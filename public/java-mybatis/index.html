<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Java八股文 - MyBatis - Yaxing&#39;s Blog</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="Yaxing" /><meta name="description" content=" 整理的MyBatis框架相关知识点和面试题，部分内容摘自网络，如有侵权请联系我～
" /><meta name="keywords" content="Java, 日记, 思考, 总结" />






<meta name="generator" content="Hugo 0.108.0 with theme even" />


<link rel="canonical" href="https://yaxing97.com/java-mybatis/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<link href="/sass/main.min.7f1b71ba722d230974863214796f63293237663ac28314ab94133cab2074126c.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Java八股文 - MyBatis" />
<meta property="og:description" content="
整理的MyBatis框架相关知识点和面试题，部分内容摘自网络，如有侵权请联系我～
" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://yaxing97.com/java-mybatis/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2023-01-23T15:30:00+00:00" />
<meta property="article:modified_time" content="2023-01-23T15:30:00+00:00" />
<meta itemprop="name" content="Java八股文 - MyBatis">
<meta itemprop="description" content="
整理的MyBatis框架相关知识点和面试题，部分内容摘自网络，如有侵权请联系我～
"><meta itemprop="datePublished" content="2023-01-23T15:30:00+00:00" />
<meta itemprop="dateModified" content="2023-01-23T15:30:00+00:00" />
<meta itemprop="wordCount" content="3965">
<meta itemprop="keywords" content="MyBatis," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Java八股文 - MyBatis"/>
<meta name="twitter:description" content="
整理的MyBatis框架相关知识点和面试题，部分内容摘自网络，如有侵权请联系我～
"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Yaxing&#39;s Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Yaxing&#39;s Blog</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Java八股文 - MyBatis</h1>

      <div class="post-meta">
        <span class="post-time"> 2023-01-23 </span>
        <div class="post-category">
            <a href="/categories/java%E5%85%AB%E8%82%A1%E6%96%87/"> Java八股文&#34; </a>
            </div>
          <span class="more-meta"> 约 3965 字 </span>
          <span class="more-meta"> 预计阅读 8 分钟 </span>
        <span id="busuanzi_container_page_pv" class="more-meta"> <span id="busuanzi_value_page_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> 次阅读 </span>
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li><a href="#什么是mybatis">什么是MyBatis？</a></li>
            <li><a href="#orm是什么">ORM是什么</a></li>
            <li><a href="#为什么说mybatis是半自动orm映射工具它与全自动的区别在哪里">为什么说MyBatis是半自动ORM映射工具？它与全自动的区别在哪里？</a></li>
            <li><a href="#jdbc编程有哪些不足之处mybatis是如何解决的">JDBC编程有哪些不足之处，MyBatis是如何解决的？</a></li>
            <li><a href="#mybatis编程步骤是什么样的">MyBatis编程步骤是什么样的？</a></li>
            <li><a href="#和的区别是什么">#{}和${}的区别是什么？</a></li>
            <li><a href="#当实体类中的属性名和表中的字段名不一样-怎么办-">当实体类中的属性名和表中的字段名不一样 ，怎么办 ？</a></li>
            <li><a href="#模糊查询like语句该怎么写">模糊查询like语句该怎么写?</a></li>
            <li><a href="#mybatis都有哪些executor执行器它们之间的区别是什么">MyBatis都有哪些Executor执行器？它们之间的区别是什么？</a></li>
            <li><a href="#通常一个xml映射文件都会写一个dao接口与之对应请问这个dao接口的工作原理是什么dao接口里的方法参数不同时方法能重载吗">通常一个xml映射文件，都会写一个Dao接口与之对应，请问，这个Dao接口的工作原理是什么？Dao接口里的方法，参数不同时，方法能重载吗？</a></li>
            <li><a href="#mybatis是如何将sql执行结果封装为目标对象并返回的都有哪些映射形式">MyBatis是如何将SQL执行结果封装为目标对象并返回的？都有哪些映射形式？</a></li>
            <li><a href="#在mapper中如何传递多个参数">在mapper中如何传递多个参数?</a></li>
            <li><a href="#mybatis动态sql有什么用执行原理有哪些动态sql">MyBatis动态SQL有什么用？执行原理？有哪些动态SQL？</a></li>
            <li><a href="#mybatis实现一对多有几种方式怎么操作的">MyBatis实现一对多有几种方式,怎么操作的？</a></li>
            <li><a href="#mybatis是否支持延迟加载如果支持它的实现原理是什么">MyBatis是否支持延迟加载？如果支持，它的实现原理是什么？</a></li>
            <li><a href="#mybatis的一级二级缓存">MyBatis的一级、二级缓存</a></li>
            <li><a href="#什么是mybatis的接口绑定有哪些实现方式">什么是MyBatis的接口绑定？有哪些实现方式？</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <blockquote>
<p>整理的MyBatis框架相关知识点和面试题，部分内容摘自网络，如有侵权请联系我～</p>
</blockquote>
<h3 id="什么是mybatis">什么是MyBatis？</h3>
<ol>
<li>MyBatis 是一个半 ORM（对象关系映射）框架，它内部封装了 JDBC，开发时只需要关注 SQL 语句本身，不需要花费精力去处理<strong>加载驱动、创建连接、创建statement</strong>等繁杂的过程。</li>
<li>通过 xml 文件或注解的方式将要执行的各种 statement 配置起来，并通过 java 对象和 statement 中 SQL 的动态参数进行映射生成最终执行的 SQL 语句，最后由 mybatis 框架执行 SQL 并将结果映射为 java 对象并返回。（从执行 SQL 到返回 result 的过程）。</li>
</ol>
<h3 id="orm是什么">ORM是什么</h3>
<p>ORM（Object Relational Mapping），对象关系映射，就是把数据库表和实体类及实体类的属性对应起来</p>
<p>让我们可以操作实体类就实现操作数据库表。</p>
<h3 id="为什么说mybatis是半自动orm映射工具它与全自动的区别在哪里">为什么说MyBatis是半自动ORM映射工具？它与全自动的区别在哪里？</h3>
<p>MyBatis 在查询关联对象或关联集合对象时，需要手动编写 SQL 来完成，所以，称之为半自动 ORM 映射工具。</p>
<h3 id="jdbc编程有哪些不足之处mybatis是如何解决的">JDBC编程有哪些不足之处，MyBatis是如何解决的？</h3>
<ol>
<li>数据库连接创建、释放频繁，造成系统资源浪费从而影响系统性能</li>
<li>SQL 语句写在代码中造成代码<strong>不易维护</strong></li>
<li>向 SQL 语句<strong>传参</strong>麻烦</li>
<li>对<strong>结果集解析</strong>麻烦</li>
</ol>
<h3 id="mybatis编程步骤是什么样的">MyBatis编程步骤是什么样的？</h3>
<ol>
<li>读取配置文件，创建 SqlSessionFactory 工厂</li>
<li>通过 SqlSessionFactory 工厂创建 SqlSession 对象</li>
<li>使用 SqlSession 创建 Dao 接口的代理对象</li>
<li>使用代理对象执行方法</li>
<li>调用 session.commit()提交事务</li>
<li>调用 session.close()关闭会话</li>
</ol>
<h3 id="和的区别是什么">#{}和${}的区别是什么？</h3>
<p>mybatis 在处理 #{} 时，会将 SQL 中的 #{} 替换为 ? 号，调用 PreparedStatement 的 set 方法来赋值。
这是<strong>预编译处理</strong>，可以提高 SQL 执行效率，更重要的是<strong>可以防止SQL注入</strong>；</p>
<p>mybatis 在处理 ${} 时，就是把 ${} 使用<strong>字符串替换</strong>。使用该方式如果传入 id 的话，会把 id=1 转换为 id=&ldquo;1&quot;字符串形式，而数据库中 id 实际为数值型这样就不匹配了，查询失败。（${}是字符串替换，通常在 EL 表达式中使用，用来展示后端传递到前端的值）。</p>
<h3 id="当实体类中的属性名和表中的字段名不一样-怎么办-">当实体类中的属性名和表中的字段名不一样 ，怎么办 ？</h3>
<ol>
<li>通过在查询的 SQL 语句中定义数据库字段名的别名，让数据库字段名的别名和实体类的属性名一致。</li>
<li>通过 <code>&lt;resultMap&gt;</code>来映射字段名和实体类属性名的一一对应的关系。</li>
</ol>
<h3 id="模糊查询like语句该怎么写">模糊查询like语句该怎么写?</h3>
<ol>
<li>
<p>在 Java 代码中添加 SQL 通配符。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl">string wildcardname = “%smi%”;
</span></span><span class="line"><span class="cl">list<span class="nt">&lt;name&gt;</span> names = mapper.selectlike(wildcardname);
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">”selectlike”</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">	select * from foo where bar like #{value}
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/select&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>在 SQL 语句中拼接通配符%，会引起 SQL 注入</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl">string wildcardname = “smi”;
</span></span><span class="line"><span class="cl">list<span class="nt">&lt;name&gt;</span> names = mapper.selectlike(wildcardname);
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">”selectlike”</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">	select * from foo where bar like &#34;%&#34;#{value}&#34;%&#34;
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/select&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h3 id="mybatis都有哪些executor执行器它们之间的区别是什么">MyBatis都有哪些Executor执行器？它们之间的区别是什么？</h3>
<p>MyBatis 有三种基本的 Executor 执行器，SimpleExecutor、ReuseExecutor、BatchExecutor。</p>
<ul>
<li><strong>SimpleExecutor</strong> ：每次开启一个 Statement 对象，用完立刻关闭 Statement 对象。</li>
<li><strong>ReuseExecutor</strong> ：重复使用创建的 Statement 对象。</li>
<li><strong>BatchExecutor</strong> ：缓存了多个 Statement 对象，一起执行批量更新。</li>
</ul>
<h3 id="通常一个xml映射文件都会写一个dao接口与之对应请问这个dao接口的工作原理是什么dao接口里的方法参数不同时方法能重载吗">通常一个xml映射文件，都会写一个Dao接口与之对应，请问，这个Dao接口的工作原理是什么？Dao接口里的方法，参数不同时，方法能重载吗？</h3>
<p>Dao 接口，就是人们常说的 <code>Mapper</code>接口，接口的全限名，就是映射文件中的 namespace 的值，接口的方法名，就是映射文件中<code>MappedStatement</code>的 id 值，接口方法内的参数，就是传递给 SQL 的参数。<code>Mapper</code>接口是没有实现类的，当调用接口方法时，接口全限名+方法名拼接字符串作为 key 值，可唯一定位一个<code>MappedStatement</code>，举例：<code>com.yaxing.dao.IUserDao.findAll</code>，可以唯一找到 namespace 为<code>com.yaxing.dao.IUserDao</code>下面<code>id = findAll</code>的<code>MappedStatement</code>。在 MyBatis 中，每一个<code>&lt;select&gt;</code>、<code>&lt;insert&gt;</code>、<code>&lt;update&gt;</code>、<code>&lt;delete&gt;</code>标签，都会被解析为一个<code>MappedStatement</code>对象，然后执行后续的操作。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.yaxing.dao.IUserDao&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;findAll&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.yaxing.domain.User&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">        select * from user;
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/select&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/mapper&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Dao 接口里的方法可以重载，但是 MyBatis 的 XML 里面的 ID 不允许重复，也就是说对于同一个接口方法名，mapper 文件中只能有一个该 id。
可以使用动态 SQL 实现接口重载对应的 maper。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * Mapper接口里面方法重载
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">StuMapper</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">List</span><span class="o">&lt;</span><span class="n">Student</span><span class="o">&gt;</span> <span class="nf">getAllStu</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">List</span><span class="o">&lt;</span><span class="n">Student</span><span class="o">&gt;</span> <span class="nf">getAllStu</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">&#34;id&#34;</span><span class="o">)</span> <span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>然后在 <code>StuMapper.xml</code> 中利用 MyBatis 的动态 SQL 就可以实现。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getAllStu&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.pojo.Student&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    select * from student
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;where&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;id != null&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">            id = #{id}
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/if&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/where&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/select&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>能正常运行，并能得到相应的结果，这样就实现了在 Dao 接口中写重载方法。</p>
<p><strong>MyBatis 的 Dao 接口可以有多个重载方法，但是多个接口对应的映射必须只有一个，否则启动会报错。</strong></p>
<h3 id="mybatis是如何将sql执行结果封装为目标对象并返回的都有哪些映射形式">MyBatis是如何将SQL执行结果封装为目标对象并返回的？都有哪些映射形式？</h3>
<ol>
<li>
<p>使用 <code>&lt;resultMap&gt;</code>标签，逐一定义数据库列名和对象属性名之间的映射关系。</p>
</li>
<li>
<p>使用 SQL 列的别名功能，将列的别名属性对应为对象属性名。</p>
</li>
</ol>
<p>有了列名与属性名的映射关系后，MyBatis<strong>通过反射创建对象</strong>，同时<strong>使用反射给对象的属性逐一赋值</strong>并返回，那些找不到映射关系的属性，是无法完成赋值的。</p>
<h3 id="在mapper中如何传递多个参数">在mapper中如何传递多个参数?</h3>
<ol>
<li>顺序传参法，#{} 里面的数字代表传入参数的顺序</li>
<li>@Param 注解传参法，#{} 里面的名称对应的是注解@Param 括号里面修饰的名称</li>
<li>map 传参，#{} 里面的名称对应的是 Map 里面的 key 名称。</li>
<li>Java Bean 传参法，#{} 里面的名称对应的是 User 类里面的成员属性。</li>
</ol>
<h3 id="mybatis动态sql有什么用执行原理有哪些动态sql">MyBatis动态SQL有什么用？执行原理？有哪些动态SQL？</h3>
<p>MyBatis 动态 SQL 可以在 xml 映射文件内，以标签的形式编写动态 SQL.</p>
<p>执行原理是根据表达式的值 完成逻辑判断并动态拼接 SQL。</p>
<p>MyBatis 提供了 9 种动态 SQL 标签： 常用的有 <code>if|where|foreach</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getAllStu&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.pojo.Student&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    select * from student
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;where&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;id != null&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">            id = #{id}
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/if&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/where&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/select&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="mybatis实现一对多有几种方式怎么操作的">MyBatis实现一对多有几种方式,怎么操作的？</h3>
<p>有<strong>联合查询</strong>和<strong>嵌套查询</strong>。</p>
<p>联合查询是几个表联合查询,只查询一次,通过在 resultMap 里面的 collection 节点配置一对多的类就可以完成；</p>
<p>嵌套查询是先查一个表,根据这个表里面的 结果的外键 id,去再另外一个表里面查询数据,也是通过配置 collection,但另外一个表的查询通过 select 节点配置。</p>
<h3 id="mybatis是否支持延迟加载如果支持它的实现原理是什么">MyBatis是否支持延迟加载？如果支持，它的实现原理是什么？</h3>
<p>MyBatis 仅支持 association 关联对象和 collection 关联集合对象的延迟加载。
association 指的就是一对一，collection 指的就是一对多查询。
在 MyBatis 配置文件中，可以配置是否启用延迟加载 lazyLoadingEnabled=true|false。</p>
<p>它的原理是，使用 CGLIB 创建目标对象的代理对象，当调用目标方法时，进入拦截器方法，比如调用 a.getB().getName()，拦截器 invoke()方法发现 a.getB()是 null 值，那么就会单独发送事先保存好的查询关联 B 对象的 SQL，把 B 查询上来，然后调用 a.setB(b)，于是 a 的对象 b 属性就有值了，接着完成 a.getB().getName()方法的调用。这就是延迟加载的基本原理。</p>
<h3 id="mybatis的一级二级缓存">MyBatis的一级、二级缓存</h3>
<p><strong>一级缓存</strong>：一级缓存是 SqlSession 范围的缓存</p>
<p>当我们执行查询之后，查询的结果会同时存入到 SqlSession 为我们提供的一块区域中。该区域的结构是一个 Map。
当我们再次查询同样的数据时，MyBatis 会先去 SqlSession 中查询是否有，有的话直接拿出来用。</p>
<p>当调用 SqlSession 的添加，修改，删除，commit()，close()、clearCache()等方法时，就会清空一级缓存。</p>
<blockquote>
<p>第一次发起查询用户id为1的用户信息，先去找缓存中是否有id为1的用户信息，如果没有，从数据库查询用户信息。
得到用户信息，将用户信息存储到一级缓存中。
如果SQLSession去执行commit操作（执行插入、更新、删除），清空SqlSession中的一级缓存，这样做的目的为了让缓存中存储的是最新的信息，避免脏读。
第二次发起查询用户id为1的用户信息，先去找缓存中是否有id为1的用户信息，缓存中有，直接从缓存中获取用户信息。</p>
</blockquote>
<p><strong>二级缓存</strong>：二级缓存是 mapper 映射级别的缓存，多个 SqlSession 去操作同一个 Mapper 映射的 SQL 语句，多个 SqlSession 可以共用二级缓存，二级缓存是跨 SqlSession 的。</p>
<p>MyBatis 中 SqlSessionFactory 对象的缓存</p>
<p>​	由同一个 SqlSessionFactory 对象创建的 SqlSession 共享其缓存。</p>
<p>​	二级缓存存放的是数据，而不是对象。</p>
<blockquote>
<p>SQLSession1去查询用户信息，查询到用户信息会将查询数据存储到二级缓存中。
如果SqlSession3去执行相同 mapper映射下SQL，执行commit提交，将会清空该 mapper映射下的二级缓存区域的数据。
SQLSession2去查询与SQLSession1相同的用户信息，首先会去缓存中找是否存在数据，如果存在直接从缓存中取出数据。</p>
</blockquote>
<p>1）一级缓存: 基于 PerpetualCache 的 HashMap 本地缓存，其存储作用域为 Session，当 Session flush 或 close 之后，该 Session 中的所有 Cache 就将清空，默认打开一级缓存；</p>
<p>2）二级缓存与一级缓存其机制相同，默认也是采用 PerpetualCache，HashMap 存储，不同在于其存储作用域为 Mapper(Namespace)，并且可自定义存储源，如 Ehcache。默认不打开二级缓存，要开启二级缓存，使用二级缓存属性类需要实现 Serializable 序列化接口(可用来保存对象的状态),可在它的映射文件中配置 <code>&lt;cache/&gt;</code> ；</p>
<p>3）对于缓存数据更新机制，当某一个作用域(一级缓存 Session/二级缓存 Namespaces)的进行了 C/U/D 操作后，默认该作用域下所有 select 中的缓存将被 clear。</p>
<h3 id="什么是mybatis的接口绑定有哪些实现方式">什么是MyBatis的接口绑定？有哪些实现方式？</h3>
<p>接口绑定，就是在 MyBatis 中任意定义接口,然后把接口里面的方法和 SQL 语句绑定, 我们直接调用接口方法就可以,这样比起原来了 SqlSession 提供的方法我们可以有更加灵活的选择和设置。</p>
<p>接口绑定有两种实现方式：</p>
<ol>
<li>通过注解绑定，就是在接口的方法上面加上 @Select、@Update 等注解，里面包含 Sql 语句来绑定；</li>
<li>通过 xml 里面写 SQL 来绑定, 在这种情况下,要指定 xml 映射文件里面的 namespace 必须为接口的全路径名。当 Sql 语句比较简单时候,用注解绑定, 当 SQL 语句比较复杂时候,用 xml 绑定,一般用 xml 绑定的比较多。</li>
</ol>
    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/mybatis/">MyBatis</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/java-spring/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Java八股文 - Spring</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        <a class="next" href="/java-concurrent-programming/">
            <span class="next-text nav-default">Java八股文 - Java并发</span>
            <span class="next-text nav-mobile">下一篇</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:yaxingfang@163.com" class="iconfont icon-email" title="email"></a>
      <a href="https://scholar.google.com.hk/citations?user=9DPge4wAAAAJ&amp;hl=zh-CN&amp;oi=sra" class="iconfont icon-google" title="google"></a>
      <a href="https://github.com/yaxingfang" class="iconfont icon-github" title="github"></a>
      <a href="https://www.zhihu.com/people/fang-ya-xing-22" class="iconfont icon-zhihu" title="zhihu"></a>
      <a href="https://yaxing97.com" class="iconfont icon-bilibili" title="bilibili"></a>
  <a href="https://yaxing97.com/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://gohugo.io">Hugo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  <div class="busuanzi-footer">
    <span id="busuanzi_container_site_pv"> 本站总访问量 <span id="busuanzi_value_site_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> 次 </span>
      <span class="division">|</span>
    <span id="busuanzi_container_site_uv"> 本站总访客数 <span id="busuanzi_value_site_uv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> 人 </span>
  </div>

  <span class="copyright-year">
    &copy; 
    2022 - 
    2023<span class="heart"><i class="iconfont icon-heart"></i></span><span>Yaxing</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js"></script>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'G-FD6WJ02QTG', 'auto');
	ga('set', 'anonymizeIp', true);
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<script id="baidu_analytics">
  var _hmt = _hmt || [];
  (function() {
    if (window.location.hostname === 'localhost') return;
    var hm = document.createElement("script"); hm.async = true;
    hm.src = "https://hm.baidu.com/hm.js?2037c3637df2058f01d810ede4492aec";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script>






</body>
</html>
