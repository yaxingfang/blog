{"meta":{"version":1,"warehouse":"4.0.2"},"models":{"Asset":[{"_id":"source/imgs/alipay.jpg","path":"imgs/alipay.jpg","modified":1,"renderable":0},{"_id":"source/imgs/wechat.jpg","path":"imgs/wechat.jpg","modified":1,"renderable":0},{"_id":"themes/icarus/source/img/avatar.png","path":"img/avatar.png","modified":1,"renderable":1},{"_id":"themes/icarus/source/img/favicon.svg","path":"img/favicon.svg","modified":1,"renderable":1},{"_id":"themes/icarus/source/img/logo.svg","path":"img/logo.svg","modified":1,"renderable":1},{"_id":"themes/icarus/source/img/og_image.png","path":"img/og_image.png","modified":1,"renderable":1},{"_id":"themes/icarus/source/img/razor-bottom-black.svg","path":"img/razor-bottom-black.svg","modified":1,"renderable":1},{"_id":"themes/icarus/source/img/razor-top-black.svg","path":"img/razor-top-black.svg","modified":1,"renderable":1},{"_id":"themes/icarus/source/css/cyberpunk.styl","path":"css/cyberpunk.styl","modified":1,"renderable":1},{"_id":"themes/icarus/source/css/default.styl","path":"css/default.styl","modified":1,"renderable":1},{"_id":"themes/icarus/source/js/animation.js","path":"js/animation.js","modified":1,"renderable":1},{"_id":"themes/icarus/source/js/back_to_top.js","path":"js/back_to_top.js","modified":1,"renderable":1},{"_id":"themes/icarus/source/js/column.js","path":"js/column.js","modified":1,"renderable":1},{"_id":"themes/icarus/source/js/main.js","path":"js/main.js","modified":1,"renderable":1},{"_id":"themes/icarus/source/css/style.styl","path":"css/style.styl","modified":1,"renderable":1},{"_id":"themes/icarus/source/img/alipay.jpg","path":"img/alipay.jpg","modified":1,"renderable":1},{"_id":"themes/icarus/source/img/wechat.jpg","path":"img/wechat.jpg","modified":1,"renderable":1}],"Cache":[{"_id":"source/_posts/.DS_Store","hash":"15f615ee77ad314ed011d8dc83f444a0dfd3dc71","modified":1676082274704},{"_id":"source/_posts/12å¼ å›¾å›å¿†æˆ‘çš„2022.md","hash":"ac66699d1542b20ff0d399d69d6ae8029f742f4e","modified":1674736558970},{"_id":"source/_posts/2022å®ä¹ æ€»ç»“.md","hash":"7d9c8d0c736839ccc428eee3bd5fe451eba53af4","modified":1674736558970},{"_id":"source/.DS_Store","hash":"0399c6d1283c9b975f6a52ad33d648cd0d667b55","modified":1676082274705},{"_id":"source/_posts/2022ç§‹æ‹›æ€»ç»“.md","hash":"c69384d32f03fb9209d1bea2a320e59ce12c791f","modified":1674736558971},{"_id":"source/_posts/Javaå…«è‚¡æ–‡ - JavaåŸºç¡€.md","hash":"a7bd4e462f5fd64276698ada528131f6c71b94fb","modified":1674736830310},{"_id":"source/_posts/Javaå…«è‚¡æ–‡ - Javaå¼‚å¸¸.md","hash":"09b3b445a2df8eca69dd72f1266ce23a95d13cf3","modified":1674738030451},{"_id":"source/_posts/Javaå…«è‚¡æ–‡ - Javaé›†åˆ.md","hash":"f50e06ec8bb71825b1d01baec9e37948f77b184e","modified":1674736558974},{"_id":"source/_posts/Javaå…«è‚¡æ–‡ - MyBatis.md","hash":"40d75f0ea68a4322d1e1a826e22beaf1a3ed55ac","modified":1674736558974},{"_id":"source/_posts/Javaå…«è‚¡æ–‡ - Spring.md","hash":"089097cb49f4ea3da654f381cd8bf4ee5a8bf72c","modified":1674736558975},{"_id":"source/_posts/Javaå…«è‚¡æ–‡ - SpringMVC.md","hash":"80f8cb25cbf0d8674bbc6a19023c2c3d705a91a1","modified":1674736558976},{"_id":"source/_posts/Macå®‰è£…MySQLä»¥åŠSequel-Proé…ç½®ä¸è¿æ¥.md","hash":"be34c0ff80236f96674cd15e7296b1e41712dfaa","modified":1676088608942},{"_id":"source/_posts/Javaå…«è‚¡æ–‡-è®¡ç®—æœºç½‘ç»œ.md","hash":"fe9669305463eab9de8de8d31aa491dbaf222534","modified":1674993624422},{"_id":"source/_posts/Typoraé…ç½®é˜¿é‡Œäº‘OSSå›¾åºŠ.md","hash":"c520e8e0c519bb469e214d13664bb9a4c07a6b98","modified":1674736558980},{"_id":"source/_posts/å…³äºä½“åˆ¶å†…çš„ä¸€äº›æ€è€ƒ.md","hash":"f2bab7eea2a545a445ab5d811ab31d70f8c641dc","modified":1675840387642},{"_id":"source/_posts/å­—èŠ‚æš‘æœŸå®ä¹ åŒç»„å®ä¹ ç”Ÿç§‹æ‹›æƒ…å†µåˆ†äº«.md","hash":"b7474b9af9ab715279f534bc22f031da32ff9d43","modified":1674736558981},{"_id":"source/_posts/å›è€å®¶çš„ä¸€å‘¨.md","hash":"479d7dfd0f78087f92e4bb96e1cdf4f849ecbe55","modified":1674734830270},{"_id":"source/_posts/å¼€äº†ä¸ªBç«™å¤§ä¼šå‘˜.md","hash":"9f61e6a37fd13d272ba9ed8d33aafbda6010567f","modified":1674736558981},{"_id":"source/_posts/æ–°å¹´å¿«ä¹ï¼.md","hash":"a1d29f9cabd7a9f2d2a87c29c455c56726ff2487","modified":1674734830270},{"_id":"source/_posts/æ‰‹æŠŠæ‰‹å¸¦ä½ æ­å»ºä¸ªäººåšå®¢.md","hash":"b691bb5f1a201a402586da957145a138406f1305","modified":1674736558982},{"_id":"source/_posts/æ–°ä¹°çš„å°ä¹¦æ¡Œ.md","hash":"4a0efd2e8e60db8574697f5082d0cb149a2fdc99","modified":1674736558983},{"_id":"source/_posts/æœ€è¿‘å…³äºæ ¡æ‹›ã€äº’è”ç½‘çš„ä¸€äº›ä¿¡æ¯.md","hash":"79de0a6e50c8e869834bf5fda957c15ed514638f","modified":1674736558983},{"_id":"source/_posts/æ±Ÿè‹çœè€ƒè€ƒå®Œå•¦.md","hash":"1ecdc57336003c34041679e6bd17901d9544ea46","modified":1674736558984},{"_id":"source/about/.DS_Store","hash":"34fe290bc8d934cf4c51deea76c7ec16f3cf4d2f","modified":1675912021468},{"_id":"source/_posts/ç®—æ³•-æ’åºç®—æ³•.md","hash":"bd482101073452d727e1e5451b26e7cbdb49bc38","modified":1675136906886},{"_id":"source/categories/index.md","hash":"34befbcc0cb1361fe6ab629e0efcb19c0ee86647","modified":1673929754157},{"_id":"source/about/index.md","hash":"3a3332e834e0e7a899ee8d52a9d55f080f39a019","modified":1675840940099},{"_id":"source/categories/.DS_Store","hash":"34fe290bc8d934cf4c51deea76c7ec16f3cf4d2f","modified":1671761650651},{"_id":"source/tags/index.md","hash":"95d08ed3da8f867aaab215ddace25b88fbf1a14f","modified":1673931830273},{"_id":"source/_posts/Javaå…«è‚¡æ–‡ - Javaå¹¶å‘.md","hash":"1c4cfbe12f8e14d04c241c8feb1e30344c764dc0","modified":1674736558973},{"_id":"source/_posts/Javaå…«è‚¡æ–‡-Linux.md","hash":"c1a7aea983da7a4203c3c0c7cf28c986aeaf8f26","modified":1674993581227},{"_id":"source/_posts/Javaå…«è‚¡æ–‡-Redis.md","hash":"d62b84d16759ab35ac00706954d5dd59165f136f","modified":1674992709073},{"_id":"source/_posts/Javaå…«è‚¡æ–‡-MySQL.md","hash":"76567a6d63072df2ed088e4aa9b5a36a57ccb1a4","modified":1674736558978},{"_id":"source/imgs/wechat.jpg","hash":"28ad8a9883ec29a49d52aeb9d8792493f56e760a","modified":1671703105000},{"_id":"source/imgs/alipay.jpg","hash":"581c5ac9226be5f2e061f385780f39bc52850b47","modified":1671703075000},{"_id":"themes/icarus/layout/donate/.gitkeep","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1673879406360},{"_id":"themes/icarus/layout/misc/.gitkeep","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1673879406364},{"_id":"themes/icarus/layout/comment/.gitkeep","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1673879406353},{"_id":"themes/icarus/layout/share/.gitkeep","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1673879406372},{"_id":"themes/icarus/layout/search/.gitkeep","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1673879406368},{"_id":"themes/icarus/include/schema/comment/.gitkeep","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1673879406219},{"_id":"themes/icarus/include/schema/search/.gitkeep","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1673879406335},{"_id":"themes/icarus/include/schema/misc/.gitkeep","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1673879406321},{"_id":"themes/icarus/include/schema/share/.gitkeep","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1673879406346},{"_id":"themes/icarus/include/schema/donate/.gitkeep","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1673879406290},{"_id":"themes/icarus/package.json","hash":"9d42eb99acdaf56afbda664adea40d8d80cdb0b0","modified":1673879406412},{"_id":"themes/icarus/CONTRIBUTING.md","hash":"70254c6778c1e41bb2ff222bbf3a70b2239b9bc1","modified":1673879406442},{"_id":"themes/icarus/include/config.js","hash":"1ff0f174e9670074ad2bee890d5b6da486800c9a","modified":1673879406385},{"_id":"themes/icarus/README.md","hash":"32f9f4fc8cd7ec60b30544bd2e558b593519ae5d","modified":1673879406442},{"_id":"themes/icarus/LICENSE","hash":"86037e5335a49321fa73b7815cab542057fac944","modified":1673879406375},{"_id":"themes/icarus/include/dependency.js","hash":"0ca35dec92ccf383f45db905db1a5a0e92d7209e","modified":1673879406388},{"_id":"themes/icarus/include/register.js","hash":"ec6596b63bfb4349ba61792d905abe8e06fea625","modified":1673879406395},{"_id":"themes/icarus/languages/en.yml","hash":"3d674204d9f723c829226da745afddd180c1131d","modified":1673879406471},{"_id":"themes/icarus/include/.DS_Store","hash":"4d4dfa619c5514b2386ed877e28e673be438287b","modified":1674523813595},{"_id":"themes/icarus/languages/de.yml","hash":"78421f09961ca0b24756a0688fb2cb2e2696e25f","modified":1673879406470},{"_id":"themes/icarus/languages/fr.yml","hash":"06d5c819d6108a42b28cff7b52e5410d0bed55d1","modified":1673879406472},{"_id":"themes/icarus/.DS_Store","hash":"d1528e36eff411e83dfcbfd19998d12857757cbf","modified":1674523813597},{"_id":"themes/icarus/languages/id.yml","hash":"5e48b1d62378cadeb64b88349477726a5c1bae47","modified":1673879406473},{"_id":"themes/icarus/languages/es.yml","hash":"38579b8fad4b6997362acc770615bcd85ff20f68","modified":1673879406471},{"_id":"themes/icarus/languages/ja.yml","hash":"801d9930fef48d6a3f80470d5bed4f3eb78147e6","modified":1673879406474},{"_id":"themes/icarus/languages/ko.yml","hash":"e3374265377809c1518114cf352b595840c0b416","modified":1673879406474},{"_id":"themes/icarus/languages/pt-BR.yml","hash":"ee8f73350e4c6e2f63b7fc72b34472a6b1e21244","modified":1673879406475},{"_id":"themes/icarus/languages/pl.yml","hash":"2e7debb44cd91096f30efc87bf8d6b1d0d0214c9","modified":1673879406474},{"_id":"themes/icarus/languages/ru.yml","hash":"9d91358c2acbe7a0f2a25daf7f65b999ff32d068","modified":1673879406476},{"_id":"themes/icarus/languages/tk.yml","hash":"ca583168bd2025124a1cd0e977da475d7a7496fd","modified":1673879406477},{"_id":"themes/icarus/languages/vn.yml","hash":"5f2fffa642110c81d8f529949711c9d19ad6bbbe","modified":1673879406478},{"_id":"themes/icarus/languages/tr.yml","hash":"dd0a7bfe14848d6e1aa229198fe1db03e08e305e","modified":1673879406477},{"_id":"themes/icarus/languages/zh-TW.yml","hash":"a6826e0c8cdb9ad286324b682b466a9e2ad78e6f","modified":1673879406479},{"_id":"themes/icarus/languages/zh-CN.yml","hash":"02475ba14afc70dfeaf5678467cee307835e4efa","modified":1673879406479},{"_id":"themes/icarus/layout/archive.jsx","hash":"99bf235042d0c57af15d2f108ba5eda77443fea8","modified":1673879406424},{"_id":"themes/icarus/layout/.DS_Store","hash":"282592d5239b152794d0c05ad8384bd7de1b9dec","modified":1674355043735},{"_id":"themes/icarus/layout/category.jsx","hash":"fd15e4eac32de9ac8687aeb3dbe179ab61375700","modified":1673879406427},{"_id":"themes/icarus/layout/categories.jsx","hash":"b8ad43e28a4990d222bfbb95b032f88555492347","modified":1673879406427},{"_id":"themes/icarus/layout/page.jsx","hash":"d26c2db57e5a88d6483a03aeb51cda9d191d8cea","modified":1673879406433},{"_id":"themes/icarus/layout/tag.jsx","hash":"d2f18cac32ca2725d34ccff3f2051c623be6c892","modified":1673879406440},{"_id":"themes/icarus/layout/layout.jsx","hash":"a7ba430119c32bcb39a85ec0f8fa2c199b38e4c4","modified":1673962797554},{"_id":"themes/icarus/scripts/index.js","hash":"0c666db6fcb4ffc4d300f4e108c00ee42b1cbbe6","modified":1673879406391},{"_id":"themes/icarus/layout/tags.jsx","hash":"2c42cb64778235dd220c563a27a92108ddc50cc4","modified":1673879406440},{"_id":"themes/icarus/layout/index.jsx","hash":"0a84a2348394fa9fc5080dd396bd28d357594f47","modified":1673879406432},{"_id":"themes/icarus/layout/post.jsx","hash":"d26c2db57e5a88d6483a03aeb51cda9d191d8cea","modified":1673879406435},{"_id":"themes/icarus/source/.DS_Store","hash":"fa38fb826dec66318c0a571326ecc579c1e0e4d1","modified":1673962237963},{"_id":"themes/icarus/include/style/article.styl","hash":"377cca6ef15e2d9d4c606ed1bbbf01e19609850c","modified":1674524075402},{"_id":"themes/icarus/include/style/base.styl","hash":"2bca6ad099949d52236c87db8db1002ffb99774c","modified":1673879406448},{"_id":"themes/icarus/include/style/button.styl","hash":"0fb35b4786be1b387c751fa2849bc71523fcedd4","modified":1673879406449},{"_id":"themes/icarus/include/style/.DS_Store","hash":"fbb73f09cb23cc4503a979c5eb94e9f963eb9d90","modified":1674527147562},{"_id":"themes/icarus/include/style/codeblock.styl","hash":"ec54dc24eb4d9802d8fefc44c210558bc1641109","modified":1673879406450},{"_id":"themes/icarus/include/style/card.styl","hash":"f78674422eb408cd17c17bbdc3ee1ebe4a453e05","modified":1673879406449},{"_id":"themes/icarus/include/style/donate.styl","hash":"8d0af00628c13134b5f30a558608e7bebf18c2ec","modified":1673879406453},{"_id":"themes/icarus/include/style/footer.styl","hash":"a4ad715dee38b249538ac6cce94efc9b355a904b","modified":1673919825476},{"_id":"themes/icarus/include/style/navbar.styl","hash":"34f09b144cb46a25ec2cc7260a6c207dd34ff1fe","modified":1673879406455},{"_id":"themes/icarus/include/style/helper.styl","hash":"9f3393e6122cc9f351091bfab960674e962da343","modified":1673879406454},{"_id":"themes/icarus/include/style/plugin.styl","hash":"084843d5a522029e0f84a4fe791fbcb2cabd4c36","modified":1673879406456},{"_id":"themes/icarus/include/style/responsive.styl","hash":"207083fe287612cddee6608b541861b14ac8de81","modified":1673879406457},{"_id":"themes/icarus/include/migration/head.js","hash":"7189efe33d18927d3790e8afb06642fb293b8603","modified":1673879406390},{"_id":"themes/icarus/include/style/search.styl","hash":"416737e1da4e7e907bd03609b0fee9e2aacfe56c","modified":1673879406457},{"_id":"themes/icarus/include/style/pagination.styl","hash":"b81bcd7ff915b4e9299533addc01bc4575ec35e3","modified":1673879406456},{"_id":"themes/icarus/include/style/timeline.styl","hash":"ea61798a09bffdda07efb93c2ff800b63bddc4c4","modified":1673879406466},{"_id":"themes/icarus/include/migration/v5_v5.1.js","hash":"073f22bd16e34b56f016633b1676dab2e7d8843d","modified":1673879406398},{"_id":"themes/icarus/include/style/widget.styl","hash":"c746902251136544eb3fe523235b3183f4189460","modified":1673879406467},{"_id":"themes/icarus/include/migration/v3_v4.js","hash":"9faf2184d7fe87debfbe007f3fc9079dcbcafcfe","modified":1673879406396},{"_id":"themes/icarus/include/schema/config.json","hash":"b949c52d02d5ee520ae4666a016ce91faf6fb350","modified":1673879406409},{"_id":"themes/icarus/include/util/console.js","hash":"59cf9d277d3ac85a496689bd811b1c316001641d","modified":1673879406387},{"_id":"themes/icarus/include/migration/v2_v3.js","hash":"3ccb2d2ce11018bebd7172da66faecc3983bff00","modified":1673879406396},{"_id":"themes/icarus/include/migration/v4_v5.js","hash":"6342310892d113763b5544789b45d44c0ccf2854","modified":1673879406397},{"_id":"themes/icarus/include/schema/.DS_Store","hash":"0c99a902830c52fa5cf73bb54a4028ce3da36077","modified":1674354250279},{"_id":"themes/icarus/layout/common/comment.jsx","hash":"427089c33002707b76e2f38709459a6824fd0f9b","modified":1673879406428},{"_id":"themes/icarus/layout/common/donates.jsx","hash":"889fb0a7ccc502f0a43b4a18eb330e351e50493c","modified":1673879406430},{"_id":"themes/icarus/layout/common/navbar.jsx","hash":"d96e501e52861056474659f96ee0206588d8c93a","modified":1673879406433},{"_id":"themes/icarus/layout/common/footer.jsx","hash":"baa8e40e036a3ec0114d96893b708435104b4ba9","modified":1673963514188},{"_id":"themes/icarus/layout/common/plugins.jsx","hash":"f6826c1a5f5f59f4a0aa00c63bdb0ad4ff4eab69","modified":1673879406435},{"_id":"themes/icarus/layout/common/article.jsx","hash":"efe38d9c10d6421f142407651b6230e257a57451","modified":1674357530930},{"_id":"themes/icarus/layout/common/head.jsx","hash":"2ec1f511f32e3a9c86d49f1338f57ae5ece18898","modified":1673879406431},{"_id":"themes/icarus/layout/common/scripts.jsx","hash":"4816c9099a881b5f7b13af3e42caae36edbffccd","modified":1673879406438},{"_id":"themes/icarus/layout/common/share.jsx","hash":"c9fb0319ad5e5a10ad3636b26a6c2afed14c590f","modified":1673879406440},{"_id":"themes/icarus/layout/common/search.jsx","hash":"6f244a37293031670a2964fe424ecd062e591d7b","modified":1673879406439},{"_id":"themes/icarus/layout/common/widgets.jsx","hash":"45f869e8cab0eb00827164a927156a30e1d29bb7","modified":1673962836208},{"_id":"themes/icarus/layout/plugin/animejs.jsx","hash":"e2aa27c3501a58ef1e91e511557b77395c2c02aa","modified":1673879406422},{"_id":"themes/icarus/source/img/favicon.svg","hash":"16fd847265845063a16596761cddb32926073dd2","modified":1673879406467},{"_id":"themes/icarus/layout/plugin/back_to_top.jsx","hash":"7fc0c5aaabd7d0eaff04cb68ec139442dc3414e8","modified":1673879406426},{"_id":"themes/icarus/layout/widget/profile.jsx","hash":"0d3a7fd922c12cc45d2c8d26a8f4d3a9a6ed0ae0","modified":1673879406437},{"_id":"themes/icarus/source/css/cyberpunk.styl","hash":"ae17d3528df0c3f089df14a06b7bd82f1bc5fed9","modified":1673879406452},{"_id":"themes/icarus/source/img/logo.svg","hash":"e9b5c1438ddb576693a15d0713b2a1d9ceda4be9","modified":1673879406468},{"_id":"themes/icarus/source/img/razor-top-black.svg","hash":"201f1171a43ce667a39091fe47c0f278857f18f0","modified":1673879406469},{"_id":"themes/icarus/source/img/avatar.png","hash":"0d8236dcca871735500e9d06bbdbe0853ed6775b","modified":1673879406444},{"_id":"themes/icarus/source/css/default.styl","hash":"b01da3028e5a1267a40aaae5c86a11187a2259e3","modified":1673879406452},{"_id":"themes/icarus/source/img/og_image.png","hash":"b03f163096ca9c350ec962feee9836277b5c2509","modified":1673879406447},{"_id":"themes/icarus/source/img/razor-bottom-black.svg","hash":"a3eda07b1c605b456da9cdf335a1075db5e5d72c","modified":1673879406469},{"_id":"themes/icarus/source/css/style.styl","hash":"5b9815586e993a6ccbe8cdcfc0c65ea38fc315ac","modified":1673879406465},{"_id":"themes/icarus/source/js/column.js","hash":"0baee024ab67474c073a4c41b495f3e7f0df4505","modified":1673879406380},{"_id":"themes/icarus/source/js/animation.js","hash":"0a8e361c353daa3194f4de3d646b96025d128e1a","modified":1673879406378},{"_id":"themes/icarus/source/js/main.js","hash":"ef8a0e5c80dc9cb02423fe18b142e17f99f8e9cb","modified":1674356784330},{"_id":"themes/icarus/include/schema/common/article.json","hash":"e2502c39045c6a26ccd8e880858f93e78c7bda35","modified":1673879406405},{"_id":"themes/icarus/source/js/back_to_top.js","hash":"d91f10c08c726135a13dfa1f422c49d8764ef03f","modified":1673879406379},{"_id":"themes/icarus/include/schema/common/comment.json","hash":"f49270b619f5d2c3decde6b0b5a0c3bbab4b54a5","modified":1673879406407},{"_id":"themes/icarus/include/schema/common/donates.json","hash":"ae86e6f177bedf4afbe638502c12635027539305","modified":1673879406409},{"_id":"themes/icarus/include/schema/common/footer.json","hash":"09d706cbb94d6da9a0d15c719ce7139325cae1c7","modified":1673879406410},{"_id":"themes/icarus/include/schema/common/head.json","hash":"98889f059c635e6bdbd51effd04cf1cf44968a66","modified":1673879406411},{"_id":"themes/icarus/include/schema/common/navbar.json","hash":"6691e587284c4cf450e0288680d5ff0f3565f090","modified":1673879406411},{"_id":"themes/icarus/include/schema/common/plugins.json","hash":"6036a805749816416850d944f7d64aaae62e5e75","modified":1673879406414},{"_id":"themes/icarus/include/schema/common/providers.json","hash":"97ec953d497fb53594227ae98acaef8a8baa91da","modified":1673879406417},{"_id":"themes/icarus/include/schema/common/search.json","hash":"985fbcbf47054af714ead1a124869d54f2a8b607","modified":1673879406417},{"_id":"themes/icarus/include/schema/common/sidebar.json","hash":"eb241beaec4c73e3085dfb3139ce72e827e20549","modified":1673879406419},{"_id":"themes/icarus/include/schema/common/share.json","hash":"cf4f9ff4fb27c3541b35f57db355c228fa6873e4","modified":1673879406418},{"_id":"themes/icarus/include/schema/common/widgets.json","hash":"cadd9dc942740ecd5037d3943e72f8b6a8399bbe","modified":1673879406419},{"_id":"themes/icarus/include/schema/widget/profile.json","hash":"690ee1b0791cab47ea03cf42b5b4932ed2aa5675","modified":1673879406416},{"_id":"themes/icarus/include/schema/plugin/animejs.json","hash":"e62ab6e20bd8862efa1ed32e7c0db0f8acbcfdec","modified":1673879406401},{"_id":"themes/icarus/include/schema/plugin/back_to_top.json","hash":"dc0febab7e7b67075d0ad3f80f5ec8b798b68dea","modified":1673879406407},{"_id":"themes/icarus/source/img/wechat.jpg","hash":"28ad8a9883ec29a49d52aeb9d8792493f56e760a","modified":1673963549027},{"_id":"themes/icarus/source/img/alipay.jpg","hash":"581c5ac9226be5f2e061f385780f39bc52850b47","modified":1673963549028},{"_id":"public/baidusitemap.xml","hash":"88616931c5ec416a0c9ff623ec1745f9941a1047","modified":1676088622961},{"_id":"public/atom.xml","hash":"7b715de78402544c7925cb23a4aeab5941e56960","modified":1676088622961},{"_id":"public/search.xml","hash":"918a278493cf0f66e6e1e894f61a307c9b0b2757","modified":1676088622961},{"_id":"public/sitemap.xml","hash":"d1a2ff9d6cd94dee359175b84ec6b5194249f14e","modified":1676088622961},{"_id":"public/sitemap.txt","hash":"febd107964d9a6bdec048b8d9f5d7025a68618d9","modified":1676088622961},{"_id":"public/js/algolia.js","hash":"a8df0c0abeeb4ee1d2d720161f3aea7339380704","modified":1676088622961},{"_id":"public/js/google_cse.js","hash":"1a9881669dfdeb2b3214074eee0d3e01e52db2c4","modified":1676088622961},{"_id":"public/js/insight.js","hash":"86bbdb7305d9bf19ad62d2ca2cf169fc8d9f9d31","modified":1676088622961},{"_id":"public/js/toc.js","hash":"da6fb757a1b083b8ed138bf29aad3a7bf8ec4f11","modified":1676088622961},{"_id":"public/content.json","hash":"552f8b35258ba3c340961aa13870d47a3b64a442","modified":1676088622961},{"_id":"public/manifest.json","hash":"4a4efab11b9e9d2f34509cad49a130e06418fb6f","modified":1676088622961},{"_id":"public/about/index.html","hash":"a7e007e19473525baac3aa2c7d6cfbf4473c9c99","modified":1676088622961},{"_id":"public/categories/index.html","hash":"bfe0a73c5820d0e443f536ef67db7647726a5541","modified":1676088622961},{"_id":"public/tags/index.html","hash":"9357d5b64144cc805b435bd6bed3f2e17b2bf342","modified":1676088622961},{"_id":"public/mysql-sequel-pro.html","hash":"da56ac06ab555c30cf4de0a198cc148f132b4b3b","modified":1676088622961},{"_id":"public/2023-happy-spring-festival.html","hash":"599b14a30f2ee81b5d73bba8f9e57685a9c8aed2","modified":1676088622961},{"_id":"public/archives/index.html","hash":"9090bad8d1181d5ebe2473b66e4d951a50059a58","modified":1676088622961},{"_id":"public/archives/page/2/index.html","hash":"78b5d44de8458a4a75b08eaaeae3e05e8376393d","modified":1676088622961},{"_id":"public/archives/page/3/index.html","hash":"1ad6790bcbbdc0d93c9206545140a65afa7181ef","modified":1676088622961},{"_id":"public/archives/2022/index.html","hash":"ea2622d721bb6e975a4dad0deac43d33c0fd85ea","modified":1676088622961},{"_id":"public/archives/2022/12/index.html","hash":"d962b497aad4a519e81b1f51a421a81459cb8f6e","modified":1676088622961},{"_id":"public/archives/2023/index.html","hash":"c9703b1b8e7c3675c00cb2b1aeaf914e678e68eb","modified":1676088622961},{"_id":"public/archives/2023/page/2/index.html","hash":"15190305c77902170a50cabccba9c94bc27e1378","modified":1676088622961},{"_id":"public/archives/2023/01/index.html","hash":"0253cc281a891f584aca65266f7a6a4fc348c1f4","modified":1676088622961},{"_id":"public/archives/2023/01/page/2/index.html","hash":"a1bb6202bb5ce85bcd262b14c39ebd7725dfda9f","modified":1676088622961},{"_id":"public/archives/2023/02/index.html","hash":"f369f9fbd3436a853b9c742b66fd8c4a128cb2d7","modified":1676088622961},{"_id":"public/categories/å®ä¹ ç§‹æ‹›/index.html","hash":"7980bf97e0998e716c237000b1782f0845488b12","modified":1676088622961},{"_id":"public/categories/Javaå…«è‚¡æ–‡/page/2/index.html","hash":"7414466f5612ce140755ce7d69545c797098a560","modified":1676088622961},{"_id":"public/categories/å®ä¹ ç§‹æ‹›/å®ä¹ /index.html","hash":"27635707db96bd7130ca4a01c908d34d5a224517","modified":1676088622961},{"_id":"public/categories/å®ä¹ ç§‹æ‹›/ç§‹æ‹›/index.html","hash":"29b3fbae1b918ed1cd5b63bfcd180ed885a81bea","modified":1676088622961},{"_id":"public/categories/Macå¼€å‘ç¯å¢ƒé…ç½®/index.html","hash":"8be9ea8ed63795ace9c9f91d6db4fd1ad1836317","modified":1676088622961},{"_id":"public/categories/æŠ€æœ¯æ€»ç»“/index.html","hash":"52eecbd9d87fbc66f2de401fc18fa38c0c0b57db","modified":1676088622961},{"_id":"public/categories/ä¸ªäººæ€è€ƒ/index.html","hash":"1635799e0e172332968b316f5d5f9fba92ccd79b","modified":1676088622961},{"_id":"public/categories/ç®—æ³•/index.html","hash":"62f416dc5006a45b3060701f54fb103525ffee9c","modified":1676088622961},{"_id":"public/about-within-the-system.html","hash":"0c4a27e9e85dba83cd0c8a44d9a297a3cc70dbb0","modified":1676088622961},{"_id":"public/linux.html","hash":"d0e717a93e2f22742844806eb3c62c8be28709b1","modified":1676088622961},{"_id":"public/algorithm-sort.html","hash":"d83e0db5fe106f9f2c6cedbf8b63b37b350862eb","modified":1676088622961},{"_id":"public/computer-network.html","hash":"1181a5da5aad423a00f1d45de08f28afb843d8b7","modified":1676088622961},{"_id":"public/Redis.html","hash":"71c302f7c65d62e66919cd03c3d21667880d179e","modified":1676088622961},{"_id":"public/mysql.html","hash":"cff47c34cd9c4bc910c6384d640d149311704b20","modified":1676088622961},{"_id":"public/java-springmvc.html","hash":"7004bda4efce546cfaf079c01b778af9c2499581","modified":1676088622961},{"_id":"public/java-spring.html","hash":"c4e5ba0f731bbe44df33dc8fcafa1617944ec7d1","modified":1676088622961},{"_id":"public/java-collection.html","hash":"8ecea6bc11e4ca325912c5629d87a1a166accd64","modified":1676088622961},{"_id":"public/java-mybatis.html","hash":"d512f9d3f567599d4d774889ade5ed3314d1dc80","modified":1676088622961},{"_id":"public/java-exception-error.html","hash":"547435dfea33ac88ac0793b522690baae6984b94","modified":1676088622961},{"_id":"public/java-basic-knowledge.html","hash":"a69877b04e11ba639c6907aaa90e8d37b85f02ba","modified":1676088622961},{"_id":"public/java-concurrent-programming.html","hash":"d68f9852c4767843e2951b137e7664b1a3ca5272","modified":1676088622961},{"_id":"public/202301-it-info.html","hash":"0c41ab4089a34760fc12a23b2cbc82e5b09574ac","modified":1676088622961},{"_id":"public/2022-memory.html","hash":"63a508001e51bf5229f1dc97df29b9f700e4ae90","modified":1676088622961},{"_id":"public/week-back-home.html","hash":"2ea2cb3b0f97d4f7675bb009fb72e4f0430e7301","modified":1676088622961},{"_id":"public/2022-jiangsu-gwy.html","hash":"2079dccd25aa102423d736407b0a112baa64ea32","modified":1676088622961},{"_id":"public/bilibili-vip.html","hash":"4fce115b469da0c99964a9bd513d30e2714cc517","modified":1676088622961},{"_id":"public/new-desk.html","hash":"2b6720484c6e19f8534db8d61b43f59a04865b00","modified":1676088622961},{"_id":"public/my-bytedance-internship-friends-offer.html","hash":"3aabea8ea11de27c9ea70f412cc1ab1096c4eeb2","modified":1676088622961},{"_id":"public/image-host.html","hash":"c882703a1f2f683e399fa3eff67c26fab5d0ec6d","modified":1676088622961},{"_id":"public/build-blog.html","hash":"182237959688187c68693acad6612fd57c4f8c7b","modified":1676088622961},{"_id":"public/2022-autumn-recruitment-summary.html","hash":"bfb00a75ad6762905d2c0c62f9021dc7d2931257","modified":1676088622961},{"_id":"public/2022-internship-summary.html","hash":"c92fb1ed7f25862751085052d0c121898a2a8ca4","modified":1676088622961},{"_id":"public/categories/æ—¥å¸¸å°è®°/index.html","hash":"1e2f8ca45f61f4d399ce8bd5f378be19d90ec293","modified":1676088622961},{"_id":"public/categories/Javaå…«è‚¡æ–‡/index.html","hash":"c8f94c901ccb083580135fc04bba84395193cc0a","modified":1676088622961},{"_id":"public/index.html","hash":"1c006e719235c49d63f7ecfc063c55b87ebf8d59","modified":1676088622961},{"_id":"public/page/2/index.html","hash":"34823ccc614dfd13b810e51dbaeb5c4f51c90d6b","modified":1676088622961},{"_id":"public/page/3/index.html","hash":"690bd8da7b2621192a18a9545d5fe5accd1db2bb","modified":1676088622961},{"_id":"public/img/favicon.svg","hash":"16fd847265845063a16596761cddb32926073dd2","modified":1676088622961},{"_id":"public/img/avatar.png","hash":"0d8236dcca871735500e9d06bbdbe0853ed6775b","modified":1676088622961},{"_id":"public/img/logo.svg","hash":"e9b5c1438ddb576693a15d0713b2a1d9ceda4be9","modified":1676088622961},{"_id":"public/img/og_image.png","hash":"b03f163096ca9c350ec962feee9836277b5c2509","modified":1676088622961},{"_id":"public/img/razor-top-black.svg","hash":"201f1171a43ce667a39091fe47c0f278857f18f0","modified":1676088622961},{"_id":"public/img/razor-bottom-black.svg","hash":"a3eda07b1c605b456da9cdf335a1075db5e5d72c","modified":1676088622961},{"_id":"public/imgs/alipay.jpg","hash":"581c5ac9226be5f2e061f385780f39bc52850b47","modified":1676088622961},{"_id":"public/imgs/wechat.jpg","hash":"28ad8a9883ec29a49d52aeb9d8792493f56e760a","modified":1676088622961},{"_id":"public/img/alipay.jpg","hash":"581c5ac9226be5f2e061f385780f39bc52850b47","modified":1676088622961},{"_id":"public/img/wechat.jpg","hash":"28ad8a9883ec29a49d52aeb9d8792493f56e760a","modified":1676088622961},{"_id":"public/js/animation.js","hash":"0a8e361c353daa3194f4de3d646b96025d128e1a","modified":1676088622961},{"_id":"public/js/column.js","hash":"0baee024ab67474c073a4c41b495f3e7f0df4505","modified":1676088622961},{"_id":"public/js/back_to_top.js","hash":"d91f10c08c726135a13dfa1f422c49d8764ef03f","modified":1676088622961},{"_id":"public/js/main.js","hash":"ef8a0e5c80dc9cb02423fe18b142e17f99f8e9cb","modified":1676088622961},{"_id":"public/css/default.css","hash":"2f1553e3ea465f4eb742bf909c31715fdcfd2c36","modified":1676088622961},{"_id":"public/css/cyberpunk.css","hash":"42a4c9d154e2d26cfe971d56d682303d77f232a3","modified":1676088622961},{"_id":"public/css/style.css","hash":"2f1553e3ea465f4eb742bf909c31715fdcfd2c36","modified":1676088622961}],"Category":[{"name":"æ—¥å¸¸å°è®°","_id":"cldzfw31t0004t9t86fxx7k2s"},{"name":"å®ä¹ ç§‹æ‹›","_id":"cldzfw31x0009t9t8h8hbd442"},{"name":"Javaå…«è‚¡æ–‡","_id":"cldzfw321000gt9t82r04hnto"},{"name":"å®ä¹ ","parent":"cldzfw31x0009t9t8h8hbd442","_id":"cldzfw326000st9t82jv6cdlu"},{"name":"ç§‹æ‹›","parent":"cldzfw31x0009t9t8h8hbd442","_id":"cldzfw32a0017t9t80iblfx7j"},{"name":"Macå¼€å‘ç¯å¢ƒé…ç½®","_id":"cldzfw32c001jt9t85v626a5j"},{"name":"æŠ€æœ¯æ€»ç»“","_id":"cldzfw32d001mt9t886rm9wo5"},{"name":"ä¸ªäººæ€è€ƒ","_id":"cldzfw32d001pt9t88wpifyz5"},{"name":"ç®—æ³•","_id":"cldzfw32d001vt9t8h6hj1xu8"}],"Data":[],"Page":[{"_content":"<div align=\"center\">\n<img src=\"https://rishavanand.github.io/static/images/greetings.gif\" align=\"center\" style=\"width: 100%\" />\n</div>  \n\nğŸ”­ æœ¬ç§‘ï¼šè‹å·å¤§å­¦çº³ç±³ç§‘å­¦ä¸æŠ€æœ¯å­¦é™¢ï¼ŒåŠå¯¼ä½“å™¨ä»¶æ–¹å‘ï¼›ç¡•å£«ï¼šè‹å·å¤§å­¦è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯å­¦é™¢ï¼Œè®¡ç®—æœºæŠ€æœ¯ã€‚\n\nğŸŒ± åœ¨å­—èŠ‚è·³åŠ¨é£ä¹¦åç«¯å¼€å‘å®ä¹ è¿‡ 4 ä¸ªæœˆï¼Œç§‹æ‹›æ‹¿åˆ°äº†å­—èŠ‚è·³åŠ¨ã€ä¸Šæµ·é“¶è¡Œã€è‹å·å†œè¡Œã€é«˜ä¸­ä¿¡æ¯è€å¸ˆç­‰ offerã€‚\n\nâš¡ ç¼–ç¨‹è¯­è¨€ç†Ÿæ‚‰ Javaã€Pythonï¼Œæ•°æ®åº“ç†Ÿæ‚‰ MySQLã€Redisï¼Œæ¡†æ¶ç†Ÿæ‚‰ Spring å…¨å®¶æ¡¶ï¼Œå¸¸ç”¨å·¥å…·ç†Ÿæ‚‰ Gitã€Mavenã€Linux ç­‰ã€‚\n\nâ“ æ¬¢è¿äº¤æµè®¡ç®—æœºè€ƒç ”ã€å®ä¹ ã€ç§‹æ‹›ã€ç¼–ç¨‹ã€äº’è”ç½‘ç­‰é—®é¢˜ï¼Œæˆ‘çš„é‚®ç®± yaxingfang@163.com ï½\n","source":"about/index.md","raw":"<div align=\"center\">\n<img src=\"https://rishavanand.github.io/static/images/greetings.gif\" align=\"center\" style=\"width: 100%\" />\n</div>  \n\nğŸ”­ æœ¬ç§‘ï¼šè‹å·å¤§å­¦çº³ç±³ç§‘å­¦ä¸æŠ€æœ¯å­¦é™¢ï¼ŒåŠå¯¼ä½“å™¨ä»¶æ–¹å‘ï¼›ç¡•å£«ï¼šè‹å·å¤§å­¦è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯å­¦é™¢ï¼Œè®¡ç®—æœºæŠ€æœ¯ã€‚\n\nğŸŒ± åœ¨å­—èŠ‚è·³åŠ¨é£ä¹¦åç«¯å¼€å‘å®ä¹ è¿‡ 4 ä¸ªæœˆï¼Œç§‹æ‹›æ‹¿åˆ°äº†å­—èŠ‚è·³åŠ¨ã€ä¸Šæµ·é“¶è¡Œã€è‹å·å†œè¡Œã€é«˜ä¸­ä¿¡æ¯è€å¸ˆç­‰ offerã€‚\n\nâš¡ ç¼–ç¨‹è¯­è¨€ç†Ÿæ‚‰ Javaã€Pythonï¼Œæ•°æ®åº“ç†Ÿæ‚‰ MySQLã€Redisï¼Œæ¡†æ¶ç†Ÿæ‚‰ Spring å…¨å®¶æ¡¶ï¼Œå¸¸ç”¨å·¥å…·ç†Ÿæ‚‰ Gitã€Mavenã€Linux ç­‰ã€‚\n\nâ“ æ¬¢è¿äº¤æµè®¡ç®—æœºè€ƒç ”ã€å®ä¹ ã€ç§‹æ‹›ã€ç¼–ç¨‹ã€äº’è”ç½‘ç­‰é—®é¢˜ï¼Œæˆ‘çš„é‚®ç®± yaxingfang@163.com ï½\n","date":"2023-02-08T07:22:20.103Z","updated":"2023-02-08T07:22:20.099Z","path":"about/index.html","title":"","comments":1,"layout":"page","_id":"cldzfw31m0000t9t8cf6f6az3","content":"<div align=\"center\">\n<img src=\"https://rishavanand.github.io/static/images/greetings.gif\" align=\"center\" style=\"width: 100%\" />\n</div>  \n\n<p>ğŸ”­ æœ¬ç§‘ï¼šè‹å·å¤§å­¦çº³ç±³ç§‘å­¦ä¸æŠ€æœ¯å­¦é™¢ï¼ŒåŠå¯¼ä½“å™¨ä»¶æ–¹å‘ï¼›ç¡•å£«ï¼šè‹å·å¤§å­¦è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯å­¦é™¢ï¼Œè®¡ç®—æœºæŠ€æœ¯ã€‚</p>\n<p>ğŸŒ± åœ¨å­—èŠ‚è·³åŠ¨é£ä¹¦åç«¯å¼€å‘å®ä¹ è¿‡ 4 ä¸ªæœˆï¼Œç§‹æ‹›æ‹¿åˆ°äº†å­—èŠ‚è·³åŠ¨ã€ä¸Šæµ·é“¶è¡Œã€è‹å·å†œè¡Œã€é«˜ä¸­ä¿¡æ¯è€å¸ˆç­‰ offerã€‚</p>\n<p>âš¡ ç¼–ç¨‹è¯­è¨€ç†Ÿæ‚‰ Javaã€Pythonï¼Œæ•°æ®åº“ç†Ÿæ‚‰ MySQLã€Redisï¼Œæ¡†æ¶ç†Ÿæ‚‰ Spring å…¨å®¶æ¡¶ï¼Œå¸¸ç”¨å·¥å…·ç†Ÿæ‚‰ Gitã€Mavenã€Linux ç­‰ã€‚</p>\n<p>â“ æ¬¢è¿äº¤æµè®¡ç®—æœºè€ƒç ”ã€å®ä¹ ã€ç§‹æ‹›ã€ç¼–ç¨‹ã€äº’è”ç½‘ç­‰é—®é¢˜ï¼Œæˆ‘çš„é‚®ç®± <a href=\"mailto:&#121;&#x61;&#x78;&#105;&#110;&#x67;&#102;&#x61;&#x6e;&#103;&#x40;&#49;&#54;&#51;&#46;&#99;&#x6f;&#x6d;\">&#121;&#x61;&#x78;&#105;&#110;&#x67;&#102;&#x61;&#x6e;&#103;&#x40;&#49;&#54;&#51;&#46;&#99;&#x6f;&#x6d;</a> ï½</p>\n","site":{"data":{}},"length":312,"excerpt":"","more":"<div align=\"center\">\n<img src=\"https://rishavanand.github.io/static/images/greetings.gif\" align=\"center\" style=\"width: 100%\" />\n</div>  \n\n<p>ğŸ”­ æœ¬ç§‘ï¼šè‹å·å¤§å­¦çº³ç±³ç§‘å­¦ä¸æŠ€æœ¯å­¦é™¢ï¼ŒåŠå¯¼ä½“å™¨ä»¶æ–¹å‘ï¼›ç¡•å£«ï¼šè‹å·å¤§å­¦è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯å­¦é™¢ï¼Œè®¡ç®—æœºæŠ€æœ¯ã€‚</p>\n<p>ğŸŒ± åœ¨å­—èŠ‚è·³åŠ¨é£ä¹¦åç«¯å¼€å‘å®ä¹ è¿‡ 4 ä¸ªæœˆï¼Œç§‹æ‹›æ‹¿åˆ°äº†å­—èŠ‚è·³åŠ¨ã€ä¸Šæµ·é“¶è¡Œã€è‹å·å†œè¡Œã€é«˜ä¸­ä¿¡æ¯è€å¸ˆç­‰ offerã€‚</p>\n<p>âš¡ ç¼–ç¨‹è¯­è¨€ç†Ÿæ‚‰ Javaã€Pythonï¼Œæ•°æ®åº“ç†Ÿæ‚‰ MySQLã€Redisï¼Œæ¡†æ¶ç†Ÿæ‚‰ Spring å…¨å®¶æ¡¶ï¼Œå¸¸ç”¨å·¥å…·ç†Ÿæ‚‰ Gitã€Mavenã€Linux ç­‰ã€‚</p>\n<p>â“ æ¬¢è¿äº¤æµè®¡ç®—æœºè€ƒç ”ã€å®ä¹ ã€ç§‹æ‹›ã€ç¼–ç¨‹ã€äº’è”ç½‘ç­‰é—®é¢˜ï¼Œæˆ‘çš„é‚®ç®± <a href=\"mailto:&#121;&#x61;&#x78;&#105;&#110;&#x67;&#102;&#x61;&#x6e;&#103;&#x40;&#49;&#54;&#51;&#46;&#99;&#x6f;&#x6d;\">&#121;&#x61;&#x78;&#105;&#110;&#x67;&#102;&#x61;&#x6e;&#103;&#x40;&#49;&#54;&#51;&#46;&#99;&#x6f;&#x6d;</a> ï½</p>\n"},{"title":"Categories","type":"categories","date":"2022-12-12T02:27:11.000Z","_content":"","source":"categories/index.md","raw":"---\ntitle: Categories\ntype: \"categories\"\ndate: 2022-12-12 10:27:11\n---\n","updated":"2023-01-17T04:29:14.157Z","path":"categories/index.html","comments":1,"layout":"page","_id":"cldzfw31s0002t9t8294ufsxs","content":"","site":{"data":{}},"length":0,"excerpt":"","more":""},{"title":"Tags","layout":"tags","_content":"\n","source":"tags/index.md","raw":"---\ntitle: Tags\nlayout: tags\n---\n\n","date":"2023-01-17T05:03:50.281Z","updated":"2023-01-17T05:03:50.273Z","path":"tags/index.html","comments":1,"_id":"cldzfw31v0005t9t83y0gagvc","content":"","site":{"data":{}},"length":0,"excerpt":"","more":""}],"Post":[{"title":"12å¼ å›¾å›å¿†æˆ‘çš„2022","copyright":true,"mathjax":true,"date":"2023-01-01T12:59:55.000Z","urlname":"2022-memory","_content":"\n2022 å¹´è½¬ç¬å³é€ï¼Œæˆ‘ä»æ‰‹æœºç›¸å†Œä¸­æ¯ä¸ªæœˆåˆ†åˆ«æŒ‘å‡ºä¸€å¼ ç…§ç‰‡ï¼Œåœ¨æ­¤ç»™æˆ‘çš„ 2022 ç•™ä¸ªå›å¿†ã€‚\n\n<!--more-->\n\n### 1æœˆ\n\nè¿™å¼ ç…§ç‰‡æˆ‘è®°å¾—æ˜¯ä¸€æœˆä»½çš„æŸä¸€å¤©ï¼Œå’Œ lbh å»å­¦æ ¡å—é—¨åƒå®Œæ™šé¥­å›å­¦æ ¡æ‹çš„ï¼Œè®°å¾—æ™šé¥­åƒçš„è¿˜æ˜¯â€œè¥¿å®‰è°ƒè°ƒâ€ï¼Œè‡Šå­é¢åƒçš„å¾ˆè¿‡ç˜¾ã€‚\n\n![1](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/1.JPG)\n\n### 2æœˆ\n\n2 æœˆçš„ç¬¬ä¸€å¤©å°±æ˜¯å¤§å¹´åˆä¸€è¿‡æ–°å¹´ï¼Œæ—©ä¸Šæ—©èµ·åœ¨å®¶é—¨å£æ”¾çˆ†ç«¹ã€‚\n\n![2](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/2.jpg)\n\n### 3æœˆ\n\n3 æœˆåŸºæœ¬å°±æ˜¯åœ¨å®¶åˆ·é¢˜ã€èƒŒå…«è‚¡ï¼ŒæŠ•é€’å®ä¹ ï¼Œå®ä¹ é¢è¯•ã€‚æ¯å¤©æ—©ä¸Šç…®ä¸¤ä¸ªç™½ç…®è›‹åƒã€‚è¿™æ˜¯æŸå¤©è§‰å¾—è‡ªå·±ç…®çš„å¥½çœ‹åˆå¥½åƒé‚è®°å½•ä¸‹ã€‚\n\n![3](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/3.JPG)\n\n### 4æœˆ\n\n4 æœˆæ”¶åˆ°å­—èŠ‚è·³åŠ¨çš„å®ä¹  offer å•¦ï¼Œæœˆåº•æ­£å¼å…¥èŒï¼Œæ”¶åˆ°å¯„æ¥çš„ç”µè„‘ï¼Œç–«æƒ…åŸå› å±…å®¶åŠå…¬äº†å‡ å‘¨ã€‚\n\n![4](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/4.jpg)\n\n### 5æœˆ\n\n5 æœˆåˆ°æ­å·çº¿ä¸‹å®ä¹ å•¦ï¼Œä¸­é—´æœ‰æœ‹å‹æ¥ç©ï¼Œä¸€èµ·å»çš„è¥¿æ¹–ã€‚\n\n![2205](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/2205.jpg)\n\n### 6æœˆ\n\nè¿™æ˜¯å…¬å¸æ—è¾¹ä¸€æ ‹è®¾è®¡é™¢çš„æ¥¼ï¼Œå½“æ—¶è²Œä¼¼æ˜¯å‘¨äº”æ™šä¸Šï¼Œæå‰æºœï¼Œå½“æ—¶è§‰å¾—é…ä¸Šæ¹›è“çš„å¤©ç©ºå¾ˆå¥½çœ‹ã€‚\n\n![6](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/6.JPG)\n\n### 7æœˆ\n\n7 æœˆå’Œé«˜ä¸­è€åŒå­¦ä¸€èµ·çº¦äº†ä¸ªé¥­ï¼Œé€›äº†é€›è¥¿æ¹–ï¼Œ7 æœˆçš„è·èŠ±å¼€çš„å¾ˆèŒ‚ç››ï¼Œè¥¿æ¹–æ—å…¨æ˜¯äººã€‚\n\n![7](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/7.JPG)\n\n### 8æœˆ\n\n8 æœˆç¦»èŒå‰ç…äº†ä¸€çœ¼ä»£ç é‡ï¼Œå¦‚ä¸‹æ˜¯ 4 ä¸ªæœˆçš„æˆæœï¼Œæ„Ÿè§‰è¿˜å¯ä»¥ï¼Œæ²¡æœ‰å¾ˆæ°´ã€‚\n\n![8](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/8.jpg)\n\n### 9æœˆ\n\n9 æœˆå›æ ¡è¿˜æ˜¯æ¯”è¾ƒé—²çš„ï¼ŒåŸºæœ¬å°±æ˜¯çœ‹çœ‹ç½‘è¯¾ï¼Œåšç¬”è¯•ã€é¢è¯•ã€‚ä¸‹å›¾å’Œæœ‹å‹å‡ºå»åƒé¥­é€›è¡—ï¼Œçœ‹ä¸­äº†ä¸€ä»¶å¤–å¥—ã€‚\n\n![9](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/9.JPG)\n\n### 10æœˆ\n\n10 æœˆå»å‚åŠ äº†è¡¨å¼Ÿçš„å©šç¤¼ï¼Œ4 ä¸ªä¼´éƒ+æ–°éƒçš„è‡ªæ‹ï¼Œå°å¸…ã€‚\n\n![10](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/10.JPG)\n\n### 11æœˆ\n\nå®¿èˆå¸ˆå¼Ÿè¿‡ç”Ÿæ—¥ä¸€èµ·å»æµ·åº•æå¹²é¥­ï¼Œå¤´ä¸€å›ä½“éªŒä¸‹æµ·åº•æçš„å…è´¹æ‰‹éƒ¨æŠ¤ç†ã€‚\n\n![11](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/11.JPG)\n\n### 12æœˆ\n\nå›è€å®¶è¿‡ç”Ÿæ—¥å¤§å§¨å¦ˆç»™ä¹°çš„è›‹ç³•ï¼Œå“ˆå“ˆå“ˆï¼Œå¿«ä¹ã€‚\n\n![12](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/12.jpg)\n","source":"_posts/12å¼ å›¾å›å¿†æˆ‘çš„2022.md","raw":"---\ntitle: 12å¼ å›¾å›å¿†æˆ‘çš„2022\ncopyright: true\nmathjax: true\ncategories: æ—¥å¸¸å°è®°\ntags: \ndate: 2023-01-01 20:59:55\nurlname: 2022-memory\n---\n\n2022 å¹´è½¬ç¬å³é€ï¼Œæˆ‘ä»æ‰‹æœºç›¸å†Œä¸­æ¯ä¸ªæœˆåˆ†åˆ«æŒ‘å‡ºä¸€å¼ ç…§ç‰‡ï¼Œåœ¨æ­¤ç»™æˆ‘çš„ 2022 ç•™ä¸ªå›å¿†ã€‚\n\n<!--more-->\n\n### 1æœˆ\n\nè¿™å¼ ç…§ç‰‡æˆ‘è®°å¾—æ˜¯ä¸€æœˆä»½çš„æŸä¸€å¤©ï¼Œå’Œ lbh å»å­¦æ ¡å—é—¨åƒå®Œæ™šé¥­å›å­¦æ ¡æ‹çš„ï¼Œè®°å¾—æ™šé¥­åƒçš„è¿˜æ˜¯â€œè¥¿å®‰è°ƒè°ƒâ€ï¼Œè‡Šå­é¢åƒçš„å¾ˆè¿‡ç˜¾ã€‚\n\n![1](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/1.JPG)\n\n### 2æœˆ\n\n2 æœˆçš„ç¬¬ä¸€å¤©å°±æ˜¯å¤§å¹´åˆä¸€è¿‡æ–°å¹´ï¼Œæ—©ä¸Šæ—©èµ·åœ¨å®¶é—¨å£æ”¾çˆ†ç«¹ã€‚\n\n![2](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/2.jpg)\n\n### 3æœˆ\n\n3 æœˆåŸºæœ¬å°±æ˜¯åœ¨å®¶åˆ·é¢˜ã€èƒŒå…«è‚¡ï¼ŒæŠ•é€’å®ä¹ ï¼Œå®ä¹ é¢è¯•ã€‚æ¯å¤©æ—©ä¸Šç…®ä¸¤ä¸ªç™½ç…®è›‹åƒã€‚è¿™æ˜¯æŸå¤©è§‰å¾—è‡ªå·±ç…®çš„å¥½çœ‹åˆå¥½åƒé‚è®°å½•ä¸‹ã€‚\n\n![3](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/3.JPG)\n\n### 4æœˆ\n\n4 æœˆæ”¶åˆ°å­—èŠ‚è·³åŠ¨çš„å®ä¹  offer å•¦ï¼Œæœˆåº•æ­£å¼å…¥èŒï¼Œæ”¶åˆ°å¯„æ¥çš„ç”µè„‘ï¼Œç–«æƒ…åŸå› å±…å®¶åŠå…¬äº†å‡ å‘¨ã€‚\n\n![4](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/4.jpg)\n\n### 5æœˆ\n\n5 æœˆåˆ°æ­å·çº¿ä¸‹å®ä¹ å•¦ï¼Œä¸­é—´æœ‰æœ‹å‹æ¥ç©ï¼Œä¸€èµ·å»çš„è¥¿æ¹–ã€‚\n\n![2205](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/2205.jpg)\n\n### 6æœˆ\n\nè¿™æ˜¯å…¬å¸æ—è¾¹ä¸€æ ‹è®¾è®¡é™¢çš„æ¥¼ï¼Œå½“æ—¶è²Œä¼¼æ˜¯å‘¨äº”æ™šä¸Šï¼Œæå‰æºœï¼Œå½“æ—¶è§‰å¾—é…ä¸Šæ¹›è“çš„å¤©ç©ºå¾ˆå¥½çœ‹ã€‚\n\n![6](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/6.JPG)\n\n### 7æœˆ\n\n7 æœˆå’Œé«˜ä¸­è€åŒå­¦ä¸€èµ·çº¦äº†ä¸ªé¥­ï¼Œé€›äº†é€›è¥¿æ¹–ï¼Œ7 æœˆçš„è·èŠ±å¼€çš„å¾ˆèŒ‚ç››ï¼Œè¥¿æ¹–æ—å…¨æ˜¯äººã€‚\n\n![7](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/7.JPG)\n\n### 8æœˆ\n\n8 æœˆç¦»èŒå‰ç…äº†ä¸€çœ¼ä»£ç é‡ï¼Œå¦‚ä¸‹æ˜¯ 4 ä¸ªæœˆçš„æˆæœï¼Œæ„Ÿè§‰è¿˜å¯ä»¥ï¼Œæ²¡æœ‰å¾ˆæ°´ã€‚\n\n![8](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/8.jpg)\n\n### 9æœˆ\n\n9 æœˆå›æ ¡è¿˜æ˜¯æ¯”è¾ƒé—²çš„ï¼ŒåŸºæœ¬å°±æ˜¯çœ‹çœ‹ç½‘è¯¾ï¼Œåšç¬”è¯•ã€é¢è¯•ã€‚ä¸‹å›¾å’Œæœ‹å‹å‡ºå»åƒé¥­é€›è¡—ï¼Œçœ‹ä¸­äº†ä¸€ä»¶å¤–å¥—ã€‚\n\n![9](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/9.JPG)\n\n### 10æœˆ\n\n10 æœˆå»å‚åŠ äº†è¡¨å¼Ÿçš„å©šç¤¼ï¼Œ4 ä¸ªä¼´éƒ+æ–°éƒçš„è‡ªæ‹ï¼Œå°å¸…ã€‚\n\n![10](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/10.JPG)\n\n### 11æœˆ\n\nå®¿èˆå¸ˆå¼Ÿè¿‡ç”Ÿæ—¥ä¸€èµ·å»æµ·åº•æå¹²é¥­ï¼Œå¤´ä¸€å›ä½“éªŒä¸‹æµ·åº•æçš„å…è´¹æ‰‹éƒ¨æŠ¤ç†ã€‚\n\n![11](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/11.JPG)\n\n### 12æœˆ\n\nå›è€å®¶è¿‡ç”Ÿæ—¥å¤§å§¨å¦ˆç»™ä¹°çš„è›‹ç³•ï¼Œå“ˆå“ˆå“ˆï¼Œå¿«ä¹ã€‚\n\n![12](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/12.jpg)\n","slug":"12å¼ å›¾å›å¿†æˆ‘çš„2022","published":1,"updated":"2023-01-26T12:35:58.970Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cldzfw31p0001t9t8bfgybk9z","content":"<p>2022 å¹´è½¬ç¬å³é€ï¼Œæˆ‘ä»æ‰‹æœºç›¸å†Œä¸­æ¯ä¸ªæœˆåˆ†åˆ«æŒ‘å‡ºä¸€å¼ ç…§ç‰‡ï¼Œåœ¨æ­¤ç»™æˆ‘çš„ 2022 ç•™ä¸ªå›å¿†ã€‚</p>\n<span id=\"more\"></span>\n\n<h3 id=\"1æœˆ\"><a href=\"#1æœˆ\" class=\"headerlink\" title=\"1æœˆ\"></a>1æœˆ</h3><p>è¿™å¼ ç…§ç‰‡æˆ‘è®°å¾—æ˜¯ä¸€æœˆä»½çš„æŸä¸€å¤©ï¼Œå’Œ lbh å»å­¦æ ¡å—é—¨åƒå®Œæ™šé¥­å›å­¦æ ¡æ‹çš„ï¼Œè®°å¾—æ™šé¥­åƒçš„è¿˜æ˜¯â€œè¥¿å®‰è°ƒè°ƒâ€ï¼Œè‡Šå­é¢åƒçš„å¾ˆè¿‡ç˜¾ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/1.JPG\" alt=\"1\"></p>\n<h3 id=\"2æœˆ\"><a href=\"#2æœˆ\" class=\"headerlink\" title=\"2æœˆ\"></a>2æœˆ</h3><p>2 æœˆçš„ç¬¬ä¸€å¤©å°±æ˜¯å¤§å¹´åˆä¸€è¿‡æ–°å¹´ï¼Œæ—©ä¸Šæ—©èµ·åœ¨å®¶é—¨å£æ”¾çˆ†ç«¹ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/2.jpg\" alt=\"2\"></p>\n<h3 id=\"3æœˆ\"><a href=\"#3æœˆ\" class=\"headerlink\" title=\"3æœˆ\"></a>3æœˆ</h3><p>3 æœˆåŸºæœ¬å°±æ˜¯åœ¨å®¶åˆ·é¢˜ã€èƒŒå…«è‚¡ï¼ŒæŠ•é€’å®ä¹ ï¼Œå®ä¹ é¢è¯•ã€‚æ¯å¤©æ—©ä¸Šç…®ä¸¤ä¸ªç™½ç…®è›‹åƒã€‚è¿™æ˜¯æŸå¤©è§‰å¾—è‡ªå·±ç…®çš„å¥½çœ‹åˆå¥½åƒé‚è®°å½•ä¸‹ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/3.JPG\" alt=\"3\"></p>\n<h3 id=\"4æœˆ\"><a href=\"#4æœˆ\" class=\"headerlink\" title=\"4æœˆ\"></a>4æœˆ</h3><p>4 æœˆæ”¶åˆ°å­—èŠ‚è·³åŠ¨çš„å®ä¹  offer å•¦ï¼Œæœˆåº•æ­£å¼å…¥èŒï¼Œæ”¶åˆ°å¯„æ¥çš„ç”µè„‘ï¼Œç–«æƒ…åŸå› å±…å®¶åŠå…¬äº†å‡ å‘¨ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/4.jpg\" alt=\"4\"></p>\n<h3 id=\"5æœˆ\"><a href=\"#5æœˆ\" class=\"headerlink\" title=\"5æœˆ\"></a>5æœˆ</h3><p>5 æœˆåˆ°æ­å·çº¿ä¸‹å®ä¹ å•¦ï¼Œä¸­é—´æœ‰æœ‹å‹æ¥ç©ï¼Œä¸€èµ·å»çš„è¥¿æ¹–ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/2205.jpg\" alt=\"2205\"></p>\n<h3 id=\"6æœˆ\"><a href=\"#6æœˆ\" class=\"headerlink\" title=\"6æœˆ\"></a>6æœˆ</h3><p>è¿™æ˜¯å…¬å¸æ—è¾¹ä¸€æ ‹è®¾è®¡é™¢çš„æ¥¼ï¼Œå½“æ—¶è²Œä¼¼æ˜¯å‘¨äº”æ™šä¸Šï¼Œæå‰æºœï¼Œå½“æ—¶è§‰å¾—é…ä¸Šæ¹›è“çš„å¤©ç©ºå¾ˆå¥½çœ‹ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/6.JPG\" alt=\"6\"></p>\n<h3 id=\"7æœˆ\"><a href=\"#7æœˆ\" class=\"headerlink\" title=\"7æœˆ\"></a>7æœˆ</h3><p>7 æœˆå’Œé«˜ä¸­è€åŒå­¦ä¸€èµ·çº¦äº†ä¸ªé¥­ï¼Œé€›äº†é€›è¥¿æ¹–ï¼Œ7 æœˆçš„è·èŠ±å¼€çš„å¾ˆèŒ‚ç››ï¼Œè¥¿æ¹–æ—å…¨æ˜¯äººã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/7.JPG\" alt=\"7\"></p>\n<h3 id=\"8æœˆ\"><a href=\"#8æœˆ\" class=\"headerlink\" title=\"8æœˆ\"></a>8æœˆ</h3><p>8 æœˆç¦»èŒå‰ç…äº†ä¸€çœ¼ä»£ç é‡ï¼Œå¦‚ä¸‹æ˜¯ 4 ä¸ªæœˆçš„æˆæœï¼Œæ„Ÿè§‰è¿˜å¯ä»¥ï¼Œæ²¡æœ‰å¾ˆæ°´ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/8.jpg\" alt=\"8\"></p>\n<h3 id=\"9æœˆ\"><a href=\"#9æœˆ\" class=\"headerlink\" title=\"9æœˆ\"></a>9æœˆ</h3><p>9 æœˆå›æ ¡è¿˜æ˜¯æ¯”è¾ƒé—²çš„ï¼ŒåŸºæœ¬å°±æ˜¯çœ‹çœ‹ç½‘è¯¾ï¼Œåšç¬”è¯•ã€é¢è¯•ã€‚ä¸‹å›¾å’Œæœ‹å‹å‡ºå»åƒé¥­é€›è¡—ï¼Œçœ‹ä¸­äº†ä¸€ä»¶å¤–å¥—ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/9.JPG\" alt=\"9\"></p>\n<h3 id=\"10æœˆ\"><a href=\"#10æœˆ\" class=\"headerlink\" title=\"10æœˆ\"></a>10æœˆ</h3><p>10 æœˆå»å‚åŠ äº†è¡¨å¼Ÿçš„å©šç¤¼ï¼Œ4 ä¸ªä¼´éƒ+æ–°éƒçš„è‡ªæ‹ï¼Œå°å¸…ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/10.JPG\" alt=\"10\"></p>\n<h3 id=\"11æœˆ\"><a href=\"#11æœˆ\" class=\"headerlink\" title=\"11æœˆ\"></a>11æœˆ</h3><p>å®¿èˆå¸ˆå¼Ÿè¿‡ç”Ÿæ—¥ä¸€èµ·å»æµ·åº•æå¹²é¥­ï¼Œå¤´ä¸€å›ä½“éªŒä¸‹æµ·åº•æçš„å…è´¹æ‰‹éƒ¨æŠ¤ç†ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/11.JPG\" alt=\"11\"></p>\n<h3 id=\"12æœˆ\"><a href=\"#12æœˆ\" class=\"headerlink\" title=\"12æœˆ\"></a>12æœˆ</h3><p>å›è€å®¶è¿‡ç”Ÿæ—¥å¤§å§¨å¦ˆç»™ä¹°çš„è›‹ç³•ï¼Œå“ˆå“ˆå“ˆï¼Œå¿«ä¹ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/12.jpg\" alt=\"12\"></p>\n","site":{"data":{}},"length":530,"excerpt":"<p>2022 å¹´è½¬ç¬å³é€ï¼Œæˆ‘ä»æ‰‹æœºç›¸å†Œä¸­æ¯ä¸ªæœˆåˆ†åˆ«æŒ‘å‡ºä¸€å¼ ç…§ç‰‡ï¼Œåœ¨æ­¤ç»™æˆ‘çš„ 2022 ç•™ä¸ªå›å¿†ã€‚</p>","more":"<h3 id=\"1æœˆ\"><a href=\"#1æœˆ\" class=\"headerlink\" title=\"1æœˆ\"></a>1æœˆ</h3><p>è¿™å¼ ç…§ç‰‡æˆ‘è®°å¾—æ˜¯ä¸€æœˆä»½çš„æŸä¸€å¤©ï¼Œå’Œ lbh å»å­¦æ ¡å—é—¨åƒå®Œæ™šé¥­å›å­¦æ ¡æ‹çš„ï¼Œè®°å¾—æ™šé¥­åƒçš„è¿˜æ˜¯â€œè¥¿å®‰è°ƒè°ƒâ€ï¼Œè‡Šå­é¢åƒçš„å¾ˆè¿‡ç˜¾ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/1.JPG\" alt=\"1\"></p>\n<h3 id=\"2æœˆ\"><a href=\"#2æœˆ\" class=\"headerlink\" title=\"2æœˆ\"></a>2æœˆ</h3><p>2 æœˆçš„ç¬¬ä¸€å¤©å°±æ˜¯å¤§å¹´åˆä¸€è¿‡æ–°å¹´ï¼Œæ—©ä¸Šæ—©èµ·åœ¨å®¶é—¨å£æ”¾çˆ†ç«¹ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/2.jpg\" alt=\"2\"></p>\n<h3 id=\"3æœˆ\"><a href=\"#3æœˆ\" class=\"headerlink\" title=\"3æœˆ\"></a>3æœˆ</h3><p>3 æœˆåŸºæœ¬å°±æ˜¯åœ¨å®¶åˆ·é¢˜ã€èƒŒå…«è‚¡ï¼ŒæŠ•é€’å®ä¹ ï¼Œå®ä¹ é¢è¯•ã€‚æ¯å¤©æ—©ä¸Šç…®ä¸¤ä¸ªç™½ç…®è›‹åƒã€‚è¿™æ˜¯æŸå¤©è§‰å¾—è‡ªå·±ç…®çš„å¥½çœ‹åˆå¥½åƒé‚è®°å½•ä¸‹ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/3.JPG\" alt=\"3\"></p>\n<h3 id=\"4æœˆ\"><a href=\"#4æœˆ\" class=\"headerlink\" title=\"4æœˆ\"></a>4æœˆ</h3><p>4 æœˆæ”¶åˆ°å­—èŠ‚è·³åŠ¨çš„å®ä¹  offer å•¦ï¼Œæœˆåº•æ­£å¼å…¥èŒï¼Œæ”¶åˆ°å¯„æ¥çš„ç”µè„‘ï¼Œç–«æƒ…åŸå› å±…å®¶åŠå…¬äº†å‡ å‘¨ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/4.jpg\" alt=\"4\"></p>\n<h3 id=\"5æœˆ\"><a href=\"#5æœˆ\" class=\"headerlink\" title=\"5æœˆ\"></a>5æœˆ</h3><p>5 æœˆåˆ°æ­å·çº¿ä¸‹å®ä¹ å•¦ï¼Œä¸­é—´æœ‰æœ‹å‹æ¥ç©ï¼Œä¸€èµ·å»çš„è¥¿æ¹–ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/2205.jpg\" alt=\"2205\"></p>\n<h3 id=\"6æœˆ\"><a href=\"#6æœˆ\" class=\"headerlink\" title=\"6æœˆ\"></a>6æœˆ</h3><p>è¿™æ˜¯å…¬å¸æ—è¾¹ä¸€æ ‹è®¾è®¡é™¢çš„æ¥¼ï¼Œå½“æ—¶è²Œä¼¼æ˜¯å‘¨äº”æ™šä¸Šï¼Œæå‰æºœï¼Œå½“æ—¶è§‰å¾—é…ä¸Šæ¹›è“çš„å¤©ç©ºå¾ˆå¥½çœ‹ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/6.JPG\" alt=\"6\"></p>\n<h3 id=\"7æœˆ\"><a href=\"#7æœˆ\" class=\"headerlink\" title=\"7æœˆ\"></a>7æœˆ</h3><p>7 æœˆå’Œé«˜ä¸­è€åŒå­¦ä¸€èµ·çº¦äº†ä¸ªé¥­ï¼Œé€›äº†é€›è¥¿æ¹–ï¼Œ7 æœˆçš„è·èŠ±å¼€çš„å¾ˆèŒ‚ç››ï¼Œè¥¿æ¹–æ—å…¨æ˜¯äººã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/7.JPG\" alt=\"7\"></p>\n<h3 id=\"8æœˆ\"><a href=\"#8æœˆ\" class=\"headerlink\" title=\"8æœˆ\"></a>8æœˆ</h3><p>8 æœˆç¦»èŒå‰ç…äº†ä¸€çœ¼ä»£ç é‡ï¼Œå¦‚ä¸‹æ˜¯ 4 ä¸ªæœˆçš„æˆæœï¼Œæ„Ÿè§‰è¿˜å¯ä»¥ï¼Œæ²¡æœ‰å¾ˆæ°´ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/8.jpg\" alt=\"8\"></p>\n<h3 id=\"9æœˆ\"><a href=\"#9æœˆ\" class=\"headerlink\" title=\"9æœˆ\"></a>9æœˆ</h3><p>9 æœˆå›æ ¡è¿˜æ˜¯æ¯”è¾ƒé—²çš„ï¼ŒåŸºæœ¬å°±æ˜¯çœ‹çœ‹ç½‘è¯¾ï¼Œåšç¬”è¯•ã€é¢è¯•ã€‚ä¸‹å›¾å’Œæœ‹å‹å‡ºå»åƒé¥­é€›è¡—ï¼Œçœ‹ä¸­äº†ä¸€ä»¶å¤–å¥—ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/9.JPG\" alt=\"9\"></p>\n<h3 id=\"10æœˆ\"><a href=\"#10æœˆ\" class=\"headerlink\" title=\"10æœˆ\"></a>10æœˆ</h3><p>10 æœˆå»å‚åŠ äº†è¡¨å¼Ÿçš„å©šç¤¼ï¼Œ4 ä¸ªä¼´éƒ+æ–°éƒçš„è‡ªæ‹ï¼Œå°å¸…ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/10.JPG\" alt=\"10\"></p>\n<h3 id=\"11æœˆ\"><a href=\"#11æœˆ\" class=\"headerlink\" title=\"11æœˆ\"></a>11æœˆ</h3><p>å®¿èˆå¸ˆå¼Ÿè¿‡ç”Ÿæ—¥ä¸€èµ·å»æµ·åº•æå¹²é¥­ï¼Œå¤´ä¸€å›ä½“éªŒä¸‹æµ·åº•æçš„å…è´¹æ‰‹éƒ¨æŠ¤ç†ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/11.JPG\" alt=\"11\"></p>\n<h3 id=\"12æœˆ\"><a href=\"#12æœˆ\" class=\"headerlink\" title=\"12æœˆ\"></a>12æœˆ</h3><p>å›è€å®¶è¿‡ç”Ÿæ—¥å¤§å§¨å¦ˆç»™ä¹°çš„è›‹ç³•ï¼Œå“ˆå“ˆå“ˆï¼Œå¿«ä¹ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/12.jpg\" alt=\"12\"></p>"},{"title":"2022å®ä¹ æ€»ç»“","date":"2022-12-12T02:40:27.000Z","urlname":"2022-internship-summary","description":null,"copyright":true,"mathjax":true,"_content":"\n> å†™åœ¨å‰é¢ï¼šä½œä¸ºä¸€åç¡•è½¬ç çš„é€‰æ‰‹ï¼Œä»Šå¹´æš‘æœŸå®ä¹ è²Œä¼¼åˆæ ¼å¤–çš„éš¾ï¼Œèº«è¾¹çš„æœ‹å‹ã€è„‰è„‰ã€ç‰›å®¢ä¸Šçš„åŒå­¦éƒ½è¡¨ç¤ºä»Šå¹´å¤§ç¯å¢ƒå¾ˆå·®ï¼Œå®ä¹ å¾ˆéš¾æ‰¾ã€‚å„ä¸ªå¤§å‚ä»è£å‘˜ï¼Œ\"æ¯•ä¸šå­£\"ï¼Œåˆ°é” hcã€åœæ­¢æµç¨‹ã€ç”šè‡³ä¸»åŠ¨æ¯çº¦å·²ç­¾çš„ offerï¼Œæ— ä¸è¡¨ç°å‡ºä»Šå¹´å¤§ç¯å¢ƒæœ‰å¤šå·®ã€‚ä»¥ä¸‹æ˜¯æœ¬äººäºŒæœˆåº•ä»¥æ¥æ‰¾åç«¯å¼€å‘å²—çš„æš‘æœŸå®ä¹ å¯¹å„ä¸ªå…¬å¸é¢è¯•æµç¨‹ä¸€ä¸ªå¤§æ¦‚çš„å›é¡¾å’Œæ€»ç»“ã€‚\n\n<!-- more -->\n\n## å·²é¢è¯•\n\n### å¾®è½¯\n\n3.7 ä¸€é¢ â†’  3.10 ï¼ˆä¸€äºŒé¢å¹³è¡Œé¢ï¼Œä¸€é¢è¿‡ç›´è¾¾ç»ˆé¢ï¼‰ â†’ 3.16 æŒ‚ \n\n* å¾®è½¯å¾ˆçœ‹é‡ç®—æ³•ï¼Œå…¨ç¨‹æ— å…«è‚¡ï¼Œåšé¢˜æ—¶æ²¡æœ‰æ€è·¯å¯ä»¥å’Œé¢è¯•å®˜æ²Ÿé€šï¼Œä¸è¦è‡ªå·±ä¸€ä¸ªäººç¡¬æƒ³ï¼Œå¾®è½¯å¾ˆçœ‹é‡æ²Ÿé€šèƒ½åŠ›ã€‚\n* å°½é‡æ—©æŠ•ï¼Œå¾®è½¯ä»Šå¹´æš‘æœŸå®ä¹ æå‰æ‰¹å·®ä¸å¤šå»å¹´ 12 æœˆå°±å¼€å§‹äº†ï¼Œèº«è¾¹æœ‰æœ‹å‹æå‰æ‰¹è¿›çš„ï¼Œç›¸è¾ƒäºæ­£å¼æ‰¹è€Œè¨€éš¾åº¦æ„Ÿè§‰ä¹Ÿæ²¡æœ‰æ›´å¤§ï¼Œè€Œä¸”å…¶å®åˆ°äº†æ­£å¼æ‰¹å‰©ä½™çš„ hc å°±ä¸å¤šäº†ã€‚æœ‰æœ‹å‹æŠ•ç®€å†æœ‰ç‚¹æ™šè¿é¢è¯•éƒ½æ²¡æœ‰å®‰æ’åˆ°ã€‚\n\n### ç¾å›¢\n\n3.12 ç¬”è¯•ï¼ˆ3.18 / 5ï¼‰ â†’  3.18 ä¸€é¢ â†’  3.18 æŒ‚\n\né¢è¯•ä½“éªŒå¾ˆä¸å¥½ï¼ˆå½“ç„¶è‡ªå·±é¢çš„ä¹Ÿä¸å¥½ï¼‰ï¼Œåç»­è„‰è„‰ç‰›å®¢ä¸Šçœ‹åˆ°è¿™ä¸ªéƒ¨é—¨è²Œä¼¼ä¸€é¢æŒ‚äº†ä¸å°‘äººä¸ä¹é¡¶çº§ 985ã€‚\n\n### å­—èŠ‚\n\n3.22 ä¸€é¢ â†’  3.23 äºŒé¢ â†’  3.29 ä¸‰é¢ â†’  4.2 offer å®¡æ‰¹ â†’  4.11 offer é‚®ä»¶\n\n* å­—èŠ‚æ¯”è¾ƒçœ‹é‡åŸºç¡€å’Œç®—æ³•ï¼Œé¢˜è‡³å°‘è¦æœ‰æ€è·¯å’Œé¢è¯•å®˜æ²Ÿé€šï¼Œæœ€å¥½åšå‡ºæ¥ã€‚\n* æµç¨‹å¾ˆå¿«ï¼Œä¸€é¢äºŒé¢éƒ½æ˜¯å½“å¤©æ™šä¸Šç›´æ¥é€šçŸ¥é€šè¿‡ï¼Œä¸‰é¢è¿‡åå¥½å‡ å¤©ç­‰åˆ° HR ç”µè¯ï¼Œç„¶å offer å®¡æ‰¹è·¨äº†æ¸…æ˜èŠ‚ï¼Œç„¶ååˆè¿‡äº†ä¸€ä¸ªå‘¨æœ«ï¼Œè›®ç—›è‹¦çš„ã€‚\n* ç»¼åˆè€Œè¨€ï¼Œå­—èŠ‚çš„é¢è¯•ä½“éªŒå¾ˆå¥½ï¼Œé¢è¯•å®˜ä¼šå¼•å¯¼ä½ å»è¯´ï¼ŒåŒ…æ‹¬ä¸€äº›å…«è‚¡ã€åœºæ™¯é¢˜ã€‚\n\n### æºç¨‹\n\n3.24 ç¬”è¯•ï¼ˆ2.7 / 4ï¼‰ â†’  3.31 ä¸€é¢ â†’  4.13 çº¦äº†äºŒé¢ï¼ˆèººå¹³ä¸é¢äº†ï¼‰\n\næºç¨‹ä¸€é¢é—®çš„æ¯”è¾ƒåŸºç¡€ï¼Œç®—æ³•ä¹Ÿæ¯”è¾ƒç®€å•ã€‚\n\n### é˜¿é‡Œ\n\n3.24 åˆé¢ â†’  3.25 ç¬”è¯•ï¼ˆæƒ¨ï¼‰ â†’  4.7 äºŒé¢ â†’  4.11 è¡¥ç¬”è¯•\n\né˜¿é‡Œä¸€é¢çœ‹åŸºç¡€ï¼ŒäºŒé¢çœ‹é¡¹ç›®ï¼Œé¡¹ç›®ä¸å¤ªç†Ÿæ‚‰äº†ï¼Œè¢«æ‹·æ‰“çƒ‚äº†ã€‚\næ›´æ–°ï¼š4.11 æ™šä¸Šä¸´æ—¶çº¦åšé¢˜ï¼Œä¸¤é“ï¼Œä¸€é“å¤šçº¿ç¨‹æ‰“å°æ•°æ®é—®é¢˜ã€ä¸€é“é«˜å¹¶å‘è½¬è´¦æ¥å£è®¾è®¡é—®é¢˜\n\n\n### æ’ç”Ÿ\n\n3.31 ç¬”è¯•ï¼ˆæ— éš¾åº¦ï¼‰ â†’ 4.6 ä¸€é¢ â†’ 4.11 æŸ¥çœ‹ å·²ç»“æŸ â†’ 4.12 HR ç”µè¯\n\né—®çš„åä¸šåŠ¡ï¼Œè²Œä¼¼ä¸€é¢è¿‡äº†ï¼Œæ‹¿äº†å­—èŠ‚ offer å°±æ‹’äº†ã€‚\n\n## å·²ç¬”è¯•\n\n* 360 3.19 ç¬”è¯•ï¼ˆ1.9 / 2ï¼‰ \n\n* è´å£³ 3.21 ç¬”è¯•ï¼ˆ1.6 / 3ï¼‰\n\n* ç½‘æ˜“é›·ç« 3.26 ç¬”è¯•ï¼ˆ1.5 / 2ï¼‰\n\n* ç½‘æ˜“äº’è”ç½‘ 3.27 ç¬”è¯•ï¼ˆAKï¼‰ â†’ 4.2 æŸ¥çœ‹ ç¬”è¯•æœªé€šè¿‡ï¼ˆä»Šå¹´è²Œä¼¼å¾ˆå¤š AK çš„åŒå­¦è¢«ç¬”è¯•æŒ‚çš„ï¼ŒæŒºè¿·ï¼‰\n\n* ä¾¿åˆ©èœ‚ 3.31 ç¬”è¯•ï¼ˆæƒ¨ï¼‰\n\n* äº¬ä¸œ 4.2 ç¬”è¯•ï¼ˆ0.7 / 2ï¼‰\n\n* ç™¾åº¦ 4.12 ç¬”è¯• ç»ˆæ­¢æµç¨‹\n\n## å·²æŠ•é€’ç®€å†æŒ‚\n\nOPPOã€ç½‘æ˜“äº’å¨±\n\n## å·²æŠ•é€’æ— åç»­\n\né¡ºä¸°ã€58 åŒåŸã€è”æƒ³ã€è¶‹åŠ¿ç§‘æŠ€\n","source":"_posts/2022å®ä¹ æ€»ç»“.md","raw":"---\ntitle: 2022å®ä¹ æ€»ç»“\ndate: 2022-12-12 10:40:27\ncategories: \n  - å®ä¹ ç§‹æ‹›\n  - å®ä¹ \ntags: \nurlname: 2022-internship-summary\ndescription: \ncopyright: true\nmathjax: true\n---\n\n> å†™åœ¨å‰é¢ï¼šä½œä¸ºä¸€åç¡•è½¬ç çš„é€‰æ‰‹ï¼Œä»Šå¹´æš‘æœŸå®ä¹ è²Œä¼¼åˆæ ¼å¤–çš„éš¾ï¼Œèº«è¾¹çš„æœ‹å‹ã€è„‰è„‰ã€ç‰›å®¢ä¸Šçš„åŒå­¦éƒ½è¡¨ç¤ºä»Šå¹´å¤§ç¯å¢ƒå¾ˆå·®ï¼Œå®ä¹ å¾ˆéš¾æ‰¾ã€‚å„ä¸ªå¤§å‚ä»è£å‘˜ï¼Œ\"æ¯•ä¸šå­£\"ï¼Œåˆ°é” hcã€åœæ­¢æµç¨‹ã€ç”šè‡³ä¸»åŠ¨æ¯çº¦å·²ç­¾çš„ offerï¼Œæ— ä¸è¡¨ç°å‡ºä»Šå¹´å¤§ç¯å¢ƒæœ‰å¤šå·®ã€‚ä»¥ä¸‹æ˜¯æœ¬äººäºŒæœˆåº•ä»¥æ¥æ‰¾åç«¯å¼€å‘å²—çš„æš‘æœŸå®ä¹ å¯¹å„ä¸ªå…¬å¸é¢è¯•æµç¨‹ä¸€ä¸ªå¤§æ¦‚çš„å›é¡¾å’Œæ€»ç»“ã€‚\n\n<!-- more -->\n\n## å·²é¢è¯•\n\n### å¾®è½¯\n\n3.7 ä¸€é¢ â†’  3.10 ï¼ˆä¸€äºŒé¢å¹³è¡Œé¢ï¼Œä¸€é¢è¿‡ç›´è¾¾ç»ˆé¢ï¼‰ â†’ 3.16 æŒ‚ \n\n* å¾®è½¯å¾ˆçœ‹é‡ç®—æ³•ï¼Œå…¨ç¨‹æ— å…«è‚¡ï¼Œåšé¢˜æ—¶æ²¡æœ‰æ€è·¯å¯ä»¥å’Œé¢è¯•å®˜æ²Ÿé€šï¼Œä¸è¦è‡ªå·±ä¸€ä¸ªäººç¡¬æƒ³ï¼Œå¾®è½¯å¾ˆçœ‹é‡æ²Ÿé€šèƒ½åŠ›ã€‚\n* å°½é‡æ—©æŠ•ï¼Œå¾®è½¯ä»Šå¹´æš‘æœŸå®ä¹ æå‰æ‰¹å·®ä¸å¤šå»å¹´ 12 æœˆå°±å¼€å§‹äº†ï¼Œèº«è¾¹æœ‰æœ‹å‹æå‰æ‰¹è¿›çš„ï¼Œç›¸è¾ƒäºæ­£å¼æ‰¹è€Œè¨€éš¾åº¦æ„Ÿè§‰ä¹Ÿæ²¡æœ‰æ›´å¤§ï¼Œè€Œä¸”å…¶å®åˆ°äº†æ­£å¼æ‰¹å‰©ä½™çš„ hc å°±ä¸å¤šäº†ã€‚æœ‰æœ‹å‹æŠ•ç®€å†æœ‰ç‚¹æ™šè¿é¢è¯•éƒ½æ²¡æœ‰å®‰æ’åˆ°ã€‚\n\n### ç¾å›¢\n\n3.12 ç¬”è¯•ï¼ˆ3.18 / 5ï¼‰ â†’  3.18 ä¸€é¢ â†’  3.18 æŒ‚\n\né¢è¯•ä½“éªŒå¾ˆä¸å¥½ï¼ˆå½“ç„¶è‡ªå·±é¢çš„ä¹Ÿä¸å¥½ï¼‰ï¼Œåç»­è„‰è„‰ç‰›å®¢ä¸Šçœ‹åˆ°è¿™ä¸ªéƒ¨é—¨è²Œä¼¼ä¸€é¢æŒ‚äº†ä¸å°‘äººä¸ä¹é¡¶çº§ 985ã€‚\n\n### å­—èŠ‚\n\n3.22 ä¸€é¢ â†’  3.23 äºŒé¢ â†’  3.29 ä¸‰é¢ â†’  4.2 offer å®¡æ‰¹ â†’  4.11 offer é‚®ä»¶\n\n* å­—èŠ‚æ¯”è¾ƒçœ‹é‡åŸºç¡€å’Œç®—æ³•ï¼Œé¢˜è‡³å°‘è¦æœ‰æ€è·¯å’Œé¢è¯•å®˜æ²Ÿé€šï¼Œæœ€å¥½åšå‡ºæ¥ã€‚\n* æµç¨‹å¾ˆå¿«ï¼Œä¸€é¢äºŒé¢éƒ½æ˜¯å½“å¤©æ™šä¸Šç›´æ¥é€šçŸ¥é€šè¿‡ï¼Œä¸‰é¢è¿‡åå¥½å‡ å¤©ç­‰åˆ° HR ç”µè¯ï¼Œç„¶å offer å®¡æ‰¹è·¨äº†æ¸…æ˜èŠ‚ï¼Œç„¶ååˆè¿‡äº†ä¸€ä¸ªå‘¨æœ«ï¼Œè›®ç—›è‹¦çš„ã€‚\n* ç»¼åˆè€Œè¨€ï¼Œå­—èŠ‚çš„é¢è¯•ä½“éªŒå¾ˆå¥½ï¼Œé¢è¯•å®˜ä¼šå¼•å¯¼ä½ å»è¯´ï¼ŒåŒ…æ‹¬ä¸€äº›å…«è‚¡ã€åœºæ™¯é¢˜ã€‚\n\n### æºç¨‹\n\n3.24 ç¬”è¯•ï¼ˆ2.7 / 4ï¼‰ â†’  3.31 ä¸€é¢ â†’  4.13 çº¦äº†äºŒé¢ï¼ˆèººå¹³ä¸é¢äº†ï¼‰\n\næºç¨‹ä¸€é¢é—®çš„æ¯”è¾ƒåŸºç¡€ï¼Œç®—æ³•ä¹Ÿæ¯”è¾ƒç®€å•ã€‚\n\n### é˜¿é‡Œ\n\n3.24 åˆé¢ â†’  3.25 ç¬”è¯•ï¼ˆæƒ¨ï¼‰ â†’  4.7 äºŒé¢ â†’  4.11 è¡¥ç¬”è¯•\n\né˜¿é‡Œä¸€é¢çœ‹åŸºç¡€ï¼ŒäºŒé¢çœ‹é¡¹ç›®ï¼Œé¡¹ç›®ä¸å¤ªç†Ÿæ‚‰äº†ï¼Œè¢«æ‹·æ‰“çƒ‚äº†ã€‚\næ›´æ–°ï¼š4.11 æ™šä¸Šä¸´æ—¶çº¦åšé¢˜ï¼Œä¸¤é“ï¼Œä¸€é“å¤šçº¿ç¨‹æ‰“å°æ•°æ®é—®é¢˜ã€ä¸€é“é«˜å¹¶å‘è½¬è´¦æ¥å£è®¾è®¡é—®é¢˜\n\n\n### æ’ç”Ÿ\n\n3.31 ç¬”è¯•ï¼ˆæ— éš¾åº¦ï¼‰ â†’ 4.6 ä¸€é¢ â†’ 4.11 æŸ¥çœ‹ å·²ç»“æŸ â†’ 4.12 HR ç”µè¯\n\né—®çš„åä¸šåŠ¡ï¼Œè²Œä¼¼ä¸€é¢è¿‡äº†ï¼Œæ‹¿äº†å­—èŠ‚ offer å°±æ‹’äº†ã€‚\n\n## å·²ç¬”è¯•\n\n* 360 3.19 ç¬”è¯•ï¼ˆ1.9 / 2ï¼‰ \n\n* è´å£³ 3.21 ç¬”è¯•ï¼ˆ1.6 / 3ï¼‰\n\n* ç½‘æ˜“é›·ç« 3.26 ç¬”è¯•ï¼ˆ1.5 / 2ï¼‰\n\n* ç½‘æ˜“äº’è”ç½‘ 3.27 ç¬”è¯•ï¼ˆAKï¼‰ â†’ 4.2 æŸ¥çœ‹ ç¬”è¯•æœªé€šè¿‡ï¼ˆä»Šå¹´è²Œä¼¼å¾ˆå¤š AK çš„åŒå­¦è¢«ç¬”è¯•æŒ‚çš„ï¼ŒæŒºè¿·ï¼‰\n\n* ä¾¿åˆ©èœ‚ 3.31 ç¬”è¯•ï¼ˆæƒ¨ï¼‰\n\n* äº¬ä¸œ 4.2 ç¬”è¯•ï¼ˆ0.7 / 2ï¼‰\n\n* ç™¾åº¦ 4.12 ç¬”è¯• ç»ˆæ­¢æµç¨‹\n\n## å·²æŠ•é€’ç®€å†æŒ‚\n\nOPPOã€ç½‘æ˜“äº’å¨±\n\n## å·²æŠ•é€’æ— åç»­\n\né¡ºä¸°ã€58 åŒåŸã€è”æƒ³ã€è¶‹åŠ¿ç§‘æŠ€\n","slug":"2022å®ä¹ æ€»ç»“","published":1,"updated":"2023-01-26T12:35:58.970Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cldzfw31s0003t9t865h262z4","content":"<blockquote>\n<p>å†™åœ¨å‰é¢ï¼šä½œä¸ºä¸€åç¡•è½¬ç çš„é€‰æ‰‹ï¼Œä»Šå¹´æš‘æœŸå®ä¹ è²Œä¼¼åˆæ ¼å¤–çš„éš¾ï¼Œèº«è¾¹çš„æœ‹å‹ã€è„‰è„‰ã€ç‰›å®¢ä¸Šçš„åŒå­¦éƒ½è¡¨ç¤ºä»Šå¹´å¤§ç¯å¢ƒå¾ˆå·®ï¼Œå®ä¹ å¾ˆéš¾æ‰¾ã€‚å„ä¸ªå¤§å‚ä»è£å‘˜ï¼Œâ€æ¯•ä¸šå­£â€ï¼Œåˆ°é” hcã€åœæ­¢æµç¨‹ã€ç”šè‡³ä¸»åŠ¨æ¯çº¦å·²ç­¾çš„ offerï¼Œæ— ä¸è¡¨ç°å‡ºä»Šå¹´å¤§ç¯å¢ƒæœ‰å¤šå·®ã€‚ä»¥ä¸‹æ˜¯æœ¬äººäºŒæœˆåº•ä»¥æ¥æ‰¾åç«¯å¼€å‘å²—çš„æš‘æœŸå®ä¹ å¯¹å„ä¸ªå…¬å¸é¢è¯•æµç¨‹ä¸€ä¸ªå¤§æ¦‚çš„å›é¡¾å’Œæ€»ç»“ã€‚</p>\n</blockquote>\n<span id=\"more\"></span>\n\n<h2 id=\"å·²é¢è¯•\"><a href=\"#å·²é¢è¯•\" class=\"headerlink\" title=\"å·²é¢è¯•\"></a>å·²é¢è¯•</h2><h3 id=\"å¾®è½¯\"><a href=\"#å¾®è½¯\" class=\"headerlink\" title=\"å¾®è½¯\"></a>å¾®è½¯</h3><p>3.7 ä¸€é¢ â†’  3.10 ï¼ˆä¸€äºŒé¢å¹³è¡Œé¢ï¼Œä¸€é¢è¿‡ç›´è¾¾ç»ˆé¢ï¼‰ â†’ 3.16 æŒ‚ </p>\n<ul>\n<li>å¾®è½¯å¾ˆçœ‹é‡ç®—æ³•ï¼Œå…¨ç¨‹æ— å…«è‚¡ï¼Œåšé¢˜æ—¶æ²¡æœ‰æ€è·¯å¯ä»¥å’Œé¢è¯•å®˜æ²Ÿé€šï¼Œä¸è¦è‡ªå·±ä¸€ä¸ªäººç¡¬æƒ³ï¼Œå¾®è½¯å¾ˆçœ‹é‡æ²Ÿé€šèƒ½åŠ›ã€‚</li>\n<li>å°½é‡æ—©æŠ•ï¼Œå¾®è½¯ä»Šå¹´æš‘æœŸå®ä¹ æå‰æ‰¹å·®ä¸å¤šå»å¹´ 12 æœˆå°±å¼€å§‹äº†ï¼Œèº«è¾¹æœ‰æœ‹å‹æå‰æ‰¹è¿›çš„ï¼Œç›¸è¾ƒäºæ­£å¼æ‰¹è€Œè¨€éš¾åº¦æ„Ÿè§‰ä¹Ÿæ²¡æœ‰æ›´å¤§ï¼Œè€Œä¸”å…¶å®åˆ°äº†æ­£å¼æ‰¹å‰©ä½™çš„ hc å°±ä¸å¤šäº†ã€‚æœ‰æœ‹å‹æŠ•ç®€å†æœ‰ç‚¹æ™šè¿é¢è¯•éƒ½æ²¡æœ‰å®‰æ’åˆ°ã€‚</li>\n</ul>\n<h3 id=\"ç¾å›¢\"><a href=\"#ç¾å›¢\" class=\"headerlink\" title=\"ç¾å›¢\"></a>ç¾å›¢</h3><p>3.12 ç¬”è¯•ï¼ˆ3.18 / 5ï¼‰ â†’  3.18 ä¸€é¢ â†’  3.18 æŒ‚</p>\n<p>é¢è¯•ä½“éªŒå¾ˆä¸å¥½ï¼ˆå½“ç„¶è‡ªå·±é¢çš„ä¹Ÿä¸å¥½ï¼‰ï¼Œåç»­è„‰è„‰ç‰›å®¢ä¸Šçœ‹åˆ°è¿™ä¸ªéƒ¨é—¨è²Œä¼¼ä¸€é¢æŒ‚äº†ä¸å°‘äººä¸ä¹é¡¶çº§ 985ã€‚</p>\n<h3 id=\"å­—èŠ‚\"><a href=\"#å­—èŠ‚\" class=\"headerlink\" title=\"å­—èŠ‚\"></a>å­—èŠ‚</h3><p>3.22 ä¸€é¢ â†’  3.23 äºŒé¢ â†’  3.29 ä¸‰é¢ â†’  4.2 offer å®¡æ‰¹ â†’  4.11 offer é‚®ä»¶</p>\n<ul>\n<li>å­—èŠ‚æ¯”è¾ƒçœ‹é‡åŸºç¡€å’Œç®—æ³•ï¼Œé¢˜è‡³å°‘è¦æœ‰æ€è·¯å’Œé¢è¯•å®˜æ²Ÿé€šï¼Œæœ€å¥½åšå‡ºæ¥ã€‚</li>\n<li>æµç¨‹å¾ˆå¿«ï¼Œä¸€é¢äºŒé¢éƒ½æ˜¯å½“å¤©æ™šä¸Šç›´æ¥é€šçŸ¥é€šè¿‡ï¼Œä¸‰é¢è¿‡åå¥½å‡ å¤©ç­‰åˆ° HR ç”µè¯ï¼Œç„¶å offer å®¡æ‰¹è·¨äº†æ¸…æ˜èŠ‚ï¼Œç„¶ååˆè¿‡äº†ä¸€ä¸ªå‘¨æœ«ï¼Œè›®ç—›è‹¦çš„ã€‚</li>\n<li>ç»¼åˆè€Œè¨€ï¼Œå­—èŠ‚çš„é¢è¯•ä½“éªŒå¾ˆå¥½ï¼Œé¢è¯•å®˜ä¼šå¼•å¯¼ä½ å»è¯´ï¼ŒåŒ…æ‹¬ä¸€äº›å…«è‚¡ã€åœºæ™¯é¢˜ã€‚</li>\n</ul>\n<h3 id=\"æºç¨‹\"><a href=\"#æºç¨‹\" class=\"headerlink\" title=\"æºç¨‹\"></a>æºç¨‹</h3><p>3.24 ç¬”è¯•ï¼ˆ2.7 / 4ï¼‰ â†’  3.31 ä¸€é¢ â†’  4.13 çº¦äº†äºŒé¢ï¼ˆèººå¹³ä¸é¢äº†ï¼‰</p>\n<p>æºç¨‹ä¸€é¢é—®çš„æ¯”è¾ƒåŸºç¡€ï¼Œç®—æ³•ä¹Ÿæ¯”è¾ƒç®€å•ã€‚</p>\n<h3 id=\"é˜¿é‡Œ\"><a href=\"#é˜¿é‡Œ\" class=\"headerlink\" title=\"é˜¿é‡Œ\"></a>é˜¿é‡Œ</h3><p>3.24 åˆé¢ â†’  3.25 ç¬”è¯•ï¼ˆæƒ¨ï¼‰ â†’  4.7 äºŒé¢ â†’  4.11 è¡¥ç¬”è¯•</p>\n<p>é˜¿é‡Œä¸€é¢çœ‹åŸºç¡€ï¼ŒäºŒé¢çœ‹é¡¹ç›®ï¼Œé¡¹ç›®ä¸å¤ªç†Ÿæ‚‰äº†ï¼Œè¢«æ‹·æ‰“çƒ‚äº†ã€‚<br>æ›´æ–°ï¼š4.11 æ™šä¸Šä¸´æ—¶çº¦åšé¢˜ï¼Œä¸¤é“ï¼Œä¸€é“å¤šçº¿ç¨‹æ‰“å°æ•°æ®é—®é¢˜ã€ä¸€é“é«˜å¹¶å‘è½¬è´¦æ¥å£è®¾è®¡é—®é¢˜</p>\n<h3 id=\"æ’ç”Ÿ\"><a href=\"#æ’ç”Ÿ\" class=\"headerlink\" title=\"æ’ç”Ÿ\"></a>æ’ç”Ÿ</h3><p>3.31 ç¬”è¯•ï¼ˆæ— éš¾åº¦ï¼‰ â†’ 4.6 ä¸€é¢ â†’ 4.11 æŸ¥çœ‹ å·²ç»“æŸ â†’ 4.12 HR ç”µè¯</p>\n<p>é—®çš„åä¸šåŠ¡ï¼Œè²Œä¼¼ä¸€é¢è¿‡äº†ï¼Œæ‹¿äº†å­—èŠ‚ offer å°±æ‹’äº†ã€‚</p>\n<h2 id=\"å·²ç¬”è¯•\"><a href=\"#å·²ç¬”è¯•\" class=\"headerlink\" title=\"å·²ç¬”è¯•\"></a>å·²ç¬”è¯•</h2><ul>\n<li><p>360 3.19 ç¬”è¯•ï¼ˆ1.9 / 2ï¼‰ </p>\n</li>\n<li><p>è´å£³ 3.21 ç¬”è¯•ï¼ˆ1.6 / 3ï¼‰</p>\n</li>\n<li><p>ç½‘æ˜“é›·ç« 3.26 ç¬”è¯•ï¼ˆ1.5 / 2ï¼‰</p>\n</li>\n<li><p>ç½‘æ˜“äº’è”ç½‘ 3.27 ç¬”è¯•ï¼ˆAKï¼‰ â†’ 4.2 æŸ¥çœ‹ ç¬”è¯•æœªé€šè¿‡ï¼ˆä»Šå¹´è²Œä¼¼å¾ˆå¤š AK çš„åŒå­¦è¢«ç¬”è¯•æŒ‚çš„ï¼ŒæŒºè¿·ï¼‰</p>\n</li>\n<li><p>ä¾¿åˆ©èœ‚ 3.31 ç¬”è¯•ï¼ˆæƒ¨ï¼‰</p>\n</li>\n<li><p>äº¬ä¸œ 4.2 ç¬”è¯•ï¼ˆ0.7 / 2ï¼‰</p>\n</li>\n<li><p>ç™¾åº¦ 4.12 ç¬”è¯• ç»ˆæ­¢æµç¨‹</p>\n</li>\n</ul>\n<h2 id=\"å·²æŠ•é€’ç®€å†æŒ‚\"><a href=\"#å·²æŠ•é€’ç®€å†æŒ‚\" class=\"headerlink\" title=\"å·²æŠ•é€’ç®€å†æŒ‚\"></a>å·²æŠ•é€’ç®€å†æŒ‚</h2><p>OPPOã€ç½‘æ˜“äº’å¨±</p>\n<h2 id=\"å·²æŠ•é€’æ— åç»­\"><a href=\"#å·²æŠ•é€’æ— åç»­\" class=\"headerlink\" title=\"å·²æŠ•é€’æ— åç»­\"></a>å·²æŠ•é€’æ— åç»­</h2><p>é¡ºä¸°ã€58 åŒåŸã€è”æƒ³ã€è¶‹åŠ¿ç§‘æŠ€</p>\n","site":{"data":{}},"length":1022,"excerpt":"<blockquote>\n<p>å†™åœ¨å‰é¢ï¼šä½œä¸ºä¸€åç¡•è½¬ç çš„é€‰æ‰‹ï¼Œä»Šå¹´æš‘æœŸå®ä¹ è²Œä¼¼åˆæ ¼å¤–çš„éš¾ï¼Œèº«è¾¹çš„æœ‹å‹ã€è„‰è„‰ã€ç‰›å®¢ä¸Šçš„åŒå­¦éƒ½è¡¨ç¤ºä»Šå¹´å¤§ç¯å¢ƒå¾ˆå·®ï¼Œå®ä¹ å¾ˆéš¾æ‰¾ã€‚å„ä¸ªå¤§å‚ä»è£å‘˜ï¼Œâ€æ¯•ä¸šå­£â€ï¼Œåˆ°é” hcã€åœæ­¢æµç¨‹ã€ç”šè‡³ä¸»åŠ¨æ¯çº¦å·²ç­¾çš„ offerï¼Œæ— ä¸è¡¨ç°å‡ºä»Šå¹´å¤§ç¯å¢ƒæœ‰å¤šå·®ã€‚ä»¥ä¸‹æ˜¯æœ¬äººäºŒæœˆåº•ä»¥æ¥æ‰¾åç«¯å¼€å‘å²—çš„æš‘æœŸå®ä¹ å¯¹å„ä¸ªå…¬å¸é¢è¯•æµç¨‹ä¸€ä¸ªå¤§æ¦‚çš„å›é¡¾å’Œæ€»ç»“ã€‚</p>\n</blockquote>","more":"<h2 id=\"å·²é¢è¯•\"><a href=\"#å·²é¢è¯•\" class=\"headerlink\" title=\"å·²é¢è¯•\"></a>å·²é¢è¯•</h2><h3 id=\"å¾®è½¯\"><a href=\"#å¾®è½¯\" class=\"headerlink\" title=\"å¾®è½¯\"></a>å¾®è½¯</h3><p>3.7 ä¸€é¢ â†’  3.10 ï¼ˆä¸€äºŒé¢å¹³è¡Œé¢ï¼Œä¸€é¢è¿‡ç›´è¾¾ç»ˆé¢ï¼‰ â†’ 3.16 æŒ‚ </p>\n<ul>\n<li>å¾®è½¯å¾ˆçœ‹é‡ç®—æ³•ï¼Œå…¨ç¨‹æ— å…«è‚¡ï¼Œåšé¢˜æ—¶æ²¡æœ‰æ€è·¯å¯ä»¥å’Œé¢è¯•å®˜æ²Ÿé€šï¼Œä¸è¦è‡ªå·±ä¸€ä¸ªäººç¡¬æƒ³ï¼Œå¾®è½¯å¾ˆçœ‹é‡æ²Ÿé€šèƒ½åŠ›ã€‚</li>\n<li>å°½é‡æ—©æŠ•ï¼Œå¾®è½¯ä»Šå¹´æš‘æœŸå®ä¹ æå‰æ‰¹å·®ä¸å¤šå»å¹´ 12 æœˆå°±å¼€å§‹äº†ï¼Œèº«è¾¹æœ‰æœ‹å‹æå‰æ‰¹è¿›çš„ï¼Œç›¸è¾ƒäºæ­£å¼æ‰¹è€Œè¨€éš¾åº¦æ„Ÿè§‰ä¹Ÿæ²¡æœ‰æ›´å¤§ï¼Œè€Œä¸”å…¶å®åˆ°äº†æ­£å¼æ‰¹å‰©ä½™çš„ hc å°±ä¸å¤šäº†ã€‚æœ‰æœ‹å‹æŠ•ç®€å†æœ‰ç‚¹æ™šè¿é¢è¯•éƒ½æ²¡æœ‰å®‰æ’åˆ°ã€‚</li>\n</ul>\n<h3 id=\"ç¾å›¢\"><a href=\"#ç¾å›¢\" class=\"headerlink\" title=\"ç¾å›¢\"></a>ç¾å›¢</h3><p>3.12 ç¬”è¯•ï¼ˆ3.18 / 5ï¼‰ â†’  3.18 ä¸€é¢ â†’  3.18 æŒ‚</p>\n<p>é¢è¯•ä½“éªŒå¾ˆä¸å¥½ï¼ˆå½“ç„¶è‡ªå·±é¢çš„ä¹Ÿä¸å¥½ï¼‰ï¼Œåç»­è„‰è„‰ç‰›å®¢ä¸Šçœ‹åˆ°è¿™ä¸ªéƒ¨é—¨è²Œä¼¼ä¸€é¢æŒ‚äº†ä¸å°‘äººä¸ä¹é¡¶çº§ 985ã€‚</p>\n<h3 id=\"å­—èŠ‚\"><a href=\"#å­—èŠ‚\" class=\"headerlink\" title=\"å­—èŠ‚\"></a>å­—èŠ‚</h3><p>3.22 ä¸€é¢ â†’  3.23 äºŒé¢ â†’  3.29 ä¸‰é¢ â†’  4.2 offer å®¡æ‰¹ â†’  4.11 offer é‚®ä»¶</p>\n<ul>\n<li>å­—èŠ‚æ¯”è¾ƒçœ‹é‡åŸºç¡€å’Œç®—æ³•ï¼Œé¢˜è‡³å°‘è¦æœ‰æ€è·¯å’Œé¢è¯•å®˜æ²Ÿé€šï¼Œæœ€å¥½åšå‡ºæ¥ã€‚</li>\n<li>æµç¨‹å¾ˆå¿«ï¼Œä¸€é¢äºŒé¢éƒ½æ˜¯å½“å¤©æ™šä¸Šç›´æ¥é€šçŸ¥é€šè¿‡ï¼Œä¸‰é¢è¿‡åå¥½å‡ å¤©ç­‰åˆ° HR ç”µè¯ï¼Œç„¶å offer å®¡æ‰¹è·¨äº†æ¸…æ˜èŠ‚ï¼Œç„¶ååˆè¿‡äº†ä¸€ä¸ªå‘¨æœ«ï¼Œè›®ç—›è‹¦çš„ã€‚</li>\n<li>ç»¼åˆè€Œè¨€ï¼Œå­—èŠ‚çš„é¢è¯•ä½“éªŒå¾ˆå¥½ï¼Œé¢è¯•å®˜ä¼šå¼•å¯¼ä½ å»è¯´ï¼ŒåŒ…æ‹¬ä¸€äº›å…«è‚¡ã€åœºæ™¯é¢˜ã€‚</li>\n</ul>\n<h3 id=\"æºç¨‹\"><a href=\"#æºç¨‹\" class=\"headerlink\" title=\"æºç¨‹\"></a>æºç¨‹</h3><p>3.24 ç¬”è¯•ï¼ˆ2.7 / 4ï¼‰ â†’  3.31 ä¸€é¢ â†’  4.13 çº¦äº†äºŒé¢ï¼ˆèººå¹³ä¸é¢äº†ï¼‰</p>\n<p>æºç¨‹ä¸€é¢é—®çš„æ¯”è¾ƒåŸºç¡€ï¼Œç®—æ³•ä¹Ÿæ¯”è¾ƒç®€å•ã€‚</p>\n<h3 id=\"é˜¿é‡Œ\"><a href=\"#é˜¿é‡Œ\" class=\"headerlink\" title=\"é˜¿é‡Œ\"></a>é˜¿é‡Œ</h3><p>3.24 åˆé¢ â†’  3.25 ç¬”è¯•ï¼ˆæƒ¨ï¼‰ â†’  4.7 äºŒé¢ â†’  4.11 è¡¥ç¬”è¯•</p>\n<p>é˜¿é‡Œä¸€é¢çœ‹åŸºç¡€ï¼ŒäºŒé¢çœ‹é¡¹ç›®ï¼Œé¡¹ç›®ä¸å¤ªç†Ÿæ‚‰äº†ï¼Œè¢«æ‹·æ‰“çƒ‚äº†ã€‚<br>æ›´æ–°ï¼š4.11 æ™šä¸Šä¸´æ—¶çº¦åšé¢˜ï¼Œä¸¤é“ï¼Œä¸€é“å¤šçº¿ç¨‹æ‰“å°æ•°æ®é—®é¢˜ã€ä¸€é“é«˜å¹¶å‘è½¬è´¦æ¥å£è®¾è®¡é—®é¢˜</p>\n<h3 id=\"æ’ç”Ÿ\"><a href=\"#æ’ç”Ÿ\" class=\"headerlink\" title=\"æ’ç”Ÿ\"></a>æ’ç”Ÿ</h3><p>3.31 ç¬”è¯•ï¼ˆæ— éš¾åº¦ï¼‰ â†’ 4.6 ä¸€é¢ â†’ 4.11 æŸ¥çœ‹ å·²ç»“æŸ â†’ 4.12 HR ç”µè¯</p>\n<p>é—®çš„åä¸šåŠ¡ï¼Œè²Œä¼¼ä¸€é¢è¿‡äº†ï¼Œæ‹¿äº†å­—èŠ‚ offer å°±æ‹’äº†ã€‚</p>\n<h2 id=\"å·²ç¬”è¯•\"><a href=\"#å·²ç¬”è¯•\" class=\"headerlink\" title=\"å·²ç¬”è¯•\"></a>å·²ç¬”è¯•</h2><ul>\n<li><p>360 3.19 ç¬”è¯•ï¼ˆ1.9 / 2ï¼‰ </p>\n</li>\n<li><p>è´å£³ 3.21 ç¬”è¯•ï¼ˆ1.6 / 3ï¼‰</p>\n</li>\n<li><p>ç½‘æ˜“é›·ç« 3.26 ç¬”è¯•ï¼ˆ1.5 / 2ï¼‰</p>\n</li>\n<li><p>ç½‘æ˜“äº’è”ç½‘ 3.27 ç¬”è¯•ï¼ˆAKï¼‰ â†’ 4.2 æŸ¥çœ‹ ç¬”è¯•æœªé€šè¿‡ï¼ˆä»Šå¹´è²Œä¼¼å¾ˆå¤š AK çš„åŒå­¦è¢«ç¬”è¯•æŒ‚çš„ï¼ŒæŒºè¿·ï¼‰</p>\n</li>\n<li><p>ä¾¿åˆ©èœ‚ 3.31 ç¬”è¯•ï¼ˆæƒ¨ï¼‰</p>\n</li>\n<li><p>äº¬ä¸œ 4.2 ç¬”è¯•ï¼ˆ0.7 / 2ï¼‰</p>\n</li>\n<li><p>ç™¾åº¦ 4.12 ç¬”è¯• ç»ˆæ­¢æµç¨‹</p>\n</li>\n</ul>\n<h2 id=\"å·²æŠ•é€’ç®€å†æŒ‚\"><a href=\"#å·²æŠ•é€’ç®€å†æŒ‚\" class=\"headerlink\" title=\"å·²æŠ•é€’ç®€å†æŒ‚\"></a>å·²æŠ•é€’ç®€å†æŒ‚</h2><p>OPPOã€ç½‘æ˜“äº’å¨±</p>\n<h2 id=\"å·²æŠ•é€’æ— åç»­\"><a href=\"#å·²æŠ•é€’æ— åç»­\" class=\"headerlink\" title=\"å·²æŠ•é€’æ— åç»­\"></a>å·²æŠ•é€’æ— åç»­</h2><p>é¡ºä¸°ã€58 åŒåŸã€è”æƒ³ã€è¶‹åŠ¿ç§‘æŠ€</p>"},{"title":"2022ç§‹æ‹›æ€»ç»“","date":"2022-12-12T03:57:22.000Z","urlname":"2022-autumn-recruitment-summary","copyright":true,"mathjax":true,"_content":"\n19 å¹´ä¹˜ç€äººè§äººå¹çš„è®¡ç®—æœºå¤§çƒ­ï¼Œè·¨è€ƒè®¡ç®—æœºä¸€ç«™æœªæœï¼ŒäºŒæˆ˜ä¸Šå²¸æœ¬æ ¡è®¡ç®—æœºã€‚\n\nç ”äºŒæš‘æœŸç•™æ ¡ç§‘ç ”ï¼Œå¾ˆå¹¸è¿åšå‡ºæ¥ä¸¤ç¯‡æ–‡ç« ï¼Œæ¥ä¸‹æ¥å¯ä»¥å»å®ä¹ äº†ã€‚\n\nä» 12 æœˆåˆ° 2 æœˆï¼Œæ–­æ–­ç»­ç»­å¤ä¹  Java åç«¯å¼€å‘æ‰€éœ€çš„çŸ¥è¯†ã€‚\n\nä» 2 æœˆåº•æ‰¾å®ä¹ ï¼Œ4 æœˆåº•å…¥èŒå­—èŠ‚è·³åŠ¨ï¼Œ8 æœˆåº•ç¦»èŒè¿”æ ¡ï¼Œç›´åˆ° 11 æœˆåº•ï¼ˆ11.27ï¼‰æ­£å¼ç­¾è®¢ä¸‰æ–¹ï¼Œè¿‡ç¨‹åå·ï¼Œå†…å¿ƒæƒ†æ€…ã€‚\n\nç§‹æ‹›æŠ•äº†çº¦ 50 å®¶å…¬å¸ï¼Œéƒ½æ˜¯ Java åç«¯ï¼Œä¸»è¦æœ‰ä»¥ä¸‹ï¼š\n\n<!--more-->\n\nèš‚èšï¼ŒäºŒé¢æŒ‚\n\nä¸­ç§»è‹ç ”ï¼Œç¬¬äºŒæ‰¹æ¬¡ï¼Œé¢è¯•èµ°å®Œï¼Œæ²¡æœ‰æ”¶åˆ°ä½“æ£€\n\næµ™å•†é“¶è¡Œï¼Œé¢è¯•èµ°å®Œï¼Œæ²¡æœ‰ææ–™å®¡æ ¸\n\nå±±çŸ³ç½‘ç§‘ï¼Œhr é¢æŒ‚\n\nè£è€€ï¼Œé¢è¯•èµ°å®Œï¼Œå£å¤´è°ˆè–ª\n\nä¸Šæµ·é“¶è¡Œï¼Œæ€»è¡Œè‹å· baseï¼Œæ”¶åˆ° offer\n\nè‹å·å†œè¡Œï¼Œæ”¶åˆ°ä½“æ£€\n\nå­—èŠ‚è·³åŠ¨ï¼Œè½¬æ­£ offerï¼Œsp\n\næ€»ä½“è€Œè¨€ï¼Œä»Šå¹´å¼ºçš„äººè¿˜æ˜¯èƒ½æ‹¿åˆ°å¤šä¸ªå¤§å‚ offerï¼Œä½†æ˜¯å¤§å‚é—¨æ§›æ¯”å¹´é«˜äº†å¾ˆå¤šã€‚åœ¨äº’è”ç½‘é¢“åŠ¿çš„ä»Šå¹´ï¼ŒèŠ¯ç‰‡ã€åµŒå…¥å¼æˆä¸ºé¦™é¥½é¥½ï¼Œè–ªèµ„é«˜ã€å‘å±•å¥½ï¼Œä¸å°‘äººç”šè‡³ç›´å‘¼èµ¶ç´§è½¬è¡Œï¼ˆæˆ‘æœ‰æœ‹å‹åœ¨é›¶åŸºç¡€æƒ…å†µä¸‹æ‹¿äº†äº”å…­å®¶åµŒå…¥å¼ä¸­å°å‚çš„ offerï¼‰ã€‚\n\nå…³äº offer é€‰æ‹©ï¼Œæœ€ç»ˆæ˜¯è€ƒè™‘å­—èŠ‚è·³åŠ¨ base æ­å·ï¼Œè¿˜æœ‰ä¸€ä¸ªæ±Ÿè‹çœæŸåœ°çº§å¸‚ top1 é«˜ä¸­çš„ä¿¡æ¯æŠ€æœ¯è€å¸ˆï¼ˆè¿›ç¼–ï¼‰çš„ offerã€‚åœ¨è€ƒè™‘å®¶åº­æƒ…å†µã€ä¸ªäººå·åº¦æ‰¿å—åº¦ã€ç¨³å®šæ€§ï¼Œæœ€ç»ˆé€‰æ‹©äº†åšä¸€åæ•™å¸ˆã€‚\n\næœªæ¥çš„å‘å±•ï¼Œå¤§æ¦‚ç‡å°±æ˜¯åšä¸€åæ™®é€šçš„ä¿¡æ¯æŠ€æœ¯æ•™å¸ˆï¼Œæœ‰å·çš„å¿ƒè¿˜æœ‰æœºä¼šå°è¯•åŠ å…¥å­¦æ ¡å¸¦ç«èµ›çš„é˜Ÿä¼ã€‚\n\nä¸ç®¡ä»€ä¹ˆ offer é€‰æ‹©ï¼Œæœ‰å¾—å¿…å®šæœ‰å¤±ï¼Œåå…¨åç¾çš„å·¥ä½œå‡ ä¹æ²¡æœ‰ã€‚æ‰€ä»¥åœ¨è¿›è¡Œ offer é€‰æ‹©æ—¶ï¼Œå¦‚æœæ²¡æœ‰æ˜ç¡®çš„çˆ±å¥½æƒ³åšçš„å·¥ä½œçš„è¯ï¼ˆæ¯”å¦‚æˆ‘ï¼‰ï¼Œé‚£å°±å¥½å¥½ç»¼åˆè€ƒè™‘ä»¥ä¸Šå‡ ç‚¹è¿›è¡Œåˆ¤æ–­å¾—å‡ºé€‰æ‹©äº†ã€‚\n\nåšå‡ºé€‰æ‹©å°±å¥½å¥½å†²å§ï¼Œæœªæ¥å¯æœŸã€‚å¤§å®¶éƒ½æœ‰å…‰æ˜çš„æœªæ¥ï¼\n","source":"_posts/2022ç§‹æ‹›æ€»ç»“.md","raw":"---\ntitle: 2022ç§‹æ‹›æ€»ç»“\ndate: 2022-12-12 11:57:22\ncategories: \n  - å®ä¹ ç§‹æ‹›\n  - ç§‹æ‹›\ntags: \nurlname: 2022-autumn-recruitment-summary\ncopyright: true\nmathjax: true\n---\n\n19 å¹´ä¹˜ç€äººè§äººå¹çš„è®¡ç®—æœºå¤§çƒ­ï¼Œè·¨è€ƒè®¡ç®—æœºä¸€ç«™æœªæœï¼ŒäºŒæˆ˜ä¸Šå²¸æœ¬æ ¡è®¡ç®—æœºã€‚\n\nç ”äºŒæš‘æœŸç•™æ ¡ç§‘ç ”ï¼Œå¾ˆå¹¸è¿åšå‡ºæ¥ä¸¤ç¯‡æ–‡ç« ï¼Œæ¥ä¸‹æ¥å¯ä»¥å»å®ä¹ äº†ã€‚\n\nä» 12 æœˆåˆ° 2 æœˆï¼Œæ–­æ–­ç»­ç»­å¤ä¹  Java åç«¯å¼€å‘æ‰€éœ€çš„çŸ¥è¯†ã€‚\n\nä» 2 æœˆåº•æ‰¾å®ä¹ ï¼Œ4 æœˆåº•å…¥èŒå­—èŠ‚è·³åŠ¨ï¼Œ8 æœˆåº•ç¦»èŒè¿”æ ¡ï¼Œç›´åˆ° 11 æœˆåº•ï¼ˆ11.27ï¼‰æ­£å¼ç­¾è®¢ä¸‰æ–¹ï¼Œè¿‡ç¨‹åå·ï¼Œå†…å¿ƒæƒ†æ€…ã€‚\n\nç§‹æ‹›æŠ•äº†çº¦ 50 å®¶å…¬å¸ï¼Œéƒ½æ˜¯ Java åç«¯ï¼Œä¸»è¦æœ‰ä»¥ä¸‹ï¼š\n\n<!--more-->\n\nèš‚èšï¼ŒäºŒé¢æŒ‚\n\nä¸­ç§»è‹ç ”ï¼Œç¬¬äºŒæ‰¹æ¬¡ï¼Œé¢è¯•èµ°å®Œï¼Œæ²¡æœ‰æ”¶åˆ°ä½“æ£€\n\næµ™å•†é“¶è¡Œï¼Œé¢è¯•èµ°å®Œï¼Œæ²¡æœ‰ææ–™å®¡æ ¸\n\nå±±çŸ³ç½‘ç§‘ï¼Œhr é¢æŒ‚\n\nè£è€€ï¼Œé¢è¯•èµ°å®Œï¼Œå£å¤´è°ˆè–ª\n\nä¸Šæµ·é“¶è¡Œï¼Œæ€»è¡Œè‹å· baseï¼Œæ”¶åˆ° offer\n\nè‹å·å†œè¡Œï¼Œæ”¶åˆ°ä½“æ£€\n\nå­—èŠ‚è·³åŠ¨ï¼Œè½¬æ­£ offerï¼Œsp\n\næ€»ä½“è€Œè¨€ï¼Œä»Šå¹´å¼ºçš„äººè¿˜æ˜¯èƒ½æ‹¿åˆ°å¤šä¸ªå¤§å‚ offerï¼Œä½†æ˜¯å¤§å‚é—¨æ§›æ¯”å¹´é«˜äº†å¾ˆå¤šã€‚åœ¨äº’è”ç½‘é¢“åŠ¿çš„ä»Šå¹´ï¼ŒèŠ¯ç‰‡ã€åµŒå…¥å¼æˆä¸ºé¦™é¥½é¥½ï¼Œè–ªèµ„é«˜ã€å‘å±•å¥½ï¼Œä¸å°‘äººç”šè‡³ç›´å‘¼èµ¶ç´§è½¬è¡Œï¼ˆæˆ‘æœ‰æœ‹å‹åœ¨é›¶åŸºç¡€æƒ…å†µä¸‹æ‹¿äº†äº”å…­å®¶åµŒå…¥å¼ä¸­å°å‚çš„ offerï¼‰ã€‚\n\nå…³äº offer é€‰æ‹©ï¼Œæœ€ç»ˆæ˜¯è€ƒè™‘å­—èŠ‚è·³åŠ¨ base æ­å·ï¼Œè¿˜æœ‰ä¸€ä¸ªæ±Ÿè‹çœæŸåœ°çº§å¸‚ top1 é«˜ä¸­çš„ä¿¡æ¯æŠ€æœ¯è€å¸ˆï¼ˆè¿›ç¼–ï¼‰çš„ offerã€‚åœ¨è€ƒè™‘å®¶åº­æƒ…å†µã€ä¸ªäººå·åº¦æ‰¿å—åº¦ã€ç¨³å®šæ€§ï¼Œæœ€ç»ˆé€‰æ‹©äº†åšä¸€åæ•™å¸ˆã€‚\n\næœªæ¥çš„å‘å±•ï¼Œå¤§æ¦‚ç‡å°±æ˜¯åšä¸€åæ™®é€šçš„ä¿¡æ¯æŠ€æœ¯æ•™å¸ˆï¼Œæœ‰å·çš„å¿ƒè¿˜æœ‰æœºä¼šå°è¯•åŠ å…¥å­¦æ ¡å¸¦ç«èµ›çš„é˜Ÿä¼ã€‚\n\nä¸ç®¡ä»€ä¹ˆ offer é€‰æ‹©ï¼Œæœ‰å¾—å¿…å®šæœ‰å¤±ï¼Œåå…¨åç¾çš„å·¥ä½œå‡ ä¹æ²¡æœ‰ã€‚æ‰€ä»¥åœ¨è¿›è¡Œ offer é€‰æ‹©æ—¶ï¼Œå¦‚æœæ²¡æœ‰æ˜ç¡®çš„çˆ±å¥½æƒ³åšçš„å·¥ä½œçš„è¯ï¼ˆæ¯”å¦‚æˆ‘ï¼‰ï¼Œé‚£å°±å¥½å¥½ç»¼åˆè€ƒè™‘ä»¥ä¸Šå‡ ç‚¹è¿›è¡Œåˆ¤æ–­å¾—å‡ºé€‰æ‹©äº†ã€‚\n\nåšå‡ºé€‰æ‹©å°±å¥½å¥½å†²å§ï¼Œæœªæ¥å¯æœŸã€‚å¤§å®¶éƒ½æœ‰å…‰æ˜çš„æœªæ¥ï¼\n","slug":"2022ç§‹æ‹›æ€»ç»“","published":1,"updated":"2023-01-26T12:35:58.971Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cldzfw31v0006t9t88c4za2p0","content":"<p>19 å¹´ä¹˜ç€äººè§äººå¹çš„è®¡ç®—æœºå¤§çƒ­ï¼Œè·¨è€ƒè®¡ç®—æœºä¸€ç«™æœªæœï¼ŒäºŒæˆ˜ä¸Šå²¸æœ¬æ ¡è®¡ç®—æœºã€‚</p>\n<p>ç ”äºŒæš‘æœŸç•™æ ¡ç§‘ç ”ï¼Œå¾ˆå¹¸è¿åšå‡ºæ¥ä¸¤ç¯‡æ–‡ç« ï¼Œæ¥ä¸‹æ¥å¯ä»¥å»å®ä¹ äº†ã€‚</p>\n<p>ä» 12 æœˆåˆ° 2 æœˆï¼Œæ–­æ–­ç»­ç»­å¤ä¹  Java åç«¯å¼€å‘æ‰€éœ€çš„çŸ¥è¯†ã€‚</p>\n<p>ä» 2 æœˆåº•æ‰¾å®ä¹ ï¼Œ4 æœˆåº•å…¥èŒå­—èŠ‚è·³åŠ¨ï¼Œ8 æœˆåº•ç¦»èŒè¿”æ ¡ï¼Œç›´åˆ° 11 æœˆåº•ï¼ˆ11.27ï¼‰æ­£å¼ç­¾è®¢ä¸‰æ–¹ï¼Œè¿‡ç¨‹åå·ï¼Œå†…å¿ƒæƒ†æ€…ã€‚</p>\n<p>ç§‹æ‹›æŠ•äº†çº¦ 50 å®¶å…¬å¸ï¼Œéƒ½æ˜¯ Java åç«¯ï¼Œä¸»è¦æœ‰ä»¥ä¸‹ï¼š</p>\n<span id=\"more\"></span>\n\n<p>èš‚èšï¼ŒäºŒé¢æŒ‚</p>\n<p>ä¸­ç§»è‹ç ”ï¼Œç¬¬äºŒæ‰¹æ¬¡ï¼Œé¢è¯•èµ°å®Œï¼Œæ²¡æœ‰æ”¶åˆ°ä½“æ£€</p>\n<p>æµ™å•†é“¶è¡Œï¼Œé¢è¯•èµ°å®Œï¼Œæ²¡æœ‰ææ–™å®¡æ ¸</p>\n<p>å±±çŸ³ç½‘ç§‘ï¼Œhr é¢æŒ‚</p>\n<p>è£è€€ï¼Œé¢è¯•èµ°å®Œï¼Œå£å¤´è°ˆè–ª</p>\n<p>ä¸Šæµ·é“¶è¡Œï¼Œæ€»è¡Œè‹å· baseï¼Œæ”¶åˆ° offer</p>\n<p>è‹å·å†œè¡Œï¼Œæ”¶åˆ°ä½“æ£€</p>\n<p>å­—èŠ‚è·³åŠ¨ï¼Œè½¬æ­£ offerï¼Œsp</p>\n<p>æ€»ä½“è€Œè¨€ï¼Œä»Šå¹´å¼ºçš„äººè¿˜æ˜¯èƒ½æ‹¿åˆ°å¤šä¸ªå¤§å‚ offerï¼Œä½†æ˜¯å¤§å‚é—¨æ§›æ¯”å¹´é«˜äº†å¾ˆå¤šã€‚åœ¨äº’è”ç½‘é¢“åŠ¿çš„ä»Šå¹´ï¼ŒèŠ¯ç‰‡ã€åµŒå…¥å¼æˆä¸ºé¦™é¥½é¥½ï¼Œè–ªèµ„é«˜ã€å‘å±•å¥½ï¼Œä¸å°‘äººç”šè‡³ç›´å‘¼èµ¶ç´§è½¬è¡Œï¼ˆæˆ‘æœ‰æœ‹å‹åœ¨é›¶åŸºç¡€æƒ…å†µä¸‹æ‹¿äº†äº”å…­å®¶åµŒå…¥å¼ä¸­å°å‚çš„ offerï¼‰ã€‚</p>\n<p>å…³äº offer é€‰æ‹©ï¼Œæœ€ç»ˆæ˜¯è€ƒè™‘å­—èŠ‚è·³åŠ¨ base æ­å·ï¼Œè¿˜æœ‰ä¸€ä¸ªæ±Ÿè‹çœæŸåœ°çº§å¸‚ top1 é«˜ä¸­çš„ä¿¡æ¯æŠ€æœ¯è€å¸ˆï¼ˆè¿›ç¼–ï¼‰çš„ offerã€‚åœ¨è€ƒè™‘å®¶åº­æƒ…å†µã€ä¸ªäººå·åº¦æ‰¿å—åº¦ã€ç¨³å®šæ€§ï¼Œæœ€ç»ˆé€‰æ‹©äº†åšä¸€åæ•™å¸ˆã€‚</p>\n<p>æœªæ¥çš„å‘å±•ï¼Œå¤§æ¦‚ç‡å°±æ˜¯åšä¸€åæ™®é€šçš„ä¿¡æ¯æŠ€æœ¯æ•™å¸ˆï¼Œæœ‰å·çš„å¿ƒè¿˜æœ‰æœºä¼šå°è¯•åŠ å…¥å­¦æ ¡å¸¦ç«èµ›çš„é˜Ÿä¼ã€‚</p>\n<p>ä¸ç®¡ä»€ä¹ˆ offer é€‰æ‹©ï¼Œæœ‰å¾—å¿…å®šæœ‰å¤±ï¼Œåå…¨åç¾çš„å·¥ä½œå‡ ä¹æ²¡æœ‰ã€‚æ‰€ä»¥åœ¨è¿›è¡Œ offer é€‰æ‹©æ—¶ï¼Œå¦‚æœæ²¡æœ‰æ˜ç¡®çš„çˆ±å¥½æƒ³åšçš„å·¥ä½œçš„è¯ï¼ˆæ¯”å¦‚æˆ‘ï¼‰ï¼Œé‚£å°±å¥½å¥½ç»¼åˆè€ƒè™‘ä»¥ä¸Šå‡ ç‚¹è¿›è¡Œåˆ¤æ–­å¾—å‡ºé€‰æ‹©äº†ã€‚</p>\n<p>åšå‡ºé€‰æ‹©å°±å¥½å¥½å†²å§ï¼Œæœªæ¥å¯æœŸã€‚å¤§å®¶éƒ½æœ‰å…‰æ˜çš„æœªæ¥ï¼</p>\n","site":{"data":{}},"length":646,"excerpt":"<p>19 å¹´ä¹˜ç€äººè§äººå¹çš„è®¡ç®—æœºå¤§çƒ­ï¼Œè·¨è€ƒè®¡ç®—æœºä¸€ç«™æœªæœï¼ŒäºŒæˆ˜ä¸Šå²¸æœ¬æ ¡è®¡ç®—æœºã€‚</p>\n<p>ç ”äºŒæš‘æœŸç•™æ ¡ç§‘ç ”ï¼Œå¾ˆå¹¸è¿åšå‡ºæ¥ä¸¤ç¯‡æ–‡ç« ï¼Œæ¥ä¸‹æ¥å¯ä»¥å»å®ä¹ äº†ã€‚</p>\n<p>ä» 12 æœˆåˆ° 2 æœˆï¼Œæ–­æ–­ç»­ç»­å¤ä¹  Java åç«¯å¼€å‘æ‰€éœ€çš„çŸ¥è¯†ã€‚</p>\n<p>ä» 2 æœˆåº•æ‰¾å®ä¹ ï¼Œ4 æœˆåº•å…¥èŒå­—èŠ‚è·³åŠ¨ï¼Œ8 æœˆåº•ç¦»èŒè¿”æ ¡ï¼Œç›´åˆ° 11 æœˆåº•ï¼ˆ11.27ï¼‰æ­£å¼ç­¾è®¢ä¸‰æ–¹ï¼Œè¿‡ç¨‹åå·ï¼Œå†…å¿ƒæƒ†æ€…ã€‚</p>\n<p>ç§‹æ‹›æŠ•äº†çº¦ 50 å®¶å…¬å¸ï¼Œéƒ½æ˜¯ Java åç«¯ï¼Œä¸»è¦æœ‰ä»¥ä¸‹ï¼š</p>","more":"<p>èš‚èšï¼ŒäºŒé¢æŒ‚</p>\n<p>ä¸­ç§»è‹ç ”ï¼Œç¬¬äºŒæ‰¹æ¬¡ï¼Œé¢è¯•èµ°å®Œï¼Œæ²¡æœ‰æ”¶åˆ°ä½“æ£€</p>\n<p>æµ™å•†é“¶è¡Œï¼Œé¢è¯•èµ°å®Œï¼Œæ²¡æœ‰ææ–™å®¡æ ¸</p>\n<p>å±±çŸ³ç½‘ç§‘ï¼Œhr é¢æŒ‚</p>\n<p>è£è€€ï¼Œé¢è¯•èµ°å®Œï¼Œå£å¤´è°ˆè–ª</p>\n<p>ä¸Šæµ·é“¶è¡Œï¼Œæ€»è¡Œè‹å· baseï¼Œæ”¶åˆ° offer</p>\n<p>è‹å·å†œè¡Œï¼Œæ”¶åˆ°ä½“æ£€</p>\n<p>å­—èŠ‚è·³åŠ¨ï¼Œè½¬æ­£ offerï¼Œsp</p>\n<p>æ€»ä½“è€Œè¨€ï¼Œä»Šå¹´å¼ºçš„äººè¿˜æ˜¯èƒ½æ‹¿åˆ°å¤šä¸ªå¤§å‚ offerï¼Œä½†æ˜¯å¤§å‚é—¨æ§›æ¯”å¹´é«˜äº†å¾ˆå¤šã€‚åœ¨äº’è”ç½‘é¢“åŠ¿çš„ä»Šå¹´ï¼ŒèŠ¯ç‰‡ã€åµŒå…¥å¼æˆä¸ºé¦™é¥½é¥½ï¼Œè–ªèµ„é«˜ã€å‘å±•å¥½ï¼Œä¸å°‘äººç”šè‡³ç›´å‘¼èµ¶ç´§è½¬è¡Œï¼ˆæˆ‘æœ‰æœ‹å‹åœ¨é›¶åŸºç¡€æƒ…å†µä¸‹æ‹¿äº†äº”å…­å®¶åµŒå…¥å¼ä¸­å°å‚çš„ offerï¼‰ã€‚</p>\n<p>å…³äº offer é€‰æ‹©ï¼Œæœ€ç»ˆæ˜¯è€ƒè™‘å­—èŠ‚è·³åŠ¨ base æ­å·ï¼Œè¿˜æœ‰ä¸€ä¸ªæ±Ÿè‹çœæŸåœ°çº§å¸‚ top1 é«˜ä¸­çš„ä¿¡æ¯æŠ€æœ¯è€å¸ˆï¼ˆè¿›ç¼–ï¼‰çš„ offerã€‚åœ¨è€ƒè™‘å®¶åº­æƒ…å†µã€ä¸ªäººå·åº¦æ‰¿å—åº¦ã€ç¨³å®šæ€§ï¼Œæœ€ç»ˆé€‰æ‹©äº†åšä¸€åæ•™å¸ˆã€‚</p>\n<p>æœªæ¥çš„å‘å±•ï¼Œå¤§æ¦‚ç‡å°±æ˜¯åšä¸€åæ™®é€šçš„ä¿¡æ¯æŠ€æœ¯æ•™å¸ˆï¼Œæœ‰å·çš„å¿ƒè¿˜æœ‰æœºä¼šå°è¯•åŠ å…¥å­¦æ ¡å¸¦ç«èµ›çš„é˜Ÿä¼ã€‚</p>\n<p>ä¸ç®¡ä»€ä¹ˆ offer é€‰æ‹©ï¼Œæœ‰å¾—å¿…å®šæœ‰å¤±ï¼Œåå…¨åç¾çš„å·¥ä½œå‡ ä¹æ²¡æœ‰ã€‚æ‰€ä»¥åœ¨è¿›è¡Œ offer é€‰æ‹©æ—¶ï¼Œå¦‚æœæ²¡æœ‰æ˜ç¡®çš„çˆ±å¥½æƒ³åšçš„å·¥ä½œçš„è¯ï¼ˆæ¯”å¦‚æˆ‘ï¼‰ï¼Œé‚£å°±å¥½å¥½ç»¼åˆè€ƒè™‘ä»¥ä¸Šå‡ ç‚¹è¿›è¡Œåˆ¤æ–­å¾—å‡ºé€‰æ‹©äº†ã€‚</p>\n<p>åšå‡ºé€‰æ‹©å°±å¥½å¥½å†²å§ï¼Œæœªæ¥å¯æœŸã€‚å¤§å®¶éƒ½æœ‰å…‰æ˜çš„æœªæ¥ï¼</p>"},{"title":"Javaå…«è‚¡æ–‡ - JavaåŸºç¡€","copyright":true,"mathjax":false,"date":"2023-01-23T02:05:51.000Z","toc":true,"urlname":"java-basic-knowledge","_content":"\n> æ•´ç†çš„JavaåŸºç¡€ç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½\t<!--more-->\n\n## Javaæ¦‚è¿°\n\n### JVMã€JREå’ŒJDKçš„å…³ç³»\n\nJVMï¼šJava Virtual Machineï¼ŒJava è™šæ‹Ÿæœºï¼ŒJava ç¨‹åºéœ€è¦è¿è¡Œåœ¨è™šæ‹Ÿæœºä¸Šï¼Œä¸åŒçš„å¹³å°æœ‰è‡ªå·±çš„è™šæ‹Ÿæœºï¼Œå› æ­¤ Java è¯­è¨€å¯ä»¥å®ç°è·¨å¹³å°ã€‚\n\nJREï¼šJava Runtime Environmentï¼ŒJava è¿è¡Œç¯å¢ƒï¼ŒåŒ…æ‹¬ Java è™šæ‹Ÿæœºå’Œ Java ç¨‹åºæ‰€éœ€çš„æ ¸å¿ƒç±»åº“ç­‰ã€‚\n\nJDKï¼šJava Development Kitï¼ŒJava å¼€å‘å·¥å…·åŒ…ï¼ŒåŒ…æ‹¬äº† JRE å’Œå¼€å‘å·¥å…·ã€‚\n\n### ä»€ä¹ˆæ˜¯è·¨å¹³å°æ€§ï¼ŸåŸç†æ˜¯ä»€ä¹ˆ\n\næ‰€è°“è·¨å¹³å°æ€§ï¼Œæ˜¯æŒ‡ Java è¯­è¨€ç¼–å†™çš„ç¨‹åºï¼Œä¸€æ¬¡ç¼–è¯‘ï¼Œåˆ°å¤„è¿è¡Œã€‚\n\nå®ç°åŸç†ï¼šJava ç¨‹åºæ˜¯é€šè¿‡ Java è™šæ‹Ÿæœºåœ¨ç³»ç»Ÿå¹³å°ä¸Šè¿è¡Œçš„ï¼Œåªè¦è¯¥ç³»ç»Ÿå¯ä»¥å®‰è£…ç›¸åº”çš„ Java è™šæ‹Ÿæœºï¼Œè¯¥ç³»ç»Ÿå°±å¯ä»¥è¿è¡Œ Java ç¨‹åºã€‚\n\n### Javaè¯­è¨€æœ‰å“ªäº›ç‰¹ç‚¹\n\né¢å‘å¯¹è±¡ï¼ˆå°è£…ï¼Œç»§æ‰¿ï¼Œå¤šæ€ï¼‰\n\nå¹³å°æ— å…³æ€§ï¼ˆJava è™šæ‹Ÿæœºå®ç°å¹³å°æ— å…³æ€§ï¼‰\n\n### ä»€ä¹ˆæ˜¯å­—èŠ‚ç ï¼Ÿé‡‡ç”¨å­—èŠ‚ç çš„æœ€å¤§å¥½å¤„æ˜¯ä»€ä¹ˆ\n\n**å­—èŠ‚ç **ï¼šJava æºä»£ç ç»è¿‡è™šæ‹Ÿæœºç¼–è¯‘å™¨ç¼–è¯‘åäº§ç”Ÿçš„æ–‡ä»¶ï¼ˆå³æ‰©å±•ä¸º.class çš„æ–‡ä»¶ï¼‰ï¼Œå®ƒä¸é¢å‘ä»»ä½•ç‰¹å®šçš„å¤„ç†å™¨ï¼Œåªé¢å‘è™šæ‹Ÿæœºã€‚ï¼ˆjavac HelloWorld.Java â†’ HelloWorld.class â†’ Java HelloWorld æ‰§è¡Œç¨‹åºï¼‰\n\n**ç¼–è¯‘ä¸è§£é‡Šå¹¶å­˜**\n\nJava æºä»£ç (.Java æ–‡ä»¶)---->ç¼–è¯‘å™¨---->jvm å¯æ‰§è¡Œçš„ Java å­—èŠ‚ç (.class æ–‡ä»¶)---->jvm---->jvm ä¸­è§£é‡Šå™¨----->æœºå™¨å¯æ‰§è¡Œçš„äºŒè¿›åˆ¶æœºå™¨ç ---->ç¨‹åºè¿è¡Œ\n\n### ä»€ä¹ˆæ˜¯Javaç¨‹åºçš„ä¸»ç±»ï¼Ÿ\n\nä¸€ä¸ªç¨‹åºä¸­å¯ä»¥æœ‰å¤šä¸ªç±»ï¼Œä½†åªèƒ½æœ‰ä¸€ä¸ªç±»æ˜¯ä¸»ç±»ã€‚åœ¨ Java åº”ç”¨ç¨‹åºä¸­ï¼Œè¿™ä¸ªä¸»ç±»æ˜¯æŒ‡åŒ…å« main()æ–¹æ³•çš„ç±»ã€‚\nä¸»ç±»æ˜¯ Java ç¨‹åºæ‰§è¡Œçš„å…¥å£ã€‚ï¼ˆmain æ–¹æ³•é™¤äº†æ˜¯ä¸ªä¸»æ–¹æ³•ä»¥å¤–ï¼Œå’Œæ™®é€šçš„é™æ€æ–¹æ³•æ²¡æœ‰åŒºåˆ«ï¼Œéƒ½å¯ä»¥é‡è½½ã€è°ƒç”¨ã€ç»§æ‰¿ï¼‰\n\n### Javaå’ŒC++çš„åŒºåˆ«\n\nç›¸åŒç‚¹ï¼šéƒ½æ˜¯**é¢å‘å¯¹è±¡**çš„è¯­è¨€ï¼Œéƒ½æ”¯æŒ**å°è£…ã€ç»§æ‰¿å’Œå¤šæ€**\n\nä¸åŒç‚¹ï¼š\n\n- **Javaä¸æä¾›æŒ‡é’ˆ**æ¥ç›´æ¥è®¿é—®å†…å­˜ï¼Œç¨‹åºå†…å­˜æ›´åŠ å®‰å…¨ï¼Œæœ‰è‡ªåŠ¨å†…å­˜ç®¡ç†ï¼›C++ç”¨æŒ‡é’ˆç®¡ç†å†…å­˜\n\n- Java çš„**ç±»æ˜¯å•ç»§æ‰¿**çš„ï¼ŒC++æ”¯æŒå¤šé‡ç»§æ‰¿ï¼›è™½ç„¶ Java çš„ç±»ä¸å¯ä»¥å¤šç»§æ‰¿ï¼Œä½†æ˜¯æ¥å£å¯ä»¥å¤šç»§æ‰¿ã€‚\n\n\tä¸ºä»€ä¹ˆ Java ä¸­ç±»ä¸æ”¯æŒå¤šç»§æ‰¿ï¼Ÿâ€”â€”å¤šé‡ç»§æ‰¿çš„é’»çŸ³é—®é¢˜\n\t\n\t![å¤šé‡ç»§æ‰¿çš„é’»çŸ³é—®é¢˜](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes20190622142003813.png)\n\tç±» B å’Œç±» C ç»§æ‰¿è‡ªç±» Aï¼Œä¸”éƒ½é‡å†™äº†ç±» A ä¸­çš„åŒä¸€ä¸ªæ–¹æ³•ï¼Œè€Œç±» D åŒæ—¶ç»§æ‰¿äº†ç±» B å’Œç±» Cï¼ˆå¤šç»§æ‰¿)ï¼Œé‚£ä¹ˆæ­¤æ—¶ç±» D ä¼šç»§æ‰¿ Bã€C çš„æ–¹æ³•ï¼Œé‚£å¯¹äº Bã€C é‡å†™çš„ A ä¸­çš„æ–¹æ³•ï¼Œç±» D ä¼šç»§æ‰¿å“ªä¸€ä¸ªå‘¢ï¼Ÿ\n\n- Java æœ‰**è‡ªåŠ¨å†…å­˜ç®¡ç†**æœºåˆ¶ï¼Œä¸éœ€è¦ç¨‹åºå‘˜æ‰‹åŠ¨é‡Šæ”¾æ— ç”¨å†…å­˜\n\n## åŸºç¡€è¯­æ³•\n\n### æ•°æ®ç±»å‹\n\n**å®šä¹‰**ï¼šJava è¯­è¨€æ˜¯å¼ºç±»å‹è¯­è¨€ï¼Œå¯¹äºæ¯ä¸€ç§æ•°æ®éƒ½å®šä¹‰äº†æ˜ç¡®çš„å…·ä½“çš„æ•°æ®ç±»å‹ï¼Œåœ¨å†…å­˜ä¸­åˆ†é…äº†ä¸åŒå¤§å°çš„å†…å­˜ç©ºé—´ã€‚\n\n**åˆ†ç±»**\n\n- åŸºæœ¬æ•°æ®ç±»å‹\n\t- æ•°å€¼å‹\n\t\t- æ•´æ•°ç±»å‹(byte,short,int,long)\n\t\t- æµ®ç‚¹ç±»å‹(float,double)\n\t- å­—ç¬¦å‹(char)\n\t- å¸ƒå°”å‹(boolean)\n- å¼•ç”¨æ•°æ®ç±»å‹\n\t- ç±»(class)\n\t- æ¥å£(interface)\n\t- æ•°ç»„([])\n\n**JavaåŸºæœ¬æ•°æ®ç±»å‹å›¾**\n\n![JavaåŸºæœ¬æ•°æ®ç±»å‹å›¾](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0pvdXJXb24vaW1hZ2UvbWFzdGVyL0phdmElRTUlOUYlQkElRTclQTElODAlRTglQUYlQUQlRTYlQjMlOTUvSmF2YSVFNSU5RiVCQSVFNiU5QyVBQyVFNiU5NSVCMCVFNiU4RCVBRSVFNyVCMSVCQiVFNSU5RSU4Qi5wbmc.png)\n\n### ç±»å‹è½¬æ¢\n\nè‡ªåŠ¨ç±»å‹è½¬æ¢\n\n> ä¸¤ç§æ•°æ®ç±»å‹å½¼æ­¤å…¼å®¹\n>\n> ä½çº§ç±»å‹æ•°æ®è½¬æ¢æˆé«˜çº§ç±»å‹æ•°æ®\n\n- æ•°å€¼å‹æ•°æ®çš„è½¬æ¢ï¼šbyteâ†’shortâ†’intâ†’longâ†’floatâ†’double\n- å­—ç¬¦å‹è½¬æ¢ä¸ºæ•´å‹ï¼šcharâ†’intã€‚\n\nå¼ºåˆ¶ç±»å‹è½¬æ¢\n\n> å½“ä¸¤ç§æ•°æ®ç±»å‹ä¸å…¼å®¹ï¼Œæˆ–é«˜çº§ç±»å‹æ•°æ®è½¬æ¢æˆä½çº§ç±»å‹æ•°æ®æ—¶ï¼Œè‡ªåŠ¨è½¬æ¢å°†æ— æ³•è¿›è¡Œï¼ˆç¼–è¯‘é”™è¯¯ï¼‰ï¼Œè¿™æ—¶å°±éœ€è¦è¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢\n\n### è®¿é—®ä¿®é¥°ç¬¦\n\n![è®¿é—®ä¿®é¥°ç¬¦](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0pvdXJXb24vaW1hZ2UvbWFzdGVyL0phdmElRTUlOUYlQkElRTclQTElODAlRTglQUYlQUQlRTYlQjMlOTUvSmF2YSVFOCVBRSVCRiVFOSU5NyVBRSVFNCVCRiVBRSVFOSVBNSVCMCVFNyVBQyVBNi5wbmc.png)\n\n### å…³é”®å­—\n\n#### final æœ‰ä»€ä¹ˆç”¨ï¼Ÿ\n\nç”¨äºä¿®é¥°ç±»ã€æ–¹æ³•å’Œå˜é‡ï¼›\n\n- è¢« final ä¿®é¥°çš„ç±»ä¸å¯ä»¥è¢«ç»§æ‰¿\n\n- è¢« final ä¿®é¥°çš„æ–¹æ³•ä¸å¯ä»¥è¢«é‡å†™\n\n- è¢« final ä¿®é¥°çš„å˜é‡ä¸å¯ä»¥è¢«æ”¹å˜ï¼Œè¢« final ä¿®é¥°**ä¸å¯å˜çš„æ˜¯å˜é‡çš„å¼•ç”¨ï¼Œè€Œä¸æ˜¯å¼•ç”¨æŒ‡å‘çš„å†…å®¹**ï¼Œå¼•ç”¨æŒ‡å‘çš„å†…å®¹æ˜¯å¯ä»¥æ”¹å˜\n\n\t```java\n\tfinal int[] nums = new int[]{1, 2, 3};\n\tnums[0] = 11;\n\tSystem.out.println(Arrays.toString(nums));\t// [11, 2, 3]\n\t```\n\n#### finalã€finallyã€finalizeåŒºåˆ«\n\n- final æ˜¯ Java ä¿®é¥°ç¬¦ï¼Œå¯ä»¥ä¿®é¥°ç±»ã€æ–¹æ³•ã€å˜é‡ï¼Œä¿®é¥°ç±»è¡¨ç¤ºè¯¥ç±»ä¸èƒ½è¢«ç»§æ‰¿ã€ä¿®é¥°æ–¹æ³•è¡¨ç¤ºè¯¥æ–¹æ³•ä¸èƒ½è¢«é‡å†™ã€ä¿®é¥°å˜é‡è¡¨ç¤ºè¯¥å˜é‡ä¸å¯ä»¥è¢«æ”¹å˜ã€‚\n- finally ä¸€èˆ¬ä½œç”¨åœ¨ try-catch ä»£ç å—ä¸­ï¼Œåœ¨å¤„ç†å¼‚å¸¸çš„æ—¶å€™ï¼Œé€šå¸¸æˆ‘ä»¬å°†ä¸€å®šè¦æ‰§è¡Œçš„ä»£ç æ”¾åœ¨ finally ä»£ç å—ä¸­ï¼Œè¡¨ç¤ºä¸ç®¡æ˜¯å¦å‡ºç°å¼‚å¸¸ï¼Œè¯¥ä»£ç å—éƒ½ä¼šæ‰§è¡Œï¼Œä¸€èˆ¬ç”¨æ¥å­˜æ”¾ä¸€äº›å…³é—­èµ„æºçš„ä»£ç ã€‚\n\n- finalize æ˜¯ Object ç±»çš„ä¸€ä¸ªæ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¸€èˆ¬ç”±åƒåœ¾å›æ”¶å™¨æ¥è°ƒç”¨ï¼Œåœ¨æ‰§è¡Œåƒåœ¾å›æ”¶å‰ï¼Œç”±åƒåœ¾å›æ”¶å™¨è°ƒç”¨å¯¹è±¡çš„ finalize()æ–¹æ³•ï¼Œå¹¶ä¸”åœ¨è¯¥æ–¹æ³•ä¸­å¯¹è±¡å¯èƒ½å¯ä»¥å¤æ´»ã€‚\n\n#### thiså…³é”®å­—çš„ç”¨æ³•\n\næŒ‡å‘å¯¹è±¡æœ¬èº«çš„ä¸€ä¸ªæŒ‡é’ˆã€‚\n\n#### superå…³é”®å­—çš„ç”¨æ³•\n\næŒ‡å‘è‡ªå·±çˆ¶ç±»å¯¹è±¡ï¼ˆæœ€è¿‘çš„çˆ¶ç±»ï¼‰çš„ä¸€ä¸ªæŒ‡é’ˆã€‚\n\n#### staticå­˜åœ¨çš„ä¸»è¦æ„ä¹‰\n\nstatic**é™æ€å˜é‡**ï¼šå’Œç±»ä¸€èµ·åŠ è½½ï¼Œ**ä»¥è‡´äºå³ä½¿æ²¡æœ‰åˆ›å»ºå¯¹è±¡ï¼Œä¹Ÿèƒ½ä½¿ç”¨å±æ€§å’Œè°ƒç”¨æ–¹æ³•ã€‚**\n\nstatic**é™æ€ä»£ç å—**ï¼šåœ¨ç±»åˆæ¬¡è¢«åŠ è½½çš„æ—¶å€™ï¼Œä¼šæŒ‰ç…§ static å—çš„é¡ºåºæ¥æ‰§è¡Œæ¯ä¸ª static å—ï¼Œå¹¶ä¸”åªä¼šæ‰§è¡Œä¸€æ¬¡ã€‚\nåŠ è½½ â†’ é“¾æ¥ï¼ˆéªŒè¯ã€å‡†å¤‡ã€è§£æï¼‰ â†’ åˆå§‹åŒ–\n\nstatic ç±»å‹çš„å˜é‡åœ¨å‡†å¤‡é˜¶æ®µè¿›è¡Œé»˜è®¤åˆå§‹åŒ–ï¼Œä½†æ˜¯æœ‰ static final ä¿®é¥°çš„ä¼šåœ¨å‡†å¤‡é˜¶æ®µç›´æ¥èµ‹å€¼ï¼Œ åœ¨åˆå§‹åŒ–é˜¶æ®µè¿›è¡Œæ˜¾å¼åˆå§‹åŒ–ã€‚\n\n#### staticæ³¨æ„äº‹é¡¹\n\n1ã€é™æ€åªèƒ½è®¿é—®é™æ€ã€‚ 2ã€éé™æ€æ—¢å¯ä»¥è®¿é—®éé™æ€çš„ï¼Œä¹Ÿå¯ä»¥è®¿é—®é™æ€çš„ã€‚\n\n### åˆå§‹åŒ–é¡ºåº\n\né™æ€å±æ€§ â†’ é™æ€æ–¹æ³•å— â†’ æ™®é€šå±æ€§ â†’ æ™®é€šæ–¹æ³•å— â†’ æ„é€ å‡½æ•°\n\n### æµç¨‹æ§åˆ¶è¯­å¥\n\n#### break ã€continueã€return çš„åŒºåˆ«åŠä½œç”¨\n\nbreak ç»“æŸå½“å‰çš„å¾ªç¯ä½“\n\ncontinue ç»“æŸæ­£åœ¨æ‰§è¡Œçš„å¾ªç¯ï¼Œè¿›å…¥ä¸‹ä¸€ä¸ªå¾ªç¯æ¡ä»¶\n\nreturn ç»“æŸå½“å‰çš„æ–¹æ³•ï¼Œç›´æ¥è¿”å›\n\n#### è·³å‡ºå½“å‰çš„å¤šé‡åµŒå¥—å¾ªç¯\n\nåœ¨ Java ä¸­ï¼Œè¦æƒ³è·³å‡ºå¤šé‡å¾ªç¯ï¼Œå¯ä»¥åœ¨å¤–é¢çš„å¾ªç¯è¯­å¥å‰å®šä¹‰ä¸€ä¸ªæ ‡å·ï¼Œç„¶ååœ¨é‡Œå±‚å¾ªç¯ä½“çš„ä»£ç ä¸­ä½¿ç”¨å¸¦æœ‰æ ‡å·çš„ break è¯­å¥ï¼Œå³å¯è·³å‡ºå¤–å±‚å¾ªç¯ã€‚ä¾‹å¦‚ï¼š\n\n```java\npublic static void main(String[] args) {\n    ok:\n    for (int i = 0; i < 10; i++) {\n        for (int j = 0; j < 10; j++) {\n            System.out.println(\"i=\" + i + \",j=\" + j);\n            if (j == 5) {\n                break ok;\n            }\n        }\n    }\n}\n```\n\n## é¢å‘å¯¹è±¡\n\n### é¢å‘å¯¹è±¡ä¸‰å¤§ç‰¹æ€§\n\n#### é¢å‘å¯¹è±¡çš„ç‰¹å¾æœ‰å“ªäº›æ–¹é¢\n\n**æŠ½è±¡**ï¼šæŠ½è±¡æ˜¯å°†ä¸€ç±»å¯¹è±¡çš„å…±åŒç‰¹å¾æ€»ç»“å‡ºæ¥æ„é€ ç±»çš„è¿‡ç¨‹ï¼ŒåŒ…æ‹¬æ•°æ®æŠ½è±¡å’Œè¡Œä¸ºæŠ½è±¡ä¸¤æ–¹é¢ã€‚æŠ½è±¡åªå…³æ³¨å¯¹è±¡æœ‰å“ªäº›å±æ€§å’Œè¡Œä¸ºï¼Œå¹¶ä¸å…³æ³¨è¿™äº›è¡Œä¸ºçš„ç»†èŠ‚æ˜¯ä»€ä¹ˆã€‚\n\n**å°è£…**\n\nå°è£…æŠŠä¸€ä¸ªå¯¹è±¡çš„å±æ€§ç§æœ‰åŒ–ï¼ŒåŒæ—¶æä¾›ä¸€äº›å¯ä»¥è¢«å¤–ç•Œè®¿é—®çš„å±æ€§çš„æ–¹æ³•ï¼Œå¦‚æœå±æ€§ä¸æƒ³è¢«å¤–ç•Œè®¿é—®ï¼Œæˆ‘ä»¬å¤§å¯ä¸å¿…æä¾›æ–¹æ³•ç»™å¤–ç•Œè®¿é—®ã€‚\n\n**ç»§æ‰¿**\n\nç»§æ‰¿æ˜¯**ä½¿ç”¨å·²å­˜åœ¨çš„ç±»ä½œä¸ºåŸºç¡€å»ºç«‹æ–°ç±»**çš„æŠ€æœ¯ï¼Œæ–°ç±»çš„å®šä¹‰å¯ä»¥å¢åŠ æ–°çš„æ•°æ®æˆ–æ–°çš„åŠŸèƒ½ï¼Œä¹Ÿå¯ä»¥ç”¨çˆ¶ç±»çš„åŠŸèƒ½ã€‚é€šè¿‡ä½¿ç”¨ç»§æ‰¿æˆ‘ä»¬èƒ½å¤Ÿéå¸¸æ–¹ä¾¿åœ°å¤ç”¨ä»¥å‰çš„ä»£ç ã€‚\n\nå…³äºç»§æ‰¿å¦‚ä¸‹ 3 ç‚¹è¯·è®°ä½ï¼š\n\n1. å­ç±»æ‹¥æœ‰çˆ¶ç±»é private çš„å±æ€§å’Œæ–¹æ³•ã€‚\n2. å­ç±»å¯ä»¥æ‹¥æœ‰è‡ªå·±å±æ€§å’Œæ–¹æ³•ï¼Œå³å­ç±»å¯ä»¥å¯¹çˆ¶ç±»è¿›è¡Œæ‰©å±•ã€‚\n3. å­ç±»å¯ä»¥ç”¨è‡ªå·±çš„æ–¹å¼å®ç°çˆ¶ç±»çš„æ–¹æ³•ï¼Œoverride é‡å†™ã€‚\n\n**å¤šæ€**\n\næ‰€è°“å¤šæ€å°±æ˜¯æŒ‡ä¸€ä¸ªå¼•ç”¨å˜é‡åˆ°åº•ä¼šæŒ‡å‘å“ªä¸ªç±»çš„å®ä¾‹å¯¹è±¡ï¼Œè¯¥å¼•ç”¨å˜é‡è°ƒç”¨çš„æ–¹æ³•åˆ°åº•æ˜¯å“ªä¸ªç±»ä¸­å®ç°çš„æ–¹æ³•ï¼Œå¿…é¡»åœ¨ç¨‹åºè¿è¡ŒæœŸé—´æ‰èƒ½ç¡®å®šï¼Œç¼–è¯‘æœŸæ— æ³•ç¡®å®šã€‚\n\nçˆ¶ç±»çš„å¼•ç”¨æŒ‡å‘å­ç±»å®ä¾‹å¯¹è±¡ã€æ¥å£æŒ‡å‘å®ç°ç±»å®ä¾‹å¯¹è±¡ã€‚æé«˜äº†ç¨‹åºçš„æ‹“å±•æ€§ã€‚\n\nåœ¨ Java ä¸­æœ‰ä¸¤ç§å½¢å¼å¯ä»¥å®ç°å¤šæ€ï¼šç»§æ‰¿ï¼ˆå¤šä¸ªå­ç±»å¯¹åŒä¸€æ–¹æ³•çš„é‡å†™ï¼‰å’Œæ¥å£ï¼ˆå®ç°æ¥å£å¹¶è¦†ç›–æ¥å£ä¸­åŒä¸€æ–¹æ³•ï¼‰ã€‚\n\næ–¹æ³•é‡è½½ï¼ˆoverloadï¼‰å®ç°ç¼–è¯‘æ—¶çš„å¤šæ€æ€§ï¼ˆä¹Ÿç§°ä¸ºå‰ç»‘å®šï¼‰ï¼Œæ–¹æ³•é‡å†™ï¼ˆoverrideï¼‰å®ç°è¿è¡Œæ—¶çš„å¤šæ€æ€§ï¼ˆä¹Ÿç§°ä¸ºåç»‘å®šï¼‰ã€‚\n\nJava å®ç°å¤šæ€æœ‰ä¸‰ä¸ªå¿…è¦æ¡ä»¶ï¼šç»§æ‰¿ã€é‡å†™ã€å‘ä¸Šè½¬å‹ã€‚\n\n> ç»§æ‰¿ï¼šåœ¨å¤šæ€ä¸­å¿…é¡»å­˜åœ¨æœ‰ç»§æ‰¿å…³ç³»çš„å­ç±»å’Œçˆ¶ç±»ã€‚\n>\n> é‡å†™ï¼šå­ç±»å¯¹çˆ¶ç±»ä¸­æŸäº›æ–¹æ³•è¿›è¡Œé‡æ–°å®šä¹‰ï¼Œåœ¨è°ƒç”¨è¿™äº›æ–¹æ³•æ—¶å°±ä¼šè°ƒç”¨å­ç±»çš„æ–¹æ³•ã€‚\n>\n> å‘ä¸Šè½¬å‹ï¼šåœ¨å¤šæ€ä¸­éœ€è¦å°†å­ç±»çš„å¼•ç”¨èµ‹ç»™çˆ¶ç±»å¯¹è±¡ï¼Œåªæœ‰è¿™æ ·è¯¥å¼•ç”¨æ‰èƒ½å¤Ÿå…·å¤‡æŠ€èƒ½è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•å’Œå­ç±»çš„æ–¹æ³•ã€‚\n\nåªæœ‰æ»¡è¶³äº†ä¸Šè¿°ä¸‰ä¸ªæ¡ä»¶ï¼Œæˆ‘ä»¬æ‰èƒ½å¤Ÿåœ¨åŒä¸€ä¸ªç»§æ‰¿ç»“æ„ä¸­ä½¿ç”¨ç»Ÿä¸€çš„é€»è¾‘å®ç°ä»£ç å¤„ç†ä¸åŒçš„å¯¹è±¡ï¼Œä»è€Œè¾¾åˆ°æ‰§è¡Œä¸åŒçš„è¡Œä¸ºã€‚\n\n#### æŠ½è±¡ç±»å’Œæ¥å£çš„å¯¹æ¯”\n\næŠ½è±¡ç±»æ˜¯å¯¹ç±»çš„æŠ½è±¡ï¼Œç”¨æ¥**æ•æ‰é€šç”¨ç‰¹æ€§**ã€‚æ¥å£æ˜¯**è¡Œä¸ºçš„æŠ½è±¡**ï¼ŒæŠ½è±¡æ–¹æ³•çš„é›†åˆã€‚\n\n**ç›¸åŒç‚¹**\n\n- æ¥å£å’ŒæŠ½è±¡ç±»éƒ½ä¸èƒ½å®ä¾‹åŒ–\n- éƒ½ä½äºç»§æ‰¿çš„é¡¶ç«¯ï¼Œç”¨äºè¢«å…¶ä»–ç±»å®ç°æˆ–ç»§æ‰¿\n- éƒ½åŒ…å«æŠ½è±¡æ–¹æ³•ï¼Œå…¶å­ç±»éƒ½å¿…é¡»é‡å†™è¿™äº›æŠ½è±¡æ–¹æ³•\n\n**ä¸åŒç‚¹**\n\n| å‚æ•°       | æŠ½è±¡ç±»                             | æ¥å£                                             |\n| ---------- | ---------------------------------- | ------------------------------------------------ |\n| å£°æ˜       | æŠ½è±¡ç±»ä½¿ç”¨abstractå…³é”®å­—å£°æ˜       | æ¥å£ä½¿ç”¨interfaceå…³é”®å­—å£°æ˜                      |\n| å®ç°       | å­ç±»ä½¿ç”¨extendså…³é”®å­—æ¥ç»§æ‰¿æŠ½è±¡ç±»  | å­ç±»ä½¿ç”¨implementså…³é”®å­—æ¥å®ç°æ¥å£               |\n| æ„é€ å™¨     | æŠ½è±¡ç±»å¯ä»¥æœ‰æ„é€ å™¨                 | æ¥å£ä¸èƒ½æœ‰æ„é€ å™¨                                 |\n| è®¿é—®ä¿®é¥°ç¬¦ | æŠ½è±¡ç±»ä¸­çš„æ–¹æ³•å¯ä»¥æ˜¯ä»»æ„è®¿é—®ä¿®é¥°ç¬¦ | æ¥å£æ–¹æ³•é»˜è®¤ä¿®é¥°ç¬¦æ˜¯publicï¼Œä¹Ÿå¯ä»¥ä¸åŠ è®¿é—®ä¿®é¥°ç¬¦ |\n| å¤šç»§æ‰¿     | ä¸€ä¸ªç±»æœ€å¤šåªèƒ½ç»§æ‰¿ä¸€ä¸ªæŠ½è±¡ç±»       | ä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£                           |\n\n#### æ™®é€šç±»å’ŒæŠ½è±¡ç±»æœ‰å“ªäº›åŒºåˆ«ï¼Ÿ\n\n- æ™®é€šç±»ä¸èƒ½åŒ…å«æŠ½è±¡æ–¹æ³•ï¼ŒæŠ½è±¡ç±»å¯ä»¥åŒ…å«æŠ½è±¡æ–¹æ³•ã€‚\n- æŠ½è±¡ç±»ä¸èƒ½ç›´æ¥å®ä¾‹åŒ–ï¼Œæ™®é€šç±»å¯ä»¥ç›´æ¥å®ä¾‹åŒ–ã€‚\n\n#### æˆå‘˜å˜é‡å’Œå±€éƒ¨å˜é‡çš„åŒºåˆ«\n\n|              | æˆå‘˜å˜é‡               | å±€éƒ¨å˜é‡                                     |\n| ------------ | ---------------------- | -------------------------------------------- |\n| **ä½œç”¨åŸŸ**   | æ•´ä¸ªç±»å¯ä½¿ç”¨           | æ–¹æ³•ä½“å†…ä½¿ç”¨                                 |\n| **å­˜å‚¨ä½ç½®** | å±äºå¯¹è±¡ï¼Œå­˜åœ¨å †å†…å­˜ä¸­ | å±äºæ–¹æ³•ï¼Œå­˜åœ¨æ ˆå¸§ä¸­                         |\n| **ç”Ÿå‘½å‘¨æœŸ** | å’Œå¯¹è±¡åŒç”Ÿå‘½å‘¨æœŸ       | å’Œæ–¹æ³•åŒç”Ÿå‘½å‘¨æœŸ                             |\n| **åˆå§‹å€¼**   | ä¸æŒ‡å®šçš„è¯æœ‰é»˜è®¤åˆå§‹å€¼ | å¿…é¡»æ‰‹åŠ¨åˆå§‹åŒ–å¦åˆ™<br />ä¸èƒ½ä½¿ç”¨ï¼ˆç¼–è¯‘é”™è¯¯ï¼‰ |\n\n**ä½¿ç”¨åŸåˆ™**\n\nåœ¨ä½¿ç”¨å˜é‡æ—¶éœ€è¦éµå¾ªçš„åŸåˆ™ä¸ºï¼šå°±è¿‘åŸåˆ™\né¦–å…ˆåœ¨å±€éƒ¨èŒƒå›´æ‰¾ï¼Œæœ‰å°±ä½¿ç”¨ï¼›æ¥ç€åœ¨æˆå‘˜ä½ç½®æ‰¾ã€‚\n\n```java\npublic class Main {\n    int a = 2;\n    public static void main(String[] args) {\n        int a = 1;\n        System.out.println(a);\t// 1\n    }\n}\n```\n\n### å†…éƒ¨ç±»\n\n#### ä»€ä¹ˆæ˜¯å†…éƒ¨ç±»ï¼Ÿ\n\nåœ¨ Java ä¸­ï¼Œå¯ä»¥å°†ä¸€ä¸ªç±»çš„å®šä¹‰æ”¾åœ¨å¦å¤–ä¸€ä¸ªç±»çš„å®šä¹‰å†…éƒ¨ï¼Œè¿™å°±æ˜¯**å†…éƒ¨ç±»**ã€‚\n\n#### å†…éƒ¨ç±»çš„åˆ†ç±»æœ‰å“ªäº›\n\nå†…éƒ¨ç±»å¯ä»¥åˆ†ä¸ºå››ç§ï¼š**é™æ€å†…éƒ¨ç±»ã€æˆå‘˜å†…éƒ¨ç±»ã€å±€éƒ¨å†…éƒ¨ç±»ã€åŒ¿åå†…éƒ¨ç±»**ã€‚\n\n##### é™æ€å†…éƒ¨ç±»\n\nå®šä¹‰åœ¨ç±»å†…éƒ¨çš„é™æ€ç±»ï¼Œå°±æ˜¯é™æ€å†…éƒ¨ç±»ã€‚\n\né™æ€å†…éƒ¨ç±»å¯ä»¥è®¿é—®å¤–éƒ¨ç±»æ‰€æœ‰çš„é™æ€å˜é‡ï¼Œè€Œä¸å¯è®¿é—®å¤–éƒ¨ç±»çš„éé™æ€å˜é‡\n\n##### æˆå‘˜å†…éƒ¨ç±»\n\nå®šä¹‰åœ¨ç±»å†…éƒ¨ï¼Œæˆå‘˜ä½ç½®ä¸Šçš„éé™æ€ç±»ï¼Œå°±æ˜¯æˆå‘˜å†…éƒ¨ç±»ã€‚\n\næˆå‘˜å†…éƒ¨ç±»å¯ä»¥è®¿é—®å¤–éƒ¨ç±»æ‰€æœ‰çš„å˜é‡å’Œæ–¹æ³•ï¼ŒåŒ…æ‹¬é™æ€å’Œéé™æ€ï¼Œç§æœ‰å’Œå…¬æœ‰ã€‚\n\n##### å±€éƒ¨å†…éƒ¨ç±»\n\nå®šä¹‰åœ¨æ–¹æ³•ä¸­çš„å†…éƒ¨ç±»ï¼Œå°±æ˜¯å±€éƒ¨å†…éƒ¨ç±»ã€‚\n\nå®šä¹‰åœ¨å®ä¾‹æ–¹æ³•ä¸­çš„å±€éƒ¨ç±»å¯ä»¥è®¿é—®å¤–éƒ¨ç±»çš„æ‰€æœ‰å˜é‡å’Œæ–¹æ³•ï¼Œå®šä¹‰åœ¨é™æ€æ–¹æ³•ä¸­çš„å±€éƒ¨ç±»åªèƒ½è®¿é—®å¤–éƒ¨ç±»çš„é™æ€å˜é‡å’Œæ–¹æ³•\n\n##### åŒ¿åå†…éƒ¨ç±»\n\nåŒ¿åå†…éƒ¨ç±»å°±æ˜¯æ²¡æœ‰åå­—çš„å†…éƒ¨ç±»ï¼Œæ—¥å¸¸å¼€å‘ä¸­ä½¿ç”¨çš„æ¯”è¾ƒå¤šã€‚åŒ¿åå†…éƒ¨ç±»å¿…é¡»ç»§æ‰¿æˆ–å®ç°ä¸€ä¸ªå·²æœ‰çš„æ¥å£ ï¼ŒåŒ¿åå†…éƒ¨ç±»ä¸èƒ½å®šä¹‰ä»»ä½•é™æ€æˆå‘˜å’Œé™æ€æ–¹æ³•\n\n#### å±€éƒ¨å†…éƒ¨ç±»å’ŒåŒ¿åå†…éƒ¨ç±»è®¿é—®å±€éƒ¨å˜é‡çš„æ—¶å€™ï¼Œä¸ºä»€ä¹ˆå˜é‡å¿…é¡»è¦åŠ ä¸Šfinalï¼Ÿ\n\nå±€éƒ¨å†…éƒ¨ç±»å’ŒåŒ¿åå†…éƒ¨ç±»è®¿é—®å±€éƒ¨å˜é‡çš„æ—¶å€™ï¼Œä¸ºä»€ä¹ˆå˜é‡å¿…é¡»è¦åŠ ä¸Š final å‘¢ï¼Ÿå®ƒå†…éƒ¨åŸç†æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ\n\nå…ˆçœ‹è¿™æ®µä»£ç ï¼š\n\n```java\npublic class Outer {\n    void outMethod(){\n        final int a =10;\n        class Inner {\n            void innerMethod(){\n                System.out.println(a);\n            }\n        }\n    }\n}\n```\n\nä»¥ä¸Šä¾‹å­ï¼Œä¸ºä»€ä¹ˆè¦åŠ  final å‘¢ï¼Ÿæ˜¯å› ä¸º**ç”Ÿå‘½å‘¨æœŸä¸ä¸€è‡´**\n\nå±€éƒ¨å˜é‡å­˜å‚¨åœ¨æ ˆä¸­ï¼Œå½“æ–¹æ³•æ‰§è¡Œç»“æŸåï¼Œå¦‚æœä¸ç”¨ final ä¿®é¥°é‚£ä¹ˆè¯¥å±€éƒ¨å˜é‡å°±è¢«é”€æ¯ã€‚è€Œå±€éƒ¨å†…éƒ¨ç±»å¯¹å±€éƒ¨å˜é‡çš„å¼•ç”¨ä¾ç„¶å­˜åœ¨ï¼Œå¦‚æœå±€éƒ¨å†…éƒ¨ç±»è¦è°ƒç”¨å±€éƒ¨å˜é‡æ—¶ï¼Œå°±ä¼šå‡ºé”™ã€‚\nåŠ äº† finalï¼Œå¯ä»¥ç¡®ä¿å±€éƒ¨å†…éƒ¨ç±»ä½¿ç”¨çš„å˜é‡ä¸å¤–å±‚çš„å±€éƒ¨å˜é‡åŒºåˆ†å¼€ï¼Œè§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚\n\n### é‡å†™ä¸é‡è½½\n\n#### æ„é€ å™¨ï¼ˆconstructorï¼‰æ˜¯å¦å¯è¢«é‡å†™ï¼ˆoverrideï¼‰\n\næ„é€ å™¨ä¸èƒ½è¢«ç»§æ‰¿ï¼Œå› æ­¤ä¸èƒ½è¢«é‡å†™ï¼Œä½†å¯ä»¥è¢«é‡è½½ã€‚\n\n#### é‡è½½ï¼ˆOverloadï¼‰å’Œé‡å†™ï¼ˆOverrideï¼‰çš„åŒºåˆ«ã€‚é‡è½½çš„æ–¹æ³•èƒ½å¦æ ¹æ®è¿”å›ç±»å‹è¿›è¡ŒåŒºåˆ†ï¼Ÿ\n\næ–¹æ³•çš„é‡è½½å’Œé‡å†™éƒ½æ˜¯å®ç°å¤šæ€çš„æ–¹å¼ï¼ŒåŒºåˆ«åœ¨äºé‡è½½å®ç°çš„æ˜¯**ç¼–è¯‘æ—¶çš„å¤šæ€æ€§**ï¼Œè€Œé‡å†™å®ç°çš„æ˜¯**è¿è¡Œæ—¶çš„å¤šæ€æ€§**ã€‚\n\né‡è½½ï¼šå‘ç”Ÿåœ¨**åŒä¸€ä¸ªç±»**ä¸­ï¼Œ**æ–¹æ³•åç›¸åŒ å‚æ•°åˆ—è¡¨ä¸åŒ**ï¼ˆå‚æ•°ç±»å‹ä¸åŒã€ä¸ªæ•°ä¸åŒã€é¡ºåºä¸åŒï¼‰ï¼Œä¸æ–¹æ³•è¿”å›å€¼å’Œè®¿é—®ä¿®é¥°ç¬¦æ— å…³\n\né‡å†™ï¼šå‘ç”Ÿåœ¨**çˆ¶å­ç±»**ä¸­ï¼Œæ–¹æ³•åã€å‚æ•°åˆ—è¡¨å¿…é¡»ç›¸åŒï¼Œè¿”å›å€¼ç±»å‹å°äºç­‰äºçˆ¶ç±»ï¼ŒæŠ›å‡ºçš„å¼‚å¸¸å°äºç­‰äºçˆ¶ç±»ï¼Œ**è®¿é—®ä¿®é¥°ç¬¦å¤§äºç­‰äºçˆ¶ç±»**ï¼ˆé‡Œæ°ä»£æ¢åŸåˆ™ï¼‰\n\n### å¯¹è±¡ç›¸ç­‰åˆ¤æ–­\n\n#### == å’Œ equals çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ\n\n**==** : å®ƒçš„ä½œç”¨æ˜¯åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡çš„åœ°å€æ˜¯ä¸æ˜¯ç›¸ç­‰ã€‚å³ï¼Œåˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯ä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚\n(åŸºæœ¬æ•°æ®ç±»å‹ == æ¯”è¾ƒçš„æ˜¯å€¼ï¼Œå¼•ç”¨æ•°æ®ç±»å‹ == æ¯”è¾ƒçš„æ˜¯å†…å­˜åœ°å€)\n\n**equals()** : å®ƒçš„ä½œç”¨ä¹Ÿæ˜¯åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰ã€‚ä½†å®ƒä¸€èˆ¬æœ‰ä¸¤ç§ä½¿ç”¨æƒ…å†µï¼š\n\næƒ…å†µ 1ï¼šç±»æ²¡æœ‰é‡å†™ equals() æ–¹æ³•ã€‚åˆ™é€šè¿‡ equals() æ¯”è¾ƒè¯¥ç±»çš„ä¸¤ä¸ªå¯¹è±¡æ—¶ï¼Œç­‰ä»·äºé€šè¿‡â€œ==â€æ¯”è¾ƒè¿™ä¸¤ä¸ªå¯¹è±¡ã€‚\n\næƒ…å†µ 2ï¼šç±»é‡å†™äº† equals() æ–¹æ³•ã€‚ä¸€èˆ¬ï¼Œæˆ‘ä»¬éƒ½é‡å†™ equals() æ–¹æ³•æ¥ä¸¤ä¸ªå¯¹è±¡çš„å†…å®¹ç›¸ç­‰ï¼›è‹¥å®ƒä»¬çš„å†…å®¹ç›¸ç­‰ï¼Œåˆ™è¿”å› true (å³ï¼Œè®¤ä¸ºè¿™ä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰)ã€‚\n\n#### hashCode ä¸ equals\n\n**hashCode()ä»‹ç»**\n\nhashCode() çš„ä½œç”¨æ˜¯è·å–å“ˆå¸Œç ï¼ˆæœ¬åœ°æ–¹æ³•ï¼‰ï¼Œä¹Ÿç§°ä¸ºæ•£åˆ—ç ï¼›å®ƒå®é™…ä¸Šæ˜¯è¿”å›ä¸€ä¸ª int æ•´æ•°ã€‚hashCode() å®šä¹‰åœ¨ JDK çš„ Object ç±»ä¸­ï¼Œè¿™å°±æ„å‘³ç€ Java ä¸­çš„ä»»ä½•ç±»éƒ½æœ‰ hashCode()æ–¹æ³•ã€‚\n\n**ä¸ºä»€ä¹ˆè¦æœ‰ hashCode**\n\n**æˆ‘ä»¬ä»¥â€œhashSet å¦‚ä½•æ£€æŸ¥é‡å¤â€ä¸ºä¾‹å­æ¥è¯´æ˜ä¸ºä»€ä¹ˆè¦æœ‰ hashCode**ï¼š\n\nå½“ä½ æŠŠå¯¹è±¡åŠ å…¥ hashSet æ—¶ï¼ŒhashSet ä¼šå…ˆè®¡ç®—å¯¹è±¡çš„ hashcode å€¼æ¥åˆ¤æ–­å¯¹è±¡åŠ å…¥çš„ä½ç½®ï¼Œå¦‚æœæ²¡æœ‰ç›¸ç¬¦çš„ hashcodeï¼ŒhashSet ä¼šå‡è®¾å¯¹è±¡æ²¡æœ‰é‡å¤å‡ºç°ã€‚ä½†æ˜¯å¦‚æœå‘ç°æœ‰ç›¸åŒ hashcode å€¼çš„å¯¹è±¡ï¼Œè¿™æ—¶ä¼šè°ƒç”¨ equals()æ–¹æ³•æ¥æ£€æŸ¥ hashcode ç›¸ç­‰çš„å¯¹è±¡æ˜¯å¦çœŸçš„ç›¸åŒã€‚å¦‚æœä¸¤è€…ç›¸åŒï¼Œè¡¨æ˜å·²ç»æœ‰äº†ç›¸åŒçš„å¯¹è±¡äº†ï¼ŒhashSet å°±ä¸ä¼šè®©å…¶åŠ å…¥æ“ä½œæˆåŠŸã€‚å¦‚æœä¸åŒçš„è¯ï¼Œå°±ä¼šé‡æ–°æ•£åˆ—åˆ°å…¶ä»–ä½ç½®ã€‚\n\n**hashCode()ä¸equals()çš„ç›¸å…³è§„å®š**\n\n- å¦‚æœä¸¤ä¸ªå¯¹è±¡çš„ hashCode å€¼ç›¸ç­‰ï¼Œé‚£è¿™ä¸¤ä¸ªå¯¹è±¡ä¸ä¸€å®šç›¸ç­‰ï¼ˆå“ˆå¸Œç¢°æ’ï¼‰ã€‚\n- å¦‚æœä¸¤ä¸ªå¯¹è±¡çš„ hashCode å€¼ç›¸ç­‰å¹¶ä¸” equals()æ–¹æ³•ä¹Ÿè¿”å› trueï¼Œæˆ‘ä»¬æ‰è®¤ä¸ºè¿™ä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰ã€‚\n- å¦‚æœä¸¤ä¸ªå¯¹è±¡çš„ hashCode å€¼ä¸ç›¸ç­‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥è®¤ä¸ºè¿™ä¸¤ä¸ªå¯¹è±¡ä¸ç›¸ç­‰ã€‚\n\n#### åªé‡å†™ hashCode å¯ä»¥å—ï¼Ÿ\n\nå¦‚æœåªé‡å†™ hashCodeï¼Œä¸é‡å†™ equalsï¼Œé‚£ä¹ˆå¦‚æœä¸¤ä¸ªå¯¹è±¡åˆ¤æ–­ hashCode ç›¸åŒäº†ï¼Œä»¥ä¸ºè¿™ä¿©å¯¹è±¡ç›¸åŒï¼Œé‚£ä¹ˆåªä¼šæ’å…¥ä¸€æ¬¡åˆ° set é‡Œé¢ï¼Œè€Œå®é™…ä¸Šè¿™ä¸¤ä¸ªä¸ä¸€æ ·ä¸€ä¸ªæ˜¯ A ä¸€ä¸ªæ˜¯ Bï¼Œéƒ½éœ€è¦æ’å…¥ã€‚\n\n> ä¸¤ä¸ªå¯¹è±¡çš„ hashCode ç›¸åŒï¼Œä½†æ˜¯å†…å®¹å¯èƒ½ä¸åŒï¼Œåœ¨ set ä¸­æ˜æ˜åº”è¯¥æ˜¯ä¸¤ä¸ªä¸åŒçš„å¯¹è±¡ï¼Œè¿™æ—¶å€™åªé€šè¿‡ hashCode åˆ¤æ–­ä»–ä¿©ç›¸åŒä¼šå¯¼è‡´åªæ’å…¥ä¸€ä¸ªå…ƒç´ ã€‚\n\n#### åªé‡å†™ equalså¯ä»¥å—ï¼Ÿ\n\nå¦‚æœåœ¨é‡å†™ equals æ—¶ï¼Œä¸é‡å†™ hashCodeï¼Œå°±ä¼šå¼•èµ·æ¯”å¦‚è¯´å°†ä¸¤ä¸ªç›¸ç­‰çš„è‡ªå®šä¹‰å¯¹è±¡å­˜å‚¨åœ¨ Set é›†åˆæ—¶ï¼Œä¼šå°†è¿™ä¸¤ä¸ªå¯¹è±¡éƒ½è¿›è¡Œæ’å…¥ã€‚ï¼ˆæ— æ³•å»é‡ï¼‰\n\n> å¦‚æœå®šä¹‰ä¸€ä¸ª set é‡Œé¢å­˜æ”¾ Person å¯¹è±¡ï¼ŒPerson åªé‡å†™äº† equals æ–¹æ³•å³å¯ä»¥åˆ¤æ–­å¯¹è±¡å†…å®¹æ˜¯å¦ç›¸åŒã€‚\n>\n> å¦‚æœåªé‡å†™äº† equals æ–¹æ³•ï¼Œé‚£ä¹ˆé»˜è®¤æƒ…å†µä¸‹ï¼ŒSet è¿›è¡Œå»é‡æ“ä½œæ—¶ï¼Œä¼šå…ˆåˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡çš„ hashCode æ˜¯å¦ç›¸åŒï¼Œæ­¤æ—¶å› ä¸ºæ²¡æœ‰é‡å†™ hashCode æ–¹æ³•ï¼Œæ‰€ä»¥ä¼šç›´æ¥æ‰§è¡Œ Object ä¸­çš„ hashCode æ–¹æ³•ï¼Œè€Œ Object ä¸­çš„ hashCode æ–¹æ³•å¯¹æ¯”çš„æ˜¯ä¸¤ä¸ªä¸åŒå¼•ç”¨åœ°å€çš„å¯¹è±¡ï¼Œæ‰€ä»¥ç»“æœæ˜¯ falseï¼Œé‚£ä¹ˆ equals æ–¹æ³•å°±ä¸ç”¨æ‰§è¡Œäº†ï¼Œç›´æ¥è¿”å›çš„ç»“æœå°±æ˜¯ falseï¼šä¸¤ä¸ªå¯¹è±¡ä¸æ˜¯ç›¸ç­‰çš„ï¼Œäºæ˜¯å°±åœ¨ Set é›†åˆä¸­æ’å…¥äº†ä¸¤ä¸ªç›¸åŒçš„å¯¹è±¡ã€‚\n>\n> ä½†æ˜¯ï¼Œå¦‚æœåœ¨é‡å†™ equals æ–¹æ³•æ—¶ï¼Œä¹Ÿé‡å†™äº† hashCode æ–¹æ³•ï¼Œé‚£ä¹ˆåœ¨æ‰§è¡Œåˆ¤æ–­æ—¶ä¼šå»æ‰§è¡Œé‡å†™çš„ hashCode æ–¹æ³•ï¼Œæ­¤æ—¶å¯¹æ¯”çš„æ˜¯ä¸¤ä¸ªå¯¹è±¡çš„æ‰€æœ‰å±æ€§çš„ hashCode æ˜¯å¦ç›¸åŒï¼Œäºæ˜¯è°ƒç”¨ hashCode è¿”å›çš„ç»“æœå°±æ˜¯ trueï¼Œå†å»è°ƒç”¨ equals æ–¹æ³•ï¼Œå‘ç°ä¸¤ä¸ªå¯¹è±¡ç¡®å®æ˜¯ç›¸ç­‰çš„ï¼Œäºæ˜¯å°±è¿”å› true äº†ï¼Œå› æ­¤ Set é›†åˆå°±ä¸ä¼šå­˜å‚¨ä¸¤ä¸ªä¸€æ¨¡ä¸€æ ·çš„æ•°æ®äº†ï¼Œäºæ˜¯æ•´ä¸ªç¨‹åºçš„æ‰§è¡Œå°±æ­£å¸¸äº†ã€‚\n\n### å€¼ä¼ é€’\n\n#### ä¸ºä»€ä¹ˆ Java ä¸­åªæœ‰å€¼ä¼ é€’\n\nJava é‡‡ç”¨æŒ‰å€¼è°ƒç”¨ï¼Œæ–¹æ³•å¾—åˆ°çš„æ˜¯æ‰€æœ‰å‚æ•°å€¼çš„ä¸€ä¸ªæ‹·è´ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ–¹æ³•ä¸èƒ½ä¿®æ”¹ä¼ é€’ç»™å®ƒçš„ä»»ä½•å‚æ•°å˜é‡çš„å†…å®¹ã€‚\n\nexample 1\n\n```java\npublic static void main(String[] args) {\n    int num1 = 10;\n    int num2 = 20;\n\n    swap(num1, num2);\n\n    System.out.println(\"num1 = \" + num1);\n    System.out.println(\"num2 = \" + num2);\n}\n\npublic static void swap(int a, int b) {\n    int temp = a;\n    a = b;\n    b = temp;\n\n    System.out.println(\"a = \" + a);\n    System.out.println(\"b = \" + b);\n}\n```\n\n**ç»“æœ**ï¼š\n\n```java\na = 20\nb = 10\nnum1 = 10\nnum2 = 20\n```\n\n**è§£æ**ï¼š\n\n![swap(int a, int b)](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNDAyMzk3Mi00ZWQyZjQ0NTlmN2MyYzkwLmpwZw.png)\n\nåœ¨ swap æ–¹æ³•ä¸­ï¼Œaã€b çš„å€¼è¿›è¡Œäº¤æ¢ï¼Œå¹¶ä¸ä¼šå½±å“åˆ° num1ã€num2ã€‚å› ä¸º aã€b ä¸­çš„å€¼ï¼Œåªæ˜¯ä» num1ã€num2 çš„å¤åˆ¶è¿‡æ¥çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œaã€b ç›¸å½“äº num1ã€num2 çš„å‰¯æœ¬ï¼Œå‰¯æœ¬çš„å†…å®¹æ— è®ºæ€ä¹ˆä¿®æ”¹ï¼Œéƒ½ä¸ä¼šå½±å“åˆ°åŸä»¶æœ¬èº«ã€‚\n\n**é€šè¿‡ä¸Šé¢ä¾‹å­ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“äº†ä¸€ä¸ªæ–¹æ³•ä¸èƒ½ä¿®æ”¹ä¸€ä¸ªåŸºæœ¬æ•°æ®ç±»å‹çš„å‚æ•°ï¼Œè€Œå¯¹è±¡å¼•ç”¨ä½œä¸ºå‚æ•°å°±ä¸ä¸€æ ·ï¼Œè¯·çœ‹ example2.**\n\nexample 2\n\n```java\n    public static void main(String[] args) {\n        int[] arr = { 1, 2, 3, 4, 5 };\n        System.out.println(arr[0]);\n        change(arr);\n        System.out.println(arr[0]);\n    }\n\n    public static void change(int[] array) {\n        // å°†æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ å˜ä¸º0\n        array[0] = 0;\n    }\n```\n\n**ç»“æœ**ï¼š\n\n```undefined\n1\n0\n```\n\n**è§£æ**ï¼š\n\n![change(int[] array)](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNDAyMzk3Mi1kYWI5Mzg5ZWRmMjIxNmIzLmpwZw.png)\n\narray è¢«åˆå§‹åŒ– arr çš„æ‹·è´ä¹Ÿå°±æ˜¯ä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ array å’Œ arr æŒ‡å‘çš„æ—¶åŒä¸€ä¸ªæ•°ç»„å¯¹è±¡ã€‚ å› æ­¤ï¼Œå¤–éƒ¨å¯¹å¼•ç”¨å¯¹è±¡çš„æ”¹å˜ä¼šåæ˜ åˆ°æ‰€å¯¹åº”çš„å¯¹è±¡ä¸Šã€‚\n\n**é€šè¿‡ example2 æˆ‘ä»¬å·²ç»çœ‹åˆ°ï¼Œå®ç°ä¸€ä¸ªæ”¹å˜å¯¹è±¡å‚æ•°çŠ¶æ€çš„æ–¹æ³•å¹¶ä¸æ˜¯ä¸€ä»¶éš¾äº‹ã€‚ç†ç”±å¾ˆç®€å•ï¼Œæ–¹æ³•å¾—åˆ°çš„æ˜¯å¯¹è±¡å¼•ç”¨çš„æ‹·è´ï¼Œå¯¹è±¡å¼•ç”¨åŠå…¶ä»–çš„æ‹·è´åŒæ—¶å¼•ç”¨åŒä¸€ä¸ªå¯¹è±¡ã€‚**\n\nexample 3\n\n```java\npublic class Test {\n\n    public static void main(String[] args) {\n        Student s1 = new Student(\"å°å¼ \");\n        Student s2 = new Student(\"å°æ\");\n        Test.swap(s1, s2);\n        System.out.println(\"s1:\" + s1.getName());\n        System.out.println(\"s2:\" + s2.getName());\n    }\n\n    public static void swap(Student x, Student y) {\n        Student temp = x;\n        x = y;\n        y = temp;\n        System.out.println(\"x:\" + x.getName());\n        System.out.println(\"y:\" + y.getName());\n    }\n}\n```\n\n**ç»“æœ**ï¼š\n\n```undefined\nx:å°æ\ny:å°å¼ \ns1:å°å¼ \ns2:å°æ\n```\n\n**è§£æ**ï¼š\n\näº¤æ¢ä¹‹å‰ï¼š\n\n![before swap(Student x, Student y)](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNDAyMzk3Mi03MmIwYzFmYjlmM2IwNzc2LmpwZw.png)\n\näº¤æ¢ä¹‹åï¼š\n\n![after swap(Student x, Student y)](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNDAyMzk3Mi0zYWUzNzY4NGNiMzg2Njc4LmpwZw.png)\n\né€šè¿‡ä¸Šé¢ä¸¤å¼ å›¾å¯ä»¥å¾ˆæ¸…æ™°çš„çœ‹å‡ºï¼š **æ–¹æ³•å¹¶æ²¡æœ‰æ”¹å˜å­˜å‚¨åœ¨å˜é‡ s1 å’Œ s2 ä¸­çš„å¯¹è±¡å¼•ç”¨ã€‚swapæ–¹æ³•çš„å‚æ•°xå’Œyè¢«åˆå§‹åŒ–ä¸ºä¸¤ä¸ªå¯¹è±¡å¼•ç”¨çš„æ‹·è´ï¼Œè¿™ä¸ªæ–¹æ³•äº¤æ¢çš„æ˜¯è¿™ä¸¤ä¸ªæ‹·è´**\n\n#### å€¼ä¼ é€’å’Œå¼•ç”¨ä¼ é€’æœ‰ä»€ä¹ˆåŒºåˆ«\n\nå€¼ä¼ é€’ï¼šæŒ‡çš„æ˜¯åœ¨æ–¹æ³•è°ƒç”¨æ—¶ï¼Œä¼ é€’çš„å‚æ•°æ˜¯æŒ‰å€¼çš„æ‹·è´ä¼ é€’ï¼Œä¼ é€’çš„æ˜¯å€¼çš„æ‹·è´ï¼Œä¹Ÿå°±æ˜¯è¯´ä¼ é€’åå°±äº’ä¸ç›¸å…³äº†ã€‚\n\nå¼•ç”¨ä¼ é€’ï¼šæŒ‡çš„æ˜¯åœ¨æ–¹æ³•è°ƒç”¨æ—¶ï¼Œä¼ é€’çš„å‚æ•°æ˜¯æŒ‰å¼•ç”¨è¿›è¡Œä¼ é€’ï¼Œå…¶å®ä¼ é€’çš„å¼•ç”¨çš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯å˜é‡æ‰€å¯¹åº”çš„å†…å­˜ç©ºé—´çš„åœ°å€ã€‚ä¼ é€’çš„æ˜¯å€¼çš„å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ä¼ é€’å‰å’Œä¼ é€’åéƒ½æŒ‡å‘åŒä¸€ä¸ªå¼•ç”¨ï¼ˆä¹Ÿå°±æ˜¯åŒä¸€ä¸ªå†…å­˜ç©ºé—´ï¼‰ã€‚\n\n## IOæµ\n\n> å‚è€ƒï¼šhttps://blog.csdn.net/weixin_44579258/article/details/90758359\n\né˜»å¡å’Œéé˜»å¡æ˜¯æŒ‡è¿›ç¨‹è®¿é—®çš„æ•°æ®å¦‚æœå°šæœªå‡†å¤‡å°±ç»ªï¼Œè¿›ç¨‹æ˜¯å¦éœ€è¦ç­‰å¾…\nåŒæ­¥å’Œå¼‚æ­¥æ˜¯æŒ‡è®¿é—®æ•°æ®çš„æœºåˆ¶ï¼ŒåŒæ­¥ä¸€èˆ¬ä¸»åŠ¨è¯·æ±‚ç­‰å¾… IO æ“ä½œå®Œæ¯•çš„æ–¹å¼ã€‚å½“æ•°æ®å°±ç»ªåï¼Œå†è¯»å†™çš„æ—¶å€™å¿…é¡»é˜»å¡ï¼Œå¼‚æ­¥åˆ™ä¸»åŠ¨è¯·æ±‚æ•°æ®åä¾¿å¯ä»¥ç»§ç»­å¤„ç†å…¶ä»–ä»»åŠ¡ï¼Œéšåç­‰å¾… IO å®Œæ¯•é€šçŸ¥ï¼Œè¿™å¯ä»¥ä½¿è¿›ç¨‹åœ¨æ•°æ®è¯»å†™æ—¶ä¹Ÿä¸é˜»å¡\n\nå‡†å¤‡æ•°æ®ï¼šç½‘å¡ â†’ å†…æ ¸\næ•°æ®å°±ç»ªï¼šæ•°æ®æ‹·è´åˆ°äº†å†…æ ¸\næ‹·è´æ•°æ®ï¼šå°†å†…æ ¸æ•°æ®æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´\n\n### Blocking I/O\n\n**BIO å±äºåŒæ­¥é˜»å¡ IO æ¨¡å‹** ã€‚\n\nåŒæ­¥é˜»å¡ IO æ¨¡å‹ä¸­ï¼Œåº”ç”¨ç¨‹åº**å‘èµ· read è°ƒç”¨**åï¼Œä¼šä¸€ç›´é˜»å¡ï¼Œç›´åˆ°å†…æ ¸å‡†å¤‡æ•°æ®ã€æ•°æ®å°±ç»ªï¼Œæ•°æ®ä»å†…æ ¸æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´ã€‚\n\n![BIO](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes20190603201109632.png)\n\n### NIO (Non-blocking I/O)\n\nåŒæ­¥éé˜»å¡ IO æ¨¡å‹ä¸­ï¼Œç”¨æˆ·è¿›ç¨‹ä¼š**ä¸€ç›´å‘èµ· read è°ƒç”¨**ï¼ˆå¦‚æœå†…æ ¸è¿”å› error åˆ™è¯´æ˜æ•°æ®æœªå‡†å¤‡å°±ç»ªï¼‰ï¼Œç›´åˆ°æ•°æ®å‡†å¤‡å°±ç»ªï¼Œç”¨æˆ·å‘èµ· read è°ƒç”¨æ—¶ï¼Œæ•°æ®ä»å†…æ ¸ç©ºé—´æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´ï¼ˆç”¨æˆ·è¿›ç¨‹æ˜¯é˜»å¡çš„ï¼‰ã€‚\n\n> ç›¸æ¯”äºåŒæ­¥é˜»å¡ IO æ¨¡å‹ï¼ŒåŒæ­¥éé˜»å¡ IO æ¨¡å‹ç¡®å®æœ‰äº†å¾ˆå¤§æ”¹è¿›ã€‚é€šè¿‡è½®è¯¢æ“ä½œï¼Œé¿å…äº†ä¸€ç›´é˜»å¡ã€‚\n\n![NIO](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes20190603201218527.png)\n\n### IOå¤šè·¯å¤ç”¨ï¼ˆNIOï¼‰\n\nselect/epoll çš„å¥½å¤„å°±åœ¨äºå•ä¸ª process å°±å¯ä»¥åŒæ—¶å¤„ç†å¤šä¸ªç½‘ç»œè¿æ¥çš„ IOã€‚\n\n![NIO](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes2019060320125821.png)\n\nIO å¤ç”¨å’ŒåŒæ­¥é˜»å¡æœ¬è´¨ä¸€æ ·ï¼Œåœ¨ NIO ä¸­ï¼Œæ¯æ¬¡ç”¨æˆ·è¿›ç¨‹è¿›è¡Œ read è½®è¯¢æ•°æ®æ˜¯å¦å‡†å¤‡å°±ç»ªï¼Œè€Œåœ¨ IO å¤šè·¯å¤ç”¨ä¸­ï¼Œåˆ©ç”¨äº†æ–°çš„ select ç³»ç»Ÿè°ƒç”¨ï¼Œç”±å†…æ ¸æ¥è´Ÿè´£æœ¬æ¥æ˜¯è¯·æ±‚è¿›ç¨‹è¯¥åšçš„è½®è¯¢æ“ä½œã€‚\n\nå½“ç”¨æˆ·çº¿ç¨‹è°ƒç”¨ selectï¼Œé‚£ä¹ˆæ•´ä¸ªè¿›ç¨‹ä¼šè¢«é˜»å¡ï¼Œè€ŒåŒæ—¶ï¼Œkernel å†…æ ¸ä¼šâ€œç›‘è§†â€æ‰€æœ‰ select è´Ÿè´£çš„ socketï¼Œå½“ä»»ä½•ä¸€ä¸ª socket ä¸­çš„æ•°æ®å‡†å¤‡å¥½äº†ï¼Œselect å°±ä¼šè¿”å›å¯è¯»æ¡ä»¶è®©ç”¨æˆ·è¿›ç¨‹å‘èµ· read è°ƒç”¨ï¼Œç”¨æˆ·è¿›ç¨‹å‘èµ·è°ƒç”¨ read æ“ä½œï¼Œå°†æ•°æ®ä»å†…æ ¸ç©ºé—´æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´ã€‚\n\n\n### Asynchronous I/O\n\nå¼‚æ­¥ IO æ˜¯åŸºäºäº‹ä»¶å’Œå›è°ƒæœºåˆ¶å®ç°çš„ï¼Œä¹Ÿå°±æ˜¯åº”ç”¨æ“ä½œä¹‹åä¼šç›´æ¥è¿”å›ï¼Œä¸ä¼šå µå¡åœ¨é‚£é‡Œï¼Œå½“åå°å¤„ç†å®Œæˆï¼Œæ“ä½œç³»ç»Ÿä¼šé€šçŸ¥ç›¸åº”çš„çº¿ç¨‹è¿›è¡Œåç»­çš„æ“ä½œã€‚\n\nç”¨æˆ·å‘èµ· read è°ƒç”¨ï¼Œæ­¤æ—¶ç”¨æˆ·è¿›ç¨‹ä¸ä¼šé˜»å¡ã€‚å†…æ ¸å°†æ•°æ®å‡†å¤‡å°±ç»ªå¹¶å°†å…¶ä»å†…æ ¸æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´åï¼Œå†…æ ¸ç»™ç”¨æˆ·è¿›ç¨‹å‘é€ä¸€ä¸ªä¿¡å·ç»™ä¹‹å‰è°ƒç”¨ read çš„è¿›ç¨‹ï¼Œæ•°æ®å·²ç»æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´äº†ã€‚\n\n![AIO](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes2019060320135956.png)\n\n## åå°„\n\n### ä»€ä¹ˆæ˜¯åå°„æœºåˆ¶ï¼Ÿ\n\nJAVA åå°„æœºåˆ¶æ˜¯åœ¨è¿è¡ŒçŠ¶æ€ä¸­ï¼Œå¯¹äºä»»æ„ä¸€ä¸ªç±»ï¼Œéƒ½èƒ½å¤ŸçŸ¥é“è¿™ä¸ªç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼›å¯¹äºä»»æ„ä¸€ä¸ªå¯¹è±¡ï¼Œéƒ½èƒ½å¤Ÿè°ƒç”¨å®ƒçš„ä»»æ„ä¸€ä¸ªæ–¹æ³•å’Œå±æ€§ï¼›è¿™ç§åŠ¨æ€è·å–çš„ä¿¡æ¯ä»¥åŠåŠ¨æ€è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•çš„åŠŸèƒ½ç§°ä¸º Java è¯­è¨€çš„åå°„æœºåˆ¶ã€‚\n\n### åå°„æœºåˆ¶ä¼˜ç¼ºç‚¹\n\n- **ä¼˜ç‚¹ï¼š** è¿è¡ŒæœŸç±»å‹çš„åˆ¤æ–­ï¼ŒåŠ¨æ€åŠ è½½ç±»ï¼Œæé«˜ä»£ç çµæ´»åº¦ã€‚\n- **ç¼ºç‚¹ï¼š** æ€§èƒ½ç“¶é¢ˆï¼šåå°„ç›¸å½“äºä¸€ç³»åˆ—è§£é‡Šæ“ä½œï¼Œé€šçŸ¥ JVM è¦åšçš„äº‹æƒ…ï¼Œæ€§èƒ½æ¯”ç›´æ¥çš„ Java ä»£ç è¦æ…¢å¾ˆå¤šã€‚\n\n### åå°„æœºåˆ¶çš„åº”ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ\n\nâ‘ æˆ‘ä»¬åœ¨ä½¿ç”¨ JDBC è¿æ¥æ•°æ®åº“æ—¶ä½¿ç”¨ Class.forName()é€šè¿‡åå°„åŠ è½½æ•°æ®åº“çš„é©±åŠ¨ç¨‹åºï¼›\n\nâ‘¡Spring é€šè¿‡ XML é…ç½®æ¨¡å¼è£…è½½ Bean çš„è¿‡ç¨‹\n\n1. åŠ è½½é…ç½®æ–‡ä»¶ï¼Œè§£ææˆ BeanDefinition æ”¾åœ¨ Map é‡Œï¼Œmap ä¸­å­˜æ”¾`<BeanNameï¼ŒClasså¯¹è±¡>`çš„æ˜ å°„\n2. è°ƒç”¨ getBean çš„æ—¶å€™ï¼Œä» BeanDefinition æ‰€å±çš„ Map é‡Œï¼Œæ‹¿å‡º Class å¯¹è±¡ä½¿ç”¨åå°„è¿›è¡Œå®ä¾‹åŒ–ï¼ŒåŒæ—¶ï¼Œå¦‚æœæœ‰ä¾èµ–å…³ç³»ï¼Œå°†é€’å½’è°ƒç”¨ getBean æ–¹æ³• â€”â€” å®Œæˆä¾èµ–æ³¨å…¥\n\n### Javaè·å–åå°„çš„ä¸‰ç§æ–¹æ³•\n\n1.é€šè¿‡ new å¯¹è±¡å®ç°åå°„æœºåˆ¶ 2.é€šè¿‡è·¯å¾„å®ç°åå°„æœºåˆ¶ 3.é€šè¿‡ç±»åå®ç°åå°„æœºåˆ¶\n\n## åŒ…è£…ç±»\n\n#### è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±\n\n**è£…ç®±**ï¼šå°†åŸºæœ¬ç±»å‹ç”¨å®ƒä»¬å¯¹åº”çš„å¼•ç”¨ç±»å‹åŒ…è£…èµ·æ¥ï¼›`Integer a = 1;`\n\n**æ‹†ç®±**ï¼šå°†åŒ…è£…ç±»å‹è½¬æ¢ä¸ºåŸºæœ¬æ•°æ®ç±»å‹ï¼›`int b = a;`\n\n#### int å’Œ Integer æœ‰ä»€ä¹ˆåŒºåˆ«\n\nå¼•å…¥åŒ…è£…ç±»æ˜¯ä¸ºäº†èƒ½å¤Ÿå°†è¿™äº›**åŸºæœ¬æ•°æ®ç±»å‹å½“æˆå¯¹è±¡æ“ä½œ**\n\nJava ä¸ºæ¯ä¸ªåŸå§‹ç±»å‹æä¾›äº†åŒ…è£…ç±»å‹ï¼š\n\nåŸå§‹ç±»å‹: booleanï¼Œcharï¼Œbyteï¼Œshortï¼Œintï¼Œlongï¼Œfloatï¼Œdouble\n\nåŒ…è£…ç±»å‹ï¼šBooleanï¼ŒCharacterï¼ŒByteï¼ŒShortï¼ŒIntegerï¼ŒLongï¼ŒFloatï¼ŒDouble\n\n#### Integer a = 127 ä¸ Integer b = 127ç›¸ç­‰å—\n\n> åŒ…è£…ç±»å’ŒåŸºæœ¬æ•°æ®ç±»å‹æ¯”è¾ƒï¼Œä¼šå°†åŒ…è£…ç±»æ‹†ç®±æˆåŸºæœ¬æ•°æ®ç±»å‹ç„¶åæ¯”è¾ƒï¼Œ\n>\n> åªæœ‰å½“åŒ…è£…ç±»æ˜¯è‡ªåŠ¨è£…ç®±ï¼Œå¹¶ä¸”æ•°å€¼èŒƒå›´åœ¨ [-128, 127] æ—¶ï¼Œæ‰ä¼šä½¿ç”¨ cache ä¸­çš„å¯¹è±¡ã€‚\n\nå¯¹äºå¯¹è±¡å¼•ç”¨ç±»å‹ï¼š==æ¯”è¾ƒçš„æ˜¯å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚\nå¯¹äºåŸºæœ¬æ•°æ®ç±»å‹ï¼š==æ¯”è¾ƒçš„æ˜¯å€¼ã€‚\n\n```java\npublic static void main(String[] args) {\n    Integer a = new Integer(3);\n  \tInteger b = 3;\n    int c = 3;\n    Integer d = 3;\n    System.out.println(a == b); // falseï¼Œä¸¤ä¸ªå¯¹è±¡æ¯”è¾ƒ\n    System.out.println(a == c); // trueï¼Œaè‡ªåŠ¨æ‹†ç®±\n    System.out.println(b == c); // trueï¼Œbè‡ªåŠ¨æ‹†ç®±\n    System.out.println(b == d); // trueï¼ŒåŒ…è£…ç±»è‡ªåŠ¨è£…ç®±ä¸”æ•°å€¼èŒƒå›´åœ¨cacheèŒƒå›´å†…\n\n    Integer a = new Integer(128);\n    Integer b = 128;\n    int c = 128;\n    Integer d = 128;\n    System.out.println(a == b); // falseï¼Œä¸¤ä¸ªå¯¹è±¡æ¯”è¾ƒ\n    System.out.println(a == c); // trueï¼Œaè‡ªåŠ¨æ‹†ç®±\n    System.out.println(b == c); // trueï¼Œbè‡ªåŠ¨æ‹†ç®±\n    System.out.println(b == d); // falseï¼ŒåŒ…è£…ç±»è‡ªåŠ¨è£…ç®±ä½†æ˜¯æ•°å€¼èŒƒå›´ä¸åœ¨cacheèŒƒå›´å†…\n}\n```\n\n","source":"_posts/Javaå…«è‚¡æ–‡ - JavaåŸºç¡€.md","raw":"---\ntitle: Javaå…«è‚¡æ–‡ - JavaåŸºç¡€\ncopyright: true\nmathjax: false\ncategories:\n  - Javaå…«è‚¡æ–‡\ndate: 2023-01-23 10:05:51\ntags:\ntoc: true\nurlname: java-basic-knowledge\n---\n\n> æ•´ç†çš„JavaåŸºç¡€ç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½\t<!--more-->\n\n## Javaæ¦‚è¿°\n\n### JVMã€JREå’ŒJDKçš„å…³ç³»\n\nJVMï¼šJava Virtual Machineï¼ŒJava è™šæ‹Ÿæœºï¼ŒJava ç¨‹åºéœ€è¦è¿è¡Œåœ¨è™šæ‹Ÿæœºä¸Šï¼Œä¸åŒçš„å¹³å°æœ‰è‡ªå·±çš„è™šæ‹Ÿæœºï¼Œå› æ­¤ Java è¯­è¨€å¯ä»¥å®ç°è·¨å¹³å°ã€‚\n\nJREï¼šJava Runtime Environmentï¼ŒJava è¿è¡Œç¯å¢ƒï¼ŒåŒ…æ‹¬ Java è™šæ‹Ÿæœºå’Œ Java ç¨‹åºæ‰€éœ€çš„æ ¸å¿ƒç±»åº“ç­‰ã€‚\n\nJDKï¼šJava Development Kitï¼ŒJava å¼€å‘å·¥å…·åŒ…ï¼ŒåŒ…æ‹¬äº† JRE å’Œå¼€å‘å·¥å…·ã€‚\n\n### ä»€ä¹ˆæ˜¯è·¨å¹³å°æ€§ï¼ŸåŸç†æ˜¯ä»€ä¹ˆ\n\næ‰€è°“è·¨å¹³å°æ€§ï¼Œæ˜¯æŒ‡ Java è¯­è¨€ç¼–å†™çš„ç¨‹åºï¼Œä¸€æ¬¡ç¼–è¯‘ï¼Œåˆ°å¤„è¿è¡Œã€‚\n\nå®ç°åŸç†ï¼šJava ç¨‹åºæ˜¯é€šè¿‡ Java è™šæ‹Ÿæœºåœ¨ç³»ç»Ÿå¹³å°ä¸Šè¿è¡Œçš„ï¼Œåªè¦è¯¥ç³»ç»Ÿå¯ä»¥å®‰è£…ç›¸åº”çš„ Java è™šæ‹Ÿæœºï¼Œè¯¥ç³»ç»Ÿå°±å¯ä»¥è¿è¡Œ Java ç¨‹åºã€‚\n\n### Javaè¯­è¨€æœ‰å“ªäº›ç‰¹ç‚¹\n\né¢å‘å¯¹è±¡ï¼ˆå°è£…ï¼Œç»§æ‰¿ï¼Œå¤šæ€ï¼‰\n\nå¹³å°æ— å…³æ€§ï¼ˆJava è™šæ‹Ÿæœºå®ç°å¹³å°æ— å…³æ€§ï¼‰\n\n### ä»€ä¹ˆæ˜¯å­—èŠ‚ç ï¼Ÿé‡‡ç”¨å­—èŠ‚ç çš„æœ€å¤§å¥½å¤„æ˜¯ä»€ä¹ˆ\n\n**å­—èŠ‚ç **ï¼šJava æºä»£ç ç»è¿‡è™šæ‹Ÿæœºç¼–è¯‘å™¨ç¼–è¯‘åäº§ç”Ÿçš„æ–‡ä»¶ï¼ˆå³æ‰©å±•ä¸º.class çš„æ–‡ä»¶ï¼‰ï¼Œå®ƒä¸é¢å‘ä»»ä½•ç‰¹å®šçš„å¤„ç†å™¨ï¼Œåªé¢å‘è™šæ‹Ÿæœºã€‚ï¼ˆjavac HelloWorld.Java â†’ HelloWorld.class â†’ Java HelloWorld æ‰§è¡Œç¨‹åºï¼‰\n\n**ç¼–è¯‘ä¸è§£é‡Šå¹¶å­˜**\n\nJava æºä»£ç (.Java æ–‡ä»¶)---->ç¼–è¯‘å™¨---->jvm å¯æ‰§è¡Œçš„ Java å­—èŠ‚ç (.class æ–‡ä»¶)---->jvm---->jvm ä¸­è§£é‡Šå™¨----->æœºå™¨å¯æ‰§è¡Œçš„äºŒè¿›åˆ¶æœºå™¨ç ---->ç¨‹åºè¿è¡Œ\n\n### ä»€ä¹ˆæ˜¯Javaç¨‹åºçš„ä¸»ç±»ï¼Ÿ\n\nä¸€ä¸ªç¨‹åºä¸­å¯ä»¥æœ‰å¤šä¸ªç±»ï¼Œä½†åªèƒ½æœ‰ä¸€ä¸ªç±»æ˜¯ä¸»ç±»ã€‚åœ¨ Java åº”ç”¨ç¨‹åºä¸­ï¼Œè¿™ä¸ªä¸»ç±»æ˜¯æŒ‡åŒ…å« main()æ–¹æ³•çš„ç±»ã€‚\nä¸»ç±»æ˜¯ Java ç¨‹åºæ‰§è¡Œçš„å…¥å£ã€‚ï¼ˆmain æ–¹æ³•é™¤äº†æ˜¯ä¸ªä¸»æ–¹æ³•ä»¥å¤–ï¼Œå’Œæ™®é€šçš„é™æ€æ–¹æ³•æ²¡æœ‰åŒºåˆ«ï¼Œéƒ½å¯ä»¥é‡è½½ã€è°ƒç”¨ã€ç»§æ‰¿ï¼‰\n\n### Javaå’ŒC++çš„åŒºåˆ«\n\nç›¸åŒç‚¹ï¼šéƒ½æ˜¯**é¢å‘å¯¹è±¡**çš„è¯­è¨€ï¼Œéƒ½æ”¯æŒ**å°è£…ã€ç»§æ‰¿å’Œå¤šæ€**\n\nä¸åŒç‚¹ï¼š\n\n- **Javaä¸æä¾›æŒ‡é’ˆ**æ¥ç›´æ¥è®¿é—®å†…å­˜ï¼Œç¨‹åºå†…å­˜æ›´åŠ å®‰å…¨ï¼Œæœ‰è‡ªåŠ¨å†…å­˜ç®¡ç†ï¼›C++ç”¨æŒ‡é’ˆç®¡ç†å†…å­˜\n\n- Java çš„**ç±»æ˜¯å•ç»§æ‰¿**çš„ï¼ŒC++æ”¯æŒå¤šé‡ç»§æ‰¿ï¼›è™½ç„¶ Java çš„ç±»ä¸å¯ä»¥å¤šç»§æ‰¿ï¼Œä½†æ˜¯æ¥å£å¯ä»¥å¤šç»§æ‰¿ã€‚\n\n\tä¸ºä»€ä¹ˆ Java ä¸­ç±»ä¸æ”¯æŒå¤šç»§æ‰¿ï¼Ÿâ€”â€”å¤šé‡ç»§æ‰¿çš„é’»çŸ³é—®é¢˜\n\t\n\t![å¤šé‡ç»§æ‰¿çš„é’»çŸ³é—®é¢˜](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes20190622142003813.png)\n\tç±» B å’Œç±» C ç»§æ‰¿è‡ªç±» Aï¼Œä¸”éƒ½é‡å†™äº†ç±» A ä¸­çš„åŒä¸€ä¸ªæ–¹æ³•ï¼Œè€Œç±» D åŒæ—¶ç»§æ‰¿äº†ç±» B å’Œç±» Cï¼ˆå¤šç»§æ‰¿)ï¼Œé‚£ä¹ˆæ­¤æ—¶ç±» D ä¼šç»§æ‰¿ Bã€C çš„æ–¹æ³•ï¼Œé‚£å¯¹äº Bã€C é‡å†™çš„ A ä¸­çš„æ–¹æ³•ï¼Œç±» D ä¼šç»§æ‰¿å“ªä¸€ä¸ªå‘¢ï¼Ÿ\n\n- Java æœ‰**è‡ªåŠ¨å†…å­˜ç®¡ç†**æœºåˆ¶ï¼Œä¸éœ€è¦ç¨‹åºå‘˜æ‰‹åŠ¨é‡Šæ”¾æ— ç”¨å†…å­˜\n\n## åŸºç¡€è¯­æ³•\n\n### æ•°æ®ç±»å‹\n\n**å®šä¹‰**ï¼šJava è¯­è¨€æ˜¯å¼ºç±»å‹è¯­è¨€ï¼Œå¯¹äºæ¯ä¸€ç§æ•°æ®éƒ½å®šä¹‰äº†æ˜ç¡®çš„å…·ä½“çš„æ•°æ®ç±»å‹ï¼Œåœ¨å†…å­˜ä¸­åˆ†é…äº†ä¸åŒå¤§å°çš„å†…å­˜ç©ºé—´ã€‚\n\n**åˆ†ç±»**\n\n- åŸºæœ¬æ•°æ®ç±»å‹\n\t- æ•°å€¼å‹\n\t\t- æ•´æ•°ç±»å‹(byte,short,int,long)\n\t\t- æµ®ç‚¹ç±»å‹(float,double)\n\t- å­—ç¬¦å‹(char)\n\t- å¸ƒå°”å‹(boolean)\n- å¼•ç”¨æ•°æ®ç±»å‹\n\t- ç±»(class)\n\t- æ¥å£(interface)\n\t- æ•°ç»„([])\n\n**JavaåŸºæœ¬æ•°æ®ç±»å‹å›¾**\n\n![JavaåŸºæœ¬æ•°æ®ç±»å‹å›¾](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0pvdXJXb24vaW1hZ2UvbWFzdGVyL0phdmElRTUlOUYlQkElRTclQTElODAlRTglQUYlQUQlRTYlQjMlOTUvSmF2YSVFNSU5RiVCQSVFNiU5QyVBQyVFNiU5NSVCMCVFNiU4RCVBRSVFNyVCMSVCQiVFNSU5RSU4Qi5wbmc.png)\n\n### ç±»å‹è½¬æ¢\n\nè‡ªåŠ¨ç±»å‹è½¬æ¢\n\n> ä¸¤ç§æ•°æ®ç±»å‹å½¼æ­¤å…¼å®¹\n>\n> ä½çº§ç±»å‹æ•°æ®è½¬æ¢æˆé«˜çº§ç±»å‹æ•°æ®\n\n- æ•°å€¼å‹æ•°æ®çš„è½¬æ¢ï¼šbyteâ†’shortâ†’intâ†’longâ†’floatâ†’double\n- å­—ç¬¦å‹è½¬æ¢ä¸ºæ•´å‹ï¼šcharâ†’intã€‚\n\nå¼ºåˆ¶ç±»å‹è½¬æ¢\n\n> å½“ä¸¤ç§æ•°æ®ç±»å‹ä¸å…¼å®¹ï¼Œæˆ–é«˜çº§ç±»å‹æ•°æ®è½¬æ¢æˆä½çº§ç±»å‹æ•°æ®æ—¶ï¼Œè‡ªåŠ¨è½¬æ¢å°†æ— æ³•è¿›è¡Œï¼ˆç¼–è¯‘é”™è¯¯ï¼‰ï¼Œè¿™æ—¶å°±éœ€è¦è¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢\n\n### è®¿é—®ä¿®é¥°ç¬¦\n\n![è®¿é—®ä¿®é¥°ç¬¦](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0pvdXJXb24vaW1hZ2UvbWFzdGVyL0phdmElRTUlOUYlQkElRTclQTElODAlRTglQUYlQUQlRTYlQjMlOTUvSmF2YSVFOCVBRSVCRiVFOSU5NyVBRSVFNCVCRiVBRSVFOSVBNSVCMCVFNyVBQyVBNi5wbmc.png)\n\n### å…³é”®å­—\n\n#### final æœ‰ä»€ä¹ˆç”¨ï¼Ÿ\n\nç”¨äºä¿®é¥°ç±»ã€æ–¹æ³•å’Œå˜é‡ï¼›\n\n- è¢« final ä¿®é¥°çš„ç±»ä¸å¯ä»¥è¢«ç»§æ‰¿\n\n- è¢« final ä¿®é¥°çš„æ–¹æ³•ä¸å¯ä»¥è¢«é‡å†™\n\n- è¢« final ä¿®é¥°çš„å˜é‡ä¸å¯ä»¥è¢«æ”¹å˜ï¼Œè¢« final ä¿®é¥°**ä¸å¯å˜çš„æ˜¯å˜é‡çš„å¼•ç”¨ï¼Œè€Œä¸æ˜¯å¼•ç”¨æŒ‡å‘çš„å†…å®¹**ï¼Œå¼•ç”¨æŒ‡å‘çš„å†…å®¹æ˜¯å¯ä»¥æ”¹å˜\n\n\t```java\n\tfinal int[] nums = new int[]{1, 2, 3};\n\tnums[0] = 11;\n\tSystem.out.println(Arrays.toString(nums));\t// [11, 2, 3]\n\t```\n\n#### finalã€finallyã€finalizeåŒºåˆ«\n\n- final æ˜¯ Java ä¿®é¥°ç¬¦ï¼Œå¯ä»¥ä¿®é¥°ç±»ã€æ–¹æ³•ã€å˜é‡ï¼Œä¿®é¥°ç±»è¡¨ç¤ºè¯¥ç±»ä¸èƒ½è¢«ç»§æ‰¿ã€ä¿®é¥°æ–¹æ³•è¡¨ç¤ºè¯¥æ–¹æ³•ä¸èƒ½è¢«é‡å†™ã€ä¿®é¥°å˜é‡è¡¨ç¤ºè¯¥å˜é‡ä¸å¯ä»¥è¢«æ”¹å˜ã€‚\n- finally ä¸€èˆ¬ä½œç”¨åœ¨ try-catch ä»£ç å—ä¸­ï¼Œåœ¨å¤„ç†å¼‚å¸¸çš„æ—¶å€™ï¼Œé€šå¸¸æˆ‘ä»¬å°†ä¸€å®šè¦æ‰§è¡Œçš„ä»£ç æ”¾åœ¨ finally ä»£ç å—ä¸­ï¼Œè¡¨ç¤ºä¸ç®¡æ˜¯å¦å‡ºç°å¼‚å¸¸ï¼Œè¯¥ä»£ç å—éƒ½ä¼šæ‰§è¡Œï¼Œä¸€èˆ¬ç”¨æ¥å­˜æ”¾ä¸€äº›å…³é—­èµ„æºçš„ä»£ç ã€‚\n\n- finalize æ˜¯ Object ç±»çš„ä¸€ä¸ªæ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¸€èˆ¬ç”±åƒåœ¾å›æ”¶å™¨æ¥è°ƒç”¨ï¼Œåœ¨æ‰§è¡Œåƒåœ¾å›æ”¶å‰ï¼Œç”±åƒåœ¾å›æ”¶å™¨è°ƒç”¨å¯¹è±¡çš„ finalize()æ–¹æ³•ï¼Œå¹¶ä¸”åœ¨è¯¥æ–¹æ³•ä¸­å¯¹è±¡å¯èƒ½å¯ä»¥å¤æ´»ã€‚\n\n#### thiså…³é”®å­—çš„ç”¨æ³•\n\næŒ‡å‘å¯¹è±¡æœ¬èº«çš„ä¸€ä¸ªæŒ‡é’ˆã€‚\n\n#### superå…³é”®å­—çš„ç”¨æ³•\n\næŒ‡å‘è‡ªå·±çˆ¶ç±»å¯¹è±¡ï¼ˆæœ€è¿‘çš„çˆ¶ç±»ï¼‰çš„ä¸€ä¸ªæŒ‡é’ˆã€‚\n\n#### staticå­˜åœ¨çš„ä¸»è¦æ„ä¹‰\n\nstatic**é™æ€å˜é‡**ï¼šå’Œç±»ä¸€èµ·åŠ è½½ï¼Œ**ä»¥è‡´äºå³ä½¿æ²¡æœ‰åˆ›å»ºå¯¹è±¡ï¼Œä¹Ÿèƒ½ä½¿ç”¨å±æ€§å’Œè°ƒç”¨æ–¹æ³•ã€‚**\n\nstatic**é™æ€ä»£ç å—**ï¼šåœ¨ç±»åˆæ¬¡è¢«åŠ è½½çš„æ—¶å€™ï¼Œä¼šæŒ‰ç…§ static å—çš„é¡ºåºæ¥æ‰§è¡Œæ¯ä¸ª static å—ï¼Œå¹¶ä¸”åªä¼šæ‰§è¡Œä¸€æ¬¡ã€‚\nåŠ è½½ â†’ é“¾æ¥ï¼ˆéªŒè¯ã€å‡†å¤‡ã€è§£æï¼‰ â†’ åˆå§‹åŒ–\n\nstatic ç±»å‹çš„å˜é‡åœ¨å‡†å¤‡é˜¶æ®µè¿›è¡Œé»˜è®¤åˆå§‹åŒ–ï¼Œä½†æ˜¯æœ‰ static final ä¿®é¥°çš„ä¼šåœ¨å‡†å¤‡é˜¶æ®µç›´æ¥èµ‹å€¼ï¼Œ åœ¨åˆå§‹åŒ–é˜¶æ®µè¿›è¡Œæ˜¾å¼åˆå§‹åŒ–ã€‚\n\n#### staticæ³¨æ„äº‹é¡¹\n\n1ã€é™æ€åªèƒ½è®¿é—®é™æ€ã€‚ 2ã€éé™æ€æ—¢å¯ä»¥è®¿é—®éé™æ€çš„ï¼Œä¹Ÿå¯ä»¥è®¿é—®é™æ€çš„ã€‚\n\n### åˆå§‹åŒ–é¡ºåº\n\né™æ€å±æ€§ â†’ é™æ€æ–¹æ³•å— â†’ æ™®é€šå±æ€§ â†’ æ™®é€šæ–¹æ³•å— â†’ æ„é€ å‡½æ•°\n\n### æµç¨‹æ§åˆ¶è¯­å¥\n\n#### break ã€continueã€return çš„åŒºåˆ«åŠä½œç”¨\n\nbreak ç»“æŸå½“å‰çš„å¾ªç¯ä½“\n\ncontinue ç»“æŸæ­£åœ¨æ‰§è¡Œçš„å¾ªç¯ï¼Œè¿›å…¥ä¸‹ä¸€ä¸ªå¾ªç¯æ¡ä»¶\n\nreturn ç»“æŸå½“å‰çš„æ–¹æ³•ï¼Œç›´æ¥è¿”å›\n\n#### è·³å‡ºå½“å‰çš„å¤šé‡åµŒå¥—å¾ªç¯\n\nåœ¨ Java ä¸­ï¼Œè¦æƒ³è·³å‡ºå¤šé‡å¾ªç¯ï¼Œå¯ä»¥åœ¨å¤–é¢çš„å¾ªç¯è¯­å¥å‰å®šä¹‰ä¸€ä¸ªæ ‡å·ï¼Œç„¶ååœ¨é‡Œå±‚å¾ªç¯ä½“çš„ä»£ç ä¸­ä½¿ç”¨å¸¦æœ‰æ ‡å·çš„ break è¯­å¥ï¼Œå³å¯è·³å‡ºå¤–å±‚å¾ªç¯ã€‚ä¾‹å¦‚ï¼š\n\n```java\npublic static void main(String[] args) {\n    ok:\n    for (int i = 0; i < 10; i++) {\n        for (int j = 0; j < 10; j++) {\n            System.out.println(\"i=\" + i + \",j=\" + j);\n            if (j == 5) {\n                break ok;\n            }\n        }\n    }\n}\n```\n\n## é¢å‘å¯¹è±¡\n\n### é¢å‘å¯¹è±¡ä¸‰å¤§ç‰¹æ€§\n\n#### é¢å‘å¯¹è±¡çš„ç‰¹å¾æœ‰å“ªäº›æ–¹é¢\n\n**æŠ½è±¡**ï¼šæŠ½è±¡æ˜¯å°†ä¸€ç±»å¯¹è±¡çš„å…±åŒç‰¹å¾æ€»ç»“å‡ºæ¥æ„é€ ç±»çš„è¿‡ç¨‹ï¼ŒåŒ…æ‹¬æ•°æ®æŠ½è±¡å’Œè¡Œä¸ºæŠ½è±¡ä¸¤æ–¹é¢ã€‚æŠ½è±¡åªå…³æ³¨å¯¹è±¡æœ‰å“ªäº›å±æ€§å’Œè¡Œä¸ºï¼Œå¹¶ä¸å…³æ³¨è¿™äº›è¡Œä¸ºçš„ç»†èŠ‚æ˜¯ä»€ä¹ˆã€‚\n\n**å°è£…**\n\nå°è£…æŠŠä¸€ä¸ªå¯¹è±¡çš„å±æ€§ç§æœ‰åŒ–ï¼ŒåŒæ—¶æä¾›ä¸€äº›å¯ä»¥è¢«å¤–ç•Œè®¿é—®çš„å±æ€§çš„æ–¹æ³•ï¼Œå¦‚æœå±æ€§ä¸æƒ³è¢«å¤–ç•Œè®¿é—®ï¼Œæˆ‘ä»¬å¤§å¯ä¸å¿…æä¾›æ–¹æ³•ç»™å¤–ç•Œè®¿é—®ã€‚\n\n**ç»§æ‰¿**\n\nç»§æ‰¿æ˜¯**ä½¿ç”¨å·²å­˜åœ¨çš„ç±»ä½œä¸ºåŸºç¡€å»ºç«‹æ–°ç±»**çš„æŠ€æœ¯ï¼Œæ–°ç±»çš„å®šä¹‰å¯ä»¥å¢åŠ æ–°çš„æ•°æ®æˆ–æ–°çš„åŠŸèƒ½ï¼Œä¹Ÿå¯ä»¥ç”¨çˆ¶ç±»çš„åŠŸèƒ½ã€‚é€šè¿‡ä½¿ç”¨ç»§æ‰¿æˆ‘ä»¬èƒ½å¤Ÿéå¸¸æ–¹ä¾¿åœ°å¤ç”¨ä»¥å‰çš„ä»£ç ã€‚\n\nå…³äºç»§æ‰¿å¦‚ä¸‹ 3 ç‚¹è¯·è®°ä½ï¼š\n\n1. å­ç±»æ‹¥æœ‰çˆ¶ç±»é private çš„å±æ€§å’Œæ–¹æ³•ã€‚\n2. å­ç±»å¯ä»¥æ‹¥æœ‰è‡ªå·±å±æ€§å’Œæ–¹æ³•ï¼Œå³å­ç±»å¯ä»¥å¯¹çˆ¶ç±»è¿›è¡Œæ‰©å±•ã€‚\n3. å­ç±»å¯ä»¥ç”¨è‡ªå·±çš„æ–¹å¼å®ç°çˆ¶ç±»çš„æ–¹æ³•ï¼Œoverride é‡å†™ã€‚\n\n**å¤šæ€**\n\næ‰€è°“å¤šæ€å°±æ˜¯æŒ‡ä¸€ä¸ªå¼•ç”¨å˜é‡åˆ°åº•ä¼šæŒ‡å‘å“ªä¸ªç±»çš„å®ä¾‹å¯¹è±¡ï¼Œè¯¥å¼•ç”¨å˜é‡è°ƒç”¨çš„æ–¹æ³•åˆ°åº•æ˜¯å“ªä¸ªç±»ä¸­å®ç°çš„æ–¹æ³•ï¼Œå¿…é¡»åœ¨ç¨‹åºè¿è¡ŒæœŸé—´æ‰èƒ½ç¡®å®šï¼Œç¼–è¯‘æœŸæ— æ³•ç¡®å®šã€‚\n\nçˆ¶ç±»çš„å¼•ç”¨æŒ‡å‘å­ç±»å®ä¾‹å¯¹è±¡ã€æ¥å£æŒ‡å‘å®ç°ç±»å®ä¾‹å¯¹è±¡ã€‚æé«˜äº†ç¨‹åºçš„æ‹“å±•æ€§ã€‚\n\nåœ¨ Java ä¸­æœ‰ä¸¤ç§å½¢å¼å¯ä»¥å®ç°å¤šæ€ï¼šç»§æ‰¿ï¼ˆå¤šä¸ªå­ç±»å¯¹åŒä¸€æ–¹æ³•çš„é‡å†™ï¼‰å’Œæ¥å£ï¼ˆå®ç°æ¥å£å¹¶è¦†ç›–æ¥å£ä¸­åŒä¸€æ–¹æ³•ï¼‰ã€‚\n\næ–¹æ³•é‡è½½ï¼ˆoverloadï¼‰å®ç°ç¼–è¯‘æ—¶çš„å¤šæ€æ€§ï¼ˆä¹Ÿç§°ä¸ºå‰ç»‘å®šï¼‰ï¼Œæ–¹æ³•é‡å†™ï¼ˆoverrideï¼‰å®ç°è¿è¡Œæ—¶çš„å¤šæ€æ€§ï¼ˆä¹Ÿç§°ä¸ºåç»‘å®šï¼‰ã€‚\n\nJava å®ç°å¤šæ€æœ‰ä¸‰ä¸ªå¿…è¦æ¡ä»¶ï¼šç»§æ‰¿ã€é‡å†™ã€å‘ä¸Šè½¬å‹ã€‚\n\n> ç»§æ‰¿ï¼šåœ¨å¤šæ€ä¸­å¿…é¡»å­˜åœ¨æœ‰ç»§æ‰¿å…³ç³»çš„å­ç±»å’Œçˆ¶ç±»ã€‚\n>\n> é‡å†™ï¼šå­ç±»å¯¹çˆ¶ç±»ä¸­æŸäº›æ–¹æ³•è¿›è¡Œé‡æ–°å®šä¹‰ï¼Œåœ¨è°ƒç”¨è¿™äº›æ–¹æ³•æ—¶å°±ä¼šè°ƒç”¨å­ç±»çš„æ–¹æ³•ã€‚\n>\n> å‘ä¸Šè½¬å‹ï¼šåœ¨å¤šæ€ä¸­éœ€è¦å°†å­ç±»çš„å¼•ç”¨èµ‹ç»™çˆ¶ç±»å¯¹è±¡ï¼Œåªæœ‰è¿™æ ·è¯¥å¼•ç”¨æ‰èƒ½å¤Ÿå…·å¤‡æŠ€èƒ½è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•å’Œå­ç±»çš„æ–¹æ³•ã€‚\n\nåªæœ‰æ»¡è¶³äº†ä¸Šè¿°ä¸‰ä¸ªæ¡ä»¶ï¼Œæˆ‘ä»¬æ‰èƒ½å¤Ÿåœ¨åŒä¸€ä¸ªç»§æ‰¿ç»“æ„ä¸­ä½¿ç”¨ç»Ÿä¸€çš„é€»è¾‘å®ç°ä»£ç å¤„ç†ä¸åŒçš„å¯¹è±¡ï¼Œä»è€Œè¾¾åˆ°æ‰§è¡Œä¸åŒçš„è¡Œä¸ºã€‚\n\n#### æŠ½è±¡ç±»å’Œæ¥å£çš„å¯¹æ¯”\n\næŠ½è±¡ç±»æ˜¯å¯¹ç±»çš„æŠ½è±¡ï¼Œç”¨æ¥**æ•æ‰é€šç”¨ç‰¹æ€§**ã€‚æ¥å£æ˜¯**è¡Œä¸ºçš„æŠ½è±¡**ï¼ŒæŠ½è±¡æ–¹æ³•çš„é›†åˆã€‚\n\n**ç›¸åŒç‚¹**\n\n- æ¥å£å’ŒæŠ½è±¡ç±»éƒ½ä¸èƒ½å®ä¾‹åŒ–\n- éƒ½ä½äºç»§æ‰¿çš„é¡¶ç«¯ï¼Œç”¨äºè¢«å…¶ä»–ç±»å®ç°æˆ–ç»§æ‰¿\n- éƒ½åŒ…å«æŠ½è±¡æ–¹æ³•ï¼Œå…¶å­ç±»éƒ½å¿…é¡»é‡å†™è¿™äº›æŠ½è±¡æ–¹æ³•\n\n**ä¸åŒç‚¹**\n\n| å‚æ•°       | æŠ½è±¡ç±»                             | æ¥å£                                             |\n| ---------- | ---------------------------------- | ------------------------------------------------ |\n| å£°æ˜       | æŠ½è±¡ç±»ä½¿ç”¨abstractå…³é”®å­—å£°æ˜       | æ¥å£ä½¿ç”¨interfaceå…³é”®å­—å£°æ˜                      |\n| å®ç°       | å­ç±»ä½¿ç”¨extendså…³é”®å­—æ¥ç»§æ‰¿æŠ½è±¡ç±»  | å­ç±»ä½¿ç”¨implementså…³é”®å­—æ¥å®ç°æ¥å£               |\n| æ„é€ å™¨     | æŠ½è±¡ç±»å¯ä»¥æœ‰æ„é€ å™¨                 | æ¥å£ä¸èƒ½æœ‰æ„é€ å™¨                                 |\n| è®¿é—®ä¿®é¥°ç¬¦ | æŠ½è±¡ç±»ä¸­çš„æ–¹æ³•å¯ä»¥æ˜¯ä»»æ„è®¿é—®ä¿®é¥°ç¬¦ | æ¥å£æ–¹æ³•é»˜è®¤ä¿®é¥°ç¬¦æ˜¯publicï¼Œä¹Ÿå¯ä»¥ä¸åŠ è®¿é—®ä¿®é¥°ç¬¦ |\n| å¤šç»§æ‰¿     | ä¸€ä¸ªç±»æœ€å¤šåªèƒ½ç»§æ‰¿ä¸€ä¸ªæŠ½è±¡ç±»       | ä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£                           |\n\n#### æ™®é€šç±»å’ŒæŠ½è±¡ç±»æœ‰å“ªäº›åŒºåˆ«ï¼Ÿ\n\n- æ™®é€šç±»ä¸èƒ½åŒ…å«æŠ½è±¡æ–¹æ³•ï¼ŒæŠ½è±¡ç±»å¯ä»¥åŒ…å«æŠ½è±¡æ–¹æ³•ã€‚\n- æŠ½è±¡ç±»ä¸èƒ½ç›´æ¥å®ä¾‹åŒ–ï¼Œæ™®é€šç±»å¯ä»¥ç›´æ¥å®ä¾‹åŒ–ã€‚\n\n#### æˆå‘˜å˜é‡å’Œå±€éƒ¨å˜é‡çš„åŒºåˆ«\n\n|              | æˆå‘˜å˜é‡               | å±€éƒ¨å˜é‡                                     |\n| ------------ | ---------------------- | -------------------------------------------- |\n| **ä½œç”¨åŸŸ**   | æ•´ä¸ªç±»å¯ä½¿ç”¨           | æ–¹æ³•ä½“å†…ä½¿ç”¨                                 |\n| **å­˜å‚¨ä½ç½®** | å±äºå¯¹è±¡ï¼Œå­˜åœ¨å †å†…å­˜ä¸­ | å±äºæ–¹æ³•ï¼Œå­˜åœ¨æ ˆå¸§ä¸­                         |\n| **ç”Ÿå‘½å‘¨æœŸ** | å’Œå¯¹è±¡åŒç”Ÿå‘½å‘¨æœŸ       | å’Œæ–¹æ³•åŒç”Ÿå‘½å‘¨æœŸ                             |\n| **åˆå§‹å€¼**   | ä¸æŒ‡å®šçš„è¯æœ‰é»˜è®¤åˆå§‹å€¼ | å¿…é¡»æ‰‹åŠ¨åˆå§‹åŒ–å¦åˆ™<br />ä¸èƒ½ä½¿ç”¨ï¼ˆç¼–è¯‘é”™è¯¯ï¼‰ |\n\n**ä½¿ç”¨åŸåˆ™**\n\nåœ¨ä½¿ç”¨å˜é‡æ—¶éœ€è¦éµå¾ªçš„åŸåˆ™ä¸ºï¼šå°±è¿‘åŸåˆ™\né¦–å…ˆåœ¨å±€éƒ¨èŒƒå›´æ‰¾ï¼Œæœ‰å°±ä½¿ç”¨ï¼›æ¥ç€åœ¨æˆå‘˜ä½ç½®æ‰¾ã€‚\n\n```java\npublic class Main {\n    int a = 2;\n    public static void main(String[] args) {\n        int a = 1;\n        System.out.println(a);\t// 1\n    }\n}\n```\n\n### å†…éƒ¨ç±»\n\n#### ä»€ä¹ˆæ˜¯å†…éƒ¨ç±»ï¼Ÿ\n\nåœ¨ Java ä¸­ï¼Œå¯ä»¥å°†ä¸€ä¸ªç±»çš„å®šä¹‰æ”¾åœ¨å¦å¤–ä¸€ä¸ªç±»çš„å®šä¹‰å†…éƒ¨ï¼Œè¿™å°±æ˜¯**å†…éƒ¨ç±»**ã€‚\n\n#### å†…éƒ¨ç±»çš„åˆ†ç±»æœ‰å“ªäº›\n\nå†…éƒ¨ç±»å¯ä»¥åˆ†ä¸ºå››ç§ï¼š**é™æ€å†…éƒ¨ç±»ã€æˆå‘˜å†…éƒ¨ç±»ã€å±€éƒ¨å†…éƒ¨ç±»ã€åŒ¿åå†…éƒ¨ç±»**ã€‚\n\n##### é™æ€å†…éƒ¨ç±»\n\nå®šä¹‰åœ¨ç±»å†…éƒ¨çš„é™æ€ç±»ï¼Œå°±æ˜¯é™æ€å†…éƒ¨ç±»ã€‚\n\né™æ€å†…éƒ¨ç±»å¯ä»¥è®¿é—®å¤–éƒ¨ç±»æ‰€æœ‰çš„é™æ€å˜é‡ï¼Œè€Œä¸å¯è®¿é—®å¤–éƒ¨ç±»çš„éé™æ€å˜é‡\n\n##### æˆå‘˜å†…éƒ¨ç±»\n\nå®šä¹‰åœ¨ç±»å†…éƒ¨ï¼Œæˆå‘˜ä½ç½®ä¸Šçš„éé™æ€ç±»ï¼Œå°±æ˜¯æˆå‘˜å†…éƒ¨ç±»ã€‚\n\næˆå‘˜å†…éƒ¨ç±»å¯ä»¥è®¿é—®å¤–éƒ¨ç±»æ‰€æœ‰çš„å˜é‡å’Œæ–¹æ³•ï¼ŒåŒ…æ‹¬é™æ€å’Œéé™æ€ï¼Œç§æœ‰å’Œå…¬æœ‰ã€‚\n\n##### å±€éƒ¨å†…éƒ¨ç±»\n\nå®šä¹‰åœ¨æ–¹æ³•ä¸­çš„å†…éƒ¨ç±»ï¼Œå°±æ˜¯å±€éƒ¨å†…éƒ¨ç±»ã€‚\n\nå®šä¹‰åœ¨å®ä¾‹æ–¹æ³•ä¸­çš„å±€éƒ¨ç±»å¯ä»¥è®¿é—®å¤–éƒ¨ç±»çš„æ‰€æœ‰å˜é‡å’Œæ–¹æ³•ï¼Œå®šä¹‰åœ¨é™æ€æ–¹æ³•ä¸­çš„å±€éƒ¨ç±»åªèƒ½è®¿é—®å¤–éƒ¨ç±»çš„é™æ€å˜é‡å’Œæ–¹æ³•\n\n##### åŒ¿åå†…éƒ¨ç±»\n\nåŒ¿åå†…éƒ¨ç±»å°±æ˜¯æ²¡æœ‰åå­—çš„å†…éƒ¨ç±»ï¼Œæ—¥å¸¸å¼€å‘ä¸­ä½¿ç”¨çš„æ¯”è¾ƒå¤šã€‚åŒ¿åå†…éƒ¨ç±»å¿…é¡»ç»§æ‰¿æˆ–å®ç°ä¸€ä¸ªå·²æœ‰çš„æ¥å£ ï¼ŒåŒ¿åå†…éƒ¨ç±»ä¸èƒ½å®šä¹‰ä»»ä½•é™æ€æˆå‘˜å’Œé™æ€æ–¹æ³•\n\n#### å±€éƒ¨å†…éƒ¨ç±»å’ŒåŒ¿åå†…éƒ¨ç±»è®¿é—®å±€éƒ¨å˜é‡çš„æ—¶å€™ï¼Œä¸ºä»€ä¹ˆå˜é‡å¿…é¡»è¦åŠ ä¸Šfinalï¼Ÿ\n\nå±€éƒ¨å†…éƒ¨ç±»å’ŒåŒ¿åå†…éƒ¨ç±»è®¿é—®å±€éƒ¨å˜é‡çš„æ—¶å€™ï¼Œä¸ºä»€ä¹ˆå˜é‡å¿…é¡»è¦åŠ ä¸Š final å‘¢ï¼Ÿå®ƒå†…éƒ¨åŸç†æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ\n\nå…ˆçœ‹è¿™æ®µä»£ç ï¼š\n\n```java\npublic class Outer {\n    void outMethod(){\n        final int a =10;\n        class Inner {\n            void innerMethod(){\n                System.out.println(a);\n            }\n        }\n    }\n}\n```\n\nä»¥ä¸Šä¾‹å­ï¼Œä¸ºä»€ä¹ˆè¦åŠ  final å‘¢ï¼Ÿæ˜¯å› ä¸º**ç”Ÿå‘½å‘¨æœŸä¸ä¸€è‡´**\n\nå±€éƒ¨å˜é‡å­˜å‚¨åœ¨æ ˆä¸­ï¼Œå½“æ–¹æ³•æ‰§è¡Œç»“æŸåï¼Œå¦‚æœä¸ç”¨ final ä¿®é¥°é‚£ä¹ˆè¯¥å±€éƒ¨å˜é‡å°±è¢«é”€æ¯ã€‚è€Œå±€éƒ¨å†…éƒ¨ç±»å¯¹å±€éƒ¨å˜é‡çš„å¼•ç”¨ä¾ç„¶å­˜åœ¨ï¼Œå¦‚æœå±€éƒ¨å†…éƒ¨ç±»è¦è°ƒç”¨å±€éƒ¨å˜é‡æ—¶ï¼Œå°±ä¼šå‡ºé”™ã€‚\nåŠ äº† finalï¼Œå¯ä»¥ç¡®ä¿å±€éƒ¨å†…éƒ¨ç±»ä½¿ç”¨çš„å˜é‡ä¸å¤–å±‚çš„å±€éƒ¨å˜é‡åŒºåˆ†å¼€ï¼Œè§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚\n\n### é‡å†™ä¸é‡è½½\n\n#### æ„é€ å™¨ï¼ˆconstructorï¼‰æ˜¯å¦å¯è¢«é‡å†™ï¼ˆoverrideï¼‰\n\næ„é€ å™¨ä¸èƒ½è¢«ç»§æ‰¿ï¼Œå› æ­¤ä¸èƒ½è¢«é‡å†™ï¼Œä½†å¯ä»¥è¢«é‡è½½ã€‚\n\n#### é‡è½½ï¼ˆOverloadï¼‰å’Œé‡å†™ï¼ˆOverrideï¼‰çš„åŒºåˆ«ã€‚é‡è½½çš„æ–¹æ³•èƒ½å¦æ ¹æ®è¿”å›ç±»å‹è¿›è¡ŒåŒºåˆ†ï¼Ÿ\n\næ–¹æ³•çš„é‡è½½å’Œé‡å†™éƒ½æ˜¯å®ç°å¤šæ€çš„æ–¹å¼ï¼ŒåŒºåˆ«åœ¨äºé‡è½½å®ç°çš„æ˜¯**ç¼–è¯‘æ—¶çš„å¤šæ€æ€§**ï¼Œè€Œé‡å†™å®ç°çš„æ˜¯**è¿è¡Œæ—¶çš„å¤šæ€æ€§**ã€‚\n\né‡è½½ï¼šå‘ç”Ÿåœ¨**åŒä¸€ä¸ªç±»**ä¸­ï¼Œ**æ–¹æ³•åç›¸åŒ å‚æ•°åˆ—è¡¨ä¸åŒ**ï¼ˆå‚æ•°ç±»å‹ä¸åŒã€ä¸ªæ•°ä¸åŒã€é¡ºåºä¸åŒï¼‰ï¼Œä¸æ–¹æ³•è¿”å›å€¼å’Œè®¿é—®ä¿®é¥°ç¬¦æ— å…³\n\né‡å†™ï¼šå‘ç”Ÿåœ¨**çˆ¶å­ç±»**ä¸­ï¼Œæ–¹æ³•åã€å‚æ•°åˆ—è¡¨å¿…é¡»ç›¸åŒï¼Œè¿”å›å€¼ç±»å‹å°äºç­‰äºçˆ¶ç±»ï¼ŒæŠ›å‡ºçš„å¼‚å¸¸å°äºç­‰äºçˆ¶ç±»ï¼Œ**è®¿é—®ä¿®é¥°ç¬¦å¤§äºç­‰äºçˆ¶ç±»**ï¼ˆé‡Œæ°ä»£æ¢åŸåˆ™ï¼‰\n\n### å¯¹è±¡ç›¸ç­‰åˆ¤æ–­\n\n#### == å’Œ equals çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ\n\n**==** : å®ƒçš„ä½œç”¨æ˜¯åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡çš„åœ°å€æ˜¯ä¸æ˜¯ç›¸ç­‰ã€‚å³ï¼Œåˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯ä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚\n(åŸºæœ¬æ•°æ®ç±»å‹ == æ¯”è¾ƒçš„æ˜¯å€¼ï¼Œå¼•ç”¨æ•°æ®ç±»å‹ == æ¯”è¾ƒçš„æ˜¯å†…å­˜åœ°å€)\n\n**equals()** : å®ƒçš„ä½œç”¨ä¹Ÿæ˜¯åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰ã€‚ä½†å®ƒä¸€èˆ¬æœ‰ä¸¤ç§ä½¿ç”¨æƒ…å†µï¼š\n\næƒ…å†µ 1ï¼šç±»æ²¡æœ‰é‡å†™ equals() æ–¹æ³•ã€‚åˆ™é€šè¿‡ equals() æ¯”è¾ƒè¯¥ç±»çš„ä¸¤ä¸ªå¯¹è±¡æ—¶ï¼Œç­‰ä»·äºé€šè¿‡â€œ==â€æ¯”è¾ƒè¿™ä¸¤ä¸ªå¯¹è±¡ã€‚\n\næƒ…å†µ 2ï¼šç±»é‡å†™äº† equals() æ–¹æ³•ã€‚ä¸€èˆ¬ï¼Œæˆ‘ä»¬éƒ½é‡å†™ equals() æ–¹æ³•æ¥ä¸¤ä¸ªå¯¹è±¡çš„å†…å®¹ç›¸ç­‰ï¼›è‹¥å®ƒä»¬çš„å†…å®¹ç›¸ç­‰ï¼Œåˆ™è¿”å› true (å³ï¼Œè®¤ä¸ºè¿™ä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰)ã€‚\n\n#### hashCode ä¸ equals\n\n**hashCode()ä»‹ç»**\n\nhashCode() çš„ä½œç”¨æ˜¯è·å–å“ˆå¸Œç ï¼ˆæœ¬åœ°æ–¹æ³•ï¼‰ï¼Œä¹Ÿç§°ä¸ºæ•£åˆ—ç ï¼›å®ƒå®é™…ä¸Šæ˜¯è¿”å›ä¸€ä¸ª int æ•´æ•°ã€‚hashCode() å®šä¹‰åœ¨ JDK çš„ Object ç±»ä¸­ï¼Œè¿™å°±æ„å‘³ç€ Java ä¸­çš„ä»»ä½•ç±»éƒ½æœ‰ hashCode()æ–¹æ³•ã€‚\n\n**ä¸ºä»€ä¹ˆè¦æœ‰ hashCode**\n\n**æˆ‘ä»¬ä»¥â€œhashSet å¦‚ä½•æ£€æŸ¥é‡å¤â€ä¸ºä¾‹å­æ¥è¯´æ˜ä¸ºä»€ä¹ˆè¦æœ‰ hashCode**ï¼š\n\nå½“ä½ æŠŠå¯¹è±¡åŠ å…¥ hashSet æ—¶ï¼ŒhashSet ä¼šå…ˆè®¡ç®—å¯¹è±¡çš„ hashcode å€¼æ¥åˆ¤æ–­å¯¹è±¡åŠ å…¥çš„ä½ç½®ï¼Œå¦‚æœæ²¡æœ‰ç›¸ç¬¦çš„ hashcodeï¼ŒhashSet ä¼šå‡è®¾å¯¹è±¡æ²¡æœ‰é‡å¤å‡ºç°ã€‚ä½†æ˜¯å¦‚æœå‘ç°æœ‰ç›¸åŒ hashcode å€¼çš„å¯¹è±¡ï¼Œè¿™æ—¶ä¼šè°ƒç”¨ equals()æ–¹æ³•æ¥æ£€æŸ¥ hashcode ç›¸ç­‰çš„å¯¹è±¡æ˜¯å¦çœŸçš„ç›¸åŒã€‚å¦‚æœä¸¤è€…ç›¸åŒï¼Œè¡¨æ˜å·²ç»æœ‰äº†ç›¸åŒçš„å¯¹è±¡äº†ï¼ŒhashSet å°±ä¸ä¼šè®©å…¶åŠ å…¥æ“ä½œæˆåŠŸã€‚å¦‚æœä¸åŒçš„è¯ï¼Œå°±ä¼šé‡æ–°æ•£åˆ—åˆ°å…¶ä»–ä½ç½®ã€‚\n\n**hashCode()ä¸equals()çš„ç›¸å…³è§„å®š**\n\n- å¦‚æœä¸¤ä¸ªå¯¹è±¡çš„ hashCode å€¼ç›¸ç­‰ï¼Œé‚£è¿™ä¸¤ä¸ªå¯¹è±¡ä¸ä¸€å®šç›¸ç­‰ï¼ˆå“ˆå¸Œç¢°æ’ï¼‰ã€‚\n- å¦‚æœä¸¤ä¸ªå¯¹è±¡çš„ hashCode å€¼ç›¸ç­‰å¹¶ä¸” equals()æ–¹æ³•ä¹Ÿè¿”å› trueï¼Œæˆ‘ä»¬æ‰è®¤ä¸ºè¿™ä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰ã€‚\n- å¦‚æœä¸¤ä¸ªå¯¹è±¡çš„ hashCode å€¼ä¸ç›¸ç­‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥è®¤ä¸ºè¿™ä¸¤ä¸ªå¯¹è±¡ä¸ç›¸ç­‰ã€‚\n\n#### åªé‡å†™ hashCode å¯ä»¥å—ï¼Ÿ\n\nå¦‚æœåªé‡å†™ hashCodeï¼Œä¸é‡å†™ equalsï¼Œé‚£ä¹ˆå¦‚æœä¸¤ä¸ªå¯¹è±¡åˆ¤æ–­ hashCode ç›¸åŒäº†ï¼Œä»¥ä¸ºè¿™ä¿©å¯¹è±¡ç›¸åŒï¼Œé‚£ä¹ˆåªä¼šæ’å…¥ä¸€æ¬¡åˆ° set é‡Œé¢ï¼Œè€Œå®é™…ä¸Šè¿™ä¸¤ä¸ªä¸ä¸€æ ·ä¸€ä¸ªæ˜¯ A ä¸€ä¸ªæ˜¯ Bï¼Œéƒ½éœ€è¦æ’å…¥ã€‚\n\n> ä¸¤ä¸ªå¯¹è±¡çš„ hashCode ç›¸åŒï¼Œä½†æ˜¯å†…å®¹å¯èƒ½ä¸åŒï¼Œåœ¨ set ä¸­æ˜æ˜åº”è¯¥æ˜¯ä¸¤ä¸ªä¸åŒçš„å¯¹è±¡ï¼Œè¿™æ—¶å€™åªé€šè¿‡ hashCode åˆ¤æ–­ä»–ä¿©ç›¸åŒä¼šå¯¼è‡´åªæ’å…¥ä¸€ä¸ªå…ƒç´ ã€‚\n\n#### åªé‡å†™ equalså¯ä»¥å—ï¼Ÿ\n\nå¦‚æœåœ¨é‡å†™ equals æ—¶ï¼Œä¸é‡å†™ hashCodeï¼Œå°±ä¼šå¼•èµ·æ¯”å¦‚è¯´å°†ä¸¤ä¸ªç›¸ç­‰çš„è‡ªå®šä¹‰å¯¹è±¡å­˜å‚¨åœ¨ Set é›†åˆæ—¶ï¼Œä¼šå°†è¿™ä¸¤ä¸ªå¯¹è±¡éƒ½è¿›è¡Œæ’å…¥ã€‚ï¼ˆæ— æ³•å»é‡ï¼‰\n\n> å¦‚æœå®šä¹‰ä¸€ä¸ª set é‡Œé¢å­˜æ”¾ Person å¯¹è±¡ï¼ŒPerson åªé‡å†™äº† equals æ–¹æ³•å³å¯ä»¥åˆ¤æ–­å¯¹è±¡å†…å®¹æ˜¯å¦ç›¸åŒã€‚\n>\n> å¦‚æœåªé‡å†™äº† equals æ–¹æ³•ï¼Œé‚£ä¹ˆé»˜è®¤æƒ…å†µä¸‹ï¼ŒSet è¿›è¡Œå»é‡æ“ä½œæ—¶ï¼Œä¼šå…ˆåˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡çš„ hashCode æ˜¯å¦ç›¸åŒï¼Œæ­¤æ—¶å› ä¸ºæ²¡æœ‰é‡å†™ hashCode æ–¹æ³•ï¼Œæ‰€ä»¥ä¼šç›´æ¥æ‰§è¡Œ Object ä¸­çš„ hashCode æ–¹æ³•ï¼Œè€Œ Object ä¸­çš„ hashCode æ–¹æ³•å¯¹æ¯”çš„æ˜¯ä¸¤ä¸ªä¸åŒå¼•ç”¨åœ°å€çš„å¯¹è±¡ï¼Œæ‰€ä»¥ç»“æœæ˜¯ falseï¼Œé‚£ä¹ˆ equals æ–¹æ³•å°±ä¸ç”¨æ‰§è¡Œäº†ï¼Œç›´æ¥è¿”å›çš„ç»“æœå°±æ˜¯ falseï¼šä¸¤ä¸ªå¯¹è±¡ä¸æ˜¯ç›¸ç­‰çš„ï¼Œäºæ˜¯å°±åœ¨ Set é›†åˆä¸­æ’å…¥äº†ä¸¤ä¸ªç›¸åŒçš„å¯¹è±¡ã€‚\n>\n> ä½†æ˜¯ï¼Œå¦‚æœåœ¨é‡å†™ equals æ–¹æ³•æ—¶ï¼Œä¹Ÿé‡å†™äº† hashCode æ–¹æ³•ï¼Œé‚£ä¹ˆåœ¨æ‰§è¡Œåˆ¤æ–­æ—¶ä¼šå»æ‰§è¡Œé‡å†™çš„ hashCode æ–¹æ³•ï¼Œæ­¤æ—¶å¯¹æ¯”çš„æ˜¯ä¸¤ä¸ªå¯¹è±¡çš„æ‰€æœ‰å±æ€§çš„ hashCode æ˜¯å¦ç›¸åŒï¼Œäºæ˜¯è°ƒç”¨ hashCode è¿”å›çš„ç»“æœå°±æ˜¯ trueï¼Œå†å»è°ƒç”¨ equals æ–¹æ³•ï¼Œå‘ç°ä¸¤ä¸ªå¯¹è±¡ç¡®å®æ˜¯ç›¸ç­‰çš„ï¼Œäºæ˜¯å°±è¿”å› true äº†ï¼Œå› æ­¤ Set é›†åˆå°±ä¸ä¼šå­˜å‚¨ä¸¤ä¸ªä¸€æ¨¡ä¸€æ ·çš„æ•°æ®äº†ï¼Œäºæ˜¯æ•´ä¸ªç¨‹åºçš„æ‰§è¡Œå°±æ­£å¸¸äº†ã€‚\n\n### å€¼ä¼ é€’\n\n#### ä¸ºä»€ä¹ˆ Java ä¸­åªæœ‰å€¼ä¼ é€’\n\nJava é‡‡ç”¨æŒ‰å€¼è°ƒç”¨ï¼Œæ–¹æ³•å¾—åˆ°çš„æ˜¯æ‰€æœ‰å‚æ•°å€¼çš„ä¸€ä¸ªæ‹·è´ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ–¹æ³•ä¸èƒ½ä¿®æ”¹ä¼ é€’ç»™å®ƒçš„ä»»ä½•å‚æ•°å˜é‡çš„å†…å®¹ã€‚\n\nexample 1\n\n```java\npublic static void main(String[] args) {\n    int num1 = 10;\n    int num2 = 20;\n\n    swap(num1, num2);\n\n    System.out.println(\"num1 = \" + num1);\n    System.out.println(\"num2 = \" + num2);\n}\n\npublic static void swap(int a, int b) {\n    int temp = a;\n    a = b;\n    b = temp;\n\n    System.out.println(\"a = \" + a);\n    System.out.println(\"b = \" + b);\n}\n```\n\n**ç»“æœ**ï¼š\n\n```java\na = 20\nb = 10\nnum1 = 10\nnum2 = 20\n```\n\n**è§£æ**ï¼š\n\n![swap(int a, int b)](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNDAyMzk3Mi00ZWQyZjQ0NTlmN2MyYzkwLmpwZw.png)\n\nåœ¨ swap æ–¹æ³•ä¸­ï¼Œaã€b çš„å€¼è¿›è¡Œäº¤æ¢ï¼Œå¹¶ä¸ä¼šå½±å“åˆ° num1ã€num2ã€‚å› ä¸º aã€b ä¸­çš„å€¼ï¼Œåªæ˜¯ä» num1ã€num2 çš„å¤åˆ¶è¿‡æ¥çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œaã€b ç›¸å½“äº num1ã€num2 çš„å‰¯æœ¬ï¼Œå‰¯æœ¬çš„å†…å®¹æ— è®ºæ€ä¹ˆä¿®æ”¹ï¼Œéƒ½ä¸ä¼šå½±å“åˆ°åŸä»¶æœ¬èº«ã€‚\n\n**é€šè¿‡ä¸Šé¢ä¾‹å­ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“äº†ä¸€ä¸ªæ–¹æ³•ä¸èƒ½ä¿®æ”¹ä¸€ä¸ªåŸºæœ¬æ•°æ®ç±»å‹çš„å‚æ•°ï¼Œè€Œå¯¹è±¡å¼•ç”¨ä½œä¸ºå‚æ•°å°±ä¸ä¸€æ ·ï¼Œè¯·çœ‹ example2.**\n\nexample 2\n\n```java\n    public static void main(String[] args) {\n        int[] arr = { 1, 2, 3, 4, 5 };\n        System.out.println(arr[0]);\n        change(arr);\n        System.out.println(arr[0]);\n    }\n\n    public static void change(int[] array) {\n        // å°†æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ å˜ä¸º0\n        array[0] = 0;\n    }\n```\n\n**ç»“æœ**ï¼š\n\n```undefined\n1\n0\n```\n\n**è§£æ**ï¼š\n\n![change(int[] array)](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNDAyMzk3Mi1kYWI5Mzg5ZWRmMjIxNmIzLmpwZw.png)\n\narray è¢«åˆå§‹åŒ– arr çš„æ‹·è´ä¹Ÿå°±æ˜¯ä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ array å’Œ arr æŒ‡å‘çš„æ—¶åŒä¸€ä¸ªæ•°ç»„å¯¹è±¡ã€‚ å› æ­¤ï¼Œå¤–éƒ¨å¯¹å¼•ç”¨å¯¹è±¡çš„æ”¹å˜ä¼šåæ˜ åˆ°æ‰€å¯¹åº”çš„å¯¹è±¡ä¸Šã€‚\n\n**é€šè¿‡ example2 æˆ‘ä»¬å·²ç»çœ‹åˆ°ï¼Œå®ç°ä¸€ä¸ªæ”¹å˜å¯¹è±¡å‚æ•°çŠ¶æ€çš„æ–¹æ³•å¹¶ä¸æ˜¯ä¸€ä»¶éš¾äº‹ã€‚ç†ç”±å¾ˆç®€å•ï¼Œæ–¹æ³•å¾—åˆ°çš„æ˜¯å¯¹è±¡å¼•ç”¨çš„æ‹·è´ï¼Œå¯¹è±¡å¼•ç”¨åŠå…¶ä»–çš„æ‹·è´åŒæ—¶å¼•ç”¨åŒä¸€ä¸ªå¯¹è±¡ã€‚**\n\nexample 3\n\n```java\npublic class Test {\n\n    public static void main(String[] args) {\n        Student s1 = new Student(\"å°å¼ \");\n        Student s2 = new Student(\"å°æ\");\n        Test.swap(s1, s2);\n        System.out.println(\"s1:\" + s1.getName());\n        System.out.println(\"s2:\" + s2.getName());\n    }\n\n    public static void swap(Student x, Student y) {\n        Student temp = x;\n        x = y;\n        y = temp;\n        System.out.println(\"x:\" + x.getName());\n        System.out.println(\"y:\" + y.getName());\n    }\n}\n```\n\n**ç»“æœ**ï¼š\n\n```undefined\nx:å°æ\ny:å°å¼ \ns1:å°å¼ \ns2:å°æ\n```\n\n**è§£æ**ï¼š\n\näº¤æ¢ä¹‹å‰ï¼š\n\n![before swap(Student x, Student y)](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNDAyMzk3Mi03MmIwYzFmYjlmM2IwNzc2LmpwZw.png)\n\näº¤æ¢ä¹‹åï¼š\n\n![after swap(Student x, Student y)](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNDAyMzk3Mi0zYWUzNzY4NGNiMzg2Njc4LmpwZw.png)\n\né€šè¿‡ä¸Šé¢ä¸¤å¼ å›¾å¯ä»¥å¾ˆæ¸…æ™°çš„çœ‹å‡ºï¼š **æ–¹æ³•å¹¶æ²¡æœ‰æ”¹å˜å­˜å‚¨åœ¨å˜é‡ s1 å’Œ s2 ä¸­çš„å¯¹è±¡å¼•ç”¨ã€‚swapæ–¹æ³•çš„å‚æ•°xå’Œyè¢«åˆå§‹åŒ–ä¸ºä¸¤ä¸ªå¯¹è±¡å¼•ç”¨çš„æ‹·è´ï¼Œè¿™ä¸ªæ–¹æ³•äº¤æ¢çš„æ˜¯è¿™ä¸¤ä¸ªæ‹·è´**\n\n#### å€¼ä¼ é€’å’Œå¼•ç”¨ä¼ é€’æœ‰ä»€ä¹ˆåŒºåˆ«\n\nå€¼ä¼ é€’ï¼šæŒ‡çš„æ˜¯åœ¨æ–¹æ³•è°ƒç”¨æ—¶ï¼Œä¼ é€’çš„å‚æ•°æ˜¯æŒ‰å€¼çš„æ‹·è´ä¼ é€’ï¼Œä¼ é€’çš„æ˜¯å€¼çš„æ‹·è´ï¼Œä¹Ÿå°±æ˜¯è¯´ä¼ é€’åå°±äº’ä¸ç›¸å…³äº†ã€‚\n\nå¼•ç”¨ä¼ é€’ï¼šæŒ‡çš„æ˜¯åœ¨æ–¹æ³•è°ƒç”¨æ—¶ï¼Œä¼ é€’çš„å‚æ•°æ˜¯æŒ‰å¼•ç”¨è¿›è¡Œä¼ é€’ï¼Œå…¶å®ä¼ é€’çš„å¼•ç”¨çš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯å˜é‡æ‰€å¯¹åº”çš„å†…å­˜ç©ºé—´çš„åœ°å€ã€‚ä¼ é€’çš„æ˜¯å€¼çš„å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ä¼ é€’å‰å’Œä¼ é€’åéƒ½æŒ‡å‘åŒä¸€ä¸ªå¼•ç”¨ï¼ˆä¹Ÿå°±æ˜¯åŒä¸€ä¸ªå†…å­˜ç©ºé—´ï¼‰ã€‚\n\n## IOæµ\n\n> å‚è€ƒï¼šhttps://blog.csdn.net/weixin_44579258/article/details/90758359\n\né˜»å¡å’Œéé˜»å¡æ˜¯æŒ‡è¿›ç¨‹è®¿é—®çš„æ•°æ®å¦‚æœå°šæœªå‡†å¤‡å°±ç»ªï¼Œè¿›ç¨‹æ˜¯å¦éœ€è¦ç­‰å¾…\nåŒæ­¥å’Œå¼‚æ­¥æ˜¯æŒ‡è®¿é—®æ•°æ®çš„æœºåˆ¶ï¼ŒåŒæ­¥ä¸€èˆ¬ä¸»åŠ¨è¯·æ±‚ç­‰å¾… IO æ“ä½œå®Œæ¯•çš„æ–¹å¼ã€‚å½“æ•°æ®å°±ç»ªåï¼Œå†è¯»å†™çš„æ—¶å€™å¿…é¡»é˜»å¡ï¼Œå¼‚æ­¥åˆ™ä¸»åŠ¨è¯·æ±‚æ•°æ®åä¾¿å¯ä»¥ç»§ç»­å¤„ç†å…¶ä»–ä»»åŠ¡ï¼Œéšåç­‰å¾… IO å®Œæ¯•é€šçŸ¥ï¼Œè¿™å¯ä»¥ä½¿è¿›ç¨‹åœ¨æ•°æ®è¯»å†™æ—¶ä¹Ÿä¸é˜»å¡\n\nå‡†å¤‡æ•°æ®ï¼šç½‘å¡ â†’ å†…æ ¸\næ•°æ®å°±ç»ªï¼šæ•°æ®æ‹·è´åˆ°äº†å†…æ ¸\næ‹·è´æ•°æ®ï¼šå°†å†…æ ¸æ•°æ®æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´\n\n### Blocking I/O\n\n**BIO å±äºåŒæ­¥é˜»å¡ IO æ¨¡å‹** ã€‚\n\nåŒæ­¥é˜»å¡ IO æ¨¡å‹ä¸­ï¼Œåº”ç”¨ç¨‹åº**å‘èµ· read è°ƒç”¨**åï¼Œä¼šä¸€ç›´é˜»å¡ï¼Œç›´åˆ°å†…æ ¸å‡†å¤‡æ•°æ®ã€æ•°æ®å°±ç»ªï¼Œæ•°æ®ä»å†…æ ¸æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´ã€‚\n\n![BIO](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes20190603201109632.png)\n\n### NIO (Non-blocking I/O)\n\nåŒæ­¥éé˜»å¡ IO æ¨¡å‹ä¸­ï¼Œç”¨æˆ·è¿›ç¨‹ä¼š**ä¸€ç›´å‘èµ· read è°ƒç”¨**ï¼ˆå¦‚æœå†…æ ¸è¿”å› error åˆ™è¯´æ˜æ•°æ®æœªå‡†å¤‡å°±ç»ªï¼‰ï¼Œç›´åˆ°æ•°æ®å‡†å¤‡å°±ç»ªï¼Œç”¨æˆ·å‘èµ· read è°ƒç”¨æ—¶ï¼Œæ•°æ®ä»å†…æ ¸ç©ºé—´æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´ï¼ˆç”¨æˆ·è¿›ç¨‹æ˜¯é˜»å¡çš„ï¼‰ã€‚\n\n> ç›¸æ¯”äºåŒæ­¥é˜»å¡ IO æ¨¡å‹ï¼ŒåŒæ­¥éé˜»å¡ IO æ¨¡å‹ç¡®å®æœ‰äº†å¾ˆå¤§æ”¹è¿›ã€‚é€šè¿‡è½®è¯¢æ“ä½œï¼Œé¿å…äº†ä¸€ç›´é˜»å¡ã€‚\n\n![NIO](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes20190603201218527.png)\n\n### IOå¤šè·¯å¤ç”¨ï¼ˆNIOï¼‰\n\nselect/epoll çš„å¥½å¤„å°±åœ¨äºå•ä¸ª process å°±å¯ä»¥åŒæ—¶å¤„ç†å¤šä¸ªç½‘ç»œè¿æ¥çš„ IOã€‚\n\n![NIO](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes2019060320125821.png)\n\nIO å¤ç”¨å’ŒåŒæ­¥é˜»å¡æœ¬è´¨ä¸€æ ·ï¼Œåœ¨ NIO ä¸­ï¼Œæ¯æ¬¡ç”¨æˆ·è¿›ç¨‹è¿›è¡Œ read è½®è¯¢æ•°æ®æ˜¯å¦å‡†å¤‡å°±ç»ªï¼Œè€Œåœ¨ IO å¤šè·¯å¤ç”¨ä¸­ï¼Œåˆ©ç”¨äº†æ–°çš„ select ç³»ç»Ÿè°ƒç”¨ï¼Œç”±å†…æ ¸æ¥è´Ÿè´£æœ¬æ¥æ˜¯è¯·æ±‚è¿›ç¨‹è¯¥åšçš„è½®è¯¢æ“ä½œã€‚\n\nå½“ç”¨æˆ·çº¿ç¨‹è°ƒç”¨ selectï¼Œé‚£ä¹ˆæ•´ä¸ªè¿›ç¨‹ä¼šè¢«é˜»å¡ï¼Œè€ŒåŒæ—¶ï¼Œkernel å†…æ ¸ä¼šâ€œç›‘è§†â€æ‰€æœ‰ select è´Ÿè´£çš„ socketï¼Œå½“ä»»ä½•ä¸€ä¸ª socket ä¸­çš„æ•°æ®å‡†å¤‡å¥½äº†ï¼Œselect å°±ä¼šè¿”å›å¯è¯»æ¡ä»¶è®©ç”¨æˆ·è¿›ç¨‹å‘èµ· read è°ƒç”¨ï¼Œç”¨æˆ·è¿›ç¨‹å‘èµ·è°ƒç”¨ read æ“ä½œï¼Œå°†æ•°æ®ä»å†…æ ¸ç©ºé—´æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´ã€‚\n\n\n### Asynchronous I/O\n\nå¼‚æ­¥ IO æ˜¯åŸºäºäº‹ä»¶å’Œå›è°ƒæœºåˆ¶å®ç°çš„ï¼Œä¹Ÿå°±æ˜¯åº”ç”¨æ“ä½œä¹‹åä¼šç›´æ¥è¿”å›ï¼Œä¸ä¼šå µå¡åœ¨é‚£é‡Œï¼Œå½“åå°å¤„ç†å®Œæˆï¼Œæ“ä½œç³»ç»Ÿä¼šé€šçŸ¥ç›¸åº”çš„çº¿ç¨‹è¿›è¡Œåç»­çš„æ“ä½œã€‚\n\nç”¨æˆ·å‘èµ· read è°ƒç”¨ï¼Œæ­¤æ—¶ç”¨æˆ·è¿›ç¨‹ä¸ä¼šé˜»å¡ã€‚å†…æ ¸å°†æ•°æ®å‡†å¤‡å°±ç»ªå¹¶å°†å…¶ä»å†…æ ¸æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´åï¼Œå†…æ ¸ç»™ç”¨æˆ·è¿›ç¨‹å‘é€ä¸€ä¸ªä¿¡å·ç»™ä¹‹å‰è°ƒç”¨ read çš„è¿›ç¨‹ï¼Œæ•°æ®å·²ç»æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´äº†ã€‚\n\n![AIO](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes2019060320135956.png)\n\n## åå°„\n\n### ä»€ä¹ˆæ˜¯åå°„æœºåˆ¶ï¼Ÿ\n\nJAVA åå°„æœºåˆ¶æ˜¯åœ¨è¿è¡ŒçŠ¶æ€ä¸­ï¼Œå¯¹äºä»»æ„ä¸€ä¸ªç±»ï¼Œéƒ½èƒ½å¤ŸçŸ¥é“è¿™ä¸ªç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼›å¯¹äºä»»æ„ä¸€ä¸ªå¯¹è±¡ï¼Œéƒ½èƒ½å¤Ÿè°ƒç”¨å®ƒçš„ä»»æ„ä¸€ä¸ªæ–¹æ³•å’Œå±æ€§ï¼›è¿™ç§åŠ¨æ€è·å–çš„ä¿¡æ¯ä»¥åŠåŠ¨æ€è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•çš„åŠŸèƒ½ç§°ä¸º Java è¯­è¨€çš„åå°„æœºåˆ¶ã€‚\n\n### åå°„æœºåˆ¶ä¼˜ç¼ºç‚¹\n\n- **ä¼˜ç‚¹ï¼š** è¿è¡ŒæœŸç±»å‹çš„åˆ¤æ–­ï¼ŒåŠ¨æ€åŠ è½½ç±»ï¼Œæé«˜ä»£ç çµæ´»åº¦ã€‚\n- **ç¼ºç‚¹ï¼š** æ€§èƒ½ç“¶é¢ˆï¼šåå°„ç›¸å½“äºä¸€ç³»åˆ—è§£é‡Šæ“ä½œï¼Œé€šçŸ¥ JVM è¦åšçš„äº‹æƒ…ï¼Œæ€§èƒ½æ¯”ç›´æ¥çš„ Java ä»£ç è¦æ…¢å¾ˆå¤šã€‚\n\n### åå°„æœºåˆ¶çš„åº”ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ\n\nâ‘ æˆ‘ä»¬åœ¨ä½¿ç”¨ JDBC è¿æ¥æ•°æ®åº“æ—¶ä½¿ç”¨ Class.forName()é€šè¿‡åå°„åŠ è½½æ•°æ®åº“çš„é©±åŠ¨ç¨‹åºï¼›\n\nâ‘¡Spring é€šè¿‡ XML é…ç½®æ¨¡å¼è£…è½½ Bean çš„è¿‡ç¨‹\n\n1. åŠ è½½é…ç½®æ–‡ä»¶ï¼Œè§£ææˆ BeanDefinition æ”¾åœ¨ Map é‡Œï¼Œmap ä¸­å­˜æ”¾`<BeanNameï¼ŒClasså¯¹è±¡>`çš„æ˜ å°„\n2. è°ƒç”¨ getBean çš„æ—¶å€™ï¼Œä» BeanDefinition æ‰€å±çš„ Map é‡Œï¼Œæ‹¿å‡º Class å¯¹è±¡ä½¿ç”¨åå°„è¿›è¡Œå®ä¾‹åŒ–ï¼ŒåŒæ—¶ï¼Œå¦‚æœæœ‰ä¾èµ–å…³ç³»ï¼Œå°†é€’å½’è°ƒç”¨ getBean æ–¹æ³• â€”â€” å®Œæˆä¾èµ–æ³¨å…¥\n\n### Javaè·å–åå°„çš„ä¸‰ç§æ–¹æ³•\n\n1.é€šè¿‡ new å¯¹è±¡å®ç°åå°„æœºåˆ¶ 2.é€šè¿‡è·¯å¾„å®ç°åå°„æœºåˆ¶ 3.é€šè¿‡ç±»åå®ç°åå°„æœºåˆ¶\n\n## åŒ…è£…ç±»\n\n#### è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±\n\n**è£…ç®±**ï¼šå°†åŸºæœ¬ç±»å‹ç”¨å®ƒä»¬å¯¹åº”çš„å¼•ç”¨ç±»å‹åŒ…è£…èµ·æ¥ï¼›`Integer a = 1;`\n\n**æ‹†ç®±**ï¼šå°†åŒ…è£…ç±»å‹è½¬æ¢ä¸ºåŸºæœ¬æ•°æ®ç±»å‹ï¼›`int b = a;`\n\n#### int å’Œ Integer æœ‰ä»€ä¹ˆåŒºåˆ«\n\nå¼•å…¥åŒ…è£…ç±»æ˜¯ä¸ºäº†èƒ½å¤Ÿå°†è¿™äº›**åŸºæœ¬æ•°æ®ç±»å‹å½“æˆå¯¹è±¡æ“ä½œ**\n\nJava ä¸ºæ¯ä¸ªåŸå§‹ç±»å‹æä¾›äº†åŒ…è£…ç±»å‹ï¼š\n\nåŸå§‹ç±»å‹: booleanï¼Œcharï¼Œbyteï¼Œshortï¼Œintï¼Œlongï¼Œfloatï¼Œdouble\n\nåŒ…è£…ç±»å‹ï¼šBooleanï¼ŒCharacterï¼ŒByteï¼ŒShortï¼ŒIntegerï¼ŒLongï¼ŒFloatï¼ŒDouble\n\n#### Integer a = 127 ä¸ Integer b = 127ç›¸ç­‰å—\n\n> åŒ…è£…ç±»å’ŒåŸºæœ¬æ•°æ®ç±»å‹æ¯”è¾ƒï¼Œä¼šå°†åŒ…è£…ç±»æ‹†ç®±æˆåŸºæœ¬æ•°æ®ç±»å‹ç„¶åæ¯”è¾ƒï¼Œ\n>\n> åªæœ‰å½“åŒ…è£…ç±»æ˜¯è‡ªåŠ¨è£…ç®±ï¼Œå¹¶ä¸”æ•°å€¼èŒƒå›´åœ¨ [-128, 127] æ—¶ï¼Œæ‰ä¼šä½¿ç”¨ cache ä¸­çš„å¯¹è±¡ã€‚\n\nå¯¹äºå¯¹è±¡å¼•ç”¨ç±»å‹ï¼š==æ¯”è¾ƒçš„æ˜¯å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚\nå¯¹äºåŸºæœ¬æ•°æ®ç±»å‹ï¼š==æ¯”è¾ƒçš„æ˜¯å€¼ã€‚\n\n```java\npublic static void main(String[] args) {\n    Integer a = new Integer(3);\n  \tInteger b = 3;\n    int c = 3;\n    Integer d = 3;\n    System.out.println(a == b); // falseï¼Œä¸¤ä¸ªå¯¹è±¡æ¯”è¾ƒ\n    System.out.println(a == c); // trueï¼Œaè‡ªåŠ¨æ‹†ç®±\n    System.out.println(b == c); // trueï¼Œbè‡ªåŠ¨æ‹†ç®±\n    System.out.println(b == d); // trueï¼ŒåŒ…è£…ç±»è‡ªåŠ¨è£…ç®±ä¸”æ•°å€¼èŒƒå›´åœ¨cacheèŒƒå›´å†…\n\n    Integer a = new Integer(128);\n    Integer b = 128;\n    int c = 128;\n    Integer d = 128;\n    System.out.println(a == b); // falseï¼Œä¸¤ä¸ªå¯¹è±¡æ¯”è¾ƒ\n    System.out.println(a == c); // trueï¼Œaè‡ªåŠ¨æ‹†ç®±\n    System.out.println(b == c); // trueï¼Œbè‡ªåŠ¨æ‹†ç®±\n    System.out.println(b == d); // falseï¼ŒåŒ…è£…ç±»è‡ªåŠ¨è£…ç®±ä½†æ˜¯æ•°å€¼èŒƒå›´ä¸åœ¨cacheèŒƒå›´å†…\n}\n```\n\n","slug":"Javaå…«è‚¡æ–‡ - JavaåŸºç¡€","published":1,"updated":"2023-01-26T12:40:30.310Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cldzfw31w0007t9t8f86m5nb0","content":"<blockquote>\n<p>æ•´ç†çš„JavaåŸºç¡€ç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½\t<span id=\"more\"></span></p>\n</blockquote>\n<h2 id=\"Javaæ¦‚è¿°\"><a href=\"#Javaæ¦‚è¿°\" class=\"headerlink\" title=\"Javaæ¦‚è¿°\"></a>Javaæ¦‚è¿°</h2><h3 id=\"JVMã€JREå’ŒJDKçš„å…³ç³»\"><a href=\"#JVMã€JREå’ŒJDKçš„å…³ç³»\" class=\"headerlink\" title=\"JVMã€JREå’ŒJDKçš„å…³ç³»\"></a>JVMã€JREå’ŒJDKçš„å…³ç³»</h3><p>JVMï¼šJava Virtual Machineï¼ŒJava è™šæ‹Ÿæœºï¼ŒJava ç¨‹åºéœ€è¦è¿è¡Œåœ¨è™šæ‹Ÿæœºä¸Šï¼Œä¸åŒçš„å¹³å°æœ‰è‡ªå·±çš„è™šæ‹Ÿæœºï¼Œå› æ­¤ Java è¯­è¨€å¯ä»¥å®ç°è·¨å¹³å°ã€‚</p>\n<p>JREï¼šJava Runtime Environmentï¼ŒJava è¿è¡Œç¯å¢ƒï¼ŒåŒ…æ‹¬ Java è™šæ‹Ÿæœºå’Œ Java ç¨‹åºæ‰€éœ€çš„æ ¸å¿ƒç±»åº“ç­‰ã€‚</p>\n<p>JDKï¼šJava Development Kitï¼ŒJava å¼€å‘å·¥å…·åŒ…ï¼ŒåŒ…æ‹¬äº† JRE å’Œå¼€å‘å·¥å…·ã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯è·¨å¹³å°æ€§ï¼ŸåŸç†æ˜¯ä»€ä¹ˆ\"><a href=\"#ä»€ä¹ˆæ˜¯è·¨å¹³å°æ€§ï¼ŸåŸç†æ˜¯ä»€ä¹ˆ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯è·¨å¹³å°æ€§ï¼ŸåŸç†æ˜¯ä»€ä¹ˆ\"></a>ä»€ä¹ˆæ˜¯è·¨å¹³å°æ€§ï¼ŸåŸç†æ˜¯ä»€ä¹ˆ</h3><p>æ‰€è°“è·¨å¹³å°æ€§ï¼Œæ˜¯æŒ‡ Java è¯­è¨€ç¼–å†™çš„ç¨‹åºï¼Œä¸€æ¬¡ç¼–è¯‘ï¼Œåˆ°å¤„è¿è¡Œã€‚</p>\n<p>å®ç°åŸç†ï¼šJava ç¨‹åºæ˜¯é€šè¿‡ Java è™šæ‹Ÿæœºåœ¨ç³»ç»Ÿå¹³å°ä¸Šè¿è¡Œçš„ï¼Œåªè¦è¯¥ç³»ç»Ÿå¯ä»¥å®‰è£…ç›¸åº”çš„ Java è™šæ‹Ÿæœºï¼Œè¯¥ç³»ç»Ÿå°±å¯ä»¥è¿è¡Œ Java ç¨‹åºã€‚</p>\n<h3 id=\"Javaè¯­è¨€æœ‰å“ªäº›ç‰¹ç‚¹\"><a href=\"#Javaè¯­è¨€æœ‰å“ªäº›ç‰¹ç‚¹\" class=\"headerlink\" title=\"Javaè¯­è¨€æœ‰å“ªäº›ç‰¹ç‚¹\"></a>Javaè¯­è¨€æœ‰å“ªäº›ç‰¹ç‚¹</h3><p>é¢å‘å¯¹è±¡ï¼ˆå°è£…ï¼Œç»§æ‰¿ï¼Œå¤šæ€ï¼‰</p>\n<p>å¹³å°æ— å…³æ€§ï¼ˆJava è™šæ‹Ÿæœºå®ç°å¹³å°æ— å…³æ€§ï¼‰</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯å­—èŠ‚ç ï¼Ÿé‡‡ç”¨å­—èŠ‚ç çš„æœ€å¤§å¥½å¤„æ˜¯ä»€ä¹ˆ\"><a href=\"#ä»€ä¹ˆæ˜¯å­—èŠ‚ç ï¼Ÿé‡‡ç”¨å­—èŠ‚ç çš„æœ€å¤§å¥½å¤„æ˜¯ä»€ä¹ˆ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯å­—èŠ‚ç ï¼Ÿé‡‡ç”¨å­—èŠ‚ç çš„æœ€å¤§å¥½å¤„æ˜¯ä»€ä¹ˆ\"></a>ä»€ä¹ˆæ˜¯å­—èŠ‚ç ï¼Ÿé‡‡ç”¨å­—èŠ‚ç çš„æœ€å¤§å¥½å¤„æ˜¯ä»€ä¹ˆ</h3><p><strong>å­—èŠ‚ç </strong>ï¼šJava æºä»£ç ç»è¿‡è™šæ‹Ÿæœºç¼–è¯‘å™¨ç¼–è¯‘åäº§ç”Ÿçš„æ–‡ä»¶ï¼ˆå³æ‰©å±•ä¸º.class çš„æ–‡ä»¶ï¼‰ï¼Œå®ƒä¸é¢å‘ä»»ä½•ç‰¹å®šçš„å¤„ç†å™¨ï¼Œåªé¢å‘è™šæ‹Ÿæœºã€‚ï¼ˆjavac HelloWorld.Java â†’ HelloWorld.class â†’ Java HelloWorld æ‰§è¡Œç¨‹åºï¼‰</p>\n<p><strong>ç¼–è¯‘ä¸è§£é‡Šå¹¶å­˜</strong></p>\n<p>Java æºä»£ç (.Java æ–‡ä»¶)â€”-&gt;ç¼–è¯‘å™¨â€”-&gt;jvm å¯æ‰§è¡Œçš„ Java å­—èŠ‚ç (.class æ–‡ä»¶)â€”-&gt;jvmâ€”-&gt;jvm ä¸­è§£é‡Šå™¨â€”â€“&gt;æœºå™¨å¯æ‰§è¡Œçš„äºŒè¿›åˆ¶æœºå™¨ç â€”-&gt;ç¨‹åºè¿è¡Œ</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯Javaç¨‹åºçš„ä¸»ç±»ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯Javaç¨‹åºçš„ä¸»ç±»ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯Javaç¨‹åºçš„ä¸»ç±»ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯Javaç¨‹åºçš„ä¸»ç±»ï¼Ÿ</h3><p>ä¸€ä¸ªç¨‹åºä¸­å¯ä»¥æœ‰å¤šä¸ªç±»ï¼Œä½†åªèƒ½æœ‰ä¸€ä¸ªç±»æ˜¯ä¸»ç±»ã€‚åœ¨ Java åº”ç”¨ç¨‹åºä¸­ï¼Œè¿™ä¸ªä¸»ç±»æ˜¯æŒ‡åŒ…å« main()æ–¹æ³•çš„ç±»ã€‚<br>ä¸»ç±»æ˜¯ Java ç¨‹åºæ‰§è¡Œçš„å…¥å£ã€‚ï¼ˆmain æ–¹æ³•é™¤äº†æ˜¯ä¸ªä¸»æ–¹æ³•ä»¥å¤–ï¼Œå’Œæ™®é€šçš„é™æ€æ–¹æ³•æ²¡æœ‰åŒºåˆ«ï¼Œéƒ½å¯ä»¥é‡è½½ã€è°ƒç”¨ã€ç»§æ‰¿ï¼‰</p>\n<h3 id=\"Javaå’ŒC-çš„åŒºåˆ«\"><a href=\"#Javaå’ŒC-çš„åŒºåˆ«\" class=\"headerlink\" title=\"Javaå’ŒC++çš„åŒºåˆ«\"></a>Javaå’ŒC++çš„åŒºåˆ«</h3><p>ç›¸åŒç‚¹ï¼šéƒ½æ˜¯<strong>é¢å‘å¯¹è±¡</strong>çš„è¯­è¨€ï¼Œéƒ½æ”¯æŒ<strong>å°è£…ã€ç»§æ‰¿å’Œå¤šæ€</strong></p>\n<p>ä¸åŒç‚¹ï¼š</p>\n<ul>\n<li><p><strong>Javaä¸æä¾›æŒ‡é’ˆ</strong>æ¥ç›´æ¥è®¿é—®å†…å­˜ï¼Œç¨‹åºå†…å­˜æ›´åŠ å®‰å…¨ï¼Œæœ‰è‡ªåŠ¨å†…å­˜ç®¡ç†ï¼›C++ç”¨æŒ‡é’ˆç®¡ç†å†…å­˜</p>\n</li>\n<li><p>Java çš„<strong>ç±»æ˜¯å•ç»§æ‰¿</strong>çš„ï¼ŒC++æ”¯æŒå¤šé‡ç»§æ‰¿ï¼›è™½ç„¶ Java çš„ç±»ä¸å¯ä»¥å¤šç»§æ‰¿ï¼Œä½†æ˜¯æ¥å£å¯ä»¥å¤šç»§æ‰¿ã€‚</p>\n<p>  ä¸ºä»€ä¹ˆ Java ä¸­ç±»ä¸æ”¯æŒå¤šç»§æ‰¿ï¼Ÿâ€”â€”å¤šé‡ç»§æ‰¿çš„é’»çŸ³é—®é¢˜</p>\n<p>  <img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes20190622142003813.png\" alt=\"å¤šé‡ç»§æ‰¿çš„é’»çŸ³é—®é¢˜\"><br>  ç±» B å’Œç±» C ç»§æ‰¿è‡ªç±» Aï¼Œä¸”éƒ½é‡å†™äº†ç±» A ä¸­çš„åŒä¸€ä¸ªæ–¹æ³•ï¼Œè€Œç±» D åŒæ—¶ç»§æ‰¿äº†ç±» B å’Œç±» Cï¼ˆå¤šç»§æ‰¿)ï¼Œé‚£ä¹ˆæ­¤æ—¶ç±» D ä¼šç»§æ‰¿ Bã€C çš„æ–¹æ³•ï¼Œé‚£å¯¹äº Bã€C é‡å†™çš„ A ä¸­çš„æ–¹æ³•ï¼Œç±» D ä¼šç»§æ‰¿å“ªä¸€ä¸ªå‘¢ï¼Ÿ</p>\n</li>\n<li><p>Java æœ‰<strong>è‡ªåŠ¨å†…å­˜ç®¡ç†</strong>æœºåˆ¶ï¼Œä¸éœ€è¦ç¨‹åºå‘˜æ‰‹åŠ¨é‡Šæ”¾æ— ç”¨å†…å­˜</p>\n</li>\n</ul>\n<h2 id=\"åŸºç¡€è¯­æ³•\"><a href=\"#åŸºç¡€è¯­æ³•\" class=\"headerlink\" title=\"åŸºç¡€è¯­æ³•\"></a>åŸºç¡€è¯­æ³•</h2><h3 id=\"æ•°æ®ç±»å‹\"><a href=\"#æ•°æ®ç±»å‹\" class=\"headerlink\" title=\"æ•°æ®ç±»å‹\"></a>æ•°æ®ç±»å‹</h3><p><strong>å®šä¹‰</strong>ï¼šJava è¯­è¨€æ˜¯å¼ºç±»å‹è¯­è¨€ï¼Œå¯¹äºæ¯ä¸€ç§æ•°æ®éƒ½å®šä¹‰äº†æ˜ç¡®çš„å…·ä½“çš„æ•°æ®ç±»å‹ï¼Œåœ¨å†…å­˜ä¸­åˆ†é…äº†ä¸åŒå¤§å°çš„å†…å­˜ç©ºé—´ã€‚</p>\n<p><strong>åˆ†ç±»</strong></p>\n<ul>\n<li>åŸºæœ¬æ•°æ®ç±»å‹<ul>\n<li>æ•°å€¼å‹<ul>\n<li>æ•´æ•°ç±»å‹(byte,short,int,long)</li>\n<li>æµ®ç‚¹ç±»å‹(float,double)</li>\n</ul>\n</li>\n<li>å­—ç¬¦å‹(char)</li>\n<li>å¸ƒå°”å‹(boolean)</li>\n</ul>\n</li>\n<li>å¼•ç”¨æ•°æ®ç±»å‹<ul>\n<li>ç±»(class)</li>\n<li>æ¥å£(interface)</li>\n<li>æ•°ç»„([])</li>\n</ul>\n</li>\n</ul>\n<p><strong>JavaåŸºæœ¬æ•°æ®ç±»å‹å›¾</strong></p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0pvdXJXb24vaW1hZ2UvbWFzdGVyL0phdmElRTUlOUYlQkElRTclQTElODAlRTglQUYlQUQlRTYlQjMlOTUvSmF2YSVFNSU5RiVCQSVFNiU5QyVBQyVFNiU5NSVCMCVFNiU4RCVBRSVFNyVCMSVCQiVFNSU5RSU4Qi5wbmc.png\" alt=\"JavaåŸºæœ¬æ•°æ®ç±»å‹å›¾\"></p>\n<h3 id=\"ç±»å‹è½¬æ¢\"><a href=\"#ç±»å‹è½¬æ¢\" class=\"headerlink\" title=\"ç±»å‹è½¬æ¢\"></a>ç±»å‹è½¬æ¢</h3><p>è‡ªåŠ¨ç±»å‹è½¬æ¢</p>\n<blockquote>\n<p>ä¸¤ç§æ•°æ®ç±»å‹å½¼æ­¤å…¼å®¹</p>\n<p>ä½çº§ç±»å‹æ•°æ®è½¬æ¢æˆé«˜çº§ç±»å‹æ•°æ®</p>\n</blockquote>\n<ul>\n<li>æ•°å€¼å‹æ•°æ®çš„è½¬æ¢ï¼šbyteâ†’shortâ†’intâ†’longâ†’floatâ†’double</li>\n<li>å­—ç¬¦å‹è½¬æ¢ä¸ºæ•´å‹ï¼šcharâ†’intã€‚</li>\n</ul>\n<p>å¼ºåˆ¶ç±»å‹è½¬æ¢</p>\n<blockquote>\n<p>å½“ä¸¤ç§æ•°æ®ç±»å‹ä¸å…¼å®¹ï¼Œæˆ–é«˜çº§ç±»å‹æ•°æ®è½¬æ¢æˆä½çº§ç±»å‹æ•°æ®æ—¶ï¼Œè‡ªåŠ¨è½¬æ¢å°†æ— æ³•è¿›è¡Œï¼ˆç¼–è¯‘é”™è¯¯ï¼‰ï¼Œè¿™æ—¶å°±éœ€è¦è¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢</p>\n</blockquote>\n<h3 id=\"è®¿é—®ä¿®é¥°ç¬¦\"><a href=\"#è®¿é—®ä¿®é¥°ç¬¦\" class=\"headerlink\" title=\"è®¿é—®ä¿®é¥°ç¬¦\"></a>è®¿é—®ä¿®é¥°ç¬¦</h3><p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0pvdXJXb24vaW1hZ2UvbWFzdGVyL0phdmElRTUlOUYlQkElRTclQTElODAlRTglQUYlQUQlRTYlQjMlOTUvSmF2YSVFOCVBRSVCRiVFOSU5NyVBRSVFNCVCRiVBRSVFOSVBNSVCMCVFNyVBQyVBNi5wbmc.png\" alt=\"è®¿é—®ä¿®é¥°ç¬¦\"></p>\n<h3 id=\"å…³é”®å­—\"><a href=\"#å…³é”®å­—\" class=\"headerlink\" title=\"å…³é”®å­—\"></a>å…³é”®å­—</h3><h4 id=\"final-æœ‰ä»€ä¹ˆç”¨ï¼Ÿ\"><a href=\"#final-æœ‰ä»€ä¹ˆç”¨ï¼Ÿ\" class=\"headerlink\" title=\"final æœ‰ä»€ä¹ˆç”¨ï¼Ÿ\"></a>final æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h4><p>ç”¨äºä¿®é¥°ç±»ã€æ–¹æ³•å’Œå˜é‡ï¼›</p>\n<ul>\n<li><p>è¢« final ä¿®é¥°çš„ç±»ä¸å¯ä»¥è¢«ç»§æ‰¿</p>\n</li>\n<li><p>è¢« final ä¿®é¥°çš„æ–¹æ³•ä¸å¯ä»¥è¢«é‡å†™</p>\n</li>\n<li><p>è¢« final ä¿®é¥°çš„å˜é‡ä¸å¯ä»¥è¢«æ”¹å˜ï¼Œè¢« final ä¿®é¥°<strong>ä¸å¯å˜çš„æ˜¯å˜é‡çš„å¼•ç”¨ï¼Œè€Œä¸æ˜¯å¼•ç”¨æŒ‡å‘çš„å†…å®¹</strong>ï¼Œå¼•ç”¨æŒ‡å‘çš„å†…å®¹æ˜¯å¯ä»¥æ”¹å˜</p>\n  <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">final</span> <span class=\"type\">int</span>[] nums = <span class=\"keyword\">new</span> <span class=\"title class_\">int</span>[]&#123;<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>&#125;;</span><br><span class=\"line\">nums[<span class=\"number\">0</span>] = <span class=\"number\">11</span>;</span><br><span class=\"line\">System.out.println(Arrays.toString(nums));\t<span class=\"comment\">// [11, 2, 3]</span></span><br></pre></td></tr></table></figure></li>\n</ul>\n<h4 id=\"finalã€finallyã€finalizeåŒºåˆ«\"><a href=\"#finalã€finallyã€finalizeåŒºåˆ«\" class=\"headerlink\" title=\"finalã€finallyã€finalizeåŒºåˆ«\"></a>finalã€finallyã€finalizeåŒºåˆ«</h4><ul>\n<li><p>final æ˜¯ Java ä¿®é¥°ç¬¦ï¼Œå¯ä»¥ä¿®é¥°ç±»ã€æ–¹æ³•ã€å˜é‡ï¼Œä¿®é¥°ç±»è¡¨ç¤ºè¯¥ç±»ä¸èƒ½è¢«ç»§æ‰¿ã€ä¿®é¥°æ–¹æ³•è¡¨ç¤ºè¯¥æ–¹æ³•ä¸èƒ½è¢«é‡å†™ã€ä¿®é¥°å˜é‡è¡¨ç¤ºè¯¥å˜é‡ä¸å¯ä»¥è¢«æ”¹å˜ã€‚</p>\n</li>\n<li><p>finally ä¸€èˆ¬ä½œç”¨åœ¨ try-catch ä»£ç å—ä¸­ï¼Œåœ¨å¤„ç†å¼‚å¸¸çš„æ—¶å€™ï¼Œé€šå¸¸æˆ‘ä»¬å°†ä¸€å®šè¦æ‰§è¡Œçš„ä»£ç æ”¾åœ¨ finally ä»£ç å—ä¸­ï¼Œè¡¨ç¤ºä¸ç®¡æ˜¯å¦å‡ºç°å¼‚å¸¸ï¼Œè¯¥ä»£ç å—éƒ½ä¼šæ‰§è¡Œï¼Œä¸€èˆ¬ç”¨æ¥å­˜æ”¾ä¸€äº›å…³é—­èµ„æºçš„ä»£ç ã€‚</p>\n</li>\n<li><p>finalize æ˜¯ Object ç±»çš„ä¸€ä¸ªæ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¸€èˆ¬ç”±åƒåœ¾å›æ”¶å™¨æ¥è°ƒç”¨ï¼Œåœ¨æ‰§è¡Œåƒåœ¾å›æ”¶å‰ï¼Œç”±åƒåœ¾å›æ”¶å™¨è°ƒç”¨å¯¹è±¡çš„ finalize()æ–¹æ³•ï¼Œå¹¶ä¸”åœ¨è¯¥æ–¹æ³•ä¸­å¯¹è±¡å¯èƒ½å¯ä»¥å¤æ´»ã€‚</p>\n</li>\n</ul>\n<h4 id=\"thiså…³é”®å­—çš„ç”¨æ³•\"><a href=\"#thiså…³é”®å­—çš„ç”¨æ³•\" class=\"headerlink\" title=\"thiså…³é”®å­—çš„ç”¨æ³•\"></a>thiså…³é”®å­—çš„ç”¨æ³•</h4><p>æŒ‡å‘å¯¹è±¡æœ¬èº«çš„ä¸€ä¸ªæŒ‡é’ˆã€‚</p>\n<h4 id=\"superå…³é”®å­—çš„ç”¨æ³•\"><a href=\"#superå…³é”®å­—çš„ç”¨æ³•\" class=\"headerlink\" title=\"superå…³é”®å­—çš„ç”¨æ³•\"></a>superå…³é”®å­—çš„ç”¨æ³•</h4><p>æŒ‡å‘è‡ªå·±çˆ¶ç±»å¯¹è±¡ï¼ˆæœ€è¿‘çš„çˆ¶ç±»ï¼‰çš„ä¸€ä¸ªæŒ‡é’ˆã€‚</p>\n<h4 id=\"staticå­˜åœ¨çš„ä¸»è¦æ„ä¹‰\"><a href=\"#staticå­˜åœ¨çš„ä¸»è¦æ„ä¹‰\" class=\"headerlink\" title=\"staticå­˜åœ¨çš„ä¸»è¦æ„ä¹‰\"></a>staticå­˜åœ¨çš„ä¸»è¦æ„ä¹‰</h4><p>static<strong>é™æ€å˜é‡</strong>ï¼šå’Œç±»ä¸€èµ·åŠ è½½ï¼Œ<strong>ä»¥è‡´äºå³ä½¿æ²¡æœ‰åˆ›å»ºå¯¹è±¡ï¼Œä¹Ÿèƒ½ä½¿ç”¨å±æ€§å’Œè°ƒç”¨æ–¹æ³•ã€‚</strong></p>\n<p>static<strong>é™æ€ä»£ç å—</strong>ï¼šåœ¨ç±»åˆæ¬¡è¢«åŠ è½½çš„æ—¶å€™ï¼Œä¼šæŒ‰ç…§ static å—çš„é¡ºåºæ¥æ‰§è¡Œæ¯ä¸ª static å—ï¼Œå¹¶ä¸”åªä¼šæ‰§è¡Œä¸€æ¬¡ã€‚<br>åŠ è½½ â†’ é“¾æ¥ï¼ˆéªŒè¯ã€å‡†å¤‡ã€è§£æï¼‰ â†’ åˆå§‹åŒ–</p>\n<p>static ç±»å‹çš„å˜é‡åœ¨å‡†å¤‡é˜¶æ®µè¿›è¡Œé»˜è®¤åˆå§‹åŒ–ï¼Œä½†æ˜¯æœ‰ static final ä¿®é¥°çš„ä¼šåœ¨å‡†å¤‡é˜¶æ®µç›´æ¥èµ‹å€¼ï¼Œ åœ¨åˆå§‹åŒ–é˜¶æ®µè¿›è¡Œæ˜¾å¼åˆå§‹åŒ–ã€‚</p>\n<h4 id=\"staticæ³¨æ„äº‹é¡¹\"><a href=\"#staticæ³¨æ„äº‹é¡¹\" class=\"headerlink\" title=\"staticæ³¨æ„äº‹é¡¹\"></a>staticæ³¨æ„äº‹é¡¹</h4><p>1ã€é™æ€åªèƒ½è®¿é—®é™æ€ã€‚ 2ã€éé™æ€æ—¢å¯ä»¥è®¿é—®éé™æ€çš„ï¼Œä¹Ÿå¯ä»¥è®¿é—®é™æ€çš„ã€‚</p>\n<h3 id=\"åˆå§‹åŒ–é¡ºåº\"><a href=\"#åˆå§‹åŒ–é¡ºåº\" class=\"headerlink\" title=\"åˆå§‹åŒ–é¡ºåº\"></a>åˆå§‹åŒ–é¡ºåº</h3><p>é™æ€å±æ€§ â†’ é™æ€æ–¹æ³•å— â†’ æ™®é€šå±æ€§ â†’ æ™®é€šæ–¹æ³•å— â†’ æ„é€ å‡½æ•°</p>\n<h3 id=\"æµç¨‹æ§åˆ¶è¯­å¥\"><a href=\"#æµç¨‹æ§åˆ¶è¯­å¥\" class=\"headerlink\" title=\"æµç¨‹æ§åˆ¶è¯­å¥\"></a>æµç¨‹æ§åˆ¶è¯­å¥</h3><h4 id=\"break-ã€continueã€return-çš„åŒºåˆ«åŠä½œç”¨\"><a href=\"#break-ã€continueã€return-çš„åŒºåˆ«åŠä½œç”¨\" class=\"headerlink\" title=\"break ã€continueã€return çš„åŒºåˆ«åŠä½œç”¨\"></a>break ã€continueã€return çš„åŒºåˆ«åŠä½œç”¨</h4><p>break ç»“æŸå½“å‰çš„å¾ªç¯ä½“</p>\n<p>continue ç»“æŸæ­£åœ¨æ‰§è¡Œçš„å¾ªç¯ï¼Œè¿›å…¥ä¸‹ä¸€ä¸ªå¾ªç¯æ¡ä»¶</p>\n<p>return ç»“æŸå½“å‰çš„æ–¹æ³•ï¼Œç›´æ¥è¿”å›</p>\n<h4 id=\"è·³å‡ºå½“å‰çš„å¤šé‡åµŒå¥—å¾ªç¯\"><a href=\"#è·³å‡ºå½“å‰çš„å¤šé‡åµŒå¥—å¾ªç¯\" class=\"headerlink\" title=\"è·³å‡ºå½“å‰çš„å¤šé‡åµŒå¥—å¾ªç¯\"></a>è·³å‡ºå½“å‰çš„å¤šé‡åµŒå¥—å¾ªç¯</h4><p>åœ¨ Java ä¸­ï¼Œè¦æƒ³è·³å‡ºå¤šé‡å¾ªç¯ï¼Œå¯ä»¥åœ¨å¤–é¢çš„å¾ªç¯è¯­å¥å‰å®šä¹‰ä¸€ä¸ªæ ‡å·ï¼Œç„¶ååœ¨é‡Œå±‚å¾ªç¯ä½“çš„ä»£ç ä¸­ä½¿ç”¨å¸¦æœ‰æ ‡å·çš„ break è¯­å¥ï¼Œå³å¯è·³å‡ºå¤–å±‚å¾ªç¯ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">    ok:</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">j</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; j &lt; <span class=\"number\">10</span>; j++) &#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;i=&quot;</span> + i + <span class=\"string\">&quot;,j=&quot;</span> + j);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (j == <span class=\"number\">5</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">break</span> ok;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"é¢å‘å¯¹è±¡\"><a href=\"#é¢å‘å¯¹è±¡\" class=\"headerlink\" title=\"é¢å‘å¯¹è±¡\"></a>é¢å‘å¯¹è±¡</h2><h3 id=\"é¢å‘å¯¹è±¡ä¸‰å¤§ç‰¹æ€§\"><a href=\"#é¢å‘å¯¹è±¡ä¸‰å¤§ç‰¹æ€§\" class=\"headerlink\" title=\"é¢å‘å¯¹è±¡ä¸‰å¤§ç‰¹æ€§\"></a>é¢å‘å¯¹è±¡ä¸‰å¤§ç‰¹æ€§</h3><h4 id=\"é¢å‘å¯¹è±¡çš„ç‰¹å¾æœ‰å“ªäº›æ–¹é¢\"><a href=\"#é¢å‘å¯¹è±¡çš„ç‰¹å¾æœ‰å“ªäº›æ–¹é¢\" class=\"headerlink\" title=\"é¢å‘å¯¹è±¡çš„ç‰¹å¾æœ‰å“ªäº›æ–¹é¢\"></a>é¢å‘å¯¹è±¡çš„ç‰¹å¾æœ‰å“ªäº›æ–¹é¢</h4><p><strong>æŠ½è±¡</strong>ï¼šæŠ½è±¡æ˜¯å°†ä¸€ç±»å¯¹è±¡çš„å…±åŒç‰¹å¾æ€»ç»“å‡ºæ¥æ„é€ ç±»çš„è¿‡ç¨‹ï¼ŒåŒ…æ‹¬æ•°æ®æŠ½è±¡å’Œè¡Œä¸ºæŠ½è±¡ä¸¤æ–¹é¢ã€‚æŠ½è±¡åªå…³æ³¨å¯¹è±¡æœ‰å“ªäº›å±æ€§å’Œè¡Œä¸ºï¼Œå¹¶ä¸å…³æ³¨è¿™äº›è¡Œä¸ºçš„ç»†èŠ‚æ˜¯ä»€ä¹ˆã€‚</p>\n<p><strong>å°è£…</strong></p>\n<p>å°è£…æŠŠä¸€ä¸ªå¯¹è±¡çš„å±æ€§ç§æœ‰åŒ–ï¼ŒåŒæ—¶æä¾›ä¸€äº›å¯ä»¥è¢«å¤–ç•Œè®¿é—®çš„å±æ€§çš„æ–¹æ³•ï¼Œå¦‚æœå±æ€§ä¸æƒ³è¢«å¤–ç•Œè®¿é—®ï¼Œæˆ‘ä»¬å¤§å¯ä¸å¿…æä¾›æ–¹æ³•ç»™å¤–ç•Œè®¿é—®ã€‚</p>\n<p><strong>ç»§æ‰¿</strong></p>\n<p>ç»§æ‰¿æ˜¯<strong>ä½¿ç”¨å·²å­˜åœ¨çš„ç±»ä½œä¸ºåŸºç¡€å»ºç«‹æ–°ç±»</strong>çš„æŠ€æœ¯ï¼Œæ–°ç±»çš„å®šä¹‰å¯ä»¥å¢åŠ æ–°çš„æ•°æ®æˆ–æ–°çš„åŠŸèƒ½ï¼Œä¹Ÿå¯ä»¥ç”¨çˆ¶ç±»çš„åŠŸèƒ½ã€‚é€šè¿‡ä½¿ç”¨ç»§æ‰¿æˆ‘ä»¬èƒ½å¤Ÿéå¸¸æ–¹ä¾¿åœ°å¤ç”¨ä»¥å‰çš„ä»£ç ã€‚</p>\n<p>å…³äºç»§æ‰¿å¦‚ä¸‹ 3 ç‚¹è¯·è®°ä½ï¼š</p>\n<ol>\n<li>å­ç±»æ‹¥æœ‰çˆ¶ç±»é private çš„å±æ€§å’Œæ–¹æ³•ã€‚</li>\n<li>å­ç±»å¯ä»¥æ‹¥æœ‰è‡ªå·±å±æ€§å’Œæ–¹æ³•ï¼Œå³å­ç±»å¯ä»¥å¯¹çˆ¶ç±»è¿›è¡Œæ‰©å±•ã€‚</li>\n<li>å­ç±»å¯ä»¥ç”¨è‡ªå·±çš„æ–¹å¼å®ç°çˆ¶ç±»çš„æ–¹æ³•ï¼Œoverride é‡å†™ã€‚</li>\n</ol>\n<p><strong>å¤šæ€</strong></p>\n<p>æ‰€è°“å¤šæ€å°±æ˜¯æŒ‡ä¸€ä¸ªå¼•ç”¨å˜é‡åˆ°åº•ä¼šæŒ‡å‘å“ªä¸ªç±»çš„å®ä¾‹å¯¹è±¡ï¼Œè¯¥å¼•ç”¨å˜é‡è°ƒç”¨çš„æ–¹æ³•åˆ°åº•æ˜¯å“ªä¸ªç±»ä¸­å®ç°çš„æ–¹æ³•ï¼Œå¿…é¡»åœ¨ç¨‹åºè¿è¡ŒæœŸé—´æ‰èƒ½ç¡®å®šï¼Œç¼–è¯‘æœŸæ— æ³•ç¡®å®šã€‚</p>\n<p>çˆ¶ç±»çš„å¼•ç”¨æŒ‡å‘å­ç±»å®ä¾‹å¯¹è±¡ã€æ¥å£æŒ‡å‘å®ç°ç±»å®ä¾‹å¯¹è±¡ã€‚æé«˜äº†ç¨‹åºçš„æ‹“å±•æ€§ã€‚</p>\n<p>åœ¨ Java ä¸­æœ‰ä¸¤ç§å½¢å¼å¯ä»¥å®ç°å¤šæ€ï¼šç»§æ‰¿ï¼ˆå¤šä¸ªå­ç±»å¯¹åŒä¸€æ–¹æ³•çš„é‡å†™ï¼‰å’Œæ¥å£ï¼ˆå®ç°æ¥å£å¹¶è¦†ç›–æ¥å£ä¸­åŒä¸€æ–¹æ³•ï¼‰ã€‚</p>\n<p>æ–¹æ³•é‡è½½ï¼ˆoverloadï¼‰å®ç°ç¼–è¯‘æ—¶çš„å¤šæ€æ€§ï¼ˆä¹Ÿç§°ä¸ºå‰ç»‘å®šï¼‰ï¼Œæ–¹æ³•é‡å†™ï¼ˆoverrideï¼‰å®ç°è¿è¡Œæ—¶çš„å¤šæ€æ€§ï¼ˆä¹Ÿç§°ä¸ºåç»‘å®šï¼‰ã€‚</p>\n<p>Java å®ç°å¤šæ€æœ‰ä¸‰ä¸ªå¿…è¦æ¡ä»¶ï¼šç»§æ‰¿ã€é‡å†™ã€å‘ä¸Šè½¬å‹ã€‚</p>\n<blockquote>\n<p>ç»§æ‰¿ï¼šåœ¨å¤šæ€ä¸­å¿…é¡»å­˜åœ¨æœ‰ç»§æ‰¿å…³ç³»çš„å­ç±»å’Œçˆ¶ç±»ã€‚</p>\n<p>é‡å†™ï¼šå­ç±»å¯¹çˆ¶ç±»ä¸­æŸäº›æ–¹æ³•è¿›è¡Œé‡æ–°å®šä¹‰ï¼Œåœ¨è°ƒç”¨è¿™äº›æ–¹æ³•æ—¶å°±ä¼šè°ƒç”¨å­ç±»çš„æ–¹æ³•ã€‚</p>\n<p>å‘ä¸Šè½¬å‹ï¼šåœ¨å¤šæ€ä¸­éœ€è¦å°†å­ç±»çš„å¼•ç”¨èµ‹ç»™çˆ¶ç±»å¯¹è±¡ï¼Œåªæœ‰è¿™æ ·è¯¥å¼•ç”¨æ‰èƒ½å¤Ÿå…·å¤‡æŠ€èƒ½è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•å’Œå­ç±»çš„æ–¹æ³•ã€‚</p>\n</blockquote>\n<p>åªæœ‰æ»¡è¶³äº†ä¸Šè¿°ä¸‰ä¸ªæ¡ä»¶ï¼Œæˆ‘ä»¬æ‰èƒ½å¤Ÿåœ¨åŒä¸€ä¸ªç»§æ‰¿ç»“æ„ä¸­ä½¿ç”¨ç»Ÿä¸€çš„é€»è¾‘å®ç°ä»£ç å¤„ç†ä¸åŒçš„å¯¹è±¡ï¼Œä»è€Œè¾¾åˆ°æ‰§è¡Œä¸åŒçš„è¡Œä¸ºã€‚</p>\n<h4 id=\"æŠ½è±¡ç±»å’Œæ¥å£çš„å¯¹æ¯”\"><a href=\"#æŠ½è±¡ç±»å’Œæ¥å£çš„å¯¹æ¯”\" class=\"headerlink\" title=\"æŠ½è±¡ç±»å’Œæ¥å£çš„å¯¹æ¯”\"></a>æŠ½è±¡ç±»å’Œæ¥å£çš„å¯¹æ¯”</h4><p>æŠ½è±¡ç±»æ˜¯å¯¹ç±»çš„æŠ½è±¡ï¼Œç”¨æ¥<strong>æ•æ‰é€šç”¨ç‰¹æ€§</strong>ã€‚æ¥å£æ˜¯<strong>è¡Œä¸ºçš„æŠ½è±¡</strong>ï¼ŒæŠ½è±¡æ–¹æ³•çš„é›†åˆã€‚</p>\n<p><strong>ç›¸åŒç‚¹</strong></p>\n<ul>\n<li>æ¥å£å’ŒæŠ½è±¡ç±»éƒ½ä¸èƒ½å®ä¾‹åŒ–</li>\n<li>éƒ½ä½äºç»§æ‰¿çš„é¡¶ç«¯ï¼Œç”¨äºè¢«å…¶ä»–ç±»å®ç°æˆ–ç»§æ‰¿</li>\n<li>éƒ½åŒ…å«æŠ½è±¡æ–¹æ³•ï¼Œå…¶å­ç±»éƒ½å¿…é¡»é‡å†™è¿™äº›æŠ½è±¡æ–¹æ³•</li>\n</ul>\n<p><strong>ä¸åŒç‚¹</strong></p>\n<table>\n<thead>\n<tr>\n<th>å‚æ•°</th>\n<th>æŠ½è±¡ç±»</th>\n<th>æ¥å£</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>å£°æ˜</td>\n<td>æŠ½è±¡ç±»ä½¿ç”¨abstractå…³é”®å­—å£°æ˜</td>\n<td>æ¥å£ä½¿ç”¨interfaceå…³é”®å­—å£°æ˜</td>\n</tr>\n<tr>\n<td>å®ç°</td>\n<td>å­ç±»ä½¿ç”¨extendså…³é”®å­—æ¥ç»§æ‰¿æŠ½è±¡ç±»</td>\n<td>å­ç±»ä½¿ç”¨implementså…³é”®å­—æ¥å®ç°æ¥å£</td>\n</tr>\n<tr>\n<td>æ„é€ å™¨</td>\n<td>æŠ½è±¡ç±»å¯ä»¥æœ‰æ„é€ å™¨</td>\n<td>æ¥å£ä¸èƒ½æœ‰æ„é€ å™¨</td>\n</tr>\n<tr>\n<td>è®¿é—®ä¿®é¥°ç¬¦</td>\n<td>æŠ½è±¡ç±»ä¸­çš„æ–¹æ³•å¯ä»¥æ˜¯ä»»æ„è®¿é—®ä¿®é¥°ç¬¦</td>\n<td>æ¥å£æ–¹æ³•é»˜è®¤ä¿®é¥°ç¬¦æ˜¯publicï¼Œä¹Ÿå¯ä»¥ä¸åŠ è®¿é—®ä¿®é¥°ç¬¦</td>\n</tr>\n<tr>\n<td>å¤šç»§æ‰¿</td>\n<td>ä¸€ä¸ªç±»æœ€å¤šåªèƒ½ç»§æ‰¿ä¸€ä¸ªæŠ½è±¡ç±»</td>\n<td>ä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£</td>\n</tr>\n</tbody></table>\n<h4 id=\"æ™®é€šç±»å’ŒæŠ½è±¡ç±»æœ‰å“ªäº›åŒºåˆ«ï¼Ÿ\"><a href=\"#æ™®é€šç±»å’ŒæŠ½è±¡ç±»æœ‰å“ªäº›åŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"æ™®é€šç±»å’ŒæŠ½è±¡ç±»æœ‰å“ªäº›åŒºåˆ«ï¼Ÿ\"></a>æ™®é€šç±»å’ŒæŠ½è±¡ç±»æœ‰å“ªäº›åŒºåˆ«ï¼Ÿ</h4><ul>\n<li>æ™®é€šç±»ä¸èƒ½åŒ…å«æŠ½è±¡æ–¹æ³•ï¼ŒæŠ½è±¡ç±»å¯ä»¥åŒ…å«æŠ½è±¡æ–¹æ³•ã€‚</li>\n<li>æŠ½è±¡ç±»ä¸èƒ½ç›´æ¥å®ä¾‹åŒ–ï¼Œæ™®é€šç±»å¯ä»¥ç›´æ¥å®ä¾‹åŒ–ã€‚</li>\n</ul>\n<h4 id=\"æˆå‘˜å˜é‡å’Œå±€éƒ¨å˜é‡çš„åŒºåˆ«\"><a href=\"#æˆå‘˜å˜é‡å’Œå±€éƒ¨å˜é‡çš„åŒºåˆ«\" class=\"headerlink\" title=\"æˆå‘˜å˜é‡å’Œå±€éƒ¨å˜é‡çš„åŒºåˆ«\"></a>æˆå‘˜å˜é‡å’Œå±€éƒ¨å˜é‡çš„åŒºåˆ«</h4><table>\n<thead>\n<tr>\n<th></th>\n<th>æˆå‘˜å˜é‡</th>\n<th>å±€éƒ¨å˜é‡</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><strong>ä½œç”¨åŸŸ</strong></td>\n<td>æ•´ä¸ªç±»å¯ä½¿ç”¨</td>\n<td>æ–¹æ³•ä½“å†…ä½¿ç”¨</td>\n</tr>\n<tr>\n<td><strong>å­˜å‚¨ä½ç½®</strong></td>\n<td>å±äºå¯¹è±¡ï¼Œå­˜åœ¨å †å†…å­˜ä¸­</td>\n<td>å±äºæ–¹æ³•ï¼Œå­˜åœ¨æ ˆå¸§ä¸­</td>\n</tr>\n<tr>\n<td><strong>ç”Ÿå‘½å‘¨æœŸ</strong></td>\n<td>å’Œå¯¹è±¡åŒç”Ÿå‘½å‘¨æœŸ</td>\n<td>å’Œæ–¹æ³•åŒç”Ÿå‘½å‘¨æœŸ</td>\n</tr>\n<tr>\n<td><strong>åˆå§‹å€¼</strong></td>\n<td>ä¸æŒ‡å®šçš„è¯æœ‰é»˜è®¤åˆå§‹å€¼</td>\n<td>å¿…é¡»æ‰‹åŠ¨åˆå§‹åŒ–å¦åˆ™<br />ä¸èƒ½ä½¿ç”¨ï¼ˆç¼–è¯‘é”™è¯¯ï¼‰</td>\n</tr>\n</tbody></table>\n<p><strong>ä½¿ç”¨åŸåˆ™</strong></p>\n<p>åœ¨ä½¿ç”¨å˜é‡æ—¶éœ€è¦éµå¾ªçš„åŸåˆ™ä¸ºï¼šå°±è¿‘åŸåˆ™<br>é¦–å…ˆåœ¨å±€éƒ¨èŒƒå›´æ‰¾ï¼Œæœ‰å°±ä½¿ç”¨ï¼›æ¥ç€åœ¨æˆå‘˜ä½ç½®æ‰¾ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Main</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">a</span> <span class=\"operator\">=</span> <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">a</span> <span class=\"operator\">=</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">        System.out.println(a);\t<span class=\"comment\">// 1</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"å†…éƒ¨ç±»\"><a href=\"#å†…éƒ¨ç±»\" class=\"headerlink\" title=\"å†…éƒ¨ç±»\"></a>å†…éƒ¨ç±»</h3><h4 id=\"ä»€ä¹ˆæ˜¯å†…éƒ¨ç±»ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯å†…éƒ¨ç±»ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯å†…éƒ¨ç±»ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯å†…éƒ¨ç±»ï¼Ÿ</h4><p>åœ¨ Java ä¸­ï¼Œå¯ä»¥å°†ä¸€ä¸ªç±»çš„å®šä¹‰æ”¾åœ¨å¦å¤–ä¸€ä¸ªç±»çš„å®šä¹‰å†…éƒ¨ï¼Œè¿™å°±æ˜¯<strong>å†…éƒ¨ç±»</strong>ã€‚</p>\n<h4 id=\"å†…éƒ¨ç±»çš„åˆ†ç±»æœ‰å“ªäº›\"><a href=\"#å†…éƒ¨ç±»çš„åˆ†ç±»æœ‰å“ªäº›\" class=\"headerlink\" title=\"å†…éƒ¨ç±»çš„åˆ†ç±»æœ‰å“ªäº›\"></a>å†…éƒ¨ç±»çš„åˆ†ç±»æœ‰å“ªäº›</h4><p>å†…éƒ¨ç±»å¯ä»¥åˆ†ä¸ºå››ç§ï¼š<strong>é™æ€å†…éƒ¨ç±»ã€æˆå‘˜å†…éƒ¨ç±»ã€å±€éƒ¨å†…éƒ¨ç±»ã€åŒ¿åå†…éƒ¨ç±»</strong>ã€‚</p>\n<h5 id=\"é™æ€å†…éƒ¨ç±»\"><a href=\"#é™æ€å†…éƒ¨ç±»\" class=\"headerlink\" title=\"é™æ€å†…éƒ¨ç±»\"></a>é™æ€å†…éƒ¨ç±»</h5><p>å®šä¹‰åœ¨ç±»å†…éƒ¨çš„é™æ€ç±»ï¼Œå°±æ˜¯é™æ€å†…éƒ¨ç±»ã€‚</p>\n<p>é™æ€å†…éƒ¨ç±»å¯ä»¥è®¿é—®å¤–éƒ¨ç±»æ‰€æœ‰çš„é™æ€å˜é‡ï¼Œè€Œä¸å¯è®¿é—®å¤–éƒ¨ç±»çš„éé™æ€å˜é‡</p>\n<h5 id=\"æˆå‘˜å†…éƒ¨ç±»\"><a href=\"#æˆå‘˜å†…éƒ¨ç±»\" class=\"headerlink\" title=\"æˆå‘˜å†…éƒ¨ç±»\"></a>æˆå‘˜å†…éƒ¨ç±»</h5><p>å®šä¹‰åœ¨ç±»å†…éƒ¨ï¼Œæˆå‘˜ä½ç½®ä¸Šçš„éé™æ€ç±»ï¼Œå°±æ˜¯æˆå‘˜å†…éƒ¨ç±»ã€‚</p>\n<p>æˆå‘˜å†…éƒ¨ç±»å¯ä»¥è®¿é—®å¤–éƒ¨ç±»æ‰€æœ‰çš„å˜é‡å’Œæ–¹æ³•ï¼ŒåŒ…æ‹¬é™æ€å’Œéé™æ€ï¼Œç§æœ‰å’Œå…¬æœ‰ã€‚</p>\n<h5 id=\"å±€éƒ¨å†…éƒ¨ç±»\"><a href=\"#å±€éƒ¨å†…éƒ¨ç±»\" class=\"headerlink\" title=\"å±€éƒ¨å†…éƒ¨ç±»\"></a>å±€éƒ¨å†…éƒ¨ç±»</h5><p>å®šä¹‰åœ¨æ–¹æ³•ä¸­çš„å†…éƒ¨ç±»ï¼Œå°±æ˜¯å±€éƒ¨å†…éƒ¨ç±»ã€‚</p>\n<p>å®šä¹‰åœ¨å®ä¾‹æ–¹æ³•ä¸­çš„å±€éƒ¨ç±»å¯ä»¥è®¿é—®å¤–éƒ¨ç±»çš„æ‰€æœ‰å˜é‡å’Œæ–¹æ³•ï¼Œå®šä¹‰åœ¨é™æ€æ–¹æ³•ä¸­çš„å±€éƒ¨ç±»åªèƒ½è®¿é—®å¤–éƒ¨ç±»çš„é™æ€å˜é‡å’Œæ–¹æ³•</p>\n<h5 id=\"åŒ¿åå†…éƒ¨ç±»\"><a href=\"#åŒ¿åå†…éƒ¨ç±»\" class=\"headerlink\" title=\"åŒ¿åå†…éƒ¨ç±»\"></a>åŒ¿åå†…éƒ¨ç±»</h5><p>åŒ¿åå†…éƒ¨ç±»å°±æ˜¯æ²¡æœ‰åå­—çš„å†…éƒ¨ç±»ï¼Œæ—¥å¸¸å¼€å‘ä¸­ä½¿ç”¨çš„æ¯”è¾ƒå¤šã€‚åŒ¿åå†…éƒ¨ç±»å¿…é¡»ç»§æ‰¿æˆ–å®ç°ä¸€ä¸ªå·²æœ‰çš„æ¥å£ ï¼ŒåŒ¿åå†…éƒ¨ç±»ä¸èƒ½å®šä¹‰ä»»ä½•é™æ€æˆå‘˜å’Œé™æ€æ–¹æ³•</p>\n<h4 id=\"å±€éƒ¨å†…éƒ¨ç±»å’ŒåŒ¿åå†…éƒ¨ç±»è®¿é—®å±€éƒ¨å˜é‡çš„æ—¶å€™ï¼Œä¸ºä»€ä¹ˆå˜é‡å¿…é¡»è¦åŠ ä¸Šfinalï¼Ÿ\"><a href=\"#å±€éƒ¨å†…éƒ¨ç±»å’ŒåŒ¿åå†…éƒ¨ç±»è®¿é—®å±€éƒ¨å˜é‡çš„æ—¶å€™ï¼Œä¸ºä»€ä¹ˆå˜é‡å¿…é¡»è¦åŠ ä¸Šfinalï¼Ÿ\" class=\"headerlink\" title=\"å±€éƒ¨å†…éƒ¨ç±»å’ŒåŒ¿åå†…éƒ¨ç±»è®¿é—®å±€éƒ¨å˜é‡çš„æ—¶å€™ï¼Œä¸ºä»€ä¹ˆå˜é‡å¿…é¡»è¦åŠ ä¸Šfinalï¼Ÿ\"></a>å±€éƒ¨å†…éƒ¨ç±»å’ŒåŒ¿åå†…éƒ¨ç±»è®¿é—®å±€éƒ¨å˜é‡çš„æ—¶å€™ï¼Œä¸ºä»€ä¹ˆå˜é‡å¿…é¡»è¦åŠ ä¸Šfinalï¼Ÿ</h4><p>å±€éƒ¨å†…éƒ¨ç±»å’ŒåŒ¿åå†…éƒ¨ç±»è®¿é—®å±€éƒ¨å˜é‡çš„æ—¶å€™ï¼Œä¸ºä»€ä¹ˆå˜é‡å¿…é¡»è¦åŠ ä¸Š final å‘¢ï¼Ÿå®ƒå†…éƒ¨åŸç†æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p>\n<p>å…ˆçœ‹è¿™æ®µä»£ç ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Outer</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">outMethod</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">a</span> <span class=\"operator\">=</span><span class=\"number\">10</span>;</span><br><span class=\"line\">        <span class=\"keyword\">class</span> <span class=\"title class_\">Inner</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">void</span> <span class=\"title function_\">innerMethod</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">                System.out.println(a);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>ä»¥ä¸Šä¾‹å­ï¼Œä¸ºä»€ä¹ˆè¦åŠ  final å‘¢ï¼Ÿæ˜¯å› ä¸º<strong>ç”Ÿå‘½å‘¨æœŸä¸ä¸€è‡´</strong></p>\n<p>å±€éƒ¨å˜é‡å­˜å‚¨åœ¨æ ˆä¸­ï¼Œå½“æ–¹æ³•æ‰§è¡Œç»“æŸåï¼Œå¦‚æœä¸ç”¨ final ä¿®é¥°é‚£ä¹ˆè¯¥å±€éƒ¨å˜é‡å°±è¢«é”€æ¯ã€‚è€Œå±€éƒ¨å†…éƒ¨ç±»å¯¹å±€éƒ¨å˜é‡çš„å¼•ç”¨ä¾ç„¶å­˜åœ¨ï¼Œå¦‚æœå±€éƒ¨å†…éƒ¨ç±»è¦è°ƒç”¨å±€éƒ¨å˜é‡æ—¶ï¼Œå°±ä¼šå‡ºé”™ã€‚<br>åŠ äº† finalï¼Œå¯ä»¥ç¡®ä¿å±€éƒ¨å†…éƒ¨ç±»ä½¿ç”¨çš„å˜é‡ä¸å¤–å±‚çš„å±€éƒ¨å˜é‡åŒºåˆ†å¼€ï¼Œè§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚</p>\n<h3 id=\"é‡å†™ä¸é‡è½½\"><a href=\"#é‡å†™ä¸é‡è½½\" class=\"headerlink\" title=\"é‡å†™ä¸é‡è½½\"></a>é‡å†™ä¸é‡è½½</h3><h4 id=\"æ„é€ å™¨ï¼ˆconstructorï¼‰æ˜¯å¦å¯è¢«é‡å†™ï¼ˆoverrideï¼‰\"><a href=\"#æ„é€ å™¨ï¼ˆconstructorï¼‰æ˜¯å¦å¯è¢«é‡å†™ï¼ˆoverrideï¼‰\" class=\"headerlink\" title=\"æ„é€ å™¨ï¼ˆconstructorï¼‰æ˜¯å¦å¯è¢«é‡å†™ï¼ˆoverrideï¼‰\"></a>æ„é€ å™¨ï¼ˆconstructorï¼‰æ˜¯å¦å¯è¢«é‡å†™ï¼ˆoverrideï¼‰</h4><p>æ„é€ å™¨ä¸èƒ½è¢«ç»§æ‰¿ï¼Œå› æ­¤ä¸èƒ½è¢«é‡å†™ï¼Œä½†å¯ä»¥è¢«é‡è½½ã€‚</p>\n<h4 id=\"é‡è½½ï¼ˆOverloadï¼‰å’Œé‡å†™ï¼ˆOverrideï¼‰çš„åŒºåˆ«ã€‚é‡è½½çš„æ–¹æ³•èƒ½å¦æ ¹æ®è¿”å›ç±»å‹è¿›è¡ŒåŒºåˆ†ï¼Ÿ\"><a href=\"#é‡è½½ï¼ˆOverloadï¼‰å’Œé‡å†™ï¼ˆOverrideï¼‰çš„åŒºåˆ«ã€‚é‡è½½çš„æ–¹æ³•èƒ½å¦æ ¹æ®è¿”å›ç±»å‹è¿›è¡ŒåŒºåˆ†ï¼Ÿ\" class=\"headerlink\" title=\"é‡è½½ï¼ˆOverloadï¼‰å’Œé‡å†™ï¼ˆOverrideï¼‰çš„åŒºåˆ«ã€‚é‡è½½çš„æ–¹æ³•èƒ½å¦æ ¹æ®è¿”å›ç±»å‹è¿›è¡ŒåŒºåˆ†ï¼Ÿ\"></a>é‡è½½ï¼ˆOverloadï¼‰å’Œé‡å†™ï¼ˆOverrideï¼‰çš„åŒºåˆ«ã€‚é‡è½½çš„æ–¹æ³•èƒ½å¦æ ¹æ®è¿”å›ç±»å‹è¿›è¡ŒåŒºåˆ†ï¼Ÿ</h4><p>æ–¹æ³•çš„é‡è½½å’Œé‡å†™éƒ½æ˜¯å®ç°å¤šæ€çš„æ–¹å¼ï¼ŒåŒºåˆ«åœ¨äºé‡è½½å®ç°çš„æ˜¯<strong>ç¼–è¯‘æ—¶çš„å¤šæ€æ€§</strong>ï¼Œè€Œé‡å†™å®ç°çš„æ˜¯<strong>è¿è¡Œæ—¶çš„å¤šæ€æ€§</strong>ã€‚</p>\n<p>é‡è½½ï¼šå‘ç”Ÿåœ¨<strong>åŒä¸€ä¸ªç±»</strong>ä¸­ï¼Œ<strong>æ–¹æ³•åç›¸åŒ å‚æ•°åˆ—è¡¨ä¸åŒ</strong>ï¼ˆå‚æ•°ç±»å‹ä¸åŒã€ä¸ªæ•°ä¸åŒã€é¡ºåºä¸åŒï¼‰ï¼Œä¸æ–¹æ³•è¿”å›å€¼å’Œè®¿é—®ä¿®é¥°ç¬¦æ— å…³</p>\n<p>é‡å†™ï¼šå‘ç”Ÿåœ¨<strong>çˆ¶å­ç±»</strong>ä¸­ï¼Œæ–¹æ³•åã€å‚æ•°åˆ—è¡¨å¿…é¡»ç›¸åŒï¼Œè¿”å›å€¼ç±»å‹å°äºç­‰äºçˆ¶ç±»ï¼ŒæŠ›å‡ºçš„å¼‚å¸¸å°äºç­‰äºçˆ¶ç±»ï¼Œ<strong>è®¿é—®ä¿®é¥°ç¬¦å¤§äºç­‰äºçˆ¶ç±»</strong>ï¼ˆé‡Œæ°ä»£æ¢åŸåˆ™ï¼‰</p>\n<h3 id=\"å¯¹è±¡ç›¸ç­‰åˆ¤æ–­\"><a href=\"#å¯¹è±¡ç›¸ç­‰åˆ¤æ–­\" class=\"headerlink\" title=\"å¯¹è±¡ç›¸ç­‰åˆ¤æ–­\"></a>å¯¹è±¡ç›¸ç­‰åˆ¤æ–­</h3><h4 id=\"x3D-x3D-å’Œ-equals-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ\"><a href=\"#x3D-x3D-å’Œ-equals-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ\" class=\"headerlink\" title=\"&#x3D;&#x3D; å’Œ equals çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ\"></a>&#x3D;&#x3D; å’Œ equals çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ</h4><p><strong>&#x3D;&#x3D;</strong> : å®ƒçš„ä½œç”¨æ˜¯åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡çš„åœ°å€æ˜¯ä¸æ˜¯ç›¸ç­‰ã€‚å³ï¼Œåˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯ä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚<br>(åŸºæœ¬æ•°æ®ç±»å‹ &#x3D;&#x3D; æ¯”è¾ƒçš„æ˜¯å€¼ï¼Œå¼•ç”¨æ•°æ®ç±»å‹ &#x3D;&#x3D; æ¯”è¾ƒçš„æ˜¯å†…å­˜åœ°å€)</p>\n<p><strong>equals()</strong> : å®ƒçš„ä½œç”¨ä¹Ÿæ˜¯åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰ã€‚ä½†å®ƒä¸€èˆ¬æœ‰ä¸¤ç§ä½¿ç”¨æƒ…å†µï¼š</p>\n<p>æƒ…å†µ 1ï¼šç±»æ²¡æœ‰é‡å†™ equals() æ–¹æ³•ã€‚åˆ™é€šè¿‡ equals() æ¯”è¾ƒè¯¥ç±»çš„ä¸¤ä¸ªå¯¹è±¡æ—¶ï¼Œç­‰ä»·äºé€šè¿‡â€œ&#x3D;&#x3D;â€æ¯”è¾ƒè¿™ä¸¤ä¸ªå¯¹è±¡ã€‚</p>\n<p>æƒ…å†µ 2ï¼šç±»é‡å†™äº† equals() æ–¹æ³•ã€‚ä¸€èˆ¬ï¼Œæˆ‘ä»¬éƒ½é‡å†™ equals() æ–¹æ³•æ¥ä¸¤ä¸ªå¯¹è±¡çš„å†…å®¹ç›¸ç­‰ï¼›è‹¥å®ƒä»¬çš„å†…å®¹ç›¸ç­‰ï¼Œåˆ™è¿”å› true (å³ï¼Œè®¤ä¸ºè¿™ä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰)ã€‚</p>\n<h4 id=\"hashCode-ä¸-equals\"><a href=\"#hashCode-ä¸-equals\" class=\"headerlink\" title=\"hashCode ä¸ equals\"></a>hashCode ä¸ equals</h4><p><strong>hashCode()ä»‹ç»</strong></p>\n<p>hashCode() çš„ä½œç”¨æ˜¯è·å–å“ˆå¸Œç ï¼ˆæœ¬åœ°æ–¹æ³•ï¼‰ï¼Œä¹Ÿç§°ä¸ºæ•£åˆ—ç ï¼›å®ƒå®é™…ä¸Šæ˜¯è¿”å›ä¸€ä¸ª int æ•´æ•°ã€‚hashCode() å®šä¹‰åœ¨ JDK çš„ Object ç±»ä¸­ï¼Œè¿™å°±æ„å‘³ç€ Java ä¸­çš„ä»»ä½•ç±»éƒ½æœ‰ hashCode()æ–¹æ³•ã€‚</p>\n<p><strong>ä¸ºä»€ä¹ˆè¦æœ‰ hashCode</strong></p>\n<p><strong>æˆ‘ä»¬ä»¥â€œhashSet å¦‚ä½•æ£€æŸ¥é‡å¤â€ä¸ºä¾‹å­æ¥è¯´æ˜ä¸ºä»€ä¹ˆè¦æœ‰ hashCode</strong>ï¼š</p>\n<p>å½“ä½ æŠŠå¯¹è±¡åŠ å…¥ hashSet æ—¶ï¼ŒhashSet ä¼šå…ˆè®¡ç®—å¯¹è±¡çš„ hashcode å€¼æ¥åˆ¤æ–­å¯¹è±¡åŠ å…¥çš„ä½ç½®ï¼Œå¦‚æœæ²¡æœ‰ç›¸ç¬¦çš„ hashcodeï¼ŒhashSet ä¼šå‡è®¾å¯¹è±¡æ²¡æœ‰é‡å¤å‡ºç°ã€‚ä½†æ˜¯å¦‚æœå‘ç°æœ‰ç›¸åŒ hashcode å€¼çš„å¯¹è±¡ï¼Œè¿™æ—¶ä¼šè°ƒç”¨ equals()æ–¹æ³•æ¥æ£€æŸ¥ hashcode ç›¸ç­‰çš„å¯¹è±¡æ˜¯å¦çœŸçš„ç›¸åŒã€‚å¦‚æœä¸¤è€…ç›¸åŒï¼Œè¡¨æ˜å·²ç»æœ‰äº†ç›¸åŒçš„å¯¹è±¡äº†ï¼ŒhashSet å°±ä¸ä¼šè®©å…¶åŠ å…¥æ“ä½œæˆåŠŸã€‚å¦‚æœä¸åŒçš„è¯ï¼Œå°±ä¼šé‡æ–°æ•£åˆ—åˆ°å…¶ä»–ä½ç½®ã€‚</p>\n<p><strong>hashCode()ä¸equals()çš„ç›¸å…³è§„å®š</strong></p>\n<ul>\n<li>å¦‚æœä¸¤ä¸ªå¯¹è±¡çš„ hashCode å€¼ç›¸ç­‰ï¼Œé‚£è¿™ä¸¤ä¸ªå¯¹è±¡ä¸ä¸€å®šç›¸ç­‰ï¼ˆå“ˆå¸Œç¢°æ’ï¼‰ã€‚</li>\n<li>å¦‚æœä¸¤ä¸ªå¯¹è±¡çš„ hashCode å€¼ç›¸ç­‰å¹¶ä¸” equals()æ–¹æ³•ä¹Ÿè¿”å› trueï¼Œæˆ‘ä»¬æ‰è®¤ä¸ºè¿™ä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰ã€‚</li>\n<li>å¦‚æœä¸¤ä¸ªå¯¹è±¡çš„ hashCode å€¼ä¸ç›¸ç­‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥è®¤ä¸ºè¿™ä¸¤ä¸ªå¯¹è±¡ä¸ç›¸ç­‰ã€‚</li>\n</ul>\n<h4 id=\"åªé‡å†™-hashCode-å¯ä»¥å—ï¼Ÿ\"><a href=\"#åªé‡å†™-hashCode-å¯ä»¥å—ï¼Ÿ\" class=\"headerlink\" title=\"åªé‡å†™ hashCode å¯ä»¥å—ï¼Ÿ\"></a>åªé‡å†™ hashCode å¯ä»¥å—ï¼Ÿ</h4><p>å¦‚æœåªé‡å†™ hashCodeï¼Œä¸é‡å†™ equalsï¼Œé‚£ä¹ˆå¦‚æœä¸¤ä¸ªå¯¹è±¡åˆ¤æ–­ hashCode ç›¸åŒäº†ï¼Œä»¥ä¸ºè¿™ä¿©å¯¹è±¡ç›¸åŒï¼Œé‚£ä¹ˆåªä¼šæ’å…¥ä¸€æ¬¡åˆ° set é‡Œé¢ï¼Œè€Œå®é™…ä¸Šè¿™ä¸¤ä¸ªä¸ä¸€æ ·ä¸€ä¸ªæ˜¯ A ä¸€ä¸ªæ˜¯ Bï¼Œéƒ½éœ€è¦æ’å…¥ã€‚</p>\n<blockquote>\n<p>ä¸¤ä¸ªå¯¹è±¡çš„ hashCode ç›¸åŒï¼Œä½†æ˜¯å†…å®¹å¯èƒ½ä¸åŒï¼Œåœ¨ set ä¸­æ˜æ˜åº”è¯¥æ˜¯ä¸¤ä¸ªä¸åŒçš„å¯¹è±¡ï¼Œè¿™æ—¶å€™åªé€šè¿‡ hashCode åˆ¤æ–­ä»–ä¿©ç›¸åŒä¼šå¯¼è‡´åªæ’å…¥ä¸€ä¸ªå…ƒç´ ã€‚</p>\n</blockquote>\n<h4 id=\"åªé‡å†™-equalså¯ä»¥å—ï¼Ÿ\"><a href=\"#åªé‡å†™-equalså¯ä»¥å—ï¼Ÿ\" class=\"headerlink\" title=\"åªé‡å†™ equalså¯ä»¥å—ï¼Ÿ\"></a>åªé‡å†™ equalså¯ä»¥å—ï¼Ÿ</h4><p>å¦‚æœåœ¨é‡å†™ equals æ—¶ï¼Œä¸é‡å†™ hashCodeï¼Œå°±ä¼šå¼•èµ·æ¯”å¦‚è¯´å°†ä¸¤ä¸ªç›¸ç­‰çš„è‡ªå®šä¹‰å¯¹è±¡å­˜å‚¨åœ¨ Set é›†åˆæ—¶ï¼Œä¼šå°†è¿™ä¸¤ä¸ªå¯¹è±¡éƒ½è¿›è¡Œæ’å…¥ã€‚ï¼ˆæ— æ³•å»é‡ï¼‰</p>\n<blockquote>\n<p>å¦‚æœå®šä¹‰ä¸€ä¸ª set é‡Œé¢å­˜æ”¾ Person å¯¹è±¡ï¼ŒPerson åªé‡å†™äº† equals æ–¹æ³•å³å¯ä»¥åˆ¤æ–­å¯¹è±¡å†…å®¹æ˜¯å¦ç›¸åŒã€‚</p>\n<p>å¦‚æœåªé‡å†™äº† equals æ–¹æ³•ï¼Œé‚£ä¹ˆé»˜è®¤æƒ…å†µä¸‹ï¼ŒSet è¿›è¡Œå»é‡æ“ä½œæ—¶ï¼Œä¼šå…ˆåˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡çš„ hashCode æ˜¯å¦ç›¸åŒï¼Œæ­¤æ—¶å› ä¸ºæ²¡æœ‰é‡å†™ hashCode æ–¹æ³•ï¼Œæ‰€ä»¥ä¼šç›´æ¥æ‰§è¡Œ Object ä¸­çš„ hashCode æ–¹æ³•ï¼Œè€Œ Object ä¸­çš„ hashCode æ–¹æ³•å¯¹æ¯”çš„æ˜¯ä¸¤ä¸ªä¸åŒå¼•ç”¨åœ°å€çš„å¯¹è±¡ï¼Œæ‰€ä»¥ç»“æœæ˜¯ falseï¼Œé‚£ä¹ˆ equals æ–¹æ³•å°±ä¸ç”¨æ‰§è¡Œäº†ï¼Œç›´æ¥è¿”å›çš„ç»“æœå°±æ˜¯ falseï¼šä¸¤ä¸ªå¯¹è±¡ä¸æ˜¯ç›¸ç­‰çš„ï¼Œäºæ˜¯å°±åœ¨ Set é›†åˆä¸­æ’å…¥äº†ä¸¤ä¸ªç›¸åŒçš„å¯¹è±¡ã€‚</p>\n<p>ä½†æ˜¯ï¼Œå¦‚æœåœ¨é‡å†™ equals æ–¹æ³•æ—¶ï¼Œä¹Ÿé‡å†™äº† hashCode æ–¹æ³•ï¼Œé‚£ä¹ˆåœ¨æ‰§è¡Œåˆ¤æ–­æ—¶ä¼šå»æ‰§è¡Œé‡å†™çš„ hashCode æ–¹æ³•ï¼Œæ­¤æ—¶å¯¹æ¯”çš„æ˜¯ä¸¤ä¸ªå¯¹è±¡çš„æ‰€æœ‰å±æ€§çš„ hashCode æ˜¯å¦ç›¸åŒï¼Œäºæ˜¯è°ƒç”¨ hashCode è¿”å›çš„ç»“æœå°±æ˜¯ trueï¼Œå†å»è°ƒç”¨ equals æ–¹æ³•ï¼Œå‘ç°ä¸¤ä¸ªå¯¹è±¡ç¡®å®æ˜¯ç›¸ç­‰çš„ï¼Œäºæ˜¯å°±è¿”å› true äº†ï¼Œå› æ­¤ Set é›†åˆå°±ä¸ä¼šå­˜å‚¨ä¸¤ä¸ªä¸€æ¨¡ä¸€æ ·çš„æ•°æ®äº†ï¼Œäºæ˜¯æ•´ä¸ªç¨‹åºçš„æ‰§è¡Œå°±æ­£å¸¸äº†ã€‚</p>\n</blockquote>\n<h3 id=\"å€¼ä¼ é€’\"><a href=\"#å€¼ä¼ é€’\" class=\"headerlink\" title=\"å€¼ä¼ é€’\"></a>å€¼ä¼ é€’</h3><h4 id=\"ä¸ºä»€ä¹ˆ-Java-ä¸­åªæœ‰å€¼ä¼ é€’\"><a href=\"#ä¸ºä»€ä¹ˆ-Java-ä¸­åªæœ‰å€¼ä¼ é€’\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆ Java ä¸­åªæœ‰å€¼ä¼ é€’\"></a>ä¸ºä»€ä¹ˆ Java ä¸­åªæœ‰å€¼ä¼ é€’</h4><p>Java é‡‡ç”¨æŒ‰å€¼è°ƒç”¨ï¼Œæ–¹æ³•å¾—åˆ°çš„æ˜¯æ‰€æœ‰å‚æ•°å€¼çš„ä¸€ä¸ªæ‹·è´ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ–¹æ³•ä¸èƒ½ä¿®æ”¹ä¼ é€’ç»™å®ƒçš„ä»»ä½•å‚æ•°å˜é‡çš„å†…å®¹ã€‚</p>\n<p>example 1</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">num1</span> <span class=\"operator\">=</span> <span class=\"number\">10</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">num2</span> <span class=\"operator\">=</span> <span class=\"number\">20</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    swap(num1, num2);</span><br><span class=\"line\"></span><br><span class=\"line\">    System.out.println(<span class=\"string\">&quot;num1 = &quot;</span> + num1);</span><br><span class=\"line\">    System.out.println(<span class=\"string\">&quot;num2 = &quot;</span> + num2);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">swap</span><span class=\"params\">(<span class=\"type\">int</span> a, <span class=\"type\">int</span> b)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">temp</span> <span class=\"operator\">=</span> a;</span><br><span class=\"line\">    a = b;</span><br><span class=\"line\">    b = temp;</span><br><span class=\"line\"></span><br><span class=\"line\">    System.out.println(<span class=\"string\">&quot;a = &quot;</span> + a);</span><br><span class=\"line\">    System.out.println(<span class=\"string\">&quot;b = &quot;</span> + b);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>ç»“æœ</strong>ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a = <span class=\"number\">20</span></span><br><span class=\"line\">b = <span class=\"number\">10</span></span><br><span class=\"line\">num1 = <span class=\"number\">10</span></span><br><span class=\"line\">num2 = <span class=\"number\">20</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>è§£æ</strong>ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNDAyMzk3Mi00ZWQyZjQ0NTlmN2MyYzkwLmpwZw.png\" alt=\"swap(int a, int b)\"></p>\n<p>åœ¨ swap æ–¹æ³•ä¸­ï¼Œaã€b çš„å€¼è¿›è¡Œäº¤æ¢ï¼Œå¹¶ä¸ä¼šå½±å“åˆ° num1ã€num2ã€‚å› ä¸º aã€b ä¸­çš„å€¼ï¼Œåªæ˜¯ä» num1ã€num2 çš„å¤åˆ¶è¿‡æ¥çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œaã€b ç›¸å½“äº num1ã€num2 çš„å‰¯æœ¬ï¼Œå‰¯æœ¬çš„å†…å®¹æ— è®ºæ€ä¹ˆä¿®æ”¹ï¼Œéƒ½ä¸ä¼šå½±å“åˆ°åŸä»¶æœ¬èº«ã€‚</p>\n<p><strong>é€šè¿‡ä¸Šé¢ä¾‹å­ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“äº†ä¸€ä¸ªæ–¹æ³•ä¸èƒ½ä¿®æ”¹ä¸€ä¸ªåŸºæœ¬æ•°æ®ç±»å‹çš„å‚æ•°ï¼Œè€Œå¯¹è±¡å¼•ç”¨ä½œä¸ºå‚æ•°å°±ä¸ä¸€æ ·ï¼Œè¯·çœ‹ example2.</strong></p>\n<p>example 2</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span>[] arr = &#123; <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span> &#125;;</span><br><span class=\"line\">    System.out.println(arr[<span class=\"number\">0</span>]);</span><br><span class=\"line\">    change(arr);</span><br><span class=\"line\">    System.out.println(arr[<span class=\"number\">0</span>]);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">change</span><span class=\"params\">(<span class=\"type\">int</span>[] array)</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// å°†æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ å˜ä¸º0</span></span><br><span class=\"line\">    array[<span class=\"number\">0</span>] = <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>ç»“æœ</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1</span><br><span class=\"line\">0</span><br></pre></td></tr></table></figure>\n\n<p><strong>è§£æ</strong>ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNDAyMzk3Mi1kYWI5Mzg5ZWRmMjIxNmIzLmpwZw.png\" alt=\"change(int[] array)\"></p>\n<p>array è¢«åˆå§‹åŒ– arr çš„æ‹·è´ä¹Ÿå°±æ˜¯ä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ array å’Œ arr æŒ‡å‘çš„æ—¶åŒä¸€ä¸ªæ•°ç»„å¯¹è±¡ã€‚ å› æ­¤ï¼Œå¤–éƒ¨å¯¹å¼•ç”¨å¯¹è±¡çš„æ”¹å˜ä¼šåæ˜ åˆ°æ‰€å¯¹åº”çš„å¯¹è±¡ä¸Šã€‚</p>\n<p><strong>é€šè¿‡ example2 æˆ‘ä»¬å·²ç»çœ‹åˆ°ï¼Œå®ç°ä¸€ä¸ªæ”¹å˜å¯¹è±¡å‚æ•°çŠ¶æ€çš„æ–¹æ³•å¹¶ä¸æ˜¯ä¸€ä»¶éš¾äº‹ã€‚ç†ç”±å¾ˆç®€å•ï¼Œæ–¹æ³•å¾—åˆ°çš„æ˜¯å¯¹è±¡å¼•ç”¨çš„æ‹·è´ï¼Œå¯¹è±¡å¼•ç”¨åŠå…¶ä»–çš„æ‹·è´åŒæ—¶å¼•ç”¨åŒä¸€ä¸ªå¯¹è±¡ã€‚</strong></p>\n<p>example 3</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Test</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Student</span> <span class=\"variable\">s1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Student</span>(<span class=\"string\">&quot;å°å¼ &quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">Student</span> <span class=\"variable\">s2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Student</span>(<span class=\"string\">&quot;å°æ&quot;</span>);</span><br><span class=\"line\">        Test.swap(s1, s2);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;s1:&quot;</span> + s1.getName());</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;s2:&quot;</span> + s2.getName());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">swap</span><span class=\"params\">(Student x, Student y)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Student</span> <span class=\"variable\">temp</span> <span class=\"operator\">=</span> x;</span><br><span class=\"line\">        x = y;</span><br><span class=\"line\">        y = temp;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;x:&quot;</span> + x.getName());</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;y:&quot;</span> + y.getName());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>ç»“æœ</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">x:å°æ</span><br><span class=\"line\">y:å°å¼ </span><br><span class=\"line\">s1:å°å¼ </span><br><span class=\"line\">s2:å°æ</span><br></pre></td></tr></table></figure>\n\n<p><strong>è§£æ</strong>ï¼š</p>\n<p>äº¤æ¢ä¹‹å‰ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNDAyMzk3Mi03MmIwYzFmYjlmM2IwNzc2LmpwZw.png\" alt=\"before swap(Student x, Student y)\"></p>\n<p>äº¤æ¢ä¹‹åï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNDAyMzk3Mi0zYWUzNzY4NGNiMzg2Njc4LmpwZw.png\" alt=\"after swap(Student x, Student y)\"></p>\n<p>é€šè¿‡ä¸Šé¢ä¸¤å¼ å›¾å¯ä»¥å¾ˆæ¸…æ™°çš„çœ‹å‡ºï¼š <strong>æ–¹æ³•å¹¶æ²¡æœ‰æ”¹å˜å­˜å‚¨åœ¨å˜é‡ s1 å’Œ s2 ä¸­çš„å¯¹è±¡å¼•ç”¨ã€‚swapæ–¹æ³•çš„å‚æ•°xå’Œyè¢«åˆå§‹åŒ–ä¸ºä¸¤ä¸ªå¯¹è±¡å¼•ç”¨çš„æ‹·è´ï¼Œè¿™ä¸ªæ–¹æ³•äº¤æ¢çš„æ˜¯è¿™ä¸¤ä¸ªæ‹·è´</strong></p>\n<h4 id=\"å€¼ä¼ é€’å’Œå¼•ç”¨ä¼ é€’æœ‰ä»€ä¹ˆåŒºåˆ«\"><a href=\"#å€¼ä¼ é€’å’Œå¼•ç”¨ä¼ é€’æœ‰ä»€ä¹ˆåŒºåˆ«\" class=\"headerlink\" title=\"å€¼ä¼ é€’å’Œå¼•ç”¨ä¼ é€’æœ‰ä»€ä¹ˆåŒºåˆ«\"></a>å€¼ä¼ é€’å’Œå¼•ç”¨ä¼ é€’æœ‰ä»€ä¹ˆåŒºåˆ«</h4><p>å€¼ä¼ é€’ï¼šæŒ‡çš„æ˜¯åœ¨æ–¹æ³•è°ƒç”¨æ—¶ï¼Œä¼ é€’çš„å‚æ•°æ˜¯æŒ‰å€¼çš„æ‹·è´ä¼ é€’ï¼Œä¼ é€’çš„æ˜¯å€¼çš„æ‹·è´ï¼Œä¹Ÿå°±æ˜¯è¯´ä¼ é€’åå°±äº’ä¸ç›¸å…³äº†ã€‚</p>\n<p>å¼•ç”¨ä¼ é€’ï¼šæŒ‡çš„æ˜¯åœ¨æ–¹æ³•è°ƒç”¨æ—¶ï¼Œä¼ é€’çš„å‚æ•°æ˜¯æŒ‰å¼•ç”¨è¿›è¡Œä¼ é€’ï¼Œå…¶å®ä¼ é€’çš„å¼•ç”¨çš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯å˜é‡æ‰€å¯¹åº”çš„å†…å­˜ç©ºé—´çš„åœ°å€ã€‚ä¼ é€’çš„æ˜¯å€¼çš„å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ä¼ é€’å‰å’Œä¼ é€’åéƒ½æŒ‡å‘åŒä¸€ä¸ªå¼•ç”¨ï¼ˆä¹Ÿå°±æ˜¯åŒä¸€ä¸ªå†…å­˜ç©ºé—´ï¼‰ã€‚</p>\n<h2 id=\"IOæµ\"><a href=\"#IOæµ\" class=\"headerlink\" title=\"IOæµ\"></a>IOæµ</h2><blockquote>\n<p>å‚è€ƒï¼š<a href=\"https://blog.csdn.net/weixin_44579258/article/details/90758359\">https://blog.csdn.net/weixin_44579258/article/details/90758359</a></p>\n</blockquote>\n<p>é˜»å¡å’Œéé˜»å¡æ˜¯æŒ‡è¿›ç¨‹è®¿é—®çš„æ•°æ®å¦‚æœå°šæœªå‡†å¤‡å°±ç»ªï¼Œè¿›ç¨‹æ˜¯å¦éœ€è¦ç­‰å¾…<br>åŒæ­¥å’Œå¼‚æ­¥æ˜¯æŒ‡è®¿é—®æ•°æ®çš„æœºåˆ¶ï¼ŒåŒæ­¥ä¸€èˆ¬ä¸»åŠ¨è¯·æ±‚ç­‰å¾… IO æ“ä½œå®Œæ¯•çš„æ–¹å¼ã€‚å½“æ•°æ®å°±ç»ªåï¼Œå†è¯»å†™çš„æ—¶å€™å¿…é¡»é˜»å¡ï¼Œå¼‚æ­¥åˆ™ä¸»åŠ¨è¯·æ±‚æ•°æ®åä¾¿å¯ä»¥ç»§ç»­å¤„ç†å…¶ä»–ä»»åŠ¡ï¼Œéšåç­‰å¾… IO å®Œæ¯•é€šçŸ¥ï¼Œè¿™å¯ä»¥ä½¿è¿›ç¨‹åœ¨æ•°æ®è¯»å†™æ—¶ä¹Ÿä¸é˜»å¡</p>\n<p>å‡†å¤‡æ•°æ®ï¼šç½‘å¡ â†’ å†…æ ¸<br>æ•°æ®å°±ç»ªï¼šæ•°æ®æ‹·è´åˆ°äº†å†…æ ¸<br>æ‹·è´æ•°æ®ï¼šå°†å†…æ ¸æ•°æ®æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´</p>\n<h3 id=\"Blocking-I-x2F-O\"><a href=\"#Blocking-I-x2F-O\" class=\"headerlink\" title=\"Blocking I&#x2F;O\"></a>Blocking I&#x2F;O</h3><p><strong>BIO å±äºåŒæ­¥é˜»å¡ IO æ¨¡å‹</strong> ã€‚</p>\n<p>åŒæ­¥é˜»å¡ IO æ¨¡å‹ä¸­ï¼Œåº”ç”¨ç¨‹åº<strong>å‘èµ· read è°ƒç”¨</strong>åï¼Œä¼šä¸€ç›´é˜»å¡ï¼Œç›´åˆ°å†…æ ¸å‡†å¤‡æ•°æ®ã€æ•°æ®å°±ç»ªï¼Œæ•°æ®ä»å†…æ ¸æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes20190603201109632.png\" alt=\"BIO\"></p>\n<h3 id=\"NIO-Non-blocking-I-x2F-O\"><a href=\"#NIO-Non-blocking-I-x2F-O\" class=\"headerlink\" title=\"NIO (Non-blocking I&#x2F;O)\"></a>NIO (Non-blocking I&#x2F;O)</h3><p>åŒæ­¥éé˜»å¡ IO æ¨¡å‹ä¸­ï¼Œç”¨æˆ·è¿›ç¨‹ä¼š<strong>ä¸€ç›´å‘èµ· read è°ƒç”¨</strong>ï¼ˆå¦‚æœå†…æ ¸è¿”å› error åˆ™è¯´æ˜æ•°æ®æœªå‡†å¤‡å°±ç»ªï¼‰ï¼Œç›´åˆ°æ•°æ®å‡†å¤‡å°±ç»ªï¼Œç”¨æˆ·å‘èµ· read è°ƒç”¨æ—¶ï¼Œæ•°æ®ä»å†…æ ¸ç©ºé—´æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´ï¼ˆç”¨æˆ·è¿›ç¨‹æ˜¯é˜»å¡çš„ï¼‰ã€‚</p>\n<blockquote>\n<p>ç›¸æ¯”äºåŒæ­¥é˜»å¡ IO æ¨¡å‹ï¼ŒåŒæ­¥éé˜»å¡ IO æ¨¡å‹ç¡®å®æœ‰äº†å¾ˆå¤§æ”¹è¿›ã€‚é€šè¿‡è½®è¯¢æ“ä½œï¼Œé¿å…äº†ä¸€ç›´é˜»å¡ã€‚</p>\n</blockquote>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes20190603201218527.png\" alt=\"NIO\"></p>\n<h3 id=\"IOå¤šè·¯å¤ç”¨ï¼ˆNIOï¼‰\"><a href=\"#IOå¤šè·¯å¤ç”¨ï¼ˆNIOï¼‰\" class=\"headerlink\" title=\"IOå¤šè·¯å¤ç”¨ï¼ˆNIOï¼‰\"></a>IOå¤šè·¯å¤ç”¨ï¼ˆNIOï¼‰</h3><p>select&#x2F;epoll çš„å¥½å¤„å°±åœ¨äºå•ä¸ª process å°±å¯ä»¥åŒæ—¶å¤„ç†å¤šä¸ªç½‘ç»œè¿æ¥çš„ IOã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes2019060320125821.png\" alt=\"NIO\"></p>\n<p>IO å¤ç”¨å’ŒåŒæ­¥é˜»å¡æœ¬è´¨ä¸€æ ·ï¼Œåœ¨ NIO ä¸­ï¼Œæ¯æ¬¡ç”¨æˆ·è¿›ç¨‹è¿›è¡Œ read è½®è¯¢æ•°æ®æ˜¯å¦å‡†å¤‡å°±ç»ªï¼Œè€Œåœ¨ IO å¤šè·¯å¤ç”¨ä¸­ï¼Œåˆ©ç”¨äº†æ–°çš„ select ç³»ç»Ÿè°ƒç”¨ï¼Œç”±å†…æ ¸æ¥è´Ÿè´£æœ¬æ¥æ˜¯è¯·æ±‚è¿›ç¨‹è¯¥åšçš„è½®è¯¢æ“ä½œã€‚</p>\n<p>å½“ç”¨æˆ·çº¿ç¨‹è°ƒç”¨ selectï¼Œé‚£ä¹ˆæ•´ä¸ªè¿›ç¨‹ä¼šè¢«é˜»å¡ï¼Œè€ŒåŒæ—¶ï¼Œkernel å†…æ ¸ä¼šâ€œç›‘è§†â€æ‰€æœ‰ select è´Ÿè´£çš„ socketï¼Œå½“ä»»ä½•ä¸€ä¸ª socket ä¸­çš„æ•°æ®å‡†å¤‡å¥½äº†ï¼Œselect å°±ä¼šè¿”å›å¯è¯»æ¡ä»¶è®©ç”¨æˆ·è¿›ç¨‹å‘èµ· read è°ƒç”¨ï¼Œç”¨æˆ·è¿›ç¨‹å‘èµ·è°ƒç”¨ read æ“ä½œï¼Œå°†æ•°æ®ä»å†…æ ¸ç©ºé—´æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´ã€‚</p>\n<h3 id=\"Asynchronous-I-x2F-O\"><a href=\"#Asynchronous-I-x2F-O\" class=\"headerlink\" title=\"Asynchronous I&#x2F;O\"></a>Asynchronous I&#x2F;O</h3><p>å¼‚æ­¥ IO æ˜¯åŸºäºäº‹ä»¶å’Œå›è°ƒæœºåˆ¶å®ç°çš„ï¼Œä¹Ÿå°±æ˜¯åº”ç”¨æ“ä½œä¹‹åä¼šç›´æ¥è¿”å›ï¼Œä¸ä¼šå µå¡åœ¨é‚£é‡Œï¼Œå½“åå°å¤„ç†å®Œæˆï¼Œæ“ä½œç³»ç»Ÿä¼šé€šçŸ¥ç›¸åº”çš„çº¿ç¨‹è¿›è¡Œåç»­çš„æ“ä½œã€‚</p>\n<p>ç”¨æˆ·å‘èµ· read è°ƒç”¨ï¼Œæ­¤æ—¶ç”¨æˆ·è¿›ç¨‹ä¸ä¼šé˜»å¡ã€‚å†…æ ¸å°†æ•°æ®å‡†å¤‡å°±ç»ªå¹¶å°†å…¶ä»å†…æ ¸æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´åï¼Œå†…æ ¸ç»™ç”¨æˆ·è¿›ç¨‹å‘é€ä¸€ä¸ªä¿¡å·ç»™ä¹‹å‰è°ƒç”¨ read çš„è¿›ç¨‹ï¼Œæ•°æ®å·²ç»æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´äº†ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes2019060320135956.png\" alt=\"AIO\"></p>\n<h2 id=\"åå°„\"><a href=\"#åå°„\" class=\"headerlink\" title=\"åå°„\"></a>åå°„</h2><h3 id=\"ä»€ä¹ˆæ˜¯åå°„æœºåˆ¶ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯åå°„æœºåˆ¶ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯åå°„æœºåˆ¶ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯åå°„æœºåˆ¶ï¼Ÿ</h3><p>JAVA åå°„æœºåˆ¶æ˜¯åœ¨è¿è¡ŒçŠ¶æ€ä¸­ï¼Œå¯¹äºä»»æ„ä¸€ä¸ªç±»ï¼Œéƒ½èƒ½å¤ŸçŸ¥é“è¿™ä¸ªç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼›å¯¹äºä»»æ„ä¸€ä¸ªå¯¹è±¡ï¼Œéƒ½èƒ½å¤Ÿè°ƒç”¨å®ƒçš„ä»»æ„ä¸€ä¸ªæ–¹æ³•å’Œå±æ€§ï¼›è¿™ç§åŠ¨æ€è·å–çš„ä¿¡æ¯ä»¥åŠåŠ¨æ€è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•çš„åŠŸèƒ½ç§°ä¸º Java è¯­è¨€çš„åå°„æœºåˆ¶ã€‚</p>\n<h3 id=\"åå°„æœºåˆ¶ä¼˜ç¼ºç‚¹\"><a href=\"#åå°„æœºåˆ¶ä¼˜ç¼ºç‚¹\" class=\"headerlink\" title=\"åå°„æœºåˆ¶ä¼˜ç¼ºç‚¹\"></a>åå°„æœºåˆ¶ä¼˜ç¼ºç‚¹</h3><ul>\n<li><strong>ä¼˜ç‚¹ï¼š</strong> è¿è¡ŒæœŸç±»å‹çš„åˆ¤æ–­ï¼ŒåŠ¨æ€åŠ è½½ç±»ï¼Œæé«˜ä»£ç çµæ´»åº¦ã€‚</li>\n<li><strong>ç¼ºç‚¹ï¼š</strong> æ€§èƒ½ç“¶é¢ˆï¼šåå°„ç›¸å½“äºä¸€ç³»åˆ—è§£é‡Šæ“ä½œï¼Œé€šçŸ¥ JVM è¦åšçš„äº‹æƒ…ï¼Œæ€§èƒ½æ¯”ç›´æ¥çš„ Java ä»£ç è¦æ…¢å¾ˆå¤šã€‚</li>\n</ul>\n<h3 id=\"åå°„æœºåˆ¶çš„åº”ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ\"><a href=\"#åå°„æœºåˆ¶çš„åº”ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ\" class=\"headerlink\" title=\"åå°„æœºåˆ¶çš„åº”ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ\"></a>åå°„æœºåˆ¶çš„åº”ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ</h3><p>â‘ æˆ‘ä»¬åœ¨ä½¿ç”¨ JDBC è¿æ¥æ•°æ®åº“æ—¶ä½¿ç”¨ Class.forName()é€šè¿‡åå°„åŠ è½½æ•°æ®åº“çš„é©±åŠ¨ç¨‹åºï¼›</p>\n<p>â‘¡Spring é€šè¿‡ XML é…ç½®æ¨¡å¼è£…è½½ Bean çš„è¿‡ç¨‹</p>\n<ol>\n<li>åŠ è½½é…ç½®æ–‡ä»¶ï¼Œè§£ææˆ BeanDefinition æ”¾åœ¨ Map é‡Œï¼Œmap ä¸­å­˜æ”¾<code>&lt;BeanNameï¼ŒClasså¯¹è±¡&gt;</code>çš„æ˜ å°„</li>\n<li>è°ƒç”¨ getBean çš„æ—¶å€™ï¼Œä» BeanDefinition æ‰€å±çš„ Map é‡Œï¼Œæ‹¿å‡º Class å¯¹è±¡ä½¿ç”¨åå°„è¿›è¡Œå®ä¾‹åŒ–ï¼ŒåŒæ—¶ï¼Œå¦‚æœæœ‰ä¾èµ–å…³ç³»ï¼Œå°†é€’å½’è°ƒç”¨ getBean æ–¹æ³• â€”â€” å®Œæˆä¾èµ–æ³¨å…¥</li>\n</ol>\n<h3 id=\"Javaè·å–åå°„çš„ä¸‰ç§æ–¹æ³•\"><a href=\"#Javaè·å–åå°„çš„ä¸‰ç§æ–¹æ³•\" class=\"headerlink\" title=\"Javaè·å–åå°„çš„ä¸‰ç§æ–¹æ³•\"></a>Javaè·å–åå°„çš„ä¸‰ç§æ–¹æ³•</h3><p>1.é€šè¿‡ new å¯¹è±¡å®ç°åå°„æœºåˆ¶ 2.é€šè¿‡è·¯å¾„å®ç°åå°„æœºåˆ¶ 3.é€šè¿‡ç±»åå®ç°åå°„æœºåˆ¶</p>\n<h2 id=\"åŒ…è£…ç±»\"><a href=\"#åŒ…è£…ç±»\" class=\"headerlink\" title=\"åŒ…è£…ç±»\"></a>åŒ…è£…ç±»</h2><h4 id=\"è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±\"><a href=\"#è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±\" class=\"headerlink\" title=\"è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±\"></a>è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±</h4><p><strong>è£…ç®±</strong>ï¼šå°†åŸºæœ¬ç±»å‹ç”¨å®ƒä»¬å¯¹åº”çš„å¼•ç”¨ç±»å‹åŒ…è£…èµ·æ¥ï¼›<code>Integer a = 1;</code></p>\n<p><strong>æ‹†ç®±</strong>ï¼šå°†åŒ…è£…ç±»å‹è½¬æ¢ä¸ºåŸºæœ¬æ•°æ®ç±»å‹ï¼›<code>int b = a;</code></p>\n<h4 id=\"int-å’Œ-Integer-æœ‰ä»€ä¹ˆåŒºåˆ«\"><a href=\"#int-å’Œ-Integer-æœ‰ä»€ä¹ˆåŒºåˆ«\" class=\"headerlink\" title=\"int å’Œ Integer æœ‰ä»€ä¹ˆåŒºåˆ«\"></a>int å’Œ Integer æœ‰ä»€ä¹ˆåŒºåˆ«</h4><p>å¼•å…¥åŒ…è£…ç±»æ˜¯ä¸ºäº†èƒ½å¤Ÿå°†è¿™äº›<strong>åŸºæœ¬æ•°æ®ç±»å‹å½“æˆå¯¹è±¡æ“ä½œ</strong></p>\n<p>Java ä¸ºæ¯ä¸ªåŸå§‹ç±»å‹æä¾›äº†åŒ…è£…ç±»å‹ï¼š</p>\n<p>åŸå§‹ç±»å‹: booleanï¼Œcharï¼Œbyteï¼Œshortï¼Œintï¼Œlongï¼Œfloatï¼Œdouble</p>\n<p>åŒ…è£…ç±»å‹ï¼šBooleanï¼ŒCharacterï¼ŒByteï¼ŒShortï¼ŒIntegerï¼ŒLongï¼ŒFloatï¼ŒDouble</p>\n<h4 id=\"Integer-a-x3D-127-ä¸-Integer-b-x3D-127ç›¸ç­‰å—\"><a href=\"#Integer-a-x3D-127-ä¸-Integer-b-x3D-127ç›¸ç­‰å—\" class=\"headerlink\" title=\"Integer a &#x3D; 127 ä¸ Integer b &#x3D; 127ç›¸ç­‰å—\"></a>Integer a &#x3D; 127 ä¸ Integer b &#x3D; 127ç›¸ç­‰å—</h4><blockquote>\n<p>åŒ…è£…ç±»å’ŒåŸºæœ¬æ•°æ®ç±»å‹æ¯”è¾ƒï¼Œä¼šå°†åŒ…è£…ç±»æ‹†ç®±æˆåŸºæœ¬æ•°æ®ç±»å‹ç„¶åæ¯”è¾ƒï¼Œ</p>\n<p>åªæœ‰å½“åŒ…è£…ç±»æ˜¯è‡ªåŠ¨è£…ç®±ï¼Œå¹¶ä¸”æ•°å€¼èŒƒå›´åœ¨ [-128, 127] æ—¶ï¼Œæ‰ä¼šä½¿ç”¨ cache ä¸­çš„å¯¹è±¡ã€‚</p>\n</blockquote>\n<p>å¯¹äºå¯¹è±¡å¼•ç”¨ç±»å‹ï¼š&#x3D;&#x3D;æ¯”è¾ƒçš„æ˜¯å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚<br>å¯¹äºåŸºæœ¬æ•°æ®ç±»å‹ï¼š&#x3D;&#x3D;æ¯”è¾ƒçš„æ˜¯å€¼ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">Integer</span> <span class=\"variable\">a</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Integer</span>(<span class=\"number\">3</span>);</span><br><span class=\"line\">  \t<span class=\"type\">Integer</span> <span class=\"variable\">b</span> <span class=\"operator\">=</span> <span class=\"number\">3</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">c</span> <span class=\"operator\">=</span> <span class=\"number\">3</span>;</span><br><span class=\"line\">    <span class=\"type\">Integer</span> <span class=\"variable\">d</span> <span class=\"operator\">=</span> <span class=\"number\">3</span>;</span><br><span class=\"line\">    System.out.println(a == b); <span class=\"comment\">// falseï¼Œä¸¤ä¸ªå¯¹è±¡æ¯”è¾ƒ</span></span><br><span class=\"line\">    System.out.println(a == c); <span class=\"comment\">// trueï¼Œaè‡ªåŠ¨æ‹†ç®±</span></span><br><span class=\"line\">    System.out.println(b == c); <span class=\"comment\">// trueï¼Œbè‡ªåŠ¨æ‹†ç®±</span></span><br><span class=\"line\">    System.out.println(b == d); <span class=\"comment\">// trueï¼ŒåŒ…è£…ç±»è‡ªåŠ¨è£…ç®±ä¸”æ•°å€¼èŒƒå›´åœ¨cacheèŒƒå›´å†…</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"type\">Integer</span> <span class=\"variable\">a</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Integer</span>(<span class=\"number\">128</span>);</span><br><span class=\"line\">    <span class=\"type\">Integer</span> <span class=\"variable\">b</span> <span class=\"operator\">=</span> <span class=\"number\">128</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">c</span> <span class=\"operator\">=</span> <span class=\"number\">128</span>;</span><br><span class=\"line\">    <span class=\"type\">Integer</span> <span class=\"variable\">d</span> <span class=\"operator\">=</span> <span class=\"number\">128</span>;</span><br><span class=\"line\">    System.out.println(a == b); <span class=\"comment\">// falseï¼Œä¸¤ä¸ªå¯¹è±¡æ¯”è¾ƒ</span></span><br><span class=\"line\">    System.out.println(a == c); <span class=\"comment\">// trueï¼Œaè‡ªåŠ¨æ‹†ç®±</span></span><br><span class=\"line\">    System.out.println(b == c); <span class=\"comment\">// trueï¼Œbè‡ªåŠ¨æ‹†ç®±</span></span><br><span class=\"line\">    System.out.println(b == d); <span class=\"comment\">// falseï¼ŒåŒ…è£…ç±»è‡ªåŠ¨è£…ç®±ä½†æ˜¯æ•°å€¼èŒƒå›´ä¸åœ¨cacheèŒƒå›´å†…</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"length":10743,"excerpt":"<blockquote>\n<p>æ•´ç†çš„JavaåŸºç¡€ç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½","more":"</p>\n</blockquote>\n<h2 id=\"Javaæ¦‚è¿°\"><a href=\"#Javaæ¦‚è¿°\" class=\"headerlink\" title=\"Javaæ¦‚è¿°\"></a>Javaæ¦‚è¿°</h2><h3 id=\"JVMã€JREå’ŒJDKçš„å…³ç³»\"><a href=\"#JVMã€JREå’ŒJDKçš„å…³ç³»\" class=\"headerlink\" title=\"JVMã€JREå’ŒJDKçš„å…³ç³»\"></a>JVMã€JREå’ŒJDKçš„å…³ç³»</h3><p>JVMï¼šJava Virtual Machineï¼ŒJava è™šæ‹Ÿæœºï¼ŒJava ç¨‹åºéœ€è¦è¿è¡Œåœ¨è™šæ‹Ÿæœºä¸Šï¼Œä¸åŒçš„å¹³å°æœ‰è‡ªå·±çš„è™šæ‹Ÿæœºï¼Œå› æ­¤ Java è¯­è¨€å¯ä»¥å®ç°è·¨å¹³å°ã€‚</p>\n<p>JREï¼šJava Runtime Environmentï¼ŒJava è¿è¡Œç¯å¢ƒï¼ŒåŒ…æ‹¬ Java è™šæ‹Ÿæœºå’Œ Java ç¨‹åºæ‰€éœ€çš„æ ¸å¿ƒç±»åº“ç­‰ã€‚</p>\n<p>JDKï¼šJava Development Kitï¼ŒJava å¼€å‘å·¥å…·åŒ…ï¼ŒåŒ…æ‹¬äº† JRE å’Œå¼€å‘å·¥å…·ã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯è·¨å¹³å°æ€§ï¼ŸåŸç†æ˜¯ä»€ä¹ˆ\"><a href=\"#ä»€ä¹ˆæ˜¯è·¨å¹³å°æ€§ï¼ŸåŸç†æ˜¯ä»€ä¹ˆ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯è·¨å¹³å°æ€§ï¼ŸåŸç†æ˜¯ä»€ä¹ˆ\"></a>ä»€ä¹ˆæ˜¯è·¨å¹³å°æ€§ï¼ŸåŸç†æ˜¯ä»€ä¹ˆ</h3><p>æ‰€è°“è·¨å¹³å°æ€§ï¼Œæ˜¯æŒ‡ Java è¯­è¨€ç¼–å†™çš„ç¨‹åºï¼Œä¸€æ¬¡ç¼–è¯‘ï¼Œåˆ°å¤„è¿è¡Œã€‚</p>\n<p>å®ç°åŸç†ï¼šJava ç¨‹åºæ˜¯é€šè¿‡ Java è™šæ‹Ÿæœºåœ¨ç³»ç»Ÿå¹³å°ä¸Šè¿è¡Œçš„ï¼Œåªè¦è¯¥ç³»ç»Ÿå¯ä»¥å®‰è£…ç›¸åº”çš„ Java è™šæ‹Ÿæœºï¼Œè¯¥ç³»ç»Ÿå°±å¯ä»¥è¿è¡Œ Java ç¨‹åºã€‚</p>\n<h3 id=\"Javaè¯­è¨€æœ‰å“ªäº›ç‰¹ç‚¹\"><a href=\"#Javaè¯­è¨€æœ‰å“ªäº›ç‰¹ç‚¹\" class=\"headerlink\" title=\"Javaè¯­è¨€æœ‰å“ªäº›ç‰¹ç‚¹\"></a>Javaè¯­è¨€æœ‰å“ªäº›ç‰¹ç‚¹</h3><p>é¢å‘å¯¹è±¡ï¼ˆå°è£…ï¼Œç»§æ‰¿ï¼Œå¤šæ€ï¼‰</p>\n<p>å¹³å°æ— å…³æ€§ï¼ˆJava è™šæ‹Ÿæœºå®ç°å¹³å°æ— å…³æ€§ï¼‰</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯å­—èŠ‚ç ï¼Ÿé‡‡ç”¨å­—èŠ‚ç çš„æœ€å¤§å¥½å¤„æ˜¯ä»€ä¹ˆ\"><a href=\"#ä»€ä¹ˆæ˜¯å­—èŠ‚ç ï¼Ÿé‡‡ç”¨å­—èŠ‚ç çš„æœ€å¤§å¥½å¤„æ˜¯ä»€ä¹ˆ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯å­—èŠ‚ç ï¼Ÿé‡‡ç”¨å­—èŠ‚ç çš„æœ€å¤§å¥½å¤„æ˜¯ä»€ä¹ˆ\"></a>ä»€ä¹ˆæ˜¯å­—èŠ‚ç ï¼Ÿé‡‡ç”¨å­—èŠ‚ç çš„æœ€å¤§å¥½å¤„æ˜¯ä»€ä¹ˆ</h3><p><strong>å­—èŠ‚ç </strong>ï¼šJava æºä»£ç ç»è¿‡è™šæ‹Ÿæœºç¼–è¯‘å™¨ç¼–è¯‘åäº§ç”Ÿçš„æ–‡ä»¶ï¼ˆå³æ‰©å±•ä¸º.class çš„æ–‡ä»¶ï¼‰ï¼Œå®ƒä¸é¢å‘ä»»ä½•ç‰¹å®šçš„å¤„ç†å™¨ï¼Œåªé¢å‘è™šæ‹Ÿæœºã€‚ï¼ˆjavac HelloWorld.Java â†’ HelloWorld.class â†’ Java HelloWorld æ‰§è¡Œç¨‹åºï¼‰</p>\n<p><strong>ç¼–è¯‘ä¸è§£é‡Šå¹¶å­˜</strong></p>\n<p>Java æºä»£ç (.Java æ–‡ä»¶)â€”-&gt;ç¼–è¯‘å™¨â€”-&gt;jvm å¯æ‰§è¡Œçš„ Java å­—èŠ‚ç (.class æ–‡ä»¶)â€”-&gt;jvmâ€”-&gt;jvm ä¸­è§£é‡Šå™¨â€”â€“&gt;æœºå™¨å¯æ‰§è¡Œçš„äºŒè¿›åˆ¶æœºå™¨ç â€”-&gt;ç¨‹åºè¿è¡Œ</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯Javaç¨‹åºçš„ä¸»ç±»ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯Javaç¨‹åºçš„ä¸»ç±»ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯Javaç¨‹åºçš„ä¸»ç±»ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯Javaç¨‹åºçš„ä¸»ç±»ï¼Ÿ</h3><p>ä¸€ä¸ªç¨‹åºä¸­å¯ä»¥æœ‰å¤šä¸ªç±»ï¼Œä½†åªèƒ½æœ‰ä¸€ä¸ªç±»æ˜¯ä¸»ç±»ã€‚åœ¨ Java åº”ç”¨ç¨‹åºä¸­ï¼Œè¿™ä¸ªä¸»ç±»æ˜¯æŒ‡åŒ…å« main()æ–¹æ³•çš„ç±»ã€‚<br>ä¸»ç±»æ˜¯ Java ç¨‹åºæ‰§è¡Œçš„å…¥å£ã€‚ï¼ˆmain æ–¹æ³•é™¤äº†æ˜¯ä¸ªä¸»æ–¹æ³•ä»¥å¤–ï¼Œå’Œæ™®é€šçš„é™æ€æ–¹æ³•æ²¡æœ‰åŒºåˆ«ï¼Œéƒ½å¯ä»¥é‡è½½ã€è°ƒç”¨ã€ç»§æ‰¿ï¼‰</p>\n<h3 id=\"Javaå’ŒC-çš„åŒºåˆ«\"><a href=\"#Javaå’ŒC-çš„åŒºåˆ«\" class=\"headerlink\" title=\"Javaå’ŒC++çš„åŒºåˆ«\"></a>Javaå’ŒC++çš„åŒºåˆ«</h3><p>ç›¸åŒç‚¹ï¼šéƒ½æ˜¯<strong>é¢å‘å¯¹è±¡</strong>çš„è¯­è¨€ï¼Œéƒ½æ”¯æŒ<strong>å°è£…ã€ç»§æ‰¿å’Œå¤šæ€</strong></p>\n<p>ä¸åŒç‚¹ï¼š</p>\n<ul>\n<li><p><strong>Javaä¸æä¾›æŒ‡é’ˆ</strong>æ¥ç›´æ¥è®¿é—®å†…å­˜ï¼Œç¨‹åºå†…å­˜æ›´åŠ å®‰å…¨ï¼Œæœ‰è‡ªåŠ¨å†…å­˜ç®¡ç†ï¼›C++ç”¨æŒ‡é’ˆç®¡ç†å†…å­˜</p>\n</li>\n<li><p>Java çš„<strong>ç±»æ˜¯å•ç»§æ‰¿</strong>çš„ï¼ŒC++æ”¯æŒå¤šé‡ç»§æ‰¿ï¼›è™½ç„¶ Java çš„ç±»ä¸å¯ä»¥å¤šç»§æ‰¿ï¼Œä½†æ˜¯æ¥å£å¯ä»¥å¤šç»§æ‰¿ã€‚</p>\n<p>  ä¸ºä»€ä¹ˆ Java ä¸­ç±»ä¸æ”¯æŒå¤šç»§æ‰¿ï¼Ÿâ€”â€”å¤šé‡ç»§æ‰¿çš„é’»çŸ³é—®é¢˜</p>\n<p>  <img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes20190622142003813.png\" alt=\"å¤šé‡ç»§æ‰¿çš„é’»çŸ³é—®é¢˜\"><br>  ç±» B å’Œç±» C ç»§æ‰¿è‡ªç±» Aï¼Œä¸”éƒ½é‡å†™äº†ç±» A ä¸­çš„åŒä¸€ä¸ªæ–¹æ³•ï¼Œè€Œç±» D åŒæ—¶ç»§æ‰¿äº†ç±» B å’Œç±» Cï¼ˆå¤šç»§æ‰¿)ï¼Œé‚£ä¹ˆæ­¤æ—¶ç±» D ä¼šç»§æ‰¿ Bã€C çš„æ–¹æ³•ï¼Œé‚£å¯¹äº Bã€C é‡å†™çš„ A ä¸­çš„æ–¹æ³•ï¼Œç±» D ä¼šç»§æ‰¿å“ªä¸€ä¸ªå‘¢ï¼Ÿ</p>\n</li>\n<li><p>Java æœ‰<strong>è‡ªåŠ¨å†…å­˜ç®¡ç†</strong>æœºåˆ¶ï¼Œä¸éœ€è¦ç¨‹åºå‘˜æ‰‹åŠ¨é‡Šæ”¾æ— ç”¨å†…å­˜</p>\n</li>\n</ul>\n<h2 id=\"åŸºç¡€è¯­æ³•\"><a href=\"#åŸºç¡€è¯­æ³•\" class=\"headerlink\" title=\"åŸºç¡€è¯­æ³•\"></a>åŸºç¡€è¯­æ³•</h2><h3 id=\"æ•°æ®ç±»å‹\"><a href=\"#æ•°æ®ç±»å‹\" class=\"headerlink\" title=\"æ•°æ®ç±»å‹\"></a>æ•°æ®ç±»å‹</h3><p><strong>å®šä¹‰</strong>ï¼šJava è¯­è¨€æ˜¯å¼ºç±»å‹è¯­è¨€ï¼Œå¯¹äºæ¯ä¸€ç§æ•°æ®éƒ½å®šä¹‰äº†æ˜ç¡®çš„å…·ä½“çš„æ•°æ®ç±»å‹ï¼Œåœ¨å†…å­˜ä¸­åˆ†é…äº†ä¸åŒå¤§å°çš„å†…å­˜ç©ºé—´ã€‚</p>\n<p><strong>åˆ†ç±»</strong></p>\n<ul>\n<li>åŸºæœ¬æ•°æ®ç±»å‹<ul>\n<li>æ•°å€¼å‹<ul>\n<li>æ•´æ•°ç±»å‹(byte,short,int,long)</li>\n<li>æµ®ç‚¹ç±»å‹(float,double)</li>\n</ul>\n</li>\n<li>å­—ç¬¦å‹(char)</li>\n<li>å¸ƒå°”å‹(boolean)</li>\n</ul>\n</li>\n<li>å¼•ç”¨æ•°æ®ç±»å‹<ul>\n<li>ç±»(class)</li>\n<li>æ¥å£(interface)</li>\n<li>æ•°ç»„([])</li>\n</ul>\n</li>\n</ul>\n<p><strong>JavaåŸºæœ¬æ•°æ®ç±»å‹å›¾</strong></p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0pvdXJXb24vaW1hZ2UvbWFzdGVyL0phdmElRTUlOUYlQkElRTclQTElODAlRTglQUYlQUQlRTYlQjMlOTUvSmF2YSVFNSU5RiVCQSVFNiU5QyVBQyVFNiU5NSVCMCVFNiU4RCVBRSVFNyVCMSVCQiVFNSU5RSU4Qi5wbmc.png\" alt=\"JavaåŸºæœ¬æ•°æ®ç±»å‹å›¾\"></p>\n<h3 id=\"ç±»å‹è½¬æ¢\"><a href=\"#ç±»å‹è½¬æ¢\" class=\"headerlink\" title=\"ç±»å‹è½¬æ¢\"></a>ç±»å‹è½¬æ¢</h3><p>è‡ªåŠ¨ç±»å‹è½¬æ¢</p>\n<blockquote>\n<p>ä¸¤ç§æ•°æ®ç±»å‹å½¼æ­¤å…¼å®¹</p>\n<p>ä½çº§ç±»å‹æ•°æ®è½¬æ¢æˆé«˜çº§ç±»å‹æ•°æ®</p>\n</blockquote>\n<ul>\n<li>æ•°å€¼å‹æ•°æ®çš„è½¬æ¢ï¼šbyteâ†’shortâ†’intâ†’longâ†’floatâ†’double</li>\n<li>å­—ç¬¦å‹è½¬æ¢ä¸ºæ•´å‹ï¼šcharâ†’intã€‚</li>\n</ul>\n<p>å¼ºåˆ¶ç±»å‹è½¬æ¢</p>\n<blockquote>\n<p>å½“ä¸¤ç§æ•°æ®ç±»å‹ä¸å…¼å®¹ï¼Œæˆ–é«˜çº§ç±»å‹æ•°æ®è½¬æ¢æˆä½çº§ç±»å‹æ•°æ®æ—¶ï¼Œè‡ªåŠ¨è½¬æ¢å°†æ— æ³•è¿›è¡Œï¼ˆç¼–è¯‘é”™è¯¯ï¼‰ï¼Œè¿™æ—¶å°±éœ€è¦è¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢</p>\n</blockquote>\n<h3 id=\"è®¿é—®ä¿®é¥°ç¬¦\"><a href=\"#è®¿é—®ä¿®é¥°ç¬¦\" class=\"headerlink\" title=\"è®¿é—®ä¿®é¥°ç¬¦\"></a>è®¿é—®ä¿®é¥°ç¬¦</h3><p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0pvdXJXb24vaW1hZ2UvbWFzdGVyL0phdmElRTUlOUYlQkElRTclQTElODAlRTglQUYlQUQlRTYlQjMlOTUvSmF2YSVFOCVBRSVCRiVFOSU5NyVBRSVFNCVCRiVBRSVFOSVBNSVCMCVFNyVBQyVBNi5wbmc.png\" alt=\"è®¿é—®ä¿®é¥°ç¬¦\"></p>\n<h3 id=\"å…³é”®å­—\"><a href=\"#å…³é”®å­—\" class=\"headerlink\" title=\"å…³é”®å­—\"></a>å…³é”®å­—</h3><h4 id=\"final-æœ‰ä»€ä¹ˆç”¨ï¼Ÿ\"><a href=\"#final-æœ‰ä»€ä¹ˆç”¨ï¼Ÿ\" class=\"headerlink\" title=\"final æœ‰ä»€ä¹ˆç”¨ï¼Ÿ\"></a>final æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h4><p>ç”¨äºä¿®é¥°ç±»ã€æ–¹æ³•å’Œå˜é‡ï¼›</p>\n<ul>\n<li><p>è¢« final ä¿®é¥°çš„ç±»ä¸å¯ä»¥è¢«ç»§æ‰¿</p>\n</li>\n<li><p>è¢« final ä¿®é¥°çš„æ–¹æ³•ä¸å¯ä»¥è¢«é‡å†™</p>\n</li>\n<li><p>è¢« final ä¿®é¥°çš„å˜é‡ä¸å¯ä»¥è¢«æ”¹å˜ï¼Œè¢« final ä¿®é¥°<strong>ä¸å¯å˜çš„æ˜¯å˜é‡çš„å¼•ç”¨ï¼Œè€Œä¸æ˜¯å¼•ç”¨æŒ‡å‘çš„å†…å®¹</strong>ï¼Œå¼•ç”¨æŒ‡å‘çš„å†…å®¹æ˜¯å¯ä»¥æ”¹å˜</p>\n  <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">final</span> <span class=\"type\">int</span>[] nums = <span class=\"keyword\">new</span> <span class=\"title class_\">int</span>[]&#123;<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>&#125;;</span><br><span class=\"line\">nums[<span class=\"number\">0</span>] = <span class=\"number\">11</span>;</span><br><span class=\"line\">System.out.println(Arrays.toString(nums));\t<span class=\"comment\">// [11, 2, 3]</span></span><br></pre></td></tr></table></figure></li>\n</ul>\n<h4 id=\"finalã€finallyã€finalizeåŒºåˆ«\"><a href=\"#finalã€finallyã€finalizeåŒºåˆ«\" class=\"headerlink\" title=\"finalã€finallyã€finalizeåŒºåˆ«\"></a>finalã€finallyã€finalizeåŒºåˆ«</h4><ul>\n<li><p>final æ˜¯ Java ä¿®é¥°ç¬¦ï¼Œå¯ä»¥ä¿®é¥°ç±»ã€æ–¹æ³•ã€å˜é‡ï¼Œä¿®é¥°ç±»è¡¨ç¤ºè¯¥ç±»ä¸èƒ½è¢«ç»§æ‰¿ã€ä¿®é¥°æ–¹æ³•è¡¨ç¤ºè¯¥æ–¹æ³•ä¸èƒ½è¢«é‡å†™ã€ä¿®é¥°å˜é‡è¡¨ç¤ºè¯¥å˜é‡ä¸å¯ä»¥è¢«æ”¹å˜ã€‚</p>\n</li>\n<li><p>finally ä¸€èˆ¬ä½œç”¨åœ¨ try-catch ä»£ç å—ä¸­ï¼Œåœ¨å¤„ç†å¼‚å¸¸çš„æ—¶å€™ï¼Œé€šå¸¸æˆ‘ä»¬å°†ä¸€å®šè¦æ‰§è¡Œçš„ä»£ç æ”¾åœ¨ finally ä»£ç å—ä¸­ï¼Œè¡¨ç¤ºä¸ç®¡æ˜¯å¦å‡ºç°å¼‚å¸¸ï¼Œè¯¥ä»£ç å—éƒ½ä¼šæ‰§è¡Œï¼Œä¸€èˆ¬ç”¨æ¥å­˜æ”¾ä¸€äº›å…³é—­èµ„æºçš„ä»£ç ã€‚</p>\n</li>\n<li><p>finalize æ˜¯ Object ç±»çš„ä¸€ä¸ªæ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¸€èˆ¬ç”±åƒåœ¾å›æ”¶å™¨æ¥è°ƒç”¨ï¼Œåœ¨æ‰§è¡Œåƒåœ¾å›æ”¶å‰ï¼Œç”±åƒåœ¾å›æ”¶å™¨è°ƒç”¨å¯¹è±¡çš„ finalize()æ–¹æ³•ï¼Œå¹¶ä¸”åœ¨è¯¥æ–¹æ³•ä¸­å¯¹è±¡å¯èƒ½å¯ä»¥å¤æ´»ã€‚</p>\n</li>\n</ul>\n<h4 id=\"thiså…³é”®å­—çš„ç”¨æ³•\"><a href=\"#thiså…³é”®å­—çš„ç”¨æ³•\" class=\"headerlink\" title=\"thiså…³é”®å­—çš„ç”¨æ³•\"></a>thiså…³é”®å­—çš„ç”¨æ³•</h4><p>æŒ‡å‘å¯¹è±¡æœ¬èº«çš„ä¸€ä¸ªæŒ‡é’ˆã€‚</p>\n<h4 id=\"superå…³é”®å­—çš„ç”¨æ³•\"><a href=\"#superå…³é”®å­—çš„ç”¨æ³•\" class=\"headerlink\" title=\"superå…³é”®å­—çš„ç”¨æ³•\"></a>superå…³é”®å­—çš„ç”¨æ³•</h4><p>æŒ‡å‘è‡ªå·±çˆ¶ç±»å¯¹è±¡ï¼ˆæœ€è¿‘çš„çˆ¶ç±»ï¼‰çš„ä¸€ä¸ªæŒ‡é’ˆã€‚</p>\n<h4 id=\"staticå­˜åœ¨çš„ä¸»è¦æ„ä¹‰\"><a href=\"#staticå­˜åœ¨çš„ä¸»è¦æ„ä¹‰\" class=\"headerlink\" title=\"staticå­˜åœ¨çš„ä¸»è¦æ„ä¹‰\"></a>staticå­˜åœ¨çš„ä¸»è¦æ„ä¹‰</h4><p>static<strong>é™æ€å˜é‡</strong>ï¼šå’Œç±»ä¸€èµ·åŠ è½½ï¼Œ<strong>ä»¥è‡´äºå³ä½¿æ²¡æœ‰åˆ›å»ºå¯¹è±¡ï¼Œä¹Ÿèƒ½ä½¿ç”¨å±æ€§å’Œè°ƒç”¨æ–¹æ³•ã€‚</strong></p>\n<p>static<strong>é™æ€ä»£ç å—</strong>ï¼šåœ¨ç±»åˆæ¬¡è¢«åŠ è½½çš„æ—¶å€™ï¼Œä¼šæŒ‰ç…§ static å—çš„é¡ºåºæ¥æ‰§è¡Œæ¯ä¸ª static å—ï¼Œå¹¶ä¸”åªä¼šæ‰§è¡Œä¸€æ¬¡ã€‚<br>åŠ è½½ â†’ é“¾æ¥ï¼ˆéªŒè¯ã€å‡†å¤‡ã€è§£æï¼‰ â†’ åˆå§‹åŒ–</p>\n<p>static ç±»å‹çš„å˜é‡åœ¨å‡†å¤‡é˜¶æ®µè¿›è¡Œé»˜è®¤åˆå§‹åŒ–ï¼Œä½†æ˜¯æœ‰ static final ä¿®é¥°çš„ä¼šåœ¨å‡†å¤‡é˜¶æ®µç›´æ¥èµ‹å€¼ï¼Œ åœ¨åˆå§‹åŒ–é˜¶æ®µè¿›è¡Œæ˜¾å¼åˆå§‹åŒ–ã€‚</p>\n<h4 id=\"staticæ³¨æ„äº‹é¡¹\"><a href=\"#staticæ³¨æ„äº‹é¡¹\" class=\"headerlink\" title=\"staticæ³¨æ„äº‹é¡¹\"></a>staticæ³¨æ„äº‹é¡¹</h4><p>1ã€é™æ€åªèƒ½è®¿é—®é™æ€ã€‚ 2ã€éé™æ€æ—¢å¯ä»¥è®¿é—®éé™æ€çš„ï¼Œä¹Ÿå¯ä»¥è®¿é—®é™æ€çš„ã€‚</p>\n<h3 id=\"åˆå§‹åŒ–é¡ºåº\"><a href=\"#åˆå§‹åŒ–é¡ºåº\" class=\"headerlink\" title=\"åˆå§‹åŒ–é¡ºåº\"></a>åˆå§‹åŒ–é¡ºåº</h3><p>é™æ€å±æ€§ â†’ é™æ€æ–¹æ³•å— â†’ æ™®é€šå±æ€§ â†’ æ™®é€šæ–¹æ³•å— â†’ æ„é€ å‡½æ•°</p>\n<h3 id=\"æµç¨‹æ§åˆ¶è¯­å¥\"><a href=\"#æµç¨‹æ§åˆ¶è¯­å¥\" class=\"headerlink\" title=\"æµç¨‹æ§åˆ¶è¯­å¥\"></a>æµç¨‹æ§åˆ¶è¯­å¥</h3><h4 id=\"break-ã€continueã€return-çš„åŒºåˆ«åŠä½œç”¨\"><a href=\"#break-ã€continueã€return-çš„åŒºåˆ«åŠä½œç”¨\" class=\"headerlink\" title=\"break ã€continueã€return çš„åŒºåˆ«åŠä½œç”¨\"></a>break ã€continueã€return çš„åŒºåˆ«åŠä½œç”¨</h4><p>break ç»“æŸå½“å‰çš„å¾ªç¯ä½“</p>\n<p>continue ç»“æŸæ­£åœ¨æ‰§è¡Œçš„å¾ªç¯ï¼Œè¿›å…¥ä¸‹ä¸€ä¸ªå¾ªç¯æ¡ä»¶</p>\n<p>return ç»“æŸå½“å‰çš„æ–¹æ³•ï¼Œç›´æ¥è¿”å›</p>\n<h4 id=\"è·³å‡ºå½“å‰çš„å¤šé‡åµŒå¥—å¾ªç¯\"><a href=\"#è·³å‡ºå½“å‰çš„å¤šé‡åµŒå¥—å¾ªç¯\" class=\"headerlink\" title=\"è·³å‡ºå½“å‰çš„å¤šé‡åµŒå¥—å¾ªç¯\"></a>è·³å‡ºå½“å‰çš„å¤šé‡åµŒå¥—å¾ªç¯</h4><p>åœ¨ Java ä¸­ï¼Œè¦æƒ³è·³å‡ºå¤šé‡å¾ªç¯ï¼Œå¯ä»¥åœ¨å¤–é¢çš„å¾ªç¯è¯­å¥å‰å®šä¹‰ä¸€ä¸ªæ ‡å·ï¼Œç„¶ååœ¨é‡Œå±‚å¾ªç¯ä½“çš„ä»£ç ä¸­ä½¿ç”¨å¸¦æœ‰æ ‡å·çš„ break è¯­å¥ï¼Œå³å¯è·³å‡ºå¤–å±‚å¾ªç¯ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">    ok:</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">j</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; j &lt; <span class=\"number\">10</span>; j++) &#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;i=&quot;</span> + i + <span class=\"string\">&quot;,j=&quot;</span> + j);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (j == <span class=\"number\">5</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">break</span> ok;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"é¢å‘å¯¹è±¡\"><a href=\"#é¢å‘å¯¹è±¡\" class=\"headerlink\" title=\"é¢å‘å¯¹è±¡\"></a>é¢å‘å¯¹è±¡</h2><h3 id=\"é¢å‘å¯¹è±¡ä¸‰å¤§ç‰¹æ€§\"><a href=\"#é¢å‘å¯¹è±¡ä¸‰å¤§ç‰¹æ€§\" class=\"headerlink\" title=\"é¢å‘å¯¹è±¡ä¸‰å¤§ç‰¹æ€§\"></a>é¢å‘å¯¹è±¡ä¸‰å¤§ç‰¹æ€§</h3><h4 id=\"é¢å‘å¯¹è±¡çš„ç‰¹å¾æœ‰å“ªäº›æ–¹é¢\"><a href=\"#é¢å‘å¯¹è±¡çš„ç‰¹å¾æœ‰å“ªäº›æ–¹é¢\" class=\"headerlink\" title=\"é¢å‘å¯¹è±¡çš„ç‰¹å¾æœ‰å“ªäº›æ–¹é¢\"></a>é¢å‘å¯¹è±¡çš„ç‰¹å¾æœ‰å“ªäº›æ–¹é¢</h4><p><strong>æŠ½è±¡</strong>ï¼šæŠ½è±¡æ˜¯å°†ä¸€ç±»å¯¹è±¡çš„å…±åŒç‰¹å¾æ€»ç»“å‡ºæ¥æ„é€ ç±»çš„è¿‡ç¨‹ï¼ŒåŒ…æ‹¬æ•°æ®æŠ½è±¡å’Œè¡Œä¸ºæŠ½è±¡ä¸¤æ–¹é¢ã€‚æŠ½è±¡åªå…³æ³¨å¯¹è±¡æœ‰å“ªäº›å±æ€§å’Œè¡Œä¸ºï¼Œå¹¶ä¸å…³æ³¨è¿™äº›è¡Œä¸ºçš„ç»†èŠ‚æ˜¯ä»€ä¹ˆã€‚</p>\n<p><strong>å°è£…</strong></p>\n<p>å°è£…æŠŠä¸€ä¸ªå¯¹è±¡çš„å±æ€§ç§æœ‰åŒ–ï¼ŒåŒæ—¶æä¾›ä¸€äº›å¯ä»¥è¢«å¤–ç•Œè®¿é—®çš„å±æ€§çš„æ–¹æ³•ï¼Œå¦‚æœå±æ€§ä¸æƒ³è¢«å¤–ç•Œè®¿é—®ï¼Œæˆ‘ä»¬å¤§å¯ä¸å¿…æä¾›æ–¹æ³•ç»™å¤–ç•Œè®¿é—®ã€‚</p>\n<p><strong>ç»§æ‰¿</strong></p>\n<p>ç»§æ‰¿æ˜¯<strong>ä½¿ç”¨å·²å­˜åœ¨çš„ç±»ä½œä¸ºåŸºç¡€å»ºç«‹æ–°ç±»</strong>çš„æŠ€æœ¯ï¼Œæ–°ç±»çš„å®šä¹‰å¯ä»¥å¢åŠ æ–°çš„æ•°æ®æˆ–æ–°çš„åŠŸèƒ½ï¼Œä¹Ÿå¯ä»¥ç”¨çˆ¶ç±»çš„åŠŸèƒ½ã€‚é€šè¿‡ä½¿ç”¨ç»§æ‰¿æˆ‘ä»¬èƒ½å¤Ÿéå¸¸æ–¹ä¾¿åœ°å¤ç”¨ä»¥å‰çš„ä»£ç ã€‚</p>\n<p>å…³äºç»§æ‰¿å¦‚ä¸‹ 3 ç‚¹è¯·è®°ä½ï¼š</p>\n<ol>\n<li>å­ç±»æ‹¥æœ‰çˆ¶ç±»é private çš„å±æ€§å’Œæ–¹æ³•ã€‚</li>\n<li>å­ç±»å¯ä»¥æ‹¥æœ‰è‡ªå·±å±æ€§å’Œæ–¹æ³•ï¼Œå³å­ç±»å¯ä»¥å¯¹çˆ¶ç±»è¿›è¡Œæ‰©å±•ã€‚</li>\n<li>å­ç±»å¯ä»¥ç”¨è‡ªå·±çš„æ–¹å¼å®ç°çˆ¶ç±»çš„æ–¹æ³•ï¼Œoverride é‡å†™ã€‚</li>\n</ol>\n<p><strong>å¤šæ€</strong></p>\n<p>æ‰€è°“å¤šæ€å°±æ˜¯æŒ‡ä¸€ä¸ªå¼•ç”¨å˜é‡åˆ°åº•ä¼šæŒ‡å‘å“ªä¸ªç±»çš„å®ä¾‹å¯¹è±¡ï¼Œè¯¥å¼•ç”¨å˜é‡è°ƒç”¨çš„æ–¹æ³•åˆ°åº•æ˜¯å“ªä¸ªç±»ä¸­å®ç°çš„æ–¹æ³•ï¼Œå¿…é¡»åœ¨ç¨‹åºè¿è¡ŒæœŸé—´æ‰èƒ½ç¡®å®šï¼Œç¼–è¯‘æœŸæ— æ³•ç¡®å®šã€‚</p>\n<p>çˆ¶ç±»çš„å¼•ç”¨æŒ‡å‘å­ç±»å®ä¾‹å¯¹è±¡ã€æ¥å£æŒ‡å‘å®ç°ç±»å®ä¾‹å¯¹è±¡ã€‚æé«˜äº†ç¨‹åºçš„æ‹“å±•æ€§ã€‚</p>\n<p>åœ¨ Java ä¸­æœ‰ä¸¤ç§å½¢å¼å¯ä»¥å®ç°å¤šæ€ï¼šç»§æ‰¿ï¼ˆå¤šä¸ªå­ç±»å¯¹åŒä¸€æ–¹æ³•çš„é‡å†™ï¼‰å’Œæ¥å£ï¼ˆå®ç°æ¥å£å¹¶è¦†ç›–æ¥å£ä¸­åŒä¸€æ–¹æ³•ï¼‰ã€‚</p>\n<p>æ–¹æ³•é‡è½½ï¼ˆoverloadï¼‰å®ç°ç¼–è¯‘æ—¶çš„å¤šæ€æ€§ï¼ˆä¹Ÿç§°ä¸ºå‰ç»‘å®šï¼‰ï¼Œæ–¹æ³•é‡å†™ï¼ˆoverrideï¼‰å®ç°è¿è¡Œæ—¶çš„å¤šæ€æ€§ï¼ˆä¹Ÿç§°ä¸ºåç»‘å®šï¼‰ã€‚</p>\n<p>Java å®ç°å¤šæ€æœ‰ä¸‰ä¸ªå¿…è¦æ¡ä»¶ï¼šç»§æ‰¿ã€é‡å†™ã€å‘ä¸Šè½¬å‹ã€‚</p>\n<blockquote>\n<p>ç»§æ‰¿ï¼šåœ¨å¤šæ€ä¸­å¿…é¡»å­˜åœ¨æœ‰ç»§æ‰¿å…³ç³»çš„å­ç±»å’Œçˆ¶ç±»ã€‚</p>\n<p>é‡å†™ï¼šå­ç±»å¯¹çˆ¶ç±»ä¸­æŸäº›æ–¹æ³•è¿›è¡Œé‡æ–°å®šä¹‰ï¼Œåœ¨è°ƒç”¨è¿™äº›æ–¹æ³•æ—¶å°±ä¼šè°ƒç”¨å­ç±»çš„æ–¹æ³•ã€‚</p>\n<p>å‘ä¸Šè½¬å‹ï¼šåœ¨å¤šæ€ä¸­éœ€è¦å°†å­ç±»çš„å¼•ç”¨èµ‹ç»™çˆ¶ç±»å¯¹è±¡ï¼Œåªæœ‰è¿™æ ·è¯¥å¼•ç”¨æ‰èƒ½å¤Ÿå…·å¤‡æŠ€èƒ½è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•å’Œå­ç±»çš„æ–¹æ³•ã€‚</p>\n</blockquote>\n<p>åªæœ‰æ»¡è¶³äº†ä¸Šè¿°ä¸‰ä¸ªæ¡ä»¶ï¼Œæˆ‘ä»¬æ‰èƒ½å¤Ÿåœ¨åŒä¸€ä¸ªç»§æ‰¿ç»“æ„ä¸­ä½¿ç”¨ç»Ÿä¸€çš„é€»è¾‘å®ç°ä»£ç å¤„ç†ä¸åŒçš„å¯¹è±¡ï¼Œä»è€Œè¾¾åˆ°æ‰§è¡Œä¸åŒçš„è¡Œä¸ºã€‚</p>\n<h4 id=\"æŠ½è±¡ç±»å’Œæ¥å£çš„å¯¹æ¯”\"><a href=\"#æŠ½è±¡ç±»å’Œæ¥å£çš„å¯¹æ¯”\" class=\"headerlink\" title=\"æŠ½è±¡ç±»å’Œæ¥å£çš„å¯¹æ¯”\"></a>æŠ½è±¡ç±»å’Œæ¥å£çš„å¯¹æ¯”</h4><p>æŠ½è±¡ç±»æ˜¯å¯¹ç±»çš„æŠ½è±¡ï¼Œç”¨æ¥<strong>æ•æ‰é€šç”¨ç‰¹æ€§</strong>ã€‚æ¥å£æ˜¯<strong>è¡Œä¸ºçš„æŠ½è±¡</strong>ï¼ŒæŠ½è±¡æ–¹æ³•çš„é›†åˆã€‚</p>\n<p><strong>ç›¸åŒç‚¹</strong></p>\n<ul>\n<li>æ¥å£å’ŒæŠ½è±¡ç±»éƒ½ä¸èƒ½å®ä¾‹åŒ–</li>\n<li>éƒ½ä½äºç»§æ‰¿çš„é¡¶ç«¯ï¼Œç”¨äºè¢«å…¶ä»–ç±»å®ç°æˆ–ç»§æ‰¿</li>\n<li>éƒ½åŒ…å«æŠ½è±¡æ–¹æ³•ï¼Œå…¶å­ç±»éƒ½å¿…é¡»é‡å†™è¿™äº›æŠ½è±¡æ–¹æ³•</li>\n</ul>\n<p><strong>ä¸åŒç‚¹</strong></p>\n<table>\n<thead>\n<tr>\n<th>å‚æ•°</th>\n<th>æŠ½è±¡ç±»</th>\n<th>æ¥å£</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>å£°æ˜</td>\n<td>æŠ½è±¡ç±»ä½¿ç”¨abstractå…³é”®å­—å£°æ˜</td>\n<td>æ¥å£ä½¿ç”¨interfaceå…³é”®å­—å£°æ˜</td>\n</tr>\n<tr>\n<td>å®ç°</td>\n<td>å­ç±»ä½¿ç”¨extendså…³é”®å­—æ¥ç»§æ‰¿æŠ½è±¡ç±»</td>\n<td>å­ç±»ä½¿ç”¨implementså…³é”®å­—æ¥å®ç°æ¥å£</td>\n</tr>\n<tr>\n<td>æ„é€ å™¨</td>\n<td>æŠ½è±¡ç±»å¯ä»¥æœ‰æ„é€ å™¨</td>\n<td>æ¥å£ä¸èƒ½æœ‰æ„é€ å™¨</td>\n</tr>\n<tr>\n<td>è®¿é—®ä¿®é¥°ç¬¦</td>\n<td>æŠ½è±¡ç±»ä¸­çš„æ–¹æ³•å¯ä»¥æ˜¯ä»»æ„è®¿é—®ä¿®é¥°ç¬¦</td>\n<td>æ¥å£æ–¹æ³•é»˜è®¤ä¿®é¥°ç¬¦æ˜¯publicï¼Œä¹Ÿå¯ä»¥ä¸åŠ è®¿é—®ä¿®é¥°ç¬¦</td>\n</tr>\n<tr>\n<td>å¤šç»§æ‰¿</td>\n<td>ä¸€ä¸ªç±»æœ€å¤šåªèƒ½ç»§æ‰¿ä¸€ä¸ªæŠ½è±¡ç±»</td>\n<td>ä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£</td>\n</tr>\n</tbody></table>\n<h4 id=\"æ™®é€šç±»å’ŒæŠ½è±¡ç±»æœ‰å“ªäº›åŒºåˆ«ï¼Ÿ\"><a href=\"#æ™®é€šç±»å’ŒæŠ½è±¡ç±»æœ‰å“ªäº›åŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"æ™®é€šç±»å’ŒæŠ½è±¡ç±»æœ‰å“ªäº›åŒºåˆ«ï¼Ÿ\"></a>æ™®é€šç±»å’ŒæŠ½è±¡ç±»æœ‰å“ªäº›åŒºåˆ«ï¼Ÿ</h4><ul>\n<li>æ™®é€šç±»ä¸èƒ½åŒ…å«æŠ½è±¡æ–¹æ³•ï¼ŒæŠ½è±¡ç±»å¯ä»¥åŒ…å«æŠ½è±¡æ–¹æ³•ã€‚</li>\n<li>æŠ½è±¡ç±»ä¸èƒ½ç›´æ¥å®ä¾‹åŒ–ï¼Œæ™®é€šç±»å¯ä»¥ç›´æ¥å®ä¾‹åŒ–ã€‚</li>\n</ul>\n<h4 id=\"æˆå‘˜å˜é‡å’Œå±€éƒ¨å˜é‡çš„åŒºåˆ«\"><a href=\"#æˆå‘˜å˜é‡å’Œå±€éƒ¨å˜é‡çš„åŒºåˆ«\" class=\"headerlink\" title=\"æˆå‘˜å˜é‡å’Œå±€éƒ¨å˜é‡çš„åŒºåˆ«\"></a>æˆå‘˜å˜é‡å’Œå±€éƒ¨å˜é‡çš„åŒºåˆ«</h4><table>\n<thead>\n<tr>\n<th></th>\n<th>æˆå‘˜å˜é‡</th>\n<th>å±€éƒ¨å˜é‡</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><strong>ä½œç”¨åŸŸ</strong></td>\n<td>æ•´ä¸ªç±»å¯ä½¿ç”¨</td>\n<td>æ–¹æ³•ä½“å†…ä½¿ç”¨</td>\n</tr>\n<tr>\n<td><strong>å­˜å‚¨ä½ç½®</strong></td>\n<td>å±äºå¯¹è±¡ï¼Œå­˜åœ¨å †å†…å­˜ä¸­</td>\n<td>å±äºæ–¹æ³•ï¼Œå­˜åœ¨æ ˆå¸§ä¸­</td>\n</tr>\n<tr>\n<td><strong>ç”Ÿå‘½å‘¨æœŸ</strong></td>\n<td>å’Œå¯¹è±¡åŒç”Ÿå‘½å‘¨æœŸ</td>\n<td>å’Œæ–¹æ³•åŒç”Ÿå‘½å‘¨æœŸ</td>\n</tr>\n<tr>\n<td><strong>åˆå§‹å€¼</strong></td>\n<td>ä¸æŒ‡å®šçš„è¯æœ‰é»˜è®¤åˆå§‹å€¼</td>\n<td>å¿…é¡»æ‰‹åŠ¨åˆå§‹åŒ–å¦åˆ™<br />ä¸èƒ½ä½¿ç”¨ï¼ˆç¼–è¯‘é”™è¯¯ï¼‰</td>\n</tr>\n</tbody></table>\n<p><strong>ä½¿ç”¨åŸåˆ™</strong></p>\n<p>åœ¨ä½¿ç”¨å˜é‡æ—¶éœ€è¦éµå¾ªçš„åŸåˆ™ä¸ºï¼šå°±è¿‘åŸåˆ™<br>é¦–å…ˆåœ¨å±€éƒ¨èŒƒå›´æ‰¾ï¼Œæœ‰å°±ä½¿ç”¨ï¼›æ¥ç€åœ¨æˆå‘˜ä½ç½®æ‰¾ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Main</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">a</span> <span class=\"operator\">=</span> <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">a</span> <span class=\"operator\">=</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">        System.out.println(a);\t<span class=\"comment\">// 1</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"å†…éƒ¨ç±»\"><a href=\"#å†…éƒ¨ç±»\" class=\"headerlink\" title=\"å†…éƒ¨ç±»\"></a>å†…éƒ¨ç±»</h3><h4 id=\"ä»€ä¹ˆæ˜¯å†…éƒ¨ç±»ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯å†…éƒ¨ç±»ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯å†…éƒ¨ç±»ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯å†…éƒ¨ç±»ï¼Ÿ</h4><p>åœ¨ Java ä¸­ï¼Œå¯ä»¥å°†ä¸€ä¸ªç±»çš„å®šä¹‰æ”¾åœ¨å¦å¤–ä¸€ä¸ªç±»çš„å®šä¹‰å†…éƒ¨ï¼Œè¿™å°±æ˜¯<strong>å†…éƒ¨ç±»</strong>ã€‚</p>\n<h4 id=\"å†…éƒ¨ç±»çš„åˆ†ç±»æœ‰å“ªäº›\"><a href=\"#å†…éƒ¨ç±»çš„åˆ†ç±»æœ‰å“ªäº›\" class=\"headerlink\" title=\"å†…éƒ¨ç±»çš„åˆ†ç±»æœ‰å“ªäº›\"></a>å†…éƒ¨ç±»çš„åˆ†ç±»æœ‰å“ªäº›</h4><p>å†…éƒ¨ç±»å¯ä»¥åˆ†ä¸ºå››ç§ï¼š<strong>é™æ€å†…éƒ¨ç±»ã€æˆå‘˜å†…éƒ¨ç±»ã€å±€éƒ¨å†…éƒ¨ç±»ã€åŒ¿åå†…éƒ¨ç±»</strong>ã€‚</p>\n<h5 id=\"é™æ€å†…éƒ¨ç±»\"><a href=\"#é™æ€å†…éƒ¨ç±»\" class=\"headerlink\" title=\"é™æ€å†…éƒ¨ç±»\"></a>é™æ€å†…éƒ¨ç±»</h5><p>å®šä¹‰åœ¨ç±»å†…éƒ¨çš„é™æ€ç±»ï¼Œå°±æ˜¯é™æ€å†…éƒ¨ç±»ã€‚</p>\n<p>é™æ€å†…éƒ¨ç±»å¯ä»¥è®¿é—®å¤–éƒ¨ç±»æ‰€æœ‰çš„é™æ€å˜é‡ï¼Œè€Œä¸å¯è®¿é—®å¤–éƒ¨ç±»çš„éé™æ€å˜é‡</p>\n<h5 id=\"æˆå‘˜å†…éƒ¨ç±»\"><a href=\"#æˆå‘˜å†…éƒ¨ç±»\" class=\"headerlink\" title=\"æˆå‘˜å†…éƒ¨ç±»\"></a>æˆå‘˜å†…éƒ¨ç±»</h5><p>å®šä¹‰åœ¨ç±»å†…éƒ¨ï¼Œæˆå‘˜ä½ç½®ä¸Šçš„éé™æ€ç±»ï¼Œå°±æ˜¯æˆå‘˜å†…éƒ¨ç±»ã€‚</p>\n<p>æˆå‘˜å†…éƒ¨ç±»å¯ä»¥è®¿é—®å¤–éƒ¨ç±»æ‰€æœ‰çš„å˜é‡å’Œæ–¹æ³•ï¼ŒåŒ…æ‹¬é™æ€å’Œéé™æ€ï¼Œç§æœ‰å’Œå…¬æœ‰ã€‚</p>\n<h5 id=\"å±€éƒ¨å†…éƒ¨ç±»\"><a href=\"#å±€éƒ¨å†…éƒ¨ç±»\" class=\"headerlink\" title=\"å±€éƒ¨å†…éƒ¨ç±»\"></a>å±€éƒ¨å†…éƒ¨ç±»</h5><p>å®šä¹‰åœ¨æ–¹æ³•ä¸­çš„å†…éƒ¨ç±»ï¼Œå°±æ˜¯å±€éƒ¨å†…éƒ¨ç±»ã€‚</p>\n<p>å®šä¹‰åœ¨å®ä¾‹æ–¹æ³•ä¸­çš„å±€éƒ¨ç±»å¯ä»¥è®¿é—®å¤–éƒ¨ç±»çš„æ‰€æœ‰å˜é‡å’Œæ–¹æ³•ï¼Œå®šä¹‰åœ¨é™æ€æ–¹æ³•ä¸­çš„å±€éƒ¨ç±»åªèƒ½è®¿é—®å¤–éƒ¨ç±»çš„é™æ€å˜é‡å’Œæ–¹æ³•</p>\n<h5 id=\"åŒ¿åå†…éƒ¨ç±»\"><a href=\"#åŒ¿åå†…éƒ¨ç±»\" class=\"headerlink\" title=\"åŒ¿åå†…éƒ¨ç±»\"></a>åŒ¿åå†…éƒ¨ç±»</h5><p>åŒ¿åå†…éƒ¨ç±»å°±æ˜¯æ²¡æœ‰åå­—çš„å†…éƒ¨ç±»ï¼Œæ—¥å¸¸å¼€å‘ä¸­ä½¿ç”¨çš„æ¯”è¾ƒå¤šã€‚åŒ¿åå†…éƒ¨ç±»å¿…é¡»ç»§æ‰¿æˆ–å®ç°ä¸€ä¸ªå·²æœ‰çš„æ¥å£ ï¼ŒåŒ¿åå†…éƒ¨ç±»ä¸èƒ½å®šä¹‰ä»»ä½•é™æ€æˆå‘˜å’Œé™æ€æ–¹æ³•</p>\n<h4 id=\"å±€éƒ¨å†…éƒ¨ç±»å’ŒåŒ¿åå†…éƒ¨ç±»è®¿é—®å±€éƒ¨å˜é‡çš„æ—¶å€™ï¼Œä¸ºä»€ä¹ˆå˜é‡å¿…é¡»è¦åŠ ä¸Šfinalï¼Ÿ\"><a href=\"#å±€éƒ¨å†…éƒ¨ç±»å’ŒåŒ¿åå†…éƒ¨ç±»è®¿é—®å±€éƒ¨å˜é‡çš„æ—¶å€™ï¼Œä¸ºä»€ä¹ˆå˜é‡å¿…é¡»è¦åŠ ä¸Šfinalï¼Ÿ\" class=\"headerlink\" title=\"å±€éƒ¨å†…éƒ¨ç±»å’ŒåŒ¿åå†…éƒ¨ç±»è®¿é—®å±€éƒ¨å˜é‡çš„æ—¶å€™ï¼Œä¸ºä»€ä¹ˆå˜é‡å¿…é¡»è¦åŠ ä¸Šfinalï¼Ÿ\"></a>å±€éƒ¨å†…éƒ¨ç±»å’ŒåŒ¿åå†…éƒ¨ç±»è®¿é—®å±€éƒ¨å˜é‡çš„æ—¶å€™ï¼Œä¸ºä»€ä¹ˆå˜é‡å¿…é¡»è¦åŠ ä¸Šfinalï¼Ÿ</h4><p>å±€éƒ¨å†…éƒ¨ç±»å’ŒåŒ¿åå†…éƒ¨ç±»è®¿é—®å±€éƒ¨å˜é‡çš„æ—¶å€™ï¼Œä¸ºä»€ä¹ˆå˜é‡å¿…é¡»è¦åŠ ä¸Š final å‘¢ï¼Ÿå®ƒå†…éƒ¨åŸç†æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p>\n<p>å…ˆçœ‹è¿™æ®µä»£ç ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Outer</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">outMethod</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">a</span> <span class=\"operator\">=</span><span class=\"number\">10</span>;</span><br><span class=\"line\">        <span class=\"keyword\">class</span> <span class=\"title class_\">Inner</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">void</span> <span class=\"title function_\">innerMethod</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">                System.out.println(a);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>ä»¥ä¸Šä¾‹å­ï¼Œä¸ºä»€ä¹ˆè¦åŠ  final å‘¢ï¼Ÿæ˜¯å› ä¸º<strong>ç”Ÿå‘½å‘¨æœŸä¸ä¸€è‡´</strong></p>\n<p>å±€éƒ¨å˜é‡å­˜å‚¨åœ¨æ ˆä¸­ï¼Œå½“æ–¹æ³•æ‰§è¡Œç»“æŸåï¼Œå¦‚æœä¸ç”¨ final ä¿®é¥°é‚£ä¹ˆè¯¥å±€éƒ¨å˜é‡å°±è¢«é”€æ¯ã€‚è€Œå±€éƒ¨å†…éƒ¨ç±»å¯¹å±€éƒ¨å˜é‡çš„å¼•ç”¨ä¾ç„¶å­˜åœ¨ï¼Œå¦‚æœå±€éƒ¨å†…éƒ¨ç±»è¦è°ƒç”¨å±€éƒ¨å˜é‡æ—¶ï¼Œå°±ä¼šå‡ºé”™ã€‚<br>åŠ äº† finalï¼Œå¯ä»¥ç¡®ä¿å±€éƒ¨å†…éƒ¨ç±»ä½¿ç”¨çš„å˜é‡ä¸å¤–å±‚çš„å±€éƒ¨å˜é‡åŒºåˆ†å¼€ï¼Œè§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚</p>\n<h3 id=\"é‡å†™ä¸é‡è½½\"><a href=\"#é‡å†™ä¸é‡è½½\" class=\"headerlink\" title=\"é‡å†™ä¸é‡è½½\"></a>é‡å†™ä¸é‡è½½</h3><h4 id=\"æ„é€ å™¨ï¼ˆconstructorï¼‰æ˜¯å¦å¯è¢«é‡å†™ï¼ˆoverrideï¼‰\"><a href=\"#æ„é€ å™¨ï¼ˆconstructorï¼‰æ˜¯å¦å¯è¢«é‡å†™ï¼ˆoverrideï¼‰\" class=\"headerlink\" title=\"æ„é€ å™¨ï¼ˆconstructorï¼‰æ˜¯å¦å¯è¢«é‡å†™ï¼ˆoverrideï¼‰\"></a>æ„é€ å™¨ï¼ˆconstructorï¼‰æ˜¯å¦å¯è¢«é‡å†™ï¼ˆoverrideï¼‰</h4><p>æ„é€ å™¨ä¸èƒ½è¢«ç»§æ‰¿ï¼Œå› æ­¤ä¸èƒ½è¢«é‡å†™ï¼Œä½†å¯ä»¥è¢«é‡è½½ã€‚</p>\n<h4 id=\"é‡è½½ï¼ˆOverloadï¼‰å’Œé‡å†™ï¼ˆOverrideï¼‰çš„åŒºåˆ«ã€‚é‡è½½çš„æ–¹æ³•èƒ½å¦æ ¹æ®è¿”å›ç±»å‹è¿›è¡ŒåŒºåˆ†ï¼Ÿ\"><a href=\"#é‡è½½ï¼ˆOverloadï¼‰å’Œé‡å†™ï¼ˆOverrideï¼‰çš„åŒºåˆ«ã€‚é‡è½½çš„æ–¹æ³•èƒ½å¦æ ¹æ®è¿”å›ç±»å‹è¿›è¡ŒåŒºåˆ†ï¼Ÿ\" class=\"headerlink\" title=\"é‡è½½ï¼ˆOverloadï¼‰å’Œé‡å†™ï¼ˆOverrideï¼‰çš„åŒºåˆ«ã€‚é‡è½½çš„æ–¹æ³•èƒ½å¦æ ¹æ®è¿”å›ç±»å‹è¿›è¡ŒåŒºåˆ†ï¼Ÿ\"></a>é‡è½½ï¼ˆOverloadï¼‰å’Œé‡å†™ï¼ˆOverrideï¼‰çš„åŒºåˆ«ã€‚é‡è½½çš„æ–¹æ³•èƒ½å¦æ ¹æ®è¿”å›ç±»å‹è¿›è¡ŒåŒºåˆ†ï¼Ÿ</h4><p>æ–¹æ³•çš„é‡è½½å’Œé‡å†™éƒ½æ˜¯å®ç°å¤šæ€çš„æ–¹å¼ï¼ŒåŒºåˆ«åœ¨äºé‡è½½å®ç°çš„æ˜¯<strong>ç¼–è¯‘æ—¶çš„å¤šæ€æ€§</strong>ï¼Œè€Œé‡å†™å®ç°çš„æ˜¯<strong>è¿è¡Œæ—¶çš„å¤šæ€æ€§</strong>ã€‚</p>\n<p>é‡è½½ï¼šå‘ç”Ÿåœ¨<strong>åŒä¸€ä¸ªç±»</strong>ä¸­ï¼Œ<strong>æ–¹æ³•åç›¸åŒ å‚æ•°åˆ—è¡¨ä¸åŒ</strong>ï¼ˆå‚æ•°ç±»å‹ä¸åŒã€ä¸ªæ•°ä¸åŒã€é¡ºåºä¸åŒï¼‰ï¼Œä¸æ–¹æ³•è¿”å›å€¼å’Œè®¿é—®ä¿®é¥°ç¬¦æ— å…³</p>\n<p>é‡å†™ï¼šå‘ç”Ÿåœ¨<strong>çˆ¶å­ç±»</strong>ä¸­ï¼Œæ–¹æ³•åã€å‚æ•°åˆ—è¡¨å¿…é¡»ç›¸åŒï¼Œè¿”å›å€¼ç±»å‹å°äºç­‰äºçˆ¶ç±»ï¼ŒæŠ›å‡ºçš„å¼‚å¸¸å°äºç­‰äºçˆ¶ç±»ï¼Œ<strong>è®¿é—®ä¿®é¥°ç¬¦å¤§äºç­‰äºçˆ¶ç±»</strong>ï¼ˆé‡Œæ°ä»£æ¢åŸåˆ™ï¼‰</p>\n<h3 id=\"å¯¹è±¡ç›¸ç­‰åˆ¤æ–­\"><a href=\"#å¯¹è±¡ç›¸ç­‰åˆ¤æ–­\" class=\"headerlink\" title=\"å¯¹è±¡ç›¸ç­‰åˆ¤æ–­\"></a>å¯¹è±¡ç›¸ç­‰åˆ¤æ–­</h3><h4 id=\"x3D-x3D-å’Œ-equals-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ\"><a href=\"#x3D-x3D-å’Œ-equals-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ\" class=\"headerlink\" title=\"&#x3D;&#x3D; å’Œ equals çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ\"></a>&#x3D;&#x3D; å’Œ equals çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ</h4><p><strong>&#x3D;&#x3D;</strong> : å®ƒçš„ä½œç”¨æ˜¯åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡çš„åœ°å€æ˜¯ä¸æ˜¯ç›¸ç­‰ã€‚å³ï¼Œåˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯ä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚<br>(åŸºæœ¬æ•°æ®ç±»å‹ &#x3D;&#x3D; æ¯”è¾ƒçš„æ˜¯å€¼ï¼Œå¼•ç”¨æ•°æ®ç±»å‹ &#x3D;&#x3D; æ¯”è¾ƒçš„æ˜¯å†…å­˜åœ°å€)</p>\n<p><strong>equals()</strong> : å®ƒçš„ä½œç”¨ä¹Ÿæ˜¯åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰ã€‚ä½†å®ƒä¸€èˆ¬æœ‰ä¸¤ç§ä½¿ç”¨æƒ…å†µï¼š</p>\n<p>æƒ…å†µ 1ï¼šç±»æ²¡æœ‰é‡å†™ equals() æ–¹æ³•ã€‚åˆ™é€šè¿‡ equals() æ¯”è¾ƒè¯¥ç±»çš„ä¸¤ä¸ªå¯¹è±¡æ—¶ï¼Œç­‰ä»·äºé€šè¿‡â€œ&#x3D;&#x3D;â€æ¯”è¾ƒè¿™ä¸¤ä¸ªå¯¹è±¡ã€‚</p>\n<p>æƒ…å†µ 2ï¼šç±»é‡å†™äº† equals() æ–¹æ³•ã€‚ä¸€èˆ¬ï¼Œæˆ‘ä»¬éƒ½é‡å†™ equals() æ–¹æ³•æ¥ä¸¤ä¸ªå¯¹è±¡çš„å†…å®¹ç›¸ç­‰ï¼›è‹¥å®ƒä»¬çš„å†…å®¹ç›¸ç­‰ï¼Œåˆ™è¿”å› true (å³ï¼Œè®¤ä¸ºè¿™ä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰)ã€‚</p>\n<h4 id=\"hashCode-ä¸-equals\"><a href=\"#hashCode-ä¸-equals\" class=\"headerlink\" title=\"hashCode ä¸ equals\"></a>hashCode ä¸ equals</h4><p><strong>hashCode()ä»‹ç»</strong></p>\n<p>hashCode() çš„ä½œç”¨æ˜¯è·å–å“ˆå¸Œç ï¼ˆæœ¬åœ°æ–¹æ³•ï¼‰ï¼Œä¹Ÿç§°ä¸ºæ•£åˆ—ç ï¼›å®ƒå®é™…ä¸Šæ˜¯è¿”å›ä¸€ä¸ª int æ•´æ•°ã€‚hashCode() å®šä¹‰åœ¨ JDK çš„ Object ç±»ä¸­ï¼Œè¿™å°±æ„å‘³ç€ Java ä¸­çš„ä»»ä½•ç±»éƒ½æœ‰ hashCode()æ–¹æ³•ã€‚</p>\n<p><strong>ä¸ºä»€ä¹ˆè¦æœ‰ hashCode</strong></p>\n<p><strong>æˆ‘ä»¬ä»¥â€œhashSet å¦‚ä½•æ£€æŸ¥é‡å¤â€ä¸ºä¾‹å­æ¥è¯´æ˜ä¸ºä»€ä¹ˆè¦æœ‰ hashCode</strong>ï¼š</p>\n<p>å½“ä½ æŠŠå¯¹è±¡åŠ å…¥ hashSet æ—¶ï¼ŒhashSet ä¼šå…ˆè®¡ç®—å¯¹è±¡çš„ hashcode å€¼æ¥åˆ¤æ–­å¯¹è±¡åŠ å…¥çš„ä½ç½®ï¼Œå¦‚æœæ²¡æœ‰ç›¸ç¬¦çš„ hashcodeï¼ŒhashSet ä¼šå‡è®¾å¯¹è±¡æ²¡æœ‰é‡å¤å‡ºç°ã€‚ä½†æ˜¯å¦‚æœå‘ç°æœ‰ç›¸åŒ hashcode å€¼çš„å¯¹è±¡ï¼Œè¿™æ—¶ä¼šè°ƒç”¨ equals()æ–¹æ³•æ¥æ£€æŸ¥ hashcode ç›¸ç­‰çš„å¯¹è±¡æ˜¯å¦çœŸçš„ç›¸åŒã€‚å¦‚æœä¸¤è€…ç›¸åŒï¼Œè¡¨æ˜å·²ç»æœ‰äº†ç›¸åŒçš„å¯¹è±¡äº†ï¼ŒhashSet å°±ä¸ä¼šè®©å…¶åŠ å…¥æ“ä½œæˆåŠŸã€‚å¦‚æœä¸åŒçš„è¯ï¼Œå°±ä¼šé‡æ–°æ•£åˆ—åˆ°å…¶ä»–ä½ç½®ã€‚</p>\n<p><strong>hashCode()ä¸equals()çš„ç›¸å…³è§„å®š</strong></p>\n<ul>\n<li>å¦‚æœä¸¤ä¸ªå¯¹è±¡çš„ hashCode å€¼ç›¸ç­‰ï¼Œé‚£è¿™ä¸¤ä¸ªå¯¹è±¡ä¸ä¸€å®šç›¸ç­‰ï¼ˆå“ˆå¸Œç¢°æ’ï¼‰ã€‚</li>\n<li>å¦‚æœä¸¤ä¸ªå¯¹è±¡çš„ hashCode å€¼ç›¸ç­‰å¹¶ä¸” equals()æ–¹æ³•ä¹Ÿè¿”å› trueï¼Œæˆ‘ä»¬æ‰è®¤ä¸ºè¿™ä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰ã€‚</li>\n<li>å¦‚æœä¸¤ä¸ªå¯¹è±¡çš„ hashCode å€¼ä¸ç›¸ç­‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥è®¤ä¸ºè¿™ä¸¤ä¸ªå¯¹è±¡ä¸ç›¸ç­‰ã€‚</li>\n</ul>\n<h4 id=\"åªé‡å†™-hashCode-å¯ä»¥å—ï¼Ÿ\"><a href=\"#åªé‡å†™-hashCode-å¯ä»¥å—ï¼Ÿ\" class=\"headerlink\" title=\"åªé‡å†™ hashCode å¯ä»¥å—ï¼Ÿ\"></a>åªé‡å†™ hashCode å¯ä»¥å—ï¼Ÿ</h4><p>å¦‚æœåªé‡å†™ hashCodeï¼Œä¸é‡å†™ equalsï¼Œé‚£ä¹ˆå¦‚æœä¸¤ä¸ªå¯¹è±¡åˆ¤æ–­ hashCode ç›¸åŒäº†ï¼Œä»¥ä¸ºè¿™ä¿©å¯¹è±¡ç›¸åŒï¼Œé‚£ä¹ˆåªä¼šæ’å…¥ä¸€æ¬¡åˆ° set é‡Œé¢ï¼Œè€Œå®é™…ä¸Šè¿™ä¸¤ä¸ªä¸ä¸€æ ·ä¸€ä¸ªæ˜¯ A ä¸€ä¸ªæ˜¯ Bï¼Œéƒ½éœ€è¦æ’å…¥ã€‚</p>\n<blockquote>\n<p>ä¸¤ä¸ªå¯¹è±¡çš„ hashCode ç›¸åŒï¼Œä½†æ˜¯å†…å®¹å¯èƒ½ä¸åŒï¼Œåœ¨ set ä¸­æ˜æ˜åº”è¯¥æ˜¯ä¸¤ä¸ªä¸åŒçš„å¯¹è±¡ï¼Œè¿™æ—¶å€™åªé€šè¿‡ hashCode åˆ¤æ–­ä»–ä¿©ç›¸åŒä¼šå¯¼è‡´åªæ’å…¥ä¸€ä¸ªå…ƒç´ ã€‚</p>\n</blockquote>\n<h4 id=\"åªé‡å†™-equalså¯ä»¥å—ï¼Ÿ\"><a href=\"#åªé‡å†™-equalså¯ä»¥å—ï¼Ÿ\" class=\"headerlink\" title=\"åªé‡å†™ equalså¯ä»¥å—ï¼Ÿ\"></a>åªé‡å†™ equalså¯ä»¥å—ï¼Ÿ</h4><p>å¦‚æœåœ¨é‡å†™ equals æ—¶ï¼Œä¸é‡å†™ hashCodeï¼Œå°±ä¼šå¼•èµ·æ¯”å¦‚è¯´å°†ä¸¤ä¸ªç›¸ç­‰çš„è‡ªå®šä¹‰å¯¹è±¡å­˜å‚¨åœ¨ Set é›†åˆæ—¶ï¼Œä¼šå°†è¿™ä¸¤ä¸ªå¯¹è±¡éƒ½è¿›è¡Œæ’å…¥ã€‚ï¼ˆæ— æ³•å»é‡ï¼‰</p>\n<blockquote>\n<p>å¦‚æœå®šä¹‰ä¸€ä¸ª set é‡Œé¢å­˜æ”¾ Person å¯¹è±¡ï¼ŒPerson åªé‡å†™äº† equals æ–¹æ³•å³å¯ä»¥åˆ¤æ–­å¯¹è±¡å†…å®¹æ˜¯å¦ç›¸åŒã€‚</p>\n<p>å¦‚æœåªé‡å†™äº† equals æ–¹æ³•ï¼Œé‚£ä¹ˆé»˜è®¤æƒ…å†µä¸‹ï¼ŒSet è¿›è¡Œå»é‡æ“ä½œæ—¶ï¼Œä¼šå…ˆåˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡çš„ hashCode æ˜¯å¦ç›¸åŒï¼Œæ­¤æ—¶å› ä¸ºæ²¡æœ‰é‡å†™ hashCode æ–¹æ³•ï¼Œæ‰€ä»¥ä¼šç›´æ¥æ‰§è¡Œ Object ä¸­çš„ hashCode æ–¹æ³•ï¼Œè€Œ Object ä¸­çš„ hashCode æ–¹æ³•å¯¹æ¯”çš„æ˜¯ä¸¤ä¸ªä¸åŒå¼•ç”¨åœ°å€çš„å¯¹è±¡ï¼Œæ‰€ä»¥ç»“æœæ˜¯ falseï¼Œé‚£ä¹ˆ equals æ–¹æ³•å°±ä¸ç”¨æ‰§è¡Œäº†ï¼Œç›´æ¥è¿”å›çš„ç»“æœå°±æ˜¯ falseï¼šä¸¤ä¸ªå¯¹è±¡ä¸æ˜¯ç›¸ç­‰çš„ï¼Œäºæ˜¯å°±åœ¨ Set é›†åˆä¸­æ’å…¥äº†ä¸¤ä¸ªç›¸åŒçš„å¯¹è±¡ã€‚</p>\n<p>ä½†æ˜¯ï¼Œå¦‚æœåœ¨é‡å†™ equals æ–¹æ³•æ—¶ï¼Œä¹Ÿé‡å†™äº† hashCode æ–¹æ³•ï¼Œé‚£ä¹ˆåœ¨æ‰§è¡Œåˆ¤æ–­æ—¶ä¼šå»æ‰§è¡Œé‡å†™çš„ hashCode æ–¹æ³•ï¼Œæ­¤æ—¶å¯¹æ¯”çš„æ˜¯ä¸¤ä¸ªå¯¹è±¡çš„æ‰€æœ‰å±æ€§çš„ hashCode æ˜¯å¦ç›¸åŒï¼Œäºæ˜¯è°ƒç”¨ hashCode è¿”å›çš„ç»“æœå°±æ˜¯ trueï¼Œå†å»è°ƒç”¨ equals æ–¹æ³•ï¼Œå‘ç°ä¸¤ä¸ªå¯¹è±¡ç¡®å®æ˜¯ç›¸ç­‰çš„ï¼Œäºæ˜¯å°±è¿”å› true äº†ï¼Œå› æ­¤ Set é›†åˆå°±ä¸ä¼šå­˜å‚¨ä¸¤ä¸ªä¸€æ¨¡ä¸€æ ·çš„æ•°æ®äº†ï¼Œäºæ˜¯æ•´ä¸ªç¨‹åºçš„æ‰§è¡Œå°±æ­£å¸¸äº†ã€‚</p>\n</blockquote>\n<h3 id=\"å€¼ä¼ é€’\"><a href=\"#å€¼ä¼ é€’\" class=\"headerlink\" title=\"å€¼ä¼ é€’\"></a>å€¼ä¼ é€’</h3><h4 id=\"ä¸ºä»€ä¹ˆ-Java-ä¸­åªæœ‰å€¼ä¼ é€’\"><a href=\"#ä¸ºä»€ä¹ˆ-Java-ä¸­åªæœ‰å€¼ä¼ é€’\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆ Java ä¸­åªæœ‰å€¼ä¼ é€’\"></a>ä¸ºä»€ä¹ˆ Java ä¸­åªæœ‰å€¼ä¼ é€’</h4><p>Java é‡‡ç”¨æŒ‰å€¼è°ƒç”¨ï¼Œæ–¹æ³•å¾—åˆ°çš„æ˜¯æ‰€æœ‰å‚æ•°å€¼çš„ä¸€ä¸ªæ‹·è´ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ–¹æ³•ä¸èƒ½ä¿®æ”¹ä¼ é€’ç»™å®ƒçš„ä»»ä½•å‚æ•°å˜é‡çš„å†…å®¹ã€‚</p>\n<p>example 1</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">num1</span> <span class=\"operator\">=</span> <span class=\"number\">10</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">num2</span> <span class=\"operator\">=</span> <span class=\"number\">20</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    swap(num1, num2);</span><br><span class=\"line\"></span><br><span class=\"line\">    System.out.println(<span class=\"string\">&quot;num1 = &quot;</span> + num1);</span><br><span class=\"line\">    System.out.println(<span class=\"string\">&quot;num2 = &quot;</span> + num2);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">swap</span><span class=\"params\">(<span class=\"type\">int</span> a, <span class=\"type\">int</span> b)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">temp</span> <span class=\"operator\">=</span> a;</span><br><span class=\"line\">    a = b;</span><br><span class=\"line\">    b = temp;</span><br><span class=\"line\"></span><br><span class=\"line\">    System.out.println(<span class=\"string\">&quot;a = &quot;</span> + a);</span><br><span class=\"line\">    System.out.println(<span class=\"string\">&quot;b = &quot;</span> + b);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>ç»“æœ</strong>ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a = <span class=\"number\">20</span></span><br><span class=\"line\">b = <span class=\"number\">10</span></span><br><span class=\"line\">num1 = <span class=\"number\">10</span></span><br><span class=\"line\">num2 = <span class=\"number\">20</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>è§£æ</strong>ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNDAyMzk3Mi00ZWQyZjQ0NTlmN2MyYzkwLmpwZw.png\" alt=\"swap(int a, int b)\"></p>\n<p>åœ¨ swap æ–¹æ³•ä¸­ï¼Œaã€b çš„å€¼è¿›è¡Œäº¤æ¢ï¼Œå¹¶ä¸ä¼šå½±å“åˆ° num1ã€num2ã€‚å› ä¸º aã€b ä¸­çš„å€¼ï¼Œåªæ˜¯ä» num1ã€num2 çš„å¤åˆ¶è¿‡æ¥çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œaã€b ç›¸å½“äº num1ã€num2 çš„å‰¯æœ¬ï¼Œå‰¯æœ¬çš„å†…å®¹æ— è®ºæ€ä¹ˆä¿®æ”¹ï¼Œéƒ½ä¸ä¼šå½±å“åˆ°åŸä»¶æœ¬èº«ã€‚</p>\n<p><strong>é€šè¿‡ä¸Šé¢ä¾‹å­ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“äº†ä¸€ä¸ªæ–¹æ³•ä¸èƒ½ä¿®æ”¹ä¸€ä¸ªåŸºæœ¬æ•°æ®ç±»å‹çš„å‚æ•°ï¼Œè€Œå¯¹è±¡å¼•ç”¨ä½œä¸ºå‚æ•°å°±ä¸ä¸€æ ·ï¼Œè¯·çœ‹ example2.</strong></p>\n<p>example 2</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span>[] arr = &#123; <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span> &#125;;</span><br><span class=\"line\">    System.out.println(arr[<span class=\"number\">0</span>]);</span><br><span class=\"line\">    change(arr);</span><br><span class=\"line\">    System.out.println(arr[<span class=\"number\">0</span>]);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">change</span><span class=\"params\">(<span class=\"type\">int</span>[] array)</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// å°†æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ å˜ä¸º0</span></span><br><span class=\"line\">    array[<span class=\"number\">0</span>] = <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>ç»“æœ</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1</span><br><span class=\"line\">0</span><br></pre></td></tr></table></figure>\n\n<p><strong>è§£æ</strong>ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNDAyMzk3Mi1kYWI5Mzg5ZWRmMjIxNmIzLmpwZw.png\" alt=\"change(int[] array)\"></p>\n<p>array è¢«åˆå§‹åŒ– arr çš„æ‹·è´ä¹Ÿå°±æ˜¯ä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ array å’Œ arr æŒ‡å‘çš„æ—¶åŒä¸€ä¸ªæ•°ç»„å¯¹è±¡ã€‚ å› æ­¤ï¼Œå¤–éƒ¨å¯¹å¼•ç”¨å¯¹è±¡çš„æ”¹å˜ä¼šåæ˜ åˆ°æ‰€å¯¹åº”çš„å¯¹è±¡ä¸Šã€‚</p>\n<p><strong>é€šè¿‡ example2 æˆ‘ä»¬å·²ç»çœ‹åˆ°ï¼Œå®ç°ä¸€ä¸ªæ”¹å˜å¯¹è±¡å‚æ•°çŠ¶æ€çš„æ–¹æ³•å¹¶ä¸æ˜¯ä¸€ä»¶éš¾äº‹ã€‚ç†ç”±å¾ˆç®€å•ï¼Œæ–¹æ³•å¾—åˆ°çš„æ˜¯å¯¹è±¡å¼•ç”¨çš„æ‹·è´ï¼Œå¯¹è±¡å¼•ç”¨åŠå…¶ä»–çš„æ‹·è´åŒæ—¶å¼•ç”¨åŒä¸€ä¸ªå¯¹è±¡ã€‚</strong></p>\n<p>example 3</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Test</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Student</span> <span class=\"variable\">s1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Student</span>(<span class=\"string\">&quot;å°å¼ &quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">Student</span> <span class=\"variable\">s2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Student</span>(<span class=\"string\">&quot;å°æ&quot;</span>);</span><br><span class=\"line\">        Test.swap(s1, s2);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;s1:&quot;</span> + s1.getName());</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;s2:&quot;</span> + s2.getName());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">swap</span><span class=\"params\">(Student x, Student y)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Student</span> <span class=\"variable\">temp</span> <span class=\"operator\">=</span> x;</span><br><span class=\"line\">        x = y;</span><br><span class=\"line\">        y = temp;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;x:&quot;</span> + x.getName());</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;y:&quot;</span> + y.getName());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>ç»“æœ</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">x:å°æ</span><br><span class=\"line\">y:å°å¼ </span><br><span class=\"line\">s1:å°å¼ </span><br><span class=\"line\">s2:å°æ</span><br></pre></td></tr></table></figure>\n\n<p><strong>è§£æ</strong>ï¼š</p>\n<p>äº¤æ¢ä¹‹å‰ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNDAyMzk3Mi03MmIwYzFmYjlmM2IwNzc2LmpwZw.png\" alt=\"before swap(Student x, Student y)\"></p>\n<p>äº¤æ¢ä¹‹åï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNDAyMzk3Mi0zYWUzNzY4NGNiMzg2Njc4LmpwZw.png\" alt=\"after swap(Student x, Student y)\"></p>\n<p>é€šè¿‡ä¸Šé¢ä¸¤å¼ å›¾å¯ä»¥å¾ˆæ¸…æ™°çš„çœ‹å‡ºï¼š <strong>æ–¹æ³•å¹¶æ²¡æœ‰æ”¹å˜å­˜å‚¨åœ¨å˜é‡ s1 å’Œ s2 ä¸­çš„å¯¹è±¡å¼•ç”¨ã€‚swapæ–¹æ³•çš„å‚æ•°xå’Œyè¢«åˆå§‹åŒ–ä¸ºä¸¤ä¸ªå¯¹è±¡å¼•ç”¨çš„æ‹·è´ï¼Œè¿™ä¸ªæ–¹æ³•äº¤æ¢çš„æ˜¯è¿™ä¸¤ä¸ªæ‹·è´</strong></p>\n<h4 id=\"å€¼ä¼ é€’å’Œå¼•ç”¨ä¼ é€’æœ‰ä»€ä¹ˆåŒºåˆ«\"><a href=\"#å€¼ä¼ é€’å’Œå¼•ç”¨ä¼ é€’æœ‰ä»€ä¹ˆåŒºåˆ«\" class=\"headerlink\" title=\"å€¼ä¼ é€’å’Œå¼•ç”¨ä¼ é€’æœ‰ä»€ä¹ˆåŒºåˆ«\"></a>å€¼ä¼ é€’å’Œå¼•ç”¨ä¼ é€’æœ‰ä»€ä¹ˆåŒºåˆ«</h4><p>å€¼ä¼ é€’ï¼šæŒ‡çš„æ˜¯åœ¨æ–¹æ³•è°ƒç”¨æ—¶ï¼Œä¼ é€’çš„å‚æ•°æ˜¯æŒ‰å€¼çš„æ‹·è´ä¼ é€’ï¼Œä¼ é€’çš„æ˜¯å€¼çš„æ‹·è´ï¼Œä¹Ÿå°±æ˜¯è¯´ä¼ é€’åå°±äº’ä¸ç›¸å…³äº†ã€‚</p>\n<p>å¼•ç”¨ä¼ é€’ï¼šæŒ‡çš„æ˜¯åœ¨æ–¹æ³•è°ƒç”¨æ—¶ï¼Œä¼ é€’çš„å‚æ•°æ˜¯æŒ‰å¼•ç”¨è¿›è¡Œä¼ é€’ï¼Œå…¶å®ä¼ é€’çš„å¼•ç”¨çš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯å˜é‡æ‰€å¯¹åº”çš„å†…å­˜ç©ºé—´çš„åœ°å€ã€‚ä¼ é€’çš„æ˜¯å€¼çš„å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ä¼ é€’å‰å’Œä¼ é€’åéƒ½æŒ‡å‘åŒä¸€ä¸ªå¼•ç”¨ï¼ˆä¹Ÿå°±æ˜¯åŒä¸€ä¸ªå†…å­˜ç©ºé—´ï¼‰ã€‚</p>\n<h2 id=\"IOæµ\"><a href=\"#IOæµ\" class=\"headerlink\" title=\"IOæµ\"></a>IOæµ</h2><blockquote>\n<p>å‚è€ƒï¼š<a href=\"https://blog.csdn.net/weixin_44579258/article/details/90758359\">https://blog.csdn.net/weixin_44579258/article/details/90758359</a></p>\n</blockquote>\n<p>é˜»å¡å’Œéé˜»å¡æ˜¯æŒ‡è¿›ç¨‹è®¿é—®çš„æ•°æ®å¦‚æœå°šæœªå‡†å¤‡å°±ç»ªï¼Œè¿›ç¨‹æ˜¯å¦éœ€è¦ç­‰å¾…<br>åŒæ­¥å’Œå¼‚æ­¥æ˜¯æŒ‡è®¿é—®æ•°æ®çš„æœºåˆ¶ï¼ŒåŒæ­¥ä¸€èˆ¬ä¸»åŠ¨è¯·æ±‚ç­‰å¾… IO æ“ä½œå®Œæ¯•çš„æ–¹å¼ã€‚å½“æ•°æ®å°±ç»ªåï¼Œå†è¯»å†™çš„æ—¶å€™å¿…é¡»é˜»å¡ï¼Œå¼‚æ­¥åˆ™ä¸»åŠ¨è¯·æ±‚æ•°æ®åä¾¿å¯ä»¥ç»§ç»­å¤„ç†å…¶ä»–ä»»åŠ¡ï¼Œéšåç­‰å¾… IO å®Œæ¯•é€šçŸ¥ï¼Œè¿™å¯ä»¥ä½¿è¿›ç¨‹åœ¨æ•°æ®è¯»å†™æ—¶ä¹Ÿä¸é˜»å¡</p>\n<p>å‡†å¤‡æ•°æ®ï¼šç½‘å¡ â†’ å†…æ ¸<br>æ•°æ®å°±ç»ªï¼šæ•°æ®æ‹·è´åˆ°äº†å†…æ ¸<br>æ‹·è´æ•°æ®ï¼šå°†å†…æ ¸æ•°æ®æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´</p>\n<h3 id=\"Blocking-I-x2F-O\"><a href=\"#Blocking-I-x2F-O\" class=\"headerlink\" title=\"Blocking I&#x2F;O\"></a>Blocking I&#x2F;O</h3><p><strong>BIO å±äºåŒæ­¥é˜»å¡ IO æ¨¡å‹</strong> ã€‚</p>\n<p>åŒæ­¥é˜»å¡ IO æ¨¡å‹ä¸­ï¼Œåº”ç”¨ç¨‹åº<strong>å‘èµ· read è°ƒç”¨</strong>åï¼Œä¼šä¸€ç›´é˜»å¡ï¼Œç›´åˆ°å†…æ ¸å‡†å¤‡æ•°æ®ã€æ•°æ®å°±ç»ªï¼Œæ•°æ®ä»å†…æ ¸æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes20190603201109632.png\" alt=\"BIO\"></p>\n<h3 id=\"NIO-Non-blocking-I-x2F-O\"><a href=\"#NIO-Non-blocking-I-x2F-O\" class=\"headerlink\" title=\"NIO (Non-blocking I&#x2F;O)\"></a>NIO (Non-blocking I&#x2F;O)</h3><p>åŒæ­¥éé˜»å¡ IO æ¨¡å‹ä¸­ï¼Œç”¨æˆ·è¿›ç¨‹ä¼š<strong>ä¸€ç›´å‘èµ· read è°ƒç”¨</strong>ï¼ˆå¦‚æœå†…æ ¸è¿”å› error åˆ™è¯´æ˜æ•°æ®æœªå‡†å¤‡å°±ç»ªï¼‰ï¼Œç›´åˆ°æ•°æ®å‡†å¤‡å°±ç»ªï¼Œç”¨æˆ·å‘èµ· read è°ƒç”¨æ—¶ï¼Œæ•°æ®ä»å†…æ ¸ç©ºé—´æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´ï¼ˆç”¨æˆ·è¿›ç¨‹æ˜¯é˜»å¡çš„ï¼‰ã€‚</p>\n<blockquote>\n<p>ç›¸æ¯”äºåŒæ­¥é˜»å¡ IO æ¨¡å‹ï¼ŒåŒæ­¥éé˜»å¡ IO æ¨¡å‹ç¡®å®æœ‰äº†å¾ˆå¤§æ”¹è¿›ã€‚é€šè¿‡è½®è¯¢æ“ä½œï¼Œé¿å…äº†ä¸€ç›´é˜»å¡ã€‚</p>\n</blockquote>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes20190603201218527.png\" alt=\"NIO\"></p>\n<h3 id=\"IOå¤šè·¯å¤ç”¨ï¼ˆNIOï¼‰\"><a href=\"#IOå¤šè·¯å¤ç”¨ï¼ˆNIOï¼‰\" class=\"headerlink\" title=\"IOå¤šè·¯å¤ç”¨ï¼ˆNIOï¼‰\"></a>IOå¤šè·¯å¤ç”¨ï¼ˆNIOï¼‰</h3><p>select&#x2F;epoll çš„å¥½å¤„å°±åœ¨äºå•ä¸ª process å°±å¯ä»¥åŒæ—¶å¤„ç†å¤šä¸ªç½‘ç»œè¿æ¥çš„ IOã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes2019060320125821.png\" alt=\"NIO\"></p>\n<p>IO å¤ç”¨å’ŒåŒæ­¥é˜»å¡æœ¬è´¨ä¸€æ ·ï¼Œåœ¨ NIO ä¸­ï¼Œæ¯æ¬¡ç”¨æˆ·è¿›ç¨‹è¿›è¡Œ read è½®è¯¢æ•°æ®æ˜¯å¦å‡†å¤‡å°±ç»ªï¼Œè€Œåœ¨ IO å¤šè·¯å¤ç”¨ä¸­ï¼Œåˆ©ç”¨äº†æ–°çš„ select ç³»ç»Ÿè°ƒç”¨ï¼Œç”±å†…æ ¸æ¥è´Ÿè´£æœ¬æ¥æ˜¯è¯·æ±‚è¿›ç¨‹è¯¥åšçš„è½®è¯¢æ“ä½œã€‚</p>\n<p>å½“ç”¨æˆ·çº¿ç¨‹è°ƒç”¨ selectï¼Œé‚£ä¹ˆæ•´ä¸ªè¿›ç¨‹ä¼šè¢«é˜»å¡ï¼Œè€ŒåŒæ—¶ï¼Œkernel å†…æ ¸ä¼šâ€œç›‘è§†â€æ‰€æœ‰ select è´Ÿè´£çš„ socketï¼Œå½“ä»»ä½•ä¸€ä¸ª socket ä¸­çš„æ•°æ®å‡†å¤‡å¥½äº†ï¼Œselect å°±ä¼šè¿”å›å¯è¯»æ¡ä»¶è®©ç”¨æˆ·è¿›ç¨‹å‘èµ· read è°ƒç”¨ï¼Œç”¨æˆ·è¿›ç¨‹å‘èµ·è°ƒç”¨ read æ“ä½œï¼Œå°†æ•°æ®ä»å†…æ ¸ç©ºé—´æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´ã€‚</p>\n<h3 id=\"Asynchronous-I-x2F-O\"><a href=\"#Asynchronous-I-x2F-O\" class=\"headerlink\" title=\"Asynchronous I&#x2F;O\"></a>Asynchronous I&#x2F;O</h3><p>å¼‚æ­¥ IO æ˜¯åŸºäºäº‹ä»¶å’Œå›è°ƒæœºåˆ¶å®ç°çš„ï¼Œä¹Ÿå°±æ˜¯åº”ç”¨æ“ä½œä¹‹åä¼šç›´æ¥è¿”å›ï¼Œä¸ä¼šå µå¡åœ¨é‚£é‡Œï¼Œå½“åå°å¤„ç†å®Œæˆï¼Œæ“ä½œç³»ç»Ÿä¼šé€šçŸ¥ç›¸åº”çš„çº¿ç¨‹è¿›è¡Œåç»­çš„æ“ä½œã€‚</p>\n<p>ç”¨æˆ·å‘èµ· read è°ƒç”¨ï¼Œæ­¤æ—¶ç”¨æˆ·è¿›ç¨‹ä¸ä¼šé˜»å¡ã€‚å†…æ ¸å°†æ•°æ®å‡†å¤‡å°±ç»ªå¹¶å°†å…¶ä»å†…æ ¸æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´åï¼Œå†…æ ¸ç»™ç”¨æˆ·è¿›ç¨‹å‘é€ä¸€ä¸ªä¿¡å·ç»™ä¹‹å‰è°ƒç”¨ read çš„è¿›ç¨‹ï¼Œæ•°æ®å·²ç»æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´äº†ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes2019060320135956.png\" alt=\"AIO\"></p>\n<h2 id=\"åå°„\"><a href=\"#åå°„\" class=\"headerlink\" title=\"åå°„\"></a>åå°„</h2><h3 id=\"ä»€ä¹ˆæ˜¯åå°„æœºåˆ¶ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯åå°„æœºåˆ¶ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯åå°„æœºåˆ¶ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯åå°„æœºåˆ¶ï¼Ÿ</h3><p>JAVA åå°„æœºåˆ¶æ˜¯åœ¨è¿è¡ŒçŠ¶æ€ä¸­ï¼Œå¯¹äºä»»æ„ä¸€ä¸ªç±»ï¼Œéƒ½èƒ½å¤ŸçŸ¥é“è¿™ä¸ªç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼›å¯¹äºä»»æ„ä¸€ä¸ªå¯¹è±¡ï¼Œéƒ½èƒ½å¤Ÿè°ƒç”¨å®ƒçš„ä»»æ„ä¸€ä¸ªæ–¹æ³•å’Œå±æ€§ï¼›è¿™ç§åŠ¨æ€è·å–çš„ä¿¡æ¯ä»¥åŠåŠ¨æ€è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•çš„åŠŸèƒ½ç§°ä¸º Java è¯­è¨€çš„åå°„æœºåˆ¶ã€‚</p>\n<h3 id=\"åå°„æœºåˆ¶ä¼˜ç¼ºç‚¹\"><a href=\"#åå°„æœºåˆ¶ä¼˜ç¼ºç‚¹\" class=\"headerlink\" title=\"åå°„æœºåˆ¶ä¼˜ç¼ºç‚¹\"></a>åå°„æœºåˆ¶ä¼˜ç¼ºç‚¹</h3><ul>\n<li><strong>ä¼˜ç‚¹ï¼š</strong> è¿è¡ŒæœŸç±»å‹çš„åˆ¤æ–­ï¼ŒåŠ¨æ€åŠ è½½ç±»ï¼Œæé«˜ä»£ç çµæ´»åº¦ã€‚</li>\n<li><strong>ç¼ºç‚¹ï¼š</strong> æ€§èƒ½ç“¶é¢ˆï¼šåå°„ç›¸å½“äºä¸€ç³»åˆ—è§£é‡Šæ“ä½œï¼Œé€šçŸ¥ JVM è¦åšçš„äº‹æƒ…ï¼Œæ€§èƒ½æ¯”ç›´æ¥çš„ Java ä»£ç è¦æ…¢å¾ˆå¤šã€‚</li>\n</ul>\n<h3 id=\"åå°„æœºåˆ¶çš„åº”ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ\"><a href=\"#åå°„æœºåˆ¶çš„åº”ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ\" class=\"headerlink\" title=\"åå°„æœºåˆ¶çš„åº”ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ\"></a>åå°„æœºåˆ¶çš„åº”ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ</h3><p>â‘ æˆ‘ä»¬åœ¨ä½¿ç”¨ JDBC è¿æ¥æ•°æ®åº“æ—¶ä½¿ç”¨ Class.forName()é€šè¿‡åå°„åŠ è½½æ•°æ®åº“çš„é©±åŠ¨ç¨‹åºï¼›</p>\n<p>â‘¡Spring é€šè¿‡ XML é…ç½®æ¨¡å¼è£…è½½ Bean çš„è¿‡ç¨‹</p>\n<ol>\n<li>åŠ è½½é…ç½®æ–‡ä»¶ï¼Œè§£ææˆ BeanDefinition æ”¾åœ¨ Map é‡Œï¼Œmap ä¸­å­˜æ”¾<code>&lt;BeanNameï¼ŒClasså¯¹è±¡&gt;</code>çš„æ˜ å°„</li>\n<li>è°ƒç”¨ getBean çš„æ—¶å€™ï¼Œä» BeanDefinition æ‰€å±çš„ Map é‡Œï¼Œæ‹¿å‡º Class å¯¹è±¡ä½¿ç”¨åå°„è¿›è¡Œå®ä¾‹åŒ–ï¼ŒåŒæ—¶ï¼Œå¦‚æœæœ‰ä¾èµ–å…³ç³»ï¼Œå°†é€’å½’è°ƒç”¨ getBean æ–¹æ³• â€”â€” å®Œæˆä¾èµ–æ³¨å…¥</li>\n</ol>\n<h3 id=\"Javaè·å–åå°„çš„ä¸‰ç§æ–¹æ³•\"><a href=\"#Javaè·å–åå°„çš„ä¸‰ç§æ–¹æ³•\" class=\"headerlink\" title=\"Javaè·å–åå°„çš„ä¸‰ç§æ–¹æ³•\"></a>Javaè·å–åå°„çš„ä¸‰ç§æ–¹æ³•</h3><p>1.é€šè¿‡ new å¯¹è±¡å®ç°åå°„æœºåˆ¶ 2.é€šè¿‡è·¯å¾„å®ç°åå°„æœºåˆ¶ 3.é€šè¿‡ç±»åå®ç°åå°„æœºåˆ¶</p>\n<h2 id=\"åŒ…è£…ç±»\"><a href=\"#åŒ…è£…ç±»\" class=\"headerlink\" title=\"åŒ…è£…ç±»\"></a>åŒ…è£…ç±»</h2><h4 id=\"è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±\"><a href=\"#è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±\" class=\"headerlink\" title=\"è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±\"></a>è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±</h4><p><strong>è£…ç®±</strong>ï¼šå°†åŸºæœ¬ç±»å‹ç”¨å®ƒä»¬å¯¹åº”çš„å¼•ç”¨ç±»å‹åŒ…è£…èµ·æ¥ï¼›<code>Integer a = 1;</code></p>\n<p><strong>æ‹†ç®±</strong>ï¼šå°†åŒ…è£…ç±»å‹è½¬æ¢ä¸ºåŸºæœ¬æ•°æ®ç±»å‹ï¼›<code>int b = a;</code></p>\n<h4 id=\"int-å’Œ-Integer-æœ‰ä»€ä¹ˆåŒºåˆ«\"><a href=\"#int-å’Œ-Integer-æœ‰ä»€ä¹ˆåŒºåˆ«\" class=\"headerlink\" title=\"int å’Œ Integer æœ‰ä»€ä¹ˆåŒºåˆ«\"></a>int å’Œ Integer æœ‰ä»€ä¹ˆåŒºåˆ«</h4><p>å¼•å…¥åŒ…è£…ç±»æ˜¯ä¸ºäº†èƒ½å¤Ÿå°†è¿™äº›<strong>åŸºæœ¬æ•°æ®ç±»å‹å½“æˆå¯¹è±¡æ“ä½œ</strong></p>\n<p>Java ä¸ºæ¯ä¸ªåŸå§‹ç±»å‹æä¾›äº†åŒ…è£…ç±»å‹ï¼š</p>\n<p>åŸå§‹ç±»å‹: booleanï¼Œcharï¼Œbyteï¼Œshortï¼Œintï¼Œlongï¼Œfloatï¼Œdouble</p>\n<p>åŒ…è£…ç±»å‹ï¼šBooleanï¼ŒCharacterï¼ŒByteï¼ŒShortï¼ŒIntegerï¼ŒLongï¼ŒFloatï¼ŒDouble</p>\n<h4 id=\"Integer-a-x3D-127-ä¸-Integer-b-x3D-127ç›¸ç­‰å—\"><a href=\"#Integer-a-x3D-127-ä¸-Integer-b-x3D-127ç›¸ç­‰å—\" class=\"headerlink\" title=\"Integer a &#x3D; 127 ä¸ Integer b &#x3D; 127ç›¸ç­‰å—\"></a>Integer a &#x3D; 127 ä¸ Integer b &#x3D; 127ç›¸ç­‰å—</h4><blockquote>\n<p>åŒ…è£…ç±»å’ŒåŸºæœ¬æ•°æ®ç±»å‹æ¯”è¾ƒï¼Œä¼šå°†åŒ…è£…ç±»æ‹†ç®±æˆåŸºæœ¬æ•°æ®ç±»å‹ç„¶åæ¯”è¾ƒï¼Œ</p>\n<p>åªæœ‰å½“åŒ…è£…ç±»æ˜¯è‡ªåŠ¨è£…ç®±ï¼Œå¹¶ä¸”æ•°å€¼èŒƒå›´åœ¨ [-128, 127] æ—¶ï¼Œæ‰ä¼šä½¿ç”¨ cache ä¸­çš„å¯¹è±¡ã€‚</p>\n</blockquote>\n<p>å¯¹äºå¯¹è±¡å¼•ç”¨ç±»å‹ï¼š&#x3D;&#x3D;æ¯”è¾ƒçš„æ˜¯å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚<br>å¯¹äºåŸºæœ¬æ•°æ®ç±»å‹ï¼š&#x3D;&#x3D;æ¯”è¾ƒçš„æ˜¯å€¼ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">Integer</span> <span class=\"variable\">a</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Integer</span>(<span class=\"number\">3</span>);</span><br><span class=\"line\">  \t<span class=\"type\">Integer</span> <span class=\"variable\">b</span> <span class=\"operator\">=</span> <span class=\"number\">3</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">c</span> <span class=\"operator\">=</span> <span class=\"number\">3</span>;</span><br><span class=\"line\">    <span class=\"type\">Integer</span> <span class=\"variable\">d</span> <span class=\"operator\">=</span> <span class=\"number\">3</span>;</span><br><span class=\"line\">    System.out.println(a == b); <span class=\"comment\">// falseï¼Œä¸¤ä¸ªå¯¹è±¡æ¯”è¾ƒ</span></span><br><span class=\"line\">    System.out.println(a == c); <span class=\"comment\">// trueï¼Œaè‡ªåŠ¨æ‹†ç®±</span></span><br><span class=\"line\">    System.out.println(b == c); <span class=\"comment\">// trueï¼Œbè‡ªåŠ¨æ‹†ç®±</span></span><br><span class=\"line\">    System.out.println(b == d); <span class=\"comment\">// trueï¼ŒåŒ…è£…ç±»è‡ªåŠ¨è£…ç®±ä¸”æ•°å€¼èŒƒå›´åœ¨cacheèŒƒå›´å†…</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"type\">Integer</span> <span class=\"variable\">a</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Integer</span>(<span class=\"number\">128</span>);</span><br><span class=\"line\">    <span class=\"type\">Integer</span> <span class=\"variable\">b</span> <span class=\"operator\">=</span> <span class=\"number\">128</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">c</span> <span class=\"operator\">=</span> <span class=\"number\">128</span>;</span><br><span class=\"line\">    <span class=\"type\">Integer</span> <span class=\"variable\">d</span> <span class=\"operator\">=</span> <span class=\"number\">128</span>;</span><br><span class=\"line\">    System.out.println(a == b); <span class=\"comment\">// falseï¼Œä¸¤ä¸ªå¯¹è±¡æ¯”è¾ƒ</span></span><br><span class=\"line\">    System.out.println(a == c); <span class=\"comment\">// trueï¼Œaè‡ªåŠ¨æ‹†ç®±</span></span><br><span class=\"line\">    System.out.println(b == c); <span class=\"comment\">// trueï¼Œbè‡ªåŠ¨æ‹†ç®±</span></span><br><span class=\"line\">    System.out.println(b == d); <span class=\"comment\">// falseï¼ŒåŒ…è£…ç±»è‡ªåŠ¨è£…ç®±ä½†æ˜¯æ•°å€¼èŒƒå›´ä¸åœ¨cacheèŒƒå›´å†…</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"Javaå…«è‚¡æ–‡ - Javaå¼‚å¸¸","copyright":true,"mathjax":false,"date":"2023-01-23T02:06:31.000Z","toc":true,"urlname":"java-exception-error","_content":"\n> æ•´ç†çš„Javaå¼‚å¸¸ç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½\t<!--more-->\n\n## Javaå¼‚å¸¸æ¶æ„\n\n![Javaå¼‚å¸¸æ¶æ„](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes20200314173417278.png)\n\n### 1. Throwable\n\nThrowable æ˜¯ Java è¯­è¨€ä¸­æ‰€æœ‰é”™è¯¯ä¸å¼‚å¸¸çš„è¶…ç±»ã€‚\n\nThrowable åŒ…å«ä¸¤ä¸ªå­ç±»ï¼šErrorï¼ˆé”™è¯¯ï¼‰å’Œ Exceptionï¼ˆå¼‚å¸¸ï¼‰ï¼Œå®ƒä»¬é€šå¸¸ç”¨äºæŒ‡ç¤ºå‘ç”Ÿäº†å¼‚å¸¸æƒ…å†µã€‚\n\n### 2. Errorï¼ˆé”™è¯¯ï¼‰\n\nError ç±»åŠå…¶å­ç±»ã€‚ç¨‹åºä¸­æ— æ³•å¤„ç†çš„é”™è¯¯ï¼Œè¡¨ç¤ºè¿è¡Œåº”ç”¨ç¨‹åºä¸­å‡ºç°äº†ä¸¥é‡çš„é”™è¯¯ã€‚\n\néå—æ£€å¼‚å¸¸ï¼Œä¸€èˆ¬è¡¨ç¤ºä»£ç è¿è¡Œæ—¶ JVM å‡ºç°é—®é¢˜ã€‚æ¯”å¦‚ OutOfMemoryErrorï¼šå†…å­˜ä¸è¶³é”™è¯¯ï¼›StackOverflowErrorï¼šæ ˆæº¢å‡ºé”™è¯¯ã€‚æ­¤ç±»é”™è¯¯å‘ç”Ÿæ—¶ï¼ŒJVM å°†ç»ˆæ­¢çº¿ç¨‹ã€‚\n\n### 3. Exceptionï¼ˆå¼‚å¸¸ï¼‰\n\nç¨‹åºæœ¬èº«å¯ä»¥æ•è·å¹¶ä¸”å¯ä»¥å¤„ç†çš„å¼‚å¸¸ã€‚Exception è¿™ç§å¼‚å¸¸åˆåˆ†ä¸ºä¸¤ç±»ï¼šè¿è¡Œæ—¶å¼‚å¸¸å’Œç¼–è¯‘æ—¶å¼‚å¸¸ã€‚\n\n#### è¿è¡Œæ—¶å¼‚å¸¸\n\nException ä¸­ RuntimeException ç±»åŠå…¶å­ç±»ï¼Œè¡¨ç¤º JVM åœ¨è¿è¡ŒæœŸé—´å¯èƒ½å‡ºç°çš„å¼‚å¸¸ã€‚ï¼ˆéå—æ£€å¼‚å¸¸ï¼Œç¼–è¯‘æ—¶ä¸ä¼šæ£€æŸ¥å‡ºå¼‚å¸¸ï¼Œè¿è¡Œæ—¶ä¼šå‘ç”Ÿå¼‚å¸¸ï¼Œéœ€è¦å¯¹å¼‚å¸¸è¿›è¡Œç‰¹æ®Šå¤„ç†ï¼Œå¦åˆ™ä¼šå‘ç”Ÿé€»è¾‘é”™è¯¯ï¼‰\n\n#### ç¼–è¯‘æ—¶å¼‚å¸¸\n\nException ä¸­é™¤ RuntimeException åŠå…¶å­ç±»ä¹‹å¤–çš„å¼‚å¸¸ã€‚ï¼ˆå—æ£€å¼‚å¸¸ï¼Œç¼–è¯‘æ—¶ä¼šæ£€æŸ¥åˆ°è¯¥å¼‚å¸¸ ï¼‰\n\n## Javaå¼‚å¸¸å…³é”®å­—\n\nâ€¢ **try** â€“ ç”¨äºç›‘å¬ã€‚å°†è¦è¢«ç›‘å¬çš„ä»£ï¼ˆå¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„ä»£ç ï¼‰æ”¾åœ¨ try è¯­å¥å—ä¹‹å†…ï¼Œå½“ try è¯­å¥å—å†…å‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œå¼‚å¸¸å°±è¢«æŠ›å‡ºã€‚\nâ€¢ **catch** â€“ ç”¨äºæ•è·å¼‚å¸¸ã€‚catch ç”¨æ¥æ•è· try è¯­å¥å—ä¸­å‘ç”Ÿçš„å¼‚å¸¸ã€‚\nâ€¢ **finally** â€“ finally è¯­å¥å—æ€»æ˜¯ä¼šè¢«æ‰§è¡Œã€‚å®ƒä¸»è¦ç”¨äºå›æ”¶åœ¨ try å—é‡Œæ‰“å¼€çš„èµ„æº(å¦‚æ•°æ®åº“è¿æ¥ã€ç½‘ç»œè¿æ¥å’Œç£ç›˜æ–‡ä»¶)ã€‚\nâ€¢ **throw** â€“ ç”¨äºæ‰‹åŠ¨æŠ›å‡º catch åˆ°çš„å¼‚å¸¸ã€‚\nâ€¢ **throws** â€“ ç”¨åœ¨æ–¹æ³•ç­¾åä¸­ï¼Œç”¨äºå£°æ˜è¯¥æ–¹æ³•å¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸ï¼Œè°ƒç”¨è¯¥æ–¹æ³•çš„æ–¹æ³•éœ€è¦æ³¨æ„ catch è¿™ä¸ªå¯èƒ½è·‘å‡ºçš„å¼‚å¸¸ã€‚\n\n## Javaå¼‚å¸¸å¤„ç†\n\n### ç›´æ¥æŠ›å‡ºå¼‚å¸¸\n\né€šå¸¸ï¼Œåº”è¯¥æ•è·é‚£äº›çŸ¥é“å¦‚ä½•å¤„ç†çš„å¼‚å¸¸ï¼Œå°†ä¸çŸ¥é“å¦‚ä½•å¤„ç†çš„å¼‚å¸¸ç»§ç»­ä¼ é€’ä¸‹å»ã€‚ä¼ é€’å¼‚å¸¸å¯ä»¥åœ¨æ–¹æ³•ç­¾åå¤„ä½¿ç”¨ **throws** å…³é”®å­—å£°æ˜å¯èƒ½ä¼šæŠ›å‡ºçš„å¼‚å¸¸ã€‚è°ƒç”¨è¯¥æ–¹æ³•çš„æ–¹æ³•éœ€è¦æ³¨æ„ catch è¿™ä¸ªå¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸ã€‚\n\n```java\nprivate static void readFile(String filePath) throws IOException {\n    File file = new File(filePath);\n    String result;\n    BufferedReader reader = new BufferedReader(new FileReader(file));\n    while((result = reader.readLine())!=null) {\n        System.out.println(result);\n    }\n    reader.close();\n}\n```\n\n### å°è£…å¼‚å¸¸å†æŠ›å‡º\n\næœ‰æ—¶æˆ‘ä»¬ä¼šä» catch ä¸­æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œç›®çš„æ˜¯ä¸ºäº†æ”¹å˜å¼‚å¸¸çš„ç±»å‹ã€‚å¤šç”¨äºåœ¨å¤šç³»ç»Ÿé›†æˆæ—¶ï¼Œå½“æŸä¸ªå­ç³»ç»Ÿæ•…éšœï¼Œå¼‚å¸¸ç±»å‹å¯èƒ½æœ‰å¤šç§ï¼Œå¯ä»¥ç”¨ç»Ÿä¸€çš„å¼‚å¸¸ç±»å‹å‘å¤–æš´éœ²ï¼Œä¸éœ€æš´éœ²å¤ªå¤šå†…éƒ¨å¼‚å¸¸ç»†èŠ‚ã€‚\n\n```java\nprivate static void readFile(String filePath) throws MyException {    \n    try {\n        // code\n    } catch (IOException e) {\n        MyException ex = new MyException(\"read file failed.\");\n        ex.initCause(e);\n        throw ex;\n    }\n}\n```\n\n### æ•è·å¼‚å¸¸\n\nåœ¨ä¸€ä¸ª try-catch è¯­å¥å—ä¸­å¯ä»¥æ•è·å¤šä¸ªå¼‚å¸¸ç±»å‹ï¼Œå¹¶å¯¹ä¸åŒç±»å‹çš„å¼‚å¸¸åšå‡ºä¸åŒçš„å¤„ç†\n\n```java\nprivate static void readFile(String filePath) {\n    try {\n        // code\n    } catch (FileNotFoundException e) {\n        // handle FileNotFoundException\n    } catch (IOException e){\n        // handle IOException\n    }\n}\n```\n\nåŒä¸€ä¸ª catch ä¹Ÿå¯ä»¥æ•è·å¤šç§ç±»å‹å¼‚å¸¸ï¼Œç”¨ | éš”å¼€\n\n```java\nprivate static void readFile(String filePath) {\n    try {\n        // code\n    } catch (FileNotFoundException | UnknownHostException e) {\n        // handle FileNotFoundException or UnknownHostException\n    } catch (IOException e){\n        // handle IOException\n    }\n}\n```\n\n### è‡ªå®šä¹‰å¼‚å¸¸\n\nä¹ æƒ¯ä¸Šï¼Œå®šä¹‰ä¸€ä¸ªå¼‚å¸¸ç±»åº”åŒ…å«ä¸¤ä¸ªæ„é€ å‡½æ•°ï¼Œä¸€ä¸ªæ— å‚æ„é€ å‡½æ•°å’Œä¸€ä¸ªå¸¦æœ‰è¯¦ç»†æè¿°ä¿¡æ¯çš„æ„é€ å‡½æ•°ï¼ˆThrowable çš„ toString æ–¹æ³•ä¼šæ‰“å°è¿™äº›è¯¦ç»†ä¿¡æ¯ï¼Œè°ƒè¯•æ—¶å¾ˆæœ‰ç”¨ï¼‰\n\n```java\npublic class MyException extends Exception {\n    public MyException(){ }\n    public MyException(String msg){\n        super(msg);\n    }\n    // ...\n}\n```\n\n## Javaå¼‚å¸¸å¸¸è§é¢è¯•é¢˜\n\n### 1. Error å’Œ Exception åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\n\nError ç±»å‹çš„é”™è¯¯é€šå¸¸ä¸ºè™šæ‹Ÿæœºç›¸å…³é”™è¯¯ï¼Œå¦‚ç³»ç»Ÿå´©æºƒï¼Œå†…å­˜ä¸è¶³ï¼Œå †æ ˆæº¢å‡ºç­‰ï¼Œç¼–è¯‘å™¨ä¸ä¼šå¯¹è¿™ç±»é”™è¯¯è¿›è¡Œæ£€æµ‹ï¼ŒJava åº”ç”¨ç¨‹åºä¹Ÿä¸åº”å¯¹è¿™ç±»é”™è¯¯è¿›è¡Œæ•è·ï¼Œä¸€æ—¦è¿™ç±»é”™è¯¯å‘ç”Ÿï¼Œé€šå¸¸åº”ç”¨ç¨‹åºä¼šè¢«ç»ˆæ­¢ï¼Œä»…é åº”ç”¨ç¨‹åºæœ¬èº«æ— æ³•æ¢å¤ï¼›\n\nException ç±»çš„é”™è¯¯æ˜¯å¯ä»¥åœ¨åº”ç”¨ç¨‹åºä¸­è¿›è¡Œæ•è·å¹¶å¤„ç†çš„ï¼Œé€šå¸¸é‡åˆ°è¿™ç§é”™è¯¯ï¼Œåº”å¯¹å…¶è¿›è¡Œå¤„ç†ï¼Œä½¿åº”ç”¨ç¨‹åºå¯ä»¥ç»§ç»­æ­£å¸¸è¿è¡Œã€‚\n\n### 2. è¿è¡Œæ—¶å¼‚å¸¸å’Œä¸€èˆ¬å¼‚å¸¸(å—æ£€å¼‚å¸¸)åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\n\nè¿è¡Œæ—¶å¼‚å¸¸åŒ…æ‹¬ RuntimeException ç±»åŠå…¶å­ç±»ï¼Œè¡¨ç¤º JVM åœ¨è¿è¡ŒæœŸé—´å¯èƒ½å‡ºç°çš„å¼‚å¸¸ã€‚ Java ç¼–è¯‘å™¨ä¸ä¼šæ£€æŸ¥è¿è¡Œæ—¶å¼‚å¸¸ã€‚\n\nå—æ£€å¼‚å¸¸æ˜¯ Exception ä¸­é™¤ RuntimeException åŠå…¶å­ç±»ä¹‹å¤–çš„å¼‚å¸¸ã€‚ Java ç¼–è¯‘å™¨ä¼šæ£€æŸ¥å—æ£€å¼‚å¸¸ã€‚\n\n**RuntimeExceptionå¼‚å¸¸å’Œå—æ£€å¼‚å¸¸ä¹‹é—´çš„åŒºåˆ«**ï¼šæ˜¯å¦å¼ºåˆ¶è¦æ±‚è°ƒç”¨è€…å¿…é¡»å¤„ç†æ­¤å¼‚å¸¸ï¼Œå¦‚æœå¼ºåˆ¶è¦æ±‚è°ƒç”¨è€…å¿…é¡»è¿›è¡Œå¤„ç†ï¼Œé‚£ä¹ˆå°±ä½¿ç”¨å—æ£€å¼‚å¸¸ï¼Œå¦åˆ™å°±é€‰æ‹©éå—æ£€å¼‚å¸¸(RuntimeException)ã€‚ä¸€èˆ¬æ¥è®²ï¼Œå¦‚æœæ²¡æœ‰ç‰¹æ®Šçš„è¦æ±‚ï¼Œæˆ‘ä»¬å»ºè®®ä½¿ç”¨ RuntimeException å¼‚å¸¸ã€‚\n\n### 3. JVM æ˜¯å¦‚ä½•å¤„ç†å¼‚å¸¸çš„ï¼Ÿ\n\nåœ¨ä¸€ä¸ªæ–¹æ³•ä¸­å¦‚æœå‘ç”Ÿå¼‚å¸¸ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šåˆ›å»ºä¸€ä¸ªå¼‚å¸¸å¯¹è±¡ï¼Œå¹¶è½¬äº¤ç»™ JVMï¼Œè¯¥å¼‚å¸¸å¯¹è±¡åŒ…å«å¼‚å¸¸åç§°ï¼Œå¼‚å¸¸æè¿°ä»¥åŠå¼‚å¸¸å‘ç”Ÿæ—¶åº”ç”¨ç¨‹åºçš„çŠ¶æ€ã€‚åˆ›å»ºå¼‚å¸¸å¯¹è±¡å¹¶è½¬äº¤ç»™ JVM çš„è¿‡ç¨‹ç§°ä¸ºæŠ›å‡ºå¼‚å¸¸ã€‚å¯èƒ½æœ‰ä¸€ç³»åˆ—çš„æ–¹æ³•è°ƒç”¨ï¼Œæœ€ç»ˆæ‰è¿›å…¥æŠ›å‡ºå¼‚å¸¸çš„æ–¹æ³•ï¼Œè¿™ä¸€ç³»åˆ—æ–¹æ³•è°ƒç”¨çš„æœ‰åºåˆ—è¡¨å«åšè°ƒç”¨æ ˆã€‚\n\nJVM ä¼šé¡ºç€è°ƒç”¨æ ˆå»æŸ¥æ‰¾çœ‹æ˜¯å¦æœ‰å¯ä»¥å¤„ç†å¼‚å¸¸çš„ä»£ç ï¼Œå¦‚æœæœ‰ï¼Œåˆ™è°ƒç”¨å¼‚å¸¸å¤„ç†ä»£ç ã€‚å½“ JVM å‘ç°å¯ä»¥å¤„ç†å¼‚å¸¸çš„ä»£ç æ—¶ï¼Œä¼šæŠŠå‘ç”Ÿçš„å¼‚å¸¸ä¼ é€’ç»™å®ƒã€‚å¦‚æœ JVM æ²¡æœ‰æ‰¾åˆ°å¯ä»¥å¤„ç†è¯¥å¼‚å¸¸çš„ä»£ç å—ï¼ŒJVM å°±ä¼šå°†è¯¥å¼‚å¸¸è½¬äº¤ç»™é»˜è®¤çš„å¼‚å¸¸å¤„ç†å™¨ï¼ˆé»˜è®¤å¤„ç†å™¨ä¸º JVM çš„ä¸€éƒ¨åˆ†ï¼‰ï¼Œé»˜è®¤å¼‚å¸¸å¤„ç†å™¨æ‰“å°å‡ºå¼‚å¸¸ä¿¡æ¯å¹¶ç»ˆæ­¢åº”ç”¨ç¨‹åºã€‚\n\n### 4. throw å’Œ throws çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\n\nJava ä¸­çš„å¼‚å¸¸å¤„ç†é™¤äº†åŒ…æ‹¬æ•è·å¼‚å¸¸å’Œå¤„ç†å¼‚å¸¸ä¹‹å¤–ï¼Œè¿˜åŒ…æ‹¬å£°æ˜å¼‚å¸¸å’Œæ‹‹å‡ºå¼‚å¸¸ï¼Œå¯ä»¥é€šè¿‡ throws å…³é”®å­—åœ¨æ–¹æ³•ä¸Šå£°æ˜è¯¥æ–¹æ³•è¦æ‹‹å‡ºçš„å¼‚å¸¸ï¼Œæˆ–è€…åœ¨æ–¹æ³•å†…éƒ¨é€šè¿‡ throw æ‹‹å‡ºå¼‚å¸¸å¯¹è±¡ã€‚\n\n**throws å…³é”®å­—å’Œ throw å…³é”®å­—åœ¨ä½¿ç”¨ä¸Šçš„å‡ ç‚¹åŒºåˆ«å¦‚ä¸‹**ï¼š\n\n- throw å…³é”®å­—ç”¨åœ¨æ–¹æ³•å†…éƒ¨ï¼Œåªèƒ½ç”¨äºæŠ›å‡ºä¸€ç§å¼‚å¸¸ï¼Œç”¨æ¥æŠ›å‡ºæ–¹æ³•æˆ–ä»£ç å—ä¸­çš„å¼‚å¸¸ï¼Œå—æŸ¥å¼‚å¸¸å’Œéå—æŸ¥å¼‚å¸¸éƒ½å¯ä»¥è¢«æŠ›å‡ºã€‚\n- throws å…³é”®å­—ç”¨åœ¨æ–¹æ³•å£°æ˜ä¸Šï¼Œå¯ä»¥æŠ›å‡ºå¤šä¸ªå¼‚å¸¸ï¼Œç”¨æ¥æ ‡è¯†è¯¥æ–¹æ³•å¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸åˆ—è¡¨ã€‚ä¸€ä¸ªæ–¹æ³•ç”¨ throws æ ‡è¯†äº†å¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸åˆ—è¡¨ï¼Œè°ƒç”¨è¯¥æ–¹æ³•çš„æ–¹æ³•ä¸­å¿…é¡»åŒ…å«å¯å¤„ç†å¼‚å¸¸çš„ä»£ç ï¼Œå¦åˆ™ä¹Ÿè¦åœ¨æ–¹æ³•ç­¾åä¸­ç”¨ throws å…³é”®å­—å£°æ˜ç›¸åº”çš„å¼‚å¸¸ã€‚\n\n### 5. try-catch-finally ä¸­ï¼Œå¦‚æœ catch ä¸­ return äº†ï¼Œfinally è¿˜ä¼šæ‰§è¡Œå—ï¼Ÿ\n\n**ç­”ï¼šä¼šæ‰§è¡Œï¼Œåœ¨ return å‰æ‰§è¡Œã€‚**\n\n**ä»£ç ç¤ºä¾‹1ï¼š**\n\n```java\npublic static int getInt() {\n    int a = 10;\n    try {\n        System.out.println(a / 0);\n        a = 20;\n    } catch (ArithmeticException e) {\n        a = 30;\n        return a;\t// ä¸ä¼šç›´æ¥returnï¼Œå…ˆæ‰§è¡Œfinallyï¼Œfinallyæ‰§è¡Œè¿‡åå›æ¥æ‰§è¡Œreturn a\n    } finally {\n        a = 40;\n    }\n\treturn a;\n}\n```\n\næ‰§è¡Œç»“æœï¼š30\n\n**ä»£ç ç¤ºä¾‹2ï¼š**\n\n```java\npublic static int getInt() {\n    int a = 10;\n    try {\n        System.out.println(a / 0);\n        a = 20;\n    } catch (ArithmeticException e) {\n        a = 30;\n        return a;\t// ä¸ä¼šç›´æ¥returnï¼Œå…ˆæ‰§è¡Œfinally\n    } finally {\n        a = 40;\n        return a;\t// finallyä¸­æœ‰returnå°±ç›´æ¥returnäº†\n    }\n}\n```\n\næ‰§è¡Œç»“æœï¼š40\n\n### 6. ç±» ExampleA ç»§æ‰¿ Exceptionï¼Œç±» ExampleB ç»§æ‰¿ExampleAã€‚\n\n```java\npublic class ExceptionA extends Exception {\n    public ExceptionA(String message) {\n        super(message);\n    }\n}\npublic class ExceptionB extends ExceptionA {\n    public ExceptionB(String message) {\n        super(message);\n    }\n}\n\ntry {\n  throw new ExceptionB(\"a\");\n} catch (ExceptionA ea) {\n  System.out.println(\"ExceptionA\");\n} catch (Exception e) {\n  System.out.println(\"Exception\");\n}\n```\n\nè¾“å‡ºï¼šExampleAã€‚ï¼ˆæ ¹æ®é‡Œæ°ä»£æ¢åŸåˆ™[èƒ½ä½¿ç”¨çˆ¶ç±»å‹çš„åœ°æ–¹ä¸€å®šèƒ½ä½¿ç”¨å­ç±»å‹]ï¼ŒæŠ“å– ExceptionA ç±»å‹å¼‚å¸¸çš„ catch å—èƒ½å¤ŸæŠ“ä½ try å—ä¸­æŠ›å‡ºçš„ ExceptionB ç±»å‹çš„å¼‚å¸¸ï¼‰\n\n```java\ntry {\n  throw new ExceptionB(\"b\");\n} catch (Exception e) {\n  System.out.println(\"Exception: \" + e);\n}\n```\n\nè¾“å‡ºï¼šException: com.yaxing.demo.exceptiondemo.ExceptionB: bï¼Œä»ä¼šä½¿ç”¨å­ç±»å‹ã€‚\n\né¢è¯•é¢˜ - è¯´å‡ºä¸‹é¢ä»£ç çš„è¿è¡Œç»“æœã€‚ï¼ˆæ­¤é¢˜çš„å‡ºå¤„æ˜¯ã€ŠJava ç¼–ç¨‹æ€æƒ³ã€‹ä¸€ä¹¦ï¼‰\n\n```java\nclass Annoyance extends Exception {\n}\nclass Sneeze extends Annoyance {\n}\nclass Human {\n\tpublic static void main(String[] args) throws Exception {\n\t\ttry {\n\t\t\ttry {\n\t\t\t\tthrow new Sneeze();\n\t\t\t} catch ( Annoyance a ) {\n\t\t\t\tSystem.out.println(\"Caught Annoyance\");\n\t\t\t\tthrow a;\n\t\t\t}\n\t\t} catch ( Sneeze s ) {\n\t\t\tSystem.out.println(\"Caught Sneeze\");\n\t\t\treturn ;\n\t\t} finally {\n\t\t\tSystem.out.println(\"Hello World!\");\n\t\t}\n\t}\n}\n```\n\nç»“æœ\n\n```java\nCaught Annoyance\nCaught Sneeze\nHello World!\n```\n\n","source":"_posts/Javaå…«è‚¡æ–‡ - Javaå¼‚å¸¸.md","raw":"---\ntitle: Javaå…«è‚¡æ–‡ - Javaå¼‚å¸¸\ncopyright: true\nmathjax: false\ncategories:\n  - Javaå…«è‚¡æ–‡\ndate: 2023-01-23 10:06:31\ntags:\ntoc: true\nurlname: java-exception-error\n---\n\n> æ•´ç†çš„Javaå¼‚å¸¸ç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½\t<!--more-->\n\n## Javaå¼‚å¸¸æ¶æ„\n\n![Javaå¼‚å¸¸æ¶æ„](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes20200314173417278.png)\n\n### 1. Throwable\n\nThrowable æ˜¯ Java è¯­è¨€ä¸­æ‰€æœ‰é”™è¯¯ä¸å¼‚å¸¸çš„è¶…ç±»ã€‚\n\nThrowable åŒ…å«ä¸¤ä¸ªå­ç±»ï¼šErrorï¼ˆé”™è¯¯ï¼‰å’Œ Exceptionï¼ˆå¼‚å¸¸ï¼‰ï¼Œå®ƒä»¬é€šå¸¸ç”¨äºæŒ‡ç¤ºå‘ç”Ÿäº†å¼‚å¸¸æƒ…å†µã€‚\n\n### 2. Errorï¼ˆé”™è¯¯ï¼‰\n\nError ç±»åŠå…¶å­ç±»ã€‚ç¨‹åºä¸­æ— æ³•å¤„ç†çš„é”™è¯¯ï¼Œè¡¨ç¤ºè¿è¡Œåº”ç”¨ç¨‹åºä¸­å‡ºç°äº†ä¸¥é‡çš„é”™è¯¯ã€‚\n\néå—æ£€å¼‚å¸¸ï¼Œä¸€èˆ¬è¡¨ç¤ºä»£ç è¿è¡Œæ—¶ JVM å‡ºç°é—®é¢˜ã€‚æ¯”å¦‚ OutOfMemoryErrorï¼šå†…å­˜ä¸è¶³é”™è¯¯ï¼›StackOverflowErrorï¼šæ ˆæº¢å‡ºé”™è¯¯ã€‚æ­¤ç±»é”™è¯¯å‘ç”Ÿæ—¶ï¼ŒJVM å°†ç»ˆæ­¢çº¿ç¨‹ã€‚\n\n### 3. Exceptionï¼ˆå¼‚å¸¸ï¼‰\n\nç¨‹åºæœ¬èº«å¯ä»¥æ•è·å¹¶ä¸”å¯ä»¥å¤„ç†çš„å¼‚å¸¸ã€‚Exception è¿™ç§å¼‚å¸¸åˆåˆ†ä¸ºä¸¤ç±»ï¼šè¿è¡Œæ—¶å¼‚å¸¸å’Œç¼–è¯‘æ—¶å¼‚å¸¸ã€‚\n\n#### è¿è¡Œæ—¶å¼‚å¸¸\n\nException ä¸­ RuntimeException ç±»åŠå…¶å­ç±»ï¼Œè¡¨ç¤º JVM åœ¨è¿è¡ŒæœŸé—´å¯èƒ½å‡ºç°çš„å¼‚å¸¸ã€‚ï¼ˆéå—æ£€å¼‚å¸¸ï¼Œç¼–è¯‘æ—¶ä¸ä¼šæ£€æŸ¥å‡ºå¼‚å¸¸ï¼Œè¿è¡Œæ—¶ä¼šå‘ç”Ÿå¼‚å¸¸ï¼Œéœ€è¦å¯¹å¼‚å¸¸è¿›è¡Œç‰¹æ®Šå¤„ç†ï¼Œå¦åˆ™ä¼šå‘ç”Ÿé€»è¾‘é”™è¯¯ï¼‰\n\n#### ç¼–è¯‘æ—¶å¼‚å¸¸\n\nException ä¸­é™¤ RuntimeException åŠå…¶å­ç±»ä¹‹å¤–çš„å¼‚å¸¸ã€‚ï¼ˆå—æ£€å¼‚å¸¸ï¼Œç¼–è¯‘æ—¶ä¼šæ£€æŸ¥åˆ°è¯¥å¼‚å¸¸ ï¼‰\n\n## Javaå¼‚å¸¸å…³é”®å­—\n\nâ€¢ **try** â€“ ç”¨äºç›‘å¬ã€‚å°†è¦è¢«ç›‘å¬çš„ä»£ï¼ˆå¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„ä»£ç ï¼‰æ”¾åœ¨ try è¯­å¥å—ä¹‹å†…ï¼Œå½“ try è¯­å¥å—å†…å‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œå¼‚å¸¸å°±è¢«æŠ›å‡ºã€‚\nâ€¢ **catch** â€“ ç”¨äºæ•è·å¼‚å¸¸ã€‚catch ç”¨æ¥æ•è· try è¯­å¥å—ä¸­å‘ç”Ÿçš„å¼‚å¸¸ã€‚\nâ€¢ **finally** â€“ finally è¯­å¥å—æ€»æ˜¯ä¼šè¢«æ‰§è¡Œã€‚å®ƒä¸»è¦ç”¨äºå›æ”¶åœ¨ try å—é‡Œæ‰“å¼€çš„èµ„æº(å¦‚æ•°æ®åº“è¿æ¥ã€ç½‘ç»œè¿æ¥å’Œç£ç›˜æ–‡ä»¶)ã€‚\nâ€¢ **throw** â€“ ç”¨äºæ‰‹åŠ¨æŠ›å‡º catch åˆ°çš„å¼‚å¸¸ã€‚\nâ€¢ **throws** â€“ ç”¨åœ¨æ–¹æ³•ç­¾åä¸­ï¼Œç”¨äºå£°æ˜è¯¥æ–¹æ³•å¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸ï¼Œè°ƒç”¨è¯¥æ–¹æ³•çš„æ–¹æ³•éœ€è¦æ³¨æ„ catch è¿™ä¸ªå¯èƒ½è·‘å‡ºçš„å¼‚å¸¸ã€‚\n\n## Javaå¼‚å¸¸å¤„ç†\n\n### ç›´æ¥æŠ›å‡ºå¼‚å¸¸\n\né€šå¸¸ï¼Œåº”è¯¥æ•è·é‚£äº›çŸ¥é“å¦‚ä½•å¤„ç†çš„å¼‚å¸¸ï¼Œå°†ä¸çŸ¥é“å¦‚ä½•å¤„ç†çš„å¼‚å¸¸ç»§ç»­ä¼ é€’ä¸‹å»ã€‚ä¼ é€’å¼‚å¸¸å¯ä»¥åœ¨æ–¹æ³•ç­¾åå¤„ä½¿ç”¨ **throws** å…³é”®å­—å£°æ˜å¯èƒ½ä¼šæŠ›å‡ºçš„å¼‚å¸¸ã€‚è°ƒç”¨è¯¥æ–¹æ³•çš„æ–¹æ³•éœ€è¦æ³¨æ„ catch è¿™ä¸ªå¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸ã€‚\n\n```java\nprivate static void readFile(String filePath) throws IOException {\n    File file = new File(filePath);\n    String result;\n    BufferedReader reader = new BufferedReader(new FileReader(file));\n    while((result = reader.readLine())!=null) {\n        System.out.println(result);\n    }\n    reader.close();\n}\n```\n\n### å°è£…å¼‚å¸¸å†æŠ›å‡º\n\næœ‰æ—¶æˆ‘ä»¬ä¼šä» catch ä¸­æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œç›®çš„æ˜¯ä¸ºäº†æ”¹å˜å¼‚å¸¸çš„ç±»å‹ã€‚å¤šç”¨äºåœ¨å¤šç³»ç»Ÿé›†æˆæ—¶ï¼Œå½“æŸä¸ªå­ç³»ç»Ÿæ•…éšœï¼Œå¼‚å¸¸ç±»å‹å¯èƒ½æœ‰å¤šç§ï¼Œå¯ä»¥ç”¨ç»Ÿä¸€çš„å¼‚å¸¸ç±»å‹å‘å¤–æš´éœ²ï¼Œä¸éœ€æš´éœ²å¤ªå¤šå†…éƒ¨å¼‚å¸¸ç»†èŠ‚ã€‚\n\n```java\nprivate static void readFile(String filePath) throws MyException {    \n    try {\n        // code\n    } catch (IOException e) {\n        MyException ex = new MyException(\"read file failed.\");\n        ex.initCause(e);\n        throw ex;\n    }\n}\n```\n\n### æ•è·å¼‚å¸¸\n\nåœ¨ä¸€ä¸ª try-catch è¯­å¥å—ä¸­å¯ä»¥æ•è·å¤šä¸ªå¼‚å¸¸ç±»å‹ï¼Œå¹¶å¯¹ä¸åŒç±»å‹çš„å¼‚å¸¸åšå‡ºä¸åŒçš„å¤„ç†\n\n```java\nprivate static void readFile(String filePath) {\n    try {\n        // code\n    } catch (FileNotFoundException e) {\n        // handle FileNotFoundException\n    } catch (IOException e){\n        // handle IOException\n    }\n}\n```\n\nåŒä¸€ä¸ª catch ä¹Ÿå¯ä»¥æ•è·å¤šç§ç±»å‹å¼‚å¸¸ï¼Œç”¨ | éš”å¼€\n\n```java\nprivate static void readFile(String filePath) {\n    try {\n        // code\n    } catch (FileNotFoundException | UnknownHostException e) {\n        // handle FileNotFoundException or UnknownHostException\n    } catch (IOException e){\n        // handle IOException\n    }\n}\n```\n\n### è‡ªå®šä¹‰å¼‚å¸¸\n\nä¹ æƒ¯ä¸Šï¼Œå®šä¹‰ä¸€ä¸ªå¼‚å¸¸ç±»åº”åŒ…å«ä¸¤ä¸ªæ„é€ å‡½æ•°ï¼Œä¸€ä¸ªæ— å‚æ„é€ å‡½æ•°å’Œä¸€ä¸ªå¸¦æœ‰è¯¦ç»†æè¿°ä¿¡æ¯çš„æ„é€ å‡½æ•°ï¼ˆThrowable çš„ toString æ–¹æ³•ä¼šæ‰“å°è¿™äº›è¯¦ç»†ä¿¡æ¯ï¼Œè°ƒè¯•æ—¶å¾ˆæœ‰ç”¨ï¼‰\n\n```java\npublic class MyException extends Exception {\n    public MyException(){ }\n    public MyException(String msg){\n        super(msg);\n    }\n    // ...\n}\n```\n\n## Javaå¼‚å¸¸å¸¸è§é¢è¯•é¢˜\n\n### 1. Error å’Œ Exception åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\n\nError ç±»å‹çš„é”™è¯¯é€šå¸¸ä¸ºè™šæ‹Ÿæœºç›¸å…³é”™è¯¯ï¼Œå¦‚ç³»ç»Ÿå´©æºƒï¼Œå†…å­˜ä¸è¶³ï¼Œå †æ ˆæº¢å‡ºç­‰ï¼Œç¼–è¯‘å™¨ä¸ä¼šå¯¹è¿™ç±»é”™è¯¯è¿›è¡Œæ£€æµ‹ï¼ŒJava åº”ç”¨ç¨‹åºä¹Ÿä¸åº”å¯¹è¿™ç±»é”™è¯¯è¿›è¡Œæ•è·ï¼Œä¸€æ—¦è¿™ç±»é”™è¯¯å‘ç”Ÿï¼Œé€šå¸¸åº”ç”¨ç¨‹åºä¼šè¢«ç»ˆæ­¢ï¼Œä»…é åº”ç”¨ç¨‹åºæœ¬èº«æ— æ³•æ¢å¤ï¼›\n\nException ç±»çš„é”™è¯¯æ˜¯å¯ä»¥åœ¨åº”ç”¨ç¨‹åºä¸­è¿›è¡Œæ•è·å¹¶å¤„ç†çš„ï¼Œé€šå¸¸é‡åˆ°è¿™ç§é”™è¯¯ï¼Œåº”å¯¹å…¶è¿›è¡Œå¤„ç†ï¼Œä½¿åº”ç”¨ç¨‹åºå¯ä»¥ç»§ç»­æ­£å¸¸è¿è¡Œã€‚\n\n### 2. è¿è¡Œæ—¶å¼‚å¸¸å’Œä¸€èˆ¬å¼‚å¸¸(å—æ£€å¼‚å¸¸)åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\n\nè¿è¡Œæ—¶å¼‚å¸¸åŒ…æ‹¬ RuntimeException ç±»åŠå…¶å­ç±»ï¼Œè¡¨ç¤º JVM åœ¨è¿è¡ŒæœŸé—´å¯èƒ½å‡ºç°çš„å¼‚å¸¸ã€‚ Java ç¼–è¯‘å™¨ä¸ä¼šæ£€æŸ¥è¿è¡Œæ—¶å¼‚å¸¸ã€‚\n\nå—æ£€å¼‚å¸¸æ˜¯ Exception ä¸­é™¤ RuntimeException åŠå…¶å­ç±»ä¹‹å¤–çš„å¼‚å¸¸ã€‚ Java ç¼–è¯‘å™¨ä¼šæ£€æŸ¥å—æ£€å¼‚å¸¸ã€‚\n\n**RuntimeExceptionå¼‚å¸¸å’Œå—æ£€å¼‚å¸¸ä¹‹é—´çš„åŒºåˆ«**ï¼šæ˜¯å¦å¼ºåˆ¶è¦æ±‚è°ƒç”¨è€…å¿…é¡»å¤„ç†æ­¤å¼‚å¸¸ï¼Œå¦‚æœå¼ºåˆ¶è¦æ±‚è°ƒç”¨è€…å¿…é¡»è¿›è¡Œå¤„ç†ï¼Œé‚£ä¹ˆå°±ä½¿ç”¨å—æ£€å¼‚å¸¸ï¼Œå¦åˆ™å°±é€‰æ‹©éå—æ£€å¼‚å¸¸(RuntimeException)ã€‚ä¸€èˆ¬æ¥è®²ï¼Œå¦‚æœæ²¡æœ‰ç‰¹æ®Šçš„è¦æ±‚ï¼Œæˆ‘ä»¬å»ºè®®ä½¿ç”¨ RuntimeException å¼‚å¸¸ã€‚\n\n### 3. JVM æ˜¯å¦‚ä½•å¤„ç†å¼‚å¸¸çš„ï¼Ÿ\n\nåœ¨ä¸€ä¸ªæ–¹æ³•ä¸­å¦‚æœå‘ç”Ÿå¼‚å¸¸ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šåˆ›å»ºä¸€ä¸ªå¼‚å¸¸å¯¹è±¡ï¼Œå¹¶è½¬äº¤ç»™ JVMï¼Œè¯¥å¼‚å¸¸å¯¹è±¡åŒ…å«å¼‚å¸¸åç§°ï¼Œå¼‚å¸¸æè¿°ä»¥åŠå¼‚å¸¸å‘ç”Ÿæ—¶åº”ç”¨ç¨‹åºçš„çŠ¶æ€ã€‚åˆ›å»ºå¼‚å¸¸å¯¹è±¡å¹¶è½¬äº¤ç»™ JVM çš„è¿‡ç¨‹ç§°ä¸ºæŠ›å‡ºå¼‚å¸¸ã€‚å¯èƒ½æœ‰ä¸€ç³»åˆ—çš„æ–¹æ³•è°ƒç”¨ï¼Œæœ€ç»ˆæ‰è¿›å…¥æŠ›å‡ºå¼‚å¸¸çš„æ–¹æ³•ï¼Œè¿™ä¸€ç³»åˆ—æ–¹æ³•è°ƒç”¨çš„æœ‰åºåˆ—è¡¨å«åšè°ƒç”¨æ ˆã€‚\n\nJVM ä¼šé¡ºç€è°ƒç”¨æ ˆå»æŸ¥æ‰¾çœ‹æ˜¯å¦æœ‰å¯ä»¥å¤„ç†å¼‚å¸¸çš„ä»£ç ï¼Œå¦‚æœæœ‰ï¼Œåˆ™è°ƒç”¨å¼‚å¸¸å¤„ç†ä»£ç ã€‚å½“ JVM å‘ç°å¯ä»¥å¤„ç†å¼‚å¸¸çš„ä»£ç æ—¶ï¼Œä¼šæŠŠå‘ç”Ÿçš„å¼‚å¸¸ä¼ é€’ç»™å®ƒã€‚å¦‚æœ JVM æ²¡æœ‰æ‰¾åˆ°å¯ä»¥å¤„ç†è¯¥å¼‚å¸¸çš„ä»£ç å—ï¼ŒJVM å°±ä¼šå°†è¯¥å¼‚å¸¸è½¬äº¤ç»™é»˜è®¤çš„å¼‚å¸¸å¤„ç†å™¨ï¼ˆé»˜è®¤å¤„ç†å™¨ä¸º JVM çš„ä¸€éƒ¨åˆ†ï¼‰ï¼Œé»˜è®¤å¼‚å¸¸å¤„ç†å™¨æ‰“å°å‡ºå¼‚å¸¸ä¿¡æ¯å¹¶ç»ˆæ­¢åº”ç”¨ç¨‹åºã€‚\n\n### 4. throw å’Œ throws çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\n\nJava ä¸­çš„å¼‚å¸¸å¤„ç†é™¤äº†åŒ…æ‹¬æ•è·å¼‚å¸¸å’Œå¤„ç†å¼‚å¸¸ä¹‹å¤–ï¼Œè¿˜åŒ…æ‹¬å£°æ˜å¼‚å¸¸å’Œæ‹‹å‡ºå¼‚å¸¸ï¼Œå¯ä»¥é€šè¿‡ throws å…³é”®å­—åœ¨æ–¹æ³•ä¸Šå£°æ˜è¯¥æ–¹æ³•è¦æ‹‹å‡ºçš„å¼‚å¸¸ï¼Œæˆ–è€…åœ¨æ–¹æ³•å†…éƒ¨é€šè¿‡ throw æ‹‹å‡ºå¼‚å¸¸å¯¹è±¡ã€‚\n\n**throws å…³é”®å­—å’Œ throw å…³é”®å­—åœ¨ä½¿ç”¨ä¸Šçš„å‡ ç‚¹åŒºåˆ«å¦‚ä¸‹**ï¼š\n\n- throw å…³é”®å­—ç”¨åœ¨æ–¹æ³•å†…éƒ¨ï¼Œåªèƒ½ç”¨äºæŠ›å‡ºä¸€ç§å¼‚å¸¸ï¼Œç”¨æ¥æŠ›å‡ºæ–¹æ³•æˆ–ä»£ç å—ä¸­çš„å¼‚å¸¸ï¼Œå—æŸ¥å¼‚å¸¸å’Œéå—æŸ¥å¼‚å¸¸éƒ½å¯ä»¥è¢«æŠ›å‡ºã€‚\n- throws å…³é”®å­—ç”¨åœ¨æ–¹æ³•å£°æ˜ä¸Šï¼Œå¯ä»¥æŠ›å‡ºå¤šä¸ªå¼‚å¸¸ï¼Œç”¨æ¥æ ‡è¯†è¯¥æ–¹æ³•å¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸åˆ—è¡¨ã€‚ä¸€ä¸ªæ–¹æ³•ç”¨ throws æ ‡è¯†äº†å¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸åˆ—è¡¨ï¼Œè°ƒç”¨è¯¥æ–¹æ³•çš„æ–¹æ³•ä¸­å¿…é¡»åŒ…å«å¯å¤„ç†å¼‚å¸¸çš„ä»£ç ï¼Œå¦åˆ™ä¹Ÿè¦åœ¨æ–¹æ³•ç­¾åä¸­ç”¨ throws å…³é”®å­—å£°æ˜ç›¸åº”çš„å¼‚å¸¸ã€‚\n\n### 5. try-catch-finally ä¸­ï¼Œå¦‚æœ catch ä¸­ return äº†ï¼Œfinally è¿˜ä¼šæ‰§è¡Œå—ï¼Ÿ\n\n**ç­”ï¼šä¼šæ‰§è¡Œï¼Œåœ¨ return å‰æ‰§è¡Œã€‚**\n\n**ä»£ç ç¤ºä¾‹1ï¼š**\n\n```java\npublic static int getInt() {\n    int a = 10;\n    try {\n        System.out.println(a / 0);\n        a = 20;\n    } catch (ArithmeticException e) {\n        a = 30;\n        return a;\t// ä¸ä¼šç›´æ¥returnï¼Œå…ˆæ‰§è¡Œfinallyï¼Œfinallyæ‰§è¡Œè¿‡åå›æ¥æ‰§è¡Œreturn a\n    } finally {\n        a = 40;\n    }\n\treturn a;\n}\n```\n\næ‰§è¡Œç»“æœï¼š30\n\n**ä»£ç ç¤ºä¾‹2ï¼š**\n\n```java\npublic static int getInt() {\n    int a = 10;\n    try {\n        System.out.println(a / 0);\n        a = 20;\n    } catch (ArithmeticException e) {\n        a = 30;\n        return a;\t// ä¸ä¼šç›´æ¥returnï¼Œå…ˆæ‰§è¡Œfinally\n    } finally {\n        a = 40;\n        return a;\t// finallyä¸­æœ‰returnå°±ç›´æ¥returnäº†\n    }\n}\n```\n\næ‰§è¡Œç»“æœï¼š40\n\n### 6. ç±» ExampleA ç»§æ‰¿ Exceptionï¼Œç±» ExampleB ç»§æ‰¿ExampleAã€‚\n\n```java\npublic class ExceptionA extends Exception {\n    public ExceptionA(String message) {\n        super(message);\n    }\n}\npublic class ExceptionB extends ExceptionA {\n    public ExceptionB(String message) {\n        super(message);\n    }\n}\n\ntry {\n  throw new ExceptionB(\"a\");\n} catch (ExceptionA ea) {\n  System.out.println(\"ExceptionA\");\n} catch (Exception e) {\n  System.out.println(\"Exception\");\n}\n```\n\nè¾“å‡ºï¼šExampleAã€‚ï¼ˆæ ¹æ®é‡Œæ°ä»£æ¢åŸåˆ™[èƒ½ä½¿ç”¨çˆ¶ç±»å‹çš„åœ°æ–¹ä¸€å®šèƒ½ä½¿ç”¨å­ç±»å‹]ï¼ŒæŠ“å– ExceptionA ç±»å‹å¼‚å¸¸çš„ catch å—èƒ½å¤ŸæŠ“ä½ try å—ä¸­æŠ›å‡ºçš„ ExceptionB ç±»å‹çš„å¼‚å¸¸ï¼‰\n\n```java\ntry {\n  throw new ExceptionB(\"b\");\n} catch (Exception e) {\n  System.out.println(\"Exception: \" + e);\n}\n```\n\nè¾“å‡ºï¼šException: com.yaxing.demo.exceptiondemo.ExceptionB: bï¼Œä»ä¼šä½¿ç”¨å­ç±»å‹ã€‚\n\né¢è¯•é¢˜ - è¯´å‡ºä¸‹é¢ä»£ç çš„è¿è¡Œç»“æœã€‚ï¼ˆæ­¤é¢˜çš„å‡ºå¤„æ˜¯ã€ŠJava ç¼–ç¨‹æ€æƒ³ã€‹ä¸€ä¹¦ï¼‰\n\n```java\nclass Annoyance extends Exception {\n}\nclass Sneeze extends Annoyance {\n}\nclass Human {\n\tpublic static void main(String[] args) throws Exception {\n\t\ttry {\n\t\t\ttry {\n\t\t\t\tthrow new Sneeze();\n\t\t\t} catch ( Annoyance a ) {\n\t\t\t\tSystem.out.println(\"Caught Annoyance\");\n\t\t\t\tthrow a;\n\t\t\t}\n\t\t} catch ( Sneeze s ) {\n\t\t\tSystem.out.println(\"Caught Sneeze\");\n\t\t\treturn ;\n\t\t} finally {\n\t\t\tSystem.out.println(\"Hello World!\");\n\t\t}\n\t}\n}\n```\n\nç»“æœ\n\n```java\nCaught Annoyance\nCaught Sneeze\nHello World!\n```\n\n","slug":"Javaå…«è‚¡æ–‡ - Javaå¼‚å¸¸","published":1,"updated":"2023-01-26T13:00:30.451Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cldzfw31w0008t9t883lmba4k","content":"<blockquote>\n<p>æ•´ç†çš„Javaå¼‚å¸¸ç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½\t<span id=\"more\"></span></p>\n</blockquote>\n<h2 id=\"Javaå¼‚å¸¸æ¶æ„\"><a href=\"#Javaå¼‚å¸¸æ¶æ„\" class=\"headerlink\" title=\"Javaå¼‚å¸¸æ¶æ„\"></a>Javaå¼‚å¸¸æ¶æ„</h2><p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes20200314173417278.png\" alt=\"Javaå¼‚å¸¸æ¶æ„\"></p>\n<h3 id=\"1-Throwable\"><a href=\"#1-Throwable\" class=\"headerlink\" title=\"1. Throwable\"></a>1. Throwable</h3><p>Throwable æ˜¯ Java è¯­è¨€ä¸­æ‰€æœ‰é”™è¯¯ä¸å¼‚å¸¸çš„è¶…ç±»ã€‚</p>\n<p>Throwable åŒ…å«ä¸¤ä¸ªå­ç±»ï¼šErrorï¼ˆé”™è¯¯ï¼‰å’Œ Exceptionï¼ˆå¼‚å¸¸ï¼‰ï¼Œå®ƒä»¬é€šå¸¸ç”¨äºæŒ‡ç¤ºå‘ç”Ÿäº†å¼‚å¸¸æƒ…å†µã€‚</p>\n<h3 id=\"2-Errorï¼ˆé”™è¯¯ï¼‰\"><a href=\"#2-Errorï¼ˆé”™è¯¯ï¼‰\" class=\"headerlink\" title=\"2. Errorï¼ˆé”™è¯¯ï¼‰\"></a>2. Errorï¼ˆé”™è¯¯ï¼‰</h3><p>Error ç±»åŠå…¶å­ç±»ã€‚ç¨‹åºä¸­æ— æ³•å¤„ç†çš„é”™è¯¯ï¼Œè¡¨ç¤ºè¿è¡Œåº”ç”¨ç¨‹åºä¸­å‡ºç°äº†ä¸¥é‡çš„é”™è¯¯ã€‚</p>\n<p>éå—æ£€å¼‚å¸¸ï¼Œä¸€èˆ¬è¡¨ç¤ºä»£ç è¿è¡Œæ—¶ JVM å‡ºç°é—®é¢˜ã€‚æ¯”å¦‚ OutOfMemoryErrorï¼šå†…å­˜ä¸è¶³é”™è¯¯ï¼›StackOverflowErrorï¼šæ ˆæº¢å‡ºé”™è¯¯ã€‚æ­¤ç±»é”™è¯¯å‘ç”Ÿæ—¶ï¼ŒJVM å°†ç»ˆæ­¢çº¿ç¨‹ã€‚</p>\n<h3 id=\"3-Exceptionï¼ˆå¼‚å¸¸ï¼‰\"><a href=\"#3-Exceptionï¼ˆå¼‚å¸¸ï¼‰\" class=\"headerlink\" title=\"3. Exceptionï¼ˆå¼‚å¸¸ï¼‰\"></a>3. Exceptionï¼ˆå¼‚å¸¸ï¼‰</h3><p>ç¨‹åºæœ¬èº«å¯ä»¥æ•è·å¹¶ä¸”å¯ä»¥å¤„ç†çš„å¼‚å¸¸ã€‚Exception è¿™ç§å¼‚å¸¸åˆåˆ†ä¸ºä¸¤ç±»ï¼šè¿è¡Œæ—¶å¼‚å¸¸å’Œç¼–è¯‘æ—¶å¼‚å¸¸ã€‚</p>\n<h4 id=\"è¿è¡Œæ—¶å¼‚å¸¸\"><a href=\"#è¿è¡Œæ—¶å¼‚å¸¸\" class=\"headerlink\" title=\"è¿è¡Œæ—¶å¼‚å¸¸\"></a>è¿è¡Œæ—¶å¼‚å¸¸</h4><p>Exception ä¸­ RuntimeException ç±»åŠå…¶å­ç±»ï¼Œè¡¨ç¤º JVM åœ¨è¿è¡ŒæœŸé—´å¯èƒ½å‡ºç°çš„å¼‚å¸¸ã€‚ï¼ˆéå—æ£€å¼‚å¸¸ï¼Œç¼–è¯‘æ—¶ä¸ä¼šæ£€æŸ¥å‡ºå¼‚å¸¸ï¼Œè¿è¡Œæ—¶ä¼šå‘ç”Ÿå¼‚å¸¸ï¼Œéœ€è¦å¯¹å¼‚å¸¸è¿›è¡Œç‰¹æ®Šå¤„ç†ï¼Œå¦åˆ™ä¼šå‘ç”Ÿé€»è¾‘é”™è¯¯ï¼‰</p>\n<h4 id=\"ç¼–è¯‘æ—¶å¼‚å¸¸\"><a href=\"#ç¼–è¯‘æ—¶å¼‚å¸¸\" class=\"headerlink\" title=\"ç¼–è¯‘æ—¶å¼‚å¸¸\"></a>ç¼–è¯‘æ—¶å¼‚å¸¸</h4><p>Exception ä¸­é™¤ RuntimeException åŠå…¶å­ç±»ä¹‹å¤–çš„å¼‚å¸¸ã€‚ï¼ˆå—æ£€å¼‚å¸¸ï¼Œç¼–è¯‘æ—¶ä¼šæ£€æŸ¥åˆ°è¯¥å¼‚å¸¸ ï¼‰</p>\n<h2 id=\"Javaå¼‚å¸¸å…³é”®å­—\"><a href=\"#Javaå¼‚å¸¸å…³é”®å­—\" class=\"headerlink\" title=\"Javaå¼‚å¸¸å…³é”®å­—\"></a>Javaå¼‚å¸¸å…³é”®å­—</h2><p>â€¢ <strong>try</strong> â€“ ç”¨äºç›‘å¬ã€‚å°†è¦è¢«ç›‘å¬çš„ä»£ï¼ˆå¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„ä»£ç ï¼‰æ”¾åœ¨ try è¯­å¥å—ä¹‹å†…ï¼Œå½“ try è¯­å¥å—å†…å‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œå¼‚å¸¸å°±è¢«æŠ›å‡ºã€‚<br>â€¢ <strong>catch</strong> â€“ ç”¨äºæ•è·å¼‚å¸¸ã€‚catch ç”¨æ¥æ•è· try è¯­å¥å—ä¸­å‘ç”Ÿçš„å¼‚å¸¸ã€‚<br>â€¢ <strong>finally</strong> â€“ finally è¯­å¥å—æ€»æ˜¯ä¼šè¢«æ‰§è¡Œã€‚å®ƒä¸»è¦ç”¨äºå›æ”¶åœ¨ try å—é‡Œæ‰“å¼€çš„èµ„æº(å¦‚æ•°æ®åº“è¿æ¥ã€ç½‘ç»œè¿æ¥å’Œç£ç›˜æ–‡ä»¶)ã€‚<br>â€¢ <strong>throw</strong> â€“ ç”¨äºæ‰‹åŠ¨æŠ›å‡º catch åˆ°çš„å¼‚å¸¸ã€‚<br>â€¢ <strong>throws</strong> â€“ ç”¨åœ¨æ–¹æ³•ç­¾åä¸­ï¼Œç”¨äºå£°æ˜è¯¥æ–¹æ³•å¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸ï¼Œè°ƒç”¨è¯¥æ–¹æ³•çš„æ–¹æ³•éœ€è¦æ³¨æ„ catch è¿™ä¸ªå¯èƒ½è·‘å‡ºçš„å¼‚å¸¸ã€‚</p>\n<h2 id=\"Javaå¼‚å¸¸å¤„ç†\"><a href=\"#Javaå¼‚å¸¸å¤„ç†\" class=\"headerlink\" title=\"Javaå¼‚å¸¸å¤„ç†\"></a>Javaå¼‚å¸¸å¤„ç†</h2><h3 id=\"ç›´æ¥æŠ›å‡ºå¼‚å¸¸\"><a href=\"#ç›´æ¥æŠ›å‡ºå¼‚å¸¸\" class=\"headerlink\" title=\"ç›´æ¥æŠ›å‡ºå¼‚å¸¸\"></a>ç›´æ¥æŠ›å‡ºå¼‚å¸¸</h3><p>é€šå¸¸ï¼Œåº”è¯¥æ•è·é‚£äº›çŸ¥é“å¦‚ä½•å¤„ç†çš„å¼‚å¸¸ï¼Œå°†ä¸çŸ¥é“å¦‚ä½•å¤„ç†çš„å¼‚å¸¸ç»§ç»­ä¼ é€’ä¸‹å»ã€‚ä¼ é€’å¼‚å¸¸å¯ä»¥åœ¨æ–¹æ³•ç­¾åå¤„ä½¿ç”¨ <strong>throws</strong> å…³é”®å­—å£°æ˜å¯èƒ½ä¼šæŠ›å‡ºçš„å¼‚å¸¸ã€‚è°ƒç”¨è¯¥æ–¹æ³•çš„æ–¹æ³•éœ€è¦æ³¨æ„ catch è¿™ä¸ªå¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">readFile</span><span class=\"params\">(String filePath)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">    <span class=\"type\">File</span> <span class=\"variable\">file</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">File</span>(filePath);</span><br><span class=\"line\">    String result;</span><br><span class=\"line\">    <span class=\"type\">BufferedReader</span> <span class=\"variable\">reader</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">BufferedReader</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">FileReader</span>(file));</span><br><span class=\"line\">    <span class=\"keyword\">while</span>((result = reader.readLine())!=<span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">        System.out.println(result);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    reader.close();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"å°è£…å¼‚å¸¸å†æŠ›å‡º\"><a href=\"#å°è£…å¼‚å¸¸å†æŠ›å‡º\" class=\"headerlink\" title=\"å°è£…å¼‚å¸¸å†æŠ›å‡º\"></a>å°è£…å¼‚å¸¸å†æŠ›å‡º</h3><p>æœ‰æ—¶æˆ‘ä»¬ä¼šä» catch ä¸­æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œç›®çš„æ˜¯ä¸ºäº†æ”¹å˜å¼‚å¸¸çš„ç±»å‹ã€‚å¤šç”¨äºåœ¨å¤šç³»ç»Ÿé›†æˆæ—¶ï¼Œå½“æŸä¸ªå­ç³»ç»Ÿæ•…éšœï¼Œå¼‚å¸¸ç±»å‹å¯èƒ½æœ‰å¤šç§ï¼Œå¯ä»¥ç”¨ç»Ÿä¸€çš„å¼‚å¸¸ç±»å‹å‘å¤–æš´éœ²ï¼Œä¸éœ€æš´éœ²å¤ªå¤šå†…éƒ¨å¼‚å¸¸ç»†èŠ‚ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">readFile</span><span class=\"params\">(String filePath)</span> <span class=\"keyword\">throws</span> MyException &#123;    </span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// code</span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (IOException e) &#123;</span><br><span class=\"line\">        <span class=\"type\">MyException</span> <span class=\"variable\">ex</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MyException</span>(<span class=\"string\">&quot;read file failed.&quot;</span>);</span><br><span class=\"line\">        ex.initCause(e);</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> ex;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"æ•è·å¼‚å¸¸\"><a href=\"#æ•è·å¼‚å¸¸\" class=\"headerlink\" title=\"æ•è·å¼‚å¸¸\"></a>æ•è·å¼‚å¸¸</h3><p>åœ¨ä¸€ä¸ª try-catch è¯­å¥å—ä¸­å¯ä»¥æ•è·å¤šä¸ªå¼‚å¸¸ç±»å‹ï¼Œå¹¶å¯¹ä¸åŒç±»å‹çš„å¼‚å¸¸åšå‡ºä¸åŒçš„å¤„ç†</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">readFile</span><span class=\"params\">(String filePath)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// code</span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (FileNotFoundException e) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// handle FileNotFoundException</span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (IOException e)&#123;</span><br><span class=\"line\">        <span class=\"comment\">// handle IOException</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>åŒä¸€ä¸ª catch ä¹Ÿå¯ä»¥æ•è·å¤šç§ç±»å‹å¼‚å¸¸ï¼Œç”¨ | éš”å¼€</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">readFile</span><span class=\"params\">(String filePath)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// code</span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (FileNotFoundException | UnknownHostException e) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// handle FileNotFoundException or UnknownHostException</span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (IOException e)&#123;</span><br><span class=\"line\">        <span class=\"comment\">// handle IOException</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"è‡ªå®šä¹‰å¼‚å¸¸\"><a href=\"#è‡ªå®šä¹‰å¼‚å¸¸\" class=\"headerlink\" title=\"è‡ªå®šä¹‰å¼‚å¸¸\"></a>è‡ªå®šä¹‰å¼‚å¸¸</h3><p>ä¹ æƒ¯ä¸Šï¼Œå®šä¹‰ä¸€ä¸ªå¼‚å¸¸ç±»åº”åŒ…å«ä¸¤ä¸ªæ„é€ å‡½æ•°ï¼Œä¸€ä¸ªæ— å‚æ„é€ å‡½æ•°å’Œä¸€ä¸ªå¸¦æœ‰è¯¦ç»†æè¿°ä¿¡æ¯çš„æ„é€ å‡½æ•°ï¼ˆThrowable çš„ toString æ–¹æ³•ä¼šæ‰“å°è¿™äº›è¯¦ç»†ä¿¡æ¯ï¼Œè°ƒè¯•æ—¶å¾ˆæœ‰ç”¨ï¼‰</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyException</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">Exception</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">MyException</span><span class=\"params\">()</span>&#123; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">MyException</span><span class=\"params\">(String msg)</span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">super</span>(msg);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Javaå¼‚å¸¸å¸¸è§é¢è¯•é¢˜\"><a href=\"#Javaå¼‚å¸¸å¸¸è§é¢è¯•é¢˜\" class=\"headerlink\" title=\"Javaå¼‚å¸¸å¸¸è§é¢è¯•é¢˜\"></a>Javaå¼‚å¸¸å¸¸è§é¢è¯•é¢˜</h2><h3 id=\"1-Error-å’Œ-Exception-åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#1-Error-å’Œ-Exception-åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"1. Error å’Œ Exception åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>1. Error å’Œ Exception åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>Error ç±»å‹çš„é”™è¯¯é€šå¸¸ä¸ºè™šæ‹Ÿæœºç›¸å…³é”™è¯¯ï¼Œå¦‚ç³»ç»Ÿå´©æºƒï¼Œå†…å­˜ä¸è¶³ï¼Œå †æ ˆæº¢å‡ºç­‰ï¼Œç¼–è¯‘å™¨ä¸ä¼šå¯¹è¿™ç±»é”™è¯¯è¿›è¡Œæ£€æµ‹ï¼ŒJava åº”ç”¨ç¨‹åºä¹Ÿä¸åº”å¯¹è¿™ç±»é”™è¯¯è¿›è¡Œæ•è·ï¼Œä¸€æ—¦è¿™ç±»é”™è¯¯å‘ç”Ÿï¼Œé€šå¸¸åº”ç”¨ç¨‹åºä¼šè¢«ç»ˆæ­¢ï¼Œä»…é åº”ç”¨ç¨‹åºæœ¬èº«æ— æ³•æ¢å¤ï¼›</p>\n<p>Exception ç±»çš„é”™è¯¯æ˜¯å¯ä»¥åœ¨åº”ç”¨ç¨‹åºä¸­è¿›è¡Œæ•è·å¹¶å¤„ç†çš„ï¼Œé€šå¸¸é‡åˆ°è¿™ç§é”™è¯¯ï¼Œåº”å¯¹å…¶è¿›è¡Œå¤„ç†ï¼Œä½¿åº”ç”¨ç¨‹åºå¯ä»¥ç»§ç»­æ­£å¸¸è¿è¡Œã€‚</p>\n<h3 id=\"2-è¿è¡Œæ—¶å¼‚å¸¸å’Œä¸€èˆ¬å¼‚å¸¸-å—æ£€å¼‚å¸¸-åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#2-è¿è¡Œæ—¶å¼‚å¸¸å’Œä¸€èˆ¬å¼‚å¸¸-å—æ£€å¼‚å¸¸-åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"2. è¿è¡Œæ—¶å¼‚å¸¸å’Œä¸€èˆ¬å¼‚å¸¸(å—æ£€å¼‚å¸¸)åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>2. è¿è¡Œæ—¶å¼‚å¸¸å’Œä¸€èˆ¬å¼‚å¸¸(å—æ£€å¼‚å¸¸)åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>è¿è¡Œæ—¶å¼‚å¸¸åŒ…æ‹¬ RuntimeException ç±»åŠå…¶å­ç±»ï¼Œè¡¨ç¤º JVM åœ¨è¿è¡ŒæœŸé—´å¯èƒ½å‡ºç°çš„å¼‚å¸¸ã€‚ Java ç¼–è¯‘å™¨ä¸ä¼šæ£€æŸ¥è¿è¡Œæ—¶å¼‚å¸¸ã€‚</p>\n<p>å—æ£€å¼‚å¸¸æ˜¯ Exception ä¸­é™¤ RuntimeException åŠå…¶å­ç±»ä¹‹å¤–çš„å¼‚å¸¸ã€‚ Java ç¼–è¯‘å™¨ä¼šæ£€æŸ¥å—æ£€å¼‚å¸¸ã€‚</p>\n<p><strong>RuntimeExceptionå¼‚å¸¸å’Œå—æ£€å¼‚å¸¸ä¹‹é—´çš„åŒºåˆ«</strong>ï¼šæ˜¯å¦å¼ºåˆ¶è¦æ±‚è°ƒç”¨è€…å¿…é¡»å¤„ç†æ­¤å¼‚å¸¸ï¼Œå¦‚æœå¼ºåˆ¶è¦æ±‚è°ƒç”¨è€…å¿…é¡»è¿›è¡Œå¤„ç†ï¼Œé‚£ä¹ˆå°±ä½¿ç”¨å—æ£€å¼‚å¸¸ï¼Œå¦åˆ™å°±é€‰æ‹©éå—æ£€å¼‚å¸¸(RuntimeException)ã€‚ä¸€èˆ¬æ¥è®²ï¼Œå¦‚æœæ²¡æœ‰ç‰¹æ®Šçš„è¦æ±‚ï¼Œæˆ‘ä»¬å»ºè®®ä½¿ç”¨ RuntimeException å¼‚å¸¸ã€‚</p>\n<h3 id=\"3-JVM-æ˜¯å¦‚ä½•å¤„ç†å¼‚å¸¸çš„ï¼Ÿ\"><a href=\"#3-JVM-æ˜¯å¦‚ä½•å¤„ç†å¼‚å¸¸çš„ï¼Ÿ\" class=\"headerlink\" title=\"3. JVM æ˜¯å¦‚ä½•å¤„ç†å¼‚å¸¸çš„ï¼Ÿ\"></a>3. JVM æ˜¯å¦‚ä½•å¤„ç†å¼‚å¸¸çš„ï¼Ÿ</h3><p>åœ¨ä¸€ä¸ªæ–¹æ³•ä¸­å¦‚æœå‘ç”Ÿå¼‚å¸¸ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šåˆ›å»ºä¸€ä¸ªå¼‚å¸¸å¯¹è±¡ï¼Œå¹¶è½¬äº¤ç»™ JVMï¼Œè¯¥å¼‚å¸¸å¯¹è±¡åŒ…å«å¼‚å¸¸åç§°ï¼Œå¼‚å¸¸æè¿°ä»¥åŠå¼‚å¸¸å‘ç”Ÿæ—¶åº”ç”¨ç¨‹åºçš„çŠ¶æ€ã€‚åˆ›å»ºå¼‚å¸¸å¯¹è±¡å¹¶è½¬äº¤ç»™ JVM çš„è¿‡ç¨‹ç§°ä¸ºæŠ›å‡ºå¼‚å¸¸ã€‚å¯èƒ½æœ‰ä¸€ç³»åˆ—çš„æ–¹æ³•è°ƒç”¨ï¼Œæœ€ç»ˆæ‰è¿›å…¥æŠ›å‡ºå¼‚å¸¸çš„æ–¹æ³•ï¼Œè¿™ä¸€ç³»åˆ—æ–¹æ³•è°ƒç”¨çš„æœ‰åºåˆ—è¡¨å«åšè°ƒç”¨æ ˆã€‚</p>\n<p>JVM ä¼šé¡ºç€è°ƒç”¨æ ˆå»æŸ¥æ‰¾çœ‹æ˜¯å¦æœ‰å¯ä»¥å¤„ç†å¼‚å¸¸çš„ä»£ç ï¼Œå¦‚æœæœ‰ï¼Œåˆ™è°ƒç”¨å¼‚å¸¸å¤„ç†ä»£ç ã€‚å½“ JVM å‘ç°å¯ä»¥å¤„ç†å¼‚å¸¸çš„ä»£ç æ—¶ï¼Œä¼šæŠŠå‘ç”Ÿçš„å¼‚å¸¸ä¼ é€’ç»™å®ƒã€‚å¦‚æœ JVM æ²¡æœ‰æ‰¾åˆ°å¯ä»¥å¤„ç†è¯¥å¼‚å¸¸çš„ä»£ç å—ï¼ŒJVM å°±ä¼šå°†è¯¥å¼‚å¸¸è½¬äº¤ç»™é»˜è®¤çš„å¼‚å¸¸å¤„ç†å™¨ï¼ˆé»˜è®¤å¤„ç†å™¨ä¸º JVM çš„ä¸€éƒ¨åˆ†ï¼‰ï¼Œé»˜è®¤å¼‚å¸¸å¤„ç†å™¨æ‰“å°å‡ºå¼‚å¸¸ä¿¡æ¯å¹¶ç»ˆæ­¢åº”ç”¨ç¨‹åºã€‚</p>\n<h3 id=\"4-throw-å’Œ-throws-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#4-throw-å’Œ-throws-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"4. throw å’Œ throws çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>4. throw å’Œ throws çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>Java ä¸­çš„å¼‚å¸¸å¤„ç†é™¤äº†åŒ…æ‹¬æ•è·å¼‚å¸¸å’Œå¤„ç†å¼‚å¸¸ä¹‹å¤–ï¼Œè¿˜åŒ…æ‹¬å£°æ˜å¼‚å¸¸å’Œæ‹‹å‡ºå¼‚å¸¸ï¼Œå¯ä»¥é€šè¿‡ throws å…³é”®å­—åœ¨æ–¹æ³•ä¸Šå£°æ˜è¯¥æ–¹æ³•è¦æ‹‹å‡ºçš„å¼‚å¸¸ï¼Œæˆ–è€…åœ¨æ–¹æ³•å†…éƒ¨é€šè¿‡ throw æ‹‹å‡ºå¼‚å¸¸å¯¹è±¡ã€‚</p>\n<p><strong>throws å…³é”®å­—å’Œ throw å…³é”®å­—åœ¨ä½¿ç”¨ä¸Šçš„å‡ ç‚¹åŒºåˆ«å¦‚ä¸‹</strong>ï¼š</p>\n<ul>\n<li>throw å…³é”®å­—ç”¨åœ¨æ–¹æ³•å†…éƒ¨ï¼Œåªèƒ½ç”¨äºæŠ›å‡ºä¸€ç§å¼‚å¸¸ï¼Œç”¨æ¥æŠ›å‡ºæ–¹æ³•æˆ–ä»£ç å—ä¸­çš„å¼‚å¸¸ï¼Œå—æŸ¥å¼‚å¸¸å’Œéå—æŸ¥å¼‚å¸¸éƒ½å¯ä»¥è¢«æŠ›å‡ºã€‚</li>\n<li>throws å…³é”®å­—ç”¨åœ¨æ–¹æ³•å£°æ˜ä¸Šï¼Œå¯ä»¥æŠ›å‡ºå¤šä¸ªå¼‚å¸¸ï¼Œç”¨æ¥æ ‡è¯†è¯¥æ–¹æ³•å¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸åˆ—è¡¨ã€‚ä¸€ä¸ªæ–¹æ³•ç”¨ throws æ ‡è¯†äº†å¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸åˆ—è¡¨ï¼Œè°ƒç”¨è¯¥æ–¹æ³•çš„æ–¹æ³•ä¸­å¿…é¡»åŒ…å«å¯å¤„ç†å¼‚å¸¸çš„ä»£ç ï¼Œå¦åˆ™ä¹Ÿè¦åœ¨æ–¹æ³•ç­¾åä¸­ç”¨ throws å…³é”®å­—å£°æ˜ç›¸åº”çš„å¼‚å¸¸ã€‚</li>\n</ul>\n<h3 id=\"5-try-catch-finally-ä¸­ï¼Œå¦‚æœ-catch-ä¸­-return-äº†ï¼Œfinally-è¿˜ä¼šæ‰§è¡Œå—ï¼Ÿ\"><a href=\"#5-try-catch-finally-ä¸­ï¼Œå¦‚æœ-catch-ä¸­-return-äº†ï¼Œfinally-è¿˜ä¼šæ‰§è¡Œå—ï¼Ÿ\" class=\"headerlink\" title=\"5. try-catch-finally ä¸­ï¼Œå¦‚æœ catch ä¸­ return äº†ï¼Œfinally è¿˜ä¼šæ‰§è¡Œå—ï¼Ÿ\"></a>5. try-catch-finally ä¸­ï¼Œå¦‚æœ catch ä¸­ return äº†ï¼Œfinally è¿˜ä¼šæ‰§è¡Œå—ï¼Ÿ</h3><p><strong>ç­”ï¼šä¼šæ‰§è¡Œï¼Œåœ¨ return å‰æ‰§è¡Œã€‚</strong></p>\n<p><strong>ä»£ç ç¤ºä¾‹1ï¼š</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"title function_\">getInt</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">a</span> <span class=\"operator\">=</span> <span class=\"number\">10</span>;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        System.out.println(a / <span class=\"number\">0</span>);</span><br><span class=\"line\">        a = <span class=\"number\">20</span>;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (ArithmeticException e) &#123;</span><br><span class=\"line\">        a = <span class=\"number\">30</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> a;\t<span class=\"comment\">// ä¸ä¼šç›´æ¥returnï¼Œå…ˆæ‰§è¡Œfinallyï¼Œfinallyæ‰§è¡Œè¿‡åå›æ¥æ‰§è¡Œreturn a</span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">        a = <span class=\"number\">40</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> a;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>æ‰§è¡Œç»“æœï¼š30</p>\n<p><strong>ä»£ç ç¤ºä¾‹2ï¼š</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"title function_\">getInt</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">a</span> <span class=\"operator\">=</span> <span class=\"number\">10</span>;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        System.out.println(a / <span class=\"number\">0</span>);</span><br><span class=\"line\">        a = <span class=\"number\">20</span>;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (ArithmeticException e) &#123;</span><br><span class=\"line\">        a = <span class=\"number\">30</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> a;\t<span class=\"comment\">// ä¸ä¼šç›´æ¥returnï¼Œå…ˆæ‰§è¡Œfinally</span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">        a = <span class=\"number\">40</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> a;\t<span class=\"comment\">// finallyä¸­æœ‰returnå°±ç›´æ¥returnäº†</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>æ‰§è¡Œç»“æœï¼š40</p>\n<h3 id=\"6-ç±»-ExampleA-ç»§æ‰¿-Exceptionï¼Œç±»-ExampleB-ç»§æ‰¿ExampleAã€‚\"><a href=\"#6-ç±»-ExampleA-ç»§æ‰¿-Exceptionï¼Œç±»-ExampleB-ç»§æ‰¿ExampleAã€‚\" class=\"headerlink\" title=\"6. ç±» ExampleA ç»§æ‰¿ Exceptionï¼Œç±» ExampleB ç»§æ‰¿ExampleAã€‚\"></a>6. ç±» ExampleA ç»§æ‰¿ Exceptionï¼Œç±» ExampleB ç»§æ‰¿ExampleAã€‚</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ExceptionA</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">Exception</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">ExceptionA</span><span class=\"params\">(String message)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">super</span>(message);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ExceptionB</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">ExceptionA</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">ExceptionB</span><span class=\"params\">(String message)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">super</span>(message);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ExceptionB</span>(<span class=\"string\">&quot;a&quot;</span>);</span><br><span class=\"line\">&#125; <span class=\"keyword\">catch</span> (ExceptionA ea) &#123;</span><br><span class=\"line\">  System.out.println(<span class=\"string\">&quot;ExceptionA&quot;</span>);</span><br><span class=\"line\">&#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">  System.out.println(<span class=\"string\">&quot;Exception&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>è¾“å‡ºï¼šExampleAã€‚ï¼ˆæ ¹æ®é‡Œæ°ä»£æ¢åŸåˆ™[èƒ½ä½¿ç”¨çˆ¶ç±»å‹çš„åœ°æ–¹ä¸€å®šèƒ½ä½¿ç”¨å­ç±»å‹]ï¼ŒæŠ“å– ExceptionA ç±»å‹å¼‚å¸¸çš„ catch å—èƒ½å¤ŸæŠ“ä½ try å—ä¸­æŠ›å‡ºçš„ ExceptionB ç±»å‹çš„å¼‚å¸¸ï¼‰</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ExceptionB</span>(<span class=\"string\">&quot;b&quot;</span>);</span><br><span class=\"line\">&#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">  System.out.println(<span class=\"string\">&quot;Exception: &quot;</span> + e);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>è¾“å‡ºï¼šException: com.yaxing.demo.exceptiondemo.ExceptionB: bï¼Œä»ä¼šä½¿ç”¨å­ç±»å‹ã€‚</p>\n<p>é¢è¯•é¢˜ - è¯´å‡ºä¸‹é¢ä»£ç çš„è¿è¡Œç»“æœã€‚ï¼ˆæ­¤é¢˜çš„å‡ºå¤„æ˜¯ã€ŠJava ç¼–ç¨‹æ€æƒ³ã€‹ä¸€ä¹¦ï¼‰</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Annoyance</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">Exception</span> &#123;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Sneeze</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">Annoyance</span> &#123;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Human</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Sneeze</span>();</span><br><span class=\"line\">\t\t\t&#125; <span class=\"keyword\">catch</span> ( Annoyance a ) &#123;</span><br><span class=\"line\">\t\t\t\tSystem.out.println(<span class=\"string\">&quot;Caught Annoyance&quot;</span>);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">throw</span> a;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">catch</span> ( Sneeze s ) &#123;</span><br><span class=\"line\">\t\t\tSystem.out.println(<span class=\"string\">&quot;Caught Sneeze&quot;</span>);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> ;</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">\t\t\tSystem.out.println(<span class=\"string\">&quot;Hello World!&quot;</span>);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>ç»“æœ</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Caught Annoyance</span><br><span class=\"line\">Caught Sneeze</span><br><span class=\"line\">Hello World!</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"length":5179,"excerpt":"<blockquote>\n<p>æ•´ç†çš„Javaå¼‚å¸¸ç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½","more":"</p>\n</blockquote>\n<h2 id=\"Javaå¼‚å¸¸æ¶æ„\"><a href=\"#Javaå¼‚å¸¸æ¶æ„\" class=\"headerlink\" title=\"Javaå¼‚å¸¸æ¶æ„\"></a>Javaå¼‚å¸¸æ¶æ„</h2><p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes20200314173417278.png\" alt=\"Javaå¼‚å¸¸æ¶æ„\"></p>\n<h3 id=\"1-Throwable\"><a href=\"#1-Throwable\" class=\"headerlink\" title=\"1. Throwable\"></a>1. Throwable</h3><p>Throwable æ˜¯ Java è¯­è¨€ä¸­æ‰€æœ‰é”™è¯¯ä¸å¼‚å¸¸çš„è¶…ç±»ã€‚</p>\n<p>Throwable åŒ…å«ä¸¤ä¸ªå­ç±»ï¼šErrorï¼ˆé”™è¯¯ï¼‰å’Œ Exceptionï¼ˆå¼‚å¸¸ï¼‰ï¼Œå®ƒä»¬é€šå¸¸ç”¨äºæŒ‡ç¤ºå‘ç”Ÿäº†å¼‚å¸¸æƒ…å†µã€‚</p>\n<h3 id=\"2-Errorï¼ˆé”™è¯¯ï¼‰\"><a href=\"#2-Errorï¼ˆé”™è¯¯ï¼‰\" class=\"headerlink\" title=\"2. Errorï¼ˆé”™è¯¯ï¼‰\"></a>2. Errorï¼ˆé”™è¯¯ï¼‰</h3><p>Error ç±»åŠå…¶å­ç±»ã€‚ç¨‹åºä¸­æ— æ³•å¤„ç†çš„é”™è¯¯ï¼Œè¡¨ç¤ºè¿è¡Œåº”ç”¨ç¨‹åºä¸­å‡ºç°äº†ä¸¥é‡çš„é”™è¯¯ã€‚</p>\n<p>éå—æ£€å¼‚å¸¸ï¼Œä¸€èˆ¬è¡¨ç¤ºä»£ç è¿è¡Œæ—¶ JVM å‡ºç°é—®é¢˜ã€‚æ¯”å¦‚ OutOfMemoryErrorï¼šå†…å­˜ä¸è¶³é”™è¯¯ï¼›StackOverflowErrorï¼šæ ˆæº¢å‡ºé”™è¯¯ã€‚æ­¤ç±»é”™è¯¯å‘ç”Ÿæ—¶ï¼ŒJVM å°†ç»ˆæ­¢çº¿ç¨‹ã€‚</p>\n<h3 id=\"3-Exceptionï¼ˆå¼‚å¸¸ï¼‰\"><a href=\"#3-Exceptionï¼ˆå¼‚å¸¸ï¼‰\" class=\"headerlink\" title=\"3. Exceptionï¼ˆå¼‚å¸¸ï¼‰\"></a>3. Exceptionï¼ˆå¼‚å¸¸ï¼‰</h3><p>ç¨‹åºæœ¬èº«å¯ä»¥æ•è·å¹¶ä¸”å¯ä»¥å¤„ç†çš„å¼‚å¸¸ã€‚Exception è¿™ç§å¼‚å¸¸åˆåˆ†ä¸ºä¸¤ç±»ï¼šè¿è¡Œæ—¶å¼‚å¸¸å’Œç¼–è¯‘æ—¶å¼‚å¸¸ã€‚</p>\n<h4 id=\"è¿è¡Œæ—¶å¼‚å¸¸\"><a href=\"#è¿è¡Œæ—¶å¼‚å¸¸\" class=\"headerlink\" title=\"è¿è¡Œæ—¶å¼‚å¸¸\"></a>è¿è¡Œæ—¶å¼‚å¸¸</h4><p>Exception ä¸­ RuntimeException ç±»åŠå…¶å­ç±»ï¼Œè¡¨ç¤º JVM åœ¨è¿è¡ŒæœŸé—´å¯èƒ½å‡ºç°çš„å¼‚å¸¸ã€‚ï¼ˆéå—æ£€å¼‚å¸¸ï¼Œç¼–è¯‘æ—¶ä¸ä¼šæ£€æŸ¥å‡ºå¼‚å¸¸ï¼Œè¿è¡Œæ—¶ä¼šå‘ç”Ÿå¼‚å¸¸ï¼Œéœ€è¦å¯¹å¼‚å¸¸è¿›è¡Œç‰¹æ®Šå¤„ç†ï¼Œå¦åˆ™ä¼šå‘ç”Ÿé€»è¾‘é”™è¯¯ï¼‰</p>\n<h4 id=\"ç¼–è¯‘æ—¶å¼‚å¸¸\"><a href=\"#ç¼–è¯‘æ—¶å¼‚å¸¸\" class=\"headerlink\" title=\"ç¼–è¯‘æ—¶å¼‚å¸¸\"></a>ç¼–è¯‘æ—¶å¼‚å¸¸</h4><p>Exception ä¸­é™¤ RuntimeException åŠå…¶å­ç±»ä¹‹å¤–çš„å¼‚å¸¸ã€‚ï¼ˆå—æ£€å¼‚å¸¸ï¼Œç¼–è¯‘æ—¶ä¼šæ£€æŸ¥åˆ°è¯¥å¼‚å¸¸ ï¼‰</p>\n<h2 id=\"Javaå¼‚å¸¸å…³é”®å­—\"><a href=\"#Javaå¼‚å¸¸å…³é”®å­—\" class=\"headerlink\" title=\"Javaå¼‚å¸¸å…³é”®å­—\"></a>Javaå¼‚å¸¸å…³é”®å­—</h2><p>â€¢ <strong>try</strong> â€“ ç”¨äºç›‘å¬ã€‚å°†è¦è¢«ç›‘å¬çš„ä»£ï¼ˆå¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„ä»£ç ï¼‰æ”¾åœ¨ try è¯­å¥å—ä¹‹å†…ï¼Œå½“ try è¯­å¥å—å†…å‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œå¼‚å¸¸å°±è¢«æŠ›å‡ºã€‚<br>â€¢ <strong>catch</strong> â€“ ç”¨äºæ•è·å¼‚å¸¸ã€‚catch ç”¨æ¥æ•è· try è¯­å¥å—ä¸­å‘ç”Ÿçš„å¼‚å¸¸ã€‚<br>â€¢ <strong>finally</strong> â€“ finally è¯­å¥å—æ€»æ˜¯ä¼šè¢«æ‰§è¡Œã€‚å®ƒä¸»è¦ç”¨äºå›æ”¶åœ¨ try å—é‡Œæ‰“å¼€çš„èµ„æº(å¦‚æ•°æ®åº“è¿æ¥ã€ç½‘ç»œè¿æ¥å’Œç£ç›˜æ–‡ä»¶)ã€‚<br>â€¢ <strong>throw</strong> â€“ ç”¨äºæ‰‹åŠ¨æŠ›å‡º catch åˆ°çš„å¼‚å¸¸ã€‚<br>â€¢ <strong>throws</strong> â€“ ç”¨åœ¨æ–¹æ³•ç­¾åä¸­ï¼Œç”¨äºå£°æ˜è¯¥æ–¹æ³•å¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸ï¼Œè°ƒç”¨è¯¥æ–¹æ³•çš„æ–¹æ³•éœ€è¦æ³¨æ„ catch è¿™ä¸ªå¯èƒ½è·‘å‡ºçš„å¼‚å¸¸ã€‚</p>\n<h2 id=\"Javaå¼‚å¸¸å¤„ç†\"><a href=\"#Javaå¼‚å¸¸å¤„ç†\" class=\"headerlink\" title=\"Javaå¼‚å¸¸å¤„ç†\"></a>Javaå¼‚å¸¸å¤„ç†</h2><h3 id=\"ç›´æ¥æŠ›å‡ºå¼‚å¸¸\"><a href=\"#ç›´æ¥æŠ›å‡ºå¼‚å¸¸\" class=\"headerlink\" title=\"ç›´æ¥æŠ›å‡ºå¼‚å¸¸\"></a>ç›´æ¥æŠ›å‡ºå¼‚å¸¸</h3><p>é€šå¸¸ï¼Œåº”è¯¥æ•è·é‚£äº›çŸ¥é“å¦‚ä½•å¤„ç†çš„å¼‚å¸¸ï¼Œå°†ä¸çŸ¥é“å¦‚ä½•å¤„ç†çš„å¼‚å¸¸ç»§ç»­ä¼ é€’ä¸‹å»ã€‚ä¼ é€’å¼‚å¸¸å¯ä»¥åœ¨æ–¹æ³•ç­¾åå¤„ä½¿ç”¨ <strong>throws</strong> å…³é”®å­—å£°æ˜å¯èƒ½ä¼šæŠ›å‡ºçš„å¼‚å¸¸ã€‚è°ƒç”¨è¯¥æ–¹æ³•çš„æ–¹æ³•éœ€è¦æ³¨æ„ catch è¿™ä¸ªå¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">readFile</span><span class=\"params\">(String filePath)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">    <span class=\"type\">File</span> <span class=\"variable\">file</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">File</span>(filePath);</span><br><span class=\"line\">    String result;</span><br><span class=\"line\">    <span class=\"type\">BufferedReader</span> <span class=\"variable\">reader</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">BufferedReader</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">FileReader</span>(file));</span><br><span class=\"line\">    <span class=\"keyword\">while</span>((result = reader.readLine())!=<span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">        System.out.println(result);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    reader.close();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"å°è£…å¼‚å¸¸å†æŠ›å‡º\"><a href=\"#å°è£…å¼‚å¸¸å†æŠ›å‡º\" class=\"headerlink\" title=\"å°è£…å¼‚å¸¸å†æŠ›å‡º\"></a>å°è£…å¼‚å¸¸å†æŠ›å‡º</h3><p>æœ‰æ—¶æˆ‘ä»¬ä¼šä» catch ä¸­æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œç›®çš„æ˜¯ä¸ºäº†æ”¹å˜å¼‚å¸¸çš„ç±»å‹ã€‚å¤šç”¨äºåœ¨å¤šç³»ç»Ÿé›†æˆæ—¶ï¼Œå½“æŸä¸ªå­ç³»ç»Ÿæ•…éšœï¼Œå¼‚å¸¸ç±»å‹å¯èƒ½æœ‰å¤šç§ï¼Œå¯ä»¥ç”¨ç»Ÿä¸€çš„å¼‚å¸¸ç±»å‹å‘å¤–æš´éœ²ï¼Œä¸éœ€æš´éœ²å¤ªå¤šå†…éƒ¨å¼‚å¸¸ç»†èŠ‚ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">readFile</span><span class=\"params\">(String filePath)</span> <span class=\"keyword\">throws</span> MyException &#123;    </span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// code</span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (IOException e) &#123;</span><br><span class=\"line\">        <span class=\"type\">MyException</span> <span class=\"variable\">ex</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MyException</span>(<span class=\"string\">&quot;read file failed.&quot;</span>);</span><br><span class=\"line\">        ex.initCause(e);</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> ex;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"æ•è·å¼‚å¸¸\"><a href=\"#æ•è·å¼‚å¸¸\" class=\"headerlink\" title=\"æ•è·å¼‚å¸¸\"></a>æ•è·å¼‚å¸¸</h3><p>åœ¨ä¸€ä¸ª try-catch è¯­å¥å—ä¸­å¯ä»¥æ•è·å¤šä¸ªå¼‚å¸¸ç±»å‹ï¼Œå¹¶å¯¹ä¸åŒç±»å‹çš„å¼‚å¸¸åšå‡ºä¸åŒçš„å¤„ç†</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">readFile</span><span class=\"params\">(String filePath)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// code</span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (FileNotFoundException e) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// handle FileNotFoundException</span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (IOException e)&#123;</span><br><span class=\"line\">        <span class=\"comment\">// handle IOException</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>åŒä¸€ä¸ª catch ä¹Ÿå¯ä»¥æ•è·å¤šç§ç±»å‹å¼‚å¸¸ï¼Œç”¨ | éš”å¼€</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">readFile</span><span class=\"params\">(String filePath)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// code</span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (FileNotFoundException | UnknownHostException e) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// handle FileNotFoundException or UnknownHostException</span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (IOException e)&#123;</span><br><span class=\"line\">        <span class=\"comment\">// handle IOException</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"è‡ªå®šä¹‰å¼‚å¸¸\"><a href=\"#è‡ªå®šä¹‰å¼‚å¸¸\" class=\"headerlink\" title=\"è‡ªå®šä¹‰å¼‚å¸¸\"></a>è‡ªå®šä¹‰å¼‚å¸¸</h3><p>ä¹ æƒ¯ä¸Šï¼Œå®šä¹‰ä¸€ä¸ªå¼‚å¸¸ç±»åº”åŒ…å«ä¸¤ä¸ªæ„é€ å‡½æ•°ï¼Œä¸€ä¸ªæ— å‚æ„é€ å‡½æ•°å’Œä¸€ä¸ªå¸¦æœ‰è¯¦ç»†æè¿°ä¿¡æ¯çš„æ„é€ å‡½æ•°ï¼ˆThrowable çš„ toString æ–¹æ³•ä¼šæ‰“å°è¿™äº›è¯¦ç»†ä¿¡æ¯ï¼Œè°ƒè¯•æ—¶å¾ˆæœ‰ç”¨ï¼‰</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyException</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">Exception</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">MyException</span><span class=\"params\">()</span>&#123; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">MyException</span><span class=\"params\">(String msg)</span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">super</span>(msg);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Javaå¼‚å¸¸å¸¸è§é¢è¯•é¢˜\"><a href=\"#Javaå¼‚å¸¸å¸¸è§é¢è¯•é¢˜\" class=\"headerlink\" title=\"Javaå¼‚å¸¸å¸¸è§é¢è¯•é¢˜\"></a>Javaå¼‚å¸¸å¸¸è§é¢è¯•é¢˜</h2><h3 id=\"1-Error-å’Œ-Exception-åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#1-Error-å’Œ-Exception-åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"1. Error å’Œ Exception åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>1. Error å’Œ Exception åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>Error ç±»å‹çš„é”™è¯¯é€šå¸¸ä¸ºè™šæ‹Ÿæœºç›¸å…³é”™è¯¯ï¼Œå¦‚ç³»ç»Ÿå´©æºƒï¼Œå†…å­˜ä¸è¶³ï¼Œå †æ ˆæº¢å‡ºç­‰ï¼Œç¼–è¯‘å™¨ä¸ä¼šå¯¹è¿™ç±»é”™è¯¯è¿›è¡Œæ£€æµ‹ï¼ŒJava åº”ç”¨ç¨‹åºä¹Ÿä¸åº”å¯¹è¿™ç±»é”™è¯¯è¿›è¡Œæ•è·ï¼Œä¸€æ—¦è¿™ç±»é”™è¯¯å‘ç”Ÿï¼Œé€šå¸¸åº”ç”¨ç¨‹åºä¼šè¢«ç»ˆæ­¢ï¼Œä»…é åº”ç”¨ç¨‹åºæœ¬èº«æ— æ³•æ¢å¤ï¼›</p>\n<p>Exception ç±»çš„é”™è¯¯æ˜¯å¯ä»¥åœ¨åº”ç”¨ç¨‹åºä¸­è¿›è¡Œæ•è·å¹¶å¤„ç†çš„ï¼Œé€šå¸¸é‡åˆ°è¿™ç§é”™è¯¯ï¼Œåº”å¯¹å…¶è¿›è¡Œå¤„ç†ï¼Œä½¿åº”ç”¨ç¨‹åºå¯ä»¥ç»§ç»­æ­£å¸¸è¿è¡Œã€‚</p>\n<h3 id=\"2-è¿è¡Œæ—¶å¼‚å¸¸å’Œä¸€èˆ¬å¼‚å¸¸-å—æ£€å¼‚å¸¸-åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#2-è¿è¡Œæ—¶å¼‚å¸¸å’Œä¸€èˆ¬å¼‚å¸¸-å—æ£€å¼‚å¸¸-åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"2. è¿è¡Œæ—¶å¼‚å¸¸å’Œä¸€èˆ¬å¼‚å¸¸(å—æ£€å¼‚å¸¸)åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>2. è¿è¡Œæ—¶å¼‚å¸¸å’Œä¸€èˆ¬å¼‚å¸¸(å—æ£€å¼‚å¸¸)åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>è¿è¡Œæ—¶å¼‚å¸¸åŒ…æ‹¬ RuntimeException ç±»åŠå…¶å­ç±»ï¼Œè¡¨ç¤º JVM åœ¨è¿è¡ŒæœŸé—´å¯èƒ½å‡ºç°çš„å¼‚å¸¸ã€‚ Java ç¼–è¯‘å™¨ä¸ä¼šæ£€æŸ¥è¿è¡Œæ—¶å¼‚å¸¸ã€‚</p>\n<p>å—æ£€å¼‚å¸¸æ˜¯ Exception ä¸­é™¤ RuntimeException åŠå…¶å­ç±»ä¹‹å¤–çš„å¼‚å¸¸ã€‚ Java ç¼–è¯‘å™¨ä¼šæ£€æŸ¥å—æ£€å¼‚å¸¸ã€‚</p>\n<p><strong>RuntimeExceptionå¼‚å¸¸å’Œå—æ£€å¼‚å¸¸ä¹‹é—´çš„åŒºåˆ«</strong>ï¼šæ˜¯å¦å¼ºåˆ¶è¦æ±‚è°ƒç”¨è€…å¿…é¡»å¤„ç†æ­¤å¼‚å¸¸ï¼Œå¦‚æœå¼ºåˆ¶è¦æ±‚è°ƒç”¨è€…å¿…é¡»è¿›è¡Œå¤„ç†ï¼Œé‚£ä¹ˆå°±ä½¿ç”¨å—æ£€å¼‚å¸¸ï¼Œå¦åˆ™å°±é€‰æ‹©éå—æ£€å¼‚å¸¸(RuntimeException)ã€‚ä¸€èˆ¬æ¥è®²ï¼Œå¦‚æœæ²¡æœ‰ç‰¹æ®Šçš„è¦æ±‚ï¼Œæˆ‘ä»¬å»ºè®®ä½¿ç”¨ RuntimeException å¼‚å¸¸ã€‚</p>\n<h3 id=\"3-JVM-æ˜¯å¦‚ä½•å¤„ç†å¼‚å¸¸çš„ï¼Ÿ\"><a href=\"#3-JVM-æ˜¯å¦‚ä½•å¤„ç†å¼‚å¸¸çš„ï¼Ÿ\" class=\"headerlink\" title=\"3. JVM æ˜¯å¦‚ä½•å¤„ç†å¼‚å¸¸çš„ï¼Ÿ\"></a>3. JVM æ˜¯å¦‚ä½•å¤„ç†å¼‚å¸¸çš„ï¼Ÿ</h3><p>åœ¨ä¸€ä¸ªæ–¹æ³•ä¸­å¦‚æœå‘ç”Ÿå¼‚å¸¸ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šåˆ›å»ºä¸€ä¸ªå¼‚å¸¸å¯¹è±¡ï¼Œå¹¶è½¬äº¤ç»™ JVMï¼Œè¯¥å¼‚å¸¸å¯¹è±¡åŒ…å«å¼‚å¸¸åç§°ï¼Œå¼‚å¸¸æè¿°ä»¥åŠå¼‚å¸¸å‘ç”Ÿæ—¶åº”ç”¨ç¨‹åºçš„çŠ¶æ€ã€‚åˆ›å»ºå¼‚å¸¸å¯¹è±¡å¹¶è½¬äº¤ç»™ JVM çš„è¿‡ç¨‹ç§°ä¸ºæŠ›å‡ºå¼‚å¸¸ã€‚å¯èƒ½æœ‰ä¸€ç³»åˆ—çš„æ–¹æ³•è°ƒç”¨ï¼Œæœ€ç»ˆæ‰è¿›å…¥æŠ›å‡ºå¼‚å¸¸çš„æ–¹æ³•ï¼Œè¿™ä¸€ç³»åˆ—æ–¹æ³•è°ƒç”¨çš„æœ‰åºåˆ—è¡¨å«åšè°ƒç”¨æ ˆã€‚</p>\n<p>JVM ä¼šé¡ºç€è°ƒç”¨æ ˆå»æŸ¥æ‰¾çœ‹æ˜¯å¦æœ‰å¯ä»¥å¤„ç†å¼‚å¸¸çš„ä»£ç ï¼Œå¦‚æœæœ‰ï¼Œåˆ™è°ƒç”¨å¼‚å¸¸å¤„ç†ä»£ç ã€‚å½“ JVM å‘ç°å¯ä»¥å¤„ç†å¼‚å¸¸çš„ä»£ç æ—¶ï¼Œä¼šæŠŠå‘ç”Ÿçš„å¼‚å¸¸ä¼ é€’ç»™å®ƒã€‚å¦‚æœ JVM æ²¡æœ‰æ‰¾åˆ°å¯ä»¥å¤„ç†è¯¥å¼‚å¸¸çš„ä»£ç å—ï¼ŒJVM å°±ä¼šå°†è¯¥å¼‚å¸¸è½¬äº¤ç»™é»˜è®¤çš„å¼‚å¸¸å¤„ç†å™¨ï¼ˆé»˜è®¤å¤„ç†å™¨ä¸º JVM çš„ä¸€éƒ¨åˆ†ï¼‰ï¼Œé»˜è®¤å¼‚å¸¸å¤„ç†å™¨æ‰“å°å‡ºå¼‚å¸¸ä¿¡æ¯å¹¶ç»ˆæ­¢åº”ç”¨ç¨‹åºã€‚</p>\n<h3 id=\"4-throw-å’Œ-throws-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#4-throw-å’Œ-throws-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"4. throw å’Œ throws çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>4. throw å’Œ throws çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>Java ä¸­çš„å¼‚å¸¸å¤„ç†é™¤äº†åŒ…æ‹¬æ•è·å¼‚å¸¸å’Œå¤„ç†å¼‚å¸¸ä¹‹å¤–ï¼Œè¿˜åŒ…æ‹¬å£°æ˜å¼‚å¸¸å’Œæ‹‹å‡ºå¼‚å¸¸ï¼Œå¯ä»¥é€šè¿‡ throws å…³é”®å­—åœ¨æ–¹æ³•ä¸Šå£°æ˜è¯¥æ–¹æ³•è¦æ‹‹å‡ºçš„å¼‚å¸¸ï¼Œæˆ–è€…åœ¨æ–¹æ³•å†…éƒ¨é€šè¿‡ throw æ‹‹å‡ºå¼‚å¸¸å¯¹è±¡ã€‚</p>\n<p><strong>throws å…³é”®å­—å’Œ throw å…³é”®å­—åœ¨ä½¿ç”¨ä¸Šçš„å‡ ç‚¹åŒºåˆ«å¦‚ä¸‹</strong>ï¼š</p>\n<ul>\n<li>throw å…³é”®å­—ç”¨åœ¨æ–¹æ³•å†…éƒ¨ï¼Œåªèƒ½ç”¨äºæŠ›å‡ºä¸€ç§å¼‚å¸¸ï¼Œç”¨æ¥æŠ›å‡ºæ–¹æ³•æˆ–ä»£ç å—ä¸­çš„å¼‚å¸¸ï¼Œå—æŸ¥å¼‚å¸¸å’Œéå—æŸ¥å¼‚å¸¸éƒ½å¯ä»¥è¢«æŠ›å‡ºã€‚</li>\n<li>throws å…³é”®å­—ç”¨åœ¨æ–¹æ³•å£°æ˜ä¸Šï¼Œå¯ä»¥æŠ›å‡ºå¤šä¸ªå¼‚å¸¸ï¼Œç”¨æ¥æ ‡è¯†è¯¥æ–¹æ³•å¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸åˆ—è¡¨ã€‚ä¸€ä¸ªæ–¹æ³•ç”¨ throws æ ‡è¯†äº†å¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸åˆ—è¡¨ï¼Œè°ƒç”¨è¯¥æ–¹æ³•çš„æ–¹æ³•ä¸­å¿…é¡»åŒ…å«å¯å¤„ç†å¼‚å¸¸çš„ä»£ç ï¼Œå¦åˆ™ä¹Ÿè¦åœ¨æ–¹æ³•ç­¾åä¸­ç”¨ throws å…³é”®å­—å£°æ˜ç›¸åº”çš„å¼‚å¸¸ã€‚</li>\n</ul>\n<h3 id=\"5-try-catch-finally-ä¸­ï¼Œå¦‚æœ-catch-ä¸­-return-äº†ï¼Œfinally-è¿˜ä¼šæ‰§è¡Œå—ï¼Ÿ\"><a href=\"#5-try-catch-finally-ä¸­ï¼Œå¦‚æœ-catch-ä¸­-return-äº†ï¼Œfinally-è¿˜ä¼šæ‰§è¡Œå—ï¼Ÿ\" class=\"headerlink\" title=\"5. try-catch-finally ä¸­ï¼Œå¦‚æœ catch ä¸­ return äº†ï¼Œfinally è¿˜ä¼šæ‰§è¡Œå—ï¼Ÿ\"></a>5. try-catch-finally ä¸­ï¼Œå¦‚æœ catch ä¸­ return äº†ï¼Œfinally è¿˜ä¼šæ‰§è¡Œå—ï¼Ÿ</h3><p><strong>ç­”ï¼šä¼šæ‰§è¡Œï¼Œåœ¨ return å‰æ‰§è¡Œã€‚</strong></p>\n<p><strong>ä»£ç ç¤ºä¾‹1ï¼š</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"title function_\">getInt</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">a</span> <span class=\"operator\">=</span> <span class=\"number\">10</span>;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        System.out.println(a / <span class=\"number\">0</span>);</span><br><span class=\"line\">        a = <span class=\"number\">20</span>;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (ArithmeticException e) &#123;</span><br><span class=\"line\">        a = <span class=\"number\">30</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> a;\t<span class=\"comment\">// ä¸ä¼šç›´æ¥returnï¼Œå…ˆæ‰§è¡Œfinallyï¼Œfinallyæ‰§è¡Œè¿‡åå›æ¥æ‰§è¡Œreturn a</span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">        a = <span class=\"number\">40</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> a;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>æ‰§è¡Œç»“æœï¼š30</p>\n<p><strong>ä»£ç ç¤ºä¾‹2ï¼š</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"title function_\">getInt</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">a</span> <span class=\"operator\">=</span> <span class=\"number\">10</span>;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        System.out.println(a / <span class=\"number\">0</span>);</span><br><span class=\"line\">        a = <span class=\"number\">20</span>;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (ArithmeticException e) &#123;</span><br><span class=\"line\">        a = <span class=\"number\">30</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> a;\t<span class=\"comment\">// ä¸ä¼šç›´æ¥returnï¼Œå…ˆæ‰§è¡Œfinally</span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">        a = <span class=\"number\">40</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> a;\t<span class=\"comment\">// finallyä¸­æœ‰returnå°±ç›´æ¥returnäº†</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>æ‰§è¡Œç»“æœï¼š40</p>\n<h3 id=\"6-ç±»-ExampleA-ç»§æ‰¿-Exceptionï¼Œç±»-ExampleB-ç»§æ‰¿ExampleAã€‚\"><a href=\"#6-ç±»-ExampleA-ç»§æ‰¿-Exceptionï¼Œç±»-ExampleB-ç»§æ‰¿ExampleAã€‚\" class=\"headerlink\" title=\"6. ç±» ExampleA ç»§æ‰¿ Exceptionï¼Œç±» ExampleB ç»§æ‰¿ExampleAã€‚\"></a>6. ç±» ExampleA ç»§æ‰¿ Exceptionï¼Œç±» ExampleB ç»§æ‰¿ExampleAã€‚</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ExceptionA</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">Exception</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">ExceptionA</span><span class=\"params\">(String message)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">super</span>(message);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ExceptionB</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">ExceptionA</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">ExceptionB</span><span class=\"params\">(String message)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">super</span>(message);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ExceptionB</span>(<span class=\"string\">&quot;a&quot;</span>);</span><br><span class=\"line\">&#125; <span class=\"keyword\">catch</span> (ExceptionA ea) &#123;</span><br><span class=\"line\">  System.out.println(<span class=\"string\">&quot;ExceptionA&quot;</span>);</span><br><span class=\"line\">&#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">  System.out.println(<span class=\"string\">&quot;Exception&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>è¾“å‡ºï¼šExampleAã€‚ï¼ˆæ ¹æ®é‡Œæ°ä»£æ¢åŸåˆ™[èƒ½ä½¿ç”¨çˆ¶ç±»å‹çš„åœ°æ–¹ä¸€å®šèƒ½ä½¿ç”¨å­ç±»å‹]ï¼ŒæŠ“å– ExceptionA ç±»å‹å¼‚å¸¸çš„ catch å—èƒ½å¤ŸæŠ“ä½ try å—ä¸­æŠ›å‡ºçš„ ExceptionB ç±»å‹çš„å¼‚å¸¸ï¼‰</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ExceptionB</span>(<span class=\"string\">&quot;b&quot;</span>);</span><br><span class=\"line\">&#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">  System.out.println(<span class=\"string\">&quot;Exception: &quot;</span> + e);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>è¾“å‡ºï¼šException: com.yaxing.demo.exceptiondemo.ExceptionB: bï¼Œä»ä¼šä½¿ç”¨å­ç±»å‹ã€‚</p>\n<p>é¢è¯•é¢˜ - è¯´å‡ºä¸‹é¢ä»£ç çš„è¿è¡Œç»“æœã€‚ï¼ˆæ­¤é¢˜çš„å‡ºå¤„æ˜¯ã€ŠJava ç¼–ç¨‹æ€æƒ³ã€‹ä¸€ä¹¦ï¼‰</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Annoyance</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">Exception</span> &#123;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Sneeze</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">Annoyance</span> &#123;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Human</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Sneeze</span>();</span><br><span class=\"line\">\t\t\t&#125; <span class=\"keyword\">catch</span> ( Annoyance a ) &#123;</span><br><span class=\"line\">\t\t\t\tSystem.out.println(<span class=\"string\">&quot;Caught Annoyance&quot;</span>);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">throw</span> a;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">catch</span> ( Sneeze s ) &#123;</span><br><span class=\"line\">\t\t\tSystem.out.println(<span class=\"string\">&quot;Caught Sneeze&quot;</span>);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> ;</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">\t\t\tSystem.out.println(<span class=\"string\">&quot;Hello World!&quot;</span>);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>ç»“æœ</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Caught Annoyance</span><br><span class=\"line\">Caught Sneeze</span><br><span class=\"line\">Hello World!</span><br></pre></td></tr></table></figure>"},{"title":"Javaå…«è‚¡æ–‡ - Javaå¹¶å‘","copyright":true,"mathjax":false,"date":"2023-01-23T07:29:48.000Z","toc":true,"urlname":"java-concurrent-programming","_content":"\n> æ•´ç†çš„Javaå¹¶å‘ç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½\t<!--more-->\n\n## åŸºç¡€çŸ¥è¯†\n\n### å¹¶å‘ç¼–ç¨‹çš„ä¼˜ç¼ºç‚¹\n\nä¼˜ç‚¹ï¼šä¸ºäº†èƒ½æé«˜ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡ï¼Œæé«˜ç¨‹åºè¿è¡Œé€Ÿåº¦ï¼›\n\nç¼ºç‚¹ï¼šå­˜åœ¨å†…å­˜æ³„æ¼ã€ä¸Šä¸‹æ–‡åˆ‡æ¢ã€çº¿ç¨‹å®‰å…¨ã€æ­»é”ç­‰é—®é¢˜ã€‚\n\n#### å¹¶å‘ç¼–ç¨‹ä¸‰è¦ç´ æ˜¯ä»€ä¹ˆï¼Ÿåœ¨ Java ç¨‹åºä¸­æ€ä¹ˆä¿è¯å¤šçº¿ç¨‹çš„è¿è¡Œå®‰å…¨ï¼Ÿ\n\nå¹¶å‘ç¼–ç¨‹ä¸‰è¦ç´ ï¼ˆçº¿ç¨‹çš„å®‰å…¨æ€§é—®é¢˜ä½“ç°åœ¨ï¼‰ï¼š\n\n**åŸå­æ€§**ï¼šåŸå­ï¼Œå³ä¸€ä¸ªä¸å¯å†è¢«åˆ†å‰²çš„é¢—ç²’ã€‚åŸå­æ€§æŒ‡çš„æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªæ“ä½œè¦ä¹ˆå…¨éƒ¨æ‰§è¡ŒæˆåŠŸè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œå¤±è´¥ã€‚ï¼ˆsynchronizedï¼ŒLockï¼‰ï¼ˆçº¿ç¨‹åˆ‡æ¢å¼•èµ·çš„åŸå­æ€§é—®é¢˜ï¼‰\n\n**å¯è§æ€§**ï¼šä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡çš„ä¿®æ”¹ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹èƒ½å¤Ÿç«‹åˆ»çœ‹åˆ°ã€‚ï¼ˆsynchronizedï¼ŒLockï¼Œvolatileï¼‰ï¼ˆJMM å†…å­˜æ¨¡å‹å¯¼è‡´çš„å¯è§æ€§é—®é¢˜ï¼‰\n\n**æœ‰åºæ€§**ï¼šç¨‹åºæ‰§è¡Œçš„é¡ºåºæŒ‰ç…§ä»£ç çš„å…ˆåé¡ºåºæ‰§è¡Œã€‚ï¼ˆsynchronizedï¼ŒLockï¼Œvolatileï¼‰ï¼ˆæŒ‡ä»¤é‡æ’åºå¸¦æ¥çš„æœ‰åºæ€§é—®é¢˜ï¼‰\n\n> volatileä¸èƒ½ä¿è¯å¹¶å‘å®‰å…¨ï¼Œæ¯”å¦‚å¤šçº¿ç¨‹å¯¹ä¸€ä¸ªvolatileçš„intå˜é‡è¿›è¡ŒåŠ 1æ“ä½œï¼Œæœ€ç»ˆå¾—åˆ°çš„æ•°å­—å¯èƒ½æ¯”é¢„æœŸå°ï¼Œå°±æ˜¯å› ä¸º++æ“ä½œä¸æ˜¯åŸå­æ€§çš„ï¼Œè€Œvolatileä¹Ÿä¸èƒ½ä¿è¯åŸå­æ€§ï¼Œæ‰€ä»¥å°±ä¼šæœ‰è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨`atomicInteger.getAndSet()`åŸå­æ“ä½œã€‚\n\n### çº¿ç¨‹å’Œè¿›ç¨‹\n\n#### è¿›ç¨‹é—´çš„é€šä¿¡æ–¹å¼\n\n1. **ç®¡é“/åŒ¿åç®¡é“(Pipes)** ï¼šç”¨äºå…·æœ‰äº²ç¼˜å…³ç³»çš„çˆ¶å­è¿›ç¨‹é—´æˆ–è€…å…„å¼Ÿè¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼›\n2. **æœ‰åç®¡é“(Names Pipes)**ï¼šåŒ¿åç®¡é“ç”±äºæ²¡æœ‰åå­—ï¼Œåªèƒ½ç”¨äºäº²ç¼˜å…³ç³»çš„è¿›ç¨‹é—´é€šä¿¡ã€‚ä¸ºäº†å…‹æœè¿™ä¸ªç¼ºç‚¹ï¼Œæå‡ºäº†æœ‰åç®¡é“ã€‚æœ‰åç®¡é“ä¸¥æ ¼éµå¾ª**å…ˆè¿›å…ˆå‡º(first in first out)**ã€‚æœ‰åç®¡é“ä»¥ç£ç›˜æ–‡ä»¶çš„æ–¹å¼å­˜åœ¨ï¼Œå¯ä»¥å®ç°æœ¬æœºä»»æ„ä¸¤ä¸ªè¿›ç¨‹é€šä¿¡ï¼›\n3. **ä¿¡å·(Signal)** ï¼šä¿¡å·æ˜¯ä¸€ç§æ¯”è¾ƒå¤æ‚çš„é€šä¿¡æ–¹å¼ï¼Œç”¨äºé€šçŸ¥æ¥æ”¶è¿›ç¨‹æŸä¸ªäº‹ä»¶å·²ç»å‘ç”Ÿï¼›\n4. **æ¶ˆæ¯é˜Ÿåˆ—(Message Queuing)** ï¼šæ¶ˆæ¯é˜Ÿåˆ—æ˜¯æ¶ˆæ¯çš„é“¾è¡¨ï¼Œå…·æœ‰ç‰¹å®šçš„æ ¼å¼ï¼Œå­˜æ”¾åœ¨å†…å­˜ä¸­å¹¶ç”±æ¶ˆæ¯é˜Ÿåˆ—æ ‡è¯†ç¬¦æ ‡è¯†ã€‚**æ¶ˆæ¯é˜Ÿåˆ—å…‹æœäº†ä¿¡å·æ‰¿è½½ä¿¡æ¯é‡å°‘ï¼Œç®¡é“åªèƒ½æ‰¿è½½æ— æ ¼å¼å­—èŠ‚æµä»¥åŠç¼“å†²åŒºå¤§å°å—é™ç­‰ç¼ºç‚¹**ï¼›\n5. **ä¿¡å·é‡(Semaphores)** ï¼šä¿¡å·é‡æ˜¯ä¸€ä¸ªè®¡æ•°å™¨ï¼Œç”¨äºå¤šè¿›ç¨‹å¯¹å…±äº«æ•°æ®çš„è®¿é—®ï¼Œä¿¡å·é‡çš„æ„å›¾åœ¨äºè¿›ç¨‹é—´åŒæ­¥ã€‚è¿™ç§é€šä¿¡æ–¹å¼ä¸»è¦ç”¨äºè§£å†³ä¸åŒæ­¥ç›¸å…³çš„é—®é¢˜å¹¶é¿å…ç«äº‰æ¡ä»¶ï¼›\n6. **å…±äº«å†…å­˜(Shared memory)** ï¼šä½¿å¾—å¤šä¸ªè¿›ç¨‹å¯ä»¥è®¿é—®åŒä¸€å—å†…å­˜ç©ºé—´ï¼Œä¸åŒè¿›ç¨‹å¯ä»¥åŠæ—¶çœ‹åˆ°å¯¹æ–¹è¿›ç¨‹ä¸­å¯¹å…±äº«å†…å­˜ä¸­æ•°æ®çš„æ›´æ–°ã€‚è¿™ç§æ–¹å¼éœ€è¦ä¾é æŸç§åŒæ­¥æ“ä½œï¼Œå¦‚äº’æ–¥é”å’Œä¿¡å·é‡ç­‰ã€‚å¯ä»¥è¯´è¿™æ˜¯æœ€æœ‰ç”¨çš„è¿›ç¨‹é—´é€šä¿¡æ–¹å¼ï¼›\n7. **å¥—æ¥å­—(Sockets)**ï¼šæ­¤æ–¹æ³•ä¸»è¦ç”¨äºåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´é€šè¿‡ç½‘ç»œè¿›è¡Œé€šä¿¡ã€‚å¥—æ¥å­—æ˜¯æ”¯æŒ TCP/IP çš„ç½‘ç»œé€šä¿¡çš„åŸºæœ¬æ“ä½œå•å…ƒï¼Œå¯ä»¥çœ‹åšæ˜¯ä¸åŒä¸»æœºä¹‹é—´çš„è¿›ç¨‹è¿›è¡ŒåŒå‘é€šä¿¡çš„ç«¯ç‚¹ï¼Œç®€å•çš„è¯´å°±æ˜¯é€šä¿¡çš„ä¸¤æ–¹çš„ä¸€ç§çº¦å®šï¼Œç”¨å¥—æ¥å­—ä¸­çš„ç›¸å…³å‡½æ•°æ¥å®Œæˆé€šä¿¡è¿‡ç¨‹ã€‚\n\n#### çº¿ç¨‹é—´çš„åŒæ­¥æ–¹å¼\n\nçº¿ç¨‹åŒæ­¥æ˜¯ä¸¤ä¸ªæˆ–å¤šä¸ªå…±äº«å…³é”®èµ„æºçš„çº¿ç¨‹çš„å¹¶å‘æ‰§è¡Œã€‚åº”è¯¥åŒæ­¥çº¿ç¨‹ä»¥é¿å…å…³é”®çš„èµ„æºä½¿ç”¨å†²çªã€‚\n\n1. **äº’æ–¥é‡(Mutex)**ï¼šé‡‡ç”¨äº’æ–¥å¯¹è±¡æœºåˆ¶ï¼Œåªæœ‰æ‹¥æœ‰äº’æ–¥å¯¹è±¡çš„çº¿ç¨‹æ‰æœ‰è®¿é—®å…¬å…±èµ„æºçš„æƒé™ã€‚å› ä¸ºäº’æ–¥å¯¹è±¡åªæœ‰ä¸€ä¸ªï¼Œæ‰€ä»¥å¯ä»¥ä¿è¯å…¬å…±èµ„æºä¸ä¼šè¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®ï¼Œæ¯”å¦‚ Java ä¸­çš„ synchronized å…³é”®è¯å’Œå„ç§ Lock éƒ½æ˜¯è¿™ç§æœºåˆ¶ï¼›\n2. **ä¿¡å·é‡(Semphares)** ï¼šå®ƒå…è®¸åŒä¸€æ—¶åˆ»å¤šä¸ªçº¿ç¨‹è®¿é—®åŒä¸€èµ„æºï¼Œä½†æ˜¯éœ€è¦æ§åˆ¶åŒä¸€æ—¶åˆ»è®¿é—®æ­¤èµ„æºçš„æœ€å¤§çº¿ç¨‹æ•°é‡ï¼›\n3. **äº‹ä»¶(Event)** ï¼šwait/notifyï¼šé€šè¿‡é€šçŸ¥æ“ä½œçš„æ–¹å¼æ¥ä¿æŒå¤šçº¿ç¨‹åŒæ­¥ï¼Œè¿˜å¯ä»¥æ–¹ä¾¿çš„å®ç°å¤šçº¿ç¨‹ä¼˜å…ˆçº§çš„æ¯”è¾ƒæ“ä½œã€‚\n\n#### ä»€ä¹ˆæ˜¯çº¿ç¨‹å’Œè¿›ç¨‹?\n\n**è¿›ç¨‹**ï¼šè¿›ç¨‹æ˜¯åº”ç”¨ç¨‹åºçš„ä¸€æ¬¡è¿è¡Œï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„å†…å­˜ç©ºé—´ï¼Œæ˜¯æ“ä½œç³»ç»Ÿèµ„æºåˆ†é…çš„åŸºæœ¬å•ä½ï¼›\n\n**çº¿ç¨‹**ï¼šçº¿ç¨‹æ˜¯å¤„ç†å™¨è°ƒåº¦å’Œæ‰§è¡Œçš„åŸºæœ¬å•ä½ï¼Œä¸€ä¸ªè¿›ç¨‹ä¸­å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹ï¼Œçº¿ç¨‹å…±äº«è¿›ç¨‹çš„å†…å­˜ç©ºé—´å’Œèµ„æºã€‚\n\n#### ä»€ä¹ˆæ˜¯ä¸Šä¸‹æ–‡åˆ‡æ¢?\n\nå¤šçº¿ç¨‹ç¼–ç¨‹ä¸­ä¸€èˆ¬çº¿ç¨‹çš„ä¸ªæ•°éƒ½å¤§äº CPU æ ¸å¿ƒçš„ä¸ªæ•°ï¼Œè€Œä¸€ä¸ª CPU æ ¸å¿ƒåœ¨ä»»æ„æ—¶åˆ»åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨ï¼Œä¸ºäº†è®©è¿™äº›çº¿ç¨‹éƒ½èƒ½å¾—åˆ°æœ‰æ•ˆæ‰§è¡Œï¼ŒCPU é‡‡å–çš„ç­–ç•¥æ˜¯ä¸ºæ¯ä¸ªçº¿ç¨‹åˆ†é…æ—¶é—´ç‰‡å¹¶è½®è½¬çš„å½¢å¼ã€‚\n\nå½“å‰ä»»åŠ¡åœ¨æ‰§è¡Œå®Œ CPU æ—¶é—´ç‰‡åˆ‡æ¢åˆ°å¦ä¸€ä¸ªä»»åŠ¡ä¹‹å‰ä¼šå…ˆä¿å­˜è‡ªå·±çš„çŠ¶æ€ï¼Œä»¥ä¾¿ä¸‹æ¬¡å†åˆ‡æ¢å›è¿™ä¸ªä»»åŠ¡æ—¶ï¼Œå¯ä»¥å†åŠ è½½è¿™ä¸ªä»»åŠ¡çš„çŠ¶æ€ã€‚**ä»»åŠ¡ä»ä¿å­˜åˆ°å†åŠ è½½çš„è¿‡ç¨‹å°±æ˜¯ä¸€æ¬¡ä¸Šä¸‹æ–‡åˆ‡æ¢**ã€‚\n\nä¸Šä¸‹æ–‡åˆ‡æ¢å¯¹ç³»ç»Ÿæ¥è¯´æ„å‘³ç€æ¶ˆè€—å¤§é‡çš„ CPU æ—¶é—´ï¼Œäº‹å®ä¸Šï¼Œå¯èƒ½æ˜¯æ“ä½œç³»ç»Ÿä¸­æ—¶é—´æ¶ˆè€—æœ€å¤§çš„æ“ä½œã€‚\n\n#### å®ˆæŠ¤çº¿ç¨‹å’Œç”¨æˆ·çº¿ç¨‹æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ\n\n- **ç”¨æˆ· (User) çº¿ç¨‹**ï¼šè¿è¡Œåœ¨å‰å°ï¼Œæ‰§è¡Œå…·ä½“çš„ä»»åŠ¡\n- **å®ˆæŠ¤ (Daemon) çº¿ç¨‹**ï¼šè¿è¡Œåœ¨åå°ï¼Œä¸ºå…¶ä»–å‰å°çº¿ç¨‹æœåŠ¡ã€‚ä¸€æ—¦æ‰€æœ‰ç”¨æˆ·çº¿ç¨‹éƒ½ç»“æŸè¿è¡Œï¼Œå®ˆæŠ¤çº¿ç¨‹ä¼šéš JVM ä¸€èµ·ç»“æŸå·¥ä½œ\n\n**æ³¨æ„äº‹é¡¹ï¼š**\n\n1. `setDaemon(true)`å¿…é¡»åœ¨`start()`æ–¹æ³•å‰æ‰§è¡Œï¼Œå¦åˆ™ä¼šæŠ›å‡º `IllegalThreadStateException` å¼‚å¸¸ï¼›\n2. åœ¨å®ˆæŠ¤çº¿ç¨‹ä¸­äº§ç”Ÿçš„æ–°çº¿ç¨‹ä¹Ÿæ˜¯å®ˆæŠ¤çº¿ç¨‹ï¼›\n3. ä¸æ˜¯æ‰€æœ‰çš„ä»»åŠ¡éƒ½å¯ä»¥åˆ†é…ç»™å®ˆæŠ¤çº¿ç¨‹æ¥æ‰§è¡Œï¼Œæ¯”å¦‚è¯»å†™æ“ä½œæˆ–è€…è®¡ç®—é€»è¾‘ï¼›\n4. å®ˆæŠ¤ (Daemon) çº¿ç¨‹ä¸­ä¸èƒ½ä¾é  finally å—çš„å†…å®¹æ¥ç¡®ä¿æ‰§è¡Œå…³é—­æˆ–æ¸…ç†èµ„æºçš„é€»è¾‘ã€‚å› ä¸ºæˆ‘ä»¬ä¸Šé¢ä¹Ÿè¯´è¿‡äº†ä¸€æ—¦æ‰€æœ‰ç”¨æˆ·çº¿ç¨‹éƒ½ç»“æŸè¿è¡Œï¼Œå®ˆæŠ¤çº¿ç¨‹ä¼šéš JVM ä¸€èµ·ç»“æŸå·¥ä½œï¼Œæ‰€ä»¥å®ˆæŠ¤ (Daemon) çº¿ç¨‹ä¸­çš„ finally è¯­å¥å—å¯èƒ½æ— æ³•è¢«æ‰§è¡Œã€‚\n\n#### å¦‚ä½•åœ¨ Windows å’Œ Linux ä¸ŠæŸ¥æ‰¾å“ªä¸ªçº¿ç¨‹cpuåˆ©ç”¨ç‡æœ€é«˜ï¼Ÿ\n\nWindows ä¸‹ç”¨ä»»åŠ¡ç®¡ç†å™¨çœ‹ï¼ŒLinux ä¸‹å¯ä»¥ç”¨ top è¿™ä¸ªå‘½ä»¤çœ‹ã€‚\n\n#### ä»€ä¹ˆæ˜¯çº¿ç¨‹æ­»é”\n\næ­»é”æ˜¯æŒ‡ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„çº¿ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œç”±äºç«äº‰èµ„æºé€ æˆçš„ä¸€ç§é˜»å¡çš„ç°è±¡ï¼Œè‹¥æ— å¤–åŠ›ä½œç”¨ï¼Œå®ƒä»¬éƒ½å°†æ— æ³•æ¨è¿›ä¸‹å»ã€‚\n\nå¦‚å›¾æ‰€ç¤ºï¼Œçº¿ç¨‹ A æŒæœ‰èµ„æº 2ï¼Œçº¿ç¨‹ B æŒæœ‰èµ„æº 1ï¼Œä»–ä»¬åŒæ—¶éƒ½æƒ³ç”³è¯·å¯¹æ–¹çš„èµ„æºï¼Œè¿™ä¸¤ä¸ªçº¿ç¨‹å°±ä¼šäº’ç›¸ç­‰å¾…è€Œè¿›å…¥æ­»é”çŠ¶æ€ã€‚\n\n![çº¿ç¨‹æ­»é”](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/202206152131355.png)\n\nä¸‹é¢é€šè¿‡ä»£ç æ¨¡æ‹Ÿäº†ä¸Šå›¾çš„æ­»é”çš„æƒ…å†µï¼ˆä»£ç æ¥æºäºã€Šå¹¶å‘ç¼–ç¨‹ä¹‹ç¾ã€‹ï¼‰ï¼š\n\n```java\npublic class DeadLockDemo {\n    private static Object resource1 = new Object();\t//èµ„æº 1\n    private static Object resource2 = new Object();\t//èµ„æº 2\n\n    public static void main(String[] args) {\n        new Thread(() -> {\n            synchronized (resource1) {\n                System.out.println(Thread.currentThread() + \"get resource1\");\n                try {\n                    Thread.sleep(1000);\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n                System.out.println(Thread.currentThread() + \"waiting get resource2\");\n                synchronized (resource2) {\n                    System.out.println(Thread.currentThread() + \"get resource2\");\n                }\n            }\n        }, \"çº¿ç¨‹ 1\").start();\n\n        new Thread(() -> {\n            synchronized (resource2) {\n                System.out.println(Thread.currentThread() + \"get resource2\");\n                try {\n                    Thread.sleep(1000);\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n                System.out.println(Thread.currentThread() + \"waiting get resource1\");\n                synchronized (resource1) {\n                    System.out.println(Thread.currentThread() + \"get resource1\");\n                }\n            }\n        }, \"çº¿ç¨‹ 2\").start();\n    }\n}\n```\n\nè¾“å‡ºç»“æœ\n\n```java\nThread[çº¿ç¨‹ 1,5,main]get resource1\nThread[çº¿ç¨‹ 2,5,main]get resource2\nThread[çº¿ç¨‹ 1,5,main]waiting get resource2\nThread[çº¿ç¨‹ 2,5,main]waiting get resource1\n```\n\nçº¿ç¨‹ A é€šè¿‡ synchronized (resource1) è·å¾— resource1 çš„ç›‘è§†å™¨é”ï¼Œç„¶åé€šè¿‡`Thread.sleep(1000)`ï¼›è®©çº¿ç¨‹ A ä¼‘çœ  1s ä¸ºçš„æ˜¯è®©çº¿ç¨‹ B å¾—åˆ° CPU æ‰§è¡Œæƒï¼Œç„¶åè·å–åˆ° resource2 çš„ç›‘è§†å™¨é”ã€‚çº¿ç¨‹ A å’Œçº¿ç¨‹ B ä¼‘çœ ç»“æŸäº†éƒ½å¼€å§‹ä¼å›¾è¯·æ±‚è·å–å¯¹æ–¹çš„èµ„æºï¼Œç„¶åè¿™ä¸¤ä¸ªçº¿ç¨‹å°±ä¼šé™·å…¥äº’ç›¸ç­‰å¾…çš„çŠ¶æ€ï¼Œè¿™ä¹Ÿå°±äº§ç”Ÿäº†æ­»é”ã€‚ä¸Šé¢çš„ä¾‹å­ç¬¦åˆäº§ç”Ÿæ­»é”çš„å››ä¸ªå¿…è¦æ¡ä»¶ã€‚\n\n#### å½¢æˆæ­»é”çš„å››ä¸ªå¿…è¦æ¡ä»¶æ˜¯ä»€ä¹ˆ\n\n1. äº’æ–¥æ¡ä»¶ï¼šä¸€ä¸ªèµ„æºåªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹å ç”¨ï¼Œç›´åˆ°è¢«è¯¥çº¿ç¨‹é‡Šæ”¾ï¼›\n2. è¯·æ±‚ä¸ä¿æŒæ¡ä»¶ï¼šä¸€ä¸ªçº¿ç¨‹å› è¯·æ±‚è¢«å ç”¨èµ„æºè€Œå‘ç”Ÿé˜»å¡æ—¶ï¼Œå¯¹å·²è·å¾—çš„èµ„æºä¿æŒä¸æ”¾ï¼›\n3. ä¸å‰¥å¤ºæ¡ä»¶ï¼šçº¿ç¨‹å·²è·å¾—çš„èµ„æºåœ¨æœ«ä½¿ç”¨å®Œä¹‹å‰ä¸èƒ½è¢«å…¶ä»–çº¿ç¨‹å¼ºè¡Œå‰¥å¤ºï¼Œåªæœ‰è‡ªå·±ä½¿ç”¨å®Œæ¯•åæ‰é‡Šæ”¾èµ„æºï¼›\n4. å¾ªç¯ç­‰å¾…æ¡ä»¶ï¼šå½“å‘ç”Ÿæ­»é”æ—¶ï¼Œæ‰€ç­‰å¾…çš„çº¿ç¨‹å¿…å®šä¼šå½¢æˆä¸€ä¸ªç¯è·¯ï¼ˆç±»ä¼¼äºæ­»å¾ªç¯ï¼‰ï¼Œé€ æˆæ°¸ä¹…é˜»å¡ã€‚\n\n#### å¦‚ä½•é¿å…çº¿ç¨‹æ­»é”\n\næˆ‘ä»¬åªè¦ç ´åäº§ç”Ÿæ­»é”çš„å››ä¸ªæ¡ä»¶ä¸­çš„å…¶ä¸­ä¸€ä¸ªå°±å¯ä»¥äº†ã€‚\n\n**ç ´åäº’æ–¥æ¡ä»¶**ï¼šæ— æ³•ç ´åï¼Œå› ä¸ºæˆ‘ä»¬ç”¨é”æœ¬æ¥å°±æ˜¯æƒ³å®ç°äº’æ–¥è®¿é—®ä¸´ç•Œèµ„æºï¼›\n\n**ç ´åè¯·æ±‚ä¸ä¿æŒæ¡ä»¶**ï¼šä¸€æ¬¡æ€§ç”³è¯·æ‰€æœ‰çš„èµ„æºï¼›\n\n**ç ´åä¸å‰¥å¤ºæ¡ä»¶**ï¼šå ç”¨éƒ¨åˆ†èµ„æºçš„çº¿ç¨‹è¿›ä¸€æ­¥ç”³è¯·å…¶ä»–èµ„æºæ—¶ï¼Œ**å¦‚æœç”³è¯·ä¸åˆ°ï¼Œå¯ä»¥ä¸»åŠ¨é‡Šæ”¾å®ƒå æœ‰çš„èµ„æº**ï¼›\n\n**ç ´åå¾ªç¯ç­‰å¾…æ¡ä»¶**ï¼šé **æŒ‰åºç”³è¯·**èµ„æºæ¥é¢„é˜²ã€‚æŒ‰æŸä¸€é¡ºåºç”³è¯·èµ„æºï¼Œé‡Šæ”¾èµ„æºåˆ™ååºé‡Šæ”¾ã€‚ç ´åå¾ªç¯ç­‰å¾…æ¡ä»¶ã€‚\n\næˆ‘ä»¬å¯¹çº¿ç¨‹ 2 çš„ä»£ç ä¿®æ”¹æˆä¸‹é¢è¿™æ ·å°±ä¸ä¼šäº§ç”Ÿæ­»é”äº†ã€‚\n\n```java\nnew Thread(() -> {\n    synchronized (resource1) {\n        System.out.println(Thread.currentThread() + \"get resource1\");\n        try {\n            Thread.sleep(1000);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        System.out.println(Thread.currentThread() + \"waiting get resource2\");\n        synchronized (resource2) {\n            System.out.println(Thread.currentThread() + \"get resource2\");\n        }\n    }\n}, \"çº¿ç¨‹ 2\").start();\n```\n\nè¾“å‡ºç»“æœ\n\n```java\nThread[çº¿ç¨‹ 1,5,main]get resource1\nThread[çº¿ç¨‹ 1,5,main]waiting get resource2\nThread[çº¿ç¨‹ 1,5,main]get resource2\nThread[çº¿ç¨‹ 2,5,main]get resource1\nThread[çº¿ç¨‹ 2,5,main]waiting get resource2\nThread[çº¿ç¨‹ 2,5,main]get resource2\n```\n\næˆ‘ä»¬åˆ†æä¸€ä¸‹ä¸Šé¢çš„ä»£ç ä¸ºä»€ä¹ˆé¿å…äº†æ­»é”çš„å‘ç”Ÿ?\n\nçº¿ç¨‹ 1 é¦–å…ˆè·å¾—åˆ° resource1 çš„ç›‘è§†å™¨é”ï¼Œè¿™æ—¶å€™çº¿ç¨‹ 2 å°±è·å–ä¸åˆ°äº†ã€‚ç„¶åçº¿ç¨‹ 1 å†å»è·å– resource2 çš„ç›‘è§†å™¨é”ï¼Œå¯ä»¥è·å–åˆ°ã€‚ç„¶åçº¿ç¨‹ 1 é‡Šæ”¾äº†å¯¹ resource1ã€resource2 çš„ç›‘è§†å™¨é”çš„å ç”¨ï¼Œçº¿ç¨‹ 2 è·å–åˆ°å°±å¯ä»¥æ‰§è¡Œäº†ã€‚è¿™æ ·å°±ç ´åäº†ç ´åå¾ªç¯ç­‰å¾…æ¡ä»¶ï¼Œå› æ­¤é¿å…äº†æ­»é”ã€‚\n\n#### åˆ›å»ºçº¿ç¨‹æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ\n\nåˆ›å»ºçº¿ç¨‹æœ‰å››ç§æ–¹å¼ï¼š\n\n- ç»§æ‰¿ Thread ç±»\n- å®ç° Runnable æ¥å£\n- å®ç° Callable æ¥å£\n- ä½¿ç”¨ Executors å·¥å…·ç±»åˆ›å»ºçº¿ç¨‹æ± \n\n**ç»§æ‰¿ Thread ç±»**\n\n1. å®šä¹‰ä¸€ä¸ª Thread ç±»çš„å­ç±»ï¼Œé‡å†™ run æ–¹æ³•ï¼›\n2. åˆ›å»ºè‡ªå®šä¹‰çš„çº¿ç¨‹å­ç±»å¯¹è±¡ï¼›\n3. è°ƒç”¨å­ç±»å®ä¾‹çš„ start() æ–¹æ³•æ¥å¯åŠ¨çº¿ç¨‹ã€‚\n\n```java\npublic class Main {\n    static class MyThread extends Thread {\n        @Override\n        public void run() {\n            System.out.println(Thread.currentThread().getName() + \" run()æ–¹æ³•æ­£åœ¨æ‰§è¡Œ...\");\n        }\n    }\n    public static void main(String[] args) {\n        new MyThread().start();\n        try {\n            Thread.sleep(10);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        System.out.println(Thread.currentThread().getName() + \" main()æ–¹æ³•æ‰§è¡Œç»“æŸ\");\n    }\n}\n```\n\n**å®ç° Runnable æ¥å£**\n\n1. å®šä¹‰ Runnable æ¥å£å®ç°ç±» MyRunnableï¼Œå¹¶é‡å†™ run() æ–¹æ³•ï¼›\n2. åˆ›å»º MyRunnable å®ä¾‹ myRunnableï¼Œä»¥ myRunnable ä½œä¸º target åˆ›å»º Thread å®ä¾‹ï¼Œ**è¯¥Threadå¯¹è±¡æ‰æ˜¯çœŸæ­£çš„çº¿ç¨‹å¯¹è±¡**ï¼›\n3. è°ƒç”¨çº¿ç¨‹å®ä¾‹çš„ start() æ–¹æ³•ã€‚\n\n```java\npublic class Main {\n    static class MyRunnable implements Runnable {\n\n        @Override\n        public void run() {\n            System.out.println(Thread.currentThread().getName() + \" run()æ–¹æ³•æ­£åœ¨æ‰§è¡Œ...\");\n        }\n\n    }\n    public static void main(String[] args) {\n        new Thread(new MyRunnable()).start();\n        try {\n            Thread.sleep(10);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        System.out.println(Thread.currentThread().getName() + \" main()æ–¹æ³•æ‰§è¡Œç»“æŸ\");\n    }\n}\n```\n\n**å®ç° Callable æ¥å£**\n\n1. åˆ›å»ºå®ç° Callable æ¥å£çš„ç±» myCallableï¼›\n2. ä»¥ myCallable ä¸ºå‚æ•°åˆ›å»º FutureTask å¯¹è±¡ï¼›\n3. å°† FutureTask ä½œä¸ºå‚æ•°åˆ›å»º Thread å¯¹è±¡ï¼›\n4. è°ƒç”¨çº¿ç¨‹å¯¹è±¡çš„ start() æ–¹æ³•ã€‚\n\n```java\npublic class Main {\n    static class MyCallable implements Callable<Integer> {\n        @Override\n        public Integer call() throws Exception {\n            System.out.println(Thread.currentThread().getName() + \" call()æ–¹æ³•æ‰§è¡Œä¸­...\");\n            return 1;\n        }\n    }\n\n    public static void main(String[] args) {\n        FutureTask<Integer> futureTask = new FutureTask<>(new MyCallable());\n        new Thread(futureTask).start();\n        try {\n            Thread.sleep(10);\n            System.out.println(futureTask.get());\n        } catch (InterruptedException | ExecutionException e) {\n            e.printStackTrace();\n        }\n        System.out.println(Thread.currentThread().getName() + \" main()æ–¹æ³•æ‰§è¡Œå®Œæˆ\");\n    }\n}\n```\n\n**ä½¿ç”¨ Executors å·¥å…·ç±»åˆ›å»ºçº¿ç¨‹æ± **\n\nExecutors æä¾›äº†ä¸€ç³»åˆ—å·¥å‚æ–¹æ³•ç”¨äºåˆ›å»ºçº¿ç¨‹æ± ï¼Œè¿”å›çš„çº¿ç¨‹æ± éƒ½å®ç°äº† ExecutorService æ¥å£ã€‚\n\nä¸»è¦æœ‰ new[Single/Fixed/Cached/Scheduled]ThreadPool è¿™å››ç§çº¿ç¨‹æ± \n\n```java\npublic class MyRunnable implements Runnable {\n    @Override\n    public void run() {\n        System.out.println(Thread.currentThread().getName() + \" run()æ–¹æ³•æ‰§è¡Œä¸­...\");\n    }\n}\n\npublic class SingleThreadExecutorTest {n\n    public static void main(String[] args) {\n        ExecutorService executorService = Executors.newSingleThreadExecutor();\n        MyRunnable myRunnable = new MyRunnable();\n        for (int i = 0; i < 5; i++) {\n            executorService.execute(myRunnable);\n        }\n\n        System.out.println(\"çº¿ç¨‹ä»»åŠ¡å¼€å§‹æ‰§è¡Œ\");\n        executorService.shutdown();\n    }\n}\n```\n\n#### è¯´ä¸€ä¸‹ runnable å’Œ callable æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\nç›¸åŒç‚¹\n\n- éƒ½æ˜¯æ¥å£\n- éƒ½å¯ä»¥ç”¨æ¥å®ç°å¤šçº¿ç¨‹\n- éƒ½åˆ›å»º Thread å®ä¾‹å¹¶è°ƒç”¨å…¶ start() æ–¹æ³•å¯åŠ¨çº¿ç¨‹\n\nä¸»è¦åŒºåˆ«\n\n- Runnable æ¥å£ run æ–¹æ³•æ— è¿”å›å€¼ï¼›Callable æ¥å£ call æ–¹æ³•æœ‰è¿”å›å€¼ï¼Œå’Œ FutureTask é…åˆå¯ä»¥ç”¨æ¥è·å–å¼‚æ­¥æ‰§è¡Œçš„ç»“æœ\n- Runnable æ¥å£ run æ–¹æ³•æ— æ³•æ•è·å¹¶å¤„ç†å¼‚å¸¸ï¼›Callable æ¥å£ call æ–¹æ³•å¯ä»¥æ•è·å¹¶å¤„ç†å¼‚å¸¸\n\n#### çº¿ç¨‹çš„ run()å’Œ start()æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\n> start() æ–¹æ³•æ¥å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ï¼ŒçœŸæ­£å®ç°äº†å¤šçº¿ç¨‹è¿è¡Œã€‚è°ƒç”¨ start() æ–¹æ³•æ— éœ€ç­‰å¾…runæ–¹æ³•ä½“ä»£ç æ‰§è¡Œå®Œæ¯•ï¼Œå¯ä»¥ç›´æ¥ç»§ç»­æ‰§è¡Œå…¶ä»–çš„ä»£ç ï¼› æ­¤æ—¶çº¿ç¨‹æ˜¯å¤„äºå°±ç»ªçŠ¶æ€ï¼Œå¹¶æ²¡æœ‰è¿è¡Œã€‚ ç„¶åé€šè¿‡æ­¤ Thread ç±»è°ƒç”¨æ–¹æ³• run() æ¥å®Œæˆå…¶è¿è¡ŒçŠ¶æ€ï¼Œ run() æ–¹æ³•è¿è¡Œç»“æŸï¼Œ æ­¤çº¿ç¨‹ç»ˆæ­¢ã€‚ç„¶å CPU å†è°ƒåº¦å…¶å®ƒçº¿ç¨‹ã€‚\n\nstart() æ–¹æ³•ç”¨äºå¯åŠ¨çº¿ç¨‹ï¼Œrun() æ–¹æ³•ç”¨äºæ‰§è¡Œçº¿ç¨‹çš„è¿è¡Œæ—¶ä»£ç ï¼Œç›´æ¥è°ƒç”¨ run()ï¼Œå…¶å®å°±ç›¸å½“äºæ˜¯è°ƒç”¨äº†ä¸€ä¸ªæ™®é€šå‡½æ•°è€Œå·²ã€‚\nstart() åªèƒ½è°ƒç”¨ä¸€æ¬¡ï¼Œrun() å¯ä»¥é‡å¤è°ƒç”¨ã€‚\n\n#### ä»€ä¹ˆæ˜¯ Callable å’Œ Future?\n\n```java\nFutureTask<Integer> futureTask = new FutureTask<>(new MyCallable());\nnew Thread(futureTask).start();\n```\n\nå°† callable å®ä¾‹ä¼ å…¥ futureï¼Œç„¶åå°† future å®ä¾‹ä¼ å…¥ Thread åˆ›å»ºçº¿ç¨‹ï¼Œ\nä¹‹åå¯ä»¥ç”¨ future æ¥è·å– callable  ä¸­ call() çš„è¿”å›ç»“æœã€‚\n\n#### çº¿ç¨‹çš„çŠ¶æ€å’ŒåŸºæœ¬æ“ä½œ\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650518197279.png\" alt=\"çº¿ç¨‹çš„çŠ¶æ€\" style=\"zoom:67%;\" />\n\n#### Java ä¸­ç”¨åˆ°çš„çº¿ç¨‹è°ƒåº¦ç®—æ³•æ˜¯ä»€ä¹ˆï¼Ÿ\n\nçº¿ç¨‹è°ƒåº¦æ˜¯æŒ‡æŒ‰ç…§ç‰¹å®šæœºåˆ¶ä¸ºå¤šä¸ªçº¿ç¨‹åˆ†é… CPU çš„ä½¿ç”¨æƒã€‚\n\næœ‰ä¸¤ç§è°ƒåº¦æ¨¡å‹ï¼š**æ—¶é—´ç‰‡è½®è½¬**æ¨¡å‹å’Œ**ä¼˜å…ˆçº§è°ƒåº¦**æ¨¡å‹ã€‚\n\n**Java è™šæ‹Ÿæœºé‡‡ç”¨ä¼˜å…ˆçº§è°ƒåº¦æ¨¡å‹**ï¼Œæ˜¯æŒ‡ä¼˜å…ˆè®©å¯è¿è¡Œæ± ä¸­ä¼˜å…ˆçº§é«˜çš„çº¿ç¨‹å ç”¨ CPUï¼Œå¦‚æœå¯è¿è¡Œæ± ä¸­çš„çº¿ç¨‹ä¼˜å…ˆçº§ç›¸åŒï¼Œé‚£ä¹ˆå°±éšæœºé€‰æ‹©ä¸€ä¸ªçº¿ç¨‹ï¼Œä½¿å…¶å ç”¨ CPUã€‚å¤„äºè¿è¡ŒçŠ¶æ€çš„çº¿ç¨‹ä¼šä¸€ç›´è¿è¡Œï¼Œç›´è‡³å®ƒä¸å¾—ä¸æ”¾å¼ƒ CPUã€‚\n\n#### è¯·è¯´å‡ºä¸çº¿ç¨‹åŒæ­¥ä»¥åŠçº¿ç¨‹è°ƒåº¦ç›¸å…³çš„æ–¹æ³•ã€‚\n\nï¼ˆ1ï¼‰wait()ï¼šä½¿ä¸€ä¸ªçº¿ç¨‹å¤„äºç­‰å¾…çŠ¶æ€ï¼Œå¹¶ä¸”é‡Šæ”¾æ‰€æŒæœ‰çš„å¯¹è±¡çš„é”ï¼›\n\nï¼ˆ2ï¼‰sleep()ï¼šä½¿ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„çº¿ç¨‹å¤„äºç¡çœ çŠ¶æ€ï¼Œæ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼›\n\nï¼ˆ3ï¼‰notify()ï¼šå”¤é†’ä¸€ä¸ªå¤„äºç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ï¼Œå½“ç„¶åœ¨è°ƒç”¨æ­¤æ–¹æ³•çš„æ—¶å€™ï¼Œå¹¶ä¸èƒ½ç¡®åˆ‡çš„å”¤é†’æŸä¸€ä¸ªç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ï¼Œè€Œæ˜¯ç”± JVM ç¡®å®šå”¤é†’å“ªä¸ªçº¿ç¨‹ï¼Œè€Œä¸”ä¸ä¼˜å…ˆçº§æ— å…³ï¼›\n\nï¼ˆ4ï¼‰notityAll()ï¼šå”¤é†’æ‰€æœ‰å¤„äºç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ï¼Œè¯¥æ–¹æ³•å¹¶ä¸æ˜¯å°†å¯¹è±¡çš„é”ç»™æ‰€æœ‰çº¿ç¨‹ï¼Œè€Œæ˜¯è®©å®ƒä»¬ç«äº‰ï¼Œåªæœ‰è·å¾—é”çš„çº¿ç¨‹æ‰èƒ½è¿›å…¥å°±ç»ªçŠ¶æ€ï¼›\n\n#### wait() å’Œ sleep() æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\nä¸¤è€…éƒ½å¯ä»¥æš‚åœçº¿ç¨‹çš„æ‰§è¡Œ\n\n- ç±»çš„ä¸åŒï¼šwait() æ˜¯ Object ç±»çš„æ–¹æ³•ï¼Œsleep() æ˜¯ Thread çº¿ç¨‹ç±»çš„é™æ€æ–¹æ³•ã€‚\n- é‡Šæ”¾é”ï¼šwait() é‡Šæ”¾é”ï¼Œsleep() ä¸é‡Šæ”¾é”ã€‚\n- ç”¨é€”ä¸åŒï¼šwait é€šå¸¸è¢«ç”¨äºçº¿ç¨‹é—´äº¤äº’/é€šä¿¡ï¼Œsleep é€šå¸¸è¢«ç”¨äºæš‚åœæ‰§è¡Œã€‚\n- è‡ªåŠ¨è‹é†’ï¼šwait() æ–¹æ³•è¢«è°ƒç”¨åï¼Œçº¿ç¨‹ä¸ä¼šè‡ªåŠ¨è‹é†’ï¼Œéœ€è¦åˆ«çš„çº¿ç¨‹è°ƒç”¨åŒä¸€ä¸ªå¯¹è±¡ä¸Šçš„ notify() æˆ–è€… notifyAll() æ–¹æ³•ã€‚sleep() æ–¹æ³•æ‰§è¡Œå®Œæˆåï¼Œçº¿ç¨‹ä¼šè‡ªåŠ¨è‹é†’ã€‚æˆ–è€…å¯ä»¥ä½¿ç”¨ wait(long timeout) è¶…æ—¶åçº¿ç¨‹ä¼šè‡ªåŠ¨è‹é†’ã€‚\n\n#### ä½ æ˜¯å¦‚ä½•è°ƒç”¨ wait() æ–¹æ³•çš„ï¼Ÿä½¿ç”¨ if å—è¿˜æ˜¯å¾ªç¯ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ\n\n> ä½¿ç”¨ while åˆ¤æ–­æ¡ä»¶æ˜¯å¦å¾—åˆ°æ»¡è¶³\n\nä½¿ç”¨ if æ¥åˆ¤æ–­ä¼šå­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š\n\n1. å¦ä¸€ä¸ªçº¿ç¨‹å¯èƒ½å·²ç»è¢«å”¤é†’å¹¶æ”¹å˜äº†æ¡ä»¶çŠ¶æ€ã€‚ä¾‹å¦‚ notifyAll ä¼šå”¤é†’å¤šä¸ªç­‰å¾…çš„çº¿ç¨‹ã€‚\n\n2. å­˜åœ¨â€œä¼ªå”¤é†’â€çš„æƒ…å†µï¼Œå³åœ¨æ²¡æœ‰é€šçŸ¥çš„æƒ…å†µä¸‹ï¼Œçº¿ç¨‹ä¹Ÿå¯èƒ½ä¼šè‹é†’è¿‡æ¥ï¼Œè€Œæ­¤æ—¶æ˜¯ä¸åº”è¯¥å”¤é†’çš„ã€‚\n\n\t```java\n\tsynchronized (monitor) {\n\t    //  åˆ¤æ–­æ¡ä»¶è°“è¯æ˜¯å¦å¾—åˆ°æ»¡è¶³\n\t    while(!locked) {\n\t        //  ç­‰å¾…å”¤é†’\n\t        monitor.wait();\n\t    }\n\t    //  å¤„ç†å…¶ä»–çš„ä¸šåŠ¡é€»è¾‘\n\t}\n\t```\n\n#### ä¸ºä»€ä¹ˆçº¿ç¨‹é€šä¿¡çš„æ–¹æ³• wait()ï¼Œnotify() å’Œ notifyAll() è¢«å®šä¹‰åœ¨ Object ç±»é‡Œï¼Ÿ\n\nJava ä¸­ï¼Œä»»ä½•å¯¹è±¡éƒ½å¯ä»¥ä½œä¸ºé”ï¼Œå¹¶ä¸”çº¿ç¨‹é€šä¿¡çš„æ–¹æ³• wait()ï¼Œnotify() ç­‰æ–¹æ³•ç”¨äºç­‰å¾…å¯¹è±¡çš„é”æˆ–è€…æ˜¯å”¤é†’çº¿ç¨‹ï¼Œé‚£ä¹ˆè¦æ‰¾ä¸€ä¸ªå¯ä¾›ä»»ä½•å¯¹è±¡ä½¿ç”¨çš„é”ï¼Œå› æ­¤å°†è¿™äº›æ–¹æ³•å®šä¹‰åœ¨ Object ä¸­ï¼ŒObject æ˜¯æ‰€æœ‰ç±»çš„çˆ¶ç±»ã€‚\n\n#### Thread ç±»ä¸­çš„ yield æ–¹æ³•æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ\n\nä½¿å½“å‰çº¿ç¨‹ä»è¿è¡ŒçŠ¶æ€å˜ä¸ºå°±ç»ªçŠ¶æ€ã€‚\n\n#### çº¿ç¨‹çš„ sleep()æ–¹æ³•å’Œ yield()æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\n1. sleep() æ–¹æ³•ç»™å…¶ä»–çº¿ç¨‹è¿è¡Œæœºä¼šæ—¶ä¸è€ƒè™‘çº¿ç¨‹çš„ä¼˜å…ˆçº§ï¼Œå› æ­¤ä¼šç»™ä½ä¼˜å…ˆçº§çš„çº¿ç¨‹ä»¥è¿è¡Œçš„æœºä¼šï¼›\n\n\tyield() æ–¹æ³•åªä¼šç»™**ç›¸åŒæˆ–æ›´é«˜ä¼˜å…ˆçº§**çš„çº¿ç¨‹ä»¥è¿è¡Œçš„æœºä¼šï¼›\n\n2. çº¿ç¨‹æ‰§è¡Œ sleep() æ–¹æ³•åè½¬å…¥ç­‰å¾…ï¼ˆwaitingï¼‰çŠ¶æ€ï¼Œè€Œæ‰§è¡Œ yield() æ–¹æ³•åè½¬å…¥å°±ç»ªï¼ˆreadyï¼‰çŠ¶æ€ï¼›\n\n#### å¦‚ä½•åœæ­¢ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„çº¿ç¨‹ï¼Ÿ\n\n1. å½“ run æ–¹æ³•å®Œæˆåçº¿ç¨‹ç»ˆæ­¢ï¼›\n2. ä½¿ç”¨ interrupt æ–¹æ³•ä¸­æ–­çº¿ç¨‹ã€‚\n\n#### notify() å’Œ notifyAll() æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\nå¦‚æœçº¿ç¨‹è°ƒç”¨äº†å¯¹è±¡çš„ wait() æ–¹æ³•ï¼Œé‚£ä¹ˆçº¿ç¨‹ä¾¿ä¼šå¤„äºè¯¥å¯¹è±¡çš„ç­‰å¾…æ± ä¸­ï¼Œç­‰å¾…æ± ä¸­çš„çº¿ç¨‹ä¸ä¼šå»ç«äº‰è¯¥å¯¹è±¡çš„é”ã€‚\n\nnotifyAll() ä¼šå”¤é†’æ‰€æœ‰çš„çº¿ç¨‹ï¼Œnotify() åªä¼šå”¤é†’ä¸€ä¸ªçº¿ç¨‹ã€‚\n\nnotifyAll() è°ƒç”¨åï¼Œä¼šå°†å…¨éƒ¨çº¿ç¨‹ç”±ç­‰å¾…æ± ç§»åˆ°é”æ± ï¼Œç„¶åå‚ä¸é”çš„ç«äº‰ï¼Œç«äº‰æˆåŠŸåˆ™ç»§ç»­æ‰§è¡Œï¼Œå¦‚æœä¸æˆåŠŸåˆ™ç•™åœ¨é”æ± ç­‰å¾…é”è¢«é‡Šæ”¾åå†æ¬¡å‚ä¸ç«äº‰ã€‚è€Œ notify()åªä¼šå”¤é†’ä¸€ä¸ªçº¿ç¨‹ï¼Œå…·ä½“å”¤é†’å“ªä¸€ä¸ªçº¿ç¨‹ç”±è™šæ‹Ÿæœºæ§åˆ¶ã€‚\n\n#### å¦‚ä½•åœ¨ä¸¤ä¸ªçº¿ç¨‹é—´å…±äº«æ•°æ®ï¼Ÿ\n\nJava çº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ç”± Java å†…å­˜æ¨¡å‹ï¼ˆç®€ç§° JMMï¼‰æ§åˆ¶ï¼š\n\n1. æ‰€æœ‰çš„å…±äº«å˜é‡éƒ½å­˜åœ¨ä¸»å†…å­˜ä¸­\n2. æ¯ä¸ªçº¿ç¨‹éƒ½ä¿å­˜äº†ä¸€ä»½è¯¥çº¿ç¨‹ä½¿ç”¨åˆ°çš„å…±äº«å˜é‡çš„å‰¯æœ¬\n3. å¦‚æœçº¿ç¨‹ A ä¸çº¿ç¨‹ B ä¹‹é—´è¦é€šä¿¡ï¼š\n\t1. çº¿ç¨‹ A å°†æœ¬åœ°å†…å­˜ A ä¸­æ›´æ–°è¿‡çš„å…±äº«å˜é‡åˆ·æ–°åˆ°ä¸»å†…å­˜ä¸­å»\n\t2. çº¿ç¨‹ B åˆ°ä¸»å†…å­˜ä¸­å»è¯»å–çº¿ç¨‹ A ä¹‹å‰å·²ç»æ›´æ–°è¿‡çš„å…±äº«å˜é‡ã€‚\n\n#### Java å¦‚ä½•å®ç°å¤šçº¿ç¨‹ä¹‹é—´çš„é€šè®¯å’Œåä½œï¼Ÿ\n\nJava ä¸­çº¿ç¨‹é€šä¿¡åä½œçš„æœ€å¸¸è§çš„ä¸¤ç§æ–¹å¼ï¼š\n\n1. synchronized åŠ é”çš„çº¿ç¨‹ + Object ç±»çš„ wait()/notify()/notifyAll()\n\n2. ReentrantLock ç±»åŠ é”çš„çº¿ç¨‹ + Condition ç±»çš„ await()/signal()/signalAll()\n\n#### åŒæ­¥æ–¹æ³•å’ŒåŒæ­¥å—ï¼Œå“ªä¸ªæ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Ÿ\n\nåŒæ­¥çš„èŒƒå›´è¶Šå°è¶Šå¥½ã€‚\n\nå› æ­¤ï¼ŒåŒæ­¥å—æ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Œå› ä¸ºå®ƒä¸ä¼šé”ä½æ•´ä¸ªå¯¹è±¡ï¼Œè€ŒåŒæ­¥æ–¹æ³•ä¼šé”ä½æ•´ä¸ªå¯¹è±¡ã€‚\n\n#### ä»€ä¹ˆæ˜¯çº¿ç¨‹åŒæ­¥å’Œçº¿ç¨‹äº’æ–¥ï¼Œæœ‰å“ªå‡ ç§å®ç°æ–¹å¼ï¼Ÿ\n\nçº¿ç¨‹åŒæ­¥æ˜¯ä¸¤ä¸ªæˆ–å¤šä¸ªå…±äº«å…³é”®èµ„æºçš„çº¿ç¨‹çš„å¹¶å‘æ‰§è¡Œã€‚åº”è¯¥åŒæ­¥çº¿ç¨‹ä»¥é¿å…å…³é”®çš„èµ„æºä½¿ç”¨å†²çªã€‚\n\nçº¿ç¨‹äº’æ–¥æ˜¯å¯¹æŸä¸€å…±äº«èµ„æºè€Œè¨€ï¼Œä»»ä½•æ—¶åˆ»æœ€å¤šåªå…è®¸ä¸€ä¸ªçº¿ç¨‹å»ä½¿ç”¨ï¼Œå…¶å®ƒè¦ä½¿ç”¨è¯¥èµ„æºçš„çº¿ç¨‹å¿…é¡»ç­‰å¾…ï¼Œç›´åˆ°å ç”¨èµ„æºè€…é‡Šæ”¾è¯¥èµ„æºã€‚\n\nå®ç°çº¿ç¨‹åŒæ­¥çš„æ–¹æ³•ï¼š\n\n- åŒæ­¥ä»£ç æ–¹æ³• / æ–¹æ³•å—ï¼šsychronized å…³é”®å­—ä¿®é¥°çš„æ–¹æ³• / ä»£ç å—\n- ä½¿ç”¨ç‰¹æ®Šå˜é‡åŸŸ volatile å®ç°çº¿ç¨‹åŒæ­¥ï¼švolatile å…³é”®å­—ä¸ºåŸŸå˜é‡çš„è®¿é—®æä¾›äº†ä¸€ç§å…é”æœºåˆ¶\n- ä½¿ç”¨é‡å…¥é”å®ç°çº¿ç¨‹åŒæ­¥ï¼šreentrantlock ç±»æ˜¯å¯é‡å…¥ã€äº’æ–¥ã€å®ç°äº† lock æ¥å£çš„é”ï¼Œä¸ sychronized æ–¹æ³•å…·æœ‰ç›¸åŒçš„åŸºæœ¬è¡Œä¸ºå’Œè¯­ä¹‰\n\n#### åœ¨ç›‘è§†å™¨(Monitor)å†…éƒ¨ï¼Œæ˜¯å¦‚ä½•åšçº¿ç¨‹åŒæ­¥çš„ï¼Ÿ\n\nåœ¨ Java è™šæ‹Ÿæœºä¸­ï¼Œæ¯ä¸ªå¯¹è±¡å…³è”ä¸€ä¸ª**ç›‘è§†å™¨**ï¼Œä¸ºäº†å®ç°ç›‘è§†å™¨çš„äº’æ–¥åŠŸèƒ½ï¼Œ**æ¯ä¸ªå¯¹è±¡éƒ½å…³è”ç€ä¸€æŠŠé”**ã€‚\n\nä¸€æ—¦æ–¹æ³•æˆ–è€…ä»£ç å—è¢« **synchronized** ä¿®é¥°ï¼Œé‚£ä¹ˆè¿™ä¸ªéƒ¨åˆ†å°±æ”¾å…¥äº†ç›‘è§†å™¨çš„ç›‘è§†åŒºåŸŸï¼Œ**ç¡®ä¿ä¸€æ¬¡åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œè¯¥éƒ¨åˆ†çš„ä»£ç **ï¼Œçº¿ç¨‹åœ¨è·å–é”ä¹‹å‰ä¸å…è®¸æ‰§è¡Œè¯¥éƒ¨åˆ†çš„ä»£ç \n\nå¦å¤– Java è¿˜æä¾›äº†æ˜¾å¼ç›‘è§†å™¨ (Lock) å’Œéšå¼ç›‘è§†å™¨ (synchronized) ä¸¤ç§é”æ–¹æ¡ˆ\n\n#### Java çº¿ç¨‹æ•°è¿‡å¤šä¼šé€ æˆä»€ä¹ˆé—®é¢˜ï¼Ÿ\n\n- æ¶ˆè€—è¿‡å¤šçš„ CPU èµ„æº\n\n\tå¦‚æœå¯è¿è¡Œçš„çº¿ç¨‹æ•°é‡å¤šäºå¯ç”¨å¤„ç†å™¨çš„æ•°é‡ï¼Œé‚£ä¹ˆæœ‰çº¿ç¨‹å°†ä¼šè¢«é—²ç½®ã€‚å¤§é‡ç©ºé—²çš„çº¿ç¨‹ä¼šå ç”¨è®¸å¤šå†…å­˜ï¼Œç»™åƒåœ¾å›æ”¶å™¨å¸¦æ¥å‹åŠ›ã€‚\n\n- é™ä½ JVM ç¨³å®šæ€§\n\n\tåœ¨å¯åˆ›å»ºçº¿ç¨‹çš„æ•°é‡ä¸Šå­˜åœ¨ä¸€ä¸ªé™åˆ¶ï¼Œè¿™ä¸ªé™åˆ¶å€¼å°†éšç€å¹³å°çš„ä¸åŒè€Œä¸åŒï¼Œå¹¶ä¸”æ‰¿å—ç€å¤šä¸ªå› ç´ åˆ¶çº¦ï¼ŒåŒ…æ‹¬ JVM çš„å¯åŠ¨å‚æ•°ã€Thread æ„é€ å‡½æ•°ä¸­è¯·æ±‚æ ˆçš„å¤§å°ï¼Œä»¥åŠåº•å±‚æ“ä½œç³»ç»Ÿå¯¹çº¿ç¨‹çš„é™åˆ¶ç­‰ã€‚å¦‚æœç ´åäº†è¿™äº›é™åˆ¶ï¼Œé‚£ä¹ˆå¯èƒ½æŠ›å‡º OutOfMemoryError å¼‚å¸¸ã€‚\n\n## å¹¶å‘å…³é”®å­—\n\n### synchronized\n\n#### synchronized çš„ä½œç”¨ï¼Ÿ\n\nåœ¨ Java ä¸­ï¼Œsynchronized å…³é”®å­—æ˜¯ç”¨æ¥æ§åˆ¶çº¿ç¨‹åŒæ­¥çš„ï¼Œå°±æ˜¯åœ¨å¤šçº¿ç¨‹çš„ç¯å¢ƒä¸‹ï¼Œæ§åˆ¶ synchronized ä»£ç æ®µä¸è¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶æ‰§è¡Œã€‚synchronized å¯ä»¥ä¿®é¥°é™æ€æ–¹æ³•ã€å®ä¾‹æ–¹æ³•ã€ä»£ç å—ã€‚\n\n#### æ€ä¹ˆä½¿ç”¨ synchronized å…³é”®å­—\n\n**synchronizedå…³é”®å­—æœ€ä¸»è¦çš„ä¸‰ç§ä½¿ç”¨æ–¹å¼ï¼š**\n\n- **ä¿®é¥°å®ä¾‹æ–¹æ³•ï¼š** ç»™å½“å‰å¯¹è±¡å®ä¾‹åŠ é”ï¼›\n- **ä¿®é¥°é™æ€æ–¹æ³•ï¼š** ç»™å½“å‰ç±»åŠ é”ï¼›\n- **ä¿®é¥°ä»£ç å—ï¼š**ç»™æŒ‡å®šå¯¹è±¡åŠ é”ï¼Œè¿›å…¥åŒæ­¥ä»£ç å—å‰è¦è·å¾—æŒ‡å®šå¯¹è±¡çš„é”ã€‚\n\n**æ€»ç»“ï¼š** synchronized å…³é”®å­—åŠ åˆ° static é™æ€æ–¹æ³•å’Œ synchronized(xxx.class) ä»£ç å—ä¸Šéƒ½æ˜¯æ˜¯ç»™ Class ç±»ä¸Šé”ã€‚synchronized å…³é”®å­—åŠ åˆ°å®ä¾‹æ–¹æ³•ä¸Šæ˜¯ç»™å¯¹è±¡å®ä¾‹ä¸Šé”ã€‚\n\n#### åŒé‡æ ¡éªŒé”å®ç°å¯¹è±¡å•ä¾‹ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰\n\n```java\npublic class Singleton {\n    private volatile static Singleton uniqueInstance;\n\n    private Singleton() {}\n\n    public static Singleton getInstance() {\n        // ç¬¬ä¸€æ¬¡å‡å¦‚çº¿ç¨‹1ï¼Œçº¿ç¨‹2ï¼Œçº¿ç¨‹3åˆ°è¾¾è¿™ï¼Œéƒ½åˆ¤æ–­åˆ°nullæœªå®ä¾‹åŒ–ï¼ŒåŠ è¿™ä¸ªåˆ¤æ–­æ˜¯ä¸ºäº†è®©é™¤äº†ç¬¬ä¸€æ¬¡å®ä¾‹åŒ–ä¹‹åçš„å…¶ä»–çº¿ç¨‹åˆ¤æ–­åˆ°éç©ºè¡¨æ˜å·²ç»å®ä¾‹åŒ–è¿‡äº†ï¼Œç›´æ¥è¿”å›å•ä¾‹\n        if (uniqueInstance == null) {\t// çº¿ç¨‹1ã€2ã€3æœ‰å¯èƒ½éƒ½è¿›æ¥äº†\n            //ç±»å¯¹è±¡åŠ é”\n            synchronized (Singleton.class) {\t// å¦‚æœå¤šä¸ªçº¿ç¨‹éƒ½åˆ¤æ–­åˆ°æœªå®ä¾‹åŒ–ï¼Œé‚£ä¹ˆåªä¼šæœ‰ä¸€ä¸ªçº¿ç¨‹é”ä½ç±»å¹¶è¿›è¡Œå®ä¾‹åŒ–\n                if (uniqueInstance == null) {\t// å¦‚æœä¸åŠ è¿™ä¸ªåˆ¤æ–­ï¼Œçº¿ç¨‹1æ‹¿åˆ°é”è¿›è¡Œå®ä¾‹åŒ–ä¹‹åï¼Œçº¿ç¨‹2æ‹¿åˆ°é”ï¼Œè¿›æ¥ç›´æ¥è¿›è¡Œå®ä¾‹åŒ–ï¼Œè¿™å°±äº§ç”Ÿå¤šæ¬¡å®ä¾‹åŒ–æ“ä½œã€‚å¦‚æœåŠ è¿™ä¸ªåˆ¤æ–­ï¼Œçº¿ç¨‹2æ‹¿åˆ°é”ä¹‹åï¼Œåˆ¤æ–­åˆ°å·²ç»å®ä¾‹åŒ–äº†ï¼Œå°±ä¸ä¼šå†è¿›è¡Œå®ä¾‹åŒ–äº†ã€‚\n                    uniqueInstance = new Singleton();\n                }\n            }\n        }\n        return uniqueInstance;\n    }\n\n}\n```\n\nå¦å¤–ï¼Œéœ€è¦æ³¨æ„ instance é‡‡ç”¨ volatile å…³é”®å­—ä¿®é¥°ä¹Ÿæ˜¯å¾ˆæœ‰å¿…è¦ã€‚\n\ninstance é‡‡ç”¨ volatile å…³é”®å­—ä¿®é¥°ä¹Ÿæ˜¯å¾ˆæœ‰å¿…è¦çš„ï¼Œinstance = new Singleton() è¿™æ®µä»£ç å…¶å®æ˜¯åˆ†ä¸ºä¸‰æ­¥æ‰§è¡Œï¼š\n\n1. ä¸º instance åˆ†é…å†…å­˜ç©ºé—´\n2. åˆå§‹åŒ– instance\n3. å°† instance æŒ‡å‘åˆ†é…çš„å†…å­˜åœ°å€\n\nä½†æ˜¯ç”±äº JVM å…·æœ‰æŒ‡ä»¤é‡æ’çš„ç‰¹æ€§ï¼Œæ‰§è¡Œé¡ºåºæœ‰å¯èƒ½å˜æˆ 1->3->2ã€‚æŒ‡ä»¤é‡æ’åœ¨å•çº¿ç¨‹ç¯å¢ƒä¸‹ä¸ä¼šå‡ºç°é—®é¢˜ï¼Œä½†æ˜¯åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä¼šå¯¼è‡´ä¸€ä¸ªçº¿ç¨‹è·å¾—è¿˜æ²¡æœ‰åˆå§‹åŒ–çš„å®ä¾‹ã€‚ä¾‹å¦‚ï¼Œçº¿ç¨‹ T1 æ‰§è¡Œäº† 1 å’Œ 3ï¼Œæ­¤æ—¶ T2 è°ƒç”¨ getInstance() åå‘ç° instance ä¸ä¸ºç©ºï¼Œå› æ­¤**è¿”å› T1 å®ä¾‹åŒ–ä½†æœªåˆå§‹åŒ–**çš„ instanceã€‚\n\n#### synchronized åº•å±‚å®ç°åŸç†ï¼Ÿï¼ˆç›‘è§†å™¨monitorï¼‰\n\nsynchronized æ˜¯ Java ä¸­çš„ä¸€ä¸ªå…³é”®å­—ï¼Œé€šè¿‡ javap å‘½ä»¤ï¼ŒæŸ¥çœ‹ç›¸åº”çš„å­—èŠ‚ç æ–‡ä»¶ã€‚\n\nsynchronized åŒæ­¥è¯­å¥å—çš„æƒ…å†µ\n\n```java\npublic class SynchronizedDemo {\n    public void method() {\n        synchronized (this) {\n            System.out.println(\"synchronized ä»£ç å—\");\n        }\n    }\n}\n```\n\né€šè¿‡ JDK åæ±‡ç¼–æŒ‡ä»¤ javap -c -v SynchronizedDemo\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/image-20220912212554623.png\" alt=\"monitorenter&monitorexit\" style=\"zoom:50%;\" />\n\nå¯ä»¥çœ‹å‡ºåœ¨æ‰§è¡ŒåŒæ­¥ä»£ç å—ä¹‹å‰ä¹‹åéƒ½æœ‰ä¸€ä¸ª monitor å­—æ ·ï¼Œå…¶ä¸­å‰é¢çš„æ˜¯ monitorenterï¼Œåé¢çš„æ˜¯ç¦»å¼€ monitorexitï¼Œä¸éš¾æƒ³è±¡ä¸€ä¸ªçº¿ç¨‹æ‰§è¡ŒåŒæ­¥ä»£ç å—ï¼Œé¦–å…ˆè¦è·å–é”ï¼Œè€Œè·å–é”çš„è¿‡ç¨‹å°±æ˜¯ monitorenter ï¼Œåœ¨æ‰§è¡Œå®Œä»£ç å—ä¹‹åï¼Œè¦é‡Šæ”¾é”ï¼Œé‡Šæ”¾é”å°±æ˜¯æ‰§è¡Œ monitorexit æŒ‡ä»¤ã€‚\n\nä¸ºä»€ä¹ˆä¼šæœ‰ä¸¤ä¸ª monitorexit å‘¢ï¼Ÿï¼ˆline 19ï¼‰\n\nè¿™ä¸ªä¸»è¦æ˜¯é˜²æ­¢åœ¨åŒæ­¥ä»£ç å—ä¸­çº¿ç¨‹å› å¼‚å¸¸é€€å‡ºï¼Œè€Œé”æ²¡æœ‰å¾—åˆ°é‡Šæ”¾ï¼Œè¿™å¿…ç„¶ä¼šé€ æˆæ­»é”ï¼ˆç­‰å¾…çš„çº¿ç¨‹æ°¸è¿œè·å–ä¸åˆ°é”ï¼‰ã€‚**å› æ­¤æœ€åä¸€ä¸ªmonitorexitæ˜¯ä¿è¯åœ¨å¼‚å¸¸æƒ…å†µä¸‹ï¼Œé”ä¹Ÿå¯ä»¥å¾—åˆ°é‡Šæ”¾ï¼Œé¿å…æ­»é”ã€‚**\n\n#### synchronized å¯é‡å…¥çš„åŸç†\n\né‡å…¥é”æ˜¯æŒ‡ä¸€ä¸ªçº¿ç¨‹è·å–åˆ°è¯¥é”ä¹‹åï¼Œè¯¥çº¿ç¨‹å¯ä»¥ç»§ç»­è·å¾—è¯¥é”ã€‚\nåº•å±‚åŸç†ç»´æŠ¤ä¸€ä¸ª**è®¡æ•°å™¨**ï¼Œå½“çº¿ç¨‹è·å–è¯¥é”æ—¶ï¼Œè®¡æ•°å™¨åŠ ä¸€ï¼Œå†æ¬¡è·å¾—è¯¥é”æ—¶ç»§ç»­åŠ ä¸€ï¼Œé‡Šæ”¾é”æ—¶ï¼Œè®¡æ•°å™¨å‡ä¸€ï¼Œå½“è®¡æ•°å™¨å€¼ä¸º 0 æ—¶ï¼Œè¡¨æ˜è¯¥é”æœªè¢«ä»»ä½•çº¿ç¨‹æ‰€æŒæœ‰ï¼Œå…¶å®ƒçº¿ç¨‹å¯ä»¥ç«äº‰è·å–é”ã€‚\n\n#### ä»€ä¹ˆæ˜¯è‡ªæ—‹\n\n> ä¸è¦é‡åˆ° synchronized å°±è®©ç­‰å¾…é”çš„çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œè€Œæ˜¯è®©è¿™ä¸ªçº¿ç¨‹åœ¨ synchronized è¾¹ç•Œåšå¿™å¾ªç¯\n\nå¾ˆå¤š synchronized é‡Œé¢çš„ä»£ç åªæ˜¯ä¸€äº›å¾ˆç®€å•çš„ä»£ç ï¼Œæ‰§è¡Œæ—¶é—´éå¸¸å¿«ï¼Œæ—¢ç„¶ synchronized é‡Œé¢çš„ä»£ç æ‰§è¡Œå¾—éå¸¸å¿«ï¼Œä¸å¦¨è®©ç­‰å¾…é”çš„çº¿ç¨‹ä¸è¦è¢«é˜»å¡ï¼Œå› ä¸º**çº¿ç¨‹é˜»å¡æ¶‰åŠåˆ°ç”¨æˆ·æ€å’Œå†…æ ¸æ€åˆ‡æ¢çš„é—®é¢˜å¼€é”€å¾ˆå¤§**ï¼Œè€Œæ˜¯**åœ¨ synchronized çš„è¾¹ç•Œåšå¿™å¾ªç¯**ï¼Œè¿™å°±æ˜¯è‡ªæ—‹ã€‚å¦‚æœåšäº†å¤šæ¬¡å¾ªç¯å‘ç°è¿˜æ²¡æœ‰è·å¾—é”ï¼Œå†é˜»å¡ï¼Œè¿™æ ·å¯èƒ½æ˜¯ä¸€ç§æ›´å¥½çš„ç­–ç•¥ã€‚\n\n#### å¤šçº¿ç¨‹ä¸­ synchronized é”å‡çº§çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ\n\n> ç›®çš„ï¼šé”å‡çº§æ˜¯ä¸ºäº†å‡ä½äº†é”å¸¦æ¥çš„æ€§èƒ½æ¶ˆè€—ã€‚\n\nJava çš„é”éƒ½æ˜¯åŸºäºå¯¹è±¡çš„ï¼ŒJava å¯¹è±¡æœ‰å¯¹è±¡å¤´ï¼Œå†…å®¹åŒ…æ‹¬ï¼š\n\n1. Mark Wordï¼Œå­˜å‚¨å¯¹è±¡çš„ hashCodeã€é”ä¿¡æ¯ç­‰ï¼›\n2. Class Metadata Addressï¼Œå­˜å‚¨åˆ°å¯¹è±¡ç±»å‹æ•°æ®çš„æŒ‡é’ˆï¼›\n3. æ•°ç»„çš„é•¿åº¦ï¼ˆå¦‚æœæ˜¯æ•°ç»„ï¼‰\n\næ¯ä¸€ä¸ªçº¿ç¨‹åœ¨å‡†å¤‡è·å–å…±äº«èµ„æºæ—¶ï¼š \n\nç¬¬ä¸€æ­¥ï¼Œæ£€æŸ¥é”çš„ MarkWord é‡Œé¢æ˜¯ä¸æ˜¯æ”¾çš„è‡ªå·±çš„ ThreadIdï¼Œå¦‚æœæ˜¯ï¼Œè¡¨ç¤ºå½“å‰çº¿ç¨‹æ˜¯å¤„äº â€œ**åå‘é”**â€ ï¼›\n\nç¬¬äºŒæ­¥ï¼Œå¦‚æœé”çš„ MarkWord å­˜æ”¾çš„ä¸æ˜¯è‡ªå·±çš„ ThreadIdï¼Œè¿™ä¸ªæ—¶å€™ä¼šå°è¯•ä½¿ç”¨ CAS æ¥æ›¿æ¢ Mark Word é‡Œé¢çš„çº¿ç¨‹ ID ä¸ºæ–°çº¿ç¨‹çš„ IDï¼Œè¿™ä¸ªæ—¶å€™è¦åˆ†ä¸¤ç§æƒ…å†µï¼š\n\n- CAS æ›¿æ¢æˆåŠŸï¼Œè¡¨ç¤ºä¹‹å‰çš„çº¿ç¨‹ä¸å­˜åœ¨äº†ï¼Œ Mark Word é‡Œé¢çš„çº¿ç¨‹ ID ä¸ºæ–°çº¿ç¨‹çš„ IDï¼Œé”ä¸ä¼šå‡çº§ï¼Œä»ç„¶ä¸ºåå‘é”ï¼›\n- CAS æ›¿æ¢å¤±è´¥ï¼Œè¡¨ç¤ºä¹‹å‰çš„çº¿ç¨‹ä»ç„¶å­˜åœ¨ï¼Œæ ¹æ®é”çš„ MarkWord é‡Œé¢çš„ ThreadIdï¼Œé€šçŸ¥è¯¥ ThreadId çš„çº¿ç¨‹æš‚åœï¼Œä¹‹å‰çº¿ç¨‹å°† Markword çš„å†…å®¹ç½®ä¸ºç©ºï¼Œå‡çº§ä¸ºè½»é‡çº§é”ï¼Œä¼šæŒ‰ç…§è½»é‡çº§é”çš„æ–¹å¼è¿›è¡Œç«äº‰é”ã€‚\n\nç¬¬ä¸‰æ­¥ï¼Œä¸¤ä¸ªçº¿ç¨‹éƒ½æŠŠé”å¯¹è±¡çš„ hashCode å¤åˆ¶åˆ°è‡ªå·±æ–°å»ºçš„ç”¨äºå­˜å‚¨é”çš„è®°å½•ç©ºé—´ï¼Œæ¥ç€å¼€å§‹é€šè¿‡ CAS æ“ä½œï¼Œ æŠŠé”å¯¹è±¡çš„ MarkWord çš„å†…å®¹ä¿®æ”¹ä¸ºè‡ªå·±æ–°å»ºçš„è®°å½•ç©ºé—´çš„åœ°å€çš„æ–¹å¼ç«äº‰ MarkWordï¼›\n\nç¬¬å››æ­¥ï¼Œç¬¬ä¸‰æ­¥ä¸­æˆåŠŸæ‰§è¡Œ CAS çš„è·å¾—èµ„æºï¼Œå¤±è´¥çš„åˆ™è¿›å…¥è‡ªæ—‹ ï¼›\n\nç¬¬äº”æ­¥ï¼Œè‡ªæ—‹çš„çº¿ç¨‹åœ¨è‡ªæ—‹è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæˆåŠŸè·å¾—èµ„æºï¼ˆå³ä¹‹å‰è·çš„èµ„æºçš„çº¿ç¨‹æ‰§è¡Œå®Œæˆå¹¶é‡Šæ”¾äº†å…±äº«èµ„æºï¼‰ï¼Œåˆ™æ•´ä¸ªçŠ¶æ€ä¾ç„¶å¤„äº **è½»é‡çº§é”**çš„çŠ¶æ€ï¼›å¦‚æœè‡ªæ—‹å¤±è´¥ ï¼ˆè¿™è¾¹çš„è‡ªæ—‹æ–¹å¼å¯ä»¥é‡‡ç”¨é€‚åº”æ€§è‡ªæ—‹ï¼Œç®€å•æ¥è¯´å°±æ˜¯çº¿ç¨‹å¦‚æœè‡ªæ—‹æˆåŠŸäº†ï¼Œåˆ™ä¸‹æ¬¡è‡ªæ—‹çš„æ¬¡æ•°ä¼šæ›´å¤šï¼Œå¦‚æœè‡ªæ—‹å¤±è´¥äº†ï¼Œåˆ™è‡ªæ—‹çš„æ¬¡æ•°å°±ä¼šå‡å°‘ï¼‰ï¼›\n\nç¬¬å…­æ­¥ï¼Œè¿›å…¥**é‡é‡çº§é”**çš„çŠ¶æ€ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œè‡ªæ—‹çš„çº¿ç¨‹è¿›å…¥é˜»å¡ï¼Œç­‰å¾…ç«äº‰çº¿ç¨‹æ‰§è¡Œå®Œæˆå¹¶å”¤é†’è‡ªå·±ã€‚\n\n#### çº¿ç¨‹ B æ€ä¹ˆçŸ¥é“çº¿ç¨‹ A ä¿®æ”¹äº†å˜é‡\n\n* volatile ä¿®é¥°å˜é‡\n\n* synchronized ä¿®é¥°ä¿®æ”¹å˜é‡çš„æ–¹æ³•\n* lock å¯¹ä¿®æ”¹å˜é‡çš„ä»£ç å—åŠ é”\n\n#### synchronized å’Œ Lock æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\n- synchronized æ˜¯ Java å…³é”®å­—ï¼Œè€Œ Lock æ˜¯ä¸ªæ¥å£ï¼›\n- synchronized å¯ä»¥ç»™é™æ€æ–¹æ³•ã€å®ä¾‹æ–¹æ³•ã€ä»£ç å—åŠ é”ï¼Œè€Œ lock åªèƒ½ç»™ä»£ç å—åŠ é”ï¼›\n- synchronized ä¸éœ€è¦æ‰‹åŠ¨è·å–é”å’Œé‡Šæ”¾é”ï¼Œè€Œ lock éœ€è¦è‡ªå·±åŠ é”å’Œé‡Šæ”¾é”ï¼›\n- é€šè¿‡ Lock å¯ä»¥çŸ¥é“æœ‰æ²¡æœ‰æˆåŠŸè·å–é”ï¼Œè€Œ synchronized å´æ— æ³•åŠåˆ°ã€‚\n\n#### synchronized å’Œ ReentrantLock åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\n\n**ç›¸åŒç‚¹ï¼š**\n\nä¸¤è€…éƒ½æ˜¯å¯é‡å…¥é”\n\nâ€œå¯é‡å…¥é”â€æ¦‚å¿µæ˜¯ï¼šè‡ªå·±å¯ä»¥å†æ¬¡è·å–è‡ªå·±çš„å†…éƒ¨é”ã€‚æ¯”å¦‚ä¸€ä¸ªçº¿ç¨‹è·å¾—äº†æŸä¸ªå¯¹è±¡çš„é”ï¼Œæ­¤æ—¶è¿™ä¸ªå¯¹è±¡é”è¿˜æ²¡æœ‰é‡Šæ”¾ï¼Œå½“å…¶å†æ¬¡æƒ³è¦è·å–è¿™ä¸ªå¯¹è±¡çš„é”çš„æ—¶å€™è¿˜æ˜¯å¯ä»¥è·å–çš„ï¼Œ**å¦‚æœä¸å¯é”é‡å…¥çš„è¯ï¼Œå°±ä¼šé€ æˆæ­»é”**ã€‚åŒä¸€ä¸ªçº¿ç¨‹æ¯æ¬¡è·å–é”ï¼Œé”çš„è®¡æ•°å™¨éƒ½è‡ªå¢ 1ï¼Œæ‰€ä»¥è¦ç­‰åˆ°é”çš„è®¡æ•°å™¨ä¸‹é™ä¸º 0 æ—¶æ‰èƒ½é‡Šæ”¾é”ã€‚\n\n**ä¸åŒç‚¹ï¼š**\n\n* synchronized æ˜¯å…³é”®å­—ï¼ŒReentrantLock æ˜¯ç±»ï¼›\n* ReentrantLock åªé€‚ç”¨äºä»£ç å—é”ï¼Œè€Œ synchronized å¯ä»¥ä¿®é¥°ç±»ã€æ–¹æ³•ã€å˜é‡ç­‰ï¼›\n\n- ReentrantLock å¿…é¡»æ‰‹åŠ¨è·å–ä¸é‡Šæ”¾é”ï¼Œè€Œ synchronized ä¸éœ€è¦æ‰‹åŠ¨é‡Šæ”¾å’Œå¼€å¯é”ï¼›\n- äºŒè€…çš„é”æœºåˆ¶å…¶å®ä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ï¼š\n\tReentrantLock åº•å±‚è°ƒç”¨çš„æ˜¯ Unsafe çš„ park æ–¹æ³•åŠ é”ï¼Œsynchronized æ“ä½œçš„åº”è¯¥æ˜¯å¯¹è±¡å¤´ä¸­ mark word\n\n### volatile\n\n#### ä¸ºä»€ä¹ˆä»£ç ä¼šé‡æ’åºï¼Ÿ\n\nåœ¨æ‰§è¡Œç¨‹åºæ—¶ï¼Œä¸ºäº†**æé«˜æ€§èƒ½**ï¼Œå¤„ç†å™¨å’Œç¼–è¯‘å™¨å¸¸å¸¸ä¼šå¯¹æŒ‡ä»¤è¿›è¡Œé‡æ’åºï¼Œä½†æ˜¯ä¸èƒ½éšæ„é‡æ’åºï¼Œä¸æ˜¯ä½ æƒ³æ€ä¹ˆæ’åºå°±æ€ä¹ˆæ’åºï¼Œå®ƒéœ€è¦æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶ï¼š\n\n- **åœ¨å•çº¿ç¨‹ç¯å¢ƒä¸‹ä¸èƒ½æ”¹å˜ç¨‹åºè¿è¡Œçš„ç»“æœï¼›**\n- **å­˜åœ¨æ•°æ®ä¾èµ–å…³ç³»çš„ä¸å…è®¸é‡æ’åº**\n\néœ€è¦æ³¨æ„çš„æ˜¯ï¼šé‡æ’åºä¸ä¼šå½±å“å•çº¿ç¨‹ç¯å¢ƒçš„æ‰§è¡Œç»“æœï¼Œä½†æ˜¯ä¼šç ´åå¤šçº¿ç¨‹çš„æ‰§è¡Œè¯­ä¹‰ã€‚\n\n#### as-if-serial è§„åˆ™å’Œ happens-before è§„åˆ™çš„åŒºåˆ«\n\n- as-if-serial è§„åˆ™ä¿è¯ **å•çº¿ç¨‹** å†…ç¨‹åºçš„æ‰§è¡Œç»“æœä¸è¢«æ”¹å˜ï¼Œhappens-before è§„åˆ™ä¿è¯ **æ­£ç¡®åŒæ­¥çš„å¤šçº¿ç¨‹** ç¨‹åºçš„æ‰§è¡Œç»“æœä¸è¢«æ”¹å˜ã€‚\n- as-if-serial è¯­ä¹‰å’Œ happens-before è¿™ä¹ˆåšçš„ç›®çš„ï¼Œéƒ½æ˜¯ä¸ºäº†åœ¨ä¸æ”¹å˜ç¨‹åºæ‰§è¡Œç»“æœçš„å‰æä¸‹ï¼Œå°½å¯èƒ½åœ°æé«˜ç¨‹åºæ‰§è¡Œçš„å¹¶è¡Œåº¦ã€‚\n\n#### volatile å…³é”®å­—çš„ä½œç”¨\n\nå¯¹äºå¯è§æ€§ï¼ŒJava æä¾›äº† volatile å…³é”®å­—æ¥ä¿è¯å¯è§æ€§å’Œæœ‰åºæ€§ï¼ˆç¦æ­¢æŒ‡ä»¤é‡æ’ï¼‰ï¼Œä½†ä¸èƒ½ä¿è¯åŸå­æ€§ã€‚ volatile æä¾› happens-before çš„ä¿è¯ï¼Œç¡®ä¿ä¸€ä¸ªçº¿ç¨‹çš„ä¿®æ”¹èƒ½å¯¹å…¶ä»–çº¿ç¨‹æ˜¯å¯è§çš„ã€‚å½“ä¸€ä¸ªå…±äº«å˜é‡è¢« volatile ä¿®é¥°æ—¶ï¼Œå®ƒä¼šä¿è¯ä¿®æ”¹çš„å€¼ä¼šç«‹å³è¢«æ›´æ–°åˆ°ä¸»å­˜ï¼Œå½“æœ‰å…¶ä»–çº¿ç¨‹éœ€è¦è¯»å–æ—¶ï¼Œå®ƒä¼šå»å†…å­˜ä¸­è¯»å–æ–°å€¼ã€‚\n\n#### JMMå†…å­˜å±éšœæ’å…¥ç­–ç•¥\n\n**æ’å…¥å±éšœ**\n\nStoreStore å±éšœ - volatile å†™ - StoreLoad å±éšœ\n\nvolatile è¯» - LoadLoad å±éšœ - LoadStore å±éšœ\n\n**volatile ä¸æ™®é€šå˜é‡çš„é‡æ’åºè§„åˆ™**\n\n1. å¦‚æœç¬¬ä¸€ä¸ªæ“ä½œæ˜¯ volatile è¯»ï¼Œé‚£æ— è®ºç¬¬äºŒä¸ªæ“ä½œæ˜¯ä»€ä¹ˆï¼Œéƒ½ä¸èƒ½é‡æ’åºï¼›\n2. å¦‚æœç¬¬äºŒä¸ªæ“ä½œæ˜¯ volatile å†™ï¼Œé‚£æ— è®ºç¬¬ä¸€ä¸ªæ“ä½œæ˜¯ä»€ä¹ˆï¼Œéƒ½ä¸èƒ½é‡æ’åºï¼›\n3. å¦‚æœç¬¬ä¸€ä¸ªæ“ä½œæ˜¯ volatile å†™ï¼Œç¬¬äºŒä¸ªæ“ä½œæ˜¯ volatile è¯»ï¼Œé‚£ä¸èƒ½é‡æ’åºã€‚\n\n#### volatile èƒ½ä½¿å¾—ä¸€ä¸ªéåŸå­æ“ä½œå˜æˆåŸå­æ“ä½œå—ï¼Ÿ\n\nvolatile åªèƒ½ä¿è¯å¯è§æ€§å’Œæœ‰åºæ€§è€Œä¸èƒ½ä¿è¯åŸå­æ€§ï¼Œä½†ç”¨ volatile ä¿®é¥° long å’Œ double å¯ä»¥ä¿è¯å…¶æ“ä½œåŸå­æ€§ã€‚\n\n#### volatile ä¿®é¥°ç¬¦çš„æœ‰è¿‡ä»€ä¹ˆå®è·µï¼Ÿ\n\nå•ä¾‹æ¨¡å¼-åŒé‡é”æ£€éªŒé‡Œé¢ç”¨ volatile ä¿®é¥°å®ä¾‹å˜é‡ã€‚\n\n#### volatile å’Œ synchronized çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\n\n- volatile æ˜¯å˜é‡ä¿®é¥°ç¬¦ï¼›synchronized å¯ä»¥ä¿®é¥°ç±»ã€æ–¹æ³•ã€ä»£ç å—ï¼›\n- volatile ä»…èƒ½å®ç°å˜é‡çš„ä¿®æ”¹å¯è§æ€§å’Œæœ‰åºæ€§ï¼Œä¸èƒ½ä¿è¯åŸå­æ€§ï¼Œ\n\tè€Œ synchronized åˆ™å¯ä»¥ä¿è¯å˜é‡çš„ä¿®æ”¹åŸå­æ€§å’Œå¯è§æ€§ï¼›\n- volatile ä¸ä¼šé€ æˆçº¿ç¨‹çš„é˜»å¡ï¼›synchronized å¯èƒ½ä¼šé€ æˆçº¿ç¨‹çš„é˜»å¡ï¼›\n- **volatileå…³é”®å­—**æ˜¯çº¿ç¨‹åŒæ­¥çš„**è½»é‡çº§å®ç°**ï¼Œæ‰€ä»¥**volatileæ€§èƒ½è‚¯å®šæ¯”synchronizedå…³é”®å­—è¦å¥½**ã€‚synchronized å…³é”®å­—åœ¨ JavaSE1.6 ä¹‹åè¿›è¡Œäº†ä¸»è¦åŒ…æ‹¬ä¸ºäº†**å‡å°‘è·å¾—é”å’Œé‡Šæ”¾é”å¸¦æ¥çš„æ€§èƒ½æ¶ˆè€—**è€Œå¼•å…¥çš„åå‘é”å’Œè½»é‡çº§é”ä»¥åŠå…¶å®ƒå„ç§ä¼˜åŒ–ä¹‹åæ‰§è¡Œæ•ˆç‡æœ‰äº†æ˜¾è‘—æå‡ï¼Œ**å®é™…å¼€å‘ä¸­ä½¿ç”¨ synchronized å…³é”®å­—çš„åœºæ™¯è¿˜æ˜¯æ›´å¤šä¸€äº›**ã€‚\n\n## Lock ä½“ç³»\n\n### Lock ç®€ä»‹\n\n#### Lock æ¥å£æ˜¯ä»€ä¹ˆï¼Ÿå¯¹æ¯”åŒæ­¥å®ƒæœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ\n\nLock æ¥å£æ¯”åŒæ­¥æ–¹æ³•å’ŒåŒæ­¥å—æä¾›äº†æ›´å…·æ‰©å±•æ€§çš„é”æ“ä½œã€‚\n\nï¼ˆ1ï¼‰å¯ä»¥ä½¿é”æ›´**å…¬å¹³**\n\nï¼ˆ2ï¼‰å¯ä»¥ä½¿çº¿ç¨‹åœ¨**ç­‰å¾…é”çš„æ—¶å€™å“åº”ä¸­æ–­**\n\nï¼ˆ3ï¼‰å¯ä»¥**è®©çº¿ç¨‹å°è¯•è·å–é”ï¼Œå¹¶åœ¨æ— æ³•è·å–é”çš„æ—¶å€™ç«‹å³è¿”å›æˆ–è€…ç­‰å¾…ä¸€æ®µæ—¶é—´**\n\n#### ä¹è§‚é”å’Œæ‚²è§‚é”çš„ç†è§£åŠå¦‚ä½•å®ç°ï¼Œæœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ\n\næ‚²è§‚é”ï¼šæ€»æ˜¯å‡è®¾æœ€åçš„æƒ…å†µï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¼šä¿®æ”¹ï¼Œæ‰€ä»¥æ¯æ¬¡åœ¨æ‹¿æ•°æ®çš„æ—¶å€™éƒ½ä¼šä¸Šé”ï¼Œè¿™æ ·åˆ«äººæƒ³æ‹¿è¿™ä¸ªæ•°æ®å°±ä¼šé˜»å¡ç›´åˆ°å®ƒæ‹¿åˆ°é”ã€‚\n\tä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“é‡Œè¾¹å°±ç”¨åˆ°äº†å¾ˆå¤šè¿™ç§é”æœºåˆ¶ï¼Œæ¯”å¦‚è¡Œé”ï¼Œè¡¨é”ç­‰ï¼Œè¯»é”ï¼Œå†™é”ç­‰ï¼Œéƒ½æ˜¯åœ¨åšæ“ä½œä¹‹å‰å…ˆä¸Šé”ã€‚å†æ¯”å¦‚ Java é‡Œé¢çš„åŒæ­¥åŸè¯­ synchronized å…³é”®å­—çš„å®ç°ä¹Ÿæ˜¯æ‚²è§‚é”ã€‚\n\nä¹è§‚é”ï¼šé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¾ˆä¹è§‚ï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¸ä¼šä¿®æ”¹ï¼Œæ‰€ä»¥ä¸ä¼šä¸Šé”ï¼Œä½†æ˜¯åœ¨æ›´æ–°çš„æ—¶å€™ä¼šåˆ¤æ–­ä¸€ä¸‹åœ¨æ­¤æœŸé—´åˆ«äººæœ‰æ²¡æœ‰å»æ›´æ–°è¿™ä¸ªæ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ç‰ˆæœ¬å·ç­‰æœºåˆ¶ã€‚\n\tä¹è§‚é”é€‚ç”¨äºå¤šè¯»çš„åº”ç”¨ç±»å‹ï¼Œè¿™æ ·å¯ä»¥æé«˜ååé‡ï¼Œæ¯”å¦‚ atomic åŒ…ä¸‹é¢çš„åŸå­å˜é‡ç±»å°±æ˜¯ä½¿ç”¨äº†ä¹è§‚é”çš„ä¸€ç§å®ç°æ–¹å¼ CAS å®ç°çš„ã€‚\n\n#### ä»€ä¹ˆæ˜¯ CAS\n\nCAS æ˜¯ compare and swap çš„ç¼©å†™ï¼Œå³æˆ‘ä»¬æ‰€è¯´çš„æ¯”è¾ƒäº¤æ¢ï¼Œæ˜¯ä¸€ç§ä¹è§‚é”æ“ä½œã€‚\n\nCAS æ“ä½œåŒ…å«ä¸‰ä¸ªæ“ä½œæ•° â€”â€” å†…å­˜ä½ç½®ï¼ˆVï¼‰ã€é¢„æœŸåŸå€¼ï¼ˆAï¼‰å’Œæ–°å€¼ï¼ˆBï¼‰ã€‚\n\nå¦‚æœå†…å­˜åœ°å€ V é‡Œé¢çš„å€¼å’Œ A çš„å€¼æ˜¯ä¸€æ ·çš„ï¼Œé‚£ä¹ˆå°±å°†å†…å­˜é‡Œé¢çš„å€¼æ›´æ–°æˆ Bã€‚\n\n####  Javaå®ç°CASçš„åŸç† - Unsafeç±»\n\nåœ¨ Java ä¸­ï¼Œæœ‰ä¸€ä¸ª`Unsafe`ç±»ï¼Œå®ƒåœ¨`sun.misc`åŒ…ä¸­ã€‚å®ƒé‡Œé¢æ˜¯ä¸€äº›`native`æ–¹æ³•ï¼ˆç”±åº•å±‚çš„ JVM ä½¿ç”¨ C æˆ–è€… C++å»å®ç°ï¼‰ï¼Œå…¶ä¸­å°±æœ‰å‡ ä¸ªå…³äº CAS çš„ï¼š\n\n```java\nboolean compareAndSwapObject(Object o, long offset,Object expected, Object x);\nboolean compareAndSwapInt(Object o, long offset,int expected,int x);\nboolean compareAndSwapLong(Object o, long offset,long expected,long x);\n```\n\nå½“ç„¶ï¼Œä»–ä»¬éƒ½æ˜¯`public native`çš„ã€‚\n\nUnsafe ä¸­å¯¹ CAS çš„å®ç°æ˜¯ C++ å†™çš„ï¼Œå®ƒçš„å…·ä½“å®ç°å’Œæ“ä½œç³»ç»Ÿã€CPU éƒ½æœ‰å…³ç³»ã€‚\n\nLinux çš„ X86 ä¸‹ä¸»è¦æ˜¯é€šè¿‡`cmpxchgl`è¿™ä¸ªæŒ‡ä»¤åœ¨ CPU çº§å®Œæˆ CAS æ“ä½œçš„ï¼Œä½†åœ¨å¤šå¤„ç†å™¨æƒ…å†µä¸‹å¿…é¡»ä½¿ç”¨`lock`æŒ‡ä»¤åŠ é”æ¥å®Œæˆã€‚å½“ç„¶ä¸åŒçš„æ“ä½œç³»ç»Ÿå’Œå¤„ç†å™¨çš„å®ç°ä¼šæœ‰æ‰€ä¸åŒï¼Œå¤§å®¶å¯ä»¥è‡ªè¡Œäº†è§£ã€‚\n\nå½“ç„¶ï¼ŒUnsafe ç±»é‡Œé¢è¿˜æœ‰å…¶å®ƒæ–¹æ³•ç”¨äºä¸åŒçš„ç”¨é€”ã€‚æ¯”å¦‚æ”¯æŒçº¿ç¨‹æŒ‚èµ·å’Œæ¢å¤çš„`park`å’Œ`unpark`ï¼Œ LockSupport ç±»åº•å±‚å°±æ˜¯è°ƒç”¨äº†è¿™ä¸¤ä¸ªæ–¹æ³•ã€‚è¿˜æœ‰æ”¯æŒåå°„æ“ä½œçš„`allocateInstance()`æ–¹æ³•ã€‚\n\n#### CAS ä¼šäº§ç”Ÿä»€ä¹ˆé—®é¢˜ï¼Ÿ\n\n1ã€**ABA é—®é¢˜**ï¼š\n\næ¯”å¦‚è¯´ä¸€ä¸ªçº¿ç¨‹ one ä»å†…å­˜ä½ç½® V ä¸­å–å‡º Aï¼Œè¿™æ—¶å€™å¦ä¸€ä¸ªçº¿ç¨‹ two ä¹Ÿä»å†…å­˜ä¸­å–å‡º Aï¼Œå¹¶ä¸” two è¿›è¡Œäº†ä¸€äº›æ“ä½œå˜æˆäº† Bï¼Œç„¶å two åˆå°† V ä½ç½®çš„æ•°æ®å˜æˆ Aï¼Œè¿™æ—¶å€™çº¿ç¨‹ one è¿›è¡Œ CAS æ“ä½œå‘ç°å†…å­˜ä¸­ä»ç„¶æ˜¯ Aï¼Œç„¶å one æ“ä½œæˆåŠŸã€‚å°½ç®¡çº¿ç¨‹ one çš„ CAS æ“ä½œæˆåŠŸï¼Œä½†å¯èƒ½å­˜åœ¨æ½œè—çš„é—®é¢˜ã€‚å¯ä»¥åœ¨å˜é‡ä¸ŠåŠ ä¸€ä¸ªç‰ˆæœ¬æˆ³ã€‚ä» Java1.5 å¼€å§‹ JDK çš„ atomic åŒ…é‡Œæä¾›äº†ä¸€ä¸ªç±» AtomicStampedReference æ¥è§£å†³ ABA é—®é¢˜ã€‚\n\n2ã€**å¾ªç¯æ—¶é—´é•¿å¼€é”€å¤§**ï¼š\n\nå¯¹äºèµ„æºç«äº‰ä¸¥é‡ï¼ˆçº¿ç¨‹å†²çªä¸¥é‡ï¼‰çš„æƒ…å†µï¼ŒCAS è‡ªæ—‹çš„æ¦‚ç‡ä¼šæ¯”è¾ƒå¤§ï¼Œä»è€Œæµªè´¹æ›´å¤šçš„ CPU èµ„æºï¼Œæ•ˆç‡ä½äº synchronizedã€‚\n\n3ã€**åªèƒ½ä¿è¯ä¸€ä¸ªå…±äº«å˜é‡çš„åŸå­æ“ä½œ**ï¼š\n\nå½“å¯¹ä¸€ä¸ªå…±äº«å˜é‡æ‰§è¡Œæ“ä½œæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¾ªç¯ CAS çš„æ–¹å¼æ¥ä¿è¯åŸå­æ“ä½œï¼Œä½†æ˜¯**å¯¹å¤šä¸ªå…±äº«å˜é‡æ“ä½œæ—¶ï¼Œå¾ªç¯ CAS å°±æ— æ³•ä¿è¯æ“ä½œçš„åŸå­æ€§ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ç”¨é”**ã€‚\n\n#### æ­»é”ä¸æ´»é”çš„åŒºåˆ«ï¼Œæ­»é”ä¸é¥¥é¥¿çš„åŒºåˆ«ï¼Ÿ\n\n> åŒºåˆ«ï¼šæ­»é”åŠ¨ä¸äº†äº†ï¼›æ´»é”ä¸€ç›´é‡å¤å°è¯•ã€å¤±è´¥ã€å°è¯•ã€å¤±è´¥ã€‚\n\næ­»é”ï¼šæ˜¯æŒ‡ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„è¿›ç¨‹ï¼ˆæˆ–çº¿ç¨‹ï¼‰åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå› äº‰å¤ºèµ„æºè€Œé€ æˆçš„ä¸€ç§äº’ç›¸ç­‰å¾…çš„ç°è±¡ï¼Œè‹¥æ— å¤–åŠ›ä½œç”¨ï¼Œå®ƒä»¬éƒ½å°†æ— æ³•æ¨è¿›ä¸‹å»ã€‚\n\næ´»é”ï¼šä»»åŠ¡æˆ–è€…æ‰§è¡Œè€…æ²¡æœ‰è¢«é˜»å¡ï¼Œç”±äºæŸäº›æ¡ä»¶æ²¡æœ‰æ»¡è¶³ï¼Œå¯¼è‡´**ä¸€ç›´é‡å¤å°è¯•ï¼Œå¤±è´¥ï¼Œå°è¯•ï¼Œå¤±è´¥**ã€‚\n\næ´»é”å’Œæ­»é”çš„åŒºåˆ«åœ¨äºï¼Œå¤„äºæ´»é”çš„å®ä½“æ˜¯åœ¨ä¸æ–­çš„æ”¹å˜çŠ¶æ€ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„â€œæ´»â€ï¼Œ è€Œå¤„äºæ­»é”çš„å®ä½“è¡¨ç°ä¸ºç­‰å¾…ï¼›æ´»é”æœ‰å¯èƒ½è‡ªè¡Œè§£å¼€ï¼Œæ­»é”åˆ™ä¸èƒ½ã€‚\n\né¥¥é¥¿ï¼šä¸€ä¸ªæˆ–è€…å¤šä¸ªçº¿ç¨‹å› ä¸ºç§ç§åŸå› æ— æ³•è·å¾—æ‰€éœ€è¦çš„èµ„æºï¼Œå¯¼è‡´ä¸€ç›´æ— æ³•æ‰§è¡Œçš„çŠ¶æ€ã€‚\n\nJava ä¸­å¯¼è‡´é¥¥é¥¿çš„åŸå› ï¼šé«˜ä¼˜å…ˆçº§çº¿ç¨‹åå™¬æ‰€æœ‰çš„ä½ä¼˜å…ˆçº§çº¿ç¨‹çš„ CPU æ—¶é—´ã€‚\n\n### AQSè¯¦è§£\n\n#### AQS ä»‹ç»\n\nAQS çš„å…¨ç§°ä¸ºï¼ˆAbstractQueuedSynchronizerï¼‰ï¼ŒæŠ½è±¡é˜Ÿåˆ—åŒæ­¥å™¨ã€‚\n\nä½¿ç”¨ AQS èƒ½ç®€å•ä¸”é«˜æ•ˆåœ°æ„é€ å‡ºåº”ç”¨å¹¿æ³›çš„å¤§é‡çš„åŒæ­¥å™¨ï¼Œæ¯”å¦‚æˆ‘ä»¬æåˆ°çš„ ReentrantLockï¼ŒSemaphoreï¼Œå…¶ä»–çš„è¯¸å¦‚ ReentrantReadWriteLockï¼ŒSynchronousQueueï¼ŒFutureTask ç­‰ç­‰çš†æ˜¯åŸºäº AQS çš„ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬è‡ªå·±ä¹Ÿèƒ½åˆ©ç”¨ AQS éå¸¸è½»æ¾å®¹æ˜“åœ°æ„é€ å‡ºç¬¦åˆæˆ‘ä»¬è‡ªå·±éœ€æ±‚çš„åŒæ­¥å™¨ã€‚\n\n#### AQS åŸç†åˆ†æ\n\n**å¦‚æœè¢«è¯·æ±‚çš„å…±äº«èµ„æºç©ºé—²ï¼Œåˆ™å°†å½“å‰è¯·æ±‚èµ„æºçš„çº¿ç¨‹è®¾ç½®ä¸ºæœ‰æ•ˆçš„å·¥ä½œçº¿ç¨‹ï¼Œå¹¶ä¸”å°†å…±äº«èµ„æºè®¾ç½®ä¸ºé”å®šçŠ¶æ€ã€‚\nå¦‚æœè¢«è¯·æ±‚çš„å…±äº«èµ„æºè¢«å ç”¨ï¼Œé‚£ä¹ˆå°±ä½¿ç”¨ CLH é˜Ÿåˆ—ï¼Œå°†æš‚æ—¶è·å–ä¸åˆ°é”çš„çº¿ç¨‹åŠ å…¥åˆ°é˜Ÿåˆ—ä¸­ã€‚**\n\n> CLH(Craig,Landin,and Hagersten)é˜Ÿåˆ—æ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„åŒå‘é˜Ÿåˆ—ï¼ˆè™šæ‹Ÿçš„åŒå‘é˜Ÿåˆ—å³ä¸å­˜åœ¨é˜Ÿåˆ—å®ä¾‹ï¼Œä»…å­˜åœ¨ç»“ç‚¹ä¹‹é—´çš„å…³è”å…³ç³»ï¼‰ã€‚AQS æ˜¯å°†æ¯æ¡è¯·æ±‚å…±äº«èµ„æºçš„çº¿ç¨‹å°è£…æˆä¸€ä¸ª CLH é˜Ÿåˆ—çš„ä¸€ä¸ªç»“ç‚¹ï¼ˆNodeï¼‰æ¥å®ç°é”çš„åˆ†é…ã€‚\n\nçœ‹ä¸ª AQS(AbstractQueuedSynchronizer)åŸç†å›¾ï¼š\n\n![AQSåŸç†å›¾](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes11474088-c906e727d699fa9c.png)\n\nAQS ä½¿ç”¨ä¸€ä¸ª volatile int ç±»å‹çš„æˆå‘˜å˜é‡ state æ¥è¡¨ç¤ºåŒæ­¥çŠ¶æ€ï¼Œé€šè¿‡å†…ç½®çš„ CLH é˜Ÿåˆ—æ¥å®Œæˆè·å–èµ„æºçº¿ç¨‹çš„æ’é˜Ÿå·¥ä½œã€‚AQS ä½¿ç”¨ CAS å¯¹è¯¥åŒæ­¥çŠ¶æ€è¿›è¡ŒåŸå­æ“ä½œå®ç°å¯¹å…¶å€¼çš„ä¿®æ”¹ã€‚\n\n```java\nprivate volatile int state;\t// å…±äº«å˜é‡ï¼Œä½¿ç”¨volatileä¿®é¥°ä¿è¯çº¿ç¨‹å¯è§æ€§\n```\n\nçŠ¶æ€ä¿¡æ¯é€šè¿‡ protected ç±»å‹çš„ getStateï¼ŒsetStateï¼ŒcompareAndSetState è¿›è¡Œæ“ä½œ\n\n```java\n// è¿”å›åŒæ­¥çŠ¶æ€çš„å½“å‰å€¼\nprotected final int getState() {  \n    return state;\n}\n// è®¾ç½®åŒæ­¥çŠ¶æ€çš„å€¼\nprotected final void setState(int newState) { \n    state = newState;\n}\n// åŸå­åœ°ï¼ˆCASæ“ä½œï¼‰å°†åŒæ­¥çŠ¶æ€å€¼è®¾ç½®ä¸ºç»™å®šå€¼updateå¦‚æœå½“å‰åŒæ­¥çŠ¶æ€çš„å€¼ç­‰äºexpectï¼ˆæœŸæœ›å€¼ï¼‰\nprotected final boolean compareAndSetState(int expect, int update) {\n    return unsafe.compareAndSwapInt(this, stateOffset, expect, update);\n}\n```\n\n**AQS å¯¹èµ„æºçš„å…±äº«æ–¹å¼**\n\nAQS å®šä¹‰ä¸¤ç§èµ„æºå…±äº«æ–¹å¼\n\n- **Exclusive**ï¼ˆç‹¬å ï¼‰ï¼šåªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æ‰§è¡Œï¼Œå¦‚ ReentrantLockã€‚åˆå¯åˆ†ä¸ºå…¬å¹³é”å’Œéå…¬å¹³é”ï¼š\n\t- å…¬å¹³é”ï¼šæŒ‰ç…§çº¿ç¨‹åœ¨é˜Ÿåˆ—ä¸­çš„æ’é˜Ÿé¡ºåºï¼Œå…ˆåˆ°è€…å…ˆæ‹¿åˆ°é”\n\t- éå…¬å¹³é”ï¼šå½“çº¿ç¨‹è¦è·å–é”æ—¶ï¼Œæ— è§†é˜Ÿåˆ—é¡ºåºç›´æ¥å»æŠ¢é”ï¼Œè°æŠ¢åˆ°å°±æ˜¯è°çš„\n- **Share**ï¼ˆå…±äº«ï¼‰ï¼šå¤šä¸ªçº¿ç¨‹å¯åŒæ—¶æ‰§è¡Œï¼Œå¦‚ Semaphore/CountDownLatchã€‚Semaphoreã€CountDownLatchã€ CyclicBarrierã€ReadWriteLock æˆ‘ä»¬éƒ½ä¼šåœ¨åé¢è®²åˆ°ã€‚\n\n**AQSåº•å±‚ä½¿ç”¨äº†æ¨¡æ¿æ–¹æ³•æ¨¡å¼**\n\nåŒæ­¥å™¨çš„è®¾è®¡æ˜¯åŸºäºæ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„ï¼Œå¦‚æœéœ€è¦è‡ªå®šä¹‰åŒæ­¥å™¨ï¼ˆ**æ¨¡æ¿æ–¹æ³•æ¨¡å¼**å¾ˆç»å…¸çš„ä¸€ä¸ªåº”ç”¨ï¼‰ï¼š\n\n1. ä½¿ç”¨è€…ç»§æ‰¿ AQS å¹¶é‡å†™æŒ‡å®šçš„æ–¹æ³•ã€‚ï¼ˆå¯¹å…±äº«èµ„æº state çš„è·å–å’Œé‡Šæ”¾ï¼‰\n2. è°ƒç”¨ AQS çš„æ¨¡æ¿æ–¹æ³•ï¼Œä¼šè¿›ä¸€æ­¥è°ƒç”¨ä½¿ç”¨è€…é‡å†™çš„æ–¹æ³•ã€‚\n\n**AQSä½¿ç”¨äº†æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼Œè‡ªå®šä¹‰åŒæ­¥å™¨æ—¶éœ€è¦é‡å†™ä¸‹é¢å‡ ä¸ªAQSæä¾›çš„æ¨¡æ¿æ–¹æ³•ï¼š**\n\n```java\nisHeldExclusively()\t// è¯¥çº¿ç¨‹æ˜¯å¦æ­£åœ¨ç‹¬å èµ„æºã€‚åªæœ‰ç”¨åˆ°conditionæ‰éœ€è¦å»å®ç°å®ƒã€‚\ntryAcquire(int)\t// ç‹¬å æ–¹å¼ã€‚å°è¯•è·å–èµ„æºï¼ŒæˆåŠŸåˆ™è¿”å›trueï¼Œå¤±è´¥åˆ™è¿”å›falseã€‚\ntryRelease(int)\t// ç‹¬å æ–¹å¼ã€‚å°è¯•é‡Šæ”¾èµ„æºï¼ŒæˆåŠŸåˆ™è¿”å›trueï¼Œå¤±è´¥åˆ™è¿”å›falseã€‚\ntryAcquireShared(int)\t// å…±äº«æ–¹å¼ã€‚å°è¯•è·å–èµ„æºã€‚è´Ÿæ•°è¡¨ç¤ºå¤±è´¥ï¼›0è¡¨ç¤ºæˆåŠŸï¼Œä½†æ²¡æœ‰å‰©ä½™å¯ç”¨èµ„æºï¼›æ­£æ•°è¡¨ç¤ºæˆåŠŸï¼Œä¸”æœ‰å‰©ä½™èµ„æºã€‚\ntryReleaseShared(int)\t// å…±äº«æ–¹å¼ã€‚å°è¯•é‡Šæ”¾èµ„æºï¼ŒæˆåŠŸåˆ™è¿”å›trueï¼Œå¤±è´¥åˆ™è¿”å›falseã€‚\n```\n\nä»¥ ReentrantLock ä¸ºä¾‹ï¼Œstate åˆå§‹åŒ–ä¸º 0ï¼Œè¡¨ç¤ºæœªé”å®šçŠ¶æ€ã€‚A çº¿ç¨‹ lock() æ—¶ï¼Œä¼šè°ƒç”¨ tryAcquire() ç‹¬å è¯¥é”å¹¶å°† state+1ã€‚æ­¤åï¼Œå…¶ä»–çº¿ç¨‹å† tryAcquire() æ—¶å°±ä¼šå¤±è´¥ï¼Œç›´åˆ° A çº¿ç¨‹ unlock( )åˆ° state=0ï¼ˆå³é‡Šæ”¾é”ï¼‰ä¸ºæ­¢ï¼Œå…¶å®ƒçº¿ç¨‹æ‰æœ‰æœºä¼šè·å–è¯¥é”ã€‚å½“ç„¶ï¼Œé‡Šæ”¾é”ä¹‹å‰ï¼ŒA çº¿ç¨‹è‡ªå·±æ˜¯å¯ä»¥é‡å¤è·å–æ­¤é”çš„ï¼ˆstate ä¼šç´¯åŠ ï¼‰ï¼Œè¿™å°±æ˜¯å¯é‡å…¥çš„æ¦‚å¿µã€‚\n\nä»¥ CountDownLatch ä»¥ä¾‹ï¼Œä»»åŠ¡åˆ†ä¸º N ä¸ªå­çº¿ç¨‹å»æ‰§è¡Œï¼Œstate ä¹Ÿåˆå§‹åŒ–ä¸º Nï¼ˆæ³¨æ„ N è¦ä¸çº¿ç¨‹ä¸ªæ•°ä¸€è‡´ï¼‰ã€‚è¿™ N ä¸ªå­çº¿ç¨‹æ˜¯å¹¶è¡Œæ‰§è¡Œçš„ï¼Œæ¯ä¸ªå­çº¿ç¨‹æ‰§è¡Œå®Œå countDown() ä¸€æ¬¡ï¼Œstate ä¼š CAS å‡ 1ã€‚ç­‰åˆ°æ‰€æœ‰å­çº¿ç¨‹éƒ½æ‰§è¡Œå®Œåï¼ˆå³ state=0ï¼‰ï¼Œä¼š unpark() ä¸»è°ƒç”¨çº¿ç¨‹ï¼Œç„¶åä¸»è°ƒç”¨çº¿ç¨‹å°±ä¼šä» await() å‡½æ•°è¿”å›ï¼Œç»§ç»­åç»­åŠ¨ä½œã€‚\n\nä¸€èˆ¬æ¥è¯´ï¼Œè‡ªå®šä¹‰åŒæ­¥å™¨è¦ä¹ˆæ˜¯ç‹¬å æ–¹æ³•ï¼Œè¦ä¹ˆæ˜¯å…±äº«æ–¹å¼ï¼Œä»–ä»¬ä¹Ÿåªéœ€å®ç°`tryAcquire-tryRelease`ã€`tryAcquireShared-tryReleaseShared`ä¸­çš„ä¸€ç§å³å¯ã€‚ä½† AQS ä¹Ÿæ”¯æŒè‡ªå®šä¹‰åŒæ­¥å™¨åŒæ—¶å®ç°ç‹¬å å’Œå…±äº«ä¸¤ç§æ–¹å¼ï¼Œå¦‚`ReentrantReadWriteLock`ã€‚\n\n### è¯»å†™é”\n\né¦–å…ˆæ˜ç¡®ä¸€ä¸‹ï¼Œä¸æ˜¯è¯´ ReentrantLock ä¸å¥½ï¼Œåªæ˜¯ ReentrantLock æŸäº›æ—¶å€™æœ‰å±€é™ã€‚å¦‚æœä½¿ç”¨ ReentrantLockï¼Œå¯èƒ½æœ¬èº«æ˜¯ä¸ºäº†é˜²æ­¢çº¿ç¨‹ A åœ¨å†™æ•°æ®ã€çº¿ç¨‹ B åœ¨è¯»æ•°æ®é€ æˆçš„æ•°æ®ä¸ä¸€è‡´ï¼Œä½†è¿™æ ·ï¼Œå¦‚æœçº¿ç¨‹ C åœ¨è¯»æ•°æ®ã€çº¿ç¨‹ D ä¹Ÿåœ¨è¯»æ•°æ®ï¼Œè¯»æ•°æ®æ˜¯ä¸ä¼šæ”¹å˜æ•°æ®çš„ï¼Œæ²¡æœ‰å¿…è¦åŠ é”ï¼Œä½†æ˜¯è¿˜æ˜¯åŠ é”äº†ï¼Œé™ä½äº†ç¨‹åºçš„æ€§èƒ½ã€‚å› ä¸ºè¿™ä¸ªï¼Œæ‰è¯ç”Ÿäº†è¯»å†™é” ReadWriteLockã€‚\n\nReadWriteLock æ˜¯ä¸€ä¸ªè¯»å†™é”æ¥å£ï¼Œè¯»å†™é”æ˜¯ç”¨æ¥æå‡å¹¶å‘ç¨‹åºæ€§èƒ½çš„é”åˆ†ç¦»æŠ€æœ¯ï¼ŒReentrantReadWriteLock æ˜¯ ReadWriteLock æ¥å£çš„ä¸€ä¸ªå…·ä½“å®ç°ï¼Œ**å®ç°äº†è¯»å†™çš„åˆ†ç¦»ï¼Œè¯»é”æ˜¯å…±äº«çš„ï¼Œå†™é”æ˜¯ç‹¬å çš„**ï¼Œè¯»å’Œè¯»ä¹‹é—´ä¸ä¼šäº’æ–¥ï¼Œè¯»å’Œå†™ã€å†™å’Œè¯»ã€å†™å’Œå†™ä¹‹é—´æ‰ä¼šäº’æ–¥ï¼Œæå‡äº†è¯»å†™çš„æ€§èƒ½ã€‚\n\n## å¹¶å‘å®¹å™¨\n\n### ConcurrentHashMap\n\n#### ä»€ä¹ˆæ˜¯ConcurrentHashMapï¼Ÿ\n\nConcurrentHashMap æ˜¯ Java ä¸­çš„ä¸€ä¸ª**çº¿ç¨‹å®‰å…¨ä¸”é«˜æ•ˆçš„HashMapå®ç°**ã€‚\n\né‚£ä¹ˆå®ƒåˆ°åº•æ˜¯å¦‚ä½•å®ç°çº¿ç¨‹å®‰å…¨çš„ï¼Ÿ\n\nJDK 1.6 ç‰ˆæœ¬å…³é”®è¦ç´ ï¼š\n\n- segment ç»§æ‰¿äº† ReentrantLock å……å½“é”çš„è§’è‰²ï¼Œä¸ºæ¯ä¸€ä¸ª segment æä¾›äº†çº¿ç¨‹å®‰å…¨çš„ä¿éšœï¼›\n- segment ç»´æŠ¤äº†å“ˆå¸Œæ•£åˆ—è¡¨çš„è‹¥å¹²ä¸ªæ¡¶ï¼Œæ¯ä¸ªæ¡¶ç”± HashEntry æ„æˆçš„é“¾è¡¨ã€‚\n\nJDK1.8 åï¼ŒConcurrentHashMap æŠ›å¼ƒäº†åŸæœ‰çš„ Segment åˆ†æ®µé”ï¼Œè€Œ**é‡‡ç”¨äº† CAS + synchronized æ¥ä¿è¯å¹¶å‘å®‰å…¨æ€§**ã€‚\n\næ’å…¥å…ƒç´ è¿‡ç¨‹ï¼š\n\nå¦‚æœç›¸åº”ä½ç½®çš„ Node è¿˜æ²¡æœ‰åˆå§‹åŒ–ï¼Œåˆ™è°ƒç”¨ CAS æ’å…¥ç›¸åº”çš„æ•°æ®ï¼›\n\nå¦‚æœç›¸åº”ä½ç½®çš„ Node ä¸ä¸ºç©ºï¼Œåˆ™å¯¹è¯¥èŠ‚ç‚¹åŠ  synchronized é”è¿›è¡Œæ’å…¥æˆ–æ›´æ–°æ“ä½œã€‚\n\n### CopyOnWriteArrayList\n\nCopyOnWrite å®¹å™¨å³**å†™æ—¶å¤åˆ¶çš„å®¹å™¨**ï¼Œå½“æˆ‘ä»¬å¾€ä¸€ä¸ªå®¹å™¨ä¸­æ·»åŠ å…ƒç´ çš„æ—¶å€™ï¼Œä¸ç›´æ¥å¾€å®¹å™¨ä¸­æ·»åŠ ï¼Œè€Œæ˜¯å°†å½“å‰å®¹å™¨è¿›è¡Œ copyï¼Œå¤åˆ¶å‡ºæ¥ä¸€ä¸ªæ–°çš„å®¹å™¨ï¼Œç„¶åå‘æ–°å®¹å™¨ä¸­æ·»åŠ æˆ‘ä»¬éœ€è¦çš„å…ƒç´ ï¼Œæœ€åå°†åŸå®¹å™¨çš„å¼•ç”¨æŒ‡å‘æ–°å®¹å™¨ã€‚\n\n**CopyOnWriteArrayList çš„ä½¿ç”¨åœºæ™¯**\n\né€šè¿‡æºç åˆ†æï¼Œæˆ‘ä»¬çœ‹å‡ºå®ƒçš„ä¼˜ç¼ºç‚¹æ¯”è¾ƒæ˜æ˜¾ï¼Œæ‰€ä»¥ä½¿ç”¨åœºæ™¯ä¹Ÿå°±æ¯”è¾ƒæ˜æ˜¾ã€‚å°±æ˜¯åˆé€‚è¯»å¤šå†™å°‘çš„åœºæ™¯ã€‚\n\n**CopyOnWriteArrayList çš„ç¼ºç‚¹**\n\n1. ç”±äºå†™æ“ä½œçš„æ—¶å€™ï¼Œéœ€è¦æ‹·è´æ•°ç»„ï¼Œä¼šæ¶ˆè€—å†…å­˜ï¼Œå¦‚æœåŸæ•°ç»„çš„å†…å®¹æ¯”è¾ƒå¤šçš„æƒ…å†µä¸‹ï¼Œå¯èƒ½å¯¼è‡´ young gc æˆ–è€… full gcã€‚\n2. **ä¸èƒ½ç”¨äºå®æ—¶è¯»çš„åœºæ™¯**ï¼Œåƒæ‹·è´æ•°ç»„ã€æ–°å¢å…ƒç´ éƒ½éœ€è¦æ—¶é—´ï¼Œæ‰€ä»¥è°ƒç”¨ä¸€ä¸ª set æ“ä½œåï¼Œ**è¯»å–åˆ°æ•°æ®å¯èƒ½è¿˜æ˜¯æ—§çš„**ï¼Œè™½ç„¶ CopyOnWriteArrayList èƒ½åšåˆ°æœ€ç»ˆä¸€è‡´æ€§,ä½†æ˜¯è¿˜æ˜¯æ²¡æ³•æ»¡è¶³å®æ—¶æ€§è¦æ±‚ã€‚\n\n### ThreadLocal\n\n#### ThreadLocalçš„æ•°æ®ç»“æ„\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesthreadlocal%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84.a0bfadf8.png\" alt=\"ThreadLocalæ•°æ®ç»“æ„\" style=\"zoom: 67%;\" />\n\næ¯ä¸ªçº¿ç¨‹ Thread ä¸­æœ‰ä¸€ä¸ªç±»å‹ä¸º ThreadLocal.ThreadLocalMap çš„å®ä¾‹å˜é‡ threadLocalsï¼Œè¯¥å®ä¾‹å˜é‡ä¸­æ¯ä¸ª entry ä¸º <threadLocal çš„å¼±å¼•ç”¨ï¼Œvalue ä¸ºå¼ºå¼•ç”¨> çš„æ˜ å°„ï¼Œæ¯ä¸ªçº¿ç¨‹å¾€ threadLocal ä¸­å¯¹ value è¿›è¡Œæ“ä½œæ—¶ï¼Œéƒ½æ˜¯åœ¨è‡ªå·±çº¿ç¨‹ç§æœ‰çš„ threadLocalMap ä¸­è¿›è¡Œæ“ä½œï¼Œä»è€Œè¾¾åˆ°çº¿ç¨‹éš”ç¦»ã€‚\n\n```java\npublic class ThreadLocalDemo {\n    // private static final ThreadLocal<Integer> threadLocal = new ThreadLocal<Integer>(){\n    //     @Override\n    //     protected Integer initialValue() {\n    //         return 0;\n    //     }\n    // };\n\n    private static final ThreadLocal<Integer> threadLocal = ThreadLocal.withInitial(() -> 0);\n\n    public static void main(String[] args) {\n        for (int i = 0; i < 2; i++) {\n            new Thread(() -> {\n                for (int j = 0; j < 5; j++) {\n                    Integer val = threadLocal.get();\n                    threadLocal.set(++val);\n                    System.out.println(Thread.currentThread().getName() + \" ---- \" + val);\n                }\n            }, \"Thread-\" + i).start();\n        }\n\n        try {\n            Thread.sleep(10);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n\n        System.out.println(Thread.currentThread().getName() + \" ---- \" + threadLocal.get());\n    }\n}\n```\n\næ‰“å°ç»“æœï¼šå¯åŠ¨äº† 2 ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹æœ€åéƒ½æ‰“å°åˆ° 5ï¼Œ æœ€å threadLocal.get ä»ç„¶æ˜¯ 0\n\n```java\nThread-1 ---- 1\nThread-0 ---- 1\nThread-1 ---- 2\nThread-0 ---- 2\nThread-1 ---- 3\nThread-1 ---- 4\nThread-1 ---- 5\nThread-0 ---- 3\nThread-0 ---- 4\nThread-0 ---- 5\nmain ---- 0\n```\n\n### ThreadLocalå†…å­˜æ³„æ¼\n\n#### ThreadLocalé€ æˆå†…å­˜æ³„æ¼çš„åŸå› ï¼Ÿ\n\nThreadLocalMap ä¸­ä½¿ç”¨çš„ key ä¸º ThreadLocal çš„å¼±å¼•ç”¨,è€Œ value æ˜¯å¼ºå¼•ç”¨ã€‚æ‰€ä»¥ï¼Œå¦‚æœ ThreadLocal æ²¡æœ‰è¢«å¤–éƒ¨å¼ºå¼•ç”¨çš„æƒ…å†µä¸‹ï¼Œåœ¨åƒåœ¾å›æ”¶çš„æ—¶å€™ï¼Œkey ä¼šè¢«æ¸…ç†æ‰ï¼Œè€Œ value ä¸ä¼šè¢«æ¸…ç†æ‰ã€‚è¿™æ ·ä¸€æ¥ï¼ŒThreadLocalMap ä¸­å°±ä¼šå‡ºç° key ä¸º null çš„ Entryã€‚å‡å¦‚æˆ‘ä»¬ä¸åšä»»ä½•æªæ–½çš„è¯ï¼Œvalue æ°¸è¿œæ— æ³•è¢« GC å›æ”¶ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯èƒ½ä¼šäº§ç”Ÿå†…å­˜æ³„éœ²ã€‚ThreadLocalMap å®ç°ä¸­å·²ç»è€ƒè™‘äº†è¿™ç§æƒ…å†µï¼Œæ¯æ¬¡ä½¿ç”¨å®Œ ThreadLocal åï¼Œéƒ½è°ƒç”¨å®ƒçš„ remove()æ–¹æ³•ï¼Œæ¸…ç†æ‰ key ä¸º null çš„è®°å½•ã€‚\n\n### BlockingQueue\n\né˜»å¡é˜Ÿåˆ—ï¼ˆBlockingQueueï¼‰æ˜¯ä¸€ä¸ªæ”¯æŒä¸¤ä¸ªé™„åŠ æ“ä½œçš„é˜Ÿåˆ—ã€‚\n\nåœ¨é˜Ÿåˆ—ä¸ºç©ºæ—¶ï¼Œè·å–å…ƒç´ çš„çº¿ç¨‹ä¼šç­‰å¾…é˜Ÿåˆ—å˜ä¸ºéç©ºã€‚å½“é˜Ÿåˆ—æ»¡æ—¶ï¼Œå­˜å‚¨å…ƒç´ çš„çº¿ç¨‹ä¼šç­‰å¾…é˜Ÿåˆ—å¯ç”¨ã€‚\n\né˜»å¡é˜Ÿåˆ—å¸¸ç”¨äºç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„åœºæ™¯ï¼Œç”Ÿäº§è€…æ˜¯å¾€é˜Ÿåˆ—é‡Œæ·»åŠ å…ƒç´ çš„çº¿ç¨‹ï¼Œæ¶ˆè´¹è€…æ˜¯ä»é˜Ÿåˆ—é‡Œæ‹¿å…ƒç´ çš„çº¿ç¨‹ã€‚é˜»å¡é˜Ÿåˆ—å°±æ˜¯ç”Ÿäº§è€…å­˜æ”¾å…ƒç´ çš„å®¹å™¨ï¼Œè€Œæ¶ˆè´¹è€…ä¹Ÿåªä»å®¹å™¨é‡Œæ‹¿å…ƒç´ ã€‚\n\nJDK7 æä¾›äº† 7 ä¸ªé˜»å¡é˜Ÿåˆ—ã€‚åˆ†åˆ«æ˜¯ï¼š\n\n> ArrayBlockingQueue ï¼šä¸€ä¸ªç”±æ•°ç»„ç»“æ„ç»„æˆçš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—ã€‚\n> LinkedBlockingQueue ï¼šä¸€ä¸ªç”±é“¾è¡¨ç»“æ„ç»„æˆçš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—ã€‚\n> PriorityBlockingQueue ï¼šä¸€ä¸ªæ”¯æŒä¼˜å…ˆçº§æ’åºçš„æ— ç•Œé˜»å¡é˜Ÿåˆ—ã€‚\n> DelayQueueï¼šä¸€ä¸ªä½¿ç”¨ä¼˜å…ˆçº§é˜Ÿåˆ—å®ç°çš„æ— ç•Œé˜»å¡é˜Ÿåˆ—ã€‚\n> SynchronousQueueï¼šä¸€ä¸ªä¸å­˜å‚¨å…ƒç´ çš„é˜»å¡é˜Ÿåˆ—ã€‚\n> LinkedTransferQueueï¼šä¸€ä¸ªç”±é“¾è¡¨ç»“æ„ç»„æˆçš„æ— ç•Œé˜»å¡é˜Ÿåˆ—ã€‚\n> LinkedBlockingDequeï¼šä¸€ä¸ªç”±é“¾è¡¨ç»“æ„ç»„æˆçš„åŒå‘é˜»å¡é˜Ÿåˆ—ã€‚\n\nJava 5 ä¹‹å‰å®ç°åŒæ­¥å­˜å–æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æ™®é€šçš„ä¸€ä¸ªé›†åˆï¼Œç„¶ååœ¨ä½¿ç”¨çº¿ç¨‹çš„åä½œå’Œçº¿ç¨‹åŒæ­¥å¯ä»¥å®ç°ç”Ÿäº§è€…ï¼Œæ¶ˆè´¹è€…æ¨¡å¼ï¼Œä¸»è¦çš„æŠ€æœ¯å°±æ˜¯ç”¨å¥½ waitï¼Œnotifyï¼ŒnotifyAllï¼Œsynchronized è¿™äº›å…³é”®å­—ã€‚è€Œåœ¨ Java 5 ä¹‹åï¼Œå¯ä»¥ä½¿ç”¨é˜»å¡é˜Ÿåˆ—æ¥å®ç°ï¼Œæ­¤æ–¹å¼å¤§å¤§ç®€å°‘äº†ä»£ç é‡ï¼Œä½¿å¾—å¤šçº¿ç¨‹ç¼–ç¨‹æ›´åŠ å®¹æ˜“ï¼Œå®‰å…¨æ–¹é¢ä¹Ÿæœ‰ä¿éšœã€‚\n\nBlockingQueue æ¥å£æ˜¯ Queue çš„å­æ¥å£ï¼Œå®ƒçš„ä¸»è¦ç”¨é€”å¹¶ä¸æ˜¯ä½œä¸ºå®¹å™¨ï¼Œè€Œæ˜¯ä½œä¸ºçº¿ç¨‹åŒæ­¥çš„çš„å·¥å…·ï¼Œå› æ­¤ä»–å…·æœ‰ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„ç‰¹æ€§ï¼Œ**å½“ç”Ÿäº§è€…çº¿ç¨‹è¯•å›¾å‘ BlockingQueue æ”¾å…¥å…ƒç´ æ—¶ï¼Œå¦‚æœé˜Ÿåˆ—å·²æ»¡ï¼Œåˆ™çº¿ç¨‹è¢«é˜»å¡ï¼Œå½“æ¶ˆè´¹è€…çº¿ç¨‹è¯•å›¾ä»ä¸­å–å‡ºä¸€ä¸ªå…ƒç´ æ—¶ï¼Œå¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™è¯¥çº¿ç¨‹ä¼šè¢«é˜»å¡**ï¼Œæ­£æ˜¯å› ä¸ºå®ƒæ‰€å…·æœ‰è¿™ä¸ªç‰¹æ€§ï¼Œæ‰€ä»¥åœ¨ç¨‹åºä¸­å¤šä¸ªçº¿ç¨‹äº¤æ›¿å‘ BlockingQueue ä¸­æ”¾å…¥å…ƒç´ ï¼Œå–å‡ºå…ƒç´ ï¼Œå®ƒå¯ä»¥å¾ˆå¥½çš„æ§åˆ¶çº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚\n\n## çº¿ç¨‹æ± \n\n### Executors åˆ›å»ºå››ç§å¸¸è§çº¿ç¨‹æ± \n\n#### ä»€ä¹ˆæ˜¯çº¿ç¨‹æ± ï¼Ÿæœ‰å“ªå‡ ç§åˆ›å»ºæ–¹å¼ï¼Ÿ\n\n> æ± åŒ–æŠ€æœ¯çš„æ€æƒ³ä¸»è¦æ˜¯ä¸ºäº†å‡å°‘æ¯æ¬¡è·å–èµ„æºçš„æ¶ˆè€—ï¼Œæé«˜å¯¹èµ„æºçš„åˆ©ç”¨ç‡ã€‚\n\nåœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­ï¼Œåˆ›å»ºå’Œé”€æ¯å¯¹è±¡æ˜¯å¾ˆè´¹æ—¶é—´çš„ï¼Œå› ä¸ºåˆ›å»ºä¸€ä¸ªå¯¹è±¡è¦è·å–å†…å­˜èµ„æºæˆ–è€…å…¶å®ƒæ›´å¤šèµ„æºã€‚åœ¨ Java ä¸­æ›´æ˜¯å¦‚æ­¤ï¼Œè™šæ‹Ÿæœºå°†è¯•å›¾è·Ÿè¸ªæ¯ä¸€ä¸ªå¯¹è±¡ï¼Œä»¥ä¾¿èƒ½å¤Ÿåœ¨å¯¹è±¡é”€æ¯åè¿›è¡Œåƒåœ¾å›æ”¶ã€‚æ‰€ä»¥æé«˜æœåŠ¡ç¨‹åºæ•ˆç‡çš„ä¸€ä¸ªæ‰‹æ®µå°±æ˜¯**å°½å¯èƒ½å‡å°‘åˆ›å»ºå’Œé”€æ¯å¯¹è±¡çš„æ¬¡æ•°**ï¼Œç‰¹åˆ«æ˜¯ä¸€äº›å¾ˆè€—èµ„æºçš„å¯¹è±¡åˆ›å»ºå’Œé”€æ¯ï¼Œè¿™å°±æ˜¯â€æ± åŒ–èµ„æºâ€æŠ€æœ¯äº§ç”Ÿçš„åŸå› ã€‚\n\nçº¿ç¨‹æ± é¡¾åæ€ä¹‰å°±æ˜¯äº‹å…ˆåˆ›å»ºè‹¥å¹²ä¸ªå¯æ‰§è¡Œçš„çº¿ç¨‹æ”¾å…¥ä¸€ä¸ªæ± ï¼ˆå®¹å™¨ï¼‰ä¸­ï¼Œéœ€è¦çš„æ—¶å€™ä»æ± ä¸­è·å–çº¿ç¨‹ä¸ç”¨è‡ªè¡Œåˆ›å»ºï¼Œä½¿ç”¨å®Œæ¯•ä¸éœ€è¦é”€æ¯çº¿ç¨‹è€Œæ˜¯æ”¾å›æ± ä¸­ï¼Œä»è€Œå‡å°‘åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹å¯¹è±¡çš„å¼€é”€ã€‚Java 5+ä¸­çš„ Executor æ¥å£å®šä¹‰ä¸€ä¸ªæ‰§è¡Œçº¿ç¨‹çš„å·¥å…·ã€‚å®ƒçš„å­ç±»å‹å³çº¿ç¨‹æ± æ¥å£æ˜¯ ExecutorServiceã€‚è¦é…ç½®ä¸€ä¸ªçº¿ç¨‹æ± æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼Œå°¤å…¶æ˜¯å¯¹äºçº¿ç¨‹æ± çš„åŸç†ä¸æ˜¯å¾ˆæ¸…æ¥šçš„æƒ…å†µä¸‹ï¼Œå› æ­¤åœ¨å·¥å…·ç±» Executors é¢æä¾›äº†ä¸€äº›é™æ€å·¥å‚æ–¹æ³•ï¼Œç”Ÿæˆä¸€äº›å¸¸ç”¨çš„çº¿ç¨‹æ± ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\n\nï¼ˆ1ï¼‰Executors.newSingleThreadExecutorï¼š`1, 1, new LinkedBlockingQueue`ã€‚æ‰€æœ‰ä»»åŠ¡æŒ‰ç…§**å…ˆæ¥å…ˆæ‰§è¡Œ**çš„é¡ºåºæ‰§è¡Œã€‚å¦‚æœè¿™ä¸ªå”¯ä¸€çš„çº¿ç¨‹ä¸ç©ºé—²ï¼Œé‚£ä¹ˆæ–°æ¥çš„ä»»åŠ¡ä¼šå­˜å‚¨åœ¨ä»»åŠ¡é˜Ÿåˆ—é‡Œç­‰å¾…æ‰§è¡Œã€‚ï¼ˆç”±äºé˜»å¡é˜Ÿåˆ—é»˜è®¤å¤§å°ä¸º Integer.MAX_VALUEï¼Œå› æ­¤å¯èƒ½ OOMï¼‰\n\nï¼ˆ2ï¼‰Executors.newFixedThreadPoolï¼š`nCoreThreads, nCoreThreads, new LinkedBlockingQueue`ï¼Œæ‰€ä»¥åªèƒ½åˆ›å»ºæ ¸å¿ƒçº¿ç¨‹ï¼Œä¸èƒ½åˆ›å»ºéæ ¸å¿ƒçº¿ç¨‹ã€‚å› ä¸º LinkedBlockingQueue çš„é»˜è®¤å¤§å°æ˜¯ Integer.MAX_VALUEï¼Œæ•…å¦‚æœæ ¸å¿ƒçº¿ç¨‹ç©ºé—²ï¼Œåˆ™äº¤ç»™æ ¸å¿ƒçº¿ç¨‹å¤„ç†ï¼›å¦‚æœæ ¸å¿ƒçº¿ç¨‹ä¸ç©ºé—²ï¼Œåˆ™å…¥åˆ—ç­‰å¾…ï¼Œç›´åˆ°æ ¸å¿ƒçº¿ç¨‹ç©ºé—²ã€‚ï¼ˆç”±äºé˜»å¡é˜Ÿåˆ—é»˜è®¤å¤§å°ä¸º Integer.MAX_VALUEï¼Œå› æ­¤å¯èƒ½ OOMï¼‰\n\nï¼ˆ3ï¼‰ Executors.newCachedThreadPoolï¼š`0, Integer.MAX_VALUE`ï¼Œä¸åˆ›å»ºæ ¸å¿ƒçº¿ç¨‹ï¼Œçº¿ç¨‹æ± æœ€å¤§ä¸º Integer.MAX_VALUEã€‚ï¼ˆçº¿ç¨‹æ± å¤ªå¤§å¯¼è‡´ OOMï¼‰\n\nnewCachedThreadPool å’Œ newFixedThreadPool éƒ½å‡ ä¹ä¸ä¼šè§¦å‘æ‹’ç»ç­–ç•¥ï¼Œä½†æ˜¯åŸç†ä¸åŒã€‚\nFixedThreadPool æ˜¯å› ä¸ºé˜»å¡é˜Ÿåˆ—å¯ä»¥å¾ˆå¤§ï¼ˆæœ€å¤§ä¸º Integer æœ€å¤§å€¼ï¼‰ï¼Œæ•…å‡ ä¹ä¸ä¼šè§¦å‘æ‹’ç»ç­–ç•¥ï¼›CachedThreadPool æ˜¯å› ä¸ºçº¿ç¨‹æ± å¾ˆå¤§ï¼ˆæœ€å¤§ä¸º Integer æœ€å¤§å€¼ï¼‰ï¼Œå‡ ä¹ä¸ä¼šå¯¼è‡´çº¿ç¨‹æ•°é‡å¤§äºæœ€å¤§çº¿ç¨‹æ•°ï¼Œæ•…å‡ ä¹ä¸ä¼šè§¦å‘æ‹’ç»ç­–ç•¥ã€‚\n\nï¼ˆ4ï¼‰Executors.newScheduledThreadPoolï¼š`nCoreThreads, Integer.MAX_VALUE`åˆ›å»ºä¸€ä¸ªå¤§å°æ— é™çš„çº¿ç¨‹æ± ã€‚æ­¤çº¿ç¨‹æ± æ”¯æŒå®šæ—¶ä»¥åŠå‘¨æœŸæ€§æ‰§è¡Œä»»åŠ¡çš„éœ€æ±‚ã€‚\n\n#### çº¿ç¨‹æ± æœ‰ä»€ä¹ˆä¼˜ç‚¹ï¼Ÿ\n\n- é™ä½èµ„æºæ¶ˆè€—ï¼šé‡ç”¨å­˜åœ¨çš„çº¿ç¨‹ï¼Œå‡å°‘å¯¹è±¡åˆ›å»ºé”€æ¯çš„å¼€é”€ï¼›\n- æé«˜å“åº”é€Ÿåº¦ï¼šå½“ä»»åŠ¡åˆ°è¾¾æ—¶ï¼Œä»»åŠ¡å¯ä»¥ä¸éœ€è¦çš„ç­‰åˆ°çº¿ç¨‹åˆ›å»ºå°±èƒ½ç«‹å³æ‰§è¡Œï¼›\n- æé«˜çº¿ç¨‹çš„å¯ç®¡ç†æ€§ï¼šä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥è¿›è¡Œç»Ÿä¸€çš„åˆ†é…ï¼Œè°ƒä¼˜å’Œç›‘æ§ã€‚\n\n#### çº¿ç¨‹æ± éƒ½æœ‰å“ªäº›çŠ¶æ€ï¼Ÿ\n\n- RUNNINGï¼šæ¥å—æ–°çš„ä»»åŠ¡æäº¤ï¼Œå¤„ç†ç­‰å¾…é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼›\n- SHUTDOWNï¼šä¸æ¥å—æ–°çš„ä»»åŠ¡æäº¤ï¼Œä½†æ˜¯ä¼šç»§ç»­å¤„ç†ç­‰å¾…é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼›\n- STOPï¼šä¸æ¥å—æ–°çš„ä»»åŠ¡æäº¤ï¼Œä¸å†å¤„ç†ç­‰å¾…é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼Œä¸­æ–­æ­£åœ¨æ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹ï¼›\n- TIDYINGï¼šæ‰€æœ‰çš„ä»»åŠ¡éƒ½é”€æ¯äº†ï¼ŒworkCount ä¸º 0ï¼Œçº¿ç¨‹æ± çš„çŠ¶æ€åœ¨è½¬æ¢ä¸º TIDYING çŠ¶æ€æ—¶ï¼Œä¼šæ‰§è¡Œé’©å­æ–¹æ³• terminated()ï¼›\n- TERMINATEDï¼šterminated()æ–¹æ³•ç»“æŸåï¼Œçº¿ç¨‹æ± çš„çŠ¶æ€å°±ä¼šå˜æˆè¿™ä¸ªã€‚\n\n#### åœ¨ Java ä¸­ Executor å’Œ Executors çš„åŒºåˆ«ï¼Ÿ\n\n- **Executors å·¥å…·ç±»**çš„ä¸åŒæ–¹æ³•æŒ‰ç…§æˆ‘ä»¬çš„éœ€æ±‚**åˆ›å»ºäº†ä¸åŒçš„çº¿ç¨‹æ± **ï¼Œæ¥æ»¡è¶³ä¸šåŠ¡çš„éœ€æ±‚ï¼›\n- **Executor æ¥å£å¯¹è±¡æ‰§è¡Œæˆ‘ä»¬çš„çº¿ç¨‹ä»»åŠ¡**ï¼ŒExecutorService æ¥å£ç»§æ‰¿äº† Executor æ¥å£å¹¶è¿›è¡Œäº†æ‰©å±•ï¼Œæä¾›äº†æ›´å¤šçš„æ–¹æ³•æˆ‘ä»¬èƒ½è·å¾—ä»»åŠ¡æ‰§è¡Œçš„çŠ¶æ€å¹¶ä¸”å¯ä»¥è·å–ä»»åŠ¡çš„è¿”å›å€¼ã€‚\n\n#### çº¿ç¨‹æ± ä¸­ submit() å’Œ execute() æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\næ¥æ”¶å‚æ•°ï¼šsubmit() å¯ä»¥æ‰§è¡Œ Runnable å’Œ Callable ç±»å‹çš„ä»»åŠ¡ï¼Œè€Œ execute()åªèƒ½æ‰§è¡Œ Runnable ç±»å‹çš„ä»»åŠ¡ï¼›\n\nè¿”å›å€¼ï¼šsubmit() æ–¹æ³•å¯ä»¥è¿”å›æŒæœ‰è®¡ç®—ç»“æœçš„ Future å¯¹è±¡ï¼Œè€Œ execute() æ²¡æœ‰ï¼›\n\nå¼‚å¸¸å¤„ç†ï¼šsubmit() æ–¹ä¾¿ Exception å¤„ç†ã€‚\n\n### ThreadPoolExecutor è‡ªå®šä¹‰çº¿ç¨‹æ± \n\n#### Executors\n\nã€Šé˜¿é‡Œå·´å·´ Java å¼€å‘æ‰‹å†Œã€‹ä¸­å¼ºåˆ¶çº¿ç¨‹æ± ä¸å…è®¸ä½¿ç”¨ Executors å»åˆ›å»ºï¼Œè€Œæ˜¯**é€šè¿‡ ThreadPoolExecutor çš„æ–¹å¼**ï¼Œè¿™æ ·çš„å¤„ç†æ–¹å¼è®©å†™çš„åŒå­¦**æ›´åŠ æ˜ç¡®çº¿ç¨‹æ± çš„è¿è¡Œè§„åˆ™ï¼Œè§„é¿èµ„æºè€—å°½çš„é£é™©**\n\nExecutors å„ä¸ªæ–¹æ³•çš„å¼Šç«¯ï¼š\n\n- newSingleThreadExecutor å’Œ newFixedThreadPool :\n\t`0, 0`å’Œ `n, n` ï¼Œä½†æ˜¯ä½¿ç”¨ LinkedBlockingQueueï¼Œæœ€å¤§å¯ä»¥ä¸º Integer.MAX_VALUE\n\n\tä¸»è¦é—®é¢˜æ˜¯å †ç§¯çš„è¯·æ±‚å¤„ç†é˜Ÿåˆ—å¯èƒ½ä¼šè€—è´¹éå¸¸å¤§çš„å†…å­˜ï¼Œç”šè‡³ OOMã€‚\n\n- newCachedThreadPool å’Œ newScheduledThreadPool:\n\t`0, Integer.MAX_VALUE` å’Œ `n, Integer.MAX_VALUE`\n\n\tä¸»è¦é—®é¢˜æ˜¯çº¿ç¨‹æ•°æœ€å¤§æ•°æ˜¯ Integer.MAX_VALUEï¼Œå¯èƒ½ä¼šåˆ›å»ºæ•°é‡éå¸¸å¤šçš„çº¿ç¨‹ï¼Œç”šè‡³ OOM\n\nThreaPoolExecutor åˆ›å»ºçº¿ç¨‹æ± æ–¹å¼åªæœ‰ä¸€ç§ï¼Œå°±æ˜¯èµ°å®ƒçš„æ„é€ å‡½æ•°ï¼Œå‚æ•°è‡ªå·±æŒ‡å®š\n\n#### ThreaPoolExecutor \n\nåˆ›å»ºçº¿ç¨‹æ± çš„æ–¹å¼æœ‰å¤šç§ï¼Œè¿™é‡Œä½ åªéœ€è¦ç­” ThreadPoolExecutor å³å¯ã€‚\n\nThreadPoolExecutor() æ˜¯æœ€åŸå§‹çš„çº¿ç¨‹æ± åˆ›å»ºï¼Œä¹Ÿæ˜¯é˜¿é‡Œå·´å·´ Java å¼€å‘æ‰‹å†Œä¸­æ˜ç¡®è§„èŒƒçš„åˆ›å»ºçº¿ç¨‹æ± çš„æ–¹å¼ã€‚\n\n#### ThreadPoolExecutoræ„é€ å‡½æ•°é‡è¦å‚æ•°åˆ†æ\n\n**`ThreadPoolExecutor`** **3 ä¸ªæœ€é‡è¦çš„å‚æ•°ï¼š**\n\n- **`corePoolSize`** ï¼šæ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œçº¿ç¨‹æ•°å®šä¹‰äº†æœ€å°å¯ä»¥åŒæ—¶è¿è¡Œçš„çº¿ç¨‹æ•°é‡\n- **`maximumPoolSize`** ï¼šçº¿ç¨‹æ± ä¸­å…è®¸å­˜åœ¨çš„å·¥ä½œçº¿ç¨‹çš„æœ€å¤§æ•°é‡\n- **`workQueue`**ï¼šå½“æ–°ä»»åŠ¡æ¥çš„æ—¶å€™ä¼šå…ˆåˆ¤æ–­å½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°é‡æ˜¯å¦è¾¾åˆ°æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œå¦‚æœè¾¾åˆ°çš„è¯ï¼Œä»»åŠ¡å°±ä¼šè¢«å­˜æ”¾åœ¨ç­‰å¾…é˜Ÿåˆ—ä¸­\n\n`ThreadPoolExecutor`å…¶ä»–å¸¸è§å‚æ•°:\n\n1. **`keepAliveTime`**ï¼šéæ ¸å¿ƒçº¿ç¨‹å¦‚æœå¤„äºé—²ç½®çŠ¶æ€è¶…è¿‡è¯¥å€¼ï¼Œå°±ä¼šè¢«é”€æ¯ã€‚\n2. **`unit`** ï¼š`keepAliveTime` é—²ç½®é”€æ¯æ—¶é•¿çš„æ—¶é—´å•ä½\n3. **`threadFactory`**ï¼šä¸ºçº¿ç¨‹æ± æä¾›åˆ›å»ºæ–°çº¿ç¨‹çš„çº¿ç¨‹å·¥å‚\n4. **`handler`** ï¼šçº¿ç¨‹æ± ä»»åŠ¡é˜Ÿåˆ—è¶…è¿‡ maxinumPoolSize ä¹‹åçš„æ‹’ç»ç­–ç•¥\n\n#### ThreadPoolExecutoræ‹’ç»ç­–ç•¥\n\n**`ThreadPoolExecutor`** **æ‹’ç»ç­–ç•¥å®šä¹‰:**\n\nå¦‚æœå½“å‰åŒæ—¶è¿è¡Œçš„çº¿ç¨‹æ•°é‡è¾¾åˆ°æœ€å¤§çº¿ç¨‹æ•°é‡å¹¶ä¸”ç­‰å¾…é˜Ÿåˆ—ä¹Ÿå·²ç»è¢«æ”¾æ»¡æ—¶ï¼Œ`ThreadPoolTaskExecutor` å®šä¹‰ä¸€äº›ç­–ç•¥:\n\n- **`ThreadPoolExecutor.AbortPolicy`**ï¼šæŠ›å‡º `RejectedExecutionException`æ¥æ‹’ç»æ–°ä»»åŠ¡çš„å¤„ç†ã€‚\n- **`ThreadPoolExecutor.CallerRunsPolicy`**ï¼šè°ƒç”¨æ‰§è¡Œè‡ªå·±çš„çº¿ç¨‹è¿è¡Œä»»åŠ¡ã€‚\n- **`ThreadPoolExecutor.DiscardPolicy`**ï¼šä¸å¤„ç†æ–°ä»»åŠ¡ï¼Œç›´æ¥ä¸¢å¼ƒæ‰ã€‚\n- **`ThreadPoolExecutor.DiscardOldestPolicy`**ï¼š æ­¤ç­–ç•¥å°†ä¸¢å¼ƒæœ€æ—©çš„æœªå¤„ç†çš„ä»»åŠ¡è¯·æ±‚ã€‚\n\n#### ä¸€ä¸ªç®€å•çš„çº¿ç¨‹æ± Demo:`Runnable` + `ThreadPoolExecutor`\n\nçº¿ç¨‹æ± å®ç°åŸç†\n\n![çº¿ç¨‹æ± å®ç°åŸç†](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOS8xMS8yNS8xNmVhMDQ3NjEyOTVlNzY2.png)\n\n**æ€»ç»“ä¸€ä¸‹å¤„ç†æµç¨‹**\n\n1. çº¿ç¨‹æ€»æ•°é‡ < corePoolSizeï¼Œæ— è®ºçº¿ç¨‹æ˜¯å¦ç©ºé—²ï¼Œéƒ½ä¼šæ–°å»ºä¸€ä¸ªæ ¸å¿ƒçº¿ç¨‹æ‰§è¡Œä»»åŠ¡ï¼ˆè®©æ ¸å¿ƒçº¿ç¨‹æ•°é‡å¿«é€Ÿè¾¾åˆ° corePoolSizeï¼Œåœ¨æ ¸å¿ƒçº¿ç¨‹æ•°é‡ < corePoolSize æ—¶ï¼‰ã€‚**æ³¨æ„ï¼Œè¿™ä¸€æ­¥éœ€è¦è·å¾—å…¨å±€é”ã€‚**\n2. çº¿ç¨‹æ€»æ•°é‡ >= corePoolSize æ—¶ï¼Œæ–°æ¥çš„çº¿ç¨‹ä»»åŠ¡ä¼šè¿›å…¥ç­‰å¾…é˜Ÿåˆ—ä¸­ç­‰å¾…ï¼Œç„¶åç©ºé—²çš„æ ¸å¿ƒçº¿ç¨‹ä¼šä¾æ¬¡å»ç¼“å­˜é˜Ÿåˆ—ä¸­å–ä»»åŠ¡æ¥æ‰§è¡Œï¼ˆä½“ç°äº†**çº¿ç¨‹å¤ç”¨**ï¼‰ã€‚ \n3. å½“ç­‰å¾…é˜Ÿåˆ—æ»¡äº†ï¼Œè¯´æ˜è¿™ä¸ªæ—¶å€™ä»»åŠ¡å·²ç»å¤šåˆ°çˆ†æ£šï¼Œéœ€è¦ä¸€äº›â€œä¸´æ—¶å·¥â€æ¥æ‰§è¡Œè¿™äº›ä»»åŠ¡äº†ã€‚äºæ˜¯ä¼šåˆ›å»ºéæ ¸å¿ƒçº¿ç¨‹å»æ‰§è¡Œè¿™ä¸ªä»»åŠ¡ã€‚**æ³¨æ„ï¼Œè¿™ä¸€æ­¥éœ€è¦è·å¾—å…¨å±€é”ã€‚**\n4. ç¼“å­˜é˜Ÿåˆ—ä¹‹å‰æ»¡äº†ï¼Œ ç°åœ¨åŠ éæ ¸å¿ƒçº¿ç¨‹ä¸”æ€»çº¿ç¨‹æ•°è¾¾åˆ°äº† maximumPoolSizeï¼Œåˆ™ä¼šé‡‡å–ä¸Šé¢æåˆ°çš„æ‹’ç»ç­–ç•¥è¿›è¡Œå¤„ç†ã€‚\n\næ•´ä¸ªè¿‡ç¨‹å¦‚å›¾æ‰€ç¤ºï¼š\n\nä¸ºäº†è®©å¤§å®¶æ›´æ¸…æ¥šä¸Šé¢çš„é¢è¯•é¢˜ä¸­çš„ä¸€äº›æ¦‚å¿µï¼Œæˆ‘å†™äº†ä¸€ä¸ªç®€å•çš„çº¿ç¨‹æ±  Demoã€‚\n\né¦–å…ˆåˆ›å»ºä¸€ä¸ª `Runnable` æ¥å£çš„å®ç°ç±»ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥æ˜¯ `Callable` æ¥å£ï¼Œæˆ‘ä»¬ä¸Šé¢ä¹Ÿè¯´äº†ä¸¤è€…çš„åŒºåˆ«ã€‚ï¼‰\n\n```java\nimport Java.util.Date;\n\n/**\n * è¿™æ˜¯ä¸€ä¸ªç®€å•çš„Runnableç±»ï¼Œéœ€è¦å¤§çº¦5ç§’é’Ÿæ¥æ‰§è¡Œå…¶ä»»åŠ¡ã€‚\n */\npublic class MyRunnable implements Runnable {\n\n    private String command;\n\n    public MyRunnable(String s) {\n        this.command = s;\n    }\n\n    @Override\n    public void run() {\n        System.out.println(Thread.currentThread().getName() + \" Start. Time = \" + new Date());\n        processCommand();\n        System.out.println(Thread.currentThread().getName() + \" End. Time = \" + new Date());\n    }\n\n    private void processCommand() {\n        try {\n            Thread.sleep(5000);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n    }\n\n    @Override\n    public String toString() {\n        return this.command;\n    }\n}\n```\n\nç¼–å†™æµ‹è¯•ç¨‹åºï¼Œæˆ‘ä»¬è¿™é‡Œä»¥é˜¿é‡Œå·´å·´æ¨èçš„ä½¿ç”¨ `ThreadPoolExecutor` æ„é€ å‡½æ•°è‡ªå®šä¹‰å‚æ•°çš„æ–¹å¼æ¥åˆ›å»ºçº¿ç¨‹æ± ã€‚\n\n```java\nimport Java.util.concurrent.ArrayBlockingQueue;\nimport Java.util.concurrent.ThreadPoolExecutor;\nimport Java.util.concurrent.TimeUnit;\n\npublic class ThreadPoolExecutorDemo {\n\n    private static final int CORE_POOL_SIZE = 5;\n    private static final int MAX_POOL_SIZE = 10;\n    private static final int QUEUE_CAPACITY = 100;\n    private static final Long KEEP_ALIVE_TIME = 1L;\n    public static void main(String[] args) {\n\n        //ä½¿ç”¨é˜¿é‡Œå·´å·´æ¨èçš„åˆ›å»ºçº¿ç¨‹æ± çš„æ–¹å¼\n        //é€šè¿‡ThreadPoolExecutoræ„é€ å‡½æ•°è‡ªå®šä¹‰å‚æ•°åˆ›å»º\n        ThreadPoolExecutor executor = new ThreadPoolExecutor(\n                CORE_POOL_SIZE,\n                MAX_POOL_SIZE,\n                KEEP_ALIVE_TIME,\n                TimeUnit.SECONDS,\n                new ArrayBlockingQueue<>(QUEUE_CAPACITY),\n                new ThreadPoolExecutor.CallerRunsPolicy());\n\n        for (int i = 0; i < 10; i++) {\n            //åˆ›å»ºWorkerThreadå¯¹è±¡ï¼ˆWorkerThreadç±»å®ç°äº†Runnable æ¥å£ï¼‰\n            Runnable worker = new MyRunnable(\"\" + i);\n            //æ‰§è¡ŒRunnable\n            executor.execute(worker);\n        }\n        //ç»ˆæ­¢çº¿ç¨‹æ± \n        executor.shutdown();\n        while (!executor.isTerminated()) {\n        }\n        System.out.println(\"Finished all threads\");\n    }\n}\n```\n\nå¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä¸Šé¢çš„ä»£ç æŒ‡å®šäº†ï¼š\n\n1. `corePoolSize`: æ ¸å¿ƒçº¿ç¨‹æ•°ä¸º 5ã€‚\n2. `maximumPoolSize` ï¼šæœ€å¤§çº¿ç¨‹æ•° 10\n3. `keepAliveTime` : ç­‰å¾…æ—¶é—´ä¸º 1Lã€‚\n4. `unit`: ç­‰å¾…æ—¶é—´çš„å•ä½ä¸º TimeUnit.SECONDSã€‚\n5. `workQueue`ï¼šä»»åŠ¡é˜Ÿåˆ—ä¸º `ArrayBlockingQueue`ï¼Œå¹¶ä¸”å®¹é‡ä¸º 100;\n6. `handler`:é¥±å’Œç­–ç•¥ä¸º `CallerRunsPolicy`ã€‚\n\n**Outputï¼š**\n\n```java\npool-1-thread-2 Start. Time = Tue Nov 12 20:59:44 CST 2019\npool-1-thread-5 Start. Time = Tue Nov 12 20:59:44 CST 2019\npool-1-thread-4 Start. Time = Tue Nov 12 20:59:44 CST 2019\npool-1-thread-1 Start. Time = Tue Nov 12 20:59:44 CST 2019\npool-1-thread-3 Start. Time = Tue Nov 12 20:59:44 CST 2019\npool-1-thread-5 End. Time = Tue Nov 12 20:59:49 CST 2019\npool-1-thread-3 End. Time = Tue Nov 12 20:59:49 CST 2019\npool-1-thread-2 End. Time = Tue Nov 12 20:59:49 CST 2019\npool-1-thread-4 End. Time = Tue Nov 12 20:59:49 CST 2019\npool-1-thread-1 End. Time = Tue Nov 12 20:59:49 CST 2019\npool-1-thread-2 Start. Time = Tue Nov 12 20:59:49 CST 2019\npool-1-thread-1 Start. Time = Tue Nov 12 20:59:49 CST 2019\npool-1-thread-4 Start. Time = Tue Nov 12 20:59:49 CST 2019\npool-1-thread-3 Start. Time = Tue Nov 12 20:59:49 CST 2019\npool-1-thread-5 Start. Time = Tue Nov 12 20:59:49 CST 2019\npool-1-thread-2 End. Time = Tue Nov 12 20:59:54 CST 2019\npool-1-thread-3 End. Time = Tue Nov 12 20:59:54 CST 2019\npool-1-thread-4 End. Time = Tue Nov 12 20:59:54 CST 2019\npool-1-thread-5 End. Time = Tue Nov 12 20:59:54 CST 2019\npool-1-thread-1 End. Time = Tue Nov 12 20:59:54 CST 2019\n```\n\n## å¹¶å‘å·¥å…·\n\n### CountDownLatch ä¸ CyclicBarrier\n\nCountDownLatch ä¸ CyclicBarrier éƒ½æ˜¯ç”¨äºæ§åˆ¶å¹¶å‘çš„å·¥å…·ç±»ï¼Œéƒ½å¯ä»¥ç†è§£æˆç»´æŠ¤çš„å°±æ˜¯ä¸€ä¸ªè®¡æ•°å™¨ï¼Œä½†æ˜¯è¿™ä¸¤è€…è¿˜æ˜¯å„æœ‰ä¸åŒä¾§é‡ç‚¹çš„ï¼š\n\n- CountDownLatch å¼ºè°ƒä¸€ä¸ªçº¿ç¨‹ç­‰å¤šä¸ªçº¿ç¨‹å®ŒæˆæŸä»¶äº‹æƒ…ã€‚CyclicBarrier æ˜¯å¤šä¸ªçº¿ç¨‹äº’ç­‰ï¼Œç­‰å¤§å®¶éƒ½å®Œæˆï¼Œå†æºæ‰‹å…±è¿›ï¼›\n- è°ƒç”¨ CountDownLatch çš„ countDown æ–¹æ³•åï¼Œå½“å‰çº¿ç¨‹å¹¶ä¸ä¼šé˜»å¡ï¼Œä¼šç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼›è€Œè°ƒç”¨ CyclicBarrier çš„ await æ–¹æ³•ï¼Œä¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼Œç›´åˆ° CyclicBarrier æŒ‡å®šçš„çº¿ç¨‹å…¨éƒ¨éƒ½åˆ°è¾¾äº†æŒ‡å®šç‚¹çš„æ—¶å€™ï¼Œæ‰èƒ½ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼›\n- CountDownLatch æ˜¯ä¸èƒ½å¤ç”¨çš„ï¼Œè€Œ CyclicBarrier æ˜¯å¯ä»¥å¤ç”¨çš„ã€‚\n\n### Semaphore\n\n**Semaphore(ä¿¡å·é‡)-å…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®ï¼š** synchronized å’Œ ReentrantLock éƒ½æ˜¯ä¸€æ¬¡åªå…è®¸ä¸€ä¸ªçº¿ç¨‹è®¿é—®æŸä¸ªèµ„æºï¼ŒSemaphore(ä¿¡å·é‡)å¯ä»¥æŒ‡å®šå¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®æŸä¸ªèµ„æºã€‚\n\nSemaphore å°±æ˜¯ä¸€ä¸ªä¿¡å·é‡ï¼Œå®ƒçš„ä½œç”¨æ˜¯é™åˆ¶æŸæ®µä»£ç å—çš„å¹¶å‘æ•°ã€‚Semaphore æœ‰ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå¯ä»¥ä¼ å…¥ä¸€ä¸ª int å‹æ•´æ•° nï¼Œè¡¨ç¤ºæŸæ®µä»£ç æœ€å¤šåªæœ‰ n ä¸ªçº¿ç¨‹å¯ä»¥è®¿é—®ï¼Œå¦‚æœè¶…å‡ºäº† nï¼Œé‚£ä¹ˆè¯·ç­‰å¾…ï¼Œç­‰åˆ°æŸä¸ªçº¿ç¨‹æ‰§è¡Œå®Œæ¯•è¿™æ®µä»£ç å—ï¼Œä¸‹ä¸€ä¸ªçº¿ç¨‹å†è¿›å…¥ã€‚ç”±æ­¤å¯ä»¥çœ‹å‡ºå¦‚æœ Semaphore æ„é€ å‡½æ•°ä¸­ä¼ å…¥çš„ int å‹æ•´æ•° n=1ï¼Œç›¸å½“äºå˜æˆäº†ä¸€ä¸ª synchronized äº†ã€‚\n\n## æ¨¡æ‹Ÿ\n\n### æ­»é”\n\n```java\npublic class DeadLock {\n    private static Object A = new Object();\n    private static Object B = new Object();\n\n    public static void main(String[] args) {\n        new Thread(() -> {\n            synchronized (A) {\n                System.out.println(Thread.currentThread().getName() + \" å·²è·å¾—èµ„æºA\");\n                try {\n                    Thread.sleep(1000);\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n                System.out.println(Thread.currentThread().getName() + \" ç­‰å¾…è·å¾—èµ„æºB\");\n                synchronized (B) {\n                    System.out.println(Thread.currentThread().getName() + \" å·²è·å¾—èµ„æºB\");\n                }\n            }\n        }, \"çº¿ç¨‹1\").start();\n\n        new Thread(() -> {\n            synchronized (B) {\n                System.out.println(Thread.currentThread().getName() + \" å·²è·å¾—èµ„æºB\");\n                try {\n                    Thread.sleep(1000);\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n                System.out.println(Thread.currentThread().getName() + \" ç­‰å¾…è·å¾—èµ„æºA\");\n                synchronized (A) {\n                    System.out.println(Thread.currentThread().getName() + \" å·²è·å¾—èµ„æºA\");\n                }\n            }\n        }, \"çº¿ç¨‹2\").start();\n    }\n}\n```\n\n> çº¿ç¨‹1 å·²è·å¾—èµ„æºA\n> çº¿ç¨‹2 å·²è·å¾—èµ„æºB\n> çº¿ç¨‹1 ç­‰å¾…è·å¾—èµ„æºB\n> çº¿ç¨‹2 ç­‰å¾…è·å¾—èµ„æºA\n\n### runæ–¹æ³•å’Œstartæ–¹æ³•\n\n```java\npublic class DiffStartRun {\n    public static void main(String[] args) {\n        new Thread(() -> {\n            System.out.println(Thread.currentThread().getName());\n        }, \"çº¿ç¨‹A\").run();\n\n        new Thread(() -> {\n            System.out.println(Thread.currentThread().getName());\n        }, \"çº¿ç¨‹B\").start();\n    }\n}\n```\n\n> main\n> çº¿ç¨‹B\n>\n> new ä¸€ä¸ª Threadï¼Œçº¿ç¨‹è¿›å…¥äº†æ–°å»ºçŠ¶æ€ã€‚è°ƒç”¨ `start()`æ–¹æ³•ï¼Œä¼šå¯åŠ¨ä¸€ä¸ªçº¿ç¨‹å¹¶ä½¿çº¿ç¨‹è¿›å…¥äº†å°±ç»ªçŠ¶æ€ï¼Œå½“åˆ†é…åˆ°æ—¶é—´ç‰‡åå°±å¯ä»¥å¼€å§‹è¿è¡Œäº†ã€‚ `start()` ä¼šæ‰§è¡Œçº¿ç¨‹çš„ç›¸åº”å‡†å¤‡å·¥ä½œï¼Œç„¶åè‡ªåŠ¨æ‰§è¡Œ `run()` æ–¹æ³•çš„å†…å®¹ï¼Œè¿™æ˜¯çœŸæ­£çš„å¤šçº¿ç¨‹å·¥ä½œã€‚ ä½†æ˜¯ï¼Œç›´æ¥æ‰§è¡Œ `run()` æ–¹æ³•ï¼Œä¼šæŠŠ `run()` æ–¹æ³•å½“æˆä¸€ä¸ª main çº¿ç¨‹ä¸‹çš„æ™®é€šæ–¹æ³•å»æ‰§è¡Œï¼Œå¹¶ä¸ä¼šåœ¨æŸä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œå®ƒï¼Œç¬¬ä¸€ä¸ªæ‰€è°“çš„çº¿ç¨‹Aåªæ˜¯ main çº¿ç¨‹çš„ä¸€ä¸ªæ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´å…¶æ‰€åœ¨çº¿ç¨‹è¿˜æ˜¯ main çº¿ç¨‹ï¼Œæ‰€ä»¥è¿™å¹¶ä¸æ˜¯å¤šçº¿ç¨‹å·¥ä½œã€‚\n>\n> **æ€»ç»“ï¼š è°ƒç”¨ start() æ–¹æ³•æ–¹å¯å¯åŠ¨çº¿ç¨‹å¹¶ä½¿çº¿ç¨‹è¿›å…¥å°±ç»ªçŠ¶æ€ï¼Œç›´æ¥æ‰§è¡Œ run() æ–¹æ³•çš„è¯ä¸ä¼šä»¥å¤šçº¿ç¨‹çš„æ–¹å¼æ‰§è¡Œã€‚**\n\n### ä¸¤ä¸ªçº¿ç¨‹ï¼Œäº¤æ›¿åŠ å‡\n\n1. synchronized\n\n\t```java\n\t/**\n\t * @author fangyaxing\n\t * @date 2022/9/12\n\t */\n\tpublic class TwoThreadWithSync {\n\t    private static int value = 0;\n\t\n\t    private static final Object lock = new Object();\n\t\n\t    public static void main(String[] args) {\n\t        new Thread(() -> {\n\t            for (int i = 0; i < 5; i++) {\n\t                synchronized (lock) {\n\t                    while (value != 0) {\n\t                        try {\n\t                            lock.wait();\n\t                        } catch (InterruptedException e) {\n\t                            e.printStackTrace();\n\t                        }\n\t                    }\n\t                    value++;\n\t                    System.out.println(Thread.currentThread().getName() + \" ---- \" + value);\n\t                    lock.notifyAll();\n\t                }\n\t            }\n\t        }, \"Thread-A\").start();\n\t\n\t        new Thread(() -> {\n\t            for (int i = 0; i < 5; i++) {\n\t                synchronized (lock) {\n\t                    while (value != 1) {\n\t                        try {\n\t                            lock.wait();\n\t                        } catch (InterruptedException e) {\n\t                            e.printStackTrace();\n\t                        }\n\t                    }\n\t                    value--;\n\t                    System.out.println(Thread.currentThread().getName() + \" ---- \" + value);\n\t                    lock.notifyAll();\n\t                }\n\t            }\n\t        }, \"Thread-B\").start();\n\t    }\n\t\n\t}\n\t```\n\n2. lock + condition\n\n\t```java\n\t/**\n\t * @author fangyaxing\n\t * @date 2022/9/12\n\t */\n\tpublic class TwoThreadWithLock {\n\t    private static int value = 0;\n\t\n\t    private static final Lock lock = new ReentrantLock();\n\t\n\t    static Condition a = lock.newCondition();\n\t\n\t    static Condition b = lock.newCondition();\n\t\n\t    public static void main(String[] args) {\n\t        new Thread(() -> {\n\t            for (int i = 0; i < 5; i++) {\n\t                try {\n\t                    lock.lock();\n\t                    while (value != 0) {\n\t                        a.await();\n\t                    }\n\t                    value++;\n\t                    System.out.println(Thread.currentThread().getName() + \" ---- \" + value);\n\t                    b.signal();\n\t                } catch (InterruptedException e) {\n\t                    e.printStackTrace();\n\t                } finally {\n\t                    lock.unlock();\n\t                }\n\t            }\n\t        }, \"Thread-A\").start();\n\t\n\t        new Thread(() -> {\n\t            for (int i = 0; i < 5; i++) {\n\t                try {\n\t                    lock.lock();\n\t                    while (value != 1) {\n\t                        b.await();\n\t                    }\n\t                    value--;\n\t                    System.out.println(Thread.currentThread().getName() + \" ---- \" + value);\n\t                    a.signal();\n\t                } catch (InterruptedException e) {\n\t                    e.printStackTrace();\n\t                } finally {\n\t                    lock.unlock();\n\t                }\n\t            }\n\t        }, \"Thread-B\").start();\n\t    }\n\t}\n\t```\n\n### ä¸‰ä¸ªçº¿ç¨‹ï¼Œå¾ªç¯æ‰“å°\n\n```java\npublic class Demo5 {\n    private int value = 0;\n    private Lock lock = new ReentrantLock();\n    private Condition a = lock.newCondition();\n    private Condition b = lock.newCondition();\n    private Condition c = lock.newCondition();\n\n    public void outputA(int round) {\n        try {\n            lock.lock();\n            while (value != 0) {\n                a.await();\n            }\n            value = 1;\n            System.out.println(\"ç¬¬\" + round + \"è½®ï¼Œ\" + Thread.currentThread().getName() + \"è¾“å‡ºA\");\n            b.signal();\n        } catch (Exception e) {\n            e.printStackTrace();\n        } finally {\n            lock.unlock();\n        }\n    }\n\n    public void outputB(int round) {\n        try {\n            lock.lock();\n            while (value != 1) {\n                b.await();\n            }\n            value = 2;\n            System.out.println(\"ç¬¬\" + round + \"è½®ï¼Œ\" + Thread.currentThread().getName() + \"è¾“å‡ºB\");\n            c.signal();\n        } catch (Exception e) {\n            e.printStackTrace();\n        } finally {\n            lock.unlock();\n        }\n    }\n\n    public void outputC(int round) {\n        try {\n            lock.lock();\n            while (value != 2) {\n                c.await();\n            }\n            value = 0;\n            System.out.println(\"ç¬¬\" + round + \"è½®ï¼Œ\" + Thread.currentThread().getName() + \"è¾“å‡ºC\");\n            a.signal();\n        } catch (Exception e) {\n            e.printStackTrace();\n        } finally {\n            lock.unlock();\n        }\n    }\n\n    public static void main(String[] args) {\n        Demo5 s = new Demo5();\n\n        new Thread(() -> {\n            for (int i = 0; i < 3; i++) {\n                s.outputA(i);\n            }\n        }, \"Thread-A\").start();\n\n        new Thread(() -> {\n            for (int i = 0; i < 3; i++) {\n                s.outputB(i);\n            }\n        }, \"Thread-B\").start();\n\n        new Thread(() -> {\n            for (int i = 0; i < 3; i++) {\n                s.outputC(i);\n            }\n        }, \"Thread-C\").start();\n\n    }\n}\n```\n","source":"_posts/Javaå…«è‚¡æ–‡ - Javaå¹¶å‘.md","raw":"---\ntitle: Javaå…«è‚¡æ–‡ - Javaå¹¶å‘\ncopyright: true\nmathjax: false\ncategories:\n  - Javaå…«è‚¡æ–‡\ndate: 2023-01-23 15:29:48\ntags:\ntoc: true\nurlname: java-concurrent-programming\n---\n\n> æ•´ç†çš„Javaå¹¶å‘ç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½\t<!--more-->\n\n## åŸºç¡€çŸ¥è¯†\n\n### å¹¶å‘ç¼–ç¨‹çš„ä¼˜ç¼ºç‚¹\n\nä¼˜ç‚¹ï¼šä¸ºäº†èƒ½æé«˜ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡ï¼Œæé«˜ç¨‹åºè¿è¡Œé€Ÿåº¦ï¼›\n\nç¼ºç‚¹ï¼šå­˜åœ¨å†…å­˜æ³„æ¼ã€ä¸Šä¸‹æ–‡åˆ‡æ¢ã€çº¿ç¨‹å®‰å…¨ã€æ­»é”ç­‰é—®é¢˜ã€‚\n\n#### å¹¶å‘ç¼–ç¨‹ä¸‰è¦ç´ æ˜¯ä»€ä¹ˆï¼Ÿåœ¨ Java ç¨‹åºä¸­æ€ä¹ˆä¿è¯å¤šçº¿ç¨‹çš„è¿è¡Œå®‰å…¨ï¼Ÿ\n\nå¹¶å‘ç¼–ç¨‹ä¸‰è¦ç´ ï¼ˆçº¿ç¨‹çš„å®‰å…¨æ€§é—®é¢˜ä½“ç°åœ¨ï¼‰ï¼š\n\n**åŸå­æ€§**ï¼šåŸå­ï¼Œå³ä¸€ä¸ªä¸å¯å†è¢«åˆ†å‰²çš„é¢—ç²’ã€‚åŸå­æ€§æŒ‡çš„æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªæ“ä½œè¦ä¹ˆå…¨éƒ¨æ‰§è¡ŒæˆåŠŸè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œå¤±è´¥ã€‚ï¼ˆsynchronizedï¼ŒLockï¼‰ï¼ˆçº¿ç¨‹åˆ‡æ¢å¼•èµ·çš„åŸå­æ€§é—®é¢˜ï¼‰\n\n**å¯è§æ€§**ï¼šä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡çš„ä¿®æ”¹ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹èƒ½å¤Ÿç«‹åˆ»çœ‹åˆ°ã€‚ï¼ˆsynchronizedï¼ŒLockï¼Œvolatileï¼‰ï¼ˆJMM å†…å­˜æ¨¡å‹å¯¼è‡´çš„å¯è§æ€§é—®é¢˜ï¼‰\n\n**æœ‰åºæ€§**ï¼šç¨‹åºæ‰§è¡Œçš„é¡ºåºæŒ‰ç…§ä»£ç çš„å…ˆåé¡ºåºæ‰§è¡Œã€‚ï¼ˆsynchronizedï¼ŒLockï¼Œvolatileï¼‰ï¼ˆæŒ‡ä»¤é‡æ’åºå¸¦æ¥çš„æœ‰åºæ€§é—®é¢˜ï¼‰\n\n> volatileä¸èƒ½ä¿è¯å¹¶å‘å®‰å…¨ï¼Œæ¯”å¦‚å¤šçº¿ç¨‹å¯¹ä¸€ä¸ªvolatileçš„intå˜é‡è¿›è¡ŒåŠ 1æ“ä½œï¼Œæœ€ç»ˆå¾—åˆ°çš„æ•°å­—å¯èƒ½æ¯”é¢„æœŸå°ï¼Œå°±æ˜¯å› ä¸º++æ“ä½œä¸æ˜¯åŸå­æ€§çš„ï¼Œè€Œvolatileä¹Ÿä¸èƒ½ä¿è¯åŸå­æ€§ï¼Œæ‰€ä»¥å°±ä¼šæœ‰è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨`atomicInteger.getAndSet()`åŸå­æ“ä½œã€‚\n\n### çº¿ç¨‹å’Œè¿›ç¨‹\n\n#### è¿›ç¨‹é—´çš„é€šä¿¡æ–¹å¼\n\n1. **ç®¡é“/åŒ¿åç®¡é“(Pipes)** ï¼šç”¨äºå…·æœ‰äº²ç¼˜å…³ç³»çš„çˆ¶å­è¿›ç¨‹é—´æˆ–è€…å…„å¼Ÿè¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼›\n2. **æœ‰åç®¡é“(Names Pipes)**ï¼šåŒ¿åç®¡é“ç”±äºæ²¡æœ‰åå­—ï¼Œåªèƒ½ç”¨äºäº²ç¼˜å…³ç³»çš„è¿›ç¨‹é—´é€šä¿¡ã€‚ä¸ºäº†å…‹æœè¿™ä¸ªç¼ºç‚¹ï¼Œæå‡ºäº†æœ‰åç®¡é“ã€‚æœ‰åç®¡é“ä¸¥æ ¼éµå¾ª**å…ˆè¿›å…ˆå‡º(first in first out)**ã€‚æœ‰åç®¡é“ä»¥ç£ç›˜æ–‡ä»¶çš„æ–¹å¼å­˜åœ¨ï¼Œå¯ä»¥å®ç°æœ¬æœºä»»æ„ä¸¤ä¸ªè¿›ç¨‹é€šä¿¡ï¼›\n3. **ä¿¡å·(Signal)** ï¼šä¿¡å·æ˜¯ä¸€ç§æ¯”è¾ƒå¤æ‚çš„é€šä¿¡æ–¹å¼ï¼Œç”¨äºé€šçŸ¥æ¥æ”¶è¿›ç¨‹æŸä¸ªäº‹ä»¶å·²ç»å‘ç”Ÿï¼›\n4. **æ¶ˆæ¯é˜Ÿåˆ—(Message Queuing)** ï¼šæ¶ˆæ¯é˜Ÿåˆ—æ˜¯æ¶ˆæ¯çš„é“¾è¡¨ï¼Œå…·æœ‰ç‰¹å®šçš„æ ¼å¼ï¼Œå­˜æ”¾åœ¨å†…å­˜ä¸­å¹¶ç”±æ¶ˆæ¯é˜Ÿåˆ—æ ‡è¯†ç¬¦æ ‡è¯†ã€‚**æ¶ˆæ¯é˜Ÿåˆ—å…‹æœäº†ä¿¡å·æ‰¿è½½ä¿¡æ¯é‡å°‘ï¼Œç®¡é“åªèƒ½æ‰¿è½½æ— æ ¼å¼å­—èŠ‚æµä»¥åŠç¼“å†²åŒºå¤§å°å—é™ç­‰ç¼ºç‚¹**ï¼›\n5. **ä¿¡å·é‡(Semaphores)** ï¼šä¿¡å·é‡æ˜¯ä¸€ä¸ªè®¡æ•°å™¨ï¼Œç”¨äºå¤šè¿›ç¨‹å¯¹å…±äº«æ•°æ®çš„è®¿é—®ï¼Œä¿¡å·é‡çš„æ„å›¾åœ¨äºè¿›ç¨‹é—´åŒæ­¥ã€‚è¿™ç§é€šä¿¡æ–¹å¼ä¸»è¦ç”¨äºè§£å†³ä¸åŒæ­¥ç›¸å…³çš„é—®é¢˜å¹¶é¿å…ç«äº‰æ¡ä»¶ï¼›\n6. **å…±äº«å†…å­˜(Shared memory)** ï¼šä½¿å¾—å¤šä¸ªè¿›ç¨‹å¯ä»¥è®¿é—®åŒä¸€å—å†…å­˜ç©ºé—´ï¼Œä¸åŒè¿›ç¨‹å¯ä»¥åŠæ—¶çœ‹åˆ°å¯¹æ–¹è¿›ç¨‹ä¸­å¯¹å…±äº«å†…å­˜ä¸­æ•°æ®çš„æ›´æ–°ã€‚è¿™ç§æ–¹å¼éœ€è¦ä¾é æŸç§åŒæ­¥æ“ä½œï¼Œå¦‚äº’æ–¥é”å’Œä¿¡å·é‡ç­‰ã€‚å¯ä»¥è¯´è¿™æ˜¯æœ€æœ‰ç”¨çš„è¿›ç¨‹é—´é€šä¿¡æ–¹å¼ï¼›\n7. **å¥—æ¥å­—(Sockets)**ï¼šæ­¤æ–¹æ³•ä¸»è¦ç”¨äºåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´é€šè¿‡ç½‘ç»œè¿›è¡Œé€šä¿¡ã€‚å¥—æ¥å­—æ˜¯æ”¯æŒ TCP/IP çš„ç½‘ç»œé€šä¿¡çš„åŸºæœ¬æ“ä½œå•å…ƒï¼Œå¯ä»¥çœ‹åšæ˜¯ä¸åŒä¸»æœºä¹‹é—´çš„è¿›ç¨‹è¿›è¡ŒåŒå‘é€šä¿¡çš„ç«¯ç‚¹ï¼Œç®€å•çš„è¯´å°±æ˜¯é€šä¿¡çš„ä¸¤æ–¹çš„ä¸€ç§çº¦å®šï¼Œç”¨å¥—æ¥å­—ä¸­çš„ç›¸å…³å‡½æ•°æ¥å®Œæˆé€šä¿¡è¿‡ç¨‹ã€‚\n\n#### çº¿ç¨‹é—´çš„åŒæ­¥æ–¹å¼\n\nçº¿ç¨‹åŒæ­¥æ˜¯ä¸¤ä¸ªæˆ–å¤šä¸ªå…±äº«å…³é”®èµ„æºçš„çº¿ç¨‹çš„å¹¶å‘æ‰§è¡Œã€‚åº”è¯¥åŒæ­¥çº¿ç¨‹ä»¥é¿å…å…³é”®çš„èµ„æºä½¿ç”¨å†²çªã€‚\n\n1. **äº’æ–¥é‡(Mutex)**ï¼šé‡‡ç”¨äº’æ–¥å¯¹è±¡æœºåˆ¶ï¼Œåªæœ‰æ‹¥æœ‰äº’æ–¥å¯¹è±¡çš„çº¿ç¨‹æ‰æœ‰è®¿é—®å…¬å…±èµ„æºçš„æƒé™ã€‚å› ä¸ºäº’æ–¥å¯¹è±¡åªæœ‰ä¸€ä¸ªï¼Œæ‰€ä»¥å¯ä»¥ä¿è¯å…¬å…±èµ„æºä¸ä¼šè¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®ï¼Œæ¯”å¦‚ Java ä¸­çš„ synchronized å…³é”®è¯å’Œå„ç§ Lock éƒ½æ˜¯è¿™ç§æœºåˆ¶ï¼›\n2. **ä¿¡å·é‡(Semphares)** ï¼šå®ƒå…è®¸åŒä¸€æ—¶åˆ»å¤šä¸ªçº¿ç¨‹è®¿é—®åŒä¸€èµ„æºï¼Œä½†æ˜¯éœ€è¦æ§åˆ¶åŒä¸€æ—¶åˆ»è®¿é—®æ­¤èµ„æºçš„æœ€å¤§çº¿ç¨‹æ•°é‡ï¼›\n3. **äº‹ä»¶(Event)** ï¼šwait/notifyï¼šé€šè¿‡é€šçŸ¥æ“ä½œçš„æ–¹å¼æ¥ä¿æŒå¤šçº¿ç¨‹åŒæ­¥ï¼Œè¿˜å¯ä»¥æ–¹ä¾¿çš„å®ç°å¤šçº¿ç¨‹ä¼˜å…ˆçº§çš„æ¯”è¾ƒæ“ä½œã€‚\n\n#### ä»€ä¹ˆæ˜¯çº¿ç¨‹å’Œè¿›ç¨‹?\n\n**è¿›ç¨‹**ï¼šè¿›ç¨‹æ˜¯åº”ç”¨ç¨‹åºçš„ä¸€æ¬¡è¿è¡Œï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„å†…å­˜ç©ºé—´ï¼Œæ˜¯æ“ä½œç³»ç»Ÿèµ„æºåˆ†é…çš„åŸºæœ¬å•ä½ï¼›\n\n**çº¿ç¨‹**ï¼šçº¿ç¨‹æ˜¯å¤„ç†å™¨è°ƒåº¦å’Œæ‰§è¡Œçš„åŸºæœ¬å•ä½ï¼Œä¸€ä¸ªè¿›ç¨‹ä¸­å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹ï¼Œçº¿ç¨‹å…±äº«è¿›ç¨‹çš„å†…å­˜ç©ºé—´å’Œèµ„æºã€‚\n\n#### ä»€ä¹ˆæ˜¯ä¸Šä¸‹æ–‡åˆ‡æ¢?\n\nå¤šçº¿ç¨‹ç¼–ç¨‹ä¸­ä¸€èˆ¬çº¿ç¨‹çš„ä¸ªæ•°éƒ½å¤§äº CPU æ ¸å¿ƒçš„ä¸ªæ•°ï¼Œè€Œä¸€ä¸ª CPU æ ¸å¿ƒåœ¨ä»»æ„æ—¶åˆ»åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨ï¼Œä¸ºäº†è®©è¿™äº›çº¿ç¨‹éƒ½èƒ½å¾—åˆ°æœ‰æ•ˆæ‰§è¡Œï¼ŒCPU é‡‡å–çš„ç­–ç•¥æ˜¯ä¸ºæ¯ä¸ªçº¿ç¨‹åˆ†é…æ—¶é—´ç‰‡å¹¶è½®è½¬çš„å½¢å¼ã€‚\n\nå½“å‰ä»»åŠ¡åœ¨æ‰§è¡Œå®Œ CPU æ—¶é—´ç‰‡åˆ‡æ¢åˆ°å¦ä¸€ä¸ªä»»åŠ¡ä¹‹å‰ä¼šå…ˆä¿å­˜è‡ªå·±çš„çŠ¶æ€ï¼Œä»¥ä¾¿ä¸‹æ¬¡å†åˆ‡æ¢å›è¿™ä¸ªä»»åŠ¡æ—¶ï¼Œå¯ä»¥å†åŠ è½½è¿™ä¸ªä»»åŠ¡çš„çŠ¶æ€ã€‚**ä»»åŠ¡ä»ä¿å­˜åˆ°å†åŠ è½½çš„è¿‡ç¨‹å°±æ˜¯ä¸€æ¬¡ä¸Šä¸‹æ–‡åˆ‡æ¢**ã€‚\n\nä¸Šä¸‹æ–‡åˆ‡æ¢å¯¹ç³»ç»Ÿæ¥è¯´æ„å‘³ç€æ¶ˆè€—å¤§é‡çš„ CPU æ—¶é—´ï¼Œäº‹å®ä¸Šï¼Œå¯èƒ½æ˜¯æ“ä½œç³»ç»Ÿä¸­æ—¶é—´æ¶ˆè€—æœ€å¤§çš„æ“ä½œã€‚\n\n#### å®ˆæŠ¤çº¿ç¨‹å’Œç”¨æˆ·çº¿ç¨‹æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ\n\n- **ç”¨æˆ· (User) çº¿ç¨‹**ï¼šè¿è¡Œåœ¨å‰å°ï¼Œæ‰§è¡Œå…·ä½“çš„ä»»åŠ¡\n- **å®ˆæŠ¤ (Daemon) çº¿ç¨‹**ï¼šè¿è¡Œåœ¨åå°ï¼Œä¸ºå…¶ä»–å‰å°çº¿ç¨‹æœåŠ¡ã€‚ä¸€æ—¦æ‰€æœ‰ç”¨æˆ·çº¿ç¨‹éƒ½ç»“æŸè¿è¡Œï¼Œå®ˆæŠ¤çº¿ç¨‹ä¼šéš JVM ä¸€èµ·ç»“æŸå·¥ä½œ\n\n**æ³¨æ„äº‹é¡¹ï¼š**\n\n1. `setDaemon(true)`å¿…é¡»åœ¨`start()`æ–¹æ³•å‰æ‰§è¡Œï¼Œå¦åˆ™ä¼šæŠ›å‡º `IllegalThreadStateException` å¼‚å¸¸ï¼›\n2. åœ¨å®ˆæŠ¤çº¿ç¨‹ä¸­äº§ç”Ÿçš„æ–°çº¿ç¨‹ä¹Ÿæ˜¯å®ˆæŠ¤çº¿ç¨‹ï¼›\n3. ä¸æ˜¯æ‰€æœ‰çš„ä»»åŠ¡éƒ½å¯ä»¥åˆ†é…ç»™å®ˆæŠ¤çº¿ç¨‹æ¥æ‰§è¡Œï¼Œæ¯”å¦‚è¯»å†™æ“ä½œæˆ–è€…è®¡ç®—é€»è¾‘ï¼›\n4. å®ˆæŠ¤ (Daemon) çº¿ç¨‹ä¸­ä¸èƒ½ä¾é  finally å—çš„å†…å®¹æ¥ç¡®ä¿æ‰§è¡Œå…³é—­æˆ–æ¸…ç†èµ„æºçš„é€»è¾‘ã€‚å› ä¸ºæˆ‘ä»¬ä¸Šé¢ä¹Ÿè¯´è¿‡äº†ä¸€æ—¦æ‰€æœ‰ç”¨æˆ·çº¿ç¨‹éƒ½ç»“æŸè¿è¡Œï¼Œå®ˆæŠ¤çº¿ç¨‹ä¼šéš JVM ä¸€èµ·ç»“æŸå·¥ä½œï¼Œæ‰€ä»¥å®ˆæŠ¤ (Daemon) çº¿ç¨‹ä¸­çš„ finally è¯­å¥å—å¯èƒ½æ— æ³•è¢«æ‰§è¡Œã€‚\n\n#### å¦‚ä½•åœ¨ Windows å’Œ Linux ä¸ŠæŸ¥æ‰¾å“ªä¸ªçº¿ç¨‹cpuåˆ©ç”¨ç‡æœ€é«˜ï¼Ÿ\n\nWindows ä¸‹ç”¨ä»»åŠ¡ç®¡ç†å™¨çœ‹ï¼ŒLinux ä¸‹å¯ä»¥ç”¨ top è¿™ä¸ªå‘½ä»¤çœ‹ã€‚\n\n#### ä»€ä¹ˆæ˜¯çº¿ç¨‹æ­»é”\n\næ­»é”æ˜¯æŒ‡ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„çº¿ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œç”±äºç«äº‰èµ„æºé€ æˆçš„ä¸€ç§é˜»å¡çš„ç°è±¡ï¼Œè‹¥æ— å¤–åŠ›ä½œç”¨ï¼Œå®ƒä»¬éƒ½å°†æ— æ³•æ¨è¿›ä¸‹å»ã€‚\n\nå¦‚å›¾æ‰€ç¤ºï¼Œçº¿ç¨‹ A æŒæœ‰èµ„æº 2ï¼Œçº¿ç¨‹ B æŒæœ‰èµ„æº 1ï¼Œä»–ä»¬åŒæ—¶éƒ½æƒ³ç”³è¯·å¯¹æ–¹çš„èµ„æºï¼Œè¿™ä¸¤ä¸ªçº¿ç¨‹å°±ä¼šäº’ç›¸ç­‰å¾…è€Œè¿›å…¥æ­»é”çŠ¶æ€ã€‚\n\n![çº¿ç¨‹æ­»é”](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/202206152131355.png)\n\nä¸‹é¢é€šè¿‡ä»£ç æ¨¡æ‹Ÿäº†ä¸Šå›¾çš„æ­»é”çš„æƒ…å†µï¼ˆä»£ç æ¥æºäºã€Šå¹¶å‘ç¼–ç¨‹ä¹‹ç¾ã€‹ï¼‰ï¼š\n\n```java\npublic class DeadLockDemo {\n    private static Object resource1 = new Object();\t//èµ„æº 1\n    private static Object resource2 = new Object();\t//èµ„æº 2\n\n    public static void main(String[] args) {\n        new Thread(() -> {\n            synchronized (resource1) {\n                System.out.println(Thread.currentThread() + \"get resource1\");\n                try {\n                    Thread.sleep(1000);\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n                System.out.println(Thread.currentThread() + \"waiting get resource2\");\n                synchronized (resource2) {\n                    System.out.println(Thread.currentThread() + \"get resource2\");\n                }\n            }\n        }, \"çº¿ç¨‹ 1\").start();\n\n        new Thread(() -> {\n            synchronized (resource2) {\n                System.out.println(Thread.currentThread() + \"get resource2\");\n                try {\n                    Thread.sleep(1000);\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n                System.out.println(Thread.currentThread() + \"waiting get resource1\");\n                synchronized (resource1) {\n                    System.out.println(Thread.currentThread() + \"get resource1\");\n                }\n            }\n        }, \"çº¿ç¨‹ 2\").start();\n    }\n}\n```\n\nè¾“å‡ºç»“æœ\n\n```java\nThread[çº¿ç¨‹ 1,5,main]get resource1\nThread[çº¿ç¨‹ 2,5,main]get resource2\nThread[çº¿ç¨‹ 1,5,main]waiting get resource2\nThread[çº¿ç¨‹ 2,5,main]waiting get resource1\n```\n\nçº¿ç¨‹ A é€šè¿‡ synchronized (resource1) è·å¾— resource1 çš„ç›‘è§†å™¨é”ï¼Œç„¶åé€šè¿‡`Thread.sleep(1000)`ï¼›è®©çº¿ç¨‹ A ä¼‘çœ  1s ä¸ºçš„æ˜¯è®©çº¿ç¨‹ B å¾—åˆ° CPU æ‰§è¡Œæƒï¼Œç„¶åè·å–åˆ° resource2 çš„ç›‘è§†å™¨é”ã€‚çº¿ç¨‹ A å’Œçº¿ç¨‹ B ä¼‘çœ ç»“æŸäº†éƒ½å¼€å§‹ä¼å›¾è¯·æ±‚è·å–å¯¹æ–¹çš„èµ„æºï¼Œç„¶åè¿™ä¸¤ä¸ªçº¿ç¨‹å°±ä¼šé™·å…¥äº’ç›¸ç­‰å¾…çš„çŠ¶æ€ï¼Œè¿™ä¹Ÿå°±äº§ç”Ÿäº†æ­»é”ã€‚ä¸Šé¢çš„ä¾‹å­ç¬¦åˆäº§ç”Ÿæ­»é”çš„å››ä¸ªå¿…è¦æ¡ä»¶ã€‚\n\n#### å½¢æˆæ­»é”çš„å››ä¸ªå¿…è¦æ¡ä»¶æ˜¯ä»€ä¹ˆ\n\n1. äº’æ–¥æ¡ä»¶ï¼šä¸€ä¸ªèµ„æºåªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹å ç”¨ï¼Œç›´åˆ°è¢«è¯¥çº¿ç¨‹é‡Šæ”¾ï¼›\n2. è¯·æ±‚ä¸ä¿æŒæ¡ä»¶ï¼šä¸€ä¸ªçº¿ç¨‹å› è¯·æ±‚è¢«å ç”¨èµ„æºè€Œå‘ç”Ÿé˜»å¡æ—¶ï¼Œå¯¹å·²è·å¾—çš„èµ„æºä¿æŒä¸æ”¾ï¼›\n3. ä¸å‰¥å¤ºæ¡ä»¶ï¼šçº¿ç¨‹å·²è·å¾—çš„èµ„æºåœ¨æœ«ä½¿ç”¨å®Œä¹‹å‰ä¸èƒ½è¢«å…¶ä»–çº¿ç¨‹å¼ºè¡Œå‰¥å¤ºï¼Œåªæœ‰è‡ªå·±ä½¿ç”¨å®Œæ¯•åæ‰é‡Šæ”¾èµ„æºï¼›\n4. å¾ªç¯ç­‰å¾…æ¡ä»¶ï¼šå½“å‘ç”Ÿæ­»é”æ—¶ï¼Œæ‰€ç­‰å¾…çš„çº¿ç¨‹å¿…å®šä¼šå½¢æˆä¸€ä¸ªç¯è·¯ï¼ˆç±»ä¼¼äºæ­»å¾ªç¯ï¼‰ï¼Œé€ æˆæ°¸ä¹…é˜»å¡ã€‚\n\n#### å¦‚ä½•é¿å…çº¿ç¨‹æ­»é”\n\næˆ‘ä»¬åªè¦ç ´åäº§ç”Ÿæ­»é”çš„å››ä¸ªæ¡ä»¶ä¸­çš„å…¶ä¸­ä¸€ä¸ªå°±å¯ä»¥äº†ã€‚\n\n**ç ´åäº’æ–¥æ¡ä»¶**ï¼šæ— æ³•ç ´åï¼Œå› ä¸ºæˆ‘ä»¬ç”¨é”æœ¬æ¥å°±æ˜¯æƒ³å®ç°äº’æ–¥è®¿é—®ä¸´ç•Œèµ„æºï¼›\n\n**ç ´åè¯·æ±‚ä¸ä¿æŒæ¡ä»¶**ï¼šä¸€æ¬¡æ€§ç”³è¯·æ‰€æœ‰çš„èµ„æºï¼›\n\n**ç ´åä¸å‰¥å¤ºæ¡ä»¶**ï¼šå ç”¨éƒ¨åˆ†èµ„æºçš„çº¿ç¨‹è¿›ä¸€æ­¥ç”³è¯·å…¶ä»–èµ„æºæ—¶ï¼Œ**å¦‚æœç”³è¯·ä¸åˆ°ï¼Œå¯ä»¥ä¸»åŠ¨é‡Šæ”¾å®ƒå æœ‰çš„èµ„æº**ï¼›\n\n**ç ´åå¾ªç¯ç­‰å¾…æ¡ä»¶**ï¼šé **æŒ‰åºç”³è¯·**èµ„æºæ¥é¢„é˜²ã€‚æŒ‰æŸä¸€é¡ºåºç”³è¯·èµ„æºï¼Œé‡Šæ”¾èµ„æºåˆ™ååºé‡Šæ”¾ã€‚ç ´åå¾ªç¯ç­‰å¾…æ¡ä»¶ã€‚\n\næˆ‘ä»¬å¯¹çº¿ç¨‹ 2 çš„ä»£ç ä¿®æ”¹æˆä¸‹é¢è¿™æ ·å°±ä¸ä¼šäº§ç”Ÿæ­»é”äº†ã€‚\n\n```java\nnew Thread(() -> {\n    synchronized (resource1) {\n        System.out.println(Thread.currentThread() + \"get resource1\");\n        try {\n            Thread.sleep(1000);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        System.out.println(Thread.currentThread() + \"waiting get resource2\");\n        synchronized (resource2) {\n            System.out.println(Thread.currentThread() + \"get resource2\");\n        }\n    }\n}, \"çº¿ç¨‹ 2\").start();\n```\n\nè¾“å‡ºç»“æœ\n\n```java\nThread[çº¿ç¨‹ 1,5,main]get resource1\nThread[çº¿ç¨‹ 1,5,main]waiting get resource2\nThread[çº¿ç¨‹ 1,5,main]get resource2\nThread[çº¿ç¨‹ 2,5,main]get resource1\nThread[çº¿ç¨‹ 2,5,main]waiting get resource2\nThread[çº¿ç¨‹ 2,5,main]get resource2\n```\n\næˆ‘ä»¬åˆ†æä¸€ä¸‹ä¸Šé¢çš„ä»£ç ä¸ºä»€ä¹ˆé¿å…äº†æ­»é”çš„å‘ç”Ÿ?\n\nçº¿ç¨‹ 1 é¦–å…ˆè·å¾—åˆ° resource1 çš„ç›‘è§†å™¨é”ï¼Œè¿™æ—¶å€™çº¿ç¨‹ 2 å°±è·å–ä¸åˆ°äº†ã€‚ç„¶åçº¿ç¨‹ 1 å†å»è·å– resource2 çš„ç›‘è§†å™¨é”ï¼Œå¯ä»¥è·å–åˆ°ã€‚ç„¶åçº¿ç¨‹ 1 é‡Šæ”¾äº†å¯¹ resource1ã€resource2 çš„ç›‘è§†å™¨é”çš„å ç”¨ï¼Œçº¿ç¨‹ 2 è·å–åˆ°å°±å¯ä»¥æ‰§è¡Œäº†ã€‚è¿™æ ·å°±ç ´åäº†ç ´åå¾ªç¯ç­‰å¾…æ¡ä»¶ï¼Œå› æ­¤é¿å…äº†æ­»é”ã€‚\n\n#### åˆ›å»ºçº¿ç¨‹æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ\n\nåˆ›å»ºçº¿ç¨‹æœ‰å››ç§æ–¹å¼ï¼š\n\n- ç»§æ‰¿ Thread ç±»\n- å®ç° Runnable æ¥å£\n- å®ç° Callable æ¥å£\n- ä½¿ç”¨ Executors å·¥å…·ç±»åˆ›å»ºçº¿ç¨‹æ± \n\n**ç»§æ‰¿ Thread ç±»**\n\n1. å®šä¹‰ä¸€ä¸ª Thread ç±»çš„å­ç±»ï¼Œé‡å†™ run æ–¹æ³•ï¼›\n2. åˆ›å»ºè‡ªå®šä¹‰çš„çº¿ç¨‹å­ç±»å¯¹è±¡ï¼›\n3. è°ƒç”¨å­ç±»å®ä¾‹çš„ start() æ–¹æ³•æ¥å¯åŠ¨çº¿ç¨‹ã€‚\n\n```java\npublic class Main {\n    static class MyThread extends Thread {\n        @Override\n        public void run() {\n            System.out.println(Thread.currentThread().getName() + \" run()æ–¹æ³•æ­£åœ¨æ‰§è¡Œ...\");\n        }\n    }\n    public static void main(String[] args) {\n        new MyThread().start();\n        try {\n            Thread.sleep(10);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        System.out.println(Thread.currentThread().getName() + \" main()æ–¹æ³•æ‰§è¡Œç»“æŸ\");\n    }\n}\n```\n\n**å®ç° Runnable æ¥å£**\n\n1. å®šä¹‰ Runnable æ¥å£å®ç°ç±» MyRunnableï¼Œå¹¶é‡å†™ run() æ–¹æ³•ï¼›\n2. åˆ›å»º MyRunnable å®ä¾‹ myRunnableï¼Œä»¥ myRunnable ä½œä¸º target åˆ›å»º Thread å®ä¾‹ï¼Œ**è¯¥Threadå¯¹è±¡æ‰æ˜¯çœŸæ­£çš„çº¿ç¨‹å¯¹è±¡**ï¼›\n3. è°ƒç”¨çº¿ç¨‹å®ä¾‹çš„ start() æ–¹æ³•ã€‚\n\n```java\npublic class Main {\n    static class MyRunnable implements Runnable {\n\n        @Override\n        public void run() {\n            System.out.println(Thread.currentThread().getName() + \" run()æ–¹æ³•æ­£åœ¨æ‰§è¡Œ...\");\n        }\n\n    }\n    public static void main(String[] args) {\n        new Thread(new MyRunnable()).start();\n        try {\n            Thread.sleep(10);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        System.out.println(Thread.currentThread().getName() + \" main()æ–¹æ³•æ‰§è¡Œç»“æŸ\");\n    }\n}\n```\n\n**å®ç° Callable æ¥å£**\n\n1. åˆ›å»ºå®ç° Callable æ¥å£çš„ç±» myCallableï¼›\n2. ä»¥ myCallable ä¸ºå‚æ•°åˆ›å»º FutureTask å¯¹è±¡ï¼›\n3. å°† FutureTask ä½œä¸ºå‚æ•°åˆ›å»º Thread å¯¹è±¡ï¼›\n4. è°ƒç”¨çº¿ç¨‹å¯¹è±¡çš„ start() æ–¹æ³•ã€‚\n\n```java\npublic class Main {\n    static class MyCallable implements Callable<Integer> {\n        @Override\n        public Integer call() throws Exception {\n            System.out.println(Thread.currentThread().getName() + \" call()æ–¹æ³•æ‰§è¡Œä¸­...\");\n            return 1;\n        }\n    }\n\n    public static void main(String[] args) {\n        FutureTask<Integer> futureTask = new FutureTask<>(new MyCallable());\n        new Thread(futureTask).start();\n        try {\n            Thread.sleep(10);\n            System.out.println(futureTask.get());\n        } catch (InterruptedException | ExecutionException e) {\n            e.printStackTrace();\n        }\n        System.out.println(Thread.currentThread().getName() + \" main()æ–¹æ³•æ‰§è¡Œå®Œæˆ\");\n    }\n}\n```\n\n**ä½¿ç”¨ Executors å·¥å…·ç±»åˆ›å»ºçº¿ç¨‹æ± **\n\nExecutors æä¾›äº†ä¸€ç³»åˆ—å·¥å‚æ–¹æ³•ç”¨äºåˆ›å»ºçº¿ç¨‹æ± ï¼Œè¿”å›çš„çº¿ç¨‹æ± éƒ½å®ç°äº† ExecutorService æ¥å£ã€‚\n\nä¸»è¦æœ‰ new[Single/Fixed/Cached/Scheduled]ThreadPool è¿™å››ç§çº¿ç¨‹æ± \n\n```java\npublic class MyRunnable implements Runnable {\n    @Override\n    public void run() {\n        System.out.println(Thread.currentThread().getName() + \" run()æ–¹æ³•æ‰§è¡Œä¸­...\");\n    }\n}\n\npublic class SingleThreadExecutorTest {n\n    public static void main(String[] args) {\n        ExecutorService executorService = Executors.newSingleThreadExecutor();\n        MyRunnable myRunnable = new MyRunnable();\n        for (int i = 0; i < 5; i++) {\n            executorService.execute(myRunnable);\n        }\n\n        System.out.println(\"çº¿ç¨‹ä»»åŠ¡å¼€å§‹æ‰§è¡Œ\");\n        executorService.shutdown();\n    }\n}\n```\n\n#### è¯´ä¸€ä¸‹ runnable å’Œ callable æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\nç›¸åŒç‚¹\n\n- éƒ½æ˜¯æ¥å£\n- éƒ½å¯ä»¥ç”¨æ¥å®ç°å¤šçº¿ç¨‹\n- éƒ½åˆ›å»º Thread å®ä¾‹å¹¶è°ƒç”¨å…¶ start() æ–¹æ³•å¯åŠ¨çº¿ç¨‹\n\nä¸»è¦åŒºåˆ«\n\n- Runnable æ¥å£ run æ–¹æ³•æ— è¿”å›å€¼ï¼›Callable æ¥å£ call æ–¹æ³•æœ‰è¿”å›å€¼ï¼Œå’Œ FutureTask é…åˆå¯ä»¥ç”¨æ¥è·å–å¼‚æ­¥æ‰§è¡Œçš„ç»“æœ\n- Runnable æ¥å£ run æ–¹æ³•æ— æ³•æ•è·å¹¶å¤„ç†å¼‚å¸¸ï¼›Callable æ¥å£ call æ–¹æ³•å¯ä»¥æ•è·å¹¶å¤„ç†å¼‚å¸¸\n\n#### çº¿ç¨‹çš„ run()å’Œ start()æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\n> start() æ–¹æ³•æ¥å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ï¼ŒçœŸæ­£å®ç°äº†å¤šçº¿ç¨‹è¿è¡Œã€‚è°ƒç”¨ start() æ–¹æ³•æ— éœ€ç­‰å¾…runæ–¹æ³•ä½“ä»£ç æ‰§è¡Œå®Œæ¯•ï¼Œå¯ä»¥ç›´æ¥ç»§ç»­æ‰§è¡Œå…¶ä»–çš„ä»£ç ï¼› æ­¤æ—¶çº¿ç¨‹æ˜¯å¤„äºå°±ç»ªçŠ¶æ€ï¼Œå¹¶æ²¡æœ‰è¿è¡Œã€‚ ç„¶åé€šè¿‡æ­¤ Thread ç±»è°ƒç”¨æ–¹æ³• run() æ¥å®Œæˆå…¶è¿è¡ŒçŠ¶æ€ï¼Œ run() æ–¹æ³•è¿è¡Œç»“æŸï¼Œ æ­¤çº¿ç¨‹ç»ˆæ­¢ã€‚ç„¶å CPU å†è°ƒåº¦å…¶å®ƒçº¿ç¨‹ã€‚\n\nstart() æ–¹æ³•ç”¨äºå¯åŠ¨çº¿ç¨‹ï¼Œrun() æ–¹æ³•ç”¨äºæ‰§è¡Œçº¿ç¨‹çš„è¿è¡Œæ—¶ä»£ç ï¼Œç›´æ¥è°ƒç”¨ run()ï¼Œå…¶å®å°±ç›¸å½“äºæ˜¯è°ƒç”¨äº†ä¸€ä¸ªæ™®é€šå‡½æ•°è€Œå·²ã€‚\nstart() åªèƒ½è°ƒç”¨ä¸€æ¬¡ï¼Œrun() å¯ä»¥é‡å¤è°ƒç”¨ã€‚\n\n#### ä»€ä¹ˆæ˜¯ Callable å’Œ Future?\n\n```java\nFutureTask<Integer> futureTask = new FutureTask<>(new MyCallable());\nnew Thread(futureTask).start();\n```\n\nå°† callable å®ä¾‹ä¼ å…¥ futureï¼Œç„¶åå°† future å®ä¾‹ä¼ å…¥ Thread åˆ›å»ºçº¿ç¨‹ï¼Œ\nä¹‹åå¯ä»¥ç”¨ future æ¥è·å– callable  ä¸­ call() çš„è¿”å›ç»“æœã€‚\n\n#### çº¿ç¨‹çš„çŠ¶æ€å’ŒåŸºæœ¬æ“ä½œ\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650518197279.png\" alt=\"çº¿ç¨‹çš„çŠ¶æ€\" style=\"zoom:67%;\" />\n\n#### Java ä¸­ç”¨åˆ°çš„çº¿ç¨‹è°ƒåº¦ç®—æ³•æ˜¯ä»€ä¹ˆï¼Ÿ\n\nçº¿ç¨‹è°ƒåº¦æ˜¯æŒ‡æŒ‰ç…§ç‰¹å®šæœºåˆ¶ä¸ºå¤šä¸ªçº¿ç¨‹åˆ†é… CPU çš„ä½¿ç”¨æƒã€‚\n\næœ‰ä¸¤ç§è°ƒåº¦æ¨¡å‹ï¼š**æ—¶é—´ç‰‡è½®è½¬**æ¨¡å‹å’Œ**ä¼˜å…ˆçº§è°ƒåº¦**æ¨¡å‹ã€‚\n\n**Java è™šæ‹Ÿæœºé‡‡ç”¨ä¼˜å…ˆçº§è°ƒåº¦æ¨¡å‹**ï¼Œæ˜¯æŒ‡ä¼˜å…ˆè®©å¯è¿è¡Œæ± ä¸­ä¼˜å…ˆçº§é«˜çš„çº¿ç¨‹å ç”¨ CPUï¼Œå¦‚æœå¯è¿è¡Œæ± ä¸­çš„çº¿ç¨‹ä¼˜å…ˆçº§ç›¸åŒï¼Œé‚£ä¹ˆå°±éšæœºé€‰æ‹©ä¸€ä¸ªçº¿ç¨‹ï¼Œä½¿å…¶å ç”¨ CPUã€‚å¤„äºè¿è¡ŒçŠ¶æ€çš„çº¿ç¨‹ä¼šä¸€ç›´è¿è¡Œï¼Œç›´è‡³å®ƒä¸å¾—ä¸æ”¾å¼ƒ CPUã€‚\n\n#### è¯·è¯´å‡ºä¸çº¿ç¨‹åŒæ­¥ä»¥åŠçº¿ç¨‹è°ƒåº¦ç›¸å…³çš„æ–¹æ³•ã€‚\n\nï¼ˆ1ï¼‰wait()ï¼šä½¿ä¸€ä¸ªçº¿ç¨‹å¤„äºç­‰å¾…çŠ¶æ€ï¼Œå¹¶ä¸”é‡Šæ”¾æ‰€æŒæœ‰çš„å¯¹è±¡çš„é”ï¼›\n\nï¼ˆ2ï¼‰sleep()ï¼šä½¿ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„çº¿ç¨‹å¤„äºç¡çœ çŠ¶æ€ï¼Œæ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼›\n\nï¼ˆ3ï¼‰notify()ï¼šå”¤é†’ä¸€ä¸ªå¤„äºç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ï¼Œå½“ç„¶åœ¨è°ƒç”¨æ­¤æ–¹æ³•çš„æ—¶å€™ï¼Œå¹¶ä¸èƒ½ç¡®åˆ‡çš„å”¤é†’æŸä¸€ä¸ªç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ï¼Œè€Œæ˜¯ç”± JVM ç¡®å®šå”¤é†’å“ªä¸ªçº¿ç¨‹ï¼Œè€Œä¸”ä¸ä¼˜å…ˆçº§æ— å…³ï¼›\n\nï¼ˆ4ï¼‰notityAll()ï¼šå”¤é†’æ‰€æœ‰å¤„äºç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ï¼Œè¯¥æ–¹æ³•å¹¶ä¸æ˜¯å°†å¯¹è±¡çš„é”ç»™æ‰€æœ‰çº¿ç¨‹ï¼Œè€Œæ˜¯è®©å®ƒä»¬ç«äº‰ï¼Œåªæœ‰è·å¾—é”çš„çº¿ç¨‹æ‰èƒ½è¿›å…¥å°±ç»ªçŠ¶æ€ï¼›\n\n#### wait() å’Œ sleep() æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\nä¸¤è€…éƒ½å¯ä»¥æš‚åœçº¿ç¨‹çš„æ‰§è¡Œ\n\n- ç±»çš„ä¸åŒï¼šwait() æ˜¯ Object ç±»çš„æ–¹æ³•ï¼Œsleep() æ˜¯ Thread çº¿ç¨‹ç±»çš„é™æ€æ–¹æ³•ã€‚\n- é‡Šæ”¾é”ï¼šwait() é‡Šæ”¾é”ï¼Œsleep() ä¸é‡Šæ”¾é”ã€‚\n- ç”¨é€”ä¸åŒï¼šwait é€šå¸¸è¢«ç”¨äºçº¿ç¨‹é—´äº¤äº’/é€šä¿¡ï¼Œsleep é€šå¸¸è¢«ç”¨äºæš‚åœæ‰§è¡Œã€‚\n- è‡ªåŠ¨è‹é†’ï¼šwait() æ–¹æ³•è¢«è°ƒç”¨åï¼Œçº¿ç¨‹ä¸ä¼šè‡ªåŠ¨è‹é†’ï¼Œéœ€è¦åˆ«çš„çº¿ç¨‹è°ƒç”¨åŒä¸€ä¸ªå¯¹è±¡ä¸Šçš„ notify() æˆ–è€… notifyAll() æ–¹æ³•ã€‚sleep() æ–¹æ³•æ‰§è¡Œå®Œæˆåï¼Œçº¿ç¨‹ä¼šè‡ªåŠ¨è‹é†’ã€‚æˆ–è€…å¯ä»¥ä½¿ç”¨ wait(long timeout) è¶…æ—¶åçº¿ç¨‹ä¼šè‡ªåŠ¨è‹é†’ã€‚\n\n#### ä½ æ˜¯å¦‚ä½•è°ƒç”¨ wait() æ–¹æ³•çš„ï¼Ÿä½¿ç”¨ if å—è¿˜æ˜¯å¾ªç¯ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ\n\n> ä½¿ç”¨ while åˆ¤æ–­æ¡ä»¶æ˜¯å¦å¾—åˆ°æ»¡è¶³\n\nä½¿ç”¨ if æ¥åˆ¤æ–­ä¼šå­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š\n\n1. å¦ä¸€ä¸ªçº¿ç¨‹å¯èƒ½å·²ç»è¢«å”¤é†’å¹¶æ”¹å˜äº†æ¡ä»¶çŠ¶æ€ã€‚ä¾‹å¦‚ notifyAll ä¼šå”¤é†’å¤šä¸ªç­‰å¾…çš„çº¿ç¨‹ã€‚\n\n2. å­˜åœ¨â€œä¼ªå”¤é†’â€çš„æƒ…å†µï¼Œå³åœ¨æ²¡æœ‰é€šçŸ¥çš„æƒ…å†µä¸‹ï¼Œçº¿ç¨‹ä¹Ÿå¯èƒ½ä¼šè‹é†’è¿‡æ¥ï¼Œè€Œæ­¤æ—¶æ˜¯ä¸åº”è¯¥å”¤é†’çš„ã€‚\n\n\t```java\n\tsynchronized (monitor) {\n\t    //  åˆ¤æ–­æ¡ä»¶è°“è¯æ˜¯å¦å¾—åˆ°æ»¡è¶³\n\t    while(!locked) {\n\t        //  ç­‰å¾…å”¤é†’\n\t        monitor.wait();\n\t    }\n\t    //  å¤„ç†å…¶ä»–çš„ä¸šåŠ¡é€»è¾‘\n\t}\n\t```\n\n#### ä¸ºä»€ä¹ˆçº¿ç¨‹é€šä¿¡çš„æ–¹æ³• wait()ï¼Œnotify() å’Œ notifyAll() è¢«å®šä¹‰åœ¨ Object ç±»é‡Œï¼Ÿ\n\nJava ä¸­ï¼Œä»»ä½•å¯¹è±¡éƒ½å¯ä»¥ä½œä¸ºé”ï¼Œå¹¶ä¸”çº¿ç¨‹é€šä¿¡çš„æ–¹æ³• wait()ï¼Œnotify() ç­‰æ–¹æ³•ç”¨äºç­‰å¾…å¯¹è±¡çš„é”æˆ–è€…æ˜¯å”¤é†’çº¿ç¨‹ï¼Œé‚£ä¹ˆè¦æ‰¾ä¸€ä¸ªå¯ä¾›ä»»ä½•å¯¹è±¡ä½¿ç”¨çš„é”ï¼Œå› æ­¤å°†è¿™äº›æ–¹æ³•å®šä¹‰åœ¨ Object ä¸­ï¼ŒObject æ˜¯æ‰€æœ‰ç±»çš„çˆ¶ç±»ã€‚\n\n#### Thread ç±»ä¸­çš„ yield æ–¹æ³•æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ\n\nä½¿å½“å‰çº¿ç¨‹ä»è¿è¡ŒçŠ¶æ€å˜ä¸ºå°±ç»ªçŠ¶æ€ã€‚\n\n#### çº¿ç¨‹çš„ sleep()æ–¹æ³•å’Œ yield()æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\n1. sleep() æ–¹æ³•ç»™å…¶ä»–çº¿ç¨‹è¿è¡Œæœºä¼šæ—¶ä¸è€ƒè™‘çº¿ç¨‹çš„ä¼˜å…ˆçº§ï¼Œå› æ­¤ä¼šç»™ä½ä¼˜å…ˆçº§çš„çº¿ç¨‹ä»¥è¿è¡Œçš„æœºä¼šï¼›\n\n\tyield() æ–¹æ³•åªä¼šç»™**ç›¸åŒæˆ–æ›´é«˜ä¼˜å…ˆçº§**çš„çº¿ç¨‹ä»¥è¿è¡Œçš„æœºä¼šï¼›\n\n2. çº¿ç¨‹æ‰§è¡Œ sleep() æ–¹æ³•åè½¬å…¥ç­‰å¾…ï¼ˆwaitingï¼‰çŠ¶æ€ï¼Œè€Œæ‰§è¡Œ yield() æ–¹æ³•åè½¬å…¥å°±ç»ªï¼ˆreadyï¼‰çŠ¶æ€ï¼›\n\n#### å¦‚ä½•åœæ­¢ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„çº¿ç¨‹ï¼Ÿ\n\n1. å½“ run æ–¹æ³•å®Œæˆåçº¿ç¨‹ç»ˆæ­¢ï¼›\n2. ä½¿ç”¨ interrupt æ–¹æ³•ä¸­æ–­çº¿ç¨‹ã€‚\n\n#### notify() å’Œ notifyAll() æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\nå¦‚æœçº¿ç¨‹è°ƒç”¨äº†å¯¹è±¡çš„ wait() æ–¹æ³•ï¼Œé‚£ä¹ˆçº¿ç¨‹ä¾¿ä¼šå¤„äºè¯¥å¯¹è±¡çš„ç­‰å¾…æ± ä¸­ï¼Œç­‰å¾…æ± ä¸­çš„çº¿ç¨‹ä¸ä¼šå»ç«äº‰è¯¥å¯¹è±¡çš„é”ã€‚\n\nnotifyAll() ä¼šå”¤é†’æ‰€æœ‰çš„çº¿ç¨‹ï¼Œnotify() åªä¼šå”¤é†’ä¸€ä¸ªçº¿ç¨‹ã€‚\n\nnotifyAll() è°ƒç”¨åï¼Œä¼šå°†å…¨éƒ¨çº¿ç¨‹ç”±ç­‰å¾…æ± ç§»åˆ°é”æ± ï¼Œç„¶åå‚ä¸é”çš„ç«äº‰ï¼Œç«äº‰æˆåŠŸåˆ™ç»§ç»­æ‰§è¡Œï¼Œå¦‚æœä¸æˆåŠŸåˆ™ç•™åœ¨é”æ± ç­‰å¾…é”è¢«é‡Šæ”¾åå†æ¬¡å‚ä¸ç«äº‰ã€‚è€Œ notify()åªä¼šå”¤é†’ä¸€ä¸ªçº¿ç¨‹ï¼Œå…·ä½“å”¤é†’å“ªä¸€ä¸ªçº¿ç¨‹ç”±è™šæ‹Ÿæœºæ§åˆ¶ã€‚\n\n#### å¦‚ä½•åœ¨ä¸¤ä¸ªçº¿ç¨‹é—´å…±äº«æ•°æ®ï¼Ÿ\n\nJava çº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ç”± Java å†…å­˜æ¨¡å‹ï¼ˆç®€ç§° JMMï¼‰æ§åˆ¶ï¼š\n\n1. æ‰€æœ‰çš„å…±äº«å˜é‡éƒ½å­˜åœ¨ä¸»å†…å­˜ä¸­\n2. æ¯ä¸ªçº¿ç¨‹éƒ½ä¿å­˜äº†ä¸€ä»½è¯¥çº¿ç¨‹ä½¿ç”¨åˆ°çš„å…±äº«å˜é‡çš„å‰¯æœ¬\n3. å¦‚æœçº¿ç¨‹ A ä¸çº¿ç¨‹ B ä¹‹é—´è¦é€šä¿¡ï¼š\n\t1. çº¿ç¨‹ A å°†æœ¬åœ°å†…å­˜ A ä¸­æ›´æ–°è¿‡çš„å…±äº«å˜é‡åˆ·æ–°åˆ°ä¸»å†…å­˜ä¸­å»\n\t2. çº¿ç¨‹ B åˆ°ä¸»å†…å­˜ä¸­å»è¯»å–çº¿ç¨‹ A ä¹‹å‰å·²ç»æ›´æ–°è¿‡çš„å…±äº«å˜é‡ã€‚\n\n#### Java å¦‚ä½•å®ç°å¤šçº¿ç¨‹ä¹‹é—´çš„é€šè®¯å’Œåä½œï¼Ÿ\n\nJava ä¸­çº¿ç¨‹é€šä¿¡åä½œçš„æœ€å¸¸è§çš„ä¸¤ç§æ–¹å¼ï¼š\n\n1. synchronized åŠ é”çš„çº¿ç¨‹ + Object ç±»çš„ wait()/notify()/notifyAll()\n\n2. ReentrantLock ç±»åŠ é”çš„çº¿ç¨‹ + Condition ç±»çš„ await()/signal()/signalAll()\n\n#### åŒæ­¥æ–¹æ³•å’ŒåŒæ­¥å—ï¼Œå“ªä¸ªæ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Ÿ\n\nåŒæ­¥çš„èŒƒå›´è¶Šå°è¶Šå¥½ã€‚\n\nå› æ­¤ï¼ŒåŒæ­¥å—æ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Œå› ä¸ºå®ƒä¸ä¼šé”ä½æ•´ä¸ªå¯¹è±¡ï¼Œè€ŒåŒæ­¥æ–¹æ³•ä¼šé”ä½æ•´ä¸ªå¯¹è±¡ã€‚\n\n#### ä»€ä¹ˆæ˜¯çº¿ç¨‹åŒæ­¥å’Œçº¿ç¨‹äº’æ–¥ï¼Œæœ‰å“ªå‡ ç§å®ç°æ–¹å¼ï¼Ÿ\n\nçº¿ç¨‹åŒæ­¥æ˜¯ä¸¤ä¸ªæˆ–å¤šä¸ªå…±äº«å…³é”®èµ„æºçš„çº¿ç¨‹çš„å¹¶å‘æ‰§è¡Œã€‚åº”è¯¥åŒæ­¥çº¿ç¨‹ä»¥é¿å…å…³é”®çš„èµ„æºä½¿ç”¨å†²çªã€‚\n\nçº¿ç¨‹äº’æ–¥æ˜¯å¯¹æŸä¸€å…±äº«èµ„æºè€Œè¨€ï¼Œä»»ä½•æ—¶åˆ»æœ€å¤šåªå…è®¸ä¸€ä¸ªçº¿ç¨‹å»ä½¿ç”¨ï¼Œå…¶å®ƒè¦ä½¿ç”¨è¯¥èµ„æºçš„çº¿ç¨‹å¿…é¡»ç­‰å¾…ï¼Œç›´åˆ°å ç”¨èµ„æºè€…é‡Šæ”¾è¯¥èµ„æºã€‚\n\nå®ç°çº¿ç¨‹åŒæ­¥çš„æ–¹æ³•ï¼š\n\n- åŒæ­¥ä»£ç æ–¹æ³• / æ–¹æ³•å—ï¼šsychronized å…³é”®å­—ä¿®é¥°çš„æ–¹æ³• / ä»£ç å—\n- ä½¿ç”¨ç‰¹æ®Šå˜é‡åŸŸ volatile å®ç°çº¿ç¨‹åŒæ­¥ï¼švolatile å…³é”®å­—ä¸ºåŸŸå˜é‡çš„è®¿é—®æä¾›äº†ä¸€ç§å…é”æœºåˆ¶\n- ä½¿ç”¨é‡å…¥é”å®ç°çº¿ç¨‹åŒæ­¥ï¼šreentrantlock ç±»æ˜¯å¯é‡å…¥ã€äº’æ–¥ã€å®ç°äº† lock æ¥å£çš„é”ï¼Œä¸ sychronized æ–¹æ³•å…·æœ‰ç›¸åŒçš„åŸºæœ¬è¡Œä¸ºå’Œè¯­ä¹‰\n\n#### åœ¨ç›‘è§†å™¨(Monitor)å†…éƒ¨ï¼Œæ˜¯å¦‚ä½•åšçº¿ç¨‹åŒæ­¥çš„ï¼Ÿ\n\nåœ¨ Java è™šæ‹Ÿæœºä¸­ï¼Œæ¯ä¸ªå¯¹è±¡å…³è”ä¸€ä¸ª**ç›‘è§†å™¨**ï¼Œä¸ºäº†å®ç°ç›‘è§†å™¨çš„äº’æ–¥åŠŸèƒ½ï¼Œ**æ¯ä¸ªå¯¹è±¡éƒ½å…³è”ç€ä¸€æŠŠé”**ã€‚\n\nä¸€æ—¦æ–¹æ³•æˆ–è€…ä»£ç å—è¢« **synchronized** ä¿®é¥°ï¼Œé‚£ä¹ˆè¿™ä¸ªéƒ¨åˆ†å°±æ”¾å…¥äº†ç›‘è§†å™¨çš„ç›‘è§†åŒºåŸŸï¼Œ**ç¡®ä¿ä¸€æ¬¡åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œè¯¥éƒ¨åˆ†çš„ä»£ç **ï¼Œçº¿ç¨‹åœ¨è·å–é”ä¹‹å‰ä¸å…è®¸æ‰§è¡Œè¯¥éƒ¨åˆ†çš„ä»£ç \n\nå¦å¤– Java è¿˜æä¾›äº†æ˜¾å¼ç›‘è§†å™¨ (Lock) å’Œéšå¼ç›‘è§†å™¨ (synchronized) ä¸¤ç§é”æ–¹æ¡ˆ\n\n#### Java çº¿ç¨‹æ•°è¿‡å¤šä¼šé€ æˆä»€ä¹ˆé—®é¢˜ï¼Ÿ\n\n- æ¶ˆè€—è¿‡å¤šçš„ CPU èµ„æº\n\n\tå¦‚æœå¯è¿è¡Œçš„çº¿ç¨‹æ•°é‡å¤šäºå¯ç”¨å¤„ç†å™¨çš„æ•°é‡ï¼Œé‚£ä¹ˆæœ‰çº¿ç¨‹å°†ä¼šè¢«é—²ç½®ã€‚å¤§é‡ç©ºé—²çš„çº¿ç¨‹ä¼šå ç”¨è®¸å¤šå†…å­˜ï¼Œç»™åƒåœ¾å›æ”¶å™¨å¸¦æ¥å‹åŠ›ã€‚\n\n- é™ä½ JVM ç¨³å®šæ€§\n\n\tåœ¨å¯åˆ›å»ºçº¿ç¨‹çš„æ•°é‡ä¸Šå­˜åœ¨ä¸€ä¸ªé™åˆ¶ï¼Œè¿™ä¸ªé™åˆ¶å€¼å°†éšç€å¹³å°çš„ä¸åŒè€Œä¸åŒï¼Œå¹¶ä¸”æ‰¿å—ç€å¤šä¸ªå› ç´ åˆ¶çº¦ï¼ŒåŒ…æ‹¬ JVM çš„å¯åŠ¨å‚æ•°ã€Thread æ„é€ å‡½æ•°ä¸­è¯·æ±‚æ ˆçš„å¤§å°ï¼Œä»¥åŠåº•å±‚æ“ä½œç³»ç»Ÿå¯¹çº¿ç¨‹çš„é™åˆ¶ç­‰ã€‚å¦‚æœç ´åäº†è¿™äº›é™åˆ¶ï¼Œé‚£ä¹ˆå¯èƒ½æŠ›å‡º OutOfMemoryError å¼‚å¸¸ã€‚\n\n## å¹¶å‘å…³é”®å­—\n\n### synchronized\n\n#### synchronized çš„ä½œç”¨ï¼Ÿ\n\nåœ¨ Java ä¸­ï¼Œsynchronized å…³é”®å­—æ˜¯ç”¨æ¥æ§åˆ¶çº¿ç¨‹åŒæ­¥çš„ï¼Œå°±æ˜¯åœ¨å¤šçº¿ç¨‹çš„ç¯å¢ƒä¸‹ï¼Œæ§åˆ¶ synchronized ä»£ç æ®µä¸è¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶æ‰§è¡Œã€‚synchronized å¯ä»¥ä¿®é¥°é™æ€æ–¹æ³•ã€å®ä¾‹æ–¹æ³•ã€ä»£ç å—ã€‚\n\n#### æ€ä¹ˆä½¿ç”¨ synchronized å…³é”®å­—\n\n**synchronizedå…³é”®å­—æœ€ä¸»è¦çš„ä¸‰ç§ä½¿ç”¨æ–¹å¼ï¼š**\n\n- **ä¿®é¥°å®ä¾‹æ–¹æ³•ï¼š** ç»™å½“å‰å¯¹è±¡å®ä¾‹åŠ é”ï¼›\n- **ä¿®é¥°é™æ€æ–¹æ³•ï¼š** ç»™å½“å‰ç±»åŠ é”ï¼›\n- **ä¿®é¥°ä»£ç å—ï¼š**ç»™æŒ‡å®šå¯¹è±¡åŠ é”ï¼Œè¿›å…¥åŒæ­¥ä»£ç å—å‰è¦è·å¾—æŒ‡å®šå¯¹è±¡çš„é”ã€‚\n\n**æ€»ç»“ï¼š** synchronized å…³é”®å­—åŠ åˆ° static é™æ€æ–¹æ³•å’Œ synchronized(xxx.class) ä»£ç å—ä¸Šéƒ½æ˜¯æ˜¯ç»™ Class ç±»ä¸Šé”ã€‚synchronized å…³é”®å­—åŠ åˆ°å®ä¾‹æ–¹æ³•ä¸Šæ˜¯ç»™å¯¹è±¡å®ä¾‹ä¸Šé”ã€‚\n\n#### åŒé‡æ ¡éªŒé”å®ç°å¯¹è±¡å•ä¾‹ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰\n\n```java\npublic class Singleton {\n    private volatile static Singleton uniqueInstance;\n\n    private Singleton() {}\n\n    public static Singleton getInstance() {\n        // ç¬¬ä¸€æ¬¡å‡å¦‚çº¿ç¨‹1ï¼Œçº¿ç¨‹2ï¼Œçº¿ç¨‹3åˆ°è¾¾è¿™ï¼Œéƒ½åˆ¤æ–­åˆ°nullæœªå®ä¾‹åŒ–ï¼ŒåŠ è¿™ä¸ªåˆ¤æ–­æ˜¯ä¸ºäº†è®©é™¤äº†ç¬¬ä¸€æ¬¡å®ä¾‹åŒ–ä¹‹åçš„å…¶ä»–çº¿ç¨‹åˆ¤æ–­åˆ°éç©ºè¡¨æ˜å·²ç»å®ä¾‹åŒ–è¿‡äº†ï¼Œç›´æ¥è¿”å›å•ä¾‹\n        if (uniqueInstance == null) {\t// çº¿ç¨‹1ã€2ã€3æœ‰å¯èƒ½éƒ½è¿›æ¥äº†\n            //ç±»å¯¹è±¡åŠ é”\n            synchronized (Singleton.class) {\t// å¦‚æœå¤šä¸ªçº¿ç¨‹éƒ½åˆ¤æ–­åˆ°æœªå®ä¾‹åŒ–ï¼Œé‚£ä¹ˆåªä¼šæœ‰ä¸€ä¸ªçº¿ç¨‹é”ä½ç±»å¹¶è¿›è¡Œå®ä¾‹åŒ–\n                if (uniqueInstance == null) {\t// å¦‚æœä¸åŠ è¿™ä¸ªåˆ¤æ–­ï¼Œçº¿ç¨‹1æ‹¿åˆ°é”è¿›è¡Œå®ä¾‹åŒ–ä¹‹åï¼Œçº¿ç¨‹2æ‹¿åˆ°é”ï¼Œè¿›æ¥ç›´æ¥è¿›è¡Œå®ä¾‹åŒ–ï¼Œè¿™å°±äº§ç”Ÿå¤šæ¬¡å®ä¾‹åŒ–æ“ä½œã€‚å¦‚æœåŠ è¿™ä¸ªåˆ¤æ–­ï¼Œçº¿ç¨‹2æ‹¿åˆ°é”ä¹‹åï¼Œåˆ¤æ–­åˆ°å·²ç»å®ä¾‹åŒ–äº†ï¼Œå°±ä¸ä¼šå†è¿›è¡Œå®ä¾‹åŒ–äº†ã€‚\n                    uniqueInstance = new Singleton();\n                }\n            }\n        }\n        return uniqueInstance;\n    }\n\n}\n```\n\nå¦å¤–ï¼Œéœ€è¦æ³¨æ„ instance é‡‡ç”¨ volatile å…³é”®å­—ä¿®é¥°ä¹Ÿæ˜¯å¾ˆæœ‰å¿…è¦ã€‚\n\ninstance é‡‡ç”¨ volatile å…³é”®å­—ä¿®é¥°ä¹Ÿæ˜¯å¾ˆæœ‰å¿…è¦çš„ï¼Œinstance = new Singleton() è¿™æ®µä»£ç å…¶å®æ˜¯åˆ†ä¸ºä¸‰æ­¥æ‰§è¡Œï¼š\n\n1. ä¸º instance åˆ†é…å†…å­˜ç©ºé—´\n2. åˆå§‹åŒ– instance\n3. å°† instance æŒ‡å‘åˆ†é…çš„å†…å­˜åœ°å€\n\nä½†æ˜¯ç”±äº JVM å…·æœ‰æŒ‡ä»¤é‡æ’çš„ç‰¹æ€§ï¼Œæ‰§è¡Œé¡ºåºæœ‰å¯èƒ½å˜æˆ 1->3->2ã€‚æŒ‡ä»¤é‡æ’åœ¨å•çº¿ç¨‹ç¯å¢ƒä¸‹ä¸ä¼šå‡ºç°é—®é¢˜ï¼Œä½†æ˜¯åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä¼šå¯¼è‡´ä¸€ä¸ªçº¿ç¨‹è·å¾—è¿˜æ²¡æœ‰åˆå§‹åŒ–çš„å®ä¾‹ã€‚ä¾‹å¦‚ï¼Œçº¿ç¨‹ T1 æ‰§è¡Œäº† 1 å’Œ 3ï¼Œæ­¤æ—¶ T2 è°ƒç”¨ getInstance() åå‘ç° instance ä¸ä¸ºç©ºï¼Œå› æ­¤**è¿”å› T1 å®ä¾‹åŒ–ä½†æœªåˆå§‹åŒ–**çš„ instanceã€‚\n\n#### synchronized åº•å±‚å®ç°åŸç†ï¼Ÿï¼ˆç›‘è§†å™¨monitorï¼‰\n\nsynchronized æ˜¯ Java ä¸­çš„ä¸€ä¸ªå…³é”®å­—ï¼Œé€šè¿‡ javap å‘½ä»¤ï¼ŒæŸ¥çœ‹ç›¸åº”çš„å­—èŠ‚ç æ–‡ä»¶ã€‚\n\nsynchronized åŒæ­¥è¯­å¥å—çš„æƒ…å†µ\n\n```java\npublic class SynchronizedDemo {\n    public void method() {\n        synchronized (this) {\n            System.out.println(\"synchronized ä»£ç å—\");\n        }\n    }\n}\n```\n\né€šè¿‡ JDK åæ±‡ç¼–æŒ‡ä»¤ javap -c -v SynchronizedDemo\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/image-20220912212554623.png\" alt=\"monitorenter&monitorexit\" style=\"zoom:50%;\" />\n\nå¯ä»¥çœ‹å‡ºåœ¨æ‰§è¡ŒåŒæ­¥ä»£ç å—ä¹‹å‰ä¹‹åéƒ½æœ‰ä¸€ä¸ª monitor å­—æ ·ï¼Œå…¶ä¸­å‰é¢çš„æ˜¯ monitorenterï¼Œåé¢çš„æ˜¯ç¦»å¼€ monitorexitï¼Œä¸éš¾æƒ³è±¡ä¸€ä¸ªçº¿ç¨‹æ‰§è¡ŒåŒæ­¥ä»£ç å—ï¼Œé¦–å…ˆè¦è·å–é”ï¼Œè€Œè·å–é”çš„è¿‡ç¨‹å°±æ˜¯ monitorenter ï¼Œåœ¨æ‰§è¡Œå®Œä»£ç å—ä¹‹åï¼Œè¦é‡Šæ”¾é”ï¼Œé‡Šæ”¾é”å°±æ˜¯æ‰§è¡Œ monitorexit æŒ‡ä»¤ã€‚\n\nä¸ºä»€ä¹ˆä¼šæœ‰ä¸¤ä¸ª monitorexit å‘¢ï¼Ÿï¼ˆline 19ï¼‰\n\nè¿™ä¸ªä¸»è¦æ˜¯é˜²æ­¢åœ¨åŒæ­¥ä»£ç å—ä¸­çº¿ç¨‹å› å¼‚å¸¸é€€å‡ºï¼Œè€Œé”æ²¡æœ‰å¾—åˆ°é‡Šæ”¾ï¼Œè¿™å¿…ç„¶ä¼šé€ æˆæ­»é”ï¼ˆç­‰å¾…çš„çº¿ç¨‹æ°¸è¿œè·å–ä¸åˆ°é”ï¼‰ã€‚**å› æ­¤æœ€åä¸€ä¸ªmonitorexitæ˜¯ä¿è¯åœ¨å¼‚å¸¸æƒ…å†µä¸‹ï¼Œé”ä¹Ÿå¯ä»¥å¾—åˆ°é‡Šæ”¾ï¼Œé¿å…æ­»é”ã€‚**\n\n#### synchronized å¯é‡å…¥çš„åŸç†\n\né‡å…¥é”æ˜¯æŒ‡ä¸€ä¸ªçº¿ç¨‹è·å–åˆ°è¯¥é”ä¹‹åï¼Œè¯¥çº¿ç¨‹å¯ä»¥ç»§ç»­è·å¾—è¯¥é”ã€‚\nåº•å±‚åŸç†ç»´æŠ¤ä¸€ä¸ª**è®¡æ•°å™¨**ï¼Œå½“çº¿ç¨‹è·å–è¯¥é”æ—¶ï¼Œè®¡æ•°å™¨åŠ ä¸€ï¼Œå†æ¬¡è·å¾—è¯¥é”æ—¶ç»§ç»­åŠ ä¸€ï¼Œé‡Šæ”¾é”æ—¶ï¼Œè®¡æ•°å™¨å‡ä¸€ï¼Œå½“è®¡æ•°å™¨å€¼ä¸º 0 æ—¶ï¼Œè¡¨æ˜è¯¥é”æœªè¢«ä»»ä½•çº¿ç¨‹æ‰€æŒæœ‰ï¼Œå…¶å®ƒçº¿ç¨‹å¯ä»¥ç«äº‰è·å–é”ã€‚\n\n#### ä»€ä¹ˆæ˜¯è‡ªæ—‹\n\n> ä¸è¦é‡åˆ° synchronized å°±è®©ç­‰å¾…é”çš„çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œè€Œæ˜¯è®©è¿™ä¸ªçº¿ç¨‹åœ¨ synchronized è¾¹ç•Œåšå¿™å¾ªç¯\n\nå¾ˆå¤š synchronized é‡Œé¢çš„ä»£ç åªæ˜¯ä¸€äº›å¾ˆç®€å•çš„ä»£ç ï¼Œæ‰§è¡Œæ—¶é—´éå¸¸å¿«ï¼Œæ—¢ç„¶ synchronized é‡Œé¢çš„ä»£ç æ‰§è¡Œå¾—éå¸¸å¿«ï¼Œä¸å¦¨è®©ç­‰å¾…é”çš„çº¿ç¨‹ä¸è¦è¢«é˜»å¡ï¼Œå› ä¸º**çº¿ç¨‹é˜»å¡æ¶‰åŠåˆ°ç”¨æˆ·æ€å’Œå†…æ ¸æ€åˆ‡æ¢çš„é—®é¢˜å¼€é”€å¾ˆå¤§**ï¼Œè€Œæ˜¯**åœ¨ synchronized çš„è¾¹ç•Œåšå¿™å¾ªç¯**ï¼Œè¿™å°±æ˜¯è‡ªæ—‹ã€‚å¦‚æœåšäº†å¤šæ¬¡å¾ªç¯å‘ç°è¿˜æ²¡æœ‰è·å¾—é”ï¼Œå†é˜»å¡ï¼Œè¿™æ ·å¯èƒ½æ˜¯ä¸€ç§æ›´å¥½çš„ç­–ç•¥ã€‚\n\n#### å¤šçº¿ç¨‹ä¸­ synchronized é”å‡çº§çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ\n\n> ç›®çš„ï¼šé”å‡çº§æ˜¯ä¸ºäº†å‡ä½äº†é”å¸¦æ¥çš„æ€§èƒ½æ¶ˆè€—ã€‚\n\nJava çš„é”éƒ½æ˜¯åŸºäºå¯¹è±¡çš„ï¼ŒJava å¯¹è±¡æœ‰å¯¹è±¡å¤´ï¼Œå†…å®¹åŒ…æ‹¬ï¼š\n\n1. Mark Wordï¼Œå­˜å‚¨å¯¹è±¡çš„ hashCodeã€é”ä¿¡æ¯ç­‰ï¼›\n2. Class Metadata Addressï¼Œå­˜å‚¨åˆ°å¯¹è±¡ç±»å‹æ•°æ®çš„æŒ‡é’ˆï¼›\n3. æ•°ç»„çš„é•¿åº¦ï¼ˆå¦‚æœæ˜¯æ•°ç»„ï¼‰\n\næ¯ä¸€ä¸ªçº¿ç¨‹åœ¨å‡†å¤‡è·å–å…±äº«èµ„æºæ—¶ï¼š \n\nç¬¬ä¸€æ­¥ï¼Œæ£€æŸ¥é”çš„ MarkWord é‡Œé¢æ˜¯ä¸æ˜¯æ”¾çš„è‡ªå·±çš„ ThreadIdï¼Œå¦‚æœæ˜¯ï¼Œè¡¨ç¤ºå½“å‰çº¿ç¨‹æ˜¯å¤„äº â€œ**åå‘é”**â€ ï¼›\n\nç¬¬äºŒæ­¥ï¼Œå¦‚æœé”çš„ MarkWord å­˜æ”¾çš„ä¸æ˜¯è‡ªå·±çš„ ThreadIdï¼Œè¿™ä¸ªæ—¶å€™ä¼šå°è¯•ä½¿ç”¨ CAS æ¥æ›¿æ¢ Mark Word é‡Œé¢çš„çº¿ç¨‹ ID ä¸ºæ–°çº¿ç¨‹çš„ IDï¼Œè¿™ä¸ªæ—¶å€™è¦åˆ†ä¸¤ç§æƒ…å†µï¼š\n\n- CAS æ›¿æ¢æˆåŠŸï¼Œè¡¨ç¤ºä¹‹å‰çš„çº¿ç¨‹ä¸å­˜åœ¨äº†ï¼Œ Mark Word é‡Œé¢çš„çº¿ç¨‹ ID ä¸ºæ–°çº¿ç¨‹çš„ IDï¼Œé”ä¸ä¼šå‡çº§ï¼Œä»ç„¶ä¸ºåå‘é”ï¼›\n- CAS æ›¿æ¢å¤±è´¥ï¼Œè¡¨ç¤ºä¹‹å‰çš„çº¿ç¨‹ä»ç„¶å­˜åœ¨ï¼Œæ ¹æ®é”çš„ MarkWord é‡Œé¢çš„ ThreadIdï¼Œé€šçŸ¥è¯¥ ThreadId çš„çº¿ç¨‹æš‚åœï¼Œä¹‹å‰çº¿ç¨‹å°† Markword çš„å†…å®¹ç½®ä¸ºç©ºï¼Œå‡çº§ä¸ºè½»é‡çº§é”ï¼Œä¼šæŒ‰ç…§è½»é‡çº§é”çš„æ–¹å¼è¿›è¡Œç«äº‰é”ã€‚\n\nç¬¬ä¸‰æ­¥ï¼Œä¸¤ä¸ªçº¿ç¨‹éƒ½æŠŠé”å¯¹è±¡çš„ hashCode å¤åˆ¶åˆ°è‡ªå·±æ–°å»ºçš„ç”¨äºå­˜å‚¨é”çš„è®°å½•ç©ºé—´ï¼Œæ¥ç€å¼€å§‹é€šè¿‡ CAS æ“ä½œï¼Œ æŠŠé”å¯¹è±¡çš„ MarkWord çš„å†…å®¹ä¿®æ”¹ä¸ºè‡ªå·±æ–°å»ºçš„è®°å½•ç©ºé—´çš„åœ°å€çš„æ–¹å¼ç«äº‰ MarkWordï¼›\n\nç¬¬å››æ­¥ï¼Œç¬¬ä¸‰æ­¥ä¸­æˆåŠŸæ‰§è¡Œ CAS çš„è·å¾—èµ„æºï¼Œå¤±è´¥çš„åˆ™è¿›å…¥è‡ªæ—‹ ï¼›\n\nç¬¬äº”æ­¥ï¼Œè‡ªæ—‹çš„çº¿ç¨‹åœ¨è‡ªæ—‹è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæˆåŠŸè·å¾—èµ„æºï¼ˆå³ä¹‹å‰è·çš„èµ„æºçš„çº¿ç¨‹æ‰§è¡Œå®Œæˆå¹¶é‡Šæ”¾äº†å…±äº«èµ„æºï¼‰ï¼Œåˆ™æ•´ä¸ªçŠ¶æ€ä¾ç„¶å¤„äº **è½»é‡çº§é”**çš„çŠ¶æ€ï¼›å¦‚æœè‡ªæ—‹å¤±è´¥ ï¼ˆè¿™è¾¹çš„è‡ªæ—‹æ–¹å¼å¯ä»¥é‡‡ç”¨é€‚åº”æ€§è‡ªæ—‹ï¼Œç®€å•æ¥è¯´å°±æ˜¯çº¿ç¨‹å¦‚æœè‡ªæ—‹æˆåŠŸäº†ï¼Œåˆ™ä¸‹æ¬¡è‡ªæ—‹çš„æ¬¡æ•°ä¼šæ›´å¤šï¼Œå¦‚æœè‡ªæ—‹å¤±è´¥äº†ï¼Œåˆ™è‡ªæ—‹çš„æ¬¡æ•°å°±ä¼šå‡å°‘ï¼‰ï¼›\n\nç¬¬å…­æ­¥ï¼Œè¿›å…¥**é‡é‡çº§é”**çš„çŠ¶æ€ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œè‡ªæ—‹çš„çº¿ç¨‹è¿›å…¥é˜»å¡ï¼Œç­‰å¾…ç«äº‰çº¿ç¨‹æ‰§è¡Œå®Œæˆå¹¶å”¤é†’è‡ªå·±ã€‚\n\n#### çº¿ç¨‹ B æ€ä¹ˆçŸ¥é“çº¿ç¨‹ A ä¿®æ”¹äº†å˜é‡\n\n* volatile ä¿®é¥°å˜é‡\n\n* synchronized ä¿®é¥°ä¿®æ”¹å˜é‡çš„æ–¹æ³•\n* lock å¯¹ä¿®æ”¹å˜é‡çš„ä»£ç å—åŠ é”\n\n#### synchronized å’Œ Lock æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\n- synchronized æ˜¯ Java å…³é”®å­—ï¼Œè€Œ Lock æ˜¯ä¸ªæ¥å£ï¼›\n- synchronized å¯ä»¥ç»™é™æ€æ–¹æ³•ã€å®ä¾‹æ–¹æ³•ã€ä»£ç å—åŠ é”ï¼Œè€Œ lock åªèƒ½ç»™ä»£ç å—åŠ é”ï¼›\n- synchronized ä¸éœ€è¦æ‰‹åŠ¨è·å–é”å’Œé‡Šæ”¾é”ï¼Œè€Œ lock éœ€è¦è‡ªå·±åŠ é”å’Œé‡Šæ”¾é”ï¼›\n- é€šè¿‡ Lock å¯ä»¥çŸ¥é“æœ‰æ²¡æœ‰æˆåŠŸè·å–é”ï¼Œè€Œ synchronized å´æ— æ³•åŠåˆ°ã€‚\n\n#### synchronized å’Œ ReentrantLock åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\n\n**ç›¸åŒç‚¹ï¼š**\n\nä¸¤è€…éƒ½æ˜¯å¯é‡å…¥é”\n\nâ€œå¯é‡å…¥é”â€æ¦‚å¿µæ˜¯ï¼šè‡ªå·±å¯ä»¥å†æ¬¡è·å–è‡ªå·±çš„å†…éƒ¨é”ã€‚æ¯”å¦‚ä¸€ä¸ªçº¿ç¨‹è·å¾—äº†æŸä¸ªå¯¹è±¡çš„é”ï¼Œæ­¤æ—¶è¿™ä¸ªå¯¹è±¡é”è¿˜æ²¡æœ‰é‡Šæ”¾ï¼Œå½“å…¶å†æ¬¡æƒ³è¦è·å–è¿™ä¸ªå¯¹è±¡çš„é”çš„æ—¶å€™è¿˜æ˜¯å¯ä»¥è·å–çš„ï¼Œ**å¦‚æœä¸å¯é”é‡å…¥çš„è¯ï¼Œå°±ä¼šé€ æˆæ­»é”**ã€‚åŒä¸€ä¸ªçº¿ç¨‹æ¯æ¬¡è·å–é”ï¼Œé”çš„è®¡æ•°å™¨éƒ½è‡ªå¢ 1ï¼Œæ‰€ä»¥è¦ç­‰åˆ°é”çš„è®¡æ•°å™¨ä¸‹é™ä¸º 0 æ—¶æ‰èƒ½é‡Šæ”¾é”ã€‚\n\n**ä¸åŒç‚¹ï¼š**\n\n* synchronized æ˜¯å…³é”®å­—ï¼ŒReentrantLock æ˜¯ç±»ï¼›\n* ReentrantLock åªé€‚ç”¨äºä»£ç å—é”ï¼Œè€Œ synchronized å¯ä»¥ä¿®é¥°ç±»ã€æ–¹æ³•ã€å˜é‡ç­‰ï¼›\n\n- ReentrantLock å¿…é¡»æ‰‹åŠ¨è·å–ä¸é‡Šæ”¾é”ï¼Œè€Œ synchronized ä¸éœ€è¦æ‰‹åŠ¨é‡Šæ”¾å’Œå¼€å¯é”ï¼›\n- äºŒè€…çš„é”æœºåˆ¶å…¶å®ä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ï¼š\n\tReentrantLock åº•å±‚è°ƒç”¨çš„æ˜¯ Unsafe çš„ park æ–¹æ³•åŠ é”ï¼Œsynchronized æ“ä½œçš„åº”è¯¥æ˜¯å¯¹è±¡å¤´ä¸­ mark word\n\n### volatile\n\n#### ä¸ºä»€ä¹ˆä»£ç ä¼šé‡æ’åºï¼Ÿ\n\nåœ¨æ‰§è¡Œç¨‹åºæ—¶ï¼Œä¸ºäº†**æé«˜æ€§èƒ½**ï¼Œå¤„ç†å™¨å’Œç¼–è¯‘å™¨å¸¸å¸¸ä¼šå¯¹æŒ‡ä»¤è¿›è¡Œé‡æ’åºï¼Œä½†æ˜¯ä¸èƒ½éšæ„é‡æ’åºï¼Œä¸æ˜¯ä½ æƒ³æ€ä¹ˆæ’åºå°±æ€ä¹ˆæ’åºï¼Œå®ƒéœ€è¦æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶ï¼š\n\n- **åœ¨å•çº¿ç¨‹ç¯å¢ƒä¸‹ä¸èƒ½æ”¹å˜ç¨‹åºè¿è¡Œçš„ç»“æœï¼›**\n- **å­˜åœ¨æ•°æ®ä¾èµ–å…³ç³»çš„ä¸å…è®¸é‡æ’åº**\n\néœ€è¦æ³¨æ„çš„æ˜¯ï¼šé‡æ’åºä¸ä¼šå½±å“å•çº¿ç¨‹ç¯å¢ƒçš„æ‰§è¡Œç»“æœï¼Œä½†æ˜¯ä¼šç ´åå¤šçº¿ç¨‹çš„æ‰§è¡Œè¯­ä¹‰ã€‚\n\n#### as-if-serial è§„åˆ™å’Œ happens-before è§„åˆ™çš„åŒºåˆ«\n\n- as-if-serial è§„åˆ™ä¿è¯ **å•çº¿ç¨‹** å†…ç¨‹åºçš„æ‰§è¡Œç»“æœä¸è¢«æ”¹å˜ï¼Œhappens-before è§„åˆ™ä¿è¯ **æ­£ç¡®åŒæ­¥çš„å¤šçº¿ç¨‹** ç¨‹åºçš„æ‰§è¡Œç»“æœä¸è¢«æ”¹å˜ã€‚\n- as-if-serial è¯­ä¹‰å’Œ happens-before è¿™ä¹ˆåšçš„ç›®çš„ï¼Œéƒ½æ˜¯ä¸ºäº†åœ¨ä¸æ”¹å˜ç¨‹åºæ‰§è¡Œç»“æœçš„å‰æä¸‹ï¼Œå°½å¯èƒ½åœ°æé«˜ç¨‹åºæ‰§è¡Œçš„å¹¶è¡Œåº¦ã€‚\n\n#### volatile å…³é”®å­—çš„ä½œç”¨\n\nå¯¹äºå¯è§æ€§ï¼ŒJava æä¾›äº† volatile å…³é”®å­—æ¥ä¿è¯å¯è§æ€§å’Œæœ‰åºæ€§ï¼ˆç¦æ­¢æŒ‡ä»¤é‡æ’ï¼‰ï¼Œä½†ä¸èƒ½ä¿è¯åŸå­æ€§ã€‚ volatile æä¾› happens-before çš„ä¿è¯ï¼Œç¡®ä¿ä¸€ä¸ªçº¿ç¨‹çš„ä¿®æ”¹èƒ½å¯¹å…¶ä»–çº¿ç¨‹æ˜¯å¯è§çš„ã€‚å½“ä¸€ä¸ªå…±äº«å˜é‡è¢« volatile ä¿®é¥°æ—¶ï¼Œå®ƒä¼šä¿è¯ä¿®æ”¹çš„å€¼ä¼šç«‹å³è¢«æ›´æ–°åˆ°ä¸»å­˜ï¼Œå½“æœ‰å…¶ä»–çº¿ç¨‹éœ€è¦è¯»å–æ—¶ï¼Œå®ƒä¼šå»å†…å­˜ä¸­è¯»å–æ–°å€¼ã€‚\n\n#### JMMå†…å­˜å±éšœæ’å…¥ç­–ç•¥\n\n**æ’å…¥å±éšœ**\n\nStoreStore å±éšœ - volatile å†™ - StoreLoad å±éšœ\n\nvolatile è¯» - LoadLoad å±éšœ - LoadStore å±éšœ\n\n**volatile ä¸æ™®é€šå˜é‡çš„é‡æ’åºè§„åˆ™**\n\n1. å¦‚æœç¬¬ä¸€ä¸ªæ“ä½œæ˜¯ volatile è¯»ï¼Œé‚£æ— è®ºç¬¬äºŒä¸ªæ“ä½œæ˜¯ä»€ä¹ˆï¼Œéƒ½ä¸èƒ½é‡æ’åºï¼›\n2. å¦‚æœç¬¬äºŒä¸ªæ“ä½œæ˜¯ volatile å†™ï¼Œé‚£æ— è®ºç¬¬ä¸€ä¸ªæ“ä½œæ˜¯ä»€ä¹ˆï¼Œéƒ½ä¸èƒ½é‡æ’åºï¼›\n3. å¦‚æœç¬¬ä¸€ä¸ªæ“ä½œæ˜¯ volatile å†™ï¼Œç¬¬äºŒä¸ªæ“ä½œæ˜¯ volatile è¯»ï¼Œé‚£ä¸èƒ½é‡æ’åºã€‚\n\n#### volatile èƒ½ä½¿å¾—ä¸€ä¸ªéåŸå­æ“ä½œå˜æˆåŸå­æ“ä½œå—ï¼Ÿ\n\nvolatile åªèƒ½ä¿è¯å¯è§æ€§å’Œæœ‰åºæ€§è€Œä¸èƒ½ä¿è¯åŸå­æ€§ï¼Œä½†ç”¨ volatile ä¿®é¥° long å’Œ double å¯ä»¥ä¿è¯å…¶æ“ä½œåŸå­æ€§ã€‚\n\n#### volatile ä¿®é¥°ç¬¦çš„æœ‰è¿‡ä»€ä¹ˆå®è·µï¼Ÿ\n\nå•ä¾‹æ¨¡å¼-åŒé‡é”æ£€éªŒé‡Œé¢ç”¨ volatile ä¿®é¥°å®ä¾‹å˜é‡ã€‚\n\n#### volatile å’Œ synchronized çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\n\n- volatile æ˜¯å˜é‡ä¿®é¥°ç¬¦ï¼›synchronized å¯ä»¥ä¿®é¥°ç±»ã€æ–¹æ³•ã€ä»£ç å—ï¼›\n- volatile ä»…èƒ½å®ç°å˜é‡çš„ä¿®æ”¹å¯è§æ€§å’Œæœ‰åºæ€§ï¼Œä¸èƒ½ä¿è¯åŸå­æ€§ï¼Œ\n\tè€Œ synchronized åˆ™å¯ä»¥ä¿è¯å˜é‡çš„ä¿®æ”¹åŸå­æ€§å’Œå¯è§æ€§ï¼›\n- volatile ä¸ä¼šé€ æˆçº¿ç¨‹çš„é˜»å¡ï¼›synchronized å¯èƒ½ä¼šé€ æˆçº¿ç¨‹çš„é˜»å¡ï¼›\n- **volatileå…³é”®å­—**æ˜¯çº¿ç¨‹åŒæ­¥çš„**è½»é‡çº§å®ç°**ï¼Œæ‰€ä»¥**volatileæ€§èƒ½è‚¯å®šæ¯”synchronizedå…³é”®å­—è¦å¥½**ã€‚synchronized å…³é”®å­—åœ¨ JavaSE1.6 ä¹‹åè¿›è¡Œäº†ä¸»è¦åŒ…æ‹¬ä¸ºäº†**å‡å°‘è·å¾—é”å’Œé‡Šæ”¾é”å¸¦æ¥çš„æ€§èƒ½æ¶ˆè€—**è€Œå¼•å…¥çš„åå‘é”å’Œè½»é‡çº§é”ä»¥åŠå…¶å®ƒå„ç§ä¼˜åŒ–ä¹‹åæ‰§è¡Œæ•ˆç‡æœ‰äº†æ˜¾è‘—æå‡ï¼Œ**å®é™…å¼€å‘ä¸­ä½¿ç”¨ synchronized å…³é”®å­—çš„åœºæ™¯è¿˜æ˜¯æ›´å¤šä¸€äº›**ã€‚\n\n## Lock ä½“ç³»\n\n### Lock ç®€ä»‹\n\n#### Lock æ¥å£æ˜¯ä»€ä¹ˆï¼Ÿå¯¹æ¯”åŒæ­¥å®ƒæœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ\n\nLock æ¥å£æ¯”åŒæ­¥æ–¹æ³•å’ŒåŒæ­¥å—æä¾›äº†æ›´å…·æ‰©å±•æ€§çš„é”æ“ä½œã€‚\n\nï¼ˆ1ï¼‰å¯ä»¥ä½¿é”æ›´**å…¬å¹³**\n\nï¼ˆ2ï¼‰å¯ä»¥ä½¿çº¿ç¨‹åœ¨**ç­‰å¾…é”çš„æ—¶å€™å“åº”ä¸­æ–­**\n\nï¼ˆ3ï¼‰å¯ä»¥**è®©çº¿ç¨‹å°è¯•è·å–é”ï¼Œå¹¶åœ¨æ— æ³•è·å–é”çš„æ—¶å€™ç«‹å³è¿”å›æˆ–è€…ç­‰å¾…ä¸€æ®µæ—¶é—´**\n\n#### ä¹è§‚é”å’Œæ‚²è§‚é”çš„ç†è§£åŠå¦‚ä½•å®ç°ï¼Œæœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ\n\næ‚²è§‚é”ï¼šæ€»æ˜¯å‡è®¾æœ€åçš„æƒ…å†µï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¼šä¿®æ”¹ï¼Œæ‰€ä»¥æ¯æ¬¡åœ¨æ‹¿æ•°æ®çš„æ—¶å€™éƒ½ä¼šä¸Šé”ï¼Œè¿™æ ·åˆ«äººæƒ³æ‹¿è¿™ä¸ªæ•°æ®å°±ä¼šé˜»å¡ç›´åˆ°å®ƒæ‹¿åˆ°é”ã€‚\n\tä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“é‡Œè¾¹å°±ç”¨åˆ°äº†å¾ˆå¤šè¿™ç§é”æœºåˆ¶ï¼Œæ¯”å¦‚è¡Œé”ï¼Œè¡¨é”ç­‰ï¼Œè¯»é”ï¼Œå†™é”ç­‰ï¼Œéƒ½æ˜¯åœ¨åšæ“ä½œä¹‹å‰å…ˆä¸Šé”ã€‚å†æ¯”å¦‚ Java é‡Œé¢çš„åŒæ­¥åŸè¯­ synchronized å…³é”®å­—çš„å®ç°ä¹Ÿæ˜¯æ‚²è§‚é”ã€‚\n\nä¹è§‚é”ï¼šé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¾ˆä¹è§‚ï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¸ä¼šä¿®æ”¹ï¼Œæ‰€ä»¥ä¸ä¼šä¸Šé”ï¼Œä½†æ˜¯åœ¨æ›´æ–°çš„æ—¶å€™ä¼šåˆ¤æ–­ä¸€ä¸‹åœ¨æ­¤æœŸé—´åˆ«äººæœ‰æ²¡æœ‰å»æ›´æ–°è¿™ä¸ªæ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ç‰ˆæœ¬å·ç­‰æœºåˆ¶ã€‚\n\tä¹è§‚é”é€‚ç”¨äºå¤šè¯»çš„åº”ç”¨ç±»å‹ï¼Œè¿™æ ·å¯ä»¥æé«˜ååé‡ï¼Œæ¯”å¦‚ atomic åŒ…ä¸‹é¢çš„åŸå­å˜é‡ç±»å°±æ˜¯ä½¿ç”¨äº†ä¹è§‚é”çš„ä¸€ç§å®ç°æ–¹å¼ CAS å®ç°çš„ã€‚\n\n#### ä»€ä¹ˆæ˜¯ CAS\n\nCAS æ˜¯ compare and swap çš„ç¼©å†™ï¼Œå³æˆ‘ä»¬æ‰€è¯´çš„æ¯”è¾ƒäº¤æ¢ï¼Œæ˜¯ä¸€ç§ä¹è§‚é”æ“ä½œã€‚\n\nCAS æ“ä½œåŒ…å«ä¸‰ä¸ªæ“ä½œæ•° â€”â€” å†…å­˜ä½ç½®ï¼ˆVï¼‰ã€é¢„æœŸåŸå€¼ï¼ˆAï¼‰å’Œæ–°å€¼ï¼ˆBï¼‰ã€‚\n\nå¦‚æœå†…å­˜åœ°å€ V é‡Œé¢çš„å€¼å’Œ A çš„å€¼æ˜¯ä¸€æ ·çš„ï¼Œé‚£ä¹ˆå°±å°†å†…å­˜é‡Œé¢çš„å€¼æ›´æ–°æˆ Bã€‚\n\n####  Javaå®ç°CASçš„åŸç† - Unsafeç±»\n\nåœ¨ Java ä¸­ï¼Œæœ‰ä¸€ä¸ª`Unsafe`ç±»ï¼Œå®ƒåœ¨`sun.misc`åŒ…ä¸­ã€‚å®ƒé‡Œé¢æ˜¯ä¸€äº›`native`æ–¹æ³•ï¼ˆç”±åº•å±‚çš„ JVM ä½¿ç”¨ C æˆ–è€… C++å»å®ç°ï¼‰ï¼Œå…¶ä¸­å°±æœ‰å‡ ä¸ªå…³äº CAS çš„ï¼š\n\n```java\nboolean compareAndSwapObject(Object o, long offset,Object expected, Object x);\nboolean compareAndSwapInt(Object o, long offset,int expected,int x);\nboolean compareAndSwapLong(Object o, long offset,long expected,long x);\n```\n\nå½“ç„¶ï¼Œä»–ä»¬éƒ½æ˜¯`public native`çš„ã€‚\n\nUnsafe ä¸­å¯¹ CAS çš„å®ç°æ˜¯ C++ å†™çš„ï¼Œå®ƒçš„å…·ä½“å®ç°å’Œæ“ä½œç³»ç»Ÿã€CPU éƒ½æœ‰å…³ç³»ã€‚\n\nLinux çš„ X86 ä¸‹ä¸»è¦æ˜¯é€šè¿‡`cmpxchgl`è¿™ä¸ªæŒ‡ä»¤åœ¨ CPU çº§å®Œæˆ CAS æ“ä½œçš„ï¼Œä½†åœ¨å¤šå¤„ç†å™¨æƒ…å†µä¸‹å¿…é¡»ä½¿ç”¨`lock`æŒ‡ä»¤åŠ é”æ¥å®Œæˆã€‚å½“ç„¶ä¸åŒçš„æ“ä½œç³»ç»Ÿå’Œå¤„ç†å™¨çš„å®ç°ä¼šæœ‰æ‰€ä¸åŒï¼Œå¤§å®¶å¯ä»¥è‡ªè¡Œäº†è§£ã€‚\n\nå½“ç„¶ï¼ŒUnsafe ç±»é‡Œé¢è¿˜æœ‰å…¶å®ƒæ–¹æ³•ç”¨äºä¸åŒçš„ç”¨é€”ã€‚æ¯”å¦‚æ”¯æŒçº¿ç¨‹æŒ‚èµ·å’Œæ¢å¤çš„`park`å’Œ`unpark`ï¼Œ LockSupport ç±»åº•å±‚å°±æ˜¯è°ƒç”¨äº†è¿™ä¸¤ä¸ªæ–¹æ³•ã€‚è¿˜æœ‰æ”¯æŒåå°„æ“ä½œçš„`allocateInstance()`æ–¹æ³•ã€‚\n\n#### CAS ä¼šäº§ç”Ÿä»€ä¹ˆé—®é¢˜ï¼Ÿ\n\n1ã€**ABA é—®é¢˜**ï¼š\n\næ¯”å¦‚è¯´ä¸€ä¸ªçº¿ç¨‹ one ä»å†…å­˜ä½ç½® V ä¸­å–å‡º Aï¼Œè¿™æ—¶å€™å¦ä¸€ä¸ªçº¿ç¨‹ two ä¹Ÿä»å†…å­˜ä¸­å–å‡º Aï¼Œå¹¶ä¸” two è¿›è¡Œäº†ä¸€äº›æ“ä½œå˜æˆäº† Bï¼Œç„¶å two åˆå°† V ä½ç½®çš„æ•°æ®å˜æˆ Aï¼Œè¿™æ—¶å€™çº¿ç¨‹ one è¿›è¡Œ CAS æ“ä½œå‘ç°å†…å­˜ä¸­ä»ç„¶æ˜¯ Aï¼Œç„¶å one æ“ä½œæˆåŠŸã€‚å°½ç®¡çº¿ç¨‹ one çš„ CAS æ“ä½œæˆåŠŸï¼Œä½†å¯èƒ½å­˜åœ¨æ½œè—çš„é—®é¢˜ã€‚å¯ä»¥åœ¨å˜é‡ä¸ŠåŠ ä¸€ä¸ªç‰ˆæœ¬æˆ³ã€‚ä» Java1.5 å¼€å§‹ JDK çš„ atomic åŒ…é‡Œæä¾›äº†ä¸€ä¸ªç±» AtomicStampedReference æ¥è§£å†³ ABA é—®é¢˜ã€‚\n\n2ã€**å¾ªç¯æ—¶é—´é•¿å¼€é”€å¤§**ï¼š\n\nå¯¹äºèµ„æºç«äº‰ä¸¥é‡ï¼ˆçº¿ç¨‹å†²çªä¸¥é‡ï¼‰çš„æƒ…å†µï¼ŒCAS è‡ªæ—‹çš„æ¦‚ç‡ä¼šæ¯”è¾ƒå¤§ï¼Œä»è€Œæµªè´¹æ›´å¤šçš„ CPU èµ„æºï¼Œæ•ˆç‡ä½äº synchronizedã€‚\n\n3ã€**åªèƒ½ä¿è¯ä¸€ä¸ªå…±äº«å˜é‡çš„åŸå­æ“ä½œ**ï¼š\n\nå½“å¯¹ä¸€ä¸ªå…±äº«å˜é‡æ‰§è¡Œæ“ä½œæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¾ªç¯ CAS çš„æ–¹å¼æ¥ä¿è¯åŸå­æ“ä½œï¼Œä½†æ˜¯**å¯¹å¤šä¸ªå…±äº«å˜é‡æ“ä½œæ—¶ï¼Œå¾ªç¯ CAS å°±æ— æ³•ä¿è¯æ“ä½œçš„åŸå­æ€§ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ç”¨é”**ã€‚\n\n#### æ­»é”ä¸æ´»é”çš„åŒºåˆ«ï¼Œæ­»é”ä¸é¥¥é¥¿çš„åŒºåˆ«ï¼Ÿ\n\n> åŒºåˆ«ï¼šæ­»é”åŠ¨ä¸äº†äº†ï¼›æ´»é”ä¸€ç›´é‡å¤å°è¯•ã€å¤±è´¥ã€å°è¯•ã€å¤±è´¥ã€‚\n\næ­»é”ï¼šæ˜¯æŒ‡ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„è¿›ç¨‹ï¼ˆæˆ–çº¿ç¨‹ï¼‰åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå› äº‰å¤ºèµ„æºè€Œé€ æˆçš„ä¸€ç§äº’ç›¸ç­‰å¾…çš„ç°è±¡ï¼Œè‹¥æ— å¤–åŠ›ä½œç”¨ï¼Œå®ƒä»¬éƒ½å°†æ— æ³•æ¨è¿›ä¸‹å»ã€‚\n\næ´»é”ï¼šä»»åŠ¡æˆ–è€…æ‰§è¡Œè€…æ²¡æœ‰è¢«é˜»å¡ï¼Œç”±äºæŸäº›æ¡ä»¶æ²¡æœ‰æ»¡è¶³ï¼Œå¯¼è‡´**ä¸€ç›´é‡å¤å°è¯•ï¼Œå¤±è´¥ï¼Œå°è¯•ï¼Œå¤±è´¥**ã€‚\n\næ´»é”å’Œæ­»é”çš„åŒºåˆ«åœ¨äºï¼Œå¤„äºæ´»é”çš„å®ä½“æ˜¯åœ¨ä¸æ–­çš„æ”¹å˜çŠ¶æ€ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„â€œæ´»â€ï¼Œ è€Œå¤„äºæ­»é”çš„å®ä½“è¡¨ç°ä¸ºç­‰å¾…ï¼›æ´»é”æœ‰å¯èƒ½è‡ªè¡Œè§£å¼€ï¼Œæ­»é”åˆ™ä¸èƒ½ã€‚\n\né¥¥é¥¿ï¼šä¸€ä¸ªæˆ–è€…å¤šä¸ªçº¿ç¨‹å› ä¸ºç§ç§åŸå› æ— æ³•è·å¾—æ‰€éœ€è¦çš„èµ„æºï¼Œå¯¼è‡´ä¸€ç›´æ— æ³•æ‰§è¡Œçš„çŠ¶æ€ã€‚\n\nJava ä¸­å¯¼è‡´é¥¥é¥¿çš„åŸå› ï¼šé«˜ä¼˜å…ˆçº§çº¿ç¨‹åå™¬æ‰€æœ‰çš„ä½ä¼˜å…ˆçº§çº¿ç¨‹çš„ CPU æ—¶é—´ã€‚\n\n### AQSè¯¦è§£\n\n#### AQS ä»‹ç»\n\nAQS çš„å…¨ç§°ä¸ºï¼ˆAbstractQueuedSynchronizerï¼‰ï¼ŒæŠ½è±¡é˜Ÿåˆ—åŒæ­¥å™¨ã€‚\n\nä½¿ç”¨ AQS èƒ½ç®€å•ä¸”é«˜æ•ˆåœ°æ„é€ å‡ºåº”ç”¨å¹¿æ³›çš„å¤§é‡çš„åŒæ­¥å™¨ï¼Œæ¯”å¦‚æˆ‘ä»¬æåˆ°çš„ ReentrantLockï¼ŒSemaphoreï¼Œå…¶ä»–çš„è¯¸å¦‚ ReentrantReadWriteLockï¼ŒSynchronousQueueï¼ŒFutureTask ç­‰ç­‰çš†æ˜¯åŸºäº AQS çš„ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬è‡ªå·±ä¹Ÿèƒ½åˆ©ç”¨ AQS éå¸¸è½»æ¾å®¹æ˜“åœ°æ„é€ å‡ºç¬¦åˆæˆ‘ä»¬è‡ªå·±éœ€æ±‚çš„åŒæ­¥å™¨ã€‚\n\n#### AQS åŸç†åˆ†æ\n\n**å¦‚æœè¢«è¯·æ±‚çš„å…±äº«èµ„æºç©ºé—²ï¼Œåˆ™å°†å½“å‰è¯·æ±‚èµ„æºçš„çº¿ç¨‹è®¾ç½®ä¸ºæœ‰æ•ˆçš„å·¥ä½œçº¿ç¨‹ï¼Œå¹¶ä¸”å°†å…±äº«èµ„æºè®¾ç½®ä¸ºé”å®šçŠ¶æ€ã€‚\nå¦‚æœè¢«è¯·æ±‚çš„å…±äº«èµ„æºè¢«å ç”¨ï¼Œé‚£ä¹ˆå°±ä½¿ç”¨ CLH é˜Ÿåˆ—ï¼Œå°†æš‚æ—¶è·å–ä¸åˆ°é”çš„çº¿ç¨‹åŠ å…¥åˆ°é˜Ÿåˆ—ä¸­ã€‚**\n\n> CLH(Craig,Landin,and Hagersten)é˜Ÿåˆ—æ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„åŒå‘é˜Ÿåˆ—ï¼ˆè™šæ‹Ÿçš„åŒå‘é˜Ÿåˆ—å³ä¸å­˜åœ¨é˜Ÿåˆ—å®ä¾‹ï¼Œä»…å­˜åœ¨ç»“ç‚¹ä¹‹é—´çš„å…³è”å…³ç³»ï¼‰ã€‚AQS æ˜¯å°†æ¯æ¡è¯·æ±‚å…±äº«èµ„æºçš„çº¿ç¨‹å°è£…æˆä¸€ä¸ª CLH é˜Ÿåˆ—çš„ä¸€ä¸ªç»“ç‚¹ï¼ˆNodeï¼‰æ¥å®ç°é”çš„åˆ†é…ã€‚\n\nçœ‹ä¸ª AQS(AbstractQueuedSynchronizer)åŸç†å›¾ï¼š\n\n![AQSåŸç†å›¾](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes11474088-c906e727d699fa9c.png)\n\nAQS ä½¿ç”¨ä¸€ä¸ª volatile int ç±»å‹çš„æˆå‘˜å˜é‡ state æ¥è¡¨ç¤ºåŒæ­¥çŠ¶æ€ï¼Œé€šè¿‡å†…ç½®çš„ CLH é˜Ÿåˆ—æ¥å®Œæˆè·å–èµ„æºçº¿ç¨‹çš„æ’é˜Ÿå·¥ä½œã€‚AQS ä½¿ç”¨ CAS å¯¹è¯¥åŒæ­¥çŠ¶æ€è¿›è¡ŒåŸå­æ“ä½œå®ç°å¯¹å…¶å€¼çš„ä¿®æ”¹ã€‚\n\n```java\nprivate volatile int state;\t// å…±äº«å˜é‡ï¼Œä½¿ç”¨volatileä¿®é¥°ä¿è¯çº¿ç¨‹å¯è§æ€§\n```\n\nçŠ¶æ€ä¿¡æ¯é€šè¿‡ protected ç±»å‹çš„ getStateï¼ŒsetStateï¼ŒcompareAndSetState è¿›è¡Œæ“ä½œ\n\n```java\n// è¿”å›åŒæ­¥çŠ¶æ€çš„å½“å‰å€¼\nprotected final int getState() {  \n    return state;\n}\n// è®¾ç½®åŒæ­¥çŠ¶æ€çš„å€¼\nprotected final void setState(int newState) { \n    state = newState;\n}\n// åŸå­åœ°ï¼ˆCASæ“ä½œï¼‰å°†åŒæ­¥çŠ¶æ€å€¼è®¾ç½®ä¸ºç»™å®šå€¼updateå¦‚æœå½“å‰åŒæ­¥çŠ¶æ€çš„å€¼ç­‰äºexpectï¼ˆæœŸæœ›å€¼ï¼‰\nprotected final boolean compareAndSetState(int expect, int update) {\n    return unsafe.compareAndSwapInt(this, stateOffset, expect, update);\n}\n```\n\n**AQS å¯¹èµ„æºçš„å…±äº«æ–¹å¼**\n\nAQS å®šä¹‰ä¸¤ç§èµ„æºå…±äº«æ–¹å¼\n\n- **Exclusive**ï¼ˆç‹¬å ï¼‰ï¼šåªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æ‰§è¡Œï¼Œå¦‚ ReentrantLockã€‚åˆå¯åˆ†ä¸ºå…¬å¹³é”å’Œéå…¬å¹³é”ï¼š\n\t- å…¬å¹³é”ï¼šæŒ‰ç…§çº¿ç¨‹åœ¨é˜Ÿåˆ—ä¸­çš„æ’é˜Ÿé¡ºåºï¼Œå…ˆåˆ°è€…å…ˆæ‹¿åˆ°é”\n\t- éå…¬å¹³é”ï¼šå½“çº¿ç¨‹è¦è·å–é”æ—¶ï¼Œæ— è§†é˜Ÿåˆ—é¡ºåºç›´æ¥å»æŠ¢é”ï¼Œè°æŠ¢åˆ°å°±æ˜¯è°çš„\n- **Share**ï¼ˆå…±äº«ï¼‰ï¼šå¤šä¸ªçº¿ç¨‹å¯åŒæ—¶æ‰§è¡Œï¼Œå¦‚ Semaphore/CountDownLatchã€‚Semaphoreã€CountDownLatchã€ CyclicBarrierã€ReadWriteLock æˆ‘ä»¬éƒ½ä¼šåœ¨åé¢è®²åˆ°ã€‚\n\n**AQSåº•å±‚ä½¿ç”¨äº†æ¨¡æ¿æ–¹æ³•æ¨¡å¼**\n\nåŒæ­¥å™¨çš„è®¾è®¡æ˜¯åŸºäºæ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„ï¼Œå¦‚æœéœ€è¦è‡ªå®šä¹‰åŒæ­¥å™¨ï¼ˆ**æ¨¡æ¿æ–¹æ³•æ¨¡å¼**å¾ˆç»å…¸çš„ä¸€ä¸ªåº”ç”¨ï¼‰ï¼š\n\n1. ä½¿ç”¨è€…ç»§æ‰¿ AQS å¹¶é‡å†™æŒ‡å®šçš„æ–¹æ³•ã€‚ï¼ˆå¯¹å…±äº«èµ„æº state çš„è·å–å’Œé‡Šæ”¾ï¼‰\n2. è°ƒç”¨ AQS çš„æ¨¡æ¿æ–¹æ³•ï¼Œä¼šè¿›ä¸€æ­¥è°ƒç”¨ä½¿ç”¨è€…é‡å†™çš„æ–¹æ³•ã€‚\n\n**AQSä½¿ç”¨äº†æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼Œè‡ªå®šä¹‰åŒæ­¥å™¨æ—¶éœ€è¦é‡å†™ä¸‹é¢å‡ ä¸ªAQSæä¾›çš„æ¨¡æ¿æ–¹æ³•ï¼š**\n\n```java\nisHeldExclusively()\t// è¯¥çº¿ç¨‹æ˜¯å¦æ­£åœ¨ç‹¬å èµ„æºã€‚åªæœ‰ç”¨åˆ°conditionæ‰éœ€è¦å»å®ç°å®ƒã€‚\ntryAcquire(int)\t// ç‹¬å æ–¹å¼ã€‚å°è¯•è·å–èµ„æºï¼ŒæˆåŠŸåˆ™è¿”å›trueï¼Œå¤±è´¥åˆ™è¿”å›falseã€‚\ntryRelease(int)\t// ç‹¬å æ–¹å¼ã€‚å°è¯•é‡Šæ”¾èµ„æºï¼ŒæˆåŠŸåˆ™è¿”å›trueï¼Œå¤±è´¥åˆ™è¿”å›falseã€‚\ntryAcquireShared(int)\t// å…±äº«æ–¹å¼ã€‚å°è¯•è·å–èµ„æºã€‚è´Ÿæ•°è¡¨ç¤ºå¤±è´¥ï¼›0è¡¨ç¤ºæˆåŠŸï¼Œä½†æ²¡æœ‰å‰©ä½™å¯ç”¨èµ„æºï¼›æ­£æ•°è¡¨ç¤ºæˆåŠŸï¼Œä¸”æœ‰å‰©ä½™èµ„æºã€‚\ntryReleaseShared(int)\t// å…±äº«æ–¹å¼ã€‚å°è¯•é‡Šæ”¾èµ„æºï¼ŒæˆåŠŸåˆ™è¿”å›trueï¼Œå¤±è´¥åˆ™è¿”å›falseã€‚\n```\n\nä»¥ ReentrantLock ä¸ºä¾‹ï¼Œstate åˆå§‹åŒ–ä¸º 0ï¼Œè¡¨ç¤ºæœªé”å®šçŠ¶æ€ã€‚A çº¿ç¨‹ lock() æ—¶ï¼Œä¼šè°ƒç”¨ tryAcquire() ç‹¬å è¯¥é”å¹¶å°† state+1ã€‚æ­¤åï¼Œå…¶ä»–çº¿ç¨‹å† tryAcquire() æ—¶å°±ä¼šå¤±è´¥ï¼Œç›´åˆ° A çº¿ç¨‹ unlock( )åˆ° state=0ï¼ˆå³é‡Šæ”¾é”ï¼‰ä¸ºæ­¢ï¼Œå…¶å®ƒçº¿ç¨‹æ‰æœ‰æœºä¼šè·å–è¯¥é”ã€‚å½“ç„¶ï¼Œé‡Šæ”¾é”ä¹‹å‰ï¼ŒA çº¿ç¨‹è‡ªå·±æ˜¯å¯ä»¥é‡å¤è·å–æ­¤é”çš„ï¼ˆstate ä¼šç´¯åŠ ï¼‰ï¼Œè¿™å°±æ˜¯å¯é‡å…¥çš„æ¦‚å¿µã€‚\n\nä»¥ CountDownLatch ä»¥ä¾‹ï¼Œä»»åŠ¡åˆ†ä¸º N ä¸ªå­çº¿ç¨‹å»æ‰§è¡Œï¼Œstate ä¹Ÿåˆå§‹åŒ–ä¸º Nï¼ˆæ³¨æ„ N è¦ä¸çº¿ç¨‹ä¸ªæ•°ä¸€è‡´ï¼‰ã€‚è¿™ N ä¸ªå­çº¿ç¨‹æ˜¯å¹¶è¡Œæ‰§è¡Œçš„ï¼Œæ¯ä¸ªå­çº¿ç¨‹æ‰§è¡Œå®Œå countDown() ä¸€æ¬¡ï¼Œstate ä¼š CAS å‡ 1ã€‚ç­‰åˆ°æ‰€æœ‰å­çº¿ç¨‹éƒ½æ‰§è¡Œå®Œåï¼ˆå³ state=0ï¼‰ï¼Œä¼š unpark() ä¸»è°ƒç”¨çº¿ç¨‹ï¼Œç„¶åä¸»è°ƒç”¨çº¿ç¨‹å°±ä¼šä» await() å‡½æ•°è¿”å›ï¼Œç»§ç»­åç»­åŠ¨ä½œã€‚\n\nä¸€èˆ¬æ¥è¯´ï¼Œè‡ªå®šä¹‰åŒæ­¥å™¨è¦ä¹ˆæ˜¯ç‹¬å æ–¹æ³•ï¼Œè¦ä¹ˆæ˜¯å…±äº«æ–¹å¼ï¼Œä»–ä»¬ä¹Ÿåªéœ€å®ç°`tryAcquire-tryRelease`ã€`tryAcquireShared-tryReleaseShared`ä¸­çš„ä¸€ç§å³å¯ã€‚ä½† AQS ä¹Ÿæ”¯æŒè‡ªå®šä¹‰åŒæ­¥å™¨åŒæ—¶å®ç°ç‹¬å å’Œå…±äº«ä¸¤ç§æ–¹å¼ï¼Œå¦‚`ReentrantReadWriteLock`ã€‚\n\n### è¯»å†™é”\n\né¦–å…ˆæ˜ç¡®ä¸€ä¸‹ï¼Œä¸æ˜¯è¯´ ReentrantLock ä¸å¥½ï¼Œåªæ˜¯ ReentrantLock æŸäº›æ—¶å€™æœ‰å±€é™ã€‚å¦‚æœä½¿ç”¨ ReentrantLockï¼Œå¯èƒ½æœ¬èº«æ˜¯ä¸ºäº†é˜²æ­¢çº¿ç¨‹ A åœ¨å†™æ•°æ®ã€çº¿ç¨‹ B åœ¨è¯»æ•°æ®é€ æˆçš„æ•°æ®ä¸ä¸€è‡´ï¼Œä½†è¿™æ ·ï¼Œå¦‚æœçº¿ç¨‹ C åœ¨è¯»æ•°æ®ã€çº¿ç¨‹ D ä¹Ÿåœ¨è¯»æ•°æ®ï¼Œè¯»æ•°æ®æ˜¯ä¸ä¼šæ”¹å˜æ•°æ®çš„ï¼Œæ²¡æœ‰å¿…è¦åŠ é”ï¼Œä½†æ˜¯è¿˜æ˜¯åŠ é”äº†ï¼Œé™ä½äº†ç¨‹åºçš„æ€§èƒ½ã€‚å› ä¸ºè¿™ä¸ªï¼Œæ‰è¯ç”Ÿäº†è¯»å†™é” ReadWriteLockã€‚\n\nReadWriteLock æ˜¯ä¸€ä¸ªè¯»å†™é”æ¥å£ï¼Œè¯»å†™é”æ˜¯ç”¨æ¥æå‡å¹¶å‘ç¨‹åºæ€§èƒ½çš„é”åˆ†ç¦»æŠ€æœ¯ï¼ŒReentrantReadWriteLock æ˜¯ ReadWriteLock æ¥å£çš„ä¸€ä¸ªå…·ä½“å®ç°ï¼Œ**å®ç°äº†è¯»å†™çš„åˆ†ç¦»ï¼Œè¯»é”æ˜¯å…±äº«çš„ï¼Œå†™é”æ˜¯ç‹¬å çš„**ï¼Œè¯»å’Œè¯»ä¹‹é—´ä¸ä¼šäº’æ–¥ï¼Œè¯»å’Œå†™ã€å†™å’Œè¯»ã€å†™å’Œå†™ä¹‹é—´æ‰ä¼šäº’æ–¥ï¼Œæå‡äº†è¯»å†™çš„æ€§èƒ½ã€‚\n\n## å¹¶å‘å®¹å™¨\n\n### ConcurrentHashMap\n\n#### ä»€ä¹ˆæ˜¯ConcurrentHashMapï¼Ÿ\n\nConcurrentHashMap æ˜¯ Java ä¸­çš„ä¸€ä¸ª**çº¿ç¨‹å®‰å…¨ä¸”é«˜æ•ˆçš„HashMapå®ç°**ã€‚\n\né‚£ä¹ˆå®ƒåˆ°åº•æ˜¯å¦‚ä½•å®ç°çº¿ç¨‹å®‰å…¨çš„ï¼Ÿ\n\nJDK 1.6 ç‰ˆæœ¬å…³é”®è¦ç´ ï¼š\n\n- segment ç»§æ‰¿äº† ReentrantLock å……å½“é”çš„è§’è‰²ï¼Œä¸ºæ¯ä¸€ä¸ª segment æä¾›äº†çº¿ç¨‹å®‰å…¨çš„ä¿éšœï¼›\n- segment ç»´æŠ¤äº†å“ˆå¸Œæ•£åˆ—è¡¨çš„è‹¥å¹²ä¸ªæ¡¶ï¼Œæ¯ä¸ªæ¡¶ç”± HashEntry æ„æˆçš„é“¾è¡¨ã€‚\n\nJDK1.8 åï¼ŒConcurrentHashMap æŠ›å¼ƒäº†åŸæœ‰çš„ Segment åˆ†æ®µé”ï¼Œè€Œ**é‡‡ç”¨äº† CAS + synchronized æ¥ä¿è¯å¹¶å‘å®‰å…¨æ€§**ã€‚\n\næ’å…¥å…ƒç´ è¿‡ç¨‹ï¼š\n\nå¦‚æœç›¸åº”ä½ç½®çš„ Node è¿˜æ²¡æœ‰åˆå§‹åŒ–ï¼Œåˆ™è°ƒç”¨ CAS æ’å…¥ç›¸åº”çš„æ•°æ®ï¼›\n\nå¦‚æœç›¸åº”ä½ç½®çš„ Node ä¸ä¸ºç©ºï¼Œåˆ™å¯¹è¯¥èŠ‚ç‚¹åŠ  synchronized é”è¿›è¡Œæ’å…¥æˆ–æ›´æ–°æ“ä½œã€‚\n\n### CopyOnWriteArrayList\n\nCopyOnWrite å®¹å™¨å³**å†™æ—¶å¤åˆ¶çš„å®¹å™¨**ï¼Œå½“æˆ‘ä»¬å¾€ä¸€ä¸ªå®¹å™¨ä¸­æ·»åŠ å…ƒç´ çš„æ—¶å€™ï¼Œä¸ç›´æ¥å¾€å®¹å™¨ä¸­æ·»åŠ ï¼Œè€Œæ˜¯å°†å½“å‰å®¹å™¨è¿›è¡Œ copyï¼Œå¤åˆ¶å‡ºæ¥ä¸€ä¸ªæ–°çš„å®¹å™¨ï¼Œç„¶åå‘æ–°å®¹å™¨ä¸­æ·»åŠ æˆ‘ä»¬éœ€è¦çš„å…ƒç´ ï¼Œæœ€åå°†åŸå®¹å™¨çš„å¼•ç”¨æŒ‡å‘æ–°å®¹å™¨ã€‚\n\n**CopyOnWriteArrayList çš„ä½¿ç”¨åœºæ™¯**\n\né€šè¿‡æºç åˆ†æï¼Œæˆ‘ä»¬çœ‹å‡ºå®ƒçš„ä¼˜ç¼ºç‚¹æ¯”è¾ƒæ˜æ˜¾ï¼Œæ‰€ä»¥ä½¿ç”¨åœºæ™¯ä¹Ÿå°±æ¯”è¾ƒæ˜æ˜¾ã€‚å°±æ˜¯åˆé€‚è¯»å¤šå†™å°‘çš„åœºæ™¯ã€‚\n\n**CopyOnWriteArrayList çš„ç¼ºç‚¹**\n\n1. ç”±äºå†™æ“ä½œçš„æ—¶å€™ï¼Œéœ€è¦æ‹·è´æ•°ç»„ï¼Œä¼šæ¶ˆè€—å†…å­˜ï¼Œå¦‚æœåŸæ•°ç»„çš„å†…å®¹æ¯”è¾ƒå¤šçš„æƒ…å†µä¸‹ï¼Œå¯èƒ½å¯¼è‡´ young gc æˆ–è€… full gcã€‚\n2. **ä¸èƒ½ç”¨äºå®æ—¶è¯»çš„åœºæ™¯**ï¼Œåƒæ‹·è´æ•°ç»„ã€æ–°å¢å…ƒç´ éƒ½éœ€è¦æ—¶é—´ï¼Œæ‰€ä»¥è°ƒç”¨ä¸€ä¸ª set æ“ä½œåï¼Œ**è¯»å–åˆ°æ•°æ®å¯èƒ½è¿˜æ˜¯æ—§çš„**ï¼Œè™½ç„¶ CopyOnWriteArrayList èƒ½åšåˆ°æœ€ç»ˆä¸€è‡´æ€§,ä½†æ˜¯è¿˜æ˜¯æ²¡æ³•æ»¡è¶³å®æ—¶æ€§è¦æ±‚ã€‚\n\n### ThreadLocal\n\n#### ThreadLocalçš„æ•°æ®ç»“æ„\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesthreadlocal%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84.a0bfadf8.png\" alt=\"ThreadLocalæ•°æ®ç»“æ„\" style=\"zoom: 67%;\" />\n\næ¯ä¸ªçº¿ç¨‹ Thread ä¸­æœ‰ä¸€ä¸ªç±»å‹ä¸º ThreadLocal.ThreadLocalMap çš„å®ä¾‹å˜é‡ threadLocalsï¼Œè¯¥å®ä¾‹å˜é‡ä¸­æ¯ä¸ª entry ä¸º <threadLocal çš„å¼±å¼•ç”¨ï¼Œvalue ä¸ºå¼ºå¼•ç”¨> çš„æ˜ å°„ï¼Œæ¯ä¸ªçº¿ç¨‹å¾€ threadLocal ä¸­å¯¹ value è¿›è¡Œæ“ä½œæ—¶ï¼Œéƒ½æ˜¯åœ¨è‡ªå·±çº¿ç¨‹ç§æœ‰çš„ threadLocalMap ä¸­è¿›è¡Œæ“ä½œï¼Œä»è€Œè¾¾åˆ°çº¿ç¨‹éš”ç¦»ã€‚\n\n```java\npublic class ThreadLocalDemo {\n    // private static final ThreadLocal<Integer> threadLocal = new ThreadLocal<Integer>(){\n    //     @Override\n    //     protected Integer initialValue() {\n    //         return 0;\n    //     }\n    // };\n\n    private static final ThreadLocal<Integer> threadLocal = ThreadLocal.withInitial(() -> 0);\n\n    public static void main(String[] args) {\n        for (int i = 0; i < 2; i++) {\n            new Thread(() -> {\n                for (int j = 0; j < 5; j++) {\n                    Integer val = threadLocal.get();\n                    threadLocal.set(++val);\n                    System.out.println(Thread.currentThread().getName() + \" ---- \" + val);\n                }\n            }, \"Thread-\" + i).start();\n        }\n\n        try {\n            Thread.sleep(10);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n\n        System.out.println(Thread.currentThread().getName() + \" ---- \" + threadLocal.get());\n    }\n}\n```\n\næ‰“å°ç»“æœï¼šå¯åŠ¨äº† 2 ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹æœ€åéƒ½æ‰“å°åˆ° 5ï¼Œ æœ€å threadLocal.get ä»ç„¶æ˜¯ 0\n\n```java\nThread-1 ---- 1\nThread-0 ---- 1\nThread-1 ---- 2\nThread-0 ---- 2\nThread-1 ---- 3\nThread-1 ---- 4\nThread-1 ---- 5\nThread-0 ---- 3\nThread-0 ---- 4\nThread-0 ---- 5\nmain ---- 0\n```\n\n### ThreadLocalå†…å­˜æ³„æ¼\n\n#### ThreadLocalé€ æˆå†…å­˜æ³„æ¼çš„åŸå› ï¼Ÿ\n\nThreadLocalMap ä¸­ä½¿ç”¨çš„ key ä¸º ThreadLocal çš„å¼±å¼•ç”¨,è€Œ value æ˜¯å¼ºå¼•ç”¨ã€‚æ‰€ä»¥ï¼Œå¦‚æœ ThreadLocal æ²¡æœ‰è¢«å¤–éƒ¨å¼ºå¼•ç”¨çš„æƒ…å†µä¸‹ï¼Œåœ¨åƒåœ¾å›æ”¶çš„æ—¶å€™ï¼Œkey ä¼šè¢«æ¸…ç†æ‰ï¼Œè€Œ value ä¸ä¼šè¢«æ¸…ç†æ‰ã€‚è¿™æ ·ä¸€æ¥ï¼ŒThreadLocalMap ä¸­å°±ä¼šå‡ºç° key ä¸º null çš„ Entryã€‚å‡å¦‚æˆ‘ä»¬ä¸åšä»»ä½•æªæ–½çš„è¯ï¼Œvalue æ°¸è¿œæ— æ³•è¢« GC å›æ”¶ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯èƒ½ä¼šäº§ç”Ÿå†…å­˜æ³„éœ²ã€‚ThreadLocalMap å®ç°ä¸­å·²ç»è€ƒè™‘äº†è¿™ç§æƒ…å†µï¼Œæ¯æ¬¡ä½¿ç”¨å®Œ ThreadLocal åï¼Œéƒ½è°ƒç”¨å®ƒçš„ remove()æ–¹æ³•ï¼Œæ¸…ç†æ‰ key ä¸º null çš„è®°å½•ã€‚\n\n### BlockingQueue\n\né˜»å¡é˜Ÿåˆ—ï¼ˆBlockingQueueï¼‰æ˜¯ä¸€ä¸ªæ”¯æŒä¸¤ä¸ªé™„åŠ æ“ä½œçš„é˜Ÿåˆ—ã€‚\n\nåœ¨é˜Ÿåˆ—ä¸ºç©ºæ—¶ï¼Œè·å–å…ƒç´ çš„çº¿ç¨‹ä¼šç­‰å¾…é˜Ÿåˆ—å˜ä¸ºéç©ºã€‚å½“é˜Ÿåˆ—æ»¡æ—¶ï¼Œå­˜å‚¨å…ƒç´ çš„çº¿ç¨‹ä¼šç­‰å¾…é˜Ÿåˆ—å¯ç”¨ã€‚\n\né˜»å¡é˜Ÿåˆ—å¸¸ç”¨äºç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„åœºæ™¯ï¼Œç”Ÿäº§è€…æ˜¯å¾€é˜Ÿåˆ—é‡Œæ·»åŠ å…ƒç´ çš„çº¿ç¨‹ï¼Œæ¶ˆè´¹è€…æ˜¯ä»é˜Ÿåˆ—é‡Œæ‹¿å…ƒç´ çš„çº¿ç¨‹ã€‚é˜»å¡é˜Ÿåˆ—å°±æ˜¯ç”Ÿäº§è€…å­˜æ”¾å…ƒç´ çš„å®¹å™¨ï¼Œè€Œæ¶ˆè´¹è€…ä¹Ÿåªä»å®¹å™¨é‡Œæ‹¿å…ƒç´ ã€‚\n\nJDK7 æä¾›äº† 7 ä¸ªé˜»å¡é˜Ÿåˆ—ã€‚åˆ†åˆ«æ˜¯ï¼š\n\n> ArrayBlockingQueue ï¼šä¸€ä¸ªç”±æ•°ç»„ç»“æ„ç»„æˆçš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—ã€‚\n> LinkedBlockingQueue ï¼šä¸€ä¸ªç”±é“¾è¡¨ç»“æ„ç»„æˆçš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—ã€‚\n> PriorityBlockingQueue ï¼šä¸€ä¸ªæ”¯æŒä¼˜å…ˆçº§æ’åºçš„æ— ç•Œé˜»å¡é˜Ÿåˆ—ã€‚\n> DelayQueueï¼šä¸€ä¸ªä½¿ç”¨ä¼˜å…ˆçº§é˜Ÿåˆ—å®ç°çš„æ— ç•Œé˜»å¡é˜Ÿåˆ—ã€‚\n> SynchronousQueueï¼šä¸€ä¸ªä¸å­˜å‚¨å…ƒç´ çš„é˜»å¡é˜Ÿåˆ—ã€‚\n> LinkedTransferQueueï¼šä¸€ä¸ªç”±é“¾è¡¨ç»“æ„ç»„æˆçš„æ— ç•Œé˜»å¡é˜Ÿåˆ—ã€‚\n> LinkedBlockingDequeï¼šä¸€ä¸ªç”±é“¾è¡¨ç»“æ„ç»„æˆçš„åŒå‘é˜»å¡é˜Ÿåˆ—ã€‚\n\nJava 5 ä¹‹å‰å®ç°åŒæ­¥å­˜å–æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æ™®é€šçš„ä¸€ä¸ªé›†åˆï¼Œç„¶ååœ¨ä½¿ç”¨çº¿ç¨‹çš„åä½œå’Œçº¿ç¨‹åŒæ­¥å¯ä»¥å®ç°ç”Ÿäº§è€…ï¼Œæ¶ˆè´¹è€…æ¨¡å¼ï¼Œä¸»è¦çš„æŠ€æœ¯å°±æ˜¯ç”¨å¥½ waitï¼Œnotifyï¼ŒnotifyAllï¼Œsynchronized è¿™äº›å…³é”®å­—ã€‚è€Œåœ¨ Java 5 ä¹‹åï¼Œå¯ä»¥ä½¿ç”¨é˜»å¡é˜Ÿåˆ—æ¥å®ç°ï¼Œæ­¤æ–¹å¼å¤§å¤§ç®€å°‘äº†ä»£ç é‡ï¼Œä½¿å¾—å¤šçº¿ç¨‹ç¼–ç¨‹æ›´åŠ å®¹æ˜“ï¼Œå®‰å…¨æ–¹é¢ä¹Ÿæœ‰ä¿éšœã€‚\n\nBlockingQueue æ¥å£æ˜¯ Queue çš„å­æ¥å£ï¼Œå®ƒçš„ä¸»è¦ç”¨é€”å¹¶ä¸æ˜¯ä½œä¸ºå®¹å™¨ï¼Œè€Œæ˜¯ä½œä¸ºçº¿ç¨‹åŒæ­¥çš„çš„å·¥å…·ï¼Œå› æ­¤ä»–å…·æœ‰ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„ç‰¹æ€§ï¼Œ**å½“ç”Ÿäº§è€…çº¿ç¨‹è¯•å›¾å‘ BlockingQueue æ”¾å…¥å…ƒç´ æ—¶ï¼Œå¦‚æœé˜Ÿåˆ—å·²æ»¡ï¼Œåˆ™çº¿ç¨‹è¢«é˜»å¡ï¼Œå½“æ¶ˆè´¹è€…çº¿ç¨‹è¯•å›¾ä»ä¸­å–å‡ºä¸€ä¸ªå…ƒç´ æ—¶ï¼Œå¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™è¯¥çº¿ç¨‹ä¼šè¢«é˜»å¡**ï¼Œæ­£æ˜¯å› ä¸ºå®ƒæ‰€å…·æœ‰è¿™ä¸ªç‰¹æ€§ï¼Œæ‰€ä»¥åœ¨ç¨‹åºä¸­å¤šä¸ªçº¿ç¨‹äº¤æ›¿å‘ BlockingQueue ä¸­æ”¾å…¥å…ƒç´ ï¼Œå–å‡ºå…ƒç´ ï¼Œå®ƒå¯ä»¥å¾ˆå¥½çš„æ§åˆ¶çº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚\n\n## çº¿ç¨‹æ± \n\n### Executors åˆ›å»ºå››ç§å¸¸è§çº¿ç¨‹æ± \n\n#### ä»€ä¹ˆæ˜¯çº¿ç¨‹æ± ï¼Ÿæœ‰å“ªå‡ ç§åˆ›å»ºæ–¹å¼ï¼Ÿ\n\n> æ± åŒ–æŠ€æœ¯çš„æ€æƒ³ä¸»è¦æ˜¯ä¸ºäº†å‡å°‘æ¯æ¬¡è·å–èµ„æºçš„æ¶ˆè€—ï¼Œæé«˜å¯¹èµ„æºçš„åˆ©ç”¨ç‡ã€‚\n\nåœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­ï¼Œåˆ›å»ºå’Œé”€æ¯å¯¹è±¡æ˜¯å¾ˆè´¹æ—¶é—´çš„ï¼Œå› ä¸ºåˆ›å»ºä¸€ä¸ªå¯¹è±¡è¦è·å–å†…å­˜èµ„æºæˆ–è€…å…¶å®ƒæ›´å¤šèµ„æºã€‚åœ¨ Java ä¸­æ›´æ˜¯å¦‚æ­¤ï¼Œè™šæ‹Ÿæœºå°†è¯•å›¾è·Ÿè¸ªæ¯ä¸€ä¸ªå¯¹è±¡ï¼Œä»¥ä¾¿èƒ½å¤Ÿåœ¨å¯¹è±¡é”€æ¯åè¿›è¡Œåƒåœ¾å›æ”¶ã€‚æ‰€ä»¥æé«˜æœåŠ¡ç¨‹åºæ•ˆç‡çš„ä¸€ä¸ªæ‰‹æ®µå°±æ˜¯**å°½å¯èƒ½å‡å°‘åˆ›å»ºå’Œé”€æ¯å¯¹è±¡çš„æ¬¡æ•°**ï¼Œç‰¹åˆ«æ˜¯ä¸€äº›å¾ˆè€—èµ„æºçš„å¯¹è±¡åˆ›å»ºå’Œé”€æ¯ï¼Œè¿™å°±æ˜¯â€æ± åŒ–èµ„æºâ€æŠ€æœ¯äº§ç”Ÿçš„åŸå› ã€‚\n\nçº¿ç¨‹æ± é¡¾åæ€ä¹‰å°±æ˜¯äº‹å…ˆåˆ›å»ºè‹¥å¹²ä¸ªå¯æ‰§è¡Œçš„çº¿ç¨‹æ”¾å…¥ä¸€ä¸ªæ± ï¼ˆå®¹å™¨ï¼‰ä¸­ï¼Œéœ€è¦çš„æ—¶å€™ä»æ± ä¸­è·å–çº¿ç¨‹ä¸ç”¨è‡ªè¡Œåˆ›å»ºï¼Œä½¿ç”¨å®Œæ¯•ä¸éœ€è¦é”€æ¯çº¿ç¨‹è€Œæ˜¯æ”¾å›æ± ä¸­ï¼Œä»è€Œå‡å°‘åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹å¯¹è±¡çš„å¼€é”€ã€‚Java 5+ä¸­çš„ Executor æ¥å£å®šä¹‰ä¸€ä¸ªæ‰§è¡Œçº¿ç¨‹çš„å·¥å…·ã€‚å®ƒçš„å­ç±»å‹å³çº¿ç¨‹æ± æ¥å£æ˜¯ ExecutorServiceã€‚è¦é…ç½®ä¸€ä¸ªçº¿ç¨‹æ± æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼Œå°¤å…¶æ˜¯å¯¹äºçº¿ç¨‹æ± çš„åŸç†ä¸æ˜¯å¾ˆæ¸…æ¥šçš„æƒ…å†µä¸‹ï¼Œå› æ­¤åœ¨å·¥å…·ç±» Executors é¢æä¾›äº†ä¸€äº›é™æ€å·¥å‚æ–¹æ³•ï¼Œç”Ÿæˆä¸€äº›å¸¸ç”¨çš„çº¿ç¨‹æ± ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\n\nï¼ˆ1ï¼‰Executors.newSingleThreadExecutorï¼š`1, 1, new LinkedBlockingQueue`ã€‚æ‰€æœ‰ä»»åŠ¡æŒ‰ç…§**å…ˆæ¥å…ˆæ‰§è¡Œ**çš„é¡ºåºæ‰§è¡Œã€‚å¦‚æœè¿™ä¸ªå”¯ä¸€çš„çº¿ç¨‹ä¸ç©ºé—²ï¼Œé‚£ä¹ˆæ–°æ¥çš„ä»»åŠ¡ä¼šå­˜å‚¨åœ¨ä»»åŠ¡é˜Ÿåˆ—é‡Œç­‰å¾…æ‰§è¡Œã€‚ï¼ˆç”±äºé˜»å¡é˜Ÿåˆ—é»˜è®¤å¤§å°ä¸º Integer.MAX_VALUEï¼Œå› æ­¤å¯èƒ½ OOMï¼‰\n\nï¼ˆ2ï¼‰Executors.newFixedThreadPoolï¼š`nCoreThreads, nCoreThreads, new LinkedBlockingQueue`ï¼Œæ‰€ä»¥åªèƒ½åˆ›å»ºæ ¸å¿ƒçº¿ç¨‹ï¼Œä¸èƒ½åˆ›å»ºéæ ¸å¿ƒçº¿ç¨‹ã€‚å› ä¸º LinkedBlockingQueue çš„é»˜è®¤å¤§å°æ˜¯ Integer.MAX_VALUEï¼Œæ•…å¦‚æœæ ¸å¿ƒçº¿ç¨‹ç©ºé—²ï¼Œåˆ™äº¤ç»™æ ¸å¿ƒçº¿ç¨‹å¤„ç†ï¼›å¦‚æœæ ¸å¿ƒçº¿ç¨‹ä¸ç©ºé—²ï¼Œåˆ™å…¥åˆ—ç­‰å¾…ï¼Œç›´åˆ°æ ¸å¿ƒçº¿ç¨‹ç©ºé—²ã€‚ï¼ˆç”±äºé˜»å¡é˜Ÿåˆ—é»˜è®¤å¤§å°ä¸º Integer.MAX_VALUEï¼Œå› æ­¤å¯èƒ½ OOMï¼‰\n\nï¼ˆ3ï¼‰ Executors.newCachedThreadPoolï¼š`0, Integer.MAX_VALUE`ï¼Œä¸åˆ›å»ºæ ¸å¿ƒçº¿ç¨‹ï¼Œçº¿ç¨‹æ± æœ€å¤§ä¸º Integer.MAX_VALUEã€‚ï¼ˆçº¿ç¨‹æ± å¤ªå¤§å¯¼è‡´ OOMï¼‰\n\nnewCachedThreadPool å’Œ newFixedThreadPool éƒ½å‡ ä¹ä¸ä¼šè§¦å‘æ‹’ç»ç­–ç•¥ï¼Œä½†æ˜¯åŸç†ä¸åŒã€‚\nFixedThreadPool æ˜¯å› ä¸ºé˜»å¡é˜Ÿåˆ—å¯ä»¥å¾ˆå¤§ï¼ˆæœ€å¤§ä¸º Integer æœ€å¤§å€¼ï¼‰ï¼Œæ•…å‡ ä¹ä¸ä¼šè§¦å‘æ‹’ç»ç­–ç•¥ï¼›CachedThreadPool æ˜¯å› ä¸ºçº¿ç¨‹æ± å¾ˆå¤§ï¼ˆæœ€å¤§ä¸º Integer æœ€å¤§å€¼ï¼‰ï¼Œå‡ ä¹ä¸ä¼šå¯¼è‡´çº¿ç¨‹æ•°é‡å¤§äºæœ€å¤§çº¿ç¨‹æ•°ï¼Œæ•…å‡ ä¹ä¸ä¼šè§¦å‘æ‹’ç»ç­–ç•¥ã€‚\n\nï¼ˆ4ï¼‰Executors.newScheduledThreadPoolï¼š`nCoreThreads, Integer.MAX_VALUE`åˆ›å»ºä¸€ä¸ªå¤§å°æ— é™çš„çº¿ç¨‹æ± ã€‚æ­¤çº¿ç¨‹æ± æ”¯æŒå®šæ—¶ä»¥åŠå‘¨æœŸæ€§æ‰§è¡Œä»»åŠ¡çš„éœ€æ±‚ã€‚\n\n#### çº¿ç¨‹æ± æœ‰ä»€ä¹ˆä¼˜ç‚¹ï¼Ÿ\n\n- é™ä½èµ„æºæ¶ˆè€—ï¼šé‡ç”¨å­˜åœ¨çš„çº¿ç¨‹ï¼Œå‡å°‘å¯¹è±¡åˆ›å»ºé”€æ¯çš„å¼€é”€ï¼›\n- æé«˜å“åº”é€Ÿåº¦ï¼šå½“ä»»åŠ¡åˆ°è¾¾æ—¶ï¼Œä»»åŠ¡å¯ä»¥ä¸éœ€è¦çš„ç­‰åˆ°çº¿ç¨‹åˆ›å»ºå°±èƒ½ç«‹å³æ‰§è¡Œï¼›\n- æé«˜çº¿ç¨‹çš„å¯ç®¡ç†æ€§ï¼šä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥è¿›è¡Œç»Ÿä¸€çš„åˆ†é…ï¼Œè°ƒä¼˜å’Œç›‘æ§ã€‚\n\n#### çº¿ç¨‹æ± éƒ½æœ‰å“ªäº›çŠ¶æ€ï¼Ÿ\n\n- RUNNINGï¼šæ¥å—æ–°çš„ä»»åŠ¡æäº¤ï¼Œå¤„ç†ç­‰å¾…é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼›\n- SHUTDOWNï¼šä¸æ¥å—æ–°çš„ä»»åŠ¡æäº¤ï¼Œä½†æ˜¯ä¼šç»§ç»­å¤„ç†ç­‰å¾…é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼›\n- STOPï¼šä¸æ¥å—æ–°çš„ä»»åŠ¡æäº¤ï¼Œä¸å†å¤„ç†ç­‰å¾…é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼Œä¸­æ–­æ­£åœ¨æ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹ï¼›\n- TIDYINGï¼šæ‰€æœ‰çš„ä»»åŠ¡éƒ½é”€æ¯äº†ï¼ŒworkCount ä¸º 0ï¼Œçº¿ç¨‹æ± çš„çŠ¶æ€åœ¨è½¬æ¢ä¸º TIDYING çŠ¶æ€æ—¶ï¼Œä¼šæ‰§è¡Œé’©å­æ–¹æ³• terminated()ï¼›\n- TERMINATEDï¼šterminated()æ–¹æ³•ç»“æŸåï¼Œçº¿ç¨‹æ± çš„çŠ¶æ€å°±ä¼šå˜æˆè¿™ä¸ªã€‚\n\n#### åœ¨ Java ä¸­ Executor å’Œ Executors çš„åŒºåˆ«ï¼Ÿ\n\n- **Executors å·¥å…·ç±»**çš„ä¸åŒæ–¹æ³•æŒ‰ç…§æˆ‘ä»¬çš„éœ€æ±‚**åˆ›å»ºäº†ä¸åŒçš„çº¿ç¨‹æ± **ï¼Œæ¥æ»¡è¶³ä¸šåŠ¡çš„éœ€æ±‚ï¼›\n- **Executor æ¥å£å¯¹è±¡æ‰§è¡Œæˆ‘ä»¬çš„çº¿ç¨‹ä»»åŠ¡**ï¼ŒExecutorService æ¥å£ç»§æ‰¿äº† Executor æ¥å£å¹¶è¿›è¡Œäº†æ‰©å±•ï¼Œæä¾›äº†æ›´å¤šçš„æ–¹æ³•æˆ‘ä»¬èƒ½è·å¾—ä»»åŠ¡æ‰§è¡Œçš„çŠ¶æ€å¹¶ä¸”å¯ä»¥è·å–ä»»åŠ¡çš„è¿”å›å€¼ã€‚\n\n#### çº¿ç¨‹æ± ä¸­ submit() å’Œ execute() æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\næ¥æ”¶å‚æ•°ï¼šsubmit() å¯ä»¥æ‰§è¡Œ Runnable å’Œ Callable ç±»å‹çš„ä»»åŠ¡ï¼Œè€Œ execute()åªèƒ½æ‰§è¡Œ Runnable ç±»å‹çš„ä»»åŠ¡ï¼›\n\nè¿”å›å€¼ï¼šsubmit() æ–¹æ³•å¯ä»¥è¿”å›æŒæœ‰è®¡ç®—ç»“æœçš„ Future å¯¹è±¡ï¼Œè€Œ execute() æ²¡æœ‰ï¼›\n\nå¼‚å¸¸å¤„ç†ï¼šsubmit() æ–¹ä¾¿ Exception å¤„ç†ã€‚\n\n### ThreadPoolExecutor è‡ªå®šä¹‰çº¿ç¨‹æ± \n\n#### Executors\n\nã€Šé˜¿é‡Œå·´å·´ Java å¼€å‘æ‰‹å†Œã€‹ä¸­å¼ºåˆ¶çº¿ç¨‹æ± ä¸å…è®¸ä½¿ç”¨ Executors å»åˆ›å»ºï¼Œè€Œæ˜¯**é€šè¿‡ ThreadPoolExecutor çš„æ–¹å¼**ï¼Œè¿™æ ·çš„å¤„ç†æ–¹å¼è®©å†™çš„åŒå­¦**æ›´åŠ æ˜ç¡®çº¿ç¨‹æ± çš„è¿è¡Œè§„åˆ™ï¼Œè§„é¿èµ„æºè€—å°½çš„é£é™©**\n\nExecutors å„ä¸ªæ–¹æ³•çš„å¼Šç«¯ï¼š\n\n- newSingleThreadExecutor å’Œ newFixedThreadPool :\n\t`0, 0`å’Œ `n, n` ï¼Œä½†æ˜¯ä½¿ç”¨ LinkedBlockingQueueï¼Œæœ€å¤§å¯ä»¥ä¸º Integer.MAX_VALUE\n\n\tä¸»è¦é—®é¢˜æ˜¯å †ç§¯çš„è¯·æ±‚å¤„ç†é˜Ÿåˆ—å¯èƒ½ä¼šè€—è´¹éå¸¸å¤§çš„å†…å­˜ï¼Œç”šè‡³ OOMã€‚\n\n- newCachedThreadPool å’Œ newScheduledThreadPool:\n\t`0, Integer.MAX_VALUE` å’Œ `n, Integer.MAX_VALUE`\n\n\tä¸»è¦é—®é¢˜æ˜¯çº¿ç¨‹æ•°æœ€å¤§æ•°æ˜¯ Integer.MAX_VALUEï¼Œå¯èƒ½ä¼šåˆ›å»ºæ•°é‡éå¸¸å¤šçš„çº¿ç¨‹ï¼Œç”šè‡³ OOM\n\nThreaPoolExecutor åˆ›å»ºçº¿ç¨‹æ± æ–¹å¼åªæœ‰ä¸€ç§ï¼Œå°±æ˜¯èµ°å®ƒçš„æ„é€ å‡½æ•°ï¼Œå‚æ•°è‡ªå·±æŒ‡å®š\n\n#### ThreaPoolExecutor \n\nåˆ›å»ºçº¿ç¨‹æ± çš„æ–¹å¼æœ‰å¤šç§ï¼Œè¿™é‡Œä½ åªéœ€è¦ç­” ThreadPoolExecutor å³å¯ã€‚\n\nThreadPoolExecutor() æ˜¯æœ€åŸå§‹çš„çº¿ç¨‹æ± åˆ›å»ºï¼Œä¹Ÿæ˜¯é˜¿é‡Œå·´å·´ Java å¼€å‘æ‰‹å†Œä¸­æ˜ç¡®è§„èŒƒçš„åˆ›å»ºçº¿ç¨‹æ± çš„æ–¹å¼ã€‚\n\n#### ThreadPoolExecutoræ„é€ å‡½æ•°é‡è¦å‚æ•°åˆ†æ\n\n**`ThreadPoolExecutor`** **3 ä¸ªæœ€é‡è¦çš„å‚æ•°ï¼š**\n\n- **`corePoolSize`** ï¼šæ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œçº¿ç¨‹æ•°å®šä¹‰äº†æœ€å°å¯ä»¥åŒæ—¶è¿è¡Œçš„çº¿ç¨‹æ•°é‡\n- **`maximumPoolSize`** ï¼šçº¿ç¨‹æ± ä¸­å…è®¸å­˜åœ¨çš„å·¥ä½œçº¿ç¨‹çš„æœ€å¤§æ•°é‡\n- **`workQueue`**ï¼šå½“æ–°ä»»åŠ¡æ¥çš„æ—¶å€™ä¼šå…ˆåˆ¤æ–­å½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°é‡æ˜¯å¦è¾¾åˆ°æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œå¦‚æœè¾¾åˆ°çš„è¯ï¼Œä»»åŠ¡å°±ä¼šè¢«å­˜æ”¾åœ¨ç­‰å¾…é˜Ÿåˆ—ä¸­\n\n`ThreadPoolExecutor`å…¶ä»–å¸¸è§å‚æ•°:\n\n1. **`keepAliveTime`**ï¼šéæ ¸å¿ƒçº¿ç¨‹å¦‚æœå¤„äºé—²ç½®çŠ¶æ€è¶…è¿‡è¯¥å€¼ï¼Œå°±ä¼šè¢«é”€æ¯ã€‚\n2. **`unit`** ï¼š`keepAliveTime` é—²ç½®é”€æ¯æ—¶é•¿çš„æ—¶é—´å•ä½\n3. **`threadFactory`**ï¼šä¸ºçº¿ç¨‹æ± æä¾›åˆ›å»ºæ–°çº¿ç¨‹çš„çº¿ç¨‹å·¥å‚\n4. **`handler`** ï¼šçº¿ç¨‹æ± ä»»åŠ¡é˜Ÿåˆ—è¶…è¿‡ maxinumPoolSize ä¹‹åçš„æ‹’ç»ç­–ç•¥\n\n#### ThreadPoolExecutoræ‹’ç»ç­–ç•¥\n\n**`ThreadPoolExecutor`** **æ‹’ç»ç­–ç•¥å®šä¹‰:**\n\nå¦‚æœå½“å‰åŒæ—¶è¿è¡Œçš„çº¿ç¨‹æ•°é‡è¾¾åˆ°æœ€å¤§çº¿ç¨‹æ•°é‡å¹¶ä¸”ç­‰å¾…é˜Ÿåˆ—ä¹Ÿå·²ç»è¢«æ”¾æ»¡æ—¶ï¼Œ`ThreadPoolTaskExecutor` å®šä¹‰ä¸€äº›ç­–ç•¥:\n\n- **`ThreadPoolExecutor.AbortPolicy`**ï¼šæŠ›å‡º `RejectedExecutionException`æ¥æ‹’ç»æ–°ä»»åŠ¡çš„å¤„ç†ã€‚\n- **`ThreadPoolExecutor.CallerRunsPolicy`**ï¼šè°ƒç”¨æ‰§è¡Œè‡ªå·±çš„çº¿ç¨‹è¿è¡Œä»»åŠ¡ã€‚\n- **`ThreadPoolExecutor.DiscardPolicy`**ï¼šä¸å¤„ç†æ–°ä»»åŠ¡ï¼Œç›´æ¥ä¸¢å¼ƒæ‰ã€‚\n- **`ThreadPoolExecutor.DiscardOldestPolicy`**ï¼š æ­¤ç­–ç•¥å°†ä¸¢å¼ƒæœ€æ—©çš„æœªå¤„ç†çš„ä»»åŠ¡è¯·æ±‚ã€‚\n\n#### ä¸€ä¸ªç®€å•çš„çº¿ç¨‹æ± Demo:`Runnable` + `ThreadPoolExecutor`\n\nçº¿ç¨‹æ± å®ç°åŸç†\n\n![çº¿ç¨‹æ± å®ç°åŸç†](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOS8xMS8yNS8xNmVhMDQ3NjEyOTVlNzY2.png)\n\n**æ€»ç»“ä¸€ä¸‹å¤„ç†æµç¨‹**\n\n1. çº¿ç¨‹æ€»æ•°é‡ < corePoolSizeï¼Œæ— è®ºçº¿ç¨‹æ˜¯å¦ç©ºé—²ï¼Œéƒ½ä¼šæ–°å»ºä¸€ä¸ªæ ¸å¿ƒçº¿ç¨‹æ‰§è¡Œä»»åŠ¡ï¼ˆè®©æ ¸å¿ƒçº¿ç¨‹æ•°é‡å¿«é€Ÿè¾¾åˆ° corePoolSizeï¼Œåœ¨æ ¸å¿ƒçº¿ç¨‹æ•°é‡ < corePoolSize æ—¶ï¼‰ã€‚**æ³¨æ„ï¼Œè¿™ä¸€æ­¥éœ€è¦è·å¾—å…¨å±€é”ã€‚**\n2. çº¿ç¨‹æ€»æ•°é‡ >= corePoolSize æ—¶ï¼Œæ–°æ¥çš„çº¿ç¨‹ä»»åŠ¡ä¼šè¿›å…¥ç­‰å¾…é˜Ÿåˆ—ä¸­ç­‰å¾…ï¼Œç„¶åç©ºé—²çš„æ ¸å¿ƒçº¿ç¨‹ä¼šä¾æ¬¡å»ç¼“å­˜é˜Ÿåˆ—ä¸­å–ä»»åŠ¡æ¥æ‰§è¡Œï¼ˆä½“ç°äº†**çº¿ç¨‹å¤ç”¨**ï¼‰ã€‚ \n3. å½“ç­‰å¾…é˜Ÿåˆ—æ»¡äº†ï¼Œè¯´æ˜è¿™ä¸ªæ—¶å€™ä»»åŠ¡å·²ç»å¤šåˆ°çˆ†æ£šï¼Œéœ€è¦ä¸€äº›â€œä¸´æ—¶å·¥â€æ¥æ‰§è¡Œè¿™äº›ä»»åŠ¡äº†ã€‚äºæ˜¯ä¼šåˆ›å»ºéæ ¸å¿ƒçº¿ç¨‹å»æ‰§è¡Œè¿™ä¸ªä»»åŠ¡ã€‚**æ³¨æ„ï¼Œè¿™ä¸€æ­¥éœ€è¦è·å¾—å…¨å±€é”ã€‚**\n4. ç¼“å­˜é˜Ÿåˆ—ä¹‹å‰æ»¡äº†ï¼Œ ç°åœ¨åŠ éæ ¸å¿ƒçº¿ç¨‹ä¸”æ€»çº¿ç¨‹æ•°è¾¾åˆ°äº† maximumPoolSizeï¼Œåˆ™ä¼šé‡‡å–ä¸Šé¢æåˆ°çš„æ‹’ç»ç­–ç•¥è¿›è¡Œå¤„ç†ã€‚\n\næ•´ä¸ªè¿‡ç¨‹å¦‚å›¾æ‰€ç¤ºï¼š\n\nä¸ºäº†è®©å¤§å®¶æ›´æ¸…æ¥šä¸Šé¢çš„é¢è¯•é¢˜ä¸­çš„ä¸€äº›æ¦‚å¿µï¼Œæˆ‘å†™äº†ä¸€ä¸ªç®€å•çš„çº¿ç¨‹æ±  Demoã€‚\n\né¦–å…ˆåˆ›å»ºä¸€ä¸ª `Runnable` æ¥å£çš„å®ç°ç±»ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥æ˜¯ `Callable` æ¥å£ï¼Œæˆ‘ä»¬ä¸Šé¢ä¹Ÿè¯´äº†ä¸¤è€…çš„åŒºåˆ«ã€‚ï¼‰\n\n```java\nimport Java.util.Date;\n\n/**\n * è¿™æ˜¯ä¸€ä¸ªç®€å•çš„Runnableç±»ï¼Œéœ€è¦å¤§çº¦5ç§’é’Ÿæ¥æ‰§è¡Œå…¶ä»»åŠ¡ã€‚\n */\npublic class MyRunnable implements Runnable {\n\n    private String command;\n\n    public MyRunnable(String s) {\n        this.command = s;\n    }\n\n    @Override\n    public void run() {\n        System.out.println(Thread.currentThread().getName() + \" Start. Time = \" + new Date());\n        processCommand();\n        System.out.println(Thread.currentThread().getName() + \" End. Time = \" + new Date());\n    }\n\n    private void processCommand() {\n        try {\n            Thread.sleep(5000);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n    }\n\n    @Override\n    public String toString() {\n        return this.command;\n    }\n}\n```\n\nç¼–å†™æµ‹è¯•ç¨‹åºï¼Œæˆ‘ä»¬è¿™é‡Œä»¥é˜¿é‡Œå·´å·´æ¨èçš„ä½¿ç”¨ `ThreadPoolExecutor` æ„é€ å‡½æ•°è‡ªå®šä¹‰å‚æ•°çš„æ–¹å¼æ¥åˆ›å»ºçº¿ç¨‹æ± ã€‚\n\n```java\nimport Java.util.concurrent.ArrayBlockingQueue;\nimport Java.util.concurrent.ThreadPoolExecutor;\nimport Java.util.concurrent.TimeUnit;\n\npublic class ThreadPoolExecutorDemo {\n\n    private static final int CORE_POOL_SIZE = 5;\n    private static final int MAX_POOL_SIZE = 10;\n    private static final int QUEUE_CAPACITY = 100;\n    private static final Long KEEP_ALIVE_TIME = 1L;\n    public static void main(String[] args) {\n\n        //ä½¿ç”¨é˜¿é‡Œå·´å·´æ¨èçš„åˆ›å»ºçº¿ç¨‹æ± çš„æ–¹å¼\n        //é€šè¿‡ThreadPoolExecutoræ„é€ å‡½æ•°è‡ªå®šä¹‰å‚æ•°åˆ›å»º\n        ThreadPoolExecutor executor = new ThreadPoolExecutor(\n                CORE_POOL_SIZE,\n                MAX_POOL_SIZE,\n                KEEP_ALIVE_TIME,\n                TimeUnit.SECONDS,\n                new ArrayBlockingQueue<>(QUEUE_CAPACITY),\n                new ThreadPoolExecutor.CallerRunsPolicy());\n\n        for (int i = 0; i < 10; i++) {\n            //åˆ›å»ºWorkerThreadå¯¹è±¡ï¼ˆWorkerThreadç±»å®ç°äº†Runnable æ¥å£ï¼‰\n            Runnable worker = new MyRunnable(\"\" + i);\n            //æ‰§è¡ŒRunnable\n            executor.execute(worker);\n        }\n        //ç»ˆæ­¢çº¿ç¨‹æ± \n        executor.shutdown();\n        while (!executor.isTerminated()) {\n        }\n        System.out.println(\"Finished all threads\");\n    }\n}\n```\n\nå¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä¸Šé¢çš„ä»£ç æŒ‡å®šäº†ï¼š\n\n1. `corePoolSize`: æ ¸å¿ƒçº¿ç¨‹æ•°ä¸º 5ã€‚\n2. `maximumPoolSize` ï¼šæœ€å¤§çº¿ç¨‹æ•° 10\n3. `keepAliveTime` : ç­‰å¾…æ—¶é—´ä¸º 1Lã€‚\n4. `unit`: ç­‰å¾…æ—¶é—´çš„å•ä½ä¸º TimeUnit.SECONDSã€‚\n5. `workQueue`ï¼šä»»åŠ¡é˜Ÿåˆ—ä¸º `ArrayBlockingQueue`ï¼Œå¹¶ä¸”å®¹é‡ä¸º 100;\n6. `handler`:é¥±å’Œç­–ç•¥ä¸º `CallerRunsPolicy`ã€‚\n\n**Outputï¼š**\n\n```java\npool-1-thread-2 Start. Time = Tue Nov 12 20:59:44 CST 2019\npool-1-thread-5 Start. Time = Tue Nov 12 20:59:44 CST 2019\npool-1-thread-4 Start. Time = Tue Nov 12 20:59:44 CST 2019\npool-1-thread-1 Start. Time = Tue Nov 12 20:59:44 CST 2019\npool-1-thread-3 Start. Time = Tue Nov 12 20:59:44 CST 2019\npool-1-thread-5 End. Time = Tue Nov 12 20:59:49 CST 2019\npool-1-thread-3 End. Time = Tue Nov 12 20:59:49 CST 2019\npool-1-thread-2 End. Time = Tue Nov 12 20:59:49 CST 2019\npool-1-thread-4 End. Time = Tue Nov 12 20:59:49 CST 2019\npool-1-thread-1 End. Time = Tue Nov 12 20:59:49 CST 2019\npool-1-thread-2 Start. Time = Tue Nov 12 20:59:49 CST 2019\npool-1-thread-1 Start. Time = Tue Nov 12 20:59:49 CST 2019\npool-1-thread-4 Start. Time = Tue Nov 12 20:59:49 CST 2019\npool-1-thread-3 Start. Time = Tue Nov 12 20:59:49 CST 2019\npool-1-thread-5 Start. Time = Tue Nov 12 20:59:49 CST 2019\npool-1-thread-2 End. Time = Tue Nov 12 20:59:54 CST 2019\npool-1-thread-3 End. Time = Tue Nov 12 20:59:54 CST 2019\npool-1-thread-4 End. Time = Tue Nov 12 20:59:54 CST 2019\npool-1-thread-5 End. Time = Tue Nov 12 20:59:54 CST 2019\npool-1-thread-1 End. Time = Tue Nov 12 20:59:54 CST 2019\n```\n\n## å¹¶å‘å·¥å…·\n\n### CountDownLatch ä¸ CyclicBarrier\n\nCountDownLatch ä¸ CyclicBarrier éƒ½æ˜¯ç”¨äºæ§åˆ¶å¹¶å‘çš„å·¥å…·ç±»ï¼Œéƒ½å¯ä»¥ç†è§£æˆç»´æŠ¤çš„å°±æ˜¯ä¸€ä¸ªè®¡æ•°å™¨ï¼Œä½†æ˜¯è¿™ä¸¤è€…è¿˜æ˜¯å„æœ‰ä¸åŒä¾§é‡ç‚¹çš„ï¼š\n\n- CountDownLatch å¼ºè°ƒä¸€ä¸ªçº¿ç¨‹ç­‰å¤šä¸ªçº¿ç¨‹å®ŒæˆæŸä»¶äº‹æƒ…ã€‚CyclicBarrier æ˜¯å¤šä¸ªçº¿ç¨‹äº’ç­‰ï¼Œç­‰å¤§å®¶éƒ½å®Œæˆï¼Œå†æºæ‰‹å…±è¿›ï¼›\n- è°ƒç”¨ CountDownLatch çš„ countDown æ–¹æ³•åï¼Œå½“å‰çº¿ç¨‹å¹¶ä¸ä¼šé˜»å¡ï¼Œä¼šç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼›è€Œè°ƒç”¨ CyclicBarrier çš„ await æ–¹æ³•ï¼Œä¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼Œç›´åˆ° CyclicBarrier æŒ‡å®šçš„çº¿ç¨‹å…¨éƒ¨éƒ½åˆ°è¾¾äº†æŒ‡å®šç‚¹çš„æ—¶å€™ï¼Œæ‰èƒ½ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼›\n- CountDownLatch æ˜¯ä¸èƒ½å¤ç”¨çš„ï¼Œè€Œ CyclicBarrier æ˜¯å¯ä»¥å¤ç”¨çš„ã€‚\n\n### Semaphore\n\n**Semaphore(ä¿¡å·é‡)-å…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®ï¼š** synchronized å’Œ ReentrantLock éƒ½æ˜¯ä¸€æ¬¡åªå…è®¸ä¸€ä¸ªçº¿ç¨‹è®¿é—®æŸä¸ªèµ„æºï¼ŒSemaphore(ä¿¡å·é‡)å¯ä»¥æŒ‡å®šå¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®æŸä¸ªèµ„æºã€‚\n\nSemaphore å°±æ˜¯ä¸€ä¸ªä¿¡å·é‡ï¼Œå®ƒçš„ä½œç”¨æ˜¯é™åˆ¶æŸæ®µä»£ç å—çš„å¹¶å‘æ•°ã€‚Semaphore æœ‰ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå¯ä»¥ä¼ å…¥ä¸€ä¸ª int å‹æ•´æ•° nï¼Œè¡¨ç¤ºæŸæ®µä»£ç æœ€å¤šåªæœ‰ n ä¸ªçº¿ç¨‹å¯ä»¥è®¿é—®ï¼Œå¦‚æœè¶…å‡ºäº† nï¼Œé‚£ä¹ˆè¯·ç­‰å¾…ï¼Œç­‰åˆ°æŸä¸ªçº¿ç¨‹æ‰§è¡Œå®Œæ¯•è¿™æ®µä»£ç å—ï¼Œä¸‹ä¸€ä¸ªçº¿ç¨‹å†è¿›å…¥ã€‚ç”±æ­¤å¯ä»¥çœ‹å‡ºå¦‚æœ Semaphore æ„é€ å‡½æ•°ä¸­ä¼ å…¥çš„ int å‹æ•´æ•° n=1ï¼Œç›¸å½“äºå˜æˆäº†ä¸€ä¸ª synchronized äº†ã€‚\n\n## æ¨¡æ‹Ÿ\n\n### æ­»é”\n\n```java\npublic class DeadLock {\n    private static Object A = new Object();\n    private static Object B = new Object();\n\n    public static void main(String[] args) {\n        new Thread(() -> {\n            synchronized (A) {\n                System.out.println(Thread.currentThread().getName() + \" å·²è·å¾—èµ„æºA\");\n                try {\n                    Thread.sleep(1000);\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n                System.out.println(Thread.currentThread().getName() + \" ç­‰å¾…è·å¾—èµ„æºB\");\n                synchronized (B) {\n                    System.out.println(Thread.currentThread().getName() + \" å·²è·å¾—èµ„æºB\");\n                }\n            }\n        }, \"çº¿ç¨‹1\").start();\n\n        new Thread(() -> {\n            synchronized (B) {\n                System.out.println(Thread.currentThread().getName() + \" å·²è·å¾—èµ„æºB\");\n                try {\n                    Thread.sleep(1000);\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n                System.out.println(Thread.currentThread().getName() + \" ç­‰å¾…è·å¾—èµ„æºA\");\n                synchronized (A) {\n                    System.out.println(Thread.currentThread().getName() + \" å·²è·å¾—èµ„æºA\");\n                }\n            }\n        }, \"çº¿ç¨‹2\").start();\n    }\n}\n```\n\n> çº¿ç¨‹1 å·²è·å¾—èµ„æºA\n> çº¿ç¨‹2 å·²è·å¾—èµ„æºB\n> çº¿ç¨‹1 ç­‰å¾…è·å¾—èµ„æºB\n> çº¿ç¨‹2 ç­‰å¾…è·å¾—èµ„æºA\n\n### runæ–¹æ³•å’Œstartæ–¹æ³•\n\n```java\npublic class DiffStartRun {\n    public static void main(String[] args) {\n        new Thread(() -> {\n            System.out.println(Thread.currentThread().getName());\n        }, \"çº¿ç¨‹A\").run();\n\n        new Thread(() -> {\n            System.out.println(Thread.currentThread().getName());\n        }, \"çº¿ç¨‹B\").start();\n    }\n}\n```\n\n> main\n> çº¿ç¨‹B\n>\n> new ä¸€ä¸ª Threadï¼Œçº¿ç¨‹è¿›å…¥äº†æ–°å»ºçŠ¶æ€ã€‚è°ƒç”¨ `start()`æ–¹æ³•ï¼Œä¼šå¯åŠ¨ä¸€ä¸ªçº¿ç¨‹å¹¶ä½¿çº¿ç¨‹è¿›å…¥äº†å°±ç»ªçŠ¶æ€ï¼Œå½“åˆ†é…åˆ°æ—¶é—´ç‰‡åå°±å¯ä»¥å¼€å§‹è¿è¡Œäº†ã€‚ `start()` ä¼šæ‰§è¡Œçº¿ç¨‹çš„ç›¸åº”å‡†å¤‡å·¥ä½œï¼Œç„¶åè‡ªåŠ¨æ‰§è¡Œ `run()` æ–¹æ³•çš„å†…å®¹ï¼Œè¿™æ˜¯çœŸæ­£çš„å¤šçº¿ç¨‹å·¥ä½œã€‚ ä½†æ˜¯ï¼Œç›´æ¥æ‰§è¡Œ `run()` æ–¹æ³•ï¼Œä¼šæŠŠ `run()` æ–¹æ³•å½“æˆä¸€ä¸ª main çº¿ç¨‹ä¸‹çš„æ™®é€šæ–¹æ³•å»æ‰§è¡Œï¼Œå¹¶ä¸ä¼šåœ¨æŸä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œå®ƒï¼Œç¬¬ä¸€ä¸ªæ‰€è°“çš„çº¿ç¨‹Aåªæ˜¯ main çº¿ç¨‹çš„ä¸€ä¸ªæ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´å…¶æ‰€åœ¨çº¿ç¨‹è¿˜æ˜¯ main çº¿ç¨‹ï¼Œæ‰€ä»¥è¿™å¹¶ä¸æ˜¯å¤šçº¿ç¨‹å·¥ä½œã€‚\n>\n> **æ€»ç»“ï¼š è°ƒç”¨ start() æ–¹æ³•æ–¹å¯å¯åŠ¨çº¿ç¨‹å¹¶ä½¿çº¿ç¨‹è¿›å…¥å°±ç»ªçŠ¶æ€ï¼Œç›´æ¥æ‰§è¡Œ run() æ–¹æ³•çš„è¯ä¸ä¼šä»¥å¤šçº¿ç¨‹çš„æ–¹å¼æ‰§è¡Œã€‚**\n\n### ä¸¤ä¸ªçº¿ç¨‹ï¼Œäº¤æ›¿åŠ å‡\n\n1. synchronized\n\n\t```java\n\t/**\n\t * @author fangyaxing\n\t * @date 2022/9/12\n\t */\n\tpublic class TwoThreadWithSync {\n\t    private static int value = 0;\n\t\n\t    private static final Object lock = new Object();\n\t\n\t    public static void main(String[] args) {\n\t        new Thread(() -> {\n\t            for (int i = 0; i < 5; i++) {\n\t                synchronized (lock) {\n\t                    while (value != 0) {\n\t                        try {\n\t                            lock.wait();\n\t                        } catch (InterruptedException e) {\n\t                            e.printStackTrace();\n\t                        }\n\t                    }\n\t                    value++;\n\t                    System.out.println(Thread.currentThread().getName() + \" ---- \" + value);\n\t                    lock.notifyAll();\n\t                }\n\t            }\n\t        }, \"Thread-A\").start();\n\t\n\t        new Thread(() -> {\n\t            for (int i = 0; i < 5; i++) {\n\t                synchronized (lock) {\n\t                    while (value != 1) {\n\t                        try {\n\t                            lock.wait();\n\t                        } catch (InterruptedException e) {\n\t                            e.printStackTrace();\n\t                        }\n\t                    }\n\t                    value--;\n\t                    System.out.println(Thread.currentThread().getName() + \" ---- \" + value);\n\t                    lock.notifyAll();\n\t                }\n\t            }\n\t        }, \"Thread-B\").start();\n\t    }\n\t\n\t}\n\t```\n\n2. lock + condition\n\n\t```java\n\t/**\n\t * @author fangyaxing\n\t * @date 2022/9/12\n\t */\n\tpublic class TwoThreadWithLock {\n\t    private static int value = 0;\n\t\n\t    private static final Lock lock = new ReentrantLock();\n\t\n\t    static Condition a = lock.newCondition();\n\t\n\t    static Condition b = lock.newCondition();\n\t\n\t    public static void main(String[] args) {\n\t        new Thread(() -> {\n\t            for (int i = 0; i < 5; i++) {\n\t                try {\n\t                    lock.lock();\n\t                    while (value != 0) {\n\t                        a.await();\n\t                    }\n\t                    value++;\n\t                    System.out.println(Thread.currentThread().getName() + \" ---- \" + value);\n\t                    b.signal();\n\t                } catch (InterruptedException e) {\n\t                    e.printStackTrace();\n\t                } finally {\n\t                    lock.unlock();\n\t                }\n\t            }\n\t        }, \"Thread-A\").start();\n\t\n\t        new Thread(() -> {\n\t            for (int i = 0; i < 5; i++) {\n\t                try {\n\t                    lock.lock();\n\t                    while (value != 1) {\n\t                        b.await();\n\t                    }\n\t                    value--;\n\t                    System.out.println(Thread.currentThread().getName() + \" ---- \" + value);\n\t                    a.signal();\n\t                } catch (InterruptedException e) {\n\t                    e.printStackTrace();\n\t                } finally {\n\t                    lock.unlock();\n\t                }\n\t            }\n\t        }, \"Thread-B\").start();\n\t    }\n\t}\n\t```\n\n### ä¸‰ä¸ªçº¿ç¨‹ï¼Œå¾ªç¯æ‰“å°\n\n```java\npublic class Demo5 {\n    private int value = 0;\n    private Lock lock = new ReentrantLock();\n    private Condition a = lock.newCondition();\n    private Condition b = lock.newCondition();\n    private Condition c = lock.newCondition();\n\n    public void outputA(int round) {\n        try {\n            lock.lock();\n            while (value != 0) {\n                a.await();\n            }\n            value = 1;\n            System.out.println(\"ç¬¬\" + round + \"è½®ï¼Œ\" + Thread.currentThread().getName() + \"è¾“å‡ºA\");\n            b.signal();\n        } catch (Exception e) {\n            e.printStackTrace();\n        } finally {\n            lock.unlock();\n        }\n    }\n\n    public void outputB(int round) {\n        try {\n            lock.lock();\n            while (value != 1) {\n                b.await();\n            }\n            value = 2;\n            System.out.println(\"ç¬¬\" + round + \"è½®ï¼Œ\" + Thread.currentThread().getName() + \"è¾“å‡ºB\");\n            c.signal();\n        } catch (Exception e) {\n            e.printStackTrace();\n        } finally {\n            lock.unlock();\n        }\n    }\n\n    public void outputC(int round) {\n        try {\n            lock.lock();\n            while (value != 2) {\n                c.await();\n            }\n            value = 0;\n            System.out.println(\"ç¬¬\" + round + \"è½®ï¼Œ\" + Thread.currentThread().getName() + \"è¾“å‡ºC\");\n            a.signal();\n        } catch (Exception e) {\n            e.printStackTrace();\n        } finally {\n            lock.unlock();\n        }\n    }\n\n    public static void main(String[] args) {\n        Demo5 s = new Demo5();\n\n        new Thread(() -> {\n            for (int i = 0; i < 3; i++) {\n                s.outputA(i);\n            }\n        }, \"Thread-A\").start();\n\n        new Thread(() -> {\n            for (int i = 0; i < 3; i++) {\n                s.outputB(i);\n            }\n        }, \"Thread-B\").start();\n\n        new Thread(() -> {\n            for (int i = 0; i < 3; i++) {\n                s.outputC(i);\n            }\n        }, \"Thread-C\").start();\n\n    }\n}\n```\n","slug":"Javaå…«è‚¡æ–‡ - Javaå¹¶å‘","published":1,"updated":"2023-01-26T12:35:58.973Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cldzfw31y000at9t8hzfmcqld","content":"<blockquote>\n<p>æ•´ç†çš„Javaå¹¶å‘ç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½\t<span id=\"more\"></span></p>\n</blockquote>\n<h2 id=\"åŸºç¡€çŸ¥è¯†\"><a href=\"#åŸºç¡€çŸ¥è¯†\" class=\"headerlink\" title=\"åŸºç¡€çŸ¥è¯†\"></a>åŸºç¡€çŸ¥è¯†</h2><h3 id=\"å¹¶å‘ç¼–ç¨‹çš„ä¼˜ç¼ºç‚¹\"><a href=\"#å¹¶å‘ç¼–ç¨‹çš„ä¼˜ç¼ºç‚¹\" class=\"headerlink\" title=\"å¹¶å‘ç¼–ç¨‹çš„ä¼˜ç¼ºç‚¹\"></a>å¹¶å‘ç¼–ç¨‹çš„ä¼˜ç¼ºç‚¹</h3><p>ä¼˜ç‚¹ï¼šä¸ºäº†èƒ½æé«˜ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡ï¼Œæé«˜ç¨‹åºè¿è¡Œé€Ÿåº¦ï¼›</p>\n<p>ç¼ºç‚¹ï¼šå­˜åœ¨å†…å­˜æ³„æ¼ã€ä¸Šä¸‹æ–‡åˆ‡æ¢ã€çº¿ç¨‹å®‰å…¨ã€æ­»é”ç­‰é—®é¢˜ã€‚</p>\n<h4 id=\"å¹¶å‘ç¼–ç¨‹ä¸‰è¦ç´ æ˜¯ä»€ä¹ˆï¼Ÿåœ¨-Java-ç¨‹åºä¸­æ€ä¹ˆä¿è¯å¤šçº¿ç¨‹çš„è¿è¡Œå®‰å…¨ï¼Ÿ\"><a href=\"#å¹¶å‘ç¼–ç¨‹ä¸‰è¦ç´ æ˜¯ä»€ä¹ˆï¼Ÿåœ¨-Java-ç¨‹åºä¸­æ€ä¹ˆä¿è¯å¤šçº¿ç¨‹çš„è¿è¡Œå®‰å…¨ï¼Ÿ\" class=\"headerlink\" title=\"å¹¶å‘ç¼–ç¨‹ä¸‰è¦ç´ æ˜¯ä»€ä¹ˆï¼Ÿåœ¨ Java ç¨‹åºä¸­æ€ä¹ˆä¿è¯å¤šçº¿ç¨‹çš„è¿è¡Œå®‰å…¨ï¼Ÿ\"></a>å¹¶å‘ç¼–ç¨‹ä¸‰è¦ç´ æ˜¯ä»€ä¹ˆï¼Ÿåœ¨ Java ç¨‹åºä¸­æ€ä¹ˆä¿è¯å¤šçº¿ç¨‹çš„è¿è¡Œå®‰å…¨ï¼Ÿ</h4><p>å¹¶å‘ç¼–ç¨‹ä¸‰è¦ç´ ï¼ˆçº¿ç¨‹çš„å®‰å…¨æ€§é—®é¢˜ä½“ç°åœ¨ï¼‰ï¼š</p>\n<p><strong>åŸå­æ€§</strong>ï¼šåŸå­ï¼Œå³ä¸€ä¸ªä¸å¯å†è¢«åˆ†å‰²çš„é¢—ç²’ã€‚åŸå­æ€§æŒ‡çš„æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªæ“ä½œè¦ä¹ˆå…¨éƒ¨æ‰§è¡ŒæˆåŠŸè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œå¤±è´¥ã€‚ï¼ˆsynchronizedï¼ŒLockï¼‰ï¼ˆçº¿ç¨‹åˆ‡æ¢å¼•èµ·çš„åŸå­æ€§é—®é¢˜ï¼‰</p>\n<p><strong>å¯è§æ€§</strong>ï¼šä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡çš„ä¿®æ”¹ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹èƒ½å¤Ÿç«‹åˆ»çœ‹åˆ°ã€‚ï¼ˆsynchronizedï¼ŒLockï¼Œvolatileï¼‰ï¼ˆJMM å†…å­˜æ¨¡å‹å¯¼è‡´çš„å¯è§æ€§é—®é¢˜ï¼‰</p>\n<p><strong>æœ‰åºæ€§</strong>ï¼šç¨‹åºæ‰§è¡Œçš„é¡ºåºæŒ‰ç…§ä»£ç çš„å…ˆåé¡ºåºæ‰§è¡Œã€‚ï¼ˆsynchronizedï¼ŒLockï¼Œvolatileï¼‰ï¼ˆæŒ‡ä»¤é‡æ’åºå¸¦æ¥çš„æœ‰åºæ€§é—®é¢˜ï¼‰</p>\n<blockquote>\n<p>volatileä¸èƒ½ä¿è¯å¹¶å‘å®‰å…¨ï¼Œæ¯”å¦‚å¤šçº¿ç¨‹å¯¹ä¸€ä¸ªvolatileçš„intå˜é‡è¿›è¡ŒåŠ 1æ“ä½œï¼Œæœ€ç»ˆå¾—åˆ°çš„æ•°å­—å¯èƒ½æ¯”é¢„æœŸå°ï¼Œå°±æ˜¯å› ä¸º++æ“ä½œä¸æ˜¯åŸå­æ€§çš„ï¼Œè€Œvolatileä¹Ÿä¸èƒ½ä¿è¯åŸå­æ€§ï¼Œæ‰€ä»¥å°±ä¼šæœ‰è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨<code>atomicInteger.getAndSet()</code>åŸå­æ“ä½œã€‚</p>\n</blockquote>\n<h3 id=\"çº¿ç¨‹å’Œè¿›ç¨‹\"><a href=\"#çº¿ç¨‹å’Œè¿›ç¨‹\" class=\"headerlink\" title=\"çº¿ç¨‹å’Œè¿›ç¨‹\"></a>çº¿ç¨‹å’Œè¿›ç¨‹</h3><h4 id=\"è¿›ç¨‹é—´çš„é€šä¿¡æ–¹å¼\"><a href=\"#è¿›ç¨‹é—´çš„é€šä¿¡æ–¹å¼\" class=\"headerlink\" title=\"è¿›ç¨‹é—´çš„é€šä¿¡æ–¹å¼\"></a>è¿›ç¨‹é—´çš„é€šä¿¡æ–¹å¼</h4><ol>\n<li><strong>ç®¡é“&#x2F;åŒ¿åç®¡é“(Pipes)</strong> ï¼šç”¨äºå…·æœ‰äº²ç¼˜å…³ç³»çš„çˆ¶å­è¿›ç¨‹é—´æˆ–è€…å…„å¼Ÿè¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼›</li>\n<li>**æœ‰åç®¡é“(Names Pipes)<strong>ï¼šåŒ¿åç®¡é“ç”±äºæ²¡æœ‰åå­—ï¼Œåªèƒ½ç”¨äºäº²ç¼˜å…³ç³»çš„è¿›ç¨‹é—´é€šä¿¡ã€‚ä¸ºäº†å…‹æœè¿™ä¸ªç¼ºç‚¹ï¼Œæå‡ºäº†æœ‰åç®¡é“ã€‚æœ‰åç®¡é“ä¸¥æ ¼éµå¾ª</strong>å…ˆè¿›å…ˆå‡º(first in first out)**ã€‚æœ‰åç®¡é“ä»¥ç£ç›˜æ–‡ä»¶çš„æ–¹å¼å­˜åœ¨ï¼Œå¯ä»¥å®ç°æœ¬æœºä»»æ„ä¸¤ä¸ªè¿›ç¨‹é€šä¿¡ï¼›</li>\n<li><strong>ä¿¡å·(Signal)</strong> ï¼šä¿¡å·æ˜¯ä¸€ç§æ¯”è¾ƒå¤æ‚çš„é€šä¿¡æ–¹å¼ï¼Œç”¨äºé€šçŸ¥æ¥æ”¶è¿›ç¨‹æŸä¸ªäº‹ä»¶å·²ç»å‘ç”Ÿï¼›</li>\n<li><strong>æ¶ˆæ¯é˜Ÿåˆ—(Message Queuing)</strong> ï¼šæ¶ˆæ¯é˜Ÿåˆ—æ˜¯æ¶ˆæ¯çš„é“¾è¡¨ï¼Œå…·æœ‰ç‰¹å®šçš„æ ¼å¼ï¼Œå­˜æ”¾åœ¨å†…å­˜ä¸­å¹¶ç”±æ¶ˆæ¯é˜Ÿåˆ—æ ‡è¯†ç¬¦æ ‡è¯†ã€‚<strong>æ¶ˆæ¯é˜Ÿåˆ—å…‹æœäº†ä¿¡å·æ‰¿è½½ä¿¡æ¯é‡å°‘ï¼Œç®¡é“åªèƒ½æ‰¿è½½æ— æ ¼å¼å­—èŠ‚æµä»¥åŠç¼“å†²åŒºå¤§å°å—é™ç­‰ç¼ºç‚¹</strong>ï¼›</li>\n<li><strong>ä¿¡å·é‡(Semaphores)</strong> ï¼šä¿¡å·é‡æ˜¯ä¸€ä¸ªè®¡æ•°å™¨ï¼Œç”¨äºå¤šè¿›ç¨‹å¯¹å…±äº«æ•°æ®çš„è®¿é—®ï¼Œä¿¡å·é‡çš„æ„å›¾åœ¨äºè¿›ç¨‹é—´åŒæ­¥ã€‚è¿™ç§é€šä¿¡æ–¹å¼ä¸»è¦ç”¨äºè§£å†³ä¸åŒæ­¥ç›¸å…³çš„é—®é¢˜å¹¶é¿å…ç«äº‰æ¡ä»¶ï¼›</li>\n<li><strong>å…±äº«å†…å­˜(Shared memory)</strong> ï¼šä½¿å¾—å¤šä¸ªè¿›ç¨‹å¯ä»¥è®¿é—®åŒä¸€å—å†…å­˜ç©ºé—´ï¼Œä¸åŒè¿›ç¨‹å¯ä»¥åŠæ—¶çœ‹åˆ°å¯¹æ–¹è¿›ç¨‹ä¸­å¯¹å…±äº«å†…å­˜ä¸­æ•°æ®çš„æ›´æ–°ã€‚è¿™ç§æ–¹å¼éœ€è¦ä¾é æŸç§åŒæ­¥æ“ä½œï¼Œå¦‚äº’æ–¥é”å’Œä¿¡å·é‡ç­‰ã€‚å¯ä»¥è¯´è¿™æ˜¯æœ€æœ‰ç”¨çš„è¿›ç¨‹é—´é€šä¿¡æ–¹å¼ï¼›</li>\n<li>**å¥—æ¥å­—(Sockets)**ï¼šæ­¤æ–¹æ³•ä¸»è¦ç”¨äºåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´é€šè¿‡ç½‘ç»œè¿›è¡Œé€šä¿¡ã€‚å¥—æ¥å­—æ˜¯æ”¯æŒ TCP&#x2F;IP çš„ç½‘ç»œé€šä¿¡çš„åŸºæœ¬æ“ä½œå•å…ƒï¼Œå¯ä»¥çœ‹åšæ˜¯ä¸åŒä¸»æœºä¹‹é—´çš„è¿›ç¨‹è¿›è¡ŒåŒå‘é€šä¿¡çš„ç«¯ç‚¹ï¼Œç®€å•çš„è¯´å°±æ˜¯é€šä¿¡çš„ä¸¤æ–¹çš„ä¸€ç§çº¦å®šï¼Œç”¨å¥—æ¥å­—ä¸­çš„ç›¸å…³å‡½æ•°æ¥å®Œæˆé€šä¿¡è¿‡ç¨‹ã€‚</li>\n</ol>\n<h4 id=\"çº¿ç¨‹é—´çš„åŒæ­¥æ–¹å¼\"><a href=\"#çº¿ç¨‹é—´çš„åŒæ­¥æ–¹å¼\" class=\"headerlink\" title=\"çº¿ç¨‹é—´çš„åŒæ­¥æ–¹å¼\"></a>çº¿ç¨‹é—´çš„åŒæ­¥æ–¹å¼</h4><p>çº¿ç¨‹åŒæ­¥æ˜¯ä¸¤ä¸ªæˆ–å¤šä¸ªå…±äº«å…³é”®èµ„æºçš„çº¿ç¨‹çš„å¹¶å‘æ‰§è¡Œã€‚åº”è¯¥åŒæ­¥çº¿ç¨‹ä»¥é¿å…å…³é”®çš„èµ„æºä½¿ç”¨å†²çªã€‚</p>\n<ol>\n<li>**äº’æ–¥é‡(Mutex)**ï¼šé‡‡ç”¨äº’æ–¥å¯¹è±¡æœºåˆ¶ï¼Œåªæœ‰æ‹¥æœ‰äº’æ–¥å¯¹è±¡çš„çº¿ç¨‹æ‰æœ‰è®¿é—®å…¬å…±èµ„æºçš„æƒé™ã€‚å› ä¸ºäº’æ–¥å¯¹è±¡åªæœ‰ä¸€ä¸ªï¼Œæ‰€ä»¥å¯ä»¥ä¿è¯å…¬å…±èµ„æºä¸ä¼šè¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®ï¼Œæ¯”å¦‚ Java ä¸­çš„ synchronized å…³é”®è¯å’Œå„ç§ Lock éƒ½æ˜¯è¿™ç§æœºåˆ¶ï¼›</li>\n<li><strong>ä¿¡å·é‡(Semphares)</strong> ï¼šå®ƒå…è®¸åŒä¸€æ—¶åˆ»å¤šä¸ªçº¿ç¨‹è®¿é—®åŒä¸€èµ„æºï¼Œä½†æ˜¯éœ€è¦æ§åˆ¶åŒä¸€æ—¶åˆ»è®¿é—®æ­¤èµ„æºçš„æœ€å¤§çº¿ç¨‹æ•°é‡ï¼›</li>\n<li><strong>äº‹ä»¶(Event)</strong> ï¼šwait&#x2F;notifyï¼šé€šè¿‡é€šçŸ¥æ“ä½œçš„æ–¹å¼æ¥ä¿æŒå¤šçº¿ç¨‹åŒæ­¥ï¼Œè¿˜å¯ä»¥æ–¹ä¾¿çš„å®ç°å¤šçº¿ç¨‹ä¼˜å…ˆçº§çš„æ¯”è¾ƒæ“ä½œã€‚</li>\n</ol>\n<h4 id=\"ä»€ä¹ˆæ˜¯çº¿ç¨‹å’Œè¿›ç¨‹\"><a href=\"#ä»€ä¹ˆæ˜¯çº¿ç¨‹å’Œè¿›ç¨‹\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯çº¿ç¨‹å’Œè¿›ç¨‹?\"></a>ä»€ä¹ˆæ˜¯çº¿ç¨‹å’Œè¿›ç¨‹?</h4><p><strong>è¿›ç¨‹</strong>ï¼šè¿›ç¨‹æ˜¯åº”ç”¨ç¨‹åºçš„ä¸€æ¬¡è¿è¡Œï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„å†…å­˜ç©ºé—´ï¼Œæ˜¯æ“ä½œç³»ç»Ÿèµ„æºåˆ†é…çš„åŸºæœ¬å•ä½ï¼›</p>\n<p><strong>çº¿ç¨‹</strong>ï¼šçº¿ç¨‹æ˜¯å¤„ç†å™¨è°ƒåº¦å’Œæ‰§è¡Œçš„åŸºæœ¬å•ä½ï¼Œä¸€ä¸ªè¿›ç¨‹ä¸­å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹ï¼Œçº¿ç¨‹å…±äº«è¿›ç¨‹çš„å†…å­˜ç©ºé—´å’Œèµ„æºã€‚</p>\n<h4 id=\"ä»€ä¹ˆæ˜¯ä¸Šä¸‹æ–‡åˆ‡æ¢\"><a href=\"#ä»€ä¹ˆæ˜¯ä¸Šä¸‹æ–‡åˆ‡æ¢\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ä¸Šä¸‹æ–‡åˆ‡æ¢?\"></a>ä»€ä¹ˆæ˜¯ä¸Šä¸‹æ–‡åˆ‡æ¢?</h4><p>å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­ä¸€èˆ¬çº¿ç¨‹çš„ä¸ªæ•°éƒ½å¤§äº CPU æ ¸å¿ƒçš„ä¸ªæ•°ï¼Œè€Œä¸€ä¸ª CPU æ ¸å¿ƒåœ¨ä»»æ„æ—¶åˆ»åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨ï¼Œä¸ºäº†è®©è¿™äº›çº¿ç¨‹éƒ½èƒ½å¾—åˆ°æœ‰æ•ˆæ‰§è¡Œï¼ŒCPU é‡‡å–çš„ç­–ç•¥æ˜¯ä¸ºæ¯ä¸ªçº¿ç¨‹åˆ†é…æ—¶é—´ç‰‡å¹¶è½®è½¬çš„å½¢å¼ã€‚</p>\n<p>å½“å‰ä»»åŠ¡åœ¨æ‰§è¡Œå®Œ CPU æ—¶é—´ç‰‡åˆ‡æ¢åˆ°å¦ä¸€ä¸ªä»»åŠ¡ä¹‹å‰ä¼šå…ˆä¿å­˜è‡ªå·±çš„çŠ¶æ€ï¼Œä»¥ä¾¿ä¸‹æ¬¡å†åˆ‡æ¢å›è¿™ä¸ªä»»åŠ¡æ—¶ï¼Œå¯ä»¥å†åŠ è½½è¿™ä¸ªä»»åŠ¡çš„çŠ¶æ€ã€‚<strong>ä»»åŠ¡ä»ä¿å­˜åˆ°å†åŠ è½½çš„è¿‡ç¨‹å°±æ˜¯ä¸€æ¬¡ä¸Šä¸‹æ–‡åˆ‡æ¢</strong>ã€‚</p>\n<p>ä¸Šä¸‹æ–‡åˆ‡æ¢å¯¹ç³»ç»Ÿæ¥è¯´æ„å‘³ç€æ¶ˆè€—å¤§é‡çš„ CPU æ—¶é—´ï¼Œäº‹å®ä¸Šï¼Œå¯èƒ½æ˜¯æ“ä½œç³»ç»Ÿä¸­æ—¶é—´æ¶ˆè€—æœ€å¤§çš„æ“ä½œã€‚</p>\n<h4 id=\"å®ˆæŠ¤çº¿ç¨‹å’Œç”¨æˆ·çº¿ç¨‹æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ\"><a href=\"#å®ˆæŠ¤çº¿ç¨‹å’Œç”¨æˆ·çº¿ç¨‹æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ\" class=\"headerlink\" title=\"å®ˆæŠ¤çº¿ç¨‹å’Œç”¨æˆ·çº¿ç¨‹æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ\"></a>å®ˆæŠ¤çº¿ç¨‹å’Œç”¨æˆ·çº¿ç¨‹æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ</h4><ul>\n<li><strong>ç”¨æˆ· (User) çº¿ç¨‹</strong>ï¼šè¿è¡Œåœ¨å‰å°ï¼Œæ‰§è¡Œå…·ä½“çš„ä»»åŠ¡</li>\n<li><strong>å®ˆæŠ¤ (Daemon) çº¿ç¨‹</strong>ï¼šè¿è¡Œåœ¨åå°ï¼Œä¸ºå…¶ä»–å‰å°çº¿ç¨‹æœåŠ¡ã€‚ä¸€æ—¦æ‰€æœ‰ç”¨æˆ·çº¿ç¨‹éƒ½ç»“æŸè¿è¡Œï¼Œå®ˆæŠ¤çº¿ç¨‹ä¼šéš JVM ä¸€èµ·ç»“æŸå·¥ä½œ</li>\n</ul>\n<p><strong>æ³¨æ„äº‹é¡¹ï¼š</strong></p>\n<ol>\n<li><code>setDaemon(true)</code>å¿…é¡»åœ¨<code>start()</code>æ–¹æ³•å‰æ‰§è¡Œï¼Œå¦åˆ™ä¼šæŠ›å‡º <code>IllegalThreadStateException</code> å¼‚å¸¸ï¼›</li>\n<li>åœ¨å®ˆæŠ¤çº¿ç¨‹ä¸­äº§ç”Ÿçš„æ–°çº¿ç¨‹ä¹Ÿæ˜¯å®ˆæŠ¤çº¿ç¨‹ï¼›</li>\n<li>ä¸æ˜¯æ‰€æœ‰çš„ä»»åŠ¡éƒ½å¯ä»¥åˆ†é…ç»™å®ˆæŠ¤çº¿ç¨‹æ¥æ‰§è¡Œï¼Œæ¯”å¦‚è¯»å†™æ“ä½œæˆ–è€…è®¡ç®—é€»è¾‘ï¼›</li>\n<li>å®ˆæŠ¤ (Daemon) çº¿ç¨‹ä¸­ä¸èƒ½ä¾é  finally å—çš„å†…å®¹æ¥ç¡®ä¿æ‰§è¡Œå…³é—­æˆ–æ¸…ç†èµ„æºçš„é€»è¾‘ã€‚å› ä¸ºæˆ‘ä»¬ä¸Šé¢ä¹Ÿè¯´è¿‡äº†ä¸€æ—¦æ‰€æœ‰ç”¨æˆ·çº¿ç¨‹éƒ½ç»“æŸè¿è¡Œï¼Œå®ˆæŠ¤çº¿ç¨‹ä¼šéš JVM ä¸€èµ·ç»“æŸå·¥ä½œï¼Œæ‰€ä»¥å®ˆæŠ¤ (Daemon) çº¿ç¨‹ä¸­çš„ finally è¯­å¥å—å¯èƒ½æ— æ³•è¢«æ‰§è¡Œã€‚</li>\n</ol>\n<h4 id=\"å¦‚ä½•åœ¨-Windows-å’Œ-Linux-ä¸ŠæŸ¥æ‰¾å“ªä¸ªçº¿ç¨‹cpuåˆ©ç”¨ç‡æœ€é«˜ï¼Ÿ\"><a href=\"#å¦‚ä½•åœ¨-Windows-å’Œ-Linux-ä¸ŠæŸ¥æ‰¾å“ªä¸ªçº¿ç¨‹cpuåˆ©ç”¨ç‡æœ€é«˜ï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•åœ¨ Windows å’Œ Linux ä¸ŠæŸ¥æ‰¾å“ªä¸ªçº¿ç¨‹cpuåˆ©ç”¨ç‡æœ€é«˜ï¼Ÿ\"></a>å¦‚ä½•åœ¨ Windows å’Œ Linux ä¸ŠæŸ¥æ‰¾å“ªä¸ªçº¿ç¨‹cpuåˆ©ç”¨ç‡æœ€é«˜ï¼Ÿ</h4><p>Windows ä¸‹ç”¨ä»»åŠ¡ç®¡ç†å™¨çœ‹ï¼ŒLinux ä¸‹å¯ä»¥ç”¨ top è¿™ä¸ªå‘½ä»¤çœ‹ã€‚</p>\n<h4 id=\"ä»€ä¹ˆæ˜¯çº¿ç¨‹æ­»é”\"><a href=\"#ä»€ä¹ˆæ˜¯çº¿ç¨‹æ­»é”\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯çº¿ç¨‹æ­»é”\"></a>ä»€ä¹ˆæ˜¯çº¿ç¨‹æ­»é”</h4><p>æ­»é”æ˜¯æŒ‡ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„çº¿ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œç”±äºç«äº‰èµ„æºé€ æˆçš„ä¸€ç§é˜»å¡çš„ç°è±¡ï¼Œè‹¥æ— å¤–åŠ›ä½œç”¨ï¼Œå®ƒä»¬éƒ½å°†æ— æ³•æ¨è¿›ä¸‹å»ã€‚</p>\n<p>å¦‚å›¾æ‰€ç¤ºï¼Œçº¿ç¨‹ A æŒæœ‰èµ„æº 2ï¼Œçº¿ç¨‹ B æŒæœ‰èµ„æº 1ï¼Œä»–ä»¬åŒæ—¶éƒ½æƒ³ç”³è¯·å¯¹æ–¹çš„èµ„æºï¼Œè¿™ä¸¤ä¸ªçº¿ç¨‹å°±ä¼šäº’ç›¸ç­‰å¾…è€Œè¿›å…¥æ­»é”çŠ¶æ€ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/202206152131355.png\" alt=\"çº¿ç¨‹æ­»é”\"></p>\n<p>ä¸‹é¢é€šè¿‡ä»£ç æ¨¡æ‹Ÿäº†ä¸Šå›¾çš„æ­»é”çš„æƒ…å†µï¼ˆä»£ç æ¥æºäºã€Šå¹¶å‘ç¼–ç¨‹ä¹‹ç¾ã€‹ï¼‰ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">DeadLockDemo</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">Object</span> <span class=\"variable\">resource1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>();\t<span class=\"comment\">//èµ„æº 1</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">Object</span> <span class=\"variable\">resource2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>();\t<span class=\"comment\">//èµ„æº 2</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">synchronized</span> (resource1) &#123;</span><br><span class=\"line\">                System.out.println(Thread.currentThread() + <span class=\"string\">&quot;get resource1&quot;</span>);</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                System.out.println(Thread.currentThread() + <span class=\"string\">&quot;waiting get resource2&quot;</span>);</span><br><span class=\"line\">                <span class=\"keyword\">synchronized</span> (resource2) &#123;</span><br><span class=\"line\">                    System.out.println(Thread.currentThread() + <span class=\"string\">&quot;get resource2&quot;</span>);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;çº¿ç¨‹ 1&quot;</span>).start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">synchronized</span> (resource2) &#123;</span><br><span class=\"line\">                System.out.println(Thread.currentThread() + <span class=\"string\">&quot;get resource2&quot;</span>);</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                System.out.println(Thread.currentThread() + <span class=\"string\">&quot;waiting get resource1&quot;</span>);</span><br><span class=\"line\">                <span class=\"keyword\">synchronized</span> (resource1) &#123;</span><br><span class=\"line\">                    System.out.println(Thread.currentThread() + <span class=\"string\">&quot;get resource1&quot;</span>);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;çº¿ç¨‹ 2&quot;</span>).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>è¾“å‡ºç»“æœ</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Thread[çº¿ç¨‹ <span class=\"number\">1</span>,<span class=\"number\">5</span>,main]get resource1</span><br><span class=\"line\">Thread[çº¿ç¨‹ <span class=\"number\">2</span>,<span class=\"number\">5</span>,main]get resource2</span><br><span class=\"line\">Thread[çº¿ç¨‹ <span class=\"number\">1</span>,<span class=\"number\">5</span>,main]waiting get resource2</span><br><span class=\"line\">Thread[çº¿ç¨‹ <span class=\"number\">2</span>,<span class=\"number\">5</span>,main]waiting get resource1</span><br></pre></td></tr></table></figure>\n\n<p>çº¿ç¨‹ A é€šè¿‡ synchronized (resource1) è·å¾— resource1 çš„ç›‘è§†å™¨é”ï¼Œç„¶åé€šè¿‡<code>Thread.sleep(1000)</code>ï¼›è®©çº¿ç¨‹ A ä¼‘çœ  1s ä¸ºçš„æ˜¯è®©çº¿ç¨‹ B å¾—åˆ° CPU æ‰§è¡Œæƒï¼Œç„¶åè·å–åˆ° resource2 çš„ç›‘è§†å™¨é”ã€‚çº¿ç¨‹ A å’Œçº¿ç¨‹ B ä¼‘çœ ç»“æŸäº†éƒ½å¼€å§‹ä¼å›¾è¯·æ±‚è·å–å¯¹æ–¹çš„èµ„æºï¼Œç„¶åè¿™ä¸¤ä¸ªçº¿ç¨‹å°±ä¼šé™·å…¥äº’ç›¸ç­‰å¾…çš„çŠ¶æ€ï¼Œè¿™ä¹Ÿå°±äº§ç”Ÿäº†æ­»é”ã€‚ä¸Šé¢çš„ä¾‹å­ç¬¦åˆäº§ç”Ÿæ­»é”çš„å››ä¸ªå¿…è¦æ¡ä»¶ã€‚</p>\n<h4 id=\"å½¢æˆæ­»é”çš„å››ä¸ªå¿…è¦æ¡ä»¶æ˜¯ä»€ä¹ˆ\"><a href=\"#å½¢æˆæ­»é”çš„å››ä¸ªå¿…è¦æ¡ä»¶æ˜¯ä»€ä¹ˆ\" class=\"headerlink\" title=\"å½¢æˆæ­»é”çš„å››ä¸ªå¿…è¦æ¡ä»¶æ˜¯ä»€ä¹ˆ\"></a>å½¢æˆæ­»é”çš„å››ä¸ªå¿…è¦æ¡ä»¶æ˜¯ä»€ä¹ˆ</h4><ol>\n<li>äº’æ–¥æ¡ä»¶ï¼šä¸€ä¸ªèµ„æºåªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹å ç”¨ï¼Œç›´åˆ°è¢«è¯¥çº¿ç¨‹é‡Šæ”¾ï¼›</li>\n<li>è¯·æ±‚ä¸ä¿æŒæ¡ä»¶ï¼šä¸€ä¸ªçº¿ç¨‹å› è¯·æ±‚è¢«å ç”¨èµ„æºè€Œå‘ç”Ÿé˜»å¡æ—¶ï¼Œå¯¹å·²è·å¾—çš„èµ„æºä¿æŒä¸æ”¾ï¼›</li>\n<li>ä¸å‰¥å¤ºæ¡ä»¶ï¼šçº¿ç¨‹å·²è·å¾—çš„èµ„æºåœ¨æœ«ä½¿ç”¨å®Œä¹‹å‰ä¸èƒ½è¢«å…¶ä»–çº¿ç¨‹å¼ºè¡Œå‰¥å¤ºï¼Œåªæœ‰è‡ªå·±ä½¿ç”¨å®Œæ¯•åæ‰é‡Šæ”¾èµ„æºï¼›</li>\n<li>å¾ªç¯ç­‰å¾…æ¡ä»¶ï¼šå½“å‘ç”Ÿæ­»é”æ—¶ï¼Œæ‰€ç­‰å¾…çš„çº¿ç¨‹å¿…å®šä¼šå½¢æˆä¸€ä¸ªç¯è·¯ï¼ˆç±»ä¼¼äºæ­»å¾ªç¯ï¼‰ï¼Œé€ æˆæ°¸ä¹…é˜»å¡ã€‚</li>\n</ol>\n<h4 id=\"å¦‚ä½•é¿å…çº¿ç¨‹æ­»é”\"><a href=\"#å¦‚ä½•é¿å…çº¿ç¨‹æ­»é”\" class=\"headerlink\" title=\"å¦‚ä½•é¿å…çº¿ç¨‹æ­»é”\"></a>å¦‚ä½•é¿å…çº¿ç¨‹æ­»é”</h4><p>æˆ‘ä»¬åªè¦ç ´åäº§ç”Ÿæ­»é”çš„å››ä¸ªæ¡ä»¶ä¸­çš„å…¶ä¸­ä¸€ä¸ªå°±å¯ä»¥äº†ã€‚</p>\n<p><strong>ç ´åäº’æ–¥æ¡ä»¶</strong>ï¼šæ— æ³•ç ´åï¼Œå› ä¸ºæˆ‘ä»¬ç”¨é”æœ¬æ¥å°±æ˜¯æƒ³å®ç°äº’æ–¥è®¿é—®ä¸´ç•Œèµ„æºï¼›</p>\n<p><strong>ç ´åè¯·æ±‚ä¸ä¿æŒæ¡ä»¶</strong>ï¼šä¸€æ¬¡æ€§ç”³è¯·æ‰€æœ‰çš„èµ„æºï¼›</p>\n<p><strong>ç ´åä¸å‰¥å¤ºæ¡ä»¶</strong>ï¼šå ç”¨éƒ¨åˆ†èµ„æºçš„çº¿ç¨‹è¿›ä¸€æ­¥ç”³è¯·å…¶ä»–èµ„æºæ—¶ï¼Œ<strong>å¦‚æœç”³è¯·ä¸åˆ°ï¼Œå¯ä»¥ä¸»åŠ¨é‡Šæ”¾å®ƒå æœ‰çš„èµ„æº</strong>ï¼›</p>\n<p><strong>ç ´åå¾ªç¯ç­‰å¾…æ¡ä»¶</strong>ï¼šé <strong>æŒ‰åºç”³è¯·</strong>èµ„æºæ¥é¢„é˜²ã€‚æŒ‰æŸä¸€é¡ºåºç”³è¯·èµ„æºï¼Œé‡Šæ”¾èµ„æºåˆ™ååºé‡Šæ”¾ã€‚ç ´åå¾ªç¯ç­‰å¾…æ¡ä»¶ã€‚</p>\n<p>æˆ‘ä»¬å¯¹çº¿ç¨‹ 2 çš„ä»£ç ä¿®æ”¹æˆä¸‹é¢è¿™æ ·å°±ä¸ä¼šäº§ç”Ÿæ­»é”äº†ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">synchronized</span> (resource1) &#123;</span><br><span class=\"line\">        System.out.println(Thread.currentThread() + <span class=\"string\">&quot;get resource1&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(Thread.currentThread() + <span class=\"string\">&quot;waiting get resource2&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span> (resource2) &#123;</span><br><span class=\"line\">            System.out.println(Thread.currentThread() + <span class=\"string\">&quot;get resource2&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;, <span class=\"string\">&quot;çº¿ç¨‹ 2&quot;</span>).start();</span><br></pre></td></tr></table></figure>\n\n<p>è¾“å‡ºç»“æœ</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Thread[çº¿ç¨‹ <span class=\"number\">1</span>,<span class=\"number\">5</span>,main]get resource1</span><br><span class=\"line\">Thread[çº¿ç¨‹ <span class=\"number\">1</span>,<span class=\"number\">5</span>,main]waiting get resource2</span><br><span class=\"line\">Thread[çº¿ç¨‹ <span class=\"number\">1</span>,<span class=\"number\">5</span>,main]get resource2</span><br><span class=\"line\">Thread[çº¿ç¨‹ <span class=\"number\">2</span>,<span class=\"number\">5</span>,main]get resource1</span><br><span class=\"line\">Thread[çº¿ç¨‹ <span class=\"number\">2</span>,<span class=\"number\">5</span>,main]waiting get resource2</span><br><span class=\"line\">Thread[çº¿ç¨‹ <span class=\"number\">2</span>,<span class=\"number\">5</span>,main]get resource2</span><br></pre></td></tr></table></figure>\n\n<p>æˆ‘ä»¬åˆ†æä¸€ä¸‹ä¸Šé¢çš„ä»£ç ä¸ºä»€ä¹ˆé¿å…äº†æ­»é”çš„å‘ç”Ÿ?</p>\n<p>çº¿ç¨‹ 1 é¦–å…ˆè·å¾—åˆ° resource1 çš„ç›‘è§†å™¨é”ï¼Œè¿™æ—¶å€™çº¿ç¨‹ 2 å°±è·å–ä¸åˆ°äº†ã€‚ç„¶åçº¿ç¨‹ 1 å†å»è·å– resource2 çš„ç›‘è§†å™¨é”ï¼Œå¯ä»¥è·å–åˆ°ã€‚ç„¶åçº¿ç¨‹ 1 é‡Šæ”¾äº†å¯¹ resource1ã€resource2 çš„ç›‘è§†å™¨é”çš„å ç”¨ï¼Œçº¿ç¨‹ 2 è·å–åˆ°å°±å¯ä»¥æ‰§è¡Œäº†ã€‚è¿™æ ·å°±ç ´åäº†ç ´åå¾ªç¯ç­‰å¾…æ¡ä»¶ï¼Œå› æ­¤é¿å…äº†æ­»é”ã€‚</p>\n<h4 id=\"åˆ›å»ºçº¿ç¨‹æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ\"><a href=\"#åˆ›å»ºçº¿ç¨‹æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ\" class=\"headerlink\" title=\"åˆ›å»ºçº¿ç¨‹æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ\"></a>åˆ›å»ºçº¿ç¨‹æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ</h4><p>åˆ›å»ºçº¿ç¨‹æœ‰å››ç§æ–¹å¼ï¼š</p>\n<ul>\n<li>ç»§æ‰¿ Thread ç±»</li>\n<li>å®ç° Runnable æ¥å£</li>\n<li>å®ç° Callable æ¥å£</li>\n<li>ä½¿ç”¨ Executors å·¥å…·ç±»åˆ›å»ºçº¿ç¨‹æ± </li>\n</ul>\n<p><strong>ç»§æ‰¿ Thread ç±»</strong></p>\n<ol>\n<li>å®šä¹‰ä¸€ä¸ª Thread ç±»çš„å­ç±»ï¼Œé‡å†™ run æ–¹æ³•ï¼›</li>\n<li>åˆ›å»ºè‡ªå®šä¹‰çš„çº¿ç¨‹å­ç±»å¯¹è±¡ï¼›</li>\n<li>è°ƒç”¨å­ç±»å®ä¾‹çš„ start() æ–¹æ³•æ¥å¯åŠ¨çº¿ç¨‹ã€‚</li>\n</ol>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Main</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyThread</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">Thread</span> &#123;</span><br><span class=\"line\">        <span class=\"meta\">@Override</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">            System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; run()æ–¹æ³•æ­£åœ¨æ‰§è¡Œ...&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">MyThread</span>().start();</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            Thread.sleep(<span class=\"number\">10</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; main()æ–¹æ³•æ‰§è¡Œç»“æŸ&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ç° Runnable æ¥å£</strong></p>\n<ol>\n<li>å®šä¹‰ Runnable æ¥å£å®ç°ç±» MyRunnableï¼Œå¹¶é‡å†™ run() æ–¹æ³•ï¼›</li>\n<li>åˆ›å»º MyRunnable å®ä¾‹ myRunnableï¼Œä»¥ myRunnable ä½œä¸º target åˆ›å»º Thread å®ä¾‹ï¼Œ<strong>è¯¥Threadå¯¹è±¡æ‰æ˜¯çœŸæ­£çš„çº¿ç¨‹å¯¹è±¡</strong>ï¼›</li>\n<li>è°ƒç”¨çº¿ç¨‹å®ä¾‹çš„ start() æ–¹æ³•ã€‚</li>\n</ol>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Main</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyRunnable</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Runnable</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"meta\">@Override</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">            System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; run()æ–¹æ³•æ­£åœ¨æ‰§è¡Œ...&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">MyRunnable</span>()).start();</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            Thread.sleep(<span class=\"number\">10</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; main()æ–¹æ³•æ‰§è¡Œç»“æŸ&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ç° Callable æ¥å£</strong></p>\n<ol>\n<li>åˆ›å»ºå®ç° Callable æ¥å£çš„ç±» myCallableï¼›</li>\n<li>ä»¥ myCallable ä¸ºå‚æ•°åˆ›å»º FutureTask å¯¹è±¡ï¼›</li>\n<li>å°† FutureTask ä½œä¸ºå‚æ•°åˆ›å»º Thread å¯¹è±¡ï¼›</li>\n<li>è°ƒç”¨çº¿ç¨‹å¯¹è±¡çš„ start() æ–¹æ³•ã€‚</li>\n</ol>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Main</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyCallable</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Callable</span>&lt;Integer&gt; &#123;</span><br><span class=\"line\">        <span class=\"meta\">@Override</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> Integer <span class=\"title function_\">call</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">            System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; call()æ–¹æ³•æ‰§è¡Œä¸­...&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        FutureTask&lt;Integer&gt; futureTask = <span class=\"keyword\">new</span> <span class=\"title class_\">FutureTask</span>&lt;&gt;(<span class=\"keyword\">new</span> <span class=\"title class_\">MyCallable</span>());</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(futureTask).start();</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            Thread.sleep(<span class=\"number\">10</span>);</span><br><span class=\"line\">            System.out.println(futureTask.get());</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException | ExecutionException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; main()æ–¹æ³•æ‰§è¡Œå®Œæˆ&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>ä½¿ç”¨ Executors å·¥å…·ç±»åˆ›å»ºçº¿ç¨‹æ± </strong></p>\n<p>Executors æä¾›äº†ä¸€ç³»åˆ—å·¥å‚æ–¹æ³•ç”¨äºåˆ›å»ºçº¿ç¨‹æ± ï¼Œè¿”å›çš„çº¿ç¨‹æ± éƒ½å®ç°äº† ExecutorService æ¥å£ã€‚</p>\n<p>ä¸»è¦æœ‰ new[Single&#x2F;Fixed&#x2F;Cached&#x2F;Scheduled]ThreadPool è¿™å››ç§çº¿ç¨‹æ± </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyRunnable</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Runnable</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; run()æ–¹æ³•æ‰§è¡Œä¸­...&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">SingleThreadExecutorTest</span> &#123;n</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">ExecutorService</span> <span class=\"variable\">executorService</span> <span class=\"operator\">=</span> Executors.newSingleThreadExecutor();</span><br><span class=\"line\">        <span class=\"type\">MyRunnable</span> <span class=\"variable\">myRunnable</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MyRunnable</span>();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">5</span>; i++) &#123;</span><br><span class=\"line\">            executorService.execute(myRunnable);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;çº¿ç¨‹ä»»åŠ¡å¼€å§‹æ‰§è¡Œ&quot;</span>);</span><br><span class=\"line\">        executorService.shutdown();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"è¯´ä¸€ä¸‹-runnable-å’Œ-callable-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"><a href=\"#è¯´ä¸€ä¸‹-runnable-å’Œ-callable-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"è¯´ä¸€ä¸‹ runnable å’Œ callable æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"></a>è¯´ä¸€ä¸‹ runnable å’Œ callable æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h4><p>ç›¸åŒç‚¹</p>\n<ul>\n<li>éƒ½æ˜¯æ¥å£</li>\n<li>éƒ½å¯ä»¥ç”¨æ¥å®ç°å¤šçº¿ç¨‹</li>\n<li>éƒ½åˆ›å»º Thread å®ä¾‹å¹¶è°ƒç”¨å…¶ start() æ–¹æ³•å¯åŠ¨çº¿ç¨‹</li>\n</ul>\n<p>ä¸»è¦åŒºåˆ«</p>\n<ul>\n<li>Runnable æ¥å£ run æ–¹æ³•æ— è¿”å›å€¼ï¼›Callable æ¥å£ call æ–¹æ³•æœ‰è¿”å›å€¼ï¼Œå’Œ FutureTask é…åˆå¯ä»¥ç”¨æ¥è·å–å¼‚æ­¥æ‰§è¡Œçš„ç»“æœ</li>\n<li>Runnable æ¥å£ run æ–¹æ³•æ— æ³•æ•è·å¹¶å¤„ç†å¼‚å¸¸ï¼›Callable æ¥å£ call æ–¹æ³•å¯ä»¥æ•è·å¹¶å¤„ç†å¼‚å¸¸</li>\n</ul>\n<h4 id=\"çº¿ç¨‹çš„-run-å’Œ-start-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"><a href=\"#çº¿ç¨‹çš„-run-å’Œ-start-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"çº¿ç¨‹çš„ run()å’Œ start()æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"></a>çº¿ç¨‹çš„ run()å’Œ start()æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h4><blockquote>\n<p>start() æ–¹æ³•æ¥å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ï¼ŒçœŸæ­£å®ç°äº†å¤šçº¿ç¨‹è¿è¡Œã€‚è°ƒç”¨ start() æ–¹æ³•æ— éœ€ç­‰å¾…runæ–¹æ³•ä½“ä»£ç æ‰§è¡Œå®Œæ¯•ï¼Œå¯ä»¥ç›´æ¥ç»§ç»­æ‰§è¡Œå…¶ä»–çš„ä»£ç ï¼› æ­¤æ—¶çº¿ç¨‹æ˜¯å¤„äºå°±ç»ªçŠ¶æ€ï¼Œå¹¶æ²¡æœ‰è¿è¡Œã€‚ ç„¶åé€šè¿‡æ­¤ Thread ç±»è°ƒç”¨æ–¹æ³• run() æ¥å®Œæˆå…¶è¿è¡ŒçŠ¶æ€ï¼Œ run() æ–¹æ³•è¿è¡Œç»“æŸï¼Œ æ­¤çº¿ç¨‹ç»ˆæ­¢ã€‚ç„¶å CPU å†è°ƒåº¦å…¶å®ƒçº¿ç¨‹ã€‚</p>\n</blockquote>\n<p>start() æ–¹æ³•ç”¨äºå¯åŠ¨çº¿ç¨‹ï¼Œrun() æ–¹æ³•ç”¨äºæ‰§è¡Œçº¿ç¨‹çš„è¿è¡Œæ—¶ä»£ç ï¼Œç›´æ¥è°ƒç”¨ run()ï¼Œå…¶å®å°±ç›¸å½“äºæ˜¯è°ƒç”¨äº†ä¸€ä¸ªæ™®é€šå‡½æ•°è€Œå·²ã€‚<br>start() åªèƒ½è°ƒç”¨ä¸€æ¬¡ï¼Œrun() å¯ä»¥é‡å¤è°ƒç”¨ã€‚</p>\n<h4 id=\"ä»€ä¹ˆæ˜¯-Callable-å’Œ-Future\"><a href=\"#ä»€ä¹ˆæ˜¯-Callable-å’Œ-Future\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ Callable å’Œ Future?\"></a>ä»€ä¹ˆæ˜¯ Callable å’Œ Future?</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">FutureTask&lt;Integer&gt; futureTask = <span class=\"keyword\">new</span> <span class=\"title class_\">FutureTask</span>&lt;&gt;(<span class=\"keyword\">new</span> <span class=\"title class_\">MyCallable</span>());</span><br><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(futureTask).start();</span><br></pre></td></tr></table></figure>\n\n<p>å°† callable å®ä¾‹ä¼ å…¥ futureï¼Œç„¶åå°† future å®ä¾‹ä¼ å…¥ Thread åˆ›å»ºçº¿ç¨‹ï¼Œ<br>ä¹‹åå¯ä»¥ç”¨ future æ¥è·å– callable  ä¸­ call() çš„è¿”å›ç»“æœã€‚</p>\n<h4 id=\"çº¿ç¨‹çš„çŠ¶æ€å’ŒåŸºæœ¬æ“ä½œ\"><a href=\"#çº¿ç¨‹çš„çŠ¶æ€å’ŒåŸºæœ¬æ“ä½œ\" class=\"headerlink\" title=\"çº¿ç¨‹çš„çŠ¶æ€å’ŒåŸºæœ¬æ“ä½œ\"></a>çº¿ç¨‹çš„çŠ¶æ€å’ŒåŸºæœ¬æ“ä½œ</h4><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650518197279.png\" alt=\"çº¿ç¨‹çš„çŠ¶æ€\" style=\"zoom:67%;\" />\n\n<h4 id=\"Java-ä¸­ç”¨åˆ°çš„çº¿ç¨‹è°ƒåº¦ç®—æ³•æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#Java-ä¸­ç”¨åˆ°çš„çº¿ç¨‹è°ƒåº¦ç®—æ³•æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"Java ä¸­ç”¨åˆ°çš„çº¿ç¨‹è°ƒåº¦ç®—æ³•æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>Java ä¸­ç”¨åˆ°çš„çº¿ç¨‹è°ƒåº¦ç®—æ³•æ˜¯ä»€ä¹ˆï¼Ÿ</h4><p>çº¿ç¨‹è°ƒåº¦æ˜¯æŒ‡æŒ‰ç…§ç‰¹å®šæœºåˆ¶ä¸ºå¤šä¸ªçº¿ç¨‹åˆ†é… CPU çš„ä½¿ç”¨æƒã€‚</p>\n<p>æœ‰ä¸¤ç§è°ƒåº¦æ¨¡å‹ï¼š<strong>æ—¶é—´ç‰‡è½®è½¬</strong>æ¨¡å‹å’Œ<strong>ä¼˜å…ˆçº§è°ƒåº¦</strong>æ¨¡å‹ã€‚</p>\n<p><strong>Java è™šæ‹Ÿæœºé‡‡ç”¨ä¼˜å…ˆçº§è°ƒåº¦æ¨¡å‹</strong>ï¼Œæ˜¯æŒ‡ä¼˜å…ˆè®©å¯è¿è¡Œæ± ä¸­ä¼˜å…ˆçº§é«˜çš„çº¿ç¨‹å ç”¨ CPUï¼Œå¦‚æœå¯è¿è¡Œæ± ä¸­çš„çº¿ç¨‹ä¼˜å…ˆçº§ç›¸åŒï¼Œé‚£ä¹ˆå°±éšæœºé€‰æ‹©ä¸€ä¸ªçº¿ç¨‹ï¼Œä½¿å…¶å ç”¨ CPUã€‚å¤„äºè¿è¡ŒçŠ¶æ€çš„çº¿ç¨‹ä¼šä¸€ç›´è¿è¡Œï¼Œç›´è‡³å®ƒä¸å¾—ä¸æ”¾å¼ƒ CPUã€‚</p>\n<h4 id=\"è¯·è¯´å‡ºä¸çº¿ç¨‹åŒæ­¥ä»¥åŠçº¿ç¨‹è°ƒåº¦ç›¸å…³çš„æ–¹æ³•ã€‚\"><a href=\"#è¯·è¯´å‡ºä¸çº¿ç¨‹åŒæ­¥ä»¥åŠçº¿ç¨‹è°ƒåº¦ç›¸å…³çš„æ–¹æ³•ã€‚\" class=\"headerlink\" title=\"è¯·è¯´å‡ºä¸çº¿ç¨‹åŒæ­¥ä»¥åŠçº¿ç¨‹è°ƒåº¦ç›¸å…³çš„æ–¹æ³•ã€‚\"></a>è¯·è¯´å‡ºä¸çº¿ç¨‹åŒæ­¥ä»¥åŠçº¿ç¨‹è°ƒåº¦ç›¸å…³çš„æ–¹æ³•ã€‚</h4><p>ï¼ˆ1ï¼‰wait()ï¼šä½¿ä¸€ä¸ªçº¿ç¨‹å¤„äºç­‰å¾…çŠ¶æ€ï¼Œå¹¶ä¸”é‡Šæ”¾æ‰€æŒæœ‰çš„å¯¹è±¡çš„é”ï¼›</p>\n<p>ï¼ˆ2ï¼‰sleep()ï¼šä½¿ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„çº¿ç¨‹å¤„äºç¡çœ çŠ¶æ€ï¼Œæ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼›</p>\n<p>ï¼ˆ3ï¼‰notify()ï¼šå”¤é†’ä¸€ä¸ªå¤„äºç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ï¼Œå½“ç„¶åœ¨è°ƒç”¨æ­¤æ–¹æ³•çš„æ—¶å€™ï¼Œå¹¶ä¸èƒ½ç¡®åˆ‡çš„å”¤é†’æŸä¸€ä¸ªç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ï¼Œè€Œæ˜¯ç”± JVM ç¡®å®šå”¤é†’å“ªä¸ªçº¿ç¨‹ï¼Œè€Œä¸”ä¸ä¼˜å…ˆçº§æ— å…³ï¼›</p>\n<p>ï¼ˆ4ï¼‰notityAll()ï¼šå”¤é†’æ‰€æœ‰å¤„äºç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ï¼Œè¯¥æ–¹æ³•å¹¶ä¸æ˜¯å°†å¯¹è±¡çš„é”ç»™æ‰€æœ‰çº¿ç¨‹ï¼Œè€Œæ˜¯è®©å®ƒä»¬ç«äº‰ï¼Œåªæœ‰è·å¾—é”çš„çº¿ç¨‹æ‰èƒ½è¿›å…¥å°±ç»ªçŠ¶æ€ï¼›</p>\n<h4 id=\"wait-å’Œ-sleep-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"><a href=\"#wait-å’Œ-sleep-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"wait() å’Œ sleep() æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"></a>wait() å’Œ sleep() æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h4><p>ä¸¤è€…éƒ½å¯ä»¥æš‚åœçº¿ç¨‹çš„æ‰§è¡Œ</p>\n<ul>\n<li>ç±»çš„ä¸åŒï¼šwait() æ˜¯ Object ç±»çš„æ–¹æ³•ï¼Œsleep() æ˜¯ Thread çº¿ç¨‹ç±»çš„é™æ€æ–¹æ³•ã€‚</li>\n<li>é‡Šæ”¾é”ï¼šwait() é‡Šæ”¾é”ï¼Œsleep() ä¸é‡Šæ”¾é”ã€‚</li>\n<li>ç”¨é€”ä¸åŒï¼šwait é€šå¸¸è¢«ç”¨äºçº¿ç¨‹é—´äº¤äº’&#x2F;é€šä¿¡ï¼Œsleep é€šå¸¸è¢«ç”¨äºæš‚åœæ‰§è¡Œã€‚</li>\n<li>è‡ªåŠ¨è‹é†’ï¼šwait() æ–¹æ³•è¢«è°ƒç”¨åï¼Œçº¿ç¨‹ä¸ä¼šè‡ªåŠ¨è‹é†’ï¼Œéœ€è¦åˆ«çš„çº¿ç¨‹è°ƒç”¨åŒä¸€ä¸ªå¯¹è±¡ä¸Šçš„ notify() æˆ–è€… notifyAll() æ–¹æ³•ã€‚sleep() æ–¹æ³•æ‰§è¡Œå®Œæˆåï¼Œçº¿ç¨‹ä¼šè‡ªåŠ¨è‹é†’ã€‚æˆ–è€…å¯ä»¥ä½¿ç”¨ wait(long timeout) è¶…æ—¶åçº¿ç¨‹ä¼šè‡ªåŠ¨è‹é†’ã€‚</li>\n</ul>\n<h4 id=\"ä½ æ˜¯å¦‚ä½•è°ƒç”¨-wait-æ–¹æ³•çš„ï¼Ÿä½¿ç”¨-if-å—è¿˜æ˜¯å¾ªç¯ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ\"><a href=\"#ä½ æ˜¯å¦‚ä½•è°ƒç”¨-wait-æ–¹æ³•çš„ï¼Ÿä½¿ç”¨-if-å—è¿˜æ˜¯å¾ªç¯ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"ä½ æ˜¯å¦‚ä½•è°ƒç”¨ wait() æ–¹æ³•çš„ï¼Ÿä½¿ç”¨ if å—è¿˜æ˜¯å¾ªç¯ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ\"></a>ä½ æ˜¯å¦‚ä½•è°ƒç”¨ wait() æ–¹æ³•çš„ï¼Ÿä½¿ç”¨ if å—è¿˜æ˜¯å¾ªç¯ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</h4><blockquote>\n<p>ä½¿ç”¨ while åˆ¤æ–­æ¡ä»¶æ˜¯å¦å¾—åˆ°æ»¡è¶³</p>\n</blockquote>\n<p>ä½¿ç”¨ if æ¥åˆ¤æ–­ä¼šå­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š</p>\n<ol>\n<li><p>å¦ä¸€ä¸ªçº¿ç¨‹å¯èƒ½å·²ç»è¢«å”¤é†’å¹¶æ”¹å˜äº†æ¡ä»¶çŠ¶æ€ã€‚ä¾‹å¦‚ notifyAll ä¼šå”¤é†’å¤šä¸ªç­‰å¾…çš„çº¿ç¨‹ã€‚</p>\n</li>\n<li><p>å­˜åœ¨â€œä¼ªå”¤é†’â€çš„æƒ…å†µï¼Œå³åœ¨æ²¡æœ‰é€šçŸ¥çš„æƒ…å†µä¸‹ï¼Œçº¿ç¨‹ä¹Ÿå¯èƒ½ä¼šè‹é†’è¿‡æ¥ï¼Œè€Œæ­¤æ—¶æ˜¯ä¸åº”è¯¥å”¤é†’çš„ã€‚</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">synchronized</span> (monitor) &#123;</span><br><span class=\"line\">    <span class=\"comment\">//  åˆ¤æ–­æ¡ä»¶è°“è¯æ˜¯å¦å¾—åˆ°æ»¡è¶³</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span>(!locked) &#123;</span><br><span class=\"line\">        <span class=\"comment\">//  ç­‰å¾…å”¤é†’</span></span><br><span class=\"line\">        monitor.wait();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//  å¤„ç†å…¶ä»–çš„ä¸šåŠ¡é€»è¾‘</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n</ol>\n<h4 id=\"ä¸ºä»€ä¹ˆçº¿ç¨‹é€šä¿¡çš„æ–¹æ³•-wait-ï¼Œnotify-å’Œ-notifyAll-è¢«å®šä¹‰åœ¨-Object-ç±»é‡Œï¼Ÿ\"><a href=\"#ä¸ºä»€ä¹ˆçº¿ç¨‹é€šä¿¡çš„æ–¹æ³•-wait-ï¼Œnotify-å’Œ-notifyAll-è¢«å®šä¹‰åœ¨-Object-ç±»é‡Œï¼Ÿ\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆçº¿ç¨‹é€šä¿¡çš„æ–¹æ³• wait()ï¼Œnotify() å’Œ notifyAll() è¢«å®šä¹‰åœ¨ Object ç±»é‡Œï¼Ÿ\"></a>ä¸ºä»€ä¹ˆçº¿ç¨‹é€šä¿¡çš„æ–¹æ³• wait()ï¼Œnotify() å’Œ notifyAll() è¢«å®šä¹‰åœ¨ Object ç±»é‡Œï¼Ÿ</h4><p>Java ä¸­ï¼Œä»»ä½•å¯¹è±¡éƒ½å¯ä»¥ä½œä¸ºé”ï¼Œå¹¶ä¸”çº¿ç¨‹é€šä¿¡çš„æ–¹æ³• wait()ï¼Œnotify() ç­‰æ–¹æ³•ç”¨äºç­‰å¾…å¯¹è±¡çš„é”æˆ–è€…æ˜¯å”¤é†’çº¿ç¨‹ï¼Œé‚£ä¹ˆè¦æ‰¾ä¸€ä¸ªå¯ä¾›ä»»ä½•å¯¹è±¡ä½¿ç”¨çš„é”ï¼Œå› æ­¤å°†è¿™äº›æ–¹æ³•å®šä¹‰åœ¨ Object ä¸­ï¼ŒObject æ˜¯æ‰€æœ‰ç±»çš„çˆ¶ç±»ã€‚</p>\n<h4 id=\"Thread-ç±»ä¸­çš„-yield-æ–¹æ³•æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ\"><a href=\"#Thread-ç±»ä¸­çš„-yield-æ–¹æ³•æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ\" class=\"headerlink\" title=\"Thread ç±»ä¸­çš„ yield æ–¹æ³•æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ\"></a>Thread ç±»ä¸­çš„ yield æ–¹æ³•æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</h4><p>ä½¿å½“å‰çº¿ç¨‹ä»è¿è¡ŒçŠ¶æ€å˜ä¸ºå°±ç»ªçŠ¶æ€ã€‚</p>\n<h4 id=\"çº¿ç¨‹çš„-sleep-æ–¹æ³•å’Œ-yield-æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"><a href=\"#çº¿ç¨‹çš„-sleep-æ–¹æ³•å’Œ-yield-æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"çº¿ç¨‹çš„ sleep()æ–¹æ³•å’Œ yield()æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"></a>çº¿ç¨‹çš„ sleep()æ–¹æ³•å’Œ yield()æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h4><ol>\n<li><p>sleep() æ–¹æ³•ç»™å…¶ä»–çº¿ç¨‹è¿è¡Œæœºä¼šæ—¶ä¸è€ƒè™‘çº¿ç¨‹çš„ä¼˜å…ˆçº§ï¼Œå› æ­¤ä¼šç»™ä½ä¼˜å…ˆçº§çš„çº¿ç¨‹ä»¥è¿è¡Œçš„æœºä¼šï¼›</p>\n<p> yield() æ–¹æ³•åªä¼šç»™<strong>ç›¸åŒæˆ–æ›´é«˜ä¼˜å…ˆçº§</strong>çš„çº¿ç¨‹ä»¥è¿è¡Œçš„æœºä¼šï¼›</p>\n</li>\n<li><p>çº¿ç¨‹æ‰§è¡Œ sleep() æ–¹æ³•åè½¬å…¥ç­‰å¾…ï¼ˆwaitingï¼‰çŠ¶æ€ï¼Œè€Œæ‰§è¡Œ yield() æ–¹æ³•åè½¬å…¥å°±ç»ªï¼ˆreadyï¼‰çŠ¶æ€ï¼›</p>\n</li>\n</ol>\n<h4 id=\"å¦‚ä½•åœæ­¢ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„çº¿ç¨‹ï¼Ÿ\"><a href=\"#å¦‚ä½•åœæ­¢ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„çº¿ç¨‹ï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•åœæ­¢ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„çº¿ç¨‹ï¼Ÿ\"></a>å¦‚ä½•åœæ­¢ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„çº¿ç¨‹ï¼Ÿ</h4><ol>\n<li>å½“ run æ–¹æ³•å®Œæˆåçº¿ç¨‹ç»ˆæ­¢ï¼›</li>\n<li>ä½¿ç”¨ interrupt æ–¹æ³•ä¸­æ–­çº¿ç¨‹ã€‚</li>\n</ol>\n<h4 id=\"notify-å’Œ-notifyAll-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"><a href=\"#notify-å’Œ-notifyAll-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"notify() å’Œ notifyAll() æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"></a>notify() å’Œ notifyAll() æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h4><p>å¦‚æœçº¿ç¨‹è°ƒç”¨äº†å¯¹è±¡çš„ wait() æ–¹æ³•ï¼Œé‚£ä¹ˆçº¿ç¨‹ä¾¿ä¼šå¤„äºè¯¥å¯¹è±¡çš„ç­‰å¾…æ± ä¸­ï¼Œç­‰å¾…æ± ä¸­çš„çº¿ç¨‹ä¸ä¼šå»ç«äº‰è¯¥å¯¹è±¡çš„é”ã€‚</p>\n<p>notifyAll() ä¼šå”¤é†’æ‰€æœ‰çš„çº¿ç¨‹ï¼Œnotify() åªä¼šå”¤é†’ä¸€ä¸ªçº¿ç¨‹ã€‚</p>\n<p>notifyAll() è°ƒç”¨åï¼Œä¼šå°†å…¨éƒ¨çº¿ç¨‹ç”±ç­‰å¾…æ± ç§»åˆ°é”æ± ï¼Œç„¶åå‚ä¸é”çš„ç«äº‰ï¼Œç«äº‰æˆåŠŸåˆ™ç»§ç»­æ‰§è¡Œï¼Œå¦‚æœä¸æˆåŠŸåˆ™ç•™åœ¨é”æ± ç­‰å¾…é”è¢«é‡Šæ”¾åå†æ¬¡å‚ä¸ç«äº‰ã€‚è€Œ notify()åªä¼šå”¤é†’ä¸€ä¸ªçº¿ç¨‹ï¼Œå…·ä½“å”¤é†’å“ªä¸€ä¸ªçº¿ç¨‹ç”±è™šæ‹Ÿæœºæ§åˆ¶ã€‚</p>\n<h4 id=\"å¦‚ä½•åœ¨ä¸¤ä¸ªçº¿ç¨‹é—´å…±äº«æ•°æ®ï¼Ÿ\"><a href=\"#å¦‚ä½•åœ¨ä¸¤ä¸ªçº¿ç¨‹é—´å…±äº«æ•°æ®ï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•åœ¨ä¸¤ä¸ªçº¿ç¨‹é—´å…±äº«æ•°æ®ï¼Ÿ\"></a>å¦‚ä½•åœ¨ä¸¤ä¸ªçº¿ç¨‹é—´å…±äº«æ•°æ®ï¼Ÿ</h4><p>Java çº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ç”± Java å†…å­˜æ¨¡å‹ï¼ˆç®€ç§° JMMï¼‰æ§åˆ¶ï¼š</p>\n<ol>\n<li>æ‰€æœ‰çš„å…±äº«å˜é‡éƒ½å­˜åœ¨ä¸»å†…å­˜ä¸­</li>\n<li>æ¯ä¸ªçº¿ç¨‹éƒ½ä¿å­˜äº†ä¸€ä»½è¯¥çº¿ç¨‹ä½¿ç”¨åˆ°çš„å…±äº«å˜é‡çš„å‰¯æœ¬</li>\n<li>å¦‚æœçº¿ç¨‹ A ä¸çº¿ç¨‹ B ä¹‹é—´è¦é€šä¿¡ï¼š<ol>\n<li>çº¿ç¨‹ A å°†æœ¬åœ°å†…å­˜ A ä¸­æ›´æ–°è¿‡çš„å…±äº«å˜é‡åˆ·æ–°åˆ°ä¸»å†…å­˜ä¸­å»</li>\n<li>çº¿ç¨‹ B åˆ°ä¸»å†…å­˜ä¸­å»è¯»å–çº¿ç¨‹ A ä¹‹å‰å·²ç»æ›´æ–°è¿‡çš„å…±äº«å˜é‡ã€‚</li>\n</ol>\n</li>\n</ol>\n<h4 id=\"Java-å¦‚ä½•å®ç°å¤šçº¿ç¨‹ä¹‹é—´çš„é€šè®¯å’Œåä½œï¼Ÿ\"><a href=\"#Java-å¦‚ä½•å®ç°å¤šçº¿ç¨‹ä¹‹é—´çš„é€šè®¯å’Œåä½œï¼Ÿ\" class=\"headerlink\" title=\"Java å¦‚ä½•å®ç°å¤šçº¿ç¨‹ä¹‹é—´çš„é€šè®¯å’Œåä½œï¼Ÿ\"></a>Java å¦‚ä½•å®ç°å¤šçº¿ç¨‹ä¹‹é—´çš„é€šè®¯å’Œåä½œï¼Ÿ</h4><p>Java ä¸­çº¿ç¨‹é€šä¿¡åä½œçš„æœ€å¸¸è§çš„ä¸¤ç§æ–¹å¼ï¼š</p>\n<ol>\n<li><p>synchronized åŠ é”çš„çº¿ç¨‹ + Object ç±»çš„ wait()&#x2F;notify()&#x2F;notifyAll()</p>\n</li>\n<li><p>ReentrantLock ç±»åŠ é”çš„çº¿ç¨‹ + Condition ç±»çš„ await()&#x2F;signal()&#x2F;signalAll()</p>\n</li>\n</ol>\n<h4 id=\"åŒæ­¥æ–¹æ³•å’ŒåŒæ­¥å—ï¼Œå“ªä¸ªæ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Ÿ\"><a href=\"#åŒæ­¥æ–¹æ³•å’ŒåŒæ­¥å—ï¼Œå“ªä¸ªæ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Ÿ\" class=\"headerlink\" title=\"åŒæ­¥æ–¹æ³•å’ŒåŒæ­¥å—ï¼Œå“ªä¸ªæ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Ÿ\"></a>åŒæ­¥æ–¹æ³•å’ŒåŒæ­¥å—ï¼Œå“ªä¸ªæ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Ÿ</h4><p>åŒæ­¥çš„èŒƒå›´è¶Šå°è¶Šå¥½ã€‚</p>\n<p>å› æ­¤ï¼ŒåŒæ­¥å—æ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Œå› ä¸ºå®ƒä¸ä¼šé”ä½æ•´ä¸ªå¯¹è±¡ï¼Œè€ŒåŒæ­¥æ–¹æ³•ä¼šé”ä½æ•´ä¸ªå¯¹è±¡ã€‚</p>\n<h4 id=\"ä»€ä¹ˆæ˜¯çº¿ç¨‹åŒæ­¥å’Œçº¿ç¨‹äº’æ–¥ï¼Œæœ‰å“ªå‡ ç§å®ç°æ–¹å¼ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯çº¿ç¨‹åŒæ­¥å’Œçº¿ç¨‹äº’æ–¥ï¼Œæœ‰å“ªå‡ ç§å®ç°æ–¹å¼ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯çº¿ç¨‹åŒæ­¥å’Œçº¿ç¨‹äº’æ–¥ï¼Œæœ‰å“ªå‡ ç§å®ç°æ–¹å¼ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯çº¿ç¨‹åŒæ­¥å’Œçº¿ç¨‹äº’æ–¥ï¼Œæœ‰å“ªå‡ ç§å®ç°æ–¹å¼ï¼Ÿ</h4><p>çº¿ç¨‹åŒæ­¥æ˜¯ä¸¤ä¸ªæˆ–å¤šä¸ªå…±äº«å…³é”®èµ„æºçš„çº¿ç¨‹çš„å¹¶å‘æ‰§è¡Œã€‚åº”è¯¥åŒæ­¥çº¿ç¨‹ä»¥é¿å…å…³é”®çš„èµ„æºä½¿ç”¨å†²çªã€‚</p>\n<p>çº¿ç¨‹äº’æ–¥æ˜¯å¯¹æŸä¸€å…±äº«èµ„æºè€Œè¨€ï¼Œä»»ä½•æ—¶åˆ»æœ€å¤šåªå…è®¸ä¸€ä¸ªçº¿ç¨‹å»ä½¿ç”¨ï¼Œå…¶å®ƒè¦ä½¿ç”¨è¯¥èµ„æºçš„çº¿ç¨‹å¿…é¡»ç­‰å¾…ï¼Œç›´åˆ°å ç”¨èµ„æºè€…é‡Šæ”¾è¯¥èµ„æºã€‚</p>\n<p>å®ç°çº¿ç¨‹åŒæ­¥çš„æ–¹æ³•ï¼š</p>\n<ul>\n<li>åŒæ­¥ä»£ç æ–¹æ³• &#x2F; æ–¹æ³•å—ï¼šsychronized å…³é”®å­—ä¿®é¥°çš„æ–¹æ³• &#x2F; ä»£ç å—</li>\n<li>ä½¿ç”¨ç‰¹æ®Šå˜é‡åŸŸ volatile å®ç°çº¿ç¨‹åŒæ­¥ï¼švolatile å…³é”®å­—ä¸ºåŸŸå˜é‡çš„è®¿é—®æä¾›äº†ä¸€ç§å…é”æœºåˆ¶</li>\n<li>ä½¿ç”¨é‡å…¥é”å®ç°çº¿ç¨‹åŒæ­¥ï¼šreentrantlock ç±»æ˜¯å¯é‡å…¥ã€äº’æ–¥ã€å®ç°äº† lock æ¥å£çš„é”ï¼Œä¸ sychronized æ–¹æ³•å…·æœ‰ç›¸åŒçš„åŸºæœ¬è¡Œä¸ºå’Œè¯­ä¹‰</li>\n</ul>\n<h4 id=\"åœ¨ç›‘è§†å™¨-Monitor-å†…éƒ¨ï¼Œæ˜¯å¦‚ä½•åšçº¿ç¨‹åŒæ­¥çš„ï¼Ÿ\"><a href=\"#åœ¨ç›‘è§†å™¨-Monitor-å†…éƒ¨ï¼Œæ˜¯å¦‚ä½•åšçº¿ç¨‹åŒæ­¥çš„ï¼Ÿ\" class=\"headerlink\" title=\"åœ¨ç›‘è§†å™¨(Monitor)å†…éƒ¨ï¼Œæ˜¯å¦‚ä½•åšçº¿ç¨‹åŒæ­¥çš„ï¼Ÿ\"></a>åœ¨ç›‘è§†å™¨(Monitor)å†…éƒ¨ï¼Œæ˜¯å¦‚ä½•åšçº¿ç¨‹åŒæ­¥çš„ï¼Ÿ</h4><p>åœ¨ Java è™šæ‹Ÿæœºä¸­ï¼Œæ¯ä¸ªå¯¹è±¡å…³è”ä¸€ä¸ª<strong>ç›‘è§†å™¨</strong>ï¼Œä¸ºäº†å®ç°ç›‘è§†å™¨çš„äº’æ–¥åŠŸèƒ½ï¼Œ<strong>æ¯ä¸ªå¯¹è±¡éƒ½å…³è”ç€ä¸€æŠŠé”</strong>ã€‚</p>\n<p>ä¸€æ—¦æ–¹æ³•æˆ–è€…ä»£ç å—è¢« <strong>synchronized</strong> ä¿®é¥°ï¼Œé‚£ä¹ˆè¿™ä¸ªéƒ¨åˆ†å°±æ”¾å…¥äº†ç›‘è§†å™¨çš„ç›‘è§†åŒºåŸŸï¼Œ<strong>ç¡®ä¿ä¸€æ¬¡åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œè¯¥éƒ¨åˆ†çš„ä»£ç </strong>ï¼Œçº¿ç¨‹åœ¨è·å–é”ä¹‹å‰ä¸å…è®¸æ‰§è¡Œè¯¥éƒ¨åˆ†çš„ä»£ç </p>\n<p>å¦å¤– Java è¿˜æä¾›äº†æ˜¾å¼ç›‘è§†å™¨ (Lock) å’Œéšå¼ç›‘è§†å™¨ (synchronized) ä¸¤ç§é”æ–¹æ¡ˆ</p>\n<h4 id=\"Java-çº¿ç¨‹æ•°è¿‡å¤šä¼šé€ æˆä»€ä¹ˆé—®é¢˜ï¼Ÿ\"><a href=\"#Java-çº¿ç¨‹æ•°è¿‡å¤šä¼šé€ æˆä»€ä¹ˆé—®é¢˜ï¼Ÿ\" class=\"headerlink\" title=\"Java çº¿ç¨‹æ•°è¿‡å¤šä¼šé€ æˆä»€ä¹ˆé—®é¢˜ï¼Ÿ\"></a>Java çº¿ç¨‹æ•°è¿‡å¤šä¼šé€ æˆä»€ä¹ˆé—®é¢˜ï¼Ÿ</h4><ul>\n<li><p>æ¶ˆè€—è¿‡å¤šçš„ CPU èµ„æº</p>\n<p>  å¦‚æœå¯è¿è¡Œçš„çº¿ç¨‹æ•°é‡å¤šäºå¯ç”¨å¤„ç†å™¨çš„æ•°é‡ï¼Œé‚£ä¹ˆæœ‰çº¿ç¨‹å°†ä¼šè¢«é—²ç½®ã€‚å¤§é‡ç©ºé—²çš„çº¿ç¨‹ä¼šå ç”¨è®¸å¤šå†…å­˜ï¼Œç»™åƒåœ¾å›æ”¶å™¨å¸¦æ¥å‹åŠ›ã€‚</p>\n</li>\n<li><p>é™ä½ JVM ç¨³å®šæ€§</p>\n<p>  åœ¨å¯åˆ›å»ºçº¿ç¨‹çš„æ•°é‡ä¸Šå­˜åœ¨ä¸€ä¸ªé™åˆ¶ï¼Œè¿™ä¸ªé™åˆ¶å€¼å°†éšç€å¹³å°çš„ä¸åŒè€Œä¸åŒï¼Œå¹¶ä¸”æ‰¿å—ç€å¤šä¸ªå› ç´ åˆ¶çº¦ï¼ŒåŒ…æ‹¬ JVM çš„å¯åŠ¨å‚æ•°ã€Thread æ„é€ å‡½æ•°ä¸­è¯·æ±‚æ ˆçš„å¤§å°ï¼Œä»¥åŠåº•å±‚æ“ä½œç³»ç»Ÿå¯¹çº¿ç¨‹çš„é™åˆ¶ç­‰ã€‚å¦‚æœç ´åäº†è¿™äº›é™åˆ¶ï¼Œé‚£ä¹ˆå¯èƒ½æŠ›å‡º OutOfMemoryError å¼‚å¸¸ã€‚</p>\n</li>\n</ul>\n<h2 id=\"å¹¶å‘å…³é”®å­—\"><a href=\"#å¹¶å‘å…³é”®å­—\" class=\"headerlink\" title=\"å¹¶å‘å…³é”®å­—\"></a>å¹¶å‘å…³é”®å­—</h2><h3 id=\"synchronized\"><a href=\"#synchronized\" class=\"headerlink\" title=\"synchronized\"></a>synchronized</h3><h4 id=\"synchronized-çš„ä½œç”¨ï¼Ÿ\"><a href=\"#synchronized-çš„ä½œç”¨ï¼Ÿ\" class=\"headerlink\" title=\"synchronized çš„ä½œç”¨ï¼Ÿ\"></a>synchronized çš„ä½œç”¨ï¼Ÿ</h4><p>åœ¨ Java ä¸­ï¼Œsynchronized å…³é”®å­—æ˜¯ç”¨æ¥æ§åˆ¶çº¿ç¨‹åŒæ­¥çš„ï¼Œå°±æ˜¯åœ¨å¤šçº¿ç¨‹çš„ç¯å¢ƒä¸‹ï¼Œæ§åˆ¶ synchronized ä»£ç æ®µä¸è¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶æ‰§è¡Œã€‚synchronized å¯ä»¥ä¿®é¥°é™æ€æ–¹æ³•ã€å®ä¾‹æ–¹æ³•ã€ä»£ç å—ã€‚</p>\n<h4 id=\"æ€ä¹ˆä½¿ç”¨-synchronized-å…³é”®å­—\"><a href=\"#æ€ä¹ˆä½¿ç”¨-synchronized-å…³é”®å­—\" class=\"headerlink\" title=\"æ€ä¹ˆä½¿ç”¨ synchronized å…³é”®å­—\"></a>æ€ä¹ˆä½¿ç”¨ synchronized å…³é”®å­—</h4><p><strong>synchronizedå…³é”®å­—æœ€ä¸»è¦çš„ä¸‰ç§ä½¿ç”¨æ–¹å¼ï¼š</strong></p>\n<ul>\n<li><strong>ä¿®é¥°å®ä¾‹æ–¹æ³•ï¼š</strong> ç»™å½“å‰å¯¹è±¡å®ä¾‹åŠ é”ï¼›</li>\n<li><strong>ä¿®é¥°é™æ€æ–¹æ³•ï¼š</strong> ç»™å½“å‰ç±»åŠ é”ï¼›</li>\n<li><strong>ä¿®é¥°ä»£ç å—ï¼š</strong>ç»™æŒ‡å®šå¯¹è±¡åŠ é”ï¼Œè¿›å…¥åŒæ­¥ä»£ç å—å‰è¦è·å¾—æŒ‡å®šå¯¹è±¡çš„é”ã€‚</li>\n</ul>\n<p><strong>æ€»ç»“ï¼š</strong> synchronized å…³é”®å­—åŠ åˆ° static é™æ€æ–¹æ³•å’Œ synchronized(xxx.class) ä»£ç å—ä¸Šéƒ½æ˜¯æ˜¯ç»™ Class ç±»ä¸Šé”ã€‚synchronized å…³é”®å­—åŠ åˆ°å®ä¾‹æ–¹æ³•ä¸Šæ˜¯ç»™å¯¹è±¡å®ä¾‹ä¸Šé”ã€‚</p>\n<h4 id=\"åŒé‡æ ¡éªŒé”å®ç°å¯¹è±¡å•ä¾‹ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰\"><a href=\"#åŒé‡æ ¡éªŒé”å®ç°å¯¹è±¡å•ä¾‹ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰\" class=\"headerlink\" title=\"åŒé‡æ ¡éªŒé”å®ç°å¯¹è±¡å•ä¾‹ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰\"></a>åŒé‡æ ¡éªŒé”å®ç°å¯¹è±¡å•ä¾‹ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Singleton</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">static</span> Singleton uniqueInstance;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"title function_\">Singleton</span><span class=\"params\">()</span> &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Singleton <span class=\"title function_\">getInstance</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// ç¬¬ä¸€æ¬¡å‡å¦‚çº¿ç¨‹1ï¼Œçº¿ç¨‹2ï¼Œçº¿ç¨‹3åˆ°è¾¾è¿™ï¼Œéƒ½åˆ¤æ–­åˆ°nullæœªå®ä¾‹åŒ–ï¼ŒåŠ è¿™ä¸ªåˆ¤æ–­æ˜¯ä¸ºäº†è®©é™¤äº†ç¬¬ä¸€æ¬¡å®ä¾‹åŒ–ä¹‹åçš„å…¶ä»–çº¿ç¨‹åˆ¤æ–­åˆ°éç©ºè¡¨æ˜å·²ç»å®ä¾‹åŒ–è¿‡äº†ï¼Œç›´æ¥è¿”å›å•ä¾‹</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (uniqueInstance == <span class=\"literal\">null</span>) &#123;\t<span class=\"comment\">// çº¿ç¨‹1ã€2ã€3æœ‰å¯èƒ½éƒ½è¿›æ¥äº†</span></span><br><span class=\"line\">            <span class=\"comment\">//ç±»å¯¹è±¡åŠ é”</span></span><br><span class=\"line\">            <span class=\"keyword\">synchronized</span> (Singleton.class) &#123;\t<span class=\"comment\">// å¦‚æœå¤šä¸ªçº¿ç¨‹éƒ½åˆ¤æ–­åˆ°æœªå®ä¾‹åŒ–ï¼Œé‚£ä¹ˆåªä¼šæœ‰ä¸€ä¸ªçº¿ç¨‹é”ä½ç±»å¹¶è¿›è¡Œå®ä¾‹åŒ–</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (uniqueInstance == <span class=\"literal\">null</span>) &#123;\t<span class=\"comment\">// å¦‚æœä¸åŠ è¿™ä¸ªåˆ¤æ–­ï¼Œçº¿ç¨‹1æ‹¿åˆ°é”è¿›è¡Œå®ä¾‹åŒ–ä¹‹åï¼Œçº¿ç¨‹2æ‹¿åˆ°é”ï¼Œè¿›æ¥ç›´æ¥è¿›è¡Œå®ä¾‹åŒ–ï¼Œè¿™å°±äº§ç”Ÿå¤šæ¬¡å®ä¾‹åŒ–æ“ä½œã€‚å¦‚æœåŠ è¿™ä¸ªåˆ¤æ–­ï¼Œçº¿ç¨‹2æ‹¿åˆ°é”ä¹‹åï¼Œåˆ¤æ–­åˆ°å·²ç»å®ä¾‹åŒ–äº†ï¼Œå°±ä¸ä¼šå†è¿›è¡Œå®ä¾‹åŒ–äº†ã€‚</span></span><br><span class=\"line\">                    uniqueInstance = <span class=\"keyword\">new</span> <span class=\"title class_\">Singleton</span>();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> uniqueInstance;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>å¦å¤–ï¼Œéœ€è¦æ³¨æ„ instance é‡‡ç”¨ volatile å…³é”®å­—ä¿®é¥°ä¹Ÿæ˜¯å¾ˆæœ‰å¿…è¦ã€‚</p>\n<p>instance é‡‡ç”¨ volatile å…³é”®å­—ä¿®é¥°ä¹Ÿæ˜¯å¾ˆæœ‰å¿…è¦çš„ï¼Œinstance &#x3D; new Singleton() è¿™æ®µä»£ç å…¶å®æ˜¯åˆ†ä¸ºä¸‰æ­¥æ‰§è¡Œï¼š</p>\n<ol>\n<li>ä¸º instance åˆ†é…å†…å­˜ç©ºé—´</li>\n<li>åˆå§‹åŒ– instance</li>\n<li>å°† instance æŒ‡å‘åˆ†é…çš„å†…å­˜åœ°å€</li>\n</ol>\n<p>ä½†æ˜¯ç”±äº JVM å…·æœ‰æŒ‡ä»¤é‡æ’çš„ç‰¹æ€§ï¼Œæ‰§è¡Œé¡ºåºæœ‰å¯èƒ½å˜æˆ 1-&gt;3-&gt;2ã€‚æŒ‡ä»¤é‡æ’åœ¨å•çº¿ç¨‹ç¯å¢ƒä¸‹ä¸ä¼šå‡ºç°é—®é¢˜ï¼Œä½†æ˜¯åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä¼šå¯¼è‡´ä¸€ä¸ªçº¿ç¨‹è·å¾—è¿˜æ²¡æœ‰åˆå§‹åŒ–çš„å®ä¾‹ã€‚ä¾‹å¦‚ï¼Œçº¿ç¨‹ T1 æ‰§è¡Œäº† 1 å’Œ 3ï¼Œæ­¤æ—¶ T2 è°ƒç”¨ getInstance() åå‘ç° instance ä¸ä¸ºç©ºï¼Œå› æ­¤<strong>è¿”å› T1 å®ä¾‹åŒ–ä½†æœªåˆå§‹åŒ–</strong>çš„ instanceã€‚</p>\n<h4 id=\"synchronized-åº•å±‚å®ç°åŸç†ï¼Ÿï¼ˆç›‘è§†å™¨monitorï¼‰\"><a href=\"#synchronized-åº•å±‚å®ç°åŸç†ï¼Ÿï¼ˆç›‘è§†å™¨monitorï¼‰\" class=\"headerlink\" title=\"synchronized åº•å±‚å®ç°åŸç†ï¼Ÿï¼ˆç›‘è§†å™¨monitorï¼‰\"></a>synchronized åº•å±‚å®ç°åŸç†ï¼Ÿï¼ˆç›‘è§†å™¨monitorï¼‰</h4><p>synchronized æ˜¯ Java ä¸­çš„ä¸€ä¸ªå…³é”®å­—ï¼Œé€šè¿‡ javap å‘½ä»¤ï¼ŒæŸ¥çœ‹ç›¸åº”çš„å­—èŠ‚ç æ–‡ä»¶ã€‚</p>\n<p>synchronized åŒæ­¥è¯­å¥å—çš„æƒ…å†µ</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">SynchronizedDemo</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span> (<span class=\"built_in\">this</span>) &#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;synchronized ä»£ç å—&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>é€šè¿‡ JDK åæ±‡ç¼–æŒ‡ä»¤ javap -c -v SynchronizedDemo</p>\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/image-20220912212554623.png\" alt=\"monitorenter&monitorexit\" style=\"zoom:50%;\" />\n\n<p>å¯ä»¥çœ‹å‡ºåœ¨æ‰§è¡ŒåŒæ­¥ä»£ç å—ä¹‹å‰ä¹‹åéƒ½æœ‰ä¸€ä¸ª monitor å­—æ ·ï¼Œå…¶ä¸­å‰é¢çš„æ˜¯ monitorenterï¼Œåé¢çš„æ˜¯ç¦»å¼€ monitorexitï¼Œä¸éš¾æƒ³è±¡ä¸€ä¸ªçº¿ç¨‹æ‰§è¡ŒåŒæ­¥ä»£ç å—ï¼Œé¦–å…ˆè¦è·å–é”ï¼Œè€Œè·å–é”çš„è¿‡ç¨‹å°±æ˜¯ monitorenter ï¼Œåœ¨æ‰§è¡Œå®Œä»£ç å—ä¹‹åï¼Œè¦é‡Šæ”¾é”ï¼Œé‡Šæ”¾é”å°±æ˜¯æ‰§è¡Œ monitorexit æŒ‡ä»¤ã€‚</p>\n<p>ä¸ºä»€ä¹ˆä¼šæœ‰ä¸¤ä¸ª monitorexit å‘¢ï¼Ÿï¼ˆline 19ï¼‰</p>\n<p>è¿™ä¸ªä¸»è¦æ˜¯é˜²æ­¢åœ¨åŒæ­¥ä»£ç å—ä¸­çº¿ç¨‹å› å¼‚å¸¸é€€å‡ºï¼Œè€Œé”æ²¡æœ‰å¾—åˆ°é‡Šæ”¾ï¼Œè¿™å¿…ç„¶ä¼šé€ æˆæ­»é”ï¼ˆç­‰å¾…çš„çº¿ç¨‹æ°¸è¿œè·å–ä¸åˆ°é”ï¼‰ã€‚<strong>å› æ­¤æœ€åä¸€ä¸ªmonitorexitæ˜¯ä¿è¯åœ¨å¼‚å¸¸æƒ…å†µä¸‹ï¼Œé”ä¹Ÿå¯ä»¥å¾—åˆ°é‡Šæ”¾ï¼Œé¿å…æ­»é”ã€‚</strong></p>\n<h4 id=\"synchronized-å¯é‡å…¥çš„åŸç†\"><a href=\"#synchronized-å¯é‡å…¥çš„åŸç†\" class=\"headerlink\" title=\"synchronized å¯é‡å…¥çš„åŸç†\"></a>synchronized å¯é‡å…¥çš„åŸç†</h4><p>é‡å…¥é”æ˜¯æŒ‡ä¸€ä¸ªçº¿ç¨‹è·å–åˆ°è¯¥é”ä¹‹åï¼Œè¯¥çº¿ç¨‹å¯ä»¥ç»§ç»­è·å¾—è¯¥é”ã€‚<br>åº•å±‚åŸç†ç»´æŠ¤ä¸€ä¸ª<strong>è®¡æ•°å™¨</strong>ï¼Œå½“çº¿ç¨‹è·å–è¯¥é”æ—¶ï¼Œè®¡æ•°å™¨åŠ ä¸€ï¼Œå†æ¬¡è·å¾—è¯¥é”æ—¶ç»§ç»­åŠ ä¸€ï¼Œé‡Šæ”¾é”æ—¶ï¼Œè®¡æ•°å™¨å‡ä¸€ï¼Œå½“è®¡æ•°å™¨å€¼ä¸º 0 æ—¶ï¼Œè¡¨æ˜è¯¥é”æœªè¢«ä»»ä½•çº¿ç¨‹æ‰€æŒæœ‰ï¼Œå…¶å®ƒçº¿ç¨‹å¯ä»¥ç«äº‰è·å–é”ã€‚</p>\n<h4 id=\"ä»€ä¹ˆæ˜¯è‡ªæ—‹\"><a href=\"#ä»€ä¹ˆæ˜¯è‡ªæ—‹\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯è‡ªæ—‹\"></a>ä»€ä¹ˆæ˜¯è‡ªæ—‹</h4><blockquote>\n<p>ä¸è¦é‡åˆ° synchronized å°±è®©ç­‰å¾…é”çš„çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œè€Œæ˜¯è®©è¿™ä¸ªçº¿ç¨‹åœ¨ synchronized è¾¹ç•Œåšå¿™å¾ªç¯</p>\n</blockquote>\n<p>å¾ˆå¤š synchronized é‡Œé¢çš„ä»£ç åªæ˜¯ä¸€äº›å¾ˆç®€å•çš„ä»£ç ï¼Œæ‰§è¡Œæ—¶é—´éå¸¸å¿«ï¼Œæ—¢ç„¶ synchronized é‡Œé¢çš„ä»£ç æ‰§è¡Œå¾—éå¸¸å¿«ï¼Œä¸å¦¨è®©ç­‰å¾…é”çš„çº¿ç¨‹ä¸è¦è¢«é˜»å¡ï¼Œå› ä¸º<strong>çº¿ç¨‹é˜»å¡æ¶‰åŠåˆ°ç”¨æˆ·æ€å’Œå†…æ ¸æ€åˆ‡æ¢çš„é—®é¢˜å¼€é”€å¾ˆå¤§</strong>ï¼Œè€Œæ˜¯<strong>åœ¨ synchronized çš„è¾¹ç•Œåšå¿™å¾ªç¯</strong>ï¼Œè¿™å°±æ˜¯è‡ªæ—‹ã€‚å¦‚æœåšäº†å¤šæ¬¡å¾ªç¯å‘ç°è¿˜æ²¡æœ‰è·å¾—é”ï¼Œå†é˜»å¡ï¼Œè¿™æ ·å¯èƒ½æ˜¯ä¸€ç§æ›´å¥½çš„ç­–ç•¥ã€‚</p>\n<h4 id=\"å¤šçº¿ç¨‹ä¸­-synchronized-é”å‡çº§çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#å¤šçº¿ç¨‹ä¸­-synchronized-é”å‡çº§çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"å¤šçº¿ç¨‹ä¸­ synchronized é”å‡çº§çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>å¤šçº¿ç¨‹ä¸­ synchronized é”å‡çº§çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</h4><blockquote>\n<p>ç›®çš„ï¼šé”å‡çº§æ˜¯ä¸ºäº†å‡ä½äº†é”å¸¦æ¥çš„æ€§èƒ½æ¶ˆè€—ã€‚</p>\n</blockquote>\n<p>Java çš„é”éƒ½æ˜¯åŸºäºå¯¹è±¡çš„ï¼ŒJava å¯¹è±¡æœ‰å¯¹è±¡å¤´ï¼Œå†…å®¹åŒ…æ‹¬ï¼š</p>\n<ol>\n<li>Mark Wordï¼Œå­˜å‚¨å¯¹è±¡çš„ hashCodeã€é”ä¿¡æ¯ç­‰ï¼›</li>\n<li>Class Metadata Addressï¼Œå­˜å‚¨åˆ°å¯¹è±¡ç±»å‹æ•°æ®çš„æŒ‡é’ˆï¼›</li>\n<li>æ•°ç»„çš„é•¿åº¦ï¼ˆå¦‚æœæ˜¯æ•°ç»„ï¼‰</li>\n</ol>\n<p>æ¯ä¸€ä¸ªçº¿ç¨‹åœ¨å‡†å¤‡è·å–å…±äº«èµ„æºæ—¶ï¼š </p>\n<p>ç¬¬ä¸€æ­¥ï¼Œæ£€æŸ¥é”çš„ MarkWord é‡Œé¢æ˜¯ä¸æ˜¯æ”¾çš„è‡ªå·±çš„ ThreadIdï¼Œå¦‚æœæ˜¯ï¼Œè¡¨ç¤ºå½“å‰çº¿ç¨‹æ˜¯å¤„äº â€œ<strong>åå‘é”</strong>â€ ï¼›</p>\n<p>ç¬¬äºŒæ­¥ï¼Œå¦‚æœé”çš„ MarkWord å­˜æ”¾çš„ä¸æ˜¯è‡ªå·±çš„ ThreadIdï¼Œè¿™ä¸ªæ—¶å€™ä¼šå°è¯•ä½¿ç”¨ CAS æ¥æ›¿æ¢ Mark Word é‡Œé¢çš„çº¿ç¨‹ ID ä¸ºæ–°çº¿ç¨‹çš„ IDï¼Œè¿™ä¸ªæ—¶å€™è¦åˆ†ä¸¤ç§æƒ…å†µï¼š</p>\n<ul>\n<li>CAS æ›¿æ¢æˆåŠŸï¼Œè¡¨ç¤ºä¹‹å‰çš„çº¿ç¨‹ä¸å­˜åœ¨äº†ï¼Œ Mark Word é‡Œé¢çš„çº¿ç¨‹ ID ä¸ºæ–°çº¿ç¨‹çš„ IDï¼Œé”ä¸ä¼šå‡çº§ï¼Œä»ç„¶ä¸ºåå‘é”ï¼›</li>\n<li>CAS æ›¿æ¢å¤±è´¥ï¼Œè¡¨ç¤ºä¹‹å‰çš„çº¿ç¨‹ä»ç„¶å­˜åœ¨ï¼Œæ ¹æ®é”çš„ MarkWord é‡Œé¢çš„ ThreadIdï¼Œé€šçŸ¥è¯¥ ThreadId çš„çº¿ç¨‹æš‚åœï¼Œä¹‹å‰çº¿ç¨‹å°† Markword çš„å†…å®¹ç½®ä¸ºç©ºï¼Œå‡çº§ä¸ºè½»é‡çº§é”ï¼Œä¼šæŒ‰ç…§è½»é‡çº§é”çš„æ–¹å¼è¿›è¡Œç«äº‰é”ã€‚</li>\n</ul>\n<p>ç¬¬ä¸‰æ­¥ï¼Œä¸¤ä¸ªçº¿ç¨‹éƒ½æŠŠé”å¯¹è±¡çš„ hashCode å¤åˆ¶åˆ°è‡ªå·±æ–°å»ºçš„ç”¨äºå­˜å‚¨é”çš„è®°å½•ç©ºé—´ï¼Œæ¥ç€å¼€å§‹é€šè¿‡ CAS æ“ä½œï¼Œ æŠŠé”å¯¹è±¡çš„ MarkWord çš„å†…å®¹ä¿®æ”¹ä¸ºè‡ªå·±æ–°å»ºçš„è®°å½•ç©ºé—´çš„åœ°å€çš„æ–¹å¼ç«äº‰ MarkWordï¼›</p>\n<p>ç¬¬å››æ­¥ï¼Œç¬¬ä¸‰æ­¥ä¸­æˆåŠŸæ‰§è¡Œ CAS çš„è·å¾—èµ„æºï¼Œå¤±è´¥çš„åˆ™è¿›å…¥è‡ªæ—‹ ï¼›</p>\n<p>ç¬¬äº”æ­¥ï¼Œè‡ªæ—‹çš„çº¿ç¨‹åœ¨è‡ªæ—‹è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæˆåŠŸè·å¾—èµ„æºï¼ˆå³ä¹‹å‰è·çš„èµ„æºçš„çº¿ç¨‹æ‰§è¡Œå®Œæˆå¹¶é‡Šæ”¾äº†å…±äº«èµ„æºï¼‰ï¼Œåˆ™æ•´ä¸ªçŠ¶æ€ä¾ç„¶å¤„äº <strong>è½»é‡çº§é”</strong>çš„çŠ¶æ€ï¼›å¦‚æœè‡ªæ—‹å¤±è´¥ ï¼ˆè¿™è¾¹çš„è‡ªæ—‹æ–¹å¼å¯ä»¥é‡‡ç”¨é€‚åº”æ€§è‡ªæ—‹ï¼Œç®€å•æ¥è¯´å°±æ˜¯çº¿ç¨‹å¦‚æœè‡ªæ—‹æˆåŠŸäº†ï¼Œåˆ™ä¸‹æ¬¡è‡ªæ—‹çš„æ¬¡æ•°ä¼šæ›´å¤šï¼Œå¦‚æœè‡ªæ—‹å¤±è´¥äº†ï¼Œåˆ™è‡ªæ—‹çš„æ¬¡æ•°å°±ä¼šå‡å°‘ï¼‰ï¼›</p>\n<p>ç¬¬å…­æ­¥ï¼Œè¿›å…¥<strong>é‡é‡çº§é”</strong>çš„çŠ¶æ€ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œè‡ªæ—‹çš„çº¿ç¨‹è¿›å…¥é˜»å¡ï¼Œç­‰å¾…ç«äº‰çº¿ç¨‹æ‰§è¡Œå®Œæˆå¹¶å”¤é†’è‡ªå·±ã€‚</p>\n<h4 id=\"çº¿ç¨‹-B-æ€ä¹ˆçŸ¥é“çº¿ç¨‹-A-ä¿®æ”¹äº†å˜é‡\"><a href=\"#çº¿ç¨‹-B-æ€ä¹ˆçŸ¥é“çº¿ç¨‹-A-ä¿®æ”¹äº†å˜é‡\" class=\"headerlink\" title=\"çº¿ç¨‹ B æ€ä¹ˆçŸ¥é“çº¿ç¨‹ A ä¿®æ”¹äº†å˜é‡\"></a>çº¿ç¨‹ B æ€ä¹ˆçŸ¥é“çº¿ç¨‹ A ä¿®æ”¹äº†å˜é‡</h4><ul>\n<li><p>volatile ä¿®é¥°å˜é‡</p>\n</li>\n<li><p>synchronized ä¿®é¥°ä¿®æ”¹å˜é‡çš„æ–¹æ³•</p>\n</li>\n<li><p>lock å¯¹ä¿®æ”¹å˜é‡çš„ä»£ç å—åŠ é”</p>\n</li>\n</ul>\n<h4 id=\"synchronized-å’Œ-Lock-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"><a href=\"#synchronized-å’Œ-Lock-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"synchronized å’Œ Lock æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"></a>synchronized å’Œ Lock æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h4><ul>\n<li>synchronized æ˜¯ Java å…³é”®å­—ï¼Œè€Œ Lock æ˜¯ä¸ªæ¥å£ï¼›</li>\n<li>synchronized å¯ä»¥ç»™é™æ€æ–¹æ³•ã€å®ä¾‹æ–¹æ³•ã€ä»£ç å—åŠ é”ï¼Œè€Œ lock åªèƒ½ç»™ä»£ç å—åŠ é”ï¼›</li>\n<li>synchronized ä¸éœ€è¦æ‰‹åŠ¨è·å–é”å’Œé‡Šæ”¾é”ï¼Œè€Œ lock éœ€è¦è‡ªå·±åŠ é”å’Œé‡Šæ”¾é”ï¼›</li>\n<li>é€šè¿‡ Lock å¯ä»¥çŸ¥é“æœ‰æ²¡æœ‰æˆåŠŸè·å–é”ï¼Œè€Œ synchronized å´æ— æ³•åŠåˆ°ã€‚</li>\n</ul>\n<h4 id=\"synchronized-å’Œ-ReentrantLock-åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#synchronized-å’Œ-ReentrantLock-åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"synchronized å’Œ ReentrantLock åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>synchronized å’Œ ReentrantLock åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h4><p><strong>ç›¸åŒç‚¹ï¼š</strong></p>\n<p>ä¸¤è€…éƒ½æ˜¯å¯é‡å…¥é”</p>\n<p>â€œå¯é‡å…¥é”â€æ¦‚å¿µæ˜¯ï¼šè‡ªå·±å¯ä»¥å†æ¬¡è·å–è‡ªå·±çš„å†…éƒ¨é”ã€‚æ¯”å¦‚ä¸€ä¸ªçº¿ç¨‹è·å¾—äº†æŸä¸ªå¯¹è±¡çš„é”ï¼Œæ­¤æ—¶è¿™ä¸ªå¯¹è±¡é”è¿˜æ²¡æœ‰é‡Šæ”¾ï¼Œå½“å…¶å†æ¬¡æƒ³è¦è·å–è¿™ä¸ªå¯¹è±¡çš„é”çš„æ—¶å€™è¿˜æ˜¯å¯ä»¥è·å–çš„ï¼Œ<strong>å¦‚æœä¸å¯é”é‡å…¥çš„è¯ï¼Œå°±ä¼šé€ æˆæ­»é”</strong>ã€‚åŒä¸€ä¸ªçº¿ç¨‹æ¯æ¬¡è·å–é”ï¼Œé”çš„è®¡æ•°å™¨éƒ½è‡ªå¢ 1ï¼Œæ‰€ä»¥è¦ç­‰åˆ°é”çš„è®¡æ•°å™¨ä¸‹é™ä¸º 0 æ—¶æ‰èƒ½é‡Šæ”¾é”ã€‚</p>\n<p><strong>ä¸åŒç‚¹ï¼š</strong></p>\n<ul>\n<li>synchronized æ˜¯å…³é”®å­—ï¼ŒReentrantLock æ˜¯ç±»ï¼›</li>\n<li>ReentrantLock åªé€‚ç”¨äºä»£ç å—é”ï¼Œè€Œ synchronized å¯ä»¥ä¿®é¥°ç±»ã€æ–¹æ³•ã€å˜é‡ç­‰ï¼›</li>\n</ul>\n<ul>\n<li>ReentrantLock å¿…é¡»æ‰‹åŠ¨è·å–ä¸é‡Šæ”¾é”ï¼Œè€Œ synchronized ä¸éœ€è¦æ‰‹åŠ¨é‡Šæ”¾å’Œå¼€å¯é”ï¼›</li>\n<li>äºŒè€…çš„é”æœºåˆ¶å…¶å®ä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ï¼š<br>  ReentrantLock åº•å±‚è°ƒç”¨çš„æ˜¯ Unsafe çš„ park æ–¹æ³•åŠ é”ï¼Œsynchronized æ“ä½œçš„åº”è¯¥æ˜¯å¯¹è±¡å¤´ä¸­ mark word</li>\n</ul>\n<h3 id=\"volatile\"><a href=\"#volatile\" class=\"headerlink\" title=\"volatile\"></a>volatile</h3><h4 id=\"ä¸ºä»€ä¹ˆä»£ç ä¼šé‡æ’åºï¼Ÿ\"><a href=\"#ä¸ºä»€ä¹ˆä»£ç ä¼šé‡æ’åºï¼Ÿ\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆä»£ç ä¼šé‡æ’åºï¼Ÿ\"></a>ä¸ºä»€ä¹ˆä»£ç ä¼šé‡æ’åºï¼Ÿ</h4><p>åœ¨æ‰§è¡Œç¨‹åºæ—¶ï¼Œä¸ºäº†<strong>æé«˜æ€§èƒ½</strong>ï¼Œå¤„ç†å™¨å’Œç¼–è¯‘å™¨å¸¸å¸¸ä¼šå¯¹æŒ‡ä»¤è¿›è¡Œé‡æ’åºï¼Œä½†æ˜¯ä¸èƒ½éšæ„é‡æ’åºï¼Œä¸æ˜¯ä½ æƒ³æ€ä¹ˆæ’åºå°±æ€ä¹ˆæ’åºï¼Œå®ƒéœ€è¦æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶ï¼š</p>\n<ul>\n<li><strong>åœ¨å•çº¿ç¨‹ç¯å¢ƒä¸‹ä¸èƒ½æ”¹å˜ç¨‹åºè¿è¡Œçš„ç»“æœï¼›</strong></li>\n<li><strong>å­˜åœ¨æ•°æ®ä¾èµ–å…³ç³»çš„ä¸å…è®¸é‡æ’åº</strong></li>\n</ul>\n<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šé‡æ’åºä¸ä¼šå½±å“å•çº¿ç¨‹ç¯å¢ƒçš„æ‰§è¡Œç»“æœï¼Œä½†æ˜¯ä¼šç ´åå¤šçº¿ç¨‹çš„æ‰§è¡Œè¯­ä¹‰ã€‚</p>\n<h4 id=\"as-if-serial-è§„åˆ™å’Œ-happens-before-è§„åˆ™çš„åŒºåˆ«\"><a href=\"#as-if-serial-è§„åˆ™å’Œ-happens-before-è§„åˆ™çš„åŒºåˆ«\" class=\"headerlink\" title=\"as-if-serial è§„åˆ™å’Œ happens-before è§„åˆ™çš„åŒºåˆ«\"></a>as-if-serial è§„åˆ™å’Œ happens-before è§„åˆ™çš„åŒºåˆ«</h4><ul>\n<li>as-if-serial è§„åˆ™ä¿è¯ <strong>å•çº¿ç¨‹</strong> å†…ç¨‹åºçš„æ‰§è¡Œç»“æœä¸è¢«æ”¹å˜ï¼Œhappens-before è§„åˆ™ä¿è¯ <strong>æ­£ç¡®åŒæ­¥çš„å¤šçº¿ç¨‹</strong> ç¨‹åºçš„æ‰§è¡Œç»“æœä¸è¢«æ”¹å˜ã€‚</li>\n<li>as-if-serial è¯­ä¹‰å’Œ happens-before è¿™ä¹ˆåšçš„ç›®çš„ï¼Œéƒ½æ˜¯ä¸ºäº†åœ¨ä¸æ”¹å˜ç¨‹åºæ‰§è¡Œç»“æœçš„å‰æä¸‹ï¼Œå°½å¯èƒ½åœ°æé«˜ç¨‹åºæ‰§è¡Œçš„å¹¶è¡Œåº¦ã€‚</li>\n</ul>\n<h4 id=\"volatile-å…³é”®å­—çš„ä½œç”¨\"><a href=\"#volatile-å…³é”®å­—çš„ä½œç”¨\" class=\"headerlink\" title=\"volatile å…³é”®å­—çš„ä½œç”¨\"></a>volatile å…³é”®å­—çš„ä½œç”¨</h4><p>å¯¹äºå¯è§æ€§ï¼ŒJava æä¾›äº† volatile å…³é”®å­—æ¥ä¿è¯å¯è§æ€§å’Œæœ‰åºæ€§ï¼ˆç¦æ­¢æŒ‡ä»¤é‡æ’ï¼‰ï¼Œä½†ä¸èƒ½ä¿è¯åŸå­æ€§ã€‚ volatile æä¾› happens-before çš„ä¿è¯ï¼Œç¡®ä¿ä¸€ä¸ªçº¿ç¨‹çš„ä¿®æ”¹èƒ½å¯¹å…¶ä»–çº¿ç¨‹æ˜¯å¯è§çš„ã€‚å½“ä¸€ä¸ªå…±äº«å˜é‡è¢« volatile ä¿®é¥°æ—¶ï¼Œå®ƒä¼šä¿è¯ä¿®æ”¹çš„å€¼ä¼šç«‹å³è¢«æ›´æ–°åˆ°ä¸»å­˜ï¼Œå½“æœ‰å…¶ä»–çº¿ç¨‹éœ€è¦è¯»å–æ—¶ï¼Œå®ƒä¼šå»å†…å­˜ä¸­è¯»å–æ–°å€¼ã€‚</p>\n<h4 id=\"JMMå†…å­˜å±éšœæ’å…¥ç­–ç•¥\"><a href=\"#JMMå†…å­˜å±éšœæ’å…¥ç­–ç•¥\" class=\"headerlink\" title=\"JMMå†…å­˜å±éšœæ’å…¥ç­–ç•¥\"></a>JMMå†…å­˜å±éšœæ’å…¥ç­–ç•¥</h4><p><strong>æ’å…¥å±éšœ</strong></p>\n<p>StoreStore å±éšœ - volatile å†™ - StoreLoad å±éšœ</p>\n<p>volatile è¯» - LoadLoad å±éšœ - LoadStore å±éšœ</p>\n<p><strong>volatile ä¸æ™®é€šå˜é‡çš„é‡æ’åºè§„åˆ™</strong></p>\n<ol>\n<li>å¦‚æœç¬¬ä¸€ä¸ªæ“ä½œæ˜¯ volatile è¯»ï¼Œé‚£æ— è®ºç¬¬äºŒä¸ªæ“ä½œæ˜¯ä»€ä¹ˆï¼Œéƒ½ä¸èƒ½é‡æ’åºï¼›</li>\n<li>å¦‚æœç¬¬äºŒä¸ªæ“ä½œæ˜¯ volatile å†™ï¼Œé‚£æ— è®ºç¬¬ä¸€ä¸ªæ“ä½œæ˜¯ä»€ä¹ˆï¼Œéƒ½ä¸èƒ½é‡æ’åºï¼›</li>\n<li>å¦‚æœç¬¬ä¸€ä¸ªæ“ä½œæ˜¯ volatile å†™ï¼Œç¬¬äºŒä¸ªæ“ä½œæ˜¯ volatile è¯»ï¼Œé‚£ä¸èƒ½é‡æ’åºã€‚</li>\n</ol>\n<h4 id=\"volatile-èƒ½ä½¿å¾—ä¸€ä¸ªéåŸå­æ“ä½œå˜æˆåŸå­æ“ä½œå—ï¼Ÿ\"><a href=\"#volatile-èƒ½ä½¿å¾—ä¸€ä¸ªéåŸå­æ“ä½œå˜æˆåŸå­æ“ä½œå—ï¼Ÿ\" class=\"headerlink\" title=\"volatile èƒ½ä½¿å¾—ä¸€ä¸ªéåŸå­æ“ä½œå˜æˆåŸå­æ“ä½œå—ï¼Ÿ\"></a>volatile èƒ½ä½¿å¾—ä¸€ä¸ªéåŸå­æ“ä½œå˜æˆåŸå­æ“ä½œå—ï¼Ÿ</h4><p>volatile åªèƒ½ä¿è¯å¯è§æ€§å’Œæœ‰åºæ€§è€Œä¸èƒ½ä¿è¯åŸå­æ€§ï¼Œä½†ç”¨ volatile ä¿®é¥° long å’Œ double å¯ä»¥ä¿è¯å…¶æ“ä½œåŸå­æ€§ã€‚</p>\n<h4 id=\"volatile-ä¿®é¥°ç¬¦çš„æœ‰è¿‡ä»€ä¹ˆå®è·µï¼Ÿ\"><a href=\"#volatile-ä¿®é¥°ç¬¦çš„æœ‰è¿‡ä»€ä¹ˆå®è·µï¼Ÿ\" class=\"headerlink\" title=\"volatile ä¿®é¥°ç¬¦çš„æœ‰è¿‡ä»€ä¹ˆå®è·µï¼Ÿ\"></a>volatile ä¿®é¥°ç¬¦çš„æœ‰è¿‡ä»€ä¹ˆå®è·µï¼Ÿ</h4><p>å•ä¾‹æ¨¡å¼-åŒé‡é”æ£€éªŒé‡Œé¢ç”¨ volatile ä¿®é¥°å®ä¾‹å˜é‡ã€‚</p>\n<h4 id=\"volatile-å’Œ-synchronized-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#volatile-å’Œ-synchronized-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"volatile å’Œ synchronized çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>volatile å’Œ synchronized çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h4><ul>\n<li>volatile æ˜¯å˜é‡ä¿®é¥°ç¬¦ï¼›synchronized å¯ä»¥ä¿®é¥°ç±»ã€æ–¹æ³•ã€ä»£ç å—ï¼›</li>\n<li>volatile ä»…èƒ½å®ç°å˜é‡çš„ä¿®æ”¹å¯è§æ€§å’Œæœ‰åºæ€§ï¼Œä¸èƒ½ä¿è¯åŸå­æ€§ï¼Œ<br>  è€Œ synchronized åˆ™å¯ä»¥ä¿è¯å˜é‡çš„ä¿®æ”¹åŸå­æ€§å’Œå¯è§æ€§ï¼›</li>\n<li>volatile ä¸ä¼šé€ æˆçº¿ç¨‹çš„é˜»å¡ï¼›synchronized å¯èƒ½ä¼šé€ æˆçº¿ç¨‹çš„é˜»å¡ï¼›</li>\n<li><strong>volatileå…³é”®å­—</strong>æ˜¯çº¿ç¨‹åŒæ­¥çš„<strong>è½»é‡çº§å®ç°</strong>ï¼Œæ‰€ä»¥<strong>volatileæ€§èƒ½è‚¯å®šæ¯”synchronizedå…³é”®å­—è¦å¥½</strong>ã€‚synchronized å…³é”®å­—åœ¨ JavaSE1.6 ä¹‹åè¿›è¡Œäº†ä¸»è¦åŒ…æ‹¬ä¸ºäº†<strong>å‡å°‘è·å¾—é”å’Œé‡Šæ”¾é”å¸¦æ¥çš„æ€§èƒ½æ¶ˆè€—</strong>è€Œå¼•å…¥çš„åå‘é”å’Œè½»é‡çº§é”ä»¥åŠå…¶å®ƒå„ç§ä¼˜åŒ–ä¹‹åæ‰§è¡Œæ•ˆç‡æœ‰äº†æ˜¾è‘—æå‡ï¼Œ<strong>å®é™…å¼€å‘ä¸­ä½¿ç”¨ synchronized å…³é”®å­—çš„åœºæ™¯è¿˜æ˜¯æ›´å¤šä¸€äº›</strong>ã€‚</li>\n</ul>\n<h2 id=\"Lock-ä½“ç³»\"><a href=\"#Lock-ä½“ç³»\" class=\"headerlink\" title=\"Lock ä½“ç³»\"></a>Lock ä½“ç³»</h2><h3 id=\"Lock-ç®€ä»‹\"><a href=\"#Lock-ç®€ä»‹\" class=\"headerlink\" title=\"Lock ç®€ä»‹\"></a>Lock ç®€ä»‹</h3><h4 id=\"Lock-æ¥å£æ˜¯ä»€ä¹ˆï¼Ÿå¯¹æ¯”åŒæ­¥å®ƒæœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ\"><a href=\"#Lock-æ¥å£æ˜¯ä»€ä¹ˆï¼Ÿå¯¹æ¯”åŒæ­¥å®ƒæœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ\" class=\"headerlink\" title=\"Lock æ¥å£æ˜¯ä»€ä¹ˆï¼Ÿå¯¹æ¯”åŒæ­¥å®ƒæœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ\"></a>Lock æ¥å£æ˜¯ä»€ä¹ˆï¼Ÿå¯¹æ¯”åŒæ­¥å®ƒæœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ</h4><p>Lock æ¥å£æ¯”åŒæ­¥æ–¹æ³•å’ŒåŒæ­¥å—æä¾›äº†æ›´å…·æ‰©å±•æ€§çš„é”æ“ä½œã€‚</p>\n<p>ï¼ˆ1ï¼‰å¯ä»¥ä½¿é”æ›´<strong>å…¬å¹³</strong></p>\n<p>ï¼ˆ2ï¼‰å¯ä»¥ä½¿çº¿ç¨‹åœ¨<strong>ç­‰å¾…é”çš„æ—¶å€™å“åº”ä¸­æ–­</strong></p>\n<p>ï¼ˆ3ï¼‰å¯ä»¥<strong>è®©çº¿ç¨‹å°è¯•è·å–é”ï¼Œå¹¶åœ¨æ— æ³•è·å–é”çš„æ—¶å€™ç«‹å³è¿”å›æˆ–è€…ç­‰å¾…ä¸€æ®µæ—¶é—´</strong></p>\n<h4 id=\"ä¹è§‚é”å’Œæ‚²è§‚é”çš„ç†è§£åŠå¦‚ä½•å®ç°ï¼Œæœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ\"><a href=\"#ä¹è§‚é”å’Œæ‚²è§‚é”çš„ç†è§£åŠå¦‚ä½•å®ç°ï¼Œæœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ\" class=\"headerlink\" title=\"ä¹è§‚é”å’Œæ‚²è§‚é”çš„ç†è§£åŠå¦‚ä½•å®ç°ï¼Œæœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ\"></a>ä¹è§‚é”å’Œæ‚²è§‚é”çš„ç†è§£åŠå¦‚ä½•å®ç°ï¼Œæœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ</h4><p>æ‚²è§‚é”ï¼šæ€»æ˜¯å‡è®¾æœ€åçš„æƒ…å†µï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¼šä¿®æ”¹ï¼Œæ‰€ä»¥æ¯æ¬¡åœ¨æ‹¿æ•°æ®çš„æ—¶å€™éƒ½ä¼šä¸Šé”ï¼Œè¿™æ ·åˆ«äººæƒ³æ‹¿è¿™ä¸ªæ•°æ®å°±ä¼šé˜»å¡ç›´åˆ°å®ƒæ‹¿åˆ°é”ã€‚<br>    ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“é‡Œè¾¹å°±ç”¨åˆ°äº†å¾ˆå¤šè¿™ç§é”æœºåˆ¶ï¼Œæ¯”å¦‚è¡Œé”ï¼Œè¡¨é”ç­‰ï¼Œè¯»é”ï¼Œå†™é”ç­‰ï¼Œéƒ½æ˜¯åœ¨åšæ“ä½œä¹‹å‰å…ˆä¸Šé”ã€‚å†æ¯”å¦‚ Java é‡Œé¢çš„åŒæ­¥åŸè¯­ synchronized å…³é”®å­—çš„å®ç°ä¹Ÿæ˜¯æ‚²è§‚é”ã€‚</p>\n<p>ä¹è§‚é”ï¼šé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¾ˆä¹è§‚ï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¸ä¼šä¿®æ”¹ï¼Œæ‰€ä»¥ä¸ä¼šä¸Šé”ï¼Œä½†æ˜¯åœ¨æ›´æ–°çš„æ—¶å€™ä¼šåˆ¤æ–­ä¸€ä¸‹åœ¨æ­¤æœŸé—´åˆ«äººæœ‰æ²¡æœ‰å»æ›´æ–°è¿™ä¸ªæ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ç‰ˆæœ¬å·ç­‰æœºåˆ¶ã€‚<br>    ä¹è§‚é”é€‚ç”¨äºå¤šè¯»çš„åº”ç”¨ç±»å‹ï¼Œè¿™æ ·å¯ä»¥æé«˜ååé‡ï¼Œæ¯”å¦‚ atomic åŒ…ä¸‹é¢çš„åŸå­å˜é‡ç±»å°±æ˜¯ä½¿ç”¨äº†ä¹è§‚é”çš„ä¸€ç§å®ç°æ–¹å¼ CAS å®ç°çš„ã€‚</p>\n<h4 id=\"ä»€ä¹ˆæ˜¯-CAS\"><a href=\"#ä»€ä¹ˆæ˜¯-CAS\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ CAS\"></a>ä»€ä¹ˆæ˜¯ CAS</h4><p>CAS æ˜¯ compare and swap çš„ç¼©å†™ï¼Œå³æˆ‘ä»¬æ‰€è¯´çš„æ¯”è¾ƒäº¤æ¢ï¼Œæ˜¯ä¸€ç§ä¹è§‚é”æ“ä½œã€‚</p>\n<p>CAS æ“ä½œåŒ…å«ä¸‰ä¸ªæ“ä½œæ•° â€”â€” å†…å­˜ä½ç½®ï¼ˆVï¼‰ã€é¢„æœŸåŸå€¼ï¼ˆAï¼‰å’Œæ–°å€¼ï¼ˆBï¼‰ã€‚</p>\n<p>å¦‚æœå†…å­˜åœ°å€ V é‡Œé¢çš„å€¼å’Œ A çš„å€¼æ˜¯ä¸€æ ·çš„ï¼Œé‚£ä¹ˆå°±å°†å†…å­˜é‡Œé¢çš„å€¼æ›´æ–°æˆ Bã€‚</p>\n<h4 id=\"Javaå®ç°CASçš„åŸç†-Unsafeç±»\"><a href=\"#Javaå®ç°CASçš„åŸç†-Unsafeç±»\" class=\"headerlink\" title=\"Javaå®ç°CASçš„åŸç† - Unsafeç±»\"></a>Javaå®ç°CASçš„åŸç† - Unsafeç±»</h4><p>åœ¨ Java ä¸­ï¼Œæœ‰ä¸€ä¸ª<code>Unsafe</code>ç±»ï¼Œå®ƒåœ¨<code>sun.misc</code>åŒ…ä¸­ã€‚å®ƒé‡Œé¢æ˜¯ä¸€äº›<code>native</code>æ–¹æ³•ï¼ˆç”±åº•å±‚çš„ JVM ä½¿ç”¨ C æˆ–è€… C++å»å®ç°ï¼‰ï¼Œå…¶ä¸­å°±æœ‰å‡ ä¸ªå…³äº CAS çš„ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">boolean</span> <span class=\"title function_\">compareAndSwapObject</span><span class=\"params\">(Object o, <span class=\"type\">long</span> offset,Object expected, Object x)</span>;</span><br><span class=\"line\"><span class=\"type\">boolean</span> <span class=\"title function_\">compareAndSwapInt</span><span class=\"params\">(Object o, <span class=\"type\">long</span> offset,<span class=\"type\">int</span> expected,<span class=\"type\">int</span> x)</span>;</span><br><span class=\"line\"><span class=\"type\">boolean</span> <span class=\"title function_\">compareAndSwapLong</span><span class=\"params\">(Object o, <span class=\"type\">long</span> offset,<span class=\"type\">long</span> expected,<span class=\"type\">long</span> x)</span>;</span><br></pre></td></tr></table></figure>\n\n<p>å½“ç„¶ï¼Œä»–ä»¬éƒ½æ˜¯<code>public native</code>çš„ã€‚</p>\n<p>Unsafe ä¸­å¯¹ CAS çš„å®ç°æ˜¯ C++ å†™çš„ï¼Œå®ƒçš„å…·ä½“å®ç°å’Œæ“ä½œç³»ç»Ÿã€CPU éƒ½æœ‰å…³ç³»ã€‚</p>\n<p>Linux çš„ X86 ä¸‹ä¸»è¦æ˜¯é€šè¿‡<code>cmpxchgl</code>è¿™ä¸ªæŒ‡ä»¤åœ¨ CPU çº§å®Œæˆ CAS æ“ä½œçš„ï¼Œä½†åœ¨å¤šå¤„ç†å™¨æƒ…å†µä¸‹å¿…é¡»ä½¿ç”¨<code>lock</code>æŒ‡ä»¤åŠ é”æ¥å®Œæˆã€‚å½“ç„¶ä¸åŒçš„æ“ä½œç³»ç»Ÿå’Œå¤„ç†å™¨çš„å®ç°ä¼šæœ‰æ‰€ä¸åŒï¼Œå¤§å®¶å¯ä»¥è‡ªè¡Œäº†è§£ã€‚</p>\n<p>å½“ç„¶ï¼ŒUnsafe ç±»é‡Œé¢è¿˜æœ‰å…¶å®ƒæ–¹æ³•ç”¨äºä¸åŒçš„ç”¨é€”ã€‚æ¯”å¦‚æ”¯æŒçº¿ç¨‹æŒ‚èµ·å’Œæ¢å¤çš„<code>park</code>å’Œ<code>unpark</code>ï¼Œ LockSupport ç±»åº•å±‚å°±æ˜¯è°ƒç”¨äº†è¿™ä¸¤ä¸ªæ–¹æ³•ã€‚è¿˜æœ‰æ”¯æŒåå°„æ“ä½œçš„<code>allocateInstance()</code>æ–¹æ³•ã€‚</p>\n<h4 id=\"CAS-ä¼šäº§ç”Ÿä»€ä¹ˆé—®é¢˜ï¼Ÿ\"><a href=\"#CAS-ä¼šäº§ç”Ÿä»€ä¹ˆé—®é¢˜ï¼Ÿ\" class=\"headerlink\" title=\"CAS ä¼šäº§ç”Ÿä»€ä¹ˆé—®é¢˜ï¼Ÿ\"></a>CAS ä¼šäº§ç”Ÿä»€ä¹ˆé—®é¢˜ï¼Ÿ</h4><p>1ã€<strong>ABA é—®é¢˜</strong>ï¼š</p>\n<p>æ¯”å¦‚è¯´ä¸€ä¸ªçº¿ç¨‹ one ä»å†…å­˜ä½ç½® V ä¸­å–å‡º Aï¼Œè¿™æ—¶å€™å¦ä¸€ä¸ªçº¿ç¨‹ two ä¹Ÿä»å†…å­˜ä¸­å–å‡º Aï¼Œå¹¶ä¸” two è¿›è¡Œäº†ä¸€äº›æ“ä½œå˜æˆäº† Bï¼Œç„¶å two åˆå°† V ä½ç½®çš„æ•°æ®å˜æˆ Aï¼Œè¿™æ—¶å€™çº¿ç¨‹ one è¿›è¡Œ CAS æ“ä½œå‘ç°å†…å­˜ä¸­ä»ç„¶æ˜¯ Aï¼Œç„¶å one æ“ä½œæˆåŠŸã€‚å°½ç®¡çº¿ç¨‹ one çš„ CAS æ“ä½œæˆåŠŸï¼Œä½†å¯èƒ½å­˜åœ¨æ½œè—çš„é—®é¢˜ã€‚å¯ä»¥åœ¨å˜é‡ä¸ŠåŠ ä¸€ä¸ªç‰ˆæœ¬æˆ³ã€‚ä» Java1.5 å¼€å§‹ JDK çš„ atomic åŒ…é‡Œæä¾›äº†ä¸€ä¸ªç±» AtomicStampedReference æ¥è§£å†³ ABA é—®é¢˜ã€‚</p>\n<p>2ã€<strong>å¾ªç¯æ—¶é—´é•¿å¼€é”€å¤§</strong>ï¼š</p>\n<p>å¯¹äºèµ„æºç«äº‰ä¸¥é‡ï¼ˆçº¿ç¨‹å†²çªä¸¥é‡ï¼‰çš„æƒ…å†µï¼ŒCAS è‡ªæ—‹çš„æ¦‚ç‡ä¼šæ¯”è¾ƒå¤§ï¼Œä»è€Œæµªè´¹æ›´å¤šçš„ CPU èµ„æºï¼Œæ•ˆç‡ä½äº synchronizedã€‚</p>\n<p>3ã€<strong>åªèƒ½ä¿è¯ä¸€ä¸ªå…±äº«å˜é‡çš„åŸå­æ“ä½œ</strong>ï¼š</p>\n<p>å½“å¯¹ä¸€ä¸ªå…±äº«å˜é‡æ‰§è¡Œæ“ä½œæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¾ªç¯ CAS çš„æ–¹å¼æ¥ä¿è¯åŸå­æ“ä½œï¼Œä½†æ˜¯<strong>å¯¹å¤šä¸ªå…±äº«å˜é‡æ“ä½œæ—¶ï¼Œå¾ªç¯ CAS å°±æ— æ³•ä¿è¯æ“ä½œçš„åŸå­æ€§ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ç”¨é”</strong>ã€‚</p>\n<h4 id=\"æ­»é”ä¸æ´»é”çš„åŒºåˆ«ï¼Œæ­»é”ä¸é¥¥é¥¿çš„åŒºåˆ«ï¼Ÿ\"><a href=\"#æ­»é”ä¸æ´»é”çš„åŒºåˆ«ï¼Œæ­»é”ä¸é¥¥é¥¿çš„åŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"æ­»é”ä¸æ´»é”çš„åŒºåˆ«ï¼Œæ­»é”ä¸é¥¥é¥¿çš„åŒºåˆ«ï¼Ÿ\"></a>æ­»é”ä¸æ´»é”çš„åŒºåˆ«ï¼Œæ­»é”ä¸é¥¥é¥¿çš„åŒºåˆ«ï¼Ÿ</h4><blockquote>\n<p>åŒºåˆ«ï¼šæ­»é”åŠ¨ä¸äº†äº†ï¼›æ´»é”ä¸€ç›´é‡å¤å°è¯•ã€å¤±è´¥ã€å°è¯•ã€å¤±è´¥ã€‚</p>\n</blockquote>\n<p>æ­»é”ï¼šæ˜¯æŒ‡ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„è¿›ç¨‹ï¼ˆæˆ–çº¿ç¨‹ï¼‰åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå› äº‰å¤ºèµ„æºè€Œé€ æˆçš„ä¸€ç§äº’ç›¸ç­‰å¾…çš„ç°è±¡ï¼Œè‹¥æ— å¤–åŠ›ä½œç”¨ï¼Œå®ƒä»¬éƒ½å°†æ— æ³•æ¨è¿›ä¸‹å»ã€‚</p>\n<p>æ´»é”ï¼šä»»åŠ¡æˆ–è€…æ‰§è¡Œè€…æ²¡æœ‰è¢«é˜»å¡ï¼Œç”±äºæŸäº›æ¡ä»¶æ²¡æœ‰æ»¡è¶³ï¼Œå¯¼è‡´<strong>ä¸€ç›´é‡å¤å°è¯•ï¼Œå¤±è´¥ï¼Œå°è¯•ï¼Œå¤±è´¥</strong>ã€‚</p>\n<p>æ´»é”å’Œæ­»é”çš„åŒºåˆ«åœ¨äºï¼Œå¤„äºæ´»é”çš„å®ä½“æ˜¯åœ¨ä¸æ–­çš„æ”¹å˜çŠ¶æ€ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„â€œæ´»â€ï¼Œ è€Œå¤„äºæ­»é”çš„å®ä½“è¡¨ç°ä¸ºç­‰å¾…ï¼›æ´»é”æœ‰å¯èƒ½è‡ªè¡Œè§£å¼€ï¼Œæ­»é”åˆ™ä¸èƒ½ã€‚</p>\n<p>é¥¥é¥¿ï¼šä¸€ä¸ªæˆ–è€…å¤šä¸ªçº¿ç¨‹å› ä¸ºç§ç§åŸå› æ— æ³•è·å¾—æ‰€éœ€è¦çš„èµ„æºï¼Œå¯¼è‡´ä¸€ç›´æ— æ³•æ‰§è¡Œçš„çŠ¶æ€ã€‚</p>\n<p>Java ä¸­å¯¼è‡´é¥¥é¥¿çš„åŸå› ï¼šé«˜ä¼˜å…ˆçº§çº¿ç¨‹åå™¬æ‰€æœ‰çš„ä½ä¼˜å…ˆçº§çº¿ç¨‹çš„ CPU æ—¶é—´ã€‚</p>\n<h3 id=\"AQSè¯¦è§£\"><a href=\"#AQSè¯¦è§£\" class=\"headerlink\" title=\"AQSè¯¦è§£\"></a>AQSè¯¦è§£</h3><h4 id=\"AQS-ä»‹ç»\"><a href=\"#AQS-ä»‹ç»\" class=\"headerlink\" title=\"AQS ä»‹ç»\"></a>AQS ä»‹ç»</h4><p>AQS çš„å…¨ç§°ä¸ºï¼ˆAbstractQueuedSynchronizerï¼‰ï¼ŒæŠ½è±¡é˜Ÿåˆ—åŒæ­¥å™¨ã€‚</p>\n<p>ä½¿ç”¨ AQS èƒ½ç®€å•ä¸”é«˜æ•ˆåœ°æ„é€ å‡ºåº”ç”¨å¹¿æ³›çš„å¤§é‡çš„åŒæ­¥å™¨ï¼Œæ¯”å¦‚æˆ‘ä»¬æåˆ°çš„ ReentrantLockï¼ŒSemaphoreï¼Œå…¶ä»–çš„è¯¸å¦‚ ReentrantReadWriteLockï¼ŒSynchronousQueueï¼ŒFutureTask ç­‰ç­‰çš†æ˜¯åŸºäº AQS çš„ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬è‡ªå·±ä¹Ÿèƒ½åˆ©ç”¨ AQS éå¸¸è½»æ¾å®¹æ˜“åœ°æ„é€ å‡ºç¬¦åˆæˆ‘ä»¬è‡ªå·±éœ€æ±‚çš„åŒæ­¥å™¨ã€‚</p>\n<h4 id=\"AQS-åŸç†åˆ†æ\"><a href=\"#AQS-åŸç†åˆ†æ\" class=\"headerlink\" title=\"AQS åŸç†åˆ†æ\"></a>AQS åŸç†åˆ†æ</h4><p><strong>å¦‚æœè¢«è¯·æ±‚çš„å…±äº«èµ„æºç©ºé—²ï¼Œåˆ™å°†å½“å‰è¯·æ±‚èµ„æºçš„çº¿ç¨‹è®¾ç½®ä¸ºæœ‰æ•ˆçš„å·¥ä½œçº¿ç¨‹ï¼Œå¹¶ä¸”å°†å…±äº«èµ„æºè®¾ç½®ä¸ºé”å®šçŠ¶æ€ã€‚<br>å¦‚æœè¢«è¯·æ±‚çš„å…±äº«èµ„æºè¢«å ç”¨ï¼Œé‚£ä¹ˆå°±ä½¿ç”¨ CLH é˜Ÿåˆ—ï¼Œå°†æš‚æ—¶è·å–ä¸åˆ°é”çš„çº¿ç¨‹åŠ å…¥åˆ°é˜Ÿåˆ—ä¸­ã€‚</strong></p>\n<blockquote>\n<p>CLH(Craig,Landin,and Hagersten)é˜Ÿåˆ—æ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„åŒå‘é˜Ÿåˆ—ï¼ˆè™šæ‹Ÿçš„åŒå‘é˜Ÿåˆ—å³ä¸å­˜åœ¨é˜Ÿåˆ—å®ä¾‹ï¼Œä»…å­˜åœ¨ç»“ç‚¹ä¹‹é—´çš„å…³è”å…³ç³»ï¼‰ã€‚AQS æ˜¯å°†æ¯æ¡è¯·æ±‚å…±äº«èµ„æºçš„çº¿ç¨‹å°è£…æˆä¸€ä¸ª CLH é˜Ÿåˆ—çš„ä¸€ä¸ªç»“ç‚¹ï¼ˆNodeï¼‰æ¥å®ç°é”çš„åˆ†é…ã€‚</p>\n</blockquote>\n<p>çœ‹ä¸ª AQS(AbstractQueuedSynchronizer)åŸç†å›¾ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes11474088-c906e727d699fa9c.png\" alt=\"AQSåŸç†å›¾\"></p>\n<p>AQS ä½¿ç”¨ä¸€ä¸ª volatile int ç±»å‹çš„æˆå‘˜å˜é‡ state æ¥è¡¨ç¤ºåŒæ­¥çŠ¶æ€ï¼Œé€šè¿‡å†…ç½®çš„ CLH é˜Ÿåˆ—æ¥å®Œæˆè·å–èµ„æºçº¿ç¨‹çš„æ’é˜Ÿå·¥ä½œã€‚AQS ä½¿ç”¨ CAS å¯¹è¯¥åŒæ­¥çŠ¶æ€è¿›è¡ŒåŸå­æ“ä½œå®ç°å¯¹å…¶å€¼çš„ä¿®æ”¹ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> <span class=\"type\">int</span> state;\t<span class=\"comment\">// å…±äº«å˜é‡ï¼Œä½¿ç”¨volatileä¿®é¥°ä¿è¯çº¿ç¨‹å¯è§æ€§</span></span><br></pre></td></tr></table></figure>\n\n<p>çŠ¶æ€ä¿¡æ¯é€šè¿‡ protected ç±»å‹çš„ getStateï¼ŒsetStateï¼ŒcompareAndSetState è¿›è¡Œæ“ä½œ</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// è¿”å›åŒæ­¥çŠ¶æ€çš„å½“å‰å€¼</span></span><br><span class=\"line\"><span class=\"keyword\">protected</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"title function_\">getState</span><span class=\"params\">()</span> &#123;  </span><br><span class=\"line\">    <span class=\"keyword\">return</span> state;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// è®¾ç½®åŒæ­¥çŠ¶æ€çš„å€¼</span></span><br><span class=\"line\"><span class=\"keyword\">protected</span> <span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title function_\">setState</span><span class=\"params\">(<span class=\"type\">int</span> newState)</span> &#123; </span><br><span class=\"line\">    state = newState;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// åŸå­åœ°ï¼ˆCASæ“ä½œï¼‰å°†åŒæ­¥çŠ¶æ€å€¼è®¾ç½®ä¸ºç»™å®šå€¼updateå¦‚æœå½“å‰åŒæ­¥çŠ¶æ€çš„å€¼ç­‰äºexpectï¼ˆæœŸæœ›å€¼ï¼‰</span></span><br><span class=\"line\"><span class=\"keyword\">protected</span> <span class=\"keyword\">final</span> <span class=\"type\">boolean</span> <span class=\"title function_\">compareAndSetState</span><span class=\"params\">(<span class=\"type\">int</span> expect, <span class=\"type\">int</span> update)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> unsafe.compareAndSwapInt(<span class=\"built_in\">this</span>, stateOffset, expect, update);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>AQS å¯¹èµ„æºçš„å…±äº«æ–¹å¼</strong></p>\n<p>AQS å®šä¹‰ä¸¤ç§èµ„æºå…±äº«æ–¹å¼</p>\n<ul>\n<li><strong>Exclusive</strong>ï¼ˆç‹¬å ï¼‰ï¼šåªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æ‰§è¡Œï¼Œå¦‚ ReentrantLockã€‚åˆå¯åˆ†ä¸ºå…¬å¹³é”å’Œéå…¬å¹³é”ï¼š<ul>\n<li>å…¬å¹³é”ï¼šæŒ‰ç…§çº¿ç¨‹åœ¨é˜Ÿåˆ—ä¸­çš„æ’é˜Ÿé¡ºåºï¼Œå…ˆåˆ°è€…å…ˆæ‹¿åˆ°é”</li>\n<li>éå…¬å¹³é”ï¼šå½“çº¿ç¨‹è¦è·å–é”æ—¶ï¼Œæ— è§†é˜Ÿåˆ—é¡ºåºç›´æ¥å»æŠ¢é”ï¼Œè°æŠ¢åˆ°å°±æ˜¯è°çš„</li>\n</ul>\n</li>\n<li><strong>Share</strong>ï¼ˆå…±äº«ï¼‰ï¼šå¤šä¸ªçº¿ç¨‹å¯åŒæ—¶æ‰§è¡Œï¼Œå¦‚ Semaphore&#x2F;CountDownLatchã€‚Semaphoreã€CountDownLatchã€ CyclicBarrierã€ReadWriteLock æˆ‘ä»¬éƒ½ä¼šåœ¨åé¢è®²åˆ°ã€‚</li>\n</ul>\n<p><strong>AQSåº•å±‚ä½¿ç”¨äº†æ¨¡æ¿æ–¹æ³•æ¨¡å¼</strong></p>\n<p>åŒæ­¥å™¨çš„è®¾è®¡æ˜¯åŸºäºæ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„ï¼Œå¦‚æœéœ€è¦è‡ªå®šä¹‰åŒæ­¥å™¨ï¼ˆ<strong>æ¨¡æ¿æ–¹æ³•æ¨¡å¼</strong>å¾ˆç»å…¸çš„ä¸€ä¸ªåº”ç”¨ï¼‰ï¼š</p>\n<ol>\n<li>ä½¿ç”¨è€…ç»§æ‰¿ AQS å¹¶é‡å†™æŒ‡å®šçš„æ–¹æ³•ã€‚ï¼ˆå¯¹å…±äº«èµ„æº state çš„è·å–å’Œé‡Šæ”¾ï¼‰</li>\n<li>è°ƒç”¨ AQS çš„æ¨¡æ¿æ–¹æ³•ï¼Œä¼šè¿›ä¸€æ­¥è°ƒç”¨ä½¿ç”¨è€…é‡å†™çš„æ–¹æ³•ã€‚</li>\n</ol>\n<p><strong>AQSä½¿ç”¨äº†æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼Œè‡ªå®šä¹‰åŒæ­¥å™¨æ—¶éœ€è¦é‡å†™ä¸‹é¢å‡ ä¸ªAQSæä¾›çš„æ¨¡æ¿æ–¹æ³•ï¼š</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">isHeldExclusively()\t<span class=\"comment\">// è¯¥çº¿ç¨‹æ˜¯å¦æ­£åœ¨ç‹¬å èµ„æºã€‚åªæœ‰ç”¨åˆ°conditionæ‰éœ€è¦å»å®ç°å®ƒã€‚</span></span><br><span class=\"line\">tryAcquire(<span class=\"type\">int</span>)\t<span class=\"comment\">// ç‹¬å æ–¹å¼ã€‚å°è¯•è·å–èµ„æºï¼ŒæˆåŠŸåˆ™è¿”å›trueï¼Œå¤±è´¥åˆ™è¿”å›falseã€‚</span></span><br><span class=\"line\">tryRelease(<span class=\"type\">int</span>)\t<span class=\"comment\">// ç‹¬å æ–¹å¼ã€‚å°è¯•é‡Šæ”¾èµ„æºï¼ŒæˆåŠŸåˆ™è¿”å›trueï¼Œå¤±è´¥åˆ™è¿”å›falseã€‚</span></span><br><span class=\"line\">tryAcquireShared(<span class=\"type\">int</span>)\t<span class=\"comment\">// å…±äº«æ–¹å¼ã€‚å°è¯•è·å–èµ„æºã€‚è´Ÿæ•°è¡¨ç¤ºå¤±è´¥ï¼›0è¡¨ç¤ºæˆåŠŸï¼Œä½†æ²¡æœ‰å‰©ä½™å¯ç”¨èµ„æºï¼›æ­£æ•°è¡¨ç¤ºæˆåŠŸï¼Œä¸”æœ‰å‰©ä½™èµ„æºã€‚</span></span><br><span class=\"line\">tryReleaseShared(<span class=\"type\">int</span>)\t<span class=\"comment\">// å…±äº«æ–¹å¼ã€‚å°è¯•é‡Šæ”¾èµ„æºï¼ŒæˆåŠŸåˆ™è¿”å›trueï¼Œå¤±è´¥åˆ™è¿”å›falseã€‚</span></span><br></pre></td></tr></table></figure>\n\n<p>ä»¥ ReentrantLock ä¸ºä¾‹ï¼Œstate åˆå§‹åŒ–ä¸º 0ï¼Œè¡¨ç¤ºæœªé”å®šçŠ¶æ€ã€‚A çº¿ç¨‹ lock() æ—¶ï¼Œä¼šè°ƒç”¨ tryAcquire() ç‹¬å è¯¥é”å¹¶å°† state+1ã€‚æ­¤åï¼Œå…¶ä»–çº¿ç¨‹å† tryAcquire() æ—¶å°±ä¼šå¤±è´¥ï¼Œç›´åˆ° A çº¿ç¨‹ unlock( )åˆ° state&#x3D;0ï¼ˆå³é‡Šæ”¾é”ï¼‰ä¸ºæ­¢ï¼Œå…¶å®ƒçº¿ç¨‹æ‰æœ‰æœºä¼šè·å–è¯¥é”ã€‚å½“ç„¶ï¼Œé‡Šæ”¾é”ä¹‹å‰ï¼ŒA çº¿ç¨‹è‡ªå·±æ˜¯å¯ä»¥é‡å¤è·å–æ­¤é”çš„ï¼ˆstate ä¼šç´¯åŠ ï¼‰ï¼Œè¿™å°±æ˜¯å¯é‡å…¥çš„æ¦‚å¿µã€‚</p>\n<p>ä»¥ CountDownLatch ä»¥ä¾‹ï¼Œä»»åŠ¡åˆ†ä¸º N ä¸ªå­çº¿ç¨‹å»æ‰§è¡Œï¼Œstate ä¹Ÿåˆå§‹åŒ–ä¸º Nï¼ˆæ³¨æ„ N è¦ä¸çº¿ç¨‹ä¸ªæ•°ä¸€è‡´ï¼‰ã€‚è¿™ N ä¸ªå­çº¿ç¨‹æ˜¯å¹¶è¡Œæ‰§è¡Œçš„ï¼Œæ¯ä¸ªå­çº¿ç¨‹æ‰§è¡Œå®Œå countDown() ä¸€æ¬¡ï¼Œstate ä¼š CAS å‡ 1ã€‚ç­‰åˆ°æ‰€æœ‰å­çº¿ç¨‹éƒ½æ‰§è¡Œå®Œåï¼ˆå³ state&#x3D;0ï¼‰ï¼Œä¼š unpark() ä¸»è°ƒç”¨çº¿ç¨‹ï¼Œç„¶åä¸»è°ƒç”¨çº¿ç¨‹å°±ä¼šä» await() å‡½æ•°è¿”å›ï¼Œç»§ç»­åç»­åŠ¨ä½œã€‚</p>\n<p>ä¸€èˆ¬æ¥è¯´ï¼Œè‡ªå®šä¹‰åŒæ­¥å™¨è¦ä¹ˆæ˜¯ç‹¬å æ–¹æ³•ï¼Œè¦ä¹ˆæ˜¯å…±äº«æ–¹å¼ï¼Œä»–ä»¬ä¹Ÿåªéœ€å®ç°<code>tryAcquire-tryRelease</code>ã€<code>tryAcquireShared-tryReleaseShared</code>ä¸­çš„ä¸€ç§å³å¯ã€‚ä½† AQS ä¹Ÿæ”¯æŒè‡ªå®šä¹‰åŒæ­¥å™¨åŒæ—¶å®ç°ç‹¬å å’Œå…±äº«ä¸¤ç§æ–¹å¼ï¼Œå¦‚<code>ReentrantReadWriteLock</code>ã€‚</p>\n<h3 id=\"è¯»å†™é”\"><a href=\"#è¯»å†™é”\" class=\"headerlink\" title=\"è¯»å†™é”\"></a>è¯»å†™é”</h3><p>é¦–å…ˆæ˜ç¡®ä¸€ä¸‹ï¼Œä¸æ˜¯è¯´ ReentrantLock ä¸å¥½ï¼Œåªæ˜¯ ReentrantLock æŸäº›æ—¶å€™æœ‰å±€é™ã€‚å¦‚æœä½¿ç”¨ ReentrantLockï¼Œå¯èƒ½æœ¬èº«æ˜¯ä¸ºäº†é˜²æ­¢çº¿ç¨‹ A åœ¨å†™æ•°æ®ã€çº¿ç¨‹ B åœ¨è¯»æ•°æ®é€ æˆçš„æ•°æ®ä¸ä¸€è‡´ï¼Œä½†è¿™æ ·ï¼Œå¦‚æœçº¿ç¨‹ C åœ¨è¯»æ•°æ®ã€çº¿ç¨‹ D ä¹Ÿåœ¨è¯»æ•°æ®ï¼Œè¯»æ•°æ®æ˜¯ä¸ä¼šæ”¹å˜æ•°æ®çš„ï¼Œæ²¡æœ‰å¿…è¦åŠ é”ï¼Œä½†æ˜¯è¿˜æ˜¯åŠ é”äº†ï¼Œé™ä½äº†ç¨‹åºçš„æ€§èƒ½ã€‚å› ä¸ºè¿™ä¸ªï¼Œæ‰è¯ç”Ÿäº†è¯»å†™é” ReadWriteLockã€‚</p>\n<p>ReadWriteLock æ˜¯ä¸€ä¸ªè¯»å†™é”æ¥å£ï¼Œè¯»å†™é”æ˜¯ç”¨æ¥æå‡å¹¶å‘ç¨‹åºæ€§èƒ½çš„é”åˆ†ç¦»æŠ€æœ¯ï¼ŒReentrantReadWriteLock æ˜¯ ReadWriteLock æ¥å£çš„ä¸€ä¸ªå…·ä½“å®ç°ï¼Œ<strong>å®ç°äº†è¯»å†™çš„åˆ†ç¦»ï¼Œè¯»é”æ˜¯å…±äº«çš„ï¼Œå†™é”æ˜¯ç‹¬å çš„</strong>ï¼Œè¯»å’Œè¯»ä¹‹é—´ä¸ä¼šäº’æ–¥ï¼Œè¯»å’Œå†™ã€å†™å’Œè¯»ã€å†™å’Œå†™ä¹‹é—´æ‰ä¼šäº’æ–¥ï¼Œæå‡äº†è¯»å†™çš„æ€§èƒ½ã€‚</p>\n<h2 id=\"å¹¶å‘å®¹å™¨\"><a href=\"#å¹¶å‘å®¹å™¨\" class=\"headerlink\" title=\"å¹¶å‘å®¹å™¨\"></a>å¹¶å‘å®¹å™¨</h2><h3 id=\"ConcurrentHashMap\"><a href=\"#ConcurrentHashMap\" class=\"headerlink\" title=\"ConcurrentHashMap\"></a>ConcurrentHashMap</h3><h4 id=\"ä»€ä¹ˆæ˜¯ConcurrentHashMapï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯ConcurrentHashMapï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ConcurrentHashMapï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯ConcurrentHashMapï¼Ÿ</h4><p>ConcurrentHashMap æ˜¯ Java ä¸­çš„ä¸€ä¸ª<strong>çº¿ç¨‹å®‰å…¨ä¸”é«˜æ•ˆçš„HashMapå®ç°</strong>ã€‚</p>\n<p>é‚£ä¹ˆå®ƒåˆ°åº•æ˜¯å¦‚ä½•å®ç°çº¿ç¨‹å®‰å…¨çš„ï¼Ÿ</p>\n<p>JDK 1.6 ç‰ˆæœ¬å…³é”®è¦ç´ ï¼š</p>\n<ul>\n<li>segment ç»§æ‰¿äº† ReentrantLock å……å½“é”çš„è§’è‰²ï¼Œä¸ºæ¯ä¸€ä¸ª segment æä¾›äº†çº¿ç¨‹å®‰å…¨çš„ä¿éšœï¼›</li>\n<li>segment ç»´æŠ¤äº†å“ˆå¸Œæ•£åˆ—è¡¨çš„è‹¥å¹²ä¸ªæ¡¶ï¼Œæ¯ä¸ªæ¡¶ç”± HashEntry æ„æˆçš„é“¾è¡¨ã€‚</li>\n</ul>\n<p>JDK1.8 åï¼ŒConcurrentHashMap æŠ›å¼ƒäº†åŸæœ‰çš„ Segment åˆ†æ®µé”ï¼Œè€Œ<strong>é‡‡ç”¨äº† CAS + synchronized æ¥ä¿è¯å¹¶å‘å®‰å…¨æ€§</strong>ã€‚</p>\n<p>æ’å…¥å…ƒç´ è¿‡ç¨‹ï¼š</p>\n<p>å¦‚æœç›¸åº”ä½ç½®çš„ Node è¿˜æ²¡æœ‰åˆå§‹åŒ–ï¼Œåˆ™è°ƒç”¨ CAS æ’å…¥ç›¸åº”çš„æ•°æ®ï¼›</p>\n<p>å¦‚æœç›¸åº”ä½ç½®çš„ Node ä¸ä¸ºç©ºï¼Œåˆ™å¯¹è¯¥èŠ‚ç‚¹åŠ  synchronized é”è¿›è¡Œæ’å…¥æˆ–æ›´æ–°æ“ä½œã€‚</p>\n<h3 id=\"CopyOnWriteArrayList\"><a href=\"#CopyOnWriteArrayList\" class=\"headerlink\" title=\"CopyOnWriteArrayList\"></a>CopyOnWriteArrayList</h3><p>CopyOnWrite å®¹å™¨å³<strong>å†™æ—¶å¤åˆ¶çš„å®¹å™¨</strong>ï¼Œå½“æˆ‘ä»¬å¾€ä¸€ä¸ªå®¹å™¨ä¸­æ·»åŠ å…ƒç´ çš„æ—¶å€™ï¼Œä¸ç›´æ¥å¾€å®¹å™¨ä¸­æ·»åŠ ï¼Œè€Œæ˜¯å°†å½“å‰å®¹å™¨è¿›è¡Œ copyï¼Œå¤åˆ¶å‡ºæ¥ä¸€ä¸ªæ–°çš„å®¹å™¨ï¼Œç„¶åå‘æ–°å®¹å™¨ä¸­æ·»åŠ æˆ‘ä»¬éœ€è¦çš„å…ƒç´ ï¼Œæœ€åå°†åŸå®¹å™¨çš„å¼•ç”¨æŒ‡å‘æ–°å®¹å™¨ã€‚</p>\n<p><strong>CopyOnWriteArrayList çš„ä½¿ç”¨åœºæ™¯</strong></p>\n<p>é€šè¿‡æºç åˆ†æï¼Œæˆ‘ä»¬çœ‹å‡ºå®ƒçš„ä¼˜ç¼ºç‚¹æ¯”è¾ƒæ˜æ˜¾ï¼Œæ‰€ä»¥ä½¿ç”¨åœºæ™¯ä¹Ÿå°±æ¯”è¾ƒæ˜æ˜¾ã€‚å°±æ˜¯åˆé€‚è¯»å¤šå†™å°‘çš„åœºæ™¯ã€‚</p>\n<p><strong>CopyOnWriteArrayList çš„ç¼ºç‚¹</strong></p>\n<ol>\n<li>ç”±äºå†™æ“ä½œçš„æ—¶å€™ï¼Œéœ€è¦æ‹·è´æ•°ç»„ï¼Œä¼šæ¶ˆè€—å†…å­˜ï¼Œå¦‚æœåŸæ•°ç»„çš„å†…å®¹æ¯”è¾ƒå¤šçš„æƒ…å†µä¸‹ï¼Œå¯èƒ½å¯¼è‡´ young gc æˆ–è€… full gcã€‚</li>\n<li><strong>ä¸èƒ½ç”¨äºå®æ—¶è¯»çš„åœºæ™¯</strong>ï¼Œåƒæ‹·è´æ•°ç»„ã€æ–°å¢å…ƒç´ éƒ½éœ€è¦æ—¶é—´ï¼Œæ‰€ä»¥è°ƒç”¨ä¸€ä¸ª set æ“ä½œåï¼Œ<strong>è¯»å–åˆ°æ•°æ®å¯èƒ½è¿˜æ˜¯æ—§çš„</strong>ï¼Œè™½ç„¶ CopyOnWriteArrayList èƒ½åšåˆ°æœ€ç»ˆä¸€è‡´æ€§,ä½†æ˜¯è¿˜æ˜¯æ²¡æ³•æ»¡è¶³å®æ—¶æ€§è¦æ±‚ã€‚</li>\n</ol>\n<h3 id=\"ThreadLocal\"><a href=\"#ThreadLocal\" class=\"headerlink\" title=\"ThreadLocal\"></a>ThreadLocal</h3><h4 id=\"ThreadLocalçš„æ•°æ®ç»“æ„\"><a href=\"#ThreadLocalçš„æ•°æ®ç»“æ„\" class=\"headerlink\" title=\"ThreadLocalçš„æ•°æ®ç»“æ„\"></a>ThreadLocalçš„æ•°æ®ç»“æ„</h4><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesthreadlocal%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84.a0bfadf8.png\" alt=\"ThreadLocalæ•°æ®ç»“æ„\" style=\"zoom: 67%;\" />\n\n<p>æ¯ä¸ªçº¿ç¨‹ Thread ä¸­æœ‰ä¸€ä¸ªç±»å‹ä¸º ThreadLocal.ThreadLocalMap çš„å®ä¾‹å˜é‡ threadLocalsï¼Œè¯¥å®ä¾‹å˜é‡ä¸­æ¯ä¸ª entry ä¸º &lt;threadLocal çš„å¼±å¼•ç”¨ï¼Œvalue ä¸ºå¼ºå¼•ç”¨&gt; çš„æ˜ å°„ï¼Œæ¯ä¸ªçº¿ç¨‹å¾€ threadLocal ä¸­å¯¹ value è¿›è¡Œæ“ä½œæ—¶ï¼Œéƒ½æ˜¯åœ¨è‡ªå·±çº¿ç¨‹ç§æœ‰çš„ threadLocalMap ä¸­è¿›è¡Œæ“ä½œï¼Œä»è€Œè¾¾åˆ°çº¿ç¨‹éš”ç¦»ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadLocalDemo</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// private static final ThreadLocal&lt;Integer&gt; threadLocal = new ThreadLocal&lt;Integer&gt;()&#123;</span></span><br><span class=\"line\">    <span class=\"comment\">//     @Override</span></span><br><span class=\"line\">    <span class=\"comment\">//     protected Integer initialValue() &#123;</span></span><br><span class=\"line\">    <span class=\"comment\">//         return 0;</span></span><br><span class=\"line\">    <span class=\"comment\">//     &#125;</span></span><br><span class=\"line\">    <span class=\"comment\">// &#125;;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> ThreadLocal&lt;Integer&gt; threadLocal = ThreadLocal.withInitial(() -&gt; <span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">2</span>; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">                <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">j</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; j &lt; <span class=\"number\">5</span>; j++) &#123;</span><br><span class=\"line\">                    <span class=\"type\">Integer</span> <span class=\"variable\">val</span> <span class=\"operator\">=</span> threadLocal.get();</span><br><span class=\"line\">                    threadLocal.set(++val);</span><br><span class=\"line\">                    System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; ---- &quot;</span> + val);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;, <span class=\"string\">&quot;Thread-&quot;</span> + i).start();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            Thread.sleep(<span class=\"number\">10</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; ---- &quot;</span> + threadLocal.get());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>æ‰“å°ç»“æœï¼šå¯åŠ¨äº† 2 ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹æœ€åéƒ½æ‰“å°åˆ° 5ï¼Œ æœ€å threadLocal.get ä»ç„¶æ˜¯ 0</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Thread-<span class=\"number\">1</span> ---- <span class=\"number\">1</span></span><br><span class=\"line\">Thread-<span class=\"number\">0</span> ---- <span class=\"number\">1</span></span><br><span class=\"line\">Thread-<span class=\"number\">1</span> ---- <span class=\"number\">2</span></span><br><span class=\"line\">Thread-<span class=\"number\">0</span> ---- <span class=\"number\">2</span></span><br><span class=\"line\">Thread-<span class=\"number\">1</span> ---- <span class=\"number\">3</span></span><br><span class=\"line\">Thread-<span class=\"number\">1</span> ---- <span class=\"number\">4</span></span><br><span class=\"line\">Thread-<span class=\"number\">1</span> ---- <span class=\"number\">5</span></span><br><span class=\"line\">Thread-<span class=\"number\">0</span> ---- <span class=\"number\">3</span></span><br><span class=\"line\">Thread-<span class=\"number\">0</span> ---- <span class=\"number\">4</span></span><br><span class=\"line\">Thread-<span class=\"number\">0</span> ---- <span class=\"number\">5</span></span><br><span class=\"line\">main ---- <span class=\"number\">0</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"ThreadLocalå†…å­˜æ³„æ¼\"><a href=\"#ThreadLocalå†…å­˜æ³„æ¼\" class=\"headerlink\" title=\"ThreadLocalå†…å­˜æ³„æ¼\"></a>ThreadLocalå†…å­˜æ³„æ¼</h3><h4 id=\"ThreadLocalé€ æˆå†…å­˜æ³„æ¼çš„åŸå› ï¼Ÿ\"><a href=\"#ThreadLocalé€ æˆå†…å­˜æ³„æ¼çš„åŸå› ï¼Ÿ\" class=\"headerlink\" title=\"ThreadLocalé€ æˆå†…å­˜æ³„æ¼çš„åŸå› ï¼Ÿ\"></a>ThreadLocalé€ æˆå†…å­˜æ³„æ¼çš„åŸå› ï¼Ÿ</h4><p>ThreadLocalMap ä¸­ä½¿ç”¨çš„ key ä¸º ThreadLocal çš„å¼±å¼•ç”¨,è€Œ value æ˜¯å¼ºå¼•ç”¨ã€‚æ‰€ä»¥ï¼Œå¦‚æœ ThreadLocal æ²¡æœ‰è¢«å¤–éƒ¨å¼ºå¼•ç”¨çš„æƒ…å†µä¸‹ï¼Œåœ¨åƒåœ¾å›æ”¶çš„æ—¶å€™ï¼Œkey ä¼šè¢«æ¸…ç†æ‰ï¼Œè€Œ value ä¸ä¼šè¢«æ¸…ç†æ‰ã€‚è¿™æ ·ä¸€æ¥ï¼ŒThreadLocalMap ä¸­å°±ä¼šå‡ºç° key ä¸º null çš„ Entryã€‚å‡å¦‚æˆ‘ä»¬ä¸åšä»»ä½•æªæ–½çš„è¯ï¼Œvalue æ°¸è¿œæ— æ³•è¢« GC å›æ”¶ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯èƒ½ä¼šäº§ç”Ÿå†…å­˜æ³„éœ²ã€‚ThreadLocalMap å®ç°ä¸­å·²ç»è€ƒè™‘äº†è¿™ç§æƒ…å†µï¼Œæ¯æ¬¡ä½¿ç”¨å®Œ ThreadLocal åï¼Œéƒ½è°ƒç”¨å®ƒçš„ remove()æ–¹æ³•ï¼Œæ¸…ç†æ‰ key ä¸º null çš„è®°å½•ã€‚</p>\n<h3 id=\"BlockingQueue\"><a href=\"#BlockingQueue\" class=\"headerlink\" title=\"BlockingQueue\"></a>BlockingQueue</h3><p>é˜»å¡é˜Ÿåˆ—ï¼ˆBlockingQueueï¼‰æ˜¯ä¸€ä¸ªæ”¯æŒä¸¤ä¸ªé™„åŠ æ“ä½œçš„é˜Ÿåˆ—ã€‚</p>\n<p>åœ¨é˜Ÿåˆ—ä¸ºç©ºæ—¶ï¼Œè·å–å…ƒç´ çš„çº¿ç¨‹ä¼šç­‰å¾…é˜Ÿåˆ—å˜ä¸ºéç©ºã€‚å½“é˜Ÿåˆ—æ»¡æ—¶ï¼Œå­˜å‚¨å…ƒç´ çš„çº¿ç¨‹ä¼šç­‰å¾…é˜Ÿåˆ—å¯ç”¨ã€‚</p>\n<p>é˜»å¡é˜Ÿåˆ—å¸¸ç”¨äºç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„åœºæ™¯ï¼Œç”Ÿäº§è€…æ˜¯å¾€é˜Ÿåˆ—é‡Œæ·»åŠ å…ƒç´ çš„çº¿ç¨‹ï¼Œæ¶ˆè´¹è€…æ˜¯ä»é˜Ÿåˆ—é‡Œæ‹¿å…ƒç´ çš„çº¿ç¨‹ã€‚é˜»å¡é˜Ÿåˆ—å°±æ˜¯ç”Ÿäº§è€…å­˜æ”¾å…ƒç´ çš„å®¹å™¨ï¼Œè€Œæ¶ˆè´¹è€…ä¹Ÿåªä»å®¹å™¨é‡Œæ‹¿å…ƒç´ ã€‚</p>\n<p>JDK7 æä¾›äº† 7 ä¸ªé˜»å¡é˜Ÿåˆ—ã€‚åˆ†åˆ«æ˜¯ï¼š</p>\n<blockquote>\n<p>ArrayBlockingQueue ï¼šä¸€ä¸ªç”±æ•°ç»„ç»“æ„ç»„æˆçš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—ã€‚<br>LinkedBlockingQueue ï¼šä¸€ä¸ªç”±é“¾è¡¨ç»“æ„ç»„æˆçš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—ã€‚<br>PriorityBlockingQueue ï¼šä¸€ä¸ªæ”¯æŒä¼˜å…ˆçº§æ’åºçš„æ— ç•Œé˜»å¡é˜Ÿåˆ—ã€‚<br>DelayQueueï¼šä¸€ä¸ªä½¿ç”¨ä¼˜å…ˆçº§é˜Ÿåˆ—å®ç°çš„æ— ç•Œé˜»å¡é˜Ÿåˆ—ã€‚<br>SynchronousQueueï¼šä¸€ä¸ªä¸å­˜å‚¨å…ƒç´ çš„é˜»å¡é˜Ÿåˆ—ã€‚<br>LinkedTransferQueueï¼šä¸€ä¸ªç”±é“¾è¡¨ç»“æ„ç»„æˆçš„æ— ç•Œé˜»å¡é˜Ÿåˆ—ã€‚<br>LinkedBlockingDequeï¼šä¸€ä¸ªç”±é“¾è¡¨ç»“æ„ç»„æˆçš„åŒå‘é˜»å¡é˜Ÿåˆ—ã€‚</p>\n</blockquote>\n<p>Java 5 ä¹‹å‰å®ç°åŒæ­¥å­˜å–æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æ™®é€šçš„ä¸€ä¸ªé›†åˆï¼Œç„¶ååœ¨ä½¿ç”¨çº¿ç¨‹çš„åä½œå’Œçº¿ç¨‹åŒæ­¥å¯ä»¥å®ç°ç”Ÿäº§è€…ï¼Œæ¶ˆè´¹è€…æ¨¡å¼ï¼Œä¸»è¦çš„æŠ€æœ¯å°±æ˜¯ç”¨å¥½ waitï¼Œnotifyï¼ŒnotifyAllï¼Œsynchronized è¿™äº›å…³é”®å­—ã€‚è€Œåœ¨ Java 5 ä¹‹åï¼Œå¯ä»¥ä½¿ç”¨é˜»å¡é˜Ÿåˆ—æ¥å®ç°ï¼Œæ­¤æ–¹å¼å¤§å¤§ç®€å°‘äº†ä»£ç é‡ï¼Œä½¿å¾—å¤šçº¿ç¨‹ç¼–ç¨‹æ›´åŠ å®¹æ˜“ï¼Œå®‰å…¨æ–¹é¢ä¹Ÿæœ‰ä¿éšœã€‚</p>\n<p>BlockingQueue æ¥å£æ˜¯ Queue çš„å­æ¥å£ï¼Œå®ƒçš„ä¸»è¦ç”¨é€”å¹¶ä¸æ˜¯ä½œä¸ºå®¹å™¨ï¼Œè€Œæ˜¯ä½œä¸ºçº¿ç¨‹åŒæ­¥çš„çš„å·¥å…·ï¼Œå› æ­¤ä»–å…·æœ‰ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„ç‰¹æ€§ï¼Œ<strong>å½“ç”Ÿäº§è€…çº¿ç¨‹è¯•å›¾å‘ BlockingQueue æ”¾å…¥å…ƒç´ æ—¶ï¼Œå¦‚æœé˜Ÿåˆ—å·²æ»¡ï¼Œåˆ™çº¿ç¨‹è¢«é˜»å¡ï¼Œå½“æ¶ˆè´¹è€…çº¿ç¨‹è¯•å›¾ä»ä¸­å–å‡ºä¸€ä¸ªå…ƒç´ æ—¶ï¼Œå¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™è¯¥çº¿ç¨‹ä¼šè¢«é˜»å¡</strong>ï¼Œæ­£æ˜¯å› ä¸ºå®ƒæ‰€å…·æœ‰è¿™ä¸ªç‰¹æ€§ï¼Œæ‰€ä»¥åœ¨ç¨‹åºä¸­å¤šä¸ªçº¿ç¨‹äº¤æ›¿å‘ BlockingQueue ä¸­æ”¾å…¥å…ƒç´ ï¼Œå–å‡ºå…ƒç´ ï¼Œå®ƒå¯ä»¥å¾ˆå¥½çš„æ§åˆ¶çº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚</p>\n<h2 id=\"çº¿ç¨‹æ± \"><a href=\"#çº¿ç¨‹æ± \" class=\"headerlink\" title=\"çº¿ç¨‹æ± \"></a>çº¿ç¨‹æ± </h2><h3 id=\"Executors-åˆ›å»ºå››ç§å¸¸è§çº¿ç¨‹æ± \"><a href=\"#Executors-åˆ›å»ºå››ç§å¸¸è§çº¿ç¨‹æ± \" class=\"headerlink\" title=\"Executors åˆ›å»ºå››ç§å¸¸è§çº¿ç¨‹æ± \"></a>Executors åˆ›å»ºå››ç§å¸¸è§çº¿ç¨‹æ± </h3><h4 id=\"ä»€ä¹ˆæ˜¯çº¿ç¨‹æ± ï¼Ÿæœ‰å“ªå‡ ç§åˆ›å»ºæ–¹å¼ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯çº¿ç¨‹æ± ï¼Ÿæœ‰å“ªå‡ ç§åˆ›å»ºæ–¹å¼ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯çº¿ç¨‹æ± ï¼Ÿæœ‰å“ªå‡ ç§åˆ›å»ºæ–¹å¼ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯çº¿ç¨‹æ± ï¼Ÿæœ‰å“ªå‡ ç§åˆ›å»ºæ–¹å¼ï¼Ÿ</h4><blockquote>\n<p>æ± åŒ–æŠ€æœ¯çš„æ€æƒ³ä¸»è¦æ˜¯ä¸ºäº†å‡å°‘æ¯æ¬¡è·å–èµ„æºçš„æ¶ˆè€—ï¼Œæé«˜å¯¹èµ„æºçš„åˆ©ç”¨ç‡ã€‚</p>\n</blockquote>\n<p>åœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­ï¼Œåˆ›å»ºå’Œé”€æ¯å¯¹è±¡æ˜¯å¾ˆè´¹æ—¶é—´çš„ï¼Œå› ä¸ºåˆ›å»ºä¸€ä¸ªå¯¹è±¡è¦è·å–å†…å­˜èµ„æºæˆ–è€…å…¶å®ƒæ›´å¤šèµ„æºã€‚åœ¨ Java ä¸­æ›´æ˜¯å¦‚æ­¤ï¼Œè™šæ‹Ÿæœºå°†è¯•å›¾è·Ÿè¸ªæ¯ä¸€ä¸ªå¯¹è±¡ï¼Œä»¥ä¾¿èƒ½å¤Ÿåœ¨å¯¹è±¡é”€æ¯åè¿›è¡Œåƒåœ¾å›æ”¶ã€‚æ‰€ä»¥æé«˜æœåŠ¡ç¨‹åºæ•ˆç‡çš„ä¸€ä¸ªæ‰‹æ®µå°±æ˜¯<strong>å°½å¯èƒ½å‡å°‘åˆ›å»ºå’Œé”€æ¯å¯¹è±¡çš„æ¬¡æ•°</strong>ï¼Œç‰¹åˆ«æ˜¯ä¸€äº›å¾ˆè€—èµ„æºçš„å¯¹è±¡åˆ›å»ºå’Œé”€æ¯ï¼Œè¿™å°±æ˜¯â€æ± åŒ–èµ„æºâ€æŠ€æœ¯äº§ç”Ÿçš„åŸå› ã€‚</p>\n<p>çº¿ç¨‹æ± é¡¾åæ€ä¹‰å°±æ˜¯äº‹å…ˆåˆ›å»ºè‹¥å¹²ä¸ªå¯æ‰§è¡Œçš„çº¿ç¨‹æ”¾å…¥ä¸€ä¸ªæ± ï¼ˆå®¹å™¨ï¼‰ä¸­ï¼Œéœ€è¦çš„æ—¶å€™ä»æ± ä¸­è·å–çº¿ç¨‹ä¸ç”¨è‡ªè¡Œåˆ›å»ºï¼Œä½¿ç”¨å®Œæ¯•ä¸éœ€è¦é”€æ¯çº¿ç¨‹è€Œæ˜¯æ”¾å›æ± ä¸­ï¼Œä»è€Œå‡å°‘åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹å¯¹è±¡çš„å¼€é”€ã€‚Java 5+ä¸­çš„ Executor æ¥å£å®šä¹‰ä¸€ä¸ªæ‰§è¡Œçº¿ç¨‹çš„å·¥å…·ã€‚å®ƒçš„å­ç±»å‹å³çº¿ç¨‹æ± æ¥å£æ˜¯ ExecutorServiceã€‚è¦é…ç½®ä¸€ä¸ªçº¿ç¨‹æ± æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼Œå°¤å…¶æ˜¯å¯¹äºçº¿ç¨‹æ± çš„åŸç†ä¸æ˜¯å¾ˆæ¸…æ¥šçš„æƒ…å†µä¸‹ï¼Œå› æ­¤åœ¨å·¥å…·ç±» Executors é¢æä¾›äº†ä¸€äº›é™æ€å·¥å‚æ–¹æ³•ï¼Œç”Ÿæˆä¸€äº›å¸¸ç”¨çš„çº¿ç¨‹æ± ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>\n<p>ï¼ˆ1ï¼‰Executors.newSingleThreadExecutorï¼š<code>1, 1, new LinkedBlockingQueue</code>ã€‚æ‰€æœ‰ä»»åŠ¡æŒ‰ç…§<strong>å…ˆæ¥å…ˆæ‰§è¡Œ</strong>çš„é¡ºåºæ‰§è¡Œã€‚å¦‚æœè¿™ä¸ªå”¯ä¸€çš„çº¿ç¨‹ä¸ç©ºé—²ï¼Œé‚£ä¹ˆæ–°æ¥çš„ä»»åŠ¡ä¼šå­˜å‚¨åœ¨ä»»åŠ¡é˜Ÿåˆ—é‡Œç­‰å¾…æ‰§è¡Œã€‚ï¼ˆç”±äºé˜»å¡é˜Ÿåˆ—é»˜è®¤å¤§å°ä¸º Integer.MAX_VALUEï¼Œå› æ­¤å¯èƒ½ OOMï¼‰</p>\n<p>ï¼ˆ2ï¼‰Executors.newFixedThreadPoolï¼š<code>nCoreThreads, nCoreThreads, new LinkedBlockingQueue</code>ï¼Œæ‰€ä»¥åªèƒ½åˆ›å»ºæ ¸å¿ƒçº¿ç¨‹ï¼Œä¸èƒ½åˆ›å»ºéæ ¸å¿ƒçº¿ç¨‹ã€‚å› ä¸º LinkedBlockingQueue çš„é»˜è®¤å¤§å°æ˜¯ Integer.MAX_VALUEï¼Œæ•…å¦‚æœæ ¸å¿ƒçº¿ç¨‹ç©ºé—²ï¼Œåˆ™äº¤ç»™æ ¸å¿ƒçº¿ç¨‹å¤„ç†ï¼›å¦‚æœæ ¸å¿ƒçº¿ç¨‹ä¸ç©ºé—²ï¼Œåˆ™å…¥åˆ—ç­‰å¾…ï¼Œç›´åˆ°æ ¸å¿ƒçº¿ç¨‹ç©ºé—²ã€‚ï¼ˆç”±äºé˜»å¡é˜Ÿåˆ—é»˜è®¤å¤§å°ä¸º Integer.MAX_VALUEï¼Œå› æ­¤å¯èƒ½ OOMï¼‰</p>\n<p>ï¼ˆ3ï¼‰ Executors.newCachedThreadPoolï¼š<code>0, Integer.MAX_VALUE</code>ï¼Œä¸åˆ›å»ºæ ¸å¿ƒçº¿ç¨‹ï¼Œçº¿ç¨‹æ± æœ€å¤§ä¸º Integer.MAX_VALUEã€‚ï¼ˆçº¿ç¨‹æ± å¤ªå¤§å¯¼è‡´ OOMï¼‰</p>\n<p>newCachedThreadPool å’Œ newFixedThreadPool éƒ½å‡ ä¹ä¸ä¼šè§¦å‘æ‹’ç»ç­–ç•¥ï¼Œä½†æ˜¯åŸç†ä¸åŒã€‚<br>FixedThreadPool æ˜¯å› ä¸ºé˜»å¡é˜Ÿåˆ—å¯ä»¥å¾ˆå¤§ï¼ˆæœ€å¤§ä¸º Integer æœ€å¤§å€¼ï¼‰ï¼Œæ•…å‡ ä¹ä¸ä¼šè§¦å‘æ‹’ç»ç­–ç•¥ï¼›CachedThreadPool æ˜¯å› ä¸ºçº¿ç¨‹æ± å¾ˆå¤§ï¼ˆæœ€å¤§ä¸º Integer æœ€å¤§å€¼ï¼‰ï¼Œå‡ ä¹ä¸ä¼šå¯¼è‡´çº¿ç¨‹æ•°é‡å¤§äºæœ€å¤§çº¿ç¨‹æ•°ï¼Œæ•…å‡ ä¹ä¸ä¼šè§¦å‘æ‹’ç»ç­–ç•¥ã€‚</p>\n<p>ï¼ˆ4ï¼‰Executors.newScheduledThreadPoolï¼š<code>nCoreThreads, Integer.MAX_VALUE</code>åˆ›å»ºä¸€ä¸ªå¤§å°æ— é™çš„çº¿ç¨‹æ± ã€‚æ­¤çº¿ç¨‹æ± æ”¯æŒå®šæ—¶ä»¥åŠå‘¨æœŸæ€§æ‰§è¡Œä»»åŠ¡çš„éœ€æ±‚ã€‚</p>\n<h4 id=\"çº¿ç¨‹æ± æœ‰ä»€ä¹ˆä¼˜ç‚¹ï¼Ÿ\"><a href=\"#çº¿ç¨‹æ± æœ‰ä»€ä¹ˆä¼˜ç‚¹ï¼Ÿ\" class=\"headerlink\" title=\"çº¿ç¨‹æ± æœ‰ä»€ä¹ˆä¼˜ç‚¹ï¼Ÿ\"></a>çº¿ç¨‹æ± æœ‰ä»€ä¹ˆä¼˜ç‚¹ï¼Ÿ</h4><ul>\n<li>é™ä½èµ„æºæ¶ˆè€—ï¼šé‡ç”¨å­˜åœ¨çš„çº¿ç¨‹ï¼Œå‡å°‘å¯¹è±¡åˆ›å»ºé”€æ¯çš„å¼€é”€ï¼›</li>\n<li>æé«˜å“åº”é€Ÿåº¦ï¼šå½“ä»»åŠ¡åˆ°è¾¾æ—¶ï¼Œä»»åŠ¡å¯ä»¥ä¸éœ€è¦çš„ç­‰åˆ°çº¿ç¨‹åˆ›å»ºå°±èƒ½ç«‹å³æ‰§è¡Œï¼›</li>\n<li>æé«˜çº¿ç¨‹çš„å¯ç®¡ç†æ€§ï¼šä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥è¿›è¡Œç»Ÿä¸€çš„åˆ†é…ï¼Œè°ƒä¼˜å’Œç›‘æ§ã€‚</li>\n</ul>\n<h4 id=\"çº¿ç¨‹æ± éƒ½æœ‰å“ªäº›çŠ¶æ€ï¼Ÿ\"><a href=\"#çº¿ç¨‹æ± éƒ½æœ‰å“ªäº›çŠ¶æ€ï¼Ÿ\" class=\"headerlink\" title=\"çº¿ç¨‹æ± éƒ½æœ‰å“ªäº›çŠ¶æ€ï¼Ÿ\"></a>çº¿ç¨‹æ± éƒ½æœ‰å“ªäº›çŠ¶æ€ï¼Ÿ</h4><ul>\n<li>RUNNINGï¼šæ¥å—æ–°çš„ä»»åŠ¡æäº¤ï¼Œå¤„ç†ç­‰å¾…é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼›</li>\n<li>SHUTDOWNï¼šä¸æ¥å—æ–°çš„ä»»åŠ¡æäº¤ï¼Œä½†æ˜¯ä¼šç»§ç»­å¤„ç†ç­‰å¾…é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼›</li>\n<li>STOPï¼šä¸æ¥å—æ–°çš„ä»»åŠ¡æäº¤ï¼Œä¸å†å¤„ç†ç­‰å¾…é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼Œä¸­æ–­æ­£åœ¨æ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹ï¼›</li>\n<li>TIDYINGï¼šæ‰€æœ‰çš„ä»»åŠ¡éƒ½é”€æ¯äº†ï¼ŒworkCount ä¸º 0ï¼Œçº¿ç¨‹æ± çš„çŠ¶æ€åœ¨è½¬æ¢ä¸º TIDYING çŠ¶æ€æ—¶ï¼Œä¼šæ‰§è¡Œé’©å­æ–¹æ³• terminated()ï¼›</li>\n<li>TERMINATEDï¼šterminated()æ–¹æ³•ç»“æŸåï¼Œçº¿ç¨‹æ± çš„çŠ¶æ€å°±ä¼šå˜æˆè¿™ä¸ªã€‚</li>\n</ul>\n<h4 id=\"åœ¨-Java-ä¸­-Executor-å’Œ-Executors-çš„åŒºåˆ«ï¼Ÿ\"><a href=\"#åœ¨-Java-ä¸­-Executor-å’Œ-Executors-çš„åŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"åœ¨ Java ä¸­ Executor å’Œ Executors çš„åŒºåˆ«ï¼Ÿ\"></a>åœ¨ Java ä¸­ Executor å’Œ Executors çš„åŒºåˆ«ï¼Ÿ</h4><ul>\n<li><strong>Executors å·¥å…·ç±»</strong>çš„ä¸åŒæ–¹æ³•æŒ‰ç…§æˆ‘ä»¬çš„éœ€æ±‚<strong>åˆ›å»ºäº†ä¸åŒçš„çº¿ç¨‹æ± </strong>ï¼Œæ¥æ»¡è¶³ä¸šåŠ¡çš„éœ€æ±‚ï¼›</li>\n<li><strong>Executor æ¥å£å¯¹è±¡æ‰§è¡Œæˆ‘ä»¬çš„çº¿ç¨‹ä»»åŠ¡</strong>ï¼ŒExecutorService æ¥å£ç»§æ‰¿äº† Executor æ¥å£å¹¶è¿›è¡Œäº†æ‰©å±•ï¼Œæä¾›äº†æ›´å¤šçš„æ–¹æ³•æˆ‘ä»¬èƒ½è·å¾—ä»»åŠ¡æ‰§è¡Œçš„çŠ¶æ€å¹¶ä¸”å¯ä»¥è·å–ä»»åŠ¡çš„è¿”å›å€¼ã€‚</li>\n</ul>\n<h4 id=\"çº¿ç¨‹æ± ä¸­-submit-å’Œ-execute-æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"><a href=\"#çº¿ç¨‹æ± ä¸­-submit-å’Œ-execute-æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"çº¿ç¨‹æ± ä¸­ submit() å’Œ execute() æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"></a>çº¿ç¨‹æ± ä¸­ submit() å’Œ execute() æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h4><p>æ¥æ”¶å‚æ•°ï¼šsubmit() å¯ä»¥æ‰§è¡Œ Runnable å’Œ Callable ç±»å‹çš„ä»»åŠ¡ï¼Œè€Œ execute()åªèƒ½æ‰§è¡Œ Runnable ç±»å‹çš„ä»»åŠ¡ï¼›</p>\n<p>è¿”å›å€¼ï¼šsubmit() æ–¹æ³•å¯ä»¥è¿”å›æŒæœ‰è®¡ç®—ç»“æœçš„ Future å¯¹è±¡ï¼Œè€Œ execute() æ²¡æœ‰ï¼›</p>\n<p>å¼‚å¸¸å¤„ç†ï¼šsubmit() æ–¹ä¾¿ Exception å¤„ç†ã€‚</p>\n<h3 id=\"ThreadPoolExecutor-è‡ªå®šä¹‰çº¿ç¨‹æ± \"><a href=\"#ThreadPoolExecutor-è‡ªå®šä¹‰çº¿ç¨‹æ± \" class=\"headerlink\" title=\"ThreadPoolExecutor è‡ªå®šä¹‰çº¿ç¨‹æ± \"></a>ThreadPoolExecutor è‡ªå®šä¹‰çº¿ç¨‹æ± </h3><h4 id=\"Executors\"><a href=\"#Executors\" class=\"headerlink\" title=\"Executors\"></a>Executors</h4><p>ã€Šé˜¿é‡Œå·´å·´ Java å¼€å‘æ‰‹å†Œã€‹ä¸­å¼ºåˆ¶çº¿ç¨‹æ± ä¸å…è®¸ä½¿ç”¨ Executors å»åˆ›å»ºï¼Œè€Œæ˜¯<strong>é€šè¿‡ ThreadPoolExecutor çš„æ–¹å¼</strong>ï¼Œè¿™æ ·çš„å¤„ç†æ–¹å¼è®©å†™çš„åŒå­¦<strong>æ›´åŠ æ˜ç¡®çº¿ç¨‹æ± çš„è¿è¡Œè§„åˆ™ï¼Œè§„é¿èµ„æºè€—å°½çš„é£é™©</strong></p>\n<p>Executors å„ä¸ªæ–¹æ³•çš„å¼Šç«¯ï¼š</p>\n<ul>\n<li><p>newSingleThreadExecutor å’Œ newFixedThreadPool :<br>  <code>0, 0</code>å’Œ <code>n, n</code> ï¼Œä½†æ˜¯ä½¿ç”¨ LinkedBlockingQueueï¼Œæœ€å¤§å¯ä»¥ä¸º Integer.MAX_VALUE</p>\n<p>  ä¸»è¦é—®é¢˜æ˜¯å †ç§¯çš„è¯·æ±‚å¤„ç†é˜Ÿåˆ—å¯èƒ½ä¼šè€—è´¹éå¸¸å¤§çš„å†…å­˜ï¼Œç”šè‡³ OOMã€‚</p>\n</li>\n<li><p>newCachedThreadPool å’Œ newScheduledThreadPool:<br>  <code>0, Integer.MAX_VALUE</code> å’Œ <code>n, Integer.MAX_VALUE</code></p>\n<p>  ä¸»è¦é—®é¢˜æ˜¯çº¿ç¨‹æ•°æœ€å¤§æ•°æ˜¯ Integer.MAX_VALUEï¼Œå¯èƒ½ä¼šåˆ›å»ºæ•°é‡éå¸¸å¤šçš„çº¿ç¨‹ï¼Œç”šè‡³ OOM</p>\n</li>\n</ul>\n<p>ThreaPoolExecutor åˆ›å»ºçº¿ç¨‹æ± æ–¹å¼åªæœ‰ä¸€ç§ï¼Œå°±æ˜¯èµ°å®ƒçš„æ„é€ å‡½æ•°ï¼Œå‚æ•°è‡ªå·±æŒ‡å®š</p>\n<h4 id=\"ThreaPoolExecutor\"><a href=\"#ThreaPoolExecutor\" class=\"headerlink\" title=\"ThreaPoolExecutor\"></a>ThreaPoolExecutor</h4><p>åˆ›å»ºçº¿ç¨‹æ± çš„æ–¹å¼æœ‰å¤šç§ï¼Œè¿™é‡Œä½ åªéœ€è¦ç­” ThreadPoolExecutor å³å¯ã€‚</p>\n<p>ThreadPoolExecutor() æ˜¯æœ€åŸå§‹çš„çº¿ç¨‹æ± åˆ›å»ºï¼Œä¹Ÿæ˜¯é˜¿é‡Œå·´å·´ Java å¼€å‘æ‰‹å†Œä¸­æ˜ç¡®è§„èŒƒçš„åˆ›å»ºçº¿ç¨‹æ± çš„æ–¹å¼ã€‚</p>\n<h4 id=\"ThreadPoolExecutoræ„é€ å‡½æ•°é‡è¦å‚æ•°åˆ†æ\"><a href=\"#ThreadPoolExecutoræ„é€ å‡½æ•°é‡è¦å‚æ•°åˆ†æ\" class=\"headerlink\" title=\"ThreadPoolExecutoræ„é€ å‡½æ•°é‡è¦å‚æ•°åˆ†æ\"></a>ThreadPoolExecutoræ„é€ å‡½æ•°é‡è¦å‚æ•°åˆ†æ</h4><p><strong><code>ThreadPoolExecutor</code></strong> <strong>3 ä¸ªæœ€é‡è¦çš„å‚æ•°ï¼š</strong></p>\n<ul>\n<li><strong><code>corePoolSize</code></strong> ï¼šæ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œçº¿ç¨‹æ•°å®šä¹‰äº†æœ€å°å¯ä»¥åŒæ—¶è¿è¡Œçš„çº¿ç¨‹æ•°é‡</li>\n<li><strong><code>maximumPoolSize</code></strong> ï¼šçº¿ç¨‹æ± ä¸­å…è®¸å­˜åœ¨çš„å·¥ä½œçº¿ç¨‹çš„æœ€å¤§æ•°é‡</li>\n<li>**<code>workQueue</code>**ï¼šå½“æ–°ä»»åŠ¡æ¥çš„æ—¶å€™ä¼šå…ˆåˆ¤æ–­å½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°é‡æ˜¯å¦è¾¾åˆ°æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œå¦‚æœè¾¾åˆ°çš„è¯ï¼Œä»»åŠ¡å°±ä¼šè¢«å­˜æ”¾åœ¨ç­‰å¾…é˜Ÿåˆ—ä¸­</li>\n</ul>\n<p><code>ThreadPoolExecutor</code>å…¶ä»–å¸¸è§å‚æ•°:</p>\n<ol>\n<li>**<code>keepAliveTime</code>**ï¼šéæ ¸å¿ƒçº¿ç¨‹å¦‚æœå¤„äºé—²ç½®çŠ¶æ€è¶…è¿‡è¯¥å€¼ï¼Œå°±ä¼šè¢«é”€æ¯ã€‚</li>\n<li><strong><code>unit</code></strong> ï¼š<code>keepAliveTime</code> é—²ç½®é”€æ¯æ—¶é•¿çš„æ—¶é—´å•ä½</li>\n<li>**<code>threadFactory</code>**ï¼šä¸ºçº¿ç¨‹æ± æä¾›åˆ›å»ºæ–°çº¿ç¨‹çš„çº¿ç¨‹å·¥å‚</li>\n<li><strong><code>handler</code></strong> ï¼šçº¿ç¨‹æ± ä»»åŠ¡é˜Ÿåˆ—è¶…è¿‡ maxinumPoolSize ä¹‹åçš„æ‹’ç»ç­–ç•¥</li>\n</ol>\n<h4 id=\"ThreadPoolExecutoræ‹’ç»ç­–ç•¥\"><a href=\"#ThreadPoolExecutoræ‹’ç»ç­–ç•¥\" class=\"headerlink\" title=\"ThreadPoolExecutoræ‹’ç»ç­–ç•¥\"></a>ThreadPoolExecutoræ‹’ç»ç­–ç•¥</h4><p><strong><code>ThreadPoolExecutor</code></strong> <strong>æ‹’ç»ç­–ç•¥å®šä¹‰:</strong></p>\n<p>å¦‚æœå½“å‰åŒæ—¶è¿è¡Œçš„çº¿ç¨‹æ•°é‡è¾¾åˆ°æœ€å¤§çº¿ç¨‹æ•°é‡å¹¶ä¸”ç­‰å¾…é˜Ÿåˆ—ä¹Ÿå·²ç»è¢«æ”¾æ»¡æ—¶ï¼Œ<code>ThreadPoolTaskExecutor</code> å®šä¹‰ä¸€äº›ç­–ç•¥:</p>\n<ul>\n<li>**<code>ThreadPoolExecutor.AbortPolicy</code>**ï¼šæŠ›å‡º <code>RejectedExecutionException</code>æ¥æ‹’ç»æ–°ä»»åŠ¡çš„å¤„ç†ã€‚</li>\n<li>**<code>ThreadPoolExecutor.CallerRunsPolicy</code>**ï¼šè°ƒç”¨æ‰§è¡Œè‡ªå·±çš„çº¿ç¨‹è¿è¡Œä»»åŠ¡ã€‚</li>\n<li>**<code>ThreadPoolExecutor.DiscardPolicy</code>**ï¼šä¸å¤„ç†æ–°ä»»åŠ¡ï¼Œç›´æ¥ä¸¢å¼ƒæ‰ã€‚</li>\n<li>**<code>ThreadPoolExecutor.DiscardOldestPolicy</code>**ï¼š æ­¤ç­–ç•¥å°†ä¸¢å¼ƒæœ€æ—©çš„æœªå¤„ç†çš„ä»»åŠ¡è¯·æ±‚ã€‚</li>\n</ul>\n<h4 id=\"ä¸€ä¸ªç®€å•çš„çº¿ç¨‹æ± Demo-Runnable-ThreadPoolExecutor\"><a href=\"#ä¸€ä¸ªç®€å•çš„çº¿ç¨‹æ± Demo-Runnable-ThreadPoolExecutor\" class=\"headerlink\" title=\"ä¸€ä¸ªç®€å•çš„çº¿ç¨‹æ± Demo:Runnable + ThreadPoolExecutor\"></a>ä¸€ä¸ªç®€å•çš„çº¿ç¨‹æ± Demo:<code>Runnable</code> + <code>ThreadPoolExecutor</code></h4><p>çº¿ç¨‹æ± å®ç°åŸç†</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOS8xMS8yNS8xNmVhMDQ3NjEyOTVlNzY2.png\" alt=\"çº¿ç¨‹æ± å®ç°åŸç†\"></p>\n<p><strong>æ€»ç»“ä¸€ä¸‹å¤„ç†æµç¨‹</strong></p>\n<ol>\n<li>çº¿ç¨‹æ€»æ•°é‡ &lt; corePoolSizeï¼Œæ— è®ºçº¿ç¨‹æ˜¯å¦ç©ºé—²ï¼Œéƒ½ä¼šæ–°å»ºä¸€ä¸ªæ ¸å¿ƒçº¿ç¨‹æ‰§è¡Œä»»åŠ¡ï¼ˆè®©æ ¸å¿ƒçº¿ç¨‹æ•°é‡å¿«é€Ÿè¾¾åˆ° corePoolSizeï¼Œåœ¨æ ¸å¿ƒçº¿ç¨‹æ•°é‡ &lt; corePoolSize æ—¶ï¼‰ã€‚<strong>æ³¨æ„ï¼Œè¿™ä¸€æ­¥éœ€è¦è·å¾—å…¨å±€é”ã€‚</strong></li>\n<li>çº¿ç¨‹æ€»æ•°é‡ &gt;&#x3D; corePoolSize æ—¶ï¼Œæ–°æ¥çš„çº¿ç¨‹ä»»åŠ¡ä¼šè¿›å…¥ç­‰å¾…é˜Ÿåˆ—ä¸­ç­‰å¾…ï¼Œç„¶åç©ºé—²çš„æ ¸å¿ƒçº¿ç¨‹ä¼šä¾æ¬¡å»ç¼“å­˜é˜Ÿåˆ—ä¸­å–ä»»åŠ¡æ¥æ‰§è¡Œï¼ˆä½“ç°äº†<strong>çº¿ç¨‹å¤ç”¨</strong>ï¼‰ã€‚ </li>\n<li>å½“ç­‰å¾…é˜Ÿåˆ—æ»¡äº†ï¼Œè¯´æ˜è¿™ä¸ªæ—¶å€™ä»»åŠ¡å·²ç»å¤šåˆ°çˆ†æ£šï¼Œéœ€è¦ä¸€äº›â€œä¸´æ—¶å·¥â€æ¥æ‰§è¡Œè¿™äº›ä»»åŠ¡äº†ã€‚äºæ˜¯ä¼šåˆ›å»ºéæ ¸å¿ƒçº¿ç¨‹å»æ‰§è¡Œè¿™ä¸ªä»»åŠ¡ã€‚<strong>æ³¨æ„ï¼Œè¿™ä¸€æ­¥éœ€è¦è·å¾—å…¨å±€é”ã€‚</strong></li>\n<li>ç¼“å­˜é˜Ÿåˆ—ä¹‹å‰æ»¡äº†ï¼Œ ç°åœ¨åŠ éæ ¸å¿ƒçº¿ç¨‹ä¸”æ€»çº¿ç¨‹æ•°è¾¾åˆ°äº† maximumPoolSizeï¼Œåˆ™ä¼šé‡‡å–ä¸Šé¢æåˆ°çš„æ‹’ç»ç­–ç•¥è¿›è¡Œå¤„ç†ã€‚</li>\n</ol>\n<p>æ•´ä¸ªè¿‡ç¨‹å¦‚å›¾æ‰€ç¤ºï¼š</p>\n<p>ä¸ºäº†è®©å¤§å®¶æ›´æ¸…æ¥šä¸Šé¢çš„é¢è¯•é¢˜ä¸­çš„ä¸€äº›æ¦‚å¿µï¼Œæˆ‘å†™äº†ä¸€ä¸ªç®€å•çš„çº¿ç¨‹æ±  Demoã€‚</p>\n<p>é¦–å…ˆåˆ›å»ºä¸€ä¸ª <code>Runnable</code> æ¥å£çš„å®ç°ç±»ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥æ˜¯ <code>Callable</code> æ¥å£ï¼Œæˆ‘ä»¬ä¸Šé¢ä¹Ÿè¯´äº†ä¸¤è€…çš„åŒºåˆ«ã€‚ï¼‰</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> Java.util.Date;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * è¿™æ˜¯ä¸€ä¸ªç®€å•çš„Runnableç±»ï¼Œéœ€è¦å¤§çº¦5ç§’é’Ÿæ¥æ‰§è¡Œå…¶ä»»åŠ¡ã€‚</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyRunnable</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Runnable</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String command;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">MyRunnable</span><span class=\"params\">(String s)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.command = s;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; Start. Time = &quot;</span> + <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>());</span><br><span class=\"line\">        processCommand();</span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; End. Time = &quot;</span> + <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">processCommand</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            Thread.sleep(<span class=\"number\">5000</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">toString</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.command;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>ç¼–å†™æµ‹è¯•ç¨‹åºï¼Œæˆ‘ä»¬è¿™é‡Œä»¥é˜¿é‡Œå·´å·´æ¨èçš„ä½¿ç”¨ <code>ThreadPoolExecutor</code> æ„é€ å‡½æ•°è‡ªå®šä¹‰å‚æ•°çš„æ–¹å¼æ¥åˆ›å»ºçº¿ç¨‹æ± ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> Java.util.concurrent.ArrayBlockingQueue;</span><br><span class=\"line\"><span class=\"keyword\">import</span> Java.util.concurrent.ThreadPoolExecutor;</span><br><span class=\"line\"><span class=\"keyword\">import</span> Java.util.concurrent.TimeUnit;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadPoolExecutorDemo</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">CORE_POOL_SIZE</span> <span class=\"operator\">=</span> <span class=\"number\">5</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">MAX_POOL_SIZE</span> <span class=\"operator\">=</span> <span class=\"number\">10</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">QUEUE_CAPACITY</span> <span class=\"operator\">=</span> <span class=\"number\">100</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">Long</span> <span class=\"variable\">KEEP_ALIVE_TIME</span> <span class=\"operator\">=</span> <span class=\"number\">1L</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//ä½¿ç”¨é˜¿é‡Œå·´å·´æ¨èçš„åˆ›å»ºçº¿ç¨‹æ± çš„æ–¹å¼</span></span><br><span class=\"line\">        <span class=\"comment\">//é€šè¿‡ThreadPoolExecutoræ„é€ å‡½æ•°è‡ªå®šä¹‰å‚æ•°åˆ›å»º</span></span><br><span class=\"line\">        <span class=\"type\">ThreadPoolExecutor</span> <span class=\"variable\">executor</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ThreadPoolExecutor</span>(</span><br><span class=\"line\">                CORE_POOL_SIZE,</span><br><span class=\"line\">                MAX_POOL_SIZE,</span><br><span class=\"line\">                KEEP_ALIVE_TIME,</span><br><span class=\"line\">                TimeUnit.SECONDS,</span><br><span class=\"line\">                <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayBlockingQueue</span>&lt;&gt;(QUEUE_CAPACITY),</span><br><span class=\"line\">                <span class=\"keyword\">new</span> <span class=\"title class_\">ThreadPoolExecutor</span>.CallerRunsPolicy());</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++) &#123;</span><br><span class=\"line\">            <span class=\"comment\">//åˆ›å»ºWorkerThreadå¯¹è±¡ï¼ˆWorkerThreadç±»å®ç°äº†Runnable æ¥å£ï¼‰</span></span><br><span class=\"line\">            <span class=\"type\">Runnable</span> <span class=\"variable\">worker</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MyRunnable</span>(<span class=\"string\">&quot;&quot;</span> + i);</span><br><span class=\"line\">            <span class=\"comment\">//æ‰§è¡ŒRunnable</span></span><br><span class=\"line\">            executor.execute(worker);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">//ç»ˆæ­¢çº¿ç¨‹æ± </span></span><br><span class=\"line\">        executor.shutdown();</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (!executor.isTerminated()) &#123;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;Finished all threads&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä¸Šé¢çš„ä»£ç æŒ‡å®šäº†ï¼š</p>\n<ol>\n<li><code>corePoolSize</code>: æ ¸å¿ƒçº¿ç¨‹æ•°ä¸º 5ã€‚</li>\n<li><code>maximumPoolSize</code> ï¼šæœ€å¤§çº¿ç¨‹æ•° 10</li>\n<li><code>keepAliveTime</code> : ç­‰å¾…æ—¶é—´ä¸º 1Lã€‚</li>\n<li><code>unit</code>: ç­‰å¾…æ—¶é—´çš„å•ä½ä¸º TimeUnit.SECONDSã€‚</li>\n<li><code>workQueue</code>ï¼šä»»åŠ¡é˜Ÿåˆ—ä¸º <code>ArrayBlockingQueue</code>ï¼Œå¹¶ä¸”å®¹é‡ä¸º 100;</li>\n<li><code>handler</code>:é¥±å’Œç­–ç•¥ä¸º <code>CallerRunsPolicy</code>ã€‚</li>\n</ol>\n<p><strong>Outputï¼š</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">2</span> Start. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">44</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">5</span> Start. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">44</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">4</span> Start. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">44</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">1</span> Start. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">44</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">3</span> Start. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">44</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">5</span> End. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">49</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">3</span> End. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">49</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">2</span> End. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">49</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">4</span> End. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">49</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">1</span> End. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">49</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">2</span> Start. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">49</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">1</span> Start. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">49</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">4</span> Start. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">49</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">3</span> Start. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">49</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">5</span> Start. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">49</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">2</span> End. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">54</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">3</span> End. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">54</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">4</span> End. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">54</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">5</span> End. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">54</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">1</span> End. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">54</span> CST <span class=\"number\">2019</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"å¹¶å‘å·¥å…·\"><a href=\"#å¹¶å‘å·¥å…·\" class=\"headerlink\" title=\"å¹¶å‘å·¥å…·\"></a>å¹¶å‘å·¥å…·</h2><h3 id=\"CountDownLatch-ä¸-CyclicBarrier\"><a href=\"#CountDownLatch-ä¸-CyclicBarrier\" class=\"headerlink\" title=\"CountDownLatch ä¸ CyclicBarrier\"></a>CountDownLatch ä¸ CyclicBarrier</h3><p>CountDownLatch ä¸ CyclicBarrier éƒ½æ˜¯ç”¨äºæ§åˆ¶å¹¶å‘çš„å·¥å…·ç±»ï¼Œéƒ½å¯ä»¥ç†è§£æˆç»´æŠ¤çš„å°±æ˜¯ä¸€ä¸ªè®¡æ•°å™¨ï¼Œä½†æ˜¯è¿™ä¸¤è€…è¿˜æ˜¯å„æœ‰ä¸åŒä¾§é‡ç‚¹çš„ï¼š</p>\n<ul>\n<li>CountDownLatch å¼ºè°ƒä¸€ä¸ªçº¿ç¨‹ç­‰å¤šä¸ªçº¿ç¨‹å®ŒæˆæŸä»¶äº‹æƒ…ã€‚CyclicBarrier æ˜¯å¤šä¸ªçº¿ç¨‹äº’ç­‰ï¼Œç­‰å¤§å®¶éƒ½å®Œæˆï¼Œå†æºæ‰‹å…±è¿›ï¼›</li>\n<li>è°ƒç”¨ CountDownLatch çš„ countDown æ–¹æ³•åï¼Œå½“å‰çº¿ç¨‹å¹¶ä¸ä¼šé˜»å¡ï¼Œä¼šç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼›è€Œè°ƒç”¨ CyclicBarrier çš„ await æ–¹æ³•ï¼Œä¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼Œç›´åˆ° CyclicBarrier æŒ‡å®šçš„çº¿ç¨‹å…¨éƒ¨éƒ½åˆ°è¾¾äº†æŒ‡å®šç‚¹çš„æ—¶å€™ï¼Œæ‰èƒ½ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼›</li>\n<li>CountDownLatch æ˜¯ä¸èƒ½å¤ç”¨çš„ï¼Œè€Œ CyclicBarrier æ˜¯å¯ä»¥å¤ç”¨çš„ã€‚</li>\n</ul>\n<h3 id=\"Semaphore\"><a href=\"#Semaphore\" class=\"headerlink\" title=\"Semaphore\"></a>Semaphore</h3><p><strong>Semaphore(ä¿¡å·é‡)-å…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®ï¼š</strong> synchronized å’Œ ReentrantLock éƒ½æ˜¯ä¸€æ¬¡åªå…è®¸ä¸€ä¸ªçº¿ç¨‹è®¿é—®æŸä¸ªèµ„æºï¼ŒSemaphore(ä¿¡å·é‡)å¯ä»¥æŒ‡å®šå¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®æŸä¸ªèµ„æºã€‚</p>\n<p>Semaphore å°±æ˜¯ä¸€ä¸ªä¿¡å·é‡ï¼Œå®ƒçš„ä½œç”¨æ˜¯é™åˆ¶æŸæ®µä»£ç å—çš„å¹¶å‘æ•°ã€‚Semaphore æœ‰ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå¯ä»¥ä¼ å…¥ä¸€ä¸ª int å‹æ•´æ•° nï¼Œè¡¨ç¤ºæŸæ®µä»£ç æœ€å¤šåªæœ‰ n ä¸ªçº¿ç¨‹å¯ä»¥è®¿é—®ï¼Œå¦‚æœè¶…å‡ºäº† nï¼Œé‚£ä¹ˆè¯·ç­‰å¾…ï¼Œç­‰åˆ°æŸä¸ªçº¿ç¨‹æ‰§è¡Œå®Œæ¯•è¿™æ®µä»£ç å—ï¼Œä¸‹ä¸€ä¸ªçº¿ç¨‹å†è¿›å…¥ã€‚ç”±æ­¤å¯ä»¥çœ‹å‡ºå¦‚æœ Semaphore æ„é€ å‡½æ•°ä¸­ä¼ å…¥çš„ int å‹æ•´æ•° n&#x3D;1ï¼Œç›¸å½“äºå˜æˆäº†ä¸€ä¸ª synchronized äº†ã€‚</p>\n<h2 id=\"æ¨¡æ‹Ÿ\"><a href=\"#æ¨¡æ‹Ÿ\" class=\"headerlink\" title=\"æ¨¡æ‹Ÿ\"></a>æ¨¡æ‹Ÿ</h2><h3 id=\"æ­»é”\"><a href=\"#æ­»é”\" class=\"headerlink\" title=\"æ­»é”\"></a>æ­»é”</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">DeadLock</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">Object</span> <span class=\"variable\">A</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>();</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">Object</span> <span class=\"variable\">B</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">synchronized</span> (A) &#123;</span><br><span class=\"line\">                System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; å·²è·å¾—èµ„æºA&quot;</span>);</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; ç­‰å¾…è·å¾—èµ„æºB&quot;</span>);</span><br><span class=\"line\">                <span class=\"keyword\">synchronized</span> (B) &#123;</span><br><span class=\"line\">                    System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; å·²è·å¾—èµ„æºB&quot;</span>);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;çº¿ç¨‹1&quot;</span>).start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">synchronized</span> (B) &#123;</span><br><span class=\"line\">                System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; å·²è·å¾—èµ„æºB&quot;</span>);</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; ç­‰å¾…è·å¾—èµ„æºA&quot;</span>);</span><br><span class=\"line\">                <span class=\"keyword\">synchronized</span> (A) &#123;</span><br><span class=\"line\">                    System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; å·²è·å¾—èµ„æºA&quot;</span>);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;çº¿ç¨‹2&quot;</span>).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>çº¿ç¨‹1 å·²è·å¾—èµ„æºA<br>çº¿ç¨‹2 å·²è·å¾—èµ„æºB<br>çº¿ç¨‹1 ç­‰å¾…è·å¾—èµ„æºB<br>çº¿ç¨‹2 ç­‰å¾…è·å¾—èµ„æºA</p>\n</blockquote>\n<h3 id=\"runæ–¹æ³•å’Œstartæ–¹æ³•\"><a href=\"#runæ–¹æ³•å’Œstartæ–¹æ³•\" class=\"headerlink\" title=\"runæ–¹æ³•å’Œstartæ–¹æ³•\"></a>runæ–¹æ³•å’Œstartæ–¹æ³•</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">DiffStartRun</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            System.out.println(Thread.currentThread().getName());</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;çº¿ç¨‹A&quot;</span>).run();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            System.out.println(Thread.currentThread().getName());</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;çº¿ç¨‹B&quot;</span>).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>main<br>çº¿ç¨‹B</p>\n<p>new ä¸€ä¸ª Threadï¼Œçº¿ç¨‹è¿›å…¥äº†æ–°å»ºçŠ¶æ€ã€‚è°ƒç”¨ <code>start()</code>æ–¹æ³•ï¼Œä¼šå¯åŠ¨ä¸€ä¸ªçº¿ç¨‹å¹¶ä½¿çº¿ç¨‹è¿›å…¥äº†å°±ç»ªçŠ¶æ€ï¼Œå½“åˆ†é…åˆ°æ—¶é—´ç‰‡åå°±å¯ä»¥å¼€å§‹è¿è¡Œäº†ã€‚ <code>start()</code> ä¼šæ‰§è¡Œçº¿ç¨‹çš„ç›¸åº”å‡†å¤‡å·¥ä½œï¼Œç„¶åè‡ªåŠ¨æ‰§è¡Œ <code>run()</code> æ–¹æ³•çš„å†…å®¹ï¼Œè¿™æ˜¯çœŸæ­£çš„å¤šçº¿ç¨‹å·¥ä½œã€‚ ä½†æ˜¯ï¼Œç›´æ¥æ‰§è¡Œ <code>run()</code> æ–¹æ³•ï¼Œä¼šæŠŠ <code>run()</code> æ–¹æ³•å½“æˆä¸€ä¸ª main çº¿ç¨‹ä¸‹çš„æ™®é€šæ–¹æ³•å»æ‰§è¡Œï¼Œå¹¶ä¸ä¼šåœ¨æŸä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œå®ƒï¼Œç¬¬ä¸€ä¸ªæ‰€è°“çš„çº¿ç¨‹Aåªæ˜¯ main çº¿ç¨‹çš„ä¸€ä¸ªæ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´å…¶æ‰€åœ¨çº¿ç¨‹è¿˜æ˜¯ main çº¿ç¨‹ï¼Œæ‰€ä»¥è¿™å¹¶ä¸æ˜¯å¤šçº¿ç¨‹å·¥ä½œã€‚</p>\n<p><strong>æ€»ç»“ï¼š è°ƒç”¨ start() æ–¹æ³•æ–¹å¯å¯åŠ¨çº¿ç¨‹å¹¶ä½¿çº¿ç¨‹è¿›å…¥å°±ç»ªçŠ¶æ€ï¼Œç›´æ¥æ‰§è¡Œ run() æ–¹æ³•çš„è¯ä¸ä¼šä»¥å¤šçº¿ç¨‹çš„æ–¹å¼æ‰§è¡Œã€‚</strong></p>\n</blockquote>\n<h3 id=\"ä¸¤ä¸ªçº¿ç¨‹ï¼Œäº¤æ›¿åŠ å‡\"><a href=\"#ä¸¤ä¸ªçº¿ç¨‹ï¼Œäº¤æ›¿åŠ å‡\" class=\"headerlink\" title=\"ä¸¤ä¸ªçº¿ç¨‹ï¼Œäº¤æ›¿åŠ å‡\"></a>ä¸¤ä¸ªçº¿ç¨‹ï¼Œäº¤æ›¿åŠ å‡</h3><ol>\n<li><p>synchronized</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> fangyaxing</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@date</span> 2022/9/12</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">TwoThreadWithSync</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"variable\">value</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">Object</span> <span class=\"variable\">lock</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">5</span>; i++) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">synchronized</span> (lock) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">while</span> (value != <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                            lock.wait();</span><br><span class=\"line\">                        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                            e.printStackTrace();</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    value++;</span><br><span class=\"line\">                    System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; ---- &quot;</span> + value);</span><br><span class=\"line\">                    lock.notifyAll();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;Thread-A&quot;</span>).start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">5</span>; i++) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">synchronized</span> (lock) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">while</span> (value != <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">                        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                            lock.wait();</span><br><span class=\"line\">                        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                            e.printStackTrace();</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    value--;</span><br><span class=\"line\">                    System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; ---- &quot;</span> + value);</span><br><span class=\"line\">                    lock.notifyAll();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;Thread-B&quot;</span>).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>lock + condition</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> fangyaxing</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@date</span> 2022/9/12</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">TwoThreadWithLock</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"variable\">value</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">Lock</span> <span class=\"variable\">lock</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ReentrantLock</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"type\">Condition</span> <span class=\"variable\">a</span> <span class=\"operator\">=</span> lock.newCondition();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"type\">Condition</span> <span class=\"variable\">b</span> <span class=\"operator\">=</span> lock.newCondition();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">5</span>; i++) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    lock.lock();</span><br><span class=\"line\">                    <span class=\"keyword\">while</span> (value != <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                        a.await();</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    value++;</span><br><span class=\"line\">                    System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; ---- &quot;</span> + value);</span><br><span class=\"line\">                    b.signal();</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">                    lock.unlock();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;Thread-A&quot;</span>).start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">5</span>; i++) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    lock.lock();</span><br><span class=\"line\">                    <span class=\"keyword\">while</span> (value != <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">                        b.await();</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    value--;</span><br><span class=\"line\">                    System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; ---- &quot;</span> + value);</span><br><span class=\"line\">                    a.signal();</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">                    lock.unlock();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;Thread-B&quot;</span>).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n</ol>\n<h3 id=\"ä¸‰ä¸ªçº¿ç¨‹ï¼Œå¾ªç¯æ‰“å°\"><a href=\"#ä¸‰ä¸ªçº¿ç¨‹ï¼Œå¾ªç¯æ‰“å°\" class=\"headerlink\" title=\"ä¸‰ä¸ªçº¿ç¨‹ï¼Œå¾ªç¯æ‰“å°\"></a>ä¸‰ä¸ªçº¿ç¨‹ï¼Œå¾ªç¯æ‰“å°</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Demo5</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> <span class=\"variable\">value</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">Lock</span> <span class=\"variable\">lock</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ReentrantLock</span>();</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">Condition</span> <span class=\"variable\">a</span> <span class=\"operator\">=</span> lock.newCondition();</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">Condition</span> <span class=\"variable\">b</span> <span class=\"operator\">=</span> lock.newCondition();</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">Condition</span> <span class=\"variable\">c</span> <span class=\"operator\">=</span> lock.newCondition();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">outputA</span><span class=\"params\">(<span class=\"type\">int</span> round)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            lock.lock();</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (value != <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                a.await();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            value = <span class=\"number\">1</span>;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;ç¬¬&quot;</span> + round + <span class=\"string\">&quot;è½®ï¼Œ&quot;</span> + Thread.currentThread().getName() + <span class=\"string\">&quot;è¾“å‡ºA&quot;</span>);</span><br><span class=\"line\">            b.signal();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            lock.unlock();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">outputB</span><span class=\"params\">(<span class=\"type\">int</span> round)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            lock.lock();</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (value != <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">                b.await();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            value = <span class=\"number\">2</span>;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;ç¬¬&quot;</span> + round + <span class=\"string\">&quot;è½®ï¼Œ&quot;</span> + Thread.currentThread().getName() + <span class=\"string\">&quot;è¾“å‡ºB&quot;</span>);</span><br><span class=\"line\">            c.signal();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            lock.unlock();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">outputC</span><span class=\"params\">(<span class=\"type\">int</span> round)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            lock.lock();</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (value != <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">                c.await();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            value = <span class=\"number\">0</span>;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;ç¬¬&quot;</span> + round + <span class=\"string\">&quot;è½®ï¼Œ&quot;</span> + Thread.currentThread().getName() + <span class=\"string\">&quot;è¾“å‡ºC&quot;</span>);</span><br><span class=\"line\">            a.signal();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            lock.unlock();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Demo5</span> <span class=\"variable\">s</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Demo5</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">3</span>; i++) &#123;</span><br><span class=\"line\">                s.outputA(i);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;Thread-A&quot;</span>).start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">3</span>; i++) &#123;</span><br><span class=\"line\">                s.outputB(i);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;Thread-B&quot;</span>).start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">3</span>; i++) &#123;</span><br><span class=\"line\">                s.outputC(i);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;Thread-C&quot;</span>).start();</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"length":35745,"excerpt":"<blockquote>\n<p>æ•´ç†çš„Javaå¹¶å‘ç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½","more":"</p>\n</blockquote>\n<h2 id=\"åŸºç¡€çŸ¥è¯†\"><a href=\"#åŸºç¡€çŸ¥è¯†\" class=\"headerlink\" title=\"åŸºç¡€çŸ¥è¯†\"></a>åŸºç¡€çŸ¥è¯†</h2><h3 id=\"å¹¶å‘ç¼–ç¨‹çš„ä¼˜ç¼ºç‚¹\"><a href=\"#å¹¶å‘ç¼–ç¨‹çš„ä¼˜ç¼ºç‚¹\" class=\"headerlink\" title=\"å¹¶å‘ç¼–ç¨‹çš„ä¼˜ç¼ºç‚¹\"></a>å¹¶å‘ç¼–ç¨‹çš„ä¼˜ç¼ºç‚¹</h3><p>ä¼˜ç‚¹ï¼šä¸ºäº†èƒ½æé«˜ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡ï¼Œæé«˜ç¨‹åºè¿è¡Œé€Ÿåº¦ï¼›</p>\n<p>ç¼ºç‚¹ï¼šå­˜åœ¨å†…å­˜æ³„æ¼ã€ä¸Šä¸‹æ–‡åˆ‡æ¢ã€çº¿ç¨‹å®‰å…¨ã€æ­»é”ç­‰é—®é¢˜ã€‚</p>\n<h4 id=\"å¹¶å‘ç¼–ç¨‹ä¸‰è¦ç´ æ˜¯ä»€ä¹ˆï¼Ÿåœ¨-Java-ç¨‹åºä¸­æ€ä¹ˆä¿è¯å¤šçº¿ç¨‹çš„è¿è¡Œå®‰å…¨ï¼Ÿ\"><a href=\"#å¹¶å‘ç¼–ç¨‹ä¸‰è¦ç´ æ˜¯ä»€ä¹ˆï¼Ÿåœ¨-Java-ç¨‹åºä¸­æ€ä¹ˆä¿è¯å¤šçº¿ç¨‹çš„è¿è¡Œå®‰å…¨ï¼Ÿ\" class=\"headerlink\" title=\"å¹¶å‘ç¼–ç¨‹ä¸‰è¦ç´ æ˜¯ä»€ä¹ˆï¼Ÿåœ¨ Java ç¨‹åºä¸­æ€ä¹ˆä¿è¯å¤šçº¿ç¨‹çš„è¿è¡Œå®‰å…¨ï¼Ÿ\"></a>å¹¶å‘ç¼–ç¨‹ä¸‰è¦ç´ æ˜¯ä»€ä¹ˆï¼Ÿåœ¨ Java ç¨‹åºä¸­æ€ä¹ˆä¿è¯å¤šçº¿ç¨‹çš„è¿è¡Œå®‰å…¨ï¼Ÿ</h4><p>å¹¶å‘ç¼–ç¨‹ä¸‰è¦ç´ ï¼ˆçº¿ç¨‹çš„å®‰å…¨æ€§é—®é¢˜ä½“ç°åœ¨ï¼‰ï¼š</p>\n<p><strong>åŸå­æ€§</strong>ï¼šåŸå­ï¼Œå³ä¸€ä¸ªä¸å¯å†è¢«åˆ†å‰²çš„é¢—ç²’ã€‚åŸå­æ€§æŒ‡çš„æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªæ“ä½œè¦ä¹ˆå…¨éƒ¨æ‰§è¡ŒæˆåŠŸè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œå¤±è´¥ã€‚ï¼ˆsynchronizedï¼ŒLockï¼‰ï¼ˆçº¿ç¨‹åˆ‡æ¢å¼•èµ·çš„åŸå­æ€§é—®é¢˜ï¼‰</p>\n<p><strong>å¯è§æ€§</strong>ï¼šä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡çš„ä¿®æ”¹ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹èƒ½å¤Ÿç«‹åˆ»çœ‹åˆ°ã€‚ï¼ˆsynchronizedï¼ŒLockï¼Œvolatileï¼‰ï¼ˆJMM å†…å­˜æ¨¡å‹å¯¼è‡´çš„å¯è§æ€§é—®é¢˜ï¼‰</p>\n<p><strong>æœ‰åºæ€§</strong>ï¼šç¨‹åºæ‰§è¡Œçš„é¡ºåºæŒ‰ç…§ä»£ç çš„å…ˆåé¡ºåºæ‰§è¡Œã€‚ï¼ˆsynchronizedï¼ŒLockï¼Œvolatileï¼‰ï¼ˆæŒ‡ä»¤é‡æ’åºå¸¦æ¥çš„æœ‰åºæ€§é—®é¢˜ï¼‰</p>\n<blockquote>\n<p>volatileä¸èƒ½ä¿è¯å¹¶å‘å®‰å…¨ï¼Œæ¯”å¦‚å¤šçº¿ç¨‹å¯¹ä¸€ä¸ªvolatileçš„intå˜é‡è¿›è¡ŒåŠ 1æ“ä½œï¼Œæœ€ç»ˆå¾—åˆ°çš„æ•°å­—å¯èƒ½æ¯”é¢„æœŸå°ï¼Œå°±æ˜¯å› ä¸º++æ“ä½œä¸æ˜¯åŸå­æ€§çš„ï¼Œè€Œvolatileä¹Ÿä¸èƒ½ä¿è¯åŸå­æ€§ï¼Œæ‰€ä»¥å°±ä¼šæœ‰è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨<code>atomicInteger.getAndSet()</code>åŸå­æ“ä½œã€‚</p>\n</blockquote>\n<h3 id=\"çº¿ç¨‹å’Œè¿›ç¨‹\"><a href=\"#çº¿ç¨‹å’Œè¿›ç¨‹\" class=\"headerlink\" title=\"çº¿ç¨‹å’Œè¿›ç¨‹\"></a>çº¿ç¨‹å’Œè¿›ç¨‹</h3><h4 id=\"è¿›ç¨‹é—´çš„é€šä¿¡æ–¹å¼\"><a href=\"#è¿›ç¨‹é—´çš„é€šä¿¡æ–¹å¼\" class=\"headerlink\" title=\"è¿›ç¨‹é—´çš„é€šä¿¡æ–¹å¼\"></a>è¿›ç¨‹é—´çš„é€šä¿¡æ–¹å¼</h4><ol>\n<li><strong>ç®¡é“&#x2F;åŒ¿åç®¡é“(Pipes)</strong> ï¼šç”¨äºå…·æœ‰äº²ç¼˜å…³ç³»çš„çˆ¶å­è¿›ç¨‹é—´æˆ–è€…å…„å¼Ÿè¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼›</li>\n<li>**æœ‰åç®¡é“(Names Pipes)<strong>ï¼šåŒ¿åç®¡é“ç”±äºæ²¡æœ‰åå­—ï¼Œåªèƒ½ç”¨äºäº²ç¼˜å…³ç³»çš„è¿›ç¨‹é—´é€šä¿¡ã€‚ä¸ºäº†å…‹æœè¿™ä¸ªç¼ºç‚¹ï¼Œæå‡ºäº†æœ‰åç®¡é“ã€‚æœ‰åç®¡é“ä¸¥æ ¼éµå¾ª</strong>å…ˆè¿›å…ˆå‡º(first in first out)**ã€‚æœ‰åç®¡é“ä»¥ç£ç›˜æ–‡ä»¶çš„æ–¹å¼å­˜åœ¨ï¼Œå¯ä»¥å®ç°æœ¬æœºä»»æ„ä¸¤ä¸ªè¿›ç¨‹é€šä¿¡ï¼›</li>\n<li><strong>ä¿¡å·(Signal)</strong> ï¼šä¿¡å·æ˜¯ä¸€ç§æ¯”è¾ƒå¤æ‚çš„é€šä¿¡æ–¹å¼ï¼Œç”¨äºé€šçŸ¥æ¥æ”¶è¿›ç¨‹æŸä¸ªäº‹ä»¶å·²ç»å‘ç”Ÿï¼›</li>\n<li><strong>æ¶ˆæ¯é˜Ÿåˆ—(Message Queuing)</strong> ï¼šæ¶ˆæ¯é˜Ÿåˆ—æ˜¯æ¶ˆæ¯çš„é“¾è¡¨ï¼Œå…·æœ‰ç‰¹å®šçš„æ ¼å¼ï¼Œå­˜æ”¾åœ¨å†…å­˜ä¸­å¹¶ç”±æ¶ˆæ¯é˜Ÿåˆ—æ ‡è¯†ç¬¦æ ‡è¯†ã€‚<strong>æ¶ˆæ¯é˜Ÿåˆ—å…‹æœäº†ä¿¡å·æ‰¿è½½ä¿¡æ¯é‡å°‘ï¼Œç®¡é“åªèƒ½æ‰¿è½½æ— æ ¼å¼å­—èŠ‚æµä»¥åŠç¼“å†²åŒºå¤§å°å—é™ç­‰ç¼ºç‚¹</strong>ï¼›</li>\n<li><strong>ä¿¡å·é‡(Semaphores)</strong> ï¼šä¿¡å·é‡æ˜¯ä¸€ä¸ªè®¡æ•°å™¨ï¼Œç”¨äºå¤šè¿›ç¨‹å¯¹å…±äº«æ•°æ®çš„è®¿é—®ï¼Œä¿¡å·é‡çš„æ„å›¾åœ¨äºè¿›ç¨‹é—´åŒæ­¥ã€‚è¿™ç§é€šä¿¡æ–¹å¼ä¸»è¦ç”¨äºè§£å†³ä¸åŒæ­¥ç›¸å…³çš„é—®é¢˜å¹¶é¿å…ç«äº‰æ¡ä»¶ï¼›</li>\n<li><strong>å…±äº«å†…å­˜(Shared memory)</strong> ï¼šä½¿å¾—å¤šä¸ªè¿›ç¨‹å¯ä»¥è®¿é—®åŒä¸€å—å†…å­˜ç©ºé—´ï¼Œä¸åŒè¿›ç¨‹å¯ä»¥åŠæ—¶çœ‹åˆ°å¯¹æ–¹è¿›ç¨‹ä¸­å¯¹å…±äº«å†…å­˜ä¸­æ•°æ®çš„æ›´æ–°ã€‚è¿™ç§æ–¹å¼éœ€è¦ä¾é æŸç§åŒæ­¥æ“ä½œï¼Œå¦‚äº’æ–¥é”å’Œä¿¡å·é‡ç­‰ã€‚å¯ä»¥è¯´è¿™æ˜¯æœ€æœ‰ç”¨çš„è¿›ç¨‹é—´é€šä¿¡æ–¹å¼ï¼›</li>\n<li>**å¥—æ¥å­—(Sockets)**ï¼šæ­¤æ–¹æ³•ä¸»è¦ç”¨äºåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´é€šè¿‡ç½‘ç»œè¿›è¡Œé€šä¿¡ã€‚å¥—æ¥å­—æ˜¯æ”¯æŒ TCP&#x2F;IP çš„ç½‘ç»œé€šä¿¡çš„åŸºæœ¬æ“ä½œå•å…ƒï¼Œå¯ä»¥çœ‹åšæ˜¯ä¸åŒä¸»æœºä¹‹é—´çš„è¿›ç¨‹è¿›è¡ŒåŒå‘é€šä¿¡çš„ç«¯ç‚¹ï¼Œç®€å•çš„è¯´å°±æ˜¯é€šä¿¡çš„ä¸¤æ–¹çš„ä¸€ç§çº¦å®šï¼Œç”¨å¥—æ¥å­—ä¸­çš„ç›¸å…³å‡½æ•°æ¥å®Œæˆé€šä¿¡è¿‡ç¨‹ã€‚</li>\n</ol>\n<h4 id=\"çº¿ç¨‹é—´çš„åŒæ­¥æ–¹å¼\"><a href=\"#çº¿ç¨‹é—´çš„åŒæ­¥æ–¹å¼\" class=\"headerlink\" title=\"çº¿ç¨‹é—´çš„åŒæ­¥æ–¹å¼\"></a>çº¿ç¨‹é—´çš„åŒæ­¥æ–¹å¼</h4><p>çº¿ç¨‹åŒæ­¥æ˜¯ä¸¤ä¸ªæˆ–å¤šä¸ªå…±äº«å…³é”®èµ„æºçš„çº¿ç¨‹çš„å¹¶å‘æ‰§è¡Œã€‚åº”è¯¥åŒæ­¥çº¿ç¨‹ä»¥é¿å…å…³é”®çš„èµ„æºä½¿ç”¨å†²çªã€‚</p>\n<ol>\n<li>**äº’æ–¥é‡(Mutex)**ï¼šé‡‡ç”¨äº’æ–¥å¯¹è±¡æœºåˆ¶ï¼Œåªæœ‰æ‹¥æœ‰äº’æ–¥å¯¹è±¡çš„çº¿ç¨‹æ‰æœ‰è®¿é—®å…¬å…±èµ„æºçš„æƒé™ã€‚å› ä¸ºäº’æ–¥å¯¹è±¡åªæœ‰ä¸€ä¸ªï¼Œæ‰€ä»¥å¯ä»¥ä¿è¯å…¬å…±èµ„æºä¸ä¼šè¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®ï¼Œæ¯”å¦‚ Java ä¸­çš„ synchronized å…³é”®è¯å’Œå„ç§ Lock éƒ½æ˜¯è¿™ç§æœºåˆ¶ï¼›</li>\n<li><strong>ä¿¡å·é‡(Semphares)</strong> ï¼šå®ƒå…è®¸åŒä¸€æ—¶åˆ»å¤šä¸ªçº¿ç¨‹è®¿é—®åŒä¸€èµ„æºï¼Œä½†æ˜¯éœ€è¦æ§åˆ¶åŒä¸€æ—¶åˆ»è®¿é—®æ­¤èµ„æºçš„æœ€å¤§çº¿ç¨‹æ•°é‡ï¼›</li>\n<li><strong>äº‹ä»¶(Event)</strong> ï¼šwait&#x2F;notifyï¼šé€šè¿‡é€šçŸ¥æ“ä½œçš„æ–¹å¼æ¥ä¿æŒå¤šçº¿ç¨‹åŒæ­¥ï¼Œè¿˜å¯ä»¥æ–¹ä¾¿çš„å®ç°å¤šçº¿ç¨‹ä¼˜å…ˆçº§çš„æ¯”è¾ƒæ“ä½œã€‚</li>\n</ol>\n<h4 id=\"ä»€ä¹ˆæ˜¯çº¿ç¨‹å’Œè¿›ç¨‹\"><a href=\"#ä»€ä¹ˆæ˜¯çº¿ç¨‹å’Œè¿›ç¨‹\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯çº¿ç¨‹å’Œè¿›ç¨‹?\"></a>ä»€ä¹ˆæ˜¯çº¿ç¨‹å’Œè¿›ç¨‹?</h4><p><strong>è¿›ç¨‹</strong>ï¼šè¿›ç¨‹æ˜¯åº”ç”¨ç¨‹åºçš„ä¸€æ¬¡è¿è¡Œï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„å†…å­˜ç©ºé—´ï¼Œæ˜¯æ“ä½œç³»ç»Ÿèµ„æºåˆ†é…çš„åŸºæœ¬å•ä½ï¼›</p>\n<p><strong>çº¿ç¨‹</strong>ï¼šçº¿ç¨‹æ˜¯å¤„ç†å™¨è°ƒåº¦å’Œæ‰§è¡Œçš„åŸºæœ¬å•ä½ï¼Œä¸€ä¸ªè¿›ç¨‹ä¸­å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹ï¼Œçº¿ç¨‹å…±äº«è¿›ç¨‹çš„å†…å­˜ç©ºé—´å’Œèµ„æºã€‚</p>\n<h4 id=\"ä»€ä¹ˆæ˜¯ä¸Šä¸‹æ–‡åˆ‡æ¢\"><a href=\"#ä»€ä¹ˆæ˜¯ä¸Šä¸‹æ–‡åˆ‡æ¢\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ä¸Šä¸‹æ–‡åˆ‡æ¢?\"></a>ä»€ä¹ˆæ˜¯ä¸Šä¸‹æ–‡åˆ‡æ¢?</h4><p>å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­ä¸€èˆ¬çº¿ç¨‹çš„ä¸ªæ•°éƒ½å¤§äº CPU æ ¸å¿ƒçš„ä¸ªæ•°ï¼Œè€Œä¸€ä¸ª CPU æ ¸å¿ƒåœ¨ä»»æ„æ—¶åˆ»åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨ï¼Œä¸ºäº†è®©è¿™äº›çº¿ç¨‹éƒ½èƒ½å¾—åˆ°æœ‰æ•ˆæ‰§è¡Œï¼ŒCPU é‡‡å–çš„ç­–ç•¥æ˜¯ä¸ºæ¯ä¸ªçº¿ç¨‹åˆ†é…æ—¶é—´ç‰‡å¹¶è½®è½¬çš„å½¢å¼ã€‚</p>\n<p>å½“å‰ä»»åŠ¡åœ¨æ‰§è¡Œå®Œ CPU æ—¶é—´ç‰‡åˆ‡æ¢åˆ°å¦ä¸€ä¸ªä»»åŠ¡ä¹‹å‰ä¼šå…ˆä¿å­˜è‡ªå·±çš„çŠ¶æ€ï¼Œä»¥ä¾¿ä¸‹æ¬¡å†åˆ‡æ¢å›è¿™ä¸ªä»»åŠ¡æ—¶ï¼Œå¯ä»¥å†åŠ è½½è¿™ä¸ªä»»åŠ¡çš„çŠ¶æ€ã€‚<strong>ä»»åŠ¡ä»ä¿å­˜åˆ°å†åŠ è½½çš„è¿‡ç¨‹å°±æ˜¯ä¸€æ¬¡ä¸Šä¸‹æ–‡åˆ‡æ¢</strong>ã€‚</p>\n<p>ä¸Šä¸‹æ–‡åˆ‡æ¢å¯¹ç³»ç»Ÿæ¥è¯´æ„å‘³ç€æ¶ˆè€—å¤§é‡çš„ CPU æ—¶é—´ï¼Œäº‹å®ä¸Šï¼Œå¯èƒ½æ˜¯æ“ä½œç³»ç»Ÿä¸­æ—¶é—´æ¶ˆè€—æœ€å¤§çš„æ“ä½œã€‚</p>\n<h4 id=\"å®ˆæŠ¤çº¿ç¨‹å’Œç”¨æˆ·çº¿ç¨‹æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ\"><a href=\"#å®ˆæŠ¤çº¿ç¨‹å’Œç”¨æˆ·çº¿ç¨‹æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ\" class=\"headerlink\" title=\"å®ˆæŠ¤çº¿ç¨‹å’Œç”¨æˆ·çº¿ç¨‹æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ\"></a>å®ˆæŠ¤çº¿ç¨‹å’Œç”¨æˆ·çº¿ç¨‹æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ</h4><ul>\n<li><strong>ç”¨æˆ· (User) çº¿ç¨‹</strong>ï¼šè¿è¡Œåœ¨å‰å°ï¼Œæ‰§è¡Œå…·ä½“çš„ä»»åŠ¡</li>\n<li><strong>å®ˆæŠ¤ (Daemon) çº¿ç¨‹</strong>ï¼šè¿è¡Œåœ¨åå°ï¼Œä¸ºå…¶ä»–å‰å°çº¿ç¨‹æœåŠ¡ã€‚ä¸€æ—¦æ‰€æœ‰ç”¨æˆ·çº¿ç¨‹éƒ½ç»“æŸè¿è¡Œï¼Œå®ˆæŠ¤çº¿ç¨‹ä¼šéš JVM ä¸€èµ·ç»“æŸå·¥ä½œ</li>\n</ul>\n<p><strong>æ³¨æ„äº‹é¡¹ï¼š</strong></p>\n<ol>\n<li><code>setDaemon(true)</code>å¿…é¡»åœ¨<code>start()</code>æ–¹æ³•å‰æ‰§è¡Œï¼Œå¦åˆ™ä¼šæŠ›å‡º <code>IllegalThreadStateException</code> å¼‚å¸¸ï¼›</li>\n<li>åœ¨å®ˆæŠ¤çº¿ç¨‹ä¸­äº§ç”Ÿçš„æ–°çº¿ç¨‹ä¹Ÿæ˜¯å®ˆæŠ¤çº¿ç¨‹ï¼›</li>\n<li>ä¸æ˜¯æ‰€æœ‰çš„ä»»åŠ¡éƒ½å¯ä»¥åˆ†é…ç»™å®ˆæŠ¤çº¿ç¨‹æ¥æ‰§è¡Œï¼Œæ¯”å¦‚è¯»å†™æ“ä½œæˆ–è€…è®¡ç®—é€»è¾‘ï¼›</li>\n<li>å®ˆæŠ¤ (Daemon) çº¿ç¨‹ä¸­ä¸èƒ½ä¾é  finally å—çš„å†…å®¹æ¥ç¡®ä¿æ‰§è¡Œå…³é—­æˆ–æ¸…ç†èµ„æºçš„é€»è¾‘ã€‚å› ä¸ºæˆ‘ä»¬ä¸Šé¢ä¹Ÿè¯´è¿‡äº†ä¸€æ—¦æ‰€æœ‰ç”¨æˆ·çº¿ç¨‹éƒ½ç»“æŸè¿è¡Œï¼Œå®ˆæŠ¤çº¿ç¨‹ä¼šéš JVM ä¸€èµ·ç»“æŸå·¥ä½œï¼Œæ‰€ä»¥å®ˆæŠ¤ (Daemon) çº¿ç¨‹ä¸­çš„ finally è¯­å¥å—å¯èƒ½æ— æ³•è¢«æ‰§è¡Œã€‚</li>\n</ol>\n<h4 id=\"å¦‚ä½•åœ¨-Windows-å’Œ-Linux-ä¸ŠæŸ¥æ‰¾å“ªä¸ªçº¿ç¨‹cpuåˆ©ç”¨ç‡æœ€é«˜ï¼Ÿ\"><a href=\"#å¦‚ä½•åœ¨-Windows-å’Œ-Linux-ä¸ŠæŸ¥æ‰¾å“ªä¸ªçº¿ç¨‹cpuåˆ©ç”¨ç‡æœ€é«˜ï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•åœ¨ Windows å’Œ Linux ä¸ŠæŸ¥æ‰¾å“ªä¸ªçº¿ç¨‹cpuåˆ©ç”¨ç‡æœ€é«˜ï¼Ÿ\"></a>å¦‚ä½•åœ¨ Windows å’Œ Linux ä¸ŠæŸ¥æ‰¾å“ªä¸ªçº¿ç¨‹cpuåˆ©ç”¨ç‡æœ€é«˜ï¼Ÿ</h4><p>Windows ä¸‹ç”¨ä»»åŠ¡ç®¡ç†å™¨çœ‹ï¼ŒLinux ä¸‹å¯ä»¥ç”¨ top è¿™ä¸ªå‘½ä»¤çœ‹ã€‚</p>\n<h4 id=\"ä»€ä¹ˆæ˜¯çº¿ç¨‹æ­»é”\"><a href=\"#ä»€ä¹ˆæ˜¯çº¿ç¨‹æ­»é”\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯çº¿ç¨‹æ­»é”\"></a>ä»€ä¹ˆæ˜¯çº¿ç¨‹æ­»é”</h4><p>æ­»é”æ˜¯æŒ‡ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„çº¿ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œç”±äºç«äº‰èµ„æºé€ æˆçš„ä¸€ç§é˜»å¡çš„ç°è±¡ï¼Œè‹¥æ— å¤–åŠ›ä½œç”¨ï¼Œå®ƒä»¬éƒ½å°†æ— æ³•æ¨è¿›ä¸‹å»ã€‚</p>\n<p>å¦‚å›¾æ‰€ç¤ºï¼Œçº¿ç¨‹ A æŒæœ‰èµ„æº 2ï¼Œçº¿ç¨‹ B æŒæœ‰èµ„æº 1ï¼Œä»–ä»¬åŒæ—¶éƒ½æƒ³ç”³è¯·å¯¹æ–¹çš„èµ„æºï¼Œè¿™ä¸¤ä¸ªçº¿ç¨‹å°±ä¼šäº’ç›¸ç­‰å¾…è€Œè¿›å…¥æ­»é”çŠ¶æ€ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/202206152131355.png\" alt=\"çº¿ç¨‹æ­»é”\"></p>\n<p>ä¸‹é¢é€šè¿‡ä»£ç æ¨¡æ‹Ÿäº†ä¸Šå›¾çš„æ­»é”çš„æƒ…å†µï¼ˆä»£ç æ¥æºäºã€Šå¹¶å‘ç¼–ç¨‹ä¹‹ç¾ã€‹ï¼‰ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">DeadLockDemo</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">Object</span> <span class=\"variable\">resource1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>();\t<span class=\"comment\">//èµ„æº 1</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">Object</span> <span class=\"variable\">resource2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>();\t<span class=\"comment\">//èµ„æº 2</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">synchronized</span> (resource1) &#123;</span><br><span class=\"line\">                System.out.println(Thread.currentThread() + <span class=\"string\">&quot;get resource1&quot;</span>);</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                System.out.println(Thread.currentThread() + <span class=\"string\">&quot;waiting get resource2&quot;</span>);</span><br><span class=\"line\">                <span class=\"keyword\">synchronized</span> (resource2) &#123;</span><br><span class=\"line\">                    System.out.println(Thread.currentThread() + <span class=\"string\">&quot;get resource2&quot;</span>);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;çº¿ç¨‹ 1&quot;</span>).start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">synchronized</span> (resource2) &#123;</span><br><span class=\"line\">                System.out.println(Thread.currentThread() + <span class=\"string\">&quot;get resource2&quot;</span>);</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                System.out.println(Thread.currentThread() + <span class=\"string\">&quot;waiting get resource1&quot;</span>);</span><br><span class=\"line\">                <span class=\"keyword\">synchronized</span> (resource1) &#123;</span><br><span class=\"line\">                    System.out.println(Thread.currentThread() + <span class=\"string\">&quot;get resource1&quot;</span>);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;çº¿ç¨‹ 2&quot;</span>).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>è¾“å‡ºç»“æœ</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Thread[çº¿ç¨‹ <span class=\"number\">1</span>,<span class=\"number\">5</span>,main]get resource1</span><br><span class=\"line\">Thread[çº¿ç¨‹ <span class=\"number\">2</span>,<span class=\"number\">5</span>,main]get resource2</span><br><span class=\"line\">Thread[çº¿ç¨‹ <span class=\"number\">1</span>,<span class=\"number\">5</span>,main]waiting get resource2</span><br><span class=\"line\">Thread[çº¿ç¨‹ <span class=\"number\">2</span>,<span class=\"number\">5</span>,main]waiting get resource1</span><br></pre></td></tr></table></figure>\n\n<p>çº¿ç¨‹ A é€šè¿‡ synchronized (resource1) è·å¾— resource1 çš„ç›‘è§†å™¨é”ï¼Œç„¶åé€šè¿‡<code>Thread.sleep(1000)</code>ï¼›è®©çº¿ç¨‹ A ä¼‘çœ  1s ä¸ºçš„æ˜¯è®©çº¿ç¨‹ B å¾—åˆ° CPU æ‰§è¡Œæƒï¼Œç„¶åè·å–åˆ° resource2 çš„ç›‘è§†å™¨é”ã€‚çº¿ç¨‹ A å’Œçº¿ç¨‹ B ä¼‘çœ ç»“æŸäº†éƒ½å¼€å§‹ä¼å›¾è¯·æ±‚è·å–å¯¹æ–¹çš„èµ„æºï¼Œç„¶åè¿™ä¸¤ä¸ªçº¿ç¨‹å°±ä¼šé™·å…¥äº’ç›¸ç­‰å¾…çš„çŠ¶æ€ï¼Œè¿™ä¹Ÿå°±äº§ç”Ÿäº†æ­»é”ã€‚ä¸Šé¢çš„ä¾‹å­ç¬¦åˆäº§ç”Ÿæ­»é”çš„å››ä¸ªå¿…è¦æ¡ä»¶ã€‚</p>\n<h4 id=\"å½¢æˆæ­»é”çš„å››ä¸ªå¿…è¦æ¡ä»¶æ˜¯ä»€ä¹ˆ\"><a href=\"#å½¢æˆæ­»é”çš„å››ä¸ªå¿…è¦æ¡ä»¶æ˜¯ä»€ä¹ˆ\" class=\"headerlink\" title=\"å½¢æˆæ­»é”çš„å››ä¸ªå¿…è¦æ¡ä»¶æ˜¯ä»€ä¹ˆ\"></a>å½¢æˆæ­»é”çš„å››ä¸ªå¿…è¦æ¡ä»¶æ˜¯ä»€ä¹ˆ</h4><ol>\n<li>äº’æ–¥æ¡ä»¶ï¼šä¸€ä¸ªèµ„æºåªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹å ç”¨ï¼Œç›´åˆ°è¢«è¯¥çº¿ç¨‹é‡Šæ”¾ï¼›</li>\n<li>è¯·æ±‚ä¸ä¿æŒæ¡ä»¶ï¼šä¸€ä¸ªçº¿ç¨‹å› è¯·æ±‚è¢«å ç”¨èµ„æºè€Œå‘ç”Ÿé˜»å¡æ—¶ï¼Œå¯¹å·²è·å¾—çš„èµ„æºä¿æŒä¸æ”¾ï¼›</li>\n<li>ä¸å‰¥å¤ºæ¡ä»¶ï¼šçº¿ç¨‹å·²è·å¾—çš„èµ„æºåœ¨æœ«ä½¿ç”¨å®Œä¹‹å‰ä¸èƒ½è¢«å…¶ä»–çº¿ç¨‹å¼ºè¡Œå‰¥å¤ºï¼Œåªæœ‰è‡ªå·±ä½¿ç”¨å®Œæ¯•åæ‰é‡Šæ”¾èµ„æºï¼›</li>\n<li>å¾ªç¯ç­‰å¾…æ¡ä»¶ï¼šå½“å‘ç”Ÿæ­»é”æ—¶ï¼Œæ‰€ç­‰å¾…çš„çº¿ç¨‹å¿…å®šä¼šå½¢æˆä¸€ä¸ªç¯è·¯ï¼ˆç±»ä¼¼äºæ­»å¾ªç¯ï¼‰ï¼Œé€ æˆæ°¸ä¹…é˜»å¡ã€‚</li>\n</ol>\n<h4 id=\"å¦‚ä½•é¿å…çº¿ç¨‹æ­»é”\"><a href=\"#å¦‚ä½•é¿å…çº¿ç¨‹æ­»é”\" class=\"headerlink\" title=\"å¦‚ä½•é¿å…çº¿ç¨‹æ­»é”\"></a>å¦‚ä½•é¿å…çº¿ç¨‹æ­»é”</h4><p>æˆ‘ä»¬åªè¦ç ´åäº§ç”Ÿæ­»é”çš„å››ä¸ªæ¡ä»¶ä¸­çš„å…¶ä¸­ä¸€ä¸ªå°±å¯ä»¥äº†ã€‚</p>\n<p><strong>ç ´åäº’æ–¥æ¡ä»¶</strong>ï¼šæ— æ³•ç ´åï¼Œå› ä¸ºæˆ‘ä»¬ç”¨é”æœ¬æ¥å°±æ˜¯æƒ³å®ç°äº’æ–¥è®¿é—®ä¸´ç•Œèµ„æºï¼›</p>\n<p><strong>ç ´åè¯·æ±‚ä¸ä¿æŒæ¡ä»¶</strong>ï¼šä¸€æ¬¡æ€§ç”³è¯·æ‰€æœ‰çš„èµ„æºï¼›</p>\n<p><strong>ç ´åä¸å‰¥å¤ºæ¡ä»¶</strong>ï¼šå ç”¨éƒ¨åˆ†èµ„æºçš„çº¿ç¨‹è¿›ä¸€æ­¥ç”³è¯·å…¶ä»–èµ„æºæ—¶ï¼Œ<strong>å¦‚æœç”³è¯·ä¸åˆ°ï¼Œå¯ä»¥ä¸»åŠ¨é‡Šæ”¾å®ƒå æœ‰çš„èµ„æº</strong>ï¼›</p>\n<p><strong>ç ´åå¾ªç¯ç­‰å¾…æ¡ä»¶</strong>ï¼šé <strong>æŒ‰åºç”³è¯·</strong>èµ„æºæ¥é¢„é˜²ã€‚æŒ‰æŸä¸€é¡ºåºç”³è¯·èµ„æºï¼Œé‡Šæ”¾èµ„æºåˆ™ååºé‡Šæ”¾ã€‚ç ´åå¾ªç¯ç­‰å¾…æ¡ä»¶ã€‚</p>\n<p>æˆ‘ä»¬å¯¹çº¿ç¨‹ 2 çš„ä»£ç ä¿®æ”¹æˆä¸‹é¢è¿™æ ·å°±ä¸ä¼šäº§ç”Ÿæ­»é”äº†ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">synchronized</span> (resource1) &#123;</span><br><span class=\"line\">        System.out.println(Thread.currentThread() + <span class=\"string\">&quot;get resource1&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(Thread.currentThread() + <span class=\"string\">&quot;waiting get resource2&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span> (resource2) &#123;</span><br><span class=\"line\">            System.out.println(Thread.currentThread() + <span class=\"string\">&quot;get resource2&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;, <span class=\"string\">&quot;çº¿ç¨‹ 2&quot;</span>).start();</span><br></pre></td></tr></table></figure>\n\n<p>è¾“å‡ºç»“æœ</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Thread[çº¿ç¨‹ <span class=\"number\">1</span>,<span class=\"number\">5</span>,main]get resource1</span><br><span class=\"line\">Thread[çº¿ç¨‹ <span class=\"number\">1</span>,<span class=\"number\">5</span>,main]waiting get resource2</span><br><span class=\"line\">Thread[çº¿ç¨‹ <span class=\"number\">1</span>,<span class=\"number\">5</span>,main]get resource2</span><br><span class=\"line\">Thread[çº¿ç¨‹ <span class=\"number\">2</span>,<span class=\"number\">5</span>,main]get resource1</span><br><span class=\"line\">Thread[çº¿ç¨‹ <span class=\"number\">2</span>,<span class=\"number\">5</span>,main]waiting get resource2</span><br><span class=\"line\">Thread[çº¿ç¨‹ <span class=\"number\">2</span>,<span class=\"number\">5</span>,main]get resource2</span><br></pre></td></tr></table></figure>\n\n<p>æˆ‘ä»¬åˆ†æä¸€ä¸‹ä¸Šé¢çš„ä»£ç ä¸ºä»€ä¹ˆé¿å…äº†æ­»é”çš„å‘ç”Ÿ?</p>\n<p>çº¿ç¨‹ 1 é¦–å…ˆè·å¾—åˆ° resource1 çš„ç›‘è§†å™¨é”ï¼Œè¿™æ—¶å€™çº¿ç¨‹ 2 å°±è·å–ä¸åˆ°äº†ã€‚ç„¶åçº¿ç¨‹ 1 å†å»è·å– resource2 çš„ç›‘è§†å™¨é”ï¼Œå¯ä»¥è·å–åˆ°ã€‚ç„¶åçº¿ç¨‹ 1 é‡Šæ”¾äº†å¯¹ resource1ã€resource2 çš„ç›‘è§†å™¨é”çš„å ç”¨ï¼Œçº¿ç¨‹ 2 è·å–åˆ°å°±å¯ä»¥æ‰§è¡Œäº†ã€‚è¿™æ ·å°±ç ´åäº†ç ´åå¾ªç¯ç­‰å¾…æ¡ä»¶ï¼Œå› æ­¤é¿å…äº†æ­»é”ã€‚</p>\n<h4 id=\"åˆ›å»ºçº¿ç¨‹æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ\"><a href=\"#åˆ›å»ºçº¿ç¨‹æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ\" class=\"headerlink\" title=\"åˆ›å»ºçº¿ç¨‹æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ\"></a>åˆ›å»ºçº¿ç¨‹æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ</h4><p>åˆ›å»ºçº¿ç¨‹æœ‰å››ç§æ–¹å¼ï¼š</p>\n<ul>\n<li>ç»§æ‰¿ Thread ç±»</li>\n<li>å®ç° Runnable æ¥å£</li>\n<li>å®ç° Callable æ¥å£</li>\n<li>ä½¿ç”¨ Executors å·¥å…·ç±»åˆ›å»ºçº¿ç¨‹æ± </li>\n</ul>\n<p><strong>ç»§æ‰¿ Thread ç±»</strong></p>\n<ol>\n<li>å®šä¹‰ä¸€ä¸ª Thread ç±»çš„å­ç±»ï¼Œé‡å†™ run æ–¹æ³•ï¼›</li>\n<li>åˆ›å»ºè‡ªå®šä¹‰çš„çº¿ç¨‹å­ç±»å¯¹è±¡ï¼›</li>\n<li>è°ƒç”¨å­ç±»å®ä¾‹çš„ start() æ–¹æ³•æ¥å¯åŠ¨çº¿ç¨‹ã€‚</li>\n</ol>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Main</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyThread</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">Thread</span> &#123;</span><br><span class=\"line\">        <span class=\"meta\">@Override</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">            System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; run()æ–¹æ³•æ­£åœ¨æ‰§è¡Œ...&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">MyThread</span>().start();</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            Thread.sleep(<span class=\"number\">10</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; main()æ–¹æ³•æ‰§è¡Œç»“æŸ&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ç° Runnable æ¥å£</strong></p>\n<ol>\n<li>å®šä¹‰ Runnable æ¥å£å®ç°ç±» MyRunnableï¼Œå¹¶é‡å†™ run() æ–¹æ³•ï¼›</li>\n<li>åˆ›å»º MyRunnable å®ä¾‹ myRunnableï¼Œä»¥ myRunnable ä½œä¸º target åˆ›å»º Thread å®ä¾‹ï¼Œ<strong>è¯¥Threadå¯¹è±¡æ‰æ˜¯çœŸæ­£çš„çº¿ç¨‹å¯¹è±¡</strong>ï¼›</li>\n<li>è°ƒç”¨çº¿ç¨‹å®ä¾‹çš„ start() æ–¹æ³•ã€‚</li>\n</ol>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Main</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyRunnable</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Runnable</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"meta\">@Override</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">            System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; run()æ–¹æ³•æ­£åœ¨æ‰§è¡Œ...&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">MyRunnable</span>()).start();</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            Thread.sleep(<span class=\"number\">10</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; main()æ–¹æ³•æ‰§è¡Œç»“æŸ&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ç° Callable æ¥å£</strong></p>\n<ol>\n<li>åˆ›å»ºå®ç° Callable æ¥å£çš„ç±» myCallableï¼›</li>\n<li>ä»¥ myCallable ä¸ºå‚æ•°åˆ›å»º FutureTask å¯¹è±¡ï¼›</li>\n<li>å°† FutureTask ä½œä¸ºå‚æ•°åˆ›å»º Thread å¯¹è±¡ï¼›</li>\n<li>è°ƒç”¨çº¿ç¨‹å¯¹è±¡çš„ start() æ–¹æ³•ã€‚</li>\n</ol>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Main</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyCallable</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Callable</span>&lt;Integer&gt; &#123;</span><br><span class=\"line\">        <span class=\"meta\">@Override</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> Integer <span class=\"title function_\">call</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">            System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; call()æ–¹æ³•æ‰§è¡Œä¸­...&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        FutureTask&lt;Integer&gt; futureTask = <span class=\"keyword\">new</span> <span class=\"title class_\">FutureTask</span>&lt;&gt;(<span class=\"keyword\">new</span> <span class=\"title class_\">MyCallable</span>());</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(futureTask).start();</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            Thread.sleep(<span class=\"number\">10</span>);</span><br><span class=\"line\">            System.out.println(futureTask.get());</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException | ExecutionException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; main()æ–¹æ³•æ‰§è¡Œå®Œæˆ&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>ä½¿ç”¨ Executors å·¥å…·ç±»åˆ›å»ºçº¿ç¨‹æ± </strong></p>\n<p>Executors æä¾›äº†ä¸€ç³»åˆ—å·¥å‚æ–¹æ³•ç”¨äºåˆ›å»ºçº¿ç¨‹æ± ï¼Œè¿”å›çš„çº¿ç¨‹æ± éƒ½å®ç°äº† ExecutorService æ¥å£ã€‚</p>\n<p>ä¸»è¦æœ‰ new[Single&#x2F;Fixed&#x2F;Cached&#x2F;Scheduled]ThreadPool è¿™å››ç§çº¿ç¨‹æ± </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyRunnable</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Runnable</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; run()æ–¹æ³•æ‰§è¡Œä¸­...&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">SingleThreadExecutorTest</span> &#123;n</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">ExecutorService</span> <span class=\"variable\">executorService</span> <span class=\"operator\">=</span> Executors.newSingleThreadExecutor();</span><br><span class=\"line\">        <span class=\"type\">MyRunnable</span> <span class=\"variable\">myRunnable</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MyRunnable</span>();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">5</span>; i++) &#123;</span><br><span class=\"line\">            executorService.execute(myRunnable);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;çº¿ç¨‹ä»»åŠ¡å¼€å§‹æ‰§è¡Œ&quot;</span>);</span><br><span class=\"line\">        executorService.shutdown();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"è¯´ä¸€ä¸‹-runnable-å’Œ-callable-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"><a href=\"#è¯´ä¸€ä¸‹-runnable-å’Œ-callable-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"è¯´ä¸€ä¸‹ runnable å’Œ callable æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"></a>è¯´ä¸€ä¸‹ runnable å’Œ callable æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h4><p>ç›¸åŒç‚¹</p>\n<ul>\n<li>éƒ½æ˜¯æ¥å£</li>\n<li>éƒ½å¯ä»¥ç”¨æ¥å®ç°å¤šçº¿ç¨‹</li>\n<li>éƒ½åˆ›å»º Thread å®ä¾‹å¹¶è°ƒç”¨å…¶ start() æ–¹æ³•å¯åŠ¨çº¿ç¨‹</li>\n</ul>\n<p>ä¸»è¦åŒºåˆ«</p>\n<ul>\n<li>Runnable æ¥å£ run æ–¹æ³•æ— è¿”å›å€¼ï¼›Callable æ¥å£ call æ–¹æ³•æœ‰è¿”å›å€¼ï¼Œå’Œ FutureTask é…åˆå¯ä»¥ç”¨æ¥è·å–å¼‚æ­¥æ‰§è¡Œçš„ç»“æœ</li>\n<li>Runnable æ¥å£ run æ–¹æ³•æ— æ³•æ•è·å¹¶å¤„ç†å¼‚å¸¸ï¼›Callable æ¥å£ call æ–¹æ³•å¯ä»¥æ•è·å¹¶å¤„ç†å¼‚å¸¸</li>\n</ul>\n<h4 id=\"çº¿ç¨‹çš„-run-å’Œ-start-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"><a href=\"#çº¿ç¨‹çš„-run-å’Œ-start-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"çº¿ç¨‹çš„ run()å’Œ start()æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"></a>çº¿ç¨‹çš„ run()å’Œ start()æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h4><blockquote>\n<p>start() æ–¹æ³•æ¥å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ï¼ŒçœŸæ­£å®ç°äº†å¤šçº¿ç¨‹è¿è¡Œã€‚è°ƒç”¨ start() æ–¹æ³•æ— éœ€ç­‰å¾…runæ–¹æ³•ä½“ä»£ç æ‰§è¡Œå®Œæ¯•ï¼Œå¯ä»¥ç›´æ¥ç»§ç»­æ‰§è¡Œå…¶ä»–çš„ä»£ç ï¼› æ­¤æ—¶çº¿ç¨‹æ˜¯å¤„äºå°±ç»ªçŠ¶æ€ï¼Œå¹¶æ²¡æœ‰è¿è¡Œã€‚ ç„¶åé€šè¿‡æ­¤ Thread ç±»è°ƒç”¨æ–¹æ³• run() æ¥å®Œæˆå…¶è¿è¡ŒçŠ¶æ€ï¼Œ run() æ–¹æ³•è¿è¡Œç»“æŸï¼Œ æ­¤çº¿ç¨‹ç»ˆæ­¢ã€‚ç„¶å CPU å†è°ƒåº¦å…¶å®ƒçº¿ç¨‹ã€‚</p>\n</blockquote>\n<p>start() æ–¹æ³•ç”¨äºå¯åŠ¨çº¿ç¨‹ï¼Œrun() æ–¹æ³•ç”¨äºæ‰§è¡Œçº¿ç¨‹çš„è¿è¡Œæ—¶ä»£ç ï¼Œç›´æ¥è°ƒç”¨ run()ï¼Œå…¶å®å°±ç›¸å½“äºæ˜¯è°ƒç”¨äº†ä¸€ä¸ªæ™®é€šå‡½æ•°è€Œå·²ã€‚<br>start() åªèƒ½è°ƒç”¨ä¸€æ¬¡ï¼Œrun() å¯ä»¥é‡å¤è°ƒç”¨ã€‚</p>\n<h4 id=\"ä»€ä¹ˆæ˜¯-Callable-å’Œ-Future\"><a href=\"#ä»€ä¹ˆæ˜¯-Callable-å’Œ-Future\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ Callable å’Œ Future?\"></a>ä»€ä¹ˆæ˜¯ Callable å’Œ Future?</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">FutureTask&lt;Integer&gt; futureTask = <span class=\"keyword\">new</span> <span class=\"title class_\">FutureTask</span>&lt;&gt;(<span class=\"keyword\">new</span> <span class=\"title class_\">MyCallable</span>());</span><br><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(futureTask).start();</span><br></pre></td></tr></table></figure>\n\n<p>å°† callable å®ä¾‹ä¼ å…¥ futureï¼Œç„¶åå°† future å®ä¾‹ä¼ å…¥ Thread åˆ›å»ºçº¿ç¨‹ï¼Œ<br>ä¹‹åå¯ä»¥ç”¨ future æ¥è·å– callable  ä¸­ call() çš„è¿”å›ç»“æœã€‚</p>\n<h4 id=\"çº¿ç¨‹çš„çŠ¶æ€å’ŒåŸºæœ¬æ“ä½œ\"><a href=\"#çº¿ç¨‹çš„çŠ¶æ€å’ŒåŸºæœ¬æ“ä½œ\" class=\"headerlink\" title=\"çº¿ç¨‹çš„çŠ¶æ€å’ŒåŸºæœ¬æ“ä½œ\"></a>çº¿ç¨‹çš„çŠ¶æ€å’ŒåŸºæœ¬æ“ä½œ</h4><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650518197279.png\" alt=\"çº¿ç¨‹çš„çŠ¶æ€\" style=\"zoom:67%;\" />\n\n<h4 id=\"Java-ä¸­ç”¨åˆ°çš„çº¿ç¨‹è°ƒåº¦ç®—æ³•æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#Java-ä¸­ç”¨åˆ°çš„çº¿ç¨‹è°ƒåº¦ç®—æ³•æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"Java ä¸­ç”¨åˆ°çš„çº¿ç¨‹è°ƒåº¦ç®—æ³•æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>Java ä¸­ç”¨åˆ°çš„çº¿ç¨‹è°ƒåº¦ç®—æ³•æ˜¯ä»€ä¹ˆï¼Ÿ</h4><p>çº¿ç¨‹è°ƒåº¦æ˜¯æŒ‡æŒ‰ç…§ç‰¹å®šæœºåˆ¶ä¸ºå¤šä¸ªçº¿ç¨‹åˆ†é… CPU çš„ä½¿ç”¨æƒã€‚</p>\n<p>æœ‰ä¸¤ç§è°ƒåº¦æ¨¡å‹ï¼š<strong>æ—¶é—´ç‰‡è½®è½¬</strong>æ¨¡å‹å’Œ<strong>ä¼˜å…ˆçº§è°ƒåº¦</strong>æ¨¡å‹ã€‚</p>\n<p><strong>Java è™šæ‹Ÿæœºé‡‡ç”¨ä¼˜å…ˆçº§è°ƒåº¦æ¨¡å‹</strong>ï¼Œæ˜¯æŒ‡ä¼˜å…ˆè®©å¯è¿è¡Œæ± ä¸­ä¼˜å…ˆçº§é«˜çš„çº¿ç¨‹å ç”¨ CPUï¼Œå¦‚æœå¯è¿è¡Œæ± ä¸­çš„çº¿ç¨‹ä¼˜å…ˆçº§ç›¸åŒï¼Œé‚£ä¹ˆå°±éšæœºé€‰æ‹©ä¸€ä¸ªçº¿ç¨‹ï¼Œä½¿å…¶å ç”¨ CPUã€‚å¤„äºè¿è¡ŒçŠ¶æ€çš„çº¿ç¨‹ä¼šä¸€ç›´è¿è¡Œï¼Œç›´è‡³å®ƒä¸å¾—ä¸æ”¾å¼ƒ CPUã€‚</p>\n<h4 id=\"è¯·è¯´å‡ºä¸çº¿ç¨‹åŒæ­¥ä»¥åŠçº¿ç¨‹è°ƒåº¦ç›¸å…³çš„æ–¹æ³•ã€‚\"><a href=\"#è¯·è¯´å‡ºä¸çº¿ç¨‹åŒæ­¥ä»¥åŠçº¿ç¨‹è°ƒåº¦ç›¸å…³çš„æ–¹æ³•ã€‚\" class=\"headerlink\" title=\"è¯·è¯´å‡ºä¸çº¿ç¨‹åŒæ­¥ä»¥åŠçº¿ç¨‹è°ƒåº¦ç›¸å…³çš„æ–¹æ³•ã€‚\"></a>è¯·è¯´å‡ºä¸çº¿ç¨‹åŒæ­¥ä»¥åŠçº¿ç¨‹è°ƒåº¦ç›¸å…³çš„æ–¹æ³•ã€‚</h4><p>ï¼ˆ1ï¼‰wait()ï¼šä½¿ä¸€ä¸ªçº¿ç¨‹å¤„äºç­‰å¾…çŠ¶æ€ï¼Œå¹¶ä¸”é‡Šæ”¾æ‰€æŒæœ‰çš„å¯¹è±¡çš„é”ï¼›</p>\n<p>ï¼ˆ2ï¼‰sleep()ï¼šä½¿ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„çº¿ç¨‹å¤„äºç¡çœ çŠ¶æ€ï¼Œæ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼›</p>\n<p>ï¼ˆ3ï¼‰notify()ï¼šå”¤é†’ä¸€ä¸ªå¤„äºç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ï¼Œå½“ç„¶åœ¨è°ƒç”¨æ­¤æ–¹æ³•çš„æ—¶å€™ï¼Œå¹¶ä¸èƒ½ç¡®åˆ‡çš„å”¤é†’æŸä¸€ä¸ªç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ï¼Œè€Œæ˜¯ç”± JVM ç¡®å®šå”¤é†’å“ªä¸ªçº¿ç¨‹ï¼Œè€Œä¸”ä¸ä¼˜å…ˆçº§æ— å…³ï¼›</p>\n<p>ï¼ˆ4ï¼‰notityAll()ï¼šå”¤é†’æ‰€æœ‰å¤„äºç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ï¼Œè¯¥æ–¹æ³•å¹¶ä¸æ˜¯å°†å¯¹è±¡çš„é”ç»™æ‰€æœ‰çº¿ç¨‹ï¼Œè€Œæ˜¯è®©å®ƒä»¬ç«äº‰ï¼Œåªæœ‰è·å¾—é”çš„çº¿ç¨‹æ‰èƒ½è¿›å…¥å°±ç»ªçŠ¶æ€ï¼›</p>\n<h4 id=\"wait-å’Œ-sleep-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"><a href=\"#wait-å’Œ-sleep-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"wait() å’Œ sleep() æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"></a>wait() å’Œ sleep() æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h4><p>ä¸¤è€…éƒ½å¯ä»¥æš‚åœçº¿ç¨‹çš„æ‰§è¡Œ</p>\n<ul>\n<li>ç±»çš„ä¸åŒï¼šwait() æ˜¯ Object ç±»çš„æ–¹æ³•ï¼Œsleep() æ˜¯ Thread çº¿ç¨‹ç±»çš„é™æ€æ–¹æ³•ã€‚</li>\n<li>é‡Šæ”¾é”ï¼šwait() é‡Šæ”¾é”ï¼Œsleep() ä¸é‡Šæ”¾é”ã€‚</li>\n<li>ç”¨é€”ä¸åŒï¼šwait é€šå¸¸è¢«ç”¨äºçº¿ç¨‹é—´äº¤äº’&#x2F;é€šä¿¡ï¼Œsleep é€šå¸¸è¢«ç”¨äºæš‚åœæ‰§è¡Œã€‚</li>\n<li>è‡ªåŠ¨è‹é†’ï¼šwait() æ–¹æ³•è¢«è°ƒç”¨åï¼Œçº¿ç¨‹ä¸ä¼šè‡ªåŠ¨è‹é†’ï¼Œéœ€è¦åˆ«çš„çº¿ç¨‹è°ƒç”¨åŒä¸€ä¸ªå¯¹è±¡ä¸Šçš„ notify() æˆ–è€… notifyAll() æ–¹æ³•ã€‚sleep() æ–¹æ³•æ‰§è¡Œå®Œæˆåï¼Œçº¿ç¨‹ä¼šè‡ªåŠ¨è‹é†’ã€‚æˆ–è€…å¯ä»¥ä½¿ç”¨ wait(long timeout) è¶…æ—¶åçº¿ç¨‹ä¼šè‡ªåŠ¨è‹é†’ã€‚</li>\n</ul>\n<h4 id=\"ä½ æ˜¯å¦‚ä½•è°ƒç”¨-wait-æ–¹æ³•çš„ï¼Ÿä½¿ç”¨-if-å—è¿˜æ˜¯å¾ªç¯ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ\"><a href=\"#ä½ æ˜¯å¦‚ä½•è°ƒç”¨-wait-æ–¹æ³•çš„ï¼Ÿä½¿ç”¨-if-å—è¿˜æ˜¯å¾ªç¯ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"ä½ æ˜¯å¦‚ä½•è°ƒç”¨ wait() æ–¹æ³•çš„ï¼Ÿä½¿ç”¨ if å—è¿˜æ˜¯å¾ªç¯ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ\"></a>ä½ æ˜¯å¦‚ä½•è°ƒç”¨ wait() æ–¹æ³•çš„ï¼Ÿä½¿ç”¨ if å—è¿˜æ˜¯å¾ªç¯ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</h4><blockquote>\n<p>ä½¿ç”¨ while åˆ¤æ–­æ¡ä»¶æ˜¯å¦å¾—åˆ°æ»¡è¶³</p>\n</blockquote>\n<p>ä½¿ç”¨ if æ¥åˆ¤æ–­ä¼šå­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š</p>\n<ol>\n<li><p>å¦ä¸€ä¸ªçº¿ç¨‹å¯èƒ½å·²ç»è¢«å”¤é†’å¹¶æ”¹å˜äº†æ¡ä»¶çŠ¶æ€ã€‚ä¾‹å¦‚ notifyAll ä¼šå”¤é†’å¤šä¸ªç­‰å¾…çš„çº¿ç¨‹ã€‚</p>\n</li>\n<li><p>å­˜åœ¨â€œä¼ªå”¤é†’â€çš„æƒ…å†µï¼Œå³åœ¨æ²¡æœ‰é€šçŸ¥çš„æƒ…å†µä¸‹ï¼Œçº¿ç¨‹ä¹Ÿå¯èƒ½ä¼šè‹é†’è¿‡æ¥ï¼Œè€Œæ­¤æ—¶æ˜¯ä¸åº”è¯¥å”¤é†’çš„ã€‚</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">synchronized</span> (monitor) &#123;</span><br><span class=\"line\">    <span class=\"comment\">//  åˆ¤æ–­æ¡ä»¶è°“è¯æ˜¯å¦å¾—åˆ°æ»¡è¶³</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span>(!locked) &#123;</span><br><span class=\"line\">        <span class=\"comment\">//  ç­‰å¾…å”¤é†’</span></span><br><span class=\"line\">        monitor.wait();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//  å¤„ç†å…¶ä»–çš„ä¸šåŠ¡é€»è¾‘</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n</ol>\n<h4 id=\"ä¸ºä»€ä¹ˆçº¿ç¨‹é€šä¿¡çš„æ–¹æ³•-wait-ï¼Œnotify-å’Œ-notifyAll-è¢«å®šä¹‰åœ¨-Object-ç±»é‡Œï¼Ÿ\"><a href=\"#ä¸ºä»€ä¹ˆçº¿ç¨‹é€šä¿¡çš„æ–¹æ³•-wait-ï¼Œnotify-å’Œ-notifyAll-è¢«å®šä¹‰åœ¨-Object-ç±»é‡Œï¼Ÿ\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆçº¿ç¨‹é€šä¿¡çš„æ–¹æ³• wait()ï¼Œnotify() å’Œ notifyAll() è¢«å®šä¹‰åœ¨ Object ç±»é‡Œï¼Ÿ\"></a>ä¸ºä»€ä¹ˆçº¿ç¨‹é€šä¿¡çš„æ–¹æ³• wait()ï¼Œnotify() å’Œ notifyAll() è¢«å®šä¹‰åœ¨ Object ç±»é‡Œï¼Ÿ</h4><p>Java ä¸­ï¼Œä»»ä½•å¯¹è±¡éƒ½å¯ä»¥ä½œä¸ºé”ï¼Œå¹¶ä¸”çº¿ç¨‹é€šä¿¡çš„æ–¹æ³• wait()ï¼Œnotify() ç­‰æ–¹æ³•ç”¨äºç­‰å¾…å¯¹è±¡çš„é”æˆ–è€…æ˜¯å”¤é†’çº¿ç¨‹ï¼Œé‚£ä¹ˆè¦æ‰¾ä¸€ä¸ªå¯ä¾›ä»»ä½•å¯¹è±¡ä½¿ç”¨çš„é”ï¼Œå› æ­¤å°†è¿™äº›æ–¹æ³•å®šä¹‰åœ¨ Object ä¸­ï¼ŒObject æ˜¯æ‰€æœ‰ç±»çš„çˆ¶ç±»ã€‚</p>\n<h4 id=\"Thread-ç±»ä¸­çš„-yield-æ–¹æ³•æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ\"><a href=\"#Thread-ç±»ä¸­çš„-yield-æ–¹æ³•æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ\" class=\"headerlink\" title=\"Thread ç±»ä¸­çš„ yield æ–¹æ³•æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ\"></a>Thread ç±»ä¸­çš„ yield æ–¹æ³•æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</h4><p>ä½¿å½“å‰çº¿ç¨‹ä»è¿è¡ŒçŠ¶æ€å˜ä¸ºå°±ç»ªçŠ¶æ€ã€‚</p>\n<h4 id=\"çº¿ç¨‹çš„-sleep-æ–¹æ³•å’Œ-yield-æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"><a href=\"#çº¿ç¨‹çš„-sleep-æ–¹æ³•å’Œ-yield-æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"çº¿ç¨‹çš„ sleep()æ–¹æ³•å’Œ yield()æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"></a>çº¿ç¨‹çš„ sleep()æ–¹æ³•å’Œ yield()æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h4><ol>\n<li><p>sleep() æ–¹æ³•ç»™å…¶ä»–çº¿ç¨‹è¿è¡Œæœºä¼šæ—¶ä¸è€ƒè™‘çº¿ç¨‹çš„ä¼˜å…ˆçº§ï¼Œå› æ­¤ä¼šç»™ä½ä¼˜å…ˆçº§çš„çº¿ç¨‹ä»¥è¿è¡Œçš„æœºä¼šï¼›</p>\n<p> yield() æ–¹æ³•åªä¼šç»™<strong>ç›¸åŒæˆ–æ›´é«˜ä¼˜å…ˆçº§</strong>çš„çº¿ç¨‹ä»¥è¿è¡Œçš„æœºä¼šï¼›</p>\n</li>\n<li><p>çº¿ç¨‹æ‰§è¡Œ sleep() æ–¹æ³•åè½¬å…¥ç­‰å¾…ï¼ˆwaitingï¼‰çŠ¶æ€ï¼Œè€Œæ‰§è¡Œ yield() æ–¹æ³•åè½¬å…¥å°±ç»ªï¼ˆreadyï¼‰çŠ¶æ€ï¼›</p>\n</li>\n</ol>\n<h4 id=\"å¦‚ä½•åœæ­¢ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„çº¿ç¨‹ï¼Ÿ\"><a href=\"#å¦‚ä½•åœæ­¢ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„çº¿ç¨‹ï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•åœæ­¢ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„çº¿ç¨‹ï¼Ÿ\"></a>å¦‚ä½•åœæ­¢ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„çº¿ç¨‹ï¼Ÿ</h4><ol>\n<li>å½“ run æ–¹æ³•å®Œæˆåçº¿ç¨‹ç»ˆæ­¢ï¼›</li>\n<li>ä½¿ç”¨ interrupt æ–¹æ³•ä¸­æ–­çº¿ç¨‹ã€‚</li>\n</ol>\n<h4 id=\"notify-å’Œ-notifyAll-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"><a href=\"#notify-å’Œ-notifyAll-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"notify() å’Œ notifyAll() æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"></a>notify() å’Œ notifyAll() æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h4><p>å¦‚æœçº¿ç¨‹è°ƒç”¨äº†å¯¹è±¡çš„ wait() æ–¹æ³•ï¼Œé‚£ä¹ˆçº¿ç¨‹ä¾¿ä¼šå¤„äºè¯¥å¯¹è±¡çš„ç­‰å¾…æ± ä¸­ï¼Œç­‰å¾…æ± ä¸­çš„çº¿ç¨‹ä¸ä¼šå»ç«äº‰è¯¥å¯¹è±¡çš„é”ã€‚</p>\n<p>notifyAll() ä¼šå”¤é†’æ‰€æœ‰çš„çº¿ç¨‹ï¼Œnotify() åªä¼šå”¤é†’ä¸€ä¸ªçº¿ç¨‹ã€‚</p>\n<p>notifyAll() è°ƒç”¨åï¼Œä¼šå°†å…¨éƒ¨çº¿ç¨‹ç”±ç­‰å¾…æ± ç§»åˆ°é”æ± ï¼Œç„¶åå‚ä¸é”çš„ç«äº‰ï¼Œç«äº‰æˆåŠŸåˆ™ç»§ç»­æ‰§è¡Œï¼Œå¦‚æœä¸æˆåŠŸåˆ™ç•™åœ¨é”æ± ç­‰å¾…é”è¢«é‡Šæ”¾åå†æ¬¡å‚ä¸ç«äº‰ã€‚è€Œ notify()åªä¼šå”¤é†’ä¸€ä¸ªçº¿ç¨‹ï¼Œå…·ä½“å”¤é†’å“ªä¸€ä¸ªçº¿ç¨‹ç”±è™šæ‹Ÿæœºæ§åˆ¶ã€‚</p>\n<h4 id=\"å¦‚ä½•åœ¨ä¸¤ä¸ªçº¿ç¨‹é—´å…±äº«æ•°æ®ï¼Ÿ\"><a href=\"#å¦‚ä½•åœ¨ä¸¤ä¸ªçº¿ç¨‹é—´å…±äº«æ•°æ®ï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•åœ¨ä¸¤ä¸ªçº¿ç¨‹é—´å…±äº«æ•°æ®ï¼Ÿ\"></a>å¦‚ä½•åœ¨ä¸¤ä¸ªçº¿ç¨‹é—´å…±äº«æ•°æ®ï¼Ÿ</h4><p>Java çº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ç”± Java å†…å­˜æ¨¡å‹ï¼ˆç®€ç§° JMMï¼‰æ§åˆ¶ï¼š</p>\n<ol>\n<li>æ‰€æœ‰çš„å…±äº«å˜é‡éƒ½å­˜åœ¨ä¸»å†…å­˜ä¸­</li>\n<li>æ¯ä¸ªçº¿ç¨‹éƒ½ä¿å­˜äº†ä¸€ä»½è¯¥çº¿ç¨‹ä½¿ç”¨åˆ°çš„å…±äº«å˜é‡çš„å‰¯æœ¬</li>\n<li>å¦‚æœçº¿ç¨‹ A ä¸çº¿ç¨‹ B ä¹‹é—´è¦é€šä¿¡ï¼š<ol>\n<li>çº¿ç¨‹ A å°†æœ¬åœ°å†…å­˜ A ä¸­æ›´æ–°è¿‡çš„å…±äº«å˜é‡åˆ·æ–°åˆ°ä¸»å†…å­˜ä¸­å»</li>\n<li>çº¿ç¨‹ B åˆ°ä¸»å†…å­˜ä¸­å»è¯»å–çº¿ç¨‹ A ä¹‹å‰å·²ç»æ›´æ–°è¿‡çš„å…±äº«å˜é‡ã€‚</li>\n</ol>\n</li>\n</ol>\n<h4 id=\"Java-å¦‚ä½•å®ç°å¤šçº¿ç¨‹ä¹‹é—´çš„é€šè®¯å’Œåä½œï¼Ÿ\"><a href=\"#Java-å¦‚ä½•å®ç°å¤šçº¿ç¨‹ä¹‹é—´çš„é€šè®¯å’Œåä½œï¼Ÿ\" class=\"headerlink\" title=\"Java å¦‚ä½•å®ç°å¤šçº¿ç¨‹ä¹‹é—´çš„é€šè®¯å’Œåä½œï¼Ÿ\"></a>Java å¦‚ä½•å®ç°å¤šçº¿ç¨‹ä¹‹é—´çš„é€šè®¯å’Œåä½œï¼Ÿ</h4><p>Java ä¸­çº¿ç¨‹é€šä¿¡åä½œçš„æœ€å¸¸è§çš„ä¸¤ç§æ–¹å¼ï¼š</p>\n<ol>\n<li><p>synchronized åŠ é”çš„çº¿ç¨‹ + Object ç±»çš„ wait()&#x2F;notify()&#x2F;notifyAll()</p>\n</li>\n<li><p>ReentrantLock ç±»åŠ é”çš„çº¿ç¨‹ + Condition ç±»çš„ await()&#x2F;signal()&#x2F;signalAll()</p>\n</li>\n</ol>\n<h4 id=\"åŒæ­¥æ–¹æ³•å’ŒåŒæ­¥å—ï¼Œå“ªä¸ªæ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Ÿ\"><a href=\"#åŒæ­¥æ–¹æ³•å’ŒåŒæ­¥å—ï¼Œå“ªä¸ªæ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Ÿ\" class=\"headerlink\" title=\"åŒæ­¥æ–¹æ³•å’ŒåŒæ­¥å—ï¼Œå“ªä¸ªæ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Ÿ\"></a>åŒæ­¥æ–¹æ³•å’ŒåŒæ­¥å—ï¼Œå“ªä¸ªæ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Ÿ</h4><p>åŒæ­¥çš„èŒƒå›´è¶Šå°è¶Šå¥½ã€‚</p>\n<p>å› æ­¤ï¼ŒåŒæ­¥å—æ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Œå› ä¸ºå®ƒä¸ä¼šé”ä½æ•´ä¸ªå¯¹è±¡ï¼Œè€ŒåŒæ­¥æ–¹æ³•ä¼šé”ä½æ•´ä¸ªå¯¹è±¡ã€‚</p>\n<h4 id=\"ä»€ä¹ˆæ˜¯çº¿ç¨‹åŒæ­¥å’Œçº¿ç¨‹äº’æ–¥ï¼Œæœ‰å“ªå‡ ç§å®ç°æ–¹å¼ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯çº¿ç¨‹åŒæ­¥å’Œçº¿ç¨‹äº’æ–¥ï¼Œæœ‰å“ªå‡ ç§å®ç°æ–¹å¼ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯çº¿ç¨‹åŒæ­¥å’Œçº¿ç¨‹äº’æ–¥ï¼Œæœ‰å“ªå‡ ç§å®ç°æ–¹å¼ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯çº¿ç¨‹åŒæ­¥å’Œçº¿ç¨‹äº’æ–¥ï¼Œæœ‰å“ªå‡ ç§å®ç°æ–¹å¼ï¼Ÿ</h4><p>çº¿ç¨‹åŒæ­¥æ˜¯ä¸¤ä¸ªæˆ–å¤šä¸ªå…±äº«å…³é”®èµ„æºçš„çº¿ç¨‹çš„å¹¶å‘æ‰§è¡Œã€‚åº”è¯¥åŒæ­¥çº¿ç¨‹ä»¥é¿å…å…³é”®çš„èµ„æºä½¿ç”¨å†²çªã€‚</p>\n<p>çº¿ç¨‹äº’æ–¥æ˜¯å¯¹æŸä¸€å…±äº«èµ„æºè€Œè¨€ï¼Œä»»ä½•æ—¶åˆ»æœ€å¤šåªå…è®¸ä¸€ä¸ªçº¿ç¨‹å»ä½¿ç”¨ï¼Œå…¶å®ƒè¦ä½¿ç”¨è¯¥èµ„æºçš„çº¿ç¨‹å¿…é¡»ç­‰å¾…ï¼Œç›´åˆ°å ç”¨èµ„æºè€…é‡Šæ”¾è¯¥èµ„æºã€‚</p>\n<p>å®ç°çº¿ç¨‹åŒæ­¥çš„æ–¹æ³•ï¼š</p>\n<ul>\n<li>åŒæ­¥ä»£ç æ–¹æ³• &#x2F; æ–¹æ³•å—ï¼šsychronized å…³é”®å­—ä¿®é¥°çš„æ–¹æ³• &#x2F; ä»£ç å—</li>\n<li>ä½¿ç”¨ç‰¹æ®Šå˜é‡åŸŸ volatile å®ç°çº¿ç¨‹åŒæ­¥ï¼švolatile å…³é”®å­—ä¸ºåŸŸå˜é‡çš„è®¿é—®æä¾›äº†ä¸€ç§å…é”æœºåˆ¶</li>\n<li>ä½¿ç”¨é‡å…¥é”å®ç°çº¿ç¨‹åŒæ­¥ï¼šreentrantlock ç±»æ˜¯å¯é‡å…¥ã€äº’æ–¥ã€å®ç°äº† lock æ¥å£çš„é”ï¼Œä¸ sychronized æ–¹æ³•å…·æœ‰ç›¸åŒçš„åŸºæœ¬è¡Œä¸ºå’Œè¯­ä¹‰</li>\n</ul>\n<h4 id=\"åœ¨ç›‘è§†å™¨-Monitor-å†…éƒ¨ï¼Œæ˜¯å¦‚ä½•åšçº¿ç¨‹åŒæ­¥çš„ï¼Ÿ\"><a href=\"#åœ¨ç›‘è§†å™¨-Monitor-å†…éƒ¨ï¼Œæ˜¯å¦‚ä½•åšçº¿ç¨‹åŒæ­¥çš„ï¼Ÿ\" class=\"headerlink\" title=\"åœ¨ç›‘è§†å™¨(Monitor)å†…éƒ¨ï¼Œæ˜¯å¦‚ä½•åšçº¿ç¨‹åŒæ­¥çš„ï¼Ÿ\"></a>åœ¨ç›‘è§†å™¨(Monitor)å†…éƒ¨ï¼Œæ˜¯å¦‚ä½•åšçº¿ç¨‹åŒæ­¥çš„ï¼Ÿ</h4><p>åœ¨ Java è™šæ‹Ÿæœºä¸­ï¼Œæ¯ä¸ªå¯¹è±¡å…³è”ä¸€ä¸ª<strong>ç›‘è§†å™¨</strong>ï¼Œä¸ºäº†å®ç°ç›‘è§†å™¨çš„äº’æ–¥åŠŸèƒ½ï¼Œ<strong>æ¯ä¸ªå¯¹è±¡éƒ½å…³è”ç€ä¸€æŠŠé”</strong>ã€‚</p>\n<p>ä¸€æ—¦æ–¹æ³•æˆ–è€…ä»£ç å—è¢« <strong>synchronized</strong> ä¿®é¥°ï¼Œé‚£ä¹ˆè¿™ä¸ªéƒ¨åˆ†å°±æ”¾å…¥äº†ç›‘è§†å™¨çš„ç›‘è§†åŒºåŸŸï¼Œ<strong>ç¡®ä¿ä¸€æ¬¡åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œè¯¥éƒ¨åˆ†çš„ä»£ç </strong>ï¼Œçº¿ç¨‹åœ¨è·å–é”ä¹‹å‰ä¸å…è®¸æ‰§è¡Œè¯¥éƒ¨åˆ†çš„ä»£ç </p>\n<p>å¦å¤– Java è¿˜æä¾›äº†æ˜¾å¼ç›‘è§†å™¨ (Lock) å’Œéšå¼ç›‘è§†å™¨ (synchronized) ä¸¤ç§é”æ–¹æ¡ˆ</p>\n<h4 id=\"Java-çº¿ç¨‹æ•°è¿‡å¤šä¼šé€ æˆä»€ä¹ˆé—®é¢˜ï¼Ÿ\"><a href=\"#Java-çº¿ç¨‹æ•°è¿‡å¤šä¼šé€ æˆä»€ä¹ˆé—®é¢˜ï¼Ÿ\" class=\"headerlink\" title=\"Java çº¿ç¨‹æ•°è¿‡å¤šä¼šé€ æˆä»€ä¹ˆé—®é¢˜ï¼Ÿ\"></a>Java çº¿ç¨‹æ•°è¿‡å¤šä¼šé€ æˆä»€ä¹ˆé—®é¢˜ï¼Ÿ</h4><ul>\n<li><p>æ¶ˆè€—è¿‡å¤šçš„ CPU èµ„æº</p>\n<p>  å¦‚æœå¯è¿è¡Œçš„çº¿ç¨‹æ•°é‡å¤šäºå¯ç”¨å¤„ç†å™¨çš„æ•°é‡ï¼Œé‚£ä¹ˆæœ‰çº¿ç¨‹å°†ä¼šè¢«é—²ç½®ã€‚å¤§é‡ç©ºé—²çš„çº¿ç¨‹ä¼šå ç”¨è®¸å¤šå†…å­˜ï¼Œç»™åƒåœ¾å›æ”¶å™¨å¸¦æ¥å‹åŠ›ã€‚</p>\n</li>\n<li><p>é™ä½ JVM ç¨³å®šæ€§</p>\n<p>  åœ¨å¯åˆ›å»ºçº¿ç¨‹çš„æ•°é‡ä¸Šå­˜åœ¨ä¸€ä¸ªé™åˆ¶ï¼Œè¿™ä¸ªé™åˆ¶å€¼å°†éšç€å¹³å°çš„ä¸åŒè€Œä¸åŒï¼Œå¹¶ä¸”æ‰¿å—ç€å¤šä¸ªå› ç´ åˆ¶çº¦ï¼ŒåŒ…æ‹¬ JVM çš„å¯åŠ¨å‚æ•°ã€Thread æ„é€ å‡½æ•°ä¸­è¯·æ±‚æ ˆçš„å¤§å°ï¼Œä»¥åŠåº•å±‚æ“ä½œç³»ç»Ÿå¯¹çº¿ç¨‹çš„é™åˆ¶ç­‰ã€‚å¦‚æœç ´åäº†è¿™äº›é™åˆ¶ï¼Œé‚£ä¹ˆå¯èƒ½æŠ›å‡º OutOfMemoryError å¼‚å¸¸ã€‚</p>\n</li>\n</ul>\n<h2 id=\"å¹¶å‘å…³é”®å­—\"><a href=\"#å¹¶å‘å…³é”®å­—\" class=\"headerlink\" title=\"å¹¶å‘å…³é”®å­—\"></a>å¹¶å‘å…³é”®å­—</h2><h3 id=\"synchronized\"><a href=\"#synchronized\" class=\"headerlink\" title=\"synchronized\"></a>synchronized</h3><h4 id=\"synchronized-çš„ä½œç”¨ï¼Ÿ\"><a href=\"#synchronized-çš„ä½œç”¨ï¼Ÿ\" class=\"headerlink\" title=\"synchronized çš„ä½œç”¨ï¼Ÿ\"></a>synchronized çš„ä½œç”¨ï¼Ÿ</h4><p>åœ¨ Java ä¸­ï¼Œsynchronized å…³é”®å­—æ˜¯ç”¨æ¥æ§åˆ¶çº¿ç¨‹åŒæ­¥çš„ï¼Œå°±æ˜¯åœ¨å¤šçº¿ç¨‹çš„ç¯å¢ƒä¸‹ï¼Œæ§åˆ¶ synchronized ä»£ç æ®µä¸è¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶æ‰§è¡Œã€‚synchronized å¯ä»¥ä¿®é¥°é™æ€æ–¹æ³•ã€å®ä¾‹æ–¹æ³•ã€ä»£ç å—ã€‚</p>\n<h4 id=\"æ€ä¹ˆä½¿ç”¨-synchronized-å…³é”®å­—\"><a href=\"#æ€ä¹ˆä½¿ç”¨-synchronized-å…³é”®å­—\" class=\"headerlink\" title=\"æ€ä¹ˆä½¿ç”¨ synchronized å…³é”®å­—\"></a>æ€ä¹ˆä½¿ç”¨ synchronized å…³é”®å­—</h4><p><strong>synchronizedå…³é”®å­—æœ€ä¸»è¦çš„ä¸‰ç§ä½¿ç”¨æ–¹å¼ï¼š</strong></p>\n<ul>\n<li><strong>ä¿®é¥°å®ä¾‹æ–¹æ³•ï¼š</strong> ç»™å½“å‰å¯¹è±¡å®ä¾‹åŠ é”ï¼›</li>\n<li><strong>ä¿®é¥°é™æ€æ–¹æ³•ï¼š</strong> ç»™å½“å‰ç±»åŠ é”ï¼›</li>\n<li><strong>ä¿®é¥°ä»£ç å—ï¼š</strong>ç»™æŒ‡å®šå¯¹è±¡åŠ é”ï¼Œè¿›å…¥åŒæ­¥ä»£ç å—å‰è¦è·å¾—æŒ‡å®šå¯¹è±¡çš„é”ã€‚</li>\n</ul>\n<p><strong>æ€»ç»“ï¼š</strong> synchronized å…³é”®å­—åŠ åˆ° static é™æ€æ–¹æ³•å’Œ synchronized(xxx.class) ä»£ç å—ä¸Šéƒ½æ˜¯æ˜¯ç»™ Class ç±»ä¸Šé”ã€‚synchronized å…³é”®å­—åŠ åˆ°å®ä¾‹æ–¹æ³•ä¸Šæ˜¯ç»™å¯¹è±¡å®ä¾‹ä¸Šé”ã€‚</p>\n<h4 id=\"åŒé‡æ ¡éªŒé”å®ç°å¯¹è±¡å•ä¾‹ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰\"><a href=\"#åŒé‡æ ¡éªŒé”å®ç°å¯¹è±¡å•ä¾‹ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰\" class=\"headerlink\" title=\"åŒé‡æ ¡éªŒé”å®ç°å¯¹è±¡å•ä¾‹ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰\"></a>åŒé‡æ ¡éªŒé”å®ç°å¯¹è±¡å•ä¾‹ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Singleton</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">static</span> Singleton uniqueInstance;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"title function_\">Singleton</span><span class=\"params\">()</span> &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Singleton <span class=\"title function_\">getInstance</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// ç¬¬ä¸€æ¬¡å‡å¦‚çº¿ç¨‹1ï¼Œçº¿ç¨‹2ï¼Œçº¿ç¨‹3åˆ°è¾¾è¿™ï¼Œéƒ½åˆ¤æ–­åˆ°nullæœªå®ä¾‹åŒ–ï¼ŒåŠ è¿™ä¸ªåˆ¤æ–­æ˜¯ä¸ºäº†è®©é™¤äº†ç¬¬ä¸€æ¬¡å®ä¾‹åŒ–ä¹‹åçš„å…¶ä»–çº¿ç¨‹åˆ¤æ–­åˆ°éç©ºè¡¨æ˜å·²ç»å®ä¾‹åŒ–è¿‡äº†ï¼Œç›´æ¥è¿”å›å•ä¾‹</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (uniqueInstance == <span class=\"literal\">null</span>) &#123;\t<span class=\"comment\">// çº¿ç¨‹1ã€2ã€3æœ‰å¯èƒ½éƒ½è¿›æ¥äº†</span></span><br><span class=\"line\">            <span class=\"comment\">//ç±»å¯¹è±¡åŠ é”</span></span><br><span class=\"line\">            <span class=\"keyword\">synchronized</span> (Singleton.class) &#123;\t<span class=\"comment\">// å¦‚æœå¤šä¸ªçº¿ç¨‹éƒ½åˆ¤æ–­åˆ°æœªå®ä¾‹åŒ–ï¼Œé‚£ä¹ˆåªä¼šæœ‰ä¸€ä¸ªçº¿ç¨‹é”ä½ç±»å¹¶è¿›è¡Œå®ä¾‹åŒ–</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (uniqueInstance == <span class=\"literal\">null</span>) &#123;\t<span class=\"comment\">// å¦‚æœä¸åŠ è¿™ä¸ªåˆ¤æ–­ï¼Œçº¿ç¨‹1æ‹¿åˆ°é”è¿›è¡Œå®ä¾‹åŒ–ä¹‹åï¼Œçº¿ç¨‹2æ‹¿åˆ°é”ï¼Œè¿›æ¥ç›´æ¥è¿›è¡Œå®ä¾‹åŒ–ï¼Œè¿™å°±äº§ç”Ÿå¤šæ¬¡å®ä¾‹åŒ–æ“ä½œã€‚å¦‚æœåŠ è¿™ä¸ªåˆ¤æ–­ï¼Œçº¿ç¨‹2æ‹¿åˆ°é”ä¹‹åï¼Œåˆ¤æ–­åˆ°å·²ç»å®ä¾‹åŒ–äº†ï¼Œå°±ä¸ä¼šå†è¿›è¡Œå®ä¾‹åŒ–äº†ã€‚</span></span><br><span class=\"line\">                    uniqueInstance = <span class=\"keyword\">new</span> <span class=\"title class_\">Singleton</span>();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> uniqueInstance;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>å¦å¤–ï¼Œéœ€è¦æ³¨æ„ instance é‡‡ç”¨ volatile å…³é”®å­—ä¿®é¥°ä¹Ÿæ˜¯å¾ˆæœ‰å¿…è¦ã€‚</p>\n<p>instance é‡‡ç”¨ volatile å…³é”®å­—ä¿®é¥°ä¹Ÿæ˜¯å¾ˆæœ‰å¿…è¦çš„ï¼Œinstance &#x3D; new Singleton() è¿™æ®µä»£ç å…¶å®æ˜¯åˆ†ä¸ºä¸‰æ­¥æ‰§è¡Œï¼š</p>\n<ol>\n<li>ä¸º instance åˆ†é…å†…å­˜ç©ºé—´</li>\n<li>åˆå§‹åŒ– instance</li>\n<li>å°† instance æŒ‡å‘åˆ†é…çš„å†…å­˜åœ°å€</li>\n</ol>\n<p>ä½†æ˜¯ç”±äº JVM å…·æœ‰æŒ‡ä»¤é‡æ’çš„ç‰¹æ€§ï¼Œæ‰§è¡Œé¡ºåºæœ‰å¯èƒ½å˜æˆ 1-&gt;3-&gt;2ã€‚æŒ‡ä»¤é‡æ’åœ¨å•çº¿ç¨‹ç¯å¢ƒä¸‹ä¸ä¼šå‡ºç°é—®é¢˜ï¼Œä½†æ˜¯åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä¼šå¯¼è‡´ä¸€ä¸ªçº¿ç¨‹è·å¾—è¿˜æ²¡æœ‰åˆå§‹åŒ–çš„å®ä¾‹ã€‚ä¾‹å¦‚ï¼Œçº¿ç¨‹ T1 æ‰§è¡Œäº† 1 å’Œ 3ï¼Œæ­¤æ—¶ T2 è°ƒç”¨ getInstance() åå‘ç° instance ä¸ä¸ºç©ºï¼Œå› æ­¤<strong>è¿”å› T1 å®ä¾‹åŒ–ä½†æœªåˆå§‹åŒ–</strong>çš„ instanceã€‚</p>\n<h4 id=\"synchronized-åº•å±‚å®ç°åŸç†ï¼Ÿï¼ˆç›‘è§†å™¨monitorï¼‰\"><a href=\"#synchronized-åº•å±‚å®ç°åŸç†ï¼Ÿï¼ˆç›‘è§†å™¨monitorï¼‰\" class=\"headerlink\" title=\"synchronized åº•å±‚å®ç°åŸç†ï¼Ÿï¼ˆç›‘è§†å™¨monitorï¼‰\"></a>synchronized åº•å±‚å®ç°åŸç†ï¼Ÿï¼ˆç›‘è§†å™¨monitorï¼‰</h4><p>synchronized æ˜¯ Java ä¸­çš„ä¸€ä¸ªå…³é”®å­—ï¼Œé€šè¿‡ javap å‘½ä»¤ï¼ŒæŸ¥çœ‹ç›¸åº”çš„å­—èŠ‚ç æ–‡ä»¶ã€‚</p>\n<p>synchronized åŒæ­¥è¯­å¥å—çš„æƒ…å†µ</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">SynchronizedDemo</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span> (<span class=\"built_in\">this</span>) &#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;synchronized ä»£ç å—&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>é€šè¿‡ JDK åæ±‡ç¼–æŒ‡ä»¤ javap -c -v SynchronizedDemo</p>\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/image-20220912212554623.png\" alt=\"monitorenter&monitorexit\" style=\"zoom:50%;\" />\n\n<p>å¯ä»¥çœ‹å‡ºåœ¨æ‰§è¡ŒåŒæ­¥ä»£ç å—ä¹‹å‰ä¹‹åéƒ½æœ‰ä¸€ä¸ª monitor å­—æ ·ï¼Œå…¶ä¸­å‰é¢çš„æ˜¯ monitorenterï¼Œåé¢çš„æ˜¯ç¦»å¼€ monitorexitï¼Œä¸éš¾æƒ³è±¡ä¸€ä¸ªçº¿ç¨‹æ‰§è¡ŒåŒæ­¥ä»£ç å—ï¼Œé¦–å…ˆè¦è·å–é”ï¼Œè€Œè·å–é”çš„è¿‡ç¨‹å°±æ˜¯ monitorenter ï¼Œåœ¨æ‰§è¡Œå®Œä»£ç å—ä¹‹åï¼Œè¦é‡Šæ”¾é”ï¼Œé‡Šæ”¾é”å°±æ˜¯æ‰§è¡Œ monitorexit æŒ‡ä»¤ã€‚</p>\n<p>ä¸ºä»€ä¹ˆä¼šæœ‰ä¸¤ä¸ª monitorexit å‘¢ï¼Ÿï¼ˆline 19ï¼‰</p>\n<p>è¿™ä¸ªä¸»è¦æ˜¯é˜²æ­¢åœ¨åŒæ­¥ä»£ç å—ä¸­çº¿ç¨‹å› å¼‚å¸¸é€€å‡ºï¼Œè€Œé”æ²¡æœ‰å¾—åˆ°é‡Šæ”¾ï¼Œè¿™å¿…ç„¶ä¼šé€ æˆæ­»é”ï¼ˆç­‰å¾…çš„çº¿ç¨‹æ°¸è¿œè·å–ä¸åˆ°é”ï¼‰ã€‚<strong>å› æ­¤æœ€åä¸€ä¸ªmonitorexitæ˜¯ä¿è¯åœ¨å¼‚å¸¸æƒ…å†µä¸‹ï¼Œé”ä¹Ÿå¯ä»¥å¾—åˆ°é‡Šæ”¾ï¼Œé¿å…æ­»é”ã€‚</strong></p>\n<h4 id=\"synchronized-å¯é‡å…¥çš„åŸç†\"><a href=\"#synchronized-å¯é‡å…¥çš„åŸç†\" class=\"headerlink\" title=\"synchronized å¯é‡å…¥çš„åŸç†\"></a>synchronized å¯é‡å…¥çš„åŸç†</h4><p>é‡å…¥é”æ˜¯æŒ‡ä¸€ä¸ªçº¿ç¨‹è·å–åˆ°è¯¥é”ä¹‹åï¼Œè¯¥çº¿ç¨‹å¯ä»¥ç»§ç»­è·å¾—è¯¥é”ã€‚<br>åº•å±‚åŸç†ç»´æŠ¤ä¸€ä¸ª<strong>è®¡æ•°å™¨</strong>ï¼Œå½“çº¿ç¨‹è·å–è¯¥é”æ—¶ï¼Œè®¡æ•°å™¨åŠ ä¸€ï¼Œå†æ¬¡è·å¾—è¯¥é”æ—¶ç»§ç»­åŠ ä¸€ï¼Œé‡Šæ”¾é”æ—¶ï¼Œè®¡æ•°å™¨å‡ä¸€ï¼Œå½“è®¡æ•°å™¨å€¼ä¸º 0 æ—¶ï¼Œè¡¨æ˜è¯¥é”æœªè¢«ä»»ä½•çº¿ç¨‹æ‰€æŒæœ‰ï¼Œå…¶å®ƒçº¿ç¨‹å¯ä»¥ç«äº‰è·å–é”ã€‚</p>\n<h4 id=\"ä»€ä¹ˆæ˜¯è‡ªæ—‹\"><a href=\"#ä»€ä¹ˆæ˜¯è‡ªæ—‹\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯è‡ªæ—‹\"></a>ä»€ä¹ˆæ˜¯è‡ªæ—‹</h4><blockquote>\n<p>ä¸è¦é‡åˆ° synchronized å°±è®©ç­‰å¾…é”çš„çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œè€Œæ˜¯è®©è¿™ä¸ªçº¿ç¨‹åœ¨ synchronized è¾¹ç•Œåšå¿™å¾ªç¯</p>\n</blockquote>\n<p>å¾ˆå¤š synchronized é‡Œé¢çš„ä»£ç åªæ˜¯ä¸€äº›å¾ˆç®€å•çš„ä»£ç ï¼Œæ‰§è¡Œæ—¶é—´éå¸¸å¿«ï¼Œæ—¢ç„¶ synchronized é‡Œé¢çš„ä»£ç æ‰§è¡Œå¾—éå¸¸å¿«ï¼Œä¸å¦¨è®©ç­‰å¾…é”çš„çº¿ç¨‹ä¸è¦è¢«é˜»å¡ï¼Œå› ä¸º<strong>çº¿ç¨‹é˜»å¡æ¶‰åŠåˆ°ç”¨æˆ·æ€å’Œå†…æ ¸æ€åˆ‡æ¢çš„é—®é¢˜å¼€é”€å¾ˆå¤§</strong>ï¼Œè€Œæ˜¯<strong>åœ¨ synchronized çš„è¾¹ç•Œåšå¿™å¾ªç¯</strong>ï¼Œè¿™å°±æ˜¯è‡ªæ—‹ã€‚å¦‚æœåšäº†å¤šæ¬¡å¾ªç¯å‘ç°è¿˜æ²¡æœ‰è·å¾—é”ï¼Œå†é˜»å¡ï¼Œè¿™æ ·å¯èƒ½æ˜¯ä¸€ç§æ›´å¥½çš„ç­–ç•¥ã€‚</p>\n<h4 id=\"å¤šçº¿ç¨‹ä¸­-synchronized-é”å‡çº§çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#å¤šçº¿ç¨‹ä¸­-synchronized-é”å‡çº§çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"å¤šçº¿ç¨‹ä¸­ synchronized é”å‡çº§çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>å¤šçº¿ç¨‹ä¸­ synchronized é”å‡çº§çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</h4><blockquote>\n<p>ç›®çš„ï¼šé”å‡çº§æ˜¯ä¸ºäº†å‡ä½äº†é”å¸¦æ¥çš„æ€§èƒ½æ¶ˆè€—ã€‚</p>\n</blockquote>\n<p>Java çš„é”éƒ½æ˜¯åŸºäºå¯¹è±¡çš„ï¼ŒJava å¯¹è±¡æœ‰å¯¹è±¡å¤´ï¼Œå†…å®¹åŒ…æ‹¬ï¼š</p>\n<ol>\n<li>Mark Wordï¼Œå­˜å‚¨å¯¹è±¡çš„ hashCodeã€é”ä¿¡æ¯ç­‰ï¼›</li>\n<li>Class Metadata Addressï¼Œå­˜å‚¨åˆ°å¯¹è±¡ç±»å‹æ•°æ®çš„æŒ‡é’ˆï¼›</li>\n<li>æ•°ç»„çš„é•¿åº¦ï¼ˆå¦‚æœæ˜¯æ•°ç»„ï¼‰</li>\n</ol>\n<p>æ¯ä¸€ä¸ªçº¿ç¨‹åœ¨å‡†å¤‡è·å–å…±äº«èµ„æºæ—¶ï¼š </p>\n<p>ç¬¬ä¸€æ­¥ï¼Œæ£€æŸ¥é”çš„ MarkWord é‡Œé¢æ˜¯ä¸æ˜¯æ”¾çš„è‡ªå·±çš„ ThreadIdï¼Œå¦‚æœæ˜¯ï¼Œè¡¨ç¤ºå½“å‰çº¿ç¨‹æ˜¯å¤„äº â€œ<strong>åå‘é”</strong>â€ ï¼›</p>\n<p>ç¬¬äºŒæ­¥ï¼Œå¦‚æœé”çš„ MarkWord å­˜æ”¾çš„ä¸æ˜¯è‡ªå·±çš„ ThreadIdï¼Œè¿™ä¸ªæ—¶å€™ä¼šå°è¯•ä½¿ç”¨ CAS æ¥æ›¿æ¢ Mark Word é‡Œé¢çš„çº¿ç¨‹ ID ä¸ºæ–°çº¿ç¨‹çš„ IDï¼Œè¿™ä¸ªæ—¶å€™è¦åˆ†ä¸¤ç§æƒ…å†µï¼š</p>\n<ul>\n<li>CAS æ›¿æ¢æˆåŠŸï¼Œè¡¨ç¤ºä¹‹å‰çš„çº¿ç¨‹ä¸å­˜åœ¨äº†ï¼Œ Mark Word é‡Œé¢çš„çº¿ç¨‹ ID ä¸ºæ–°çº¿ç¨‹çš„ IDï¼Œé”ä¸ä¼šå‡çº§ï¼Œä»ç„¶ä¸ºåå‘é”ï¼›</li>\n<li>CAS æ›¿æ¢å¤±è´¥ï¼Œè¡¨ç¤ºä¹‹å‰çš„çº¿ç¨‹ä»ç„¶å­˜åœ¨ï¼Œæ ¹æ®é”çš„ MarkWord é‡Œé¢çš„ ThreadIdï¼Œé€šçŸ¥è¯¥ ThreadId çš„çº¿ç¨‹æš‚åœï¼Œä¹‹å‰çº¿ç¨‹å°† Markword çš„å†…å®¹ç½®ä¸ºç©ºï¼Œå‡çº§ä¸ºè½»é‡çº§é”ï¼Œä¼šæŒ‰ç…§è½»é‡çº§é”çš„æ–¹å¼è¿›è¡Œç«äº‰é”ã€‚</li>\n</ul>\n<p>ç¬¬ä¸‰æ­¥ï¼Œä¸¤ä¸ªçº¿ç¨‹éƒ½æŠŠé”å¯¹è±¡çš„ hashCode å¤åˆ¶åˆ°è‡ªå·±æ–°å»ºçš„ç”¨äºå­˜å‚¨é”çš„è®°å½•ç©ºé—´ï¼Œæ¥ç€å¼€å§‹é€šè¿‡ CAS æ“ä½œï¼Œ æŠŠé”å¯¹è±¡çš„ MarkWord çš„å†…å®¹ä¿®æ”¹ä¸ºè‡ªå·±æ–°å»ºçš„è®°å½•ç©ºé—´çš„åœ°å€çš„æ–¹å¼ç«äº‰ MarkWordï¼›</p>\n<p>ç¬¬å››æ­¥ï¼Œç¬¬ä¸‰æ­¥ä¸­æˆåŠŸæ‰§è¡Œ CAS çš„è·å¾—èµ„æºï¼Œå¤±è´¥çš„åˆ™è¿›å…¥è‡ªæ—‹ ï¼›</p>\n<p>ç¬¬äº”æ­¥ï¼Œè‡ªæ—‹çš„çº¿ç¨‹åœ¨è‡ªæ—‹è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæˆåŠŸè·å¾—èµ„æºï¼ˆå³ä¹‹å‰è·çš„èµ„æºçš„çº¿ç¨‹æ‰§è¡Œå®Œæˆå¹¶é‡Šæ”¾äº†å…±äº«èµ„æºï¼‰ï¼Œåˆ™æ•´ä¸ªçŠ¶æ€ä¾ç„¶å¤„äº <strong>è½»é‡çº§é”</strong>çš„çŠ¶æ€ï¼›å¦‚æœè‡ªæ—‹å¤±è´¥ ï¼ˆè¿™è¾¹çš„è‡ªæ—‹æ–¹å¼å¯ä»¥é‡‡ç”¨é€‚åº”æ€§è‡ªæ—‹ï¼Œç®€å•æ¥è¯´å°±æ˜¯çº¿ç¨‹å¦‚æœè‡ªæ—‹æˆåŠŸäº†ï¼Œåˆ™ä¸‹æ¬¡è‡ªæ—‹çš„æ¬¡æ•°ä¼šæ›´å¤šï¼Œå¦‚æœè‡ªæ—‹å¤±è´¥äº†ï¼Œåˆ™è‡ªæ—‹çš„æ¬¡æ•°å°±ä¼šå‡å°‘ï¼‰ï¼›</p>\n<p>ç¬¬å…­æ­¥ï¼Œè¿›å…¥<strong>é‡é‡çº§é”</strong>çš„çŠ¶æ€ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œè‡ªæ—‹çš„çº¿ç¨‹è¿›å…¥é˜»å¡ï¼Œç­‰å¾…ç«äº‰çº¿ç¨‹æ‰§è¡Œå®Œæˆå¹¶å”¤é†’è‡ªå·±ã€‚</p>\n<h4 id=\"çº¿ç¨‹-B-æ€ä¹ˆçŸ¥é“çº¿ç¨‹-A-ä¿®æ”¹äº†å˜é‡\"><a href=\"#çº¿ç¨‹-B-æ€ä¹ˆçŸ¥é“çº¿ç¨‹-A-ä¿®æ”¹äº†å˜é‡\" class=\"headerlink\" title=\"çº¿ç¨‹ B æ€ä¹ˆçŸ¥é“çº¿ç¨‹ A ä¿®æ”¹äº†å˜é‡\"></a>çº¿ç¨‹ B æ€ä¹ˆçŸ¥é“çº¿ç¨‹ A ä¿®æ”¹äº†å˜é‡</h4><ul>\n<li><p>volatile ä¿®é¥°å˜é‡</p>\n</li>\n<li><p>synchronized ä¿®é¥°ä¿®æ”¹å˜é‡çš„æ–¹æ³•</p>\n</li>\n<li><p>lock å¯¹ä¿®æ”¹å˜é‡çš„ä»£ç å—åŠ é”</p>\n</li>\n</ul>\n<h4 id=\"synchronized-å’Œ-Lock-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"><a href=\"#synchronized-å’Œ-Lock-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"synchronized å’Œ Lock æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"></a>synchronized å’Œ Lock æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h4><ul>\n<li>synchronized æ˜¯ Java å…³é”®å­—ï¼Œè€Œ Lock æ˜¯ä¸ªæ¥å£ï¼›</li>\n<li>synchronized å¯ä»¥ç»™é™æ€æ–¹æ³•ã€å®ä¾‹æ–¹æ³•ã€ä»£ç å—åŠ é”ï¼Œè€Œ lock åªèƒ½ç»™ä»£ç å—åŠ é”ï¼›</li>\n<li>synchronized ä¸éœ€è¦æ‰‹åŠ¨è·å–é”å’Œé‡Šæ”¾é”ï¼Œè€Œ lock éœ€è¦è‡ªå·±åŠ é”å’Œé‡Šæ”¾é”ï¼›</li>\n<li>é€šè¿‡ Lock å¯ä»¥çŸ¥é“æœ‰æ²¡æœ‰æˆåŠŸè·å–é”ï¼Œè€Œ synchronized å´æ— æ³•åŠåˆ°ã€‚</li>\n</ul>\n<h4 id=\"synchronized-å’Œ-ReentrantLock-åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#synchronized-å’Œ-ReentrantLock-åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"synchronized å’Œ ReentrantLock åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>synchronized å’Œ ReentrantLock åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h4><p><strong>ç›¸åŒç‚¹ï¼š</strong></p>\n<p>ä¸¤è€…éƒ½æ˜¯å¯é‡å…¥é”</p>\n<p>â€œå¯é‡å…¥é”â€æ¦‚å¿µæ˜¯ï¼šè‡ªå·±å¯ä»¥å†æ¬¡è·å–è‡ªå·±çš„å†…éƒ¨é”ã€‚æ¯”å¦‚ä¸€ä¸ªçº¿ç¨‹è·å¾—äº†æŸä¸ªå¯¹è±¡çš„é”ï¼Œæ­¤æ—¶è¿™ä¸ªå¯¹è±¡é”è¿˜æ²¡æœ‰é‡Šæ”¾ï¼Œå½“å…¶å†æ¬¡æƒ³è¦è·å–è¿™ä¸ªå¯¹è±¡çš„é”çš„æ—¶å€™è¿˜æ˜¯å¯ä»¥è·å–çš„ï¼Œ<strong>å¦‚æœä¸å¯é”é‡å…¥çš„è¯ï¼Œå°±ä¼šé€ æˆæ­»é”</strong>ã€‚åŒä¸€ä¸ªçº¿ç¨‹æ¯æ¬¡è·å–é”ï¼Œé”çš„è®¡æ•°å™¨éƒ½è‡ªå¢ 1ï¼Œæ‰€ä»¥è¦ç­‰åˆ°é”çš„è®¡æ•°å™¨ä¸‹é™ä¸º 0 æ—¶æ‰èƒ½é‡Šæ”¾é”ã€‚</p>\n<p><strong>ä¸åŒç‚¹ï¼š</strong></p>\n<ul>\n<li>synchronized æ˜¯å…³é”®å­—ï¼ŒReentrantLock æ˜¯ç±»ï¼›</li>\n<li>ReentrantLock åªé€‚ç”¨äºä»£ç å—é”ï¼Œè€Œ synchronized å¯ä»¥ä¿®é¥°ç±»ã€æ–¹æ³•ã€å˜é‡ç­‰ï¼›</li>\n</ul>\n<ul>\n<li>ReentrantLock å¿…é¡»æ‰‹åŠ¨è·å–ä¸é‡Šæ”¾é”ï¼Œè€Œ synchronized ä¸éœ€è¦æ‰‹åŠ¨é‡Šæ”¾å’Œå¼€å¯é”ï¼›</li>\n<li>äºŒè€…çš„é”æœºåˆ¶å…¶å®ä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ï¼š<br>  ReentrantLock åº•å±‚è°ƒç”¨çš„æ˜¯ Unsafe çš„ park æ–¹æ³•åŠ é”ï¼Œsynchronized æ“ä½œçš„åº”è¯¥æ˜¯å¯¹è±¡å¤´ä¸­ mark word</li>\n</ul>\n<h3 id=\"volatile\"><a href=\"#volatile\" class=\"headerlink\" title=\"volatile\"></a>volatile</h3><h4 id=\"ä¸ºä»€ä¹ˆä»£ç ä¼šé‡æ’åºï¼Ÿ\"><a href=\"#ä¸ºä»€ä¹ˆä»£ç ä¼šé‡æ’åºï¼Ÿ\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆä»£ç ä¼šé‡æ’åºï¼Ÿ\"></a>ä¸ºä»€ä¹ˆä»£ç ä¼šé‡æ’åºï¼Ÿ</h4><p>åœ¨æ‰§è¡Œç¨‹åºæ—¶ï¼Œä¸ºäº†<strong>æé«˜æ€§èƒ½</strong>ï¼Œå¤„ç†å™¨å’Œç¼–è¯‘å™¨å¸¸å¸¸ä¼šå¯¹æŒ‡ä»¤è¿›è¡Œé‡æ’åºï¼Œä½†æ˜¯ä¸èƒ½éšæ„é‡æ’åºï¼Œä¸æ˜¯ä½ æƒ³æ€ä¹ˆæ’åºå°±æ€ä¹ˆæ’åºï¼Œå®ƒéœ€è¦æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶ï¼š</p>\n<ul>\n<li><strong>åœ¨å•çº¿ç¨‹ç¯å¢ƒä¸‹ä¸èƒ½æ”¹å˜ç¨‹åºè¿è¡Œçš„ç»“æœï¼›</strong></li>\n<li><strong>å­˜åœ¨æ•°æ®ä¾èµ–å…³ç³»çš„ä¸å…è®¸é‡æ’åº</strong></li>\n</ul>\n<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šé‡æ’åºä¸ä¼šå½±å“å•çº¿ç¨‹ç¯å¢ƒçš„æ‰§è¡Œç»“æœï¼Œä½†æ˜¯ä¼šç ´åå¤šçº¿ç¨‹çš„æ‰§è¡Œè¯­ä¹‰ã€‚</p>\n<h4 id=\"as-if-serial-è§„åˆ™å’Œ-happens-before-è§„åˆ™çš„åŒºåˆ«\"><a href=\"#as-if-serial-è§„åˆ™å’Œ-happens-before-è§„åˆ™çš„åŒºåˆ«\" class=\"headerlink\" title=\"as-if-serial è§„åˆ™å’Œ happens-before è§„åˆ™çš„åŒºåˆ«\"></a>as-if-serial è§„åˆ™å’Œ happens-before è§„åˆ™çš„åŒºåˆ«</h4><ul>\n<li>as-if-serial è§„åˆ™ä¿è¯ <strong>å•çº¿ç¨‹</strong> å†…ç¨‹åºçš„æ‰§è¡Œç»“æœä¸è¢«æ”¹å˜ï¼Œhappens-before è§„åˆ™ä¿è¯ <strong>æ­£ç¡®åŒæ­¥çš„å¤šçº¿ç¨‹</strong> ç¨‹åºçš„æ‰§è¡Œç»“æœä¸è¢«æ”¹å˜ã€‚</li>\n<li>as-if-serial è¯­ä¹‰å’Œ happens-before è¿™ä¹ˆåšçš„ç›®çš„ï¼Œéƒ½æ˜¯ä¸ºäº†åœ¨ä¸æ”¹å˜ç¨‹åºæ‰§è¡Œç»“æœçš„å‰æä¸‹ï¼Œå°½å¯èƒ½åœ°æé«˜ç¨‹åºæ‰§è¡Œçš„å¹¶è¡Œåº¦ã€‚</li>\n</ul>\n<h4 id=\"volatile-å…³é”®å­—çš„ä½œç”¨\"><a href=\"#volatile-å…³é”®å­—çš„ä½œç”¨\" class=\"headerlink\" title=\"volatile å…³é”®å­—çš„ä½œç”¨\"></a>volatile å…³é”®å­—çš„ä½œç”¨</h4><p>å¯¹äºå¯è§æ€§ï¼ŒJava æä¾›äº† volatile å…³é”®å­—æ¥ä¿è¯å¯è§æ€§å’Œæœ‰åºæ€§ï¼ˆç¦æ­¢æŒ‡ä»¤é‡æ’ï¼‰ï¼Œä½†ä¸èƒ½ä¿è¯åŸå­æ€§ã€‚ volatile æä¾› happens-before çš„ä¿è¯ï¼Œç¡®ä¿ä¸€ä¸ªçº¿ç¨‹çš„ä¿®æ”¹èƒ½å¯¹å…¶ä»–çº¿ç¨‹æ˜¯å¯è§çš„ã€‚å½“ä¸€ä¸ªå…±äº«å˜é‡è¢« volatile ä¿®é¥°æ—¶ï¼Œå®ƒä¼šä¿è¯ä¿®æ”¹çš„å€¼ä¼šç«‹å³è¢«æ›´æ–°åˆ°ä¸»å­˜ï¼Œå½“æœ‰å…¶ä»–çº¿ç¨‹éœ€è¦è¯»å–æ—¶ï¼Œå®ƒä¼šå»å†…å­˜ä¸­è¯»å–æ–°å€¼ã€‚</p>\n<h4 id=\"JMMå†…å­˜å±éšœæ’å…¥ç­–ç•¥\"><a href=\"#JMMå†…å­˜å±éšœæ’å…¥ç­–ç•¥\" class=\"headerlink\" title=\"JMMå†…å­˜å±éšœæ’å…¥ç­–ç•¥\"></a>JMMå†…å­˜å±éšœæ’å…¥ç­–ç•¥</h4><p><strong>æ’å…¥å±éšœ</strong></p>\n<p>StoreStore å±éšœ - volatile å†™ - StoreLoad å±éšœ</p>\n<p>volatile è¯» - LoadLoad å±éšœ - LoadStore å±éšœ</p>\n<p><strong>volatile ä¸æ™®é€šå˜é‡çš„é‡æ’åºè§„åˆ™</strong></p>\n<ol>\n<li>å¦‚æœç¬¬ä¸€ä¸ªæ“ä½œæ˜¯ volatile è¯»ï¼Œé‚£æ— è®ºç¬¬äºŒä¸ªæ“ä½œæ˜¯ä»€ä¹ˆï¼Œéƒ½ä¸èƒ½é‡æ’åºï¼›</li>\n<li>å¦‚æœç¬¬äºŒä¸ªæ“ä½œæ˜¯ volatile å†™ï¼Œé‚£æ— è®ºç¬¬ä¸€ä¸ªæ“ä½œæ˜¯ä»€ä¹ˆï¼Œéƒ½ä¸èƒ½é‡æ’åºï¼›</li>\n<li>å¦‚æœç¬¬ä¸€ä¸ªæ“ä½œæ˜¯ volatile å†™ï¼Œç¬¬äºŒä¸ªæ“ä½œæ˜¯ volatile è¯»ï¼Œé‚£ä¸èƒ½é‡æ’åºã€‚</li>\n</ol>\n<h4 id=\"volatile-èƒ½ä½¿å¾—ä¸€ä¸ªéåŸå­æ“ä½œå˜æˆåŸå­æ“ä½œå—ï¼Ÿ\"><a href=\"#volatile-èƒ½ä½¿å¾—ä¸€ä¸ªéåŸå­æ“ä½œå˜æˆåŸå­æ“ä½œå—ï¼Ÿ\" class=\"headerlink\" title=\"volatile èƒ½ä½¿å¾—ä¸€ä¸ªéåŸå­æ“ä½œå˜æˆåŸå­æ“ä½œå—ï¼Ÿ\"></a>volatile èƒ½ä½¿å¾—ä¸€ä¸ªéåŸå­æ“ä½œå˜æˆåŸå­æ“ä½œå—ï¼Ÿ</h4><p>volatile åªèƒ½ä¿è¯å¯è§æ€§å’Œæœ‰åºæ€§è€Œä¸èƒ½ä¿è¯åŸå­æ€§ï¼Œä½†ç”¨ volatile ä¿®é¥° long å’Œ double å¯ä»¥ä¿è¯å…¶æ“ä½œåŸå­æ€§ã€‚</p>\n<h4 id=\"volatile-ä¿®é¥°ç¬¦çš„æœ‰è¿‡ä»€ä¹ˆå®è·µï¼Ÿ\"><a href=\"#volatile-ä¿®é¥°ç¬¦çš„æœ‰è¿‡ä»€ä¹ˆå®è·µï¼Ÿ\" class=\"headerlink\" title=\"volatile ä¿®é¥°ç¬¦çš„æœ‰è¿‡ä»€ä¹ˆå®è·µï¼Ÿ\"></a>volatile ä¿®é¥°ç¬¦çš„æœ‰è¿‡ä»€ä¹ˆå®è·µï¼Ÿ</h4><p>å•ä¾‹æ¨¡å¼-åŒé‡é”æ£€éªŒé‡Œé¢ç”¨ volatile ä¿®é¥°å®ä¾‹å˜é‡ã€‚</p>\n<h4 id=\"volatile-å’Œ-synchronized-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#volatile-å’Œ-synchronized-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"volatile å’Œ synchronized çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>volatile å’Œ synchronized çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h4><ul>\n<li>volatile æ˜¯å˜é‡ä¿®é¥°ç¬¦ï¼›synchronized å¯ä»¥ä¿®é¥°ç±»ã€æ–¹æ³•ã€ä»£ç å—ï¼›</li>\n<li>volatile ä»…èƒ½å®ç°å˜é‡çš„ä¿®æ”¹å¯è§æ€§å’Œæœ‰åºæ€§ï¼Œä¸èƒ½ä¿è¯åŸå­æ€§ï¼Œ<br>  è€Œ synchronized åˆ™å¯ä»¥ä¿è¯å˜é‡çš„ä¿®æ”¹åŸå­æ€§å’Œå¯è§æ€§ï¼›</li>\n<li>volatile ä¸ä¼šé€ æˆçº¿ç¨‹çš„é˜»å¡ï¼›synchronized å¯èƒ½ä¼šé€ æˆçº¿ç¨‹çš„é˜»å¡ï¼›</li>\n<li><strong>volatileå…³é”®å­—</strong>æ˜¯çº¿ç¨‹åŒæ­¥çš„<strong>è½»é‡çº§å®ç°</strong>ï¼Œæ‰€ä»¥<strong>volatileæ€§èƒ½è‚¯å®šæ¯”synchronizedå…³é”®å­—è¦å¥½</strong>ã€‚synchronized å…³é”®å­—åœ¨ JavaSE1.6 ä¹‹åè¿›è¡Œäº†ä¸»è¦åŒ…æ‹¬ä¸ºäº†<strong>å‡å°‘è·å¾—é”å’Œé‡Šæ”¾é”å¸¦æ¥çš„æ€§èƒ½æ¶ˆè€—</strong>è€Œå¼•å…¥çš„åå‘é”å’Œè½»é‡çº§é”ä»¥åŠå…¶å®ƒå„ç§ä¼˜åŒ–ä¹‹åæ‰§è¡Œæ•ˆç‡æœ‰äº†æ˜¾è‘—æå‡ï¼Œ<strong>å®é™…å¼€å‘ä¸­ä½¿ç”¨ synchronized å…³é”®å­—çš„åœºæ™¯è¿˜æ˜¯æ›´å¤šä¸€äº›</strong>ã€‚</li>\n</ul>\n<h2 id=\"Lock-ä½“ç³»\"><a href=\"#Lock-ä½“ç³»\" class=\"headerlink\" title=\"Lock ä½“ç³»\"></a>Lock ä½“ç³»</h2><h3 id=\"Lock-ç®€ä»‹\"><a href=\"#Lock-ç®€ä»‹\" class=\"headerlink\" title=\"Lock ç®€ä»‹\"></a>Lock ç®€ä»‹</h3><h4 id=\"Lock-æ¥å£æ˜¯ä»€ä¹ˆï¼Ÿå¯¹æ¯”åŒæ­¥å®ƒæœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ\"><a href=\"#Lock-æ¥å£æ˜¯ä»€ä¹ˆï¼Ÿå¯¹æ¯”åŒæ­¥å®ƒæœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ\" class=\"headerlink\" title=\"Lock æ¥å£æ˜¯ä»€ä¹ˆï¼Ÿå¯¹æ¯”åŒæ­¥å®ƒæœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ\"></a>Lock æ¥å£æ˜¯ä»€ä¹ˆï¼Ÿå¯¹æ¯”åŒæ­¥å®ƒæœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ</h4><p>Lock æ¥å£æ¯”åŒæ­¥æ–¹æ³•å’ŒåŒæ­¥å—æä¾›äº†æ›´å…·æ‰©å±•æ€§çš„é”æ“ä½œã€‚</p>\n<p>ï¼ˆ1ï¼‰å¯ä»¥ä½¿é”æ›´<strong>å…¬å¹³</strong></p>\n<p>ï¼ˆ2ï¼‰å¯ä»¥ä½¿çº¿ç¨‹åœ¨<strong>ç­‰å¾…é”çš„æ—¶å€™å“åº”ä¸­æ–­</strong></p>\n<p>ï¼ˆ3ï¼‰å¯ä»¥<strong>è®©çº¿ç¨‹å°è¯•è·å–é”ï¼Œå¹¶åœ¨æ— æ³•è·å–é”çš„æ—¶å€™ç«‹å³è¿”å›æˆ–è€…ç­‰å¾…ä¸€æ®µæ—¶é—´</strong></p>\n<h4 id=\"ä¹è§‚é”å’Œæ‚²è§‚é”çš„ç†è§£åŠå¦‚ä½•å®ç°ï¼Œæœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ\"><a href=\"#ä¹è§‚é”å’Œæ‚²è§‚é”çš„ç†è§£åŠå¦‚ä½•å®ç°ï¼Œæœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ\" class=\"headerlink\" title=\"ä¹è§‚é”å’Œæ‚²è§‚é”çš„ç†è§£åŠå¦‚ä½•å®ç°ï¼Œæœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ\"></a>ä¹è§‚é”å’Œæ‚²è§‚é”çš„ç†è§£åŠå¦‚ä½•å®ç°ï¼Œæœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ</h4><p>æ‚²è§‚é”ï¼šæ€»æ˜¯å‡è®¾æœ€åçš„æƒ…å†µï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¼šä¿®æ”¹ï¼Œæ‰€ä»¥æ¯æ¬¡åœ¨æ‹¿æ•°æ®çš„æ—¶å€™éƒ½ä¼šä¸Šé”ï¼Œè¿™æ ·åˆ«äººæƒ³æ‹¿è¿™ä¸ªæ•°æ®å°±ä¼šé˜»å¡ç›´åˆ°å®ƒæ‹¿åˆ°é”ã€‚<br>    ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“é‡Œè¾¹å°±ç”¨åˆ°äº†å¾ˆå¤šè¿™ç§é”æœºåˆ¶ï¼Œæ¯”å¦‚è¡Œé”ï¼Œè¡¨é”ç­‰ï¼Œè¯»é”ï¼Œå†™é”ç­‰ï¼Œéƒ½æ˜¯åœ¨åšæ“ä½œä¹‹å‰å…ˆä¸Šé”ã€‚å†æ¯”å¦‚ Java é‡Œé¢çš„åŒæ­¥åŸè¯­ synchronized å…³é”®å­—çš„å®ç°ä¹Ÿæ˜¯æ‚²è§‚é”ã€‚</p>\n<p>ä¹è§‚é”ï¼šé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¾ˆä¹è§‚ï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¸ä¼šä¿®æ”¹ï¼Œæ‰€ä»¥ä¸ä¼šä¸Šé”ï¼Œä½†æ˜¯åœ¨æ›´æ–°çš„æ—¶å€™ä¼šåˆ¤æ–­ä¸€ä¸‹åœ¨æ­¤æœŸé—´åˆ«äººæœ‰æ²¡æœ‰å»æ›´æ–°è¿™ä¸ªæ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ç‰ˆæœ¬å·ç­‰æœºåˆ¶ã€‚<br>    ä¹è§‚é”é€‚ç”¨äºå¤šè¯»çš„åº”ç”¨ç±»å‹ï¼Œè¿™æ ·å¯ä»¥æé«˜ååé‡ï¼Œæ¯”å¦‚ atomic åŒ…ä¸‹é¢çš„åŸå­å˜é‡ç±»å°±æ˜¯ä½¿ç”¨äº†ä¹è§‚é”çš„ä¸€ç§å®ç°æ–¹å¼ CAS å®ç°çš„ã€‚</p>\n<h4 id=\"ä»€ä¹ˆæ˜¯-CAS\"><a href=\"#ä»€ä¹ˆæ˜¯-CAS\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ CAS\"></a>ä»€ä¹ˆæ˜¯ CAS</h4><p>CAS æ˜¯ compare and swap çš„ç¼©å†™ï¼Œå³æˆ‘ä»¬æ‰€è¯´çš„æ¯”è¾ƒäº¤æ¢ï¼Œæ˜¯ä¸€ç§ä¹è§‚é”æ“ä½œã€‚</p>\n<p>CAS æ“ä½œåŒ…å«ä¸‰ä¸ªæ“ä½œæ•° â€”â€” å†…å­˜ä½ç½®ï¼ˆVï¼‰ã€é¢„æœŸåŸå€¼ï¼ˆAï¼‰å’Œæ–°å€¼ï¼ˆBï¼‰ã€‚</p>\n<p>å¦‚æœå†…å­˜åœ°å€ V é‡Œé¢çš„å€¼å’Œ A çš„å€¼æ˜¯ä¸€æ ·çš„ï¼Œé‚£ä¹ˆå°±å°†å†…å­˜é‡Œé¢çš„å€¼æ›´æ–°æˆ Bã€‚</p>\n<h4 id=\"Javaå®ç°CASçš„åŸç†-Unsafeç±»\"><a href=\"#Javaå®ç°CASçš„åŸç†-Unsafeç±»\" class=\"headerlink\" title=\"Javaå®ç°CASçš„åŸç† - Unsafeç±»\"></a>Javaå®ç°CASçš„åŸç† - Unsafeç±»</h4><p>åœ¨ Java ä¸­ï¼Œæœ‰ä¸€ä¸ª<code>Unsafe</code>ç±»ï¼Œå®ƒåœ¨<code>sun.misc</code>åŒ…ä¸­ã€‚å®ƒé‡Œé¢æ˜¯ä¸€äº›<code>native</code>æ–¹æ³•ï¼ˆç”±åº•å±‚çš„ JVM ä½¿ç”¨ C æˆ–è€… C++å»å®ç°ï¼‰ï¼Œå…¶ä¸­å°±æœ‰å‡ ä¸ªå…³äº CAS çš„ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">boolean</span> <span class=\"title function_\">compareAndSwapObject</span><span class=\"params\">(Object o, <span class=\"type\">long</span> offset,Object expected, Object x)</span>;</span><br><span class=\"line\"><span class=\"type\">boolean</span> <span class=\"title function_\">compareAndSwapInt</span><span class=\"params\">(Object o, <span class=\"type\">long</span> offset,<span class=\"type\">int</span> expected,<span class=\"type\">int</span> x)</span>;</span><br><span class=\"line\"><span class=\"type\">boolean</span> <span class=\"title function_\">compareAndSwapLong</span><span class=\"params\">(Object o, <span class=\"type\">long</span> offset,<span class=\"type\">long</span> expected,<span class=\"type\">long</span> x)</span>;</span><br></pre></td></tr></table></figure>\n\n<p>å½“ç„¶ï¼Œä»–ä»¬éƒ½æ˜¯<code>public native</code>çš„ã€‚</p>\n<p>Unsafe ä¸­å¯¹ CAS çš„å®ç°æ˜¯ C++ å†™çš„ï¼Œå®ƒçš„å…·ä½“å®ç°å’Œæ“ä½œç³»ç»Ÿã€CPU éƒ½æœ‰å…³ç³»ã€‚</p>\n<p>Linux çš„ X86 ä¸‹ä¸»è¦æ˜¯é€šè¿‡<code>cmpxchgl</code>è¿™ä¸ªæŒ‡ä»¤åœ¨ CPU çº§å®Œæˆ CAS æ“ä½œçš„ï¼Œä½†åœ¨å¤šå¤„ç†å™¨æƒ…å†µä¸‹å¿…é¡»ä½¿ç”¨<code>lock</code>æŒ‡ä»¤åŠ é”æ¥å®Œæˆã€‚å½“ç„¶ä¸åŒçš„æ“ä½œç³»ç»Ÿå’Œå¤„ç†å™¨çš„å®ç°ä¼šæœ‰æ‰€ä¸åŒï¼Œå¤§å®¶å¯ä»¥è‡ªè¡Œäº†è§£ã€‚</p>\n<p>å½“ç„¶ï¼ŒUnsafe ç±»é‡Œé¢è¿˜æœ‰å…¶å®ƒæ–¹æ³•ç”¨äºä¸åŒçš„ç”¨é€”ã€‚æ¯”å¦‚æ”¯æŒçº¿ç¨‹æŒ‚èµ·å’Œæ¢å¤çš„<code>park</code>å’Œ<code>unpark</code>ï¼Œ LockSupport ç±»åº•å±‚å°±æ˜¯è°ƒç”¨äº†è¿™ä¸¤ä¸ªæ–¹æ³•ã€‚è¿˜æœ‰æ”¯æŒåå°„æ“ä½œçš„<code>allocateInstance()</code>æ–¹æ³•ã€‚</p>\n<h4 id=\"CAS-ä¼šäº§ç”Ÿä»€ä¹ˆé—®é¢˜ï¼Ÿ\"><a href=\"#CAS-ä¼šäº§ç”Ÿä»€ä¹ˆé—®é¢˜ï¼Ÿ\" class=\"headerlink\" title=\"CAS ä¼šäº§ç”Ÿä»€ä¹ˆé—®é¢˜ï¼Ÿ\"></a>CAS ä¼šäº§ç”Ÿä»€ä¹ˆé—®é¢˜ï¼Ÿ</h4><p>1ã€<strong>ABA é—®é¢˜</strong>ï¼š</p>\n<p>æ¯”å¦‚è¯´ä¸€ä¸ªçº¿ç¨‹ one ä»å†…å­˜ä½ç½® V ä¸­å–å‡º Aï¼Œè¿™æ—¶å€™å¦ä¸€ä¸ªçº¿ç¨‹ two ä¹Ÿä»å†…å­˜ä¸­å–å‡º Aï¼Œå¹¶ä¸” two è¿›è¡Œäº†ä¸€äº›æ“ä½œå˜æˆäº† Bï¼Œç„¶å two åˆå°† V ä½ç½®çš„æ•°æ®å˜æˆ Aï¼Œè¿™æ—¶å€™çº¿ç¨‹ one è¿›è¡Œ CAS æ“ä½œå‘ç°å†…å­˜ä¸­ä»ç„¶æ˜¯ Aï¼Œç„¶å one æ“ä½œæˆåŠŸã€‚å°½ç®¡çº¿ç¨‹ one çš„ CAS æ“ä½œæˆåŠŸï¼Œä½†å¯èƒ½å­˜åœ¨æ½œè—çš„é—®é¢˜ã€‚å¯ä»¥åœ¨å˜é‡ä¸ŠåŠ ä¸€ä¸ªç‰ˆæœ¬æˆ³ã€‚ä» Java1.5 å¼€å§‹ JDK çš„ atomic åŒ…é‡Œæä¾›äº†ä¸€ä¸ªç±» AtomicStampedReference æ¥è§£å†³ ABA é—®é¢˜ã€‚</p>\n<p>2ã€<strong>å¾ªç¯æ—¶é—´é•¿å¼€é”€å¤§</strong>ï¼š</p>\n<p>å¯¹äºèµ„æºç«äº‰ä¸¥é‡ï¼ˆçº¿ç¨‹å†²çªä¸¥é‡ï¼‰çš„æƒ…å†µï¼ŒCAS è‡ªæ—‹çš„æ¦‚ç‡ä¼šæ¯”è¾ƒå¤§ï¼Œä»è€Œæµªè´¹æ›´å¤šçš„ CPU èµ„æºï¼Œæ•ˆç‡ä½äº synchronizedã€‚</p>\n<p>3ã€<strong>åªèƒ½ä¿è¯ä¸€ä¸ªå…±äº«å˜é‡çš„åŸå­æ“ä½œ</strong>ï¼š</p>\n<p>å½“å¯¹ä¸€ä¸ªå…±äº«å˜é‡æ‰§è¡Œæ“ä½œæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¾ªç¯ CAS çš„æ–¹å¼æ¥ä¿è¯åŸå­æ“ä½œï¼Œä½†æ˜¯<strong>å¯¹å¤šä¸ªå…±äº«å˜é‡æ“ä½œæ—¶ï¼Œå¾ªç¯ CAS å°±æ— æ³•ä¿è¯æ“ä½œçš„åŸå­æ€§ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ç”¨é”</strong>ã€‚</p>\n<h4 id=\"æ­»é”ä¸æ´»é”çš„åŒºåˆ«ï¼Œæ­»é”ä¸é¥¥é¥¿çš„åŒºåˆ«ï¼Ÿ\"><a href=\"#æ­»é”ä¸æ´»é”çš„åŒºåˆ«ï¼Œæ­»é”ä¸é¥¥é¥¿çš„åŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"æ­»é”ä¸æ´»é”çš„åŒºåˆ«ï¼Œæ­»é”ä¸é¥¥é¥¿çš„åŒºåˆ«ï¼Ÿ\"></a>æ­»é”ä¸æ´»é”çš„åŒºåˆ«ï¼Œæ­»é”ä¸é¥¥é¥¿çš„åŒºåˆ«ï¼Ÿ</h4><blockquote>\n<p>åŒºåˆ«ï¼šæ­»é”åŠ¨ä¸äº†äº†ï¼›æ´»é”ä¸€ç›´é‡å¤å°è¯•ã€å¤±è´¥ã€å°è¯•ã€å¤±è´¥ã€‚</p>\n</blockquote>\n<p>æ­»é”ï¼šæ˜¯æŒ‡ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„è¿›ç¨‹ï¼ˆæˆ–çº¿ç¨‹ï¼‰åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå› äº‰å¤ºèµ„æºè€Œé€ æˆçš„ä¸€ç§äº’ç›¸ç­‰å¾…çš„ç°è±¡ï¼Œè‹¥æ— å¤–åŠ›ä½œç”¨ï¼Œå®ƒä»¬éƒ½å°†æ— æ³•æ¨è¿›ä¸‹å»ã€‚</p>\n<p>æ´»é”ï¼šä»»åŠ¡æˆ–è€…æ‰§è¡Œè€…æ²¡æœ‰è¢«é˜»å¡ï¼Œç”±äºæŸäº›æ¡ä»¶æ²¡æœ‰æ»¡è¶³ï¼Œå¯¼è‡´<strong>ä¸€ç›´é‡å¤å°è¯•ï¼Œå¤±è´¥ï¼Œå°è¯•ï¼Œå¤±è´¥</strong>ã€‚</p>\n<p>æ´»é”å’Œæ­»é”çš„åŒºåˆ«åœ¨äºï¼Œå¤„äºæ´»é”çš„å®ä½“æ˜¯åœ¨ä¸æ–­çš„æ”¹å˜çŠ¶æ€ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„â€œæ´»â€ï¼Œ è€Œå¤„äºæ­»é”çš„å®ä½“è¡¨ç°ä¸ºç­‰å¾…ï¼›æ´»é”æœ‰å¯èƒ½è‡ªè¡Œè§£å¼€ï¼Œæ­»é”åˆ™ä¸èƒ½ã€‚</p>\n<p>é¥¥é¥¿ï¼šä¸€ä¸ªæˆ–è€…å¤šä¸ªçº¿ç¨‹å› ä¸ºç§ç§åŸå› æ— æ³•è·å¾—æ‰€éœ€è¦çš„èµ„æºï¼Œå¯¼è‡´ä¸€ç›´æ— æ³•æ‰§è¡Œçš„çŠ¶æ€ã€‚</p>\n<p>Java ä¸­å¯¼è‡´é¥¥é¥¿çš„åŸå› ï¼šé«˜ä¼˜å…ˆçº§çº¿ç¨‹åå™¬æ‰€æœ‰çš„ä½ä¼˜å…ˆçº§çº¿ç¨‹çš„ CPU æ—¶é—´ã€‚</p>\n<h3 id=\"AQSè¯¦è§£\"><a href=\"#AQSè¯¦è§£\" class=\"headerlink\" title=\"AQSè¯¦è§£\"></a>AQSè¯¦è§£</h3><h4 id=\"AQS-ä»‹ç»\"><a href=\"#AQS-ä»‹ç»\" class=\"headerlink\" title=\"AQS ä»‹ç»\"></a>AQS ä»‹ç»</h4><p>AQS çš„å…¨ç§°ä¸ºï¼ˆAbstractQueuedSynchronizerï¼‰ï¼ŒæŠ½è±¡é˜Ÿåˆ—åŒæ­¥å™¨ã€‚</p>\n<p>ä½¿ç”¨ AQS èƒ½ç®€å•ä¸”é«˜æ•ˆåœ°æ„é€ å‡ºåº”ç”¨å¹¿æ³›çš„å¤§é‡çš„åŒæ­¥å™¨ï¼Œæ¯”å¦‚æˆ‘ä»¬æåˆ°çš„ ReentrantLockï¼ŒSemaphoreï¼Œå…¶ä»–çš„è¯¸å¦‚ ReentrantReadWriteLockï¼ŒSynchronousQueueï¼ŒFutureTask ç­‰ç­‰çš†æ˜¯åŸºäº AQS çš„ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬è‡ªå·±ä¹Ÿèƒ½åˆ©ç”¨ AQS éå¸¸è½»æ¾å®¹æ˜“åœ°æ„é€ å‡ºç¬¦åˆæˆ‘ä»¬è‡ªå·±éœ€æ±‚çš„åŒæ­¥å™¨ã€‚</p>\n<h4 id=\"AQS-åŸç†åˆ†æ\"><a href=\"#AQS-åŸç†åˆ†æ\" class=\"headerlink\" title=\"AQS åŸç†åˆ†æ\"></a>AQS åŸç†åˆ†æ</h4><p><strong>å¦‚æœè¢«è¯·æ±‚çš„å…±äº«èµ„æºç©ºé—²ï¼Œåˆ™å°†å½“å‰è¯·æ±‚èµ„æºçš„çº¿ç¨‹è®¾ç½®ä¸ºæœ‰æ•ˆçš„å·¥ä½œçº¿ç¨‹ï¼Œå¹¶ä¸”å°†å…±äº«èµ„æºè®¾ç½®ä¸ºé”å®šçŠ¶æ€ã€‚<br>å¦‚æœè¢«è¯·æ±‚çš„å…±äº«èµ„æºè¢«å ç”¨ï¼Œé‚£ä¹ˆå°±ä½¿ç”¨ CLH é˜Ÿåˆ—ï¼Œå°†æš‚æ—¶è·å–ä¸åˆ°é”çš„çº¿ç¨‹åŠ å…¥åˆ°é˜Ÿåˆ—ä¸­ã€‚</strong></p>\n<blockquote>\n<p>CLH(Craig,Landin,and Hagersten)é˜Ÿåˆ—æ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„åŒå‘é˜Ÿåˆ—ï¼ˆè™šæ‹Ÿçš„åŒå‘é˜Ÿåˆ—å³ä¸å­˜åœ¨é˜Ÿåˆ—å®ä¾‹ï¼Œä»…å­˜åœ¨ç»“ç‚¹ä¹‹é—´çš„å…³è”å…³ç³»ï¼‰ã€‚AQS æ˜¯å°†æ¯æ¡è¯·æ±‚å…±äº«èµ„æºçš„çº¿ç¨‹å°è£…æˆä¸€ä¸ª CLH é˜Ÿåˆ—çš„ä¸€ä¸ªç»“ç‚¹ï¼ˆNodeï¼‰æ¥å®ç°é”çš„åˆ†é…ã€‚</p>\n</blockquote>\n<p>çœ‹ä¸ª AQS(AbstractQueuedSynchronizer)åŸç†å›¾ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes11474088-c906e727d699fa9c.png\" alt=\"AQSåŸç†å›¾\"></p>\n<p>AQS ä½¿ç”¨ä¸€ä¸ª volatile int ç±»å‹çš„æˆå‘˜å˜é‡ state æ¥è¡¨ç¤ºåŒæ­¥çŠ¶æ€ï¼Œé€šè¿‡å†…ç½®çš„ CLH é˜Ÿåˆ—æ¥å®Œæˆè·å–èµ„æºçº¿ç¨‹çš„æ’é˜Ÿå·¥ä½œã€‚AQS ä½¿ç”¨ CAS å¯¹è¯¥åŒæ­¥çŠ¶æ€è¿›è¡ŒåŸå­æ“ä½œå®ç°å¯¹å…¶å€¼çš„ä¿®æ”¹ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> <span class=\"type\">int</span> state;\t<span class=\"comment\">// å…±äº«å˜é‡ï¼Œä½¿ç”¨volatileä¿®é¥°ä¿è¯çº¿ç¨‹å¯è§æ€§</span></span><br></pre></td></tr></table></figure>\n\n<p>çŠ¶æ€ä¿¡æ¯é€šè¿‡ protected ç±»å‹çš„ getStateï¼ŒsetStateï¼ŒcompareAndSetState è¿›è¡Œæ“ä½œ</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// è¿”å›åŒæ­¥çŠ¶æ€çš„å½“å‰å€¼</span></span><br><span class=\"line\"><span class=\"keyword\">protected</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"title function_\">getState</span><span class=\"params\">()</span> &#123;  </span><br><span class=\"line\">    <span class=\"keyword\">return</span> state;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// è®¾ç½®åŒæ­¥çŠ¶æ€çš„å€¼</span></span><br><span class=\"line\"><span class=\"keyword\">protected</span> <span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title function_\">setState</span><span class=\"params\">(<span class=\"type\">int</span> newState)</span> &#123; </span><br><span class=\"line\">    state = newState;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// åŸå­åœ°ï¼ˆCASæ“ä½œï¼‰å°†åŒæ­¥çŠ¶æ€å€¼è®¾ç½®ä¸ºç»™å®šå€¼updateå¦‚æœå½“å‰åŒæ­¥çŠ¶æ€çš„å€¼ç­‰äºexpectï¼ˆæœŸæœ›å€¼ï¼‰</span></span><br><span class=\"line\"><span class=\"keyword\">protected</span> <span class=\"keyword\">final</span> <span class=\"type\">boolean</span> <span class=\"title function_\">compareAndSetState</span><span class=\"params\">(<span class=\"type\">int</span> expect, <span class=\"type\">int</span> update)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> unsafe.compareAndSwapInt(<span class=\"built_in\">this</span>, stateOffset, expect, update);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>AQS å¯¹èµ„æºçš„å…±äº«æ–¹å¼</strong></p>\n<p>AQS å®šä¹‰ä¸¤ç§èµ„æºå…±äº«æ–¹å¼</p>\n<ul>\n<li><strong>Exclusive</strong>ï¼ˆç‹¬å ï¼‰ï¼šåªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æ‰§è¡Œï¼Œå¦‚ ReentrantLockã€‚åˆå¯åˆ†ä¸ºå…¬å¹³é”å’Œéå…¬å¹³é”ï¼š<ul>\n<li>å…¬å¹³é”ï¼šæŒ‰ç…§çº¿ç¨‹åœ¨é˜Ÿåˆ—ä¸­çš„æ’é˜Ÿé¡ºåºï¼Œå…ˆåˆ°è€…å…ˆæ‹¿åˆ°é”</li>\n<li>éå…¬å¹³é”ï¼šå½“çº¿ç¨‹è¦è·å–é”æ—¶ï¼Œæ— è§†é˜Ÿåˆ—é¡ºåºç›´æ¥å»æŠ¢é”ï¼Œè°æŠ¢åˆ°å°±æ˜¯è°çš„</li>\n</ul>\n</li>\n<li><strong>Share</strong>ï¼ˆå…±äº«ï¼‰ï¼šå¤šä¸ªçº¿ç¨‹å¯åŒæ—¶æ‰§è¡Œï¼Œå¦‚ Semaphore&#x2F;CountDownLatchã€‚Semaphoreã€CountDownLatchã€ CyclicBarrierã€ReadWriteLock æˆ‘ä»¬éƒ½ä¼šåœ¨åé¢è®²åˆ°ã€‚</li>\n</ul>\n<p><strong>AQSåº•å±‚ä½¿ç”¨äº†æ¨¡æ¿æ–¹æ³•æ¨¡å¼</strong></p>\n<p>åŒæ­¥å™¨çš„è®¾è®¡æ˜¯åŸºäºæ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„ï¼Œå¦‚æœéœ€è¦è‡ªå®šä¹‰åŒæ­¥å™¨ï¼ˆ<strong>æ¨¡æ¿æ–¹æ³•æ¨¡å¼</strong>å¾ˆç»å…¸çš„ä¸€ä¸ªåº”ç”¨ï¼‰ï¼š</p>\n<ol>\n<li>ä½¿ç”¨è€…ç»§æ‰¿ AQS å¹¶é‡å†™æŒ‡å®šçš„æ–¹æ³•ã€‚ï¼ˆå¯¹å…±äº«èµ„æº state çš„è·å–å’Œé‡Šæ”¾ï¼‰</li>\n<li>è°ƒç”¨ AQS çš„æ¨¡æ¿æ–¹æ³•ï¼Œä¼šè¿›ä¸€æ­¥è°ƒç”¨ä½¿ç”¨è€…é‡å†™çš„æ–¹æ³•ã€‚</li>\n</ol>\n<p><strong>AQSä½¿ç”¨äº†æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼Œè‡ªå®šä¹‰åŒæ­¥å™¨æ—¶éœ€è¦é‡å†™ä¸‹é¢å‡ ä¸ªAQSæä¾›çš„æ¨¡æ¿æ–¹æ³•ï¼š</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">isHeldExclusively()\t<span class=\"comment\">// è¯¥çº¿ç¨‹æ˜¯å¦æ­£åœ¨ç‹¬å èµ„æºã€‚åªæœ‰ç”¨åˆ°conditionæ‰éœ€è¦å»å®ç°å®ƒã€‚</span></span><br><span class=\"line\">tryAcquire(<span class=\"type\">int</span>)\t<span class=\"comment\">// ç‹¬å æ–¹å¼ã€‚å°è¯•è·å–èµ„æºï¼ŒæˆåŠŸåˆ™è¿”å›trueï¼Œå¤±è´¥åˆ™è¿”å›falseã€‚</span></span><br><span class=\"line\">tryRelease(<span class=\"type\">int</span>)\t<span class=\"comment\">// ç‹¬å æ–¹å¼ã€‚å°è¯•é‡Šæ”¾èµ„æºï¼ŒæˆåŠŸåˆ™è¿”å›trueï¼Œå¤±è´¥åˆ™è¿”å›falseã€‚</span></span><br><span class=\"line\">tryAcquireShared(<span class=\"type\">int</span>)\t<span class=\"comment\">// å…±äº«æ–¹å¼ã€‚å°è¯•è·å–èµ„æºã€‚è´Ÿæ•°è¡¨ç¤ºå¤±è´¥ï¼›0è¡¨ç¤ºæˆåŠŸï¼Œä½†æ²¡æœ‰å‰©ä½™å¯ç”¨èµ„æºï¼›æ­£æ•°è¡¨ç¤ºæˆåŠŸï¼Œä¸”æœ‰å‰©ä½™èµ„æºã€‚</span></span><br><span class=\"line\">tryReleaseShared(<span class=\"type\">int</span>)\t<span class=\"comment\">// å…±äº«æ–¹å¼ã€‚å°è¯•é‡Šæ”¾èµ„æºï¼ŒæˆåŠŸåˆ™è¿”å›trueï¼Œå¤±è´¥åˆ™è¿”å›falseã€‚</span></span><br></pre></td></tr></table></figure>\n\n<p>ä»¥ ReentrantLock ä¸ºä¾‹ï¼Œstate åˆå§‹åŒ–ä¸º 0ï¼Œè¡¨ç¤ºæœªé”å®šçŠ¶æ€ã€‚A çº¿ç¨‹ lock() æ—¶ï¼Œä¼šè°ƒç”¨ tryAcquire() ç‹¬å è¯¥é”å¹¶å°† state+1ã€‚æ­¤åï¼Œå…¶ä»–çº¿ç¨‹å† tryAcquire() æ—¶å°±ä¼šå¤±è´¥ï¼Œç›´åˆ° A çº¿ç¨‹ unlock( )åˆ° state&#x3D;0ï¼ˆå³é‡Šæ”¾é”ï¼‰ä¸ºæ­¢ï¼Œå…¶å®ƒçº¿ç¨‹æ‰æœ‰æœºä¼šè·å–è¯¥é”ã€‚å½“ç„¶ï¼Œé‡Šæ”¾é”ä¹‹å‰ï¼ŒA çº¿ç¨‹è‡ªå·±æ˜¯å¯ä»¥é‡å¤è·å–æ­¤é”çš„ï¼ˆstate ä¼šç´¯åŠ ï¼‰ï¼Œè¿™å°±æ˜¯å¯é‡å…¥çš„æ¦‚å¿µã€‚</p>\n<p>ä»¥ CountDownLatch ä»¥ä¾‹ï¼Œä»»åŠ¡åˆ†ä¸º N ä¸ªå­çº¿ç¨‹å»æ‰§è¡Œï¼Œstate ä¹Ÿåˆå§‹åŒ–ä¸º Nï¼ˆæ³¨æ„ N è¦ä¸çº¿ç¨‹ä¸ªæ•°ä¸€è‡´ï¼‰ã€‚è¿™ N ä¸ªå­çº¿ç¨‹æ˜¯å¹¶è¡Œæ‰§è¡Œçš„ï¼Œæ¯ä¸ªå­çº¿ç¨‹æ‰§è¡Œå®Œå countDown() ä¸€æ¬¡ï¼Œstate ä¼š CAS å‡ 1ã€‚ç­‰åˆ°æ‰€æœ‰å­çº¿ç¨‹éƒ½æ‰§è¡Œå®Œåï¼ˆå³ state&#x3D;0ï¼‰ï¼Œä¼š unpark() ä¸»è°ƒç”¨çº¿ç¨‹ï¼Œç„¶åä¸»è°ƒç”¨çº¿ç¨‹å°±ä¼šä» await() å‡½æ•°è¿”å›ï¼Œç»§ç»­åç»­åŠ¨ä½œã€‚</p>\n<p>ä¸€èˆ¬æ¥è¯´ï¼Œè‡ªå®šä¹‰åŒæ­¥å™¨è¦ä¹ˆæ˜¯ç‹¬å æ–¹æ³•ï¼Œè¦ä¹ˆæ˜¯å…±äº«æ–¹å¼ï¼Œä»–ä»¬ä¹Ÿåªéœ€å®ç°<code>tryAcquire-tryRelease</code>ã€<code>tryAcquireShared-tryReleaseShared</code>ä¸­çš„ä¸€ç§å³å¯ã€‚ä½† AQS ä¹Ÿæ”¯æŒè‡ªå®šä¹‰åŒæ­¥å™¨åŒæ—¶å®ç°ç‹¬å å’Œå…±äº«ä¸¤ç§æ–¹å¼ï¼Œå¦‚<code>ReentrantReadWriteLock</code>ã€‚</p>\n<h3 id=\"è¯»å†™é”\"><a href=\"#è¯»å†™é”\" class=\"headerlink\" title=\"è¯»å†™é”\"></a>è¯»å†™é”</h3><p>é¦–å…ˆæ˜ç¡®ä¸€ä¸‹ï¼Œä¸æ˜¯è¯´ ReentrantLock ä¸å¥½ï¼Œåªæ˜¯ ReentrantLock æŸäº›æ—¶å€™æœ‰å±€é™ã€‚å¦‚æœä½¿ç”¨ ReentrantLockï¼Œå¯èƒ½æœ¬èº«æ˜¯ä¸ºäº†é˜²æ­¢çº¿ç¨‹ A åœ¨å†™æ•°æ®ã€çº¿ç¨‹ B åœ¨è¯»æ•°æ®é€ æˆçš„æ•°æ®ä¸ä¸€è‡´ï¼Œä½†è¿™æ ·ï¼Œå¦‚æœçº¿ç¨‹ C åœ¨è¯»æ•°æ®ã€çº¿ç¨‹ D ä¹Ÿåœ¨è¯»æ•°æ®ï¼Œè¯»æ•°æ®æ˜¯ä¸ä¼šæ”¹å˜æ•°æ®çš„ï¼Œæ²¡æœ‰å¿…è¦åŠ é”ï¼Œä½†æ˜¯è¿˜æ˜¯åŠ é”äº†ï¼Œé™ä½äº†ç¨‹åºçš„æ€§èƒ½ã€‚å› ä¸ºè¿™ä¸ªï¼Œæ‰è¯ç”Ÿäº†è¯»å†™é” ReadWriteLockã€‚</p>\n<p>ReadWriteLock æ˜¯ä¸€ä¸ªè¯»å†™é”æ¥å£ï¼Œè¯»å†™é”æ˜¯ç”¨æ¥æå‡å¹¶å‘ç¨‹åºæ€§èƒ½çš„é”åˆ†ç¦»æŠ€æœ¯ï¼ŒReentrantReadWriteLock æ˜¯ ReadWriteLock æ¥å£çš„ä¸€ä¸ªå…·ä½“å®ç°ï¼Œ<strong>å®ç°äº†è¯»å†™çš„åˆ†ç¦»ï¼Œè¯»é”æ˜¯å…±äº«çš„ï¼Œå†™é”æ˜¯ç‹¬å çš„</strong>ï¼Œè¯»å’Œè¯»ä¹‹é—´ä¸ä¼šäº’æ–¥ï¼Œè¯»å’Œå†™ã€å†™å’Œè¯»ã€å†™å’Œå†™ä¹‹é—´æ‰ä¼šäº’æ–¥ï¼Œæå‡äº†è¯»å†™çš„æ€§èƒ½ã€‚</p>\n<h2 id=\"å¹¶å‘å®¹å™¨\"><a href=\"#å¹¶å‘å®¹å™¨\" class=\"headerlink\" title=\"å¹¶å‘å®¹å™¨\"></a>å¹¶å‘å®¹å™¨</h2><h3 id=\"ConcurrentHashMap\"><a href=\"#ConcurrentHashMap\" class=\"headerlink\" title=\"ConcurrentHashMap\"></a>ConcurrentHashMap</h3><h4 id=\"ä»€ä¹ˆæ˜¯ConcurrentHashMapï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯ConcurrentHashMapï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ConcurrentHashMapï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯ConcurrentHashMapï¼Ÿ</h4><p>ConcurrentHashMap æ˜¯ Java ä¸­çš„ä¸€ä¸ª<strong>çº¿ç¨‹å®‰å…¨ä¸”é«˜æ•ˆçš„HashMapå®ç°</strong>ã€‚</p>\n<p>é‚£ä¹ˆå®ƒåˆ°åº•æ˜¯å¦‚ä½•å®ç°çº¿ç¨‹å®‰å…¨çš„ï¼Ÿ</p>\n<p>JDK 1.6 ç‰ˆæœ¬å…³é”®è¦ç´ ï¼š</p>\n<ul>\n<li>segment ç»§æ‰¿äº† ReentrantLock å……å½“é”çš„è§’è‰²ï¼Œä¸ºæ¯ä¸€ä¸ª segment æä¾›äº†çº¿ç¨‹å®‰å…¨çš„ä¿éšœï¼›</li>\n<li>segment ç»´æŠ¤äº†å“ˆå¸Œæ•£åˆ—è¡¨çš„è‹¥å¹²ä¸ªæ¡¶ï¼Œæ¯ä¸ªæ¡¶ç”± HashEntry æ„æˆçš„é“¾è¡¨ã€‚</li>\n</ul>\n<p>JDK1.8 åï¼ŒConcurrentHashMap æŠ›å¼ƒäº†åŸæœ‰çš„ Segment åˆ†æ®µé”ï¼Œè€Œ<strong>é‡‡ç”¨äº† CAS + synchronized æ¥ä¿è¯å¹¶å‘å®‰å…¨æ€§</strong>ã€‚</p>\n<p>æ’å…¥å…ƒç´ è¿‡ç¨‹ï¼š</p>\n<p>å¦‚æœç›¸åº”ä½ç½®çš„ Node è¿˜æ²¡æœ‰åˆå§‹åŒ–ï¼Œåˆ™è°ƒç”¨ CAS æ’å…¥ç›¸åº”çš„æ•°æ®ï¼›</p>\n<p>å¦‚æœç›¸åº”ä½ç½®çš„ Node ä¸ä¸ºç©ºï¼Œåˆ™å¯¹è¯¥èŠ‚ç‚¹åŠ  synchronized é”è¿›è¡Œæ’å…¥æˆ–æ›´æ–°æ“ä½œã€‚</p>\n<h3 id=\"CopyOnWriteArrayList\"><a href=\"#CopyOnWriteArrayList\" class=\"headerlink\" title=\"CopyOnWriteArrayList\"></a>CopyOnWriteArrayList</h3><p>CopyOnWrite å®¹å™¨å³<strong>å†™æ—¶å¤åˆ¶çš„å®¹å™¨</strong>ï¼Œå½“æˆ‘ä»¬å¾€ä¸€ä¸ªå®¹å™¨ä¸­æ·»åŠ å…ƒç´ çš„æ—¶å€™ï¼Œä¸ç›´æ¥å¾€å®¹å™¨ä¸­æ·»åŠ ï¼Œè€Œæ˜¯å°†å½“å‰å®¹å™¨è¿›è¡Œ copyï¼Œå¤åˆ¶å‡ºæ¥ä¸€ä¸ªæ–°çš„å®¹å™¨ï¼Œç„¶åå‘æ–°å®¹å™¨ä¸­æ·»åŠ æˆ‘ä»¬éœ€è¦çš„å…ƒç´ ï¼Œæœ€åå°†åŸå®¹å™¨çš„å¼•ç”¨æŒ‡å‘æ–°å®¹å™¨ã€‚</p>\n<p><strong>CopyOnWriteArrayList çš„ä½¿ç”¨åœºæ™¯</strong></p>\n<p>é€šè¿‡æºç åˆ†æï¼Œæˆ‘ä»¬çœ‹å‡ºå®ƒçš„ä¼˜ç¼ºç‚¹æ¯”è¾ƒæ˜æ˜¾ï¼Œæ‰€ä»¥ä½¿ç”¨åœºæ™¯ä¹Ÿå°±æ¯”è¾ƒæ˜æ˜¾ã€‚å°±æ˜¯åˆé€‚è¯»å¤šå†™å°‘çš„åœºæ™¯ã€‚</p>\n<p><strong>CopyOnWriteArrayList çš„ç¼ºç‚¹</strong></p>\n<ol>\n<li>ç”±äºå†™æ“ä½œçš„æ—¶å€™ï¼Œéœ€è¦æ‹·è´æ•°ç»„ï¼Œä¼šæ¶ˆè€—å†…å­˜ï¼Œå¦‚æœåŸæ•°ç»„çš„å†…å®¹æ¯”è¾ƒå¤šçš„æƒ…å†µä¸‹ï¼Œå¯èƒ½å¯¼è‡´ young gc æˆ–è€… full gcã€‚</li>\n<li><strong>ä¸èƒ½ç”¨äºå®æ—¶è¯»çš„åœºæ™¯</strong>ï¼Œåƒæ‹·è´æ•°ç»„ã€æ–°å¢å…ƒç´ éƒ½éœ€è¦æ—¶é—´ï¼Œæ‰€ä»¥è°ƒç”¨ä¸€ä¸ª set æ“ä½œåï¼Œ<strong>è¯»å–åˆ°æ•°æ®å¯èƒ½è¿˜æ˜¯æ—§çš„</strong>ï¼Œè™½ç„¶ CopyOnWriteArrayList èƒ½åšåˆ°æœ€ç»ˆä¸€è‡´æ€§,ä½†æ˜¯è¿˜æ˜¯æ²¡æ³•æ»¡è¶³å®æ—¶æ€§è¦æ±‚ã€‚</li>\n</ol>\n<h3 id=\"ThreadLocal\"><a href=\"#ThreadLocal\" class=\"headerlink\" title=\"ThreadLocal\"></a>ThreadLocal</h3><h4 id=\"ThreadLocalçš„æ•°æ®ç»“æ„\"><a href=\"#ThreadLocalçš„æ•°æ®ç»“æ„\" class=\"headerlink\" title=\"ThreadLocalçš„æ•°æ®ç»“æ„\"></a>ThreadLocalçš„æ•°æ®ç»“æ„</h4><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesthreadlocal%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84.a0bfadf8.png\" alt=\"ThreadLocalæ•°æ®ç»“æ„\" style=\"zoom: 67%;\" />\n\n<p>æ¯ä¸ªçº¿ç¨‹ Thread ä¸­æœ‰ä¸€ä¸ªç±»å‹ä¸º ThreadLocal.ThreadLocalMap çš„å®ä¾‹å˜é‡ threadLocalsï¼Œè¯¥å®ä¾‹å˜é‡ä¸­æ¯ä¸ª entry ä¸º &lt;threadLocal çš„å¼±å¼•ç”¨ï¼Œvalue ä¸ºå¼ºå¼•ç”¨&gt; çš„æ˜ å°„ï¼Œæ¯ä¸ªçº¿ç¨‹å¾€ threadLocal ä¸­å¯¹ value è¿›è¡Œæ“ä½œæ—¶ï¼Œéƒ½æ˜¯åœ¨è‡ªå·±çº¿ç¨‹ç§æœ‰çš„ threadLocalMap ä¸­è¿›è¡Œæ“ä½œï¼Œä»è€Œè¾¾åˆ°çº¿ç¨‹éš”ç¦»ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadLocalDemo</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// private static final ThreadLocal&lt;Integer&gt; threadLocal = new ThreadLocal&lt;Integer&gt;()&#123;</span></span><br><span class=\"line\">    <span class=\"comment\">//     @Override</span></span><br><span class=\"line\">    <span class=\"comment\">//     protected Integer initialValue() &#123;</span></span><br><span class=\"line\">    <span class=\"comment\">//         return 0;</span></span><br><span class=\"line\">    <span class=\"comment\">//     &#125;</span></span><br><span class=\"line\">    <span class=\"comment\">// &#125;;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> ThreadLocal&lt;Integer&gt; threadLocal = ThreadLocal.withInitial(() -&gt; <span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">2</span>; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">                <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">j</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; j &lt; <span class=\"number\">5</span>; j++) &#123;</span><br><span class=\"line\">                    <span class=\"type\">Integer</span> <span class=\"variable\">val</span> <span class=\"operator\">=</span> threadLocal.get();</span><br><span class=\"line\">                    threadLocal.set(++val);</span><br><span class=\"line\">                    System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; ---- &quot;</span> + val);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;, <span class=\"string\">&quot;Thread-&quot;</span> + i).start();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            Thread.sleep(<span class=\"number\">10</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; ---- &quot;</span> + threadLocal.get());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>æ‰“å°ç»“æœï¼šå¯åŠ¨äº† 2 ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹æœ€åéƒ½æ‰“å°åˆ° 5ï¼Œ æœ€å threadLocal.get ä»ç„¶æ˜¯ 0</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Thread-<span class=\"number\">1</span> ---- <span class=\"number\">1</span></span><br><span class=\"line\">Thread-<span class=\"number\">0</span> ---- <span class=\"number\">1</span></span><br><span class=\"line\">Thread-<span class=\"number\">1</span> ---- <span class=\"number\">2</span></span><br><span class=\"line\">Thread-<span class=\"number\">0</span> ---- <span class=\"number\">2</span></span><br><span class=\"line\">Thread-<span class=\"number\">1</span> ---- <span class=\"number\">3</span></span><br><span class=\"line\">Thread-<span class=\"number\">1</span> ---- <span class=\"number\">4</span></span><br><span class=\"line\">Thread-<span class=\"number\">1</span> ---- <span class=\"number\">5</span></span><br><span class=\"line\">Thread-<span class=\"number\">0</span> ---- <span class=\"number\">3</span></span><br><span class=\"line\">Thread-<span class=\"number\">0</span> ---- <span class=\"number\">4</span></span><br><span class=\"line\">Thread-<span class=\"number\">0</span> ---- <span class=\"number\">5</span></span><br><span class=\"line\">main ---- <span class=\"number\">0</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"ThreadLocalå†…å­˜æ³„æ¼\"><a href=\"#ThreadLocalå†…å­˜æ³„æ¼\" class=\"headerlink\" title=\"ThreadLocalå†…å­˜æ³„æ¼\"></a>ThreadLocalå†…å­˜æ³„æ¼</h3><h4 id=\"ThreadLocalé€ æˆå†…å­˜æ³„æ¼çš„åŸå› ï¼Ÿ\"><a href=\"#ThreadLocalé€ æˆå†…å­˜æ³„æ¼çš„åŸå› ï¼Ÿ\" class=\"headerlink\" title=\"ThreadLocalé€ æˆå†…å­˜æ³„æ¼çš„åŸå› ï¼Ÿ\"></a>ThreadLocalé€ æˆå†…å­˜æ³„æ¼çš„åŸå› ï¼Ÿ</h4><p>ThreadLocalMap ä¸­ä½¿ç”¨çš„ key ä¸º ThreadLocal çš„å¼±å¼•ç”¨,è€Œ value æ˜¯å¼ºå¼•ç”¨ã€‚æ‰€ä»¥ï¼Œå¦‚æœ ThreadLocal æ²¡æœ‰è¢«å¤–éƒ¨å¼ºå¼•ç”¨çš„æƒ…å†µä¸‹ï¼Œåœ¨åƒåœ¾å›æ”¶çš„æ—¶å€™ï¼Œkey ä¼šè¢«æ¸…ç†æ‰ï¼Œè€Œ value ä¸ä¼šè¢«æ¸…ç†æ‰ã€‚è¿™æ ·ä¸€æ¥ï¼ŒThreadLocalMap ä¸­å°±ä¼šå‡ºç° key ä¸º null çš„ Entryã€‚å‡å¦‚æˆ‘ä»¬ä¸åšä»»ä½•æªæ–½çš„è¯ï¼Œvalue æ°¸è¿œæ— æ³•è¢« GC å›æ”¶ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯èƒ½ä¼šäº§ç”Ÿå†…å­˜æ³„éœ²ã€‚ThreadLocalMap å®ç°ä¸­å·²ç»è€ƒè™‘äº†è¿™ç§æƒ…å†µï¼Œæ¯æ¬¡ä½¿ç”¨å®Œ ThreadLocal åï¼Œéƒ½è°ƒç”¨å®ƒçš„ remove()æ–¹æ³•ï¼Œæ¸…ç†æ‰ key ä¸º null çš„è®°å½•ã€‚</p>\n<h3 id=\"BlockingQueue\"><a href=\"#BlockingQueue\" class=\"headerlink\" title=\"BlockingQueue\"></a>BlockingQueue</h3><p>é˜»å¡é˜Ÿåˆ—ï¼ˆBlockingQueueï¼‰æ˜¯ä¸€ä¸ªæ”¯æŒä¸¤ä¸ªé™„åŠ æ“ä½œçš„é˜Ÿåˆ—ã€‚</p>\n<p>åœ¨é˜Ÿåˆ—ä¸ºç©ºæ—¶ï¼Œè·å–å…ƒç´ çš„çº¿ç¨‹ä¼šç­‰å¾…é˜Ÿåˆ—å˜ä¸ºéç©ºã€‚å½“é˜Ÿåˆ—æ»¡æ—¶ï¼Œå­˜å‚¨å…ƒç´ çš„çº¿ç¨‹ä¼šç­‰å¾…é˜Ÿåˆ—å¯ç”¨ã€‚</p>\n<p>é˜»å¡é˜Ÿåˆ—å¸¸ç”¨äºç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„åœºæ™¯ï¼Œç”Ÿäº§è€…æ˜¯å¾€é˜Ÿåˆ—é‡Œæ·»åŠ å…ƒç´ çš„çº¿ç¨‹ï¼Œæ¶ˆè´¹è€…æ˜¯ä»é˜Ÿåˆ—é‡Œæ‹¿å…ƒç´ çš„çº¿ç¨‹ã€‚é˜»å¡é˜Ÿåˆ—å°±æ˜¯ç”Ÿäº§è€…å­˜æ”¾å…ƒç´ çš„å®¹å™¨ï¼Œè€Œæ¶ˆè´¹è€…ä¹Ÿåªä»å®¹å™¨é‡Œæ‹¿å…ƒç´ ã€‚</p>\n<p>JDK7 æä¾›äº† 7 ä¸ªé˜»å¡é˜Ÿåˆ—ã€‚åˆ†åˆ«æ˜¯ï¼š</p>\n<blockquote>\n<p>ArrayBlockingQueue ï¼šä¸€ä¸ªç”±æ•°ç»„ç»“æ„ç»„æˆçš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—ã€‚<br>LinkedBlockingQueue ï¼šä¸€ä¸ªç”±é“¾è¡¨ç»“æ„ç»„æˆçš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—ã€‚<br>PriorityBlockingQueue ï¼šä¸€ä¸ªæ”¯æŒä¼˜å…ˆçº§æ’åºçš„æ— ç•Œé˜»å¡é˜Ÿåˆ—ã€‚<br>DelayQueueï¼šä¸€ä¸ªä½¿ç”¨ä¼˜å…ˆçº§é˜Ÿåˆ—å®ç°çš„æ— ç•Œé˜»å¡é˜Ÿåˆ—ã€‚<br>SynchronousQueueï¼šä¸€ä¸ªä¸å­˜å‚¨å…ƒç´ çš„é˜»å¡é˜Ÿåˆ—ã€‚<br>LinkedTransferQueueï¼šä¸€ä¸ªç”±é“¾è¡¨ç»“æ„ç»„æˆçš„æ— ç•Œé˜»å¡é˜Ÿåˆ—ã€‚<br>LinkedBlockingDequeï¼šä¸€ä¸ªç”±é“¾è¡¨ç»“æ„ç»„æˆçš„åŒå‘é˜»å¡é˜Ÿåˆ—ã€‚</p>\n</blockquote>\n<p>Java 5 ä¹‹å‰å®ç°åŒæ­¥å­˜å–æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æ™®é€šçš„ä¸€ä¸ªé›†åˆï¼Œç„¶ååœ¨ä½¿ç”¨çº¿ç¨‹çš„åä½œå’Œçº¿ç¨‹åŒæ­¥å¯ä»¥å®ç°ç”Ÿäº§è€…ï¼Œæ¶ˆè´¹è€…æ¨¡å¼ï¼Œä¸»è¦çš„æŠ€æœ¯å°±æ˜¯ç”¨å¥½ waitï¼Œnotifyï¼ŒnotifyAllï¼Œsynchronized è¿™äº›å…³é”®å­—ã€‚è€Œåœ¨ Java 5 ä¹‹åï¼Œå¯ä»¥ä½¿ç”¨é˜»å¡é˜Ÿåˆ—æ¥å®ç°ï¼Œæ­¤æ–¹å¼å¤§å¤§ç®€å°‘äº†ä»£ç é‡ï¼Œä½¿å¾—å¤šçº¿ç¨‹ç¼–ç¨‹æ›´åŠ å®¹æ˜“ï¼Œå®‰å…¨æ–¹é¢ä¹Ÿæœ‰ä¿éšœã€‚</p>\n<p>BlockingQueue æ¥å£æ˜¯ Queue çš„å­æ¥å£ï¼Œå®ƒçš„ä¸»è¦ç”¨é€”å¹¶ä¸æ˜¯ä½œä¸ºå®¹å™¨ï¼Œè€Œæ˜¯ä½œä¸ºçº¿ç¨‹åŒæ­¥çš„çš„å·¥å…·ï¼Œå› æ­¤ä»–å…·æœ‰ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„ç‰¹æ€§ï¼Œ<strong>å½“ç”Ÿäº§è€…çº¿ç¨‹è¯•å›¾å‘ BlockingQueue æ”¾å…¥å…ƒç´ æ—¶ï¼Œå¦‚æœé˜Ÿåˆ—å·²æ»¡ï¼Œåˆ™çº¿ç¨‹è¢«é˜»å¡ï¼Œå½“æ¶ˆè´¹è€…çº¿ç¨‹è¯•å›¾ä»ä¸­å–å‡ºä¸€ä¸ªå…ƒç´ æ—¶ï¼Œå¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™è¯¥çº¿ç¨‹ä¼šè¢«é˜»å¡</strong>ï¼Œæ­£æ˜¯å› ä¸ºå®ƒæ‰€å…·æœ‰è¿™ä¸ªç‰¹æ€§ï¼Œæ‰€ä»¥åœ¨ç¨‹åºä¸­å¤šä¸ªçº¿ç¨‹äº¤æ›¿å‘ BlockingQueue ä¸­æ”¾å…¥å…ƒç´ ï¼Œå–å‡ºå…ƒç´ ï¼Œå®ƒå¯ä»¥å¾ˆå¥½çš„æ§åˆ¶çº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚</p>\n<h2 id=\"çº¿ç¨‹æ± \"><a href=\"#çº¿ç¨‹æ± \" class=\"headerlink\" title=\"çº¿ç¨‹æ± \"></a>çº¿ç¨‹æ± </h2><h3 id=\"Executors-åˆ›å»ºå››ç§å¸¸è§çº¿ç¨‹æ± \"><a href=\"#Executors-åˆ›å»ºå››ç§å¸¸è§çº¿ç¨‹æ± \" class=\"headerlink\" title=\"Executors åˆ›å»ºå››ç§å¸¸è§çº¿ç¨‹æ± \"></a>Executors åˆ›å»ºå››ç§å¸¸è§çº¿ç¨‹æ± </h3><h4 id=\"ä»€ä¹ˆæ˜¯çº¿ç¨‹æ± ï¼Ÿæœ‰å“ªå‡ ç§åˆ›å»ºæ–¹å¼ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯çº¿ç¨‹æ± ï¼Ÿæœ‰å“ªå‡ ç§åˆ›å»ºæ–¹å¼ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯çº¿ç¨‹æ± ï¼Ÿæœ‰å“ªå‡ ç§åˆ›å»ºæ–¹å¼ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯çº¿ç¨‹æ± ï¼Ÿæœ‰å“ªå‡ ç§åˆ›å»ºæ–¹å¼ï¼Ÿ</h4><blockquote>\n<p>æ± åŒ–æŠ€æœ¯çš„æ€æƒ³ä¸»è¦æ˜¯ä¸ºäº†å‡å°‘æ¯æ¬¡è·å–èµ„æºçš„æ¶ˆè€—ï¼Œæé«˜å¯¹èµ„æºçš„åˆ©ç”¨ç‡ã€‚</p>\n</blockquote>\n<p>åœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­ï¼Œåˆ›å»ºå’Œé”€æ¯å¯¹è±¡æ˜¯å¾ˆè´¹æ—¶é—´çš„ï¼Œå› ä¸ºåˆ›å»ºä¸€ä¸ªå¯¹è±¡è¦è·å–å†…å­˜èµ„æºæˆ–è€…å…¶å®ƒæ›´å¤šèµ„æºã€‚åœ¨ Java ä¸­æ›´æ˜¯å¦‚æ­¤ï¼Œè™šæ‹Ÿæœºå°†è¯•å›¾è·Ÿè¸ªæ¯ä¸€ä¸ªå¯¹è±¡ï¼Œä»¥ä¾¿èƒ½å¤Ÿåœ¨å¯¹è±¡é”€æ¯åè¿›è¡Œåƒåœ¾å›æ”¶ã€‚æ‰€ä»¥æé«˜æœåŠ¡ç¨‹åºæ•ˆç‡çš„ä¸€ä¸ªæ‰‹æ®µå°±æ˜¯<strong>å°½å¯èƒ½å‡å°‘åˆ›å»ºå’Œé”€æ¯å¯¹è±¡çš„æ¬¡æ•°</strong>ï¼Œç‰¹åˆ«æ˜¯ä¸€äº›å¾ˆè€—èµ„æºçš„å¯¹è±¡åˆ›å»ºå’Œé”€æ¯ï¼Œè¿™å°±æ˜¯â€æ± åŒ–èµ„æºâ€æŠ€æœ¯äº§ç”Ÿçš„åŸå› ã€‚</p>\n<p>çº¿ç¨‹æ± é¡¾åæ€ä¹‰å°±æ˜¯äº‹å…ˆåˆ›å»ºè‹¥å¹²ä¸ªå¯æ‰§è¡Œçš„çº¿ç¨‹æ”¾å…¥ä¸€ä¸ªæ± ï¼ˆå®¹å™¨ï¼‰ä¸­ï¼Œéœ€è¦çš„æ—¶å€™ä»æ± ä¸­è·å–çº¿ç¨‹ä¸ç”¨è‡ªè¡Œåˆ›å»ºï¼Œä½¿ç”¨å®Œæ¯•ä¸éœ€è¦é”€æ¯çº¿ç¨‹è€Œæ˜¯æ”¾å›æ± ä¸­ï¼Œä»è€Œå‡å°‘åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹å¯¹è±¡çš„å¼€é”€ã€‚Java 5+ä¸­çš„ Executor æ¥å£å®šä¹‰ä¸€ä¸ªæ‰§è¡Œçº¿ç¨‹çš„å·¥å…·ã€‚å®ƒçš„å­ç±»å‹å³çº¿ç¨‹æ± æ¥å£æ˜¯ ExecutorServiceã€‚è¦é…ç½®ä¸€ä¸ªçº¿ç¨‹æ± æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼Œå°¤å…¶æ˜¯å¯¹äºçº¿ç¨‹æ± çš„åŸç†ä¸æ˜¯å¾ˆæ¸…æ¥šçš„æƒ…å†µä¸‹ï¼Œå› æ­¤åœ¨å·¥å…·ç±» Executors é¢æä¾›äº†ä¸€äº›é™æ€å·¥å‚æ–¹æ³•ï¼Œç”Ÿæˆä¸€äº›å¸¸ç”¨çš„çº¿ç¨‹æ± ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>\n<p>ï¼ˆ1ï¼‰Executors.newSingleThreadExecutorï¼š<code>1, 1, new LinkedBlockingQueue</code>ã€‚æ‰€æœ‰ä»»åŠ¡æŒ‰ç…§<strong>å…ˆæ¥å…ˆæ‰§è¡Œ</strong>çš„é¡ºåºæ‰§è¡Œã€‚å¦‚æœè¿™ä¸ªå”¯ä¸€çš„çº¿ç¨‹ä¸ç©ºé—²ï¼Œé‚£ä¹ˆæ–°æ¥çš„ä»»åŠ¡ä¼šå­˜å‚¨åœ¨ä»»åŠ¡é˜Ÿåˆ—é‡Œç­‰å¾…æ‰§è¡Œã€‚ï¼ˆç”±äºé˜»å¡é˜Ÿåˆ—é»˜è®¤å¤§å°ä¸º Integer.MAX_VALUEï¼Œå› æ­¤å¯èƒ½ OOMï¼‰</p>\n<p>ï¼ˆ2ï¼‰Executors.newFixedThreadPoolï¼š<code>nCoreThreads, nCoreThreads, new LinkedBlockingQueue</code>ï¼Œæ‰€ä»¥åªèƒ½åˆ›å»ºæ ¸å¿ƒçº¿ç¨‹ï¼Œä¸èƒ½åˆ›å»ºéæ ¸å¿ƒçº¿ç¨‹ã€‚å› ä¸º LinkedBlockingQueue çš„é»˜è®¤å¤§å°æ˜¯ Integer.MAX_VALUEï¼Œæ•…å¦‚æœæ ¸å¿ƒçº¿ç¨‹ç©ºé—²ï¼Œåˆ™äº¤ç»™æ ¸å¿ƒçº¿ç¨‹å¤„ç†ï¼›å¦‚æœæ ¸å¿ƒçº¿ç¨‹ä¸ç©ºé—²ï¼Œåˆ™å…¥åˆ—ç­‰å¾…ï¼Œç›´åˆ°æ ¸å¿ƒçº¿ç¨‹ç©ºé—²ã€‚ï¼ˆç”±äºé˜»å¡é˜Ÿåˆ—é»˜è®¤å¤§å°ä¸º Integer.MAX_VALUEï¼Œå› æ­¤å¯èƒ½ OOMï¼‰</p>\n<p>ï¼ˆ3ï¼‰ Executors.newCachedThreadPoolï¼š<code>0, Integer.MAX_VALUE</code>ï¼Œä¸åˆ›å»ºæ ¸å¿ƒçº¿ç¨‹ï¼Œçº¿ç¨‹æ± æœ€å¤§ä¸º Integer.MAX_VALUEã€‚ï¼ˆçº¿ç¨‹æ± å¤ªå¤§å¯¼è‡´ OOMï¼‰</p>\n<p>newCachedThreadPool å’Œ newFixedThreadPool éƒ½å‡ ä¹ä¸ä¼šè§¦å‘æ‹’ç»ç­–ç•¥ï¼Œä½†æ˜¯åŸç†ä¸åŒã€‚<br>FixedThreadPool æ˜¯å› ä¸ºé˜»å¡é˜Ÿåˆ—å¯ä»¥å¾ˆå¤§ï¼ˆæœ€å¤§ä¸º Integer æœ€å¤§å€¼ï¼‰ï¼Œæ•…å‡ ä¹ä¸ä¼šè§¦å‘æ‹’ç»ç­–ç•¥ï¼›CachedThreadPool æ˜¯å› ä¸ºçº¿ç¨‹æ± å¾ˆå¤§ï¼ˆæœ€å¤§ä¸º Integer æœ€å¤§å€¼ï¼‰ï¼Œå‡ ä¹ä¸ä¼šå¯¼è‡´çº¿ç¨‹æ•°é‡å¤§äºæœ€å¤§çº¿ç¨‹æ•°ï¼Œæ•…å‡ ä¹ä¸ä¼šè§¦å‘æ‹’ç»ç­–ç•¥ã€‚</p>\n<p>ï¼ˆ4ï¼‰Executors.newScheduledThreadPoolï¼š<code>nCoreThreads, Integer.MAX_VALUE</code>åˆ›å»ºä¸€ä¸ªå¤§å°æ— é™çš„çº¿ç¨‹æ± ã€‚æ­¤çº¿ç¨‹æ± æ”¯æŒå®šæ—¶ä»¥åŠå‘¨æœŸæ€§æ‰§è¡Œä»»åŠ¡çš„éœ€æ±‚ã€‚</p>\n<h4 id=\"çº¿ç¨‹æ± æœ‰ä»€ä¹ˆä¼˜ç‚¹ï¼Ÿ\"><a href=\"#çº¿ç¨‹æ± æœ‰ä»€ä¹ˆä¼˜ç‚¹ï¼Ÿ\" class=\"headerlink\" title=\"çº¿ç¨‹æ± æœ‰ä»€ä¹ˆä¼˜ç‚¹ï¼Ÿ\"></a>çº¿ç¨‹æ± æœ‰ä»€ä¹ˆä¼˜ç‚¹ï¼Ÿ</h4><ul>\n<li>é™ä½èµ„æºæ¶ˆè€—ï¼šé‡ç”¨å­˜åœ¨çš„çº¿ç¨‹ï¼Œå‡å°‘å¯¹è±¡åˆ›å»ºé”€æ¯çš„å¼€é”€ï¼›</li>\n<li>æé«˜å“åº”é€Ÿåº¦ï¼šå½“ä»»åŠ¡åˆ°è¾¾æ—¶ï¼Œä»»åŠ¡å¯ä»¥ä¸éœ€è¦çš„ç­‰åˆ°çº¿ç¨‹åˆ›å»ºå°±èƒ½ç«‹å³æ‰§è¡Œï¼›</li>\n<li>æé«˜çº¿ç¨‹çš„å¯ç®¡ç†æ€§ï¼šä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥è¿›è¡Œç»Ÿä¸€çš„åˆ†é…ï¼Œè°ƒä¼˜å’Œç›‘æ§ã€‚</li>\n</ul>\n<h4 id=\"çº¿ç¨‹æ± éƒ½æœ‰å“ªäº›çŠ¶æ€ï¼Ÿ\"><a href=\"#çº¿ç¨‹æ± éƒ½æœ‰å“ªäº›çŠ¶æ€ï¼Ÿ\" class=\"headerlink\" title=\"çº¿ç¨‹æ± éƒ½æœ‰å“ªäº›çŠ¶æ€ï¼Ÿ\"></a>çº¿ç¨‹æ± éƒ½æœ‰å“ªäº›çŠ¶æ€ï¼Ÿ</h4><ul>\n<li>RUNNINGï¼šæ¥å—æ–°çš„ä»»åŠ¡æäº¤ï¼Œå¤„ç†ç­‰å¾…é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼›</li>\n<li>SHUTDOWNï¼šä¸æ¥å—æ–°çš„ä»»åŠ¡æäº¤ï¼Œä½†æ˜¯ä¼šç»§ç»­å¤„ç†ç­‰å¾…é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼›</li>\n<li>STOPï¼šä¸æ¥å—æ–°çš„ä»»åŠ¡æäº¤ï¼Œä¸å†å¤„ç†ç­‰å¾…é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼Œä¸­æ–­æ­£åœ¨æ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹ï¼›</li>\n<li>TIDYINGï¼šæ‰€æœ‰çš„ä»»åŠ¡éƒ½é”€æ¯äº†ï¼ŒworkCount ä¸º 0ï¼Œçº¿ç¨‹æ± çš„çŠ¶æ€åœ¨è½¬æ¢ä¸º TIDYING çŠ¶æ€æ—¶ï¼Œä¼šæ‰§è¡Œé’©å­æ–¹æ³• terminated()ï¼›</li>\n<li>TERMINATEDï¼šterminated()æ–¹æ³•ç»“æŸåï¼Œçº¿ç¨‹æ± çš„çŠ¶æ€å°±ä¼šå˜æˆè¿™ä¸ªã€‚</li>\n</ul>\n<h4 id=\"åœ¨-Java-ä¸­-Executor-å’Œ-Executors-çš„åŒºåˆ«ï¼Ÿ\"><a href=\"#åœ¨-Java-ä¸­-Executor-å’Œ-Executors-çš„åŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"åœ¨ Java ä¸­ Executor å’Œ Executors çš„åŒºåˆ«ï¼Ÿ\"></a>åœ¨ Java ä¸­ Executor å’Œ Executors çš„åŒºåˆ«ï¼Ÿ</h4><ul>\n<li><strong>Executors å·¥å…·ç±»</strong>çš„ä¸åŒæ–¹æ³•æŒ‰ç…§æˆ‘ä»¬çš„éœ€æ±‚<strong>åˆ›å»ºäº†ä¸åŒçš„çº¿ç¨‹æ± </strong>ï¼Œæ¥æ»¡è¶³ä¸šåŠ¡çš„éœ€æ±‚ï¼›</li>\n<li><strong>Executor æ¥å£å¯¹è±¡æ‰§è¡Œæˆ‘ä»¬çš„çº¿ç¨‹ä»»åŠ¡</strong>ï¼ŒExecutorService æ¥å£ç»§æ‰¿äº† Executor æ¥å£å¹¶è¿›è¡Œäº†æ‰©å±•ï¼Œæä¾›äº†æ›´å¤šçš„æ–¹æ³•æˆ‘ä»¬èƒ½è·å¾—ä»»åŠ¡æ‰§è¡Œçš„çŠ¶æ€å¹¶ä¸”å¯ä»¥è·å–ä»»åŠ¡çš„è¿”å›å€¼ã€‚</li>\n</ul>\n<h4 id=\"çº¿ç¨‹æ± ä¸­-submit-å’Œ-execute-æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"><a href=\"#çº¿ç¨‹æ± ä¸­-submit-å’Œ-execute-æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"çº¿ç¨‹æ± ä¸­ submit() å’Œ execute() æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"></a>çº¿ç¨‹æ± ä¸­ submit() å’Œ execute() æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h4><p>æ¥æ”¶å‚æ•°ï¼šsubmit() å¯ä»¥æ‰§è¡Œ Runnable å’Œ Callable ç±»å‹çš„ä»»åŠ¡ï¼Œè€Œ execute()åªèƒ½æ‰§è¡Œ Runnable ç±»å‹çš„ä»»åŠ¡ï¼›</p>\n<p>è¿”å›å€¼ï¼šsubmit() æ–¹æ³•å¯ä»¥è¿”å›æŒæœ‰è®¡ç®—ç»“æœçš„ Future å¯¹è±¡ï¼Œè€Œ execute() æ²¡æœ‰ï¼›</p>\n<p>å¼‚å¸¸å¤„ç†ï¼šsubmit() æ–¹ä¾¿ Exception å¤„ç†ã€‚</p>\n<h3 id=\"ThreadPoolExecutor-è‡ªå®šä¹‰çº¿ç¨‹æ± \"><a href=\"#ThreadPoolExecutor-è‡ªå®šä¹‰çº¿ç¨‹æ± \" class=\"headerlink\" title=\"ThreadPoolExecutor è‡ªå®šä¹‰çº¿ç¨‹æ± \"></a>ThreadPoolExecutor è‡ªå®šä¹‰çº¿ç¨‹æ± </h3><h4 id=\"Executors\"><a href=\"#Executors\" class=\"headerlink\" title=\"Executors\"></a>Executors</h4><p>ã€Šé˜¿é‡Œå·´å·´ Java å¼€å‘æ‰‹å†Œã€‹ä¸­å¼ºåˆ¶çº¿ç¨‹æ± ä¸å…è®¸ä½¿ç”¨ Executors å»åˆ›å»ºï¼Œè€Œæ˜¯<strong>é€šè¿‡ ThreadPoolExecutor çš„æ–¹å¼</strong>ï¼Œè¿™æ ·çš„å¤„ç†æ–¹å¼è®©å†™çš„åŒå­¦<strong>æ›´åŠ æ˜ç¡®çº¿ç¨‹æ± çš„è¿è¡Œè§„åˆ™ï¼Œè§„é¿èµ„æºè€—å°½çš„é£é™©</strong></p>\n<p>Executors å„ä¸ªæ–¹æ³•çš„å¼Šç«¯ï¼š</p>\n<ul>\n<li><p>newSingleThreadExecutor å’Œ newFixedThreadPool :<br>  <code>0, 0</code>å’Œ <code>n, n</code> ï¼Œä½†æ˜¯ä½¿ç”¨ LinkedBlockingQueueï¼Œæœ€å¤§å¯ä»¥ä¸º Integer.MAX_VALUE</p>\n<p>  ä¸»è¦é—®é¢˜æ˜¯å †ç§¯çš„è¯·æ±‚å¤„ç†é˜Ÿåˆ—å¯èƒ½ä¼šè€—è´¹éå¸¸å¤§çš„å†…å­˜ï¼Œç”šè‡³ OOMã€‚</p>\n</li>\n<li><p>newCachedThreadPool å’Œ newScheduledThreadPool:<br>  <code>0, Integer.MAX_VALUE</code> å’Œ <code>n, Integer.MAX_VALUE</code></p>\n<p>  ä¸»è¦é—®é¢˜æ˜¯çº¿ç¨‹æ•°æœ€å¤§æ•°æ˜¯ Integer.MAX_VALUEï¼Œå¯èƒ½ä¼šåˆ›å»ºæ•°é‡éå¸¸å¤šçš„çº¿ç¨‹ï¼Œç”šè‡³ OOM</p>\n</li>\n</ul>\n<p>ThreaPoolExecutor åˆ›å»ºçº¿ç¨‹æ± æ–¹å¼åªæœ‰ä¸€ç§ï¼Œå°±æ˜¯èµ°å®ƒçš„æ„é€ å‡½æ•°ï¼Œå‚æ•°è‡ªå·±æŒ‡å®š</p>\n<h4 id=\"ThreaPoolExecutor\"><a href=\"#ThreaPoolExecutor\" class=\"headerlink\" title=\"ThreaPoolExecutor\"></a>ThreaPoolExecutor</h4><p>åˆ›å»ºçº¿ç¨‹æ± çš„æ–¹å¼æœ‰å¤šç§ï¼Œè¿™é‡Œä½ åªéœ€è¦ç­” ThreadPoolExecutor å³å¯ã€‚</p>\n<p>ThreadPoolExecutor() æ˜¯æœ€åŸå§‹çš„çº¿ç¨‹æ± åˆ›å»ºï¼Œä¹Ÿæ˜¯é˜¿é‡Œå·´å·´ Java å¼€å‘æ‰‹å†Œä¸­æ˜ç¡®è§„èŒƒçš„åˆ›å»ºçº¿ç¨‹æ± çš„æ–¹å¼ã€‚</p>\n<h4 id=\"ThreadPoolExecutoræ„é€ å‡½æ•°é‡è¦å‚æ•°åˆ†æ\"><a href=\"#ThreadPoolExecutoræ„é€ å‡½æ•°é‡è¦å‚æ•°åˆ†æ\" class=\"headerlink\" title=\"ThreadPoolExecutoræ„é€ å‡½æ•°é‡è¦å‚æ•°åˆ†æ\"></a>ThreadPoolExecutoræ„é€ å‡½æ•°é‡è¦å‚æ•°åˆ†æ</h4><p><strong><code>ThreadPoolExecutor</code></strong> <strong>3 ä¸ªæœ€é‡è¦çš„å‚æ•°ï¼š</strong></p>\n<ul>\n<li><strong><code>corePoolSize</code></strong> ï¼šæ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œçº¿ç¨‹æ•°å®šä¹‰äº†æœ€å°å¯ä»¥åŒæ—¶è¿è¡Œçš„çº¿ç¨‹æ•°é‡</li>\n<li><strong><code>maximumPoolSize</code></strong> ï¼šçº¿ç¨‹æ± ä¸­å…è®¸å­˜åœ¨çš„å·¥ä½œçº¿ç¨‹çš„æœ€å¤§æ•°é‡</li>\n<li>**<code>workQueue</code>**ï¼šå½“æ–°ä»»åŠ¡æ¥çš„æ—¶å€™ä¼šå…ˆåˆ¤æ–­å½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°é‡æ˜¯å¦è¾¾åˆ°æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œå¦‚æœè¾¾åˆ°çš„è¯ï¼Œä»»åŠ¡å°±ä¼šè¢«å­˜æ”¾åœ¨ç­‰å¾…é˜Ÿåˆ—ä¸­</li>\n</ul>\n<p><code>ThreadPoolExecutor</code>å…¶ä»–å¸¸è§å‚æ•°:</p>\n<ol>\n<li>**<code>keepAliveTime</code>**ï¼šéæ ¸å¿ƒçº¿ç¨‹å¦‚æœå¤„äºé—²ç½®çŠ¶æ€è¶…è¿‡è¯¥å€¼ï¼Œå°±ä¼šè¢«é”€æ¯ã€‚</li>\n<li><strong><code>unit</code></strong> ï¼š<code>keepAliveTime</code> é—²ç½®é”€æ¯æ—¶é•¿çš„æ—¶é—´å•ä½</li>\n<li>**<code>threadFactory</code>**ï¼šä¸ºçº¿ç¨‹æ± æä¾›åˆ›å»ºæ–°çº¿ç¨‹çš„çº¿ç¨‹å·¥å‚</li>\n<li><strong><code>handler</code></strong> ï¼šçº¿ç¨‹æ± ä»»åŠ¡é˜Ÿåˆ—è¶…è¿‡ maxinumPoolSize ä¹‹åçš„æ‹’ç»ç­–ç•¥</li>\n</ol>\n<h4 id=\"ThreadPoolExecutoræ‹’ç»ç­–ç•¥\"><a href=\"#ThreadPoolExecutoræ‹’ç»ç­–ç•¥\" class=\"headerlink\" title=\"ThreadPoolExecutoræ‹’ç»ç­–ç•¥\"></a>ThreadPoolExecutoræ‹’ç»ç­–ç•¥</h4><p><strong><code>ThreadPoolExecutor</code></strong> <strong>æ‹’ç»ç­–ç•¥å®šä¹‰:</strong></p>\n<p>å¦‚æœå½“å‰åŒæ—¶è¿è¡Œçš„çº¿ç¨‹æ•°é‡è¾¾åˆ°æœ€å¤§çº¿ç¨‹æ•°é‡å¹¶ä¸”ç­‰å¾…é˜Ÿåˆ—ä¹Ÿå·²ç»è¢«æ”¾æ»¡æ—¶ï¼Œ<code>ThreadPoolTaskExecutor</code> å®šä¹‰ä¸€äº›ç­–ç•¥:</p>\n<ul>\n<li>**<code>ThreadPoolExecutor.AbortPolicy</code>**ï¼šæŠ›å‡º <code>RejectedExecutionException</code>æ¥æ‹’ç»æ–°ä»»åŠ¡çš„å¤„ç†ã€‚</li>\n<li>**<code>ThreadPoolExecutor.CallerRunsPolicy</code>**ï¼šè°ƒç”¨æ‰§è¡Œè‡ªå·±çš„çº¿ç¨‹è¿è¡Œä»»åŠ¡ã€‚</li>\n<li>**<code>ThreadPoolExecutor.DiscardPolicy</code>**ï¼šä¸å¤„ç†æ–°ä»»åŠ¡ï¼Œç›´æ¥ä¸¢å¼ƒæ‰ã€‚</li>\n<li>**<code>ThreadPoolExecutor.DiscardOldestPolicy</code>**ï¼š æ­¤ç­–ç•¥å°†ä¸¢å¼ƒæœ€æ—©çš„æœªå¤„ç†çš„ä»»åŠ¡è¯·æ±‚ã€‚</li>\n</ul>\n<h4 id=\"ä¸€ä¸ªç®€å•çš„çº¿ç¨‹æ± Demo-Runnable-ThreadPoolExecutor\"><a href=\"#ä¸€ä¸ªç®€å•çš„çº¿ç¨‹æ± Demo-Runnable-ThreadPoolExecutor\" class=\"headerlink\" title=\"ä¸€ä¸ªç®€å•çš„çº¿ç¨‹æ± Demo:Runnable + ThreadPoolExecutor\"></a>ä¸€ä¸ªç®€å•çš„çº¿ç¨‹æ± Demo:<code>Runnable</code> + <code>ThreadPoolExecutor</code></h4><p>çº¿ç¨‹æ± å®ç°åŸç†</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOS8xMS8yNS8xNmVhMDQ3NjEyOTVlNzY2.png\" alt=\"çº¿ç¨‹æ± å®ç°åŸç†\"></p>\n<p><strong>æ€»ç»“ä¸€ä¸‹å¤„ç†æµç¨‹</strong></p>\n<ol>\n<li>çº¿ç¨‹æ€»æ•°é‡ &lt; corePoolSizeï¼Œæ— è®ºçº¿ç¨‹æ˜¯å¦ç©ºé—²ï¼Œéƒ½ä¼šæ–°å»ºä¸€ä¸ªæ ¸å¿ƒçº¿ç¨‹æ‰§è¡Œä»»åŠ¡ï¼ˆè®©æ ¸å¿ƒçº¿ç¨‹æ•°é‡å¿«é€Ÿè¾¾åˆ° corePoolSizeï¼Œåœ¨æ ¸å¿ƒçº¿ç¨‹æ•°é‡ &lt; corePoolSize æ—¶ï¼‰ã€‚<strong>æ³¨æ„ï¼Œè¿™ä¸€æ­¥éœ€è¦è·å¾—å…¨å±€é”ã€‚</strong></li>\n<li>çº¿ç¨‹æ€»æ•°é‡ &gt;&#x3D; corePoolSize æ—¶ï¼Œæ–°æ¥çš„çº¿ç¨‹ä»»åŠ¡ä¼šè¿›å…¥ç­‰å¾…é˜Ÿåˆ—ä¸­ç­‰å¾…ï¼Œç„¶åç©ºé—²çš„æ ¸å¿ƒçº¿ç¨‹ä¼šä¾æ¬¡å»ç¼“å­˜é˜Ÿåˆ—ä¸­å–ä»»åŠ¡æ¥æ‰§è¡Œï¼ˆä½“ç°äº†<strong>çº¿ç¨‹å¤ç”¨</strong>ï¼‰ã€‚ </li>\n<li>å½“ç­‰å¾…é˜Ÿåˆ—æ»¡äº†ï¼Œè¯´æ˜è¿™ä¸ªæ—¶å€™ä»»åŠ¡å·²ç»å¤šåˆ°çˆ†æ£šï¼Œéœ€è¦ä¸€äº›â€œä¸´æ—¶å·¥â€æ¥æ‰§è¡Œè¿™äº›ä»»åŠ¡äº†ã€‚äºæ˜¯ä¼šåˆ›å»ºéæ ¸å¿ƒçº¿ç¨‹å»æ‰§è¡Œè¿™ä¸ªä»»åŠ¡ã€‚<strong>æ³¨æ„ï¼Œè¿™ä¸€æ­¥éœ€è¦è·å¾—å…¨å±€é”ã€‚</strong></li>\n<li>ç¼“å­˜é˜Ÿåˆ—ä¹‹å‰æ»¡äº†ï¼Œ ç°åœ¨åŠ éæ ¸å¿ƒçº¿ç¨‹ä¸”æ€»çº¿ç¨‹æ•°è¾¾åˆ°äº† maximumPoolSizeï¼Œåˆ™ä¼šé‡‡å–ä¸Šé¢æåˆ°çš„æ‹’ç»ç­–ç•¥è¿›è¡Œå¤„ç†ã€‚</li>\n</ol>\n<p>æ•´ä¸ªè¿‡ç¨‹å¦‚å›¾æ‰€ç¤ºï¼š</p>\n<p>ä¸ºäº†è®©å¤§å®¶æ›´æ¸…æ¥šä¸Šé¢çš„é¢è¯•é¢˜ä¸­çš„ä¸€äº›æ¦‚å¿µï¼Œæˆ‘å†™äº†ä¸€ä¸ªç®€å•çš„çº¿ç¨‹æ±  Demoã€‚</p>\n<p>é¦–å…ˆåˆ›å»ºä¸€ä¸ª <code>Runnable</code> æ¥å£çš„å®ç°ç±»ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥æ˜¯ <code>Callable</code> æ¥å£ï¼Œæˆ‘ä»¬ä¸Šé¢ä¹Ÿè¯´äº†ä¸¤è€…çš„åŒºåˆ«ã€‚ï¼‰</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> Java.util.Date;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * è¿™æ˜¯ä¸€ä¸ªç®€å•çš„Runnableç±»ï¼Œéœ€è¦å¤§çº¦5ç§’é’Ÿæ¥æ‰§è¡Œå…¶ä»»åŠ¡ã€‚</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyRunnable</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Runnable</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String command;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">MyRunnable</span><span class=\"params\">(String s)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.command = s;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; Start. Time = &quot;</span> + <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>());</span><br><span class=\"line\">        processCommand();</span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; End. Time = &quot;</span> + <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">processCommand</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            Thread.sleep(<span class=\"number\">5000</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">toString</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.command;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>ç¼–å†™æµ‹è¯•ç¨‹åºï¼Œæˆ‘ä»¬è¿™é‡Œä»¥é˜¿é‡Œå·´å·´æ¨èçš„ä½¿ç”¨ <code>ThreadPoolExecutor</code> æ„é€ å‡½æ•°è‡ªå®šä¹‰å‚æ•°çš„æ–¹å¼æ¥åˆ›å»ºçº¿ç¨‹æ± ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> Java.util.concurrent.ArrayBlockingQueue;</span><br><span class=\"line\"><span class=\"keyword\">import</span> Java.util.concurrent.ThreadPoolExecutor;</span><br><span class=\"line\"><span class=\"keyword\">import</span> Java.util.concurrent.TimeUnit;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadPoolExecutorDemo</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">CORE_POOL_SIZE</span> <span class=\"operator\">=</span> <span class=\"number\">5</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">MAX_POOL_SIZE</span> <span class=\"operator\">=</span> <span class=\"number\">10</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">QUEUE_CAPACITY</span> <span class=\"operator\">=</span> <span class=\"number\">100</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">Long</span> <span class=\"variable\">KEEP_ALIVE_TIME</span> <span class=\"operator\">=</span> <span class=\"number\">1L</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//ä½¿ç”¨é˜¿é‡Œå·´å·´æ¨èçš„åˆ›å»ºçº¿ç¨‹æ± çš„æ–¹å¼</span></span><br><span class=\"line\">        <span class=\"comment\">//é€šè¿‡ThreadPoolExecutoræ„é€ å‡½æ•°è‡ªå®šä¹‰å‚æ•°åˆ›å»º</span></span><br><span class=\"line\">        <span class=\"type\">ThreadPoolExecutor</span> <span class=\"variable\">executor</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ThreadPoolExecutor</span>(</span><br><span class=\"line\">                CORE_POOL_SIZE,</span><br><span class=\"line\">                MAX_POOL_SIZE,</span><br><span class=\"line\">                KEEP_ALIVE_TIME,</span><br><span class=\"line\">                TimeUnit.SECONDS,</span><br><span class=\"line\">                <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayBlockingQueue</span>&lt;&gt;(QUEUE_CAPACITY),</span><br><span class=\"line\">                <span class=\"keyword\">new</span> <span class=\"title class_\">ThreadPoolExecutor</span>.CallerRunsPolicy());</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++) &#123;</span><br><span class=\"line\">            <span class=\"comment\">//åˆ›å»ºWorkerThreadå¯¹è±¡ï¼ˆWorkerThreadç±»å®ç°äº†Runnable æ¥å£ï¼‰</span></span><br><span class=\"line\">            <span class=\"type\">Runnable</span> <span class=\"variable\">worker</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MyRunnable</span>(<span class=\"string\">&quot;&quot;</span> + i);</span><br><span class=\"line\">            <span class=\"comment\">//æ‰§è¡ŒRunnable</span></span><br><span class=\"line\">            executor.execute(worker);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">//ç»ˆæ­¢çº¿ç¨‹æ± </span></span><br><span class=\"line\">        executor.shutdown();</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (!executor.isTerminated()) &#123;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;Finished all threads&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä¸Šé¢çš„ä»£ç æŒ‡å®šäº†ï¼š</p>\n<ol>\n<li><code>corePoolSize</code>: æ ¸å¿ƒçº¿ç¨‹æ•°ä¸º 5ã€‚</li>\n<li><code>maximumPoolSize</code> ï¼šæœ€å¤§çº¿ç¨‹æ•° 10</li>\n<li><code>keepAliveTime</code> : ç­‰å¾…æ—¶é—´ä¸º 1Lã€‚</li>\n<li><code>unit</code>: ç­‰å¾…æ—¶é—´çš„å•ä½ä¸º TimeUnit.SECONDSã€‚</li>\n<li><code>workQueue</code>ï¼šä»»åŠ¡é˜Ÿåˆ—ä¸º <code>ArrayBlockingQueue</code>ï¼Œå¹¶ä¸”å®¹é‡ä¸º 100;</li>\n<li><code>handler</code>:é¥±å’Œç­–ç•¥ä¸º <code>CallerRunsPolicy</code>ã€‚</li>\n</ol>\n<p><strong>Outputï¼š</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">2</span> Start. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">44</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">5</span> Start. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">44</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">4</span> Start. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">44</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">1</span> Start. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">44</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">3</span> Start. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">44</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">5</span> End. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">49</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">3</span> End. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">49</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">2</span> End. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">49</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">4</span> End. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">49</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">1</span> End. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">49</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">2</span> Start. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">49</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">1</span> Start. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">49</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">4</span> Start. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">49</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">3</span> Start. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">49</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">5</span> Start. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">49</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">2</span> End. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">54</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">3</span> End. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">54</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">4</span> End. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">54</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">5</span> End. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">54</span> CST <span class=\"number\">2019</span></span><br><span class=\"line\">pool-<span class=\"number\">1</span>-thread-<span class=\"number\">1</span> End. Time = Tue Nov <span class=\"number\">12</span> <span class=\"number\">20</span>:<span class=\"number\">59</span>:<span class=\"number\">54</span> CST <span class=\"number\">2019</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"å¹¶å‘å·¥å…·\"><a href=\"#å¹¶å‘å·¥å…·\" class=\"headerlink\" title=\"å¹¶å‘å·¥å…·\"></a>å¹¶å‘å·¥å…·</h2><h3 id=\"CountDownLatch-ä¸-CyclicBarrier\"><a href=\"#CountDownLatch-ä¸-CyclicBarrier\" class=\"headerlink\" title=\"CountDownLatch ä¸ CyclicBarrier\"></a>CountDownLatch ä¸ CyclicBarrier</h3><p>CountDownLatch ä¸ CyclicBarrier éƒ½æ˜¯ç”¨äºæ§åˆ¶å¹¶å‘çš„å·¥å…·ç±»ï¼Œéƒ½å¯ä»¥ç†è§£æˆç»´æŠ¤çš„å°±æ˜¯ä¸€ä¸ªè®¡æ•°å™¨ï¼Œä½†æ˜¯è¿™ä¸¤è€…è¿˜æ˜¯å„æœ‰ä¸åŒä¾§é‡ç‚¹çš„ï¼š</p>\n<ul>\n<li>CountDownLatch å¼ºè°ƒä¸€ä¸ªçº¿ç¨‹ç­‰å¤šä¸ªçº¿ç¨‹å®ŒæˆæŸä»¶äº‹æƒ…ã€‚CyclicBarrier æ˜¯å¤šä¸ªçº¿ç¨‹äº’ç­‰ï¼Œç­‰å¤§å®¶éƒ½å®Œæˆï¼Œå†æºæ‰‹å…±è¿›ï¼›</li>\n<li>è°ƒç”¨ CountDownLatch çš„ countDown æ–¹æ³•åï¼Œå½“å‰çº¿ç¨‹å¹¶ä¸ä¼šé˜»å¡ï¼Œä¼šç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼›è€Œè°ƒç”¨ CyclicBarrier çš„ await æ–¹æ³•ï¼Œä¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼Œç›´åˆ° CyclicBarrier æŒ‡å®šçš„çº¿ç¨‹å…¨éƒ¨éƒ½åˆ°è¾¾äº†æŒ‡å®šç‚¹çš„æ—¶å€™ï¼Œæ‰èƒ½ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼›</li>\n<li>CountDownLatch æ˜¯ä¸èƒ½å¤ç”¨çš„ï¼Œè€Œ CyclicBarrier æ˜¯å¯ä»¥å¤ç”¨çš„ã€‚</li>\n</ul>\n<h3 id=\"Semaphore\"><a href=\"#Semaphore\" class=\"headerlink\" title=\"Semaphore\"></a>Semaphore</h3><p><strong>Semaphore(ä¿¡å·é‡)-å…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®ï¼š</strong> synchronized å’Œ ReentrantLock éƒ½æ˜¯ä¸€æ¬¡åªå…è®¸ä¸€ä¸ªçº¿ç¨‹è®¿é—®æŸä¸ªèµ„æºï¼ŒSemaphore(ä¿¡å·é‡)å¯ä»¥æŒ‡å®šå¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®æŸä¸ªèµ„æºã€‚</p>\n<p>Semaphore å°±æ˜¯ä¸€ä¸ªä¿¡å·é‡ï¼Œå®ƒçš„ä½œç”¨æ˜¯é™åˆ¶æŸæ®µä»£ç å—çš„å¹¶å‘æ•°ã€‚Semaphore æœ‰ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå¯ä»¥ä¼ å…¥ä¸€ä¸ª int å‹æ•´æ•° nï¼Œè¡¨ç¤ºæŸæ®µä»£ç æœ€å¤šåªæœ‰ n ä¸ªçº¿ç¨‹å¯ä»¥è®¿é—®ï¼Œå¦‚æœè¶…å‡ºäº† nï¼Œé‚£ä¹ˆè¯·ç­‰å¾…ï¼Œç­‰åˆ°æŸä¸ªçº¿ç¨‹æ‰§è¡Œå®Œæ¯•è¿™æ®µä»£ç å—ï¼Œä¸‹ä¸€ä¸ªçº¿ç¨‹å†è¿›å…¥ã€‚ç”±æ­¤å¯ä»¥çœ‹å‡ºå¦‚æœ Semaphore æ„é€ å‡½æ•°ä¸­ä¼ å…¥çš„ int å‹æ•´æ•° n&#x3D;1ï¼Œç›¸å½“äºå˜æˆäº†ä¸€ä¸ª synchronized äº†ã€‚</p>\n<h2 id=\"æ¨¡æ‹Ÿ\"><a href=\"#æ¨¡æ‹Ÿ\" class=\"headerlink\" title=\"æ¨¡æ‹Ÿ\"></a>æ¨¡æ‹Ÿ</h2><h3 id=\"æ­»é”\"><a href=\"#æ­»é”\" class=\"headerlink\" title=\"æ­»é”\"></a>æ­»é”</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">DeadLock</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">Object</span> <span class=\"variable\">A</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>();</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">Object</span> <span class=\"variable\">B</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">synchronized</span> (A) &#123;</span><br><span class=\"line\">                System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; å·²è·å¾—èµ„æºA&quot;</span>);</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; ç­‰å¾…è·å¾—èµ„æºB&quot;</span>);</span><br><span class=\"line\">                <span class=\"keyword\">synchronized</span> (B) &#123;</span><br><span class=\"line\">                    System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; å·²è·å¾—èµ„æºB&quot;</span>);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;çº¿ç¨‹1&quot;</span>).start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">synchronized</span> (B) &#123;</span><br><span class=\"line\">                System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; å·²è·å¾—èµ„æºB&quot;</span>);</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; ç­‰å¾…è·å¾—èµ„æºA&quot;</span>);</span><br><span class=\"line\">                <span class=\"keyword\">synchronized</span> (A) &#123;</span><br><span class=\"line\">                    System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; å·²è·å¾—èµ„æºA&quot;</span>);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;çº¿ç¨‹2&quot;</span>).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>çº¿ç¨‹1 å·²è·å¾—èµ„æºA<br>çº¿ç¨‹2 å·²è·å¾—èµ„æºB<br>çº¿ç¨‹1 ç­‰å¾…è·å¾—èµ„æºB<br>çº¿ç¨‹2 ç­‰å¾…è·å¾—èµ„æºA</p>\n</blockquote>\n<h3 id=\"runæ–¹æ³•å’Œstartæ–¹æ³•\"><a href=\"#runæ–¹æ³•å’Œstartæ–¹æ³•\" class=\"headerlink\" title=\"runæ–¹æ³•å’Œstartæ–¹æ³•\"></a>runæ–¹æ³•å’Œstartæ–¹æ³•</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">DiffStartRun</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            System.out.println(Thread.currentThread().getName());</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;çº¿ç¨‹A&quot;</span>).run();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            System.out.println(Thread.currentThread().getName());</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;çº¿ç¨‹B&quot;</span>).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>main<br>çº¿ç¨‹B</p>\n<p>new ä¸€ä¸ª Threadï¼Œçº¿ç¨‹è¿›å…¥äº†æ–°å»ºçŠ¶æ€ã€‚è°ƒç”¨ <code>start()</code>æ–¹æ³•ï¼Œä¼šå¯åŠ¨ä¸€ä¸ªçº¿ç¨‹å¹¶ä½¿çº¿ç¨‹è¿›å…¥äº†å°±ç»ªçŠ¶æ€ï¼Œå½“åˆ†é…åˆ°æ—¶é—´ç‰‡åå°±å¯ä»¥å¼€å§‹è¿è¡Œäº†ã€‚ <code>start()</code> ä¼šæ‰§è¡Œçº¿ç¨‹çš„ç›¸åº”å‡†å¤‡å·¥ä½œï¼Œç„¶åè‡ªåŠ¨æ‰§è¡Œ <code>run()</code> æ–¹æ³•çš„å†…å®¹ï¼Œè¿™æ˜¯çœŸæ­£çš„å¤šçº¿ç¨‹å·¥ä½œã€‚ ä½†æ˜¯ï¼Œç›´æ¥æ‰§è¡Œ <code>run()</code> æ–¹æ³•ï¼Œä¼šæŠŠ <code>run()</code> æ–¹æ³•å½“æˆä¸€ä¸ª main çº¿ç¨‹ä¸‹çš„æ™®é€šæ–¹æ³•å»æ‰§è¡Œï¼Œå¹¶ä¸ä¼šåœ¨æŸä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œå®ƒï¼Œç¬¬ä¸€ä¸ªæ‰€è°“çš„çº¿ç¨‹Aåªæ˜¯ main çº¿ç¨‹çš„ä¸€ä¸ªæ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´å…¶æ‰€åœ¨çº¿ç¨‹è¿˜æ˜¯ main çº¿ç¨‹ï¼Œæ‰€ä»¥è¿™å¹¶ä¸æ˜¯å¤šçº¿ç¨‹å·¥ä½œã€‚</p>\n<p><strong>æ€»ç»“ï¼š è°ƒç”¨ start() æ–¹æ³•æ–¹å¯å¯åŠ¨çº¿ç¨‹å¹¶ä½¿çº¿ç¨‹è¿›å…¥å°±ç»ªçŠ¶æ€ï¼Œç›´æ¥æ‰§è¡Œ run() æ–¹æ³•çš„è¯ä¸ä¼šä»¥å¤šçº¿ç¨‹çš„æ–¹å¼æ‰§è¡Œã€‚</strong></p>\n</blockquote>\n<h3 id=\"ä¸¤ä¸ªçº¿ç¨‹ï¼Œäº¤æ›¿åŠ å‡\"><a href=\"#ä¸¤ä¸ªçº¿ç¨‹ï¼Œäº¤æ›¿åŠ å‡\" class=\"headerlink\" title=\"ä¸¤ä¸ªçº¿ç¨‹ï¼Œäº¤æ›¿åŠ å‡\"></a>ä¸¤ä¸ªçº¿ç¨‹ï¼Œäº¤æ›¿åŠ å‡</h3><ol>\n<li><p>synchronized</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> fangyaxing</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@date</span> 2022/9/12</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">TwoThreadWithSync</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"variable\">value</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">Object</span> <span class=\"variable\">lock</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">5</span>; i++) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">synchronized</span> (lock) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">while</span> (value != <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                            lock.wait();</span><br><span class=\"line\">                        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                            e.printStackTrace();</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    value++;</span><br><span class=\"line\">                    System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; ---- &quot;</span> + value);</span><br><span class=\"line\">                    lock.notifyAll();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;Thread-A&quot;</span>).start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">5</span>; i++) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">synchronized</span> (lock) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">while</span> (value != <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">                        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                            lock.wait();</span><br><span class=\"line\">                        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                            e.printStackTrace();</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    value--;</span><br><span class=\"line\">                    System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; ---- &quot;</span> + value);</span><br><span class=\"line\">                    lock.notifyAll();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;Thread-B&quot;</span>).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>lock + condition</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> fangyaxing</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@date</span> 2022/9/12</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">TwoThreadWithLock</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"variable\">value</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">Lock</span> <span class=\"variable\">lock</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ReentrantLock</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"type\">Condition</span> <span class=\"variable\">a</span> <span class=\"operator\">=</span> lock.newCondition();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"type\">Condition</span> <span class=\"variable\">b</span> <span class=\"operator\">=</span> lock.newCondition();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">5</span>; i++) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    lock.lock();</span><br><span class=\"line\">                    <span class=\"keyword\">while</span> (value != <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                        a.await();</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    value++;</span><br><span class=\"line\">                    System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; ---- &quot;</span> + value);</span><br><span class=\"line\">                    b.signal();</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">                    lock.unlock();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;Thread-A&quot;</span>).start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">5</span>; i++) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    lock.lock();</span><br><span class=\"line\">                    <span class=\"keyword\">while</span> (value != <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">                        b.await();</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    value--;</span><br><span class=\"line\">                    System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; ---- &quot;</span> + value);</span><br><span class=\"line\">                    a.signal();</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">                    lock.unlock();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;Thread-B&quot;</span>).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n</ol>\n<h3 id=\"ä¸‰ä¸ªçº¿ç¨‹ï¼Œå¾ªç¯æ‰“å°\"><a href=\"#ä¸‰ä¸ªçº¿ç¨‹ï¼Œå¾ªç¯æ‰“å°\" class=\"headerlink\" title=\"ä¸‰ä¸ªçº¿ç¨‹ï¼Œå¾ªç¯æ‰“å°\"></a>ä¸‰ä¸ªçº¿ç¨‹ï¼Œå¾ªç¯æ‰“å°</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Demo5</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> <span class=\"variable\">value</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">Lock</span> <span class=\"variable\">lock</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ReentrantLock</span>();</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">Condition</span> <span class=\"variable\">a</span> <span class=\"operator\">=</span> lock.newCondition();</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">Condition</span> <span class=\"variable\">b</span> <span class=\"operator\">=</span> lock.newCondition();</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">Condition</span> <span class=\"variable\">c</span> <span class=\"operator\">=</span> lock.newCondition();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">outputA</span><span class=\"params\">(<span class=\"type\">int</span> round)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            lock.lock();</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (value != <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                a.await();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            value = <span class=\"number\">1</span>;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;ç¬¬&quot;</span> + round + <span class=\"string\">&quot;è½®ï¼Œ&quot;</span> + Thread.currentThread().getName() + <span class=\"string\">&quot;è¾“å‡ºA&quot;</span>);</span><br><span class=\"line\">            b.signal();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            lock.unlock();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">outputB</span><span class=\"params\">(<span class=\"type\">int</span> round)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            lock.lock();</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (value != <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">                b.await();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            value = <span class=\"number\">2</span>;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;ç¬¬&quot;</span> + round + <span class=\"string\">&quot;è½®ï¼Œ&quot;</span> + Thread.currentThread().getName() + <span class=\"string\">&quot;è¾“å‡ºB&quot;</span>);</span><br><span class=\"line\">            c.signal();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            lock.unlock();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">outputC</span><span class=\"params\">(<span class=\"type\">int</span> round)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            lock.lock();</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (value != <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">                c.await();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            value = <span class=\"number\">0</span>;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;ç¬¬&quot;</span> + round + <span class=\"string\">&quot;è½®ï¼Œ&quot;</span> + Thread.currentThread().getName() + <span class=\"string\">&quot;è¾“å‡ºC&quot;</span>);</span><br><span class=\"line\">            a.signal();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            lock.unlock();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Demo5</span> <span class=\"variable\">s</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Demo5</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">3</span>; i++) &#123;</span><br><span class=\"line\">                s.outputA(i);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;Thread-A&quot;</span>).start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">3</span>; i++) &#123;</span><br><span class=\"line\">                s.outputB(i);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;Thread-B&quot;</span>).start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">3</span>; i++) &#123;</span><br><span class=\"line\">                s.outputC(i);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;Thread-C&quot;</span>).start();</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"Javaå…«è‚¡æ–‡ - MyBatis","copyright":true,"mathjax":false,"date":"2023-01-23T07:30:00.000Z","toc":true,"urlname":"java-mybatis","_content":"\n> æ•´ç†çš„MyBatisæ¡†æ¶ç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½<!--more-->\n\n\n### ä»€ä¹ˆæ˜¯MyBatisï¼Ÿ\n\n1. MyBatis æ˜¯ä¸€ä¸ªåŠ ORMï¼ˆå¯¹è±¡å…³ç³»æ˜ å°„ï¼‰æ¡†æ¶ï¼Œå®ƒå†…éƒ¨å°è£…äº† JDBCï¼Œå¼€å‘æ—¶åªéœ€è¦å…³æ³¨ SQL è¯­å¥æœ¬èº«ï¼Œä¸éœ€è¦èŠ±è´¹ç²¾åŠ›å»å¤„ç†**åŠ è½½é©±åŠ¨ã€åˆ›å»ºè¿æ¥ã€åˆ›å»ºstatement**ç­‰ç¹æ‚çš„è¿‡ç¨‹ã€‚\n2. é€šè¿‡ xml æ–‡ä»¶æˆ–æ³¨è§£çš„æ–¹å¼å°†è¦æ‰§è¡Œçš„å„ç§ statement é…ç½®èµ·æ¥ï¼Œå¹¶é€šè¿‡ java å¯¹è±¡å’Œ statement ä¸­ SQL çš„åŠ¨æ€å‚æ•°è¿›è¡Œæ˜ å°„ç”Ÿæˆæœ€ç»ˆæ‰§è¡Œçš„ SQL è¯­å¥ï¼Œæœ€åç”± mybatis æ¡†æ¶æ‰§è¡Œ SQL å¹¶å°†ç»“æœæ˜ å°„ä¸º java å¯¹è±¡å¹¶è¿”å›ã€‚ï¼ˆä»æ‰§è¡Œ SQL åˆ°è¿”å› result çš„è¿‡ç¨‹ï¼‰ã€‚\n\n### ORMæ˜¯ä»€ä¹ˆ\n\nORMï¼ˆObject Relational Mappingï¼‰ï¼Œå¯¹è±¡å…³ç³»æ˜ å°„ï¼Œå°±æ˜¯æŠŠæ•°æ®åº“è¡¨å’Œå®ä½“ç±»åŠå®ä½“ç±»çš„å±æ€§å¯¹åº”èµ·æ¥\n\nè®©æˆ‘ä»¬å¯ä»¥æ“ä½œå®ä½“ç±»å°±å®ç°æ“ä½œæ•°æ®åº“è¡¨ã€‚\n\n### ä¸ºä»€ä¹ˆè¯´MyBatisæ˜¯åŠè‡ªåŠ¨ORMæ˜ å°„å·¥å…·ï¼Ÿå®ƒä¸å…¨è‡ªåŠ¨çš„åŒºåˆ«åœ¨å“ªé‡Œï¼Ÿ\n\nMyBatis åœ¨æŸ¥è¯¢å…³è”å¯¹è±¡æˆ–å…³è”é›†åˆå¯¹è±¡æ—¶ï¼Œéœ€è¦æ‰‹åŠ¨ç¼–å†™ SQL æ¥å®Œæˆï¼Œæ‰€ä»¥ï¼Œç§°ä¹‹ä¸ºåŠè‡ªåŠ¨ ORM æ˜ å°„å·¥å…·ã€‚\n\n### JDBCç¼–ç¨‹æœ‰å“ªäº›ä¸è¶³ä¹‹å¤„ï¼ŒMyBatisæ˜¯å¦‚ä½•è§£å†³çš„ï¼Ÿ\n\n1. æ•°æ®åº“è¿æ¥åˆ›å»ºã€é‡Šæ”¾é¢‘ç¹ï¼Œé€ æˆç³»ç»Ÿèµ„æºæµªè´¹ä»è€Œå½±å“ç³»ç»Ÿæ€§èƒ½\n2. SQL è¯­å¥å†™åœ¨ä»£ç ä¸­é€ æˆä»£ç **ä¸æ˜“ç»´æŠ¤**\n3. å‘ SQL è¯­å¥**ä¼ å‚**éº»çƒ¦\n4. å¯¹**ç»“æœé›†è§£æ**éº»çƒ¦\n\n### MyBatisç¼–ç¨‹æ­¥éª¤æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ\n\n1. è¯»å–é…ç½®æ–‡ä»¶ï¼Œåˆ›å»º SqlSessionFactory å·¥å‚\n2. é€šè¿‡ SqlSessionFactory å·¥å‚åˆ›å»º SqlSession å¯¹è±¡\n3. ä½¿ç”¨ SqlSession åˆ›å»º Dao æ¥å£çš„ä»£ç†å¯¹è±¡\n4. ä½¿ç”¨ä»£ç†å¯¹è±¡æ‰§è¡Œæ–¹æ³•\n5. è°ƒç”¨ session.commit()æäº¤äº‹åŠ¡\n6. è°ƒç”¨ session.close()å…³é—­ä¼šè¯\n\n### \\#{}å’Œ\\${}çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\n\nmybatis åœ¨å¤„ç† \\#{} æ—¶ï¼Œä¼šå°† SQL ä¸­çš„ \\#{} æ›¿æ¢ä¸º ? å·ï¼Œè°ƒç”¨ PreparedStatement çš„ set æ–¹æ³•æ¥èµ‹å€¼ã€‚\nè¿™æ˜¯**é¢„ç¼–è¯‘å¤„ç†**ï¼Œå¯ä»¥æé«˜ SQL æ‰§è¡Œæ•ˆç‡ï¼Œæ›´é‡è¦çš„æ˜¯**å¯ä»¥é˜²æ­¢SQLæ³¨å…¥**ï¼›\n\nmybatis åœ¨å¤„ç† \\${} æ—¶ï¼Œå°±æ˜¯æŠŠ \\${} ä½¿ç”¨**å­—ç¬¦ä¸²æ›¿æ¢**ã€‚ä½¿ç”¨è¯¥æ–¹å¼å¦‚æœä¼ å…¥ id çš„è¯ï¼Œä¼šæŠŠ id=1 è½¬æ¢ä¸º id=\"1\"å­—ç¬¦ä¸²å½¢å¼ï¼Œè€Œæ•°æ®åº“ä¸­ id å®é™…ä¸ºæ•°å€¼å‹è¿™æ ·å°±ä¸åŒ¹é…äº†ï¼ŒæŸ¥è¯¢å¤±è´¥ã€‚ï¼ˆ\\${}æ˜¯å­—ç¬¦ä¸²æ›¿æ¢ï¼Œé€šå¸¸åœ¨ EL è¡¨è¾¾å¼ä¸­ä½¿ç”¨ï¼Œç”¨æ¥å±•ç¤ºåç«¯ä¼ é€’åˆ°å‰ç«¯çš„å€¼ï¼‰ã€‚\n\n### å½“å®ä½“ç±»ä¸­çš„å±æ€§åå’Œè¡¨ä¸­çš„å­—æ®µåä¸ä¸€æ · ï¼Œæ€ä¹ˆåŠ ï¼Ÿ\n\n1. é€šè¿‡åœ¨æŸ¥è¯¢çš„ SQL è¯­å¥ä¸­å®šä¹‰æ•°æ®åº“å­—æ®µåçš„åˆ«åï¼Œè®©æ•°æ®åº“å­—æ®µåçš„åˆ«åå’Œå®ä½“ç±»çš„å±æ€§åä¸€è‡´ã€‚\n2. é€šè¿‡ `<resultMap>`æ¥æ˜ å°„å­—æ®µåå’Œå®ä½“ç±»å±æ€§åçš„ä¸€ä¸€å¯¹åº”çš„å…³ç³»ã€‚\n\n### æ¨¡ç³ŠæŸ¥è¯¢likeè¯­å¥è¯¥æ€ä¹ˆå†™?\n\n1. åœ¨ Java ä»£ç ä¸­æ·»åŠ  SQL é€šé…ç¬¦ã€‚\n\n\t```xml\n\tstring wildcardname = â€œ%smi%â€;\n\tlist<name> names = mapper.selectlike(wildcardname);\n\t\n\t<select id=â€selectlikeâ€>\n\t\tselect * from foo where bar like #{value}\n\t</select>\n\t```\n\n2. åœ¨ SQL è¯­å¥ä¸­æ‹¼æ¥é€šé…ç¬¦%ï¼Œä¼šå¼•èµ· SQL æ³¨å…¥\n\n\t```xml\n\tstring wildcardname = â€œsmiâ€;\n\tlist<name> names = mapper.selectlike(wildcardname);\n\t\n\t<select id=â€selectlikeâ€>\n\t\tselect * from foo where bar like \"%\"#{value}\"%\"\n\t</select>\n\t```\n\n### MyBatiséƒ½æœ‰å“ªäº›Executoræ‰§è¡Œå™¨ï¼Ÿå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\n\nMyBatis æœ‰ä¸‰ç§åŸºæœ¬çš„ Executor æ‰§è¡Œå™¨ï¼ŒSimpleExecutorã€ReuseExecutorã€BatchExecutorã€‚\n\n- **SimpleExecutor** ï¼šæ¯æ¬¡å¼€å¯ä¸€ä¸ª Statement å¯¹è±¡ï¼Œç”¨å®Œç«‹åˆ»å…³é—­ Statement å¯¹è±¡ã€‚\n- **ReuseExecutor** ï¼šé‡å¤ä½¿ç”¨åˆ›å»ºçš„ Statement å¯¹è±¡ã€‚\n- **BatchExecutor** ï¼šç¼“å­˜äº†å¤šä¸ª Statement å¯¹è±¡ï¼Œä¸€èµ·æ‰§è¡Œæ‰¹é‡æ›´æ–°ã€‚\n\n### é€šå¸¸ä¸€ä¸ªxmlæ˜ å°„æ–‡ä»¶ï¼Œéƒ½ä¼šå†™ä¸€ä¸ªDaoæ¥å£ä¸ä¹‹å¯¹åº”ï¼Œè¯·é—®ï¼Œè¿™ä¸ªDaoæ¥å£çš„å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆï¼ŸDaoæ¥å£é‡Œçš„æ–¹æ³•ï¼Œå‚æ•°ä¸åŒæ—¶ï¼Œæ–¹æ³•èƒ½é‡è½½å—ï¼Ÿ\n\nDao æ¥å£ï¼Œå°±æ˜¯äººä»¬å¸¸è¯´çš„ `Mapper`æ¥å£ï¼Œæ¥å£çš„å…¨é™åï¼Œå°±æ˜¯æ˜ å°„æ–‡ä»¶ä¸­çš„ namespace çš„å€¼ï¼Œæ¥å£çš„æ–¹æ³•åï¼Œå°±æ˜¯æ˜ å°„æ–‡ä»¶ä¸­`MappedStatement`çš„ id å€¼ï¼Œæ¥å£æ–¹æ³•å†…çš„å‚æ•°ï¼Œå°±æ˜¯ä¼ é€’ç»™ SQL çš„å‚æ•°ã€‚`Mapper`æ¥å£æ˜¯æ²¡æœ‰å®ç°ç±»çš„ï¼Œå½“è°ƒç”¨æ¥å£æ–¹æ³•æ—¶ï¼Œæ¥å£å…¨é™å+æ–¹æ³•åæ‹¼æ¥å­—ç¬¦ä¸²ä½œä¸º key å€¼ï¼Œå¯å”¯ä¸€å®šä½ä¸€ä¸ª`MappedStatement`ï¼Œä¸¾ä¾‹ï¼š`com.yaxing.dao.IUserDao.findAll`ï¼Œå¯ä»¥å”¯ä¸€æ‰¾åˆ° namespace ä¸º`com.yaxing.dao.IUserDao`ä¸‹é¢`id = findAll`çš„`MappedStatement`ã€‚åœ¨ MyBatis ä¸­ï¼Œæ¯ä¸€ä¸ª`<select>`ã€`<insert>`ã€`<update>`ã€`<delete>`æ ‡ç­¾ï¼Œéƒ½ä¼šè¢«è§£æä¸ºä¸€ä¸ª`MappedStatement`å¯¹è±¡ï¼Œç„¶åæ‰§è¡Œåç»­çš„æ“ä½œã€‚\n\n```xml\n<mapper namespace=\"com.yaxing.dao.IUserDao\">\n    <select id=\"findAll\" resultType=\"com.yaxing.domain.User\">\n        select * from user;\n    </select>\n</mapper>\n```\n\nDao æ¥å£é‡Œçš„æ–¹æ³•å¯ä»¥é‡è½½ï¼Œä½†æ˜¯ MyBatis çš„ XML é‡Œé¢çš„ ID ä¸å…è®¸é‡å¤ï¼Œä¹Ÿå°±æ˜¯è¯´å¯¹äºåŒä¸€ä¸ªæ¥å£æ–¹æ³•åï¼Œmapper æ–‡ä»¶ä¸­åªèƒ½æœ‰ä¸€ä¸ªè¯¥ idã€‚\nå¯ä»¥ä½¿ç”¨åŠ¨æ€ SQL å®ç°æ¥å£é‡è½½å¯¹åº”çš„ maperã€‚\n\n```java\n/**\n * Mapperæ¥å£é‡Œé¢æ–¹æ³•é‡è½½\n */\npublic interface StuMapper {\n    List<Student> getAllStu();\n    List<Student> getAllStu(@Param(\"id\") Integer id);\n}\n```\n\nç„¶ååœ¨ `StuMapper.xml` ä¸­åˆ©ç”¨ MyBatis çš„åŠ¨æ€ SQL å°±å¯ä»¥å®ç°ã€‚\n\n```xml\n<select id=\"getAllStu\" resultType=\"com.pojo.Student\">\n    select * from student\n    <where>\n        <if test=\"id != null\">\n            id = #{id}\n        </if>\n    </where>\n</select>\n```\n\nèƒ½æ­£å¸¸è¿è¡Œï¼Œå¹¶èƒ½å¾—åˆ°ç›¸åº”çš„ç»“æœï¼Œè¿™æ ·å°±å®ç°äº†åœ¨ Dao æ¥å£ä¸­å†™é‡è½½æ–¹æ³•ã€‚\n\n**MyBatis çš„ Dao æ¥å£å¯ä»¥æœ‰å¤šä¸ªé‡è½½æ–¹æ³•ï¼Œä½†æ˜¯å¤šä¸ªæ¥å£å¯¹åº”çš„æ˜ å°„å¿…é¡»åªæœ‰ä¸€ä¸ªï¼Œå¦åˆ™å¯åŠ¨ä¼šæŠ¥é”™ã€‚**\n\n### MyBatisæ˜¯å¦‚ä½•å°†SQLæ‰§è¡Œç»“æœå°è£…ä¸ºç›®æ ‡å¯¹è±¡å¹¶è¿”å›çš„ï¼Ÿéƒ½æœ‰å“ªäº›æ˜ å°„å½¢å¼ï¼Ÿ\n\n1. ä½¿ç”¨ `<resultMap>`æ ‡ç­¾ï¼Œé€ä¸€å®šä¹‰æ•°æ®åº“åˆ—åå’Œå¯¹è±¡å±æ€§åä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚\n\n2. ä½¿ç”¨ SQL åˆ—çš„åˆ«ååŠŸèƒ½ï¼Œå°†åˆ—çš„åˆ«åå±æ€§å¯¹åº”ä¸ºå¯¹è±¡å±æ€§åã€‚\n\næœ‰äº†åˆ—åä¸å±æ€§åçš„æ˜ å°„å…³ç³»åï¼ŒMyBatis**é€šè¿‡åå°„åˆ›å»ºå¯¹è±¡**ï¼ŒåŒæ—¶**ä½¿ç”¨åå°„ç»™å¯¹è±¡çš„å±æ€§é€ä¸€èµ‹å€¼**å¹¶è¿”å›ï¼Œé‚£äº›æ‰¾ä¸åˆ°æ˜ å°„å…³ç³»çš„å±æ€§ï¼Œæ˜¯æ— æ³•å®Œæˆèµ‹å€¼çš„ã€‚\n\n### åœ¨mapperä¸­å¦‚ä½•ä¼ é€’å¤šä¸ªå‚æ•°?\n\n1. é¡ºåºä¼ å‚æ³•ï¼Œ\\#{} é‡Œé¢çš„æ•°å­—ä»£è¡¨ä¼ å…¥å‚æ•°çš„é¡ºåº\n2. @Param æ³¨è§£ä¼ å‚æ³•ï¼Œ\\#{} é‡Œé¢çš„åç§°å¯¹åº”çš„æ˜¯æ³¨è§£@Param æ‹¬å·é‡Œé¢ä¿®é¥°çš„åç§°\n3. map ä¼ å‚ï¼Œ\\#{} é‡Œé¢çš„åç§°å¯¹åº”çš„æ˜¯ Map é‡Œé¢çš„ key åç§°ã€‚\n4. Java Bean ä¼ å‚æ³•ï¼Œ\\#{} é‡Œé¢çš„åç§°å¯¹åº”çš„æ˜¯ User ç±»é‡Œé¢çš„æˆå‘˜å±æ€§ã€‚\n\n### MyBatisåŠ¨æ€SQLæœ‰ä»€ä¹ˆç”¨ï¼Ÿæ‰§è¡ŒåŸç†ï¼Ÿæœ‰å“ªäº›åŠ¨æ€SQLï¼Ÿ\n\nMyBatis åŠ¨æ€ SQL å¯ä»¥åœ¨ xml æ˜ å°„æ–‡ä»¶å†…ï¼Œä»¥æ ‡ç­¾çš„å½¢å¼ç¼–å†™åŠ¨æ€ SQL.\n\næ‰§è¡ŒåŸç†æ˜¯æ ¹æ®è¡¨è¾¾å¼çš„å€¼ å®Œæˆé€»è¾‘åˆ¤æ–­å¹¶åŠ¨æ€æ‹¼æ¥ SQLã€‚\n\nMyBatis æä¾›äº† 9 ç§åŠ¨æ€ SQL æ ‡ç­¾ï¼š å¸¸ç”¨çš„æœ‰ `if|where|foreach`\n\n```xml\n<select id=\"getAllStu\" resultType=\"com.pojo.Student\">\n    select * from student\n    <where>\n        <if test=\"id != null\">\n            id = #{id}\n        </if>\n    </where>\n</select>\n```\n\n### MyBatiså®ç°ä¸€å¯¹å¤šæœ‰å‡ ç§æ–¹å¼,æ€ä¹ˆæ“ä½œçš„ï¼Ÿ\n\næœ‰**è”åˆæŸ¥è¯¢**å’Œ**åµŒå¥—æŸ¥è¯¢**ã€‚\n\nè”åˆæŸ¥è¯¢æ˜¯å‡ ä¸ªè¡¨è”åˆæŸ¥è¯¢,åªæŸ¥è¯¢ä¸€æ¬¡,é€šè¿‡åœ¨ resultMap é‡Œé¢çš„ collection èŠ‚ç‚¹é…ç½®ä¸€å¯¹å¤šçš„ç±»å°±å¯ä»¥å®Œæˆï¼›\n\nåµŒå¥—æŸ¥è¯¢æ˜¯å…ˆæŸ¥ä¸€ä¸ªè¡¨,æ ¹æ®è¿™ä¸ªè¡¨é‡Œé¢çš„ ç»“æœçš„å¤–é”® id,å»å†å¦å¤–ä¸€ä¸ªè¡¨é‡Œé¢æŸ¥è¯¢æ•°æ®,ä¹Ÿæ˜¯é€šè¿‡é…ç½® collection,ä½†å¦å¤–ä¸€ä¸ªè¡¨çš„æŸ¥è¯¢é€šè¿‡ select èŠ‚ç‚¹é…ç½®ã€‚\n\n### MyBatisæ˜¯å¦æ”¯æŒå»¶è¿ŸåŠ è½½ï¼Ÿå¦‚æœæ”¯æŒï¼Œå®ƒçš„å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ\n\nMyBatis ä»…æ”¯æŒ association å…³è”å¯¹è±¡å’Œ collection å…³è”é›†åˆå¯¹è±¡çš„å»¶è¿ŸåŠ è½½ã€‚\nassociation æŒ‡çš„å°±æ˜¯ä¸€å¯¹ä¸€ï¼Œcollection æŒ‡çš„å°±æ˜¯ä¸€å¯¹å¤šæŸ¥è¯¢ã€‚\nåœ¨ MyBatis é…ç½®æ–‡ä»¶ä¸­ï¼Œå¯ä»¥é…ç½®æ˜¯å¦å¯ç”¨å»¶è¿ŸåŠ è½½ lazyLoadingEnabled=true|falseã€‚\n\nå®ƒçš„åŸç†æ˜¯ï¼Œä½¿ç”¨ CGLIB åˆ›å»ºç›®æ ‡å¯¹è±¡çš„ä»£ç†å¯¹è±¡ï¼Œå½“è°ƒç”¨ç›®æ ‡æ–¹æ³•æ—¶ï¼Œè¿›å…¥æ‹¦æˆªå™¨æ–¹æ³•ï¼Œæ¯”å¦‚è°ƒç”¨ a.getB().getName()ï¼Œæ‹¦æˆªå™¨ invoke()æ–¹æ³•å‘ç° a.getB()æ˜¯ null å€¼ï¼Œé‚£ä¹ˆå°±ä¼šå•ç‹¬å‘é€äº‹å…ˆä¿å­˜å¥½çš„æŸ¥è¯¢å…³è” B å¯¹è±¡çš„ SQLï¼ŒæŠŠ B æŸ¥è¯¢ä¸Šæ¥ï¼Œç„¶åè°ƒç”¨ a.setB(b)ï¼Œäºæ˜¯ a çš„å¯¹è±¡ b å±æ€§å°±æœ‰å€¼äº†ï¼Œæ¥ç€å®Œæˆ a.getB().getName()æ–¹æ³•çš„è°ƒç”¨ã€‚è¿™å°±æ˜¯å»¶è¿ŸåŠ è½½çš„åŸºæœ¬åŸç†ã€‚\n\n### MyBatisçš„ä¸€çº§ã€äºŒçº§ç¼“å­˜\n\n**ä¸€çº§ç¼“å­˜**ï¼šä¸€çº§ç¼“å­˜æ˜¯ SqlSession èŒƒå›´çš„ç¼“å­˜\n\nå½“æˆ‘ä»¬æ‰§è¡ŒæŸ¥è¯¢ä¹‹åï¼ŒæŸ¥è¯¢çš„ç»“æœä¼šåŒæ—¶å­˜å…¥åˆ° SqlSession ä¸ºæˆ‘ä»¬æä¾›çš„ä¸€å—åŒºåŸŸä¸­ã€‚è¯¥åŒºåŸŸçš„ç»“æ„æ˜¯ä¸€ä¸ª Mapã€‚\nå½“æˆ‘ä»¬å†æ¬¡æŸ¥è¯¢åŒæ ·çš„æ•°æ®æ—¶ï¼ŒMyBatis ä¼šå…ˆå» SqlSession ä¸­æŸ¥è¯¢æ˜¯å¦æœ‰ï¼Œæœ‰çš„è¯ç›´æ¥æ‹¿å‡ºæ¥ç”¨ã€‚\n\nå½“è°ƒç”¨ SqlSession çš„æ·»åŠ ï¼Œä¿®æ”¹ï¼Œåˆ é™¤ï¼Œcommit()ï¼Œclose()ã€clearCache()ç­‰æ–¹æ³•æ—¶ï¼Œå°±ä¼šæ¸…ç©ºä¸€çº§ç¼“å­˜ã€‚\n\n> ç¬¬ä¸€æ¬¡å‘èµ·æŸ¥è¯¢ç”¨æˆ·idä¸º1çš„ç”¨æˆ·ä¿¡æ¯ï¼Œå…ˆå»æ‰¾ç¼“å­˜ä¸­æ˜¯å¦æœ‰idä¸º1çš„ç”¨æˆ·ä¿¡æ¯ï¼Œå¦‚æœæ²¡æœ‰ï¼Œä»æ•°æ®åº“æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ã€‚ \n> å¾—åˆ°ç”¨æˆ·ä¿¡æ¯ï¼Œå°†ç”¨æˆ·ä¿¡æ¯å­˜å‚¨åˆ°ä¸€çº§ç¼“å­˜ä¸­ã€‚ \n> å¦‚æœSQLSessionå»æ‰§è¡Œcommitæ“ä½œï¼ˆæ‰§è¡Œæ’å…¥ã€æ›´æ–°ã€åˆ é™¤ï¼‰ï¼Œæ¸…ç©ºSqlSessionä¸­çš„ä¸€çº§ç¼“å­˜ï¼Œè¿™æ ·åšçš„ç›®çš„ä¸ºäº†è®©ç¼“å­˜ä¸­å­˜å‚¨çš„æ˜¯æœ€æ–°çš„ä¿¡æ¯ï¼Œé¿å…è„è¯»ã€‚ \n> ç¬¬äºŒæ¬¡å‘èµ·æŸ¥è¯¢ç”¨æˆ·idä¸º1çš„ç”¨æˆ·ä¿¡æ¯ï¼Œå…ˆå»æ‰¾ç¼“å­˜ä¸­æ˜¯å¦æœ‰idä¸º1çš„ç”¨æˆ·ä¿¡æ¯ï¼Œç¼“å­˜ä¸­æœ‰ï¼Œç›´æ¥ä»ç¼“å­˜ä¸­è·å–ç”¨æˆ·ä¿¡æ¯ã€‚\n\n**äºŒçº§ç¼“å­˜**ï¼šäºŒçº§ç¼“å­˜æ˜¯ mapper æ˜ å°„çº§åˆ«çš„ç¼“å­˜ï¼Œå¤šä¸ª SqlSession å»æ“ä½œåŒä¸€ä¸ª Mapper æ˜ å°„çš„ SQL è¯­å¥ï¼Œå¤šä¸ª SqlSession å¯ä»¥å…±ç”¨äºŒçº§ç¼“å­˜ï¼ŒäºŒçº§ç¼“å­˜æ˜¯è·¨ SqlSession çš„ã€‚\n\nMyBatis ä¸­ SqlSessionFactory å¯¹è±¡çš„ç¼“å­˜\n\nâ€‹\tç”±åŒä¸€ä¸ª SqlSessionFactory å¯¹è±¡åˆ›å»ºçš„ SqlSession å…±äº«å…¶ç¼“å­˜ã€‚\n\nâ€‹\täºŒçº§ç¼“å­˜å­˜æ”¾çš„æ˜¯æ•°æ®ï¼Œè€Œä¸æ˜¯å¯¹è±¡ã€‚\n\n> SQLSession1å»æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ï¼ŒæŸ¥è¯¢åˆ°ç”¨æˆ·ä¿¡æ¯ä¼šå°†æŸ¥è¯¢æ•°æ®å­˜å‚¨åˆ°äºŒçº§ç¼“å­˜ä¸­ã€‚\n> å¦‚æœSqlSession3å»æ‰§è¡Œç›¸åŒ mapperæ˜ å°„ä¸‹SQLï¼Œæ‰§è¡Œcommitæäº¤ï¼Œå°†ä¼šæ¸…ç©ºè¯¥ mapperæ˜ å°„ä¸‹çš„äºŒçº§ç¼“å­˜åŒºåŸŸçš„æ•°æ®ã€‚ \n> SQLSession2å»æŸ¥è¯¢ä¸SQLSession1ç›¸åŒçš„ç”¨æˆ·ä¿¡æ¯ï¼Œé¦–å…ˆä¼šå»ç¼“å­˜ä¸­æ‰¾æ˜¯å¦å­˜åœ¨æ•°æ®ï¼Œå¦‚æœå­˜åœ¨ç›´æ¥ä»ç¼“å­˜ä¸­å–å‡ºæ•°æ®ã€‚\n\n1ï¼‰ä¸€çº§ç¼“å­˜: åŸºäº PerpetualCache çš„ HashMap æœ¬åœ°ç¼“å­˜ï¼Œå…¶å­˜å‚¨ä½œç”¨åŸŸä¸º Sessionï¼Œå½“ Session flush æˆ– close ä¹‹åï¼Œè¯¥ Session ä¸­çš„æ‰€æœ‰ Cache å°±å°†æ¸…ç©ºï¼Œé»˜è®¤æ‰“å¼€ä¸€çº§ç¼“å­˜ï¼›\n\n2ï¼‰äºŒçº§ç¼“å­˜ä¸ä¸€çº§ç¼“å­˜å…¶æœºåˆ¶ç›¸åŒï¼Œé»˜è®¤ä¹Ÿæ˜¯é‡‡ç”¨ PerpetualCacheï¼ŒHashMap å­˜å‚¨ï¼Œä¸åŒåœ¨äºå…¶å­˜å‚¨ä½œç”¨åŸŸä¸º Mapper(Namespace)ï¼Œå¹¶ä¸”å¯è‡ªå®šä¹‰å­˜å‚¨æºï¼Œå¦‚ Ehcacheã€‚é»˜è®¤ä¸æ‰“å¼€äºŒçº§ç¼“å­˜ï¼Œè¦å¼€å¯äºŒçº§ç¼“å­˜ï¼Œä½¿ç”¨äºŒçº§ç¼“å­˜å±æ€§ç±»éœ€è¦å®ç° Serializable åºåˆ—åŒ–æ¥å£(å¯ç”¨æ¥ä¿å­˜å¯¹è±¡çš„çŠ¶æ€),å¯åœ¨å®ƒçš„æ˜ å°„æ–‡ä»¶ä¸­é…ç½® `<cache/>` ï¼›\n\n3ï¼‰å¯¹äºç¼“å­˜æ•°æ®æ›´æ–°æœºåˆ¶ï¼Œå½“æŸä¸€ä¸ªä½œç”¨åŸŸ(ä¸€çº§ç¼“å­˜ Session/äºŒçº§ç¼“å­˜ Namespaces)çš„è¿›è¡Œäº† C/U/D æ“ä½œåï¼Œé»˜è®¤è¯¥ä½œç”¨åŸŸä¸‹æ‰€æœ‰ select ä¸­çš„ç¼“å­˜å°†è¢« clearã€‚ \n\n### ä»€ä¹ˆæ˜¯MyBatisçš„æ¥å£ç»‘å®šï¼Ÿæœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ\n\næ¥å£ç»‘å®šï¼Œå°±æ˜¯åœ¨ MyBatis ä¸­ä»»æ„å®šä¹‰æ¥å£,ç„¶åæŠŠæ¥å£é‡Œé¢çš„æ–¹æ³•å’Œ SQL è¯­å¥ç»‘å®š, æˆ‘ä»¬ç›´æ¥è°ƒç”¨æ¥å£æ–¹æ³•å°±å¯ä»¥,è¿™æ ·æ¯”èµ·åŸæ¥äº† SqlSession æä¾›çš„æ–¹æ³•æˆ‘ä»¬å¯ä»¥æœ‰æ›´åŠ çµæ´»çš„é€‰æ‹©å’Œè®¾ç½®ã€‚\n\næ¥å£ç»‘å®šæœ‰ä¸¤ç§å®ç°æ–¹å¼ï¼š\n\n1. é€šè¿‡æ³¨è§£ç»‘å®šï¼Œå°±æ˜¯åœ¨æ¥å£çš„æ–¹æ³•ä¸Šé¢åŠ ä¸Š @Selectã€@Update ç­‰æ³¨è§£ï¼Œé‡Œé¢åŒ…å« Sql è¯­å¥æ¥ç»‘å®šï¼›\n2. é€šè¿‡ xml é‡Œé¢å†™ SQL æ¥ç»‘å®š, åœ¨è¿™ç§æƒ…å†µä¸‹,è¦æŒ‡å®š xml æ˜ å°„æ–‡ä»¶é‡Œé¢çš„ namespace å¿…é¡»ä¸ºæ¥å£çš„å…¨è·¯å¾„åã€‚å½“ Sql è¯­å¥æ¯”è¾ƒç®€å•æ—¶å€™,ç”¨æ³¨è§£ç»‘å®š, å½“ SQL è¯­å¥æ¯”è¾ƒå¤æ‚æ—¶å€™,ç”¨ xml ç»‘å®š,ä¸€èˆ¬ç”¨ xml ç»‘å®šçš„æ¯”è¾ƒå¤šã€‚\n","source":"_posts/Javaå…«è‚¡æ–‡ - MyBatis.md","raw":"---\ntitle: Javaå…«è‚¡æ–‡ - MyBatis\ncopyright: true\nmathjax: false\ncategories:\n  - Javaå…«è‚¡æ–‡\ndate: 2023-01-23 15:30:00\ntags:\ntoc: true\nurlname: java-mybatis\n---\n\n> æ•´ç†çš„MyBatisæ¡†æ¶ç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½<!--more-->\n\n\n### ä»€ä¹ˆæ˜¯MyBatisï¼Ÿ\n\n1. MyBatis æ˜¯ä¸€ä¸ªåŠ ORMï¼ˆå¯¹è±¡å…³ç³»æ˜ å°„ï¼‰æ¡†æ¶ï¼Œå®ƒå†…éƒ¨å°è£…äº† JDBCï¼Œå¼€å‘æ—¶åªéœ€è¦å…³æ³¨ SQL è¯­å¥æœ¬èº«ï¼Œä¸éœ€è¦èŠ±è´¹ç²¾åŠ›å»å¤„ç†**åŠ è½½é©±åŠ¨ã€åˆ›å»ºè¿æ¥ã€åˆ›å»ºstatement**ç­‰ç¹æ‚çš„è¿‡ç¨‹ã€‚\n2. é€šè¿‡ xml æ–‡ä»¶æˆ–æ³¨è§£çš„æ–¹å¼å°†è¦æ‰§è¡Œçš„å„ç§ statement é…ç½®èµ·æ¥ï¼Œå¹¶é€šè¿‡ java å¯¹è±¡å’Œ statement ä¸­ SQL çš„åŠ¨æ€å‚æ•°è¿›è¡Œæ˜ å°„ç”Ÿæˆæœ€ç»ˆæ‰§è¡Œçš„ SQL è¯­å¥ï¼Œæœ€åç”± mybatis æ¡†æ¶æ‰§è¡Œ SQL å¹¶å°†ç»“æœæ˜ å°„ä¸º java å¯¹è±¡å¹¶è¿”å›ã€‚ï¼ˆä»æ‰§è¡Œ SQL åˆ°è¿”å› result çš„è¿‡ç¨‹ï¼‰ã€‚\n\n### ORMæ˜¯ä»€ä¹ˆ\n\nORMï¼ˆObject Relational Mappingï¼‰ï¼Œå¯¹è±¡å…³ç³»æ˜ å°„ï¼Œå°±æ˜¯æŠŠæ•°æ®åº“è¡¨å’Œå®ä½“ç±»åŠå®ä½“ç±»çš„å±æ€§å¯¹åº”èµ·æ¥\n\nè®©æˆ‘ä»¬å¯ä»¥æ“ä½œå®ä½“ç±»å°±å®ç°æ“ä½œæ•°æ®åº“è¡¨ã€‚\n\n### ä¸ºä»€ä¹ˆè¯´MyBatisæ˜¯åŠè‡ªåŠ¨ORMæ˜ å°„å·¥å…·ï¼Ÿå®ƒä¸å…¨è‡ªåŠ¨çš„åŒºåˆ«åœ¨å“ªé‡Œï¼Ÿ\n\nMyBatis åœ¨æŸ¥è¯¢å…³è”å¯¹è±¡æˆ–å…³è”é›†åˆå¯¹è±¡æ—¶ï¼Œéœ€è¦æ‰‹åŠ¨ç¼–å†™ SQL æ¥å®Œæˆï¼Œæ‰€ä»¥ï¼Œç§°ä¹‹ä¸ºåŠè‡ªåŠ¨ ORM æ˜ å°„å·¥å…·ã€‚\n\n### JDBCç¼–ç¨‹æœ‰å“ªäº›ä¸è¶³ä¹‹å¤„ï¼ŒMyBatisæ˜¯å¦‚ä½•è§£å†³çš„ï¼Ÿ\n\n1. æ•°æ®åº“è¿æ¥åˆ›å»ºã€é‡Šæ”¾é¢‘ç¹ï¼Œé€ æˆç³»ç»Ÿèµ„æºæµªè´¹ä»è€Œå½±å“ç³»ç»Ÿæ€§èƒ½\n2. SQL è¯­å¥å†™åœ¨ä»£ç ä¸­é€ æˆä»£ç **ä¸æ˜“ç»´æŠ¤**\n3. å‘ SQL è¯­å¥**ä¼ å‚**éº»çƒ¦\n4. å¯¹**ç»“æœé›†è§£æ**éº»çƒ¦\n\n### MyBatisç¼–ç¨‹æ­¥éª¤æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ\n\n1. è¯»å–é…ç½®æ–‡ä»¶ï¼Œåˆ›å»º SqlSessionFactory å·¥å‚\n2. é€šè¿‡ SqlSessionFactory å·¥å‚åˆ›å»º SqlSession å¯¹è±¡\n3. ä½¿ç”¨ SqlSession åˆ›å»º Dao æ¥å£çš„ä»£ç†å¯¹è±¡\n4. ä½¿ç”¨ä»£ç†å¯¹è±¡æ‰§è¡Œæ–¹æ³•\n5. è°ƒç”¨ session.commit()æäº¤äº‹åŠ¡\n6. è°ƒç”¨ session.close()å…³é—­ä¼šè¯\n\n### \\#{}å’Œ\\${}çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\n\nmybatis åœ¨å¤„ç† \\#{} æ—¶ï¼Œä¼šå°† SQL ä¸­çš„ \\#{} æ›¿æ¢ä¸º ? å·ï¼Œè°ƒç”¨ PreparedStatement çš„ set æ–¹æ³•æ¥èµ‹å€¼ã€‚\nè¿™æ˜¯**é¢„ç¼–è¯‘å¤„ç†**ï¼Œå¯ä»¥æé«˜ SQL æ‰§è¡Œæ•ˆç‡ï¼Œæ›´é‡è¦çš„æ˜¯**å¯ä»¥é˜²æ­¢SQLæ³¨å…¥**ï¼›\n\nmybatis åœ¨å¤„ç† \\${} æ—¶ï¼Œå°±æ˜¯æŠŠ \\${} ä½¿ç”¨**å­—ç¬¦ä¸²æ›¿æ¢**ã€‚ä½¿ç”¨è¯¥æ–¹å¼å¦‚æœä¼ å…¥ id çš„è¯ï¼Œä¼šæŠŠ id=1 è½¬æ¢ä¸º id=\"1\"å­—ç¬¦ä¸²å½¢å¼ï¼Œè€Œæ•°æ®åº“ä¸­ id å®é™…ä¸ºæ•°å€¼å‹è¿™æ ·å°±ä¸åŒ¹é…äº†ï¼ŒæŸ¥è¯¢å¤±è´¥ã€‚ï¼ˆ\\${}æ˜¯å­—ç¬¦ä¸²æ›¿æ¢ï¼Œé€šå¸¸åœ¨ EL è¡¨è¾¾å¼ä¸­ä½¿ç”¨ï¼Œç”¨æ¥å±•ç¤ºåç«¯ä¼ é€’åˆ°å‰ç«¯çš„å€¼ï¼‰ã€‚\n\n### å½“å®ä½“ç±»ä¸­çš„å±æ€§åå’Œè¡¨ä¸­çš„å­—æ®µåä¸ä¸€æ · ï¼Œæ€ä¹ˆåŠ ï¼Ÿ\n\n1. é€šè¿‡åœ¨æŸ¥è¯¢çš„ SQL è¯­å¥ä¸­å®šä¹‰æ•°æ®åº“å­—æ®µåçš„åˆ«åï¼Œè®©æ•°æ®åº“å­—æ®µåçš„åˆ«åå’Œå®ä½“ç±»çš„å±æ€§åä¸€è‡´ã€‚\n2. é€šè¿‡ `<resultMap>`æ¥æ˜ å°„å­—æ®µåå’Œå®ä½“ç±»å±æ€§åçš„ä¸€ä¸€å¯¹åº”çš„å…³ç³»ã€‚\n\n### æ¨¡ç³ŠæŸ¥è¯¢likeè¯­å¥è¯¥æ€ä¹ˆå†™?\n\n1. åœ¨ Java ä»£ç ä¸­æ·»åŠ  SQL é€šé…ç¬¦ã€‚\n\n\t```xml\n\tstring wildcardname = â€œ%smi%â€;\n\tlist<name> names = mapper.selectlike(wildcardname);\n\t\n\t<select id=â€selectlikeâ€>\n\t\tselect * from foo where bar like #{value}\n\t</select>\n\t```\n\n2. åœ¨ SQL è¯­å¥ä¸­æ‹¼æ¥é€šé…ç¬¦%ï¼Œä¼šå¼•èµ· SQL æ³¨å…¥\n\n\t```xml\n\tstring wildcardname = â€œsmiâ€;\n\tlist<name> names = mapper.selectlike(wildcardname);\n\t\n\t<select id=â€selectlikeâ€>\n\t\tselect * from foo where bar like \"%\"#{value}\"%\"\n\t</select>\n\t```\n\n### MyBatiséƒ½æœ‰å“ªäº›Executoræ‰§è¡Œå™¨ï¼Ÿå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\n\nMyBatis æœ‰ä¸‰ç§åŸºæœ¬çš„ Executor æ‰§è¡Œå™¨ï¼ŒSimpleExecutorã€ReuseExecutorã€BatchExecutorã€‚\n\n- **SimpleExecutor** ï¼šæ¯æ¬¡å¼€å¯ä¸€ä¸ª Statement å¯¹è±¡ï¼Œç”¨å®Œç«‹åˆ»å…³é—­ Statement å¯¹è±¡ã€‚\n- **ReuseExecutor** ï¼šé‡å¤ä½¿ç”¨åˆ›å»ºçš„ Statement å¯¹è±¡ã€‚\n- **BatchExecutor** ï¼šç¼“å­˜äº†å¤šä¸ª Statement å¯¹è±¡ï¼Œä¸€èµ·æ‰§è¡Œæ‰¹é‡æ›´æ–°ã€‚\n\n### é€šå¸¸ä¸€ä¸ªxmlæ˜ å°„æ–‡ä»¶ï¼Œéƒ½ä¼šå†™ä¸€ä¸ªDaoæ¥å£ä¸ä¹‹å¯¹åº”ï¼Œè¯·é—®ï¼Œè¿™ä¸ªDaoæ¥å£çš„å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆï¼ŸDaoæ¥å£é‡Œçš„æ–¹æ³•ï¼Œå‚æ•°ä¸åŒæ—¶ï¼Œæ–¹æ³•èƒ½é‡è½½å—ï¼Ÿ\n\nDao æ¥å£ï¼Œå°±æ˜¯äººä»¬å¸¸è¯´çš„ `Mapper`æ¥å£ï¼Œæ¥å£çš„å…¨é™åï¼Œå°±æ˜¯æ˜ å°„æ–‡ä»¶ä¸­çš„ namespace çš„å€¼ï¼Œæ¥å£çš„æ–¹æ³•åï¼Œå°±æ˜¯æ˜ å°„æ–‡ä»¶ä¸­`MappedStatement`çš„ id å€¼ï¼Œæ¥å£æ–¹æ³•å†…çš„å‚æ•°ï¼Œå°±æ˜¯ä¼ é€’ç»™ SQL çš„å‚æ•°ã€‚`Mapper`æ¥å£æ˜¯æ²¡æœ‰å®ç°ç±»çš„ï¼Œå½“è°ƒç”¨æ¥å£æ–¹æ³•æ—¶ï¼Œæ¥å£å…¨é™å+æ–¹æ³•åæ‹¼æ¥å­—ç¬¦ä¸²ä½œä¸º key å€¼ï¼Œå¯å”¯ä¸€å®šä½ä¸€ä¸ª`MappedStatement`ï¼Œä¸¾ä¾‹ï¼š`com.yaxing.dao.IUserDao.findAll`ï¼Œå¯ä»¥å”¯ä¸€æ‰¾åˆ° namespace ä¸º`com.yaxing.dao.IUserDao`ä¸‹é¢`id = findAll`çš„`MappedStatement`ã€‚åœ¨ MyBatis ä¸­ï¼Œæ¯ä¸€ä¸ª`<select>`ã€`<insert>`ã€`<update>`ã€`<delete>`æ ‡ç­¾ï¼Œéƒ½ä¼šè¢«è§£æä¸ºä¸€ä¸ª`MappedStatement`å¯¹è±¡ï¼Œç„¶åæ‰§è¡Œåç»­çš„æ“ä½œã€‚\n\n```xml\n<mapper namespace=\"com.yaxing.dao.IUserDao\">\n    <select id=\"findAll\" resultType=\"com.yaxing.domain.User\">\n        select * from user;\n    </select>\n</mapper>\n```\n\nDao æ¥å£é‡Œçš„æ–¹æ³•å¯ä»¥é‡è½½ï¼Œä½†æ˜¯ MyBatis çš„ XML é‡Œé¢çš„ ID ä¸å…è®¸é‡å¤ï¼Œä¹Ÿå°±æ˜¯è¯´å¯¹äºåŒä¸€ä¸ªæ¥å£æ–¹æ³•åï¼Œmapper æ–‡ä»¶ä¸­åªèƒ½æœ‰ä¸€ä¸ªè¯¥ idã€‚\nå¯ä»¥ä½¿ç”¨åŠ¨æ€ SQL å®ç°æ¥å£é‡è½½å¯¹åº”çš„ maperã€‚\n\n```java\n/**\n * Mapperæ¥å£é‡Œé¢æ–¹æ³•é‡è½½\n */\npublic interface StuMapper {\n    List<Student> getAllStu();\n    List<Student> getAllStu(@Param(\"id\") Integer id);\n}\n```\n\nç„¶ååœ¨ `StuMapper.xml` ä¸­åˆ©ç”¨ MyBatis çš„åŠ¨æ€ SQL å°±å¯ä»¥å®ç°ã€‚\n\n```xml\n<select id=\"getAllStu\" resultType=\"com.pojo.Student\">\n    select * from student\n    <where>\n        <if test=\"id != null\">\n            id = #{id}\n        </if>\n    </where>\n</select>\n```\n\nèƒ½æ­£å¸¸è¿è¡Œï¼Œå¹¶èƒ½å¾—åˆ°ç›¸åº”çš„ç»“æœï¼Œè¿™æ ·å°±å®ç°äº†åœ¨ Dao æ¥å£ä¸­å†™é‡è½½æ–¹æ³•ã€‚\n\n**MyBatis çš„ Dao æ¥å£å¯ä»¥æœ‰å¤šä¸ªé‡è½½æ–¹æ³•ï¼Œä½†æ˜¯å¤šä¸ªæ¥å£å¯¹åº”çš„æ˜ å°„å¿…é¡»åªæœ‰ä¸€ä¸ªï¼Œå¦åˆ™å¯åŠ¨ä¼šæŠ¥é”™ã€‚**\n\n### MyBatisæ˜¯å¦‚ä½•å°†SQLæ‰§è¡Œç»“æœå°è£…ä¸ºç›®æ ‡å¯¹è±¡å¹¶è¿”å›çš„ï¼Ÿéƒ½æœ‰å“ªäº›æ˜ å°„å½¢å¼ï¼Ÿ\n\n1. ä½¿ç”¨ `<resultMap>`æ ‡ç­¾ï¼Œé€ä¸€å®šä¹‰æ•°æ®åº“åˆ—åå’Œå¯¹è±¡å±æ€§åä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚\n\n2. ä½¿ç”¨ SQL åˆ—çš„åˆ«ååŠŸèƒ½ï¼Œå°†åˆ—çš„åˆ«åå±æ€§å¯¹åº”ä¸ºå¯¹è±¡å±æ€§åã€‚\n\næœ‰äº†åˆ—åä¸å±æ€§åçš„æ˜ å°„å…³ç³»åï¼ŒMyBatis**é€šè¿‡åå°„åˆ›å»ºå¯¹è±¡**ï¼ŒåŒæ—¶**ä½¿ç”¨åå°„ç»™å¯¹è±¡çš„å±æ€§é€ä¸€èµ‹å€¼**å¹¶è¿”å›ï¼Œé‚£äº›æ‰¾ä¸åˆ°æ˜ å°„å…³ç³»çš„å±æ€§ï¼Œæ˜¯æ— æ³•å®Œæˆèµ‹å€¼çš„ã€‚\n\n### åœ¨mapperä¸­å¦‚ä½•ä¼ é€’å¤šä¸ªå‚æ•°?\n\n1. é¡ºåºä¼ å‚æ³•ï¼Œ\\#{} é‡Œé¢çš„æ•°å­—ä»£è¡¨ä¼ å…¥å‚æ•°çš„é¡ºåº\n2. @Param æ³¨è§£ä¼ å‚æ³•ï¼Œ\\#{} é‡Œé¢çš„åç§°å¯¹åº”çš„æ˜¯æ³¨è§£@Param æ‹¬å·é‡Œé¢ä¿®é¥°çš„åç§°\n3. map ä¼ å‚ï¼Œ\\#{} é‡Œé¢çš„åç§°å¯¹åº”çš„æ˜¯ Map é‡Œé¢çš„ key åç§°ã€‚\n4. Java Bean ä¼ å‚æ³•ï¼Œ\\#{} é‡Œé¢çš„åç§°å¯¹åº”çš„æ˜¯ User ç±»é‡Œé¢çš„æˆå‘˜å±æ€§ã€‚\n\n### MyBatisåŠ¨æ€SQLæœ‰ä»€ä¹ˆç”¨ï¼Ÿæ‰§è¡ŒåŸç†ï¼Ÿæœ‰å“ªäº›åŠ¨æ€SQLï¼Ÿ\n\nMyBatis åŠ¨æ€ SQL å¯ä»¥åœ¨ xml æ˜ å°„æ–‡ä»¶å†…ï¼Œä»¥æ ‡ç­¾çš„å½¢å¼ç¼–å†™åŠ¨æ€ SQL.\n\næ‰§è¡ŒåŸç†æ˜¯æ ¹æ®è¡¨è¾¾å¼çš„å€¼ å®Œæˆé€»è¾‘åˆ¤æ–­å¹¶åŠ¨æ€æ‹¼æ¥ SQLã€‚\n\nMyBatis æä¾›äº† 9 ç§åŠ¨æ€ SQL æ ‡ç­¾ï¼š å¸¸ç”¨çš„æœ‰ `if|where|foreach`\n\n```xml\n<select id=\"getAllStu\" resultType=\"com.pojo.Student\">\n    select * from student\n    <where>\n        <if test=\"id != null\">\n            id = #{id}\n        </if>\n    </where>\n</select>\n```\n\n### MyBatiså®ç°ä¸€å¯¹å¤šæœ‰å‡ ç§æ–¹å¼,æ€ä¹ˆæ“ä½œçš„ï¼Ÿ\n\næœ‰**è”åˆæŸ¥è¯¢**å’Œ**åµŒå¥—æŸ¥è¯¢**ã€‚\n\nè”åˆæŸ¥è¯¢æ˜¯å‡ ä¸ªè¡¨è”åˆæŸ¥è¯¢,åªæŸ¥è¯¢ä¸€æ¬¡,é€šè¿‡åœ¨ resultMap é‡Œé¢çš„ collection èŠ‚ç‚¹é…ç½®ä¸€å¯¹å¤šçš„ç±»å°±å¯ä»¥å®Œæˆï¼›\n\nåµŒå¥—æŸ¥è¯¢æ˜¯å…ˆæŸ¥ä¸€ä¸ªè¡¨,æ ¹æ®è¿™ä¸ªè¡¨é‡Œé¢çš„ ç»“æœçš„å¤–é”® id,å»å†å¦å¤–ä¸€ä¸ªè¡¨é‡Œé¢æŸ¥è¯¢æ•°æ®,ä¹Ÿæ˜¯é€šè¿‡é…ç½® collection,ä½†å¦å¤–ä¸€ä¸ªè¡¨çš„æŸ¥è¯¢é€šè¿‡ select èŠ‚ç‚¹é…ç½®ã€‚\n\n### MyBatisæ˜¯å¦æ”¯æŒå»¶è¿ŸåŠ è½½ï¼Ÿå¦‚æœæ”¯æŒï¼Œå®ƒçš„å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ\n\nMyBatis ä»…æ”¯æŒ association å…³è”å¯¹è±¡å’Œ collection å…³è”é›†åˆå¯¹è±¡çš„å»¶è¿ŸåŠ è½½ã€‚\nassociation æŒ‡çš„å°±æ˜¯ä¸€å¯¹ä¸€ï¼Œcollection æŒ‡çš„å°±æ˜¯ä¸€å¯¹å¤šæŸ¥è¯¢ã€‚\nåœ¨ MyBatis é…ç½®æ–‡ä»¶ä¸­ï¼Œå¯ä»¥é…ç½®æ˜¯å¦å¯ç”¨å»¶è¿ŸåŠ è½½ lazyLoadingEnabled=true|falseã€‚\n\nå®ƒçš„åŸç†æ˜¯ï¼Œä½¿ç”¨ CGLIB åˆ›å»ºç›®æ ‡å¯¹è±¡çš„ä»£ç†å¯¹è±¡ï¼Œå½“è°ƒç”¨ç›®æ ‡æ–¹æ³•æ—¶ï¼Œè¿›å…¥æ‹¦æˆªå™¨æ–¹æ³•ï¼Œæ¯”å¦‚è°ƒç”¨ a.getB().getName()ï¼Œæ‹¦æˆªå™¨ invoke()æ–¹æ³•å‘ç° a.getB()æ˜¯ null å€¼ï¼Œé‚£ä¹ˆå°±ä¼šå•ç‹¬å‘é€äº‹å…ˆä¿å­˜å¥½çš„æŸ¥è¯¢å…³è” B å¯¹è±¡çš„ SQLï¼ŒæŠŠ B æŸ¥è¯¢ä¸Šæ¥ï¼Œç„¶åè°ƒç”¨ a.setB(b)ï¼Œäºæ˜¯ a çš„å¯¹è±¡ b å±æ€§å°±æœ‰å€¼äº†ï¼Œæ¥ç€å®Œæˆ a.getB().getName()æ–¹æ³•çš„è°ƒç”¨ã€‚è¿™å°±æ˜¯å»¶è¿ŸåŠ è½½çš„åŸºæœ¬åŸç†ã€‚\n\n### MyBatisçš„ä¸€çº§ã€äºŒçº§ç¼“å­˜\n\n**ä¸€çº§ç¼“å­˜**ï¼šä¸€çº§ç¼“å­˜æ˜¯ SqlSession èŒƒå›´çš„ç¼“å­˜\n\nå½“æˆ‘ä»¬æ‰§è¡ŒæŸ¥è¯¢ä¹‹åï¼ŒæŸ¥è¯¢çš„ç»“æœä¼šåŒæ—¶å­˜å…¥åˆ° SqlSession ä¸ºæˆ‘ä»¬æä¾›çš„ä¸€å—åŒºåŸŸä¸­ã€‚è¯¥åŒºåŸŸçš„ç»“æ„æ˜¯ä¸€ä¸ª Mapã€‚\nå½“æˆ‘ä»¬å†æ¬¡æŸ¥è¯¢åŒæ ·çš„æ•°æ®æ—¶ï¼ŒMyBatis ä¼šå…ˆå» SqlSession ä¸­æŸ¥è¯¢æ˜¯å¦æœ‰ï¼Œæœ‰çš„è¯ç›´æ¥æ‹¿å‡ºæ¥ç”¨ã€‚\n\nå½“è°ƒç”¨ SqlSession çš„æ·»åŠ ï¼Œä¿®æ”¹ï¼Œåˆ é™¤ï¼Œcommit()ï¼Œclose()ã€clearCache()ç­‰æ–¹æ³•æ—¶ï¼Œå°±ä¼šæ¸…ç©ºä¸€çº§ç¼“å­˜ã€‚\n\n> ç¬¬ä¸€æ¬¡å‘èµ·æŸ¥è¯¢ç”¨æˆ·idä¸º1çš„ç”¨æˆ·ä¿¡æ¯ï¼Œå…ˆå»æ‰¾ç¼“å­˜ä¸­æ˜¯å¦æœ‰idä¸º1çš„ç”¨æˆ·ä¿¡æ¯ï¼Œå¦‚æœæ²¡æœ‰ï¼Œä»æ•°æ®åº“æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ã€‚ \n> å¾—åˆ°ç”¨æˆ·ä¿¡æ¯ï¼Œå°†ç”¨æˆ·ä¿¡æ¯å­˜å‚¨åˆ°ä¸€çº§ç¼“å­˜ä¸­ã€‚ \n> å¦‚æœSQLSessionå»æ‰§è¡Œcommitæ“ä½œï¼ˆæ‰§è¡Œæ’å…¥ã€æ›´æ–°ã€åˆ é™¤ï¼‰ï¼Œæ¸…ç©ºSqlSessionä¸­çš„ä¸€çº§ç¼“å­˜ï¼Œè¿™æ ·åšçš„ç›®çš„ä¸ºäº†è®©ç¼“å­˜ä¸­å­˜å‚¨çš„æ˜¯æœ€æ–°çš„ä¿¡æ¯ï¼Œé¿å…è„è¯»ã€‚ \n> ç¬¬äºŒæ¬¡å‘èµ·æŸ¥è¯¢ç”¨æˆ·idä¸º1çš„ç”¨æˆ·ä¿¡æ¯ï¼Œå…ˆå»æ‰¾ç¼“å­˜ä¸­æ˜¯å¦æœ‰idä¸º1çš„ç”¨æˆ·ä¿¡æ¯ï¼Œç¼“å­˜ä¸­æœ‰ï¼Œç›´æ¥ä»ç¼“å­˜ä¸­è·å–ç”¨æˆ·ä¿¡æ¯ã€‚\n\n**äºŒçº§ç¼“å­˜**ï¼šäºŒçº§ç¼“å­˜æ˜¯ mapper æ˜ å°„çº§åˆ«çš„ç¼“å­˜ï¼Œå¤šä¸ª SqlSession å»æ“ä½œåŒä¸€ä¸ª Mapper æ˜ å°„çš„ SQL è¯­å¥ï¼Œå¤šä¸ª SqlSession å¯ä»¥å…±ç”¨äºŒçº§ç¼“å­˜ï¼ŒäºŒçº§ç¼“å­˜æ˜¯è·¨ SqlSession çš„ã€‚\n\nMyBatis ä¸­ SqlSessionFactory å¯¹è±¡çš„ç¼“å­˜\n\nâ€‹\tç”±åŒä¸€ä¸ª SqlSessionFactory å¯¹è±¡åˆ›å»ºçš„ SqlSession å…±äº«å…¶ç¼“å­˜ã€‚\n\nâ€‹\täºŒçº§ç¼“å­˜å­˜æ”¾çš„æ˜¯æ•°æ®ï¼Œè€Œä¸æ˜¯å¯¹è±¡ã€‚\n\n> SQLSession1å»æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ï¼ŒæŸ¥è¯¢åˆ°ç”¨æˆ·ä¿¡æ¯ä¼šå°†æŸ¥è¯¢æ•°æ®å­˜å‚¨åˆ°äºŒçº§ç¼“å­˜ä¸­ã€‚\n> å¦‚æœSqlSession3å»æ‰§è¡Œç›¸åŒ mapperæ˜ å°„ä¸‹SQLï¼Œæ‰§è¡Œcommitæäº¤ï¼Œå°†ä¼šæ¸…ç©ºè¯¥ mapperæ˜ å°„ä¸‹çš„äºŒçº§ç¼“å­˜åŒºåŸŸçš„æ•°æ®ã€‚ \n> SQLSession2å»æŸ¥è¯¢ä¸SQLSession1ç›¸åŒçš„ç”¨æˆ·ä¿¡æ¯ï¼Œé¦–å…ˆä¼šå»ç¼“å­˜ä¸­æ‰¾æ˜¯å¦å­˜åœ¨æ•°æ®ï¼Œå¦‚æœå­˜åœ¨ç›´æ¥ä»ç¼“å­˜ä¸­å–å‡ºæ•°æ®ã€‚\n\n1ï¼‰ä¸€çº§ç¼“å­˜: åŸºäº PerpetualCache çš„ HashMap æœ¬åœ°ç¼“å­˜ï¼Œå…¶å­˜å‚¨ä½œç”¨åŸŸä¸º Sessionï¼Œå½“ Session flush æˆ– close ä¹‹åï¼Œè¯¥ Session ä¸­çš„æ‰€æœ‰ Cache å°±å°†æ¸…ç©ºï¼Œé»˜è®¤æ‰“å¼€ä¸€çº§ç¼“å­˜ï¼›\n\n2ï¼‰äºŒçº§ç¼“å­˜ä¸ä¸€çº§ç¼“å­˜å…¶æœºåˆ¶ç›¸åŒï¼Œé»˜è®¤ä¹Ÿæ˜¯é‡‡ç”¨ PerpetualCacheï¼ŒHashMap å­˜å‚¨ï¼Œä¸åŒåœ¨äºå…¶å­˜å‚¨ä½œç”¨åŸŸä¸º Mapper(Namespace)ï¼Œå¹¶ä¸”å¯è‡ªå®šä¹‰å­˜å‚¨æºï¼Œå¦‚ Ehcacheã€‚é»˜è®¤ä¸æ‰“å¼€äºŒçº§ç¼“å­˜ï¼Œè¦å¼€å¯äºŒçº§ç¼“å­˜ï¼Œä½¿ç”¨äºŒçº§ç¼“å­˜å±æ€§ç±»éœ€è¦å®ç° Serializable åºåˆ—åŒ–æ¥å£(å¯ç”¨æ¥ä¿å­˜å¯¹è±¡çš„çŠ¶æ€),å¯åœ¨å®ƒçš„æ˜ å°„æ–‡ä»¶ä¸­é…ç½® `<cache/>` ï¼›\n\n3ï¼‰å¯¹äºç¼“å­˜æ•°æ®æ›´æ–°æœºåˆ¶ï¼Œå½“æŸä¸€ä¸ªä½œç”¨åŸŸ(ä¸€çº§ç¼“å­˜ Session/äºŒçº§ç¼“å­˜ Namespaces)çš„è¿›è¡Œäº† C/U/D æ“ä½œåï¼Œé»˜è®¤è¯¥ä½œç”¨åŸŸä¸‹æ‰€æœ‰ select ä¸­çš„ç¼“å­˜å°†è¢« clearã€‚ \n\n### ä»€ä¹ˆæ˜¯MyBatisçš„æ¥å£ç»‘å®šï¼Ÿæœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ\n\næ¥å£ç»‘å®šï¼Œå°±æ˜¯åœ¨ MyBatis ä¸­ä»»æ„å®šä¹‰æ¥å£,ç„¶åæŠŠæ¥å£é‡Œé¢çš„æ–¹æ³•å’Œ SQL è¯­å¥ç»‘å®š, æˆ‘ä»¬ç›´æ¥è°ƒç”¨æ¥å£æ–¹æ³•å°±å¯ä»¥,è¿™æ ·æ¯”èµ·åŸæ¥äº† SqlSession æä¾›çš„æ–¹æ³•æˆ‘ä»¬å¯ä»¥æœ‰æ›´åŠ çµæ´»çš„é€‰æ‹©å’Œè®¾ç½®ã€‚\n\næ¥å£ç»‘å®šæœ‰ä¸¤ç§å®ç°æ–¹å¼ï¼š\n\n1. é€šè¿‡æ³¨è§£ç»‘å®šï¼Œå°±æ˜¯åœ¨æ¥å£çš„æ–¹æ³•ä¸Šé¢åŠ ä¸Š @Selectã€@Update ç­‰æ³¨è§£ï¼Œé‡Œé¢åŒ…å« Sql è¯­å¥æ¥ç»‘å®šï¼›\n2. é€šè¿‡ xml é‡Œé¢å†™ SQL æ¥ç»‘å®š, åœ¨è¿™ç§æƒ…å†µä¸‹,è¦æŒ‡å®š xml æ˜ å°„æ–‡ä»¶é‡Œé¢çš„ namespace å¿…é¡»ä¸ºæ¥å£çš„å…¨è·¯å¾„åã€‚å½“ Sql è¯­å¥æ¯”è¾ƒç®€å•æ—¶å€™,ç”¨æ³¨è§£ç»‘å®š, å½“ SQL è¯­å¥æ¯”è¾ƒå¤æ‚æ—¶å€™,ç”¨ xml ç»‘å®š,ä¸€èˆ¬ç”¨ xml ç»‘å®šçš„æ¯”è¾ƒå¤šã€‚\n","slug":"Javaå…«è‚¡æ–‡ - MyBatis","published":1,"updated":"2023-01-26T12:35:58.974Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cldzfw31y000bt9t8d77e6f6g","content":"<blockquote>\n<p>æ•´ç†çš„MyBatisæ¡†æ¶ç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½<span id=\"more\"></span></p>\n</blockquote>\n<h3 id=\"ä»€ä¹ˆæ˜¯MyBatisï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯MyBatisï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯MyBatisï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯MyBatisï¼Ÿ</h3><ol>\n<li>MyBatis æ˜¯ä¸€ä¸ªåŠ ORMï¼ˆå¯¹è±¡å…³ç³»æ˜ å°„ï¼‰æ¡†æ¶ï¼Œå®ƒå†…éƒ¨å°è£…äº† JDBCï¼Œå¼€å‘æ—¶åªéœ€è¦å…³æ³¨ SQL è¯­å¥æœ¬èº«ï¼Œä¸éœ€è¦èŠ±è´¹ç²¾åŠ›å»å¤„ç†<strong>åŠ è½½é©±åŠ¨ã€åˆ›å»ºè¿æ¥ã€åˆ›å»ºstatement</strong>ç­‰ç¹æ‚çš„è¿‡ç¨‹ã€‚</li>\n<li>é€šè¿‡ xml æ–‡ä»¶æˆ–æ³¨è§£çš„æ–¹å¼å°†è¦æ‰§è¡Œçš„å„ç§ statement é…ç½®èµ·æ¥ï¼Œå¹¶é€šè¿‡ java å¯¹è±¡å’Œ statement ä¸­ SQL çš„åŠ¨æ€å‚æ•°è¿›è¡Œæ˜ å°„ç”Ÿæˆæœ€ç»ˆæ‰§è¡Œçš„ SQL è¯­å¥ï¼Œæœ€åç”± mybatis æ¡†æ¶æ‰§è¡Œ SQL å¹¶å°†ç»“æœæ˜ å°„ä¸º java å¯¹è±¡å¹¶è¿”å›ã€‚ï¼ˆä»æ‰§è¡Œ SQL åˆ°è¿”å› result çš„è¿‡ç¨‹ï¼‰ã€‚</li>\n</ol>\n<h3 id=\"ORMæ˜¯ä»€ä¹ˆ\"><a href=\"#ORMæ˜¯ä»€ä¹ˆ\" class=\"headerlink\" title=\"ORMæ˜¯ä»€ä¹ˆ\"></a>ORMæ˜¯ä»€ä¹ˆ</h3><p>ORMï¼ˆObject Relational Mappingï¼‰ï¼Œå¯¹è±¡å…³ç³»æ˜ å°„ï¼Œå°±æ˜¯æŠŠæ•°æ®åº“è¡¨å’Œå®ä½“ç±»åŠå®ä½“ç±»çš„å±æ€§å¯¹åº”èµ·æ¥</p>\n<p>è®©æˆ‘ä»¬å¯ä»¥æ“ä½œå®ä½“ç±»å°±å®ç°æ“ä½œæ•°æ®åº“è¡¨ã€‚</p>\n<h3 id=\"ä¸ºä»€ä¹ˆè¯´MyBatisæ˜¯åŠè‡ªåŠ¨ORMæ˜ å°„å·¥å…·ï¼Ÿå®ƒä¸å…¨è‡ªåŠ¨çš„åŒºåˆ«åœ¨å“ªé‡Œï¼Ÿ\"><a href=\"#ä¸ºä»€ä¹ˆè¯´MyBatisæ˜¯åŠè‡ªåŠ¨ORMæ˜ å°„å·¥å…·ï¼Ÿå®ƒä¸å…¨è‡ªåŠ¨çš„åŒºåˆ«åœ¨å“ªé‡Œï¼Ÿ\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆè¯´MyBatisæ˜¯åŠè‡ªåŠ¨ORMæ˜ å°„å·¥å…·ï¼Ÿå®ƒä¸å…¨è‡ªåŠ¨çš„åŒºåˆ«åœ¨å“ªé‡Œï¼Ÿ\"></a>ä¸ºä»€ä¹ˆè¯´MyBatisæ˜¯åŠè‡ªåŠ¨ORMæ˜ å°„å·¥å…·ï¼Ÿå®ƒä¸å…¨è‡ªåŠ¨çš„åŒºåˆ«åœ¨å“ªé‡Œï¼Ÿ</h3><p>MyBatis åœ¨æŸ¥è¯¢å…³è”å¯¹è±¡æˆ–å…³è”é›†åˆå¯¹è±¡æ—¶ï¼Œéœ€è¦æ‰‹åŠ¨ç¼–å†™ SQL æ¥å®Œæˆï¼Œæ‰€ä»¥ï¼Œç§°ä¹‹ä¸ºåŠè‡ªåŠ¨ ORM æ˜ å°„å·¥å…·ã€‚</p>\n<h3 id=\"JDBCç¼–ç¨‹æœ‰å“ªäº›ä¸è¶³ä¹‹å¤„ï¼ŒMyBatisæ˜¯å¦‚ä½•è§£å†³çš„ï¼Ÿ\"><a href=\"#JDBCç¼–ç¨‹æœ‰å“ªäº›ä¸è¶³ä¹‹å¤„ï¼ŒMyBatisæ˜¯å¦‚ä½•è§£å†³çš„ï¼Ÿ\" class=\"headerlink\" title=\"JDBCç¼–ç¨‹æœ‰å“ªäº›ä¸è¶³ä¹‹å¤„ï¼ŒMyBatisæ˜¯å¦‚ä½•è§£å†³çš„ï¼Ÿ\"></a>JDBCç¼–ç¨‹æœ‰å“ªäº›ä¸è¶³ä¹‹å¤„ï¼ŒMyBatisæ˜¯å¦‚ä½•è§£å†³çš„ï¼Ÿ</h3><ol>\n<li>æ•°æ®åº“è¿æ¥åˆ›å»ºã€é‡Šæ”¾é¢‘ç¹ï¼Œé€ æˆç³»ç»Ÿèµ„æºæµªè´¹ä»è€Œå½±å“ç³»ç»Ÿæ€§èƒ½</li>\n<li>SQL è¯­å¥å†™åœ¨ä»£ç ä¸­é€ æˆä»£ç <strong>ä¸æ˜“ç»´æŠ¤</strong></li>\n<li>å‘ SQL è¯­å¥<strong>ä¼ å‚</strong>éº»çƒ¦</li>\n<li>å¯¹<strong>ç»“æœé›†è§£æ</strong>éº»çƒ¦</li>\n</ol>\n<h3 id=\"MyBatisç¼–ç¨‹æ­¥éª¤æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ\"><a href=\"#MyBatisç¼–ç¨‹æ­¥éª¤æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ\" class=\"headerlink\" title=\"MyBatisç¼–ç¨‹æ­¥éª¤æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ\"></a>MyBatisç¼–ç¨‹æ­¥éª¤æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ</h3><ol>\n<li>è¯»å–é…ç½®æ–‡ä»¶ï¼Œåˆ›å»º SqlSessionFactory å·¥å‚</li>\n<li>é€šè¿‡ SqlSessionFactory å·¥å‚åˆ›å»º SqlSession å¯¹è±¡</li>\n<li>ä½¿ç”¨ SqlSession åˆ›å»º Dao æ¥å£çš„ä»£ç†å¯¹è±¡</li>\n<li>ä½¿ç”¨ä»£ç†å¯¹è±¡æ‰§è¡Œæ–¹æ³•</li>\n<li>è°ƒç”¨ session.commit()æäº¤äº‹åŠ¡</li>\n<li>è°ƒç”¨ session.close()å…³é—­ä¼šè¯</li>\n</ol>\n<h3 id=\"å’Œ-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#å’Œ-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"#{}å’Œ${}çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>#{}å’Œ${}çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>mybatis åœ¨å¤„ç† #{} æ—¶ï¼Œä¼šå°† SQL ä¸­çš„ #{} æ›¿æ¢ä¸º ? å·ï¼Œè°ƒç”¨ PreparedStatement çš„ set æ–¹æ³•æ¥èµ‹å€¼ã€‚<br>è¿™æ˜¯<strong>é¢„ç¼–è¯‘å¤„ç†</strong>ï¼Œå¯ä»¥æé«˜ SQL æ‰§è¡Œæ•ˆç‡ï¼Œæ›´é‡è¦çš„æ˜¯<strong>å¯ä»¥é˜²æ­¢SQLæ³¨å…¥</strong>ï¼›</p>\n<p>mybatis åœ¨å¤„ç† ${} æ—¶ï¼Œå°±æ˜¯æŠŠ ${} ä½¿ç”¨<strong>å­—ç¬¦ä¸²æ›¿æ¢</strong>ã€‚ä½¿ç”¨è¯¥æ–¹å¼å¦‚æœä¼ å…¥ id çš„è¯ï¼Œä¼šæŠŠ id&#x3D;1 è½¬æ¢ä¸º id&#x3D;â€1â€å­—ç¬¦ä¸²å½¢å¼ï¼Œè€Œæ•°æ®åº“ä¸­ id å®é™…ä¸ºæ•°å€¼å‹è¿™æ ·å°±ä¸åŒ¹é…äº†ï¼ŒæŸ¥è¯¢å¤±è´¥ã€‚ï¼ˆ${}æ˜¯å­—ç¬¦ä¸²æ›¿æ¢ï¼Œé€šå¸¸åœ¨ EL è¡¨è¾¾å¼ä¸­ä½¿ç”¨ï¼Œç”¨æ¥å±•ç¤ºåç«¯ä¼ é€’åˆ°å‰ç«¯çš„å€¼ï¼‰ã€‚</p>\n<h3 id=\"å½“å®ä½“ç±»ä¸­çš„å±æ€§åå’Œè¡¨ä¸­çš„å­—æ®µåä¸ä¸€æ ·-ï¼Œæ€ä¹ˆåŠ-ï¼Ÿ\"><a href=\"#å½“å®ä½“ç±»ä¸­çš„å±æ€§åå’Œè¡¨ä¸­çš„å­—æ®µåä¸ä¸€æ ·-ï¼Œæ€ä¹ˆåŠ-ï¼Ÿ\" class=\"headerlink\" title=\"å½“å®ä½“ç±»ä¸­çš„å±æ€§åå’Œè¡¨ä¸­çš„å­—æ®µåä¸ä¸€æ · ï¼Œæ€ä¹ˆåŠ ï¼Ÿ\"></a>å½“å®ä½“ç±»ä¸­çš„å±æ€§åå’Œè¡¨ä¸­çš„å­—æ®µåä¸ä¸€æ · ï¼Œæ€ä¹ˆåŠ ï¼Ÿ</h3><ol>\n<li>é€šè¿‡åœ¨æŸ¥è¯¢çš„ SQL è¯­å¥ä¸­å®šä¹‰æ•°æ®åº“å­—æ®µåçš„åˆ«åï¼Œè®©æ•°æ®åº“å­—æ®µåçš„åˆ«åå’Œå®ä½“ç±»çš„å±æ€§åä¸€è‡´ã€‚</li>\n<li>é€šè¿‡ <code>&lt;resultMap&gt;</code>æ¥æ˜ å°„å­—æ®µåå’Œå®ä½“ç±»å±æ€§åçš„ä¸€ä¸€å¯¹åº”çš„å…³ç³»ã€‚</li>\n</ol>\n<h3 id=\"æ¨¡ç³ŠæŸ¥è¯¢likeè¯­å¥è¯¥æ€ä¹ˆå†™\"><a href=\"#æ¨¡ç³ŠæŸ¥è¯¢likeè¯­å¥è¯¥æ€ä¹ˆå†™\" class=\"headerlink\" title=\"æ¨¡ç³ŠæŸ¥è¯¢likeè¯­å¥è¯¥æ€ä¹ˆå†™?\"></a>æ¨¡ç³ŠæŸ¥è¯¢likeè¯­å¥è¯¥æ€ä¹ˆå†™?</h3><ol>\n<li><p>åœ¨ Java ä»£ç ä¸­æ·»åŠ  SQL é€šé…ç¬¦ã€‚</p>\n <figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">string wildcardname = â€œ%smi%â€;</span><br><span class=\"line\">list<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span> names = mapper.selectlike(wildcardname);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">â€selectlikeâ€</span>&gt;</span></span><br><span class=\"line\">\tselect * from foo where bar like #&#123;value&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>åœ¨ SQL è¯­å¥ä¸­æ‹¼æ¥é€šé…ç¬¦%ï¼Œä¼šå¼•èµ· SQL æ³¨å…¥</p>\n <figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">string wildcardname = â€œsmiâ€;</span><br><span class=\"line\">list<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span> names = mapper.selectlike(wildcardname);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">â€selectlikeâ€</span>&gt;</span></span><br><span class=\"line\">\tselect * from foo where bar like &quot;%&quot;#&#123;value&#125;&quot;%&quot;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure></li>\n</ol>\n<h3 id=\"MyBatiséƒ½æœ‰å“ªäº›Executoræ‰§è¡Œå™¨ï¼Ÿå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#MyBatiséƒ½æœ‰å“ªäº›Executoræ‰§è¡Œå™¨ï¼Ÿå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"MyBatiséƒ½æœ‰å“ªäº›Executoræ‰§è¡Œå™¨ï¼Ÿå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>MyBatiséƒ½æœ‰å“ªäº›Executoræ‰§è¡Œå™¨ï¼Ÿå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>MyBatis æœ‰ä¸‰ç§åŸºæœ¬çš„ Executor æ‰§è¡Œå™¨ï¼ŒSimpleExecutorã€ReuseExecutorã€BatchExecutorã€‚</p>\n<ul>\n<li><strong>SimpleExecutor</strong> ï¼šæ¯æ¬¡å¼€å¯ä¸€ä¸ª Statement å¯¹è±¡ï¼Œç”¨å®Œç«‹åˆ»å…³é—­ Statement å¯¹è±¡ã€‚</li>\n<li><strong>ReuseExecutor</strong> ï¼šé‡å¤ä½¿ç”¨åˆ›å»ºçš„ Statement å¯¹è±¡ã€‚</li>\n<li><strong>BatchExecutor</strong> ï¼šç¼“å­˜äº†å¤šä¸ª Statement å¯¹è±¡ï¼Œä¸€èµ·æ‰§è¡Œæ‰¹é‡æ›´æ–°ã€‚</li>\n</ul>\n<h3 id=\"é€šå¸¸ä¸€ä¸ªxmlæ˜ å°„æ–‡ä»¶ï¼Œéƒ½ä¼šå†™ä¸€ä¸ªDaoæ¥å£ä¸ä¹‹å¯¹åº”ï¼Œè¯·é—®ï¼Œè¿™ä¸ªDaoæ¥å£çš„å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆï¼ŸDaoæ¥å£é‡Œçš„æ–¹æ³•ï¼Œå‚æ•°ä¸åŒæ—¶ï¼Œæ–¹æ³•èƒ½é‡è½½å—ï¼Ÿ\"><a href=\"#é€šå¸¸ä¸€ä¸ªxmlæ˜ å°„æ–‡ä»¶ï¼Œéƒ½ä¼šå†™ä¸€ä¸ªDaoæ¥å£ä¸ä¹‹å¯¹åº”ï¼Œè¯·é—®ï¼Œè¿™ä¸ªDaoæ¥å£çš„å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆï¼ŸDaoæ¥å£é‡Œçš„æ–¹æ³•ï¼Œå‚æ•°ä¸åŒæ—¶ï¼Œæ–¹æ³•èƒ½é‡è½½å—ï¼Ÿ\" class=\"headerlink\" title=\"é€šå¸¸ä¸€ä¸ªxmlæ˜ å°„æ–‡ä»¶ï¼Œéƒ½ä¼šå†™ä¸€ä¸ªDaoæ¥å£ä¸ä¹‹å¯¹åº”ï¼Œè¯·é—®ï¼Œè¿™ä¸ªDaoæ¥å£çš„å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆï¼ŸDaoæ¥å£é‡Œçš„æ–¹æ³•ï¼Œå‚æ•°ä¸åŒæ—¶ï¼Œæ–¹æ³•èƒ½é‡è½½å—ï¼Ÿ\"></a>é€šå¸¸ä¸€ä¸ªxmlæ˜ å°„æ–‡ä»¶ï¼Œéƒ½ä¼šå†™ä¸€ä¸ªDaoæ¥å£ä¸ä¹‹å¯¹åº”ï¼Œè¯·é—®ï¼Œè¿™ä¸ªDaoæ¥å£çš„å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆï¼ŸDaoæ¥å£é‡Œçš„æ–¹æ³•ï¼Œå‚æ•°ä¸åŒæ—¶ï¼Œæ–¹æ³•èƒ½é‡è½½å—ï¼Ÿ</h3><p>Dao æ¥å£ï¼Œå°±æ˜¯äººä»¬å¸¸è¯´çš„ <code>Mapper</code>æ¥å£ï¼Œæ¥å£çš„å…¨é™åï¼Œå°±æ˜¯æ˜ å°„æ–‡ä»¶ä¸­çš„ namespace çš„å€¼ï¼Œæ¥å£çš„æ–¹æ³•åï¼Œå°±æ˜¯æ˜ å°„æ–‡ä»¶ä¸­<code>MappedStatement</code>çš„ id å€¼ï¼Œæ¥å£æ–¹æ³•å†…çš„å‚æ•°ï¼Œå°±æ˜¯ä¼ é€’ç»™ SQL çš„å‚æ•°ã€‚<code>Mapper</code>æ¥å£æ˜¯æ²¡æœ‰å®ç°ç±»çš„ï¼Œå½“è°ƒç”¨æ¥å£æ–¹æ³•æ—¶ï¼Œæ¥å£å…¨é™å+æ–¹æ³•åæ‹¼æ¥å­—ç¬¦ä¸²ä½œä¸º key å€¼ï¼Œå¯å”¯ä¸€å®šä½ä¸€ä¸ª<code>MappedStatement</code>ï¼Œä¸¾ä¾‹ï¼š<code>com.yaxing.dao.IUserDao.findAll</code>ï¼Œå¯ä»¥å”¯ä¸€æ‰¾åˆ° namespace ä¸º<code>com.yaxing.dao.IUserDao</code>ä¸‹é¢<code>id = findAll</code>çš„<code>MappedStatement</code>ã€‚åœ¨ MyBatis ä¸­ï¼Œæ¯ä¸€ä¸ª<code>&lt;select&gt;</code>ã€<code>&lt;insert&gt;</code>ã€<code>&lt;update&gt;</code>ã€<code>&lt;delete&gt;</code>æ ‡ç­¾ï¼Œéƒ½ä¼šè¢«è§£æä¸ºä¸€ä¸ª<code>MappedStatement</code>å¯¹è±¡ï¼Œç„¶åæ‰§è¡Œåç»­çš„æ“ä½œã€‚</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">mapper</span> <span class=\"attr\">namespace</span>=<span class=\"string\">&quot;com.yaxing.dao.IUserDao&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;findAll&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;com.yaxing.domain.User&quot;</span>&gt;</span></span><br><span class=\"line\">        select * from user;</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>Dao æ¥å£é‡Œçš„æ–¹æ³•å¯ä»¥é‡è½½ï¼Œä½†æ˜¯ MyBatis çš„ XML é‡Œé¢çš„ ID ä¸å…è®¸é‡å¤ï¼Œä¹Ÿå°±æ˜¯è¯´å¯¹äºåŒä¸€ä¸ªæ¥å£æ–¹æ³•åï¼Œmapper æ–‡ä»¶ä¸­åªèƒ½æœ‰ä¸€ä¸ªè¯¥ idã€‚<br>å¯ä»¥ä½¿ç”¨åŠ¨æ€ SQL å®ç°æ¥å£é‡è½½å¯¹åº”çš„ maperã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Mapperæ¥å£é‡Œé¢æ–¹æ³•é‡è½½</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">StuMapper</span> &#123;</span><br><span class=\"line\">    List&lt;Student&gt; <span class=\"title function_\">getAllStu</span><span class=\"params\">()</span>;</span><br><span class=\"line\">    List&lt;Student&gt; <span class=\"title function_\">getAllStu</span><span class=\"params\">(<span class=\"meta\">@Param(&quot;id&quot;)</span> Integer id)</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>ç„¶ååœ¨ <code>StuMapper.xml</code> ä¸­åˆ©ç”¨ MyBatis çš„åŠ¨æ€ SQL å°±å¯ä»¥å®ç°ã€‚</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;getAllStu&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;com.pojo.Student&quot;</span>&gt;</span></span><br><span class=\"line\">    select * from student</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">where</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;id != null&quot;</span>&gt;</span></span><br><span class=\"line\">            id = #&#123;id&#125;</span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">where</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>èƒ½æ­£å¸¸è¿è¡Œï¼Œå¹¶èƒ½å¾—åˆ°ç›¸åº”çš„ç»“æœï¼Œè¿™æ ·å°±å®ç°äº†åœ¨ Dao æ¥å£ä¸­å†™é‡è½½æ–¹æ³•ã€‚</p>\n<p><strong>MyBatis çš„ Dao æ¥å£å¯ä»¥æœ‰å¤šä¸ªé‡è½½æ–¹æ³•ï¼Œä½†æ˜¯å¤šä¸ªæ¥å£å¯¹åº”çš„æ˜ å°„å¿…é¡»åªæœ‰ä¸€ä¸ªï¼Œå¦åˆ™å¯åŠ¨ä¼šæŠ¥é”™ã€‚</strong></p>\n<h3 id=\"MyBatisæ˜¯å¦‚ä½•å°†SQLæ‰§è¡Œç»“æœå°è£…ä¸ºç›®æ ‡å¯¹è±¡å¹¶è¿”å›çš„ï¼Ÿéƒ½æœ‰å“ªäº›æ˜ å°„å½¢å¼ï¼Ÿ\"><a href=\"#MyBatisæ˜¯å¦‚ä½•å°†SQLæ‰§è¡Œç»“æœå°è£…ä¸ºç›®æ ‡å¯¹è±¡å¹¶è¿”å›çš„ï¼Ÿéƒ½æœ‰å“ªäº›æ˜ å°„å½¢å¼ï¼Ÿ\" class=\"headerlink\" title=\"MyBatisæ˜¯å¦‚ä½•å°†SQLæ‰§è¡Œç»“æœå°è£…ä¸ºç›®æ ‡å¯¹è±¡å¹¶è¿”å›çš„ï¼Ÿéƒ½æœ‰å“ªäº›æ˜ å°„å½¢å¼ï¼Ÿ\"></a>MyBatisæ˜¯å¦‚ä½•å°†SQLæ‰§è¡Œç»“æœå°è£…ä¸ºç›®æ ‡å¯¹è±¡å¹¶è¿”å›çš„ï¼Ÿéƒ½æœ‰å“ªäº›æ˜ å°„å½¢å¼ï¼Ÿ</h3><ol>\n<li><p>ä½¿ç”¨ <code>&lt;resultMap&gt;</code>æ ‡ç­¾ï¼Œé€ä¸€å®šä¹‰æ•°æ®åº“åˆ—åå’Œå¯¹è±¡å±æ€§åä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚</p>\n</li>\n<li><p>ä½¿ç”¨ SQL åˆ—çš„åˆ«ååŠŸèƒ½ï¼Œå°†åˆ—çš„åˆ«åå±æ€§å¯¹åº”ä¸ºå¯¹è±¡å±æ€§åã€‚</p>\n</li>\n</ol>\n<p>æœ‰äº†åˆ—åä¸å±æ€§åçš„æ˜ å°„å…³ç³»åï¼ŒMyBatis<strong>é€šè¿‡åå°„åˆ›å»ºå¯¹è±¡</strong>ï¼ŒåŒæ—¶<strong>ä½¿ç”¨åå°„ç»™å¯¹è±¡çš„å±æ€§é€ä¸€èµ‹å€¼</strong>å¹¶è¿”å›ï¼Œé‚£äº›æ‰¾ä¸åˆ°æ˜ å°„å…³ç³»çš„å±æ€§ï¼Œæ˜¯æ— æ³•å®Œæˆèµ‹å€¼çš„ã€‚</p>\n<h3 id=\"åœ¨mapperä¸­å¦‚ä½•ä¼ é€’å¤šä¸ªå‚æ•°\"><a href=\"#åœ¨mapperä¸­å¦‚ä½•ä¼ é€’å¤šä¸ªå‚æ•°\" class=\"headerlink\" title=\"åœ¨mapperä¸­å¦‚ä½•ä¼ é€’å¤šä¸ªå‚æ•°?\"></a>åœ¨mapperä¸­å¦‚ä½•ä¼ é€’å¤šä¸ªå‚æ•°?</h3><ol>\n<li>é¡ºåºä¼ å‚æ³•ï¼Œ#{} é‡Œé¢çš„æ•°å­—ä»£è¡¨ä¼ å…¥å‚æ•°çš„é¡ºåº</li>\n<li>@Param æ³¨è§£ä¼ å‚æ³•ï¼Œ#{} é‡Œé¢çš„åç§°å¯¹åº”çš„æ˜¯æ³¨è§£@Param æ‹¬å·é‡Œé¢ä¿®é¥°çš„åç§°</li>\n<li>map ä¼ å‚ï¼Œ#{} é‡Œé¢çš„åç§°å¯¹åº”çš„æ˜¯ Map é‡Œé¢çš„ key åç§°ã€‚</li>\n<li>Java Bean ä¼ å‚æ³•ï¼Œ#{} é‡Œé¢çš„åç§°å¯¹åº”çš„æ˜¯ User ç±»é‡Œé¢çš„æˆå‘˜å±æ€§ã€‚</li>\n</ol>\n<h3 id=\"MyBatisåŠ¨æ€SQLæœ‰ä»€ä¹ˆç”¨ï¼Ÿæ‰§è¡ŒåŸç†ï¼Ÿæœ‰å“ªäº›åŠ¨æ€SQLï¼Ÿ\"><a href=\"#MyBatisåŠ¨æ€SQLæœ‰ä»€ä¹ˆç”¨ï¼Ÿæ‰§è¡ŒåŸç†ï¼Ÿæœ‰å“ªäº›åŠ¨æ€SQLï¼Ÿ\" class=\"headerlink\" title=\"MyBatisåŠ¨æ€SQLæœ‰ä»€ä¹ˆç”¨ï¼Ÿæ‰§è¡ŒåŸç†ï¼Ÿæœ‰å“ªäº›åŠ¨æ€SQLï¼Ÿ\"></a>MyBatisåŠ¨æ€SQLæœ‰ä»€ä¹ˆç”¨ï¼Ÿæ‰§è¡ŒåŸç†ï¼Ÿæœ‰å“ªäº›åŠ¨æ€SQLï¼Ÿ</h3><p>MyBatis åŠ¨æ€ SQL å¯ä»¥åœ¨ xml æ˜ å°„æ–‡ä»¶å†…ï¼Œä»¥æ ‡ç­¾çš„å½¢å¼ç¼–å†™åŠ¨æ€ SQL.</p>\n<p>æ‰§è¡ŒåŸç†æ˜¯æ ¹æ®è¡¨è¾¾å¼çš„å€¼ å®Œæˆé€»è¾‘åˆ¤æ–­å¹¶åŠ¨æ€æ‹¼æ¥ SQLã€‚</p>\n<p>MyBatis æä¾›äº† 9 ç§åŠ¨æ€ SQL æ ‡ç­¾ï¼š å¸¸ç”¨çš„æœ‰ <code>if|where|foreach</code></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;getAllStu&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;com.pojo.Student&quot;</span>&gt;</span></span><br><span class=\"line\">    select * from student</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">where</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;id != null&quot;</span>&gt;</span></span><br><span class=\"line\">            id = #&#123;id&#125;</span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">where</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"MyBatiså®ç°ä¸€å¯¹å¤šæœ‰å‡ ç§æ–¹å¼-æ€ä¹ˆæ“ä½œçš„ï¼Ÿ\"><a href=\"#MyBatiså®ç°ä¸€å¯¹å¤šæœ‰å‡ ç§æ–¹å¼-æ€ä¹ˆæ“ä½œçš„ï¼Ÿ\" class=\"headerlink\" title=\"MyBatiså®ç°ä¸€å¯¹å¤šæœ‰å‡ ç§æ–¹å¼,æ€ä¹ˆæ“ä½œçš„ï¼Ÿ\"></a>MyBatiså®ç°ä¸€å¯¹å¤šæœ‰å‡ ç§æ–¹å¼,æ€ä¹ˆæ“ä½œçš„ï¼Ÿ</h3><p>æœ‰<strong>è”åˆæŸ¥è¯¢</strong>å’Œ<strong>åµŒå¥—æŸ¥è¯¢</strong>ã€‚</p>\n<p>è”åˆæŸ¥è¯¢æ˜¯å‡ ä¸ªè¡¨è”åˆæŸ¥è¯¢,åªæŸ¥è¯¢ä¸€æ¬¡,é€šè¿‡åœ¨ resultMap é‡Œé¢çš„ collection èŠ‚ç‚¹é…ç½®ä¸€å¯¹å¤šçš„ç±»å°±å¯ä»¥å®Œæˆï¼›</p>\n<p>åµŒå¥—æŸ¥è¯¢æ˜¯å…ˆæŸ¥ä¸€ä¸ªè¡¨,æ ¹æ®è¿™ä¸ªè¡¨é‡Œé¢çš„ ç»“æœçš„å¤–é”® id,å»å†å¦å¤–ä¸€ä¸ªè¡¨é‡Œé¢æŸ¥è¯¢æ•°æ®,ä¹Ÿæ˜¯é€šè¿‡é…ç½® collection,ä½†å¦å¤–ä¸€ä¸ªè¡¨çš„æŸ¥è¯¢é€šè¿‡ select èŠ‚ç‚¹é…ç½®ã€‚</p>\n<h3 id=\"MyBatisæ˜¯å¦æ”¯æŒå»¶è¿ŸåŠ è½½ï¼Ÿå¦‚æœæ”¯æŒï¼Œå®ƒçš„å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#MyBatisæ˜¯å¦æ”¯æŒå»¶è¿ŸåŠ è½½ï¼Ÿå¦‚æœæ”¯æŒï¼Œå®ƒçš„å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"MyBatisæ˜¯å¦æ”¯æŒå»¶è¿ŸåŠ è½½ï¼Ÿå¦‚æœæ”¯æŒï¼Œå®ƒçš„å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>MyBatisæ˜¯å¦æ”¯æŒå»¶è¿ŸåŠ è½½ï¼Ÿå¦‚æœæ”¯æŒï¼Œå®ƒçš„å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>MyBatis ä»…æ”¯æŒ association å…³è”å¯¹è±¡å’Œ collection å…³è”é›†åˆå¯¹è±¡çš„å»¶è¿ŸåŠ è½½ã€‚<br>association æŒ‡çš„å°±æ˜¯ä¸€å¯¹ä¸€ï¼Œcollection æŒ‡çš„å°±æ˜¯ä¸€å¯¹å¤šæŸ¥è¯¢ã€‚<br>åœ¨ MyBatis é…ç½®æ–‡ä»¶ä¸­ï¼Œå¯ä»¥é…ç½®æ˜¯å¦å¯ç”¨å»¶è¿ŸåŠ è½½ lazyLoadingEnabled&#x3D;true|falseã€‚</p>\n<p>å®ƒçš„åŸç†æ˜¯ï¼Œä½¿ç”¨ CGLIB åˆ›å»ºç›®æ ‡å¯¹è±¡çš„ä»£ç†å¯¹è±¡ï¼Œå½“è°ƒç”¨ç›®æ ‡æ–¹æ³•æ—¶ï¼Œè¿›å…¥æ‹¦æˆªå™¨æ–¹æ³•ï¼Œæ¯”å¦‚è°ƒç”¨ a.getB().getName()ï¼Œæ‹¦æˆªå™¨ invoke()æ–¹æ³•å‘ç° a.getB()æ˜¯ null å€¼ï¼Œé‚£ä¹ˆå°±ä¼šå•ç‹¬å‘é€äº‹å…ˆä¿å­˜å¥½çš„æŸ¥è¯¢å…³è” B å¯¹è±¡çš„ SQLï¼ŒæŠŠ B æŸ¥è¯¢ä¸Šæ¥ï¼Œç„¶åè°ƒç”¨ a.setB(b)ï¼Œäºæ˜¯ a çš„å¯¹è±¡ b å±æ€§å°±æœ‰å€¼äº†ï¼Œæ¥ç€å®Œæˆ a.getB().getName()æ–¹æ³•çš„è°ƒç”¨ã€‚è¿™å°±æ˜¯å»¶è¿ŸåŠ è½½çš„åŸºæœ¬åŸç†ã€‚</p>\n<h3 id=\"MyBatisçš„ä¸€çº§ã€äºŒçº§ç¼“å­˜\"><a href=\"#MyBatisçš„ä¸€çº§ã€äºŒçº§ç¼“å­˜\" class=\"headerlink\" title=\"MyBatisçš„ä¸€çº§ã€äºŒçº§ç¼“å­˜\"></a>MyBatisçš„ä¸€çº§ã€äºŒçº§ç¼“å­˜</h3><p><strong>ä¸€çº§ç¼“å­˜</strong>ï¼šä¸€çº§ç¼“å­˜æ˜¯ SqlSession èŒƒå›´çš„ç¼“å­˜</p>\n<p>å½“æˆ‘ä»¬æ‰§è¡ŒæŸ¥è¯¢ä¹‹åï¼ŒæŸ¥è¯¢çš„ç»“æœä¼šåŒæ—¶å­˜å…¥åˆ° SqlSession ä¸ºæˆ‘ä»¬æä¾›çš„ä¸€å—åŒºåŸŸä¸­ã€‚è¯¥åŒºåŸŸçš„ç»“æ„æ˜¯ä¸€ä¸ª Mapã€‚<br>å½“æˆ‘ä»¬å†æ¬¡æŸ¥è¯¢åŒæ ·çš„æ•°æ®æ—¶ï¼ŒMyBatis ä¼šå…ˆå» SqlSession ä¸­æŸ¥è¯¢æ˜¯å¦æœ‰ï¼Œæœ‰çš„è¯ç›´æ¥æ‹¿å‡ºæ¥ç”¨ã€‚</p>\n<p>å½“è°ƒç”¨ SqlSession çš„æ·»åŠ ï¼Œä¿®æ”¹ï¼Œåˆ é™¤ï¼Œcommit()ï¼Œclose()ã€clearCache()ç­‰æ–¹æ³•æ—¶ï¼Œå°±ä¼šæ¸…ç©ºä¸€çº§ç¼“å­˜ã€‚</p>\n<blockquote>\n<p>ç¬¬ä¸€æ¬¡å‘èµ·æŸ¥è¯¢ç”¨æˆ·idä¸º1çš„ç”¨æˆ·ä¿¡æ¯ï¼Œå…ˆå»æ‰¾ç¼“å­˜ä¸­æ˜¯å¦æœ‰idä¸º1çš„ç”¨æˆ·ä¿¡æ¯ï¼Œå¦‚æœæ²¡æœ‰ï¼Œä»æ•°æ®åº“æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ã€‚<br>å¾—åˆ°ç”¨æˆ·ä¿¡æ¯ï¼Œå°†ç”¨æˆ·ä¿¡æ¯å­˜å‚¨åˆ°ä¸€çº§ç¼“å­˜ä¸­ã€‚<br>å¦‚æœSQLSessionå»æ‰§è¡Œcommitæ“ä½œï¼ˆæ‰§è¡Œæ’å…¥ã€æ›´æ–°ã€åˆ é™¤ï¼‰ï¼Œæ¸…ç©ºSqlSessionä¸­çš„ä¸€çº§ç¼“å­˜ï¼Œè¿™æ ·åšçš„ç›®çš„ä¸ºäº†è®©ç¼“å­˜ä¸­å­˜å‚¨çš„æ˜¯æœ€æ–°çš„ä¿¡æ¯ï¼Œé¿å…è„è¯»ã€‚<br>ç¬¬äºŒæ¬¡å‘èµ·æŸ¥è¯¢ç”¨æˆ·idä¸º1çš„ç”¨æˆ·ä¿¡æ¯ï¼Œå…ˆå»æ‰¾ç¼“å­˜ä¸­æ˜¯å¦æœ‰idä¸º1çš„ç”¨æˆ·ä¿¡æ¯ï¼Œç¼“å­˜ä¸­æœ‰ï¼Œç›´æ¥ä»ç¼“å­˜ä¸­è·å–ç”¨æˆ·ä¿¡æ¯ã€‚</p>\n</blockquote>\n<p><strong>äºŒçº§ç¼“å­˜</strong>ï¼šäºŒçº§ç¼“å­˜æ˜¯ mapper æ˜ å°„çº§åˆ«çš„ç¼“å­˜ï¼Œå¤šä¸ª SqlSession å»æ“ä½œåŒä¸€ä¸ª Mapper æ˜ å°„çš„ SQL è¯­å¥ï¼Œå¤šä¸ª SqlSession å¯ä»¥å…±ç”¨äºŒçº§ç¼“å­˜ï¼ŒäºŒçº§ç¼“å­˜æ˜¯è·¨ SqlSession çš„ã€‚</p>\n<p>MyBatis ä¸­ SqlSessionFactory å¯¹è±¡çš„ç¼“å­˜</p>\n<p>â€‹\tç”±åŒä¸€ä¸ª SqlSessionFactory å¯¹è±¡åˆ›å»ºçš„ SqlSession å…±äº«å…¶ç¼“å­˜ã€‚</p>\n<p>â€‹\täºŒçº§ç¼“å­˜å­˜æ”¾çš„æ˜¯æ•°æ®ï¼Œè€Œä¸æ˜¯å¯¹è±¡ã€‚</p>\n<blockquote>\n<p>SQLSession1å»æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ï¼ŒæŸ¥è¯¢åˆ°ç”¨æˆ·ä¿¡æ¯ä¼šå°†æŸ¥è¯¢æ•°æ®å­˜å‚¨åˆ°äºŒçº§ç¼“å­˜ä¸­ã€‚<br>å¦‚æœSqlSession3å»æ‰§è¡Œç›¸åŒ mapperæ˜ å°„ä¸‹SQLï¼Œæ‰§è¡Œcommitæäº¤ï¼Œå°†ä¼šæ¸…ç©ºè¯¥ mapperæ˜ å°„ä¸‹çš„äºŒçº§ç¼“å­˜åŒºåŸŸçš„æ•°æ®ã€‚<br>SQLSession2å»æŸ¥è¯¢ä¸SQLSession1ç›¸åŒçš„ç”¨æˆ·ä¿¡æ¯ï¼Œé¦–å…ˆä¼šå»ç¼“å­˜ä¸­æ‰¾æ˜¯å¦å­˜åœ¨æ•°æ®ï¼Œå¦‚æœå­˜åœ¨ç›´æ¥ä»ç¼“å­˜ä¸­å–å‡ºæ•°æ®ã€‚</p>\n</blockquote>\n<p>1ï¼‰ä¸€çº§ç¼“å­˜: åŸºäº PerpetualCache çš„ HashMap æœ¬åœ°ç¼“å­˜ï¼Œå…¶å­˜å‚¨ä½œç”¨åŸŸä¸º Sessionï¼Œå½“ Session flush æˆ– close ä¹‹åï¼Œè¯¥ Session ä¸­çš„æ‰€æœ‰ Cache å°±å°†æ¸…ç©ºï¼Œé»˜è®¤æ‰“å¼€ä¸€çº§ç¼“å­˜ï¼›</p>\n<p>2ï¼‰äºŒçº§ç¼“å­˜ä¸ä¸€çº§ç¼“å­˜å…¶æœºåˆ¶ç›¸åŒï¼Œé»˜è®¤ä¹Ÿæ˜¯é‡‡ç”¨ PerpetualCacheï¼ŒHashMap å­˜å‚¨ï¼Œä¸åŒåœ¨äºå…¶å­˜å‚¨ä½œç”¨åŸŸä¸º Mapper(Namespace)ï¼Œå¹¶ä¸”å¯è‡ªå®šä¹‰å­˜å‚¨æºï¼Œå¦‚ Ehcacheã€‚é»˜è®¤ä¸æ‰“å¼€äºŒçº§ç¼“å­˜ï¼Œè¦å¼€å¯äºŒçº§ç¼“å­˜ï¼Œä½¿ç”¨äºŒçº§ç¼“å­˜å±æ€§ç±»éœ€è¦å®ç° Serializable åºåˆ—åŒ–æ¥å£(å¯ç”¨æ¥ä¿å­˜å¯¹è±¡çš„çŠ¶æ€),å¯åœ¨å®ƒçš„æ˜ å°„æ–‡ä»¶ä¸­é…ç½® <code>&lt;cache/&gt;</code> ï¼›</p>\n<p>3ï¼‰å¯¹äºç¼“å­˜æ•°æ®æ›´æ–°æœºåˆ¶ï¼Œå½“æŸä¸€ä¸ªä½œç”¨åŸŸ(ä¸€çº§ç¼“å­˜ Session&#x2F;äºŒçº§ç¼“å­˜ Namespaces)çš„è¿›è¡Œäº† C&#x2F;U&#x2F;D æ“ä½œåï¼Œé»˜è®¤è¯¥ä½œç”¨åŸŸä¸‹æ‰€æœ‰ select ä¸­çš„ç¼“å­˜å°†è¢« clearã€‚ </p>\n<h3 id=\"ä»€ä¹ˆæ˜¯MyBatisçš„æ¥å£ç»‘å®šï¼Ÿæœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯MyBatisçš„æ¥å£ç»‘å®šï¼Ÿæœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯MyBatisçš„æ¥å£ç»‘å®šï¼Ÿæœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯MyBatisçš„æ¥å£ç»‘å®šï¼Ÿæœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ</h3><p>æ¥å£ç»‘å®šï¼Œå°±æ˜¯åœ¨ MyBatis ä¸­ä»»æ„å®šä¹‰æ¥å£,ç„¶åæŠŠæ¥å£é‡Œé¢çš„æ–¹æ³•å’Œ SQL è¯­å¥ç»‘å®š, æˆ‘ä»¬ç›´æ¥è°ƒç”¨æ¥å£æ–¹æ³•å°±å¯ä»¥,è¿™æ ·æ¯”èµ·åŸæ¥äº† SqlSession æä¾›çš„æ–¹æ³•æˆ‘ä»¬å¯ä»¥æœ‰æ›´åŠ çµæ´»çš„é€‰æ‹©å’Œè®¾ç½®ã€‚</p>\n<p>æ¥å£ç»‘å®šæœ‰ä¸¤ç§å®ç°æ–¹å¼ï¼š</p>\n<ol>\n<li>é€šè¿‡æ³¨è§£ç»‘å®šï¼Œå°±æ˜¯åœ¨æ¥å£çš„æ–¹æ³•ä¸Šé¢åŠ ä¸Š @Selectã€@Update ç­‰æ³¨è§£ï¼Œé‡Œé¢åŒ…å« Sql è¯­å¥æ¥ç»‘å®šï¼›</li>\n<li>é€šè¿‡ xml é‡Œé¢å†™ SQL æ¥ç»‘å®š, åœ¨è¿™ç§æƒ…å†µä¸‹,è¦æŒ‡å®š xml æ˜ å°„æ–‡ä»¶é‡Œé¢çš„ namespace å¿…é¡»ä¸ºæ¥å£çš„å…¨è·¯å¾„åã€‚å½“ Sql è¯­å¥æ¯”è¾ƒç®€å•æ—¶å€™,ç”¨æ³¨è§£ç»‘å®š, å½“ SQL è¯­å¥æ¯”è¾ƒå¤æ‚æ—¶å€™,ç”¨ xml ç»‘å®š,ä¸€èˆ¬ç”¨ xml ç»‘å®šçš„æ¯”è¾ƒå¤šã€‚</li>\n</ol>\n","site":{"data":{}},"length":5628,"excerpt":"<blockquote>\n<p>æ•´ç†çš„MyBatisæ¡†æ¶ç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½","more":"</p>\n</blockquote>\n<h3 id=\"ä»€ä¹ˆæ˜¯MyBatisï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯MyBatisï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯MyBatisï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯MyBatisï¼Ÿ</h3><ol>\n<li>MyBatis æ˜¯ä¸€ä¸ªåŠ ORMï¼ˆå¯¹è±¡å…³ç³»æ˜ å°„ï¼‰æ¡†æ¶ï¼Œå®ƒå†…éƒ¨å°è£…äº† JDBCï¼Œå¼€å‘æ—¶åªéœ€è¦å…³æ³¨ SQL è¯­å¥æœ¬èº«ï¼Œä¸éœ€è¦èŠ±è´¹ç²¾åŠ›å»å¤„ç†<strong>åŠ è½½é©±åŠ¨ã€åˆ›å»ºè¿æ¥ã€åˆ›å»ºstatement</strong>ç­‰ç¹æ‚çš„è¿‡ç¨‹ã€‚</li>\n<li>é€šè¿‡ xml æ–‡ä»¶æˆ–æ³¨è§£çš„æ–¹å¼å°†è¦æ‰§è¡Œçš„å„ç§ statement é…ç½®èµ·æ¥ï¼Œå¹¶é€šè¿‡ java å¯¹è±¡å’Œ statement ä¸­ SQL çš„åŠ¨æ€å‚æ•°è¿›è¡Œæ˜ å°„ç”Ÿæˆæœ€ç»ˆæ‰§è¡Œçš„ SQL è¯­å¥ï¼Œæœ€åç”± mybatis æ¡†æ¶æ‰§è¡Œ SQL å¹¶å°†ç»“æœæ˜ å°„ä¸º java å¯¹è±¡å¹¶è¿”å›ã€‚ï¼ˆä»æ‰§è¡Œ SQL åˆ°è¿”å› result çš„è¿‡ç¨‹ï¼‰ã€‚</li>\n</ol>\n<h3 id=\"ORMæ˜¯ä»€ä¹ˆ\"><a href=\"#ORMæ˜¯ä»€ä¹ˆ\" class=\"headerlink\" title=\"ORMæ˜¯ä»€ä¹ˆ\"></a>ORMæ˜¯ä»€ä¹ˆ</h3><p>ORMï¼ˆObject Relational Mappingï¼‰ï¼Œå¯¹è±¡å…³ç³»æ˜ å°„ï¼Œå°±æ˜¯æŠŠæ•°æ®åº“è¡¨å’Œå®ä½“ç±»åŠå®ä½“ç±»çš„å±æ€§å¯¹åº”èµ·æ¥</p>\n<p>è®©æˆ‘ä»¬å¯ä»¥æ“ä½œå®ä½“ç±»å°±å®ç°æ“ä½œæ•°æ®åº“è¡¨ã€‚</p>\n<h3 id=\"ä¸ºä»€ä¹ˆè¯´MyBatisæ˜¯åŠè‡ªåŠ¨ORMæ˜ å°„å·¥å…·ï¼Ÿå®ƒä¸å…¨è‡ªåŠ¨çš„åŒºåˆ«åœ¨å“ªé‡Œï¼Ÿ\"><a href=\"#ä¸ºä»€ä¹ˆè¯´MyBatisæ˜¯åŠè‡ªåŠ¨ORMæ˜ å°„å·¥å…·ï¼Ÿå®ƒä¸å…¨è‡ªåŠ¨çš„åŒºåˆ«åœ¨å“ªé‡Œï¼Ÿ\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆè¯´MyBatisæ˜¯åŠè‡ªåŠ¨ORMæ˜ å°„å·¥å…·ï¼Ÿå®ƒä¸å…¨è‡ªåŠ¨çš„åŒºåˆ«åœ¨å“ªé‡Œï¼Ÿ\"></a>ä¸ºä»€ä¹ˆè¯´MyBatisæ˜¯åŠè‡ªåŠ¨ORMæ˜ å°„å·¥å…·ï¼Ÿå®ƒä¸å…¨è‡ªåŠ¨çš„åŒºåˆ«åœ¨å“ªé‡Œï¼Ÿ</h3><p>MyBatis åœ¨æŸ¥è¯¢å…³è”å¯¹è±¡æˆ–å…³è”é›†åˆå¯¹è±¡æ—¶ï¼Œéœ€è¦æ‰‹åŠ¨ç¼–å†™ SQL æ¥å®Œæˆï¼Œæ‰€ä»¥ï¼Œç§°ä¹‹ä¸ºåŠè‡ªåŠ¨ ORM æ˜ å°„å·¥å…·ã€‚</p>\n<h3 id=\"JDBCç¼–ç¨‹æœ‰å“ªäº›ä¸è¶³ä¹‹å¤„ï¼ŒMyBatisæ˜¯å¦‚ä½•è§£å†³çš„ï¼Ÿ\"><a href=\"#JDBCç¼–ç¨‹æœ‰å“ªäº›ä¸è¶³ä¹‹å¤„ï¼ŒMyBatisæ˜¯å¦‚ä½•è§£å†³çš„ï¼Ÿ\" class=\"headerlink\" title=\"JDBCç¼–ç¨‹æœ‰å“ªäº›ä¸è¶³ä¹‹å¤„ï¼ŒMyBatisæ˜¯å¦‚ä½•è§£å†³çš„ï¼Ÿ\"></a>JDBCç¼–ç¨‹æœ‰å“ªäº›ä¸è¶³ä¹‹å¤„ï¼ŒMyBatisæ˜¯å¦‚ä½•è§£å†³çš„ï¼Ÿ</h3><ol>\n<li>æ•°æ®åº“è¿æ¥åˆ›å»ºã€é‡Šæ”¾é¢‘ç¹ï¼Œé€ æˆç³»ç»Ÿèµ„æºæµªè´¹ä»è€Œå½±å“ç³»ç»Ÿæ€§èƒ½</li>\n<li>SQL è¯­å¥å†™åœ¨ä»£ç ä¸­é€ æˆä»£ç <strong>ä¸æ˜“ç»´æŠ¤</strong></li>\n<li>å‘ SQL è¯­å¥<strong>ä¼ å‚</strong>éº»çƒ¦</li>\n<li>å¯¹<strong>ç»“æœé›†è§£æ</strong>éº»çƒ¦</li>\n</ol>\n<h3 id=\"MyBatisç¼–ç¨‹æ­¥éª¤æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ\"><a href=\"#MyBatisç¼–ç¨‹æ­¥éª¤æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ\" class=\"headerlink\" title=\"MyBatisç¼–ç¨‹æ­¥éª¤æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ\"></a>MyBatisç¼–ç¨‹æ­¥éª¤æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ</h3><ol>\n<li>è¯»å–é…ç½®æ–‡ä»¶ï¼Œåˆ›å»º SqlSessionFactory å·¥å‚</li>\n<li>é€šè¿‡ SqlSessionFactory å·¥å‚åˆ›å»º SqlSession å¯¹è±¡</li>\n<li>ä½¿ç”¨ SqlSession åˆ›å»º Dao æ¥å£çš„ä»£ç†å¯¹è±¡</li>\n<li>ä½¿ç”¨ä»£ç†å¯¹è±¡æ‰§è¡Œæ–¹æ³•</li>\n<li>è°ƒç”¨ session.commit()æäº¤äº‹åŠ¡</li>\n<li>è°ƒç”¨ session.close()å…³é—­ä¼šè¯</li>\n</ol>\n<h3 id=\"å’Œ-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#å’Œ-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"#{}å’Œ${}çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>#{}å’Œ${}çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>mybatis åœ¨å¤„ç† #{} æ—¶ï¼Œä¼šå°† SQL ä¸­çš„ #{} æ›¿æ¢ä¸º ? å·ï¼Œè°ƒç”¨ PreparedStatement çš„ set æ–¹æ³•æ¥èµ‹å€¼ã€‚<br>è¿™æ˜¯<strong>é¢„ç¼–è¯‘å¤„ç†</strong>ï¼Œå¯ä»¥æé«˜ SQL æ‰§è¡Œæ•ˆç‡ï¼Œæ›´é‡è¦çš„æ˜¯<strong>å¯ä»¥é˜²æ­¢SQLæ³¨å…¥</strong>ï¼›</p>\n<p>mybatis åœ¨å¤„ç† ${} æ—¶ï¼Œå°±æ˜¯æŠŠ ${} ä½¿ç”¨<strong>å­—ç¬¦ä¸²æ›¿æ¢</strong>ã€‚ä½¿ç”¨è¯¥æ–¹å¼å¦‚æœä¼ å…¥ id çš„è¯ï¼Œä¼šæŠŠ id&#x3D;1 è½¬æ¢ä¸º id&#x3D;â€1â€å­—ç¬¦ä¸²å½¢å¼ï¼Œè€Œæ•°æ®åº“ä¸­ id å®é™…ä¸ºæ•°å€¼å‹è¿™æ ·å°±ä¸åŒ¹é…äº†ï¼ŒæŸ¥è¯¢å¤±è´¥ã€‚ï¼ˆ${}æ˜¯å­—ç¬¦ä¸²æ›¿æ¢ï¼Œé€šå¸¸åœ¨ EL è¡¨è¾¾å¼ä¸­ä½¿ç”¨ï¼Œç”¨æ¥å±•ç¤ºåç«¯ä¼ é€’åˆ°å‰ç«¯çš„å€¼ï¼‰ã€‚</p>\n<h3 id=\"å½“å®ä½“ç±»ä¸­çš„å±æ€§åå’Œè¡¨ä¸­çš„å­—æ®µåä¸ä¸€æ ·-ï¼Œæ€ä¹ˆåŠ-ï¼Ÿ\"><a href=\"#å½“å®ä½“ç±»ä¸­çš„å±æ€§åå’Œè¡¨ä¸­çš„å­—æ®µåä¸ä¸€æ ·-ï¼Œæ€ä¹ˆåŠ-ï¼Ÿ\" class=\"headerlink\" title=\"å½“å®ä½“ç±»ä¸­çš„å±æ€§åå’Œè¡¨ä¸­çš„å­—æ®µåä¸ä¸€æ · ï¼Œæ€ä¹ˆåŠ ï¼Ÿ\"></a>å½“å®ä½“ç±»ä¸­çš„å±æ€§åå’Œè¡¨ä¸­çš„å­—æ®µåä¸ä¸€æ · ï¼Œæ€ä¹ˆåŠ ï¼Ÿ</h3><ol>\n<li>é€šè¿‡åœ¨æŸ¥è¯¢çš„ SQL è¯­å¥ä¸­å®šä¹‰æ•°æ®åº“å­—æ®µåçš„åˆ«åï¼Œè®©æ•°æ®åº“å­—æ®µåçš„åˆ«åå’Œå®ä½“ç±»çš„å±æ€§åä¸€è‡´ã€‚</li>\n<li>é€šè¿‡ <code>&lt;resultMap&gt;</code>æ¥æ˜ å°„å­—æ®µåå’Œå®ä½“ç±»å±æ€§åçš„ä¸€ä¸€å¯¹åº”çš„å…³ç³»ã€‚</li>\n</ol>\n<h3 id=\"æ¨¡ç³ŠæŸ¥è¯¢likeè¯­å¥è¯¥æ€ä¹ˆå†™\"><a href=\"#æ¨¡ç³ŠæŸ¥è¯¢likeè¯­å¥è¯¥æ€ä¹ˆå†™\" class=\"headerlink\" title=\"æ¨¡ç³ŠæŸ¥è¯¢likeè¯­å¥è¯¥æ€ä¹ˆå†™?\"></a>æ¨¡ç³ŠæŸ¥è¯¢likeè¯­å¥è¯¥æ€ä¹ˆå†™?</h3><ol>\n<li><p>åœ¨ Java ä»£ç ä¸­æ·»åŠ  SQL é€šé…ç¬¦ã€‚</p>\n <figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">string wildcardname = â€œ%smi%â€;</span><br><span class=\"line\">list<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span> names = mapper.selectlike(wildcardname);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">â€selectlikeâ€</span>&gt;</span></span><br><span class=\"line\">\tselect * from foo where bar like #&#123;value&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>åœ¨ SQL è¯­å¥ä¸­æ‹¼æ¥é€šé…ç¬¦%ï¼Œä¼šå¼•èµ· SQL æ³¨å…¥</p>\n <figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">string wildcardname = â€œsmiâ€;</span><br><span class=\"line\">list<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span> names = mapper.selectlike(wildcardname);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">â€selectlikeâ€</span>&gt;</span></span><br><span class=\"line\">\tselect * from foo where bar like &quot;%&quot;#&#123;value&#125;&quot;%&quot;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure></li>\n</ol>\n<h3 id=\"MyBatiséƒ½æœ‰å“ªäº›Executoræ‰§è¡Œå™¨ï¼Ÿå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#MyBatiséƒ½æœ‰å“ªäº›Executoræ‰§è¡Œå™¨ï¼Ÿå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"MyBatiséƒ½æœ‰å“ªäº›Executoræ‰§è¡Œå™¨ï¼Ÿå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>MyBatiséƒ½æœ‰å“ªäº›Executoræ‰§è¡Œå™¨ï¼Ÿå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>MyBatis æœ‰ä¸‰ç§åŸºæœ¬çš„ Executor æ‰§è¡Œå™¨ï¼ŒSimpleExecutorã€ReuseExecutorã€BatchExecutorã€‚</p>\n<ul>\n<li><strong>SimpleExecutor</strong> ï¼šæ¯æ¬¡å¼€å¯ä¸€ä¸ª Statement å¯¹è±¡ï¼Œç”¨å®Œç«‹åˆ»å…³é—­ Statement å¯¹è±¡ã€‚</li>\n<li><strong>ReuseExecutor</strong> ï¼šé‡å¤ä½¿ç”¨åˆ›å»ºçš„ Statement å¯¹è±¡ã€‚</li>\n<li><strong>BatchExecutor</strong> ï¼šç¼“å­˜äº†å¤šä¸ª Statement å¯¹è±¡ï¼Œä¸€èµ·æ‰§è¡Œæ‰¹é‡æ›´æ–°ã€‚</li>\n</ul>\n<h3 id=\"é€šå¸¸ä¸€ä¸ªxmlæ˜ å°„æ–‡ä»¶ï¼Œéƒ½ä¼šå†™ä¸€ä¸ªDaoæ¥å£ä¸ä¹‹å¯¹åº”ï¼Œè¯·é—®ï¼Œè¿™ä¸ªDaoæ¥å£çš„å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆï¼ŸDaoæ¥å£é‡Œçš„æ–¹æ³•ï¼Œå‚æ•°ä¸åŒæ—¶ï¼Œæ–¹æ³•èƒ½é‡è½½å—ï¼Ÿ\"><a href=\"#é€šå¸¸ä¸€ä¸ªxmlæ˜ å°„æ–‡ä»¶ï¼Œéƒ½ä¼šå†™ä¸€ä¸ªDaoæ¥å£ä¸ä¹‹å¯¹åº”ï¼Œè¯·é—®ï¼Œè¿™ä¸ªDaoæ¥å£çš„å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆï¼ŸDaoæ¥å£é‡Œçš„æ–¹æ³•ï¼Œå‚æ•°ä¸åŒæ—¶ï¼Œæ–¹æ³•èƒ½é‡è½½å—ï¼Ÿ\" class=\"headerlink\" title=\"é€šå¸¸ä¸€ä¸ªxmlæ˜ å°„æ–‡ä»¶ï¼Œéƒ½ä¼šå†™ä¸€ä¸ªDaoæ¥å£ä¸ä¹‹å¯¹åº”ï¼Œè¯·é—®ï¼Œè¿™ä¸ªDaoæ¥å£çš„å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆï¼ŸDaoæ¥å£é‡Œçš„æ–¹æ³•ï¼Œå‚æ•°ä¸åŒæ—¶ï¼Œæ–¹æ³•èƒ½é‡è½½å—ï¼Ÿ\"></a>é€šå¸¸ä¸€ä¸ªxmlæ˜ å°„æ–‡ä»¶ï¼Œéƒ½ä¼šå†™ä¸€ä¸ªDaoæ¥å£ä¸ä¹‹å¯¹åº”ï¼Œè¯·é—®ï¼Œè¿™ä¸ªDaoæ¥å£çš„å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆï¼ŸDaoæ¥å£é‡Œçš„æ–¹æ³•ï¼Œå‚æ•°ä¸åŒæ—¶ï¼Œæ–¹æ³•èƒ½é‡è½½å—ï¼Ÿ</h3><p>Dao æ¥å£ï¼Œå°±æ˜¯äººä»¬å¸¸è¯´çš„ <code>Mapper</code>æ¥å£ï¼Œæ¥å£çš„å…¨é™åï¼Œå°±æ˜¯æ˜ å°„æ–‡ä»¶ä¸­çš„ namespace çš„å€¼ï¼Œæ¥å£çš„æ–¹æ³•åï¼Œå°±æ˜¯æ˜ å°„æ–‡ä»¶ä¸­<code>MappedStatement</code>çš„ id å€¼ï¼Œæ¥å£æ–¹æ³•å†…çš„å‚æ•°ï¼Œå°±æ˜¯ä¼ é€’ç»™ SQL çš„å‚æ•°ã€‚<code>Mapper</code>æ¥å£æ˜¯æ²¡æœ‰å®ç°ç±»çš„ï¼Œå½“è°ƒç”¨æ¥å£æ–¹æ³•æ—¶ï¼Œæ¥å£å…¨é™å+æ–¹æ³•åæ‹¼æ¥å­—ç¬¦ä¸²ä½œä¸º key å€¼ï¼Œå¯å”¯ä¸€å®šä½ä¸€ä¸ª<code>MappedStatement</code>ï¼Œä¸¾ä¾‹ï¼š<code>com.yaxing.dao.IUserDao.findAll</code>ï¼Œå¯ä»¥å”¯ä¸€æ‰¾åˆ° namespace ä¸º<code>com.yaxing.dao.IUserDao</code>ä¸‹é¢<code>id = findAll</code>çš„<code>MappedStatement</code>ã€‚åœ¨ MyBatis ä¸­ï¼Œæ¯ä¸€ä¸ª<code>&lt;select&gt;</code>ã€<code>&lt;insert&gt;</code>ã€<code>&lt;update&gt;</code>ã€<code>&lt;delete&gt;</code>æ ‡ç­¾ï¼Œéƒ½ä¼šè¢«è§£æä¸ºä¸€ä¸ª<code>MappedStatement</code>å¯¹è±¡ï¼Œç„¶åæ‰§è¡Œåç»­çš„æ“ä½œã€‚</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">mapper</span> <span class=\"attr\">namespace</span>=<span class=\"string\">&quot;com.yaxing.dao.IUserDao&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;findAll&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;com.yaxing.domain.User&quot;</span>&gt;</span></span><br><span class=\"line\">        select * from user;</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>Dao æ¥å£é‡Œçš„æ–¹æ³•å¯ä»¥é‡è½½ï¼Œä½†æ˜¯ MyBatis çš„ XML é‡Œé¢çš„ ID ä¸å…è®¸é‡å¤ï¼Œä¹Ÿå°±æ˜¯è¯´å¯¹äºåŒä¸€ä¸ªæ¥å£æ–¹æ³•åï¼Œmapper æ–‡ä»¶ä¸­åªèƒ½æœ‰ä¸€ä¸ªè¯¥ idã€‚<br>å¯ä»¥ä½¿ç”¨åŠ¨æ€ SQL å®ç°æ¥å£é‡è½½å¯¹åº”çš„ maperã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Mapperæ¥å£é‡Œé¢æ–¹æ³•é‡è½½</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">StuMapper</span> &#123;</span><br><span class=\"line\">    List&lt;Student&gt; <span class=\"title function_\">getAllStu</span><span class=\"params\">()</span>;</span><br><span class=\"line\">    List&lt;Student&gt; <span class=\"title function_\">getAllStu</span><span class=\"params\">(<span class=\"meta\">@Param(&quot;id&quot;)</span> Integer id)</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>ç„¶ååœ¨ <code>StuMapper.xml</code> ä¸­åˆ©ç”¨ MyBatis çš„åŠ¨æ€ SQL å°±å¯ä»¥å®ç°ã€‚</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;getAllStu&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;com.pojo.Student&quot;</span>&gt;</span></span><br><span class=\"line\">    select * from student</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">where</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;id != null&quot;</span>&gt;</span></span><br><span class=\"line\">            id = #&#123;id&#125;</span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">where</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>èƒ½æ­£å¸¸è¿è¡Œï¼Œå¹¶èƒ½å¾—åˆ°ç›¸åº”çš„ç»“æœï¼Œè¿™æ ·å°±å®ç°äº†åœ¨ Dao æ¥å£ä¸­å†™é‡è½½æ–¹æ³•ã€‚</p>\n<p><strong>MyBatis çš„ Dao æ¥å£å¯ä»¥æœ‰å¤šä¸ªé‡è½½æ–¹æ³•ï¼Œä½†æ˜¯å¤šä¸ªæ¥å£å¯¹åº”çš„æ˜ å°„å¿…é¡»åªæœ‰ä¸€ä¸ªï¼Œå¦åˆ™å¯åŠ¨ä¼šæŠ¥é”™ã€‚</strong></p>\n<h3 id=\"MyBatisæ˜¯å¦‚ä½•å°†SQLæ‰§è¡Œç»“æœå°è£…ä¸ºç›®æ ‡å¯¹è±¡å¹¶è¿”å›çš„ï¼Ÿéƒ½æœ‰å“ªäº›æ˜ å°„å½¢å¼ï¼Ÿ\"><a href=\"#MyBatisæ˜¯å¦‚ä½•å°†SQLæ‰§è¡Œç»“æœå°è£…ä¸ºç›®æ ‡å¯¹è±¡å¹¶è¿”å›çš„ï¼Ÿéƒ½æœ‰å“ªäº›æ˜ å°„å½¢å¼ï¼Ÿ\" class=\"headerlink\" title=\"MyBatisæ˜¯å¦‚ä½•å°†SQLæ‰§è¡Œç»“æœå°è£…ä¸ºç›®æ ‡å¯¹è±¡å¹¶è¿”å›çš„ï¼Ÿéƒ½æœ‰å“ªäº›æ˜ å°„å½¢å¼ï¼Ÿ\"></a>MyBatisæ˜¯å¦‚ä½•å°†SQLæ‰§è¡Œç»“æœå°è£…ä¸ºç›®æ ‡å¯¹è±¡å¹¶è¿”å›çš„ï¼Ÿéƒ½æœ‰å“ªäº›æ˜ å°„å½¢å¼ï¼Ÿ</h3><ol>\n<li><p>ä½¿ç”¨ <code>&lt;resultMap&gt;</code>æ ‡ç­¾ï¼Œé€ä¸€å®šä¹‰æ•°æ®åº“åˆ—åå’Œå¯¹è±¡å±æ€§åä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚</p>\n</li>\n<li><p>ä½¿ç”¨ SQL åˆ—çš„åˆ«ååŠŸèƒ½ï¼Œå°†åˆ—çš„åˆ«åå±æ€§å¯¹åº”ä¸ºå¯¹è±¡å±æ€§åã€‚</p>\n</li>\n</ol>\n<p>æœ‰äº†åˆ—åä¸å±æ€§åçš„æ˜ å°„å…³ç³»åï¼ŒMyBatis<strong>é€šè¿‡åå°„åˆ›å»ºå¯¹è±¡</strong>ï¼ŒåŒæ—¶<strong>ä½¿ç”¨åå°„ç»™å¯¹è±¡çš„å±æ€§é€ä¸€èµ‹å€¼</strong>å¹¶è¿”å›ï¼Œé‚£äº›æ‰¾ä¸åˆ°æ˜ å°„å…³ç³»çš„å±æ€§ï¼Œæ˜¯æ— æ³•å®Œæˆèµ‹å€¼çš„ã€‚</p>\n<h3 id=\"åœ¨mapperä¸­å¦‚ä½•ä¼ é€’å¤šä¸ªå‚æ•°\"><a href=\"#åœ¨mapperä¸­å¦‚ä½•ä¼ é€’å¤šä¸ªå‚æ•°\" class=\"headerlink\" title=\"åœ¨mapperä¸­å¦‚ä½•ä¼ é€’å¤šä¸ªå‚æ•°?\"></a>åœ¨mapperä¸­å¦‚ä½•ä¼ é€’å¤šä¸ªå‚æ•°?</h3><ol>\n<li>é¡ºåºä¼ å‚æ³•ï¼Œ#{} é‡Œé¢çš„æ•°å­—ä»£è¡¨ä¼ å…¥å‚æ•°çš„é¡ºåº</li>\n<li>@Param æ³¨è§£ä¼ å‚æ³•ï¼Œ#{} é‡Œé¢çš„åç§°å¯¹åº”çš„æ˜¯æ³¨è§£@Param æ‹¬å·é‡Œé¢ä¿®é¥°çš„åç§°</li>\n<li>map ä¼ å‚ï¼Œ#{} é‡Œé¢çš„åç§°å¯¹åº”çš„æ˜¯ Map é‡Œé¢çš„ key åç§°ã€‚</li>\n<li>Java Bean ä¼ å‚æ³•ï¼Œ#{} é‡Œé¢çš„åç§°å¯¹åº”çš„æ˜¯ User ç±»é‡Œé¢çš„æˆå‘˜å±æ€§ã€‚</li>\n</ol>\n<h3 id=\"MyBatisåŠ¨æ€SQLæœ‰ä»€ä¹ˆç”¨ï¼Ÿæ‰§è¡ŒåŸç†ï¼Ÿæœ‰å“ªäº›åŠ¨æ€SQLï¼Ÿ\"><a href=\"#MyBatisåŠ¨æ€SQLæœ‰ä»€ä¹ˆç”¨ï¼Ÿæ‰§è¡ŒåŸç†ï¼Ÿæœ‰å“ªäº›åŠ¨æ€SQLï¼Ÿ\" class=\"headerlink\" title=\"MyBatisåŠ¨æ€SQLæœ‰ä»€ä¹ˆç”¨ï¼Ÿæ‰§è¡ŒåŸç†ï¼Ÿæœ‰å“ªäº›åŠ¨æ€SQLï¼Ÿ\"></a>MyBatisåŠ¨æ€SQLæœ‰ä»€ä¹ˆç”¨ï¼Ÿæ‰§è¡ŒåŸç†ï¼Ÿæœ‰å“ªäº›åŠ¨æ€SQLï¼Ÿ</h3><p>MyBatis åŠ¨æ€ SQL å¯ä»¥åœ¨ xml æ˜ å°„æ–‡ä»¶å†…ï¼Œä»¥æ ‡ç­¾çš„å½¢å¼ç¼–å†™åŠ¨æ€ SQL.</p>\n<p>æ‰§è¡ŒåŸç†æ˜¯æ ¹æ®è¡¨è¾¾å¼çš„å€¼ å®Œæˆé€»è¾‘åˆ¤æ–­å¹¶åŠ¨æ€æ‹¼æ¥ SQLã€‚</p>\n<p>MyBatis æä¾›äº† 9 ç§åŠ¨æ€ SQL æ ‡ç­¾ï¼š å¸¸ç”¨çš„æœ‰ <code>if|where|foreach</code></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;getAllStu&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;com.pojo.Student&quot;</span>&gt;</span></span><br><span class=\"line\">    select * from student</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">where</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;id != null&quot;</span>&gt;</span></span><br><span class=\"line\">            id = #&#123;id&#125;</span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">where</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"MyBatiså®ç°ä¸€å¯¹å¤šæœ‰å‡ ç§æ–¹å¼-æ€ä¹ˆæ“ä½œçš„ï¼Ÿ\"><a href=\"#MyBatiså®ç°ä¸€å¯¹å¤šæœ‰å‡ ç§æ–¹å¼-æ€ä¹ˆæ“ä½œçš„ï¼Ÿ\" class=\"headerlink\" title=\"MyBatiså®ç°ä¸€å¯¹å¤šæœ‰å‡ ç§æ–¹å¼,æ€ä¹ˆæ“ä½œçš„ï¼Ÿ\"></a>MyBatiså®ç°ä¸€å¯¹å¤šæœ‰å‡ ç§æ–¹å¼,æ€ä¹ˆæ“ä½œçš„ï¼Ÿ</h3><p>æœ‰<strong>è”åˆæŸ¥è¯¢</strong>å’Œ<strong>åµŒå¥—æŸ¥è¯¢</strong>ã€‚</p>\n<p>è”åˆæŸ¥è¯¢æ˜¯å‡ ä¸ªè¡¨è”åˆæŸ¥è¯¢,åªæŸ¥è¯¢ä¸€æ¬¡,é€šè¿‡åœ¨ resultMap é‡Œé¢çš„ collection èŠ‚ç‚¹é…ç½®ä¸€å¯¹å¤šçš„ç±»å°±å¯ä»¥å®Œæˆï¼›</p>\n<p>åµŒå¥—æŸ¥è¯¢æ˜¯å…ˆæŸ¥ä¸€ä¸ªè¡¨,æ ¹æ®è¿™ä¸ªè¡¨é‡Œé¢çš„ ç»“æœçš„å¤–é”® id,å»å†å¦å¤–ä¸€ä¸ªè¡¨é‡Œé¢æŸ¥è¯¢æ•°æ®,ä¹Ÿæ˜¯é€šè¿‡é…ç½® collection,ä½†å¦å¤–ä¸€ä¸ªè¡¨çš„æŸ¥è¯¢é€šè¿‡ select èŠ‚ç‚¹é…ç½®ã€‚</p>\n<h3 id=\"MyBatisæ˜¯å¦æ”¯æŒå»¶è¿ŸåŠ è½½ï¼Ÿå¦‚æœæ”¯æŒï¼Œå®ƒçš„å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#MyBatisæ˜¯å¦æ”¯æŒå»¶è¿ŸåŠ è½½ï¼Ÿå¦‚æœæ”¯æŒï¼Œå®ƒçš„å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"MyBatisæ˜¯å¦æ”¯æŒå»¶è¿ŸåŠ è½½ï¼Ÿå¦‚æœæ”¯æŒï¼Œå®ƒçš„å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>MyBatisæ˜¯å¦æ”¯æŒå»¶è¿ŸåŠ è½½ï¼Ÿå¦‚æœæ”¯æŒï¼Œå®ƒçš„å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>MyBatis ä»…æ”¯æŒ association å…³è”å¯¹è±¡å’Œ collection å…³è”é›†åˆå¯¹è±¡çš„å»¶è¿ŸåŠ è½½ã€‚<br>association æŒ‡çš„å°±æ˜¯ä¸€å¯¹ä¸€ï¼Œcollection æŒ‡çš„å°±æ˜¯ä¸€å¯¹å¤šæŸ¥è¯¢ã€‚<br>åœ¨ MyBatis é…ç½®æ–‡ä»¶ä¸­ï¼Œå¯ä»¥é…ç½®æ˜¯å¦å¯ç”¨å»¶è¿ŸåŠ è½½ lazyLoadingEnabled&#x3D;true|falseã€‚</p>\n<p>å®ƒçš„åŸç†æ˜¯ï¼Œä½¿ç”¨ CGLIB åˆ›å»ºç›®æ ‡å¯¹è±¡çš„ä»£ç†å¯¹è±¡ï¼Œå½“è°ƒç”¨ç›®æ ‡æ–¹æ³•æ—¶ï¼Œè¿›å…¥æ‹¦æˆªå™¨æ–¹æ³•ï¼Œæ¯”å¦‚è°ƒç”¨ a.getB().getName()ï¼Œæ‹¦æˆªå™¨ invoke()æ–¹æ³•å‘ç° a.getB()æ˜¯ null å€¼ï¼Œé‚£ä¹ˆå°±ä¼šå•ç‹¬å‘é€äº‹å…ˆä¿å­˜å¥½çš„æŸ¥è¯¢å…³è” B å¯¹è±¡çš„ SQLï¼ŒæŠŠ B æŸ¥è¯¢ä¸Šæ¥ï¼Œç„¶åè°ƒç”¨ a.setB(b)ï¼Œäºæ˜¯ a çš„å¯¹è±¡ b å±æ€§å°±æœ‰å€¼äº†ï¼Œæ¥ç€å®Œæˆ a.getB().getName()æ–¹æ³•çš„è°ƒç”¨ã€‚è¿™å°±æ˜¯å»¶è¿ŸåŠ è½½çš„åŸºæœ¬åŸç†ã€‚</p>\n<h3 id=\"MyBatisçš„ä¸€çº§ã€äºŒçº§ç¼“å­˜\"><a href=\"#MyBatisçš„ä¸€çº§ã€äºŒçº§ç¼“å­˜\" class=\"headerlink\" title=\"MyBatisçš„ä¸€çº§ã€äºŒçº§ç¼“å­˜\"></a>MyBatisçš„ä¸€çº§ã€äºŒçº§ç¼“å­˜</h3><p><strong>ä¸€çº§ç¼“å­˜</strong>ï¼šä¸€çº§ç¼“å­˜æ˜¯ SqlSession èŒƒå›´çš„ç¼“å­˜</p>\n<p>å½“æˆ‘ä»¬æ‰§è¡ŒæŸ¥è¯¢ä¹‹åï¼ŒæŸ¥è¯¢çš„ç»“æœä¼šåŒæ—¶å­˜å…¥åˆ° SqlSession ä¸ºæˆ‘ä»¬æä¾›çš„ä¸€å—åŒºåŸŸä¸­ã€‚è¯¥åŒºåŸŸçš„ç»“æ„æ˜¯ä¸€ä¸ª Mapã€‚<br>å½“æˆ‘ä»¬å†æ¬¡æŸ¥è¯¢åŒæ ·çš„æ•°æ®æ—¶ï¼ŒMyBatis ä¼šå…ˆå» SqlSession ä¸­æŸ¥è¯¢æ˜¯å¦æœ‰ï¼Œæœ‰çš„è¯ç›´æ¥æ‹¿å‡ºæ¥ç”¨ã€‚</p>\n<p>å½“è°ƒç”¨ SqlSession çš„æ·»åŠ ï¼Œä¿®æ”¹ï¼Œåˆ é™¤ï¼Œcommit()ï¼Œclose()ã€clearCache()ç­‰æ–¹æ³•æ—¶ï¼Œå°±ä¼šæ¸…ç©ºä¸€çº§ç¼“å­˜ã€‚</p>\n<blockquote>\n<p>ç¬¬ä¸€æ¬¡å‘èµ·æŸ¥è¯¢ç”¨æˆ·idä¸º1çš„ç”¨æˆ·ä¿¡æ¯ï¼Œå…ˆå»æ‰¾ç¼“å­˜ä¸­æ˜¯å¦æœ‰idä¸º1çš„ç”¨æˆ·ä¿¡æ¯ï¼Œå¦‚æœæ²¡æœ‰ï¼Œä»æ•°æ®åº“æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ã€‚<br>å¾—åˆ°ç”¨æˆ·ä¿¡æ¯ï¼Œå°†ç”¨æˆ·ä¿¡æ¯å­˜å‚¨åˆ°ä¸€çº§ç¼“å­˜ä¸­ã€‚<br>å¦‚æœSQLSessionå»æ‰§è¡Œcommitæ“ä½œï¼ˆæ‰§è¡Œæ’å…¥ã€æ›´æ–°ã€åˆ é™¤ï¼‰ï¼Œæ¸…ç©ºSqlSessionä¸­çš„ä¸€çº§ç¼“å­˜ï¼Œè¿™æ ·åšçš„ç›®çš„ä¸ºäº†è®©ç¼“å­˜ä¸­å­˜å‚¨çš„æ˜¯æœ€æ–°çš„ä¿¡æ¯ï¼Œé¿å…è„è¯»ã€‚<br>ç¬¬äºŒæ¬¡å‘èµ·æŸ¥è¯¢ç”¨æˆ·idä¸º1çš„ç”¨æˆ·ä¿¡æ¯ï¼Œå…ˆå»æ‰¾ç¼“å­˜ä¸­æ˜¯å¦æœ‰idä¸º1çš„ç”¨æˆ·ä¿¡æ¯ï¼Œç¼“å­˜ä¸­æœ‰ï¼Œç›´æ¥ä»ç¼“å­˜ä¸­è·å–ç”¨æˆ·ä¿¡æ¯ã€‚</p>\n</blockquote>\n<p><strong>äºŒçº§ç¼“å­˜</strong>ï¼šäºŒçº§ç¼“å­˜æ˜¯ mapper æ˜ å°„çº§åˆ«çš„ç¼“å­˜ï¼Œå¤šä¸ª SqlSession å»æ“ä½œåŒä¸€ä¸ª Mapper æ˜ å°„çš„ SQL è¯­å¥ï¼Œå¤šä¸ª SqlSession å¯ä»¥å…±ç”¨äºŒçº§ç¼“å­˜ï¼ŒäºŒçº§ç¼“å­˜æ˜¯è·¨ SqlSession çš„ã€‚</p>\n<p>MyBatis ä¸­ SqlSessionFactory å¯¹è±¡çš„ç¼“å­˜</p>\n<p>â€‹\tç”±åŒä¸€ä¸ª SqlSessionFactory å¯¹è±¡åˆ›å»ºçš„ SqlSession å…±äº«å…¶ç¼“å­˜ã€‚</p>\n<p>â€‹\täºŒçº§ç¼“å­˜å­˜æ”¾çš„æ˜¯æ•°æ®ï¼Œè€Œä¸æ˜¯å¯¹è±¡ã€‚</p>\n<blockquote>\n<p>SQLSession1å»æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ï¼ŒæŸ¥è¯¢åˆ°ç”¨æˆ·ä¿¡æ¯ä¼šå°†æŸ¥è¯¢æ•°æ®å­˜å‚¨åˆ°äºŒçº§ç¼“å­˜ä¸­ã€‚<br>å¦‚æœSqlSession3å»æ‰§è¡Œç›¸åŒ mapperæ˜ å°„ä¸‹SQLï¼Œæ‰§è¡Œcommitæäº¤ï¼Œå°†ä¼šæ¸…ç©ºè¯¥ mapperæ˜ å°„ä¸‹çš„äºŒçº§ç¼“å­˜åŒºåŸŸçš„æ•°æ®ã€‚<br>SQLSession2å»æŸ¥è¯¢ä¸SQLSession1ç›¸åŒçš„ç”¨æˆ·ä¿¡æ¯ï¼Œé¦–å…ˆä¼šå»ç¼“å­˜ä¸­æ‰¾æ˜¯å¦å­˜åœ¨æ•°æ®ï¼Œå¦‚æœå­˜åœ¨ç›´æ¥ä»ç¼“å­˜ä¸­å–å‡ºæ•°æ®ã€‚</p>\n</blockquote>\n<p>1ï¼‰ä¸€çº§ç¼“å­˜: åŸºäº PerpetualCache çš„ HashMap æœ¬åœ°ç¼“å­˜ï¼Œå…¶å­˜å‚¨ä½œç”¨åŸŸä¸º Sessionï¼Œå½“ Session flush æˆ– close ä¹‹åï¼Œè¯¥ Session ä¸­çš„æ‰€æœ‰ Cache å°±å°†æ¸…ç©ºï¼Œé»˜è®¤æ‰“å¼€ä¸€çº§ç¼“å­˜ï¼›</p>\n<p>2ï¼‰äºŒçº§ç¼“å­˜ä¸ä¸€çº§ç¼“å­˜å…¶æœºåˆ¶ç›¸åŒï¼Œé»˜è®¤ä¹Ÿæ˜¯é‡‡ç”¨ PerpetualCacheï¼ŒHashMap å­˜å‚¨ï¼Œä¸åŒåœ¨äºå…¶å­˜å‚¨ä½œç”¨åŸŸä¸º Mapper(Namespace)ï¼Œå¹¶ä¸”å¯è‡ªå®šä¹‰å­˜å‚¨æºï¼Œå¦‚ Ehcacheã€‚é»˜è®¤ä¸æ‰“å¼€äºŒçº§ç¼“å­˜ï¼Œè¦å¼€å¯äºŒçº§ç¼“å­˜ï¼Œä½¿ç”¨äºŒçº§ç¼“å­˜å±æ€§ç±»éœ€è¦å®ç° Serializable åºåˆ—åŒ–æ¥å£(å¯ç”¨æ¥ä¿å­˜å¯¹è±¡çš„çŠ¶æ€),å¯åœ¨å®ƒçš„æ˜ å°„æ–‡ä»¶ä¸­é…ç½® <code>&lt;cache/&gt;</code> ï¼›</p>\n<p>3ï¼‰å¯¹äºç¼“å­˜æ•°æ®æ›´æ–°æœºåˆ¶ï¼Œå½“æŸä¸€ä¸ªä½œç”¨åŸŸ(ä¸€çº§ç¼“å­˜ Session&#x2F;äºŒçº§ç¼“å­˜ Namespaces)çš„è¿›è¡Œäº† C&#x2F;U&#x2F;D æ“ä½œåï¼Œé»˜è®¤è¯¥ä½œç”¨åŸŸä¸‹æ‰€æœ‰ select ä¸­çš„ç¼“å­˜å°†è¢« clearã€‚ </p>\n<h3 id=\"ä»€ä¹ˆæ˜¯MyBatisçš„æ¥å£ç»‘å®šï¼Ÿæœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯MyBatisçš„æ¥å£ç»‘å®šï¼Ÿæœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯MyBatisçš„æ¥å£ç»‘å®šï¼Ÿæœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯MyBatisçš„æ¥å£ç»‘å®šï¼Ÿæœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ</h3><p>æ¥å£ç»‘å®šï¼Œå°±æ˜¯åœ¨ MyBatis ä¸­ä»»æ„å®šä¹‰æ¥å£,ç„¶åæŠŠæ¥å£é‡Œé¢çš„æ–¹æ³•å’Œ SQL è¯­å¥ç»‘å®š, æˆ‘ä»¬ç›´æ¥è°ƒç”¨æ¥å£æ–¹æ³•å°±å¯ä»¥,è¿™æ ·æ¯”èµ·åŸæ¥äº† SqlSession æä¾›çš„æ–¹æ³•æˆ‘ä»¬å¯ä»¥æœ‰æ›´åŠ çµæ´»çš„é€‰æ‹©å’Œè®¾ç½®ã€‚</p>\n<p>æ¥å£ç»‘å®šæœ‰ä¸¤ç§å®ç°æ–¹å¼ï¼š</p>\n<ol>\n<li>é€šè¿‡æ³¨è§£ç»‘å®šï¼Œå°±æ˜¯åœ¨æ¥å£çš„æ–¹æ³•ä¸Šé¢åŠ ä¸Š @Selectã€@Update ç­‰æ³¨è§£ï¼Œé‡Œé¢åŒ…å« Sql è¯­å¥æ¥ç»‘å®šï¼›</li>\n<li>é€šè¿‡ xml é‡Œé¢å†™ SQL æ¥ç»‘å®š, åœ¨è¿™ç§æƒ…å†µä¸‹,è¦æŒ‡å®š xml æ˜ å°„æ–‡ä»¶é‡Œé¢çš„ namespace å¿…é¡»ä¸ºæ¥å£çš„å…¨è·¯å¾„åã€‚å½“ Sql è¯­å¥æ¯”è¾ƒç®€å•æ—¶å€™,ç”¨æ³¨è§£ç»‘å®š, å½“ SQL è¯­å¥æ¯”è¾ƒå¤æ‚æ—¶å€™,ç”¨ xml ç»‘å®š,ä¸€èˆ¬ç”¨ xml ç»‘å®šçš„æ¯”è¾ƒå¤šã€‚</li>\n</ol>"},{"title":"Javaå…«è‚¡æ–‡ - Javaé›†åˆ","copyright":true,"mathjax":false,"date":"2023-01-23T02:06:52.000Z","toc":true,"urlname":"java-collection","_content":"\n> æ•´ç†çš„Javaé›†åˆç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½\t<!--more-->\n\n## é›†åˆå®¹å™¨æ¦‚è¿°\n\n### ä»€ä¹ˆæ˜¯é›†åˆ\n\nç”¨äºå­˜å‚¨æ•°æ®çš„å®¹å™¨ã€‚\n\n### é›†åˆå’Œæ•°ç»„çš„åŒºåˆ«\n\n- æ•°ç»„æ˜¯å›ºå®šé•¿åº¦çš„ï¼›é›†åˆå¯å˜é•¿åº¦çš„ã€‚\n- æ•°ç»„å¯ä»¥å­˜å‚¨åŸºæœ¬æ•°æ®ç±»å‹ï¼Œä¹Ÿå¯ä»¥å­˜å‚¨å¼•ç”¨æ•°æ®ç±»å‹ï¼›é›†åˆåªèƒ½å­˜å‚¨å¼•ç”¨æ•°æ®ç±»å‹ã€‚\n\n### å¸¸ç”¨çš„é›†åˆç±»æœ‰å“ªäº›ï¼Ÿ\n\nCollection æ¥å£å’Œ Map æ¥å£æ˜¯æ‰€æœ‰é›†åˆæ¡†æ¶çš„çˆ¶æ¥å£ã€‚\n\nCollection æ¥å£ï¼šå­æ¥å£åŒ…æ‹¬ Set æ¥å£å’Œ List æ¥å£\n\n1. Set æ¥å£çš„å®ç°ç±»ä¸»è¦æœ‰ï¼šHashSetã€TreeSetã€LinkedHashSet ç­‰ï¼›\n2. List æ¥å£çš„å®ç°ç±»ä¸»è¦æœ‰ï¼šArrayListã€LinkedListã€Stack ä»¥åŠ Vector ç­‰ã€‚\n\nMap æ¥å£ï¼šå®ç°ç±»ä¸»è¦æœ‰ HashMapã€TreeMapã€HashTableã€ConcurrentHashMap ä»¥åŠ Properties ç­‰ã€‚\n\n### Listã€Setã€Mapä¸‰è€…çš„åŒºåˆ«ï¼Ÿ\n\n![Collectionæ¶æ„](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly9pbWcyMDE4LmNuYmxvZ3MuY29tL290aGVyLzE0MDgxODMvMjAxOTExLzE0MDgxODMtMjAxOTExMTkxODQxNDk1NTktMTU3MTU5NTY2OC5qcGc.png)\n\nList å’Œ Set ä¸¤å¤§æ¥å£æ˜¯ Collection çš„å­æ¥å£\n\n- Listï¼šæœ‰åºå®¹å™¨ï¼Œå…ƒç´ å¯ä»¥é‡å¤ï¼Œå¯ä»¥æ’å…¥å¤šä¸ª null å…ƒç´ ï¼Œå…ƒç´ éƒ½æœ‰ç´¢å¼•ï¼›\n\tå¸¸ç”¨å®ç°ç±»ï¼šArrayListã€LinkedList å’Œ Vectorã€‚\n\t\n- Setï¼šæ— åºå®¹å™¨ï¼Œä¸å¯ä»¥å­˜å‚¨é‡å¤å…ƒç´ ï¼Œåªå…è®¸å­˜å…¥ä¸€ä¸ª null å…ƒç´ ï¼Œå¿…é¡»ä¿è¯å…ƒç´ å”¯ä¸€æ€§ï¼›\n\n\tå¸¸ç”¨å®ç°ç±»ï¼šHashSetã€LinkedHashSet ä»¥åŠ TreeSetã€‚\n\n* Map æ˜¯ä¸€ä¸ªé”®å€¼å¯¹é›†åˆï¼Œå­˜å‚¨é”®ã€å€¼å’Œä¹‹é—´çš„æ˜ å°„ã€‚ key æ— åºï¼Œå”¯ä¸€ï¼›value ä¸è¦æ±‚æœ‰åºï¼Œå…è®¸é‡å¤ï¼›\n\n\tå¸¸ç”¨å®ç°ç±»ï¼šHashMapã€TreeMapã€HashTableã€LinkedHashMapã€ConcurrentHashMapã€‚\n\n### é›†åˆæ¡†æ¶åº•å±‚æ•°æ®ç»“æ„\n\n#### Collection\n\n1. List\n\n- Arraylistï¼š Object æ•°ç»„\n- Vectorï¼š Object æ•°ç»„\n- LinkedListï¼š åŒå‘é“¾è¡¨\n\n2. Set\n\n- HashSetï¼ˆæ— åºï¼Œå”¯ä¸€ï¼‰ï¼šåŸºäº HashMap å®ç°çš„ï¼Œåº•å±‚é‡‡ç”¨ HashMap æ¥ä¿å­˜å…ƒç´ \n- LinkedHashSetï¼š LinkedHashSet ç»§æ‰¿äº HashSetï¼Œå¹¶ä¸”å…¶å†…éƒ¨æ˜¯é€šè¿‡ LinkedHashMap æ¥å®ç°çš„ã€‚\n- TreeSetï¼ˆæœ‰åºï¼Œå”¯ä¸€ï¼‰ï¼š çº¢é»‘æ ‘(è‡ªå¹³è¡¡çš„æ’åºäºŒå‰æ ‘)\n\n#### Map\n\n- HashMapï¼š JDK1.8 ä¹‹å‰ HashMap ç”±æ•°ç»„+é“¾è¡¨ç»„æˆçš„ï¼Œæ•°ç»„æ˜¯ HashMap çš„ä¸»ä½“ï¼Œé“¾è¡¨åˆ™æ˜¯ä¸»è¦ä¸ºäº†è§£å†³å“ˆå¸Œå†²çªè€Œå­˜åœ¨çš„ï¼ˆâ€œæ‹‰é“¾æ³•â€è§£å†³å†²çªï¼‰ã€‚JDK1.8 ä»¥ååœ¨è§£å†³å“ˆå¸Œå†²çªæ—¶æœ‰äº†è¾ƒå¤§çš„å˜åŒ–ï¼Œå½“é“¾è¡¨é•¿åº¦å¤§äºé˜ˆå€¼ï¼ˆé»˜è®¤ä¸º 8ï¼‰ï¼Œä¸”æ•°ç»„é•¿åº¦å¤§äº 64ï¼Œå°†é“¾è¡¨è½¬åŒ–ä¸ºçº¢é»‘æ ‘ï¼Œä»¥å‡å°‘æœç´¢æ—¶é—´ï¼Œå¦åˆ™æ‰©å®¹æ•°ç»„ã€‚\n- LinkedHashMapï¼šLinkedHashMap ç»§æ‰¿è‡ª HashMapï¼Œæ‰€ä»¥å®ƒçš„åº•å±‚ç”±æ•°ç»„å’Œé“¾è¡¨æˆ–çº¢é»‘æ ‘ç»„æˆã€‚å¦å¤–ï¼ŒLinkedHashMap åœ¨ä¸Šé¢ç»“æ„çš„åŸºç¡€ä¸Šï¼Œå¢åŠ äº†ä¸€æ¡åŒå‘é“¾è¡¨ï¼Œä½¿å¾—ä¸Šé¢çš„ç»“æ„å¯ä»¥ä¿æŒé”®å€¼å¯¹çš„æ’å…¥é¡ºåºã€‚åŒæ—¶é€šè¿‡å¯¹é“¾è¡¨è¿›è¡Œç›¸åº”çš„æ“ä½œï¼Œå®ç°äº†è®¿é—®é¡ºåºç›¸å…³é€»è¾‘ã€‚\n- HashTableï¼š æ•°ç»„+é“¾è¡¨ç»„æˆçš„ï¼Œæ•°ç»„æ˜¯ HashMap çš„ä¸»ä½“ï¼Œé“¾è¡¨åˆ™æ˜¯ä¸»è¦ä¸ºäº†è§£å†³å“ˆå¸Œå†²çªè€Œå­˜åœ¨çš„\n- TreeMapï¼š çº¢é»‘æ ‘ï¼ˆè‡ªå¹³è¡¡çš„æ’åºäºŒå‰æ ‘ï¼‰\n\n### å“ªäº›é›†åˆç±»æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Ÿ\n\nvector å’Œ hashtableï¼Œé€šè¿‡åœ¨æ–¹æ³•ä¸ŠåŠ  synchronized å…³é”®å­—å®ç°çº¿ç¨‹å®‰å…¨\n\n### Javaé›†åˆçš„å¿«é€Ÿå¤±è´¥æœºåˆ¶ â€œfail-fastâ€ï¼Ÿ\n\nfail-fast æ˜¯ Java é›†åˆçš„ä¸€ç§**é”™è¯¯æ£€æµ‹æœºåˆ¶**ï¼Œå½“å¤šä¸ªçº¿ç¨‹å¯¹åŒä¸€ä¸ªé›†åˆçš„å†…å®¹è¿›è¡Œæ“ä½œæ—¶ï¼Œå°±å¯èƒ½ä¼šäº§ç”Ÿ fail-fast äº‹ä»¶ã€‚\n\nä¾‹å¦‚ï¼šå‡è®¾å­˜åœ¨ä¸¤ä¸ªçº¿ç¨‹ï¼ˆçº¿ç¨‹ 1ã€çº¿ç¨‹ 2ï¼‰ï¼Œçº¿ç¨‹ 1 é€šè¿‡ Iterator åœ¨éå†é›†åˆ A ä¸­çš„å…ƒç´ ï¼Œåœ¨æŸä¸ªæ—¶å€™çº¿ç¨‹ 2 ä¿®æ”¹äº†é›†åˆ A çš„ç»“æ„ï¼ˆaddã€removeã€clear ç­‰ç»“æ„ä¸Šçš„ä¿®æ”¹ï¼Œè€Œä¸æ˜¯ç®€å•çš„ä¿®æ”¹é›†åˆå…ƒç´ çš„å†…å®¹ï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™ç¨‹åºå°±ä¼šæŠ›å‡º **ConcurrentModificationException** å¼‚å¸¸ï¼Œä»è€Œäº§ç”Ÿ fail-fast äº‹ä»¶ã€‚\n\nåŸå› ï¼šè¿­ä»£å™¨åœ¨éå†æ—¶ç›´æ¥è®¿é—®é›†åˆä¸­çš„å†…å®¹ï¼Œå¹¶ä¸”åœ¨éå†è¿‡ç¨‹ä¸­ä½¿ç”¨ä¸€ä¸ª modCount å˜é‡ã€‚æ¯å½“è¿­ä»£å™¨ä½¿ç”¨ hashNext()/next()éå†ä¸‹ä¸€ä¸ªå…ƒç´ ä¹‹å‰ï¼Œéƒ½ä¼šæ£€æµ‹ modCount å˜é‡æ˜¯å¦ä¸º expectedmodCount å€¼ï¼Œæ˜¯çš„è¯å°±è¿”å›éå†ï¼›å¦åˆ™æŠ›å‡ºå¼‚å¸¸ï¼Œç»ˆæ­¢éå†ã€‚é›†åˆåœ¨è¢«éå†æœŸé—´å¦‚æœå†…å®¹å‘ç”Ÿå˜åŒ–ï¼Œå°±ä¼šæ”¹å˜ modCount çš„å€¼ï¼Œä»è€Œ modCount ä¸ç­‰äº expectedmodCount å€¼æŠ›å‡ºå¼‚å¸¸ï¼Œä¹Ÿå°±æ˜¯äº§ç”Ÿäº† fail-fast äº‹ä»¶ã€‚\n\nè§£å†³åŠæ³•ï¼š\n\n1. åœ¨éå†è¿‡ç¨‹ä¸­ï¼Œæ‰€æœ‰æ¶‰åŠåˆ°æ”¹å˜ modCount å€¼çš„åœ°æ–¹å…¨éƒ¨åŠ ä¸Š synchronizedï¼›\n2. ä½¿ç”¨ Java.util.concurrent ä¸‹çš„ CopyOnWriteArrayList æ¥æ›¿æ¢ ArrayListï¼›\n3. ä½¿ç”¨ Java.util.concurrent ä¸‹çš„ ConcurrentHashMap æ¥æ›¿æ¢ HashMapã€‚\n\n### æ€ä¹ˆç¡®ä¿ä¸€ä¸ªé›†åˆä¸èƒ½è¢«ä¿®æ”¹ï¼Ÿ\n\nå¯ä»¥ä½¿ç”¨ Collections. unmodifiableCollection(Collection c) æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªåªè¯»é›†åˆï¼Œè¿™æ ·æ”¹å˜é›†åˆçš„ä»»ä½•æ“ä½œéƒ½ä¼šæŠ›å‡º Java. lang. UnsupportedOperationException å¼‚å¸¸ã€‚\n\n```Java\nList<String> list = new ArrayList<>();\nlist. add(\"x\");\nCollection<String> clist = Collections. unmodifiableCollection(list);\nclist.add(\"y\"); // è¿è¡Œæ—¶æ­¤è¡ŒæŠ¥é”™\nSystem.out.println(list. size());\n```\n\n## Collectionæ¥å£\n\n### Listæ¥å£\n\n#### è¿­ä»£å™¨ Iterator æ˜¯ä»€ä¹ˆï¼Ÿ\n\nCollection æ¥å£å®ç°äº† Iterable æ¥å£ï¼Œé€šè¿‡å®ç° Iterable æ¥å£ä¸­çš„ iterator()æ–¹æ³•è¿”å› Iterator æ¥å£çš„å®ä¾‹ï¼Œé€šè¿‡ iterator å¯¹é›†åˆçš„å…ƒç´ è¿›è¡Œè¿­ä»£æ“ä½œã€‚\n\n#### Iterator æ€ä¹ˆä½¿ç”¨ï¼Ÿæœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ\n\n```Java\nList<String> list = new ArrayList<>();\nIterator<String> it = list.iterator();\nwhile(it.hasNext()){\n    String obj = it.next();\n    System.out.println(obj);\n}\n```\n\nIterator çš„ç‰¹ç‚¹æ˜¯åªèƒ½å•å‘éå†ï¼Œä½†æ˜¯æ›´åŠ å®‰å…¨ï¼Œå› ä¸ºå®ƒå¯ä»¥ç¡®ä¿ï¼Œåœ¨å½“å‰éå†çš„é›†åˆå…ƒç´ è¢«æ›´æ”¹çš„æ—¶å€™ï¼Œå°±ä¼šæŠ›å‡º ConcurrentModificationException å¼‚å¸¸ã€‚\n\n#### å¦‚ä½•è¾¹éå†è¾¹ç§»é™¤ Collection ä¸­çš„å…ƒç´ ï¼Ÿ\n\nè¾¹éå†è¾¹ä¿®æ”¹ Collection çš„å”¯ä¸€æ­£ç¡®æ–¹å¼æ˜¯ä½¿ç”¨ Iterator.remove() æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š\n\n```java\nIterator<Integer> it = list.iterator();\nwhile(it.hasNext()){\n   // do something\n   it.remove();\n}\n```\n\nä¸€ç§æœ€å¸¸è§çš„**é”™è¯¯**ä»£ç å¦‚ä¸‹ï¼š\n\n```java\nList<String> list = new ArrayList<>();\nlist.add(\"1\");\nlist.add(\"2\");\nlist.add(\"3\");\nlist.add(\"4\");\nlist.add(\"5\");\nint cnt = 0;\nfor (String item : list) {\n  System.out.println(++cnt);\n  list.remove(item);\n}\nSystem.out.println(Arrays.toString(list.toArray()));\n```\n\nè¿è¡Œä»¥ä¸Šé”™è¯¯ä»£ç ä¼šæŠ¥ **ConcurrentModificationException å¼‚å¸¸**ã€‚\nè¿™æ˜¯å› ä¸ºå½“ä½¿ç”¨ foreach(for(Integer i : list)) è¯­å¥æ—¶ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª iterator æ¥éå†è¯¥ listï¼Œä½†åŒæ—¶è¯¥ list æ­£åœ¨è¢« Iterator.remove() ä¿®æ”¹ã€‚é›†åˆå‘ç”Ÿç»“æ„æ€§å˜åŒ–ï¼Œæ ¹æ® fail-fast æœºåˆ¶ï¼Œä¼šæŠ›å¼‚å¸¸ã€‚\n\n#### éå†ä¸€ä¸ª List æœ‰å“ªäº›ä¸åŒçš„æ–¹å¼ï¼Ÿ\n\n1. for å¾ªç¯ï¼Œç»´æŠ¤ä¸€ä¸ªè®¡æ•°å™¨ï¼›\n2. è¿­ä»£å™¨ï¼ŒIteratorã€‚Collection æ¥å£å®ç°äº† Iterable æ¥å£ï¼Œé€šè¿‡å®ç° Iterable æ¥å£ä¸­çš„ iterator()æ–¹æ³•è¿”å› Iterator æ¥å£çš„å®ä¾‹ï¼Œé€šè¿‡ iterator å¯¹é›†åˆçš„å…ƒç´ è¿›è¡Œè¿­ä»£æ“ä½œï¼›\n3. å¢å¼º for å¾ªç¯ã€‚å¢å¼º for å¾ªç¯ foreach å†…éƒ¨ä¹Ÿæ˜¯é‡‡ç”¨äº† Iterator çš„æ–¹å¼å®ç°ï¼Œä½¿ç”¨æ—¶ä¸éœ€è¦æ˜¾å¼å£°æ˜ Iterator æˆ–è®¡æ•°å™¨ã€‚\n\tä¼˜ç‚¹æ˜¯ä»£ç ç®€æ´ï¼Œä¸æ˜“å‡ºé”™ï¼›ç¼ºç‚¹æ˜¯åªèƒ½åšç®€å•çš„éå†ï¼Œä¸èƒ½åœ¨éå†è¿‡ç¨‹ä¸­æ“ä½œæ•°æ®é›†åˆï¼Œä¾‹å¦‚åˆ é™¤ã€æ›¿æ¢ã€‚\n\n#### è¯´ä¸€ä¸‹ ArrayList çš„ä¼˜ç¼ºç‚¹\n\n**ArrayList æ¯”è¾ƒé€‚åˆé¡ºåºæ·»åŠ ã€éšæœºè®¿é—®çš„åœºæ™¯ã€‚**\n\nArrayList çš„ä¼˜ç‚¹å¦‚ä¸‹ï¼š\n\n- ArrayList åº•å±‚ä»¥æ•°ç»„å®ç°ï¼Œæ˜¯ä¸€ç§éšæœºè®¿é—®æ¨¡å¼ã€‚ArrayList å®ç°äº† RandomAccess æ¥å£ï¼Œæ ‡è®° List å®ç°æ˜¯å¦æ”¯æŒ Random Accessï¼Œå¯¼è‡´å®ƒå¯ä»¥éšæœºè®¿é—®çš„æ ¹æœ¬åŸå› æ˜¯å®ƒåº•å±‚æ˜¯æ•°ç»„ç»“æ„ï¼Œæ•°ç»„å¯ä»¥é€šè¿‡ä¸‹æ ‡è·å–ç›¸åº”çš„å€¼ï¼Œè€Œ RandomAccess åªæ˜¯ä¸€ä¸ªæ ‡è®°ã€‚å› æ­¤æŸ¥æ‰¾çš„æ—¶å€™éå¸¸å¿«ã€‚å¯ä»¥ç”¨ for å¾ªç¯é€šè¿‡ä¸‹æ ‡è·å–å…ƒç´ ã€‚\n- ArrayList åœ¨é¡ºåºæ·»åŠ ä¸€ä¸ªå…ƒç´ çš„æ—¶å€™éå¸¸æ–¹ä¾¿ã€‚\n\nArrayList çš„ç¼ºç‚¹å¦‚ä¸‹ï¼š\n\n- å‘**ä¸­é—´æŸä¸ªä½ç½®åˆ é™¤**å…ƒç´ çš„æ—¶å€™ï¼Œéœ€è¦åšå…ƒç´ å¤åˆ¶æ“ä½œã€‚å¦‚æœè¦å¤åˆ¶çš„å…ƒç´ å¾ˆå¤šï¼Œé‚£ä¹ˆå°±ä¼šæ¯”è¾ƒè€—è´¹æ€§èƒ½ï¼›\n- å‘**ä¸­é—´æŸä¸ªä½ç½®æ’å…¥**å…ƒç´ çš„æ—¶å€™ï¼Œä¹Ÿéœ€è¦åšå…ƒç´ å¤åˆ¶æ“ä½œï¼Œç¼ºç‚¹åŒä¸Šã€‚\n\n#### å¦‚ä½•å®ç°æ•°ç»„å’Œ List ä¹‹é—´çš„è½¬æ¢ï¼Ÿ\n\n- æ•°ç»„è½¬ Listï¼šä½¿ç”¨ Arrays. asList(array) è¿›è¡Œè½¬æ¢ã€‚\n- List è½¬æ•°ç»„ï¼šä½¿ç”¨ List è‡ªå¸¦çš„ toArray() æ–¹æ³•ã€‚\n\n```Java\n// list to array\nList<String> list = new ArrayList<String>();\nlist.add(\"123\");\nlist.add(\"456\");\nlist.toArray(new String[0]);\n\n// array to list\nString[] array = new String[]{\"123\", \"456\"};\nArrays.asList(array);\n```\n\n#### ArrayList å’Œ LinkedList çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\n\n- åº•å±‚å®ç°ï¼šArrayList æ˜¯åŠ¨æ€æ•°ç»„çš„æ•°æ®ç»“æ„å®ç°ï¼Œè€Œ LinkedList æ˜¯åŒå‘é“¾è¡¨çš„æ•°æ®ç»“æ„å®ç°ï¼›\n- è®¿é—®å’Œå¢åˆ å…ƒç´ æ•ˆç‡ï¼šArrayList éšæœºè®¿é—®å’Œé¡ºåºæ’å…¥/åˆ é™¤å…ƒç´ æ•ˆç‡æ›´é«˜ï¼›\n- å†…å­˜å ç”¨ï¼šLinkedList æ¯” ArrayList æ›´å å†…å­˜ï¼Œå› ä¸º LinkedList çš„èŠ‚ç‚¹é™¤äº†å­˜å‚¨æ•°æ®ï¼Œè¿˜å­˜å‚¨äº†ä¸¤ä¸ªå¼•ç”¨ï¼Œä¸€ä¸ªæŒ‡å‘å‰ä¸€ä¸ªå…ƒç´ ï¼Œä¸€ä¸ªæŒ‡å‘åä¸€ä¸ªå…ƒç´ ï¼›\n- çº¿ç¨‹å®‰å…¨ï¼šArrayList å’Œ LinkedList éƒ½æ˜¯ä¸åŒæ­¥çš„ï¼Œä¹Ÿå°±æ˜¯ä¸ä¿è¯çº¿ç¨‹å®‰å…¨ã€‚\n\nç»¼åˆæ¥è¯´ï¼Œåœ¨éœ€è¦**é¢‘ç¹è¯»å–**é›†åˆä¸­çš„å…ƒç´ æ—¶ï¼Œæ›´æ¨èä½¿ç”¨ ArrayListï¼Œè€Œåœ¨**æ’å…¥å’Œåˆ é™¤æ“ä½œè¾ƒå¤š**æ—¶ï¼Œæ›´æ¨èä½¿ç”¨ LinkedListã€‚\n\n#### ArrayList å’Œ Vector çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\n\nä¸»è¦åŒºåˆ«æ˜¯çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼š\nVector ä½¿ç”¨äº† synchronized æ¥å®ç°çº¿ç¨‹åŒæ­¥ï¼ˆæ€§èƒ½å·®ï¼‰ï¼Œæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè€Œ ArrayList æ˜¯éçº¿ç¨‹å®‰å…¨çš„ã€‚\n\n#### å¤šçº¿ç¨‹åœºæ™¯ä¸‹å¦‚ä½•ä½¿ç”¨ ArrayListï¼Ÿ\n\nå¯ä»¥ç”¨ Java.util.concurrent.CopyOnWriteArrayList æ›¿æ¢ ArrayListã€‚\n\n#### ä¸ºä»€ä¹ˆ ArrayList çš„ elementData åŠ ä¸Š transient ä¿®é¥°ï¼Ÿ\n\nArrayList å®ç°äº† Serializable æ¥å£ï¼Œè¿™æ„å‘³ç€ ArrayList æ”¯æŒåºåˆ—åŒ–ã€‚\nå¯¹äº elementDataï¼Œç”±äº elementData å¯èƒ½æœ‰å¤šä½™çš„å®¹é‡ï¼ˆå®¹é‡ä¸è¶³ä¼šæ‰©å®¹æˆ 1.5 å€å¤§å°ï¼Œæ‰©å®¹ä¹‹åé™¤äº†æ–°åŠ \nçš„å…ƒç´ ä»¥å¤–è¿˜æœ‰å¤šçš„ç©ºé—´æ²¡æœ‰æ”¾å…ƒç´ ï¼Œæ¯”å¦‚ç°åœ¨å®¹é‡æ˜¯ 15ï¼Œè€Œé›†åˆé‡Œé¢åªå­˜äº† 11 ä¸ªå…ƒç´ ï¼‰ï¼Œä¸å¯¹ elementData åŠ ä¸Š transient ä¿®é¥°ï¼Œè€Œæ˜¯æ‰‹åŠ¨è¿›è¡Œåºåˆ—åŒ–ï¼Œå¯ä»¥ä¿è¯åªåºåˆ—åŒ–å®é™…å­˜å‚¨çš„é‚£äº›å…ƒç´ ï¼ˆ11 ä¸ªå…ƒç´ ï¼‰ï¼Œè€Œä¸æ˜¯æ•´ä¸ªæ•°ç»„ï¼Œä»è€ŒèŠ‚çœç©ºé—´å’Œæ—¶é—´ã€‚\n\n### â­ArrayListæ‰©å®¹æœºåˆ¶\n\n> **æ€»ç»“ï¼š**\n>\n> * åˆå§‹åŒ–å¦‚æœä½¿ç”¨æ— å‚æ„é€ å™¨çš„è¯ï¼š\n>\n> \tåœ¨ç¬¬ä¸€æ¬¡æ·»åŠ å…ƒç´ çš„æ—¶å€™ï¼Œå°†æ•°ç»„å®¹é‡è®¾ç½®ä¸º10ï¼Œç„¶åè¿›è¡Œæ·»åŠ ã€‚\n>\n> \tä¸€ç›´æ·»åŠ ï¼Œç›´åˆ°è¦æ·»åŠ çš„å…ƒç´ è¶…å‡ºå½“å‰æ•°ç»„å®¹é‡äº†ï¼Œè¿›å…¥æ‰©å®¹ï¼Œå°†æ•°ç»„é•¿åº¦æ‰©å®¹ä¸º1.5å€é•¿åº¦ï¼Œç„¶åè¿›è¡Œæ·»åŠ ã€‚\n>\n> * åˆå§‹åŒ–å¦‚æœä½¿ç”¨æœ‰å‚æ„é€ å™¨çš„è¯ï¼š\n>\n> \té‚£ä¹ˆæ¯æ¬¡æ·»åŠ å…ƒç´ åªéœ€è¦åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹å³å¯ï¼Œä¸éœ€è¦ç¬¬ä¸€æ¬¡çš„åˆå§‹åŒ–ä¸º10çš„åˆ¤æ–­ã€‚\n\n#### 1. å…ˆä» ArrayList çš„æ„é€ å‡½æ•°è¯´èµ·\n\n**ï¼ˆJDK8ï¼‰ArrayList æœ‰ä¸‰ç§æ–¹å¼æ¥åˆå§‹åŒ–ï¼Œæ„é€ æ–¹æ³•æºç å¦‚ä¸‹ï¼š**\n\n```java\n    /**\n     * é»˜è®¤åˆå§‹å®¹é‡å¤§å°\n     */\n    private static final int DEFAULT_CAPACITY = 10;\n\n\n    private static final Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = {};\n\n    /**\n     *é»˜è®¤æ„é€ å‡½æ•°ï¼Œä½¿ç”¨åˆå§‹å®¹é‡10æ„é€ ä¸€ä¸ªç©ºåˆ—è¡¨(æ— å‚æ•°æ„é€ )\n     */\n    public ArrayList() {\n        this.elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA;\n    }\n\n    /**\n     * å¸¦åˆå§‹å®¹é‡å‚æ•°çš„æ„é€ å‡½æ•°ã€‚ï¼ˆç”¨æˆ·è‡ªå·±æŒ‡å®šå®¹é‡ï¼‰\n     */\n    public ArrayList(int initialCapacity) {\n        if (initialCapacity > 0) {//åˆå§‹å®¹é‡å¤§äº0\n            //åˆ›å»ºinitialCapacityå¤§å°çš„æ•°ç»„\n            this.elementData = new Object[initialCapacity];\n        } else if (initialCapacity == 0) {//åˆå§‹å®¹é‡ç­‰äº0\n            //åˆ›å»ºç©ºæ•°ç»„\n            this.elementData = EMPTY_ELEMENTDATA;\n        } else {//åˆå§‹å®¹é‡å°äº0ï¼ŒæŠ›å‡ºå¼‚å¸¸\n            throw new IllegalArgumentException(\"Illegal Capacity: \"+\n                                               initialCapacity);\n        }\n    }\n\n\n   /**\n    *æ„é€ åŒ…å«æŒ‡å®šcollectionå…ƒç´ çš„åˆ—è¡¨ï¼Œè¿™äº›å…ƒç´ åˆ©ç”¨è¯¥é›†åˆçš„è¿­ä»£å™¨æŒ‰é¡ºåºè¿”å›\n    *å¦‚æœæŒ‡å®šçš„é›†åˆä¸ºnullï¼Œthrows NullPointerExceptionã€‚\n    */\n     public ArrayList(Collection<? extends E> c) {\n        elementData = c.toArray();\n        if ((size = elementData.length) != 0) {\n            // c.toArray might (incorrectly) not return Object[] (see 6260652)\n            if (elementData.getClass() != Object[].class)\n                elementData = Arrays.copyOf(elementData, size, Object[].class);\n        } else {\n            // replace with empty array.\n            this.elementData = EMPTY_ELEMENTDATA;\n        }\n    }\n```\n\n**ä»¥æ— å‚æ•°æ„é€ æ–¹æ³•åˆ›å»º ArrayList æ—¶ï¼Œå®é™…ä¸Šåˆå§‹åŒ–èµ‹å€¼çš„æ˜¯ä¸€ä¸ªç©ºæ•°ç»„ã€‚å½“çœŸæ­£å¯¹æ•°ç»„è¿›è¡Œæ·»åŠ å…ƒç´ æ“ä½œæ—¶ï¼Œæ‰çœŸæ­£åˆ†é…å®¹é‡ã€‚å³å‘æ•°ç»„ä¸­æ·»åŠ ç¬¬ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œæ•°ç»„å®¹é‡æ‰©ä¸º 10ã€‚** \n\n> è¡¥å……ï¼šJDK6 new æ— å‚æ„é€ çš„ `ArrayList` å¯¹è±¡æ—¶ï¼Œç›´æ¥åˆ›å»ºäº†é•¿åº¦æ˜¯ 10 çš„ `Object[]` æ•°ç»„ elementData ã€‚\n\n#### 2. ä¸€æ­¥ä¸€æ­¥åˆ†æ ArrayList æ‰©å®¹æœºåˆ¶\n\nè¿™é‡Œä»¥æ— å‚æ„é€ å‡½æ•°åˆ›å»ºçš„ ArrayList ä¸ºä¾‹åˆ†æ\n\n##### 2.1.  `add` \n\n```java\n    /**\n     * å°†æŒ‡å®šçš„å…ƒç´ è¿½åŠ åˆ°æ­¤åˆ—è¡¨çš„æœ«å°¾ã€‚\n     */\n    public boolean add(E e) {\n   // æ·»åŠ å…ƒç´ ä¹‹å‰ï¼Œå…ˆè°ƒç”¨ensureCapacityInternalæ–¹æ³•\n        ensureCapacityInternal(size + 1);  // Increments modCount!!\n        // è¿™é‡Œçœ‹åˆ°ArrayListæ·»åŠ å…ƒç´ çš„å®è´¨å°±ç›¸å½“äºä¸ºæ•°ç»„èµ‹å€¼\n        elementData[size++] = e;\n        return true;\n    }\n```\n\n##### 2.2. `ensureCapacityInternal()` \n\nï¼ˆJDK7ï¼‰å¯ä»¥çœ‹åˆ° `add` æ–¹æ³• é¦–å…ˆè°ƒç”¨äº†`ensureCapacityInternal(size + 1)`\n\n```java\n   //å¾—åˆ°æœ€å°æ‰©å®¹é‡\n    private void ensureCapacityInternal(int minCapacity) {\n        if (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) {\n            // è·å–é»˜è®¤çš„å®¹é‡å’Œä¼ å…¥å‚æ•°çš„è¾ƒå¤§å€¼\n            minCapacity = Math.max(DEFAULT_CAPACITY, minCapacity);\n        }\n\n        ensureExplicitCapacity(minCapacity);\n    }\n```\n\n**å½“ è¦ add è¿›ç¬¬ 1 ä¸ªå…ƒç´ æ—¶ï¼ŒminCapacity ä¸º 1ï¼Œåœ¨ Math.max()æ–¹æ³•æ¯”è¾ƒåï¼ŒminCapacity ä¸º 10ã€‚**\n\n> æ­¤å¤„å’Œåç»­ JDK8 ä»£ç æ ¼å¼åŒ–ç•¥æœ‰ä¸åŒï¼Œæ ¸å¿ƒä»£ç åŸºæœ¬ä¸€æ ·ã€‚\n\n##### 2.3. `ensureExplicitCapacity()` \n\nå¦‚æœè°ƒç”¨ `ensureCapacityInternal()` æ–¹æ³•å°±ä¸€å®šä¼šè¿›å…¥ï¼ˆæ‰§è¡Œï¼‰è¿™ä¸ªæ–¹æ³•\n\n```java\n  //åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹\n    private void ensureExplicitCapacity(int minCapacity) {\n        modCount++;\n\n        // overflow-conscious code\n        if (minCapacity - elementData.length > 0)\n            //è°ƒç”¨growæ–¹æ³•è¿›è¡Œæ‰©å®¹ï¼Œè°ƒç”¨æ­¤æ–¹æ³•ä»£è¡¨å·²ç»å¼€å§‹æ‰©å®¹äº†\n            grow(minCapacity);\n    }\n```\n\næˆ‘ä»¬æ¥ä»”ç»†åˆ†æä¸€ä¸‹ï¼š\n\n- å½“æˆ‘ä»¬è¦ add è¿›ç¬¬ 1 ä¸ªå…ƒç´ åˆ° ArrayList æ—¶ï¼ŒelementData.length ä¸º 0 ï¼ˆå› ä¸ºè¿˜æ˜¯ä¸€ä¸ªç©ºçš„ listï¼‰ï¼Œå› ä¸ºæ‰§è¡Œäº† `ensureCapacityInternal()` æ–¹æ³• ï¼Œæ‰€ä»¥ minCapacity æ­¤æ—¶ä¸º 10ã€‚æ­¤æ—¶ï¼Œ`minCapacity - elementData.length > 0`æˆç«‹ï¼Œæ‰€ä»¥ä¼šè¿›å…¥ `grow(minCapacity)` æ–¹æ³•ã€‚\n- å½“ add ç¬¬ 2 ä¸ªå…ƒç´ æ—¶ï¼ŒminCapacity ä¸º 2ï¼Œæ­¤æ—¶ elementData.length(å®¹é‡)åœ¨æ·»åŠ ç¬¬ä¸€ä¸ªå…ƒç´ åæ‰©å®¹æˆ 10 äº†ã€‚æ­¤æ—¶ï¼Œ`minCapacity - elementData.length > 0` ä¸æˆç«‹ï¼Œæ‰€ä»¥ä¸ä¼šè¿›å…¥ ï¼ˆæ‰§è¡Œï¼‰`grow(minCapacity)` æ–¹æ³•ã€‚\n- æ·»åŠ ç¬¬ 3ã€4Â·Â·Â·åˆ°ç¬¬ 10 ä¸ªå…ƒç´ æ—¶ï¼Œä¾ç„¶ä¸ä¼šæ‰§è¡Œ grow æ–¹æ³•ï¼Œæ•°ç»„å®¹é‡éƒ½ä¸º 10ã€‚\n\nç›´åˆ°æ·»åŠ ç¬¬ 11 ä¸ªå…ƒç´ ï¼ŒminCapacity(ä¸º 11)æ¯” elementData.lengthï¼ˆä¸º 10ï¼‰è¦å¤§ã€‚è¿›å…¥ grow æ–¹æ³•è¿›è¡Œæ‰©å®¹ã€‚\n\n##### 2.4. `grow()` \n\n```java\n    /**\n     * è¦åˆ†é…çš„æœ€å¤§æ•°ç»„å¤§å°\n     */\n    private static final int MAX_ARRAY_SIZE = Integer.MAX_VALUE - 8;\n\n    /**\n     * ArrayListæ‰©å®¹çš„æ ¸å¿ƒæ–¹æ³•ã€‚\n     */\n    private void grow(int minCapacity) {\n        // oldCapacityä¸ºæ—§å®¹é‡ï¼ŒnewCapacityä¸ºæ–°å®¹é‡\n        int oldCapacity = elementData.length;\n        //å°†oldCapacity å³ç§»ä¸€ä½ï¼Œå…¶æ•ˆæœç›¸å½“äºoldCapacity /2ï¼Œ\n        //æˆ‘ä»¬çŸ¥é“ä½è¿ç®—çš„é€Ÿåº¦è¿œè¿œå¿«äºæ•´é™¤è¿ç®—ï¼Œæ•´å¥è¿ç®—å¼çš„ç»“æœå°±æ˜¯å°†æ–°å®¹é‡æ›´æ–°ä¸ºæ—§å®¹é‡çš„1.5å€ï¼Œ\n        int newCapacity = oldCapacity + (oldCapacity >> 1);\n        //ç„¶åæ£€æŸ¥æ–°å®¹é‡æ˜¯å¦å¤§äºæœ€å°éœ€è¦å®¹é‡ï¼Œè‹¥è¿˜æ˜¯å°äºæœ€å°éœ€è¦å®¹é‡ï¼Œé‚£ä¹ˆå°±æŠŠæœ€å°éœ€è¦å®¹é‡å½“ä½œæ•°ç»„çš„æ–°å®¹é‡ï¼Œ\n        if (newCapacity - minCapacity < 0)\n            newCapacity = minCapacity;\n       // å¦‚æœæ–°å®¹é‡å¤§äº MAX_ARRAY_SIZE,è¿›å…¥(æ‰§è¡Œ) `hugeCapacity()` æ–¹æ³•æ¥æ¯”è¾ƒ minCapacity å’Œ MAX_ARRAY_SIZEï¼Œ\n       //å¦‚æœminCapacityå¤§äºæœ€å¤§å®¹é‡ï¼Œåˆ™æ–°å®¹é‡åˆ™ä¸º`Integer.MAX_VALUE`ï¼Œå¦åˆ™ï¼Œæ–°å®¹é‡å¤§å°åˆ™ä¸º MAX_ARRAY_SIZE å³ä¸º `Integer.MAX_VALUE - 8`ã€‚\n        if (newCapacity - MAX_ARRAY_SIZE > 0)\n            newCapacity = hugeCapacity(minCapacity);\n        // minCapacity is usually close to size, so this is a win:\n        elementData = Arrays.copyOf(elementData, newCapacity);\n    }\n```\n\n**int newCapacity = oldCapacity + (oldCapacity >> 1),æ‰€ä»¥ ArrayList æ¯æ¬¡æ‰©å®¹ä¹‹åå®¹é‡éƒ½ä¼šå˜ä¸ºåŸæ¥çš„ 1.5 å€å·¦å³ï¼ˆoldCapacity ä¸ºå¶æ•°å°±æ˜¯ 1.5 å€ï¼Œå¦åˆ™æ˜¯ 1.5 å€å·¦å³ï¼‰** \n\n**æˆ‘ä»¬å†æ¥é€šè¿‡ä¾‹å­æ¢ç©¶ä¸€ä¸‹grow() æ–¹æ³• ï¼š**\n\n- å½“ add ç¬¬ 1 ä¸ªå…ƒç´ æ—¶ï¼ŒoldCapacity ä¸º 0ï¼Œç»æ¯”è¾ƒåç¬¬ä¸€ä¸ª if åˆ¤æ–­æˆç«‹ï¼ŒnewCapacity = minCapacity(ä¸º 10)ã€‚ä½†æ˜¯ç¬¬äºŒä¸ª if åˆ¤æ–­ä¸ä¼šæˆç«‹ï¼Œå³ newCapacity ä¸æ¯” MAX_ARRAY_SIZE å¤§ï¼Œåˆ™ä¸ä¼šè¿›å…¥ `hugeCapacity` æ–¹æ³•ã€‚æ•°ç»„å®¹é‡ä¸º 10ï¼Œadd æ–¹æ³•ä¸­ return true,size å¢ä¸º 1ã€‚\n- å½“ add ç¬¬ 11 ä¸ªå…ƒç´ è¿›å…¥ grow æ–¹æ³•æ—¶ï¼ŒnewCapacity ä¸º 15ï¼Œæ¯” minCapacityï¼ˆä¸º 11ï¼‰å¤§ï¼Œç¬¬ä¸€ä¸ª if åˆ¤æ–­ä¸æˆç«‹ã€‚æ–°å®¹é‡æ²¡æœ‰å¤§äºæ•°ç»„æœ€å¤§ sizeï¼Œä¸ä¼šè¿›å…¥ hugeCapacity æ–¹æ³•ã€‚æ•°ç»„å®¹é‡æ‰©ä¸º 15ï¼Œadd æ–¹æ³•ä¸­ return true,size å¢ä¸º 11ã€‚\n- ä»¥æ­¤ç±»æ¨Â·Â·Â·Â·Â·Â·\n\n##### 2.5. `hugeCapacity()` \n\nä»ä¸Šé¢ `grow()` æ–¹æ³•æºç æˆ‘ä»¬çŸ¥é“ï¼š å¦‚æœæ–°å®¹é‡å¤§äº MAX_ARRAY_SIZE,è¿›å…¥(æ‰§è¡Œ) `hugeCapacity()` æ–¹æ³•æ¥æ¯”è¾ƒ minCapacity å’Œ MAX_ARRAY_SIZEï¼Œå¦‚æœ minCapacity å¤§äºæœ€å¤§å®¹é‡ï¼Œåˆ™æ–°å®¹é‡åˆ™ä¸º`Integer.MAX_VALUE`ï¼Œå¦åˆ™ï¼Œæ–°å®¹é‡å¤§å°åˆ™ä¸º MAX_ARRAY_SIZE å³ä¸º `Integer.MAX_VALUE - 8`ã€‚\n\n```java\n    private static int hugeCapacity(int minCapacity) {\n        if (minCapacity < 0) // overflow\n            throw new OutOfMemoryError();\n        //å¯¹minCapacityå’ŒMAX_ARRAY_SIZEè¿›è¡Œæ¯”è¾ƒ\n        //è‹¥minCapacityå¤§ï¼Œå°†Integer.MAX_VALUEä½œä¸ºæ–°æ•°ç»„çš„å¤§å°\n        //è‹¥MAX_ARRAY_SIZEå¤§ï¼Œå°†MAX_ARRAY_SIZEä½œä¸ºæ–°æ•°ç»„çš„å¤§å°\n        //MAX_ARRAY_SIZE = Integer.MAX_VALUE - 8;\n        return (minCapacity > MAX_ARRAY_SIZE) ?\n            Integer.MAX_VALUE :\n            MAX_ARRAY_SIZE;\n    }\n```\n\n### Setæ¥å£\n\n#### HashSet çš„å®ç°åŸç†ï¼Ÿ\n\nHashSet æ˜¯åŸºäº HashMap å®ç°çš„ï¼ŒHashSet çš„å€¼å­˜æ”¾äº HashMap çš„ key ä¸Šï¼ŒHashMap çš„ value ç»Ÿä¸€ä¸º Object å¸¸é‡ PRESENTï¼Œç”±äº HashMap çš„ key ä¸å…è®¸é‡å¤ï¼Œè€Œ HashSet ä¸å…è®¸é‡å¤çš„å€¼ï¼Œå› æ­¤ HashSet å¯ä»¥åŸºäº HashMap å®ç°ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯ç›´æ¥è°ƒç”¨åº•å±‚ HashMap çš„ç›¸å…³æ–¹æ³•æ¥å®Œæˆã€‚\n\n#### HashSetæ˜¯å¦‚ä½•ä¿è¯æ•°æ®ä¸å¯é‡å¤çš„ï¼Ÿ\n\nå½“ä½ æŠŠå¯¹è±¡åŠ å…¥ hashSet æ—¶ï¼ŒhashSet ä¼šå…ˆè®¡ç®—å¯¹è±¡çš„ hashcode å€¼æ¥åˆ¤æ–­å¯¹è±¡åŠ å…¥çš„ä½ç½®ï¼Œå¦‚æœå‘ç°æœ‰ç›¸åŒ hashcode å€¼çš„å¯¹è±¡ï¼Œè¿™æ—¶ä¼šè°ƒç”¨ equals()æ–¹æ³•æ¥æ£€æŸ¥ hashcode ç›¸ç­‰çš„å¯¹è±¡æ˜¯å¦çœŸçš„ç›¸åŒã€‚å¦‚æœä¸¤è€…ç›¸åŒï¼Œè¡¨æ˜å·²ç»æœ‰äº†ç›¸åŒçš„å¯¹è±¡äº†ï¼ŒhashSet å°±ä¸ä¼šè®©å…¶åŠ å…¥æ“ä½œæˆåŠŸã€‚å¦‚æœä¸åŒçš„è¯ï¼Œå°±ä¼šé‡æ–°æ•£åˆ—åˆ°å…¶ä»–ä½ç½®ã€‚ \n\n```java\n// Dummy value to associate with an Object in the backing Map\nprivate static final Object PRESENT = new Object();\nprivate transient HashMap<E,Object> map;\n\npublic HashSet() {\n    map = new HashMap<>();\n}\n\npublic boolean add(E e) {\n    // è°ƒç”¨HashMapçš„putæ–¹æ³•,PRESENTæ˜¯ä¸€ä¸ªè‡³å§‹è‡³ç»ˆéƒ½ç›¸åŒçš„è™šå€¼\n\treturn map.put(e, PRESENT)==null;\n}\n```\n\n#### åªé‡å†™ hashCode å¯ä»¥å—ï¼Ÿ\n\nä¸¤ä¸ªå¯¹è±¡çš„ hashCode ç›¸åŒï¼Œä½†æ˜¯å†…å®¹å¯èƒ½ä¸åŒï¼Œåœ¨ set ä¸­æ˜æ˜åº”è¯¥æ˜¯ä¸¤ä¸ªä¸åŒçš„å¯¹è±¡ï¼Œè¿™æ—¶å€™åªé€šè¿‡ hashCode åˆ¤æ–­ä»–ä¿©ç›¸åŒä¼šå¯¼è‡´åªæ’å…¥ä¸€ä¸ªå…ƒç´ ã€‚\n\n#### åªé‡å†™ equalså¯ä»¥å—ï¼Ÿ\n\nå¦‚æœåœ¨é‡å†™ equals æ—¶ï¼Œä¸é‡å†™ hashCodeï¼Œå°±ä¼šå¼•èµ·æ¯”å¦‚è¯´å°†ä¸¤ä¸ªç›¸ç­‰çš„è‡ªå®šä¹‰å¯¹è±¡å­˜å‚¨åœ¨ Set é›†åˆæ—¶ï¼Œä¼šå°†è¿™ä¸¤ä¸ªå¯¹è±¡éƒ½è¿›è¡Œæ’å…¥ã€‚ï¼ˆæ— æ³•å»é‡ï¼‰\n\n## Mapæ¥å£\n\n### HashMapçº¿ç¨‹ä¸å®‰å…¨çš„ä¸»è¦ä½“ç°ï¼Ÿ\n\n1. åœ¨ jdk1.7 ä¸­ï¼Œåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œ**æ‰©å®¹**æ—¶ä¼šé€ æˆæ­»é“¾ã€‚\n\n\t> ä½œè€…ï¼šç£Šå“¥\n\t> é“¾æ¥ï¼šhttps://www.zhihu.com/question/394039290/answer/2314917909\n\t> æ¥æºï¼šçŸ¥ä¹\n\n\t1.1ã€\n\n\tæ­»å¾ªç¯æ˜¯å› ä¸ºå¹¶å‘ HashMap æ‰©å®¹å¯¼è‡´çš„ï¼Œå¹¶å‘æ‰©å®¹çš„ç¬¬ä¸€æ­¥ï¼Œçº¿ç¨‹ T1 å’Œçº¿ç¨‹ T2 è¦å¯¹ HashMap è¿›è¡Œæ‰©å®¹æ“ä½œï¼Œæ­¤æ—¶ T1 å’Œ T2 æŒ‡å‘çš„æ˜¯é“¾è¡¨çš„å¤´ç»“ç‚¹å…ƒç´  Aï¼Œè€Œ T1 å’Œ T2 çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯ T1.next å’Œ T2.next æŒ‡å‘çš„æ˜¯ B èŠ‚ç‚¹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š \n\n\t![å¤šçº¿ç¨‹æ‰©å®¹å¯¼è‡´æ­»å¾ªç¯é—®é¢˜-1](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/v2-e0b4f5ea00cb277bde490f315b9b387f_720w.jpg)\n\n\t1.2ã€\n\n\tæ­»å¾ªç¯çš„ç¬¬äºŒæ­¥æ“ä½œæ˜¯ï¼Œçº¿ç¨‹ T2 æ—¶é—´ç‰‡ç”¨å®Œè¿›å…¥ä¼‘çœ çŠ¶æ€ï¼Œè€Œçº¿ç¨‹ T1 å¼€å§‹æ‰§è¡Œæ‰©å®¹æ“ä½œï¼Œä¸€ç›´åˆ°çº¿ç¨‹ T1 æ‰©å®¹å®Œæˆåï¼Œçº¿ç¨‹ T2 æ‰è¢«å”¤é†’ï¼Œæ‰©å®¹ä¹‹åçš„åœºæ™¯å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š \n\n\t![å¤šçº¿ç¨‹æ‰©å®¹å¯¼è‡´æ­»å¾ªç¯é—®é¢˜-2](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/v2-5f78d8ac8af1efc79e7d79a1f3fdc154_r.jpg)\n\n\t ä»ä¸Šå›¾å¯çŸ¥çº¿ç¨‹ T1 æ‰§è¡Œä¹‹åï¼Œ**å› ä¸ºæ˜¯å¤´æ’æ³•ï¼Œæ‰€ä»¥HashMapçš„é¡ºåºå·²ç»å‘ç”Ÿäº†æ”¹å˜**ï¼Œä½†çº¿ç¨‹ T2 å¯¹äºå‘ç”Ÿçš„ä¸€åˆ‡æ˜¯ä¸å¯çŸ¥çš„ï¼Œæ‰€ä»¥å®ƒçš„æŒ‡å‘å…ƒç´ ä¾ç„¶æ²¡å˜ï¼Œå¦‚ä¸Šå›¾å±•ç¤ºçš„é‚£æ ·ï¼ŒT2 æŒ‡å‘çš„æ˜¯ A å…ƒç´ ï¼ŒT2.next æŒ‡å‘çš„èŠ‚ç‚¹æ˜¯ B å…ƒç´ ã€‚\n\n\t1.3ã€\n\n\tå½“çº¿ç¨‹ T1 æ‰§è¡Œå®Œï¼Œè€Œçº¿ç¨‹ T2 æ¢å¤æ‰§è¡Œæ—¶ï¼Œæ­»å¾ªç¯å°±å»ºç«‹äº†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š \n\n\t![å¤šçº¿ç¨‹æ‰©å®¹å¯¼è‡´æ­»å¾ªç¯é—®é¢˜-3](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/v2-bd4a753db8c985119aa4dcd4356609cf_720w.jpg)\n\n\t å› ä¸º T1 æ‰§è¡Œå®Œæ‰©å®¹ä¹‹å B èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ˜¯ Aï¼Œè€Œ T2 çº¿ç¨‹æŒ‡å‘çš„é¦–èŠ‚ç‚¹æ˜¯ Aï¼Œç¬¬äºŒä¸ªèŠ‚ç‚¹æ˜¯ Bï¼Œè¿™ä¸ªé¡ºåºåˆšå¥½å’Œ T1 æ‰©å®Œå®¹å®Œä¹‹åçš„èŠ‚ç‚¹é¡ºåºæ˜¯ç›¸åçš„ã€‚**T1æ‰§è¡Œå®Œä¹‹åçš„é¡ºåºæ˜¯Båˆ°Aï¼Œè€ŒT2çš„é¡ºåºæ˜¯Aåˆ°Bï¼Œè¿™æ ·AèŠ‚ç‚¹å’ŒBèŠ‚ç‚¹å°±å½¢æˆæ­»å¾ªç¯äº†**ï¼Œè¿™å°±æ˜¯ HashMap æ­»å¾ªç¯å¯¼è‡´çš„åŸå› ã€‚\n\n2. åœ¨ jdk1.8 ä¸­ï¼Œåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œ**æ’å…¥**æ—¶ä¼šå‘ç”Ÿæ•°æ®è¦†ç›–çš„æƒ…å†µï¼ˆ**å°¾æ’æ³•**ï¼‰ã€‚\n\n### HashMapåœ¨JDK1.7å’ŒJDK1.8ä¸­æœ‰å“ªäº›ä¸åŒï¼Ÿ\n\n| ä¸åŒ                         | JDK 1.7                                                      | JDK 1.8                                                      |\n| ---------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |\n| **å­˜å‚¨ç»“æ„**                 | æ•°ç»„ + é“¾è¡¨                                                  | æ•°ç»„ + é“¾è¡¨ + çº¢é»‘æ ‘                                         |\n| **hashå€¼è®¡ç®—æ–¹å¼**           | æ‰°åŠ¨å¤„ç† = 4æ¬¡ä½è¿ç®— + 5æ¬¡å¼‚æˆ–è¿ç®—                           | æ‰°åŠ¨å¤„ç† = 1æ¬¡ä½è¿ç®— + 1æ¬¡å¼‚æˆ–è¿ç®—                           |\n| **å­˜æ”¾æ•°æ®çš„è§„åˆ™**           | æ— å†²çªæ—¶ï¼Œå­˜æ”¾æ•°ç»„ï¼›<br />å†²çªæ—¶ï¼Œå­˜æ”¾é“¾è¡¨                   | æ— å†²çªæ—¶ï¼Œå­˜æ”¾æ•°ç»„ï¼›<br />å†²çª & é“¾è¡¨é•¿åº¦ < 8ï¼šæ’å…¥å•é“¾è¡¨ï¼›<br />é“¾è¡¨é•¿åº¦>8ï¼Œå…ˆå°è¯•æ‰©å®¹æ•°ç»„ï¼Œæ•°ç»„é•¿åº¦å¤§äº64<br />é“¾è¡¨è½¬ä¸ºçº¢é»‘æ ‘ï¼Œæ’å…¥åˆ°çº¢é»‘æ ‘ |\n| **æ’å…¥æ•°æ®æ–¹å¼**             | å¤´æ’æ³•                                                       | å°¾æ’æ³•                                                       |\n| **æ‰©å®¹åå­˜å‚¨ä½ç½®çš„è®¡ç®—æ–¹å¼** | æŒ‰ç…§åŸæ¥æ–¹æ³•é‡æ–°è¿›è¡Œè®¡ç®—<br />hashCodeã€æ‰°åŠ¨å‡½æ•°ã€ä¸è¿ç®—h&length-1 | æ ¹æ®å…ƒç´ çš„hashå€¼è¿›è¡Œåˆ¤æ–­ <br />æ‰©å®¹åçš„ä½ç½®=åŸä½ç½® or åŸä½ç½® + æ—§å®¹é‡ |\n\n### HashMapçš„hashç®—æ³•\n\n#### ä»€ä¹ˆæ˜¯å“ˆå¸Œï¼Ÿ\n\nHashï¼Œå°±æ˜¯æŠŠä»»æ„é•¿åº¦çš„è¾“å…¥é€šè¿‡æ•£åˆ—ç®—æ³•ï¼Œå˜æ¢æˆå›ºå®šé•¿åº¦çš„è¾“å‡ºï¼Œè¯¥è¾“å‡ºå°±æ˜¯æ•£åˆ—å€¼ï¼ˆå“ˆå¸Œå€¼ï¼‰ï¼›\n\nhash å€¼ä¸åŒï¼Œè¾“å…¥ä¸€å®šä¸åŒï¼›è¾“å…¥ä¸åŒï¼Œhash å€¼å¯èƒ½ç›¸åŒï¼ˆå³å“ˆå¸Œç¢°æ’ï¼‰\n\n#### ä»€ä¹ˆæ˜¯å“ˆå¸Œå†²çªï¼Ÿ\n\nå½“ä¸¤ä¸ªä¸åŒçš„è¾“å…¥å€¼ï¼Œæ ¹æ®åŒä¸€æ•£åˆ—å‡½æ•°è®¡ç®—å‡ºç›¸åŒçš„æ•£åˆ—å€¼çš„ç°è±¡ï¼Œæˆ‘ä»¬å°±æŠŠå®ƒå«åšå“ˆå¸Œç¢°æ’/å†²çªã€‚\n\n#### HashMapçš„æ•°æ®ç»“æ„\n\nåº•å±‚æ•°æ®ç»“æ„ï¼šæ•°ç»„+é“¾è¡¨\n**æ•°ç»„çš„ç‰¹ç‚¹æ˜¯ï¼šæ–¹ä¾¿æŸ¥æ‰¾ï¼›é“¾è¡¨çš„ç‰¹ç‚¹æ˜¯ï¼šæ–¹ä¾¿æ’å…¥åˆ é™¤**\næ‰€ä»¥æˆ‘ä»¬å°†æ•°ç»„å’Œé“¾è¡¨ç»“åˆåœ¨ä¸€èµ·ï¼Œå‘æŒ¥ä¸¤è€…å„è‡ªçš„ä¼˜åŠ¿ï¼Œä½¿ç”¨ä¸€ç§å«åš**é“¾åœ°å€æ³•**çš„æ–¹å¼å¯ä»¥è§£å†³å“ˆå¸Œå†²çª\n\n> è§£å†³å“ˆå¸Œå†²çªçš„å…¶ä»–æ–¹æ³•ï¼š\n> å¼€æ”¾å®šå€æ³•ï¼ˆå†²çªäº†é€šè¿‡æŸç§æ–¹å¼æ•£åˆ—åˆ°å¦ä¸€ä¸ªä¸å†²çªçš„ä½ç½®ä¸Šï¼‰ï¼›\n> å†å“ˆå¸Œæ³•ï¼ˆæ„é€ å¤šä¸ªä¸åŒçš„å“ˆå¸Œå‡½æ•°ï¼‰ã€‚\n\n![HashMapæ•°æ®ç»“æ„](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy83ODk2ODkwLWM2NmE0YmQ4OTA3ZjQ5ZjYucG5n.png)\n\n#### æ‰°åŠ¨å¤„ç†\n\nç”±äºè®¡ç®—ä¸‹æ ‡æ—¶ï¼Œé€šè¿‡ h & (length - 1)ï¼Œç”±äº hash å€¼èŒƒå›´å¾ˆå¤§ï¼Œè€Œæ•°ç»„é•¿åº¦ç›¸å¯¹æ¥è¯´å°å¾—å¤šï¼Œå¯¼è‡´è¿›è¡Œä¸è¿ç®—æ—¶å‚ä¸è¿ç®—çš„åªæœ‰ hash å€¼çš„ä½ä½ï¼Œ**é«˜ä½æ˜¯æ²¡æœ‰èµ·åˆ°ä»»ä½•ä½œç”¨çš„**ï¼Œè¿™å°†ä¼šå¤§å¤§å¢åŠ å“ˆå¸Œç¢°æ’çš„æ¦‚ç‡ã€‚æ‰€ä»¥æˆ‘ä»¬çš„æ€è·¯å°±æ˜¯è®© hashCode å€¼çš„é«˜ä½ä¹Ÿå‚ä¸è¿ç®—ï¼Œè¿›ä¸€æ­¥é™ä½ hash ç¢°æ’çš„æ¦‚ç‡ï¼Œä½¿å¾—**æ•°æ®åˆ†å¸ƒæ›´å¹³å‡**ï¼Œæˆ‘ä»¬æŠŠè¿™æ ·çš„æ“ä½œç§°ä¸º**æ‰°åŠ¨**ï¼Œåœ¨**JDK 1.8**ä¸­çš„ hash()å‡½æ•°å¦‚ä¸‹ï¼š\n\n```java\nstatic final int hash(Object key) {\n    int h;\n    return (key == null) ? 0 : (h = key.hashCode()) ^ (h >>> 16);\n    // ä¸è‡ªå·±å³ç§»16ä½è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼ˆé«˜ä½ä½å¼‚æˆ–ï¼‰\n}\n```\n\nè¿™æ¯”åœ¨**JDK 1.7**ä¸­ï¼Œæ›´ä¸ºç®€æ´ï¼Œ**ç›¸æ¯”åœ¨1.7ä¸­çš„4æ¬¡ä½è¿ç®—ï¼Œ5æ¬¡å¼‚æˆ–è¿ç®—ï¼ˆ9æ¬¡æ‰°åŠ¨ï¼‰ï¼Œåœ¨1.8ä¸­ï¼Œåªè¿›è¡Œäº†1æ¬¡ä½è¿ç®—å’Œ1æ¬¡å¼‚æˆ–è¿ç®—ï¼ˆ2æ¬¡æ‰°åŠ¨ï¼‰**ï¼›\n\n#### ä¸‹æ ‡è®¡ç®—\n\nåœ¨å¾—åˆ° hash å€¼ä¹‹åï¼Œæˆ‘ä»¬è¦æŠŠè¿™äº› hash å€¼æ˜ å°„åˆ°ç›¸åº”çš„æ•°ç»„ä¸‹æ ‡ä¸Šï¼Œé‚£ä¹ˆå°±å¯ä»¥è€ƒè™‘ä½¿ç”¨ hash % length\n\nè€Œ hash % length==hash & (length-1) å¹¶ä¸”å‰ææ˜¯ length æ˜¯ 2 çš„ n æ¬¡æ–¹ã€‚\nç”±äºé‡‡ç”¨äºŒè¿›åˆ¶ä½æ“ä½œ &ï¼Œç›¸å¯¹äº%èƒ½å¤Ÿæé«˜è¿ç®—æ•ˆç‡ï¼Œå› æ­¤å¯ä»¥å°† HashMap çš„é•¿åº¦è®¾è®¡ä¸º 2 çš„å¹‚æ¬¡æ–¹ã€‚ï¼ˆåˆå§‹åŒ–ä¸º 16ï¼Œå¦‚æœæŒ‡å®šåˆå§‹åŒ–å®¹é‡çš„å€¼ï¼Œä¼šæ‰©å®¹è‡³ç¬¬ä¸€ä¸ªå¤§äºè¯¥å®¹é‡çš„ 2 çš„å¹‚æ¬¡æ–¹ä½œä¸ºæ•°ç»„å®¹é‡ï¼‰\n\n```java\nstatic int indexFor(int h, int length){\n     return h & (length - 1);\n}\n```\n\n#### ä¸ºä»€ä¹ˆè¦å°†æ•°ç»„é•¿åº¦è®¾ç½®ä¸º 2 çš„næ¬¡å¹‚å‘¢ï¼Ÿ\n\nå½“æ•°ç»„é•¿åº¦ä¸º 2 çš„ n æ¬¡å¹‚çš„æ—¶å€™ï¼Œä¸åŒçš„ key ä¸ 1111ï¼ˆn ä¸ªï¼‰è¿›è¡Œä¸é¢„ç®—å¾—åˆ°ç›¸åŒä¸‹æ ‡çš„å‡ ç‡è¾ƒå°ï¼Œå‘ç”Ÿç¢°æ’çš„å‡ ç‡å°ã€‚ \n\n#### JDK1.8æ–°å¢çº¢é»‘æ ‘\n\nä¸ºäº†è§£å†³ä¸€æ¡é“¾ä¸Šçš„å…ƒç´ è¿‡å¤šï¼ŒæŸ¥æ‰¾æ•ˆç‡ä½çš„é—®é¢˜ï¼Œå°†é“¾è¡¨è½¬åŒ–ä¸ºçº¢é»‘æ ‘ï¼Œéå†å¤æ‚åº¦é™ä½è‡³ O(logn)ï¼›\n\n#### HashMapæ˜¯ä½¿ç”¨äº†å“ªäº›æ–¹æ³•æ¥æœ‰æ•ˆè§£å†³å“ˆå¸Œå†²çªçš„ï¼Ÿ\n\n1. ä½¿ç”¨é“¾åœ°å€æ³•ï¼ˆä½¿ç”¨æ•£åˆ—è¡¨ï¼‰æ¥é“¾æ¥æ‹¥æœ‰ç›¸åŒ hash å€¼çš„æ•°æ®ï¼›\n2. ä½¿ç”¨ 2 æ¬¡æ‰°åŠ¨å‡½æ•°ï¼ˆ1 æ¬¡ä½è¿ç®—å’Œ 1 æ¬¡å¼‚æˆ–è¿ç®—ï¼‰æ¥é™ä½å“ˆå¸Œå†²çªçš„æ¦‚ç‡ï¼Œä½¿å¾—æ•°æ®åˆ†å¸ƒæ›´å¹³å‡ï¼›\n3. å¼•å…¥çº¢é»‘æ ‘è¿›ä¸€æ­¥é™ä½éå†çš„æ—¶é—´å¤æ‚åº¦ï¼Œä½¿å¾—éå†æ›´å¿«ã€‚\n\n### HashMapçš„getæ–¹æ³•çš„å…·ä½“æµç¨‹ï¼Ÿ\n\n1. å…ˆä½¿ç”¨ key çš„ hashCodeã€æ‰°åŠ¨å¤„ç†ã€ä¸æ•°ç»„é•¿åº¦-1 è¿›è¡Œä¸è¿ç®—ï¼ˆå¯¹æ•°ç»„é•¿åº¦å»ä½™ï¼‰å¾—åˆ°æ§½ä½ï¼›\n2. åˆ¤æ–­é¦–ç»“ç‚¹ï¼Œå¦‚æœé¦–ç»“ç‚¹å’Œ key çš„ **hashå€¼** ï¼ˆhashCode å€¼ç»è¿‡æ‰°åŠ¨å‡½æ•°å¤„ç†åçš„å€¼ï¼‰ç›¸ç­‰ï¼Œå¹¶ä¸”ä¸¤è€…çš„ **keyå€¼åœ°å€ç›¸ç­‰ã€equalsç›¸ç­‰**ï¼Œåˆ™è¿”å›é¦–ç»“ç‚¹ï¼›\n3. å¦åˆ™ï¼Œåˆ™çº¢é»‘æ ‘æˆ–è€…é“¾è¡¨ä¸­è¿›è¡ŒæŸ¥æ‰¾ï¼ŒæŸ¥æ‰¾æ—¶åˆ¤æ–­ä¸¤ä¸ª key çš„ hash å€¼ã€key å€¼åœ°å€ç›¸ç­‰ã€equals æ˜¯å¦éƒ½ç›¸ç­‰ã€‚\n\n```java\npublic V get(Object key) {\n    Node<K,V> e;\n    return (e = getNode(hash(key), key)) == null ? null : e.value;\n}\n\nfinal Node<K,V> getNode(int hash, Object key) {\n    Node<K,V>[] tab; Node<K,V> first, e; int n; K k;\n    \n    //Nodeæ•°ç»„ä¸ä¸ºç©ºï¼Œæ•°ç»„é•¿åº¦å¤§äº0ï¼Œæ•°ç»„å¯¹åº”ä¸‹æ ‡çš„Nodeä¸ä¸ºç©º\n    if ((tab = table) != null && (n = tab.length) > 0 &&\n        //ä¹Ÿæ˜¯é€šè¿‡ hash & (length - 1) æ¥æ›¿ä»£ hash % length çš„\n        (first = tab[(n - 1) & hash]) != null) {\n        \n        //å…ˆå’Œç¬¬ä¸€ä¸ªç»“ç‚¹æ¯”ï¼Œhashå€¼ç›¸ç­‰ä¸”keyä¸ä¸ºç©ºï¼Œkeyçš„ç¬¬ä¸€ä¸ªç»“ç‚¹çš„keyçš„å¯¹è±¡åœ°å€å’Œå€¼å‡ç›¸ç­‰\n        //åˆ™è¿”å›ç¬¬ä¸€ä¸ªç»“ç‚¹\n        if (first.hash == hash && // always check first node\n            ((k = first.key) == key || (key != null && key.equals(k))))\n            return first;\n        //å¦‚æœkeyå’Œç¬¬ä¸€ä¸ªç»“ç‚¹ä¸åŒ¹é…ï¼Œåˆ™çœ‹.nextæ˜¯å¦ä¸ºç©ºï¼Œä¸ä¸ºnullåˆ™ç»§ç»­ï¼Œä¸ºç©ºåˆ™è¿”å›null\n        if ((e = first.next) != null) {\n            //å¦‚æœæ­¤æ—¶æ˜¯çº¢é»‘æ ‘çš„ç»“æ„ï¼Œåˆ™è¿›è¡Œå¤„ç†getTreeNode()æ–¹æ³•æœç´¢key\n            if (first instanceof TreeNode)\n                return ((TreeNode<K,V>)first).getTreeNode(hash, key);\n            //æ˜¯é“¾è¡¨ç»“æ„çš„è¯å°±ä¸€ä¸ªä¸€ä¸ªéå†ï¼Œç›´åˆ°æ‰¾åˆ°keyå¯¹åº”çš„ç»“ç‚¹ï¼Œ\n            //æˆ–è€…eçš„ä¸‹ä¸€ä¸ªç»“ç‚¹ä¸ºnullé€€å‡ºå¾ªç¯\n            do {\n                if (e.hash == hash &&\n                    ((k = e.key) == key || (key != null && key.equals(k))))\n                    return e;\n            } while ((e = e.next) != null);\n        }\n    }\n    return null;\n}\n```\n\n### HashMapçš„putæ–¹æ³•çš„å…·ä½“æµç¨‹ï¼Ÿ\n\n1. å¦‚æœ table æœªåˆå§‹åŒ–æˆ–è€…é•¿åº¦ä¸º 0 ç©ºåˆ™æ‰§è¡Œ resize()è¿›è¡Œæ‰©å®¹ï¼Œè½¬å‘â‘¡\n2. æ ¹æ®é”®å€¼ key è®¡ç®— hash å€¼å¾—åˆ°æ’å…¥çš„æ•°ç»„ç´¢å¼• iï¼Œå¦‚æœ table[i]==nullï¼Œå³æ•°ç»„è¯¥ä½ç½®ä¸Šæ²¡æœ‰å…ƒç´ ï¼Œç›´æ¥æ–°å»ºèŠ‚ç‚¹æ’å…¥ï¼Œè½¬å‘â‘¥åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹ï¼Œå¦‚æœ table[i]ä¸ä¸ºç©ºï¼Œè½¬å‘â‘¢ï¼›\n3. åˆ¤æ–­ table[i]çš„é¦–ä¸ªå…ƒç´ æ˜¯å¦å’Œ key ä¸€æ ·ï¼Œå¦‚æœç›¸åŒï¼ˆhashCode ç›¸åŒã€key åœ°å€ç›¸åŒã€equals ç›¸åŒï¼‰ç›´æ¥è¦†ç›– valueï¼Œå¦åˆ™è½¬å‘â‘£ï¼›\n4. åˆ¤æ–­ table[i] æ˜¯å¦ä¸º treeNodeï¼Œå³ table[i] æ˜¯å¦æ˜¯çº¢é»‘æ ‘ï¼Œå¦‚æœæ˜¯çº¢é»‘æ ‘ï¼Œåˆ™ç›´æ¥åœ¨æ ‘ä¸­æ’å…¥é”®å€¼å¯¹ï¼Œå¦åˆ™è½¬å‘â‘¤ï¼›\n5. éå† table[i]ï¼Œåˆ¤æ–­é“¾è¡¨é•¿åº¦æ˜¯å¦å¤§äº 8ï¼Œå¤§äº 8 çš„è¯æŠŠé“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼Œåœ¨çº¢é»‘æ ‘ä¸­æ‰§è¡Œæ’å…¥æ“ä½œï¼Œå¦åˆ™è¿›è¡Œé“¾è¡¨çš„æ’å…¥æ“ä½œï¼›éå†è¿‡ç¨‹ä¸­è‹¥å‘ç° key å·²ç»å­˜åœ¨ç›´æ¥è¦†ç›– value å³å¯ï¼›\n6. æ’å…¥æˆåŠŸåï¼Œåˆ¤æ–­å®é™…å­˜åœ¨çš„é”®å€¼å¯¹æ•°é‡ size æ˜¯å¦è¶…å‡ºå½“å‰æœ€å¤§å®¹é‡ thresholdï¼Œå¦‚æœè¶…è¿‡ï¼Œè¿›è¡Œæ‰©å®¹ã€‚\n\n```java\npublic V put(K key, V value) {\n    return putVal(hash(key), key, value, false, true);\n}\n\nstatic final int hash(Object key) {\n    int h;\n    return (key == null) ? 0 : (h = key.hashCode()) ^ (h >>> 16);\n}\n\n//å®ç°Map.putå’Œç›¸å…³æ–¹æ³•\nfinal V putVal(int hash, K key, V value, boolean onlyIfAbsent,\n                   boolean evict) {\n    Node<K,V>[] tab; Node<K,V> p; int n, i;\n    // æ­¥éª¤â‘ ï¼štabä¸ºç©ºåˆ™åˆ›å»º \n    // tableæœªåˆå§‹åŒ–æˆ–è€…é•¿åº¦ä¸º0ï¼Œè¿›è¡Œæ‰©å®¹\n    if ((tab = table) == null || (n = tab.length) == 0)\n        n = (tab = resize()).length;\n    // æ­¥éª¤â‘¡ï¼šè®¡ç®—indexï¼Œå¹¶å¯¹nullåšå¤„ç†  \n    // (n - 1) & hash ç¡®å®šå…ƒç´ å­˜æ”¾åœ¨å“ªä¸ªæ¡¶ä¸­ï¼Œæ¡¶ä¸ºç©ºï¼Œæ–°ç”Ÿæˆç»“ç‚¹æ”¾å…¥æ¡¶ä¸­(æ­¤æ—¶ï¼Œè¿™ä¸ªç»“ç‚¹æ˜¯æ”¾åœ¨æ•°ç»„ä¸­)\n    if ((p = tab[i = (n - 1) & hash]) == null)\n        tab[i] = newNode(hash, key, value, null);\n    // æ¡¶ä¸­å·²ç»å­˜åœ¨å…ƒç´ \n    else {\n        Node<K,V> e; K k;\n        // æ­¥éª¤â‘¢ï¼šèŠ‚ç‚¹keyå­˜åœ¨ï¼Œç›´æ¥è¦†ç›–value \n        // æ¯”è¾ƒæ¡¶ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ (æ•°ç»„ä¸­çš„ç»“ç‚¹)çš„hashå€¼ç›¸ç­‰ï¼Œkeyç›¸ç­‰\n        if (p.hash == hash &&\n            ((k = p.key) == key || (key != null && key.equals(k))))\n                // å°†ç¬¬ä¸€ä¸ªå…ƒç´ èµ‹å€¼ç»™eï¼Œç”¨eæ¥è®°å½•\n                e = p;\n        // æ­¥éª¤â‘£ï¼šåˆ¤æ–­è¯¥é“¾ä¸ºçº¢é»‘æ ‘ \n        // hashå€¼ä¸ç›¸ç­‰ï¼Œå³keyä¸ç›¸ç­‰ï¼›ä¸ºçº¢é»‘æ ‘ç»“ç‚¹\n        // å¦‚æœå½“å‰å…ƒç´ ç±»å‹ä¸ºTreeNodeï¼Œè¡¨ç¤ºä¸ºçº¢é»‘æ ‘ï¼ŒputTreeValè¿”å›å¾…å­˜æ”¾çš„node, eå¯èƒ½ä¸ºnull\n        else if (p instanceof TreeNode)\n            // æ”¾å…¥æ ‘ä¸­\n            e = ((TreeNode<K,V>)p).putTreeVal(this, tab, hash, key, value);\n        // æ­¥éª¤â‘¤ï¼šè¯¥é“¾ä¸ºé“¾è¡¨ \n        // ä¸ºé“¾è¡¨ç»“ç‚¹\n        else {\n            // åœ¨é“¾è¡¨æœ€æœ«æ’å…¥ç»“ç‚¹\n            for (int binCount = 0; ; ++binCount) {\n                // åˆ°è¾¾é“¾è¡¨çš„å°¾éƒ¨\n                \n                //åˆ¤æ–­è¯¥é“¾è¡¨å°¾éƒ¨æŒ‡é’ˆæ˜¯ä¸æ˜¯ç©ºçš„\n                if ((e = p.next) == null) {\n                    // åœ¨å°¾éƒ¨æ’å…¥æ–°ç»“ç‚¹\n                    p.next = newNode(hash, key, value, null);\n                    //åˆ¤æ–­é“¾è¡¨çš„é•¿åº¦æ˜¯å¦è¾¾åˆ°è½¬åŒ–çº¢é»‘æ ‘çš„ä¸´ç•Œå€¼ï¼Œä¸´ç•Œå€¼ä¸º8\n                    if (binCount >= TREEIFY_THRESHOLD - 1) // -1 for 1st\n                        //é“¾è¡¨ç»“æ„è½¬æ ‘å½¢ç»“æ„\n                        treeifyBin(tab, hash);\n                    // è·³å‡ºå¾ªç¯\n                    break;\n                }\n                // åˆ¤æ–­é“¾è¡¨ä¸­ç»“ç‚¹çš„keyå€¼ä¸æ’å…¥çš„å…ƒç´ çš„keyå€¼æ˜¯å¦ç›¸ç­‰\n                if (e.hash == hash &&\n                    ((k = e.key) == key || (key != null && key.equals(k))))\n                    // ç›¸ç­‰ï¼Œè·³å‡ºå¾ªç¯\n                    break;\n                // ç”¨äºéå†æ¡¶ä¸­çš„é“¾è¡¨ï¼Œä¸å‰é¢çš„e = p.nextç»„åˆï¼Œå¯ä»¥éå†é“¾è¡¨\n                p = e;\n            }\n        }\n        //åˆ¤æ–­å½“å‰çš„keyå·²ç»å­˜åœ¨çš„æƒ…å†µä¸‹ï¼Œå†æ¥ä¸€ä¸ªç›¸åŒçš„hashå€¼ã€keyå€¼æ—¶ï¼Œè¿”å›æ–°æ¥çš„valueè¿™ä¸ªå€¼\n        if (e != null) { \n            // è®°å½•eçš„value\n            V oldValue = e.value;\n            // onlyIfAbsentä¸ºfalseæˆ–è€…æ—§å€¼ä¸ºnull\n            if (!onlyIfAbsent || oldValue == null)\n                //ç”¨æ–°å€¼æ›¿æ¢æ—§å€¼\n                e.value = value;\n            // è®¿é—®åå›è°ƒ\n            afterNodeAccess(e);\n            // è¿”å›æ—§å€¼\n            return oldValue;\n        }\n    }\n    // ç»“æ„æ€§ä¿®æ”¹\n    ++modCount;\n    // æ­¥éª¤â‘¥ï¼šè¶…è¿‡æœ€å¤§å®¹é‡å°±æ‰©å®¹ \n    // å®é™…å¤§å°å¤§äºé˜ˆå€¼åˆ™æ‰©å®¹\n    if (++size > threshold)\n        resize();\n    // æ’å…¥åå›è°ƒ\n    afterNodeInsertion(evict);\n    return null;\n}\n```\n\n### HashMapçš„æ‰©å®¹æ“ä½œæ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ\n\nâ‘ .åœ¨ jdk1.8 ä¸­ï¼Œresize æ–¹æ³•æ˜¯åœ¨ hashmap ä¸­çš„é”®å€¼å¯¹ï¼ˆå…ƒç´ æ•°é‡ï¼‰å¤§äºé˜€å€¼æ—¶ï¼ˆé˜ˆå€¼ä¸ºå®¹é‡*è´Ÿè½½å› å­ï¼‰æ‰©å®¹ä¸ºåŸå®¹é‡çš„ 2 å€ï¼Œæˆ–è€…åˆå§‹åŒ–æ—¶ï¼ˆæ‰©å®¹ä¸º 16ï¼‰ï¼Œå°±è°ƒç”¨ resize æ–¹æ³•è¿›è¡Œæ‰©å®¹ï¼›\n\nâ‘¡.åœ¨ 1.7 ä¸­ï¼Œæ‰©å®¹ä¹‹åéœ€è¦é‡æ–°å»è®¡ç®—å…¶ Hash å€¼ï¼Œæ ¹æ® Hash å€¼å¯¹å…¶è¿›è¡Œåˆ†å‘ï¼Œä½†åœ¨ 1.8 ç‰ˆæœ¬ä¸­ï¼Œåˆ™æ˜¯æ ¹æ®åœ¨åŒä¸€ä¸ªæ¡¶çš„ä½ç½®ä¸­è¿›è¡Œåˆ¤æ–­(e.hash & oldCap)æ˜¯å¦ä¸º 0ï¼Œé‡æ–°è¿›è¡Œ hash åˆ†é…åï¼Œè¯¥å…ƒç´  hash å€¼ä¸æ—§å®¹é‡ä¸è¿ç®—ä¸º 0 åˆ™ç•™åœ¨åŸå§‹ä½ç½®ï¼Œhash å€¼ä¸æ—§å®¹é‡ä¸è¿ç®—ä¸º 1 åˆ™ç§»åŠ¨åˆ° åŸä½ç½® + oldCap è¿™ä¸ªä½ç½®ä¸Š\n\n![HashMapçš„resizeæ“ä½œ](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes20190128152700351.png)\n\n```java\nfinal Node<K,V>[] resize() {\n    Node<K,V>[] oldTab = table;//oldTabæŒ‡å‘hashæ¡¶æ•°ç»„\n    int oldCap = (oldTab == null) ? 0 : oldTab.length;\n    int oldThr = threshold;\n    int newCap, newThr = 0;\n    if (oldCap > 0) {//å¦‚æœoldCapä¸ä¸ºç©ºçš„è¯ï¼Œå°±æ˜¯hashæ¡¶æ•°ç»„ä¸ä¸ºç©º\n        if (oldCap >= MAXIMUM_CAPACITY) {//å¦‚æœå¤§äºæœ€å¤§å®¹é‡äº†ï¼Œå°±èµ‹å€¼ä¸ºæ•´æ•°æœ€å¤§çš„é˜€å€¼\n            threshold = Integer.MAX_VALUE;\n            return oldTab;//è¿”å›\n        }//å¦‚æœå½“å‰hashæ¡¶æ•°ç»„çš„é•¿åº¦åœ¨æ‰©å®¹åä»ç„¶å°äºæœ€å¤§å®¹é‡ å¹¶ä¸”oldCapå¤§äºé»˜è®¤å€¼16\n        else if ((newCap = oldCap << 1) < MAXIMUM_CAPACITY &&\n                 oldCap >= DEFAULT_INITIAL_CAPACITY)\n            newThr = oldThr << 1; // double threshold åŒå€æ‰©å®¹é˜€å€¼threshold\n    }\n    // æ—§çš„å®¹é‡ä¸º0ï¼Œä½†thresholdå¤§äºé›¶ï¼Œä»£è¡¨æœ‰å‚æ„é€ æœ‰capä¼ å…¥ï¼Œthresholdå·²ç»è¢«åˆå§‹åŒ–æˆæœ€å°2çš„næ¬¡å¹‚\n    // ç›´æ¥å°†è¯¥å€¼èµ‹ç»™æ–°çš„å®¹é‡\n    else if (oldThr > 0) // initial capacity was placed in threshold\n        newCap = oldThr;\n    // æ— å‚æ„é€ åˆ›å»ºçš„mapï¼Œç»™å‡ºé»˜è®¤å®¹é‡å’Œthreshold 16, 16*0.75\n    else {               // zero initial threshold signifies using defaults\n        newCap = DEFAULT_INITIAL_CAPACITY;\n        newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);\n    }\n    // æ–°çš„threshold = æ–°çš„cap * 0.75\n    if (newThr == 0) {\n        float ft = (float)newCap * loadFactor;\n        newThr = (newCap < MAXIMUM_CAPACITY && ft < (float)MAXIMUM_CAPACITY ?\n                  (int)ft : Integer.MAX_VALUE);\n    }\n    threshold = newThr;\n    // è®¡ç®—å‡ºæ–°çš„æ•°ç»„é•¿åº¦åèµ‹ç»™å½“å‰æˆå‘˜å˜é‡table\n    @SuppressWarnings({\"rawtypes\",\"unchecked\"})\n        Node<K,V>[] newTab = (Node<K,V>[])new Node[newCap];//æ–°å»ºhashæ¡¶æ•°ç»„\n    table = newTab;//å°†æ–°æ•°ç»„çš„å€¼å¤åˆ¶ç»™æ—§çš„hashæ¡¶æ•°ç»„\n    // å¦‚æœåŸå…ˆçš„æ•°ç»„æ²¡æœ‰åˆå§‹åŒ–ï¼Œé‚£ä¹ˆresizeçš„åˆå§‹åŒ–å·¥ä½œåˆ°æ­¤ç»“æŸï¼Œå¦åˆ™è¿›å…¥æ‰©å®¹å…ƒç´ é‡æ’é€»è¾‘ï¼Œä½¿å…¶å‡åŒ€çš„åˆ†æ•£\n    if (oldTab != null) {\n        // éå†æ–°æ•°ç»„çš„æ‰€æœ‰æ¡¶ä¸‹æ ‡\n        for (int j = 0; j < oldCap; ++j) {\n            Node<K,V> e;\n            if ((e = oldTab[j]) != null) {\n                // æ—§æ•°ç»„çš„æ¡¶ä¸‹æ ‡èµ‹ç»™ä¸´æ—¶å˜é‡eï¼Œå¹¶ä¸”è§£é™¤æ—§æ•°ç»„ä¸­çš„å¼•ç”¨ï¼Œå¦åˆ™å°±æ•°ç»„æ— æ³•è¢«GCå›æ”¶\n                oldTab[j] = null;\n                // å¦‚æœe.next==nullï¼Œä»£è¡¨æ¡¶ä¸­å°±ä¸€ä¸ªå…ƒç´ ï¼Œä¸å­˜åœ¨é“¾è¡¨æˆ–è€…çº¢é»‘æ ‘\n                if (e.next == null)\n                    // ç”¨åŒæ ·çš„hashæ˜ å°„ç®—æ³•æŠŠè¯¥å…ƒç´ åŠ å…¥æ–°çš„æ•°ç»„\n                    newTab[e.hash & (newCap - 1)] = e;\n                // å¦‚æœeæ˜¯TreeNodeå¹¶ä¸”e.next!=nullï¼Œé‚£ä¹ˆå¤„ç†æ ‘ä¸­å…ƒç´ çš„é‡æ’\n                else if (e instanceof TreeNode)\n                    ((TreeNode<K,V>)e).split(this, newTab, j, oldCap);\n                // eæ˜¯é“¾è¡¨çš„å¤´å¹¶ä¸”e.next!=nullï¼Œé‚£ä¹ˆå¤„ç†é“¾è¡¨ä¸­å…ƒç´ é‡æ’\n                else { // preserve order\n                    // loHead,loTail ä»£è¡¨æ‰©å®¹åä¸ç”¨å˜æ¢ä¸‹æ ‡ï¼Œè§æ³¨1\n                    Node<K,V> loHead = null, loTail = null;\n                    // hiHead,hiTail ä»£è¡¨æ‰©å®¹åå˜æ¢ä¸‹æ ‡ï¼Œè§æ³¨1\n                    Node<K,V> hiHead = null, hiTail = null;\n                    Node<K,V> next;\n                    // éå†é“¾è¡¨\n                    do {             \n                        next = e.next;\n                        if ((e.hash & oldCap) == 0) {\n                            if (loTail == null)\n                                // åˆå§‹åŒ–headæŒ‡å‘é“¾è¡¨å½“å‰å…ƒç´ eï¼Œeä¸ä¸€å®šæ˜¯é“¾è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œåˆå§‹åŒ–åloHead\n                                // ä»£è¡¨ä¸‹æ ‡ä¿æŒä¸å˜çš„é“¾è¡¨çš„å¤´å…ƒç´ \n                                loHead = e;\n                            else                                \n                                // loTail.nextæŒ‡å‘å½“å‰e\n                                loTail.next = e;\n                            // loTailæŒ‡å‘å½“å‰çš„å…ƒç´ e\n                            // åˆå§‹åŒ–åï¼ŒloTailå’ŒloHeadæŒ‡å‘ç›¸åŒçš„å†…å­˜ï¼Œæ‰€ä»¥å½“loTail.nextæŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œ\n                            // åº•å±‚æ•°ç»„ä¸­çš„å…ƒç´ çš„nextå¼•ç”¨ä¹Ÿç›¸åº”å‘ç”Ÿå˜åŒ–ï¼Œé€ æˆlowHead.next.next.....\n                            // è·ŸéšloTailåŒæ­¥ï¼Œä½¿å¾—lowHeadå¯ä»¥é“¾æ¥åˆ°æ‰€æœ‰å±äºè¯¥é“¾è¡¨çš„å…ƒç´ ã€‚\n                            loTail = e;                           \n                        }\n                        else {\n                            if (hiTail == null)\n                                // åˆå§‹åŒ–headæŒ‡å‘é“¾è¡¨å½“å‰å…ƒç´ e, åˆå§‹åŒ–åhiHeadä»£è¡¨ä¸‹æ ‡æ›´æ”¹çš„é“¾è¡¨å¤´å…ƒç´ \n                                hiHead = e;\n                            else\n                                hiTail.next = e;\n                            hiTail = e;\n                        }\n                    } while ((e = next) != null);\n                    // éå†ç»“æŸ, å°†tailæŒ‡å‘nullï¼Œå¹¶æŠŠé“¾è¡¨å¤´æ”¾å…¥æ–°æ•°ç»„çš„ç›¸åº”ä¸‹æ ‡ï¼Œå½¢æˆæ–°çš„æ˜ å°„ã€‚\n                    if (loTail != null) {\n                        loTail.next = null;\n                        newTab[j] = loHead;\n                    }\n                    if (hiTail != null) {\n                        hiTail.next = null;\n                        newTab[j + oldCap] = hiHead;\n                    }\n                }\n            }\n        }\n    }\n    return newTab;\n}\n```\n\n### HashMapè´Ÿè½½å› å­ä¸ºä»€ä¹ˆè®¾ç½®ä¸º 0.75?\n\nhashmap çš„æºç ä¸­æœ‰ä¸€æ®µæ³¨é‡Šè§£é‡Šäº†ä¸ºä»€ä¹ˆè®¾ç½®ä¸º 0.75ï¼Œæ˜¯**ç©ºé—´å’Œæ—¶é—´æ•ˆç‡çš„æŠ˜ä¸­è€ƒè™‘**ã€‚\n\n### èƒ½å¦ä½¿ç”¨ä»»ä½•ç±»ä½œä¸º Map çš„ keyï¼Ÿ\n\nå¯ä»¥ä½¿ç”¨ä»»ä½•ç±»ä½œä¸º Map çš„ keyï¼Œå‰ææ˜¯è¯¥ç±»é‡å†™äº† hashCode å’Œ equals æ–¹æ³•ã€‚é‡å†™ hashCode() æ˜¯ä¸ºäº†è®¡ç®—æ•°æ®çš„å­˜å‚¨ä½ç½®ï¼Œé‡å†™ equals æ–¹æ³•æ˜¯ä¸ºäº†ç¡®ä¿ key åœ¨å“ˆå¸Œè¡¨ä¸­çš„å”¯ä¸€æ€§ã€‚æœ€ç»ˆç›®çš„æ˜¯ä¸ºäº†ä¿è¯ Map ä¸­é”® key çš„å”¯ä¸€æ€§ã€‚\n\n### ä¸ºä»€ä¹ˆHashMapä¸­Stringã€Integerè¿™æ ·çš„åŒ…è£…ç±»é€‚åˆä½œä¸ºkeyï¼Ÿ\n\né‡å†™äº† hashCode å’Œ equals æ–¹æ³•ï¼Œä¿è¯äº† Map ä¸­é”®**keyçš„å”¯ä¸€æ€§**ã€‚å¹¶ä¸”ä»–ä»¬éƒ½ä¸å¯å˜ï¼Œå¯ä»¥å°†å®ƒä»¬çš„ hash å€¼**ç¼“å­˜ä¸‹æ¥ï¼Œæé«˜æ•ˆç‡**ã€‚\n\n### HashMap ä¸ HashTable æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\n1. **çº¿ç¨‹å®‰å…¨**ï¼š HashMap æ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼ŒHashTable æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå†…éƒ¨çš„æ–¹æ³•åŸºæœ¬éƒ½ç»è¿‡ `synchronized` ä¿®é¥°ï¼›\n2. **æ•ˆç‡**ï¼š å› ä¸ºçº¿ç¨‹å®‰å…¨çš„é—®é¢˜ synchronizedï¼ŒHashMap è¦æ¯” HashTable æ•ˆç‡é«˜ä¸€ç‚¹ï¼›\n3. **å¯¹Null key å’ŒNull valueçš„æ”¯æŒ**ï¼š HashMap ä¸­ï¼Œnull å¯ä»¥ä½œä¸ºé”®ï¼Œè¿™æ ·çš„é”®åªæœ‰ä¸€ä¸ªï¼Œå¯ä»¥æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªé”®æ‰€å¯¹åº”çš„å€¼ä¸º nullã€‚ä½†æ˜¯åœ¨ HashTable ä¸­ put è¿›çš„é”®å€¼åªè¦æœ‰ä¸€ä¸ª nullï¼Œç›´æ¥æŠ› NullPointerExceptionï¼›\n4. **åˆå§‹å®¹é‡å¤§å°å’Œæ¯æ¬¡æ‰©å……å®¹é‡å¤§å°çš„ä¸åŒ **ï¼š \n\tâ‘ åˆ›å»ºæ—¶å¦‚æœä¸æŒ‡å®šå®¹é‡åˆå§‹å€¼ï¼ŒHashTable é»˜è®¤çš„åˆå§‹å¤§å°ä¸º 11ï¼Œä¹‹åæ¯æ¬¡æ‰©å……ï¼Œå®¹é‡å˜ä¸ºåŸæ¥çš„ 2n+1ã€‚HashMap é»˜è®¤çš„åˆå§‹åŒ–å¤§å°ä¸º 16ã€‚ä¹‹åæ¯æ¬¡æ‰©å……ï¼Œå®¹é‡å˜ä¸ºåŸæ¥çš„ 2 å€ï¼›\n\tâ‘¡åˆ›å»ºæ—¶å¦‚æœç»™å®šäº†å®¹é‡åˆå§‹å€¼ï¼Œé‚£ä¹ˆ HashTable ä¼šç›´æ¥ä½¿ç”¨ä½ ç»™å®šçš„å¤§å°ï¼Œè€Œ HashMap ä¼šå°†å…¶æ‰©å……ä¸º 2 çš„å¹‚æ¬¡æ–¹å¤§å°ã€‚ä¹Ÿå°±æ˜¯è¯´ HashMap æ€»æ˜¯ä½¿ç”¨ 2 çš„å¹‚ä½œä¸ºå“ˆå¸Œè¡¨çš„å¤§å°ï¼›\n5. **åº•å±‚æ•°æ®ç»“æ„**ï¼š JDK1.8 ä»¥åçš„ HashMap åœ¨è§£å†³å“ˆå¸Œå†²çªæ—¶æœ‰äº†è¾ƒå¤§çš„å˜åŒ–ï¼Œå½“é“¾è¡¨é•¿åº¦å¤§äºé˜ˆå€¼ï¼ˆé»˜è®¤ä¸º 8ï¼‰æ—¶ï¼Œå°†é“¾è¡¨è½¬åŒ–ä¸ºçº¢é»‘æ ‘ï¼Œä»¥å‡å°‘æœç´¢æ—¶é—´ã€‚HashTable æ²¡æœ‰è¿™æ ·çš„æœºåˆ¶ã€‚\n\n### ConcurrentHashMap å’Œ HashTable çš„åŒºåˆ«ï¼Ÿ\n\nConcurrentHashMap å’Œ HashTable çš„åŒºåˆ«ä¸»è¦ä½“ç°åœ¨å®ç°çº¿ç¨‹å®‰å…¨çš„æ–¹å¼ä¸Šä¸åŒã€‚\n\n- **åº•å±‚æ•°æ®ç»“æ„**ï¼š \n\tJDK1.7 çš„ ConcurrentHashMap åº•å±‚é‡‡ç”¨ **åˆ†æ®µçš„æ•°ç»„+é“¾è¡¨** å®ç°ï¼ŒJDK1.8 é‡‡ç”¨çš„æ•°æ®ç»“æ„è·Ÿ HashMap1.8 çš„ç»“æ„ä¸€æ ·ï¼Œæ•°ç»„+é“¾è¡¨/çº¢é»‘äºŒå‰æ ‘ã€‚\n\tHashTable å’Œ JDK1.8 ä¹‹å‰çš„ HashMap çš„åº•å±‚æ•°æ®ç»“æ„ç±»ä¼¼éƒ½æ˜¯é‡‡ç”¨ **æ•°ç»„+é“¾è¡¨** çš„å½¢å¼ï¼Œæ•°ç»„æ˜¯ HashMap çš„ä¸»ä½“ï¼Œé“¾è¡¨åˆ™æ˜¯ä¸»è¦ä¸ºäº†è§£å†³å“ˆå¸Œå†²çªè€Œå­˜åœ¨çš„ï¼›\n- **å®ç°çº¿ç¨‹å®‰å…¨çš„æ–¹å¼ï¼ˆé‡è¦ï¼‰**ï¼š \n\tâ‘  **åœ¨JDK1.7çš„æ—¶å€™ï¼ŒConcurrentHashMapä½¿ç”¨åˆ†æ®µé”** å¯¹æ•´ä¸ªæ¡¶æ•°ç»„è¿›è¡Œäº†åˆ†å‰²åˆ†æ®µ(Segment é”ç»§æ‰¿ ReentrantLock)ï¼Œæ¯ä¸€æŠŠé”åªé”å®¹å™¨å…¶ä¸­ä¸€éƒ¨åˆ†æ•°æ®ï¼Œå¤šçº¿ç¨‹è®¿é—®å®¹å™¨é‡Œä¸åŒæ•°æ®æ®µçš„æ•°æ®ï¼Œå°±ä¸ä¼šå­˜åœ¨é”ç«äº‰ï¼Œæé«˜å¹¶å‘è®¿é—®ç‡ã€‚ï¼ˆé»˜è®¤åˆ†é… 16 ä¸ª Segmentï¼Œæ¯” HashTable æ•ˆç‡æé«˜ 16 å€ã€‚ï¼‰\n\t**åˆ°äº† JDK1.8 çš„æ—¶å€™å·²ç»æ‘’å¼ƒäº†Segmentçš„æ¦‚å¿µï¼Œè€Œæ˜¯ç›´æ¥ç”¨ Node æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘çš„æ•°æ®ç»“æ„æ¥å®ç°ï¼Œå¹¶å‘æ§åˆ¶ä½¿ç”¨ synchronized å’Œ CAS æ¥æ“ä½œï¼Œsynchronizedåªé”å®šå½“å‰é“¾è¡¨æˆ–çº¢é»‘æ ‘çš„é¦–èŠ‚ç‚¹ã€‚ï¼ˆJDK1.6ä»¥å å¯¹ synchronizedé”åšäº†å¾ˆå¤šä¼˜åŒ–ï¼‰** æ•´ä¸ªçœ‹èµ·æ¥å°±åƒæ˜¯ä¼˜åŒ–è¿‡ä¸”çº¿ç¨‹å®‰å…¨çš„ HashMap\n\tâ‘¡ **HashTable(å…¨è¡¨é”)** :ä½¿ç”¨ synchronized æ¥ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œæ•ˆç‡éå¸¸ä½ä¸‹ã€‚å½“ä¸€ä¸ªçº¿ç¨‹è®¿é—®åŒæ­¥æ–¹æ³•æ—¶ï¼Œå…¶ä»–çº¿ç¨‹ä¹Ÿè®¿é—®åŒæ­¥æ–¹æ³•ï¼Œå¯èƒ½ä¼šè¿›å…¥é˜»å¡æˆ–è½®è¯¢çŠ¶æ€ï¼Œå¦‚ä½¿ç”¨ put æ·»åŠ å…ƒç´ ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¸èƒ½ä½¿ç”¨ put æ·»åŠ å…ƒç´ ï¼Œä¹Ÿä¸èƒ½ä½¿ç”¨ getï¼Œç«äº‰ä¼šè¶Šæ¥è¶Šæ¿€çƒˆæ•ˆç‡è¶Šä½ã€‚\n- â­**Jdk1.7é‡‡ç”¨åˆ†æ®µé”ï¼Œé”ç²’åº¦è¾ƒå¤§ï¼Œå®¹æ˜“å‘ç”Ÿå†²çªï¼Œå¹¶å‘é‡ä½ï¼›å› æ­¤ Jdk1.8 é‡‡ç”¨åªé”å®šæ¡¶çš„é¦–ç»“ç‚¹ï¼Œé”çš„åŠ›åº¦è¾ƒä½ï¼Œä¸å®¹æ˜“å‘ç”Ÿå†²çªï¼Œå¹¶å‘é‡é«˜ã€‚**\n\n**ä¸¤è€…çš„å¯¹æ¯”å›¾**ï¼š\n\nHashTable:\n\n![HashTableå…¨è¡¨é”](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOC84LzIzLzE2NTY2NzdhNmYyNTYxOTY.png)\n\nJDK1.7 çš„ ConcurrentHashMapï¼š\n\n![JDK1.7çš„ConcurrentHashMapåˆ†æ®µé”](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOC84LzIzLzE2NTY2NzdhNmYwMDhiZTQ.png)\n\nJDK1.8 çš„ ConcurrentHashMapï¼ˆTreeBin: çº¢é»‘äºŒå‰æ ‘èŠ‚ç‚¹ Node: é“¾è¡¨èŠ‚ç‚¹ï¼‰ï¼š\n\n![JDK1.8çš„ConcurrentHashMapåˆ†æ®µé”](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOC84LzIzLzE2NTY2NzdhNmYxNGUwMzk.png)\n","source":"_posts/Javaå…«è‚¡æ–‡ - Javaé›†åˆ.md","raw":"---\ntitle: Javaå…«è‚¡æ–‡ - Javaé›†åˆ\ncopyright: true\nmathjax: false\ncategories:\n  - Javaå…«è‚¡æ–‡\ndate: 2023-01-23 10:06:52\ntags:\ntoc: true\nurlname: java-collection\n---\n\n> æ•´ç†çš„Javaé›†åˆç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½\t<!--more-->\n\n## é›†åˆå®¹å™¨æ¦‚è¿°\n\n### ä»€ä¹ˆæ˜¯é›†åˆ\n\nç”¨äºå­˜å‚¨æ•°æ®çš„å®¹å™¨ã€‚\n\n### é›†åˆå’Œæ•°ç»„çš„åŒºåˆ«\n\n- æ•°ç»„æ˜¯å›ºå®šé•¿åº¦çš„ï¼›é›†åˆå¯å˜é•¿åº¦çš„ã€‚\n- æ•°ç»„å¯ä»¥å­˜å‚¨åŸºæœ¬æ•°æ®ç±»å‹ï¼Œä¹Ÿå¯ä»¥å­˜å‚¨å¼•ç”¨æ•°æ®ç±»å‹ï¼›é›†åˆåªèƒ½å­˜å‚¨å¼•ç”¨æ•°æ®ç±»å‹ã€‚\n\n### å¸¸ç”¨çš„é›†åˆç±»æœ‰å“ªäº›ï¼Ÿ\n\nCollection æ¥å£å’Œ Map æ¥å£æ˜¯æ‰€æœ‰é›†åˆæ¡†æ¶çš„çˆ¶æ¥å£ã€‚\n\nCollection æ¥å£ï¼šå­æ¥å£åŒ…æ‹¬ Set æ¥å£å’Œ List æ¥å£\n\n1. Set æ¥å£çš„å®ç°ç±»ä¸»è¦æœ‰ï¼šHashSetã€TreeSetã€LinkedHashSet ç­‰ï¼›\n2. List æ¥å£çš„å®ç°ç±»ä¸»è¦æœ‰ï¼šArrayListã€LinkedListã€Stack ä»¥åŠ Vector ç­‰ã€‚\n\nMap æ¥å£ï¼šå®ç°ç±»ä¸»è¦æœ‰ HashMapã€TreeMapã€HashTableã€ConcurrentHashMap ä»¥åŠ Properties ç­‰ã€‚\n\n### Listã€Setã€Mapä¸‰è€…çš„åŒºåˆ«ï¼Ÿ\n\n![Collectionæ¶æ„](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly9pbWcyMDE4LmNuYmxvZ3MuY29tL290aGVyLzE0MDgxODMvMjAxOTExLzE0MDgxODMtMjAxOTExMTkxODQxNDk1NTktMTU3MTU5NTY2OC5qcGc.png)\n\nList å’Œ Set ä¸¤å¤§æ¥å£æ˜¯ Collection çš„å­æ¥å£\n\n- Listï¼šæœ‰åºå®¹å™¨ï¼Œå…ƒç´ å¯ä»¥é‡å¤ï¼Œå¯ä»¥æ’å…¥å¤šä¸ª null å…ƒç´ ï¼Œå…ƒç´ éƒ½æœ‰ç´¢å¼•ï¼›\n\tå¸¸ç”¨å®ç°ç±»ï¼šArrayListã€LinkedList å’Œ Vectorã€‚\n\t\n- Setï¼šæ— åºå®¹å™¨ï¼Œä¸å¯ä»¥å­˜å‚¨é‡å¤å…ƒç´ ï¼Œåªå…è®¸å­˜å…¥ä¸€ä¸ª null å…ƒç´ ï¼Œå¿…é¡»ä¿è¯å…ƒç´ å”¯ä¸€æ€§ï¼›\n\n\tå¸¸ç”¨å®ç°ç±»ï¼šHashSetã€LinkedHashSet ä»¥åŠ TreeSetã€‚\n\n* Map æ˜¯ä¸€ä¸ªé”®å€¼å¯¹é›†åˆï¼Œå­˜å‚¨é”®ã€å€¼å’Œä¹‹é—´çš„æ˜ å°„ã€‚ key æ— åºï¼Œå”¯ä¸€ï¼›value ä¸è¦æ±‚æœ‰åºï¼Œå…è®¸é‡å¤ï¼›\n\n\tå¸¸ç”¨å®ç°ç±»ï¼šHashMapã€TreeMapã€HashTableã€LinkedHashMapã€ConcurrentHashMapã€‚\n\n### é›†åˆæ¡†æ¶åº•å±‚æ•°æ®ç»“æ„\n\n#### Collection\n\n1. List\n\n- Arraylistï¼š Object æ•°ç»„\n- Vectorï¼š Object æ•°ç»„\n- LinkedListï¼š åŒå‘é“¾è¡¨\n\n2. Set\n\n- HashSetï¼ˆæ— åºï¼Œå”¯ä¸€ï¼‰ï¼šåŸºäº HashMap å®ç°çš„ï¼Œåº•å±‚é‡‡ç”¨ HashMap æ¥ä¿å­˜å…ƒç´ \n- LinkedHashSetï¼š LinkedHashSet ç»§æ‰¿äº HashSetï¼Œå¹¶ä¸”å…¶å†…éƒ¨æ˜¯é€šè¿‡ LinkedHashMap æ¥å®ç°çš„ã€‚\n- TreeSetï¼ˆæœ‰åºï¼Œå”¯ä¸€ï¼‰ï¼š çº¢é»‘æ ‘(è‡ªå¹³è¡¡çš„æ’åºäºŒå‰æ ‘)\n\n#### Map\n\n- HashMapï¼š JDK1.8 ä¹‹å‰ HashMap ç”±æ•°ç»„+é“¾è¡¨ç»„æˆçš„ï¼Œæ•°ç»„æ˜¯ HashMap çš„ä¸»ä½“ï¼Œé“¾è¡¨åˆ™æ˜¯ä¸»è¦ä¸ºäº†è§£å†³å“ˆå¸Œå†²çªè€Œå­˜åœ¨çš„ï¼ˆâ€œæ‹‰é“¾æ³•â€è§£å†³å†²çªï¼‰ã€‚JDK1.8 ä»¥ååœ¨è§£å†³å“ˆå¸Œå†²çªæ—¶æœ‰äº†è¾ƒå¤§çš„å˜åŒ–ï¼Œå½“é“¾è¡¨é•¿åº¦å¤§äºé˜ˆå€¼ï¼ˆé»˜è®¤ä¸º 8ï¼‰ï¼Œä¸”æ•°ç»„é•¿åº¦å¤§äº 64ï¼Œå°†é“¾è¡¨è½¬åŒ–ä¸ºçº¢é»‘æ ‘ï¼Œä»¥å‡å°‘æœç´¢æ—¶é—´ï¼Œå¦åˆ™æ‰©å®¹æ•°ç»„ã€‚\n- LinkedHashMapï¼šLinkedHashMap ç»§æ‰¿è‡ª HashMapï¼Œæ‰€ä»¥å®ƒçš„åº•å±‚ç”±æ•°ç»„å’Œé“¾è¡¨æˆ–çº¢é»‘æ ‘ç»„æˆã€‚å¦å¤–ï¼ŒLinkedHashMap åœ¨ä¸Šé¢ç»“æ„çš„åŸºç¡€ä¸Šï¼Œå¢åŠ äº†ä¸€æ¡åŒå‘é“¾è¡¨ï¼Œä½¿å¾—ä¸Šé¢çš„ç»“æ„å¯ä»¥ä¿æŒé”®å€¼å¯¹çš„æ’å…¥é¡ºåºã€‚åŒæ—¶é€šè¿‡å¯¹é“¾è¡¨è¿›è¡Œç›¸åº”çš„æ“ä½œï¼Œå®ç°äº†è®¿é—®é¡ºåºç›¸å…³é€»è¾‘ã€‚\n- HashTableï¼š æ•°ç»„+é“¾è¡¨ç»„æˆçš„ï¼Œæ•°ç»„æ˜¯ HashMap çš„ä¸»ä½“ï¼Œé“¾è¡¨åˆ™æ˜¯ä¸»è¦ä¸ºäº†è§£å†³å“ˆå¸Œå†²çªè€Œå­˜åœ¨çš„\n- TreeMapï¼š çº¢é»‘æ ‘ï¼ˆè‡ªå¹³è¡¡çš„æ’åºäºŒå‰æ ‘ï¼‰\n\n### å“ªäº›é›†åˆç±»æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Ÿ\n\nvector å’Œ hashtableï¼Œé€šè¿‡åœ¨æ–¹æ³•ä¸ŠåŠ  synchronized å…³é”®å­—å®ç°çº¿ç¨‹å®‰å…¨\n\n### Javaé›†åˆçš„å¿«é€Ÿå¤±è´¥æœºåˆ¶ â€œfail-fastâ€ï¼Ÿ\n\nfail-fast æ˜¯ Java é›†åˆçš„ä¸€ç§**é”™è¯¯æ£€æµ‹æœºåˆ¶**ï¼Œå½“å¤šä¸ªçº¿ç¨‹å¯¹åŒä¸€ä¸ªé›†åˆçš„å†…å®¹è¿›è¡Œæ“ä½œæ—¶ï¼Œå°±å¯èƒ½ä¼šäº§ç”Ÿ fail-fast äº‹ä»¶ã€‚\n\nä¾‹å¦‚ï¼šå‡è®¾å­˜åœ¨ä¸¤ä¸ªçº¿ç¨‹ï¼ˆçº¿ç¨‹ 1ã€çº¿ç¨‹ 2ï¼‰ï¼Œçº¿ç¨‹ 1 é€šè¿‡ Iterator åœ¨éå†é›†åˆ A ä¸­çš„å…ƒç´ ï¼Œåœ¨æŸä¸ªæ—¶å€™çº¿ç¨‹ 2 ä¿®æ”¹äº†é›†åˆ A çš„ç»“æ„ï¼ˆaddã€removeã€clear ç­‰ç»“æ„ä¸Šçš„ä¿®æ”¹ï¼Œè€Œä¸æ˜¯ç®€å•çš„ä¿®æ”¹é›†åˆå…ƒç´ çš„å†…å®¹ï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™ç¨‹åºå°±ä¼šæŠ›å‡º **ConcurrentModificationException** å¼‚å¸¸ï¼Œä»è€Œäº§ç”Ÿ fail-fast äº‹ä»¶ã€‚\n\nåŸå› ï¼šè¿­ä»£å™¨åœ¨éå†æ—¶ç›´æ¥è®¿é—®é›†åˆä¸­çš„å†…å®¹ï¼Œå¹¶ä¸”åœ¨éå†è¿‡ç¨‹ä¸­ä½¿ç”¨ä¸€ä¸ª modCount å˜é‡ã€‚æ¯å½“è¿­ä»£å™¨ä½¿ç”¨ hashNext()/next()éå†ä¸‹ä¸€ä¸ªå…ƒç´ ä¹‹å‰ï¼Œéƒ½ä¼šæ£€æµ‹ modCount å˜é‡æ˜¯å¦ä¸º expectedmodCount å€¼ï¼Œæ˜¯çš„è¯å°±è¿”å›éå†ï¼›å¦åˆ™æŠ›å‡ºå¼‚å¸¸ï¼Œç»ˆæ­¢éå†ã€‚é›†åˆåœ¨è¢«éå†æœŸé—´å¦‚æœå†…å®¹å‘ç”Ÿå˜åŒ–ï¼Œå°±ä¼šæ”¹å˜ modCount çš„å€¼ï¼Œä»è€Œ modCount ä¸ç­‰äº expectedmodCount å€¼æŠ›å‡ºå¼‚å¸¸ï¼Œä¹Ÿå°±æ˜¯äº§ç”Ÿäº† fail-fast äº‹ä»¶ã€‚\n\nè§£å†³åŠæ³•ï¼š\n\n1. åœ¨éå†è¿‡ç¨‹ä¸­ï¼Œæ‰€æœ‰æ¶‰åŠåˆ°æ”¹å˜ modCount å€¼çš„åœ°æ–¹å…¨éƒ¨åŠ ä¸Š synchronizedï¼›\n2. ä½¿ç”¨ Java.util.concurrent ä¸‹çš„ CopyOnWriteArrayList æ¥æ›¿æ¢ ArrayListï¼›\n3. ä½¿ç”¨ Java.util.concurrent ä¸‹çš„ ConcurrentHashMap æ¥æ›¿æ¢ HashMapã€‚\n\n### æ€ä¹ˆç¡®ä¿ä¸€ä¸ªé›†åˆä¸èƒ½è¢«ä¿®æ”¹ï¼Ÿ\n\nå¯ä»¥ä½¿ç”¨ Collections. unmodifiableCollection(Collection c) æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªåªè¯»é›†åˆï¼Œè¿™æ ·æ”¹å˜é›†åˆçš„ä»»ä½•æ“ä½œéƒ½ä¼šæŠ›å‡º Java. lang. UnsupportedOperationException å¼‚å¸¸ã€‚\n\n```Java\nList<String> list = new ArrayList<>();\nlist. add(\"x\");\nCollection<String> clist = Collections. unmodifiableCollection(list);\nclist.add(\"y\"); // è¿è¡Œæ—¶æ­¤è¡ŒæŠ¥é”™\nSystem.out.println(list. size());\n```\n\n## Collectionæ¥å£\n\n### Listæ¥å£\n\n#### è¿­ä»£å™¨ Iterator æ˜¯ä»€ä¹ˆï¼Ÿ\n\nCollection æ¥å£å®ç°äº† Iterable æ¥å£ï¼Œé€šè¿‡å®ç° Iterable æ¥å£ä¸­çš„ iterator()æ–¹æ³•è¿”å› Iterator æ¥å£çš„å®ä¾‹ï¼Œé€šè¿‡ iterator å¯¹é›†åˆçš„å…ƒç´ è¿›è¡Œè¿­ä»£æ“ä½œã€‚\n\n#### Iterator æ€ä¹ˆä½¿ç”¨ï¼Ÿæœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ\n\n```Java\nList<String> list = new ArrayList<>();\nIterator<String> it = list.iterator();\nwhile(it.hasNext()){\n    String obj = it.next();\n    System.out.println(obj);\n}\n```\n\nIterator çš„ç‰¹ç‚¹æ˜¯åªèƒ½å•å‘éå†ï¼Œä½†æ˜¯æ›´åŠ å®‰å…¨ï¼Œå› ä¸ºå®ƒå¯ä»¥ç¡®ä¿ï¼Œåœ¨å½“å‰éå†çš„é›†åˆå…ƒç´ è¢«æ›´æ”¹çš„æ—¶å€™ï¼Œå°±ä¼šæŠ›å‡º ConcurrentModificationException å¼‚å¸¸ã€‚\n\n#### å¦‚ä½•è¾¹éå†è¾¹ç§»é™¤ Collection ä¸­çš„å…ƒç´ ï¼Ÿ\n\nè¾¹éå†è¾¹ä¿®æ”¹ Collection çš„å”¯ä¸€æ­£ç¡®æ–¹å¼æ˜¯ä½¿ç”¨ Iterator.remove() æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š\n\n```java\nIterator<Integer> it = list.iterator();\nwhile(it.hasNext()){\n   // do something\n   it.remove();\n}\n```\n\nä¸€ç§æœ€å¸¸è§çš„**é”™è¯¯**ä»£ç å¦‚ä¸‹ï¼š\n\n```java\nList<String> list = new ArrayList<>();\nlist.add(\"1\");\nlist.add(\"2\");\nlist.add(\"3\");\nlist.add(\"4\");\nlist.add(\"5\");\nint cnt = 0;\nfor (String item : list) {\n  System.out.println(++cnt);\n  list.remove(item);\n}\nSystem.out.println(Arrays.toString(list.toArray()));\n```\n\nè¿è¡Œä»¥ä¸Šé”™è¯¯ä»£ç ä¼šæŠ¥ **ConcurrentModificationException å¼‚å¸¸**ã€‚\nè¿™æ˜¯å› ä¸ºå½“ä½¿ç”¨ foreach(for(Integer i : list)) è¯­å¥æ—¶ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª iterator æ¥éå†è¯¥ listï¼Œä½†åŒæ—¶è¯¥ list æ­£åœ¨è¢« Iterator.remove() ä¿®æ”¹ã€‚é›†åˆå‘ç”Ÿç»“æ„æ€§å˜åŒ–ï¼Œæ ¹æ® fail-fast æœºåˆ¶ï¼Œä¼šæŠ›å¼‚å¸¸ã€‚\n\n#### éå†ä¸€ä¸ª List æœ‰å“ªäº›ä¸åŒçš„æ–¹å¼ï¼Ÿ\n\n1. for å¾ªç¯ï¼Œç»´æŠ¤ä¸€ä¸ªè®¡æ•°å™¨ï¼›\n2. è¿­ä»£å™¨ï¼ŒIteratorã€‚Collection æ¥å£å®ç°äº† Iterable æ¥å£ï¼Œé€šè¿‡å®ç° Iterable æ¥å£ä¸­çš„ iterator()æ–¹æ³•è¿”å› Iterator æ¥å£çš„å®ä¾‹ï¼Œé€šè¿‡ iterator å¯¹é›†åˆçš„å…ƒç´ è¿›è¡Œè¿­ä»£æ“ä½œï¼›\n3. å¢å¼º for å¾ªç¯ã€‚å¢å¼º for å¾ªç¯ foreach å†…éƒ¨ä¹Ÿæ˜¯é‡‡ç”¨äº† Iterator çš„æ–¹å¼å®ç°ï¼Œä½¿ç”¨æ—¶ä¸éœ€è¦æ˜¾å¼å£°æ˜ Iterator æˆ–è®¡æ•°å™¨ã€‚\n\tä¼˜ç‚¹æ˜¯ä»£ç ç®€æ´ï¼Œä¸æ˜“å‡ºé”™ï¼›ç¼ºç‚¹æ˜¯åªèƒ½åšç®€å•çš„éå†ï¼Œä¸èƒ½åœ¨éå†è¿‡ç¨‹ä¸­æ“ä½œæ•°æ®é›†åˆï¼Œä¾‹å¦‚åˆ é™¤ã€æ›¿æ¢ã€‚\n\n#### è¯´ä¸€ä¸‹ ArrayList çš„ä¼˜ç¼ºç‚¹\n\n**ArrayList æ¯”è¾ƒé€‚åˆé¡ºåºæ·»åŠ ã€éšæœºè®¿é—®çš„åœºæ™¯ã€‚**\n\nArrayList çš„ä¼˜ç‚¹å¦‚ä¸‹ï¼š\n\n- ArrayList åº•å±‚ä»¥æ•°ç»„å®ç°ï¼Œæ˜¯ä¸€ç§éšæœºè®¿é—®æ¨¡å¼ã€‚ArrayList å®ç°äº† RandomAccess æ¥å£ï¼Œæ ‡è®° List å®ç°æ˜¯å¦æ”¯æŒ Random Accessï¼Œå¯¼è‡´å®ƒå¯ä»¥éšæœºè®¿é—®çš„æ ¹æœ¬åŸå› æ˜¯å®ƒåº•å±‚æ˜¯æ•°ç»„ç»“æ„ï¼Œæ•°ç»„å¯ä»¥é€šè¿‡ä¸‹æ ‡è·å–ç›¸åº”çš„å€¼ï¼Œè€Œ RandomAccess åªæ˜¯ä¸€ä¸ªæ ‡è®°ã€‚å› æ­¤æŸ¥æ‰¾çš„æ—¶å€™éå¸¸å¿«ã€‚å¯ä»¥ç”¨ for å¾ªç¯é€šè¿‡ä¸‹æ ‡è·å–å…ƒç´ ã€‚\n- ArrayList åœ¨é¡ºåºæ·»åŠ ä¸€ä¸ªå…ƒç´ çš„æ—¶å€™éå¸¸æ–¹ä¾¿ã€‚\n\nArrayList çš„ç¼ºç‚¹å¦‚ä¸‹ï¼š\n\n- å‘**ä¸­é—´æŸä¸ªä½ç½®åˆ é™¤**å…ƒç´ çš„æ—¶å€™ï¼Œéœ€è¦åšå…ƒç´ å¤åˆ¶æ“ä½œã€‚å¦‚æœè¦å¤åˆ¶çš„å…ƒç´ å¾ˆå¤šï¼Œé‚£ä¹ˆå°±ä¼šæ¯”è¾ƒè€—è´¹æ€§èƒ½ï¼›\n- å‘**ä¸­é—´æŸä¸ªä½ç½®æ’å…¥**å…ƒç´ çš„æ—¶å€™ï¼Œä¹Ÿéœ€è¦åšå…ƒç´ å¤åˆ¶æ“ä½œï¼Œç¼ºç‚¹åŒä¸Šã€‚\n\n#### å¦‚ä½•å®ç°æ•°ç»„å’Œ List ä¹‹é—´çš„è½¬æ¢ï¼Ÿ\n\n- æ•°ç»„è½¬ Listï¼šä½¿ç”¨ Arrays. asList(array) è¿›è¡Œè½¬æ¢ã€‚\n- List è½¬æ•°ç»„ï¼šä½¿ç”¨ List è‡ªå¸¦çš„ toArray() æ–¹æ³•ã€‚\n\n```Java\n// list to array\nList<String> list = new ArrayList<String>();\nlist.add(\"123\");\nlist.add(\"456\");\nlist.toArray(new String[0]);\n\n// array to list\nString[] array = new String[]{\"123\", \"456\"};\nArrays.asList(array);\n```\n\n#### ArrayList å’Œ LinkedList çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\n\n- åº•å±‚å®ç°ï¼šArrayList æ˜¯åŠ¨æ€æ•°ç»„çš„æ•°æ®ç»“æ„å®ç°ï¼Œè€Œ LinkedList æ˜¯åŒå‘é“¾è¡¨çš„æ•°æ®ç»“æ„å®ç°ï¼›\n- è®¿é—®å’Œå¢åˆ å…ƒç´ æ•ˆç‡ï¼šArrayList éšæœºè®¿é—®å’Œé¡ºåºæ’å…¥/åˆ é™¤å…ƒç´ æ•ˆç‡æ›´é«˜ï¼›\n- å†…å­˜å ç”¨ï¼šLinkedList æ¯” ArrayList æ›´å å†…å­˜ï¼Œå› ä¸º LinkedList çš„èŠ‚ç‚¹é™¤äº†å­˜å‚¨æ•°æ®ï¼Œè¿˜å­˜å‚¨äº†ä¸¤ä¸ªå¼•ç”¨ï¼Œä¸€ä¸ªæŒ‡å‘å‰ä¸€ä¸ªå…ƒç´ ï¼Œä¸€ä¸ªæŒ‡å‘åä¸€ä¸ªå…ƒç´ ï¼›\n- çº¿ç¨‹å®‰å…¨ï¼šArrayList å’Œ LinkedList éƒ½æ˜¯ä¸åŒæ­¥çš„ï¼Œä¹Ÿå°±æ˜¯ä¸ä¿è¯çº¿ç¨‹å®‰å…¨ã€‚\n\nç»¼åˆæ¥è¯´ï¼Œåœ¨éœ€è¦**é¢‘ç¹è¯»å–**é›†åˆä¸­çš„å…ƒç´ æ—¶ï¼Œæ›´æ¨èä½¿ç”¨ ArrayListï¼Œè€Œåœ¨**æ’å…¥å’Œåˆ é™¤æ“ä½œè¾ƒå¤š**æ—¶ï¼Œæ›´æ¨èä½¿ç”¨ LinkedListã€‚\n\n#### ArrayList å’Œ Vector çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\n\nä¸»è¦åŒºåˆ«æ˜¯çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼š\nVector ä½¿ç”¨äº† synchronized æ¥å®ç°çº¿ç¨‹åŒæ­¥ï¼ˆæ€§èƒ½å·®ï¼‰ï¼Œæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè€Œ ArrayList æ˜¯éçº¿ç¨‹å®‰å…¨çš„ã€‚\n\n#### å¤šçº¿ç¨‹åœºæ™¯ä¸‹å¦‚ä½•ä½¿ç”¨ ArrayListï¼Ÿ\n\nå¯ä»¥ç”¨ Java.util.concurrent.CopyOnWriteArrayList æ›¿æ¢ ArrayListã€‚\n\n#### ä¸ºä»€ä¹ˆ ArrayList çš„ elementData åŠ ä¸Š transient ä¿®é¥°ï¼Ÿ\n\nArrayList å®ç°äº† Serializable æ¥å£ï¼Œè¿™æ„å‘³ç€ ArrayList æ”¯æŒåºåˆ—åŒ–ã€‚\nå¯¹äº elementDataï¼Œç”±äº elementData å¯èƒ½æœ‰å¤šä½™çš„å®¹é‡ï¼ˆå®¹é‡ä¸è¶³ä¼šæ‰©å®¹æˆ 1.5 å€å¤§å°ï¼Œæ‰©å®¹ä¹‹åé™¤äº†æ–°åŠ \nçš„å…ƒç´ ä»¥å¤–è¿˜æœ‰å¤šçš„ç©ºé—´æ²¡æœ‰æ”¾å…ƒç´ ï¼Œæ¯”å¦‚ç°åœ¨å®¹é‡æ˜¯ 15ï¼Œè€Œé›†åˆé‡Œé¢åªå­˜äº† 11 ä¸ªå…ƒç´ ï¼‰ï¼Œä¸å¯¹ elementData åŠ ä¸Š transient ä¿®é¥°ï¼Œè€Œæ˜¯æ‰‹åŠ¨è¿›è¡Œåºåˆ—åŒ–ï¼Œå¯ä»¥ä¿è¯åªåºåˆ—åŒ–å®é™…å­˜å‚¨çš„é‚£äº›å…ƒç´ ï¼ˆ11 ä¸ªå…ƒç´ ï¼‰ï¼Œè€Œä¸æ˜¯æ•´ä¸ªæ•°ç»„ï¼Œä»è€ŒèŠ‚çœç©ºé—´å’Œæ—¶é—´ã€‚\n\n### â­ArrayListæ‰©å®¹æœºåˆ¶\n\n> **æ€»ç»“ï¼š**\n>\n> * åˆå§‹åŒ–å¦‚æœä½¿ç”¨æ— å‚æ„é€ å™¨çš„è¯ï¼š\n>\n> \tåœ¨ç¬¬ä¸€æ¬¡æ·»åŠ å…ƒç´ çš„æ—¶å€™ï¼Œå°†æ•°ç»„å®¹é‡è®¾ç½®ä¸º10ï¼Œç„¶åè¿›è¡Œæ·»åŠ ã€‚\n>\n> \tä¸€ç›´æ·»åŠ ï¼Œç›´åˆ°è¦æ·»åŠ çš„å…ƒç´ è¶…å‡ºå½“å‰æ•°ç»„å®¹é‡äº†ï¼Œè¿›å…¥æ‰©å®¹ï¼Œå°†æ•°ç»„é•¿åº¦æ‰©å®¹ä¸º1.5å€é•¿åº¦ï¼Œç„¶åè¿›è¡Œæ·»åŠ ã€‚\n>\n> * åˆå§‹åŒ–å¦‚æœä½¿ç”¨æœ‰å‚æ„é€ å™¨çš„è¯ï¼š\n>\n> \té‚£ä¹ˆæ¯æ¬¡æ·»åŠ å…ƒç´ åªéœ€è¦åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹å³å¯ï¼Œä¸éœ€è¦ç¬¬ä¸€æ¬¡çš„åˆå§‹åŒ–ä¸º10çš„åˆ¤æ–­ã€‚\n\n#### 1. å…ˆä» ArrayList çš„æ„é€ å‡½æ•°è¯´èµ·\n\n**ï¼ˆJDK8ï¼‰ArrayList æœ‰ä¸‰ç§æ–¹å¼æ¥åˆå§‹åŒ–ï¼Œæ„é€ æ–¹æ³•æºç å¦‚ä¸‹ï¼š**\n\n```java\n    /**\n     * é»˜è®¤åˆå§‹å®¹é‡å¤§å°\n     */\n    private static final int DEFAULT_CAPACITY = 10;\n\n\n    private static final Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = {};\n\n    /**\n     *é»˜è®¤æ„é€ å‡½æ•°ï¼Œä½¿ç”¨åˆå§‹å®¹é‡10æ„é€ ä¸€ä¸ªç©ºåˆ—è¡¨(æ— å‚æ•°æ„é€ )\n     */\n    public ArrayList() {\n        this.elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA;\n    }\n\n    /**\n     * å¸¦åˆå§‹å®¹é‡å‚æ•°çš„æ„é€ å‡½æ•°ã€‚ï¼ˆç”¨æˆ·è‡ªå·±æŒ‡å®šå®¹é‡ï¼‰\n     */\n    public ArrayList(int initialCapacity) {\n        if (initialCapacity > 0) {//åˆå§‹å®¹é‡å¤§äº0\n            //åˆ›å»ºinitialCapacityå¤§å°çš„æ•°ç»„\n            this.elementData = new Object[initialCapacity];\n        } else if (initialCapacity == 0) {//åˆå§‹å®¹é‡ç­‰äº0\n            //åˆ›å»ºç©ºæ•°ç»„\n            this.elementData = EMPTY_ELEMENTDATA;\n        } else {//åˆå§‹å®¹é‡å°äº0ï¼ŒæŠ›å‡ºå¼‚å¸¸\n            throw new IllegalArgumentException(\"Illegal Capacity: \"+\n                                               initialCapacity);\n        }\n    }\n\n\n   /**\n    *æ„é€ åŒ…å«æŒ‡å®šcollectionå…ƒç´ çš„åˆ—è¡¨ï¼Œè¿™äº›å…ƒç´ åˆ©ç”¨è¯¥é›†åˆçš„è¿­ä»£å™¨æŒ‰é¡ºåºè¿”å›\n    *å¦‚æœæŒ‡å®šçš„é›†åˆä¸ºnullï¼Œthrows NullPointerExceptionã€‚\n    */\n     public ArrayList(Collection<? extends E> c) {\n        elementData = c.toArray();\n        if ((size = elementData.length) != 0) {\n            // c.toArray might (incorrectly) not return Object[] (see 6260652)\n            if (elementData.getClass() != Object[].class)\n                elementData = Arrays.copyOf(elementData, size, Object[].class);\n        } else {\n            // replace with empty array.\n            this.elementData = EMPTY_ELEMENTDATA;\n        }\n    }\n```\n\n**ä»¥æ— å‚æ•°æ„é€ æ–¹æ³•åˆ›å»º ArrayList æ—¶ï¼Œå®é™…ä¸Šåˆå§‹åŒ–èµ‹å€¼çš„æ˜¯ä¸€ä¸ªç©ºæ•°ç»„ã€‚å½“çœŸæ­£å¯¹æ•°ç»„è¿›è¡Œæ·»åŠ å…ƒç´ æ“ä½œæ—¶ï¼Œæ‰çœŸæ­£åˆ†é…å®¹é‡ã€‚å³å‘æ•°ç»„ä¸­æ·»åŠ ç¬¬ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œæ•°ç»„å®¹é‡æ‰©ä¸º 10ã€‚** \n\n> è¡¥å……ï¼šJDK6 new æ— å‚æ„é€ çš„ `ArrayList` å¯¹è±¡æ—¶ï¼Œç›´æ¥åˆ›å»ºäº†é•¿åº¦æ˜¯ 10 çš„ `Object[]` æ•°ç»„ elementData ã€‚\n\n#### 2. ä¸€æ­¥ä¸€æ­¥åˆ†æ ArrayList æ‰©å®¹æœºåˆ¶\n\nè¿™é‡Œä»¥æ— å‚æ„é€ å‡½æ•°åˆ›å»ºçš„ ArrayList ä¸ºä¾‹åˆ†æ\n\n##### 2.1.  `add` \n\n```java\n    /**\n     * å°†æŒ‡å®šçš„å…ƒç´ è¿½åŠ åˆ°æ­¤åˆ—è¡¨çš„æœ«å°¾ã€‚\n     */\n    public boolean add(E e) {\n   // æ·»åŠ å…ƒç´ ä¹‹å‰ï¼Œå…ˆè°ƒç”¨ensureCapacityInternalæ–¹æ³•\n        ensureCapacityInternal(size + 1);  // Increments modCount!!\n        // è¿™é‡Œçœ‹åˆ°ArrayListæ·»åŠ å…ƒç´ çš„å®è´¨å°±ç›¸å½“äºä¸ºæ•°ç»„èµ‹å€¼\n        elementData[size++] = e;\n        return true;\n    }\n```\n\n##### 2.2. `ensureCapacityInternal()` \n\nï¼ˆJDK7ï¼‰å¯ä»¥çœ‹åˆ° `add` æ–¹æ³• é¦–å…ˆè°ƒç”¨äº†`ensureCapacityInternal(size + 1)`\n\n```java\n   //å¾—åˆ°æœ€å°æ‰©å®¹é‡\n    private void ensureCapacityInternal(int minCapacity) {\n        if (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) {\n            // è·å–é»˜è®¤çš„å®¹é‡å’Œä¼ å…¥å‚æ•°çš„è¾ƒå¤§å€¼\n            minCapacity = Math.max(DEFAULT_CAPACITY, minCapacity);\n        }\n\n        ensureExplicitCapacity(minCapacity);\n    }\n```\n\n**å½“ è¦ add è¿›ç¬¬ 1 ä¸ªå…ƒç´ æ—¶ï¼ŒminCapacity ä¸º 1ï¼Œåœ¨ Math.max()æ–¹æ³•æ¯”è¾ƒåï¼ŒminCapacity ä¸º 10ã€‚**\n\n> æ­¤å¤„å’Œåç»­ JDK8 ä»£ç æ ¼å¼åŒ–ç•¥æœ‰ä¸åŒï¼Œæ ¸å¿ƒä»£ç åŸºæœ¬ä¸€æ ·ã€‚\n\n##### 2.3. `ensureExplicitCapacity()` \n\nå¦‚æœè°ƒç”¨ `ensureCapacityInternal()` æ–¹æ³•å°±ä¸€å®šä¼šè¿›å…¥ï¼ˆæ‰§è¡Œï¼‰è¿™ä¸ªæ–¹æ³•\n\n```java\n  //åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹\n    private void ensureExplicitCapacity(int minCapacity) {\n        modCount++;\n\n        // overflow-conscious code\n        if (minCapacity - elementData.length > 0)\n            //è°ƒç”¨growæ–¹æ³•è¿›è¡Œæ‰©å®¹ï¼Œè°ƒç”¨æ­¤æ–¹æ³•ä»£è¡¨å·²ç»å¼€å§‹æ‰©å®¹äº†\n            grow(minCapacity);\n    }\n```\n\næˆ‘ä»¬æ¥ä»”ç»†åˆ†æä¸€ä¸‹ï¼š\n\n- å½“æˆ‘ä»¬è¦ add è¿›ç¬¬ 1 ä¸ªå…ƒç´ åˆ° ArrayList æ—¶ï¼ŒelementData.length ä¸º 0 ï¼ˆå› ä¸ºè¿˜æ˜¯ä¸€ä¸ªç©ºçš„ listï¼‰ï¼Œå› ä¸ºæ‰§è¡Œäº† `ensureCapacityInternal()` æ–¹æ³• ï¼Œæ‰€ä»¥ minCapacity æ­¤æ—¶ä¸º 10ã€‚æ­¤æ—¶ï¼Œ`minCapacity - elementData.length > 0`æˆç«‹ï¼Œæ‰€ä»¥ä¼šè¿›å…¥ `grow(minCapacity)` æ–¹æ³•ã€‚\n- å½“ add ç¬¬ 2 ä¸ªå…ƒç´ æ—¶ï¼ŒminCapacity ä¸º 2ï¼Œæ­¤æ—¶ elementData.length(å®¹é‡)åœ¨æ·»åŠ ç¬¬ä¸€ä¸ªå…ƒç´ åæ‰©å®¹æˆ 10 äº†ã€‚æ­¤æ—¶ï¼Œ`minCapacity - elementData.length > 0` ä¸æˆç«‹ï¼Œæ‰€ä»¥ä¸ä¼šè¿›å…¥ ï¼ˆæ‰§è¡Œï¼‰`grow(minCapacity)` æ–¹æ³•ã€‚\n- æ·»åŠ ç¬¬ 3ã€4Â·Â·Â·åˆ°ç¬¬ 10 ä¸ªå…ƒç´ æ—¶ï¼Œä¾ç„¶ä¸ä¼šæ‰§è¡Œ grow æ–¹æ³•ï¼Œæ•°ç»„å®¹é‡éƒ½ä¸º 10ã€‚\n\nç›´åˆ°æ·»åŠ ç¬¬ 11 ä¸ªå…ƒç´ ï¼ŒminCapacity(ä¸º 11)æ¯” elementData.lengthï¼ˆä¸º 10ï¼‰è¦å¤§ã€‚è¿›å…¥ grow æ–¹æ³•è¿›è¡Œæ‰©å®¹ã€‚\n\n##### 2.4. `grow()` \n\n```java\n    /**\n     * è¦åˆ†é…çš„æœ€å¤§æ•°ç»„å¤§å°\n     */\n    private static final int MAX_ARRAY_SIZE = Integer.MAX_VALUE - 8;\n\n    /**\n     * ArrayListæ‰©å®¹çš„æ ¸å¿ƒæ–¹æ³•ã€‚\n     */\n    private void grow(int minCapacity) {\n        // oldCapacityä¸ºæ—§å®¹é‡ï¼ŒnewCapacityä¸ºæ–°å®¹é‡\n        int oldCapacity = elementData.length;\n        //å°†oldCapacity å³ç§»ä¸€ä½ï¼Œå…¶æ•ˆæœç›¸å½“äºoldCapacity /2ï¼Œ\n        //æˆ‘ä»¬çŸ¥é“ä½è¿ç®—çš„é€Ÿåº¦è¿œè¿œå¿«äºæ•´é™¤è¿ç®—ï¼Œæ•´å¥è¿ç®—å¼çš„ç»“æœå°±æ˜¯å°†æ–°å®¹é‡æ›´æ–°ä¸ºæ—§å®¹é‡çš„1.5å€ï¼Œ\n        int newCapacity = oldCapacity + (oldCapacity >> 1);\n        //ç„¶åæ£€æŸ¥æ–°å®¹é‡æ˜¯å¦å¤§äºæœ€å°éœ€è¦å®¹é‡ï¼Œè‹¥è¿˜æ˜¯å°äºæœ€å°éœ€è¦å®¹é‡ï¼Œé‚£ä¹ˆå°±æŠŠæœ€å°éœ€è¦å®¹é‡å½“ä½œæ•°ç»„çš„æ–°å®¹é‡ï¼Œ\n        if (newCapacity - minCapacity < 0)\n            newCapacity = minCapacity;\n       // å¦‚æœæ–°å®¹é‡å¤§äº MAX_ARRAY_SIZE,è¿›å…¥(æ‰§è¡Œ) `hugeCapacity()` æ–¹æ³•æ¥æ¯”è¾ƒ minCapacity å’Œ MAX_ARRAY_SIZEï¼Œ\n       //å¦‚æœminCapacityå¤§äºæœ€å¤§å®¹é‡ï¼Œåˆ™æ–°å®¹é‡åˆ™ä¸º`Integer.MAX_VALUE`ï¼Œå¦åˆ™ï¼Œæ–°å®¹é‡å¤§å°åˆ™ä¸º MAX_ARRAY_SIZE å³ä¸º `Integer.MAX_VALUE - 8`ã€‚\n        if (newCapacity - MAX_ARRAY_SIZE > 0)\n            newCapacity = hugeCapacity(minCapacity);\n        // minCapacity is usually close to size, so this is a win:\n        elementData = Arrays.copyOf(elementData, newCapacity);\n    }\n```\n\n**int newCapacity = oldCapacity + (oldCapacity >> 1),æ‰€ä»¥ ArrayList æ¯æ¬¡æ‰©å®¹ä¹‹åå®¹é‡éƒ½ä¼šå˜ä¸ºåŸæ¥çš„ 1.5 å€å·¦å³ï¼ˆoldCapacity ä¸ºå¶æ•°å°±æ˜¯ 1.5 å€ï¼Œå¦åˆ™æ˜¯ 1.5 å€å·¦å³ï¼‰** \n\n**æˆ‘ä»¬å†æ¥é€šè¿‡ä¾‹å­æ¢ç©¶ä¸€ä¸‹grow() æ–¹æ³• ï¼š**\n\n- å½“ add ç¬¬ 1 ä¸ªå…ƒç´ æ—¶ï¼ŒoldCapacity ä¸º 0ï¼Œç»æ¯”è¾ƒåç¬¬ä¸€ä¸ª if åˆ¤æ–­æˆç«‹ï¼ŒnewCapacity = minCapacity(ä¸º 10)ã€‚ä½†æ˜¯ç¬¬äºŒä¸ª if åˆ¤æ–­ä¸ä¼šæˆç«‹ï¼Œå³ newCapacity ä¸æ¯” MAX_ARRAY_SIZE å¤§ï¼Œåˆ™ä¸ä¼šè¿›å…¥ `hugeCapacity` æ–¹æ³•ã€‚æ•°ç»„å®¹é‡ä¸º 10ï¼Œadd æ–¹æ³•ä¸­ return true,size å¢ä¸º 1ã€‚\n- å½“ add ç¬¬ 11 ä¸ªå…ƒç´ è¿›å…¥ grow æ–¹æ³•æ—¶ï¼ŒnewCapacity ä¸º 15ï¼Œæ¯” minCapacityï¼ˆä¸º 11ï¼‰å¤§ï¼Œç¬¬ä¸€ä¸ª if åˆ¤æ–­ä¸æˆç«‹ã€‚æ–°å®¹é‡æ²¡æœ‰å¤§äºæ•°ç»„æœ€å¤§ sizeï¼Œä¸ä¼šè¿›å…¥ hugeCapacity æ–¹æ³•ã€‚æ•°ç»„å®¹é‡æ‰©ä¸º 15ï¼Œadd æ–¹æ³•ä¸­ return true,size å¢ä¸º 11ã€‚\n- ä»¥æ­¤ç±»æ¨Â·Â·Â·Â·Â·Â·\n\n##### 2.5. `hugeCapacity()` \n\nä»ä¸Šé¢ `grow()` æ–¹æ³•æºç æˆ‘ä»¬çŸ¥é“ï¼š å¦‚æœæ–°å®¹é‡å¤§äº MAX_ARRAY_SIZE,è¿›å…¥(æ‰§è¡Œ) `hugeCapacity()` æ–¹æ³•æ¥æ¯”è¾ƒ minCapacity å’Œ MAX_ARRAY_SIZEï¼Œå¦‚æœ minCapacity å¤§äºæœ€å¤§å®¹é‡ï¼Œåˆ™æ–°å®¹é‡åˆ™ä¸º`Integer.MAX_VALUE`ï¼Œå¦åˆ™ï¼Œæ–°å®¹é‡å¤§å°åˆ™ä¸º MAX_ARRAY_SIZE å³ä¸º `Integer.MAX_VALUE - 8`ã€‚\n\n```java\n    private static int hugeCapacity(int minCapacity) {\n        if (minCapacity < 0) // overflow\n            throw new OutOfMemoryError();\n        //å¯¹minCapacityå’ŒMAX_ARRAY_SIZEè¿›è¡Œæ¯”è¾ƒ\n        //è‹¥minCapacityå¤§ï¼Œå°†Integer.MAX_VALUEä½œä¸ºæ–°æ•°ç»„çš„å¤§å°\n        //è‹¥MAX_ARRAY_SIZEå¤§ï¼Œå°†MAX_ARRAY_SIZEä½œä¸ºæ–°æ•°ç»„çš„å¤§å°\n        //MAX_ARRAY_SIZE = Integer.MAX_VALUE - 8;\n        return (minCapacity > MAX_ARRAY_SIZE) ?\n            Integer.MAX_VALUE :\n            MAX_ARRAY_SIZE;\n    }\n```\n\n### Setæ¥å£\n\n#### HashSet çš„å®ç°åŸç†ï¼Ÿ\n\nHashSet æ˜¯åŸºäº HashMap å®ç°çš„ï¼ŒHashSet çš„å€¼å­˜æ”¾äº HashMap çš„ key ä¸Šï¼ŒHashMap çš„ value ç»Ÿä¸€ä¸º Object å¸¸é‡ PRESENTï¼Œç”±äº HashMap çš„ key ä¸å…è®¸é‡å¤ï¼Œè€Œ HashSet ä¸å…è®¸é‡å¤çš„å€¼ï¼Œå› æ­¤ HashSet å¯ä»¥åŸºäº HashMap å®ç°ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯ç›´æ¥è°ƒç”¨åº•å±‚ HashMap çš„ç›¸å…³æ–¹æ³•æ¥å®Œæˆã€‚\n\n#### HashSetæ˜¯å¦‚ä½•ä¿è¯æ•°æ®ä¸å¯é‡å¤çš„ï¼Ÿ\n\nå½“ä½ æŠŠå¯¹è±¡åŠ å…¥ hashSet æ—¶ï¼ŒhashSet ä¼šå…ˆè®¡ç®—å¯¹è±¡çš„ hashcode å€¼æ¥åˆ¤æ–­å¯¹è±¡åŠ å…¥çš„ä½ç½®ï¼Œå¦‚æœå‘ç°æœ‰ç›¸åŒ hashcode å€¼çš„å¯¹è±¡ï¼Œè¿™æ—¶ä¼šè°ƒç”¨ equals()æ–¹æ³•æ¥æ£€æŸ¥ hashcode ç›¸ç­‰çš„å¯¹è±¡æ˜¯å¦çœŸçš„ç›¸åŒã€‚å¦‚æœä¸¤è€…ç›¸åŒï¼Œè¡¨æ˜å·²ç»æœ‰äº†ç›¸åŒçš„å¯¹è±¡äº†ï¼ŒhashSet å°±ä¸ä¼šè®©å…¶åŠ å…¥æ“ä½œæˆåŠŸã€‚å¦‚æœä¸åŒçš„è¯ï¼Œå°±ä¼šé‡æ–°æ•£åˆ—åˆ°å…¶ä»–ä½ç½®ã€‚ \n\n```java\n// Dummy value to associate with an Object in the backing Map\nprivate static final Object PRESENT = new Object();\nprivate transient HashMap<E,Object> map;\n\npublic HashSet() {\n    map = new HashMap<>();\n}\n\npublic boolean add(E e) {\n    // è°ƒç”¨HashMapçš„putæ–¹æ³•,PRESENTæ˜¯ä¸€ä¸ªè‡³å§‹è‡³ç»ˆéƒ½ç›¸åŒçš„è™šå€¼\n\treturn map.put(e, PRESENT)==null;\n}\n```\n\n#### åªé‡å†™ hashCode å¯ä»¥å—ï¼Ÿ\n\nä¸¤ä¸ªå¯¹è±¡çš„ hashCode ç›¸åŒï¼Œä½†æ˜¯å†…å®¹å¯èƒ½ä¸åŒï¼Œåœ¨ set ä¸­æ˜æ˜åº”è¯¥æ˜¯ä¸¤ä¸ªä¸åŒçš„å¯¹è±¡ï¼Œè¿™æ—¶å€™åªé€šè¿‡ hashCode åˆ¤æ–­ä»–ä¿©ç›¸åŒä¼šå¯¼è‡´åªæ’å…¥ä¸€ä¸ªå…ƒç´ ã€‚\n\n#### åªé‡å†™ equalså¯ä»¥å—ï¼Ÿ\n\nå¦‚æœåœ¨é‡å†™ equals æ—¶ï¼Œä¸é‡å†™ hashCodeï¼Œå°±ä¼šå¼•èµ·æ¯”å¦‚è¯´å°†ä¸¤ä¸ªç›¸ç­‰çš„è‡ªå®šä¹‰å¯¹è±¡å­˜å‚¨åœ¨ Set é›†åˆæ—¶ï¼Œä¼šå°†è¿™ä¸¤ä¸ªå¯¹è±¡éƒ½è¿›è¡Œæ’å…¥ã€‚ï¼ˆæ— æ³•å»é‡ï¼‰\n\n## Mapæ¥å£\n\n### HashMapçº¿ç¨‹ä¸å®‰å…¨çš„ä¸»è¦ä½“ç°ï¼Ÿ\n\n1. åœ¨ jdk1.7 ä¸­ï¼Œåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œ**æ‰©å®¹**æ—¶ä¼šé€ æˆæ­»é“¾ã€‚\n\n\t> ä½œè€…ï¼šç£Šå“¥\n\t> é“¾æ¥ï¼šhttps://www.zhihu.com/question/394039290/answer/2314917909\n\t> æ¥æºï¼šçŸ¥ä¹\n\n\t1.1ã€\n\n\tæ­»å¾ªç¯æ˜¯å› ä¸ºå¹¶å‘ HashMap æ‰©å®¹å¯¼è‡´çš„ï¼Œå¹¶å‘æ‰©å®¹çš„ç¬¬ä¸€æ­¥ï¼Œçº¿ç¨‹ T1 å’Œçº¿ç¨‹ T2 è¦å¯¹ HashMap è¿›è¡Œæ‰©å®¹æ“ä½œï¼Œæ­¤æ—¶ T1 å’Œ T2 æŒ‡å‘çš„æ˜¯é“¾è¡¨çš„å¤´ç»“ç‚¹å…ƒç´  Aï¼Œè€Œ T1 å’Œ T2 çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯ T1.next å’Œ T2.next æŒ‡å‘çš„æ˜¯ B èŠ‚ç‚¹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š \n\n\t![å¤šçº¿ç¨‹æ‰©å®¹å¯¼è‡´æ­»å¾ªç¯é—®é¢˜-1](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/v2-e0b4f5ea00cb277bde490f315b9b387f_720w.jpg)\n\n\t1.2ã€\n\n\tæ­»å¾ªç¯çš„ç¬¬äºŒæ­¥æ“ä½œæ˜¯ï¼Œçº¿ç¨‹ T2 æ—¶é—´ç‰‡ç”¨å®Œè¿›å…¥ä¼‘çœ çŠ¶æ€ï¼Œè€Œçº¿ç¨‹ T1 å¼€å§‹æ‰§è¡Œæ‰©å®¹æ“ä½œï¼Œä¸€ç›´åˆ°çº¿ç¨‹ T1 æ‰©å®¹å®Œæˆåï¼Œçº¿ç¨‹ T2 æ‰è¢«å”¤é†’ï¼Œæ‰©å®¹ä¹‹åçš„åœºæ™¯å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š \n\n\t![å¤šçº¿ç¨‹æ‰©å®¹å¯¼è‡´æ­»å¾ªç¯é—®é¢˜-2](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/v2-5f78d8ac8af1efc79e7d79a1f3fdc154_r.jpg)\n\n\t ä»ä¸Šå›¾å¯çŸ¥çº¿ç¨‹ T1 æ‰§è¡Œä¹‹åï¼Œ**å› ä¸ºæ˜¯å¤´æ’æ³•ï¼Œæ‰€ä»¥HashMapçš„é¡ºåºå·²ç»å‘ç”Ÿäº†æ”¹å˜**ï¼Œä½†çº¿ç¨‹ T2 å¯¹äºå‘ç”Ÿçš„ä¸€åˆ‡æ˜¯ä¸å¯çŸ¥çš„ï¼Œæ‰€ä»¥å®ƒçš„æŒ‡å‘å…ƒç´ ä¾ç„¶æ²¡å˜ï¼Œå¦‚ä¸Šå›¾å±•ç¤ºçš„é‚£æ ·ï¼ŒT2 æŒ‡å‘çš„æ˜¯ A å…ƒç´ ï¼ŒT2.next æŒ‡å‘çš„èŠ‚ç‚¹æ˜¯ B å…ƒç´ ã€‚\n\n\t1.3ã€\n\n\tå½“çº¿ç¨‹ T1 æ‰§è¡Œå®Œï¼Œè€Œçº¿ç¨‹ T2 æ¢å¤æ‰§è¡Œæ—¶ï¼Œæ­»å¾ªç¯å°±å»ºç«‹äº†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š \n\n\t![å¤šçº¿ç¨‹æ‰©å®¹å¯¼è‡´æ­»å¾ªç¯é—®é¢˜-3](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/v2-bd4a753db8c985119aa4dcd4356609cf_720w.jpg)\n\n\t å› ä¸º T1 æ‰§è¡Œå®Œæ‰©å®¹ä¹‹å B èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ˜¯ Aï¼Œè€Œ T2 çº¿ç¨‹æŒ‡å‘çš„é¦–èŠ‚ç‚¹æ˜¯ Aï¼Œç¬¬äºŒä¸ªèŠ‚ç‚¹æ˜¯ Bï¼Œè¿™ä¸ªé¡ºåºåˆšå¥½å’Œ T1 æ‰©å®Œå®¹å®Œä¹‹åçš„èŠ‚ç‚¹é¡ºåºæ˜¯ç›¸åçš„ã€‚**T1æ‰§è¡Œå®Œä¹‹åçš„é¡ºåºæ˜¯Båˆ°Aï¼Œè€ŒT2çš„é¡ºåºæ˜¯Aåˆ°Bï¼Œè¿™æ ·AèŠ‚ç‚¹å’ŒBèŠ‚ç‚¹å°±å½¢æˆæ­»å¾ªç¯äº†**ï¼Œè¿™å°±æ˜¯ HashMap æ­»å¾ªç¯å¯¼è‡´çš„åŸå› ã€‚\n\n2. åœ¨ jdk1.8 ä¸­ï¼Œåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œ**æ’å…¥**æ—¶ä¼šå‘ç”Ÿæ•°æ®è¦†ç›–çš„æƒ…å†µï¼ˆ**å°¾æ’æ³•**ï¼‰ã€‚\n\n### HashMapåœ¨JDK1.7å’ŒJDK1.8ä¸­æœ‰å“ªäº›ä¸åŒï¼Ÿ\n\n| ä¸åŒ                         | JDK 1.7                                                      | JDK 1.8                                                      |\n| ---------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |\n| **å­˜å‚¨ç»“æ„**                 | æ•°ç»„ + é“¾è¡¨                                                  | æ•°ç»„ + é“¾è¡¨ + çº¢é»‘æ ‘                                         |\n| **hashå€¼è®¡ç®—æ–¹å¼**           | æ‰°åŠ¨å¤„ç† = 4æ¬¡ä½è¿ç®— + 5æ¬¡å¼‚æˆ–è¿ç®—                           | æ‰°åŠ¨å¤„ç† = 1æ¬¡ä½è¿ç®— + 1æ¬¡å¼‚æˆ–è¿ç®—                           |\n| **å­˜æ”¾æ•°æ®çš„è§„åˆ™**           | æ— å†²çªæ—¶ï¼Œå­˜æ”¾æ•°ç»„ï¼›<br />å†²çªæ—¶ï¼Œå­˜æ”¾é“¾è¡¨                   | æ— å†²çªæ—¶ï¼Œå­˜æ”¾æ•°ç»„ï¼›<br />å†²çª & é“¾è¡¨é•¿åº¦ < 8ï¼šæ’å…¥å•é“¾è¡¨ï¼›<br />é“¾è¡¨é•¿åº¦>8ï¼Œå…ˆå°è¯•æ‰©å®¹æ•°ç»„ï¼Œæ•°ç»„é•¿åº¦å¤§äº64<br />é“¾è¡¨è½¬ä¸ºçº¢é»‘æ ‘ï¼Œæ’å…¥åˆ°çº¢é»‘æ ‘ |\n| **æ’å…¥æ•°æ®æ–¹å¼**             | å¤´æ’æ³•                                                       | å°¾æ’æ³•                                                       |\n| **æ‰©å®¹åå­˜å‚¨ä½ç½®çš„è®¡ç®—æ–¹å¼** | æŒ‰ç…§åŸæ¥æ–¹æ³•é‡æ–°è¿›è¡Œè®¡ç®—<br />hashCodeã€æ‰°åŠ¨å‡½æ•°ã€ä¸è¿ç®—h&length-1 | æ ¹æ®å…ƒç´ çš„hashå€¼è¿›è¡Œåˆ¤æ–­ <br />æ‰©å®¹åçš„ä½ç½®=åŸä½ç½® or åŸä½ç½® + æ—§å®¹é‡ |\n\n### HashMapçš„hashç®—æ³•\n\n#### ä»€ä¹ˆæ˜¯å“ˆå¸Œï¼Ÿ\n\nHashï¼Œå°±æ˜¯æŠŠä»»æ„é•¿åº¦çš„è¾“å…¥é€šè¿‡æ•£åˆ—ç®—æ³•ï¼Œå˜æ¢æˆå›ºå®šé•¿åº¦çš„è¾“å‡ºï¼Œè¯¥è¾“å‡ºå°±æ˜¯æ•£åˆ—å€¼ï¼ˆå“ˆå¸Œå€¼ï¼‰ï¼›\n\nhash å€¼ä¸åŒï¼Œè¾“å…¥ä¸€å®šä¸åŒï¼›è¾“å…¥ä¸åŒï¼Œhash å€¼å¯èƒ½ç›¸åŒï¼ˆå³å“ˆå¸Œç¢°æ’ï¼‰\n\n#### ä»€ä¹ˆæ˜¯å“ˆå¸Œå†²çªï¼Ÿ\n\nå½“ä¸¤ä¸ªä¸åŒçš„è¾“å…¥å€¼ï¼Œæ ¹æ®åŒä¸€æ•£åˆ—å‡½æ•°è®¡ç®—å‡ºç›¸åŒçš„æ•£åˆ—å€¼çš„ç°è±¡ï¼Œæˆ‘ä»¬å°±æŠŠå®ƒå«åšå“ˆå¸Œç¢°æ’/å†²çªã€‚\n\n#### HashMapçš„æ•°æ®ç»“æ„\n\nåº•å±‚æ•°æ®ç»“æ„ï¼šæ•°ç»„+é“¾è¡¨\n**æ•°ç»„çš„ç‰¹ç‚¹æ˜¯ï¼šæ–¹ä¾¿æŸ¥æ‰¾ï¼›é“¾è¡¨çš„ç‰¹ç‚¹æ˜¯ï¼šæ–¹ä¾¿æ’å…¥åˆ é™¤**\næ‰€ä»¥æˆ‘ä»¬å°†æ•°ç»„å’Œé“¾è¡¨ç»“åˆåœ¨ä¸€èµ·ï¼Œå‘æŒ¥ä¸¤è€…å„è‡ªçš„ä¼˜åŠ¿ï¼Œä½¿ç”¨ä¸€ç§å«åš**é“¾åœ°å€æ³•**çš„æ–¹å¼å¯ä»¥è§£å†³å“ˆå¸Œå†²çª\n\n> è§£å†³å“ˆå¸Œå†²çªçš„å…¶ä»–æ–¹æ³•ï¼š\n> å¼€æ”¾å®šå€æ³•ï¼ˆå†²çªäº†é€šè¿‡æŸç§æ–¹å¼æ•£åˆ—åˆ°å¦ä¸€ä¸ªä¸å†²çªçš„ä½ç½®ä¸Šï¼‰ï¼›\n> å†å“ˆå¸Œæ³•ï¼ˆæ„é€ å¤šä¸ªä¸åŒçš„å“ˆå¸Œå‡½æ•°ï¼‰ã€‚\n\n![HashMapæ•°æ®ç»“æ„](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy83ODk2ODkwLWM2NmE0YmQ4OTA3ZjQ5ZjYucG5n.png)\n\n#### æ‰°åŠ¨å¤„ç†\n\nç”±äºè®¡ç®—ä¸‹æ ‡æ—¶ï¼Œé€šè¿‡ h & (length - 1)ï¼Œç”±äº hash å€¼èŒƒå›´å¾ˆå¤§ï¼Œè€Œæ•°ç»„é•¿åº¦ç›¸å¯¹æ¥è¯´å°å¾—å¤šï¼Œå¯¼è‡´è¿›è¡Œä¸è¿ç®—æ—¶å‚ä¸è¿ç®—çš„åªæœ‰ hash å€¼çš„ä½ä½ï¼Œ**é«˜ä½æ˜¯æ²¡æœ‰èµ·åˆ°ä»»ä½•ä½œç”¨çš„**ï¼Œè¿™å°†ä¼šå¤§å¤§å¢åŠ å“ˆå¸Œç¢°æ’çš„æ¦‚ç‡ã€‚æ‰€ä»¥æˆ‘ä»¬çš„æ€è·¯å°±æ˜¯è®© hashCode å€¼çš„é«˜ä½ä¹Ÿå‚ä¸è¿ç®—ï¼Œè¿›ä¸€æ­¥é™ä½ hash ç¢°æ’çš„æ¦‚ç‡ï¼Œä½¿å¾—**æ•°æ®åˆ†å¸ƒæ›´å¹³å‡**ï¼Œæˆ‘ä»¬æŠŠè¿™æ ·çš„æ“ä½œç§°ä¸º**æ‰°åŠ¨**ï¼Œåœ¨**JDK 1.8**ä¸­çš„ hash()å‡½æ•°å¦‚ä¸‹ï¼š\n\n```java\nstatic final int hash(Object key) {\n    int h;\n    return (key == null) ? 0 : (h = key.hashCode()) ^ (h >>> 16);\n    // ä¸è‡ªå·±å³ç§»16ä½è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼ˆé«˜ä½ä½å¼‚æˆ–ï¼‰\n}\n```\n\nè¿™æ¯”åœ¨**JDK 1.7**ä¸­ï¼Œæ›´ä¸ºç®€æ´ï¼Œ**ç›¸æ¯”åœ¨1.7ä¸­çš„4æ¬¡ä½è¿ç®—ï¼Œ5æ¬¡å¼‚æˆ–è¿ç®—ï¼ˆ9æ¬¡æ‰°åŠ¨ï¼‰ï¼Œåœ¨1.8ä¸­ï¼Œåªè¿›è¡Œäº†1æ¬¡ä½è¿ç®—å’Œ1æ¬¡å¼‚æˆ–è¿ç®—ï¼ˆ2æ¬¡æ‰°åŠ¨ï¼‰**ï¼›\n\n#### ä¸‹æ ‡è®¡ç®—\n\nåœ¨å¾—åˆ° hash å€¼ä¹‹åï¼Œæˆ‘ä»¬è¦æŠŠè¿™äº› hash å€¼æ˜ å°„åˆ°ç›¸åº”çš„æ•°ç»„ä¸‹æ ‡ä¸Šï¼Œé‚£ä¹ˆå°±å¯ä»¥è€ƒè™‘ä½¿ç”¨ hash % length\n\nè€Œ hash % length==hash & (length-1) å¹¶ä¸”å‰ææ˜¯ length æ˜¯ 2 çš„ n æ¬¡æ–¹ã€‚\nç”±äºé‡‡ç”¨äºŒè¿›åˆ¶ä½æ“ä½œ &ï¼Œç›¸å¯¹äº%èƒ½å¤Ÿæé«˜è¿ç®—æ•ˆç‡ï¼Œå› æ­¤å¯ä»¥å°† HashMap çš„é•¿åº¦è®¾è®¡ä¸º 2 çš„å¹‚æ¬¡æ–¹ã€‚ï¼ˆåˆå§‹åŒ–ä¸º 16ï¼Œå¦‚æœæŒ‡å®šåˆå§‹åŒ–å®¹é‡çš„å€¼ï¼Œä¼šæ‰©å®¹è‡³ç¬¬ä¸€ä¸ªå¤§äºè¯¥å®¹é‡çš„ 2 çš„å¹‚æ¬¡æ–¹ä½œä¸ºæ•°ç»„å®¹é‡ï¼‰\n\n```java\nstatic int indexFor(int h, int length){\n     return h & (length - 1);\n}\n```\n\n#### ä¸ºä»€ä¹ˆè¦å°†æ•°ç»„é•¿åº¦è®¾ç½®ä¸º 2 çš„næ¬¡å¹‚å‘¢ï¼Ÿ\n\nå½“æ•°ç»„é•¿åº¦ä¸º 2 çš„ n æ¬¡å¹‚çš„æ—¶å€™ï¼Œä¸åŒçš„ key ä¸ 1111ï¼ˆn ä¸ªï¼‰è¿›è¡Œä¸é¢„ç®—å¾—åˆ°ç›¸åŒä¸‹æ ‡çš„å‡ ç‡è¾ƒå°ï¼Œå‘ç”Ÿç¢°æ’çš„å‡ ç‡å°ã€‚ \n\n#### JDK1.8æ–°å¢çº¢é»‘æ ‘\n\nä¸ºäº†è§£å†³ä¸€æ¡é“¾ä¸Šçš„å…ƒç´ è¿‡å¤šï¼ŒæŸ¥æ‰¾æ•ˆç‡ä½çš„é—®é¢˜ï¼Œå°†é“¾è¡¨è½¬åŒ–ä¸ºçº¢é»‘æ ‘ï¼Œéå†å¤æ‚åº¦é™ä½è‡³ O(logn)ï¼›\n\n#### HashMapæ˜¯ä½¿ç”¨äº†å“ªäº›æ–¹æ³•æ¥æœ‰æ•ˆè§£å†³å“ˆå¸Œå†²çªçš„ï¼Ÿ\n\n1. ä½¿ç”¨é“¾åœ°å€æ³•ï¼ˆä½¿ç”¨æ•£åˆ—è¡¨ï¼‰æ¥é“¾æ¥æ‹¥æœ‰ç›¸åŒ hash å€¼çš„æ•°æ®ï¼›\n2. ä½¿ç”¨ 2 æ¬¡æ‰°åŠ¨å‡½æ•°ï¼ˆ1 æ¬¡ä½è¿ç®—å’Œ 1 æ¬¡å¼‚æˆ–è¿ç®—ï¼‰æ¥é™ä½å“ˆå¸Œå†²çªçš„æ¦‚ç‡ï¼Œä½¿å¾—æ•°æ®åˆ†å¸ƒæ›´å¹³å‡ï¼›\n3. å¼•å…¥çº¢é»‘æ ‘è¿›ä¸€æ­¥é™ä½éå†çš„æ—¶é—´å¤æ‚åº¦ï¼Œä½¿å¾—éå†æ›´å¿«ã€‚\n\n### HashMapçš„getæ–¹æ³•çš„å…·ä½“æµç¨‹ï¼Ÿ\n\n1. å…ˆä½¿ç”¨ key çš„ hashCodeã€æ‰°åŠ¨å¤„ç†ã€ä¸æ•°ç»„é•¿åº¦-1 è¿›è¡Œä¸è¿ç®—ï¼ˆå¯¹æ•°ç»„é•¿åº¦å»ä½™ï¼‰å¾—åˆ°æ§½ä½ï¼›\n2. åˆ¤æ–­é¦–ç»“ç‚¹ï¼Œå¦‚æœé¦–ç»“ç‚¹å’Œ key çš„ **hashå€¼** ï¼ˆhashCode å€¼ç»è¿‡æ‰°åŠ¨å‡½æ•°å¤„ç†åçš„å€¼ï¼‰ç›¸ç­‰ï¼Œå¹¶ä¸”ä¸¤è€…çš„ **keyå€¼åœ°å€ç›¸ç­‰ã€equalsç›¸ç­‰**ï¼Œåˆ™è¿”å›é¦–ç»“ç‚¹ï¼›\n3. å¦åˆ™ï¼Œåˆ™çº¢é»‘æ ‘æˆ–è€…é“¾è¡¨ä¸­è¿›è¡ŒæŸ¥æ‰¾ï¼ŒæŸ¥æ‰¾æ—¶åˆ¤æ–­ä¸¤ä¸ª key çš„ hash å€¼ã€key å€¼åœ°å€ç›¸ç­‰ã€equals æ˜¯å¦éƒ½ç›¸ç­‰ã€‚\n\n```java\npublic V get(Object key) {\n    Node<K,V> e;\n    return (e = getNode(hash(key), key)) == null ? null : e.value;\n}\n\nfinal Node<K,V> getNode(int hash, Object key) {\n    Node<K,V>[] tab; Node<K,V> first, e; int n; K k;\n    \n    //Nodeæ•°ç»„ä¸ä¸ºç©ºï¼Œæ•°ç»„é•¿åº¦å¤§äº0ï¼Œæ•°ç»„å¯¹åº”ä¸‹æ ‡çš„Nodeä¸ä¸ºç©º\n    if ((tab = table) != null && (n = tab.length) > 0 &&\n        //ä¹Ÿæ˜¯é€šè¿‡ hash & (length - 1) æ¥æ›¿ä»£ hash % length çš„\n        (first = tab[(n - 1) & hash]) != null) {\n        \n        //å…ˆå’Œç¬¬ä¸€ä¸ªç»“ç‚¹æ¯”ï¼Œhashå€¼ç›¸ç­‰ä¸”keyä¸ä¸ºç©ºï¼Œkeyçš„ç¬¬ä¸€ä¸ªç»“ç‚¹çš„keyçš„å¯¹è±¡åœ°å€å’Œå€¼å‡ç›¸ç­‰\n        //åˆ™è¿”å›ç¬¬ä¸€ä¸ªç»“ç‚¹\n        if (first.hash == hash && // always check first node\n            ((k = first.key) == key || (key != null && key.equals(k))))\n            return first;\n        //å¦‚æœkeyå’Œç¬¬ä¸€ä¸ªç»“ç‚¹ä¸åŒ¹é…ï¼Œåˆ™çœ‹.nextæ˜¯å¦ä¸ºç©ºï¼Œä¸ä¸ºnullåˆ™ç»§ç»­ï¼Œä¸ºç©ºåˆ™è¿”å›null\n        if ((e = first.next) != null) {\n            //å¦‚æœæ­¤æ—¶æ˜¯çº¢é»‘æ ‘çš„ç»“æ„ï¼Œåˆ™è¿›è¡Œå¤„ç†getTreeNode()æ–¹æ³•æœç´¢key\n            if (first instanceof TreeNode)\n                return ((TreeNode<K,V>)first).getTreeNode(hash, key);\n            //æ˜¯é“¾è¡¨ç»“æ„çš„è¯å°±ä¸€ä¸ªä¸€ä¸ªéå†ï¼Œç›´åˆ°æ‰¾åˆ°keyå¯¹åº”çš„ç»“ç‚¹ï¼Œ\n            //æˆ–è€…eçš„ä¸‹ä¸€ä¸ªç»“ç‚¹ä¸ºnullé€€å‡ºå¾ªç¯\n            do {\n                if (e.hash == hash &&\n                    ((k = e.key) == key || (key != null && key.equals(k))))\n                    return e;\n            } while ((e = e.next) != null);\n        }\n    }\n    return null;\n}\n```\n\n### HashMapçš„putæ–¹æ³•çš„å…·ä½“æµç¨‹ï¼Ÿ\n\n1. å¦‚æœ table æœªåˆå§‹åŒ–æˆ–è€…é•¿åº¦ä¸º 0 ç©ºåˆ™æ‰§è¡Œ resize()è¿›è¡Œæ‰©å®¹ï¼Œè½¬å‘â‘¡\n2. æ ¹æ®é”®å€¼ key è®¡ç®— hash å€¼å¾—åˆ°æ’å…¥çš„æ•°ç»„ç´¢å¼• iï¼Œå¦‚æœ table[i]==nullï¼Œå³æ•°ç»„è¯¥ä½ç½®ä¸Šæ²¡æœ‰å…ƒç´ ï¼Œç›´æ¥æ–°å»ºèŠ‚ç‚¹æ’å…¥ï¼Œè½¬å‘â‘¥åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹ï¼Œå¦‚æœ table[i]ä¸ä¸ºç©ºï¼Œè½¬å‘â‘¢ï¼›\n3. åˆ¤æ–­ table[i]çš„é¦–ä¸ªå…ƒç´ æ˜¯å¦å’Œ key ä¸€æ ·ï¼Œå¦‚æœç›¸åŒï¼ˆhashCode ç›¸åŒã€key åœ°å€ç›¸åŒã€equals ç›¸åŒï¼‰ç›´æ¥è¦†ç›– valueï¼Œå¦åˆ™è½¬å‘â‘£ï¼›\n4. åˆ¤æ–­ table[i] æ˜¯å¦ä¸º treeNodeï¼Œå³ table[i] æ˜¯å¦æ˜¯çº¢é»‘æ ‘ï¼Œå¦‚æœæ˜¯çº¢é»‘æ ‘ï¼Œåˆ™ç›´æ¥åœ¨æ ‘ä¸­æ’å…¥é”®å€¼å¯¹ï¼Œå¦åˆ™è½¬å‘â‘¤ï¼›\n5. éå† table[i]ï¼Œåˆ¤æ–­é“¾è¡¨é•¿åº¦æ˜¯å¦å¤§äº 8ï¼Œå¤§äº 8 çš„è¯æŠŠé“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼Œåœ¨çº¢é»‘æ ‘ä¸­æ‰§è¡Œæ’å…¥æ“ä½œï¼Œå¦åˆ™è¿›è¡Œé“¾è¡¨çš„æ’å…¥æ“ä½œï¼›éå†è¿‡ç¨‹ä¸­è‹¥å‘ç° key å·²ç»å­˜åœ¨ç›´æ¥è¦†ç›– value å³å¯ï¼›\n6. æ’å…¥æˆåŠŸåï¼Œåˆ¤æ–­å®é™…å­˜åœ¨çš„é”®å€¼å¯¹æ•°é‡ size æ˜¯å¦è¶…å‡ºå½“å‰æœ€å¤§å®¹é‡ thresholdï¼Œå¦‚æœè¶…è¿‡ï¼Œè¿›è¡Œæ‰©å®¹ã€‚\n\n```java\npublic V put(K key, V value) {\n    return putVal(hash(key), key, value, false, true);\n}\n\nstatic final int hash(Object key) {\n    int h;\n    return (key == null) ? 0 : (h = key.hashCode()) ^ (h >>> 16);\n}\n\n//å®ç°Map.putå’Œç›¸å…³æ–¹æ³•\nfinal V putVal(int hash, K key, V value, boolean onlyIfAbsent,\n                   boolean evict) {\n    Node<K,V>[] tab; Node<K,V> p; int n, i;\n    // æ­¥éª¤â‘ ï¼štabä¸ºç©ºåˆ™åˆ›å»º \n    // tableæœªåˆå§‹åŒ–æˆ–è€…é•¿åº¦ä¸º0ï¼Œè¿›è¡Œæ‰©å®¹\n    if ((tab = table) == null || (n = tab.length) == 0)\n        n = (tab = resize()).length;\n    // æ­¥éª¤â‘¡ï¼šè®¡ç®—indexï¼Œå¹¶å¯¹nullåšå¤„ç†  \n    // (n - 1) & hash ç¡®å®šå…ƒç´ å­˜æ”¾åœ¨å“ªä¸ªæ¡¶ä¸­ï¼Œæ¡¶ä¸ºç©ºï¼Œæ–°ç”Ÿæˆç»“ç‚¹æ”¾å…¥æ¡¶ä¸­(æ­¤æ—¶ï¼Œè¿™ä¸ªç»“ç‚¹æ˜¯æ”¾åœ¨æ•°ç»„ä¸­)\n    if ((p = tab[i = (n - 1) & hash]) == null)\n        tab[i] = newNode(hash, key, value, null);\n    // æ¡¶ä¸­å·²ç»å­˜åœ¨å…ƒç´ \n    else {\n        Node<K,V> e; K k;\n        // æ­¥éª¤â‘¢ï¼šèŠ‚ç‚¹keyå­˜åœ¨ï¼Œç›´æ¥è¦†ç›–value \n        // æ¯”è¾ƒæ¡¶ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ (æ•°ç»„ä¸­çš„ç»“ç‚¹)çš„hashå€¼ç›¸ç­‰ï¼Œkeyç›¸ç­‰\n        if (p.hash == hash &&\n            ((k = p.key) == key || (key != null && key.equals(k))))\n                // å°†ç¬¬ä¸€ä¸ªå…ƒç´ èµ‹å€¼ç»™eï¼Œç”¨eæ¥è®°å½•\n                e = p;\n        // æ­¥éª¤â‘£ï¼šåˆ¤æ–­è¯¥é“¾ä¸ºçº¢é»‘æ ‘ \n        // hashå€¼ä¸ç›¸ç­‰ï¼Œå³keyä¸ç›¸ç­‰ï¼›ä¸ºçº¢é»‘æ ‘ç»“ç‚¹\n        // å¦‚æœå½“å‰å…ƒç´ ç±»å‹ä¸ºTreeNodeï¼Œè¡¨ç¤ºä¸ºçº¢é»‘æ ‘ï¼ŒputTreeValè¿”å›å¾…å­˜æ”¾çš„node, eå¯èƒ½ä¸ºnull\n        else if (p instanceof TreeNode)\n            // æ”¾å…¥æ ‘ä¸­\n            e = ((TreeNode<K,V>)p).putTreeVal(this, tab, hash, key, value);\n        // æ­¥éª¤â‘¤ï¼šè¯¥é“¾ä¸ºé“¾è¡¨ \n        // ä¸ºé“¾è¡¨ç»“ç‚¹\n        else {\n            // åœ¨é“¾è¡¨æœ€æœ«æ’å…¥ç»“ç‚¹\n            for (int binCount = 0; ; ++binCount) {\n                // åˆ°è¾¾é“¾è¡¨çš„å°¾éƒ¨\n                \n                //åˆ¤æ–­è¯¥é“¾è¡¨å°¾éƒ¨æŒ‡é’ˆæ˜¯ä¸æ˜¯ç©ºçš„\n                if ((e = p.next) == null) {\n                    // åœ¨å°¾éƒ¨æ’å…¥æ–°ç»“ç‚¹\n                    p.next = newNode(hash, key, value, null);\n                    //åˆ¤æ–­é“¾è¡¨çš„é•¿åº¦æ˜¯å¦è¾¾åˆ°è½¬åŒ–çº¢é»‘æ ‘çš„ä¸´ç•Œå€¼ï¼Œä¸´ç•Œå€¼ä¸º8\n                    if (binCount >= TREEIFY_THRESHOLD - 1) // -1 for 1st\n                        //é“¾è¡¨ç»“æ„è½¬æ ‘å½¢ç»“æ„\n                        treeifyBin(tab, hash);\n                    // è·³å‡ºå¾ªç¯\n                    break;\n                }\n                // åˆ¤æ–­é“¾è¡¨ä¸­ç»“ç‚¹çš„keyå€¼ä¸æ’å…¥çš„å…ƒç´ çš„keyå€¼æ˜¯å¦ç›¸ç­‰\n                if (e.hash == hash &&\n                    ((k = e.key) == key || (key != null && key.equals(k))))\n                    // ç›¸ç­‰ï¼Œè·³å‡ºå¾ªç¯\n                    break;\n                // ç”¨äºéå†æ¡¶ä¸­çš„é“¾è¡¨ï¼Œä¸å‰é¢çš„e = p.nextç»„åˆï¼Œå¯ä»¥éå†é“¾è¡¨\n                p = e;\n            }\n        }\n        //åˆ¤æ–­å½“å‰çš„keyå·²ç»å­˜åœ¨çš„æƒ…å†µä¸‹ï¼Œå†æ¥ä¸€ä¸ªç›¸åŒçš„hashå€¼ã€keyå€¼æ—¶ï¼Œè¿”å›æ–°æ¥çš„valueè¿™ä¸ªå€¼\n        if (e != null) { \n            // è®°å½•eçš„value\n            V oldValue = e.value;\n            // onlyIfAbsentä¸ºfalseæˆ–è€…æ—§å€¼ä¸ºnull\n            if (!onlyIfAbsent || oldValue == null)\n                //ç”¨æ–°å€¼æ›¿æ¢æ—§å€¼\n                e.value = value;\n            // è®¿é—®åå›è°ƒ\n            afterNodeAccess(e);\n            // è¿”å›æ—§å€¼\n            return oldValue;\n        }\n    }\n    // ç»“æ„æ€§ä¿®æ”¹\n    ++modCount;\n    // æ­¥éª¤â‘¥ï¼šè¶…è¿‡æœ€å¤§å®¹é‡å°±æ‰©å®¹ \n    // å®é™…å¤§å°å¤§äºé˜ˆå€¼åˆ™æ‰©å®¹\n    if (++size > threshold)\n        resize();\n    // æ’å…¥åå›è°ƒ\n    afterNodeInsertion(evict);\n    return null;\n}\n```\n\n### HashMapçš„æ‰©å®¹æ“ä½œæ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ\n\nâ‘ .åœ¨ jdk1.8 ä¸­ï¼Œresize æ–¹æ³•æ˜¯åœ¨ hashmap ä¸­çš„é”®å€¼å¯¹ï¼ˆå…ƒç´ æ•°é‡ï¼‰å¤§äºé˜€å€¼æ—¶ï¼ˆé˜ˆå€¼ä¸ºå®¹é‡*è´Ÿè½½å› å­ï¼‰æ‰©å®¹ä¸ºåŸå®¹é‡çš„ 2 å€ï¼Œæˆ–è€…åˆå§‹åŒ–æ—¶ï¼ˆæ‰©å®¹ä¸º 16ï¼‰ï¼Œå°±è°ƒç”¨ resize æ–¹æ³•è¿›è¡Œæ‰©å®¹ï¼›\n\nâ‘¡.åœ¨ 1.7 ä¸­ï¼Œæ‰©å®¹ä¹‹åéœ€è¦é‡æ–°å»è®¡ç®—å…¶ Hash å€¼ï¼Œæ ¹æ® Hash å€¼å¯¹å…¶è¿›è¡Œåˆ†å‘ï¼Œä½†åœ¨ 1.8 ç‰ˆæœ¬ä¸­ï¼Œåˆ™æ˜¯æ ¹æ®åœ¨åŒä¸€ä¸ªæ¡¶çš„ä½ç½®ä¸­è¿›è¡Œåˆ¤æ–­(e.hash & oldCap)æ˜¯å¦ä¸º 0ï¼Œé‡æ–°è¿›è¡Œ hash åˆ†é…åï¼Œè¯¥å…ƒç´  hash å€¼ä¸æ—§å®¹é‡ä¸è¿ç®—ä¸º 0 åˆ™ç•™åœ¨åŸå§‹ä½ç½®ï¼Œhash å€¼ä¸æ—§å®¹é‡ä¸è¿ç®—ä¸º 1 åˆ™ç§»åŠ¨åˆ° åŸä½ç½® + oldCap è¿™ä¸ªä½ç½®ä¸Š\n\n![HashMapçš„resizeæ“ä½œ](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes20190128152700351.png)\n\n```java\nfinal Node<K,V>[] resize() {\n    Node<K,V>[] oldTab = table;//oldTabæŒ‡å‘hashæ¡¶æ•°ç»„\n    int oldCap = (oldTab == null) ? 0 : oldTab.length;\n    int oldThr = threshold;\n    int newCap, newThr = 0;\n    if (oldCap > 0) {//å¦‚æœoldCapä¸ä¸ºç©ºçš„è¯ï¼Œå°±æ˜¯hashæ¡¶æ•°ç»„ä¸ä¸ºç©º\n        if (oldCap >= MAXIMUM_CAPACITY) {//å¦‚æœå¤§äºæœ€å¤§å®¹é‡äº†ï¼Œå°±èµ‹å€¼ä¸ºæ•´æ•°æœ€å¤§çš„é˜€å€¼\n            threshold = Integer.MAX_VALUE;\n            return oldTab;//è¿”å›\n        }//å¦‚æœå½“å‰hashæ¡¶æ•°ç»„çš„é•¿åº¦åœ¨æ‰©å®¹åä»ç„¶å°äºæœ€å¤§å®¹é‡ å¹¶ä¸”oldCapå¤§äºé»˜è®¤å€¼16\n        else if ((newCap = oldCap << 1) < MAXIMUM_CAPACITY &&\n                 oldCap >= DEFAULT_INITIAL_CAPACITY)\n            newThr = oldThr << 1; // double threshold åŒå€æ‰©å®¹é˜€å€¼threshold\n    }\n    // æ—§çš„å®¹é‡ä¸º0ï¼Œä½†thresholdå¤§äºé›¶ï¼Œä»£è¡¨æœ‰å‚æ„é€ æœ‰capä¼ å…¥ï¼Œthresholdå·²ç»è¢«åˆå§‹åŒ–æˆæœ€å°2çš„næ¬¡å¹‚\n    // ç›´æ¥å°†è¯¥å€¼èµ‹ç»™æ–°çš„å®¹é‡\n    else if (oldThr > 0) // initial capacity was placed in threshold\n        newCap = oldThr;\n    // æ— å‚æ„é€ åˆ›å»ºçš„mapï¼Œç»™å‡ºé»˜è®¤å®¹é‡å’Œthreshold 16, 16*0.75\n    else {               // zero initial threshold signifies using defaults\n        newCap = DEFAULT_INITIAL_CAPACITY;\n        newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);\n    }\n    // æ–°çš„threshold = æ–°çš„cap * 0.75\n    if (newThr == 0) {\n        float ft = (float)newCap * loadFactor;\n        newThr = (newCap < MAXIMUM_CAPACITY && ft < (float)MAXIMUM_CAPACITY ?\n                  (int)ft : Integer.MAX_VALUE);\n    }\n    threshold = newThr;\n    // è®¡ç®—å‡ºæ–°çš„æ•°ç»„é•¿åº¦åèµ‹ç»™å½“å‰æˆå‘˜å˜é‡table\n    @SuppressWarnings({\"rawtypes\",\"unchecked\"})\n        Node<K,V>[] newTab = (Node<K,V>[])new Node[newCap];//æ–°å»ºhashæ¡¶æ•°ç»„\n    table = newTab;//å°†æ–°æ•°ç»„çš„å€¼å¤åˆ¶ç»™æ—§çš„hashæ¡¶æ•°ç»„\n    // å¦‚æœåŸå…ˆçš„æ•°ç»„æ²¡æœ‰åˆå§‹åŒ–ï¼Œé‚£ä¹ˆresizeçš„åˆå§‹åŒ–å·¥ä½œåˆ°æ­¤ç»“æŸï¼Œå¦åˆ™è¿›å…¥æ‰©å®¹å…ƒç´ é‡æ’é€»è¾‘ï¼Œä½¿å…¶å‡åŒ€çš„åˆ†æ•£\n    if (oldTab != null) {\n        // éå†æ–°æ•°ç»„çš„æ‰€æœ‰æ¡¶ä¸‹æ ‡\n        for (int j = 0; j < oldCap; ++j) {\n            Node<K,V> e;\n            if ((e = oldTab[j]) != null) {\n                // æ—§æ•°ç»„çš„æ¡¶ä¸‹æ ‡èµ‹ç»™ä¸´æ—¶å˜é‡eï¼Œå¹¶ä¸”è§£é™¤æ—§æ•°ç»„ä¸­çš„å¼•ç”¨ï¼Œå¦åˆ™å°±æ•°ç»„æ— æ³•è¢«GCå›æ”¶\n                oldTab[j] = null;\n                // å¦‚æœe.next==nullï¼Œä»£è¡¨æ¡¶ä¸­å°±ä¸€ä¸ªå…ƒç´ ï¼Œä¸å­˜åœ¨é“¾è¡¨æˆ–è€…çº¢é»‘æ ‘\n                if (e.next == null)\n                    // ç”¨åŒæ ·çš„hashæ˜ å°„ç®—æ³•æŠŠè¯¥å…ƒç´ åŠ å…¥æ–°çš„æ•°ç»„\n                    newTab[e.hash & (newCap - 1)] = e;\n                // å¦‚æœeæ˜¯TreeNodeå¹¶ä¸”e.next!=nullï¼Œé‚£ä¹ˆå¤„ç†æ ‘ä¸­å…ƒç´ çš„é‡æ’\n                else if (e instanceof TreeNode)\n                    ((TreeNode<K,V>)e).split(this, newTab, j, oldCap);\n                // eæ˜¯é“¾è¡¨çš„å¤´å¹¶ä¸”e.next!=nullï¼Œé‚£ä¹ˆå¤„ç†é“¾è¡¨ä¸­å…ƒç´ é‡æ’\n                else { // preserve order\n                    // loHead,loTail ä»£è¡¨æ‰©å®¹åä¸ç”¨å˜æ¢ä¸‹æ ‡ï¼Œè§æ³¨1\n                    Node<K,V> loHead = null, loTail = null;\n                    // hiHead,hiTail ä»£è¡¨æ‰©å®¹åå˜æ¢ä¸‹æ ‡ï¼Œè§æ³¨1\n                    Node<K,V> hiHead = null, hiTail = null;\n                    Node<K,V> next;\n                    // éå†é“¾è¡¨\n                    do {             \n                        next = e.next;\n                        if ((e.hash & oldCap) == 0) {\n                            if (loTail == null)\n                                // åˆå§‹åŒ–headæŒ‡å‘é“¾è¡¨å½“å‰å…ƒç´ eï¼Œeä¸ä¸€å®šæ˜¯é“¾è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œåˆå§‹åŒ–åloHead\n                                // ä»£è¡¨ä¸‹æ ‡ä¿æŒä¸å˜çš„é“¾è¡¨çš„å¤´å…ƒç´ \n                                loHead = e;\n                            else                                \n                                // loTail.nextæŒ‡å‘å½“å‰e\n                                loTail.next = e;\n                            // loTailæŒ‡å‘å½“å‰çš„å…ƒç´ e\n                            // åˆå§‹åŒ–åï¼ŒloTailå’ŒloHeadæŒ‡å‘ç›¸åŒçš„å†…å­˜ï¼Œæ‰€ä»¥å½“loTail.nextæŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œ\n                            // åº•å±‚æ•°ç»„ä¸­çš„å…ƒç´ çš„nextå¼•ç”¨ä¹Ÿç›¸åº”å‘ç”Ÿå˜åŒ–ï¼Œé€ æˆlowHead.next.next.....\n                            // è·ŸéšloTailåŒæ­¥ï¼Œä½¿å¾—lowHeadå¯ä»¥é“¾æ¥åˆ°æ‰€æœ‰å±äºè¯¥é“¾è¡¨çš„å…ƒç´ ã€‚\n                            loTail = e;                           \n                        }\n                        else {\n                            if (hiTail == null)\n                                // åˆå§‹åŒ–headæŒ‡å‘é“¾è¡¨å½“å‰å…ƒç´ e, åˆå§‹åŒ–åhiHeadä»£è¡¨ä¸‹æ ‡æ›´æ”¹çš„é“¾è¡¨å¤´å…ƒç´ \n                                hiHead = e;\n                            else\n                                hiTail.next = e;\n                            hiTail = e;\n                        }\n                    } while ((e = next) != null);\n                    // éå†ç»“æŸ, å°†tailæŒ‡å‘nullï¼Œå¹¶æŠŠé“¾è¡¨å¤´æ”¾å…¥æ–°æ•°ç»„çš„ç›¸åº”ä¸‹æ ‡ï¼Œå½¢æˆæ–°çš„æ˜ å°„ã€‚\n                    if (loTail != null) {\n                        loTail.next = null;\n                        newTab[j] = loHead;\n                    }\n                    if (hiTail != null) {\n                        hiTail.next = null;\n                        newTab[j + oldCap] = hiHead;\n                    }\n                }\n            }\n        }\n    }\n    return newTab;\n}\n```\n\n### HashMapè´Ÿè½½å› å­ä¸ºä»€ä¹ˆè®¾ç½®ä¸º 0.75?\n\nhashmap çš„æºç ä¸­æœ‰ä¸€æ®µæ³¨é‡Šè§£é‡Šäº†ä¸ºä»€ä¹ˆè®¾ç½®ä¸º 0.75ï¼Œæ˜¯**ç©ºé—´å’Œæ—¶é—´æ•ˆç‡çš„æŠ˜ä¸­è€ƒè™‘**ã€‚\n\n### èƒ½å¦ä½¿ç”¨ä»»ä½•ç±»ä½œä¸º Map çš„ keyï¼Ÿ\n\nå¯ä»¥ä½¿ç”¨ä»»ä½•ç±»ä½œä¸º Map çš„ keyï¼Œå‰ææ˜¯è¯¥ç±»é‡å†™äº† hashCode å’Œ equals æ–¹æ³•ã€‚é‡å†™ hashCode() æ˜¯ä¸ºäº†è®¡ç®—æ•°æ®çš„å­˜å‚¨ä½ç½®ï¼Œé‡å†™ equals æ–¹æ³•æ˜¯ä¸ºäº†ç¡®ä¿ key åœ¨å“ˆå¸Œè¡¨ä¸­çš„å”¯ä¸€æ€§ã€‚æœ€ç»ˆç›®çš„æ˜¯ä¸ºäº†ä¿è¯ Map ä¸­é”® key çš„å”¯ä¸€æ€§ã€‚\n\n### ä¸ºä»€ä¹ˆHashMapä¸­Stringã€Integerè¿™æ ·çš„åŒ…è£…ç±»é€‚åˆä½œä¸ºkeyï¼Ÿ\n\né‡å†™äº† hashCode å’Œ equals æ–¹æ³•ï¼Œä¿è¯äº† Map ä¸­é”®**keyçš„å”¯ä¸€æ€§**ã€‚å¹¶ä¸”ä»–ä»¬éƒ½ä¸å¯å˜ï¼Œå¯ä»¥å°†å®ƒä»¬çš„ hash å€¼**ç¼“å­˜ä¸‹æ¥ï¼Œæé«˜æ•ˆç‡**ã€‚\n\n### HashMap ä¸ HashTable æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\n1. **çº¿ç¨‹å®‰å…¨**ï¼š HashMap æ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼ŒHashTable æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå†…éƒ¨çš„æ–¹æ³•åŸºæœ¬éƒ½ç»è¿‡ `synchronized` ä¿®é¥°ï¼›\n2. **æ•ˆç‡**ï¼š å› ä¸ºçº¿ç¨‹å®‰å…¨çš„é—®é¢˜ synchronizedï¼ŒHashMap è¦æ¯” HashTable æ•ˆç‡é«˜ä¸€ç‚¹ï¼›\n3. **å¯¹Null key å’ŒNull valueçš„æ”¯æŒ**ï¼š HashMap ä¸­ï¼Œnull å¯ä»¥ä½œä¸ºé”®ï¼Œè¿™æ ·çš„é”®åªæœ‰ä¸€ä¸ªï¼Œå¯ä»¥æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªé”®æ‰€å¯¹åº”çš„å€¼ä¸º nullã€‚ä½†æ˜¯åœ¨ HashTable ä¸­ put è¿›çš„é”®å€¼åªè¦æœ‰ä¸€ä¸ª nullï¼Œç›´æ¥æŠ› NullPointerExceptionï¼›\n4. **åˆå§‹å®¹é‡å¤§å°å’Œæ¯æ¬¡æ‰©å……å®¹é‡å¤§å°çš„ä¸åŒ **ï¼š \n\tâ‘ åˆ›å»ºæ—¶å¦‚æœä¸æŒ‡å®šå®¹é‡åˆå§‹å€¼ï¼ŒHashTable é»˜è®¤çš„åˆå§‹å¤§å°ä¸º 11ï¼Œä¹‹åæ¯æ¬¡æ‰©å……ï¼Œå®¹é‡å˜ä¸ºåŸæ¥çš„ 2n+1ã€‚HashMap é»˜è®¤çš„åˆå§‹åŒ–å¤§å°ä¸º 16ã€‚ä¹‹åæ¯æ¬¡æ‰©å……ï¼Œå®¹é‡å˜ä¸ºåŸæ¥çš„ 2 å€ï¼›\n\tâ‘¡åˆ›å»ºæ—¶å¦‚æœç»™å®šäº†å®¹é‡åˆå§‹å€¼ï¼Œé‚£ä¹ˆ HashTable ä¼šç›´æ¥ä½¿ç”¨ä½ ç»™å®šçš„å¤§å°ï¼Œè€Œ HashMap ä¼šå°†å…¶æ‰©å……ä¸º 2 çš„å¹‚æ¬¡æ–¹å¤§å°ã€‚ä¹Ÿå°±æ˜¯è¯´ HashMap æ€»æ˜¯ä½¿ç”¨ 2 çš„å¹‚ä½œä¸ºå“ˆå¸Œè¡¨çš„å¤§å°ï¼›\n5. **åº•å±‚æ•°æ®ç»“æ„**ï¼š JDK1.8 ä»¥åçš„ HashMap åœ¨è§£å†³å“ˆå¸Œå†²çªæ—¶æœ‰äº†è¾ƒå¤§çš„å˜åŒ–ï¼Œå½“é“¾è¡¨é•¿åº¦å¤§äºé˜ˆå€¼ï¼ˆé»˜è®¤ä¸º 8ï¼‰æ—¶ï¼Œå°†é“¾è¡¨è½¬åŒ–ä¸ºçº¢é»‘æ ‘ï¼Œä»¥å‡å°‘æœç´¢æ—¶é—´ã€‚HashTable æ²¡æœ‰è¿™æ ·çš„æœºåˆ¶ã€‚\n\n### ConcurrentHashMap å’Œ HashTable çš„åŒºåˆ«ï¼Ÿ\n\nConcurrentHashMap å’Œ HashTable çš„åŒºåˆ«ä¸»è¦ä½“ç°åœ¨å®ç°çº¿ç¨‹å®‰å…¨çš„æ–¹å¼ä¸Šä¸åŒã€‚\n\n- **åº•å±‚æ•°æ®ç»“æ„**ï¼š \n\tJDK1.7 çš„ ConcurrentHashMap åº•å±‚é‡‡ç”¨ **åˆ†æ®µçš„æ•°ç»„+é“¾è¡¨** å®ç°ï¼ŒJDK1.8 é‡‡ç”¨çš„æ•°æ®ç»“æ„è·Ÿ HashMap1.8 çš„ç»“æ„ä¸€æ ·ï¼Œæ•°ç»„+é“¾è¡¨/çº¢é»‘äºŒå‰æ ‘ã€‚\n\tHashTable å’Œ JDK1.8 ä¹‹å‰çš„ HashMap çš„åº•å±‚æ•°æ®ç»“æ„ç±»ä¼¼éƒ½æ˜¯é‡‡ç”¨ **æ•°ç»„+é“¾è¡¨** çš„å½¢å¼ï¼Œæ•°ç»„æ˜¯ HashMap çš„ä¸»ä½“ï¼Œé“¾è¡¨åˆ™æ˜¯ä¸»è¦ä¸ºäº†è§£å†³å“ˆå¸Œå†²çªè€Œå­˜åœ¨çš„ï¼›\n- **å®ç°çº¿ç¨‹å®‰å…¨çš„æ–¹å¼ï¼ˆé‡è¦ï¼‰**ï¼š \n\tâ‘  **åœ¨JDK1.7çš„æ—¶å€™ï¼ŒConcurrentHashMapä½¿ç”¨åˆ†æ®µé”** å¯¹æ•´ä¸ªæ¡¶æ•°ç»„è¿›è¡Œäº†åˆ†å‰²åˆ†æ®µ(Segment é”ç»§æ‰¿ ReentrantLock)ï¼Œæ¯ä¸€æŠŠé”åªé”å®¹å™¨å…¶ä¸­ä¸€éƒ¨åˆ†æ•°æ®ï¼Œå¤šçº¿ç¨‹è®¿é—®å®¹å™¨é‡Œä¸åŒæ•°æ®æ®µçš„æ•°æ®ï¼Œå°±ä¸ä¼šå­˜åœ¨é”ç«äº‰ï¼Œæé«˜å¹¶å‘è®¿é—®ç‡ã€‚ï¼ˆé»˜è®¤åˆ†é… 16 ä¸ª Segmentï¼Œæ¯” HashTable æ•ˆç‡æé«˜ 16 å€ã€‚ï¼‰\n\t**åˆ°äº† JDK1.8 çš„æ—¶å€™å·²ç»æ‘’å¼ƒäº†Segmentçš„æ¦‚å¿µï¼Œè€Œæ˜¯ç›´æ¥ç”¨ Node æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘çš„æ•°æ®ç»“æ„æ¥å®ç°ï¼Œå¹¶å‘æ§åˆ¶ä½¿ç”¨ synchronized å’Œ CAS æ¥æ“ä½œï¼Œsynchronizedåªé”å®šå½“å‰é“¾è¡¨æˆ–çº¢é»‘æ ‘çš„é¦–èŠ‚ç‚¹ã€‚ï¼ˆJDK1.6ä»¥å å¯¹ synchronizedé”åšäº†å¾ˆå¤šä¼˜åŒ–ï¼‰** æ•´ä¸ªçœ‹èµ·æ¥å°±åƒæ˜¯ä¼˜åŒ–è¿‡ä¸”çº¿ç¨‹å®‰å…¨çš„ HashMap\n\tâ‘¡ **HashTable(å…¨è¡¨é”)** :ä½¿ç”¨ synchronized æ¥ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œæ•ˆç‡éå¸¸ä½ä¸‹ã€‚å½“ä¸€ä¸ªçº¿ç¨‹è®¿é—®åŒæ­¥æ–¹æ³•æ—¶ï¼Œå…¶ä»–çº¿ç¨‹ä¹Ÿè®¿é—®åŒæ­¥æ–¹æ³•ï¼Œå¯èƒ½ä¼šè¿›å…¥é˜»å¡æˆ–è½®è¯¢çŠ¶æ€ï¼Œå¦‚ä½¿ç”¨ put æ·»åŠ å…ƒç´ ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¸èƒ½ä½¿ç”¨ put æ·»åŠ å…ƒç´ ï¼Œä¹Ÿä¸èƒ½ä½¿ç”¨ getï¼Œç«äº‰ä¼šè¶Šæ¥è¶Šæ¿€çƒˆæ•ˆç‡è¶Šä½ã€‚\n- â­**Jdk1.7é‡‡ç”¨åˆ†æ®µé”ï¼Œé”ç²’åº¦è¾ƒå¤§ï¼Œå®¹æ˜“å‘ç”Ÿå†²çªï¼Œå¹¶å‘é‡ä½ï¼›å› æ­¤ Jdk1.8 é‡‡ç”¨åªé”å®šæ¡¶çš„é¦–ç»“ç‚¹ï¼Œé”çš„åŠ›åº¦è¾ƒä½ï¼Œä¸å®¹æ˜“å‘ç”Ÿå†²çªï¼Œå¹¶å‘é‡é«˜ã€‚**\n\n**ä¸¤è€…çš„å¯¹æ¯”å›¾**ï¼š\n\nHashTable:\n\n![HashTableå…¨è¡¨é”](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOC84LzIzLzE2NTY2NzdhNmYyNTYxOTY.png)\n\nJDK1.7 çš„ ConcurrentHashMapï¼š\n\n![JDK1.7çš„ConcurrentHashMapåˆ†æ®µé”](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOC84LzIzLzE2NTY2NzdhNmYwMDhiZTQ.png)\n\nJDK1.8 çš„ ConcurrentHashMapï¼ˆTreeBin: çº¢é»‘äºŒå‰æ ‘èŠ‚ç‚¹ Node: é“¾è¡¨èŠ‚ç‚¹ï¼‰ï¼š\n\n![JDK1.8çš„ConcurrentHashMapåˆ†æ®µé”](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOC84LzIzLzE2NTY2NzdhNmYxNGUwMzk.png)\n","slug":"Javaå…«è‚¡æ–‡ - Javaé›†åˆ","published":1,"updated":"2023-01-26T12:35:58.974Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cldzfw320000et9t827tqb6pj","content":"<blockquote>\n<p>æ•´ç†çš„Javaé›†åˆç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½\t<span id=\"more\"></span></p>\n</blockquote>\n<h2 id=\"é›†åˆå®¹å™¨æ¦‚è¿°\"><a href=\"#é›†åˆå®¹å™¨æ¦‚è¿°\" class=\"headerlink\" title=\"é›†åˆå®¹å™¨æ¦‚è¿°\"></a>é›†åˆå®¹å™¨æ¦‚è¿°</h2><h3 id=\"ä»€ä¹ˆæ˜¯é›†åˆ\"><a href=\"#ä»€ä¹ˆæ˜¯é›†åˆ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯é›†åˆ\"></a>ä»€ä¹ˆæ˜¯é›†åˆ</h3><p>ç”¨äºå­˜å‚¨æ•°æ®çš„å®¹å™¨ã€‚</p>\n<h3 id=\"é›†åˆå’Œæ•°ç»„çš„åŒºåˆ«\"><a href=\"#é›†åˆå’Œæ•°ç»„çš„åŒºåˆ«\" class=\"headerlink\" title=\"é›†åˆå’Œæ•°ç»„çš„åŒºåˆ«\"></a>é›†åˆå’Œæ•°ç»„çš„åŒºåˆ«</h3><ul>\n<li>æ•°ç»„æ˜¯å›ºå®šé•¿åº¦çš„ï¼›é›†åˆå¯å˜é•¿åº¦çš„ã€‚</li>\n<li>æ•°ç»„å¯ä»¥å­˜å‚¨åŸºæœ¬æ•°æ®ç±»å‹ï¼Œä¹Ÿå¯ä»¥å­˜å‚¨å¼•ç”¨æ•°æ®ç±»å‹ï¼›é›†åˆåªèƒ½å­˜å‚¨å¼•ç”¨æ•°æ®ç±»å‹ã€‚</li>\n</ul>\n<h3 id=\"å¸¸ç”¨çš„é›†åˆç±»æœ‰å“ªäº›ï¼Ÿ\"><a href=\"#å¸¸ç”¨çš„é›†åˆç±»æœ‰å“ªäº›ï¼Ÿ\" class=\"headerlink\" title=\"å¸¸ç”¨çš„é›†åˆç±»æœ‰å“ªäº›ï¼Ÿ\"></a>å¸¸ç”¨çš„é›†åˆç±»æœ‰å“ªäº›ï¼Ÿ</h3><p>Collection æ¥å£å’Œ Map æ¥å£æ˜¯æ‰€æœ‰é›†åˆæ¡†æ¶çš„çˆ¶æ¥å£ã€‚</p>\n<p>Collection æ¥å£ï¼šå­æ¥å£åŒ…æ‹¬ Set æ¥å£å’Œ List æ¥å£</p>\n<ol>\n<li>Set æ¥å£çš„å®ç°ç±»ä¸»è¦æœ‰ï¼šHashSetã€TreeSetã€LinkedHashSet ç­‰ï¼›</li>\n<li>List æ¥å£çš„å®ç°ç±»ä¸»è¦æœ‰ï¼šArrayListã€LinkedListã€Stack ä»¥åŠ Vector ç­‰ã€‚</li>\n</ol>\n<p>Map æ¥å£ï¼šå®ç°ç±»ä¸»è¦æœ‰ HashMapã€TreeMapã€HashTableã€ConcurrentHashMap ä»¥åŠ Properties ç­‰ã€‚</p>\n<h3 id=\"Listã€Setã€Mapä¸‰è€…çš„åŒºåˆ«ï¼Ÿ\"><a href=\"#Listã€Setã€Mapä¸‰è€…çš„åŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"Listã€Setã€Mapä¸‰è€…çš„åŒºåˆ«ï¼Ÿ\"></a>Listã€Setã€Mapä¸‰è€…çš„åŒºåˆ«ï¼Ÿ</h3><p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly9pbWcyMDE4LmNuYmxvZ3MuY29tL290aGVyLzE0MDgxODMvMjAxOTExLzE0MDgxODMtMjAxOTExMTkxODQxNDk1NTktMTU3MTU5NTY2OC5qcGc.png\" alt=\"Collectionæ¶æ„\"></p>\n<p>List å’Œ Set ä¸¤å¤§æ¥å£æ˜¯ Collection çš„å­æ¥å£</p>\n<ul>\n<li><p>Listï¼šæœ‰åºå®¹å™¨ï¼Œå…ƒç´ å¯ä»¥é‡å¤ï¼Œå¯ä»¥æ’å…¥å¤šä¸ª null å…ƒç´ ï¼Œå…ƒç´ éƒ½æœ‰ç´¢å¼•ï¼›<br>  å¸¸ç”¨å®ç°ç±»ï¼šArrayListã€LinkedList å’Œ Vectorã€‚</p>\n</li>\n<li><p>Setï¼šæ— åºå®¹å™¨ï¼Œä¸å¯ä»¥å­˜å‚¨é‡å¤å…ƒç´ ï¼Œåªå…è®¸å­˜å…¥ä¸€ä¸ª null å…ƒç´ ï¼Œå¿…é¡»ä¿è¯å…ƒç´ å”¯ä¸€æ€§ï¼›</p>\n<p>  å¸¸ç”¨å®ç°ç±»ï¼šHashSetã€LinkedHashSet ä»¥åŠ TreeSetã€‚</p>\n</li>\n</ul>\n<ul>\n<li><p>Map æ˜¯ä¸€ä¸ªé”®å€¼å¯¹é›†åˆï¼Œå­˜å‚¨é”®ã€å€¼å’Œä¹‹é—´çš„æ˜ å°„ã€‚ key æ— åºï¼Œå”¯ä¸€ï¼›value ä¸è¦æ±‚æœ‰åºï¼Œå…è®¸é‡å¤ï¼›</p>\n<p>  å¸¸ç”¨å®ç°ç±»ï¼šHashMapã€TreeMapã€HashTableã€LinkedHashMapã€ConcurrentHashMapã€‚</p>\n</li>\n</ul>\n<h3 id=\"é›†åˆæ¡†æ¶åº•å±‚æ•°æ®ç»“æ„\"><a href=\"#é›†åˆæ¡†æ¶åº•å±‚æ•°æ®ç»“æ„\" class=\"headerlink\" title=\"é›†åˆæ¡†æ¶åº•å±‚æ•°æ®ç»“æ„\"></a>é›†åˆæ¡†æ¶åº•å±‚æ•°æ®ç»“æ„</h3><h4 id=\"Collection\"><a href=\"#Collection\" class=\"headerlink\" title=\"Collection\"></a>Collection</h4><ol>\n<li>List</li>\n</ol>\n<ul>\n<li>Arraylistï¼š Object æ•°ç»„</li>\n<li>Vectorï¼š Object æ•°ç»„</li>\n<li>LinkedListï¼š åŒå‘é“¾è¡¨</li>\n</ul>\n<ol start=\"2\">\n<li>Set</li>\n</ol>\n<ul>\n<li>HashSetï¼ˆæ— åºï¼Œå”¯ä¸€ï¼‰ï¼šåŸºäº HashMap å®ç°çš„ï¼Œåº•å±‚é‡‡ç”¨ HashMap æ¥ä¿å­˜å…ƒç´ </li>\n<li>LinkedHashSetï¼š LinkedHashSet ç»§æ‰¿äº HashSetï¼Œå¹¶ä¸”å…¶å†…éƒ¨æ˜¯é€šè¿‡ LinkedHashMap æ¥å®ç°çš„ã€‚</li>\n<li>TreeSetï¼ˆæœ‰åºï¼Œå”¯ä¸€ï¼‰ï¼š çº¢é»‘æ ‘(è‡ªå¹³è¡¡çš„æ’åºäºŒå‰æ ‘)</li>\n</ul>\n<h4 id=\"Map\"><a href=\"#Map\" class=\"headerlink\" title=\"Map\"></a>Map</h4><ul>\n<li>HashMapï¼š JDK1.8 ä¹‹å‰ HashMap ç”±æ•°ç»„+é“¾è¡¨ç»„æˆçš„ï¼Œæ•°ç»„æ˜¯ HashMap çš„ä¸»ä½“ï¼Œé“¾è¡¨åˆ™æ˜¯ä¸»è¦ä¸ºäº†è§£å†³å“ˆå¸Œå†²çªè€Œå­˜åœ¨çš„ï¼ˆâ€œæ‹‰é“¾æ³•â€è§£å†³å†²çªï¼‰ã€‚JDK1.8 ä»¥ååœ¨è§£å†³å“ˆå¸Œå†²çªæ—¶æœ‰äº†è¾ƒå¤§çš„å˜åŒ–ï¼Œå½“é“¾è¡¨é•¿åº¦å¤§äºé˜ˆå€¼ï¼ˆé»˜è®¤ä¸º 8ï¼‰ï¼Œä¸”æ•°ç»„é•¿åº¦å¤§äº 64ï¼Œå°†é“¾è¡¨è½¬åŒ–ä¸ºçº¢é»‘æ ‘ï¼Œä»¥å‡å°‘æœç´¢æ—¶é—´ï¼Œå¦åˆ™æ‰©å®¹æ•°ç»„ã€‚</li>\n<li>LinkedHashMapï¼šLinkedHashMap ç»§æ‰¿è‡ª HashMapï¼Œæ‰€ä»¥å®ƒçš„åº•å±‚ç”±æ•°ç»„å’Œé“¾è¡¨æˆ–çº¢é»‘æ ‘ç»„æˆã€‚å¦å¤–ï¼ŒLinkedHashMap åœ¨ä¸Šé¢ç»“æ„çš„åŸºç¡€ä¸Šï¼Œå¢åŠ äº†ä¸€æ¡åŒå‘é“¾è¡¨ï¼Œä½¿å¾—ä¸Šé¢çš„ç»“æ„å¯ä»¥ä¿æŒé”®å€¼å¯¹çš„æ’å…¥é¡ºåºã€‚åŒæ—¶é€šè¿‡å¯¹é“¾è¡¨è¿›è¡Œç›¸åº”çš„æ“ä½œï¼Œå®ç°äº†è®¿é—®é¡ºåºç›¸å…³é€»è¾‘ã€‚</li>\n<li>HashTableï¼š æ•°ç»„+é“¾è¡¨ç»„æˆçš„ï¼Œæ•°ç»„æ˜¯ HashMap çš„ä¸»ä½“ï¼Œé“¾è¡¨åˆ™æ˜¯ä¸»è¦ä¸ºäº†è§£å†³å“ˆå¸Œå†²çªè€Œå­˜åœ¨çš„</li>\n<li>TreeMapï¼š çº¢é»‘æ ‘ï¼ˆè‡ªå¹³è¡¡çš„æ’åºäºŒå‰æ ‘ï¼‰</li>\n</ul>\n<h3 id=\"å“ªäº›é›†åˆç±»æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Ÿ\"><a href=\"#å“ªäº›é›†åˆç±»æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Ÿ\" class=\"headerlink\" title=\"å“ªäº›é›†åˆç±»æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Ÿ\"></a>å“ªäº›é›†åˆç±»æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Ÿ</h3><p>vector å’Œ hashtableï¼Œé€šè¿‡åœ¨æ–¹æ³•ä¸ŠåŠ  synchronized å…³é”®å­—å®ç°çº¿ç¨‹å®‰å…¨</p>\n<h3 id=\"Javaé›†åˆçš„å¿«é€Ÿå¤±è´¥æœºåˆ¶-â€œfail-fastâ€ï¼Ÿ\"><a href=\"#Javaé›†åˆçš„å¿«é€Ÿå¤±è´¥æœºåˆ¶-â€œfail-fastâ€ï¼Ÿ\" class=\"headerlink\" title=\"Javaé›†åˆçš„å¿«é€Ÿå¤±è´¥æœºåˆ¶ â€œfail-fastâ€ï¼Ÿ\"></a>Javaé›†åˆçš„å¿«é€Ÿå¤±è´¥æœºåˆ¶ â€œfail-fastâ€ï¼Ÿ</h3><p>fail-fast æ˜¯ Java é›†åˆçš„ä¸€ç§<strong>é”™è¯¯æ£€æµ‹æœºåˆ¶</strong>ï¼Œå½“å¤šä¸ªçº¿ç¨‹å¯¹åŒä¸€ä¸ªé›†åˆçš„å†…å®¹è¿›è¡Œæ“ä½œæ—¶ï¼Œå°±å¯èƒ½ä¼šäº§ç”Ÿ fail-fast äº‹ä»¶ã€‚</p>\n<p>ä¾‹å¦‚ï¼šå‡è®¾å­˜åœ¨ä¸¤ä¸ªçº¿ç¨‹ï¼ˆçº¿ç¨‹ 1ã€çº¿ç¨‹ 2ï¼‰ï¼Œçº¿ç¨‹ 1 é€šè¿‡ Iterator åœ¨éå†é›†åˆ A ä¸­çš„å…ƒç´ ï¼Œåœ¨æŸä¸ªæ—¶å€™çº¿ç¨‹ 2 ä¿®æ”¹äº†é›†åˆ A çš„ç»“æ„ï¼ˆaddã€removeã€clear ç­‰ç»“æ„ä¸Šçš„ä¿®æ”¹ï¼Œè€Œä¸æ˜¯ç®€å•çš„ä¿®æ”¹é›†åˆå…ƒç´ çš„å†…å®¹ï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™ç¨‹åºå°±ä¼šæŠ›å‡º <strong>ConcurrentModificationException</strong> å¼‚å¸¸ï¼Œä»è€Œäº§ç”Ÿ fail-fast äº‹ä»¶ã€‚</p>\n<p>åŸå› ï¼šè¿­ä»£å™¨åœ¨éå†æ—¶ç›´æ¥è®¿é—®é›†åˆä¸­çš„å†…å®¹ï¼Œå¹¶ä¸”åœ¨éå†è¿‡ç¨‹ä¸­ä½¿ç”¨ä¸€ä¸ª modCount å˜é‡ã€‚æ¯å½“è¿­ä»£å™¨ä½¿ç”¨ hashNext()&#x2F;next()éå†ä¸‹ä¸€ä¸ªå…ƒç´ ä¹‹å‰ï¼Œéƒ½ä¼šæ£€æµ‹ modCount å˜é‡æ˜¯å¦ä¸º expectedmodCount å€¼ï¼Œæ˜¯çš„è¯å°±è¿”å›éå†ï¼›å¦åˆ™æŠ›å‡ºå¼‚å¸¸ï¼Œç»ˆæ­¢éå†ã€‚é›†åˆåœ¨è¢«éå†æœŸé—´å¦‚æœå†…å®¹å‘ç”Ÿå˜åŒ–ï¼Œå°±ä¼šæ”¹å˜ modCount çš„å€¼ï¼Œä»è€Œ modCount ä¸ç­‰äº expectedmodCount å€¼æŠ›å‡ºå¼‚å¸¸ï¼Œä¹Ÿå°±æ˜¯äº§ç”Ÿäº† fail-fast äº‹ä»¶ã€‚</p>\n<p>è§£å†³åŠæ³•ï¼š</p>\n<ol>\n<li>åœ¨éå†è¿‡ç¨‹ä¸­ï¼Œæ‰€æœ‰æ¶‰åŠåˆ°æ”¹å˜ modCount å€¼çš„åœ°æ–¹å…¨éƒ¨åŠ ä¸Š synchronizedï¼›</li>\n<li>ä½¿ç”¨ Java.util.concurrent ä¸‹çš„ CopyOnWriteArrayList æ¥æ›¿æ¢ ArrayListï¼›</li>\n<li>ä½¿ç”¨ Java.util.concurrent ä¸‹çš„ ConcurrentHashMap æ¥æ›¿æ¢ HashMapã€‚</li>\n</ol>\n<h3 id=\"æ€ä¹ˆç¡®ä¿ä¸€ä¸ªé›†åˆä¸èƒ½è¢«ä¿®æ”¹ï¼Ÿ\"><a href=\"#æ€ä¹ˆç¡®ä¿ä¸€ä¸ªé›†åˆä¸èƒ½è¢«ä¿®æ”¹ï¼Ÿ\" class=\"headerlink\" title=\"æ€ä¹ˆç¡®ä¿ä¸€ä¸ªé›†åˆä¸èƒ½è¢«ä¿®æ”¹ï¼Ÿ\"></a>æ€ä¹ˆç¡®ä¿ä¸€ä¸ªé›†åˆä¸èƒ½è¢«ä¿®æ”¹ï¼Ÿ</h3><p>å¯ä»¥ä½¿ç”¨ Collections. unmodifiableCollection(Collection c) æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªåªè¯»é›†åˆï¼Œè¿™æ ·æ”¹å˜é›†åˆçš„ä»»ä½•æ“ä½œéƒ½ä¼šæŠ›å‡º Java. lang. UnsupportedOperationException å¼‚å¸¸ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">List&lt;String&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;&gt;();</span><br><span class=\"line\">list. add(<span class=\"string\">&quot;x&quot;</span>);</span><br><span class=\"line\">Collection&lt;String&gt; clist = Collections. unmodifiableCollection(list);</span><br><span class=\"line\">clist.add(<span class=\"string\">&quot;y&quot;</span>); <span class=\"comment\">// è¿è¡Œæ—¶æ­¤è¡ŒæŠ¥é”™</span></span><br><span class=\"line\">System.out.println(list. size());</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Collectionæ¥å£\"><a href=\"#Collectionæ¥å£\" class=\"headerlink\" title=\"Collectionæ¥å£\"></a>Collectionæ¥å£</h2><h3 id=\"Listæ¥å£\"><a href=\"#Listæ¥å£\" class=\"headerlink\" title=\"Listæ¥å£\"></a>Listæ¥å£</h3><h4 id=\"è¿­ä»£å™¨-Iterator-æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#è¿­ä»£å™¨-Iterator-æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"è¿­ä»£å™¨ Iterator æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>è¿­ä»£å™¨ Iterator æ˜¯ä»€ä¹ˆï¼Ÿ</h4><p>Collection æ¥å£å®ç°äº† Iterable æ¥å£ï¼Œé€šè¿‡å®ç° Iterable æ¥å£ä¸­çš„ iterator()æ–¹æ³•è¿”å› Iterator æ¥å£çš„å®ä¾‹ï¼Œé€šè¿‡ iterator å¯¹é›†åˆçš„å…ƒç´ è¿›è¡Œè¿­ä»£æ“ä½œã€‚</p>\n<h4 id=\"Iterator-æ€ä¹ˆä½¿ç”¨ï¼Ÿæœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ\"><a href=\"#Iterator-æ€ä¹ˆä½¿ç”¨ï¼Ÿæœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ\" class=\"headerlink\" title=\"Iterator æ€ä¹ˆä½¿ç”¨ï¼Ÿæœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ\"></a>Iterator æ€ä¹ˆä½¿ç”¨ï¼Ÿæœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">List&lt;String&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;&gt;();</span><br><span class=\"line\">Iterator&lt;String&gt; it = list.iterator();</span><br><span class=\"line\"><span class=\"keyword\">while</span>(it.hasNext())&#123;</span><br><span class=\"line\">    <span class=\"type\">String</span> <span class=\"variable\">obj</span> <span class=\"operator\">=</span> it.next();</span><br><span class=\"line\">    System.out.println(obj);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Iterator çš„ç‰¹ç‚¹æ˜¯åªèƒ½å•å‘éå†ï¼Œä½†æ˜¯æ›´åŠ å®‰å…¨ï¼Œå› ä¸ºå®ƒå¯ä»¥ç¡®ä¿ï¼Œåœ¨å½“å‰éå†çš„é›†åˆå…ƒç´ è¢«æ›´æ”¹çš„æ—¶å€™ï¼Œå°±ä¼šæŠ›å‡º ConcurrentModificationException å¼‚å¸¸ã€‚</p>\n<h4 id=\"å¦‚ä½•è¾¹éå†è¾¹ç§»é™¤-Collection-ä¸­çš„å…ƒç´ ï¼Ÿ\"><a href=\"#å¦‚ä½•è¾¹éå†è¾¹ç§»é™¤-Collection-ä¸­çš„å…ƒç´ ï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•è¾¹éå†è¾¹ç§»é™¤ Collection ä¸­çš„å…ƒç´ ï¼Ÿ\"></a>å¦‚ä½•è¾¹éå†è¾¹ç§»é™¤ Collection ä¸­çš„å…ƒç´ ï¼Ÿ</h4><p>è¾¹éå†è¾¹ä¿®æ”¹ Collection çš„å”¯ä¸€æ­£ç¡®æ–¹å¼æ˜¯ä½¿ç”¨ Iterator.remove() æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Iterator&lt;Integer&gt; it = list.iterator();</span><br><span class=\"line\"><span class=\"keyword\">while</span>(it.hasNext())&#123;</span><br><span class=\"line\">   <span class=\"comment\">// do something</span></span><br><span class=\"line\">   it.remove();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>ä¸€ç§æœ€å¸¸è§çš„<strong>é”™è¯¯</strong>ä»£ç å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">List&lt;String&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;&gt;();</span><br><span class=\"line\">list.add(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">list.add(<span class=\"string\">&quot;2&quot;</span>);</span><br><span class=\"line\">list.add(<span class=\"string\">&quot;3&quot;</span>);</span><br><span class=\"line\">list.add(<span class=\"string\">&quot;4&quot;</span>);</span><br><span class=\"line\">list.add(<span class=\"string\">&quot;5&quot;</span>);</span><br><span class=\"line\"><span class=\"type\">int</span> <span class=\"variable\">cnt</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"keyword\">for</span> (String item : list) &#123;</span><br><span class=\"line\">  System.out.println(++cnt);</span><br><span class=\"line\">  list.remove(item);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">System.out.println(Arrays.toString(list.toArray()));</span><br></pre></td></tr></table></figure>\n\n<p>è¿è¡Œä»¥ä¸Šé”™è¯¯ä»£ç ä¼šæŠ¥ <strong>ConcurrentModificationException å¼‚å¸¸</strong>ã€‚<br>è¿™æ˜¯å› ä¸ºå½“ä½¿ç”¨ foreach(for(Integer i : list)) è¯­å¥æ—¶ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª iterator æ¥éå†è¯¥ listï¼Œä½†åŒæ—¶è¯¥ list æ­£åœ¨è¢« Iterator.remove() ä¿®æ”¹ã€‚é›†åˆå‘ç”Ÿç»“æ„æ€§å˜åŒ–ï¼Œæ ¹æ® fail-fast æœºåˆ¶ï¼Œä¼šæŠ›å¼‚å¸¸ã€‚</p>\n<h4 id=\"éå†ä¸€ä¸ª-List-æœ‰å“ªäº›ä¸åŒçš„æ–¹å¼ï¼Ÿ\"><a href=\"#éå†ä¸€ä¸ª-List-æœ‰å“ªäº›ä¸åŒçš„æ–¹å¼ï¼Ÿ\" class=\"headerlink\" title=\"éå†ä¸€ä¸ª List æœ‰å“ªäº›ä¸åŒçš„æ–¹å¼ï¼Ÿ\"></a>éå†ä¸€ä¸ª List æœ‰å“ªäº›ä¸åŒçš„æ–¹å¼ï¼Ÿ</h4><ol>\n<li>for å¾ªç¯ï¼Œç»´æŠ¤ä¸€ä¸ªè®¡æ•°å™¨ï¼›</li>\n<li>è¿­ä»£å™¨ï¼ŒIteratorã€‚Collection æ¥å£å®ç°äº† Iterable æ¥å£ï¼Œé€šè¿‡å®ç° Iterable æ¥å£ä¸­çš„ iterator()æ–¹æ³•è¿”å› Iterator æ¥å£çš„å®ä¾‹ï¼Œé€šè¿‡ iterator å¯¹é›†åˆçš„å…ƒç´ è¿›è¡Œè¿­ä»£æ“ä½œï¼›</li>\n<li>å¢å¼º for å¾ªç¯ã€‚å¢å¼º for å¾ªç¯ foreach å†…éƒ¨ä¹Ÿæ˜¯é‡‡ç”¨äº† Iterator çš„æ–¹å¼å®ç°ï¼Œä½¿ç”¨æ—¶ä¸éœ€è¦æ˜¾å¼å£°æ˜ Iterator æˆ–è®¡æ•°å™¨ã€‚<br> ä¼˜ç‚¹æ˜¯ä»£ç ç®€æ´ï¼Œä¸æ˜“å‡ºé”™ï¼›ç¼ºç‚¹æ˜¯åªèƒ½åšç®€å•çš„éå†ï¼Œä¸èƒ½åœ¨éå†è¿‡ç¨‹ä¸­æ“ä½œæ•°æ®é›†åˆï¼Œä¾‹å¦‚åˆ é™¤ã€æ›¿æ¢ã€‚</li>\n</ol>\n<h4 id=\"è¯´ä¸€ä¸‹-ArrayList-çš„ä¼˜ç¼ºç‚¹\"><a href=\"#è¯´ä¸€ä¸‹-ArrayList-çš„ä¼˜ç¼ºç‚¹\" class=\"headerlink\" title=\"è¯´ä¸€ä¸‹ ArrayList çš„ä¼˜ç¼ºç‚¹\"></a>è¯´ä¸€ä¸‹ ArrayList çš„ä¼˜ç¼ºç‚¹</h4><p><strong>ArrayList æ¯”è¾ƒé€‚åˆé¡ºåºæ·»åŠ ã€éšæœºè®¿é—®çš„åœºæ™¯ã€‚</strong></p>\n<p>ArrayList çš„ä¼˜ç‚¹å¦‚ä¸‹ï¼š</p>\n<ul>\n<li>ArrayList åº•å±‚ä»¥æ•°ç»„å®ç°ï¼Œæ˜¯ä¸€ç§éšæœºè®¿é—®æ¨¡å¼ã€‚ArrayList å®ç°äº† RandomAccess æ¥å£ï¼Œæ ‡è®° List å®ç°æ˜¯å¦æ”¯æŒ Random Accessï¼Œå¯¼è‡´å®ƒå¯ä»¥éšæœºè®¿é—®çš„æ ¹æœ¬åŸå› æ˜¯å®ƒåº•å±‚æ˜¯æ•°ç»„ç»“æ„ï¼Œæ•°ç»„å¯ä»¥é€šè¿‡ä¸‹æ ‡è·å–ç›¸åº”çš„å€¼ï¼Œè€Œ RandomAccess åªæ˜¯ä¸€ä¸ªæ ‡è®°ã€‚å› æ­¤æŸ¥æ‰¾çš„æ—¶å€™éå¸¸å¿«ã€‚å¯ä»¥ç”¨ for å¾ªç¯é€šè¿‡ä¸‹æ ‡è·å–å…ƒç´ ã€‚</li>\n<li>ArrayList åœ¨é¡ºåºæ·»åŠ ä¸€ä¸ªå…ƒç´ çš„æ—¶å€™éå¸¸æ–¹ä¾¿ã€‚</li>\n</ul>\n<p>ArrayList çš„ç¼ºç‚¹å¦‚ä¸‹ï¼š</p>\n<ul>\n<li>å‘<strong>ä¸­é—´æŸä¸ªä½ç½®åˆ é™¤</strong>å…ƒç´ çš„æ—¶å€™ï¼Œéœ€è¦åšå…ƒç´ å¤åˆ¶æ“ä½œã€‚å¦‚æœè¦å¤åˆ¶çš„å…ƒç´ å¾ˆå¤šï¼Œé‚£ä¹ˆå°±ä¼šæ¯”è¾ƒè€—è´¹æ€§èƒ½ï¼›</li>\n<li>å‘<strong>ä¸­é—´æŸä¸ªä½ç½®æ’å…¥</strong>å…ƒç´ çš„æ—¶å€™ï¼Œä¹Ÿéœ€è¦åšå…ƒç´ å¤åˆ¶æ“ä½œï¼Œç¼ºç‚¹åŒä¸Šã€‚</li>\n</ul>\n<h4 id=\"å¦‚ä½•å®ç°æ•°ç»„å’Œ-List-ä¹‹é—´çš„è½¬æ¢ï¼Ÿ\"><a href=\"#å¦‚ä½•å®ç°æ•°ç»„å’Œ-List-ä¹‹é—´çš„è½¬æ¢ï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•å®ç°æ•°ç»„å’Œ List ä¹‹é—´çš„è½¬æ¢ï¼Ÿ\"></a>å¦‚ä½•å®ç°æ•°ç»„å’Œ List ä¹‹é—´çš„è½¬æ¢ï¼Ÿ</h4><ul>\n<li>æ•°ç»„è½¬ Listï¼šä½¿ç”¨ Arrays. asList(array) è¿›è¡Œè½¬æ¢ã€‚</li>\n<li>List è½¬æ•°ç»„ï¼šä½¿ç”¨ List è‡ªå¸¦çš„ toArray() æ–¹æ³•ã€‚</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// list to array</span></span><br><span class=\"line\">List&lt;String&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;String&gt;();</span><br><span class=\"line\">list.add(<span class=\"string\">&quot;123&quot;</span>);</span><br><span class=\"line\">list.add(<span class=\"string\">&quot;456&quot;</span>);</span><br><span class=\"line\">list.toArray(<span class=\"keyword\">new</span> <span class=\"title class_\">String</span>[<span class=\"number\">0</span>]);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// array to list</span></span><br><span class=\"line\">String[] array = <span class=\"keyword\">new</span> <span class=\"title class_\">String</span>[]&#123;<span class=\"string\">&quot;123&quot;</span>, <span class=\"string\">&quot;456&quot;</span>&#125;;</span><br><span class=\"line\">Arrays.asList(array);</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"ArrayList-å’Œ-LinkedList-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#ArrayList-å’Œ-LinkedList-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"ArrayList å’Œ LinkedList çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>ArrayList å’Œ LinkedList çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h4><ul>\n<li>åº•å±‚å®ç°ï¼šArrayList æ˜¯åŠ¨æ€æ•°ç»„çš„æ•°æ®ç»“æ„å®ç°ï¼Œè€Œ LinkedList æ˜¯åŒå‘é“¾è¡¨çš„æ•°æ®ç»“æ„å®ç°ï¼›</li>\n<li>è®¿é—®å’Œå¢åˆ å…ƒç´ æ•ˆç‡ï¼šArrayList éšæœºè®¿é—®å’Œé¡ºåºæ’å…¥&#x2F;åˆ é™¤å…ƒç´ æ•ˆç‡æ›´é«˜ï¼›</li>\n<li>å†…å­˜å ç”¨ï¼šLinkedList æ¯” ArrayList æ›´å å†…å­˜ï¼Œå› ä¸º LinkedList çš„èŠ‚ç‚¹é™¤äº†å­˜å‚¨æ•°æ®ï¼Œè¿˜å­˜å‚¨äº†ä¸¤ä¸ªå¼•ç”¨ï¼Œä¸€ä¸ªæŒ‡å‘å‰ä¸€ä¸ªå…ƒç´ ï¼Œä¸€ä¸ªæŒ‡å‘åä¸€ä¸ªå…ƒç´ ï¼›</li>\n<li>çº¿ç¨‹å®‰å…¨ï¼šArrayList å’Œ LinkedList éƒ½æ˜¯ä¸åŒæ­¥çš„ï¼Œä¹Ÿå°±æ˜¯ä¸ä¿è¯çº¿ç¨‹å®‰å…¨ã€‚</li>\n</ul>\n<p>ç»¼åˆæ¥è¯´ï¼Œåœ¨éœ€è¦<strong>é¢‘ç¹è¯»å–</strong>é›†åˆä¸­çš„å…ƒç´ æ—¶ï¼Œæ›´æ¨èä½¿ç”¨ ArrayListï¼Œè€Œåœ¨<strong>æ’å…¥å’Œåˆ é™¤æ“ä½œè¾ƒå¤š</strong>æ—¶ï¼Œæ›´æ¨èä½¿ç”¨ LinkedListã€‚</p>\n<h4 id=\"ArrayList-å’Œ-Vector-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#ArrayList-å’Œ-Vector-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"ArrayList å’Œ Vector çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>ArrayList å’Œ Vector çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h4><p>ä¸»è¦åŒºåˆ«æ˜¯çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼š<br>Vector ä½¿ç”¨äº† synchronized æ¥å®ç°çº¿ç¨‹åŒæ­¥ï¼ˆæ€§èƒ½å·®ï¼‰ï¼Œæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè€Œ ArrayList æ˜¯éçº¿ç¨‹å®‰å…¨çš„ã€‚</p>\n<h4 id=\"å¤šçº¿ç¨‹åœºæ™¯ä¸‹å¦‚ä½•ä½¿ç”¨-ArrayListï¼Ÿ\"><a href=\"#å¤šçº¿ç¨‹åœºæ™¯ä¸‹å¦‚ä½•ä½¿ç”¨-ArrayListï¼Ÿ\" class=\"headerlink\" title=\"å¤šçº¿ç¨‹åœºæ™¯ä¸‹å¦‚ä½•ä½¿ç”¨ ArrayListï¼Ÿ\"></a>å¤šçº¿ç¨‹åœºæ™¯ä¸‹å¦‚ä½•ä½¿ç”¨ ArrayListï¼Ÿ</h4><p>å¯ä»¥ç”¨ Java.util.concurrent.CopyOnWriteArrayList æ›¿æ¢ ArrayListã€‚</p>\n<h4 id=\"ä¸ºä»€ä¹ˆ-ArrayList-çš„-elementData-åŠ ä¸Š-transient-ä¿®é¥°ï¼Ÿ\"><a href=\"#ä¸ºä»€ä¹ˆ-ArrayList-çš„-elementData-åŠ ä¸Š-transient-ä¿®é¥°ï¼Ÿ\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆ ArrayList çš„ elementData åŠ ä¸Š transient ä¿®é¥°ï¼Ÿ\"></a>ä¸ºä»€ä¹ˆ ArrayList çš„ elementData åŠ ä¸Š transient ä¿®é¥°ï¼Ÿ</h4><p>ArrayList å®ç°äº† Serializable æ¥å£ï¼Œè¿™æ„å‘³ç€ ArrayList æ”¯æŒåºåˆ—åŒ–ã€‚<br>å¯¹äº elementDataï¼Œç”±äº elementData å¯èƒ½æœ‰å¤šä½™çš„å®¹é‡ï¼ˆå®¹é‡ä¸è¶³ä¼šæ‰©å®¹æˆ 1.5 å€å¤§å°ï¼Œæ‰©å®¹ä¹‹åé™¤äº†æ–°åŠ <br>çš„å…ƒç´ ä»¥å¤–è¿˜æœ‰å¤šçš„ç©ºé—´æ²¡æœ‰æ”¾å…ƒç´ ï¼Œæ¯”å¦‚ç°åœ¨å®¹é‡æ˜¯ 15ï¼Œè€Œé›†åˆé‡Œé¢åªå­˜äº† 11 ä¸ªå…ƒç´ ï¼‰ï¼Œä¸å¯¹ elementData åŠ ä¸Š transient ä¿®é¥°ï¼Œè€Œæ˜¯æ‰‹åŠ¨è¿›è¡Œåºåˆ—åŒ–ï¼Œå¯ä»¥ä¿è¯åªåºåˆ—åŒ–å®é™…å­˜å‚¨çš„é‚£äº›å…ƒç´ ï¼ˆ11 ä¸ªå…ƒç´ ï¼‰ï¼Œè€Œä¸æ˜¯æ•´ä¸ªæ•°ç»„ï¼Œä»è€ŒèŠ‚çœç©ºé—´å’Œæ—¶é—´ã€‚</p>\n<h3 id=\"â­ArrayListæ‰©å®¹æœºåˆ¶\"><a href=\"#â­ArrayListæ‰©å®¹æœºåˆ¶\" class=\"headerlink\" title=\"â­ArrayListæ‰©å®¹æœºåˆ¶\"></a>â­ArrayListæ‰©å®¹æœºåˆ¶</h3><blockquote>\n<p><strong>æ€»ç»“ï¼š</strong></p>\n<ul>\n<li><p>åˆå§‹åŒ–å¦‚æœä½¿ç”¨æ— å‚æ„é€ å™¨çš„è¯ï¼š</p>\n<p>  åœ¨ç¬¬ä¸€æ¬¡æ·»åŠ å…ƒç´ çš„æ—¶å€™ï¼Œå°†æ•°ç»„å®¹é‡è®¾ç½®ä¸º10ï¼Œç„¶åè¿›è¡Œæ·»åŠ ã€‚</p>\n<p>  ä¸€ç›´æ·»åŠ ï¼Œç›´åˆ°è¦æ·»åŠ çš„å…ƒç´ è¶…å‡ºå½“å‰æ•°ç»„å®¹é‡äº†ï¼Œè¿›å…¥æ‰©å®¹ï¼Œå°†æ•°ç»„é•¿åº¦æ‰©å®¹ä¸º1.5å€é•¿åº¦ï¼Œç„¶åè¿›è¡Œæ·»åŠ ã€‚</p>\n</li>\n<li><p>åˆå§‹åŒ–å¦‚æœä½¿ç”¨æœ‰å‚æ„é€ å™¨çš„è¯ï¼š</p>\n<p>  é‚£ä¹ˆæ¯æ¬¡æ·»åŠ å…ƒç´ åªéœ€è¦åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹å³å¯ï¼Œä¸éœ€è¦ç¬¬ä¸€æ¬¡çš„åˆå§‹åŒ–ä¸º10çš„åˆ¤æ–­ã€‚</p>\n</li>\n</ul>\n</blockquote>\n<h4 id=\"1-å…ˆä»-ArrayList-çš„æ„é€ å‡½æ•°è¯´èµ·\"><a href=\"#1-å…ˆä»-ArrayList-çš„æ„é€ å‡½æ•°è¯´èµ·\" class=\"headerlink\" title=\"1. å…ˆä» ArrayList çš„æ„é€ å‡½æ•°è¯´èµ·\"></a>1. å…ˆä» ArrayList çš„æ„é€ å‡½æ•°è¯´èµ·</h4><p><strong>ï¼ˆJDK8ï¼‰ArrayList æœ‰ä¸‰ç§æ–¹å¼æ¥åˆå§‹åŒ–ï¼Œæ„é€ æ–¹æ³•æºç å¦‚ä¸‹ï¼š</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * é»˜è®¤åˆå§‹å®¹é‡å¤§å°</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"> <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">DEFAULT_CAPACITY</span> <span class=\"operator\">=</span> <span class=\"number\">10</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = &#123;&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  *é»˜è®¤æ„é€ å‡½æ•°ï¼Œä½¿ç”¨åˆå§‹å®¹é‡10æ„é€ ä¸€ä¸ªç©ºåˆ—è¡¨(æ— å‚æ•°æ„é€ )</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"> <span class=\"keyword\">public</span> <span class=\"title function_\">ArrayList</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">     <span class=\"built_in\">this</span>.elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA;</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * å¸¦åˆå§‹å®¹é‡å‚æ•°çš„æ„é€ å‡½æ•°ã€‚ï¼ˆç”¨æˆ·è‡ªå·±æŒ‡å®šå®¹é‡ï¼‰</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"> <span class=\"keyword\">public</span> <span class=\"title function_\">ArrayList</span><span class=\"params\">(<span class=\"type\">int</span> initialCapacity)</span> &#123;</span><br><span class=\"line\">     <span class=\"keyword\">if</span> (initialCapacity &gt; <span class=\"number\">0</span>) &#123;<span class=\"comment\">//åˆå§‹å®¹é‡å¤§äº0</span></span><br><span class=\"line\">         <span class=\"comment\">//åˆ›å»ºinitialCapacityå¤§å°çš„æ•°ç»„</span></span><br><span class=\"line\">         <span class=\"built_in\">this</span>.elementData = <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>[initialCapacity];</span><br><span class=\"line\">     &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (initialCapacity == <span class=\"number\">0</span>) &#123;<span class=\"comment\">//åˆå§‹å®¹é‡ç­‰äº0</span></span><br><span class=\"line\">         <span class=\"comment\">//åˆ›å»ºç©ºæ•°ç»„</span></span><br><span class=\"line\">         <span class=\"built_in\">this</span>.elementData = EMPTY_ELEMENTDATA;</span><br><span class=\"line\">     &#125; <span class=\"keyword\">else</span> &#123;<span class=\"comment\">//åˆå§‹å®¹é‡å°äº0ï¼ŒæŠ›å‡ºå¼‚å¸¸</span></span><br><span class=\"line\">         <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IllegalArgumentException</span>(<span class=\"string\">&quot;Illegal Capacity: &quot;</span>+</span><br><span class=\"line\">                                            initialCapacity);</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *æ„é€ åŒ…å«æŒ‡å®šcollectionå…ƒç´ çš„åˆ—è¡¨ï¼Œè¿™äº›å…ƒç´ åˆ©ç”¨è¯¥é›†åˆçš„è¿­ä»£å™¨æŒ‰é¡ºåºè¿”å›</span></span><br><span class=\"line\"><span class=\"comment\"> *å¦‚æœæŒ‡å®šçš„é›†åˆä¸ºnullï¼Œthrows NullPointerExceptionã€‚</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"title function_\">ArrayList</span><span class=\"params\">(Collection&lt;? extends E&gt; c)</span> &#123;</span><br><span class=\"line\">     elementData = c.toArray();</span><br><span class=\"line\">     <span class=\"keyword\">if</span> ((size = elementData.length) != <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">         <span class=\"comment\">// c.toArray might (incorrectly) not return Object[] (see 6260652)</span></span><br><span class=\"line\">         <span class=\"keyword\">if</span> (elementData.getClass() != Object[].class)</span><br><span class=\"line\">             elementData = Arrays.copyOf(elementData, size, Object[].class);</span><br><span class=\"line\">     &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">         <span class=\"comment\">// replace with empty array.</span></span><br><span class=\"line\">         <span class=\"built_in\">this</span>.elementData = EMPTY_ELEMENTDATA;</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\"> &#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>ä»¥æ— å‚æ•°æ„é€ æ–¹æ³•åˆ›å»º ArrayList æ—¶ï¼Œå®é™…ä¸Šåˆå§‹åŒ–èµ‹å€¼çš„æ˜¯ä¸€ä¸ªç©ºæ•°ç»„ã€‚å½“çœŸæ­£å¯¹æ•°ç»„è¿›è¡Œæ·»åŠ å…ƒç´ æ“ä½œæ—¶ï¼Œæ‰çœŸæ­£åˆ†é…å®¹é‡ã€‚å³å‘æ•°ç»„ä¸­æ·»åŠ ç¬¬ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œæ•°ç»„å®¹é‡æ‰©ä¸º 10ã€‚</strong> </p>\n<blockquote>\n<p>è¡¥å……ï¼šJDK6 new æ— å‚æ„é€ çš„ <code>ArrayList</code> å¯¹è±¡æ—¶ï¼Œç›´æ¥åˆ›å»ºäº†é•¿åº¦æ˜¯ 10 çš„ <code>Object[]</code> æ•°ç»„ elementData ã€‚</p>\n</blockquote>\n<h4 id=\"2-ä¸€æ­¥ä¸€æ­¥åˆ†æ-ArrayList-æ‰©å®¹æœºåˆ¶\"><a href=\"#2-ä¸€æ­¥ä¸€æ­¥åˆ†æ-ArrayList-æ‰©å®¹æœºåˆ¶\" class=\"headerlink\" title=\"2. ä¸€æ­¥ä¸€æ­¥åˆ†æ ArrayList æ‰©å®¹æœºåˆ¶\"></a>2. ä¸€æ­¥ä¸€æ­¥åˆ†æ ArrayList æ‰©å®¹æœºåˆ¶</h4><p>è¿™é‡Œä»¥æ— å‚æ„é€ å‡½æ•°åˆ›å»ºçš„ ArrayList ä¸ºä¾‹åˆ†æ</p>\n<h5 id=\"2-1-add\"><a href=\"#2-1-add\" class=\"headerlink\" title=\"2.1.  add\"></a>2.1.  <code>add</code></h5><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * å°†æŒ‡å®šçš„å…ƒç´ è¿½åŠ åˆ°æ­¤åˆ—è¡¨çš„æœ«å°¾ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"> <span class=\"keyword\">public</span> <span class=\"type\">boolean</span> <span class=\"title function_\">add</span><span class=\"params\">(E e)</span> &#123;</span><br><span class=\"line\"><span class=\"comment\">// æ·»åŠ å…ƒç´ ä¹‹å‰ï¼Œå…ˆè°ƒç”¨ensureCapacityInternalæ–¹æ³•</span></span><br><span class=\"line\">     ensureCapacityInternal(size + <span class=\"number\">1</span>);  <span class=\"comment\">// Increments modCount!!</span></span><br><span class=\"line\">     <span class=\"comment\">// è¿™é‡Œçœ‹åˆ°ArrayListæ·»åŠ å…ƒç´ çš„å®è´¨å°±ç›¸å½“äºä¸ºæ•°ç»„èµ‹å€¼</span></span><br><span class=\"line\">     elementData[size++] = e;</span><br><span class=\"line\">     <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\"> &#125;</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"2-2-ensureCapacityInternal\"><a href=\"#2-2-ensureCapacityInternal\" class=\"headerlink\" title=\"2.2. ensureCapacityInternal()\"></a>2.2. <code>ensureCapacityInternal()</code></h5><p>ï¼ˆJDK7ï¼‰å¯ä»¥çœ‹åˆ° <code>add</code> æ–¹æ³• é¦–å…ˆè°ƒç”¨äº†<code>ensureCapacityInternal(size + 1)</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//å¾—åˆ°æœ€å°æ‰©å®¹é‡</span></span><br><span class=\"line\"> <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">ensureCapacityInternal</span><span class=\"params\">(<span class=\"type\">int</span> minCapacity)</span> &#123;</span><br><span class=\"line\">     <span class=\"keyword\">if</span> (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) &#123;</span><br><span class=\"line\">         <span class=\"comment\">// è·å–é»˜è®¤çš„å®¹é‡å’Œä¼ å…¥å‚æ•°çš„è¾ƒå¤§å€¼</span></span><br><span class=\"line\">         minCapacity = Math.max(DEFAULT_CAPACITY, minCapacity);</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">     ensureExplicitCapacity(minCapacity);</span><br><span class=\"line\"> &#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>å½“ è¦ add è¿›ç¬¬ 1 ä¸ªå…ƒç´ æ—¶ï¼ŒminCapacity ä¸º 1ï¼Œåœ¨ Math.max()æ–¹æ³•æ¯”è¾ƒåï¼ŒminCapacity ä¸º 10ã€‚</strong></p>\n<blockquote>\n<p>æ­¤å¤„å’Œåç»­ JDK8 ä»£ç æ ¼å¼åŒ–ç•¥æœ‰ä¸åŒï¼Œæ ¸å¿ƒä»£ç åŸºæœ¬ä¸€æ ·ã€‚</p>\n</blockquote>\n<h5 id=\"2-3-ensureExplicitCapacity\"><a href=\"#2-3-ensureExplicitCapacity\" class=\"headerlink\" title=\"2.3. ensureExplicitCapacity()\"></a>2.3. <code>ensureExplicitCapacity()</code></h5><p>å¦‚æœè°ƒç”¨ <code>ensureCapacityInternal()</code> æ–¹æ³•å°±ä¸€å®šä¼šè¿›å…¥ï¼ˆæ‰§è¡Œï¼‰è¿™ä¸ªæ–¹æ³•</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹</span></span><br><span class=\"line\">  <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">ensureExplicitCapacity</span><span class=\"params\">(<span class=\"type\">int</span> minCapacity)</span> &#123;</span><br><span class=\"line\">      modCount++;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">// overflow-conscious code</span></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (minCapacity - elementData.length &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">          <span class=\"comment\">//è°ƒç”¨growæ–¹æ³•è¿›è¡Œæ‰©å®¹ï¼Œè°ƒç”¨æ­¤æ–¹æ³•ä»£è¡¨å·²ç»å¼€å§‹æ‰©å®¹äº†</span></span><br><span class=\"line\">          grow(minCapacity);</span><br><span class=\"line\">  &#125;</span><br></pre></td></tr></table></figure>\n\n<p>æˆ‘ä»¬æ¥ä»”ç»†åˆ†æä¸€ä¸‹ï¼š</p>\n<ul>\n<li>å½“æˆ‘ä»¬è¦ add è¿›ç¬¬ 1 ä¸ªå…ƒç´ åˆ° ArrayList æ—¶ï¼ŒelementData.length ä¸º 0 ï¼ˆå› ä¸ºè¿˜æ˜¯ä¸€ä¸ªç©ºçš„ listï¼‰ï¼Œå› ä¸ºæ‰§è¡Œäº† <code>ensureCapacityInternal()</code> æ–¹æ³• ï¼Œæ‰€ä»¥ minCapacity æ­¤æ—¶ä¸º 10ã€‚æ­¤æ—¶ï¼Œ<code>minCapacity - elementData.length &gt; 0</code>æˆç«‹ï¼Œæ‰€ä»¥ä¼šè¿›å…¥ <code>grow(minCapacity)</code> æ–¹æ³•ã€‚</li>\n<li>å½“ add ç¬¬ 2 ä¸ªå…ƒç´ æ—¶ï¼ŒminCapacity ä¸º 2ï¼Œæ­¤æ—¶ elementData.length(å®¹é‡)åœ¨æ·»åŠ ç¬¬ä¸€ä¸ªå…ƒç´ åæ‰©å®¹æˆ 10 äº†ã€‚æ­¤æ—¶ï¼Œ<code>minCapacity - elementData.length &gt; 0</code> ä¸æˆç«‹ï¼Œæ‰€ä»¥ä¸ä¼šè¿›å…¥ ï¼ˆæ‰§è¡Œï¼‰<code>grow(minCapacity)</code> æ–¹æ³•ã€‚</li>\n<li>æ·»åŠ ç¬¬ 3ã€4Â·Â·Â·åˆ°ç¬¬ 10 ä¸ªå…ƒç´ æ—¶ï¼Œä¾ç„¶ä¸ä¼šæ‰§è¡Œ grow æ–¹æ³•ï¼Œæ•°ç»„å®¹é‡éƒ½ä¸º 10ã€‚</li>\n</ul>\n<p>ç›´åˆ°æ·»åŠ ç¬¬ 11 ä¸ªå…ƒç´ ï¼ŒminCapacity(ä¸º 11)æ¯” elementData.lengthï¼ˆä¸º 10ï¼‰è¦å¤§ã€‚è¿›å…¥ grow æ–¹æ³•è¿›è¡Œæ‰©å®¹ã€‚</p>\n<h5 id=\"2-4-grow\"><a href=\"#2-4-grow\" class=\"headerlink\" title=\"2.4. grow()\"></a>2.4. <code>grow()</code></h5><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * è¦åˆ†é…çš„æœ€å¤§æ•°ç»„å¤§å°</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">MAX_ARRAY_SIZE</span> <span class=\"operator\">=</span> Integer.MAX_VALUE - <span class=\"number\">8</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * ArrayListæ‰©å®¹çš„æ ¸å¿ƒæ–¹æ³•ã€‚</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">grow</span><span class=\"params\">(<span class=\"type\">int</span> minCapacity)</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// oldCapacityä¸ºæ—§å®¹é‡ï¼ŒnewCapacityä¸ºæ–°å®¹é‡</span></span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">oldCapacity</span> <span class=\"operator\">=</span> elementData.length;</span><br><span class=\"line\">    <span class=\"comment\">//å°†oldCapacity å³ç§»ä¸€ä½ï¼Œå…¶æ•ˆæœç›¸å½“äºoldCapacity /2ï¼Œ</span></span><br><span class=\"line\">    <span class=\"comment\">//æˆ‘ä»¬çŸ¥é“ä½è¿ç®—çš„é€Ÿåº¦è¿œè¿œå¿«äºæ•´é™¤è¿ç®—ï¼Œæ•´å¥è¿ç®—å¼çš„ç»“æœå°±æ˜¯å°†æ–°å®¹é‡æ›´æ–°ä¸ºæ—§å®¹é‡çš„1.5å€ï¼Œ</span></span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">newCapacity</span> <span class=\"operator\">=</span> oldCapacity + (oldCapacity &gt;&gt; <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"comment\">//ç„¶åæ£€æŸ¥æ–°å®¹é‡æ˜¯å¦å¤§äºæœ€å°éœ€è¦å®¹é‡ï¼Œè‹¥è¿˜æ˜¯å°äºæœ€å°éœ€è¦å®¹é‡ï¼Œé‚£ä¹ˆå°±æŠŠæœ€å°éœ€è¦å®¹é‡å½“ä½œæ•°ç»„çš„æ–°å®¹é‡ï¼Œ</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (newCapacity - minCapacity &lt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        newCapacity = minCapacity;</span><br><span class=\"line\">   <span class=\"comment\">// å¦‚æœæ–°å®¹é‡å¤§äº MAX_ARRAY_SIZE,è¿›å…¥(æ‰§è¡Œ) `hugeCapacity()` æ–¹æ³•æ¥æ¯”è¾ƒ minCapacity å’Œ MAX_ARRAY_SIZEï¼Œ</span></span><br><span class=\"line\">   <span class=\"comment\">//å¦‚æœminCapacityå¤§äºæœ€å¤§å®¹é‡ï¼Œåˆ™æ–°å®¹é‡åˆ™ä¸º`Integer.MAX_VALUE`ï¼Œå¦åˆ™ï¼Œæ–°å®¹é‡å¤§å°åˆ™ä¸º MAX_ARRAY_SIZE å³ä¸º `Integer.MAX_VALUE - 8`ã€‚</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (newCapacity - MAX_ARRAY_SIZE &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        newCapacity = hugeCapacity(minCapacity);</span><br><span class=\"line\">    <span class=\"comment\">// minCapacity is usually close to size, so this is a win:</span></span><br><span class=\"line\">    elementData = Arrays.copyOf(elementData, newCapacity);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>int newCapacity &#x3D; oldCapacity + (oldCapacity &gt;&gt; 1),æ‰€ä»¥ ArrayList æ¯æ¬¡æ‰©å®¹ä¹‹åå®¹é‡éƒ½ä¼šå˜ä¸ºåŸæ¥çš„ 1.5 å€å·¦å³ï¼ˆoldCapacity ä¸ºå¶æ•°å°±æ˜¯ 1.5 å€ï¼Œå¦åˆ™æ˜¯ 1.5 å€å·¦å³ï¼‰</strong> </p>\n<p><strong>æˆ‘ä»¬å†æ¥é€šè¿‡ä¾‹å­æ¢ç©¶ä¸€ä¸‹grow() æ–¹æ³• ï¼š</strong></p>\n<ul>\n<li>å½“ add ç¬¬ 1 ä¸ªå…ƒç´ æ—¶ï¼ŒoldCapacity ä¸º 0ï¼Œç»æ¯”è¾ƒåç¬¬ä¸€ä¸ª if åˆ¤æ–­æˆç«‹ï¼ŒnewCapacity &#x3D; minCapacity(ä¸º 10)ã€‚ä½†æ˜¯ç¬¬äºŒä¸ª if åˆ¤æ–­ä¸ä¼šæˆç«‹ï¼Œå³ newCapacity ä¸æ¯” MAX_ARRAY_SIZE å¤§ï¼Œåˆ™ä¸ä¼šè¿›å…¥ <code>hugeCapacity</code> æ–¹æ³•ã€‚æ•°ç»„å®¹é‡ä¸º 10ï¼Œadd æ–¹æ³•ä¸­ return true,size å¢ä¸º 1ã€‚</li>\n<li>å½“ add ç¬¬ 11 ä¸ªå…ƒç´ è¿›å…¥ grow æ–¹æ³•æ—¶ï¼ŒnewCapacity ä¸º 15ï¼Œæ¯” minCapacityï¼ˆä¸º 11ï¼‰å¤§ï¼Œç¬¬ä¸€ä¸ª if åˆ¤æ–­ä¸æˆç«‹ã€‚æ–°å®¹é‡æ²¡æœ‰å¤§äºæ•°ç»„æœ€å¤§ sizeï¼Œä¸ä¼šè¿›å…¥ hugeCapacity æ–¹æ³•ã€‚æ•°ç»„å®¹é‡æ‰©ä¸º 15ï¼Œadd æ–¹æ³•ä¸­ return true,size å¢ä¸º 11ã€‚</li>\n<li>ä»¥æ­¤ç±»æ¨Â·Â·Â·Â·Â·Â·</li>\n</ul>\n<h5 id=\"2-5-hugeCapacity\"><a href=\"#2-5-hugeCapacity\" class=\"headerlink\" title=\"2.5. hugeCapacity()\"></a>2.5. <code>hugeCapacity()</code></h5><p>ä»ä¸Šé¢ <code>grow()</code> æ–¹æ³•æºç æˆ‘ä»¬çŸ¥é“ï¼š å¦‚æœæ–°å®¹é‡å¤§äº MAX_ARRAY_SIZE,è¿›å…¥(æ‰§è¡Œ) <code>hugeCapacity()</code> æ–¹æ³•æ¥æ¯”è¾ƒ minCapacity å’Œ MAX_ARRAY_SIZEï¼Œå¦‚æœ minCapacity å¤§äºæœ€å¤§å®¹é‡ï¼Œåˆ™æ–°å®¹é‡åˆ™ä¸º<code>Integer.MAX_VALUE</code>ï¼Œå¦åˆ™ï¼Œæ–°å®¹é‡å¤§å°åˆ™ä¸º MAX_ARRAY_SIZE å³ä¸º <code>Integer.MAX_VALUE - 8</code>ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"title function_\">hugeCapacity</span><span class=\"params\">(<span class=\"type\">int</span> minCapacity)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (minCapacity &lt; <span class=\"number\">0</span>) <span class=\"comment\">// overflow</span></span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">OutOfMemoryError</span>();</span><br><span class=\"line\">    <span class=\"comment\">//å¯¹minCapacityå’ŒMAX_ARRAY_SIZEè¿›è¡Œæ¯”è¾ƒ</span></span><br><span class=\"line\">    <span class=\"comment\">//è‹¥minCapacityå¤§ï¼Œå°†Integer.MAX_VALUEä½œä¸ºæ–°æ•°ç»„çš„å¤§å°</span></span><br><span class=\"line\">    <span class=\"comment\">//è‹¥MAX_ARRAY_SIZEå¤§ï¼Œå°†MAX_ARRAY_SIZEä½œä¸ºæ–°æ•°ç»„çš„å¤§å°</span></span><br><span class=\"line\">    <span class=\"comment\">//MAX_ARRAY_SIZE = Integer.MAX_VALUE - 8;</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> (minCapacity &gt; MAX_ARRAY_SIZE) ?</span><br><span class=\"line\">        Integer.MAX_VALUE :</span><br><span class=\"line\">        MAX_ARRAY_SIZE;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Setæ¥å£\"><a href=\"#Setæ¥å£\" class=\"headerlink\" title=\"Setæ¥å£\"></a>Setæ¥å£</h3><h4 id=\"HashSet-çš„å®ç°åŸç†ï¼Ÿ\"><a href=\"#HashSet-çš„å®ç°åŸç†ï¼Ÿ\" class=\"headerlink\" title=\"HashSet çš„å®ç°åŸç†ï¼Ÿ\"></a>HashSet çš„å®ç°åŸç†ï¼Ÿ</h4><p>HashSet æ˜¯åŸºäº HashMap å®ç°çš„ï¼ŒHashSet çš„å€¼å­˜æ”¾äº HashMap çš„ key ä¸Šï¼ŒHashMap çš„ value ç»Ÿä¸€ä¸º Object å¸¸é‡ PRESENTï¼Œç”±äº HashMap çš„ key ä¸å…è®¸é‡å¤ï¼Œè€Œ HashSet ä¸å…è®¸é‡å¤çš„å€¼ï¼Œå› æ­¤ HashSet å¯ä»¥åŸºäº HashMap å®ç°ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯ç›´æ¥è°ƒç”¨åº•å±‚ HashMap çš„ç›¸å…³æ–¹æ³•æ¥å®Œæˆã€‚</p>\n<h4 id=\"HashSetæ˜¯å¦‚ä½•ä¿è¯æ•°æ®ä¸å¯é‡å¤çš„ï¼Ÿ\"><a href=\"#HashSetæ˜¯å¦‚ä½•ä¿è¯æ•°æ®ä¸å¯é‡å¤çš„ï¼Ÿ\" class=\"headerlink\" title=\"HashSetæ˜¯å¦‚ä½•ä¿è¯æ•°æ®ä¸å¯é‡å¤çš„ï¼Ÿ\"></a>HashSetæ˜¯å¦‚ä½•ä¿è¯æ•°æ®ä¸å¯é‡å¤çš„ï¼Ÿ</h4><p>å½“ä½ æŠŠå¯¹è±¡åŠ å…¥ hashSet æ—¶ï¼ŒhashSet ä¼šå…ˆè®¡ç®—å¯¹è±¡çš„ hashcode å€¼æ¥åˆ¤æ–­å¯¹è±¡åŠ å…¥çš„ä½ç½®ï¼Œå¦‚æœå‘ç°æœ‰ç›¸åŒ hashcode å€¼çš„å¯¹è±¡ï¼Œè¿™æ—¶ä¼šè°ƒç”¨ equals()æ–¹æ³•æ¥æ£€æŸ¥ hashcode ç›¸ç­‰çš„å¯¹è±¡æ˜¯å¦çœŸçš„ç›¸åŒã€‚å¦‚æœä¸¤è€…ç›¸åŒï¼Œè¡¨æ˜å·²ç»æœ‰äº†ç›¸åŒçš„å¯¹è±¡äº†ï¼ŒhashSet å°±ä¸ä¼šè®©å…¶åŠ å…¥æ“ä½œæˆåŠŸã€‚å¦‚æœä¸åŒçš„è¯ï¼Œå°±ä¼šé‡æ–°æ•£åˆ—åˆ°å…¶ä»–ä½ç½®ã€‚ </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Dummy value to associate with an Object in the backing Map</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">Object</span> <span class=\"variable\">PRESENT</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>();</span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">transient</span> HashMap&lt;E,Object&gt; map;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"title function_\">HashSet</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    map = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;&gt;();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"type\">boolean</span> <span class=\"title function_\">add</span><span class=\"params\">(E e)</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// è°ƒç”¨HashMapçš„putæ–¹æ³•,PRESENTæ˜¯ä¸€ä¸ªè‡³å§‹è‡³ç»ˆéƒ½ç›¸åŒçš„è™šå€¼</span></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> map.put(e, PRESENT)==<span class=\"literal\">null</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"åªé‡å†™-hashCode-å¯ä»¥å—ï¼Ÿ\"><a href=\"#åªé‡å†™-hashCode-å¯ä»¥å—ï¼Ÿ\" class=\"headerlink\" title=\"åªé‡å†™ hashCode å¯ä»¥å—ï¼Ÿ\"></a>åªé‡å†™ hashCode å¯ä»¥å—ï¼Ÿ</h4><p>ä¸¤ä¸ªå¯¹è±¡çš„ hashCode ç›¸åŒï¼Œä½†æ˜¯å†…å®¹å¯èƒ½ä¸åŒï¼Œåœ¨ set ä¸­æ˜æ˜åº”è¯¥æ˜¯ä¸¤ä¸ªä¸åŒçš„å¯¹è±¡ï¼Œè¿™æ—¶å€™åªé€šè¿‡ hashCode åˆ¤æ–­ä»–ä¿©ç›¸åŒä¼šå¯¼è‡´åªæ’å…¥ä¸€ä¸ªå…ƒç´ ã€‚</p>\n<h4 id=\"åªé‡å†™-equalså¯ä»¥å—ï¼Ÿ\"><a href=\"#åªé‡å†™-equalså¯ä»¥å—ï¼Ÿ\" class=\"headerlink\" title=\"åªé‡å†™ equalså¯ä»¥å—ï¼Ÿ\"></a>åªé‡å†™ equalså¯ä»¥å—ï¼Ÿ</h4><p>å¦‚æœåœ¨é‡å†™ equals æ—¶ï¼Œä¸é‡å†™ hashCodeï¼Œå°±ä¼šå¼•èµ·æ¯”å¦‚è¯´å°†ä¸¤ä¸ªç›¸ç­‰çš„è‡ªå®šä¹‰å¯¹è±¡å­˜å‚¨åœ¨ Set é›†åˆæ—¶ï¼Œä¼šå°†è¿™ä¸¤ä¸ªå¯¹è±¡éƒ½è¿›è¡Œæ’å…¥ã€‚ï¼ˆæ— æ³•å»é‡ï¼‰</p>\n<h2 id=\"Mapæ¥å£\"><a href=\"#Mapæ¥å£\" class=\"headerlink\" title=\"Mapæ¥å£\"></a>Mapæ¥å£</h2><h3 id=\"HashMapçº¿ç¨‹ä¸å®‰å…¨çš„ä¸»è¦ä½“ç°ï¼Ÿ\"><a href=\"#HashMapçº¿ç¨‹ä¸å®‰å…¨çš„ä¸»è¦ä½“ç°ï¼Ÿ\" class=\"headerlink\" title=\"HashMapçº¿ç¨‹ä¸å®‰å…¨çš„ä¸»è¦ä½“ç°ï¼Ÿ\"></a>HashMapçº¿ç¨‹ä¸å®‰å…¨çš„ä¸»è¦ä½“ç°ï¼Ÿ</h3><ol>\n<li><p>åœ¨ jdk1.7 ä¸­ï¼Œåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œ<strong>æ‰©å®¹</strong>æ—¶ä¼šé€ æˆæ­»é“¾ã€‚</p>\n<blockquote>\n<p>ä½œè€…ï¼šç£Šå“¥<br>é“¾æ¥ï¼š<a href=\"https://www.zhihu.com/question/394039290/answer/2314917909\">https://www.zhihu.com/question/394039290/answer/2314917909</a><br>æ¥æºï¼šçŸ¥ä¹</p>\n</blockquote>\n<p> 1.1ã€</p>\n<p> æ­»å¾ªç¯æ˜¯å› ä¸ºå¹¶å‘ HashMap æ‰©å®¹å¯¼è‡´çš„ï¼Œå¹¶å‘æ‰©å®¹çš„ç¬¬ä¸€æ­¥ï¼Œçº¿ç¨‹ T1 å’Œçº¿ç¨‹ T2 è¦å¯¹ HashMap è¿›è¡Œæ‰©å®¹æ“ä½œï¼Œæ­¤æ—¶ T1 å’Œ T2 æŒ‡å‘çš„æ˜¯é“¾è¡¨çš„å¤´ç»“ç‚¹å…ƒç´  Aï¼Œè€Œ T1 å’Œ T2 çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯ T1.next å’Œ T2.next æŒ‡å‘çš„æ˜¯ B èŠ‚ç‚¹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š </p>\n<p> <img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/v2-e0b4f5ea00cb277bde490f315b9b387f_720w.jpg\" alt=\"å¤šçº¿ç¨‹æ‰©å®¹å¯¼è‡´æ­»å¾ªç¯é—®é¢˜-1\"></p>\n<p> 1.2ã€</p>\n<p> æ­»å¾ªç¯çš„ç¬¬äºŒæ­¥æ“ä½œæ˜¯ï¼Œçº¿ç¨‹ T2 æ—¶é—´ç‰‡ç”¨å®Œè¿›å…¥ä¼‘çœ çŠ¶æ€ï¼Œè€Œçº¿ç¨‹ T1 å¼€å§‹æ‰§è¡Œæ‰©å®¹æ“ä½œï¼Œä¸€ç›´åˆ°çº¿ç¨‹ T1 æ‰©å®¹å®Œæˆåï¼Œçº¿ç¨‹ T2 æ‰è¢«å”¤é†’ï¼Œæ‰©å®¹ä¹‹åçš„åœºæ™¯å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š </p>\n<p> <img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/v2-5f78d8ac8af1efc79e7d79a1f3fdc154_r.jpg\" alt=\"å¤šçº¿ç¨‹æ‰©å®¹å¯¼è‡´æ­»å¾ªç¯é—®é¢˜-2\"></p>\n<p>  ä»ä¸Šå›¾å¯çŸ¥çº¿ç¨‹ T1 æ‰§è¡Œä¹‹åï¼Œ<strong>å› ä¸ºæ˜¯å¤´æ’æ³•ï¼Œæ‰€ä»¥HashMapçš„é¡ºåºå·²ç»å‘ç”Ÿäº†æ”¹å˜</strong>ï¼Œä½†çº¿ç¨‹ T2 å¯¹äºå‘ç”Ÿçš„ä¸€åˆ‡æ˜¯ä¸å¯çŸ¥çš„ï¼Œæ‰€ä»¥å®ƒçš„æŒ‡å‘å…ƒç´ ä¾ç„¶æ²¡å˜ï¼Œå¦‚ä¸Šå›¾å±•ç¤ºçš„é‚£æ ·ï¼ŒT2 æŒ‡å‘çš„æ˜¯ A å…ƒç´ ï¼ŒT2.next æŒ‡å‘çš„èŠ‚ç‚¹æ˜¯ B å…ƒç´ ã€‚</p>\n<p> 1.3ã€</p>\n<p> å½“çº¿ç¨‹ T1 æ‰§è¡Œå®Œï¼Œè€Œçº¿ç¨‹ T2 æ¢å¤æ‰§è¡Œæ—¶ï¼Œæ­»å¾ªç¯å°±å»ºç«‹äº†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š </p>\n<p> <img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/v2-bd4a753db8c985119aa4dcd4356609cf_720w.jpg\" alt=\"å¤šçº¿ç¨‹æ‰©å®¹å¯¼è‡´æ­»å¾ªç¯é—®é¢˜-3\"></p>\n<p>  å› ä¸º T1 æ‰§è¡Œå®Œæ‰©å®¹ä¹‹å B èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ˜¯ Aï¼Œè€Œ T2 çº¿ç¨‹æŒ‡å‘çš„é¦–èŠ‚ç‚¹æ˜¯ Aï¼Œç¬¬äºŒä¸ªèŠ‚ç‚¹æ˜¯ Bï¼Œè¿™ä¸ªé¡ºåºåˆšå¥½å’Œ T1 æ‰©å®Œå®¹å®Œä¹‹åçš„èŠ‚ç‚¹é¡ºåºæ˜¯ç›¸åçš„ã€‚<strong>T1æ‰§è¡Œå®Œä¹‹åçš„é¡ºåºæ˜¯Båˆ°Aï¼Œè€ŒT2çš„é¡ºåºæ˜¯Aåˆ°Bï¼Œè¿™æ ·AèŠ‚ç‚¹å’ŒBèŠ‚ç‚¹å°±å½¢æˆæ­»å¾ªç¯äº†</strong>ï¼Œè¿™å°±æ˜¯ HashMap æ­»å¾ªç¯å¯¼è‡´çš„åŸå› ã€‚</p>\n</li>\n<li><p>åœ¨ jdk1.8 ä¸­ï¼Œåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œ<strong>æ’å…¥</strong>æ—¶ä¼šå‘ç”Ÿæ•°æ®è¦†ç›–çš„æƒ…å†µï¼ˆ<strong>å°¾æ’æ³•</strong>ï¼‰ã€‚</p>\n</li>\n</ol>\n<h3 id=\"HashMapåœ¨JDK1-7å’ŒJDK1-8ä¸­æœ‰å“ªäº›ä¸åŒï¼Ÿ\"><a href=\"#HashMapåœ¨JDK1-7å’ŒJDK1-8ä¸­æœ‰å“ªäº›ä¸åŒï¼Ÿ\" class=\"headerlink\" title=\"HashMapåœ¨JDK1.7å’ŒJDK1.8ä¸­æœ‰å“ªäº›ä¸åŒï¼Ÿ\"></a>HashMapåœ¨JDK1.7å’ŒJDK1.8ä¸­æœ‰å“ªäº›ä¸åŒï¼Ÿ</h3><table>\n<thead>\n<tr>\n<th>ä¸åŒ</th>\n<th>JDK 1.7</th>\n<th>JDK 1.8</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><strong>å­˜å‚¨ç»“æ„</strong></td>\n<td>æ•°ç»„ + é“¾è¡¨</td>\n<td>æ•°ç»„ + é“¾è¡¨ + çº¢é»‘æ ‘</td>\n</tr>\n<tr>\n<td><strong>hashå€¼è®¡ç®—æ–¹å¼</strong></td>\n<td>æ‰°åŠ¨å¤„ç† &#x3D; 4æ¬¡ä½è¿ç®— + 5æ¬¡å¼‚æˆ–è¿ç®—</td>\n<td>æ‰°åŠ¨å¤„ç† &#x3D; 1æ¬¡ä½è¿ç®— + 1æ¬¡å¼‚æˆ–è¿ç®—</td>\n</tr>\n<tr>\n<td><strong>å­˜æ”¾æ•°æ®çš„è§„åˆ™</strong></td>\n<td>æ— å†²çªæ—¶ï¼Œå­˜æ”¾æ•°ç»„ï¼›<br />å†²çªæ—¶ï¼Œå­˜æ”¾é“¾è¡¨</td>\n<td>æ— å†²çªæ—¶ï¼Œå­˜æ”¾æ•°ç»„ï¼›<br />å†²çª &amp; é“¾è¡¨é•¿åº¦ &lt; 8ï¼šæ’å…¥å•é“¾è¡¨ï¼›<br />é“¾è¡¨é•¿åº¦&gt;8ï¼Œå…ˆå°è¯•æ‰©å®¹æ•°ç»„ï¼Œæ•°ç»„é•¿åº¦å¤§äº64<br />é“¾è¡¨è½¬ä¸ºçº¢é»‘æ ‘ï¼Œæ’å…¥åˆ°çº¢é»‘æ ‘</td>\n</tr>\n<tr>\n<td><strong>æ’å…¥æ•°æ®æ–¹å¼</strong></td>\n<td>å¤´æ’æ³•</td>\n<td>å°¾æ’æ³•</td>\n</tr>\n<tr>\n<td><strong>æ‰©å®¹åå­˜å‚¨ä½ç½®çš„è®¡ç®—æ–¹å¼</strong></td>\n<td>æŒ‰ç…§åŸæ¥æ–¹æ³•é‡æ–°è¿›è¡Œè®¡ç®—<br />hashCodeã€æ‰°åŠ¨å‡½æ•°ã€ä¸è¿ç®—h&amp;length-1</td>\n<td>æ ¹æ®å…ƒç´ çš„hashå€¼è¿›è¡Œåˆ¤æ–­ <br />æ‰©å®¹åçš„ä½ç½®&#x3D;åŸä½ç½® or åŸä½ç½® + æ—§å®¹é‡</td>\n</tr>\n</tbody></table>\n<h3 id=\"HashMapçš„hashç®—æ³•\"><a href=\"#HashMapçš„hashç®—æ³•\" class=\"headerlink\" title=\"HashMapçš„hashç®—æ³•\"></a>HashMapçš„hashç®—æ³•</h3><h4 id=\"ä»€ä¹ˆæ˜¯å“ˆå¸Œï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯å“ˆå¸Œï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯å“ˆå¸Œï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯å“ˆå¸Œï¼Ÿ</h4><p>Hashï¼Œå°±æ˜¯æŠŠä»»æ„é•¿åº¦çš„è¾“å…¥é€šè¿‡æ•£åˆ—ç®—æ³•ï¼Œå˜æ¢æˆå›ºå®šé•¿åº¦çš„è¾“å‡ºï¼Œè¯¥è¾“å‡ºå°±æ˜¯æ•£åˆ—å€¼ï¼ˆå“ˆå¸Œå€¼ï¼‰ï¼›</p>\n<p>hash å€¼ä¸åŒï¼Œè¾“å…¥ä¸€å®šä¸åŒï¼›è¾“å…¥ä¸åŒï¼Œhash å€¼å¯èƒ½ç›¸åŒï¼ˆå³å“ˆå¸Œç¢°æ’ï¼‰</p>\n<h4 id=\"ä»€ä¹ˆæ˜¯å“ˆå¸Œå†²çªï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯å“ˆå¸Œå†²çªï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯å“ˆå¸Œå†²çªï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯å“ˆå¸Œå†²çªï¼Ÿ</h4><p>å½“ä¸¤ä¸ªä¸åŒçš„è¾“å…¥å€¼ï¼Œæ ¹æ®åŒä¸€æ•£åˆ—å‡½æ•°è®¡ç®—å‡ºç›¸åŒçš„æ•£åˆ—å€¼çš„ç°è±¡ï¼Œæˆ‘ä»¬å°±æŠŠå®ƒå«åšå“ˆå¸Œç¢°æ’&#x2F;å†²çªã€‚</p>\n<h4 id=\"HashMapçš„æ•°æ®ç»“æ„\"><a href=\"#HashMapçš„æ•°æ®ç»“æ„\" class=\"headerlink\" title=\"HashMapçš„æ•°æ®ç»“æ„\"></a>HashMapçš„æ•°æ®ç»“æ„</h4><p>åº•å±‚æ•°æ®ç»“æ„ï¼šæ•°ç»„+é“¾è¡¨<br><strong>æ•°ç»„çš„ç‰¹ç‚¹æ˜¯ï¼šæ–¹ä¾¿æŸ¥æ‰¾ï¼›é“¾è¡¨çš„ç‰¹ç‚¹æ˜¯ï¼šæ–¹ä¾¿æ’å…¥åˆ é™¤</strong><br>æ‰€ä»¥æˆ‘ä»¬å°†æ•°ç»„å’Œé“¾è¡¨ç»“åˆåœ¨ä¸€èµ·ï¼Œå‘æŒ¥ä¸¤è€…å„è‡ªçš„ä¼˜åŠ¿ï¼Œä½¿ç”¨ä¸€ç§å«åš<strong>é“¾åœ°å€æ³•</strong>çš„æ–¹å¼å¯ä»¥è§£å†³å“ˆå¸Œå†²çª</p>\n<blockquote>\n<p>è§£å†³å“ˆå¸Œå†²çªçš„å…¶ä»–æ–¹æ³•ï¼š<br>å¼€æ”¾å®šå€æ³•ï¼ˆå†²çªäº†é€šè¿‡æŸç§æ–¹å¼æ•£åˆ—åˆ°å¦ä¸€ä¸ªä¸å†²çªçš„ä½ç½®ä¸Šï¼‰ï¼›<br>å†å“ˆå¸Œæ³•ï¼ˆæ„é€ å¤šä¸ªä¸åŒçš„å“ˆå¸Œå‡½æ•°ï¼‰ã€‚</p>\n</blockquote>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy83ODk2ODkwLWM2NmE0YmQ4OTA3ZjQ5ZjYucG5n.png\" alt=\"HashMapæ•°æ®ç»“æ„\"></p>\n<h4 id=\"æ‰°åŠ¨å¤„ç†\"><a href=\"#æ‰°åŠ¨å¤„ç†\" class=\"headerlink\" title=\"æ‰°åŠ¨å¤„ç†\"></a>æ‰°åŠ¨å¤„ç†</h4><p>ç”±äºè®¡ç®—ä¸‹æ ‡æ—¶ï¼Œé€šè¿‡ h &amp; (length - 1)ï¼Œç”±äº hash å€¼èŒƒå›´å¾ˆå¤§ï¼Œè€Œæ•°ç»„é•¿åº¦ç›¸å¯¹æ¥è¯´å°å¾—å¤šï¼Œå¯¼è‡´è¿›è¡Œä¸è¿ç®—æ—¶å‚ä¸è¿ç®—çš„åªæœ‰ hash å€¼çš„ä½ä½ï¼Œ<strong>é«˜ä½æ˜¯æ²¡æœ‰èµ·åˆ°ä»»ä½•ä½œç”¨çš„</strong>ï¼Œè¿™å°†ä¼šå¤§å¤§å¢åŠ å“ˆå¸Œç¢°æ’çš„æ¦‚ç‡ã€‚æ‰€ä»¥æˆ‘ä»¬çš„æ€è·¯å°±æ˜¯è®© hashCode å€¼çš„é«˜ä½ä¹Ÿå‚ä¸è¿ç®—ï¼Œè¿›ä¸€æ­¥é™ä½ hash ç¢°æ’çš„æ¦‚ç‡ï¼Œä½¿å¾—<strong>æ•°æ®åˆ†å¸ƒæ›´å¹³å‡</strong>ï¼Œæˆ‘ä»¬æŠŠè¿™æ ·çš„æ“ä½œç§°ä¸º<strong>æ‰°åŠ¨</strong>ï¼Œåœ¨<strong>JDK 1.8</strong>ä¸­çš„ hash()å‡½æ•°å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"title function_\">hash</span><span class=\"params\">(Object key)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> h;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (key == <span class=\"literal\">null</span>) ? <span class=\"number\">0</span> : (h = key.hashCode()) ^ (h &gt;&gt;&gt; <span class=\"number\">16</span>);</span><br><span class=\"line\">    <span class=\"comment\">// ä¸è‡ªå·±å³ç§»16ä½è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼ˆé«˜ä½ä½å¼‚æˆ–ï¼‰</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>è¿™æ¯”åœ¨<strong>JDK 1.7</strong>ä¸­ï¼Œæ›´ä¸ºç®€æ´ï¼Œ<strong>ç›¸æ¯”åœ¨1.7ä¸­çš„4æ¬¡ä½è¿ç®—ï¼Œ5æ¬¡å¼‚æˆ–è¿ç®—ï¼ˆ9æ¬¡æ‰°åŠ¨ï¼‰ï¼Œåœ¨1.8ä¸­ï¼Œåªè¿›è¡Œäº†1æ¬¡ä½è¿ç®—å’Œ1æ¬¡å¼‚æˆ–è¿ç®—ï¼ˆ2æ¬¡æ‰°åŠ¨ï¼‰</strong>ï¼›</p>\n<h4 id=\"ä¸‹æ ‡è®¡ç®—\"><a href=\"#ä¸‹æ ‡è®¡ç®—\" class=\"headerlink\" title=\"ä¸‹æ ‡è®¡ç®—\"></a>ä¸‹æ ‡è®¡ç®—</h4><p>åœ¨å¾—åˆ° hash å€¼ä¹‹åï¼Œæˆ‘ä»¬è¦æŠŠè¿™äº› hash å€¼æ˜ å°„åˆ°ç›¸åº”çš„æ•°ç»„ä¸‹æ ‡ä¸Šï¼Œé‚£ä¹ˆå°±å¯ä»¥è€ƒè™‘ä½¿ç”¨ hash % length</p>\n<p>è€Œ hash % length&#x3D;&#x3D;hash &amp; (length-1) å¹¶ä¸”å‰ææ˜¯ length æ˜¯ 2 çš„ n æ¬¡æ–¹ã€‚<br>ç”±äºé‡‡ç”¨äºŒè¿›åˆ¶ä½æ“ä½œ &amp;ï¼Œç›¸å¯¹äº%èƒ½å¤Ÿæé«˜è¿ç®—æ•ˆç‡ï¼Œå› æ­¤å¯ä»¥å°† HashMap çš„é•¿åº¦è®¾è®¡ä¸º 2 çš„å¹‚æ¬¡æ–¹ã€‚ï¼ˆåˆå§‹åŒ–ä¸º 16ï¼Œå¦‚æœæŒ‡å®šåˆå§‹åŒ–å®¹é‡çš„å€¼ï¼Œä¼šæ‰©å®¹è‡³ç¬¬ä¸€ä¸ªå¤§äºè¯¥å®¹é‡çš„ 2 çš„å¹‚æ¬¡æ–¹ä½œä¸ºæ•°ç»„å®¹é‡ï¼‰</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"title function_\">indexFor</span><span class=\"params\">(<span class=\"type\">int</span> h, <span class=\"type\">int</span> length)</span>&#123;</span><br><span class=\"line\">     <span class=\"keyword\">return</span> h &amp; (length - <span class=\"number\">1</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"ä¸ºä»€ä¹ˆè¦å°†æ•°ç»„é•¿åº¦è®¾ç½®ä¸º-2-çš„næ¬¡å¹‚å‘¢ï¼Ÿ\"><a href=\"#ä¸ºä»€ä¹ˆè¦å°†æ•°ç»„é•¿åº¦è®¾ç½®ä¸º-2-çš„næ¬¡å¹‚å‘¢ï¼Ÿ\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆè¦å°†æ•°ç»„é•¿åº¦è®¾ç½®ä¸º 2 çš„næ¬¡å¹‚å‘¢ï¼Ÿ\"></a>ä¸ºä»€ä¹ˆè¦å°†æ•°ç»„é•¿åº¦è®¾ç½®ä¸º 2 çš„næ¬¡å¹‚å‘¢ï¼Ÿ</h4><p>å½“æ•°ç»„é•¿åº¦ä¸º 2 çš„ n æ¬¡å¹‚çš„æ—¶å€™ï¼Œä¸åŒçš„ key ä¸ 1111ï¼ˆn ä¸ªï¼‰è¿›è¡Œä¸é¢„ç®—å¾—åˆ°ç›¸åŒä¸‹æ ‡çš„å‡ ç‡è¾ƒå°ï¼Œå‘ç”Ÿç¢°æ’çš„å‡ ç‡å°ã€‚ </p>\n<h4 id=\"JDK1-8æ–°å¢çº¢é»‘æ ‘\"><a href=\"#JDK1-8æ–°å¢çº¢é»‘æ ‘\" class=\"headerlink\" title=\"JDK1.8æ–°å¢çº¢é»‘æ ‘\"></a>JDK1.8æ–°å¢çº¢é»‘æ ‘</h4><p>ä¸ºäº†è§£å†³ä¸€æ¡é“¾ä¸Šçš„å…ƒç´ è¿‡å¤šï¼ŒæŸ¥æ‰¾æ•ˆç‡ä½çš„é—®é¢˜ï¼Œå°†é“¾è¡¨è½¬åŒ–ä¸ºçº¢é»‘æ ‘ï¼Œéå†å¤æ‚åº¦é™ä½è‡³ O(logn)ï¼›</p>\n<h4 id=\"HashMapæ˜¯ä½¿ç”¨äº†å“ªäº›æ–¹æ³•æ¥æœ‰æ•ˆè§£å†³å“ˆå¸Œå†²çªçš„ï¼Ÿ\"><a href=\"#HashMapæ˜¯ä½¿ç”¨äº†å“ªäº›æ–¹æ³•æ¥æœ‰æ•ˆè§£å†³å“ˆå¸Œå†²çªçš„ï¼Ÿ\" class=\"headerlink\" title=\"HashMapæ˜¯ä½¿ç”¨äº†å“ªäº›æ–¹æ³•æ¥æœ‰æ•ˆè§£å†³å“ˆå¸Œå†²çªçš„ï¼Ÿ\"></a>HashMapæ˜¯ä½¿ç”¨äº†å“ªäº›æ–¹æ³•æ¥æœ‰æ•ˆè§£å†³å“ˆå¸Œå†²çªçš„ï¼Ÿ</h4><ol>\n<li>ä½¿ç”¨é“¾åœ°å€æ³•ï¼ˆä½¿ç”¨æ•£åˆ—è¡¨ï¼‰æ¥é“¾æ¥æ‹¥æœ‰ç›¸åŒ hash å€¼çš„æ•°æ®ï¼›</li>\n<li>ä½¿ç”¨ 2 æ¬¡æ‰°åŠ¨å‡½æ•°ï¼ˆ1 æ¬¡ä½è¿ç®—å’Œ 1 æ¬¡å¼‚æˆ–è¿ç®—ï¼‰æ¥é™ä½å“ˆå¸Œå†²çªçš„æ¦‚ç‡ï¼Œä½¿å¾—æ•°æ®åˆ†å¸ƒæ›´å¹³å‡ï¼›</li>\n<li>å¼•å…¥çº¢é»‘æ ‘è¿›ä¸€æ­¥é™ä½éå†çš„æ—¶é—´å¤æ‚åº¦ï¼Œä½¿å¾—éå†æ›´å¿«ã€‚</li>\n</ol>\n<h3 id=\"HashMapçš„getæ–¹æ³•çš„å…·ä½“æµç¨‹ï¼Ÿ\"><a href=\"#HashMapçš„getæ–¹æ³•çš„å…·ä½“æµç¨‹ï¼Ÿ\" class=\"headerlink\" title=\"HashMapçš„getæ–¹æ³•çš„å…·ä½“æµç¨‹ï¼Ÿ\"></a>HashMapçš„getæ–¹æ³•çš„å…·ä½“æµç¨‹ï¼Ÿ</h3><ol>\n<li>å…ˆä½¿ç”¨ key çš„ hashCodeã€æ‰°åŠ¨å¤„ç†ã€ä¸æ•°ç»„é•¿åº¦-1 è¿›è¡Œä¸è¿ç®—ï¼ˆå¯¹æ•°ç»„é•¿åº¦å»ä½™ï¼‰å¾—åˆ°æ§½ä½ï¼›</li>\n<li>åˆ¤æ–­é¦–ç»“ç‚¹ï¼Œå¦‚æœé¦–ç»“ç‚¹å’Œ key çš„ <strong>hashå€¼</strong> ï¼ˆhashCode å€¼ç»è¿‡æ‰°åŠ¨å‡½æ•°å¤„ç†åçš„å€¼ï¼‰ç›¸ç­‰ï¼Œå¹¶ä¸”ä¸¤è€…çš„ <strong>keyå€¼åœ°å€ç›¸ç­‰ã€equalsç›¸ç­‰</strong>ï¼Œåˆ™è¿”å›é¦–ç»“ç‚¹ï¼›</li>\n<li>å¦åˆ™ï¼Œåˆ™çº¢é»‘æ ‘æˆ–è€…é“¾è¡¨ä¸­è¿›è¡ŒæŸ¥æ‰¾ï¼ŒæŸ¥æ‰¾æ—¶åˆ¤æ–­ä¸¤ä¸ª key çš„ hash å€¼ã€key å€¼åœ°å€ç›¸ç­‰ã€equals æ˜¯å¦éƒ½ç›¸ç­‰ã€‚</li>\n</ol>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> V <span class=\"title function_\">get</span><span class=\"params\">(Object key)</span> &#123;</span><br><span class=\"line\">    Node&lt;K,V&gt; e;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (e = getNode(hash(key), key)) == <span class=\"literal\">null</span> ? <span class=\"literal\">null</span> : e.value;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">final</span> Node&lt;K,V&gt; <span class=\"title function_\">getNode</span><span class=\"params\">(<span class=\"type\">int</span> hash, Object key)</span> &#123;</span><br><span class=\"line\">    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; first, e; <span class=\"type\">int</span> n; K k;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">//Nodeæ•°ç»„ä¸ä¸ºç©ºï¼Œæ•°ç»„é•¿åº¦å¤§äº0ï¼Œæ•°ç»„å¯¹åº”ä¸‹æ ‡çš„Nodeä¸ä¸ºç©º</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> ((tab = table) != <span class=\"literal\">null</span> &amp;&amp; (n = tab.length) &gt; <span class=\"number\">0</span> &amp;&amp;</span><br><span class=\"line\">        <span class=\"comment\">//ä¹Ÿæ˜¯é€šè¿‡ hash &amp; (length - 1) æ¥æ›¿ä»£ hash % length çš„</span></span><br><span class=\"line\">        (first = tab[(n - <span class=\"number\">1</span>) &amp; hash]) != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">//å…ˆå’Œç¬¬ä¸€ä¸ªç»“ç‚¹æ¯”ï¼Œhashå€¼ç›¸ç­‰ä¸”keyä¸ä¸ºç©ºï¼Œkeyçš„ç¬¬ä¸€ä¸ªç»“ç‚¹çš„keyçš„å¯¹è±¡åœ°å€å’Œå€¼å‡ç›¸ç­‰</span></span><br><span class=\"line\">        <span class=\"comment\">//åˆ™è¿”å›ç¬¬ä¸€ä¸ªç»“ç‚¹</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (first.hash == hash &amp;&amp; <span class=\"comment\">// always check first node</span></span><br><span class=\"line\">            ((k = first.key) == key || (key != <span class=\"literal\">null</span> &amp;&amp; key.equals(k))))</span><br><span class=\"line\">            <span class=\"keyword\">return</span> first;</span><br><span class=\"line\">        <span class=\"comment\">//å¦‚æœkeyå’Œç¬¬ä¸€ä¸ªç»“ç‚¹ä¸åŒ¹é…ï¼Œåˆ™çœ‹.nextæ˜¯å¦ä¸ºç©ºï¼Œä¸ä¸ºnullåˆ™ç»§ç»­ï¼Œä¸ºç©ºåˆ™è¿”å›null</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> ((e = first.next) != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">//å¦‚æœæ­¤æ—¶æ˜¯çº¢é»‘æ ‘çš„ç»“æ„ï¼Œåˆ™è¿›è¡Œå¤„ç†getTreeNode()æ–¹æ³•æœç´¢key</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (first <span class=\"keyword\">instanceof</span> TreeNode)</span><br><span class=\"line\">                <span class=\"keyword\">return</span> ((TreeNode&lt;K,V&gt;)first).getTreeNode(hash, key);</span><br><span class=\"line\">            <span class=\"comment\">//æ˜¯é“¾è¡¨ç»“æ„çš„è¯å°±ä¸€ä¸ªä¸€ä¸ªéå†ï¼Œç›´åˆ°æ‰¾åˆ°keyå¯¹åº”çš„ç»“ç‚¹ï¼Œ</span></span><br><span class=\"line\">            <span class=\"comment\">//æˆ–è€…eçš„ä¸‹ä¸€ä¸ªç»“ç‚¹ä¸ºnullé€€å‡ºå¾ªç¯</span></span><br><span class=\"line\">            <span class=\"keyword\">do</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (e.hash == hash &amp;&amp;</span><br><span class=\"line\">                    ((k = e.key) == key || (key != <span class=\"literal\">null</span> &amp;&amp; key.equals(k))))</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> e;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">while</span> ((e = e.next) != <span class=\"literal\">null</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"HashMapçš„putæ–¹æ³•çš„å…·ä½“æµç¨‹ï¼Ÿ\"><a href=\"#HashMapçš„putæ–¹æ³•çš„å…·ä½“æµç¨‹ï¼Ÿ\" class=\"headerlink\" title=\"HashMapçš„putæ–¹æ³•çš„å…·ä½“æµç¨‹ï¼Ÿ\"></a>HashMapçš„putæ–¹æ³•çš„å…·ä½“æµç¨‹ï¼Ÿ</h3><ol>\n<li>å¦‚æœ table æœªåˆå§‹åŒ–æˆ–è€…é•¿åº¦ä¸º 0 ç©ºåˆ™æ‰§è¡Œ resize()è¿›è¡Œæ‰©å®¹ï¼Œè½¬å‘â‘¡</li>\n<li>æ ¹æ®é”®å€¼ key è®¡ç®— hash å€¼å¾—åˆ°æ’å…¥çš„æ•°ç»„ç´¢å¼• iï¼Œå¦‚æœ table[i]&#x3D;&#x3D;nullï¼Œå³æ•°ç»„è¯¥ä½ç½®ä¸Šæ²¡æœ‰å…ƒç´ ï¼Œç›´æ¥æ–°å»ºèŠ‚ç‚¹æ’å…¥ï¼Œè½¬å‘â‘¥åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹ï¼Œå¦‚æœ table[i]ä¸ä¸ºç©ºï¼Œè½¬å‘â‘¢ï¼›</li>\n<li>åˆ¤æ–­ table[i]çš„é¦–ä¸ªå…ƒç´ æ˜¯å¦å’Œ key ä¸€æ ·ï¼Œå¦‚æœç›¸åŒï¼ˆhashCode ç›¸åŒã€key åœ°å€ç›¸åŒã€equals ç›¸åŒï¼‰ç›´æ¥è¦†ç›– valueï¼Œå¦åˆ™è½¬å‘â‘£ï¼›</li>\n<li>åˆ¤æ–­ table[i] æ˜¯å¦ä¸º treeNodeï¼Œå³ table[i] æ˜¯å¦æ˜¯çº¢é»‘æ ‘ï¼Œå¦‚æœæ˜¯çº¢é»‘æ ‘ï¼Œåˆ™ç›´æ¥åœ¨æ ‘ä¸­æ’å…¥é”®å€¼å¯¹ï¼Œå¦åˆ™è½¬å‘â‘¤ï¼›</li>\n<li>éå† table[i]ï¼Œåˆ¤æ–­é“¾è¡¨é•¿åº¦æ˜¯å¦å¤§äº 8ï¼Œå¤§äº 8 çš„è¯æŠŠé“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼Œåœ¨çº¢é»‘æ ‘ä¸­æ‰§è¡Œæ’å…¥æ“ä½œï¼Œå¦åˆ™è¿›è¡Œé“¾è¡¨çš„æ’å…¥æ“ä½œï¼›éå†è¿‡ç¨‹ä¸­è‹¥å‘ç° key å·²ç»å­˜åœ¨ç›´æ¥è¦†ç›– value å³å¯ï¼›</li>\n<li>æ’å…¥æˆåŠŸåï¼Œåˆ¤æ–­å®é™…å­˜åœ¨çš„é”®å€¼å¯¹æ•°é‡ size æ˜¯å¦è¶…å‡ºå½“å‰æœ€å¤§å®¹é‡ thresholdï¼Œå¦‚æœè¶…è¿‡ï¼Œè¿›è¡Œæ‰©å®¹ã€‚</li>\n</ol>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> V <span class=\"title function_\">put</span><span class=\"params\">(K key, V value)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> putVal(hash(key), key, value, <span class=\"literal\">false</span>, <span class=\"literal\">true</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"title function_\">hash</span><span class=\"params\">(Object key)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> h;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (key == <span class=\"literal\">null</span>) ? <span class=\"number\">0</span> : (h = key.hashCode()) ^ (h &gt;&gt;&gt; <span class=\"number\">16</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//å®ç°Map.putå’Œç›¸å…³æ–¹æ³•</span></span><br><span class=\"line\"><span class=\"keyword\">final</span> V <span class=\"title function_\">putVal</span><span class=\"params\">(<span class=\"type\">int</span> hash, K key, V value, <span class=\"type\">boolean</span> onlyIfAbsent,</span></span><br><span class=\"line\"><span class=\"params\">                   <span class=\"type\">boolean</span> evict)</span> &#123;</span><br><span class=\"line\">    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; <span class=\"type\">int</span> n, i;</span><br><span class=\"line\">    <span class=\"comment\">// æ­¥éª¤â‘ ï¼štabä¸ºç©ºåˆ™åˆ›å»º </span></span><br><span class=\"line\">    <span class=\"comment\">// tableæœªåˆå§‹åŒ–æˆ–è€…é•¿åº¦ä¸º0ï¼Œè¿›è¡Œæ‰©å®¹</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> ((tab = table) == <span class=\"literal\">null</span> || (n = tab.length) == <span class=\"number\">0</span>)</span><br><span class=\"line\">        n = (tab = resize()).length;</span><br><span class=\"line\">    <span class=\"comment\">// æ­¥éª¤â‘¡ï¼šè®¡ç®—indexï¼Œå¹¶å¯¹nullåšå¤„ç†  </span></span><br><span class=\"line\">    <span class=\"comment\">// (n - 1) &amp; hash ç¡®å®šå…ƒç´ å­˜æ”¾åœ¨å“ªä¸ªæ¡¶ä¸­ï¼Œæ¡¶ä¸ºç©ºï¼Œæ–°ç”Ÿæˆç»“ç‚¹æ”¾å…¥æ¡¶ä¸­(æ­¤æ—¶ï¼Œè¿™ä¸ªç»“ç‚¹æ˜¯æ”¾åœ¨æ•°ç»„ä¸­)</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> ((p = tab[i = (n - <span class=\"number\">1</span>) &amp; hash]) == <span class=\"literal\">null</span>)</span><br><span class=\"line\">        tab[i] = newNode(hash, key, value, <span class=\"literal\">null</span>);</span><br><span class=\"line\">    <span class=\"comment\">// æ¡¶ä¸­å·²ç»å­˜åœ¨å…ƒç´ </span></span><br><span class=\"line\">    <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        Node&lt;K,V&gt; e; K k;</span><br><span class=\"line\">        <span class=\"comment\">// æ­¥éª¤â‘¢ï¼šèŠ‚ç‚¹keyå­˜åœ¨ï¼Œç›´æ¥è¦†ç›–value </span></span><br><span class=\"line\">        <span class=\"comment\">// æ¯”è¾ƒæ¡¶ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ (æ•°ç»„ä¸­çš„ç»“ç‚¹)çš„hashå€¼ç›¸ç­‰ï¼Œkeyç›¸ç­‰</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (p.hash == hash &amp;&amp;</span><br><span class=\"line\">            ((k = p.key) == key || (key != <span class=\"literal\">null</span> &amp;&amp; key.equals(k))))</span><br><span class=\"line\">                <span class=\"comment\">// å°†ç¬¬ä¸€ä¸ªå…ƒç´ èµ‹å€¼ç»™eï¼Œç”¨eæ¥è®°å½•</span></span><br><span class=\"line\">                e = p;</span><br><span class=\"line\">        <span class=\"comment\">// æ­¥éª¤â‘£ï¼šåˆ¤æ–­è¯¥é“¾ä¸ºçº¢é»‘æ ‘ </span></span><br><span class=\"line\">        <span class=\"comment\">// hashå€¼ä¸ç›¸ç­‰ï¼Œå³keyä¸ç›¸ç­‰ï¼›ä¸ºçº¢é»‘æ ‘ç»“ç‚¹</span></span><br><span class=\"line\">        <span class=\"comment\">// å¦‚æœå½“å‰å…ƒç´ ç±»å‹ä¸ºTreeNodeï¼Œè¡¨ç¤ºä¸ºçº¢é»‘æ ‘ï¼ŒputTreeValè¿”å›å¾…å­˜æ”¾çš„node, eå¯èƒ½ä¸ºnull</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (p <span class=\"keyword\">instanceof</span> TreeNode)</span><br><span class=\"line\">            <span class=\"comment\">// æ”¾å…¥æ ‘ä¸­</span></span><br><span class=\"line\">            e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(<span class=\"built_in\">this</span>, tab, hash, key, value);</span><br><span class=\"line\">        <span class=\"comment\">// æ­¥éª¤â‘¤ï¼šè¯¥é“¾ä¸ºé“¾è¡¨ </span></span><br><span class=\"line\">        <span class=\"comment\">// ä¸ºé“¾è¡¨ç»“ç‚¹</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// åœ¨é“¾è¡¨æœ€æœ«æ’å…¥ç»“ç‚¹</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">binCount</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; ; ++binCount) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// åˆ°è¾¾é“¾è¡¨çš„å°¾éƒ¨</span></span><br><span class=\"line\">                </span><br><span class=\"line\">                <span class=\"comment\">//åˆ¤æ–­è¯¥é“¾è¡¨å°¾éƒ¨æŒ‡é’ˆæ˜¯ä¸æ˜¯ç©ºçš„</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> ((e = p.next) == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// åœ¨å°¾éƒ¨æ’å…¥æ–°ç»“ç‚¹</span></span><br><span class=\"line\">                    p.next = newNode(hash, key, value, <span class=\"literal\">null</span>);</span><br><span class=\"line\">                    <span class=\"comment\">//åˆ¤æ–­é“¾è¡¨çš„é•¿åº¦æ˜¯å¦è¾¾åˆ°è½¬åŒ–çº¢é»‘æ ‘çš„ä¸´ç•Œå€¼ï¼Œä¸´ç•Œå€¼ä¸º8</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class=\"number\">1</span>) <span class=\"comment\">// -1 for 1st</span></span><br><span class=\"line\">                        <span class=\"comment\">//é“¾è¡¨ç»“æ„è½¬æ ‘å½¢ç»“æ„</span></span><br><span class=\"line\">                        treeifyBin(tab, hash);</span><br><span class=\"line\">                    <span class=\"comment\">// è·³å‡ºå¾ªç¯</span></span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"comment\">// åˆ¤æ–­é“¾è¡¨ä¸­ç»“ç‚¹çš„keyå€¼ä¸æ’å…¥çš„å…ƒç´ çš„keyå€¼æ˜¯å¦ç›¸ç­‰</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (e.hash == hash &amp;&amp;</span><br><span class=\"line\">                    ((k = e.key) == key || (key != <span class=\"literal\">null</span> &amp;&amp; key.equals(k))))</span><br><span class=\"line\">                    <span class=\"comment\">// ç›¸ç­‰ï¼Œè·³å‡ºå¾ªç¯</span></span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                <span class=\"comment\">// ç”¨äºéå†æ¡¶ä¸­çš„é“¾è¡¨ï¼Œä¸å‰é¢çš„e = p.nextç»„åˆï¼Œå¯ä»¥éå†é“¾è¡¨</span></span><br><span class=\"line\">                p = e;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">//åˆ¤æ–­å½“å‰çš„keyå·²ç»å­˜åœ¨çš„æƒ…å†µä¸‹ï¼Œå†æ¥ä¸€ä¸ªç›¸åŒçš„hashå€¼ã€keyå€¼æ—¶ï¼Œè¿”å›æ–°æ¥çš„valueè¿™ä¸ªå€¼</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (e != <span class=\"literal\">null</span>) &#123; </span><br><span class=\"line\">            <span class=\"comment\">// è®°å½•eçš„value</span></span><br><span class=\"line\">            <span class=\"type\">V</span> <span class=\"variable\">oldValue</span> <span class=\"operator\">=</span> e.value;</span><br><span class=\"line\">            <span class=\"comment\">// onlyIfAbsentä¸ºfalseæˆ–è€…æ—§å€¼ä¸ºnull</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!onlyIfAbsent || oldValue == <span class=\"literal\">null</span>)</span><br><span class=\"line\">                <span class=\"comment\">//ç”¨æ–°å€¼æ›¿æ¢æ—§å€¼</span></span><br><span class=\"line\">                e.value = value;</span><br><span class=\"line\">            <span class=\"comment\">// è®¿é—®åå›è°ƒ</span></span><br><span class=\"line\">            afterNodeAccess(e);</span><br><span class=\"line\">            <span class=\"comment\">// è¿”å›æ—§å€¼</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> oldValue;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// ç»“æ„æ€§ä¿®æ”¹</span></span><br><span class=\"line\">    ++modCount;</span><br><span class=\"line\">    <span class=\"comment\">// æ­¥éª¤â‘¥ï¼šè¶…è¿‡æœ€å¤§å®¹é‡å°±æ‰©å®¹ </span></span><br><span class=\"line\">    <span class=\"comment\">// å®é™…å¤§å°å¤§äºé˜ˆå€¼åˆ™æ‰©å®¹</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (++size &gt; threshold)</span><br><span class=\"line\">        resize();</span><br><span class=\"line\">    <span class=\"comment\">// æ’å…¥åå›è°ƒ</span></span><br><span class=\"line\">    afterNodeInsertion(evict);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"HashMapçš„æ‰©å®¹æ“ä½œæ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ\"><a href=\"#HashMapçš„æ‰©å®¹æ“ä½œæ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ\" class=\"headerlink\" title=\"HashMapçš„æ‰©å®¹æ“ä½œæ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ\"></a>HashMapçš„æ‰©å®¹æ“ä½œæ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ</h3><p>â‘ .åœ¨ jdk1.8 ä¸­ï¼Œresize æ–¹æ³•æ˜¯åœ¨ hashmap ä¸­çš„é”®å€¼å¯¹ï¼ˆå…ƒç´ æ•°é‡ï¼‰å¤§äºé˜€å€¼æ—¶ï¼ˆé˜ˆå€¼ä¸ºå®¹é‡*è´Ÿè½½å› å­ï¼‰æ‰©å®¹ä¸ºåŸå®¹é‡çš„ 2 å€ï¼Œæˆ–è€…åˆå§‹åŒ–æ—¶ï¼ˆæ‰©å®¹ä¸º 16ï¼‰ï¼Œå°±è°ƒç”¨ resize æ–¹æ³•è¿›è¡Œæ‰©å®¹ï¼›</p>\n<p>â‘¡.åœ¨ 1.7 ä¸­ï¼Œæ‰©å®¹ä¹‹åéœ€è¦é‡æ–°å»è®¡ç®—å…¶ Hash å€¼ï¼Œæ ¹æ® Hash å€¼å¯¹å…¶è¿›è¡Œåˆ†å‘ï¼Œä½†åœ¨ 1.8 ç‰ˆæœ¬ä¸­ï¼Œåˆ™æ˜¯æ ¹æ®åœ¨åŒä¸€ä¸ªæ¡¶çš„ä½ç½®ä¸­è¿›è¡Œåˆ¤æ–­(e.hash &amp; oldCap)æ˜¯å¦ä¸º 0ï¼Œé‡æ–°è¿›è¡Œ hash åˆ†é…åï¼Œè¯¥å…ƒç´  hash å€¼ä¸æ—§å®¹é‡ä¸è¿ç®—ä¸º 0 åˆ™ç•™åœ¨åŸå§‹ä½ç½®ï¼Œhash å€¼ä¸æ—§å®¹é‡ä¸è¿ç®—ä¸º 1 åˆ™ç§»åŠ¨åˆ° åŸä½ç½® + oldCap è¿™ä¸ªä½ç½®ä¸Š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes20190128152700351.png\" alt=\"HashMapçš„resizeæ“ä½œ\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">final</span> Node&lt;K,V&gt;[] resize() &#123;</span><br><span class=\"line\">    Node&lt;K,V&gt;[] oldTab = table;<span class=\"comment\">//oldTabæŒ‡å‘hashæ¡¶æ•°ç»„</span></span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">oldCap</span> <span class=\"operator\">=</span> (oldTab == <span class=\"literal\">null</span>) ? <span class=\"number\">0</span> : oldTab.length;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">oldThr</span> <span class=\"operator\">=</span> threshold;</span><br><span class=\"line\">    <span class=\"type\">int</span> newCap, newThr = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (oldCap &gt; <span class=\"number\">0</span>) &#123;<span class=\"comment\">//å¦‚æœoldCapä¸ä¸ºç©ºçš„è¯ï¼Œå°±æ˜¯hashæ¡¶æ•°ç»„ä¸ä¸ºç©º</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (oldCap &gt;= MAXIMUM_CAPACITY) &#123;<span class=\"comment\">//å¦‚æœå¤§äºæœ€å¤§å®¹é‡äº†ï¼Œå°±èµ‹å€¼ä¸ºæ•´æ•°æœ€å¤§çš„é˜€å€¼</span></span><br><span class=\"line\">            threshold = Integer.MAX_VALUE;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> oldTab;<span class=\"comment\">//è¿”å›</span></span><br><span class=\"line\">        &#125;<span class=\"comment\">//å¦‚æœå½“å‰hashæ¡¶æ•°ç»„çš„é•¿åº¦åœ¨æ‰©å®¹åä»ç„¶å°äºæœ€å¤§å®¹é‡ å¹¶ä¸”oldCapå¤§äºé»˜è®¤å€¼16</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> ((newCap = oldCap &lt;&lt; <span class=\"number\">1</span>) &lt; MAXIMUM_CAPACITY &amp;&amp;</span><br><span class=\"line\">                 oldCap &gt;= DEFAULT_INITIAL_CAPACITY)</span><br><span class=\"line\">            newThr = oldThr &lt;&lt; <span class=\"number\">1</span>; <span class=\"comment\">// double threshold åŒå€æ‰©å®¹é˜€å€¼threshold</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// æ—§çš„å®¹é‡ä¸º0ï¼Œä½†thresholdå¤§äºé›¶ï¼Œä»£è¡¨æœ‰å‚æ„é€ æœ‰capä¼ å…¥ï¼Œthresholdå·²ç»è¢«åˆå§‹åŒ–æˆæœ€å°2çš„næ¬¡å¹‚</span></span><br><span class=\"line\">    <span class=\"comment\">// ç›´æ¥å°†è¯¥å€¼èµ‹ç»™æ–°çš„å®¹é‡</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (oldThr &gt; <span class=\"number\">0</span>) <span class=\"comment\">// initial capacity was placed in threshold</span></span><br><span class=\"line\">        newCap = oldThr;</span><br><span class=\"line\">    <span class=\"comment\">// æ— å‚æ„é€ åˆ›å»ºçš„mapï¼Œç»™å‡ºé»˜è®¤å®¹é‡å’Œthreshold 16, 16*0.75</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span> &#123;               <span class=\"comment\">// zero initial threshold signifies using defaults</span></span><br><span class=\"line\">        newCap = DEFAULT_INITIAL_CAPACITY;</span><br><span class=\"line\">        newThr = (<span class=\"type\">int</span>)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// æ–°çš„threshold = æ–°çš„cap * 0.75</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (newThr == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"type\">float</span> <span class=\"variable\">ft</span> <span class=\"operator\">=</span> (<span class=\"type\">float</span>)newCap * loadFactor;</span><br><span class=\"line\">        newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (<span class=\"type\">float</span>)MAXIMUM_CAPACITY ?</span><br><span class=\"line\">                  (<span class=\"type\">int</span>)ft : Integer.MAX_VALUE);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    threshold = newThr;</span><br><span class=\"line\">    <span class=\"comment\">// è®¡ç®—å‡ºæ–°çš„æ•°ç»„é•¿åº¦åèµ‹ç»™å½“å‰æˆå‘˜å˜é‡table</span></span><br><span class=\"line\">    <span class=\"meta\">@SuppressWarnings(&#123;&quot;rawtypes&quot;,&quot;unchecked&quot;&#125;)</span></span><br><span class=\"line\">        Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])<span class=\"keyword\">new</span> <span class=\"title class_\">Node</span>[newCap];<span class=\"comment\">//æ–°å»ºhashæ¡¶æ•°ç»„</span></span><br><span class=\"line\">    table = newTab;<span class=\"comment\">//å°†æ–°æ•°ç»„çš„å€¼å¤åˆ¶ç»™æ—§çš„hashæ¡¶æ•°ç»„</span></span><br><span class=\"line\">    <span class=\"comment\">// å¦‚æœåŸå…ˆçš„æ•°ç»„æ²¡æœ‰åˆå§‹åŒ–ï¼Œé‚£ä¹ˆresizeçš„åˆå§‹åŒ–å·¥ä½œåˆ°æ­¤ç»“æŸï¼Œå¦åˆ™è¿›å…¥æ‰©å®¹å…ƒç´ é‡æ’é€»è¾‘ï¼Œä½¿å…¶å‡åŒ€çš„åˆ†æ•£</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (oldTab != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// éå†æ–°æ•°ç»„çš„æ‰€æœ‰æ¡¶ä¸‹æ ‡</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">j</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; j &lt; oldCap; ++j) &#123;</span><br><span class=\"line\">            Node&lt;K,V&gt; e;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> ((e = oldTab[j]) != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// æ—§æ•°ç»„çš„æ¡¶ä¸‹æ ‡èµ‹ç»™ä¸´æ—¶å˜é‡eï¼Œå¹¶ä¸”è§£é™¤æ—§æ•°ç»„ä¸­çš„å¼•ç”¨ï¼Œå¦åˆ™å°±æ•°ç»„æ— æ³•è¢«GCå›æ”¶</span></span><br><span class=\"line\">                oldTab[j] = <span class=\"literal\">null</span>;</span><br><span class=\"line\">                <span class=\"comment\">// å¦‚æœe.next==nullï¼Œä»£è¡¨æ¡¶ä¸­å°±ä¸€ä¸ªå…ƒç´ ï¼Œä¸å­˜åœ¨é“¾è¡¨æˆ–è€…çº¢é»‘æ ‘</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (e.next == <span class=\"literal\">null</span>)</span><br><span class=\"line\">                    <span class=\"comment\">// ç”¨åŒæ ·çš„hashæ˜ å°„ç®—æ³•æŠŠè¯¥å…ƒç´ åŠ å…¥æ–°çš„æ•°ç»„</span></span><br><span class=\"line\">                    newTab[e.hash &amp; (newCap - <span class=\"number\">1</span>)] = e;</span><br><span class=\"line\">                <span class=\"comment\">// å¦‚æœeæ˜¯TreeNodeå¹¶ä¸”e.next!=nullï¼Œé‚£ä¹ˆå¤„ç†æ ‘ä¸­å…ƒç´ çš„é‡æ’</span></span><br><span class=\"line\">                <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (e <span class=\"keyword\">instanceof</span> TreeNode)</span><br><span class=\"line\">                    ((TreeNode&lt;K,V&gt;)e).split(<span class=\"built_in\">this</span>, newTab, j, oldCap);</span><br><span class=\"line\">                <span class=\"comment\">// eæ˜¯é“¾è¡¨çš„å¤´å¹¶ä¸”e.next!=nullï¼Œé‚£ä¹ˆå¤„ç†é“¾è¡¨ä¸­å…ƒç´ é‡æ’</span></span><br><span class=\"line\">                <span class=\"keyword\">else</span> &#123; <span class=\"comment\">// preserve order</span></span><br><span class=\"line\">                    <span class=\"comment\">// loHead,loTail ä»£è¡¨æ‰©å®¹åä¸ç”¨å˜æ¢ä¸‹æ ‡ï¼Œè§æ³¨1</span></span><br><span class=\"line\">                    Node&lt;K,V&gt; loHead = <span class=\"literal\">null</span>, loTail = <span class=\"literal\">null</span>;</span><br><span class=\"line\">                    <span class=\"comment\">// hiHead,hiTail ä»£è¡¨æ‰©å®¹åå˜æ¢ä¸‹æ ‡ï¼Œè§æ³¨1</span></span><br><span class=\"line\">                    Node&lt;K,V&gt; hiHead = <span class=\"literal\">null</span>, hiTail = <span class=\"literal\">null</span>;</span><br><span class=\"line\">                    Node&lt;K,V&gt; next;</span><br><span class=\"line\">                    <span class=\"comment\">// éå†é“¾è¡¨</span></span><br><span class=\"line\">                    <span class=\"keyword\">do</span> &#123;             </span><br><span class=\"line\">                        next = e.next;</span><br><span class=\"line\">                        <span class=\"keyword\">if</span> ((e.hash &amp; oldCap) == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                            <span class=\"keyword\">if</span> (loTail == <span class=\"literal\">null</span>)</span><br><span class=\"line\">                                <span class=\"comment\">// åˆå§‹åŒ–headæŒ‡å‘é“¾è¡¨å½“å‰å…ƒç´ eï¼Œeä¸ä¸€å®šæ˜¯é“¾è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œåˆå§‹åŒ–åloHead</span></span><br><span class=\"line\">                                <span class=\"comment\">// ä»£è¡¨ä¸‹æ ‡ä¿æŒä¸å˜çš„é“¾è¡¨çš„å¤´å…ƒç´ </span></span><br><span class=\"line\">                                loHead = e;</span><br><span class=\"line\">                            <span class=\"keyword\">else</span>                                </span><br><span class=\"line\">                                <span class=\"comment\">// loTail.nextæŒ‡å‘å½“å‰e</span></span><br><span class=\"line\">                                loTail.next = e;</span><br><span class=\"line\">                            <span class=\"comment\">// loTailæŒ‡å‘å½“å‰çš„å…ƒç´ e</span></span><br><span class=\"line\">                            <span class=\"comment\">// åˆå§‹åŒ–åï¼ŒloTailå’ŒloHeadæŒ‡å‘ç›¸åŒçš„å†…å­˜ï¼Œæ‰€ä»¥å½“loTail.nextæŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œ</span></span><br><span class=\"line\">                            <span class=\"comment\">// åº•å±‚æ•°ç»„ä¸­çš„å…ƒç´ çš„nextå¼•ç”¨ä¹Ÿç›¸åº”å‘ç”Ÿå˜åŒ–ï¼Œé€ æˆlowHead.next.next.....</span></span><br><span class=\"line\">                            <span class=\"comment\">// è·ŸéšloTailåŒæ­¥ï¼Œä½¿å¾—lowHeadå¯ä»¥é“¾æ¥åˆ°æ‰€æœ‰å±äºè¯¥é“¾è¡¨çš„å…ƒç´ ã€‚</span></span><br><span class=\"line\">                            loTail = e;                           </span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                        <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                            <span class=\"keyword\">if</span> (hiTail == <span class=\"literal\">null</span>)</span><br><span class=\"line\">                                <span class=\"comment\">// åˆå§‹åŒ–headæŒ‡å‘é“¾è¡¨å½“å‰å…ƒç´ e, åˆå§‹åŒ–åhiHeadä»£è¡¨ä¸‹æ ‡æ›´æ”¹çš„é“¾è¡¨å¤´å…ƒç´ </span></span><br><span class=\"line\">                                hiHead = e;</span><br><span class=\"line\">                            <span class=\"keyword\">else</span></span><br><span class=\"line\">                                hiTail.next = e;</span><br><span class=\"line\">                            hiTail = e;</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125; <span class=\"keyword\">while</span> ((e = next) != <span class=\"literal\">null</span>);</span><br><span class=\"line\">                    <span class=\"comment\">// éå†ç»“æŸ, å°†tailæŒ‡å‘nullï¼Œå¹¶æŠŠé“¾è¡¨å¤´æ”¾å…¥æ–°æ•°ç»„çš„ç›¸åº”ä¸‹æ ‡ï¼Œå½¢æˆæ–°çš„æ˜ å°„ã€‚</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (loTail != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                        loTail.next = <span class=\"literal\">null</span>;</span><br><span class=\"line\">                        newTab[j] = loHead;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (hiTail != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                        hiTail.next = <span class=\"literal\">null</span>;</span><br><span class=\"line\">                        newTab[j + oldCap] = hiHead;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> newTab;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"HashMapè´Ÿè½½å› å­ä¸ºä»€ä¹ˆè®¾ç½®ä¸º-0-75\"><a href=\"#HashMapè´Ÿè½½å› å­ä¸ºä»€ä¹ˆè®¾ç½®ä¸º-0-75\" class=\"headerlink\" title=\"HashMapè´Ÿè½½å› å­ä¸ºä»€ä¹ˆè®¾ç½®ä¸º 0.75?\"></a>HashMapè´Ÿè½½å› å­ä¸ºä»€ä¹ˆè®¾ç½®ä¸º 0.75?</h3><p>hashmap çš„æºç ä¸­æœ‰ä¸€æ®µæ³¨é‡Šè§£é‡Šäº†ä¸ºä»€ä¹ˆè®¾ç½®ä¸º 0.75ï¼Œæ˜¯<strong>ç©ºé—´å’Œæ—¶é—´æ•ˆç‡çš„æŠ˜ä¸­è€ƒè™‘</strong>ã€‚</p>\n<h3 id=\"èƒ½å¦ä½¿ç”¨ä»»ä½•ç±»ä½œä¸º-Map-çš„-keyï¼Ÿ\"><a href=\"#èƒ½å¦ä½¿ç”¨ä»»ä½•ç±»ä½œä¸º-Map-çš„-keyï¼Ÿ\" class=\"headerlink\" title=\"èƒ½å¦ä½¿ç”¨ä»»ä½•ç±»ä½œä¸º Map çš„ keyï¼Ÿ\"></a>èƒ½å¦ä½¿ç”¨ä»»ä½•ç±»ä½œä¸º Map çš„ keyï¼Ÿ</h3><p>å¯ä»¥ä½¿ç”¨ä»»ä½•ç±»ä½œä¸º Map çš„ keyï¼Œå‰ææ˜¯è¯¥ç±»é‡å†™äº† hashCode å’Œ equals æ–¹æ³•ã€‚é‡å†™ hashCode() æ˜¯ä¸ºäº†è®¡ç®—æ•°æ®çš„å­˜å‚¨ä½ç½®ï¼Œé‡å†™ equals æ–¹æ³•æ˜¯ä¸ºäº†ç¡®ä¿ key åœ¨å“ˆå¸Œè¡¨ä¸­çš„å”¯ä¸€æ€§ã€‚æœ€ç»ˆç›®çš„æ˜¯ä¸ºäº†ä¿è¯ Map ä¸­é”® key çš„å”¯ä¸€æ€§ã€‚</p>\n<h3 id=\"ä¸ºä»€ä¹ˆHashMapä¸­Stringã€Integerè¿™æ ·çš„åŒ…è£…ç±»é€‚åˆä½œä¸ºkeyï¼Ÿ\"><a href=\"#ä¸ºä»€ä¹ˆHashMapä¸­Stringã€Integerè¿™æ ·çš„åŒ…è£…ç±»é€‚åˆä½œä¸ºkeyï¼Ÿ\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆHashMapä¸­Stringã€Integerè¿™æ ·çš„åŒ…è£…ç±»é€‚åˆä½œä¸ºkeyï¼Ÿ\"></a>ä¸ºä»€ä¹ˆHashMapä¸­Stringã€Integerè¿™æ ·çš„åŒ…è£…ç±»é€‚åˆä½œä¸ºkeyï¼Ÿ</h3><p>é‡å†™äº† hashCode å’Œ equals æ–¹æ³•ï¼Œä¿è¯äº† Map ä¸­é”®<strong>keyçš„å”¯ä¸€æ€§</strong>ã€‚å¹¶ä¸”ä»–ä»¬éƒ½ä¸å¯å˜ï¼Œå¯ä»¥å°†å®ƒä»¬çš„ hash å€¼<strong>ç¼“å­˜ä¸‹æ¥ï¼Œæé«˜æ•ˆç‡</strong>ã€‚</p>\n<h3 id=\"HashMap-ä¸-HashTable-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"><a href=\"#HashMap-ä¸-HashTable-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"HashMap ä¸ HashTable æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"></a>HashMap ä¸ HashTable æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><ol>\n<li><strong>çº¿ç¨‹å®‰å…¨</strong>ï¼š HashMap æ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼ŒHashTable æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå†…éƒ¨çš„æ–¹æ³•åŸºæœ¬éƒ½ç»è¿‡ <code>synchronized</code> ä¿®é¥°ï¼›</li>\n<li><strong>æ•ˆç‡</strong>ï¼š å› ä¸ºçº¿ç¨‹å®‰å…¨çš„é—®é¢˜ synchronizedï¼ŒHashMap è¦æ¯” HashTable æ•ˆç‡é«˜ä¸€ç‚¹ï¼›</li>\n<li><strong>å¯¹Null key å’ŒNull valueçš„æ”¯æŒ</strong>ï¼š HashMap ä¸­ï¼Œnull å¯ä»¥ä½œä¸ºé”®ï¼Œè¿™æ ·çš„é”®åªæœ‰ä¸€ä¸ªï¼Œå¯ä»¥æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªé”®æ‰€å¯¹åº”çš„å€¼ä¸º nullã€‚ä½†æ˜¯åœ¨ HashTable ä¸­ put è¿›çš„é”®å€¼åªè¦æœ‰ä¸€ä¸ª nullï¼Œç›´æ¥æŠ› NullPointerExceptionï¼›</li>\n<li>**åˆå§‹å®¹é‡å¤§å°å’Œæ¯æ¬¡æ‰©å……å®¹é‡å¤§å°çš„ä¸åŒ **ï¼š<br> â‘ åˆ›å»ºæ—¶å¦‚æœä¸æŒ‡å®šå®¹é‡åˆå§‹å€¼ï¼ŒHashTable é»˜è®¤çš„åˆå§‹å¤§å°ä¸º 11ï¼Œä¹‹åæ¯æ¬¡æ‰©å……ï¼Œå®¹é‡å˜ä¸ºåŸæ¥çš„ 2n+1ã€‚HashMap é»˜è®¤çš„åˆå§‹åŒ–å¤§å°ä¸º 16ã€‚ä¹‹åæ¯æ¬¡æ‰©å……ï¼Œå®¹é‡å˜ä¸ºåŸæ¥çš„ 2 å€ï¼›<br> â‘¡åˆ›å»ºæ—¶å¦‚æœç»™å®šäº†å®¹é‡åˆå§‹å€¼ï¼Œé‚£ä¹ˆ HashTable ä¼šç›´æ¥ä½¿ç”¨ä½ ç»™å®šçš„å¤§å°ï¼Œè€Œ HashMap ä¼šå°†å…¶æ‰©å……ä¸º 2 çš„å¹‚æ¬¡æ–¹å¤§å°ã€‚ä¹Ÿå°±æ˜¯è¯´ HashMap æ€»æ˜¯ä½¿ç”¨ 2 çš„å¹‚ä½œä¸ºå“ˆå¸Œè¡¨çš„å¤§å°ï¼›</li>\n<li><strong>åº•å±‚æ•°æ®ç»“æ„</strong>ï¼š JDK1.8 ä»¥åçš„ HashMap åœ¨è§£å†³å“ˆå¸Œå†²çªæ—¶æœ‰äº†è¾ƒå¤§çš„å˜åŒ–ï¼Œå½“é“¾è¡¨é•¿åº¦å¤§äºé˜ˆå€¼ï¼ˆé»˜è®¤ä¸º 8ï¼‰æ—¶ï¼Œå°†é“¾è¡¨è½¬åŒ–ä¸ºçº¢é»‘æ ‘ï¼Œä»¥å‡å°‘æœç´¢æ—¶é—´ã€‚HashTable æ²¡æœ‰è¿™æ ·çš„æœºåˆ¶ã€‚</li>\n</ol>\n<h3 id=\"ConcurrentHashMap-å’Œ-HashTable-çš„åŒºåˆ«ï¼Ÿ\"><a href=\"#ConcurrentHashMap-å’Œ-HashTable-çš„åŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"ConcurrentHashMap å’Œ HashTable çš„åŒºåˆ«ï¼Ÿ\"></a>ConcurrentHashMap å’Œ HashTable çš„åŒºåˆ«ï¼Ÿ</h3><p>ConcurrentHashMap å’Œ HashTable çš„åŒºåˆ«ä¸»è¦ä½“ç°åœ¨å®ç°çº¿ç¨‹å®‰å…¨çš„æ–¹å¼ä¸Šä¸åŒã€‚</p>\n<ul>\n<li><strong>åº•å±‚æ•°æ®ç»“æ„</strong>ï¼š<br>  JDK1.7 çš„ ConcurrentHashMap åº•å±‚é‡‡ç”¨ <strong>åˆ†æ®µçš„æ•°ç»„+é“¾è¡¨</strong> å®ç°ï¼ŒJDK1.8 é‡‡ç”¨çš„æ•°æ®ç»“æ„è·Ÿ HashMap1.8 çš„ç»“æ„ä¸€æ ·ï¼Œæ•°ç»„+é“¾è¡¨&#x2F;çº¢é»‘äºŒå‰æ ‘ã€‚<br>  HashTable å’Œ JDK1.8 ä¹‹å‰çš„ HashMap çš„åº•å±‚æ•°æ®ç»“æ„ç±»ä¼¼éƒ½æ˜¯é‡‡ç”¨ <strong>æ•°ç»„+é“¾è¡¨</strong> çš„å½¢å¼ï¼Œæ•°ç»„æ˜¯ HashMap çš„ä¸»ä½“ï¼Œé“¾è¡¨åˆ™æ˜¯ä¸»è¦ä¸ºäº†è§£å†³å“ˆå¸Œå†²çªè€Œå­˜åœ¨çš„ï¼›</li>\n<li><strong>å®ç°çº¿ç¨‹å®‰å…¨çš„æ–¹å¼ï¼ˆé‡è¦ï¼‰</strong>ï¼š<br>  â‘  <strong>åœ¨JDK1.7çš„æ—¶å€™ï¼ŒConcurrentHashMapä½¿ç”¨åˆ†æ®µé”</strong> å¯¹æ•´ä¸ªæ¡¶æ•°ç»„è¿›è¡Œäº†åˆ†å‰²åˆ†æ®µ(Segment é”ç»§æ‰¿ ReentrantLock)ï¼Œæ¯ä¸€æŠŠé”åªé”å®¹å™¨å…¶ä¸­ä¸€éƒ¨åˆ†æ•°æ®ï¼Œå¤šçº¿ç¨‹è®¿é—®å®¹å™¨é‡Œä¸åŒæ•°æ®æ®µçš„æ•°æ®ï¼Œå°±ä¸ä¼šå­˜åœ¨é”ç«äº‰ï¼Œæé«˜å¹¶å‘è®¿é—®ç‡ã€‚ï¼ˆé»˜è®¤åˆ†é… 16 ä¸ª Segmentï¼Œæ¯” HashTable æ•ˆç‡æé«˜ 16 å€ã€‚ï¼‰<br>  <strong>åˆ°äº† JDK1.8 çš„æ—¶å€™å·²ç»æ‘’å¼ƒäº†Segmentçš„æ¦‚å¿µï¼Œè€Œæ˜¯ç›´æ¥ç”¨ Node æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘çš„æ•°æ®ç»“æ„æ¥å®ç°ï¼Œå¹¶å‘æ§åˆ¶ä½¿ç”¨ synchronized å’Œ CAS æ¥æ“ä½œï¼Œsynchronizedåªé”å®šå½“å‰é“¾è¡¨æˆ–çº¢é»‘æ ‘çš„é¦–èŠ‚ç‚¹ã€‚ï¼ˆJDK1.6ä»¥å å¯¹ synchronizedé”åšäº†å¾ˆå¤šä¼˜åŒ–ï¼‰</strong> æ•´ä¸ªçœ‹èµ·æ¥å°±åƒæ˜¯ä¼˜åŒ–è¿‡ä¸”çº¿ç¨‹å®‰å…¨çš„ HashMap<br>  â‘¡ <strong>HashTable(å…¨è¡¨é”)</strong> :ä½¿ç”¨ synchronized æ¥ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œæ•ˆç‡éå¸¸ä½ä¸‹ã€‚å½“ä¸€ä¸ªçº¿ç¨‹è®¿é—®åŒæ­¥æ–¹æ³•æ—¶ï¼Œå…¶ä»–çº¿ç¨‹ä¹Ÿè®¿é—®åŒæ­¥æ–¹æ³•ï¼Œå¯èƒ½ä¼šè¿›å…¥é˜»å¡æˆ–è½®è¯¢çŠ¶æ€ï¼Œå¦‚ä½¿ç”¨ put æ·»åŠ å…ƒç´ ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¸èƒ½ä½¿ç”¨ put æ·»åŠ å…ƒç´ ï¼Œä¹Ÿä¸èƒ½ä½¿ç”¨ getï¼Œç«äº‰ä¼šè¶Šæ¥è¶Šæ¿€çƒˆæ•ˆç‡è¶Šä½ã€‚</li>\n<li>â­<strong>Jdk1.7é‡‡ç”¨åˆ†æ®µé”ï¼Œé”ç²’åº¦è¾ƒå¤§ï¼Œå®¹æ˜“å‘ç”Ÿå†²çªï¼Œå¹¶å‘é‡ä½ï¼›å› æ­¤ Jdk1.8 é‡‡ç”¨åªé”å®šæ¡¶çš„é¦–ç»“ç‚¹ï¼Œé”çš„åŠ›åº¦è¾ƒä½ï¼Œä¸å®¹æ˜“å‘ç”Ÿå†²çªï¼Œå¹¶å‘é‡é«˜ã€‚</strong></li>\n</ul>\n<p><strong>ä¸¤è€…çš„å¯¹æ¯”å›¾</strong>ï¼š</p>\n<p>HashTable:</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOC84LzIzLzE2NTY2NzdhNmYyNTYxOTY.png\" alt=\"HashTableå…¨è¡¨é”\"></p>\n<p>JDK1.7 çš„ ConcurrentHashMapï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOC84LzIzLzE2NTY2NzdhNmYwMDhiZTQ.png\" alt=\"JDK1.7çš„ConcurrentHashMapåˆ†æ®µé”\"></p>\n<p>JDK1.8 çš„ ConcurrentHashMapï¼ˆTreeBin: çº¢é»‘äºŒå‰æ ‘èŠ‚ç‚¹ Node: é“¾è¡¨èŠ‚ç‚¹ï¼‰ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOC84LzIzLzE2NTY2NzdhNmYxNGUwMzk.png\" alt=\"JDK1.8çš„ConcurrentHashMapåˆ†æ®µé”\"></p>\n","site":{"data":{}},"length":21285,"excerpt":"<blockquote>\n<p>æ•´ç†çš„Javaé›†åˆç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½","more":"</p>\n</blockquote>\n<h2 id=\"é›†åˆå®¹å™¨æ¦‚è¿°\"><a href=\"#é›†åˆå®¹å™¨æ¦‚è¿°\" class=\"headerlink\" title=\"é›†åˆå®¹å™¨æ¦‚è¿°\"></a>é›†åˆå®¹å™¨æ¦‚è¿°</h2><h3 id=\"ä»€ä¹ˆæ˜¯é›†åˆ\"><a href=\"#ä»€ä¹ˆæ˜¯é›†åˆ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯é›†åˆ\"></a>ä»€ä¹ˆæ˜¯é›†åˆ</h3><p>ç”¨äºå­˜å‚¨æ•°æ®çš„å®¹å™¨ã€‚</p>\n<h3 id=\"é›†åˆå’Œæ•°ç»„çš„åŒºåˆ«\"><a href=\"#é›†åˆå’Œæ•°ç»„çš„åŒºåˆ«\" class=\"headerlink\" title=\"é›†åˆå’Œæ•°ç»„çš„åŒºåˆ«\"></a>é›†åˆå’Œæ•°ç»„çš„åŒºåˆ«</h3><ul>\n<li>æ•°ç»„æ˜¯å›ºå®šé•¿åº¦çš„ï¼›é›†åˆå¯å˜é•¿åº¦çš„ã€‚</li>\n<li>æ•°ç»„å¯ä»¥å­˜å‚¨åŸºæœ¬æ•°æ®ç±»å‹ï¼Œä¹Ÿå¯ä»¥å­˜å‚¨å¼•ç”¨æ•°æ®ç±»å‹ï¼›é›†åˆåªèƒ½å­˜å‚¨å¼•ç”¨æ•°æ®ç±»å‹ã€‚</li>\n</ul>\n<h3 id=\"å¸¸ç”¨çš„é›†åˆç±»æœ‰å“ªäº›ï¼Ÿ\"><a href=\"#å¸¸ç”¨çš„é›†åˆç±»æœ‰å“ªäº›ï¼Ÿ\" class=\"headerlink\" title=\"å¸¸ç”¨çš„é›†åˆç±»æœ‰å“ªäº›ï¼Ÿ\"></a>å¸¸ç”¨çš„é›†åˆç±»æœ‰å“ªäº›ï¼Ÿ</h3><p>Collection æ¥å£å’Œ Map æ¥å£æ˜¯æ‰€æœ‰é›†åˆæ¡†æ¶çš„çˆ¶æ¥å£ã€‚</p>\n<p>Collection æ¥å£ï¼šå­æ¥å£åŒ…æ‹¬ Set æ¥å£å’Œ List æ¥å£</p>\n<ol>\n<li>Set æ¥å£çš„å®ç°ç±»ä¸»è¦æœ‰ï¼šHashSetã€TreeSetã€LinkedHashSet ç­‰ï¼›</li>\n<li>List æ¥å£çš„å®ç°ç±»ä¸»è¦æœ‰ï¼šArrayListã€LinkedListã€Stack ä»¥åŠ Vector ç­‰ã€‚</li>\n</ol>\n<p>Map æ¥å£ï¼šå®ç°ç±»ä¸»è¦æœ‰ HashMapã€TreeMapã€HashTableã€ConcurrentHashMap ä»¥åŠ Properties ç­‰ã€‚</p>\n<h3 id=\"Listã€Setã€Mapä¸‰è€…çš„åŒºåˆ«ï¼Ÿ\"><a href=\"#Listã€Setã€Mapä¸‰è€…çš„åŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"Listã€Setã€Mapä¸‰è€…çš„åŒºåˆ«ï¼Ÿ\"></a>Listã€Setã€Mapä¸‰è€…çš„åŒºåˆ«ï¼Ÿ</h3><p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly9pbWcyMDE4LmNuYmxvZ3MuY29tL290aGVyLzE0MDgxODMvMjAxOTExLzE0MDgxODMtMjAxOTExMTkxODQxNDk1NTktMTU3MTU5NTY2OC5qcGc.png\" alt=\"Collectionæ¶æ„\"></p>\n<p>List å’Œ Set ä¸¤å¤§æ¥å£æ˜¯ Collection çš„å­æ¥å£</p>\n<ul>\n<li><p>Listï¼šæœ‰åºå®¹å™¨ï¼Œå…ƒç´ å¯ä»¥é‡å¤ï¼Œå¯ä»¥æ’å…¥å¤šä¸ª null å…ƒç´ ï¼Œå…ƒç´ éƒ½æœ‰ç´¢å¼•ï¼›<br>  å¸¸ç”¨å®ç°ç±»ï¼šArrayListã€LinkedList å’Œ Vectorã€‚</p>\n</li>\n<li><p>Setï¼šæ— åºå®¹å™¨ï¼Œä¸å¯ä»¥å­˜å‚¨é‡å¤å…ƒç´ ï¼Œåªå…è®¸å­˜å…¥ä¸€ä¸ª null å…ƒç´ ï¼Œå¿…é¡»ä¿è¯å…ƒç´ å”¯ä¸€æ€§ï¼›</p>\n<p>  å¸¸ç”¨å®ç°ç±»ï¼šHashSetã€LinkedHashSet ä»¥åŠ TreeSetã€‚</p>\n</li>\n</ul>\n<ul>\n<li><p>Map æ˜¯ä¸€ä¸ªé”®å€¼å¯¹é›†åˆï¼Œå­˜å‚¨é”®ã€å€¼å’Œä¹‹é—´çš„æ˜ å°„ã€‚ key æ— åºï¼Œå”¯ä¸€ï¼›value ä¸è¦æ±‚æœ‰åºï¼Œå…è®¸é‡å¤ï¼›</p>\n<p>  å¸¸ç”¨å®ç°ç±»ï¼šHashMapã€TreeMapã€HashTableã€LinkedHashMapã€ConcurrentHashMapã€‚</p>\n</li>\n</ul>\n<h3 id=\"é›†åˆæ¡†æ¶åº•å±‚æ•°æ®ç»“æ„\"><a href=\"#é›†åˆæ¡†æ¶åº•å±‚æ•°æ®ç»“æ„\" class=\"headerlink\" title=\"é›†åˆæ¡†æ¶åº•å±‚æ•°æ®ç»“æ„\"></a>é›†åˆæ¡†æ¶åº•å±‚æ•°æ®ç»“æ„</h3><h4 id=\"Collection\"><a href=\"#Collection\" class=\"headerlink\" title=\"Collection\"></a>Collection</h4><ol>\n<li>List</li>\n</ol>\n<ul>\n<li>Arraylistï¼š Object æ•°ç»„</li>\n<li>Vectorï¼š Object æ•°ç»„</li>\n<li>LinkedListï¼š åŒå‘é“¾è¡¨</li>\n</ul>\n<ol start=\"2\">\n<li>Set</li>\n</ol>\n<ul>\n<li>HashSetï¼ˆæ— åºï¼Œå”¯ä¸€ï¼‰ï¼šåŸºäº HashMap å®ç°çš„ï¼Œåº•å±‚é‡‡ç”¨ HashMap æ¥ä¿å­˜å…ƒç´ </li>\n<li>LinkedHashSetï¼š LinkedHashSet ç»§æ‰¿äº HashSetï¼Œå¹¶ä¸”å…¶å†…éƒ¨æ˜¯é€šè¿‡ LinkedHashMap æ¥å®ç°çš„ã€‚</li>\n<li>TreeSetï¼ˆæœ‰åºï¼Œå”¯ä¸€ï¼‰ï¼š çº¢é»‘æ ‘(è‡ªå¹³è¡¡çš„æ’åºäºŒå‰æ ‘)</li>\n</ul>\n<h4 id=\"Map\"><a href=\"#Map\" class=\"headerlink\" title=\"Map\"></a>Map</h4><ul>\n<li>HashMapï¼š JDK1.8 ä¹‹å‰ HashMap ç”±æ•°ç»„+é“¾è¡¨ç»„æˆçš„ï¼Œæ•°ç»„æ˜¯ HashMap çš„ä¸»ä½“ï¼Œé“¾è¡¨åˆ™æ˜¯ä¸»è¦ä¸ºäº†è§£å†³å“ˆå¸Œå†²çªè€Œå­˜åœ¨çš„ï¼ˆâ€œæ‹‰é“¾æ³•â€è§£å†³å†²çªï¼‰ã€‚JDK1.8 ä»¥ååœ¨è§£å†³å“ˆå¸Œå†²çªæ—¶æœ‰äº†è¾ƒå¤§çš„å˜åŒ–ï¼Œå½“é“¾è¡¨é•¿åº¦å¤§äºé˜ˆå€¼ï¼ˆé»˜è®¤ä¸º 8ï¼‰ï¼Œä¸”æ•°ç»„é•¿åº¦å¤§äº 64ï¼Œå°†é“¾è¡¨è½¬åŒ–ä¸ºçº¢é»‘æ ‘ï¼Œä»¥å‡å°‘æœç´¢æ—¶é—´ï¼Œå¦åˆ™æ‰©å®¹æ•°ç»„ã€‚</li>\n<li>LinkedHashMapï¼šLinkedHashMap ç»§æ‰¿è‡ª HashMapï¼Œæ‰€ä»¥å®ƒçš„åº•å±‚ç”±æ•°ç»„å’Œé“¾è¡¨æˆ–çº¢é»‘æ ‘ç»„æˆã€‚å¦å¤–ï¼ŒLinkedHashMap åœ¨ä¸Šé¢ç»“æ„çš„åŸºç¡€ä¸Šï¼Œå¢åŠ äº†ä¸€æ¡åŒå‘é“¾è¡¨ï¼Œä½¿å¾—ä¸Šé¢çš„ç»“æ„å¯ä»¥ä¿æŒé”®å€¼å¯¹çš„æ’å…¥é¡ºåºã€‚åŒæ—¶é€šè¿‡å¯¹é“¾è¡¨è¿›è¡Œç›¸åº”çš„æ“ä½œï¼Œå®ç°äº†è®¿é—®é¡ºåºç›¸å…³é€»è¾‘ã€‚</li>\n<li>HashTableï¼š æ•°ç»„+é“¾è¡¨ç»„æˆçš„ï¼Œæ•°ç»„æ˜¯ HashMap çš„ä¸»ä½“ï¼Œé“¾è¡¨åˆ™æ˜¯ä¸»è¦ä¸ºäº†è§£å†³å“ˆå¸Œå†²çªè€Œå­˜åœ¨çš„</li>\n<li>TreeMapï¼š çº¢é»‘æ ‘ï¼ˆè‡ªå¹³è¡¡çš„æ’åºäºŒå‰æ ‘ï¼‰</li>\n</ul>\n<h3 id=\"å“ªäº›é›†åˆç±»æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Ÿ\"><a href=\"#å“ªäº›é›†åˆç±»æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Ÿ\" class=\"headerlink\" title=\"å“ªäº›é›†åˆç±»æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Ÿ\"></a>å“ªäº›é›†åˆç±»æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Ÿ</h3><p>vector å’Œ hashtableï¼Œé€šè¿‡åœ¨æ–¹æ³•ä¸ŠåŠ  synchronized å…³é”®å­—å®ç°çº¿ç¨‹å®‰å…¨</p>\n<h3 id=\"Javaé›†åˆçš„å¿«é€Ÿå¤±è´¥æœºåˆ¶-â€œfail-fastâ€ï¼Ÿ\"><a href=\"#Javaé›†åˆçš„å¿«é€Ÿå¤±è´¥æœºåˆ¶-â€œfail-fastâ€ï¼Ÿ\" class=\"headerlink\" title=\"Javaé›†åˆçš„å¿«é€Ÿå¤±è´¥æœºåˆ¶ â€œfail-fastâ€ï¼Ÿ\"></a>Javaé›†åˆçš„å¿«é€Ÿå¤±è´¥æœºåˆ¶ â€œfail-fastâ€ï¼Ÿ</h3><p>fail-fast æ˜¯ Java é›†åˆçš„ä¸€ç§<strong>é”™è¯¯æ£€æµ‹æœºåˆ¶</strong>ï¼Œå½“å¤šä¸ªçº¿ç¨‹å¯¹åŒä¸€ä¸ªé›†åˆçš„å†…å®¹è¿›è¡Œæ“ä½œæ—¶ï¼Œå°±å¯èƒ½ä¼šäº§ç”Ÿ fail-fast äº‹ä»¶ã€‚</p>\n<p>ä¾‹å¦‚ï¼šå‡è®¾å­˜åœ¨ä¸¤ä¸ªçº¿ç¨‹ï¼ˆçº¿ç¨‹ 1ã€çº¿ç¨‹ 2ï¼‰ï¼Œçº¿ç¨‹ 1 é€šè¿‡ Iterator åœ¨éå†é›†åˆ A ä¸­çš„å…ƒç´ ï¼Œåœ¨æŸä¸ªæ—¶å€™çº¿ç¨‹ 2 ä¿®æ”¹äº†é›†åˆ A çš„ç»“æ„ï¼ˆaddã€removeã€clear ç­‰ç»“æ„ä¸Šçš„ä¿®æ”¹ï¼Œè€Œä¸æ˜¯ç®€å•çš„ä¿®æ”¹é›†åˆå…ƒç´ çš„å†…å®¹ï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™ç¨‹åºå°±ä¼šæŠ›å‡º <strong>ConcurrentModificationException</strong> å¼‚å¸¸ï¼Œä»è€Œäº§ç”Ÿ fail-fast äº‹ä»¶ã€‚</p>\n<p>åŸå› ï¼šè¿­ä»£å™¨åœ¨éå†æ—¶ç›´æ¥è®¿é—®é›†åˆä¸­çš„å†…å®¹ï¼Œå¹¶ä¸”åœ¨éå†è¿‡ç¨‹ä¸­ä½¿ç”¨ä¸€ä¸ª modCount å˜é‡ã€‚æ¯å½“è¿­ä»£å™¨ä½¿ç”¨ hashNext()&#x2F;next()éå†ä¸‹ä¸€ä¸ªå…ƒç´ ä¹‹å‰ï¼Œéƒ½ä¼šæ£€æµ‹ modCount å˜é‡æ˜¯å¦ä¸º expectedmodCount å€¼ï¼Œæ˜¯çš„è¯å°±è¿”å›éå†ï¼›å¦åˆ™æŠ›å‡ºå¼‚å¸¸ï¼Œç»ˆæ­¢éå†ã€‚é›†åˆåœ¨è¢«éå†æœŸé—´å¦‚æœå†…å®¹å‘ç”Ÿå˜åŒ–ï¼Œå°±ä¼šæ”¹å˜ modCount çš„å€¼ï¼Œä»è€Œ modCount ä¸ç­‰äº expectedmodCount å€¼æŠ›å‡ºå¼‚å¸¸ï¼Œä¹Ÿå°±æ˜¯äº§ç”Ÿäº† fail-fast äº‹ä»¶ã€‚</p>\n<p>è§£å†³åŠæ³•ï¼š</p>\n<ol>\n<li>åœ¨éå†è¿‡ç¨‹ä¸­ï¼Œæ‰€æœ‰æ¶‰åŠåˆ°æ”¹å˜ modCount å€¼çš„åœ°æ–¹å…¨éƒ¨åŠ ä¸Š synchronizedï¼›</li>\n<li>ä½¿ç”¨ Java.util.concurrent ä¸‹çš„ CopyOnWriteArrayList æ¥æ›¿æ¢ ArrayListï¼›</li>\n<li>ä½¿ç”¨ Java.util.concurrent ä¸‹çš„ ConcurrentHashMap æ¥æ›¿æ¢ HashMapã€‚</li>\n</ol>\n<h3 id=\"æ€ä¹ˆç¡®ä¿ä¸€ä¸ªé›†åˆä¸èƒ½è¢«ä¿®æ”¹ï¼Ÿ\"><a href=\"#æ€ä¹ˆç¡®ä¿ä¸€ä¸ªé›†åˆä¸èƒ½è¢«ä¿®æ”¹ï¼Ÿ\" class=\"headerlink\" title=\"æ€ä¹ˆç¡®ä¿ä¸€ä¸ªé›†åˆä¸èƒ½è¢«ä¿®æ”¹ï¼Ÿ\"></a>æ€ä¹ˆç¡®ä¿ä¸€ä¸ªé›†åˆä¸èƒ½è¢«ä¿®æ”¹ï¼Ÿ</h3><p>å¯ä»¥ä½¿ç”¨ Collections. unmodifiableCollection(Collection c) æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªåªè¯»é›†åˆï¼Œè¿™æ ·æ”¹å˜é›†åˆçš„ä»»ä½•æ“ä½œéƒ½ä¼šæŠ›å‡º Java. lang. UnsupportedOperationException å¼‚å¸¸ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">List&lt;String&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;&gt;();</span><br><span class=\"line\">list. add(<span class=\"string\">&quot;x&quot;</span>);</span><br><span class=\"line\">Collection&lt;String&gt; clist = Collections. unmodifiableCollection(list);</span><br><span class=\"line\">clist.add(<span class=\"string\">&quot;y&quot;</span>); <span class=\"comment\">// è¿è¡Œæ—¶æ­¤è¡ŒæŠ¥é”™</span></span><br><span class=\"line\">System.out.println(list. size());</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Collectionæ¥å£\"><a href=\"#Collectionæ¥å£\" class=\"headerlink\" title=\"Collectionæ¥å£\"></a>Collectionæ¥å£</h2><h3 id=\"Listæ¥å£\"><a href=\"#Listæ¥å£\" class=\"headerlink\" title=\"Listæ¥å£\"></a>Listæ¥å£</h3><h4 id=\"è¿­ä»£å™¨-Iterator-æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#è¿­ä»£å™¨-Iterator-æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"è¿­ä»£å™¨ Iterator æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>è¿­ä»£å™¨ Iterator æ˜¯ä»€ä¹ˆï¼Ÿ</h4><p>Collection æ¥å£å®ç°äº† Iterable æ¥å£ï¼Œé€šè¿‡å®ç° Iterable æ¥å£ä¸­çš„ iterator()æ–¹æ³•è¿”å› Iterator æ¥å£çš„å®ä¾‹ï¼Œé€šè¿‡ iterator å¯¹é›†åˆçš„å…ƒç´ è¿›è¡Œè¿­ä»£æ“ä½œã€‚</p>\n<h4 id=\"Iterator-æ€ä¹ˆä½¿ç”¨ï¼Ÿæœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ\"><a href=\"#Iterator-æ€ä¹ˆä½¿ç”¨ï¼Ÿæœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ\" class=\"headerlink\" title=\"Iterator æ€ä¹ˆä½¿ç”¨ï¼Ÿæœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ\"></a>Iterator æ€ä¹ˆä½¿ç”¨ï¼Ÿæœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">List&lt;String&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;&gt;();</span><br><span class=\"line\">Iterator&lt;String&gt; it = list.iterator();</span><br><span class=\"line\"><span class=\"keyword\">while</span>(it.hasNext())&#123;</span><br><span class=\"line\">    <span class=\"type\">String</span> <span class=\"variable\">obj</span> <span class=\"operator\">=</span> it.next();</span><br><span class=\"line\">    System.out.println(obj);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Iterator çš„ç‰¹ç‚¹æ˜¯åªèƒ½å•å‘éå†ï¼Œä½†æ˜¯æ›´åŠ å®‰å…¨ï¼Œå› ä¸ºå®ƒå¯ä»¥ç¡®ä¿ï¼Œåœ¨å½“å‰éå†çš„é›†åˆå…ƒç´ è¢«æ›´æ”¹çš„æ—¶å€™ï¼Œå°±ä¼šæŠ›å‡º ConcurrentModificationException å¼‚å¸¸ã€‚</p>\n<h4 id=\"å¦‚ä½•è¾¹éå†è¾¹ç§»é™¤-Collection-ä¸­çš„å…ƒç´ ï¼Ÿ\"><a href=\"#å¦‚ä½•è¾¹éå†è¾¹ç§»é™¤-Collection-ä¸­çš„å…ƒç´ ï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•è¾¹éå†è¾¹ç§»é™¤ Collection ä¸­çš„å…ƒç´ ï¼Ÿ\"></a>å¦‚ä½•è¾¹éå†è¾¹ç§»é™¤ Collection ä¸­çš„å…ƒç´ ï¼Ÿ</h4><p>è¾¹éå†è¾¹ä¿®æ”¹ Collection çš„å”¯ä¸€æ­£ç¡®æ–¹å¼æ˜¯ä½¿ç”¨ Iterator.remove() æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Iterator&lt;Integer&gt; it = list.iterator();</span><br><span class=\"line\"><span class=\"keyword\">while</span>(it.hasNext())&#123;</span><br><span class=\"line\">   <span class=\"comment\">// do something</span></span><br><span class=\"line\">   it.remove();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>ä¸€ç§æœ€å¸¸è§çš„<strong>é”™è¯¯</strong>ä»£ç å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">List&lt;String&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;&gt;();</span><br><span class=\"line\">list.add(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">list.add(<span class=\"string\">&quot;2&quot;</span>);</span><br><span class=\"line\">list.add(<span class=\"string\">&quot;3&quot;</span>);</span><br><span class=\"line\">list.add(<span class=\"string\">&quot;4&quot;</span>);</span><br><span class=\"line\">list.add(<span class=\"string\">&quot;5&quot;</span>);</span><br><span class=\"line\"><span class=\"type\">int</span> <span class=\"variable\">cnt</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"keyword\">for</span> (String item : list) &#123;</span><br><span class=\"line\">  System.out.println(++cnt);</span><br><span class=\"line\">  list.remove(item);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">System.out.println(Arrays.toString(list.toArray()));</span><br></pre></td></tr></table></figure>\n\n<p>è¿è¡Œä»¥ä¸Šé”™è¯¯ä»£ç ä¼šæŠ¥ <strong>ConcurrentModificationException å¼‚å¸¸</strong>ã€‚<br>è¿™æ˜¯å› ä¸ºå½“ä½¿ç”¨ foreach(for(Integer i : list)) è¯­å¥æ—¶ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª iterator æ¥éå†è¯¥ listï¼Œä½†åŒæ—¶è¯¥ list æ­£åœ¨è¢« Iterator.remove() ä¿®æ”¹ã€‚é›†åˆå‘ç”Ÿç»“æ„æ€§å˜åŒ–ï¼Œæ ¹æ® fail-fast æœºåˆ¶ï¼Œä¼šæŠ›å¼‚å¸¸ã€‚</p>\n<h4 id=\"éå†ä¸€ä¸ª-List-æœ‰å“ªäº›ä¸åŒçš„æ–¹å¼ï¼Ÿ\"><a href=\"#éå†ä¸€ä¸ª-List-æœ‰å“ªäº›ä¸åŒçš„æ–¹å¼ï¼Ÿ\" class=\"headerlink\" title=\"éå†ä¸€ä¸ª List æœ‰å“ªäº›ä¸åŒçš„æ–¹å¼ï¼Ÿ\"></a>éå†ä¸€ä¸ª List æœ‰å“ªäº›ä¸åŒçš„æ–¹å¼ï¼Ÿ</h4><ol>\n<li>for å¾ªç¯ï¼Œç»´æŠ¤ä¸€ä¸ªè®¡æ•°å™¨ï¼›</li>\n<li>è¿­ä»£å™¨ï¼ŒIteratorã€‚Collection æ¥å£å®ç°äº† Iterable æ¥å£ï¼Œé€šè¿‡å®ç° Iterable æ¥å£ä¸­çš„ iterator()æ–¹æ³•è¿”å› Iterator æ¥å£çš„å®ä¾‹ï¼Œé€šè¿‡ iterator å¯¹é›†åˆçš„å…ƒç´ è¿›è¡Œè¿­ä»£æ“ä½œï¼›</li>\n<li>å¢å¼º for å¾ªç¯ã€‚å¢å¼º for å¾ªç¯ foreach å†…éƒ¨ä¹Ÿæ˜¯é‡‡ç”¨äº† Iterator çš„æ–¹å¼å®ç°ï¼Œä½¿ç”¨æ—¶ä¸éœ€è¦æ˜¾å¼å£°æ˜ Iterator æˆ–è®¡æ•°å™¨ã€‚<br> ä¼˜ç‚¹æ˜¯ä»£ç ç®€æ´ï¼Œä¸æ˜“å‡ºé”™ï¼›ç¼ºç‚¹æ˜¯åªèƒ½åšç®€å•çš„éå†ï¼Œä¸èƒ½åœ¨éå†è¿‡ç¨‹ä¸­æ“ä½œæ•°æ®é›†åˆï¼Œä¾‹å¦‚åˆ é™¤ã€æ›¿æ¢ã€‚</li>\n</ol>\n<h4 id=\"è¯´ä¸€ä¸‹-ArrayList-çš„ä¼˜ç¼ºç‚¹\"><a href=\"#è¯´ä¸€ä¸‹-ArrayList-çš„ä¼˜ç¼ºç‚¹\" class=\"headerlink\" title=\"è¯´ä¸€ä¸‹ ArrayList çš„ä¼˜ç¼ºç‚¹\"></a>è¯´ä¸€ä¸‹ ArrayList çš„ä¼˜ç¼ºç‚¹</h4><p><strong>ArrayList æ¯”è¾ƒé€‚åˆé¡ºåºæ·»åŠ ã€éšæœºè®¿é—®çš„åœºæ™¯ã€‚</strong></p>\n<p>ArrayList çš„ä¼˜ç‚¹å¦‚ä¸‹ï¼š</p>\n<ul>\n<li>ArrayList åº•å±‚ä»¥æ•°ç»„å®ç°ï¼Œæ˜¯ä¸€ç§éšæœºè®¿é—®æ¨¡å¼ã€‚ArrayList å®ç°äº† RandomAccess æ¥å£ï¼Œæ ‡è®° List å®ç°æ˜¯å¦æ”¯æŒ Random Accessï¼Œå¯¼è‡´å®ƒå¯ä»¥éšæœºè®¿é—®çš„æ ¹æœ¬åŸå› æ˜¯å®ƒåº•å±‚æ˜¯æ•°ç»„ç»“æ„ï¼Œæ•°ç»„å¯ä»¥é€šè¿‡ä¸‹æ ‡è·å–ç›¸åº”çš„å€¼ï¼Œè€Œ RandomAccess åªæ˜¯ä¸€ä¸ªæ ‡è®°ã€‚å› æ­¤æŸ¥æ‰¾çš„æ—¶å€™éå¸¸å¿«ã€‚å¯ä»¥ç”¨ for å¾ªç¯é€šè¿‡ä¸‹æ ‡è·å–å…ƒç´ ã€‚</li>\n<li>ArrayList åœ¨é¡ºåºæ·»åŠ ä¸€ä¸ªå…ƒç´ çš„æ—¶å€™éå¸¸æ–¹ä¾¿ã€‚</li>\n</ul>\n<p>ArrayList çš„ç¼ºç‚¹å¦‚ä¸‹ï¼š</p>\n<ul>\n<li>å‘<strong>ä¸­é—´æŸä¸ªä½ç½®åˆ é™¤</strong>å…ƒç´ çš„æ—¶å€™ï¼Œéœ€è¦åšå…ƒç´ å¤åˆ¶æ“ä½œã€‚å¦‚æœè¦å¤åˆ¶çš„å…ƒç´ å¾ˆå¤šï¼Œé‚£ä¹ˆå°±ä¼šæ¯”è¾ƒè€—è´¹æ€§èƒ½ï¼›</li>\n<li>å‘<strong>ä¸­é—´æŸä¸ªä½ç½®æ’å…¥</strong>å…ƒç´ çš„æ—¶å€™ï¼Œä¹Ÿéœ€è¦åšå…ƒç´ å¤åˆ¶æ“ä½œï¼Œç¼ºç‚¹åŒä¸Šã€‚</li>\n</ul>\n<h4 id=\"å¦‚ä½•å®ç°æ•°ç»„å’Œ-List-ä¹‹é—´çš„è½¬æ¢ï¼Ÿ\"><a href=\"#å¦‚ä½•å®ç°æ•°ç»„å’Œ-List-ä¹‹é—´çš„è½¬æ¢ï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•å®ç°æ•°ç»„å’Œ List ä¹‹é—´çš„è½¬æ¢ï¼Ÿ\"></a>å¦‚ä½•å®ç°æ•°ç»„å’Œ List ä¹‹é—´çš„è½¬æ¢ï¼Ÿ</h4><ul>\n<li>æ•°ç»„è½¬ Listï¼šä½¿ç”¨ Arrays. asList(array) è¿›è¡Œè½¬æ¢ã€‚</li>\n<li>List è½¬æ•°ç»„ï¼šä½¿ç”¨ List è‡ªå¸¦çš„ toArray() æ–¹æ³•ã€‚</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// list to array</span></span><br><span class=\"line\">List&lt;String&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;String&gt;();</span><br><span class=\"line\">list.add(<span class=\"string\">&quot;123&quot;</span>);</span><br><span class=\"line\">list.add(<span class=\"string\">&quot;456&quot;</span>);</span><br><span class=\"line\">list.toArray(<span class=\"keyword\">new</span> <span class=\"title class_\">String</span>[<span class=\"number\">0</span>]);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// array to list</span></span><br><span class=\"line\">String[] array = <span class=\"keyword\">new</span> <span class=\"title class_\">String</span>[]&#123;<span class=\"string\">&quot;123&quot;</span>, <span class=\"string\">&quot;456&quot;</span>&#125;;</span><br><span class=\"line\">Arrays.asList(array);</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"ArrayList-å’Œ-LinkedList-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#ArrayList-å’Œ-LinkedList-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"ArrayList å’Œ LinkedList çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>ArrayList å’Œ LinkedList çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h4><ul>\n<li>åº•å±‚å®ç°ï¼šArrayList æ˜¯åŠ¨æ€æ•°ç»„çš„æ•°æ®ç»“æ„å®ç°ï¼Œè€Œ LinkedList æ˜¯åŒå‘é“¾è¡¨çš„æ•°æ®ç»“æ„å®ç°ï¼›</li>\n<li>è®¿é—®å’Œå¢åˆ å…ƒç´ æ•ˆç‡ï¼šArrayList éšæœºè®¿é—®å’Œé¡ºåºæ’å…¥&#x2F;åˆ é™¤å…ƒç´ æ•ˆç‡æ›´é«˜ï¼›</li>\n<li>å†…å­˜å ç”¨ï¼šLinkedList æ¯” ArrayList æ›´å å†…å­˜ï¼Œå› ä¸º LinkedList çš„èŠ‚ç‚¹é™¤äº†å­˜å‚¨æ•°æ®ï¼Œè¿˜å­˜å‚¨äº†ä¸¤ä¸ªå¼•ç”¨ï¼Œä¸€ä¸ªæŒ‡å‘å‰ä¸€ä¸ªå…ƒç´ ï¼Œä¸€ä¸ªæŒ‡å‘åä¸€ä¸ªå…ƒç´ ï¼›</li>\n<li>çº¿ç¨‹å®‰å…¨ï¼šArrayList å’Œ LinkedList éƒ½æ˜¯ä¸åŒæ­¥çš„ï¼Œä¹Ÿå°±æ˜¯ä¸ä¿è¯çº¿ç¨‹å®‰å…¨ã€‚</li>\n</ul>\n<p>ç»¼åˆæ¥è¯´ï¼Œåœ¨éœ€è¦<strong>é¢‘ç¹è¯»å–</strong>é›†åˆä¸­çš„å…ƒç´ æ—¶ï¼Œæ›´æ¨èä½¿ç”¨ ArrayListï¼Œè€Œåœ¨<strong>æ’å…¥å’Œåˆ é™¤æ“ä½œè¾ƒå¤š</strong>æ—¶ï¼Œæ›´æ¨èä½¿ç”¨ LinkedListã€‚</p>\n<h4 id=\"ArrayList-å’Œ-Vector-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#ArrayList-å’Œ-Vector-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"ArrayList å’Œ Vector çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>ArrayList å’Œ Vector çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h4><p>ä¸»è¦åŒºåˆ«æ˜¯çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼š<br>Vector ä½¿ç”¨äº† synchronized æ¥å®ç°çº¿ç¨‹åŒæ­¥ï¼ˆæ€§èƒ½å·®ï¼‰ï¼Œæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè€Œ ArrayList æ˜¯éçº¿ç¨‹å®‰å…¨çš„ã€‚</p>\n<h4 id=\"å¤šçº¿ç¨‹åœºæ™¯ä¸‹å¦‚ä½•ä½¿ç”¨-ArrayListï¼Ÿ\"><a href=\"#å¤šçº¿ç¨‹åœºæ™¯ä¸‹å¦‚ä½•ä½¿ç”¨-ArrayListï¼Ÿ\" class=\"headerlink\" title=\"å¤šçº¿ç¨‹åœºæ™¯ä¸‹å¦‚ä½•ä½¿ç”¨ ArrayListï¼Ÿ\"></a>å¤šçº¿ç¨‹åœºæ™¯ä¸‹å¦‚ä½•ä½¿ç”¨ ArrayListï¼Ÿ</h4><p>å¯ä»¥ç”¨ Java.util.concurrent.CopyOnWriteArrayList æ›¿æ¢ ArrayListã€‚</p>\n<h4 id=\"ä¸ºä»€ä¹ˆ-ArrayList-çš„-elementData-åŠ ä¸Š-transient-ä¿®é¥°ï¼Ÿ\"><a href=\"#ä¸ºä»€ä¹ˆ-ArrayList-çš„-elementData-åŠ ä¸Š-transient-ä¿®é¥°ï¼Ÿ\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆ ArrayList çš„ elementData åŠ ä¸Š transient ä¿®é¥°ï¼Ÿ\"></a>ä¸ºä»€ä¹ˆ ArrayList çš„ elementData åŠ ä¸Š transient ä¿®é¥°ï¼Ÿ</h4><p>ArrayList å®ç°äº† Serializable æ¥å£ï¼Œè¿™æ„å‘³ç€ ArrayList æ”¯æŒåºåˆ—åŒ–ã€‚<br>å¯¹äº elementDataï¼Œç”±äº elementData å¯èƒ½æœ‰å¤šä½™çš„å®¹é‡ï¼ˆå®¹é‡ä¸è¶³ä¼šæ‰©å®¹æˆ 1.5 å€å¤§å°ï¼Œæ‰©å®¹ä¹‹åé™¤äº†æ–°åŠ <br>çš„å…ƒç´ ä»¥å¤–è¿˜æœ‰å¤šçš„ç©ºé—´æ²¡æœ‰æ”¾å…ƒç´ ï¼Œæ¯”å¦‚ç°åœ¨å®¹é‡æ˜¯ 15ï¼Œè€Œé›†åˆé‡Œé¢åªå­˜äº† 11 ä¸ªå…ƒç´ ï¼‰ï¼Œä¸å¯¹ elementData åŠ ä¸Š transient ä¿®é¥°ï¼Œè€Œæ˜¯æ‰‹åŠ¨è¿›è¡Œåºåˆ—åŒ–ï¼Œå¯ä»¥ä¿è¯åªåºåˆ—åŒ–å®é™…å­˜å‚¨çš„é‚£äº›å…ƒç´ ï¼ˆ11 ä¸ªå…ƒç´ ï¼‰ï¼Œè€Œä¸æ˜¯æ•´ä¸ªæ•°ç»„ï¼Œä»è€ŒèŠ‚çœç©ºé—´å’Œæ—¶é—´ã€‚</p>\n<h3 id=\"â­ArrayListæ‰©å®¹æœºåˆ¶\"><a href=\"#â­ArrayListæ‰©å®¹æœºåˆ¶\" class=\"headerlink\" title=\"â­ArrayListæ‰©å®¹æœºåˆ¶\"></a>â­ArrayListæ‰©å®¹æœºåˆ¶</h3><blockquote>\n<p><strong>æ€»ç»“ï¼š</strong></p>\n<ul>\n<li><p>åˆå§‹åŒ–å¦‚æœä½¿ç”¨æ— å‚æ„é€ å™¨çš„è¯ï¼š</p>\n<p>  åœ¨ç¬¬ä¸€æ¬¡æ·»åŠ å…ƒç´ çš„æ—¶å€™ï¼Œå°†æ•°ç»„å®¹é‡è®¾ç½®ä¸º10ï¼Œç„¶åè¿›è¡Œæ·»åŠ ã€‚</p>\n<p>  ä¸€ç›´æ·»åŠ ï¼Œç›´åˆ°è¦æ·»åŠ çš„å…ƒç´ è¶…å‡ºå½“å‰æ•°ç»„å®¹é‡äº†ï¼Œè¿›å…¥æ‰©å®¹ï¼Œå°†æ•°ç»„é•¿åº¦æ‰©å®¹ä¸º1.5å€é•¿åº¦ï¼Œç„¶åè¿›è¡Œæ·»åŠ ã€‚</p>\n</li>\n<li><p>åˆå§‹åŒ–å¦‚æœä½¿ç”¨æœ‰å‚æ„é€ å™¨çš„è¯ï¼š</p>\n<p>  é‚£ä¹ˆæ¯æ¬¡æ·»åŠ å…ƒç´ åªéœ€è¦åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹å³å¯ï¼Œä¸éœ€è¦ç¬¬ä¸€æ¬¡çš„åˆå§‹åŒ–ä¸º10çš„åˆ¤æ–­ã€‚</p>\n</li>\n</ul>\n</blockquote>\n<h4 id=\"1-å…ˆä»-ArrayList-çš„æ„é€ å‡½æ•°è¯´èµ·\"><a href=\"#1-å…ˆä»-ArrayList-çš„æ„é€ å‡½æ•°è¯´èµ·\" class=\"headerlink\" title=\"1. å…ˆä» ArrayList çš„æ„é€ å‡½æ•°è¯´èµ·\"></a>1. å…ˆä» ArrayList çš„æ„é€ å‡½æ•°è¯´èµ·</h4><p><strong>ï¼ˆJDK8ï¼‰ArrayList æœ‰ä¸‰ç§æ–¹å¼æ¥åˆå§‹åŒ–ï¼Œæ„é€ æ–¹æ³•æºç å¦‚ä¸‹ï¼š</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * é»˜è®¤åˆå§‹å®¹é‡å¤§å°</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"> <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">DEFAULT_CAPACITY</span> <span class=\"operator\">=</span> <span class=\"number\">10</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = &#123;&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  *é»˜è®¤æ„é€ å‡½æ•°ï¼Œä½¿ç”¨åˆå§‹å®¹é‡10æ„é€ ä¸€ä¸ªç©ºåˆ—è¡¨(æ— å‚æ•°æ„é€ )</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"> <span class=\"keyword\">public</span> <span class=\"title function_\">ArrayList</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">     <span class=\"built_in\">this</span>.elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA;</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * å¸¦åˆå§‹å®¹é‡å‚æ•°çš„æ„é€ å‡½æ•°ã€‚ï¼ˆç”¨æˆ·è‡ªå·±æŒ‡å®šå®¹é‡ï¼‰</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"> <span class=\"keyword\">public</span> <span class=\"title function_\">ArrayList</span><span class=\"params\">(<span class=\"type\">int</span> initialCapacity)</span> &#123;</span><br><span class=\"line\">     <span class=\"keyword\">if</span> (initialCapacity &gt; <span class=\"number\">0</span>) &#123;<span class=\"comment\">//åˆå§‹å®¹é‡å¤§äº0</span></span><br><span class=\"line\">         <span class=\"comment\">//åˆ›å»ºinitialCapacityå¤§å°çš„æ•°ç»„</span></span><br><span class=\"line\">         <span class=\"built_in\">this</span>.elementData = <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>[initialCapacity];</span><br><span class=\"line\">     &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (initialCapacity == <span class=\"number\">0</span>) &#123;<span class=\"comment\">//åˆå§‹å®¹é‡ç­‰äº0</span></span><br><span class=\"line\">         <span class=\"comment\">//åˆ›å»ºç©ºæ•°ç»„</span></span><br><span class=\"line\">         <span class=\"built_in\">this</span>.elementData = EMPTY_ELEMENTDATA;</span><br><span class=\"line\">     &#125; <span class=\"keyword\">else</span> &#123;<span class=\"comment\">//åˆå§‹å®¹é‡å°äº0ï¼ŒæŠ›å‡ºå¼‚å¸¸</span></span><br><span class=\"line\">         <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IllegalArgumentException</span>(<span class=\"string\">&quot;Illegal Capacity: &quot;</span>+</span><br><span class=\"line\">                                            initialCapacity);</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *æ„é€ åŒ…å«æŒ‡å®šcollectionå…ƒç´ çš„åˆ—è¡¨ï¼Œè¿™äº›å…ƒç´ åˆ©ç”¨è¯¥é›†åˆçš„è¿­ä»£å™¨æŒ‰é¡ºåºè¿”å›</span></span><br><span class=\"line\"><span class=\"comment\"> *å¦‚æœæŒ‡å®šçš„é›†åˆä¸ºnullï¼Œthrows NullPointerExceptionã€‚</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"title function_\">ArrayList</span><span class=\"params\">(Collection&lt;? extends E&gt; c)</span> &#123;</span><br><span class=\"line\">     elementData = c.toArray();</span><br><span class=\"line\">     <span class=\"keyword\">if</span> ((size = elementData.length) != <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">         <span class=\"comment\">// c.toArray might (incorrectly) not return Object[] (see 6260652)</span></span><br><span class=\"line\">         <span class=\"keyword\">if</span> (elementData.getClass() != Object[].class)</span><br><span class=\"line\">             elementData = Arrays.copyOf(elementData, size, Object[].class);</span><br><span class=\"line\">     &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">         <span class=\"comment\">// replace with empty array.</span></span><br><span class=\"line\">         <span class=\"built_in\">this</span>.elementData = EMPTY_ELEMENTDATA;</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\"> &#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>ä»¥æ— å‚æ•°æ„é€ æ–¹æ³•åˆ›å»º ArrayList æ—¶ï¼Œå®é™…ä¸Šåˆå§‹åŒ–èµ‹å€¼çš„æ˜¯ä¸€ä¸ªç©ºæ•°ç»„ã€‚å½“çœŸæ­£å¯¹æ•°ç»„è¿›è¡Œæ·»åŠ å…ƒç´ æ“ä½œæ—¶ï¼Œæ‰çœŸæ­£åˆ†é…å®¹é‡ã€‚å³å‘æ•°ç»„ä¸­æ·»åŠ ç¬¬ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œæ•°ç»„å®¹é‡æ‰©ä¸º 10ã€‚</strong> </p>\n<blockquote>\n<p>è¡¥å……ï¼šJDK6 new æ— å‚æ„é€ çš„ <code>ArrayList</code> å¯¹è±¡æ—¶ï¼Œç›´æ¥åˆ›å»ºäº†é•¿åº¦æ˜¯ 10 çš„ <code>Object[]</code> æ•°ç»„ elementData ã€‚</p>\n</blockquote>\n<h4 id=\"2-ä¸€æ­¥ä¸€æ­¥åˆ†æ-ArrayList-æ‰©å®¹æœºåˆ¶\"><a href=\"#2-ä¸€æ­¥ä¸€æ­¥åˆ†æ-ArrayList-æ‰©å®¹æœºåˆ¶\" class=\"headerlink\" title=\"2. ä¸€æ­¥ä¸€æ­¥åˆ†æ ArrayList æ‰©å®¹æœºåˆ¶\"></a>2. ä¸€æ­¥ä¸€æ­¥åˆ†æ ArrayList æ‰©å®¹æœºåˆ¶</h4><p>è¿™é‡Œä»¥æ— å‚æ„é€ å‡½æ•°åˆ›å»ºçš„ ArrayList ä¸ºä¾‹åˆ†æ</p>\n<h5 id=\"2-1-add\"><a href=\"#2-1-add\" class=\"headerlink\" title=\"2.1.  add\"></a>2.1.  <code>add</code></h5><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * å°†æŒ‡å®šçš„å…ƒç´ è¿½åŠ åˆ°æ­¤åˆ—è¡¨çš„æœ«å°¾ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"> <span class=\"keyword\">public</span> <span class=\"type\">boolean</span> <span class=\"title function_\">add</span><span class=\"params\">(E e)</span> &#123;</span><br><span class=\"line\"><span class=\"comment\">// æ·»åŠ å…ƒç´ ä¹‹å‰ï¼Œå…ˆè°ƒç”¨ensureCapacityInternalæ–¹æ³•</span></span><br><span class=\"line\">     ensureCapacityInternal(size + <span class=\"number\">1</span>);  <span class=\"comment\">// Increments modCount!!</span></span><br><span class=\"line\">     <span class=\"comment\">// è¿™é‡Œçœ‹åˆ°ArrayListæ·»åŠ å…ƒç´ çš„å®è´¨å°±ç›¸å½“äºä¸ºæ•°ç»„èµ‹å€¼</span></span><br><span class=\"line\">     elementData[size++] = e;</span><br><span class=\"line\">     <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\"> &#125;</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"2-2-ensureCapacityInternal\"><a href=\"#2-2-ensureCapacityInternal\" class=\"headerlink\" title=\"2.2. ensureCapacityInternal()\"></a>2.2. <code>ensureCapacityInternal()</code></h5><p>ï¼ˆJDK7ï¼‰å¯ä»¥çœ‹åˆ° <code>add</code> æ–¹æ³• é¦–å…ˆè°ƒç”¨äº†<code>ensureCapacityInternal(size + 1)</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//å¾—åˆ°æœ€å°æ‰©å®¹é‡</span></span><br><span class=\"line\"> <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">ensureCapacityInternal</span><span class=\"params\">(<span class=\"type\">int</span> minCapacity)</span> &#123;</span><br><span class=\"line\">     <span class=\"keyword\">if</span> (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) &#123;</span><br><span class=\"line\">         <span class=\"comment\">// è·å–é»˜è®¤çš„å®¹é‡å’Œä¼ å…¥å‚æ•°çš„è¾ƒå¤§å€¼</span></span><br><span class=\"line\">         minCapacity = Math.max(DEFAULT_CAPACITY, minCapacity);</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">     ensureExplicitCapacity(minCapacity);</span><br><span class=\"line\"> &#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>å½“ è¦ add è¿›ç¬¬ 1 ä¸ªå…ƒç´ æ—¶ï¼ŒminCapacity ä¸º 1ï¼Œåœ¨ Math.max()æ–¹æ³•æ¯”è¾ƒåï¼ŒminCapacity ä¸º 10ã€‚</strong></p>\n<blockquote>\n<p>æ­¤å¤„å’Œåç»­ JDK8 ä»£ç æ ¼å¼åŒ–ç•¥æœ‰ä¸åŒï¼Œæ ¸å¿ƒä»£ç åŸºæœ¬ä¸€æ ·ã€‚</p>\n</blockquote>\n<h5 id=\"2-3-ensureExplicitCapacity\"><a href=\"#2-3-ensureExplicitCapacity\" class=\"headerlink\" title=\"2.3. ensureExplicitCapacity()\"></a>2.3. <code>ensureExplicitCapacity()</code></h5><p>å¦‚æœè°ƒç”¨ <code>ensureCapacityInternal()</code> æ–¹æ³•å°±ä¸€å®šä¼šè¿›å…¥ï¼ˆæ‰§è¡Œï¼‰è¿™ä¸ªæ–¹æ³•</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹</span></span><br><span class=\"line\">  <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">ensureExplicitCapacity</span><span class=\"params\">(<span class=\"type\">int</span> minCapacity)</span> &#123;</span><br><span class=\"line\">      modCount++;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">// overflow-conscious code</span></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (minCapacity - elementData.length &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">          <span class=\"comment\">//è°ƒç”¨growæ–¹æ³•è¿›è¡Œæ‰©å®¹ï¼Œè°ƒç”¨æ­¤æ–¹æ³•ä»£è¡¨å·²ç»å¼€å§‹æ‰©å®¹äº†</span></span><br><span class=\"line\">          grow(minCapacity);</span><br><span class=\"line\">  &#125;</span><br></pre></td></tr></table></figure>\n\n<p>æˆ‘ä»¬æ¥ä»”ç»†åˆ†æä¸€ä¸‹ï¼š</p>\n<ul>\n<li>å½“æˆ‘ä»¬è¦ add è¿›ç¬¬ 1 ä¸ªå…ƒç´ åˆ° ArrayList æ—¶ï¼ŒelementData.length ä¸º 0 ï¼ˆå› ä¸ºè¿˜æ˜¯ä¸€ä¸ªç©ºçš„ listï¼‰ï¼Œå› ä¸ºæ‰§è¡Œäº† <code>ensureCapacityInternal()</code> æ–¹æ³• ï¼Œæ‰€ä»¥ minCapacity æ­¤æ—¶ä¸º 10ã€‚æ­¤æ—¶ï¼Œ<code>minCapacity - elementData.length &gt; 0</code>æˆç«‹ï¼Œæ‰€ä»¥ä¼šè¿›å…¥ <code>grow(minCapacity)</code> æ–¹æ³•ã€‚</li>\n<li>å½“ add ç¬¬ 2 ä¸ªå…ƒç´ æ—¶ï¼ŒminCapacity ä¸º 2ï¼Œæ­¤æ—¶ elementData.length(å®¹é‡)åœ¨æ·»åŠ ç¬¬ä¸€ä¸ªå…ƒç´ åæ‰©å®¹æˆ 10 äº†ã€‚æ­¤æ—¶ï¼Œ<code>minCapacity - elementData.length &gt; 0</code> ä¸æˆç«‹ï¼Œæ‰€ä»¥ä¸ä¼šè¿›å…¥ ï¼ˆæ‰§è¡Œï¼‰<code>grow(minCapacity)</code> æ–¹æ³•ã€‚</li>\n<li>æ·»åŠ ç¬¬ 3ã€4Â·Â·Â·åˆ°ç¬¬ 10 ä¸ªå…ƒç´ æ—¶ï¼Œä¾ç„¶ä¸ä¼šæ‰§è¡Œ grow æ–¹æ³•ï¼Œæ•°ç»„å®¹é‡éƒ½ä¸º 10ã€‚</li>\n</ul>\n<p>ç›´åˆ°æ·»åŠ ç¬¬ 11 ä¸ªå…ƒç´ ï¼ŒminCapacity(ä¸º 11)æ¯” elementData.lengthï¼ˆä¸º 10ï¼‰è¦å¤§ã€‚è¿›å…¥ grow æ–¹æ³•è¿›è¡Œæ‰©å®¹ã€‚</p>\n<h5 id=\"2-4-grow\"><a href=\"#2-4-grow\" class=\"headerlink\" title=\"2.4. grow()\"></a>2.4. <code>grow()</code></h5><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * è¦åˆ†é…çš„æœ€å¤§æ•°ç»„å¤§å°</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">MAX_ARRAY_SIZE</span> <span class=\"operator\">=</span> Integer.MAX_VALUE - <span class=\"number\">8</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * ArrayListæ‰©å®¹çš„æ ¸å¿ƒæ–¹æ³•ã€‚</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">grow</span><span class=\"params\">(<span class=\"type\">int</span> minCapacity)</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// oldCapacityä¸ºæ—§å®¹é‡ï¼ŒnewCapacityä¸ºæ–°å®¹é‡</span></span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">oldCapacity</span> <span class=\"operator\">=</span> elementData.length;</span><br><span class=\"line\">    <span class=\"comment\">//å°†oldCapacity å³ç§»ä¸€ä½ï¼Œå…¶æ•ˆæœç›¸å½“äºoldCapacity /2ï¼Œ</span></span><br><span class=\"line\">    <span class=\"comment\">//æˆ‘ä»¬çŸ¥é“ä½è¿ç®—çš„é€Ÿåº¦è¿œè¿œå¿«äºæ•´é™¤è¿ç®—ï¼Œæ•´å¥è¿ç®—å¼çš„ç»“æœå°±æ˜¯å°†æ–°å®¹é‡æ›´æ–°ä¸ºæ—§å®¹é‡çš„1.5å€ï¼Œ</span></span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">newCapacity</span> <span class=\"operator\">=</span> oldCapacity + (oldCapacity &gt;&gt; <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"comment\">//ç„¶åæ£€æŸ¥æ–°å®¹é‡æ˜¯å¦å¤§äºæœ€å°éœ€è¦å®¹é‡ï¼Œè‹¥è¿˜æ˜¯å°äºæœ€å°éœ€è¦å®¹é‡ï¼Œé‚£ä¹ˆå°±æŠŠæœ€å°éœ€è¦å®¹é‡å½“ä½œæ•°ç»„çš„æ–°å®¹é‡ï¼Œ</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (newCapacity - minCapacity &lt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        newCapacity = minCapacity;</span><br><span class=\"line\">   <span class=\"comment\">// å¦‚æœæ–°å®¹é‡å¤§äº MAX_ARRAY_SIZE,è¿›å…¥(æ‰§è¡Œ) `hugeCapacity()` æ–¹æ³•æ¥æ¯”è¾ƒ minCapacity å’Œ MAX_ARRAY_SIZEï¼Œ</span></span><br><span class=\"line\">   <span class=\"comment\">//å¦‚æœminCapacityå¤§äºæœ€å¤§å®¹é‡ï¼Œåˆ™æ–°å®¹é‡åˆ™ä¸º`Integer.MAX_VALUE`ï¼Œå¦åˆ™ï¼Œæ–°å®¹é‡å¤§å°åˆ™ä¸º MAX_ARRAY_SIZE å³ä¸º `Integer.MAX_VALUE - 8`ã€‚</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (newCapacity - MAX_ARRAY_SIZE &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        newCapacity = hugeCapacity(minCapacity);</span><br><span class=\"line\">    <span class=\"comment\">// minCapacity is usually close to size, so this is a win:</span></span><br><span class=\"line\">    elementData = Arrays.copyOf(elementData, newCapacity);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>int newCapacity &#x3D; oldCapacity + (oldCapacity &gt;&gt; 1),æ‰€ä»¥ ArrayList æ¯æ¬¡æ‰©å®¹ä¹‹åå®¹é‡éƒ½ä¼šå˜ä¸ºåŸæ¥çš„ 1.5 å€å·¦å³ï¼ˆoldCapacity ä¸ºå¶æ•°å°±æ˜¯ 1.5 å€ï¼Œå¦åˆ™æ˜¯ 1.5 å€å·¦å³ï¼‰</strong> </p>\n<p><strong>æˆ‘ä»¬å†æ¥é€šè¿‡ä¾‹å­æ¢ç©¶ä¸€ä¸‹grow() æ–¹æ³• ï¼š</strong></p>\n<ul>\n<li>å½“ add ç¬¬ 1 ä¸ªå…ƒç´ æ—¶ï¼ŒoldCapacity ä¸º 0ï¼Œç»æ¯”è¾ƒåç¬¬ä¸€ä¸ª if åˆ¤æ–­æˆç«‹ï¼ŒnewCapacity &#x3D; minCapacity(ä¸º 10)ã€‚ä½†æ˜¯ç¬¬äºŒä¸ª if åˆ¤æ–­ä¸ä¼šæˆç«‹ï¼Œå³ newCapacity ä¸æ¯” MAX_ARRAY_SIZE å¤§ï¼Œåˆ™ä¸ä¼šè¿›å…¥ <code>hugeCapacity</code> æ–¹æ³•ã€‚æ•°ç»„å®¹é‡ä¸º 10ï¼Œadd æ–¹æ³•ä¸­ return true,size å¢ä¸º 1ã€‚</li>\n<li>å½“ add ç¬¬ 11 ä¸ªå…ƒç´ è¿›å…¥ grow æ–¹æ³•æ—¶ï¼ŒnewCapacity ä¸º 15ï¼Œæ¯” minCapacityï¼ˆä¸º 11ï¼‰å¤§ï¼Œç¬¬ä¸€ä¸ª if åˆ¤æ–­ä¸æˆç«‹ã€‚æ–°å®¹é‡æ²¡æœ‰å¤§äºæ•°ç»„æœ€å¤§ sizeï¼Œä¸ä¼šè¿›å…¥ hugeCapacity æ–¹æ³•ã€‚æ•°ç»„å®¹é‡æ‰©ä¸º 15ï¼Œadd æ–¹æ³•ä¸­ return true,size å¢ä¸º 11ã€‚</li>\n<li>ä»¥æ­¤ç±»æ¨Â·Â·Â·Â·Â·Â·</li>\n</ul>\n<h5 id=\"2-5-hugeCapacity\"><a href=\"#2-5-hugeCapacity\" class=\"headerlink\" title=\"2.5. hugeCapacity()\"></a>2.5. <code>hugeCapacity()</code></h5><p>ä»ä¸Šé¢ <code>grow()</code> æ–¹æ³•æºç æˆ‘ä»¬çŸ¥é“ï¼š å¦‚æœæ–°å®¹é‡å¤§äº MAX_ARRAY_SIZE,è¿›å…¥(æ‰§è¡Œ) <code>hugeCapacity()</code> æ–¹æ³•æ¥æ¯”è¾ƒ minCapacity å’Œ MAX_ARRAY_SIZEï¼Œå¦‚æœ minCapacity å¤§äºæœ€å¤§å®¹é‡ï¼Œåˆ™æ–°å®¹é‡åˆ™ä¸º<code>Integer.MAX_VALUE</code>ï¼Œå¦åˆ™ï¼Œæ–°å®¹é‡å¤§å°åˆ™ä¸º MAX_ARRAY_SIZE å³ä¸º <code>Integer.MAX_VALUE - 8</code>ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"title function_\">hugeCapacity</span><span class=\"params\">(<span class=\"type\">int</span> minCapacity)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (minCapacity &lt; <span class=\"number\">0</span>) <span class=\"comment\">// overflow</span></span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">OutOfMemoryError</span>();</span><br><span class=\"line\">    <span class=\"comment\">//å¯¹minCapacityå’ŒMAX_ARRAY_SIZEè¿›è¡Œæ¯”è¾ƒ</span></span><br><span class=\"line\">    <span class=\"comment\">//è‹¥minCapacityå¤§ï¼Œå°†Integer.MAX_VALUEä½œä¸ºæ–°æ•°ç»„çš„å¤§å°</span></span><br><span class=\"line\">    <span class=\"comment\">//è‹¥MAX_ARRAY_SIZEå¤§ï¼Œå°†MAX_ARRAY_SIZEä½œä¸ºæ–°æ•°ç»„çš„å¤§å°</span></span><br><span class=\"line\">    <span class=\"comment\">//MAX_ARRAY_SIZE = Integer.MAX_VALUE - 8;</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> (minCapacity &gt; MAX_ARRAY_SIZE) ?</span><br><span class=\"line\">        Integer.MAX_VALUE :</span><br><span class=\"line\">        MAX_ARRAY_SIZE;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Setæ¥å£\"><a href=\"#Setæ¥å£\" class=\"headerlink\" title=\"Setæ¥å£\"></a>Setæ¥å£</h3><h4 id=\"HashSet-çš„å®ç°åŸç†ï¼Ÿ\"><a href=\"#HashSet-çš„å®ç°åŸç†ï¼Ÿ\" class=\"headerlink\" title=\"HashSet çš„å®ç°åŸç†ï¼Ÿ\"></a>HashSet çš„å®ç°åŸç†ï¼Ÿ</h4><p>HashSet æ˜¯åŸºäº HashMap å®ç°çš„ï¼ŒHashSet çš„å€¼å­˜æ”¾äº HashMap çš„ key ä¸Šï¼ŒHashMap çš„ value ç»Ÿä¸€ä¸º Object å¸¸é‡ PRESENTï¼Œç”±äº HashMap çš„ key ä¸å…è®¸é‡å¤ï¼Œè€Œ HashSet ä¸å…è®¸é‡å¤çš„å€¼ï¼Œå› æ­¤ HashSet å¯ä»¥åŸºäº HashMap å®ç°ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯ç›´æ¥è°ƒç”¨åº•å±‚ HashMap çš„ç›¸å…³æ–¹æ³•æ¥å®Œæˆã€‚</p>\n<h4 id=\"HashSetæ˜¯å¦‚ä½•ä¿è¯æ•°æ®ä¸å¯é‡å¤çš„ï¼Ÿ\"><a href=\"#HashSetæ˜¯å¦‚ä½•ä¿è¯æ•°æ®ä¸å¯é‡å¤çš„ï¼Ÿ\" class=\"headerlink\" title=\"HashSetæ˜¯å¦‚ä½•ä¿è¯æ•°æ®ä¸å¯é‡å¤çš„ï¼Ÿ\"></a>HashSetæ˜¯å¦‚ä½•ä¿è¯æ•°æ®ä¸å¯é‡å¤çš„ï¼Ÿ</h4><p>å½“ä½ æŠŠå¯¹è±¡åŠ å…¥ hashSet æ—¶ï¼ŒhashSet ä¼šå…ˆè®¡ç®—å¯¹è±¡çš„ hashcode å€¼æ¥åˆ¤æ–­å¯¹è±¡åŠ å…¥çš„ä½ç½®ï¼Œå¦‚æœå‘ç°æœ‰ç›¸åŒ hashcode å€¼çš„å¯¹è±¡ï¼Œè¿™æ—¶ä¼šè°ƒç”¨ equals()æ–¹æ³•æ¥æ£€æŸ¥ hashcode ç›¸ç­‰çš„å¯¹è±¡æ˜¯å¦çœŸçš„ç›¸åŒã€‚å¦‚æœä¸¤è€…ç›¸åŒï¼Œè¡¨æ˜å·²ç»æœ‰äº†ç›¸åŒçš„å¯¹è±¡äº†ï¼ŒhashSet å°±ä¸ä¼šè®©å…¶åŠ å…¥æ“ä½œæˆåŠŸã€‚å¦‚æœä¸åŒçš„è¯ï¼Œå°±ä¼šé‡æ–°æ•£åˆ—åˆ°å…¶ä»–ä½ç½®ã€‚ </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Dummy value to associate with an Object in the backing Map</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">Object</span> <span class=\"variable\">PRESENT</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>();</span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">transient</span> HashMap&lt;E,Object&gt; map;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"title function_\">HashSet</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    map = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;&gt;();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"type\">boolean</span> <span class=\"title function_\">add</span><span class=\"params\">(E e)</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// è°ƒç”¨HashMapçš„putæ–¹æ³•,PRESENTæ˜¯ä¸€ä¸ªè‡³å§‹è‡³ç»ˆéƒ½ç›¸åŒçš„è™šå€¼</span></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> map.put(e, PRESENT)==<span class=\"literal\">null</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"åªé‡å†™-hashCode-å¯ä»¥å—ï¼Ÿ\"><a href=\"#åªé‡å†™-hashCode-å¯ä»¥å—ï¼Ÿ\" class=\"headerlink\" title=\"åªé‡å†™ hashCode å¯ä»¥å—ï¼Ÿ\"></a>åªé‡å†™ hashCode å¯ä»¥å—ï¼Ÿ</h4><p>ä¸¤ä¸ªå¯¹è±¡çš„ hashCode ç›¸åŒï¼Œä½†æ˜¯å†…å®¹å¯èƒ½ä¸åŒï¼Œåœ¨ set ä¸­æ˜æ˜åº”è¯¥æ˜¯ä¸¤ä¸ªä¸åŒçš„å¯¹è±¡ï¼Œè¿™æ—¶å€™åªé€šè¿‡ hashCode åˆ¤æ–­ä»–ä¿©ç›¸åŒä¼šå¯¼è‡´åªæ’å…¥ä¸€ä¸ªå…ƒç´ ã€‚</p>\n<h4 id=\"åªé‡å†™-equalså¯ä»¥å—ï¼Ÿ\"><a href=\"#åªé‡å†™-equalså¯ä»¥å—ï¼Ÿ\" class=\"headerlink\" title=\"åªé‡å†™ equalså¯ä»¥å—ï¼Ÿ\"></a>åªé‡å†™ equalså¯ä»¥å—ï¼Ÿ</h4><p>å¦‚æœåœ¨é‡å†™ equals æ—¶ï¼Œä¸é‡å†™ hashCodeï¼Œå°±ä¼šå¼•èµ·æ¯”å¦‚è¯´å°†ä¸¤ä¸ªç›¸ç­‰çš„è‡ªå®šä¹‰å¯¹è±¡å­˜å‚¨åœ¨ Set é›†åˆæ—¶ï¼Œä¼šå°†è¿™ä¸¤ä¸ªå¯¹è±¡éƒ½è¿›è¡Œæ’å…¥ã€‚ï¼ˆæ— æ³•å»é‡ï¼‰</p>\n<h2 id=\"Mapæ¥å£\"><a href=\"#Mapæ¥å£\" class=\"headerlink\" title=\"Mapæ¥å£\"></a>Mapæ¥å£</h2><h3 id=\"HashMapçº¿ç¨‹ä¸å®‰å…¨çš„ä¸»è¦ä½“ç°ï¼Ÿ\"><a href=\"#HashMapçº¿ç¨‹ä¸å®‰å…¨çš„ä¸»è¦ä½“ç°ï¼Ÿ\" class=\"headerlink\" title=\"HashMapçº¿ç¨‹ä¸å®‰å…¨çš„ä¸»è¦ä½“ç°ï¼Ÿ\"></a>HashMapçº¿ç¨‹ä¸å®‰å…¨çš„ä¸»è¦ä½“ç°ï¼Ÿ</h3><ol>\n<li><p>åœ¨ jdk1.7 ä¸­ï¼Œåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œ<strong>æ‰©å®¹</strong>æ—¶ä¼šé€ æˆæ­»é“¾ã€‚</p>\n<blockquote>\n<p>ä½œè€…ï¼šç£Šå“¥<br>é“¾æ¥ï¼š<a href=\"https://www.zhihu.com/question/394039290/answer/2314917909\">https://www.zhihu.com/question/394039290/answer/2314917909</a><br>æ¥æºï¼šçŸ¥ä¹</p>\n</blockquote>\n<p> 1.1ã€</p>\n<p> æ­»å¾ªç¯æ˜¯å› ä¸ºå¹¶å‘ HashMap æ‰©å®¹å¯¼è‡´çš„ï¼Œå¹¶å‘æ‰©å®¹çš„ç¬¬ä¸€æ­¥ï¼Œçº¿ç¨‹ T1 å’Œçº¿ç¨‹ T2 è¦å¯¹ HashMap è¿›è¡Œæ‰©å®¹æ“ä½œï¼Œæ­¤æ—¶ T1 å’Œ T2 æŒ‡å‘çš„æ˜¯é“¾è¡¨çš„å¤´ç»“ç‚¹å…ƒç´  Aï¼Œè€Œ T1 å’Œ T2 çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯ T1.next å’Œ T2.next æŒ‡å‘çš„æ˜¯ B èŠ‚ç‚¹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š </p>\n<p> <img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/v2-e0b4f5ea00cb277bde490f315b9b387f_720w.jpg\" alt=\"å¤šçº¿ç¨‹æ‰©å®¹å¯¼è‡´æ­»å¾ªç¯é—®é¢˜-1\"></p>\n<p> 1.2ã€</p>\n<p> æ­»å¾ªç¯çš„ç¬¬äºŒæ­¥æ“ä½œæ˜¯ï¼Œçº¿ç¨‹ T2 æ—¶é—´ç‰‡ç”¨å®Œè¿›å…¥ä¼‘çœ çŠ¶æ€ï¼Œè€Œçº¿ç¨‹ T1 å¼€å§‹æ‰§è¡Œæ‰©å®¹æ“ä½œï¼Œä¸€ç›´åˆ°çº¿ç¨‹ T1 æ‰©å®¹å®Œæˆåï¼Œçº¿ç¨‹ T2 æ‰è¢«å”¤é†’ï¼Œæ‰©å®¹ä¹‹åçš„åœºæ™¯å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š </p>\n<p> <img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/v2-5f78d8ac8af1efc79e7d79a1f3fdc154_r.jpg\" alt=\"å¤šçº¿ç¨‹æ‰©å®¹å¯¼è‡´æ­»å¾ªç¯é—®é¢˜-2\"></p>\n<p>  ä»ä¸Šå›¾å¯çŸ¥çº¿ç¨‹ T1 æ‰§è¡Œä¹‹åï¼Œ<strong>å› ä¸ºæ˜¯å¤´æ’æ³•ï¼Œæ‰€ä»¥HashMapçš„é¡ºåºå·²ç»å‘ç”Ÿäº†æ”¹å˜</strong>ï¼Œä½†çº¿ç¨‹ T2 å¯¹äºå‘ç”Ÿçš„ä¸€åˆ‡æ˜¯ä¸å¯çŸ¥çš„ï¼Œæ‰€ä»¥å®ƒçš„æŒ‡å‘å…ƒç´ ä¾ç„¶æ²¡å˜ï¼Œå¦‚ä¸Šå›¾å±•ç¤ºçš„é‚£æ ·ï¼ŒT2 æŒ‡å‘çš„æ˜¯ A å…ƒç´ ï¼ŒT2.next æŒ‡å‘çš„èŠ‚ç‚¹æ˜¯ B å…ƒç´ ã€‚</p>\n<p> 1.3ã€</p>\n<p> å½“çº¿ç¨‹ T1 æ‰§è¡Œå®Œï¼Œè€Œçº¿ç¨‹ T2 æ¢å¤æ‰§è¡Œæ—¶ï¼Œæ­»å¾ªç¯å°±å»ºç«‹äº†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š </p>\n<p> <img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/v2-bd4a753db8c985119aa4dcd4356609cf_720w.jpg\" alt=\"å¤šçº¿ç¨‹æ‰©å®¹å¯¼è‡´æ­»å¾ªç¯é—®é¢˜-3\"></p>\n<p>  å› ä¸º T1 æ‰§è¡Œå®Œæ‰©å®¹ä¹‹å B èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ˜¯ Aï¼Œè€Œ T2 çº¿ç¨‹æŒ‡å‘çš„é¦–èŠ‚ç‚¹æ˜¯ Aï¼Œç¬¬äºŒä¸ªèŠ‚ç‚¹æ˜¯ Bï¼Œè¿™ä¸ªé¡ºåºåˆšå¥½å’Œ T1 æ‰©å®Œå®¹å®Œä¹‹åçš„èŠ‚ç‚¹é¡ºåºæ˜¯ç›¸åçš„ã€‚<strong>T1æ‰§è¡Œå®Œä¹‹åçš„é¡ºåºæ˜¯Båˆ°Aï¼Œè€ŒT2çš„é¡ºåºæ˜¯Aåˆ°Bï¼Œè¿™æ ·AèŠ‚ç‚¹å’ŒBèŠ‚ç‚¹å°±å½¢æˆæ­»å¾ªç¯äº†</strong>ï¼Œè¿™å°±æ˜¯ HashMap æ­»å¾ªç¯å¯¼è‡´çš„åŸå› ã€‚</p>\n</li>\n<li><p>åœ¨ jdk1.8 ä¸­ï¼Œåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œ<strong>æ’å…¥</strong>æ—¶ä¼šå‘ç”Ÿæ•°æ®è¦†ç›–çš„æƒ…å†µï¼ˆ<strong>å°¾æ’æ³•</strong>ï¼‰ã€‚</p>\n</li>\n</ol>\n<h3 id=\"HashMapåœ¨JDK1-7å’ŒJDK1-8ä¸­æœ‰å“ªäº›ä¸åŒï¼Ÿ\"><a href=\"#HashMapåœ¨JDK1-7å’ŒJDK1-8ä¸­æœ‰å“ªäº›ä¸åŒï¼Ÿ\" class=\"headerlink\" title=\"HashMapåœ¨JDK1.7å’ŒJDK1.8ä¸­æœ‰å“ªäº›ä¸åŒï¼Ÿ\"></a>HashMapåœ¨JDK1.7å’ŒJDK1.8ä¸­æœ‰å“ªäº›ä¸åŒï¼Ÿ</h3><table>\n<thead>\n<tr>\n<th>ä¸åŒ</th>\n<th>JDK 1.7</th>\n<th>JDK 1.8</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><strong>å­˜å‚¨ç»“æ„</strong></td>\n<td>æ•°ç»„ + é“¾è¡¨</td>\n<td>æ•°ç»„ + é“¾è¡¨ + çº¢é»‘æ ‘</td>\n</tr>\n<tr>\n<td><strong>hashå€¼è®¡ç®—æ–¹å¼</strong></td>\n<td>æ‰°åŠ¨å¤„ç† &#x3D; 4æ¬¡ä½è¿ç®— + 5æ¬¡å¼‚æˆ–è¿ç®—</td>\n<td>æ‰°åŠ¨å¤„ç† &#x3D; 1æ¬¡ä½è¿ç®— + 1æ¬¡å¼‚æˆ–è¿ç®—</td>\n</tr>\n<tr>\n<td><strong>å­˜æ”¾æ•°æ®çš„è§„åˆ™</strong></td>\n<td>æ— å†²çªæ—¶ï¼Œå­˜æ”¾æ•°ç»„ï¼›<br />å†²çªæ—¶ï¼Œå­˜æ”¾é“¾è¡¨</td>\n<td>æ— å†²çªæ—¶ï¼Œå­˜æ”¾æ•°ç»„ï¼›<br />å†²çª &amp; é“¾è¡¨é•¿åº¦ &lt; 8ï¼šæ’å…¥å•é“¾è¡¨ï¼›<br />é“¾è¡¨é•¿åº¦&gt;8ï¼Œå…ˆå°è¯•æ‰©å®¹æ•°ç»„ï¼Œæ•°ç»„é•¿åº¦å¤§äº64<br />é“¾è¡¨è½¬ä¸ºçº¢é»‘æ ‘ï¼Œæ’å…¥åˆ°çº¢é»‘æ ‘</td>\n</tr>\n<tr>\n<td><strong>æ’å…¥æ•°æ®æ–¹å¼</strong></td>\n<td>å¤´æ’æ³•</td>\n<td>å°¾æ’æ³•</td>\n</tr>\n<tr>\n<td><strong>æ‰©å®¹åå­˜å‚¨ä½ç½®çš„è®¡ç®—æ–¹å¼</strong></td>\n<td>æŒ‰ç…§åŸæ¥æ–¹æ³•é‡æ–°è¿›è¡Œè®¡ç®—<br />hashCodeã€æ‰°åŠ¨å‡½æ•°ã€ä¸è¿ç®—h&amp;length-1</td>\n<td>æ ¹æ®å…ƒç´ çš„hashå€¼è¿›è¡Œåˆ¤æ–­ <br />æ‰©å®¹åçš„ä½ç½®&#x3D;åŸä½ç½® or åŸä½ç½® + æ—§å®¹é‡</td>\n</tr>\n</tbody></table>\n<h3 id=\"HashMapçš„hashç®—æ³•\"><a href=\"#HashMapçš„hashç®—æ³•\" class=\"headerlink\" title=\"HashMapçš„hashç®—æ³•\"></a>HashMapçš„hashç®—æ³•</h3><h4 id=\"ä»€ä¹ˆæ˜¯å“ˆå¸Œï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯å“ˆå¸Œï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯å“ˆå¸Œï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯å“ˆå¸Œï¼Ÿ</h4><p>Hashï¼Œå°±æ˜¯æŠŠä»»æ„é•¿åº¦çš„è¾“å…¥é€šè¿‡æ•£åˆ—ç®—æ³•ï¼Œå˜æ¢æˆå›ºå®šé•¿åº¦çš„è¾“å‡ºï¼Œè¯¥è¾“å‡ºå°±æ˜¯æ•£åˆ—å€¼ï¼ˆå“ˆå¸Œå€¼ï¼‰ï¼›</p>\n<p>hash å€¼ä¸åŒï¼Œè¾“å…¥ä¸€å®šä¸åŒï¼›è¾“å…¥ä¸åŒï¼Œhash å€¼å¯èƒ½ç›¸åŒï¼ˆå³å“ˆå¸Œç¢°æ’ï¼‰</p>\n<h4 id=\"ä»€ä¹ˆæ˜¯å“ˆå¸Œå†²çªï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯å“ˆå¸Œå†²çªï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯å“ˆå¸Œå†²çªï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯å“ˆå¸Œå†²çªï¼Ÿ</h4><p>å½“ä¸¤ä¸ªä¸åŒçš„è¾“å…¥å€¼ï¼Œæ ¹æ®åŒä¸€æ•£åˆ—å‡½æ•°è®¡ç®—å‡ºç›¸åŒçš„æ•£åˆ—å€¼çš„ç°è±¡ï¼Œæˆ‘ä»¬å°±æŠŠå®ƒå«åšå“ˆå¸Œç¢°æ’&#x2F;å†²çªã€‚</p>\n<h4 id=\"HashMapçš„æ•°æ®ç»“æ„\"><a href=\"#HashMapçš„æ•°æ®ç»“æ„\" class=\"headerlink\" title=\"HashMapçš„æ•°æ®ç»“æ„\"></a>HashMapçš„æ•°æ®ç»“æ„</h4><p>åº•å±‚æ•°æ®ç»“æ„ï¼šæ•°ç»„+é“¾è¡¨<br><strong>æ•°ç»„çš„ç‰¹ç‚¹æ˜¯ï¼šæ–¹ä¾¿æŸ¥æ‰¾ï¼›é“¾è¡¨çš„ç‰¹ç‚¹æ˜¯ï¼šæ–¹ä¾¿æ’å…¥åˆ é™¤</strong><br>æ‰€ä»¥æˆ‘ä»¬å°†æ•°ç»„å’Œé“¾è¡¨ç»“åˆåœ¨ä¸€èµ·ï¼Œå‘æŒ¥ä¸¤è€…å„è‡ªçš„ä¼˜åŠ¿ï¼Œä½¿ç”¨ä¸€ç§å«åš<strong>é“¾åœ°å€æ³•</strong>çš„æ–¹å¼å¯ä»¥è§£å†³å“ˆå¸Œå†²çª</p>\n<blockquote>\n<p>è§£å†³å“ˆå¸Œå†²çªçš„å…¶ä»–æ–¹æ³•ï¼š<br>å¼€æ”¾å®šå€æ³•ï¼ˆå†²çªäº†é€šè¿‡æŸç§æ–¹å¼æ•£åˆ—åˆ°å¦ä¸€ä¸ªä¸å†²çªçš„ä½ç½®ä¸Šï¼‰ï¼›<br>å†å“ˆå¸Œæ³•ï¼ˆæ„é€ å¤šä¸ªä¸åŒçš„å“ˆå¸Œå‡½æ•°ï¼‰ã€‚</p>\n</blockquote>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy83ODk2ODkwLWM2NmE0YmQ4OTA3ZjQ5ZjYucG5n.png\" alt=\"HashMapæ•°æ®ç»“æ„\"></p>\n<h4 id=\"æ‰°åŠ¨å¤„ç†\"><a href=\"#æ‰°åŠ¨å¤„ç†\" class=\"headerlink\" title=\"æ‰°åŠ¨å¤„ç†\"></a>æ‰°åŠ¨å¤„ç†</h4><p>ç”±äºè®¡ç®—ä¸‹æ ‡æ—¶ï¼Œé€šè¿‡ h &amp; (length - 1)ï¼Œç”±äº hash å€¼èŒƒå›´å¾ˆå¤§ï¼Œè€Œæ•°ç»„é•¿åº¦ç›¸å¯¹æ¥è¯´å°å¾—å¤šï¼Œå¯¼è‡´è¿›è¡Œä¸è¿ç®—æ—¶å‚ä¸è¿ç®—çš„åªæœ‰ hash å€¼çš„ä½ä½ï¼Œ<strong>é«˜ä½æ˜¯æ²¡æœ‰èµ·åˆ°ä»»ä½•ä½œç”¨çš„</strong>ï¼Œè¿™å°†ä¼šå¤§å¤§å¢åŠ å“ˆå¸Œç¢°æ’çš„æ¦‚ç‡ã€‚æ‰€ä»¥æˆ‘ä»¬çš„æ€è·¯å°±æ˜¯è®© hashCode å€¼çš„é«˜ä½ä¹Ÿå‚ä¸è¿ç®—ï¼Œè¿›ä¸€æ­¥é™ä½ hash ç¢°æ’çš„æ¦‚ç‡ï¼Œä½¿å¾—<strong>æ•°æ®åˆ†å¸ƒæ›´å¹³å‡</strong>ï¼Œæˆ‘ä»¬æŠŠè¿™æ ·çš„æ“ä½œç§°ä¸º<strong>æ‰°åŠ¨</strong>ï¼Œåœ¨<strong>JDK 1.8</strong>ä¸­çš„ hash()å‡½æ•°å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"title function_\">hash</span><span class=\"params\">(Object key)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> h;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (key == <span class=\"literal\">null</span>) ? <span class=\"number\">0</span> : (h = key.hashCode()) ^ (h &gt;&gt;&gt; <span class=\"number\">16</span>);</span><br><span class=\"line\">    <span class=\"comment\">// ä¸è‡ªå·±å³ç§»16ä½è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼ˆé«˜ä½ä½å¼‚æˆ–ï¼‰</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>è¿™æ¯”åœ¨<strong>JDK 1.7</strong>ä¸­ï¼Œæ›´ä¸ºç®€æ´ï¼Œ<strong>ç›¸æ¯”åœ¨1.7ä¸­çš„4æ¬¡ä½è¿ç®—ï¼Œ5æ¬¡å¼‚æˆ–è¿ç®—ï¼ˆ9æ¬¡æ‰°åŠ¨ï¼‰ï¼Œåœ¨1.8ä¸­ï¼Œåªè¿›è¡Œäº†1æ¬¡ä½è¿ç®—å’Œ1æ¬¡å¼‚æˆ–è¿ç®—ï¼ˆ2æ¬¡æ‰°åŠ¨ï¼‰</strong>ï¼›</p>\n<h4 id=\"ä¸‹æ ‡è®¡ç®—\"><a href=\"#ä¸‹æ ‡è®¡ç®—\" class=\"headerlink\" title=\"ä¸‹æ ‡è®¡ç®—\"></a>ä¸‹æ ‡è®¡ç®—</h4><p>åœ¨å¾—åˆ° hash å€¼ä¹‹åï¼Œæˆ‘ä»¬è¦æŠŠè¿™äº› hash å€¼æ˜ å°„åˆ°ç›¸åº”çš„æ•°ç»„ä¸‹æ ‡ä¸Šï¼Œé‚£ä¹ˆå°±å¯ä»¥è€ƒè™‘ä½¿ç”¨ hash % length</p>\n<p>è€Œ hash % length&#x3D;&#x3D;hash &amp; (length-1) å¹¶ä¸”å‰ææ˜¯ length æ˜¯ 2 çš„ n æ¬¡æ–¹ã€‚<br>ç”±äºé‡‡ç”¨äºŒè¿›åˆ¶ä½æ“ä½œ &amp;ï¼Œç›¸å¯¹äº%èƒ½å¤Ÿæé«˜è¿ç®—æ•ˆç‡ï¼Œå› æ­¤å¯ä»¥å°† HashMap çš„é•¿åº¦è®¾è®¡ä¸º 2 çš„å¹‚æ¬¡æ–¹ã€‚ï¼ˆåˆå§‹åŒ–ä¸º 16ï¼Œå¦‚æœæŒ‡å®šåˆå§‹åŒ–å®¹é‡çš„å€¼ï¼Œä¼šæ‰©å®¹è‡³ç¬¬ä¸€ä¸ªå¤§äºè¯¥å®¹é‡çš„ 2 çš„å¹‚æ¬¡æ–¹ä½œä¸ºæ•°ç»„å®¹é‡ï¼‰</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"title function_\">indexFor</span><span class=\"params\">(<span class=\"type\">int</span> h, <span class=\"type\">int</span> length)</span>&#123;</span><br><span class=\"line\">     <span class=\"keyword\">return</span> h &amp; (length - <span class=\"number\">1</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"ä¸ºä»€ä¹ˆè¦å°†æ•°ç»„é•¿åº¦è®¾ç½®ä¸º-2-çš„næ¬¡å¹‚å‘¢ï¼Ÿ\"><a href=\"#ä¸ºä»€ä¹ˆè¦å°†æ•°ç»„é•¿åº¦è®¾ç½®ä¸º-2-çš„næ¬¡å¹‚å‘¢ï¼Ÿ\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆè¦å°†æ•°ç»„é•¿åº¦è®¾ç½®ä¸º 2 çš„næ¬¡å¹‚å‘¢ï¼Ÿ\"></a>ä¸ºä»€ä¹ˆè¦å°†æ•°ç»„é•¿åº¦è®¾ç½®ä¸º 2 çš„næ¬¡å¹‚å‘¢ï¼Ÿ</h4><p>å½“æ•°ç»„é•¿åº¦ä¸º 2 çš„ n æ¬¡å¹‚çš„æ—¶å€™ï¼Œä¸åŒçš„ key ä¸ 1111ï¼ˆn ä¸ªï¼‰è¿›è¡Œä¸é¢„ç®—å¾—åˆ°ç›¸åŒä¸‹æ ‡çš„å‡ ç‡è¾ƒå°ï¼Œå‘ç”Ÿç¢°æ’çš„å‡ ç‡å°ã€‚ </p>\n<h4 id=\"JDK1-8æ–°å¢çº¢é»‘æ ‘\"><a href=\"#JDK1-8æ–°å¢çº¢é»‘æ ‘\" class=\"headerlink\" title=\"JDK1.8æ–°å¢çº¢é»‘æ ‘\"></a>JDK1.8æ–°å¢çº¢é»‘æ ‘</h4><p>ä¸ºäº†è§£å†³ä¸€æ¡é“¾ä¸Šçš„å…ƒç´ è¿‡å¤šï¼ŒæŸ¥æ‰¾æ•ˆç‡ä½çš„é—®é¢˜ï¼Œå°†é“¾è¡¨è½¬åŒ–ä¸ºçº¢é»‘æ ‘ï¼Œéå†å¤æ‚åº¦é™ä½è‡³ O(logn)ï¼›</p>\n<h4 id=\"HashMapæ˜¯ä½¿ç”¨äº†å“ªäº›æ–¹æ³•æ¥æœ‰æ•ˆè§£å†³å“ˆå¸Œå†²çªçš„ï¼Ÿ\"><a href=\"#HashMapæ˜¯ä½¿ç”¨äº†å“ªäº›æ–¹æ³•æ¥æœ‰æ•ˆè§£å†³å“ˆå¸Œå†²çªçš„ï¼Ÿ\" class=\"headerlink\" title=\"HashMapæ˜¯ä½¿ç”¨äº†å“ªäº›æ–¹æ³•æ¥æœ‰æ•ˆè§£å†³å“ˆå¸Œå†²çªçš„ï¼Ÿ\"></a>HashMapæ˜¯ä½¿ç”¨äº†å“ªäº›æ–¹æ³•æ¥æœ‰æ•ˆè§£å†³å“ˆå¸Œå†²çªçš„ï¼Ÿ</h4><ol>\n<li>ä½¿ç”¨é“¾åœ°å€æ³•ï¼ˆä½¿ç”¨æ•£åˆ—è¡¨ï¼‰æ¥é“¾æ¥æ‹¥æœ‰ç›¸åŒ hash å€¼çš„æ•°æ®ï¼›</li>\n<li>ä½¿ç”¨ 2 æ¬¡æ‰°åŠ¨å‡½æ•°ï¼ˆ1 æ¬¡ä½è¿ç®—å’Œ 1 æ¬¡å¼‚æˆ–è¿ç®—ï¼‰æ¥é™ä½å“ˆå¸Œå†²çªçš„æ¦‚ç‡ï¼Œä½¿å¾—æ•°æ®åˆ†å¸ƒæ›´å¹³å‡ï¼›</li>\n<li>å¼•å…¥çº¢é»‘æ ‘è¿›ä¸€æ­¥é™ä½éå†çš„æ—¶é—´å¤æ‚åº¦ï¼Œä½¿å¾—éå†æ›´å¿«ã€‚</li>\n</ol>\n<h3 id=\"HashMapçš„getæ–¹æ³•çš„å…·ä½“æµç¨‹ï¼Ÿ\"><a href=\"#HashMapçš„getæ–¹æ³•çš„å…·ä½“æµç¨‹ï¼Ÿ\" class=\"headerlink\" title=\"HashMapçš„getæ–¹æ³•çš„å…·ä½“æµç¨‹ï¼Ÿ\"></a>HashMapçš„getæ–¹æ³•çš„å…·ä½“æµç¨‹ï¼Ÿ</h3><ol>\n<li>å…ˆä½¿ç”¨ key çš„ hashCodeã€æ‰°åŠ¨å¤„ç†ã€ä¸æ•°ç»„é•¿åº¦-1 è¿›è¡Œä¸è¿ç®—ï¼ˆå¯¹æ•°ç»„é•¿åº¦å»ä½™ï¼‰å¾—åˆ°æ§½ä½ï¼›</li>\n<li>åˆ¤æ–­é¦–ç»“ç‚¹ï¼Œå¦‚æœé¦–ç»“ç‚¹å’Œ key çš„ <strong>hashå€¼</strong> ï¼ˆhashCode å€¼ç»è¿‡æ‰°åŠ¨å‡½æ•°å¤„ç†åçš„å€¼ï¼‰ç›¸ç­‰ï¼Œå¹¶ä¸”ä¸¤è€…çš„ <strong>keyå€¼åœ°å€ç›¸ç­‰ã€equalsç›¸ç­‰</strong>ï¼Œåˆ™è¿”å›é¦–ç»“ç‚¹ï¼›</li>\n<li>å¦åˆ™ï¼Œåˆ™çº¢é»‘æ ‘æˆ–è€…é“¾è¡¨ä¸­è¿›è¡ŒæŸ¥æ‰¾ï¼ŒæŸ¥æ‰¾æ—¶åˆ¤æ–­ä¸¤ä¸ª key çš„ hash å€¼ã€key å€¼åœ°å€ç›¸ç­‰ã€equals æ˜¯å¦éƒ½ç›¸ç­‰ã€‚</li>\n</ol>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> V <span class=\"title function_\">get</span><span class=\"params\">(Object key)</span> &#123;</span><br><span class=\"line\">    Node&lt;K,V&gt; e;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (e = getNode(hash(key), key)) == <span class=\"literal\">null</span> ? <span class=\"literal\">null</span> : e.value;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">final</span> Node&lt;K,V&gt; <span class=\"title function_\">getNode</span><span class=\"params\">(<span class=\"type\">int</span> hash, Object key)</span> &#123;</span><br><span class=\"line\">    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; first, e; <span class=\"type\">int</span> n; K k;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">//Nodeæ•°ç»„ä¸ä¸ºç©ºï¼Œæ•°ç»„é•¿åº¦å¤§äº0ï¼Œæ•°ç»„å¯¹åº”ä¸‹æ ‡çš„Nodeä¸ä¸ºç©º</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> ((tab = table) != <span class=\"literal\">null</span> &amp;&amp; (n = tab.length) &gt; <span class=\"number\">0</span> &amp;&amp;</span><br><span class=\"line\">        <span class=\"comment\">//ä¹Ÿæ˜¯é€šè¿‡ hash &amp; (length - 1) æ¥æ›¿ä»£ hash % length çš„</span></span><br><span class=\"line\">        (first = tab[(n - <span class=\"number\">1</span>) &amp; hash]) != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">//å…ˆå’Œç¬¬ä¸€ä¸ªç»“ç‚¹æ¯”ï¼Œhashå€¼ç›¸ç­‰ä¸”keyä¸ä¸ºç©ºï¼Œkeyçš„ç¬¬ä¸€ä¸ªç»“ç‚¹çš„keyçš„å¯¹è±¡åœ°å€å’Œå€¼å‡ç›¸ç­‰</span></span><br><span class=\"line\">        <span class=\"comment\">//åˆ™è¿”å›ç¬¬ä¸€ä¸ªç»“ç‚¹</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (first.hash == hash &amp;&amp; <span class=\"comment\">// always check first node</span></span><br><span class=\"line\">            ((k = first.key) == key || (key != <span class=\"literal\">null</span> &amp;&amp; key.equals(k))))</span><br><span class=\"line\">            <span class=\"keyword\">return</span> first;</span><br><span class=\"line\">        <span class=\"comment\">//å¦‚æœkeyå’Œç¬¬ä¸€ä¸ªç»“ç‚¹ä¸åŒ¹é…ï¼Œåˆ™çœ‹.nextæ˜¯å¦ä¸ºç©ºï¼Œä¸ä¸ºnullåˆ™ç»§ç»­ï¼Œä¸ºç©ºåˆ™è¿”å›null</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> ((e = first.next) != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">//å¦‚æœæ­¤æ—¶æ˜¯çº¢é»‘æ ‘çš„ç»“æ„ï¼Œåˆ™è¿›è¡Œå¤„ç†getTreeNode()æ–¹æ³•æœç´¢key</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (first <span class=\"keyword\">instanceof</span> TreeNode)</span><br><span class=\"line\">                <span class=\"keyword\">return</span> ((TreeNode&lt;K,V&gt;)first).getTreeNode(hash, key);</span><br><span class=\"line\">            <span class=\"comment\">//æ˜¯é“¾è¡¨ç»“æ„çš„è¯å°±ä¸€ä¸ªä¸€ä¸ªéå†ï¼Œç›´åˆ°æ‰¾åˆ°keyå¯¹åº”çš„ç»“ç‚¹ï¼Œ</span></span><br><span class=\"line\">            <span class=\"comment\">//æˆ–è€…eçš„ä¸‹ä¸€ä¸ªç»“ç‚¹ä¸ºnullé€€å‡ºå¾ªç¯</span></span><br><span class=\"line\">            <span class=\"keyword\">do</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (e.hash == hash &amp;&amp;</span><br><span class=\"line\">                    ((k = e.key) == key || (key != <span class=\"literal\">null</span> &amp;&amp; key.equals(k))))</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> e;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">while</span> ((e = e.next) != <span class=\"literal\">null</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"HashMapçš„putæ–¹æ³•çš„å…·ä½“æµç¨‹ï¼Ÿ\"><a href=\"#HashMapçš„putæ–¹æ³•çš„å…·ä½“æµç¨‹ï¼Ÿ\" class=\"headerlink\" title=\"HashMapçš„putæ–¹æ³•çš„å…·ä½“æµç¨‹ï¼Ÿ\"></a>HashMapçš„putæ–¹æ³•çš„å…·ä½“æµç¨‹ï¼Ÿ</h3><ol>\n<li>å¦‚æœ table æœªåˆå§‹åŒ–æˆ–è€…é•¿åº¦ä¸º 0 ç©ºåˆ™æ‰§è¡Œ resize()è¿›è¡Œæ‰©å®¹ï¼Œè½¬å‘â‘¡</li>\n<li>æ ¹æ®é”®å€¼ key è®¡ç®— hash å€¼å¾—åˆ°æ’å…¥çš„æ•°ç»„ç´¢å¼• iï¼Œå¦‚æœ table[i]&#x3D;&#x3D;nullï¼Œå³æ•°ç»„è¯¥ä½ç½®ä¸Šæ²¡æœ‰å…ƒç´ ï¼Œç›´æ¥æ–°å»ºèŠ‚ç‚¹æ’å…¥ï¼Œè½¬å‘â‘¥åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹ï¼Œå¦‚æœ table[i]ä¸ä¸ºç©ºï¼Œè½¬å‘â‘¢ï¼›</li>\n<li>åˆ¤æ–­ table[i]çš„é¦–ä¸ªå…ƒç´ æ˜¯å¦å’Œ key ä¸€æ ·ï¼Œå¦‚æœç›¸åŒï¼ˆhashCode ç›¸åŒã€key åœ°å€ç›¸åŒã€equals ç›¸åŒï¼‰ç›´æ¥è¦†ç›– valueï¼Œå¦åˆ™è½¬å‘â‘£ï¼›</li>\n<li>åˆ¤æ–­ table[i] æ˜¯å¦ä¸º treeNodeï¼Œå³ table[i] æ˜¯å¦æ˜¯çº¢é»‘æ ‘ï¼Œå¦‚æœæ˜¯çº¢é»‘æ ‘ï¼Œåˆ™ç›´æ¥åœ¨æ ‘ä¸­æ’å…¥é”®å€¼å¯¹ï¼Œå¦åˆ™è½¬å‘â‘¤ï¼›</li>\n<li>éå† table[i]ï¼Œåˆ¤æ–­é“¾è¡¨é•¿åº¦æ˜¯å¦å¤§äº 8ï¼Œå¤§äº 8 çš„è¯æŠŠé“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼Œåœ¨çº¢é»‘æ ‘ä¸­æ‰§è¡Œæ’å…¥æ“ä½œï¼Œå¦åˆ™è¿›è¡Œé“¾è¡¨çš„æ’å…¥æ“ä½œï¼›éå†è¿‡ç¨‹ä¸­è‹¥å‘ç° key å·²ç»å­˜åœ¨ç›´æ¥è¦†ç›– value å³å¯ï¼›</li>\n<li>æ’å…¥æˆåŠŸåï¼Œåˆ¤æ–­å®é™…å­˜åœ¨çš„é”®å€¼å¯¹æ•°é‡ size æ˜¯å¦è¶…å‡ºå½“å‰æœ€å¤§å®¹é‡ thresholdï¼Œå¦‚æœè¶…è¿‡ï¼Œè¿›è¡Œæ‰©å®¹ã€‚</li>\n</ol>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> V <span class=\"title function_\">put</span><span class=\"params\">(K key, V value)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> putVal(hash(key), key, value, <span class=\"literal\">false</span>, <span class=\"literal\">true</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"title function_\">hash</span><span class=\"params\">(Object key)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> h;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (key == <span class=\"literal\">null</span>) ? <span class=\"number\">0</span> : (h = key.hashCode()) ^ (h &gt;&gt;&gt; <span class=\"number\">16</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//å®ç°Map.putå’Œç›¸å…³æ–¹æ³•</span></span><br><span class=\"line\"><span class=\"keyword\">final</span> V <span class=\"title function_\">putVal</span><span class=\"params\">(<span class=\"type\">int</span> hash, K key, V value, <span class=\"type\">boolean</span> onlyIfAbsent,</span></span><br><span class=\"line\"><span class=\"params\">                   <span class=\"type\">boolean</span> evict)</span> &#123;</span><br><span class=\"line\">    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; <span class=\"type\">int</span> n, i;</span><br><span class=\"line\">    <span class=\"comment\">// æ­¥éª¤â‘ ï¼štabä¸ºç©ºåˆ™åˆ›å»º </span></span><br><span class=\"line\">    <span class=\"comment\">// tableæœªåˆå§‹åŒ–æˆ–è€…é•¿åº¦ä¸º0ï¼Œè¿›è¡Œæ‰©å®¹</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> ((tab = table) == <span class=\"literal\">null</span> || (n = tab.length) == <span class=\"number\">0</span>)</span><br><span class=\"line\">        n = (tab = resize()).length;</span><br><span class=\"line\">    <span class=\"comment\">// æ­¥éª¤â‘¡ï¼šè®¡ç®—indexï¼Œå¹¶å¯¹nullåšå¤„ç†  </span></span><br><span class=\"line\">    <span class=\"comment\">// (n - 1) &amp; hash ç¡®å®šå…ƒç´ å­˜æ”¾åœ¨å“ªä¸ªæ¡¶ä¸­ï¼Œæ¡¶ä¸ºç©ºï¼Œæ–°ç”Ÿæˆç»“ç‚¹æ”¾å…¥æ¡¶ä¸­(æ­¤æ—¶ï¼Œè¿™ä¸ªç»“ç‚¹æ˜¯æ”¾åœ¨æ•°ç»„ä¸­)</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> ((p = tab[i = (n - <span class=\"number\">1</span>) &amp; hash]) == <span class=\"literal\">null</span>)</span><br><span class=\"line\">        tab[i] = newNode(hash, key, value, <span class=\"literal\">null</span>);</span><br><span class=\"line\">    <span class=\"comment\">// æ¡¶ä¸­å·²ç»å­˜åœ¨å…ƒç´ </span></span><br><span class=\"line\">    <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        Node&lt;K,V&gt; e; K k;</span><br><span class=\"line\">        <span class=\"comment\">// æ­¥éª¤â‘¢ï¼šèŠ‚ç‚¹keyå­˜åœ¨ï¼Œç›´æ¥è¦†ç›–value </span></span><br><span class=\"line\">        <span class=\"comment\">// æ¯”è¾ƒæ¡¶ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ (æ•°ç»„ä¸­çš„ç»“ç‚¹)çš„hashå€¼ç›¸ç­‰ï¼Œkeyç›¸ç­‰</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (p.hash == hash &amp;&amp;</span><br><span class=\"line\">            ((k = p.key) == key || (key != <span class=\"literal\">null</span> &amp;&amp; key.equals(k))))</span><br><span class=\"line\">                <span class=\"comment\">// å°†ç¬¬ä¸€ä¸ªå…ƒç´ èµ‹å€¼ç»™eï¼Œç”¨eæ¥è®°å½•</span></span><br><span class=\"line\">                e = p;</span><br><span class=\"line\">        <span class=\"comment\">// æ­¥éª¤â‘£ï¼šåˆ¤æ–­è¯¥é“¾ä¸ºçº¢é»‘æ ‘ </span></span><br><span class=\"line\">        <span class=\"comment\">// hashå€¼ä¸ç›¸ç­‰ï¼Œå³keyä¸ç›¸ç­‰ï¼›ä¸ºçº¢é»‘æ ‘ç»“ç‚¹</span></span><br><span class=\"line\">        <span class=\"comment\">// å¦‚æœå½“å‰å…ƒç´ ç±»å‹ä¸ºTreeNodeï¼Œè¡¨ç¤ºä¸ºçº¢é»‘æ ‘ï¼ŒputTreeValè¿”å›å¾…å­˜æ”¾çš„node, eå¯èƒ½ä¸ºnull</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (p <span class=\"keyword\">instanceof</span> TreeNode)</span><br><span class=\"line\">            <span class=\"comment\">// æ”¾å…¥æ ‘ä¸­</span></span><br><span class=\"line\">            e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(<span class=\"built_in\">this</span>, tab, hash, key, value);</span><br><span class=\"line\">        <span class=\"comment\">// æ­¥éª¤â‘¤ï¼šè¯¥é“¾ä¸ºé“¾è¡¨ </span></span><br><span class=\"line\">        <span class=\"comment\">// ä¸ºé“¾è¡¨ç»“ç‚¹</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// åœ¨é“¾è¡¨æœ€æœ«æ’å…¥ç»“ç‚¹</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">binCount</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; ; ++binCount) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// åˆ°è¾¾é“¾è¡¨çš„å°¾éƒ¨</span></span><br><span class=\"line\">                </span><br><span class=\"line\">                <span class=\"comment\">//åˆ¤æ–­è¯¥é“¾è¡¨å°¾éƒ¨æŒ‡é’ˆæ˜¯ä¸æ˜¯ç©ºçš„</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> ((e = p.next) == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// åœ¨å°¾éƒ¨æ’å…¥æ–°ç»“ç‚¹</span></span><br><span class=\"line\">                    p.next = newNode(hash, key, value, <span class=\"literal\">null</span>);</span><br><span class=\"line\">                    <span class=\"comment\">//åˆ¤æ–­é“¾è¡¨çš„é•¿åº¦æ˜¯å¦è¾¾åˆ°è½¬åŒ–çº¢é»‘æ ‘çš„ä¸´ç•Œå€¼ï¼Œä¸´ç•Œå€¼ä¸º8</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class=\"number\">1</span>) <span class=\"comment\">// -1 for 1st</span></span><br><span class=\"line\">                        <span class=\"comment\">//é“¾è¡¨ç»“æ„è½¬æ ‘å½¢ç»“æ„</span></span><br><span class=\"line\">                        treeifyBin(tab, hash);</span><br><span class=\"line\">                    <span class=\"comment\">// è·³å‡ºå¾ªç¯</span></span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"comment\">// åˆ¤æ–­é“¾è¡¨ä¸­ç»“ç‚¹çš„keyå€¼ä¸æ’å…¥çš„å…ƒç´ çš„keyå€¼æ˜¯å¦ç›¸ç­‰</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (e.hash == hash &amp;&amp;</span><br><span class=\"line\">                    ((k = e.key) == key || (key != <span class=\"literal\">null</span> &amp;&amp; key.equals(k))))</span><br><span class=\"line\">                    <span class=\"comment\">// ç›¸ç­‰ï¼Œè·³å‡ºå¾ªç¯</span></span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                <span class=\"comment\">// ç”¨äºéå†æ¡¶ä¸­çš„é“¾è¡¨ï¼Œä¸å‰é¢çš„e = p.nextç»„åˆï¼Œå¯ä»¥éå†é“¾è¡¨</span></span><br><span class=\"line\">                p = e;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">//åˆ¤æ–­å½“å‰çš„keyå·²ç»å­˜åœ¨çš„æƒ…å†µä¸‹ï¼Œå†æ¥ä¸€ä¸ªç›¸åŒçš„hashå€¼ã€keyå€¼æ—¶ï¼Œè¿”å›æ–°æ¥çš„valueè¿™ä¸ªå€¼</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (e != <span class=\"literal\">null</span>) &#123; </span><br><span class=\"line\">            <span class=\"comment\">// è®°å½•eçš„value</span></span><br><span class=\"line\">            <span class=\"type\">V</span> <span class=\"variable\">oldValue</span> <span class=\"operator\">=</span> e.value;</span><br><span class=\"line\">            <span class=\"comment\">// onlyIfAbsentä¸ºfalseæˆ–è€…æ—§å€¼ä¸ºnull</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!onlyIfAbsent || oldValue == <span class=\"literal\">null</span>)</span><br><span class=\"line\">                <span class=\"comment\">//ç”¨æ–°å€¼æ›¿æ¢æ—§å€¼</span></span><br><span class=\"line\">                e.value = value;</span><br><span class=\"line\">            <span class=\"comment\">// è®¿é—®åå›è°ƒ</span></span><br><span class=\"line\">            afterNodeAccess(e);</span><br><span class=\"line\">            <span class=\"comment\">// è¿”å›æ—§å€¼</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> oldValue;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// ç»“æ„æ€§ä¿®æ”¹</span></span><br><span class=\"line\">    ++modCount;</span><br><span class=\"line\">    <span class=\"comment\">// æ­¥éª¤â‘¥ï¼šè¶…è¿‡æœ€å¤§å®¹é‡å°±æ‰©å®¹ </span></span><br><span class=\"line\">    <span class=\"comment\">// å®é™…å¤§å°å¤§äºé˜ˆå€¼åˆ™æ‰©å®¹</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (++size &gt; threshold)</span><br><span class=\"line\">        resize();</span><br><span class=\"line\">    <span class=\"comment\">// æ’å…¥åå›è°ƒ</span></span><br><span class=\"line\">    afterNodeInsertion(evict);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"HashMapçš„æ‰©å®¹æ“ä½œæ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ\"><a href=\"#HashMapçš„æ‰©å®¹æ“ä½œæ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ\" class=\"headerlink\" title=\"HashMapçš„æ‰©å®¹æ“ä½œæ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ\"></a>HashMapçš„æ‰©å®¹æ“ä½œæ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ</h3><p>â‘ .åœ¨ jdk1.8 ä¸­ï¼Œresize æ–¹æ³•æ˜¯åœ¨ hashmap ä¸­çš„é”®å€¼å¯¹ï¼ˆå…ƒç´ æ•°é‡ï¼‰å¤§äºé˜€å€¼æ—¶ï¼ˆé˜ˆå€¼ä¸ºå®¹é‡*è´Ÿè½½å› å­ï¼‰æ‰©å®¹ä¸ºåŸå®¹é‡çš„ 2 å€ï¼Œæˆ–è€…åˆå§‹åŒ–æ—¶ï¼ˆæ‰©å®¹ä¸º 16ï¼‰ï¼Œå°±è°ƒç”¨ resize æ–¹æ³•è¿›è¡Œæ‰©å®¹ï¼›</p>\n<p>â‘¡.åœ¨ 1.7 ä¸­ï¼Œæ‰©å®¹ä¹‹åéœ€è¦é‡æ–°å»è®¡ç®—å…¶ Hash å€¼ï¼Œæ ¹æ® Hash å€¼å¯¹å…¶è¿›è¡Œåˆ†å‘ï¼Œä½†åœ¨ 1.8 ç‰ˆæœ¬ä¸­ï¼Œåˆ™æ˜¯æ ¹æ®åœ¨åŒä¸€ä¸ªæ¡¶çš„ä½ç½®ä¸­è¿›è¡Œåˆ¤æ–­(e.hash &amp; oldCap)æ˜¯å¦ä¸º 0ï¼Œé‡æ–°è¿›è¡Œ hash åˆ†é…åï¼Œè¯¥å…ƒç´  hash å€¼ä¸æ—§å®¹é‡ä¸è¿ç®—ä¸º 0 åˆ™ç•™åœ¨åŸå§‹ä½ç½®ï¼Œhash å€¼ä¸æ—§å®¹é‡ä¸è¿ç®—ä¸º 1 åˆ™ç§»åŠ¨åˆ° åŸä½ç½® + oldCap è¿™ä¸ªä½ç½®ä¸Š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes20190128152700351.png\" alt=\"HashMapçš„resizeæ“ä½œ\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">final</span> Node&lt;K,V&gt;[] resize() &#123;</span><br><span class=\"line\">    Node&lt;K,V&gt;[] oldTab = table;<span class=\"comment\">//oldTabæŒ‡å‘hashæ¡¶æ•°ç»„</span></span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">oldCap</span> <span class=\"operator\">=</span> (oldTab == <span class=\"literal\">null</span>) ? <span class=\"number\">0</span> : oldTab.length;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">oldThr</span> <span class=\"operator\">=</span> threshold;</span><br><span class=\"line\">    <span class=\"type\">int</span> newCap, newThr = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (oldCap &gt; <span class=\"number\">0</span>) &#123;<span class=\"comment\">//å¦‚æœoldCapä¸ä¸ºç©ºçš„è¯ï¼Œå°±æ˜¯hashæ¡¶æ•°ç»„ä¸ä¸ºç©º</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (oldCap &gt;= MAXIMUM_CAPACITY) &#123;<span class=\"comment\">//å¦‚æœå¤§äºæœ€å¤§å®¹é‡äº†ï¼Œå°±èµ‹å€¼ä¸ºæ•´æ•°æœ€å¤§çš„é˜€å€¼</span></span><br><span class=\"line\">            threshold = Integer.MAX_VALUE;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> oldTab;<span class=\"comment\">//è¿”å›</span></span><br><span class=\"line\">        &#125;<span class=\"comment\">//å¦‚æœå½“å‰hashæ¡¶æ•°ç»„çš„é•¿åº¦åœ¨æ‰©å®¹åä»ç„¶å°äºæœ€å¤§å®¹é‡ å¹¶ä¸”oldCapå¤§äºé»˜è®¤å€¼16</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> ((newCap = oldCap &lt;&lt; <span class=\"number\">1</span>) &lt; MAXIMUM_CAPACITY &amp;&amp;</span><br><span class=\"line\">                 oldCap &gt;= DEFAULT_INITIAL_CAPACITY)</span><br><span class=\"line\">            newThr = oldThr &lt;&lt; <span class=\"number\">1</span>; <span class=\"comment\">// double threshold åŒå€æ‰©å®¹é˜€å€¼threshold</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// æ—§çš„å®¹é‡ä¸º0ï¼Œä½†thresholdå¤§äºé›¶ï¼Œä»£è¡¨æœ‰å‚æ„é€ æœ‰capä¼ å…¥ï¼Œthresholdå·²ç»è¢«åˆå§‹åŒ–æˆæœ€å°2çš„næ¬¡å¹‚</span></span><br><span class=\"line\">    <span class=\"comment\">// ç›´æ¥å°†è¯¥å€¼èµ‹ç»™æ–°çš„å®¹é‡</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (oldThr &gt; <span class=\"number\">0</span>) <span class=\"comment\">// initial capacity was placed in threshold</span></span><br><span class=\"line\">        newCap = oldThr;</span><br><span class=\"line\">    <span class=\"comment\">// æ— å‚æ„é€ åˆ›å»ºçš„mapï¼Œç»™å‡ºé»˜è®¤å®¹é‡å’Œthreshold 16, 16*0.75</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span> &#123;               <span class=\"comment\">// zero initial threshold signifies using defaults</span></span><br><span class=\"line\">        newCap = DEFAULT_INITIAL_CAPACITY;</span><br><span class=\"line\">        newThr = (<span class=\"type\">int</span>)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// æ–°çš„threshold = æ–°çš„cap * 0.75</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (newThr == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"type\">float</span> <span class=\"variable\">ft</span> <span class=\"operator\">=</span> (<span class=\"type\">float</span>)newCap * loadFactor;</span><br><span class=\"line\">        newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (<span class=\"type\">float</span>)MAXIMUM_CAPACITY ?</span><br><span class=\"line\">                  (<span class=\"type\">int</span>)ft : Integer.MAX_VALUE);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    threshold = newThr;</span><br><span class=\"line\">    <span class=\"comment\">// è®¡ç®—å‡ºæ–°çš„æ•°ç»„é•¿åº¦åèµ‹ç»™å½“å‰æˆå‘˜å˜é‡table</span></span><br><span class=\"line\">    <span class=\"meta\">@SuppressWarnings(&#123;&quot;rawtypes&quot;,&quot;unchecked&quot;&#125;)</span></span><br><span class=\"line\">        Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])<span class=\"keyword\">new</span> <span class=\"title class_\">Node</span>[newCap];<span class=\"comment\">//æ–°å»ºhashæ¡¶æ•°ç»„</span></span><br><span class=\"line\">    table = newTab;<span class=\"comment\">//å°†æ–°æ•°ç»„çš„å€¼å¤åˆ¶ç»™æ—§çš„hashæ¡¶æ•°ç»„</span></span><br><span class=\"line\">    <span class=\"comment\">// å¦‚æœåŸå…ˆçš„æ•°ç»„æ²¡æœ‰åˆå§‹åŒ–ï¼Œé‚£ä¹ˆresizeçš„åˆå§‹åŒ–å·¥ä½œåˆ°æ­¤ç»“æŸï¼Œå¦åˆ™è¿›å…¥æ‰©å®¹å…ƒç´ é‡æ’é€»è¾‘ï¼Œä½¿å…¶å‡åŒ€çš„åˆ†æ•£</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (oldTab != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// éå†æ–°æ•°ç»„çš„æ‰€æœ‰æ¡¶ä¸‹æ ‡</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">j</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; j &lt; oldCap; ++j) &#123;</span><br><span class=\"line\">            Node&lt;K,V&gt; e;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> ((e = oldTab[j]) != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// æ—§æ•°ç»„çš„æ¡¶ä¸‹æ ‡èµ‹ç»™ä¸´æ—¶å˜é‡eï¼Œå¹¶ä¸”è§£é™¤æ—§æ•°ç»„ä¸­çš„å¼•ç”¨ï¼Œå¦åˆ™å°±æ•°ç»„æ— æ³•è¢«GCå›æ”¶</span></span><br><span class=\"line\">                oldTab[j] = <span class=\"literal\">null</span>;</span><br><span class=\"line\">                <span class=\"comment\">// å¦‚æœe.next==nullï¼Œä»£è¡¨æ¡¶ä¸­å°±ä¸€ä¸ªå…ƒç´ ï¼Œä¸å­˜åœ¨é“¾è¡¨æˆ–è€…çº¢é»‘æ ‘</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (e.next == <span class=\"literal\">null</span>)</span><br><span class=\"line\">                    <span class=\"comment\">// ç”¨åŒæ ·çš„hashæ˜ å°„ç®—æ³•æŠŠè¯¥å…ƒç´ åŠ å…¥æ–°çš„æ•°ç»„</span></span><br><span class=\"line\">                    newTab[e.hash &amp; (newCap - <span class=\"number\">1</span>)] = e;</span><br><span class=\"line\">                <span class=\"comment\">// å¦‚æœeæ˜¯TreeNodeå¹¶ä¸”e.next!=nullï¼Œé‚£ä¹ˆå¤„ç†æ ‘ä¸­å…ƒç´ çš„é‡æ’</span></span><br><span class=\"line\">                <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (e <span class=\"keyword\">instanceof</span> TreeNode)</span><br><span class=\"line\">                    ((TreeNode&lt;K,V&gt;)e).split(<span class=\"built_in\">this</span>, newTab, j, oldCap);</span><br><span class=\"line\">                <span class=\"comment\">// eæ˜¯é“¾è¡¨çš„å¤´å¹¶ä¸”e.next!=nullï¼Œé‚£ä¹ˆå¤„ç†é“¾è¡¨ä¸­å…ƒç´ é‡æ’</span></span><br><span class=\"line\">                <span class=\"keyword\">else</span> &#123; <span class=\"comment\">// preserve order</span></span><br><span class=\"line\">                    <span class=\"comment\">// loHead,loTail ä»£è¡¨æ‰©å®¹åä¸ç”¨å˜æ¢ä¸‹æ ‡ï¼Œè§æ³¨1</span></span><br><span class=\"line\">                    Node&lt;K,V&gt; loHead = <span class=\"literal\">null</span>, loTail = <span class=\"literal\">null</span>;</span><br><span class=\"line\">                    <span class=\"comment\">// hiHead,hiTail ä»£è¡¨æ‰©å®¹åå˜æ¢ä¸‹æ ‡ï¼Œè§æ³¨1</span></span><br><span class=\"line\">                    Node&lt;K,V&gt; hiHead = <span class=\"literal\">null</span>, hiTail = <span class=\"literal\">null</span>;</span><br><span class=\"line\">                    Node&lt;K,V&gt; next;</span><br><span class=\"line\">                    <span class=\"comment\">// éå†é“¾è¡¨</span></span><br><span class=\"line\">                    <span class=\"keyword\">do</span> &#123;             </span><br><span class=\"line\">                        next = e.next;</span><br><span class=\"line\">                        <span class=\"keyword\">if</span> ((e.hash &amp; oldCap) == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                            <span class=\"keyword\">if</span> (loTail == <span class=\"literal\">null</span>)</span><br><span class=\"line\">                                <span class=\"comment\">// åˆå§‹åŒ–headæŒ‡å‘é“¾è¡¨å½“å‰å…ƒç´ eï¼Œeä¸ä¸€å®šæ˜¯é“¾è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œåˆå§‹åŒ–åloHead</span></span><br><span class=\"line\">                                <span class=\"comment\">// ä»£è¡¨ä¸‹æ ‡ä¿æŒä¸å˜çš„é“¾è¡¨çš„å¤´å…ƒç´ </span></span><br><span class=\"line\">                                loHead = e;</span><br><span class=\"line\">                            <span class=\"keyword\">else</span>                                </span><br><span class=\"line\">                                <span class=\"comment\">// loTail.nextæŒ‡å‘å½“å‰e</span></span><br><span class=\"line\">                                loTail.next = e;</span><br><span class=\"line\">                            <span class=\"comment\">// loTailæŒ‡å‘å½“å‰çš„å…ƒç´ e</span></span><br><span class=\"line\">                            <span class=\"comment\">// åˆå§‹åŒ–åï¼ŒloTailå’ŒloHeadæŒ‡å‘ç›¸åŒçš„å†…å­˜ï¼Œæ‰€ä»¥å½“loTail.nextæŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œ</span></span><br><span class=\"line\">                            <span class=\"comment\">// åº•å±‚æ•°ç»„ä¸­çš„å…ƒç´ çš„nextå¼•ç”¨ä¹Ÿç›¸åº”å‘ç”Ÿå˜åŒ–ï¼Œé€ æˆlowHead.next.next.....</span></span><br><span class=\"line\">                            <span class=\"comment\">// è·ŸéšloTailåŒæ­¥ï¼Œä½¿å¾—lowHeadå¯ä»¥é“¾æ¥åˆ°æ‰€æœ‰å±äºè¯¥é“¾è¡¨çš„å…ƒç´ ã€‚</span></span><br><span class=\"line\">                            loTail = e;                           </span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                        <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                            <span class=\"keyword\">if</span> (hiTail == <span class=\"literal\">null</span>)</span><br><span class=\"line\">                                <span class=\"comment\">// åˆå§‹åŒ–headæŒ‡å‘é“¾è¡¨å½“å‰å…ƒç´ e, åˆå§‹åŒ–åhiHeadä»£è¡¨ä¸‹æ ‡æ›´æ”¹çš„é“¾è¡¨å¤´å…ƒç´ </span></span><br><span class=\"line\">                                hiHead = e;</span><br><span class=\"line\">                            <span class=\"keyword\">else</span></span><br><span class=\"line\">                                hiTail.next = e;</span><br><span class=\"line\">                            hiTail = e;</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125; <span class=\"keyword\">while</span> ((e = next) != <span class=\"literal\">null</span>);</span><br><span class=\"line\">                    <span class=\"comment\">// éå†ç»“æŸ, å°†tailæŒ‡å‘nullï¼Œå¹¶æŠŠé“¾è¡¨å¤´æ”¾å…¥æ–°æ•°ç»„çš„ç›¸åº”ä¸‹æ ‡ï¼Œå½¢æˆæ–°çš„æ˜ å°„ã€‚</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (loTail != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                        loTail.next = <span class=\"literal\">null</span>;</span><br><span class=\"line\">                        newTab[j] = loHead;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (hiTail != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                        hiTail.next = <span class=\"literal\">null</span>;</span><br><span class=\"line\">                        newTab[j + oldCap] = hiHead;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> newTab;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"HashMapè´Ÿè½½å› å­ä¸ºä»€ä¹ˆè®¾ç½®ä¸º-0-75\"><a href=\"#HashMapè´Ÿè½½å› å­ä¸ºä»€ä¹ˆè®¾ç½®ä¸º-0-75\" class=\"headerlink\" title=\"HashMapè´Ÿè½½å› å­ä¸ºä»€ä¹ˆè®¾ç½®ä¸º 0.75?\"></a>HashMapè´Ÿè½½å› å­ä¸ºä»€ä¹ˆè®¾ç½®ä¸º 0.75?</h3><p>hashmap çš„æºç ä¸­æœ‰ä¸€æ®µæ³¨é‡Šè§£é‡Šäº†ä¸ºä»€ä¹ˆè®¾ç½®ä¸º 0.75ï¼Œæ˜¯<strong>ç©ºé—´å’Œæ—¶é—´æ•ˆç‡çš„æŠ˜ä¸­è€ƒè™‘</strong>ã€‚</p>\n<h3 id=\"èƒ½å¦ä½¿ç”¨ä»»ä½•ç±»ä½œä¸º-Map-çš„-keyï¼Ÿ\"><a href=\"#èƒ½å¦ä½¿ç”¨ä»»ä½•ç±»ä½œä¸º-Map-çš„-keyï¼Ÿ\" class=\"headerlink\" title=\"èƒ½å¦ä½¿ç”¨ä»»ä½•ç±»ä½œä¸º Map çš„ keyï¼Ÿ\"></a>èƒ½å¦ä½¿ç”¨ä»»ä½•ç±»ä½œä¸º Map çš„ keyï¼Ÿ</h3><p>å¯ä»¥ä½¿ç”¨ä»»ä½•ç±»ä½œä¸º Map çš„ keyï¼Œå‰ææ˜¯è¯¥ç±»é‡å†™äº† hashCode å’Œ equals æ–¹æ³•ã€‚é‡å†™ hashCode() æ˜¯ä¸ºäº†è®¡ç®—æ•°æ®çš„å­˜å‚¨ä½ç½®ï¼Œé‡å†™ equals æ–¹æ³•æ˜¯ä¸ºäº†ç¡®ä¿ key åœ¨å“ˆå¸Œè¡¨ä¸­çš„å”¯ä¸€æ€§ã€‚æœ€ç»ˆç›®çš„æ˜¯ä¸ºäº†ä¿è¯ Map ä¸­é”® key çš„å”¯ä¸€æ€§ã€‚</p>\n<h3 id=\"ä¸ºä»€ä¹ˆHashMapä¸­Stringã€Integerè¿™æ ·çš„åŒ…è£…ç±»é€‚åˆä½œä¸ºkeyï¼Ÿ\"><a href=\"#ä¸ºä»€ä¹ˆHashMapä¸­Stringã€Integerè¿™æ ·çš„åŒ…è£…ç±»é€‚åˆä½œä¸ºkeyï¼Ÿ\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆHashMapä¸­Stringã€Integerè¿™æ ·çš„åŒ…è£…ç±»é€‚åˆä½œä¸ºkeyï¼Ÿ\"></a>ä¸ºä»€ä¹ˆHashMapä¸­Stringã€Integerè¿™æ ·çš„åŒ…è£…ç±»é€‚åˆä½œä¸ºkeyï¼Ÿ</h3><p>é‡å†™äº† hashCode å’Œ equals æ–¹æ³•ï¼Œä¿è¯äº† Map ä¸­é”®<strong>keyçš„å”¯ä¸€æ€§</strong>ã€‚å¹¶ä¸”ä»–ä»¬éƒ½ä¸å¯å˜ï¼Œå¯ä»¥å°†å®ƒä»¬çš„ hash å€¼<strong>ç¼“å­˜ä¸‹æ¥ï¼Œæé«˜æ•ˆç‡</strong>ã€‚</p>\n<h3 id=\"HashMap-ä¸-HashTable-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"><a href=\"#HashMap-ä¸-HashTable-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"HashMap ä¸ HashTable æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"></a>HashMap ä¸ HashTable æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><ol>\n<li><strong>çº¿ç¨‹å®‰å…¨</strong>ï¼š HashMap æ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼ŒHashTable æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå†…éƒ¨çš„æ–¹æ³•åŸºæœ¬éƒ½ç»è¿‡ <code>synchronized</code> ä¿®é¥°ï¼›</li>\n<li><strong>æ•ˆç‡</strong>ï¼š å› ä¸ºçº¿ç¨‹å®‰å…¨çš„é—®é¢˜ synchronizedï¼ŒHashMap è¦æ¯” HashTable æ•ˆç‡é«˜ä¸€ç‚¹ï¼›</li>\n<li><strong>å¯¹Null key å’ŒNull valueçš„æ”¯æŒ</strong>ï¼š HashMap ä¸­ï¼Œnull å¯ä»¥ä½œä¸ºé”®ï¼Œè¿™æ ·çš„é”®åªæœ‰ä¸€ä¸ªï¼Œå¯ä»¥æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªé”®æ‰€å¯¹åº”çš„å€¼ä¸º nullã€‚ä½†æ˜¯åœ¨ HashTable ä¸­ put è¿›çš„é”®å€¼åªè¦æœ‰ä¸€ä¸ª nullï¼Œç›´æ¥æŠ› NullPointerExceptionï¼›</li>\n<li>**åˆå§‹å®¹é‡å¤§å°å’Œæ¯æ¬¡æ‰©å……å®¹é‡å¤§å°çš„ä¸åŒ **ï¼š<br> â‘ åˆ›å»ºæ—¶å¦‚æœä¸æŒ‡å®šå®¹é‡åˆå§‹å€¼ï¼ŒHashTable é»˜è®¤çš„åˆå§‹å¤§å°ä¸º 11ï¼Œä¹‹åæ¯æ¬¡æ‰©å……ï¼Œå®¹é‡å˜ä¸ºåŸæ¥çš„ 2n+1ã€‚HashMap é»˜è®¤çš„åˆå§‹åŒ–å¤§å°ä¸º 16ã€‚ä¹‹åæ¯æ¬¡æ‰©å……ï¼Œå®¹é‡å˜ä¸ºåŸæ¥çš„ 2 å€ï¼›<br> â‘¡åˆ›å»ºæ—¶å¦‚æœç»™å®šäº†å®¹é‡åˆå§‹å€¼ï¼Œé‚£ä¹ˆ HashTable ä¼šç›´æ¥ä½¿ç”¨ä½ ç»™å®šçš„å¤§å°ï¼Œè€Œ HashMap ä¼šå°†å…¶æ‰©å……ä¸º 2 çš„å¹‚æ¬¡æ–¹å¤§å°ã€‚ä¹Ÿå°±æ˜¯è¯´ HashMap æ€»æ˜¯ä½¿ç”¨ 2 çš„å¹‚ä½œä¸ºå“ˆå¸Œè¡¨çš„å¤§å°ï¼›</li>\n<li><strong>åº•å±‚æ•°æ®ç»“æ„</strong>ï¼š JDK1.8 ä»¥åçš„ HashMap åœ¨è§£å†³å“ˆå¸Œå†²çªæ—¶æœ‰äº†è¾ƒå¤§çš„å˜åŒ–ï¼Œå½“é“¾è¡¨é•¿åº¦å¤§äºé˜ˆå€¼ï¼ˆé»˜è®¤ä¸º 8ï¼‰æ—¶ï¼Œå°†é“¾è¡¨è½¬åŒ–ä¸ºçº¢é»‘æ ‘ï¼Œä»¥å‡å°‘æœç´¢æ—¶é—´ã€‚HashTable æ²¡æœ‰è¿™æ ·çš„æœºåˆ¶ã€‚</li>\n</ol>\n<h3 id=\"ConcurrentHashMap-å’Œ-HashTable-çš„åŒºåˆ«ï¼Ÿ\"><a href=\"#ConcurrentHashMap-å’Œ-HashTable-çš„åŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"ConcurrentHashMap å’Œ HashTable çš„åŒºåˆ«ï¼Ÿ\"></a>ConcurrentHashMap å’Œ HashTable çš„åŒºåˆ«ï¼Ÿ</h3><p>ConcurrentHashMap å’Œ HashTable çš„åŒºåˆ«ä¸»è¦ä½“ç°åœ¨å®ç°çº¿ç¨‹å®‰å…¨çš„æ–¹å¼ä¸Šä¸åŒã€‚</p>\n<ul>\n<li><strong>åº•å±‚æ•°æ®ç»“æ„</strong>ï¼š<br>  JDK1.7 çš„ ConcurrentHashMap åº•å±‚é‡‡ç”¨ <strong>åˆ†æ®µçš„æ•°ç»„+é“¾è¡¨</strong> å®ç°ï¼ŒJDK1.8 é‡‡ç”¨çš„æ•°æ®ç»“æ„è·Ÿ HashMap1.8 çš„ç»“æ„ä¸€æ ·ï¼Œæ•°ç»„+é“¾è¡¨&#x2F;çº¢é»‘äºŒå‰æ ‘ã€‚<br>  HashTable å’Œ JDK1.8 ä¹‹å‰çš„ HashMap çš„åº•å±‚æ•°æ®ç»“æ„ç±»ä¼¼éƒ½æ˜¯é‡‡ç”¨ <strong>æ•°ç»„+é“¾è¡¨</strong> çš„å½¢å¼ï¼Œæ•°ç»„æ˜¯ HashMap çš„ä¸»ä½“ï¼Œé“¾è¡¨åˆ™æ˜¯ä¸»è¦ä¸ºäº†è§£å†³å“ˆå¸Œå†²çªè€Œå­˜åœ¨çš„ï¼›</li>\n<li><strong>å®ç°çº¿ç¨‹å®‰å…¨çš„æ–¹å¼ï¼ˆé‡è¦ï¼‰</strong>ï¼š<br>  â‘  <strong>åœ¨JDK1.7çš„æ—¶å€™ï¼ŒConcurrentHashMapä½¿ç”¨åˆ†æ®µé”</strong> å¯¹æ•´ä¸ªæ¡¶æ•°ç»„è¿›è¡Œäº†åˆ†å‰²åˆ†æ®µ(Segment é”ç»§æ‰¿ ReentrantLock)ï¼Œæ¯ä¸€æŠŠé”åªé”å®¹å™¨å…¶ä¸­ä¸€éƒ¨åˆ†æ•°æ®ï¼Œå¤šçº¿ç¨‹è®¿é—®å®¹å™¨é‡Œä¸åŒæ•°æ®æ®µçš„æ•°æ®ï¼Œå°±ä¸ä¼šå­˜åœ¨é”ç«äº‰ï¼Œæé«˜å¹¶å‘è®¿é—®ç‡ã€‚ï¼ˆé»˜è®¤åˆ†é… 16 ä¸ª Segmentï¼Œæ¯” HashTable æ•ˆç‡æé«˜ 16 å€ã€‚ï¼‰<br>  <strong>åˆ°äº† JDK1.8 çš„æ—¶å€™å·²ç»æ‘’å¼ƒäº†Segmentçš„æ¦‚å¿µï¼Œè€Œæ˜¯ç›´æ¥ç”¨ Node æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘çš„æ•°æ®ç»“æ„æ¥å®ç°ï¼Œå¹¶å‘æ§åˆ¶ä½¿ç”¨ synchronized å’Œ CAS æ¥æ“ä½œï¼Œsynchronizedåªé”å®šå½“å‰é“¾è¡¨æˆ–çº¢é»‘æ ‘çš„é¦–èŠ‚ç‚¹ã€‚ï¼ˆJDK1.6ä»¥å å¯¹ synchronizedé”åšäº†å¾ˆå¤šä¼˜åŒ–ï¼‰</strong> æ•´ä¸ªçœ‹èµ·æ¥å°±åƒæ˜¯ä¼˜åŒ–è¿‡ä¸”çº¿ç¨‹å®‰å…¨çš„ HashMap<br>  â‘¡ <strong>HashTable(å…¨è¡¨é”)</strong> :ä½¿ç”¨ synchronized æ¥ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œæ•ˆç‡éå¸¸ä½ä¸‹ã€‚å½“ä¸€ä¸ªçº¿ç¨‹è®¿é—®åŒæ­¥æ–¹æ³•æ—¶ï¼Œå…¶ä»–çº¿ç¨‹ä¹Ÿè®¿é—®åŒæ­¥æ–¹æ³•ï¼Œå¯èƒ½ä¼šè¿›å…¥é˜»å¡æˆ–è½®è¯¢çŠ¶æ€ï¼Œå¦‚ä½¿ç”¨ put æ·»åŠ å…ƒç´ ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¸èƒ½ä½¿ç”¨ put æ·»åŠ å…ƒç´ ï¼Œä¹Ÿä¸èƒ½ä½¿ç”¨ getï¼Œç«äº‰ä¼šè¶Šæ¥è¶Šæ¿€çƒˆæ•ˆç‡è¶Šä½ã€‚</li>\n<li>â­<strong>Jdk1.7é‡‡ç”¨åˆ†æ®µé”ï¼Œé”ç²’åº¦è¾ƒå¤§ï¼Œå®¹æ˜“å‘ç”Ÿå†²çªï¼Œå¹¶å‘é‡ä½ï¼›å› æ­¤ Jdk1.8 é‡‡ç”¨åªé”å®šæ¡¶çš„é¦–ç»“ç‚¹ï¼Œé”çš„åŠ›åº¦è¾ƒä½ï¼Œä¸å®¹æ˜“å‘ç”Ÿå†²çªï¼Œå¹¶å‘é‡é«˜ã€‚</strong></li>\n</ul>\n<p><strong>ä¸¤è€…çš„å¯¹æ¯”å›¾</strong>ï¼š</p>\n<p>HashTable:</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOC84LzIzLzE2NTY2NzdhNmYyNTYxOTY.png\" alt=\"HashTableå…¨è¡¨é”\"></p>\n<p>JDK1.7 çš„ ConcurrentHashMapï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOC84LzIzLzE2NTY2NzdhNmYwMDhiZTQ.png\" alt=\"JDK1.7çš„ConcurrentHashMapåˆ†æ®µé”\"></p>\n<p>JDK1.8 çš„ ConcurrentHashMapï¼ˆTreeBin: çº¢é»‘äºŒå‰æ ‘èŠ‚ç‚¹ Node: é“¾è¡¨èŠ‚ç‚¹ï¼‰ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOC84LzIzLzE2NTY2NzdhNmYxNGUwMzk.png\" alt=\"JDK1.8çš„ConcurrentHashMapåˆ†æ®µé”\"></p>"},{"title":"Javaå…«è‚¡æ–‡ - SpringMVC","copyright":true,"mathjax":false,"date":"2023-01-23T08:14:20.000Z","toc":true,"urlname":"java-springmvc","_content":"\n> æ•´ç†çš„SpringMVCç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½<!--more-->\n\n## æ¦‚è¿°\n\n### ä»€ä¹ˆæ˜¯Spring MVCï¼Ÿç®€å•ä»‹ç»ä¸‹ä½ å¯¹Spring MVCçš„ç†è§£ï¼Ÿ\n\nSpring MVC æ˜¯ä¸€ä¸ªåŸºäº Java çš„å®ç°äº† MVC è®¾è®¡æ¨¡å¼çš„è¯·æ±‚é©±åŠ¨ç±»å‹çš„è½»é‡çº§ Web æ¡†æ¶ï¼Œé€šè¿‡æŠŠæ¨¡å‹-è§†å›¾-æ§åˆ¶å™¨åˆ†ç¦»ï¼Œå°† web å±‚è¿›è¡ŒèŒè´£è§£è€¦ï¼Œç®€åŒ–å¼€å‘ã€‚\n\n## æ ¸å¿ƒç»„ä»¶\n\n### Spring MVCçš„ä¸»è¦ç»„ä»¶ï¼Ÿ\n\nï¼ˆ1ï¼‰å‰ç«¯æ§åˆ¶å™¨ DispatcherServletï¼ˆä¸éœ€è¦ç¨‹åºå‘˜å¼€å‘ï¼‰\n\nä½œç”¨ï¼šæ¥æ”¶è¯·æ±‚ã€å“åº”ç»“æœï¼Œç›¸å½“äºè½¬å‘å™¨ï¼Œæœ‰äº† DispatcherServlet å°±å‡å°‘äº†å…¶å®ƒç»„ä»¶ä¹‹é—´çš„è€¦åˆåº¦ã€‚\n\nï¼ˆ2ï¼‰å¤„ç†å™¨æ˜ å°„å™¨ HandlerMappingï¼ˆä¸éœ€è¦ç¨‹åºå‘˜å¼€å‘ï¼‰\n\nä½œç”¨ï¼šæ ¹æ®è¯·æ±‚çš„ URL æ¥æŸ¥æ‰¾ Handler\n\nï¼ˆ3ï¼‰å¤„ç†å™¨é€‚é…å™¨ HandlerAdapter\n\næ³¨æ„ï¼šåœ¨ç¼–å†™ Handler çš„æ—¶å€™è¦æŒ‰ç…§ HandlerAdapter è¦æ±‚çš„è§„åˆ™å»ç¼–å†™ï¼Œè¿™æ ·é€‚é…å™¨ HandlerAdapter æ‰å¯ä»¥æ­£ç¡®çš„å»æ‰§è¡Œ Handlerã€‚\n\nï¼ˆ4ï¼‰å¤„ç†å™¨ Handlerï¼ˆéœ€è¦ç¨‹åºå‘˜å¼€å‘ï¼‰\n\nï¼ˆ5ï¼‰è§†å›¾è§£æå™¨ ViewResolverï¼ˆä¸éœ€è¦ç¨‹åºå‘˜å¼€å‘ï¼‰\n\nä½œç”¨ï¼šè¿›è¡Œè§†å›¾çš„è§£æï¼Œæ ¹æ®è§†å›¾é€»è¾‘åè§£ææˆçœŸæ­£çš„è§†å›¾ï¼ˆviewï¼‰\n\nï¼ˆ6ï¼‰è§†å›¾ Viewï¼ˆéœ€è¦ç¨‹åºå‘˜å¼€å‘ jspï¼‰\n\nView æ˜¯ä¸€ä¸ªæ¥å£ï¼Œ å®ƒçš„å®ç°ç±»æ”¯æŒä¸åŒçš„è§†å›¾ç±»å‹ï¼ˆjspï¼Œfreemarkerï¼Œpdf ç­‰ç­‰ï¼‰\n\n### ä»€ä¹ˆæ˜¯DispatcherServlet\n\nSpring çš„ MVC æ¡†æ¶æ˜¯å›´ç»• DispatcherServlet æ¥è®¾è®¡çš„ï¼Œå®ƒç”¨æ¥å¤„ç†æ‰€æœ‰çš„ HTTP è¯·æ±‚å’Œå“åº”ã€‚\n\n### ä»€ä¹ˆæ˜¯Spring MVCæ¡†æ¶çš„æ§åˆ¶å™¨ï¼Ÿ\n\næ§åˆ¶å™¨ä½¿ç”¨@Controller æ³¨è§£ï¼Œå¹¶ä¸”æä¾›äº†@RequestMapping æ³¨è§£ï¼Œé€šè¿‡è§£æ url ä¸­çš„è·¯å¾„ï¼Œå¯ä»¥æ‰¾åˆ°ç›¸åº”çš„æ§åˆ¶å™¨è¿›è¡Œé€»è¾‘å¤„ç†ï¼Œå“åº”æ•°æ®ç­‰ã€‚\n\n### Spring MVCçš„æ§åˆ¶å™¨æ˜¯ä¸æ˜¯å•ä¾‹æ¨¡å¼,å¦‚æœæ˜¯,æœ‰ä»€ä¹ˆé—®é¢˜,æ€ä¹ˆè§£å†³ï¼Ÿ\n\nå•ä¾‹æ¨¡å¼,æ‰€ä»¥åœ¨å¤šçº¿ç¨‹è®¿é—®çš„æ—¶å€™æœ‰çº¿ç¨‹å®‰å…¨é—®é¢˜,ä¸è¦ç”¨åŒæ­¥,ä¼šå½±å“æ€§èƒ½çš„ï¼Œè§£å†³æ–¹æ¡ˆæ˜¯åœ¨æ§åˆ¶å™¨ä¿æŒæ§åˆ¶å™¨æ— çŠ¶æ€ï¼ˆä¸è¦å†™å­—æ®µï¼‰ã€‚\n\n## å·¥ä½œåŸç†\n\n### è¯·æè¿°Spring MVCçš„å·¥ä½œæµç¨‹ï¼Ÿæè¿°ä¸€ä¸‹ DispatcherServlet çš„å·¥ä½œæµç¨‹ï¼Ÿ\n\n1. ç”¨æˆ·å‘é€è¯·æ±‚è‡³å‰ç«¯æ§åˆ¶å™¨ DispatcherServletï¼›\n2. DispatcherServlet æ”¶åˆ°è¯·æ±‚åï¼Œè°ƒç”¨ HandlerMapping å¤„ç†å™¨æ˜ å°„å™¨ï¼Œè¯·æ±‚è·å– Handlerï¼›\n3. HandlerMapping å¤„ç†å™¨æ˜ å°„å™¨æ ¹æ®è¯·æ±‚ url**æ‰¾åˆ°å…·ä½“çš„å¤„ç†å™¨**ï¼Œç”Ÿæˆå¤„ç†å™¨å¯¹è±¡åŠå¤„ç†å™¨æ‹¦æˆªå™¨(å¦‚æœæœ‰åˆ™ç”Ÿæˆ)ä¸€å¹¶è¿”å›ç»™ DispatcherServletï¼›\n4. DispatcherServlet è°ƒç”¨ HandlerAdapter å¤„ç†å™¨é€‚é…å™¨ï¼›\n5. HandlerAdapter ç»è¿‡é€‚é… **è°ƒç”¨å…·ä½“å¤„ç†å™¨**(Handlerï¼Œä¹Ÿå«åç«¯æ§åˆ¶å™¨)ï¼›\n6. Handler æ‰§è¡Œå®Œæˆè¿”å› ModelAndViewï¼›\n7. HandlerAdapter å°† Handler æ‰§è¡Œç»“æœ ModelAndView è¿”å›ç»™ DispatcherServletï¼›\n8. DispatcherServlet å°† ModelAndView ä¼ ç»™ ViewResolver è§†å›¾è§£æå™¨è¿›è¡Œè§£æï¼›\n9. ViewResolver è§£æåè¿”å›å…·ä½“ Viewï¼›\n10. DispatcherServlet å¯¹ View è¿›è¡Œæ¸²æŸ“æˆä¸ºè§†å›¾ï¼ˆå³å°†æ¨¡å‹æ•°æ®å¡«å……è‡³è§†å›¾ä¸­ï¼‰ï¼›\n11. DispatcherServlet å“åº”ç”¨æˆ·ã€‚\n\n![Spring MVCçš„å·¥ä½œæµç¨‹](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes20200208211439106.png)\n\n## å¸¸ç”¨æ³¨è§£\n\n### æ³¨è§£åŸç†æ˜¯ä»€ä¹ˆ\n\næ³¨è§£æœ¬è´¨æ˜¯ä¸€ä¸ªç»§æ‰¿äº† Annotation çš„ç‰¹æ®Šæ¥å£ï¼Œå…¶å…·ä½“å®ç°ç±»æ˜¯ Java è¿è¡Œæ—¶ç”Ÿæˆçš„åŠ¨æ€ä»£ç†ç±»ã€‚æˆ‘ä»¬é€šè¿‡åå°„è·å–æ³¨è§£æ—¶ï¼Œè¿”å›çš„æ˜¯ Java è¿è¡Œæ—¶ç”Ÿæˆçš„åŠ¨æ€ä»£ç†å¯¹è±¡ã€‚é€šè¿‡ä»£ç†å¯¹è±¡è°ƒç”¨è‡ªå®šä¹‰æ³¨è§£çš„æ–¹æ³•ã€‚\n\n### Spring MVCå¸¸ç”¨çš„æ³¨è§£æœ‰å“ªäº›ï¼Ÿ\n\n@RequestMappingï¼šç”¨äºå¤„ç†è¯·æ±‚ url æ˜ å°„çš„æ³¨è§£ï¼Œå¯ç”¨äºç±»æˆ–æ–¹æ³•ä¸Šã€‚ç”¨äºç±»ä¸Šï¼Œåˆ™è¡¨ç¤ºç±»ä¸­çš„æ‰€æœ‰å“åº”è¯·æ±‚çš„æ–¹æ³•éƒ½æ˜¯ä»¥è¯¥åœ°å€ä½œä¸ºçˆ¶è·¯å¾„ã€‚\n\n@RequestBodyï¼šæ³¨è§£å®ç°æ¥æ”¶ http è¯·æ±‚çš„ json æ•°æ®ï¼Œå°† json è½¬æ¢ä¸º java å¯¹è±¡ã€‚\n\n@ResponseBodyï¼šæ³¨è§£å®ç°å°† controller æ–¹æ³•è¿”å›å¯¹è±¡è½¬åŒ–ä¸º json å¯¹è±¡å“åº”ç»™å®¢æˆ·ã€‚\n\n### Sping MVCä¸­çš„æ§åˆ¶å™¨çš„æ³¨è§£ä¸€èˆ¬ç”¨å“ªä¸ª,æœ‰æ²¡æœ‰åˆ«çš„æ³¨è§£å¯ä»¥æ›¿ä»£ï¼Ÿ\n\nç­”ï¼šä¸€èˆ¬ç”¨@Controller æ³¨è§£ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨@RestControllerï¼Œ@RestController æ³¨è§£ç›¸å½“äº@ResponseBody ï¼‹ @Controllerï¼Œ@ResponseBody ç”¨äºè¿”å› json æ•°æ®ï¼‹ @Controller ç”¨äºè¡¨æ˜æ§åˆ¶å™¨\n\n### @Controlleræ³¨è§£çš„ä½œç”¨\n\n@Controller ç”¨äºæ ‡è®°åœ¨ä¸€ä¸ªç±»ä¸Šï¼Œä½¿ç”¨å®ƒæ ‡è®°çš„ç±»å°±æ˜¯ä¸€ä¸ª Spring MVC Controller å¯¹è±¡ã€‚é€šè¿‡è¯·æ±‚çš„ url å’Œ@RequestMapping æ³¨è§£å¯¹åº”åˆ°å®é™…å¤„ç†è¯·æ±‚çš„å¤„ç†å™¨ã€‚éœ€è¦å¼€å¯ mvc æ³¨è§£æ‰«ææ‰¾åˆ°@Controller çš„æ§åˆ¶å™¨ã€‚\n\n### @RequestMappingæ³¨è§£çš„ä½œç”¨\n\nRequestMapping æ˜¯ä¸€ä¸ªç”¨æ¥å¤„ç†è¯·æ±‚åœ°å€æ˜ å°„çš„æ³¨è§£ï¼Œå¯ç”¨äºç±»æˆ–æ–¹æ³•ä¸Šã€‚\n\nç”¨äºç±»ä¸Šï¼Œè¡¨ç¤ºç±»ä¸­çš„æ‰€æœ‰å“åº”è¯·æ±‚çš„æ–¹æ³•éƒ½æ˜¯ä»¥è¯¥åœ°å€ä½œä¸ºçˆ¶è·¯å¾„ã€‚\n\nRequestMapping æ³¨è§£æœ‰å…­ä¸ªå±æ€§ï¼š\n\n**path/valueï¼Œ method**\n\n* valueï¼š æŒ‡å®šè¯·æ±‚çš„å®é™…åœ°å€ï¼ŒæŒ‡å®šçš„åœ°å€å¯ä»¥æ˜¯ URI Template æ¨¡å¼ï¼ˆåé¢å°†ä¼šè¯´æ˜ï¼‰ï¼›\n\n* methodï¼š æŒ‡å®šè¯·æ±‚çš„ method ç±»å‹ï¼Œ GETã€POSTã€PUTã€DELETE ç­‰ï¼›\n\n**consumesï¼Œproduces**\n\n* consumesï¼š æŒ‡å®šå¤„ç†è¯·æ±‚çš„æäº¤å†…å®¹ç±»å‹ï¼ˆContent-Typeï¼‰ï¼Œä¾‹å¦‚ application/json, text/html;\n\n* produces: æŒ‡å®šè¿”å›çš„å†…å®¹ç±»å‹ï¼Œä»…å½“ request è¯·æ±‚å¤´ä¸­çš„(Accept)ç±»å‹ä¸­åŒ…å«è¯¥æŒ‡å®šç±»å‹æ‰è¿”å›ï¼›\n\n**paramsï¼Œheaders**\n\n* paramsï¼š æŒ‡å®š request ä¸­å¿…é¡»åŒ…å«æŸäº›å‚æ•°å€¼æ—¶ï¼Œæ‰è®©è¯¥æ–¹æ³•å¤„ç†ã€‚\n\n* headersï¼š æŒ‡å®š request ä¸­å¿…é¡»åŒ…å«æŸäº›æŒ‡å®šçš„ header å€¼ï¼Œæ‰èƒ½è®©è¯¥æ–¹æ³•å¤„ç†è¯·æ±‚ã€‚\n\n### @PathVariableå’Œ@RequestParamçš„åŒºåˆ«\n\n@PathVariable ä½œç”¨ï¼š ç”¨äºç»‘å®š url ä¸­çš„å ä½ç¬¦ã€‚ä¾‹å¦‚ï¼šè¯·æ±‚ url ä¸­ /delete/{id}ï¼Œè¿™ä¸ª{id}å°±æ˜¯ url å ä½ç¬¦ã€‚\n\n```java\n/**\n* æ ¹æ®path /anno/testPathVariable/10 æ‰¾åˆ° testPathVariable æ–¹æ³•\n* ç„¶åï¼Œå…¶ä¸­çš„10å°±æ˜¯sidå ä½ç¬¦æ‰€å çš„ä½ç½®çš„æ•°æ®ï¼Œç„¶åé€šè¿‡@PathVaribaleæ³¨è§£å°†å…¶èµ‹å€¼ç»™ id\n*/\n@RequestMapping(path = \"testPathVariable/{sid}\")\npublic String testPathVariable(@PathVariable(value = \"sid\") String id) {\n    System.out.println(\"æ‰§è¡Œäº†testPathVariable...\");\n    System.out.println(id);\n    return \"success\";\n}\n```\n\n@RequestParam ä½œç”¨ï¼š æŠŠè¯·æ±‚ä¸­æŒ‡å®šåç§°çš„å‚æ•°ç»™æ§åˆ¶å™¨ä¸­çš„å½¢å‚èµ‹å€¼ã€‚\n\n```java\n// Controllerä¸­çš„ä»£ç ï¼š\n@RequestMapping(path = \"/testRequestParam\")\npublic String testRequestParam(@RequestParam(value = \"name\") String username) {\n    // æŠŠè¯·æ±‚ä¸­æŒ‡å®šçš„nameèµ‹å€¼ç»™æ§åˆ¶å™¨ä¸­çš„å½¢å‚username\n    System.out.println(\"æ‰§è¡Œäº†testRequestParam...\");\n    System.out.println(username);\n    return \"success\";\n}\n```\n\n## å…¶ä»–\n\n### Spring MVCæ€ä¹ˆæ ·è®¾å®šè½¬å‘å’Œé‡å®šå‘çš„ï¼Ÿ\n\nï¼ˆ1ï¼‰è½¬å‘ï¼šä½¿ç”¨ forward\nforward æ˜¯æŒ‡å†…éƒ¨è½¬å‘ï¼Œç›¸å½“äºæœåŠ¡å™¨å†…éƒ¨æ–¹æ³•è·³è½¬è°ƒç”¨ã€‚è¯·æ±‚ä¸€æ¬¡æœåŠ¡å™¨ã€‚è½¬å‘åœ°å€ä¸å˜ã€‚\n\nï¼ˆ2ï¼‰é‡å®šå‘ï¼šä½¿ç”¨ redirect\né‡å®šå‘æ˜¯æŒ‡å½“æµè§ˆå™¨è¯·æ±‚ä¸€ä¸ª URL æ—¶ï¼ŒæœåŠ¡å™¨è¿”å›ä¸€ä¸ªé‡å®šå‘æŒ‡ä»¤ï¼Œå‘Šè¯‰æµè§ˆå™¨åœ°å€å·²ç»å˜äº†ï¼Œéº»çƒ¦ä½¿ç”¨æ–°çš„ URL å†é‡æ–°å‘é€æ–°è¯·æ±‚ã€‚è¯·æ±‚ä¸¤æ¬¡æœåŠ¡å™¨ã€‚é‡å®šå‘åœ°å€æ”¹å˜ã€‚\n\n### Spring MVCæ€ä¹ˆå’ŒAJAXç›¸äº’è°ƒç”¨çš„ï¼Ÿ\n\né€šè¿‡ Jackson æˆ–è€…æ˜¯ fastjson å°±å¯ä»¥æŠŠ Java é‡Œé¢çš„å¯¹è±¡ç›´æ¥è½¬åŒ–æˆ Js å¯ä»¥è¯†åˆ«çš„ Json å¯¹è±¡ï¼Œæ¥è¿›è¡Œä¼ è¾“ã€‚\n\n### å¦‚ä½•è§£å†³POSTè¯·æ±‚ä¸­æ–‡ä¹±ç é—®é¢˜ï¼ŒGETçš„åˆå¦‚ä½•å¤„ç†å‘¢ï¼Ÿ\n\nï¼ˆ1ï¼‰è§£å†³ post è¯·æ±‚ä¹±ç é—®é¢˜ï¼š\n\nåœ¨ web.xml ä¸­é…ç½®ä¸€ä¸ª CharacterEncodingFilter è¿‡æ»¤å™¨ï¼Œè®¾ç½®æˆ utf-8ï¼›\n\n```xml\n<filter>\n    <filter-name>CharacterEncodingFilter</filter-name>\n    <filter-class>org.springframework.web.filter.CharacterEncodingFilter</filter-class>\n\n    <init-param>\n        <param-name>encoding</param-name>\n        <param-value>utf-8</param-value>\n    </init-param>\n</filter>\n\n<filter-mapping>\n    <filter-name>CharacterEncodingFilter</filter-name>\n    <url-pattern>/*</url-pattern>\n</filter-mapping>\n```\n\nï¼ˆ2ï¼‰get è¯·æ±‚ä¸­æ–‡å‚æ•°å‡ºç°ä¹±ç è§£å†³æ–¹æ³•æœ‰ä¸¤ä¸ªï¼š\n\nä¿®æ”¹ tomcat é…ç½®æ–‡ä»¶æ·»åŠ ç¼–ç ä¸å·¥ç¨‹ç¼–ç ä¸€è‡´ï¼Œå¦‚ä¸‹ï¼š\n\n```xml\n<ConnectorURIEncoding=\"utf-8\" connectionTimeout=\"20000\" port=\"8080\" protocol=\"HTTP/1.1\" redirectPort=\"8443\"/>\n```\n\n### Spring MVCçš„å¼‚å¸¸å¤„ç†\n\nå¯ä»¥å°†å¼‚å¸¸æŠ›ç»™ Spring æ¡†æ¶ï¼Œç”± Spring æ¡†æ¶æ¥å¤„ç†ï¼›æˆ‘ä»¬åªéœ€è¦é…ç½®ç®€å•çš„å¼‚å¸¸å¤„ç†å™¨ï¼Œåœ¨å¼‚å¸¸å¤„ç†å™¨ä¸­æ·»è§†å›¾é¡µé¢å³å¯ã€‚\n\n### å¦‚æœåœ¨æ‹¦æˆªè¯·æ±‚ä¸­ï¼Œæˆ‘æƒ³æ‹¦æˆªgetæ–¹å¼æäº¤çš„æ–¹æ³•,æ€ä¹ˆé…ç½®\n\nç­”ï¼šå¯ä»¥åœ¨@RequestMapping æ³¨è§£é‡Œé¢åŠ ä¸Š method=RequestMethod.GETã€‚\n\n### æ€æ ·åœ¨æ–¹æ³•é‡Œé¢å¾—åˆ°Request,æˆ–è€…Sessionï¼Ÿ\n\nç­”ï¼šç›´æ¥åœ¨æ–¹æ³•çš„å½¢å‚ä¸­å£°æ˜ request,Spring MVC å°±è‡ªåŠ¨æŠŠ request å¯¹è±¡ä¼ å…¥ã€‚\n\n### å¦‚æœæƒ³åœ¨æ‹¦æˆªçš„æ–¹æ³•é‡Œé¢å¾—åˆ°ä»å‰å°ä¼ å…¥çš„å‚æ•°,æ€ä¹ˆå¾—åˆ°ï¼Ÿ\n\nç›´æ¥åœ¨å½¢å‚é‡Œé¢å£°æ˜è¿™ä¸ªå‚æ•°å°±å¯ä»¥,ä½†å¿…é¡»åå­—å’Œä¼ è¿‡æ¥çš„å‚æ•°ä¸€æ ·ã€‚\næˆ–è€…ä½¿ç”¨ RequestParam æ³¨è§£å°†å‰å°çš„å‚æ•°å A ä¼ ç»™å½¢å‚ä¸­çš„å‚æ•° B\n\n### å¦‚æœå‰å°æœ‰å¾ˆå¤šä¸ªå‚æ•°ä¼ å…¥,å¹¶ä¸”è¿™äº›å‚æ•°éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡çš„,é‚£ä¹ˆæ€ä¹ˆæ ·å¿«é€Ÿå¾—åˆ°è¿™ä¸ªå¯¹è±¡ï¼Ÿ\n\nç›´æ¥åœ¨æ–¹æ³•ä¸­å£°æ˜è¿™ä¸ªå¯¹è±¡,Spring MVC å°±è‡ªåŠ¨ä¼šæŠŠå±æ€§èµ‹å€¼åˆ°è¿™ä¸ªå¯¹è±¡é‡Œé¢ã€‚\n\n### Spring MVCä¸­å‡½æ•°çš„è¿”å›å€¼æ˜¯ä»€ä¹ˆï¼Ÿ\n\nè¿”å›å€¼å¯ä»¥æœ‰å¾ˆå¤šç±»å‹,æœ‰ String, ModelAndViewï¼ˆè§†å›¾å’Œæ•°æ®åˆå¹¶åœ¨ä¸€èµ·ï¼‰ã€‚\n\n### Spring MVCç”¨ä»€ä¹ˆå¯¹è±¡ä»åå°å‘å‰å°ä¼ é€’æ•°æ®çš„ï¼Ÿ\n\né€šè¿‡ ModelMap å¯¹è±¡,å¯ä»¥åœ¨è¿™ä¸ªå¯¹è±¡é‡Œé¢è°ƒç”¨ put æ–¹æ³•,æŠŠå¯¹è±¡åŠ åˆ°é‡Œé¢,å‰å°å°±å¯ä»¥é€šè¿‡ el è¡¨è¾¾å¼æ‹¿åˆ°ã€‚\n\n### æ€ä¹ˆæ ·æŠŠModelMapé‡Œé¢çš„æ•°æ®æ”¾å…¥Sessioné‡Œé¢ï¼Ÿ\n\nå¯ä»¥åœ¨ç±»ä¸Šé¢åŠ ä¸Š@SessionAttributes æ³¨è§£,é‡Œé¢åŒ…å«çš„å­—ç¬¦ä¸²å°±æ˜¯è¦æ”¾å…¥ session é‡Œé¢çš„ keyã€‚\n\n### Spring MVCé‡Œé¢æ‹¦æˆªå™¨æ˜¯æ€ä¹ˆå†™çš„\n\næœ‰ä¸¤ç§å†™æ³•,ä¸€ç§æ˜¯å®ç° HandlerInterceptor æ¥å£ï¼Œé‡å†™ prehandle ç­‰æ–¹æ³•ï¼Œç„¶åé…ç½®æ‹¦æˆªå™¨\n","source":"_posts/Javaå…«è‚¡æ–‡ - SpringMVC.md","raw":"---\ntitle: Javaå…«è‚¡æ–‡ - SpringMVC\ncopyright: true\nmathjax: false\ncategories:\n  - Javaå…«è‚¡æ–‡\ndate: 2023-01-23 16:14:20\ntags:\ntoc: true\nurlname: java-springmvc\n---\n\n> æ•´ç†çš„SpringMVCç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½<!--more-->\n\n## æ¦‚è¿°\n\n### ä»€ä¹ˆæ˜¯Spring MVCï¼Ÿç®€å•ä»‹ç»ä¸‹ä½ å¯¹Spring MVCçš„ç†è§£ï¼Ÿ\n\nSpring MVC æ˜¯ä¸€ä¸ªåŸºäº Java çš„å®ç°äº† MVC è®¾è®¡æ¨¡å¼çš„è¯·æ±‚é©±åŠ¨ç±»å‹çš„è½»é‡çº§ Web æ¡†æ¶ï¼Œé€šè¿‡æŠŠæ¨¡å‹-è§†å›¾-æ§åˆ¶å™¨åˆ†ç¦»ï¼Œå°† web å±‚è¿›è¡ŒèŒè´£è§£è€¦ï¼Œç®€åŒ–å¼€å‘ã€‚\n\n## æ ¸å¿ƒç»„ä»¶\n\n### Spring MVCçš„ä¸»è¦ç»„ä»¶ï¼Ÿ\n\nï¼ˆ1ï¼‰å‰ç«¯æ§åˆ¶å™¨ DispatcherServletï¼ˆä¸éœ€è¦ç¨‹åºå‘˜å¼€å‘ï¼‰\n\nä½œç”¨ï¼šæ¥æ”¶è¯·æ±‚ã€å“åº”ç»“æœï¼Œç›¸å½“äºè½¬å‘å™¨ï¼Œæœ‰äº† DispatcherServlet å°±å‡å°‘äº†å…¶å®ƒç»„ä»¶ä¹‹é—´çš„è€¦åˆåº¦ã€‚\n\nï¼ˆ2ï¼‰å¤„ç†å™¨æ˜ å°„å™¨ HandlerMappingï¼ˆä¸éœ€è¦ç¨‹åºå‘˜å¼€å‘ï¼‰\n\nä½œç”¨ï¼šæ ¹æ®è¯·æ±‚çš„ URL æ¥æŸ¥æ‰¾ Handler\n\nï¼ˆ3ï¼‰å¤„ç†å™¨é€‚é…å™¨ HandlerAdapter\n\næ³¨æ„ï¼šåœ¨ç¼–å†™ Handler çš„æ—¶å€™è¦æŒ‰ç…§ HandlerAdapter è¦æ±‚çš„è§„åˆ™å»ç¼–å†™ï¼Œè¿™æ ·é€‚é…å™¨ HandlerAdapter æ‰å¯ä»¥æ­£ç¡®çš„å»æ‰§è¡Œ Handlerã€‚\n\nï¼ˆ4ï¼‰å¤„ç†å™¨ Handlerï¼ˆéœ€è¦ç¨‹åºå‘˜å¼€å‘ï¼‰\n\nï¼ˆ5ï¼‰è§†å›¾è§£æå™¨ ViewResolverï¼ˆä¸éœ€è¦ç¨‹åºå‘˜å¼€å‘ï¼‰\n\nä½œç”¨ï¼šè¿›è¡Œè§†å›¾çš„è§£æï¼Œæ ¹æ®è§†å›¾é€»è¾‘åè§£ææˆçœŸæ­£çš„è§†å›¾ï¼ˆviewï¼‰\n\nï¼ˆ6ï¼‰è§†å›¾ Viewï¼ˆéœ€è¦ç¨‹åºå‘˜å¼€å‘ jspï¼‰\n\nView æ˜¯ä¸€ä¸ªæ¥å£ï¼Œ å®ƒçš„å®ç°ç±»æ”¯æŒä¸åŒçš„è§†å›¾ç±»å‹ï¼ˆjspï¼Œfreemarkerï¼Œpdf ç­‰ç­‰ï¼‰\n\n### ä»€ä¹ˆæ˜¯DispatcherServlet\n\nSpring çš„ MVC æ¡†æ¶æ˜¯å›´ç»• DispatcherServlet æ¥è®¾è®¡çš„ï¼Œå®ƒç”¨æ¥å¤„ç†æ‰€æœ‰çš„ HTTP è¯·æ±‚å’Œå“åº”ã€‚\n\n### ä»€ä¹ˆæ˜¯Spring MVCæ¡†æ¶çš„æ§åˆ¶å™¨ï¼Ÿ\n\næ§åˆ¶å™¨ä½¿ç”¨@Controller æ³¨è§£ï¼Œå¹¶ä¸”æä¾›äº†@RequestMapping æ³¨è§£ï¼Œé€šè¿‡è§£æ url ä¸­çš„è·¯å¾„ï¼Œå¯ä»¥æ‰¾åˆ°ç›¸åº”çš„æ§åˆ¶å™¨è¿›è¡Œé€»è¾‘å¤„ç†ï¼Œå“åº”æ•°æ®ç­‰ã€‚\n\n### Spring MVCçš„æ§åˆ¶å™¨æ˜¯ä¸æ˜¯å•ä¾‹æ¨¡å¼,å¦‚æœæ˜¯,æœ‰ä»€ä¹ˆé—®é¢˜,æ€ä¹ˆè§£å†³ï¼Ÿ\n\nå•ä¾‹æ¨¡å¼,æ‰€ä»¥åœ¨å¤šçº¿ç¨‹è®¿é—®çš„æ—¶å€™æœ‰çº¿ç¨‹å®‰å…¨é—®é¢˜,ä¸è¦ç”¨åŒæ­¥,ä¼šå½±å“æ€§èƒ½çš„ï¼Œè§£å†³æ–¹æ¡ˆæ˜¯åœ¨æ§åˆ¶å™¨ä¿æŒæ§åˆ¶å™¨æ— çŠ¶æ€ï¼ˆä¸è¦å†™å­—æ®µï¼‰ã€‚\n\n## å·¥ä½œåŸç†\n\n### è¯·æè¿°Spring MVCçš„å·¥ä½œæµç¨‹ï¼Ÿæè¿°ä¸€ä¸‹ DispatcherServlet çš„å·¥ä½œæµç¨‹ï¼Ÿ\n\n1. ç”¨æˆ·å‘é€è¯·æ±‚è‡³å‰ç«¯æ§åˆ¶å™¨ DispatcherServletï¼›\n2. DispatcherServlet æ”¶åˆ°è¯·æ±‚åï¼Œè°ƒç”¨ HandlerMapping å¤„ç†å™¨æ˜ å°„å™¨ï¼Œè¯·æ±‚è·å– Handlerï¼›\n3. HandlerMapping å¤„ç†å™¨æ˜ å°„å™¨æ ¹æ®è¯·æ±‚ url**æ‰¾åˆ°å…·ä½“çš„å¤„ç†å™¨**ï¼Œç”Ÿæˆå¤„ç†å™¨å¯¹è±¡åŠå¤„ç†å™¨æ‹¦æˆªå™¨(å¦‚æœæœ‰åˆ™ç”Ÿæˆ)ä¸€å¹¶è¿”å›ç»™ DispatcherServletï¼›\n4. DispatcherServlet è°ƒç”¨ HandlerAdapter å¤„ç†å™¨é€‚é…å™¨ï¼›\n5. HandlerAdapter ç»è¿‡é€‚é… **è°ƒç”¨å…·ä½“å¤„ç†å™¨**(Handlerï¼Œä¹Ÿå«åç«¯æ§åˆ¶å™¨)ï¼›\n6. Handler æ‰§è¡Œå®Œæˆè¿”å› ModelAndViewï¼›\n7. HandlerAdapter å°† Handler æ‰§è¡Œç»“æœ ModelAndView è¿”å›ç»™ DispatcherServletï¼›\n8. DispatcherServlet å°† ModelAndView ä¼ ç»™ ViewResolver è§†å›¾è§£æå™¨è¿›è¡Œè§£æï¼›\n9. ViewResolver è§£æåè¿”å›å…·ä½“ Viewï¼›\n10. DispatcherServlet å¯¹ View è¿›è¡Œæ¸²æŸ“æˆä¸ºè§†å›¾ï¼ˆå³å°†æ¨¡å‹æ•°æ®å¡«å……è‡³è§†å›¾ä¸­ï¼‰ï¼›\n11. DispatcherServlet å“åº”ç”¨æˆ·ã€‚\n\n![Spring MVCçš„å·¥ä½œæµç¨‹](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes20200208211439106.png)\n\n## å¸¸ç”¨æ³¨è§£\n\n### æ³¨è§£åŸç†æ˜¯ä»€ä¹ˆ\n\næ³¨è§£æœ¬è´¨æ˜¯ä¸€ä¸ªç»§æ‰¿äº† Annotation çš„ç‰¹æ®Šæ¥å£ï¼Œå…¶å…·ä½“å®ç°ç±»æ˜¯ Java è¿è¡Œæ—¶ç”Ÿæˆçš„åŠ¨æ€ä»£ç†ç±»ã€‚æˆ‘ä»¬é€šè¿‡åå°„è·å–æ³¨è§£æ—¶ï¼Œè¿”å›çš„æ˜¯ Java è¿è¡Œæ—¶ç”Ÿæˆçš„åŠ¨æ€ä»£ç†å¯¹è±¡ã€‚é€šè¿‡ä»£ç†å¯¹è±¡è°ƒç”¨è‡ªå®šä¹‰æ³¨è§£çš„æ–¹æ³•ã€‚\n\n### Spring MVCå¸¸ç”¨çš„æ³¨è§£æœ‰å“ªäº›ï¼Ÿ\n\n@RequestMappingï¼šç”¨äºå¤„ç†è¯·æ±‚ url æ˜ å°„çš„æ³¨è§£ï¼Œå¯ç”¨äºç±»æˆ–æ–¹æ³•ä¸Šã€‚ç”¨äºç±»ä¸Šï¼Œåˆ™è¡¨ç¤ºç±»ä¸­çš„æ‰€æœ‰å“åº”è¯·æ±‚çš„æ–¹æ³•éƒ½æ˜¯ä»¥è¯¥åœ°å€ä½œä¸ºçˆ¶è·¯å¾„ã€‚\n\n@RequestBodyï¼šæ³¨è§£å®ç°æ¥æ”¶ http è¯·æ±‚çš„ json æ•°æ®ï¼Œå°† json è½¬æ¢ä¸º java å¯¹è±¡ã€‚\n\n@ResponseBodyï¼šæ³¨è§£å®ç°å°† controller æ–¹æ³•è¿”å›å¯¹è±¡è½¬åŒ–ä¸º json å¯¹è±¡å“åº”ç»™å®¢æˆ·ã€‚\n\n### Sping MVCä¸­çš„æ§åˆ¶å™¨çš„æ³¨è§£ä¸€èˆ¬ç”¨å“ªä¸ª,æœ‰æ²¡æœ‰åˆ«çš„æ³¨è§£å¯ä»¥æ›¿ä»£ï¼Ÿ\n\nç­”ï¼šä¸€èˆ¬ç”¨@Controller æ³¨è§£ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨@RestControllerï¼Œ@RestController æ³¨è§£ç›¸å½“äº@ResponseBody ï¼‹ @Controllerï¼Œ@ResponseBody ç”¨äºè¿”å› json æ•°æ®ï¼‹ @Controller ç”¨äºè¡¨æ˜æ§åˆ¶å™¨\n\n### @Controlleræ³¨è§£çš„ä½œç”¨\n\n@Controller ç”¨äºæ ‡è®°åœ¨ä¸€ä¸ªç±»ä¸Šï¼Œä½¿ç”¨å®ƒæ ‡è®°çš„ç±»å°±æ˜¯ä¸€ä¸ª Spring MVC Controller å¯¹è±¡ã€‚é€šè¿‡è¯·æ±‚çš„ url å’Œ@RequestMapping æ³¨è§£å¯¹åº”åˆ°å®é™…å¤„ç†è¯·æ±‚çš„å¤„ç†å™¨ã€‚éœ€è¦å¼€å¯ mvc æ³¨è§£æ‰«ææ‰¾åˆ°@Controller çš„æ§åˆ¶å™¨ã€‚\n\n### @RequestMappingæ³¨è§£çš„ä½œç”¨\n\nRequestMapping æ˜¯ä¸€ä¸ªç”¨æ¥å¤„ç†è¯·æ±‚åœ°å€æ˜ å°„çš„æ³¨è§£ï¼Œå¯ç”¨äºç±»æˆ–æ–¹æ³•ä¸Šã€‚\n\nç”¨äºç±»ä¸Šï¼Œè¡¨ç¤ºç±»ä¸­çš„æ‰€æœ‰å“åº”è¯·æ±‚çš„æ–¹æ³•éƒ½æ˜¯ä»¥è¯¥åœ°å€ä½œä¸ºçˆ¶è·¯å¾„ã€‚\n\nRequestMapping æ³¨è§£æœ‰å…­ä¸ªå±æ€§ï¼š\n\n**path/valueï¼Œ method**\n\n* valueï¼š æŒ‡å®šè¯·æ±‚çš„å®é™…åœ°å€ï¼ŒæŒ‡å®šçš„åœ°å€å¯ä»¥æ˜¯ URI Template æ¨¡å¼ï¼ˆåé¢å°†ä¼šè¯´æ˜ï¼‰ï¼›\n\n* methodï¼š æŒ‡å®šè¯·æ±‚çš„ method ç±»å‹ï¼Œ GETã€POSTã€PUTã€DELETE ç­‰ï¼›\n\n**consumesï¼Œproduces**\n\n* consumesï¼š æŒ‡å®šå¤„ç†è¯·æ±‚çš„æäº¤å†…å®¹ç±»å‹ï¼ˆContent-Typeï¼‰ï¼Œä¾‹å¦‚ application/json, text/html;\n\n* produces: æŒ‡å®šè¿”å›çš„å†…å®¹ç±»å‹ï¼Œä»…å½“ request è¯·æ±‚å¤´ä¸­çš„(Accept)ç±»å‹ä¸­åŒ…å«è¯¥æŒ‡å®šç±»å‹æ‰è¿”å›ï¼›\n\n**paramsï¼Œheaders**\n\n* paramsï¼š æŒ‡å®š request ä¸­å¿…é¡»åŒ…å«æŸäº›å‚æ•°å€¼æ—¶ï¼Œæ‰è®©è¯¥æ–¹æ³•å¤„ç†ã€‚\n\n* headersï¼š æŒ‡å®š request ä¸­å¿…é¡»åŒ…å«æŸäº›æŒ‡å®šçš„ header å€¼ï¼Œæ‰èƒ½è®©è¯¥æ–¹æ³•å¤„ç†è¯·æ±‚ã€‚\n\n### @PathVariableå’Œ@RequestParamçš„åŒºåˆ«\n\n@PathVariable ä½œç”¨ï¼š ç”¨äºç»‘å®š url ä¸­çš„å ä½ç¬¦ã€‚ä¾‹å¦‚ï¼šè¯·æ±‚ url ä¸­ /delete/{id}ï¼Œè¿™ä¸ª{id}å°±æ˜¯ url å ä½ç¬¦ã€‚\n\n```java\n/**\n* æ ¹æ®path /anno/testPathVariable/10 æ‰¾åˆ° testPathVariable æ–¹æ³•\n* ç„¶åï¼Œå…¶ä¸­çš„10å°±æ˜¯sidå ä½ç¬¦æ‰€å çš„ä½ç½®çš„æ•°æ®ï¼Œç„¶åé€šè¿‡@PathVaribaleæ³¨è§£å°†å…¶èµ‹å€¼ç»™ id\n*/\n@RequestMapping(path = \"testPathVariable/{sid}\")\npublic String testPathVariable(@PathVariable(value = \"sid\") String id) {\n    System.out.println(\"æ‰§è¡Œäº†testPathVariable...\");\n    System.out.println(id);\n    return \"success\";\n}\n```\n\n@RequestParam ä½œç”¨ï¼š æŠŠè¯·æ±‚ä¸­æŒ‡å®šåç§°çš„å‚æ•°ç»™æ§åˆ¶å™¨ä¸­çš„å½¢å‚èµ‹å€¼ã€‚\n\n```java\n// Controllerä¸­çš„ä»£ç ï¼š\n@RequestMapping(path = \"/testRequestParam\")\npublic String testRequestParam(@RequestParam(value = \"name\") String username) {\n    // æŠŠè¯·æ±‚ä¸­æŒ‡å®šçš„nameèµ‹å€¼ç»™æ§åˆ¶å™¨ä¸­çš„å½¢å‚username\n    System.out.println(\"æ‰§è¡Œäº†testRequestParam...\");\n    System.out.println(username);\n    return \"success\";\n}\n```\n\n## å…¶ä»–\n\n### Spring MVCæ€ä¹ˆæ ·è®¾å®šè½¬å‘å’Œé‡å®šå‘çš„ï¼Ÿ\n\nï¼ˆ1ï¼‰è½¬å‘ï¼šä½¿ç”¨ forward\nforward æ˜¯æŒ‡å†…éƒ¨è½¬å‘ï¼Œç›¸å½“äºæœåŠ¡å™¨å†…éƒ¨æ–¹æ³•è·³è½¬è°ƒç”¨ã€‚è¯·æ±‚ä¸€æ¬¡æœåŠ¡å™¨ã€‚è½¬å‘åœ°å€ä¸å˜ã€‚\n\nï¼ˆ2ï¼‰é‡å®šå‘ï¼šä½¿ç”¨ redirect\né‡å®šå‘æ˜¯æŒ‡å½“æµè§ˆå™¨è¯·æ±‚ä¸€ä¸ª URL æ—¶ï¼ŒæœåŠ¡å™¨è¿”å›ä¸€ä¸ªé‡å®šå‘æŒ‡ä»¤ï¼Œå‘Šè¯‰æµè§ˆå™¨åœ°å€å·²ç»å˜äº†ï¼Œéº»çƒ¦ä½¿ç”¨æ–°çš„ URL å†é‡æ–°å‘é€æ–°è¯·æ±‚ã€‚è¯·æ±‚ä¸¤æ¬¡æœåŠ¡å™¨ã€‚é‡å®šå‘åœ°å€æ”¹å˜ã€‚\n\n### Spring MVCæ€ä¹ˆå’ŒAJAXç›¸äº’è°ƒç”¨çš„ï¼Ÿ\n\né€šè¿‡ Jackson æˆ–è€…æ˜¯ fastjson å°±å¯ä»¥æŠŠ Java é‡Œé¢çš„å¯¹è±¡ç›´æ¥è½¬åŒ–æˆ Js å¯ä»¥è¯†åˆ«çš„ Json å¯¹è±¡ï¼Œæ¥è¿›è¡Œä¼ è¾“ã€‚\n\n### å¦‚ä½•è§£å†³POSTè¯·æ±‚ä¸­æ–‡ä¹±ç é—®é¢˜ï¼ŒGETçš„åˆå¦‚ä½•å¤„ç†å‘¢ï¼Ÿ\n\nï¼ˆ1ï¼‰è§£å†³ post è¯·æ±‚ä¹±ç é—®é¢˜ï¼š\n\nåœ¨ web.xml ä¸­é…ç½®ä¸€ä¸ª CharacterEncodingFilter è¿‡æ»¤å™¨ï¼Œè®¾ç½®æˆ utf-8ï¼›\n\n```xml\n<filter>\n    <filter-name>CharacterEncodingFilter</filter-name>\n    <filter-class>org.springframework.web.filter.CharacterEncodingFilter</filter-class>\n\n    <init-param>\n        <param-name>encoding</param-name>\n        <param-value>utf-8</param-value>\n    </init-param>\n</filter>\n\n<filter-mapping>\n    <filter-name>CharacterEncodingFilter</filter-name>\n    <url-pattern>/*</url-pattern>\n</filter-mapping>\n```\n\nï¼ˆ2ï¼‰get è¯·æ±‚ä¸­æ–‡å‚æ•°å‡ºç°ä¹±ç è§£å†³æ–¹æ³•æœ‰ä¸¤ä¸ªï¼š\n\nä¿®æ”¹ tomcat é…ç½®æ–‡ä»¶æ·»åŠ ç¼–ç ä¸å·¥ç¨‹ç¼–ç ä¸€è‡´ï¼Œå¦‚ä¸‹ï¼š\n\n```xml\n<ConnectorURIEncoding=\"utf-8\" connectionTimeout=\"20000\" port=\"8080\" protocol=\"HTTP/1.1\" redirectPort=\"8443\"/>\n```\n\n### Spring MVCçš„å¼‚å¸¸å¤„ç†\n\nå¯ä»¥å°†å¼‚å¸¸æŠ›ç»™ Spring æ¡†æ¶ï¼Œç”± Spring æ¡†æ¶æ¥å¤„ç†ï¼›æˆ‘ä»¬åªéœ€è¦é…ç½®ç®€å•çš„å¼‚å¸¸å¤„ç†å™¨ï¼Œåœ¨å¼‚å¸¸å¤„ç†å™¨ä¸­æ·»è§†å›¾é¡µé¢å³å¯ã€‚\n\n### å¦‚æœåœ¨æ‹¦æˆªè¯·æ±‚ä¸­ï¼Œæˆ‘æƒ³æ‹¦æˆªgetæ–¹å¼æäº¤çš„æ–¹æ³•,æ€ä¹ˆé…ç½®\n\nç­”ï¼šå¯ä»¥åœ¨@RequestMapping æ³¨è§£é‡Œé¢åŠ ä¸Š method=RequestMethod.GETã€‚\n\n### æ€æ ·åœ¨æ–¹æ³•é‡Œé¢å¾—åˆ°Request,æˆ–è€…Sessionï¼Ÿ\n\nç­”ï¼šç›´æ¥åœ¨æ–¹æ³•çš„å½¢å‚ä¸­å£°æ˜ request,Spring MVC å°±è‡ªåŠ¨æŠŠ request å¯¹è±¡ä¼ å…¥ã€‚\n\n### å¦‚æœæƒ³åœ¨æ‹¦æˆªçš„æ–¹æ³•é‡Œé¢å¾—åˆ°ä»å‰å°ä¼ å…¥çš„å‚æ•°,æ€ä¹ˆå¾—åˆ°ï¼Ÿ\n\nç›´æ¥åœ¨å½¢å‚é‡Œé¢å£°æ˜è¿™ä¸ªå‚æ•°å°±å¯ä»¥,ä½†å¿…é¡»åå­—å’Œä¼ è¿‡æ¥çš„å‚æ•°ä¸€æ ·ã€‚\næˆ–è€…ä½¿ç”¨ RequestParam æ³¨è§£å°†å‰å°çš„å‚æ•°å A ä¼ ç»™å½¢å‚ä¸­çš„å‚æ•° B\n\n### å¦‚æœå‰å°æœ‰å¾ˆå¤šä¸ªå‚æ•°ä¼ å…¥,å¹¶ä¸”è¿™äº›å‚æ•°éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡çš„,é‚£ä¹ˆæ€ä¹ˆæ ·å¿«é€Ÿå¾—åˆ°è¿™ä¸ªå¯¹è±¡ï¼Ÿ\n\nç›´æ¥åœ¨æ–¹æ³•ä¸­å£°æ˜è¿™ä¸ªå¯¹è±¡,Spring MVC å°±è‡ªåŠ¨ä¼šæŠŠå±æ€§èµ‹å€¼åˆ°è¿™ä¸ªå¯¹è±¡é‡Œé¢ã€‚\n\n### Spring MVCä¸­å‡½æ•°çš„è¿”å›å€¼æ˜¯ä»€ä¹ˆï¼Ÿ\n\nè¿”å›å€¼å¯ä»¥æœ‰å¾ˆå¤šç±»å‹,æœ‰ String, ModelAndViewï¼ˆè§†å›¾å’Œæ•°æ®åˆå¹¶åœ¨ä¸€èµ·ï¼‰ã€‚\n\n### Spring MVCç”¨ä»€ä¹ˆå¯¹è±¡ä»åå°å‘å‰å°ä¼ é€’æ•°æ®çš„ï¼Ÿ\n\né€šè¿‡ ModelMap å¯¹è±¡,å¯ä»¥åœ¨è¿™ä¸ªå¯¹è±¡é‡Œé¢è°ƒç”¨ put æ–¹æ³•,æŠŠå¯¹è±¡åŠ åˆ°é‡Œé¢,å‰å°å°±å¯ä»¥é€šè¿‡ el è¡¨è¾¾å¼æ‹¿åˆ°ã€‚\n\n### æ€ä¹ˆæ ·æŠŠModelMapé‡Œé¢çš„æ•°æ®æ”¾å…¥Sessioné‡Œé¢ï¼Ÿ\n\nå¯ä»¥åœ¨ç±»ä¸Šé¢åŠ ä¸Š@SessionAttributes æ³¨è§£,é‡Œé¢åŒ…å«çš„å­—ç¬¦ä¸²å°±æ˜¯è¦æ”¾å…¥ session é‡Œé¢çš„ keyã€‚\n\n### Spring MVCé‡Œé¢æ‹¦æˆªå™¨æ˜¯æ€ä¹ˆå†™çš„\n\næœ‰ä¸¤ç§å†™æ³•,ä¸€ç§æ˜¯å®ç° HandlerInterceptor æ¥å£ï¼Œé‡å†™ prehandle ç­‰æ–¹æ³•ï¼Œç„¶åé…ç½®æ‹¦æˆªå™¨\n","slug":"Javaå…«è‚¡æ–‡ - SpringMVC","published":1,"updated":"2023-01-26T12:35:58.976Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cldzfw321000ft9t82hv43rgr","content":"<blockquote>\n<p>æ•´ç†çš„SpringMVCç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½<span id=\"more\"></span></p>\n</blockquote>\n<h2 id=\"æ¦‚è¿°\"><a href=\"#æ¦‚è¿°\" class=\"headerlink\" title=\"æ¦‚è¿°\"></a>æ¦‚è¿°</h2><h3 id=\"ä»€ä¹ˆæ˜¯Spring-MVCï¼Ÿç®€å•ä»‹ç»ä¸‹ä½ å¯¹Spring-MVCçš„ç†è§£ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯Spring-MVCï¼Ÿç®€å•ä»‹ç»ä¸‹ä½ å¯¹Spring-MVCçš„ç†è§£ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯Spring MVCï¼Ÿç®€å•ä»‹ç»ä¸‹ä½ å¯¹Spring MVCçš„ç†è§£ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯Spring MVCï¼Ÿç®€å•ä»‹ç»ä¸‹ä½ å¯¹Spring MVCçš„ç†è§£ï¼Ÿ</h3><p>Spring MVC æ˜¯ä¸€ä¸ªåŸºäº Java çš„å®ç°äº† MVC è®¾è®¡æ¨¡å¼çš„è¯·æ±‚é©±åŠ¨ç±»å‹çš„è½»é‡çº§ Web æ¡†æ¶ï¼Œé€šè¿‡æŠŠæ¨¡å‹-è§†å›¾-æ§åˆ¶å™¨åˆ†ç¦»ï¼Œå°† web å±‚è¿›è¡ŒèŒè´£è§£è€¦ï¼Œç®€åŒ–å¼€å‘ã€‚</p>\n<h2 id=\"æ ¸å¿ƒç»„ä»¶\"><a href=\"#æ ¸å¿ƒç»„ä»¶\" class=\"headerlink\" title=\"æ ¸å¿ƒç»„ä»¶\"></a>æ ¸å¿ƒç»„ä»¶</h2><h3 id=\"Spring-MVCçš„ä¸»è¦ç»„ä»¶ï¼Ÿ\"><a href=\"#Spring-MVCçš„ä¸»è¦ç»„ä»¶ï¼Ÿ\" class=\"headerlink\" title=\"Spring MVCçš„ä¸»è¦ç»„ä»¶ï¼Ÿ\"></a>Spring MVCçš„ä¸»è¦ç»„ä»¶ï¼Ÿ</h3><p>ï¼ˆ1ï¼‰å‰ç«¯æ§åˆ¶å™¨ DispatcherServletï¼ˆä¸éœ€è¦ç¨‹åºå‘˜å¼€å‘ï¼‰</p>\n<p>ä½œç”¨ï¼šæ¥æ”¶è¯·æ±‚ã€å“åº”ç»“æœï¼Œç›¸å½“äºè½¬å‘å™¨ï¼Œæœ‰äº† DispatcherServlet å°±å‡å°‘äº†å…¶å®ƒç»„ä»¶ä¹‹é—´çš„è€¦åˆåº¦ã€‚</p>\n<p>ï¼ˆ2ï¼‰å¤„ç†å™¨æ˜ å°„å™¨ HandlerMappingï¼ˆä¸éœ€è¦ç¨‹åºå‘˜å¼€å‘ï¼‰</p>\n<p>ä½œç”¨ï¼šæ ¹æ®è¯·æ±‚çš„ URL æ¥æŸ¥æ‰¾ Handler</p>\n<p>ï¼ˆ3ï¼‰å¤„ç†å™¨é€‚é…å™¨ HandlerAdapter</p>\n<p>æ³¨æ„ï¼šåœ¨ç¼–å†™ Handler çš„æ—¶å€™è¦æŒ‰ç…§ HandlerAdapter è¦æ±‚çš„è§„åˆ™å»ç¼–å†™ï¼Œè¿™æ ·é€‚é…å™¨ HandlerAdapter æ‰å¯ä»¥æ­£ç¡®çš„å»æ‰§è¡Œ Handlerã€‚</p>\n<p>ï¼ˆ4ï¼‰å¤„ç†å™¨ Handlerï¼ˆéœ€è¦ç¨‹åºå‘˜å¼€å‘ï¼‰</p>\n<p>ï¼ˆ5ï¼‰è§†å›¾è§£æå™¨ ViewResolverï¼ˆä¸éœ€è¦ç¨‹åºå‘˜å¼€å‘ï¼‰</p>\n<p>ä½œç”¨ï¼šè¿›è¡Œè§†å›¾çš„è§£æï¼Œæ ¹æ®è§†å›¾é€»è¾‘åè§£ææˆçœŸæ­£çš„è§†å›¾ï¼ˆviewï¼‰</p>\n<p>ï¼ˆ6ï¼‰è§†å›¾ Viewï¼ˆéœ€è¦ç¨‹åºå‘˜å¼€å‘ jspï¼‰</p>\n<p>View æ˜¯ä¸€ä¸ªæ¥å£ï¼Œ å®ƒçš„å®ç°ç±»æ”¯æŒä¸åŒçš„è§†å›¾ç±»å‹ï¼ˆjspï¼Œfreemarkerï¼Œpdf ç­‰ç­‰ï¼‰</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯DispatcherServlet\"><a href=\"#ä»€ä¹ˆæ˜¯DispatcherServlet\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯DispatcherServlet\"></a>ä»€ä¹ˆæ˜¯DispatcherServlet</h3><p>Spring çš„ MVC æ¡†æ¶æ˜¯å›´ç»• DispatcherServlet æ¥è®¾è®¡çš„ï¼Œå®ƒç”¨æ¥å¤„ç†æ‰€æœ‰çš„ HTTP è¯·æ±‚å’Œå“åº”ã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯Spring-MVCæ¡†æ¶çš„æ§åˆ¶å™¨ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯Spring-MVCæ¡†æ¶çš„æ§åˆ¶å™¨ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯Spring MVCæ¡†æ¶çš„æ§åˆ¶å™¨ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯Spring MVCæ¡†æ¶çš„æ§åˆ¶å™¨ï¼Ÿ</h3><p>æ§åˆ¶å™¨ä½¿ç”¨@Controller æ³¨è§£ï¼Œå¹¶ä¸”æä¾›äº†@RequestMapping æ³¨è§£ï¼Œé€šè¿‡è§£æ url ä¸­çš„è·¯å¾„ï¼Œå¯ä»¥æ‰¾åˆ°ç›¸åº”çš„æ§åˆ¶å™¨è¿›è¡Œé€»è¾‘å¤„ç†ï¼Œå“åº”æ•°æ®ç­‰ã€‚</p>\n<h3 id=\"Spring-MVCçš„æ§åˆ¶å™¨æ˜¯ä¸æ˜¯å•ä¾‹æ¨¡å¼-å¦‚æœæ˜¯-æœ‰ä»€ä¹ˆé—®é¢˜-æ€ä¹ˆè§£å†³ï¼Ÿ\"><a href=\"#Spring-MVCçš„æ§åˆ¶å™¨æ˜¯ä¸æ˜¯å•ä¾‹æ¨¡å¼-å¦‚æœæ˜¯-æœ‰ä»€ä¹ˆé—®é¢˜-æ€ä¹ˆè§£å†³ï¼Ÿ\" class=\"headerlink\" title=\"Spring MVCçš„æ§åˆ¶å™¨æ˜¯ä¸æ˜¯å•ä¾‹æ¨¡å¼,å¦‚æœæ˜¯,æœ‰ä»€ä¹ˆé—®é¢˜,æ€ä¹ˆè§£å†³ï¼Ÿ\"></a>Spring MVCçš„æ§åˆ¶å™¨æ˜¯ä¸æ˜¯å•ä¾‹æ¨¡å¼,å¦‚æœæ˜¯,æœ‰ä»€ä¹ˆé—®é¢˜,æ€ä¹ˆè§£å†³ï¼Ÿ</h3><p>å•ä¾‹æ¨¡å¼,æ‰€ä»¥åœ¨å¤šçº¿ç¨‹è®¿é—®çš„æ—¶å€™æœ‰çº¿ç¨‹å®‰å…¨é—®é¢˜,ä¸è¦ç”¨åŒæ­¥,ä¼šå½±å“æ€§èƒ½çš„ï¼Œè§£å†³æ–¹æ¡ˆæ˜¯åœ¨æ§åˆ¶å™¨ä¿æŒæ§åˆ¶å™¨æ— çŠ¶æ€ï¼ˆä¸è¦å†™å­—æ®µï¼‰ã€‚</p>\n<h2 id=\"å·¥ä½œåŸç†\"><a href=\"#å·¥ä½œåŸç†\" class=\"headerlink\" title=\"å·¥ä½œåŸç†\"></a>å·¥ä½œåŸç†</h2><h3 id=\"è¯·æè¿°Spring-MVCçš„å·¥ä½œæµç¨‹ï¼Ÿæè¿°ä¸€ä¸‹-DispatcherServlet-çš„å·¥ä½œæµç¨‹ï¼Ÿ\"><a href=\"#è¯·æè¿°Spring-MVCçš„å·¥ä½œæµç¨‹ï¼Ÿæè¿°ä¸€ä¸‹-DispatcherServlet-çš„å·¥ä½œæµç¨‹ï¼Ÿ\" class=\"headerlink\" title=\"è¯·æè¿°Spring MVCçš„å·¥ä½œæµç¨‹ï¼Ÿæè¿°ä¸€ä¸‹ DispatcherServlet çš„å·¥ä½œæµç¨‹ï¼Ÿ\"></a>è¯·æè¿°Spring MVCçš„å·¥ä½œæµç¨‹ï¼Ÿæè¿°ä¸€ä¸‹ DispatcherServlet çš„å·¥ä½œæµç¨‹ï¼Ÿ</h3><ol>\n<li>ç”¨æˆ·å‘é€è¯·æ±‚è‡³å‰ç«¯æ§åˆ¶å™¨ DispatcherServletï¼›</li>\n<li>DispatcherServlet æ”¶åˆ°è¯·æ±‚åï¼Œè°ƒç”¨ HandlerMapping å¤„ç†å™¨æ˜ å°„å™¨ï¼Œè¯·æ±‚è·å– Handlerï¼›</li>\n<li>HandlerMapping å¤„ç†å™¨æ˜ å°„å™¨æ ¹æ®è¯·æ±‚ url<strong>æ‰¾åˆ°å…·ä½“çš„å¤„ç†å™¨</strong>ï¼Œç”Ÿæˆå¤„ç†å™¨å¯¹è±¡åŠå¤„ç†å™¨æ‹¦æˆªå™¨(å¦‚æœæœ‰åˆ™ç”Ÿæˆ)ä¸€å¹¶è¿”å›ç»™ DispatcherServletï¼›</li>\n<li>DispatcherServlet è°ƒç”¨ HandlerAdapter å¤„ç†å™¨é€‚é…å™¨ï¼›</li>\n<li>HandlerAdapter ç»è¿‡é€‚é… <strong>è°ƒç”¨å…·ä½“å¤„ç†å™¨</strong>(Handlerï¼Œä¹Ÿå«åç«¯æ§åˆ¶å™¨)ï¼›</li>\n<li>Handler æ‰§è¡Œå®Œæˆè¿”å› ModelAndViewï¼›</li>\n<li>HandlerAdapter å°† Handler æ‰§è¡Œç»“æœ ModelAndView è¿”å›ç»™ DispatcherServletï¼›</li>\n<li>DispatcherServlet å°† ModelAndView ä¼ ç»™ ViewResolver è§†å›¾è§£æå™¨è¿›è¡Œè§£æï¼›</li>\n<li>ViewResolver è§£æåè¿”å›å…·ä½“ Viewï¼›</li>\n<li>DispatcherServlet å¯¹ View è¿›è¡Œæ¸²æŸ“æˆä¸ºè§†å›¾ï¼ˆå³å°†æ¨¡å‹æ•°æ®å¡«å……è‡³è§†å›¾ä¸­ï¼‰ï¼›</li>\n<li>DispatcherServlet å“åº”ç”¨æˆ·ã€‚</li>\n</ol>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes20200208211439106.png\" alt=\"Spring MVCçš„å·¥ä½œæµç¨‹\"></p>\n<h2 id=\"å¸¸ç”¨æ³¨è§£\"><a href=\"#å¸¸ç”¨æ³¨è§£\" class=\"headerlink\" title=\"å¸¸ç”¨æ³¨è§£\"></a>å¸¸ç”¨æ³¨è§£</h2><h3 id=\"æ³¨è§£åŸç†æ˜¯ä»€ä¹ˆ\"><a href=\"#æ³¨è§£åŸç†æ˜¯ä»€ä¹ˆ\" class=\"headerlink\" title=\"æ³¨è§£åŸç†æ˜¯ä»€ä¹ˆ\"></a>æ³¨è§£åŸç†æ˜¯ä»€ä¹ˆ</h3><p>æ³¨è§£æœ¬è´¨æ˜¯ä¸€ä¸ªç»§æ‰¿äº† Annotation çš„ç‰¹æ®Šæ¥å£ï¼Œå…¶å…·ä½“å®ç°ç±»æ˜¯ Java è¿è¡Œæ—¶ç”Ÿæˆçš„åŠ¨æ€ä»£ç†ç±»ã€‚æˆ‘ä»¬é€šè¿‡åå°„è·å–æ³¨è§£æ—¶ï¼Œè¿”å›çš„æ˜¯ Java è¿è¡Œæ—¶ç”Ÿæˆçš„åŠ¨æ€ä»£ç†å¯¹è±¡ã€‚é€šè¿‡ä»£ç†å¯¹è±¡è°ƒç”¨è‡ªå®šä¹‰æ³¨è§£çš„æ–¹æ³•ã€‚</p>\n<h3 id=\"Spring-MVCå¸¸ç”¨çš„æ³¨è§£æœ‰å“ªäº›ï¼Ÿ\"><a href=\"#Spring-MVCå¸¸ç”¨çš„æ³¨è§£æœ‰å“ªäº›ï¼Ÿ\" class=\"headerlink\" title=\"Spring MVCå¸¸ç”¨çš„æ³¨è§£æœ‰å“ªäº›ï¼Ÿ\"></a>Spring MVCå¸¸ç”¨çš„æ³¨è§£æœ‰å“ªäº›ï¼Ÿ</h3><p>@RequestMappingï¼šç”¨äºå¤„ç†è¯·æ±‚ url æ˜ å°„çš„æ³¨è§£ï¼Œå¯ç”¨äºç±»æˆ–æ–¹æ³•ä¸Šã€‚ç”¨äºç±»ä¸Šï¼Œåˆ™è¡¨ç¤ºç±»ä¸­çš„æ‰€æœ‰å“åº”è¯·æ±‚çš„æ–¹æ³•éƒ½æ˜¯ä»¥è¯¥åœ°å€ä½œä¸ºçˆ¶è·¯å¾„ã€‚</p>\n<p>@RequestBodyï¼šæ³¨è§£å®ç°æ¥æ”¶ http è¯·æ±‚çš„ json æ•°æ®ï¼Œå°† json è½¬æ¢ä¸º java å¯¹è±¡ã€‚</p>\n<p>@ResponseBodyï¼šæ³¨è§£å®ç°å°† controller æ–¹æ³•è¿”å›å¯¹è±¡è½¬åŒ–ä¸º json å¯¹è±¡å“åº”ç»™å®¢æˆ·ã€‚</p>\n<h3 id=\"Sping-MVCä¸­çš„æ§åˆ¶å™¨çš„æ³¨è§£ä¸€èˆ¬ç”¨å“ªä¸ª-æœ‰æ²¡æœ‰åˆ«çš„æ³¨è§£å¯ä»¥æ›¿ä»£ï¼Ÿ\"><a href=\"#Sping-MVCä¸­çš„æ§åˆ¶å™¨çš„æ³¨è§£ä¸€èˆ¬ç”¨å“ªä¸ª-æœ‰æ²¡æœ‰åˆ«çš„æ³¨è§£å¯ä»¥æ›¿ä»£ï¼Ÿ\" class=\"headerlink\" title=\"Sping MVCä¸­çš„æ§åˆ¶å™¨çš„æ³¨è§£ä¸€èˆ¬ç”¨å“ªä¸ª,æœ‰æ²¡æœ‰åˆ«çš„æ³¨è§£å¯ä»¥æ›¿ä»£ï¼Ÿ\"></a>Sping MVCä¸­çš„æ§åˆ¶å™¨çš„æ³¨è§£ä¸€èˆ¬ç”¨å“ªä¸ª,æœ‰æ²¡æœ‰åˆ«çš„æ³¨è§£å¯ä»¥æ›¿ä»£ï¼Ÿ</h3><p>ç­”ï¼šä¸€èˆ¬ç”¨@Controller æ³¨è§£ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨@RestControllerï¼Œ@RestController æ³¨è§£ç›¸å½“äº@ResponseBody ï¼‹ @Controllerï¼Œ@ResponseBody ç”¨äºè¿”å› json æ•°æ®ï¼‹ @Controller ç”¨äºè¡¨æ˜æ§åˆ¶å™¨</p>\n<h3 id=\"Controlleræ³¨è§£çš„ä½œç”¨\"><a href=\"#Controlleræ³¨è§£çš„ä½œç”¨\" class=\"headerlink\" title=\"@Controlleræ³¨è§£çš„ä½œç”¨\"></a>@Controlleræ³¨è§£çš„ä½œç”¨</h3><p>@Controller ç”¨äºæ ‡è®°åœ¨ä¸€ä¸ªç±»ä¸Šï¼Œä½¿ç”¨å®ƒæ ‡è®°çš„ç±»å°±æ˜¯ä¸€ä¸ª Spring MVC Controller å¯¹è±¡ã€‚é€šè¿‡è¯·æ±‚çš„ url å’Œ@RequestMapping æ³¨è§£å¯¹åº”åˆ°å®é™…å¤„ç†è¯·æ±‚çš„å¤„ç†å™¨ã€‚éœ€è¦å¼€å¯ mvc æ³¨è§£æ‰«ææ‰¾åˆ°@Controller çš„æ§åˆ¶å™¨ã€‚</p>\n<h3 id=\"RequestMappingæ³¨è§£çš„ä½œç”¨\"><a href=\"#RequestMappingæ³¨è§£çš„ä½œç”¨\" class=\"headerlink\" title=\"@RequestMappingæ³¨è§£çš„ä½œç”¨\"></a>@RequestMappingæ³¨è§£çš„ä½œç”¨</h3><p>RequestMapping æ˜¯ä¸€ä¸ªç”¨æ¥å¤„ç†è¯·æ±‚åœ°å€æ˜ å°„çš„æ³¨è§£ï¼Œå¯ç”¨äºç±»æˆ–æ–¹æ³•ä¸Šã€‚</p>\n<p>ç”¨äºç±»ä¸Šï¼Œè¡¨ç¤ºç±»ä¸­çš„æ‰€æœ‰å“åº”è¯·æ±‚çš„æ–¹æ³•éƒ½æ˜¯ä»¥è¯¥åœ°å€ä½œä¸ºçˆ¶è·¯å¾„ã€‚</p>\n<p>RequestMapping æ³¨è§£æœ‰å…­ä¸ªå±æ€§ï¼š</p>\n<p><strong>path&#x2F;valueï¼Œ method</strong></p>\n<ul>\n<li><p>valueï¼š æŒ‡å®šè¯·æ±‚çš„å®é™…åœ°å€ï¼ŒæŒ‡å®šçš„åœ°å€å¯ä»¥æ˜¯ URI Template æ¨¡å¼ï¼ˆåé¢å°†ä¼šè¯´æ˜ï¼‰ï¼›</p>\n</li>\n<li><p>methodï¼š æŒ‡å®šè¯·æ±‚çš„ method ç±»å‹ï¼Œ GETã€POSTã€PUTã€DELETE ç­‰ï¼›</p>\n</li>\n</ul>\n<p><strong>consumesï¼Œproduces</strong></p>\n<ul>\n<li><p>consumesï¼š æŒ‡å®šå¤„ç†è¯·æ±‚çš„æäº¤å†…å®¹ç±»å‹ï¼ˆContent-Typeï¼‰ï¼Œä¾‹å¦‚ application&#x2F;json, text&#x2F;html;</p>\n</li>\n<li><p>produces: æŒ‡å®šè¿”å›çš„å†…å®¹ç±»å‹ï¼Œä»…å½“ request è¯·æ±‚å¤´ä¸­çš„(Accept)ç±»å‹ä¸­åŒ…å«è¯¥æŒ‡å®šç±»å‹æ‰è¿”å›ï¼›</p>\n</li>\n</ul>\n<p><strong>paramsï¼Œheaders</strong></p>\n<ul>\n<li><p>paramsï¼š æŒ‡å®š request ä¸­å¿…é¡»åŒ…å«æŸäº›å‚æ•°å€¼æ—¶ï¼Œæ‰è®©è¯¥æ–¹æ³•å¤„ç†ã€‚</p>\n</li>\n<li><p>headersï¼š æŒ‡å®š request ä¸­å¿…é¡»åŒ…å«æŸäº›æŒ‡å®šçš„ header å€¼ï¼Œæ‰èƒ½è®©è¯¥æ–¹æ³•å¤„ç†è¯·æ±‚ã€‚</p>\n</li>\n</ul>\n<h3 id=\"PathVariableå’Œ-RequestParamçš„åŒºåˆ«\"><a href=\"#PathVariableå’Œ-RequestParamçš„åŒºåˆ«\" class=\"headerlink\" title=\"@PathVariableå’Œ@RequestParamçš„åŒºåˆ«\"></a>@PathVariableå’Œ@RequestParamçš„åŒºåˆ«</h3><p>@PathVariable ä½œç”¨ï¼š ç”¨äºç»‘å®š url ä¸­çš„å ä½ç¬¦ã€‚ä¾‹å¦‚ï¼šè¯·æ±‚ url ä¸­ &#x2F;delete&#x2F;{id}ï¼Œè¿™ä¸ª{id}å°±æ˜¯ url å ä½ç¬¦ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">* æ ¹æ®path /anno/testPathVariable/10 æ‰¾åˆ° testPathVariable æ–¹æ³•</span></span><br><span class=\"line\"><span class=\"comment\">* ç„¶åï¼Œå…¶ä¸­çš„10å°±æ˜¯sidå ä½ç¬¦æ‰€å çš„ä½ç½®çš„æ•°æ®ï¼Œç„¶åé€šè¿‡<span class=\"doctag\">@PathVaribale</span>æ³¨è§£å°†å…¶èµ‹å€¼ç»™ id</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"meta\">@RequestMapping(path = &quot;testPathVariable/&#123;sid&#125;&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> String <span class=\"title function_\">testPathVariable</span><span class=\"params\">(<span class=\"meta\">@PathVariable(value = &quot;sid&quot;)</span> String id)</span> &#123;</span><br><span class=\"line\">    System.out.println(<span class=\"string\">&quot;æ‰§è¡Œäº†testPathVariable...&quot;</span>);</span><br><span class=\"line\">    System.out.println(id);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">&quot;success&quot;</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>@RequestParam ä½œç”¨ï¼š æŠŠè¯·æ±‚ä¸­æŒ‡å®šåç§°çš„å‚æ•°ç»™æ§åˆ¶å™¨ä¸­çš„å½¢å‚èµ‹å€¼ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Controllerä¸­çš„ä»£ç ï¼š</span></span><br><span class=\"line\"><span class=\"meta\">@RequestMapping(path = &quot;/testRequestParam&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> String <span class=\"title function_\">testRequestParam</span><span class=\"params\">(<span class=\"meta\">@RequestParam(value = &quot;name&quot;)</span> String username)</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// æŠŠè¯·æ±‚ä¸­æŒ‡å®šçš„nameèµ‹å€¼ç»™æ§åˆ¶å™¨ä¸­çš„å½¢å‚username</span></span><br><span class=\"line\">    System.out.println(<span class=\"string\">&quot;æ‰§è¡Œäº†testRequestParam...&quot;</span>);</span><br><span class=\"line\">    System.out.println(username);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">&quot;success&quot;</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"å…¶ä»–\"><a href=\"#å…¶ä»–\" class=\"headerlink\" title=\"å…¶ä»–\"></a>å…¶ä»–</h2><h3 id=\"Spring-MVCæ€ä¹ˆæ ·è®¾å®šè½¬å‘å’Œé‡å®šå‘çš„ï¼Ÿ\"><a href=\"#Spring-MVCæ€ä¹ˆæ ·è®¾å®šè½¬å‘å’Œé‡å®šå‘çš„ï¼Ÿ\" class=\"headerlink\" title=\"Spring MVCæ€ä¹ˆæ ·è®¾å®šè½¬å‘å’Œé‡å®šå‘çš„ï¼Ÿ\"></a>Spring MVCæ€ä¹ˆæ ·è®¾å®šè½¬å‘å’Œé‡å®šå‘çš„ï¼Ÿ</h3><p>ï¼ˆ1ï¼‰è½¬å‘ï¼šä½¿ç”¨ forward<br>forward æ˜¯æŒ‡å†…éƒ¨è½¬å‘ï¼Œç›¸å½“äºæœåŠ¡å™¨å†…éƒ¨æ–¹æ³•è·³è½¬è°ƒç”¨ã€‚è¯·æ±‚ä¸€æ¬¡æœåŠ¡å™¨ã€‚è½¬å‘åœ°å€ä¸å˜ã€‚</p>\n<p>ï¼ˆ2ï¼‰é‡å®šå‘ï¼šä½¿ç”¨ redirect<br>é‡å®šå‘æ˜¯æŒ‡å½“æµè§ˆå™¨è¯·æ±‚ä¸€ä¸ª URL æ—¶ï¼ŒæœåŠ¡å™¨è¿”å›ä¸€ä¸ªé‡å®šå‘æŒ‡ä»¤ï¼Œå‘Šè¯‰æµè§ˆå™¨åœ°å€å·²ç»å˜äº†ï¼Œéº»çƒ¦ä½¿ç”¨æ–°çš„ URL å†é‡æ–°å‘é€æ–°è¯·æ±‚ã€‚è¯·æ±‚ä¸¤æ¬¡æœåŠ¡å™¨ã€‚é‡å®šå‘åœ°å€æ”¹å˜ã€‚</p>\n<h3 id=\"Spring-MVCæ€ä¹ˆå’ŒAJAXç›¸äº’è°ƒç”¨çš„ï¼Ÿ\"><a href=\"#Spring-MVCæ€ä¹ˆå’ŒAJAXç›¸äº’è°ƒç”¨çš„ï¼Ÿ\" class=\"headerlink\" title=\"Spring MVCæ€ä¹ˆå’ŒAJAXç›¸äº’è°ƒç”¨çš„ï¼Ÿ\"></a>Spring MVCæ€ä¹ˆå’ŒAJAXç›¸äº’è°ƒç”¨çš„ï¼Ÿ</h3><p>é€šè¿‡ Jackson æˆ–è€…æ˜¯ fastjson å°±å¯ä»¥æŠŠ Java é‡Œé¢çš„å¯¹è±¡ç›´æ¥è½¬åŒ–æˆ Js å¯ä»¥è¯†åˆ«çš„ Json å¯¹è±¡ï¼Œæ¥è¿›è¡Œä¼ è¾“ã€‚</p>\n<h3 id=\"å¦‚ä½•è§£å†³POSTè¯·æ±‚ä¸­æ–‡ä¹±ç é—®é¢˜ï¼ŒGETçš„åˆå¦‚ä½•å¤„ç†å‘¢ï¼Ÿ\"><a href=\"#å¦‚ä½•è§£å†³POSTè¯·æ±‚ä¸­æ–‡ä¹±ç é—®é¢˜ï¼ŒGETçš„åˆå¦‚ä½•å¤„ç†å‘¢ï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•è§£å†³POSTè¯·æ±‚ä¸­æ–‡ä¹±ç é—®é¢˜ï¼ŒGETçš„åˆå¦‚ä½•å¤„ç†å‘¢ï¼Ÿ\"></a>å¦‚ä½•è§£å†³POSTè¯·æ±‚ä¸­æ–‡ä¹±ç é—®é¢˜ï¼ŒGETçš„åˆå¦‚ä½•å¤„ç†å‘¢ï¼Ÿ</h3><p>ï¼ˆ1ï¼‰è§£å†³ post è¯·æ±‚ä¹±ç é—®é¢˜ï¼š</p>\n<p>åœ¨ web.xml ä¸­é…ç½®ä¸€ä¸ª CharacterEncodingFilter è¿‡æ»¤å™¨ï¼Œè®¾ç½®æˆ utf-8ï¼›</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">filter</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">filter-name</span>&gt;</span>CharacterEncodingFilter<span class=\"tag\">&lt;/<span class=\"name\">filter-name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class=\"tag\">&lt;/<span class=\"name\">filter-class</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">init-param</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">param-name</span>&gt;</span>encoding<span class=\"tag\">&lt;/<span class=\"name\">param-name</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">param-value</span>&gt;</span>utf-8<span class=\"tag\">&lt;/<span class=\"name\">param-value</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">init-param</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">filter</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">filter-mapping</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">filter-name</span>&gt;</span>CharacterEncodingFilter<span class=\"tag\">&lt;/<span class=\"name\">filter-name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">url-pattern</span>&gt;</span>/*<span class=\"tag\">&lt;/<span class=\"name\">url-pattern</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰get è¯·æ±‚ä¸­æ–‡å‚æ•°å‡ºç°ä¹±ç è§£å†³æ–¹æ³•æœ‰ä¸¤ä¸ªï¼š</p>\n<p>ä¿®æ”¹ tomcat é…ç½®æ–‡ä»¶æ·»åŠ ç¼–ç ä¸å·¥ç¨‹ç¼–ç ä¸€è‡´ï¼Œå¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;ConnectorURIEncoding=&quot;utf-8&quot; connectionTimeout=&quot;20000&quot; port=&quot;8080&quot; protocol=&quot;HTTP/1.1&quot; redirectPort=&quot;8443&quot;/&gt;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Spring-MVCçš„å¼‚å¸¸å¤„ç†\"><a href=\"#Spring-MVCçš„å¼‚å¸¸å¤„ç†\" class=\"headerlink\" title=\"Spring MVCçš„å¼‚å¸¸å¤„ç†\"></a>Spring MVCçš„å¼‚å¸¸å¤„ç†</h3><p>å¯ä»¥å°†å¼‚å¸¸æŠ›ç»™ Spring æ¡†æ¶ï¼Œç”± Spring æ¡†æ¶æ¥å¤„ç†ï¼›æˆ‘ä»¬åªéœ€è¦é…ç½®ç®€å•çš„å¼‚å¸¸å¤„ç†å™¨ï¼Œåœ¨å¼‚å¸¸å¤„ç†å™¨ä¸­æ·»è§†å›¾é¡µé¢å³å¯ã€‚</p>\n<h3 id=\"å¦‚æœåœ¨æ‹¦æˆªè¯·æ±‚ä¸­ï¼Œæˆ‘æƒ³æ‹¦æˆªgetæ–¹å¼æäº¤çš„æ–¹æ³•-æ€ä¹ˆé…ç½®\"><a href=\"#å¦‚æœåœ¨æ‹¦æˆªè¯·æ±‚ä¸­ï¼Œæˆ‘æƒ³æ‹¦æˆªgetæ–¹å¼æäº¤çš„æ–¹æ³•-æ€ä¹ˆé…ç½®\" class=\"headerlink\" title=\"å¦‚æœåœ¨æ‹¦æˆªè¯·æ±‚ä¸­ï¼Œæˆ‘æƒ³æ‹¦æˆªgetæ–¹å¼æäº¤çš„æ–¹æ³•,æ€ä¹ˆé…ç½®\"></a>å¦‚æœåœ¨æ‹¦æˆªè¯·æ±‚ä¸­ï¼Œæˆ‘æƒ³æ‹¦æˆªgetæ–¹å¼æäº¤çš„æ–¹æ³•,æ€ä¹ˆé…ç½®</h3><p>ç­”ï¼šå¯ä»¥åœ¨@RequestMapping æ³¨è§£é‡Œé¢åŠ ä¸Š method&#x3D;RequestMethod.GETã€‚</p>\n<h3 id=\"æ€æ ·åœ¨æ–¹æ³•é‡Œé¢å¾—åˆ°Request-æˆ–è€…Sessionï¼Ÿ\"><a href=\"#æ€æ ·åœ¨æ–¹æ³•é‡Œé¢å¾—åˆ°Request-æˆ–è€…Sessionï¼Ÿ\" class=\"headerlink\" title=\"æ€æ ·åœ¨æ–¹æ³•é‡Œé¢å¾—åˆ°Request,æˆ–è€…Sessionï¼Ÿ\"></a>æ€æ ·åœ¨æ–¹æ³•é‡Œé¢å¾—åˆ°Request,æˆ–è€…Sessionï¼Ÿ</h3><p>ç­”ï¼šç›´æ¥åœ¨æ–¹æ³•çš„å½¢å‚ä¸­å£°æ˜ request,Spring MVC å°±è‡ªåŠ¨æŠŠ request å¯¹è±¡ä¼ å…¥ã€‚</p>\n<h3 id=\"å¦‚æœæƒ³åœ¨æ‹¦æˆªçš„æ–¹æ³•é‡Œé¢å¾—åˆ°ä»å‰å°ä¼ å…¥çš„å‚æ•°-æ€ä¹ˆå¾—åˆ°ï¼Ÿ\"><a href=\"#å¦‚æœæƒ³åœ¨æ‹¦æˆªçš„æ–¹æ³•é‡Œé¢å¾—åˆ°ä»å‰å°ä¼ å…¥çš„å‚æ•°-æ€ä¹ˆå¾—åˆ°ï¼Ÿ\" class=\"headerlink\" title=\"å¦‚æœæƒ³åœ¨æ‹¦æˆªçš„æ–¹æ³•é‡Œé¢å¾—åˆ°ä»å‰å°ä¼ å…¥çš„å‚æ•°,æ€ä¹ˆå¾—åˆ°ï¼Ÿ\"></a>å¦‚æœæƒ³åœ¨æ‹¦æˆªçš„æ–¹æ³•é‡Œé¢å¾—åˆ°ä»å‰å°ä¼ å…¥çš„å‚æ•°,æ€ä¹ˆå¾—åˆ°ï¼Ÿ</h3><p>ç›´æ¥åœ¨å½¢å‚é‡Œé¢å£°æ˜è¿™ä¸ªå‚æ•°å°±å¯ä»¥,ä½†å¿…é¡»åå­—å’Œä¼ è¿‡æ¥çš„å‚æ•°ä¸€æ ·ã€‚<br>æˆ–è€…ä½¿ç”¨ RequestParam æ³¨è§£å°†å‰å°çš„å‚æ•°å A ä¼ ç»™å½¢å‚ä¸­çš„å‚æ•° B</p>\n<h3 id=\"å¦‚æœå‰å°æœ‰å¾ˆå¤šä¸ªå‚æ•°ä¼ å…¥-å¹¶ä¸”è¿™äº›å‚æ•°éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡çš„-é‚£ä¹ˆæ€ä¹ˆæ ·å¿«é€Ÿå¾—åˆ°è¿™ä¸ªå¯¹è±¡ï¼Ÿ\"><a href=\"#å¦‚æœå‰å°æœ‰å¾ˆå¤šä¸ªå‚æ•°ä¼ å…¥-å¹¶ä¸”è¿™äº›å‚æ•°éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡çš„-é‚£ä¹ˆæ€ä¹ˆæ ·å¿«é€Ÿå¾—åˆ°è¿™ä¸ªå¯¹è±¡ï¼Ÿ\" class=\"headerlink\" title=\"å¦‚æœå‰å°æœ‰å¾ˆå¤šä¸ªå‚æ•°ä¼ å…¥,å¹¶ä¸”è¿™äº›å‚æ•°éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡çš„,é‚£ä¹ˆæ€ä¹ˆæ ·å¿«é€Ÿå¾—åˆ°è¿™ä¸ªå¯¹è±¡ï¼Ÿ\"></a>å¦‚æœå‰å°æœ‰å¾ˆå¤šä¸ªå‚æ•°ä¼ å…¥,å¹¶ä¸”è¿™äº›å‚æ•°éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡çš„,é‚£ä¹ˆæ€ä¹ˆæ ·å¿«é€Ÿå¾—åˆ°è¿™ä¸ªå¯¹è±¡ï¼Ÿ</h3><p>ç›´æ¥åœ¨æ–¹æ³•ä¸­å£°æ˜è¿™ä¸ªå¯¹è±¡,Spring MVC å°±è‡ªåŠ¨ä¼šæŠŠå±æ€§èµ‹å€¼åˆ°è¿™ä¸ªå¯¹è±¡é‡Œé¢ã€‚</p>\n<h3 id=\"Spring-MVCä¸­å‡½æ•°çš„è¿”å›å€¼æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#Spring-MVCä¸­å‡½æ•°çš„è¿”å›å€¼æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"Spring MVCä¸­å‡½æ•°çš„è¿”å›å€¼æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>Spring MVCä¸­å‡½æ•°çš„è¿”å›å€¼æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>è¿”å›å€¼å¯ä»¥æœ‰å¾ˆå¤šç±»å‹,æœ‰ String, ModelAndViewï¼ˆè§†å›¾å’Œæ•°æ®åˆå¹¶åœ¨ä¸€èµ·ï¼‰ã€‚</p>\n<h3 id=\"Spring-MVCç”¨ä»€ä¹ˆå¯¹è±¡ä»åå°å‘å‰å°ä¼ é€’æ•°æ®çš„ï¼Ÿ\"><a href=\"#Spring-MVCç”¨ä»€ä¹ˆå¯¹è±¡ä»åå°å‘å‰å°ä¼ é€’æ•°æ®çš„ï¼Ÿ\" class=\"headerlink\" title=\"Spring MVCç”¨ä»€ä¹ˆå¯¹è±¡ä»åå°å‘å‰å°ä¼ é€’æ•°æ®çš„ï¼Ÿ\"></a>Spring MVCç”¨ä»€ä¹ˆå¯¹è±¡ä»åå°å‘å‰å°ä¼ é€’æ•°æ®çš„ï¼Ÿ</h3><p>é€šè¿‡ ModelMap å¯¹è±¡,å¯ä»¥åœ¨è¿™ä¸ªå¯¹è±¡é‡Œé¢è°ƒç”¨ put æ–¹æ³•,æŠŠå¯¹è±¡åŠ åˆ°é‡Œé¢,å‰å°å°±å¯ä»¥é€šè¿‡ el è¡¨è¾¾å¼æ‹¿åˆ°ã€‚</p>\n<h3 id=\"æ€ä¹ˆæ ·æŠŠModelMapé‡Œé¢çš„æ•°æ®æ”¾å…¥Sessioné‡Œé¢ï¼Ÿ\"><a href=\"#æ€ä¹ˆæ ·æŠŠModelMapé‡Œé¢çš„æ•°æ®æ”¾å…¥Sessioné‡Œé¢ï¼Ÿ\" class=\"headerlink\" title=\"æ€ä¹ˆæ ·æŠŠModelMapé‡Œé¢çš„æ•°æ®æ”¾å…¥Sessioné‡Œé¢ï¼Ÿ\"></a>æ€ä¹ˆæ ·æŠŠModelMapé‡Œé¢çš„æ•°æ®æ”¾å…¥Sessioné‡Œé¢ï¼Ÿ</h3><p>å¯ä»¥åœ¨ç±»ä¸Šé¢åŠ ä¸Š@SessionAttributes æ³¨è§£,é‡Œé¢åŒ…å«çš„å­—ç¬¦ä¸²å°±æ˜¯è¦æ”¾å…¥ session é‡Œé¢çš„ keyã€‚</p>\n<h3 id=\"Spring-MVCé‡Œé¢æ‹¦æˆªå™¨æ˜¯æ€ä¹ˆå†™çš„\"><a href=\"#Spring-MVCé‡Œé¢æ‹¦æˆªå™¨æ˜¯æ€ä¹ˆå†™çš„\" class=\"headerlink\" title=\"Spring MVCé‡Œé¢æ‹¦æˆªå™¨æ˜¯æ€ä¹ˆå†™çš„\"></a>Spring MVCé‡Œé¢æ‹¦æˆªå™¨æ˜¯æ€ä¹ˆå†™çš„</h3><p>æœ‰ä¸¤ç§å†™æ³•,ä¸€ç§æ˜¯å®ç° HandlerInterceptor æ¥å£ï¼Œé‡å†™ prehandle ç­‰æ–¹æ³•ï¼Œç„¶åé…ç½®æ‹¦æˆªå™¨</p>\n","site":{"data":{}},"length":5011,"excerpt":"<blockquote>\n<p>æ•´ç†çš„SpringMVCç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½","more":"</p>\n</blockquote>\n<h2 id=\"æ¦‚è¿°\"><a href=\"#æ¦‚è¿°\" class=\"headerlink\" title=\"æ¦‚è¿°\"></a>æ¦‚è¿°</h2><h3 id=\"ä»€ä¹ˆæ˜¯Spring-MVCï¼Ÿç®€å•ä»‹ç»ä¸‹ä½ å¯¹Spring-MVCçš„ç†è§£ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯Spring-MVCï¼Ÿç®€å•ä»‹ç»ä¸‹ä½ å¯¹Spring-MVCçš„ç†è§£ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯Spring MVCï¼Ÿç®€å•ä»‹ç»ä¸‹ä½ å¯¹Spring MVCçš„ç†è§£ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯Spring MVCï¼Ÿç®€å•ä»‹ç»ä¸‹ä½ å¯¹Spring MVCçš„ç†è§£ï¼Ÿ</h3><p>Spring MVC æ˜¯ä¸€ä¸ªåŸºäº Java çš„å®ç°äº† MVC è®¾è®¡æ¨¡å¼çš„è¯·æ±‚é©±åŠ¨ç±»å‹çš„è½»é‡çº§ Web æ¡†æ¶ï¼Œé€šè¿‡æŠŠæ¨¡å‹-è§†å›¾-æ§åˆ¶å™¨åˆ†ç¦»ï¼Œå°† web å±‚è¿›è¡ŒèŒè´£è§£è€¦ï¼Œç®€åŒ–å¼€å‘ã€‚</p>\n<h2 id=\"æ ¸å¿ƒç»„ä»¶\"><a href=\"#æ ¸å¿ƒç»„ä»¶\" class=\"headerlink\" title=\"æ ¸å¿ƒç»„ä»¶\"></a>æ ¸å¿ƒç»„ä»¶</h2><h3 id=\"Spring-MVCçš„ä¸»è¦ç»„ä»¶ï¼Ÿ\"><a href=\"#Spring-MVCçš„ä¸»è¦ç»„ä»¶ï¼Ÿ\" class=\"headerlink\" title=\"Spring MVCçš„ä¸»è¦ç»„ä»¶ï¼Ÿ\"></a>Spring MVCçš„ä¸»è¦ç»„ä»¶ï¼Ÿ</h3><p>ï¼ˆ1ï¼‰å‰ç«¯æ§åˆ¶å™¨ DispatcherServletï¼ˆä¸éœ€è¦ç¨‹åºå‘˜å¼€å‘ï¼‰</p>\n<p>ä½œç”¨ï¼šæ¥æ”¶è¯·æ±‚ã€å“åº”ç»“æœï¼Œç›¸å½“äºè½¬å‘å™¨ï¼Œæœ‰äº† DispatcherServlet å°±å‡å°‘äº†å…¶å®ƒç»„ä»¶ä¹‹é—´çš„è€¦åˆåº¦ã€‚</p>\n<p>ï¼ˆ2ï¼‰å¤„ç†å™¨æ˜ å°„å™¨ HandlerMappingï¼ˆä¸éœ€è¦ç¨‹åºå‘˜å¼€å‘ï¼‰</p>\n<p>ä½œç”¨ï¼šæ ¹æ®è¯·æ±‚çš„ URL æ¥æŸ¥æ‰¾ Handler</p>\n<p>ï¼ˆ3ï¼‰å¤„ç†å™¨é€‚é…å™¨ HandlerAdapter</p>\n<p>æ³¨æ„ï¼šåœ¨ç¼–å†™ Handler çš„æ—¶å€™è¦æŒ‰ç…§ HandlerAdapter è¦æ±‚çš„è§„åˆ™å»ç¼–å†™ï¼Œè¿™æ ·é€‚é…å™¨ HandlerAdapter æ‰å¯ä»¥æ­£ç¡®çš„å»æ‰§è¡Œ Handlerã€‚</p>\n<p>ï¼ˆ4ï¼‰å¤„ç†å™¨ Handlerï¼ˆéœ€è¦ç¨‹åºå‘˜å¼€å‘ï¼‰</p>\n<p>ï¼ˆ5ï¼‰è§†å›¾è§£æå™¨ ViewResolverï¼ˆä¸éœ€è¦ç¨‹åºå‘˜å¼€å‘ï¼‰</p>\n<p>ä½œç”¨ï¼šè¿›è¡Œè§†å›¾çš„è§£æï¼Œæ ¹æ®è§†å›¾é€»è¾‘åè§£ææˆçœŸæ­£çš„è§†å›¾ï¼ˆviewï¼‰</p>\n<p>ï¼ˆ6ï¼‰è§†å›¾ Viewï¼ˆéœ€è¦ç¨‹åºå‘˜å¼€å‘ jspï¼‰</p>\n<p>View æ˜¯ä¸€ä¸ªæ¥å£ï¼Œ å®ƒçš„å®ç°ç±»æ”¯æŒä¸åŒçš„è§†å›¾ç±»å‹ï¼ˆjspï¼Œfreemarkerï¼Œpdf ç­‰ç­‰ï¼‰</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯DispatcherServlet\"><a href=\"#ä»€ä¹ˆæ˜¯DispatcherServlet\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯DispatcherServlet\"></a>ä»€ä¹ˆæ˜¯DispatcherServlet</h3><p>Spring çš„ MVC æ¡†æ¶æ˜¯å›´ç»• DispatcherServlet æ¥è®¾è®¡çš„ï¼Œå®ƒç”¨æ¥å¤„ç†æ‰€æœ‰çš„ HTTP è¯·æ±‚å’Œå“åº”ã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯Spring-MVCæ¡†æ¶çš„æ§åˆ¶å™¨ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯Spring-MVCæ¡†æ¶çš„æ§åˆ¶å™¨ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯Spring MVCæ¡†æ¶çš„æ§åˆ¶å™¨ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯Spring MVCæ¡†æ¶çš„æ§åˆ¶å™¨ï¼Ÿ</h3><p>æ§åˆ¶å™¨ä½¿ç”¨@Controller æ³¨è§£ï¼Œå¹¶ä¸”æä¾›äº†@RequestMapping æ³¨è§£ï¼Œé€šè¿‡è§£æ url ä¸­çš„è·¯å¾„ï¼Œå¯ä»¥æ‰¾åˆ°ç›¸åº”çš„æ§åˆ¶å™¨è¿›è¡Œé€»è¾‘å¤„ç†ï¼Œå“åº”æ•°æ®ç­‰ã€‚</p>\n<h3 id=\"Spring-MVCçš„æ§åˆ¶å™¨æ˜¯ä¸æ˜¯å•ä¾‹æ¨¡å¼-å¦‚æœæ˜¯-æœ‰ä»€ä¹ˆé—®é¢˜-æ€ä¹ˆè§£å†³ï¼Ÿ\"><a href=\"#Spring-MVCçš„æ§åˆ¶å™¨æ˜¯ä¸æ˜¯å•ä¾‹æ¨¡å¼-å¦‚æœæ˜¯-æœ‰ä»€ä¹ˆé—®é¢˜-æ€ä¹ˆè§£å†³ï¼Ÿ\" class=\"headerlink\" title=\"Spring MVCçš„æ§åˆ¶å™¨æ˜¯ä¸æ˜¯å•ä¾‹æ¨¡å¼,å¦‚æœæ˜¯,æœ‰ä»€ä¹ˆé—®é¢˜,æ€ä¹ˆè§£å†³ï¼Ÿ\"></a>Spring MVCçš„æ§åˆ¶å™¨æ˜¯ä¸æ˜¯å•ä¾‹æ¨¡å¼,å¦‚æœæ˜¯,æœ‰ä»€ä¹ˆé—®é¢˜,æ€ä¹ˆè§£å†³ï¼Ÿ</h3><p>å•ä¾‹æ¨¡å¼,æ‰€ä»¥åœ¨å¤šçº¿ç¨‹è®¿é—®çš„æ—¶å€™æœ‰çº¿ç¨‹å®‰å…¨é—®é¢˜,ä¸è¦ç”¨åŒæ­¥,ä¼šå½±å“æ€§èƒ½çš„ï¼Œè§£å†³æ–¹æ¡ˆæ˜¯åœ¨æ§åˆ¶å™¨ä¿æŒæ§åˆ¶å™¨æ— çŠ¶æ€ï¼ˆä¸è¦å†™å­—æ®µï¼‰ã€‚</p>\n<h2 id=\"å·¥ä½œåŸç†\"><a href=\"#å·¥ä½œåŸç†\" class=\"headerlink\" title=\"å·¥ä½œåŸç†\"></a>å·¥ä½œåŸç†</h2><h3 id=\"è¯·æè¿°Spring-MVCçš„å·¥ä½œæµç¨‹ï¼Ÿæè¿°ä¸€ä¸‹-DispatcherServlet-çš„å·¥ä½œæµç¨‹ï¼Ÿ\"><a href=\"#è¯·æè¿°Spring-MVCçš„å·¥ä½œæµç¨‹ï¼Ÿæè¿°ä¸€ä¸‹-DispatcherServlet-çš„å·¥ä½œæµç¨‹ï¼Ÿ\" class=\"headerlink\" title=\"è¯·æè¿°Spring MVCçš„å·¥ä½œæµç¨‹ï¼Ÿæè¿°ä¸€ä¸‹ DispatcherServlet çš„å·¥ä½œæµç¨‹ï¼Ÿ\"></a>è¯·æè¿°Spring MVCçš„å·¥ä½œæµç¨‹ï¼Ÿæè¿°ä¸€ä¸‹ DispatcherServlet çš„å·¥ä½œæµç¨‹ï¼Ÿ</h3><ol>\n<li>ç”¨æˆ·å‘é€è¯·æ±‚è‡³å‰ç«¯æ§åˆ¶å™¨ DispatcherServletï¼›</li>\n<li>DispatcherServlet æ”¶åˆ°è¯·æ±‚åï¼Œè°ƒç”¨ HandlerMapping å¤„ç†å™¨æ˜ å°„å™¨ï¼Œè¯·æ±‚è·å– Handlerï¼›</li>\n<li>HandlerMapping å¤„ç†å™¨æ˜ å°„å™¨æ ¹æ®è¯·æ±‚ url<strong>æ‰¾åˆ°å…·ä½“çš„å¤„ç†å™¨</strong>ï¼Œç”Ÿæˆå¤„ç†å™¨å¯¹è±¡åŠå¤„ç†å™¨æ‹¦æˆªå™¨(å¦‚æœæœ‰åˆ™ç”Ÿæˆ)ä¸€å¹¶è¿”å›ç»™ DispatcherServletï¼›</li>\n<li>DispatcherServlet è°ƒç”¨ HandlerAdapter å¤„ç†å™¨é€‚é…å™¨ï¼›</li>\n<li>HandlerAdapter ç»è¿‡é€‚é… <strong>è°ƒç”¨å…·ä½“å¤„ç†å™¨</strong>(Handlerï¼Œä¹Ÿå«åç«¯æ§åˆ¶å™¨)ï¼›</li>\n<li>Handler æ‰§è¡Œå®Œæˆè¿”å› ModelAndViewï¼›</li>\n<li>HandlerAdapter å°† Handler æ‰§è¡Œç»“æœ ModelAndView è¿”å›ç»™ DispatcherServletï¼›</li>\n<li>DispatcherServlet å°† ModelAndView ä¼ ç»™ ViewResolver è§†å›¾è§£æå™¨è¿›è¡Œè§£æï¼›</li>\n<li>ViewResolver è§£æåè¿”å›å…·ä½“ Viewï¼›</li>\n<li>DispatcherServlet å¯¹ View è¿›è¡Œæ¸²æŸ“æˆä¸ºè§†å›¾ï¼ˆå³å°†æ¨¡å‹æ•°æ®å¡«å……è‡³è§†å›¾ä¸­ï¼‰ï¼›</li>\n<li>DispatcherServlet å“åº”ç”¨æˆ·ã€‚</li>\n</ol>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes20200208211439106.png\" alt=\"Spring MVCçš„å·¥ä½œæµç¨‹\"></p>\n<h2 id=\"å¸¸ç”¨æ³¨è§£\"><a href=\"#å¸¸ç”¨æ³¨è§£\" class=\"headerlink\" title=\"å¸¸ç”¨æ³¨è§£\"></a>å¸¸ç”¨æ³¨è§£</h2><h3 id=\"æ³¨è§£åŸç†æ˜¯ä»€ä¹ˆ\"><a href=\"#æ³¨è§£åŸç†æ˜¯ä»€ä¹ˆ\" class=\"headerlink\" title=\"æ³¨è§£åŸç†æ˜¯ä»€ä¹ˆ\"></a>æ³¨è§£åŸç†æ˜¯ä»€ä¹ˆ</h3><p>æ³¨è§£æœ¬è´¨æ˜¯ä¸€ä¸ªç»§æ‰¿äº† Annotation çš„ç‰¹æ®Šæ¥å£ï¼Œå…¶å…·ä½“å®ç°ç±»æ˜¯ Java è¿è¡Œæ—¶ç”Ÿæˆçš„åŠ¨æ€ä»£ç†ç±»ã€‚æˆ‘ä»¬é€šè¿‡åå°„è·å–æ³¨è§£æ—¶ï¼Œè¿”å›çš„æ˜¯ Java è¿è¡Œæ—¶ç”Ÿæˆçš„åŠ¨æ€ä»£ç†å¯¹è±¡ã€‚é€šè¿‡ä»£ç†å¯¹è±¡è°ƒç”¨è‡ªå®šä¹‰æ³¨è§£çš„æ–¹æ³•ã€‚</p>\n<h3 id=\"Spring-MVCå¸¸ç”¨çš„æ³¨è§£æœ‰å“ªäº›ï¼Ÿ\"><a href=\"#Spring-MVCå¸¸ç”¨çš„æ³¨è§£æœ‰å“ªäº›ï¼Ÿ\" class=\"headerlink\" title=\"Spring MVCå¸¸ç”¨çš„æ³¨è§£æœ‰å“ªäº›ï¼Ÿ\"></a>Spring MVCå¸¸ç”¨çš„æ³¨è§£æœ‰å“ªäº›ï¼Ÿ</h3><p>@RequestMappingï¼šç”¨äºå¤„ç†è¯·æ±‚ url æ˜ å°„çš„æ³¨è§£ï¼Œå¯ç”¨äºç±»æˆ–æ–¹æ³•ä¸Šã€‚ç”¨äºç±»ä¸Šï¼Œåˆ™è¡¨ç¤ºç±»ä¸­çš„æ‰€æœ‰å“åº”è¯·æ±‚çš„æ–¹æ³•éƒ½æ˜¯ä»¥è¯¥åœ°å€ä½œä¸ºçˆ¶è·¯å¾„ã€‚</p>\n<p>@RequestBodyï¼šæ³¨è§£å®ç°æ¥æ”¶ http è¯·æ±‚çš„ json æ•°æ®ï¼Œå°† json è½¬æ¢ä¸º java å¯¹è±¡ã€‚</p>\n<p>@ResponseBodyï¼šæ³¨è§£å®ç°å°† controller æ–¹æ³•è¿”å›å¯¹è±¡è½¬åŒ–ä¸º json å¯¹è±¡å“åº”ç»™å®¢æˆ·ã€‚</p>\n<h3 id=\"Sping-MVCä¸­çš„æ§åˆ¶å™¨çš„æ³¨è§£ä¸€èˆ¬ç”¨å“ªä¸ª-æœ‰æ²¡æœ‰åˆ«çš„æ³¨è§£å¯ä»¥æ›¿ä»£ï¼Ÿ\"><a href=\"#Sping-MVCä¸­çš„æ§åˆ¶å™¨çš„æ³¨è§£ä¸€èˆ¬ç”¨å“ªä¸ª-æœ‰æ²¡æœ‰åˆ«çš„æ³¨è§£å¯ä»¥æ›¿ä»£ï¼Ÿ\" class=\"headerlink\" title=\"Sping MVCä¸­çš„æ§åˆ¶å™¨çš„æ³¨è§£ä¸€èˆ¬ç”¨å“ªä¸ª,æœ‰æ²¡æœ‰åˆ«çš„æ³¨è§£å¯ä»¥æ›¿ä»£ï¼Ÿ\"></a>Sping MVCä¸­çš„æ§åˆ¶å™¨çš„æ³¨è§£ä¸€èˆ¬ç”¨å“ªä¸ª,æœ‰æ²¡æœ‰åˆ«çš„æ³¨è§£å¯ä»¥æ›¿ä»£ï¼Ÿ</h3><p>ç­”ï¼šä¸€èˆ¬ç”¨@Controller æ³¨è§£ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨@RestControllerï¼Œ@RestController æ³¨è§£ç›¸å½“äº@ResponseBody ï¼‹ @Controllerï¼Œ@ResponseBody ç”¨äºè¿”å› json æ•°æ®ï¼‹ @Controller ç”¨äºè¡¨æ˜æ§åˆ¶å™¨</p>\n<h3 id=\"Controlleræ³¨è§£çš„ä½œç”¨\"><a href=\"#Controlleræ³¨è§£çš„ä½œç”¨\" class=\"headerlink\" title=\"@Controlleræ³¨è§£çš„ä½œç”¨\"></a>@Controlleræ³¨è§£çš„ä½œç”¨</h3><p>@Controller ç”¨äºæ ‡è®°åœ¨ä¸€ä¸ªç±»ä¸Šï¼Œä½¿ç”¨å®ƒæ ‡è®°çš„ç±»å°±æ˜¯ä¸€ä¸ª Spring MVC Controller å¯¹è±¡ã€‚é€šè¿‡è¯·æ±‚çš„ url å’Œ@RequestMapping æ³¨è§£å¯¹åº”åˆ°å®é™…å¤„ç†è¯·æ±‚çš„å¤„ç†å™¨ã€‚éœ€è¦å¼€å¯ mvc æ³¨è§£æ‰«ææ‰¾åˆ°@Controller çš„æ§åˆ¶å™¨ã€‚</p>\n<h3 id=\"RequestMappingæ³¨è§£çš„ä½œç”¨\"><a href=\"#RequestMappingæ³¨è§£çš„ä½œç”¨\" class=\"headerlink\" title=\"@RequestMappingæ³¨è§£çš„ä½œç”¨\"></a>@RequestMappingæ³¨è§£çš„ä½œç”¨</h3><p>RequestMapping æ˜¯ä¸€ä¸ªç”¨æ¥å¤„ç†è¯·æ±‚åœ°å€æ˜ å°„çš„æ³¨è§£ï¼Œå¯ç”¨äºç±»æˆ–æ–¹æ³•ä¸Šã€‚</p>\n<p>ç”¨äºç±»ä¸Šï¼Œè¡¨ç¤ºç±»ä¸­çš„æ‰€æœ‰å“åº”è¯·æ±‚çš„æ–¹æ³•éƒ½æ˜¯ä»¥è¯¥åœ°å€ä½œä¸ºçˆ¶è·¯å¾„ã€‚</p>\n<p>RequestMapping æ³¨è§£æœ‰å…­ä¸ªå±æ€§ï¼š</p>\n<p><strong>path&#x2F;valueï¼Œ method</strong></p>\n<ul>\n<li><p>valueï¼š æŒ‡å®šè¯·æ±‚çš„å®é™…åœ°å€ï¼ŒæŒ‡å®šçš„åœ°å€å¯ä»¥æ˜¯ URI Template æ¨¡å¼ï¼ˆåé¢å°†ä¼šè¯´æ˜ï¼‰ï¼›</p>\n</li>\n<li><p>methodï¼š æŒ‡å®šè¯·æ±‚çš„ method ç±»å‹ï¼Œ GETã€POSTã€PUTã€DELETE ç­‰ï¼›</p>\n</li>\n</ul>\n<p><strong>consumesï¼Œproduces</strong></p>\n<ul>\n<li><p>consumesï¼š æŒ‡å®šå¤„ç†è¯·æ±‚çš„æäº¤å†…å®¹ç±»å‹ï¼ˆContent-Typeï¼‰ï¼Œä¾‹å¦‚ application&#x2F;json, text&#x2F;html;</p>\n</li>\n<li><p>produces: æŒ‡å®šè¿”å›çš„å†…å®¹ç±»å‹ï¼Œä»…å½“ request è¯·æ±‚å¤´ä¸­çš„(Accept)ç±»å‹ä¸­åŒ…å«è¯¥æŒ‡å®šç±»å‹æ‰è¿”å›ï¼›</p>\n</li>\n</ul>\n<p><strong>paramsï¼Œheaders</strong></p>\n<ul>\n<li><p>paramsï¼š æŒ‡å®š request ä¸­å¿…é¡»åŒ…å«æŸäº›å‚æ•°å€¼æ—¶ï¼Œæ‰è®©è¯¥æ–¹æ³•å¤„ç†ã€‚</p>\n</li>\n<li><p>headersï¼š æŒ‡å®š request ä¸­å¿…é¡»åŒ…å«æŸäº›æŒ‡å®šçš„ header å€¼ï¼Œæ‰èƒ½è®©è¯¥æ–¹æ³•å¤„ç†è¯·æ±‚ã€‚</p>\n</li>\n</ul>\n<h3 id=\"PathVariableå’Œ-RequestParamçš„åŒºåˆ«\"><a href=\"#PathVariableå’Œ-RequestParamçš„åŒºåˆ«\" class=\"headerlink\" title=\"@PathVariableå’Œ@RequestParamçš„åŒºåˆ«\"></a>@PathVariableå’Œ@RequestParamçš„åŒºåˆ«</h3><p>@PathVariable ä½œç”¨ï¼š ç”¨äºç»‘å®š url ä¸­çš„å ä½ç¬¦ã€‚ä¾‹å¦‚ï¼šè¯·æ±‚ url ä¸­ &#x2F;delete&#x2F;{id}ï¼Œè¿™ä¸ª{id}å°±æ˜¯ url å ä½ç¬¦ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">* æ ¹æ®path /anno/testPathVariable/10 æ‰¾åˆ° testPathVariable æ–¹æ³•</span></span><br><span class=\"line\"><span class=\"comment\">* ç„¶åï¼Œå…¶ä¸­çš„10å°±æ˜¯sidå ä½ç¬¦æ‰€å çš„ä½ç½®çš„æ•°æ®ï¼Œç„¶åé€šè¿‡<span class=\"doctag\">@PathVaribale</span>æ³¨è§£å°†å…¶èµ‹å€¼ç»™ id</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"meta\">@RequestMapping(path = &quot;testPathVariable/&#123;sid&#125;&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> String <span class=\"title function_\">testPathVariable</span><span class=\"params\">(<span class=\"meta\">@PathVariable(value = &quot;sid&quot;)</span> String id)</span> &#123;</span><br><span class=\"line\">    System.out.println(<span class=\"string\">&quot;æ‰§è¡Œäº†testPathVariable...&quot;</span>);</span><br><span class=\"line\">    System.out.println(id);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">&quot;success&quot;</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>@RequestParam ä½œç”¨ï¼š æŠŠè¯·æ±‚ä¸­æŒ‡å®šåç§°çš„å‚æ•°ç»™æ§åˆ¶å™¨ä¸­çš„å½¢å‚èµ‹å€¼ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Controllerä¸­çš„ä»£ç ï¼š</span></span><br><span class=\"line\"><span class=\"meta\">@RequestMapping(path = &quot;/testRequestParam&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> String <span class=\"title function_\">testRequestParam</span><span class=\"params\">(<span class=\"meta\">@RequestParam(value = &quot;name&quot;)</span> String username)</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// æŠŠè¯·æ±‚ä¸­æŒ‡å®šçš„nameèµ‹å€¼ç»™æ§åˆ¶å™¨ä¸­çš„å½¢å‚username</span></span><br><span class=\"line\">    System.out.println(<span class=\"string\">&quot;æ‰§è¡Œäº†testRequestParam...&quot;</span>);</span><br><span class=\"line\">    System.out.println(username);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">&quot;success&quot;</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"å…¶ä»–\"><a href=\"#å…¶ä»–\" class=\"headerlink\" title=\"å…¶ä»–\"></a>å…¶ä»–</h2><h3 id=\"Spring-MVCæ€ä¹ˆæ ·è®¾å®šè½¬å‘å’Œé‡å®šå‘çš„ï¼Ÿ\"><a href=\"#Spring-MVCæ€ä¹ˆæ ·è®¾å®šè½¬å‘å’Œé‡å®šå‘çš„ï¼Ÿ\" class=\"headerlink\" title=\"Spring MVCæ€ä¹ˆæ ·è®¾å®šè½¬å‘å’Œé‡å®šå‘çš„ï¼Ÿ\"></a>Spring MVCæ€ä¹ˆæ ·è®¾å®šè½¬å‘å’Œé‡å®šå‘çš„ï¼Ÿ</h3><p>ï¼ˆ1ï¼‰è½¬å‘ï¼šä½¿ç”¨ forward<br>forward æ˜¯æŒ‡å†…éƒ¨è½¬å‘ï¼Œç›¸å½“äºæœåŠ¡å™¨å†…éƒ¨æ–¹æ³•è·³è½¬è°ƒç”¨ã€‚è¯·æ±‚ä¸€æ¬¡æœåŠ¡å™¨ã€‚è½¬å‘åœ°å€ä¸å˜ã€‚</p>\n<p>ï¼ˆ2ï¼‰é‡å®šå‘ï¼šä½¿ç”¨ redirect<br>é‡å®šå‘æ˜¯æŒ‡å½“æµè§ˆå™¨è¯·æ±‚ä¸€ä¸ª URL æ—¶ï¼ŒæœåŠ¡å™¨è¿”å›ä¸€ä¸ªé‡å®šå‘æŒ‡ä»¤ï¼Œå‘Šè¯‰æµè§ˆå™¨åœ°å€å·²ç»å˜äº†ï¼Œéº»çƒ¦ä½¿ç”¨æ–°çš„ URL å†é‡æ–°å‘é€æ–°è¯·æ±‚ã€‚è¯·æ±‚ä¸¤æ¬¡æœåŠ¡å™¨ã€‚é‡å®šå‘åœ°å€æ”¹å˜ã€‚</p>\n<h3 id=\"Spring-MVCæ€ä¹ˆå’ŒAJAXç›¸äº’è°ƒç”¨çš„ï¼Ÿ\"><a href=\"#Spring-MVCæ€ä¹ˆå’ŒAJAXç›¸äº’è°ƒç”¨çš„ï¼Ÿ\" class=\"headerlink\" title=\"Spring MVCæ€ä¹ˆå’ŒAJAXç›¸äº’è°ƒç”¨çš„ï¼Ÿ\"></a>Spring MVCæ€ä¹ˆå’ŒAJAXç›¸äº’è°ƒç”¨çš„ï¼Ÿ</h3><p>é€šè¿‡ Jackson æˆ–è€…æ˜¯ fastjson å°±å¯ä»¥æŠŠ Java é‡Œé¢çš„å¯¹è±¡ç›´æ¥è½¬åŒ–æˆ Js å¯ä»¥è¯†åˆ«çš„ Json å¯¹è±¡ï¼Œæ¥è¿›è¡Œä¼ è¾“ã€‚</p>\n<h3 id=\"å¦‚ä½•è§£å†³POSTè¯·æ±‚ä¸­æ–‡ä¹±ç é—®é¢˜ï¼ŒGETçš„åˆå¦‚ä½•å¤„ç†å‘¢ï¼Ÿ\"><a href=\"#å¦‚ä½•è§£å†³POSTè¯·æ±‚ä¸­æ–‡ä¹±ç é—®é¢˜ï¼ŒGETçš„åˆå¦‚ä½•å¤„ç†å‘¢ï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•è§£å†³POSTè¯·æ±‚ä¸­æ–‡ä¹±ç é—®é¢˜ï¼ŒGETçš„åˆå¦‚ä½•å¤„ç†å‘¢ï¼Ÿ\"></a>å¦‚ä½•è§£å†³POSTè¯·æ±‚ä¸­æ–‡ä¹±ç é—®é¢˜ï¼ŒGETçš„åˆå¦‚ä½•å¤„ç†å‘¢ï¼Ÿ</h3><p>ï¼ˆ1ï¼‰è§£å†³ post è¯·æ±‚ä¹±ç é—®é¢˜ï¼š</p>\n<p>åœ¨ web.xml ä¸­é…ç½®ä¸€ä¸ª CharacterEncodingFilter è¿‡æ»¤å™¨ï¼Œè®¾ç½®æˆ utf-8ï¼›</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">filter</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">filter-name</span>&gt;</span>CharacterEncodingFilter<span class=\"tag\">&lt;/<span class=\"name\">filter-name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class=\"tag\">&lt;/<span class=\"name\">filter-class</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">init-param</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">param-name</span>&gt;</span>encoding<span class=\"tag\">&lt;/<span class=\"name\">param-name</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">param-value</span>&gt;</span>utf-8<span class=\"tag\">&lt;/<span class=\"name\">param-value</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">init-param</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">filter</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">filter-mapping</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">filter-name</span>&gt;</span>CharacterEncodingFilter<span class=\"tag\">&lt;/<span class=\"name\">filter-name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">url-pattern</span>&gt;</span>/*<span class=\"tag\">&lt;/<span class=\"name\">url-pattern</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰get è¯·æ±‚ä¸­æ–‡å‚æ•°å‡ºç°ä¹±ç è§£å†³æ–¹æ³•æœ‰ä¸¤ä¸ªï¼š</p>\n<p>ä¿®æ”¹ tomcat é…ç½®æ–‡ä»¶æ·»åŠ ç¼–ç ä¸å·¥ç¨‹ç¼–ç ä¸€è‡´ï¼Œå¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;ConnectorURIEncoding=&quot;utf-8&quot; connectionTimeout=&quot;20000&quot; port=&quot;8080&quot; protocol=&quot;HTTP/1.1&quot; redirectPort=&quot;8443&quot;/&gt;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Spring-MVCçš„å¼‚å¸¸å¤„ç†\"><a href=\"#Spring-MVCçš„å¼‚å¸¸å¤„ç†\" class=\"headerlink\" title=\"Spring MVCçš„å¼‚å¸¸å¤„ç†\"></a>Spring MVCçš„å¼‚å¸¸å¤„ç†</h3><p>å¯ä»¥å°†å¼‚å¸¸æŠ›ç»™ Spring æ¡†æ¶ï¼Œç”± Spring æ¡†æ¶æ¥å¤„ç†ï¼›æˆ‘ä»¬åªéœ€è¦é…ç½®ç®€å•çš„å¼‚å¸¸å¤„ç†å™¨ï¼Œåœ¨å¼‚å¸¸å¤„ç†å™¨ä¸­æ·»è§†å›¾é¡µé¢å³å¯ã€‚</p>\n<h3 id=\"å¦‚æœåœ¨æ‹¦æˆªè¯·æ±‚ä¸­ï¼Œæˆ‘æƒ³æ‹¦æˆªgetæ–¹å¼æäº¤çš„æ–¹æ³•-æ€ä¹ˆé…ç½®\"><a href=\"#å¦‚æœåœ¨æ‹¦æˆªè¯·æ±‚ä¸­ï¼Œæˆ‘æƒ³æ‹¦æˆªgetæ–¹å¼æäº¤çš„æ–¹æ³•-æ€ä¹ˆé…ç½®\" class=\"headerlink\" title=\"å¦‚æœåœ¨æ‹¦æˆªè¯·æ±‚ä¸­ï¼Œæˆ‘æƒ³æ‹¦æˆªgetæ–¹å¼æäº¤çš„æ–¹æ³•,æ€ä¹ˆé…ç½®\"></a>å¦‚æœåœ¨æ‹¦æˆªè¯·æ±‚ä¸­ï¼Œæˆ‘æƒ³æ‹¦æˆªgetæ–¹å¼æäº¤çš„æ–¹æ³•,æ€ä¹ˆé…ç½®</h3><p>ç­”ï¼šå¯ä»¥åœ¨@RequestMapping æ³¨è§£é‡Œé¢åŠ ä¸Š method&#x3D;RequestMethod.GETã€‚</p>\n<h3 id=\"æ€æ ·åœ¨æ–¹æ³•é‡Œé¢å¾—åˆ°Request-æˆ–è€…Sessionï¼Ÿ\"><a href=\"#æ€æ ·åœ¨æ–¹æ³•é‡Œé¢å¾—åˆ°Request-æˆ–è€…Sessionï¼Ÿ\" class=\"headerlink\" title=\"æ€æ ·åœ¨æ–¹æ³•é‡Œé¢å¾—åˆ°Request,æˆ–è€…Sessionï¼Ÿ\"></a>æ€æ ·åœ¨æ–¹æ³•é‡Œé¢å¾—åˆ°Request,æˆ–è€…Sessionï¼Ÿ</h3><p>ç­”ï¼šç›´æ¥åœ¨æ–¹æ³•çš„å½¢å‚ä¸­å£°æ˜ request,Spring MVC å°±è‡ªåŠ¨æŠŠ request å¯¹è±¡ä¼ å…¥ã€‚</p>\n<h3 id=\"å¦‚æœæƒ³åœ¨æ‹¦æˆªçš„æ–¹æ³•é‡Œé¢å¾—åˆ°ä»å‰å°ä¼ å…¥çš„å‚æ•°-æ€ä¹ˆå¾—åˆ°ï¼Ÿ\"><a href=\"#å¦‚æœæƒ³åœ¨æ‹¦æˆªçš„æ–¹æ³•é‡Œé¢å¾—åˆ°ä»å‰å°ä¼ å…¥çš„å‚æ•°-æ€ä¹ˆå¾—åˆ°ï¼Ÿ\" class=\"headerlink\" title=\"å¦‚æœæƒ³åœ¨æ‹¦æˆªçš„æ–¹æ³•é‡Œé¢å¾—åˆ°ä»å‰å°ä¼ å…¥çš„å‚æ•°,æ€ä¹ˆå¾—åˆ°ï¼Ÿ\"></a>å¦‚æœæƒ³åœ¨æ‹¦æˆªçš„æ–¹æ³•é‡Œé¢å¾—åˆ°ä»å‰å°ä¼ å…¥çš„å‚æ•°,æ€ä¹ˆå¾—åˆ°ï¼Ÿ</h3><p>ç›´æ¥åœ¨å½¢å‚é‡Œé¢å£°æ˜è¿™ä¸ªå‚æ•°å°±å¯ä»¥,ä½†å¿…é¡»åå­—å’Œä¼ è¿‡æ¥çš„å‚æ•°ä¸€æ ·ã€‚<br>æˆ–è€…ä½¿ç”¨ RequestParam æ³¨è§£å°†å‰å°çš„å‚æ•°å A ä¼ ç»™å½¢å‚ä¸­çš„å‚æ•° B</p>\n<h3 id=\"å¦‚æœå‰å°æœ‰å¾ˆå¤šä¸ªå‚æ•°ä¼ å…¥-å¹¶ä¸”è¿™äº›å‚æ•°éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡çš„-é‚£ä¹ˆæ€ä¹ˆæ ·å¿«é€Ÿå¾—åˆ°è¿™ä¸ªå¯¹è±¡ï¼Ÿ\"><a href=\"#å¦‚æœå‰å°æœ‰å¾ˆå¤šä¸ªå‚æ•°ä¼ å…¥-å¹¶ä¸”è¿™äº›å‚æ•°éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡çš„-é‚£ä¹ˆæ€ä¹ˆæ ·å¿«é€Ÿå¾—åˆ°è¿™ä¸ªå¯¹è±¡ï¼Ÿ\" class=\"headerlink\" title=\"å¦‚æœå‰å°æœ‰å¾ˆå¤šä¸ªå‚æ•°ä¼ å…¥,å¹¶ä¸”è¿™äº›å‚æ•°éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡çš„,é‚£ä¹ˆæ€ä¹ˆæ ·å¿«é€Ÿå¾—åˆ°è¿™ä¸ªå¯¹è±¡ï¼Ÿ\"></a>å¦‚æœå‰å°æœ‰å¾ˆå¤šä¸ªå‚æ•°ä¼ å…¥,å¹¶ä¸”è¿™äº›å‚æ•°éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡çš„,é‚£ä¹ˆæ€ä¹ˆæ ·å¿«é€Ÿå¾—åˆ°è¿™ä¸ªå¯¹è±¡ï¼Ÿ</h3><p>ç›´æ¥åœ¨æ–¹æ³•ä¸­å£°æ˜è¿™ä¸ªå¯¹è±¡,Spring MVC å°±è‡ªåŠ¨ä¼šæŠŠå±æ€§èµ‹å€¼åˆ°è¿™ä¸ªå¯¹è±¡é‡Œé¢ã€‚</p>\n<h3 id=\"Spring-MVCä¸­å‡½æ•°çš„è¿”å›å€¼æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#Spring-MVCä¸­å‡½æ•°çš„è¿”å›å€¼æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"Spring MVCä¸­å‡½æ•°çš„è¿”å›å€¼æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>Spring MVCä¸­å‡½æ•°çš„è¿”å›å€¼æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>è¿”å›å€¼å¯ä»¥æœ‰å¾ˆå¤šç±»å‹,æœ‰ String, ModelAndViewï¼ˆè§†å›¾å’Œæ•°æ®åˆå¹¶åœ¨ä¸€èµ·ï¼‰ã€‚</p>\n<h3 id=\"Spring-MVCç”¨ä»€ä¹ˆå¯¹è±¡ä»åå°å‘å‰å°ä¼ é€’æ•°æ®çš„ï¼Ÿ\"><a href=\"#Spring-MVCç”¨ä»€ä¹ˆå¯¹è±¡ä»åå°å‘å‰å°ä¼ é€’æ•°æ®çš„ï¼Ÿ\" class=\"headerlink\" title=\"Spring MVCç”¨ä»€ä¹ˆå¯¹è±¡ä»åå°å‘å‰å°ä¼ é€’æ•°æ®çš„ï¼Ÿ\"></a>Spring MVCç”¨ä»€ä¹ˆå¯¹è±¡ä»åå°å‘å‰å°ä¼ é€’æ•°æ®çš„ï¼Ÿ</h3><p>é€šè¿‡ ModelMap å¯¹è±¡,å¯ä»¥åœ¨è¿™ä¸ªå¯¹è±¡é‡Œé¢è°ƒç”¨ put æ–¹æ³•,æŠŠå¯¹è±¡åŠ åˆ°é‡Œé¢,å‰å°å°±å¯ä»¥é€šè¿‡ el è¡¨è¾¾å¼æ‹¿åˆ°ã€‚</p>\n<h3 id=\"æ€ä¹ˆæ ·æŠŠModelMapé‡Œé¢çš„æ•°æ®æ”¾å…¥Sessioné‡Œé¢ï¼Ÿ\"><a href=\"#æ€ä¹ˆæ ·æŠŠModelMapé‡Œé¢çš„æ•°æ®æ”¾å…¥Sessioné‡Œé¢ï¼Ÿ\" class=\"headerlink\" title=\"æ€ä¹ˆæ ·æŠŠModelMapé‡Œé¢çš„æ•°æ®æ”¾å…¥Sessioné‡Œé¢ï¼Ÿ\"></a>æ€ä¹ˆæ ·æŠŠModelMapé‡Œé¢çš„æ•°æ®æ”¾å…¥Sessioné‡Œé¢ï¼Ÿ</h3><p>å¯ä»¥åœ¨ç±»ä¸Šé¢åŠ ä¸Š@SessionAttributes æ³¨è§£,é‡Œé¢åŒ…å«çš„å­—ç¬¦ä¸²å°±æ˜¯è¦æ”¾å…¥ session é‡Œé¢çš„ keyã€‚</p>\n<h3 id=\"Spring-MVCé‡Œé¢æ‹¦æˆªå™¨æ˜¯æ€ä¹ˆå†™çš„\"><a href=\"#Spring-MVCé‡Œé¢æ‹¦æˆªå™¨æ˜¯æ€ä¹ˆå†™çš„\" class=\"headerlink\" title=\"Spring MVCé‡Œé¢æ‹¦æˆªå™¨æ˜¯æ€ä¹ˆå†™çš„\"></a>Spring MVCé‡Œé¢æ‹¦æˆªå™¨æ˜¯æ€ä¹ˆå†™çš„</h3><p>æœ‰ä¸¤ç§å†™æ³•,ä¸€ç§æ˜¯å®ç° HandlerInterceptor æ¥å£ï¼Œé‡å†™ prehandle ç­‰æ–¹æ³•ï¼Œç„¶åé…ç½®æ‹¦æˆªå™¨</p>"},{"title":"Javaå…«è‚¡æ–‡ - Spring","copyright":true,"mathjax":false,"date":"2023-01-23T08:14:06.000Z","toc":true,"urlname":"java-spring","_content":"\n> æ•´ç†çš„Springæ¡†æ¶ç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½\t<!--more-->\n\n## Springæ¦‚è¿°\n\n### ä»€ä¹ˆæ˜¯spring?\n\nSpring æ˜¯**ä¸€ä¸ªè½»é‡çº§Javaå¼€å‘æ¡†æ¶**ï¼Œç›®çš„æ˜¯ä¸ºäº†è§£å†³å¼€å‘ä¸­çš„**ä¸šåŠ¡é€»è¾‘å±‚å’Œå…¶ä»–å„å±‚çš„è€¦åˆé—®é¢˜**ï¼Œç®€åŒ– Java å¼€å‘ã€‚\n\n### Springæ¡†æ¶çš„æ ¸å¿ƒæ˜¯ä»€ä¹ˆ\n\n**Springæ¡†æ¶çš„æ ¸å¿ƒ**ï¼šIoC å®¹å™¨å’Œ AOP æ¨¡å—ã€‚\né€šè¿‡ IoC å®¹å™¨ç®¡ç† Java Bean å¯¹è±¡åŠå…¶ç”Ÿå‘½å‘¨æœŸä»¥åŠä»–ä»¬ä¹‹é—´çš„è€¦åˆå…³ç³»ï¼›\né€šè¿‡ AOP å°†ä¸€äº›å…¬å…±è¡Œä¸ºå’Œé€»è¾‘ï¼ŒæŠ½å–å¹¶å°è£…ä¸ºä¸€ä¸ªå¯é‡ç”¨çš„æ¨¡å—ï¼Œå‡å°‘ç³»ç»Ÿä¸­çš„é‡å¤ä»£ç ï¼Œé™ä½æ¨¡å—é—´çš„è€¦åˆåº¦\n\n### Springçš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ\n\nä¼˜ç‚¹\n\n- æ–¹ä¾¿è§£è€¦ï¼Œç®€åŒ–å¼€å‘ï¼ˆ**IoC**ï¼‰\n\n\tSpring å°±æ˜¯ä¸€ä¸ªå¤§å·¥å‚ï¼Œå¯ä»¥å°†æ‰€æœ‰å¯¹è±¡çš„åˆ›å»ºå’Œä¾èµ–å…³ç³»çš„ç»´æŠ¤ï¼Œäº¤ç»™ Spring ç®¡ç†ã€‚\n\n- AOP ç¼–ç¨‹çš„æ”¯æŒï¼ˆ**AOP**ï¼‰\n\n\tSpring æä¾›é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œå¯ä»¥æ–¹ä¾¿çš„å®ç°å¯¹ç¨‹åºè¿›è¡Œæƒé™æ‹¦æˆªã€è¿è¡Œç›‘æ§ç­‰åŠŸèƒ½ã€‚\n\n- å£°æ˜å¼äº‹åŠ¡çš„æ”¯æŒï¼ˆ**äº‹åŠ¡**ï¼‰\n\n\tåªéœ€è¦é€šè¿‡é…ç½®å°±å¯ä»¥å®Œæˆå¯¹äº‹åŠ¡çš„ç®¡ç†ï¼Œè€Œæ— éœ€æ‰‹åŠ¨ç¼–ç¨‹ã€‚\n\n- æ–¹ä¾¿é›†æˆå„ç§ä¼˜ç§€æ¡†æ¶ï¼ˆ**é›†æˆ**ï¼‰\n\n\tSpring ä¸æ’æ–¥å„ç§ä¼˜ç§€çš„å¼€æºæ¡†æ¶ï¼Œå…¶å†…éƒ¨æä¾›äº†å¯¹å„ç§ä¼˜ç§€æ¡†æ¶çš„ç›´æ¥æ”¯æŒï¼ˆå¦‚ï¼šStrutsã€Hibernateã€MyBatis ç­‰ï¼‰ã€‚\n\n\nç¼ºç‚¹\n\n- Spring**ä¾èµ–åå°„ï¼Œåå°„å½±å“æ€§èƒ½**\n\n### Spring æ¡†æ¶ä¸­éƒ½ç”¨åˆ°äº†å“ªäº›è®¾è®¡æ¨¡å¼ï¼Ÿ\n\n1. å·¥å‚æ¨¡å¼ï¼šé€šè¿‡ BeanFactory å’Œ ApplicationContext æ¥ç®¡ç† Bean å¯¹è±¡ã€‚\n2. å•ä¾‹æ¨¡å¼ï¼šBean é»˜è®¤ä¸ºå•ä¾‹æ¨¡å¼ã€‚\n3. ä»£ç†æ¨¡å¼ï¼šSpring çš„ AOP åŠŸèƒ½ç”¨åˆ°äº†åŸºäºæ¥å£çš„ JDK çš„åŠ¨æ€ä»£ç†å’ŒåŸºäºå­ç±»çš„ CGLIB åŠ¨æ€ä»£ç†ï¼›\n\n### Springæ¡†æ¶ä¸­æœ‰å“ªäº›ä¸åŒç±»å‹çš„äº‹ä»¶\n\n**Springçš„ApplicationContext æä¾›äº†æ”¯æŒäº‹ä»¶å’Œä»£ç ä¸­ç›‘å¬å™¨çš„åŠŸèƒ½ã€‚**  \n\nå¦‚æœä¸€ä¸ª bean å®ç°äº†`ApplicationListener`æ¥å£ï¼Œå½“ä¸€ä¸ª`ApplicationEvent` è¢«å‘å¸ƒä»¥åï¼Œbean ä¼šè‡ªåŠ¨è¢«é€šçŸ¥ã€‚\n\n```javascript\npublic class AllApplicationEventListener implements ApplicationListener < ApplicationEvent >{\n    @Override\n    public void onApplicationEvent(ApplicationEvent applicationEvent){\n        //process event\n    }\n}\n```\n\n**Spring æä¾›äº†ä»¥ä¸‹5ç§æ ‡å‡†çš„äº‹ä»¶ï¼š**\n\n- ä¸Šä¸‹æ–‡æ›´æ–°äº‹ä»¶ï¼ˆContextRefreshedEventï¼‰ï¼šè¯¥äº‹ä»¶ä¼šåœ¨ ApplicationContext è¢«åˆå§‹åŒ–æˆ–è€…æ›´æ–°æ—¶å‘å¸ƒã€‚ä¹Ÿå¯ä»¥åœ¨è°ƒç”¨`ConfigurableApplicationContext` æ¥å£ä¸­çš„`refresh()`æ–¹æ³•æ—¶è¢«è§¦å‘ã€‚\n- ä¸Šä¸‹æ–‡å¼€å§‹äº‹ä»¶ï¼ˆContextStartedEventï¼‰ï¼šå½“å®¹å™¨è°ƒç”¨`ConfigurableApplicationContext`çš„`Start()`æ–¹æ³•å¼€å§‹/é‡æ–°å¼€å§‹å®¹å™¨æ—¶è§¦å‘è¯¥äº‹ä»¶ã€‚\n- ä¸Šä¸‹æ–‡åœæ­¢äº‹ä»¶ï¼ˆContextStoppedEventï¼‰ï¼šå½“å®¹å™¨è°ƒç”¨`ConfigurableApplicationContext`çš„`Stop()`æ–¹æ³•åœæ­¢å®¹å™¨æ—¶è§¦å‘è¯¥äº‹ä»¶ã€‚\n- ä¸Šä¸‹æ–‡å…³é—­äº‹ä»¶ï¼ˆContextClosedEventï¼‰ï¼šå½“`ApplicationContext`è¢«å…³é—­æ—¶è§¦å‘è¯¥äº‹ä»¶ã€‚å®¹å™¨è¢«å…³é—­æ—¶ï¼Œå…¶ç®¡ç†çš„æ‰€æœ‰å•ä¾‹ Bean éƒ½è¢«é”€æ¯ã€‚\n- è¯·æ±‚å¤„ç†äº‹ä»¶ï¼ˆRequestHandledEventï¼‰ï¼šåœ¨ Web åº”ç”¨ä¸­ï¼Œå½“ä¸€ä¸ª http è¯·æ±‚ï¼ˆrequestï¼‰ç»“æŸè§¦å‘è¯¥äº‹ä»¶ã€‚\n\n### Spring åº”ç”¨ç¨‹åºæœ‰å“ªäº›ä¸åŒç»„ä»¶ï¼Ÿ\n\nSpring åº”ç”¨ä¸€èˆ¬æœ‰ä»¥ä¸‹ç»„ä»¶ï¼š\n\n- Bean ç±» - å®ƒåŒ…å«å±æ€§ï¼Œsetter å’Œ getter æ–¹æ³•ï¼Œå‡½æ•°ç­‰ã€‚\n- Bean é…ç½®æ–‡ä»¶ - åŒ…å«ç±»çš„ä¿¡æ¯ä»¥åŠå¦‚ä½•é…ç½®å®ƒä»¬ã€‚\n- æ¥å£ - å¤„ç† Bean \n- ç”¨æˆ·ç¨‹åº - å®ƒä½¿ç”¨æ¥å£ã€‚\n\n## Springæ§åˆ¶åè½¬(IOC)\n\n### ä»€ä¹ˆæ˜¯Spring IOC å®¹å™¨ï¼Ÿ\n\nSpring IOCï¼ˆæ§åˆ¶åè½¬ï¼‰ æŠŠç»„ä»¶å¯¹è±¡æ§åˆ¶æƒäº¤ç»™å®¹å™¨ï¼Œå®¹å™¨è´Ÿè´£åˆ›å»ºå¯¹è±¡ï¼Œé…ç½®å¯¹è±¡ï¼ˆé€šè¿‡ä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰ï¼Œå¹¶ä¸”ç®¡ç†è¿™äº›å¯¹è±¡çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸã€‚IoC è®©ç›¸äº’åä½œçš„ç»„ä»¶ä¿æŒæ¾è€¦åˆã€‚\n\n### Spring IoC çš„å®ç°æœºåˆ¶\n\nSpring ä¸­çš„ IoC çš„å®ç°åŸç†å°±æ˜¯**å·¥å‚æ¨¡å¼åŠ åå°„**ã€‚\n\n```java\ninterface Fruit {\n    void eat();\n}\n\nclass Apple implements Fruit {\n    public void eat(){\n        System.out.println(\"Apple\");\n    }\n}\n\nclass Orange implements Fruit {\n    public void eat(){\n        System.out.println(\"Orange\");\n    }\n}\n\nclass Factory {\n    public static Fruit getInstance(String className) {\t// ä½¿ç”¨åå°„ï¼Œç”¨å­—ç¬¦ä¸²è·å–åˆ°å®ä¾‹\n        Fruit f=null;\n        try {\n            f = (Fruit) Class.forName(className).newInstance();\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n        return f;\n    }\n}\n\nclass Client {\n    public static void main(String[] a) {\n        Fruit f = Factory.getInstance(\"io.github.dunwu.spring.Apple\");\n        if(f != null){\n            f.eat();\n        }\n    }\n}\n```\n\n### BeanFactory å’Œ ApplicationContextæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\nBeanFactory å’Œ ApplicationContext æ˜¯ Spring çš„ä¸¤å¤§æ ¸å¿ƒæ¥å£ï¼Œéƒ½å¯ä»¥å½“åš Spring çš„å®¹å™¨ã€‚\nApplicationContext æ˜¯ BeanFactory çš„å­æ¥å£ã€‚\n\n1. ä¾èµ–å…³ç³»\n\nBeanFactoryï¼šæ˜¯ Spring é‡Œé¢æœ€åº•å±‚çš„æ¥å£ï¼ŒåŒ…å«äº†å„ç§ Bean çš„å®šä¹‰ï¼Œè¯»å– bean é…ç½®æ–‡æ¡£ï¼Œç®¡ç† bean çš„åŠ è½½ã€å®ä¾‹åŒ–ï¼Œæ§åˆ¶ bean çš„ç”Ÿå‘½å‘¨æœŸï¼Œç»´æŠ¤ bean ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚\n\nApplicationContext æ¥å£ä½œä¸º BeanFactory çš„å­æ¥å£ï¼Œé™¤äº†æä¾› BeanFactory æ‰€å…·æœ‰çš„åŠŸèƒ½å¤–ï¼Œè¿˜æä¾›äº†æ›´å®Œæ•´çš„æ¡†æ¶åŠŸèƒ½ï¼š\n\n- æ”¯æŒå›½é™…åŒ–ã€‚\n- æ”¯æŒè®¿é—®æ–‡ä»¶èµ„æº\n- æ”¯æŒäº‹ä»¶å‘å¸ƒé€šçŸ¥\n- åŒæ—¶åŠ è½½å¤šä¸ªé…ç½®æ–‡ä»¶ã€‚\n\né…ç½®æµç¨‹ï¼š\n\n1. åŠ è½½é…ç½®æ–‡ä»¶ï¼Œè§£ææˆ BeanDefinition æ”¾åœ¨ Map é‡Œï¼Œmap ä¸­å­˜æ”¾`<BeanNameï¼ŒClasså¯¹è±¡>`çš„æ˜ å°„\n2. è°ƒç”¨ getBean çš„æ—¶å€™ï¼Œä» BeanDefinition æ‰€å±çš„ Map é‡Œï¼Œæ‹¿å‡º Class å¯¹è±¡ä½¿ç”¨åå°„è¿›è¡Œå®ä¾‹åŒ–ï¼ŒåŒæ—¶ï¼Œå¦‚æœæœ‰ä¾èµ–å…³ç³»ï¼Œå°†é€’å½’è°ƒç”¨ getBean æ–¹æ³• â€”â€” å®Œæˆä¾èµ–æ³¨å…¥ã€‚\n3. åŠ è½½æ–¹å¼\n\n**BeanFactroy**é‡‡ç”¨çš„æ˜¯**å»¶è¿ŸåŠ è½½**å½¢å¼æ¥æ³¨å…¥ Bean çš„ï¼Œå³åªæœ‰åœ¨ä½¿ç”¨åˆ°æŸä¸ª Bean æ—¶(è°ƒç”¨ getBean())ï¼Œæ‰å¯¹è¯¥ Bean è¿›è¡ŒåŠ è½½å®ä¾‹åŒ–ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±ä¸èƒ½å‘ç°ä¸€äº›å­˜åœ¨çš„ Spring çš„é…ç½®é—®é¢˜ã€‚å¦‚æœ Bean çš„æŸä¸€ä¸ªå±æ€§æ²¡æœ‰æ³¨å…¥æˆ–è€…æ˜¯å±æ€§æ³¨å…¥é”™è¯¯ï¼ŒBeanFacotry åŠ è½½åï¼Œç›´è‡³ç¬¬ä¸€æ¬¡ä½¿ç”¨è°ƒç”¨ getBean æ–¹æ³•æ‰ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚\n\n**ApplicationContext**ï¼Œå®ƒæ˜¯åœ¨å®¹å™¨å¯åŠ¨æ—¶ï¼Œ**ä¸€æ¬¡æ€§åˆ›å»º**äº†æ‰€æœ‰çš„ Beanã€‚è¿™æ ·ï¼Œåœ¨å®¹å™¨å¯åŠ¨æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥**å‘ç°Springä¸­å­˜åœ¨çš„é…ç½®é”™è¯¯**ï¼Œè¿™æ ·æœ‰åˆ©äºæ£€æŸ¥æ‰€ä¾èµ–å±æ€§æ˜¯å¦æ³¨å…¥ã€‚ ApplicationContext å¯åŠ¨åé¢„è½½å…¥æ‰€æœ‰çš„å•å®ä¾‹ Beanï¼Œé€šè¿‡é¢„è½½å…¥å•å®ä¾‹ bean ,ç¡®ä¿å½“ä½ éœ€è¦çš„æ—¶å€™ï¼Œä½ å°±ä¸ç”¨ç­‰å¾…ï¼Œå› ä¸ºå®ƒä»¬å·²ç»åˆ›å»ºå¥½äº†ã€‚\n\nç”±äºåœ¨å®¹å™¨å¯åŠ¨æ—¶ä¸€æ¬¡æ€§åˆ›å»ºæ‰€æœ‰çš„ Beanï¼Œå› æ­¤ ApplicationContext æ›´åŠ å ç”¨å†…å­˜ç©ºé—´ï¼Œå½“é…ç½®çš„ Bean æ¯”è¾ƒå¤šæ—¶ï¼Œç¨‹åºå¯åŠ¨è¾ƒæ…¢ã€‚\n\n#### â­BeanFactoryå’ŒFactoryBeanåŒºåˆ«ï¼Ÿ\n\nBeanFactoryï¼šæ˜¯ spring IoC å®¹å™¨çš„åº•å±‚æ¥å£ï¼Œå¯ä»¥ç”¨æ¥ç®¡ç† bean åŠå…¶ç”Ÿå‘½å‘¨æœŸï¼›\n\nFactoryBeanï¼šå¦‚æœæŸä¸ª bean å®ç°äº† FactoryBean è¿™ä¸ªæ¥å£ï¼Œé€šè¿‡ getBean æ–¹æ³•æ¥è·å– bean çš„æ—¶å€™ï¼Œå¹¶ä¸æ˜¯è¿”å›è‡ªå·±çš„å®ä¾‹ï¼Œè€Œæ˜¯è¿”å›å…¶ getObject() æ–¹æ³•çš„è¿”å›å€¼\n\n### ApplicationContexté€šå¸¸çš„å®ç°æ˜¯ä»€ä¹ˆï¼Ÿ\n\n**FileSystemXmlApplicationContext** ï¼šæ­¤å®¹å™¨ä»ä¸€ä¸ª XML æ–‡ä»¶ä¸­åŠ è½½ beans çš„å®šä¹‰ï¼ŒXML Bean é…ç½®æ–‡ä»¶çš„å…¨è·¯å¾„åå¿…é¡»æä¾›ç»™å®ƒçš„æ„é€ å‡½æ•°ã€‚\n\n**ClassPathXmlApplicationContext**ï¼šæ­¤å®¹å™¨ä¹Ÿä»ä¸€ä¸ª XML æ–‡ä»¶ä¸­åŠ è½½ beans çš„å®šä¹‰ï¼Œè¿™é‡Œï¼Œä½ éœ€è¦æ­£ç¡®è®¾ç½® classpath å› ä¸ºè¿™ä¸ªå®¹å™¨å°†åœ¨ classpath é‡Œæ‰¾ bean é…ç½®ã€‚\n\n**AnnotationConfigApplicationContext**ï¼šå®ƒæ˜¯ç”¨äºè¯»å–æ³¨è§£åˆ›å»ºå®¹å™¨çš„\n\n### ä»€ä¹ˆæ˜¯Springçš„ä¾èµ–æ³¨å…¥ï¼Ÿ\n\nå…·ä½“å«ä¹‰æ˜¯:å½“æŸä¸ªè°ƒç”¨è€…éœ€è¦å¦ä¸€ä¸ªè¢«è°ƒç”¨è€…çš„ååŠ©æ—¶ï¼Œåœ¨ ä¼ ç»Ÿçš„ç¨‹åºè®¾è®¡è¿‡ç¨‹ä¸­ï¼Œé€šå¸¸ç”±è°ƒç”¨è€…æ¥åˆ›å»ºè¢«è°ƒç”¨è€…çš„å®ä¾‹ã€‚ä½†åœ¨ Spring é‡Œï¼Œåˆ›å»ºè¢«è°ƒç”¨è€…çš„å·¥ä½œä¸å†ç”±è°ƒç”¨è€…æ¥å®Œæˆï¼Œå› æ­¤ç§°ä¸ºæ§åˆ¶åè½¬ï¼›åˆ›å»ºè¢«è°ƒç”¨è€… å®ä¾‹çš„å·¥ä½œé€šå¸¸ç”± Spring å®¹å™¨æ¥å®Œæˆï¼Œç„¶åæ³¨å…¥è°ƒç”¨è€…ï¼Œå› æ­¤ä¹Ÿç§°ä¸ºä¾èµ–æ³¨å…¥ã€‚\n\n### ä¾èµ–æ³¨å…¥æœ‰ä»€ä¹ˆä¼˜åŠ¿\n\nä¾èµ–æ³¨å…¥ä¹‹æ‰€ä»¥æ›´æµè¡Œæ˜¯å› ä¸ºå®ƒæ˜¯ä¸€ç§æ›´å¯å–çš„æ–¹å¼ï¼šè®©å®¹å™¨å…¨æƒè´Ÿè´£ä¾èµ–æŸ¥è¯¢ï¼Œå—ç®¡ç»„ä»¶åªéœ€è¦æš´éœ² JavaBean çš„ setter æ–¹æ³•æˆ–è€…å¸¦å‚æ•°çš„æ„é€ å™¨æˆ–è€…æ¥å£ï¼Œä½¿å®¹å™¨å¯ä»¥åœ¨åˆå§‹åŒ–æ—¶ç»„è£…å¯¹è±¡çš„ä¾èµ–å…³ç³»ã€‚å…¶ä¸ä¾èµ–æŸ¥æ‰¾æ–¹å¼ç›¸æ¯”ï¼Œä¸»è¦ä¼˜åŠ¿ä¸ºï¼š\n\n- æŸ¥æ‰¾å®šä½æ“ä½œä¸åº”ç”¨ä»£ç å®Œå…¨æ— å…³ã€‚\n- ä¸ä¾èµ–äºå®¹å™¨çš„ APIï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°åœ¨ä»»ä½•å®¹å™¨ä»¥å¤–ä½¿ç”¨åº”ç”¨å¯¹è±¡ã€‚\n- ä¸éœ€è¦ç‰¹æ®Šçš„æ¥å£ï¼Œç»å¤§å¤šæ•°å¯¹è±¡å¯ä»¥åšåˆ°å®Œå…¨ä¸å¿…ä¾èµ–å®¹å™¨ã€‚\n\n### æœ‰å“ªäº›ä¸åŒç±»å‹çš„ä¾èµ–æ³¨å…¥å®ç°æ–¹å¼ï¼Ÿ\n\n**æ„é€ å™¨ä¾èµ–æ³¨å…¥**ï¼šæ„é€ å™¨ä¾èµ–æ³¨å…¥é€šè¿‡å®¹å™¨è§¦å‘ä¸€ä¸ªç±»çš„æ„é€ å™¨æ¥å®ç°çš„ï¼Œè¯¥ç±»æœ‰ä¸€ç³»åˆ—å‚æ•°ï¼Œæ¯ä¸ªå‚æ•°ä»£è¡¨ä¸€ä¸ªå¯¹å…¶ä»–ç±»çš„ä¾èµ–ã€‚\n\n**Setteræ–¹æ³•æ³¨å…¥**ï¼šSetter æ–¹æ³•æ³¨å…¥æ˜¯å®¹å™¨é€šè¿‡è°ƒç”¨æ— å‚æ„é€ å™¨æˆ–æ— å‚ static å·¥å‚ æ–¹æ³•å®ä¾‹åŒ– bean ä¹‹åï¼Œè°ƒç”¨è¯¥ bean çš„ setter æ–¹æ³•ï¼Œå³å®ç°äº†åŸºäº setter çš„ä¾èµ–æ³¨å…¥ã€‚\n\n### æ„é€ å™¨ä¾èµ–æ³¨å…¥å’Œ setteræ–¹æ³•æ³¨å…¥çš„åŒºåˆ«\n\nï¼ˆéƒ¨åˆ†æ³¨å…¥ï¼‰åœ¨ setter æ³¨å…¥,å¯ä»¥å°†ä¾èµ–é¡¹éƒ¨åˆ†æ³¨å…¥,æ„é€ æ–¹æ³•æ³¨å…¥ä¸èƒ½éƒ¨åˆ†æ³¨å…¥ã€‚\n\nï¼ˆå±æ€§è¦†ç›–ï¼‰å¦‚æœæˆ‘ä»¬ä¸ºåŒä¸€å±æ€§æä¾› setter å’Œæ„é€ æ–¹æ³•æ³¨å…¥ï¼Œsetter æ³¨å…¥å°†è¦†ç›–æ„é€ æ–¹æ³•æ³¨å…¥ã€‚ä½†æ˜¯æ„é€ æ–¹æ³•æ³¨å…¥ä¸èƒ½è¦†ç›– setter æ³¨å…¥å€¼ã€‚æ˜¾ç„¶ï¼Œæ„é€ æ–¹æ³•æ³¨å…¥è¢«ç§°ä¸ºåˆ›å»ºå®ä¾‹çš„ç¬¬ä¸€é€‰é¡¹ã€‚\n\nï¼ˆå¾ªç¯ä¾èµ–ï¼‰åœ¨æ„é€ å‡½æ•°æ³¨å…¥,å¦‚æœ A å’Œ B å¯¹è±¡ç›¸äº’ä¾èµ–ï¼šA ä¾èµ–äº B,B ä¹Ÿä¾èµ–äº A,æ­¤æ—¶åœ¨åˆ›å»ºå¯¹è±¡çš„ A æˆ–è€… B æ—¶ï¼ŒSpring æŠ›å‡º ObjectCurrentlyInCreationExceptionã€‚æ‰€ä»¥ Spring å¯ä»¥é€šè¿‡ setter æ³¨å…¥,ä»è€Œè§£å†³å¾ªç¯ä¾èµ–çš„é—®é¢˜ã€‚\n\n**æœ€å¥½çš„è§£å†³æ–¹æ¡ˆæ˜¯ç”¨æ„é€ å™¨å‚æ•°å®ç°å¼ºåˆ¶ä¾èµ–ï¼Œsetteræ–¹æ³•å®ç°å¯é€‰ä¾èµ–**\n\n### è®²ä¸€è®²Springä¸­çš„å¾ªç¯ä¾èµ–\n\nhttps://www.cnblogs.com/daimzh/p/13256413.html\n\nhttps://blog.csdn.net/weixin_49592546/article/details/108050566\n\n#### ä»€ä¹ˆæ˜¯å¾ªç¯ä¾èµ–ï¼Ÿ\n\n```java\n@Component\npublic class A {\n    // Aä¸­æ³¨å…¥äº†B\n\t@Autowired\n\tprivate B b;\n}\n\n@Component\npublic class B {\n    // Bä¸­ä¹Ÿæ³¨å…¥äº†A\n\t@Autowired\n\tprivate A a;\n}\n```\n\n#### Springæ˜¯å¦‚ä½•è§£å†³çš„å¾ªç¯ä¾èµ–ï¼Ÿ\n\n> ä»¥ä¸‹ï¼š\n>\n> ä½œè€…ï¼šé˜¿é‡Œäº‘äº‘æ –å·\n>\n> é“¾æ¥ï¼šhttps://zhuanlan.zhihu.com/p/368769721\n>\n> æ¥æºï¼šçŸ¥ä¹\n>\n> è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚\n\né¦–å…ˆï¼ŒSpring è§£å†³å¾ªç¯ä¾èµ–æœ‰ä¸¤ä¸ªå‰ææ¡ä»¶ï¼š\n\n1. ä¸å…¨æ˜¯æ„é€ å™¨æ–¹å¼çš„å¾ªç¯ä¾èµ–\n2. å¿…é¡»æ˜¯å•ä¾‹\n\nåŸºäºä¸Šé¢çš„é—®é¢˜ï¼Œæˆ‘ä»¬çŸ¥é“ Bean çš„ç”Ÿå‘½å‘¨æœŸï¼Œæœ¬è´¨ä¸Šè§£å†³å¾ªç¯ä¾èµ–çš„é—®é¢˜å°±æ˜¯ä¸‰çº§ç¼“å­˜ï¼Œé€šè¿‡ä¸‰çº§ç¼“å­˜æå‰æ‹¿åˆ°æœªåˆå§‹åŒ–å®Œå…¨çš„å¯¹è±¡ã€‚\n\n```java\n/** Cache of singleton objects: bean name to bean instance. */\nprivate final Map<String, Object> singletonObjects = new ConcurrentHashMap<>(256);\n/** Cache of early singleton objects: bean name to bean instance. */\nprivate final Map<String, Object> earlySingletonObjects = new HashMap<>(16);\n/** Cache of singleton factories: bean name to ObjectFactory. */\nprivate final Map<String, ObjectFactory<?>> singletonFactories = new HashMap<>(16);\n```\n\nç¬¬ä¸€çº§ç¼“å­˜ï¼šç”¨æ¥ä¿å­˜å®ä¾‹åŒ–ã€åˆå§‹åŒ–éƒ½å®Œæˆçš„å¯¹è±¡\n\nç¬¬äºŒçº§ç¼“å­˜ï¼šç”¨æ¥ä¿å­˜å®ä¾‹åŒ–å®Œæˆï¼Œä½†æ˜¯æœªåˆå§‹åŒ–å®Œæˆçš„å¯¹è±¡\n\nç¬¬ä¸‰çº§ç¼“å­˜ï¼šç”¨æ¥ä¿å­˜ä¸€ä¸ªå¯¹è±¡å·¥å‚ï¼Œæä¾›ä¸€ä¸ªåŒ¿åå†…éƒ¨ç±»ï¼Œç”¨äºåˆ›å»ºäºŒçº§ç¼“å­˜ä¸­çš„å¯¹è±¡\n\n![Springä¸‰çº§ç¼“å­˜](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesv2-dbda6a103e41cde4a54548386d6c1cc2_720w.jpg)\n\nå‡è®¾ä¸€ä¸ªç®€å•çš„å¾ªç¯ä¾èµ–åœºæ™¯ï¼ŒAã€B äº’ç›¸ä¾èµ–ã€‚\n\n![ç®€å•çš„å¾ªç¯ä¾èµ–åœºæ™¯](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesv2-f20f1e81c8011fd99f723127cacf7430_720w.jpg)\n\nA å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹ï¼š\n\n1. åˆ›å»ºå¯¹è±¡ Aï¼Œå®ä¾‹åŒ–çš„æ—¶å€™æŠŠ A å¯¹è±¡å·¥å‚æ”¾å…¥ä¸‰çº§ç¼“å­˜ï¼›\n\n![å®ä¾‹åŒ–å¯¹è±¡A](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesv2-b295374aff4235ee9c0538bf03856217_720w.jpg)\n\n\n\n2. A æ³¨å…¥å±æ€§æ—¶ï¼Œå‘ç°ä¾èµ– Bï¼Œè½¬è€Œå»å®ä¾‹åŒ– B\n\n3. åŒæ ·åˆ›å»ºå¯¹è±¡ Bï¼Œæ³¨å…¥å±æ€§æ—¶å‘ç°ä¾èµ– Aï¼Œä¾æ¬¡ä»ä¸€çº§åˆ°ä¸‰çº§ç¼“å­˜æŸ¥è¯¢ Aï¼Œä»ä¸‰çº§ç¼“å­˜é€šè¿‡å¯¹è±¡å·¥å‚æ‹¿åˆ° Aï¼ŒæŠŠ A æ”¾å…¥äºŒçº§ç¼“å­˜ï¼ŒåŒæ—¶åˆ é™¤ä¸‰çº§ç¼“å­˜ä¸­çš„ Aï¼Œæ­¤æ—¶ï¼ŒB å·²ç»å®ä¾‹åŒ–å¹¶ä¸”åˆå§‹åŒ–å®Œæˆï¼ŒæŠŠ B æ”¾å…¥ä¸€çº§ç¼“å­˜ã€‚\n\n![åˆ›å»ºå¯¹è±¡B](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesv2-51cb735fc6c02c2225d2f38b9b5b6da9_720w.jpg)\n\n4. æ¥ç€ç»§ç»­åˆ›å»º Aï¼Œé¡ºåˆ©ä»ä¸€çº§ç¼“å­˜æ‹¿åˆ°å®ä¾‹åŒ–ä¸”åˆå§‹åŒ–å®Œæˆçš„ B å¯¹è±¡ï¼ŒA å¯¹è±¡åˆ›å»ºä¹Ÿå®Œæˆï¼Œåˆ é™¤äºŒçº§ç¼“å­˜ä¸­çš„ Aï¼ŒåŒæ—¶æŠŠ A æ”¾å…¥ä¸€çº§ç¼“å­˜\n\n5. æœ€åï¼Œä¸€çº§ç¼“å­˜ä¸­ä¿å­˜ç€å®ä¾‹åŒ–ã€åˆå§‹åŒ–éƒ½å®Œæˆçš„ Aã€B å¯¹è±¡\n\n![æœ€ç»ˆç»“æœ](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesv2-a1eaa5d9f8bec23e373dc1b9f86ddb25_720w.jpg)\n\nå› æ­¤ï¼Œç”±äºæŠŠå®ä¾‹åŒ–å’Œåˆå§‹åŒ–çš„æµç¨‹åˆ†å¼€äº†ï¼Œæ‰€ä»¥å¦‚æœéƒ½æ˜¯ç”¨æ„é€ å™¨çš„è¯ï¼Œå°±æ²¡æ³•åˆ†ç¦»è¿™ä¸ªæ“ä½œï¼Œæ‰€ä»¥éƒ½æ˜¯æ„é€ å™¨çš„è¯å°±æ— æ³•è§£å†³å¾ªç¯ä¾èµ–çš„é—®é¢˜äº†ã€‚\n\n### 8. ä¸ºä»€ä¹ˆè¦ä¸‰çº§ç¼“å­˜ï¼ŸäºŒçº§ä¸è¡Œå—ï¼Ÿ\n\nä¸å¯ä»¥ï¼Œä¸»è¦æ˜¯ä¸ºäº†ç”Ÿæˆä»£ç†å¯¹è±¡ã€‚\n\nå› ä¸ºä¸‰çº§ç¼“å­˜ä¸­æ”¾çš„æ˜¯ç”Ÿæˆå…·ä½“å¯¹è±¡çš„å¯¹è±¡å·¥å‚ï¼Œä»–å¯ä»¥ç”Ÿæˆä»£ç†å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥æ˜¯æ™®é€šçš„å®ä¾‹å¯¹è±¡ã€‚\n\nå‡è®¾åªæœ‰äºŒçº§ç¼“å­˜çš„æƒ…å†µï¼Œå¾€äºŒçº§ç¼“å­˜ä¸­æ”¾çš„æ˜¾ç¤ºä¸€ä¸ªæ™®é€šçš„ Bean å¯¹è±¡ï¼Œ`BeanPostProcessor`å»ç”Ÿæˆä»£ç†å¯¹è±¡ä¹‹åï¼Œè¦†ç›–æ‰äºŒçº§ç¼“å­˜ä¸­çš„æ™®é€š Bean å¯¹è±¡ï¼Œé‚£ä¹ˆå¤šçº¿ç¨‹ç¯å¢ƒä¸‹å¯èƒ½å–åˆ°çš„å¯¹è±¡å°±ä¸ä¸€è‡´äº†ã€‚\n\n![Aä»£ç†å¯¹è±¡è¦†ç›–Aæ™®é€šBean](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesv2-e4e9050787017c7272dc313f88af9382_720w.jpg)\n\n\n\n## Spring Beans\n\n### å¦‚ä½•ç»™Spring å®¹å™¨æä¾›é…ç½®å…ƒæ•°æ®ï¼ŸSpringæœ‰å‡ ç§é…ç½®æ–¹å¼\n\nè¿™é‡Œæœ‰ä¸‰ç§é‡è¦çš„æ–¹æ³•ç»™ Spring å®¹å™¨æä¾›é…ç½®å…ƒæ•°æ®ã€‚\n\n- XML é…ç½®æ–‡ä»¶ã€‚\n- åŸºäºæ³¨è§£çš„é…ç½®ã€‚\n- åŸºäº Java çš„é…ç½®ã€‚\n\n### Springé…ç½®æ–‡ä»¶åŒ…å«äº†å“ªäº›ä¿¡æ¯\n\nSpring é…ç½®æ–‡ä»¶æ˜¯ä¸ª XML æ–‡ä»¶ï¼Œé€šè¿‡è¯»å–æŒ‡å®šç±»çš„å…¨é™å®šç±»åã€‚åå°„åˆ›å»ºå¯¹è±¡ï¼Œä¸¢å…¥ ioc å®¹å™¨ä¸­ï¼Œè¯¥å¯¹è±¡å¯ä»¥é€šè¿‡ id æ¥è·å–\n\n### SpringåŸºäºxmlæ³¨å…¥beançš„å‡ ç§æ–¹å¼\n\n1. Set æ–¹æ³•æ³¨å…¥ï¼š`<property name=\"xxx\" value=\"yyy\"/>`\n2. æ„é€ å™¨æ³¨å…¥ï¼š`<construtor-arg type/index/name=\"xxx\" value=\"yyy\"/>`\n3. é™æ€å·¥å‚æ³¨å…¥ï¼›factory-bean factory-method\n4. å®ä¾‹å·¥å‚ï¼› class factory-method\n\n### è§£é‡ŠSpringæ”¯æŒçš„å‡ ç§beançš„ä½œç”¨åŸŸ\n\nSpring æ¡†æ¶æ”¯æŒä»¥ä¸‹äº”ç§ bean çš„ä½œç”¨åŸŸï¼š\n\n- **singleton :** bean åœ¨æ¯ä¸ª Spring ioc å®¹å™¨ä¸­åªæœ‰ä¸€ä¸ªå®ä¾‹ã€‚\n- **prototype**ï¼šä¸€ä¸ª bean çš„å®šä¹‰å¯ä»¥æœ‰å¤šä¸ªå®ä¾‹ã€‚\n- **request**ï¼šæ¯æ¬¡ http è¯·æ±‚éƒ½ä¼šåˆ›å»ºä¸€ä¸ª beanï¼Œè¯¥ä½œç”¨åŸŸä»…åœ¨åŸºäº web çš„ Spring ApplicationContext æƒ…å½¢ä¸‹æœ‰æ•ˆã€‚\n- **session**ï¼šåœ¨ä¸€ä¸ª HTTP Session ä¸­ï¼Œä¸€ä¸ª bean å®šä¹‰å¯¹åº”ä¸€ä¸ªå®ä¾‹ã€‚è¯¥ä½œç”¨åŸŸä»…åœ¨åŸºäº web çš„ Spring ApplicationContext æƒ…å½¢ä¸‹æœ‰æ•ˆã€‚\n- **global-session**ï¼šåœ¨ä¸€ä¸ªå…¨å±€çš„ HTTP Session ä¸­ï¼Œä¸€ä¸ª bean å®šä¹‰å¯¹åº”ä¸€ä¸ªå®ä¾‹ã€‚è¯¥ä½œç”¨åŸŸä»…åœ¨åŸºäº web çš„ Spring ApplicationContext æƒ…å½¢ä¸‹æœ‰æ•ˆã€‚\n\n**æ³¨æ„ï¼š** ç¼ºçœçš„ Spring bean çš„ä½œç”¨åŸŸæ˜¯ singletonã€‚ä½¿ç”¨ prototype ä½œç”¨åŸŸéœ€è¦æ…é‡çš„æ€è€ƒï¼Œå› ä¸ºé¢‘ç¹åˆ›å»ºå’Œé”€æ¯ bean ä¼šå¸¦æ¥å¾ˆå¤§çš„æ€§èƒ½å¼€é”€ã€‚\n\n### Springæ¡†æ¶ä¸­çš„å•ä¾‹beanæ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼Ÿ\n\nä¸æ˜¯ï¼ŒSpring æ¡†æ¶ä¸­çš„å•ä¾‹ bean ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚\n\nspring ä¸­çš„ bean é»˜è®¤æ˜¯å•ä¾‹æ¨¡å¼ï¼Œspring æ¡†æ¶å¹¶æ²¡æœ‰å¯¹å•ä¾‹ bean è¿›è¡Œå¤šçº¿ç¨‹çš„å°è£…å¤„ç†ã€‚\n\nç„¶è€Œï¼Œå®é™…ä¸Šå¤§éƒ¨åˆ†æ—¶å€™ spring bean æ— çŠ¶æ€çš„ï¼ˆæ¯”å¦‚ dao ç±»ï¼‰ï¼Œæ‰€ä»¥æŸç§ç¨‹åº¦ä¸Šæ¥è¯´ bean ä¹Ÿæ˜¯å®‰å…¨çš„ï¼Œä½†å¦‚æœ bean æœ‰çŠ¶æ€çš„è¯ï¼ˆæ¯”å¦‚ view model å¯¹è±¡ï¼‰ï¼Œé‚£å°±è¦å¼€å‘è€…è‡ªå·±å»ä¿è¯çº¿ç¨‹å®‰å…¨äº†ï¼Œæœ€ç®€å•çš„å°±æ˜¯æ”¹å˜ bean çš„ä½œç”¨åŸŸï¼ŒæŠŠâ€œsingletonâ€å˜æ›´ä¸ºâ€œprototypeâ€ï¼Œè¿™æ ·è¯·æ±‚ bean ç›¸å½“äº new Bean()äº†ï¼Œæ‰€ä»¥å°±å¯ä»¥ä¿è¯çº¿ç¨‹å®‰å…¨äº†ã€‚\n\n> æœ‰çŠ¶æ€å°±æ˜¯æœ‰æ•°æ®å­˜å‚¨åŠŸèƒ½\n> æ— çŠ¶æ€å°±æ˜¯ä¸ä¼šä¿å­˜æ•°æ®\n\n### Springå¦‚ä½•å¤„ç†çº¿ç¨‹å¹¶å‘é—®é¢˜ï¼Ÿ\n\n**Springä½¿ç”¨ThreadLocalå¯¹ä¸€äº›Beançš„çº¿ç¨‹å®‰å…¨é—®é¢˜è¿›è¡Œå¤„ç†**ã€‚\n\nThreadLocal å’Œçº¿ç¨‹åŒæ­¥æœºåˆ¶éƒ½æ˜¯ä¸ºäº†è§£å†³å¤šçº¿ç¨‹ä¸­ç›¸åŒå˜é‡çš„è®¿é—®å†²çªé—®é¢˜ã€‚åŒæ­¥æœºåˆ¶é‡‡ç”¨äº†â€œæ—¶é—´æ¢ç©ºé—´â€çš„æ–¹å¼ï¼Œä»…æä¾›ä¸€ä»½å˜é‡ï¼Œä¸åŒçš„çº¿ç¨‹åœ¨è®¿é—®å‰éœ€è¦è·å–é”ï¼Œæ²¡è·å¾—é”çš„çº¿ç¨‹åˆ™éœ€è¦æ’é˜Ÿã€‚è€Œ ThreadLocal é‡‡ç”¨äº†â€œç©ºé—´æ¢æ—¶é—´â€çš„æ–¹å¼ã€‚\n\nThreadLocal ä¼šä¸ºæ¯ä¸€ä¸ªçº¿ç¨‹æä¾›ä¸€ä¸ªç‹¬ç«‹çš„å˜é‡å‰¯æœ¬ï¼Œä»è€Œéš”ç¦»äº†å¤šä¸ªçº¿ç¨‹å¯¹æ•°æ®çš„è®¿é—®å†²çªã€‚å› ä¸ºæ¯ä¸€ä¸ªçº¿ç¨‹éƒ½æ‹¥æœ‰è‡ªå·±çš„å˜é‡å‰¯æœ¬ï¼Œä»è€Œä¹Ÿå°±æ²¡æœ‰å¿…è¦å¯¹è¯¥å˜é‡è¿›è¡ŒåŒæ­¥äº†ã€‚ThreadLocal æä¾›äº†çº¿ç¨‹å®‰å…¨çš„å…±äº«å¯¹è±¡ï¼Œåœ¨ç¼–å†™å¤šçº¿ç¨‹ä»£ç æ—¶ï¼Œå¯ä»¥æŠŠä¸å®‰å…¨çš„å˜é‡å°è£…è¿› ThreadLocalã€‚\n\n### è§£é‡ŠSpringæ¡†æ¶ä¸­beançš„ç”Ÿå‘½å‘¨æœŸ\n\nå‚è€ƒï¼šhttps://www.cnblogs.com/javazhiyin/p/10905294.html\n\n![Springä¸­Beançš„ç”Ÿå‘½å‘¨æœŸ](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes201911012343410.png)\n\n**1ã€å®ä¾‹åŒ–Beanï¼š**\n\nå¯¹äº BeanFactory å®¹å™¨ï¼Œå½“å®¢æˆ·å‘å®¹å™¨è¯·æ±‚ä¸€ä¸ªå°šæœªåˆå§‹åŒ–çš„ bean æ—¶ï¼Œæˆ–åˆå§‹åŒ– bean çš„æ—¶å€™éœ€è¦æ³¨å…¥å¦ä¸€ä¸ªå°šæœªåˆå§‹åŒ–çš„ä¾èµ–æ—¶ï¼Œå®¹å™¨å°±ä¼šè°ƒç”¨ createBean è¿›è¡Œå®ä¾‹åŒ–ã€‚\nå¯¹äº ApplicationContext å®¹å™¨ï¼Œå½“å®¹å™¨å¯åŠ¨ç»“æŸåï¼Œé€šè¿‡è·å– BeanDefinition å¯¹è±¡ä¸­çš„ä¿¡æ¯ï¼Œå®ä¾‹åŒ–æ‰€æœ‰çš„ beanã€‚\n\n**2ã€ä¾èµ–æ³¨å…¥ï¼š**\n\nå®ä¾‹åŒ–åçš„å¯¹è±¡è¢«å°è£…åœ¨ BeanWrapper å¯¹è±¡ä¸­ï¼Œç´§æ¥ç€ï¼ŒSpring æ ¹æ® BeanDefinition ä¸­çš„ä¿¡æ¯ ä»¥åŠ é€šè¿‡ BeanWrapper æä¾›çš„è®¾ç½®å±æ€§çš„æ¥å£å®Œæˆä¾èµ–æ³¨å…¥ã€‚\n\n**3ã€å¤„ç†Awareæ¥å£ï¼ˆé…ç½®Beanå¯¹è±¡çš„idå€¼ã€å·¥å‚/ä¸Šä¸‹æ–‡ï¼‰ï¼š**\n\næ¥ç€ï¼ŒSpring ä¼šæ£€æµ‹è¯¥å¯¹è±¡æ˜¯å¦å®ç°äº† xxxAware æ¥å£ï¼Œå¹¶å°†ç›¸å…³çš„ xxxAware å®ä¾‹æ³¨å…¥ç»™ Beanï¼š\n\n- å¦‚æœè¿™ä¸ª Bean å·²ç»å®ç°äº† BeanNameAware æ¥å£ï¼Œä¼šè°ƒç”¨å®ƒå®ç°çš„ setBeanName(String beanId)æ–¹æ³•ï¼Œæ­¤å¤„ä¼ é€’çš„å°±æ˜¯ Spring é…ç½®æ–‡ä»¶ä¸­ Bean çš„ id å€¼ï¼›\n- å¦‚æœè¿™ä¸ª Bean å·²ç»å®ç°äº† BeanFactoryAware æ¥å£ï¼Œä¼šè°ƒç”¨å®ƒå®ç°çš„ setBeanFactory()æ–¹æ³•ï¼Œä¼ é€’çš„æ˜¯ Spring å·¥å‚è‡ªèº«ï¼›\n- å¦‚æœè¿™ä¸ª Bean å·²ç»å®ç°äº† ApplicationContextAware æ¥å£ï¼Œä¼šè°ƒ setApplicationContext(ApplicationContext)æ–¹æ³•ï¼Œä¼ å…¥ Spring ä¸Šä¸‹æ–‡ï¼›\n\n**4ã€postProcessBeforeInitializationï¼ˆåˆå§‹åŒ–å‰ç½®å¤„ç†ï¼‰ï¼š**\n\nå¦‚æœæƒ³å¯¹ Bean è¿›è¡Œä¸€äº›è‡ªå®šä¹‰çš„å¤„ç†ï¼Œé‚£ä¹ˆå¯ä»¥è®© Bean å®ç°äº† BeanPostProcessor æ¥å£ï¼Œé‚£å°†ä¼šè°ƒç”¨ postProcessBeforeInitialization(Object obj, String s)æ–¹æ³•ã€‚ç”±äºè¿™ä¸ªæ–¹æ³•æ˜¯åœ¨ Bean åˆå§‹åŒ–ç»“æŸæ—¶è°ƒç”¨çš„ï¼Œæ‰€ä»¥å¯ä»¥è¢«åº”ç”¨äºå†…å­˜æˆ–ç¼“å­˜æŠ€æœ¯ï¼›\n\n**5ã€è‡ªå®šä¹‰åˆå§‹åŒ–init-methodï¼š**\n\nå¦‚æœ Bean åœ¨ Spring é…ç½®æ–‡ä»¶ä¸­é…ç½®äº† init-method å±æ€§ï¼Œåˆ™ä¼šè‡ªåŠ¨è°ƒç”¨å…¶é…ç½®çš„**è‡ªå®šä¹‰åˆå§‹åŒ–**æ–¹æ³•ã€‚\n\n**6ã€postProcessAfterInitializationï¼ˆåˆå§‹åŒ–åç½®å¤„ç†ï¼‰**\n\nå¦‚æœè¿™ä¸ª Bean å®ç°äº† BeanPostProcessor æ¥å£ï¼Œå°†ä¼šè°ƒç”¨ postProcessAfterInitialization(Object obj, String s)æ–¹æ³•ï¼Œ**AOPåœ¨è¿™ä¸ªæ—¶å€™è¿›è¡Œä»£ç†å¯¹è±¡çš„åˆ›å»º**ã€‚\n\n**NOW** ä»¥ä¸Šå‡ ä¸ªæ­¥éª¤å®Œæˆåï¼ŒBean å°±å·²ç»è¢«æ­£ç¡®åˆ›å»ºäº†ï¼Œä¹‹åå°±å¯ä»¥ä½¿ç”¨è¿™ä¸ª Bean äº†ã€‚\n\n**7ã€æ¸…ç†é˜¶æ®µdestroyï¼š**\n\nå½“ Bean ä¸å†éœ€è¦æ—¶ï¼Œä¼šè¿›å…¥æ¸…ç†é˜¶æ®µï¼Œå¦‚æœ Bean å®ç°äº† DisposableBean è¿™ä¸ªæ¥å£ï¼Œä¼šè°ƒç”¨å…¶å®ç°çš„ destroy()æ–¹æ³•ï¼›\n\n**8ã€è‡ªå®šä¹‰é”€æ¯destroy-methodï¼š**\n\næœ€åï¼Œå¦‚æœè¿™ä¸ª Bean çš„ Spring é…ç½®ä¸­é…ç½®äº† destroy-method å±æ€§ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨å…¶é…ç½®çš„**è‡ªå®šä¹‰é”€æ¯**æ–¹æ³•ã€‚\n\n### åœ¨ Springä¸­å¦‚ä½•æ³¨å…¥ä¸€ä¸ªJavaé›†åˆï¼Ÿ\n\nç”¨`<list>`æ³¨å…¥ä¸€åˆ—å€¼ï¼Œç”¨`<map>`æ³¨å…¥ä¸€ç»„æ˜ å°„æ•°æ®ã€‚\n\n### ä»€ä¹ˆæ˜¯beanè£…é…ï¼Ÿ\n\né€šè¿‡ bean çš„ä¾èµ–å…³ç³»ï¼Œä½¿ç”¨ä¾èµ–æ³¨å…¥å°† spring ä¸­çš„ bean è£…é…åœ¨ä¸€èµ·ã€‚\nspring å¯ä»¥é€šè¿‡ bean çš„ä¾èµ–å…³ç³»è‡ªåŠ¨å®Œæˆ bean ä¹‹é—´çš„é…ç½®ã€‚\n\n### Spring è‡ªåŠ¨è£…é… bean æœ‰å“ªäº›æ–¹å¼ï¼Ÿ\n\nåœ¨ spring ä¸­ï¼Œå¯¹è±¡æ— éœ€è‡ªå·±æŸ¥æ‰¾æˆ–åˆ›å»ºä¸å…¶å…³è”çš„å…¶ä»–å¯¹è±¡ï¼Œç”±å®¹å™¨è´Ÿè´£æŠŠéœ€è¦ç›¸äº’åä½œçš„å¯¹è±¡å¼•ç”¨èµ‹äºˆå„ä¸ªå¯¹è±¡ã€‚\n\nåœ¨ Spring æ¡†æ¶ xml é…ç½®ä¸­å…±æœ‰ 5 ç§è‡ªåŠ¨è£…é…ï¼š\n\n- noï¼šé»˜è®¤çš„æ–¹å¼æ˜¯ä¸è¿›è¡Œè‡ªåŠ¨è£…é…çš„ï¼Œé€šè¿‡æ‰‹å·¥è®¾ç½® ref å±æ€§æ¥è¿›è¡Œè£…é… beanã€‚\n- byNameï¼šé€šè¿‡ bean çš„åç§°è¿›è¡Œè‡ªåŠ¨è£…é…ï¼Œå¦‚æœä¸€ä¸ª bean çš„ property ä¸å¦ä¸€ bean çš„ name ç›¸åŒï¼Œå°±è¿›è¡Œè‡ªåŠ¨è£…é…ã€‚\n- byTypeï¼šé€šè¿‡å‚æ•°çš„æ•°æ®ç±»å‹è¿›è¡Œè‡ªåŠ¨è£…é…ã€‚\n- constructorï¼šåˆ©ç”¨æ„é€ å‡½æ•°è¿›è¡Œè£…é…ï¼Œå¹¶ä¸”æ„é€ å‡½æ•°çš„å‚æ•°é€šè¿‡ byType è¿›è¡Œè£…é…ã€‚\n- autodetectï¼šè‡ªåŠ¨æ¢æµ‹ï¼Œå¦‚æœæœ‰æ„é€ æ–¹æ³•ï¼Œé€šè¿‡ construct çš„æ–¹å¼è‡ªåŠ¨è£…é…ï¼Œå¦åˆ™ä½¿ç”¨ byType çš„æ–¹å¼è‡ªåŠ¨è£…é…ã€‚\n\n### ä½¿ç”¨@Autowiredæ³¨è§£è‡ªåŠ¨è£…é…çš„è¿‡ç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ\n\nä½¿ç”¨@Autowired æ³¨è§£æ¥è‡ªåŠ¨è£…é…æŒ‡å®šçš„ beanã€‚åœ¨ä½¿ç”¨@Autowired æ³¨è§£ä¹‹å‰éœ€è¦åœ¨ Spring é…ç½®æ–‡ä»¶è¿›è¡Œé…ç½®æ³¨è§£æ‰«æ `<context:annotation-config />`ã€‚\n\nåœ¨å¯åŠ¨ spring IoC æ—¶ï¼Œå®¹å™¨è‡ªåŠ¨è£…è½½äº†ä¸€ä¸ªåç½®å¤„ç†å™¨ï¼Œå½“å®¹å™¨æ‰«æåˆ°@Autowiedã€@Resource æˆ–@Inject æ—¶ï¼Œå°±ä¼šåœ¨ IoC å®¹å™¨è‡ªåŠ¨æŸ¥æ‰¾éœ€è¦çš„ beanï¼Œå¹¶è£…é…ç»™è¯¥å¯¹è±¡çš„å±æ€§ã€‚åœ¨ä½¿ç”¨@Autowired æ—¶ï¼Œé¦–å…ˆåœ¨å®¹å™¨ä¸­**æŸ¥è¯¢å¯¹åº”ç±»å‹**çš„ beanï¼š\n\n- å¦‚æœå¯¹åº”ç±»å‹æŸ¥è¯¢ç»“æœåˆšå¥½ä¸ºä¸€ä¸ªï¼Œå°±å°†è¯¥ bean è£…é…ç»™@Autowired æŒ‡å®šçš„æ•°æ®ï¼›\n- å¦‚æœå¯¹åº”ç±»å‹æŸ¥è¯¢çš„ç»“æœä¸æ­¢ä¸€ä¸ªï¼Œé‚£ä¹ˆ@Autowired ä¼šæ ¹æ®åç§°æ¥æŸ¥æ‰¾ï¼›\n- å¦‚æœä¸Šè¿°æŸ¥æ‰¾çš„ç»“æœä¸ºç©ºæˆ–è€…ä¸æ­¢ä¸€ä¸ªï¼Œé‚£ä¹ˆä¼šæŠ›å‡ºå¼‚å¸¸ã€‚\n\n## Springæ³¨è§£\n\n### ä»€ä¹ˆæ˜¯åŸºäºJavaçš„Springæ³¨è§£é…ç½®? ç»™ä¸€äº›æ³¨è§£çš„ä¾‹å­\n\nåŸºäº Java çš„é…ç½®ï¼Œå…è®¸ä½ åœ¨å°‘é‡çš„ Java æ³¨è§£çš„å¸®åŠ©ä¸‹ï¼Œè¿›è¡Œä½ çš„å¤§éƒ¨åˆ† Spring é…ç½®è€Œéé€šè¿‡ XML æ–‡ä»¶ã€‚\n\nä»¥@Configuration æ³¨è§£ä¸ºä¾‹ï¼Œå®ƒç”¨æ¥æ ‡è®°ç±»å¯ä»¥å½“åšä¸€ä¸ª bean çš„å®šä¹‰ï¼Œè¢« Spring IOC å®¹å™¨ä½¿ç”¨ã€‚\n\nå¦ä¸€ä¸ªä¾‹å­æ˜¯@Bean æ³¨è§£ï¼Œå®ƒè¡¨ç¤ºæ­¤æ–¹æ³•å°†è¦è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œä½œä¸ºä¸€ä¸ª bean æ³¨å†Œè¿› Spring åº”ç”¨ä¸Šä¸‹æ–‡ã€‚\n\n```java\n@Configuration\npublic class StudentConfig {\n    @Bean\n    public StudentBean myStudent() {\n        return new StudentBean();\n    }\n}\n```\n\n### æ€æ ·å¼€å¯æ³¨è§£è£…é…ï¼Ÿ\n\næ³¨è§£è£…é…åœ¨é»˜è®¤æƒ…å†µä¸‹æ˜¯ä¸å¼€å¯çš„ï¼Œä¸ºäº†ä½¿ç”¨æ³¨è§£è£…é…ï¼Œå¿…é¡»åœ¨ Spring é…ç½®æ–‡ä»¶ä¸­é…ç½® `<context:annotation-config/>`ã€‚\n\n### @Component, @Controller, @Repository, @Service æœ‰ä½•åŒºåˆ«ï¼Ÿ\n\n@Componentï¼šè¿™å°† Java ç±»æ ‡è®°ä¸º beanã€‚spring çš„ç»„ä»¶æ‰«ææœºåˆ¶å¯ä»¥å°†å…¶æ‰«æå¹¶å°†å…¶æ³¨å†Œåˆ° IoC å®¹å™¨ä¸­ã€‚\n\n@Controllerï¼šè¿™å°†ä¸€ä¸ªç±»æ ‡è®°ä¸º Spring Web MVC æ§åˆ¶å™¨ã€‚æ ‡æœ‰å®ƒçš„ Bean ä¼šè‡ªåŠ¨å¯¼å…¥åˆ° IoC å®¹å™¨ä¸­ã€‚\n\n@Serviceï¼šæ­¤æ³¨è§£æ˜¯ç»„ä»¶æ³¨è§£çš„ç‰¹åŒ–ã€‚å®ƒä¸ä¼šå¯¹ @Component æ³¨è§£æä¾›ä»»ä½•å…¶ä»–è¡Œä¸ºã€‚æ‚¨å¯ä»¥åœ¨æœåŠ¡å±‚ç±»ä¸­ä½¿ç”¨ @Service è€Œä¸æ˜¯ @Componentï¼Œå› ä¸ºå®ƒä»¥æ›´å¥½çš„æ–¹å¼æŒ‡å®šäº†æ„å›¾ã€‚\n\n@Repositoryï¼šè¿™ä¸ªæ³¨è§£æ˜¯å…·æœ‰ç±»ä¼¼ç”¨é€”å’ŒåŠŸèƒ½çš„ @Component æ³¨è§£çš„ç‰¹åŒ–ã€‚å®ƒä¸º DAO æä¾›äº†é¢å¤–çš„å¥½å¤„ã€‚å®ƒå°† DAO å¯¼å…¥ IoC å®¹å™¨ï¼Œå¹¶ä½¿æœªç»æ£€æŸ¥çš„å¼‚å¸¸æœ‰èµ„æ ¼è½¬æ¢ä¸º Spring DataAccessExceptionã€‚\n\n### @Required æ³¨è§£æœ‰ä»€ä¹ˆä½œç”¨\n\n`@Required`æ³¨è§£ä½œç”¨äº Bean`setter`æ–¹æ³•ä¸Šï¼Œç”¨äºæ£€æŸ¥ä¸€ä¸ª Bean çš„å±æ€§çš„å€¼**åœ¨é…ç½®æœŸé—´æ˜¯å¦è¢«èµ‹äºˆæˆ–è®¾ç½®**ï¼Œå¦‚æœæœªè¢«è®¾ç½®ï¼Œå®¹å™¨å°†æŠ›å‡º BeanInitializationExceptionã€‚ç¤ºä¾‹ï¼š\n\n```java\npublic class Employee {\n    private String name;\n    @Required\n    public void setName(String name){\n        this.name=name;\n    }\n    public string getName(){\n        return name;\n    }\n}\n```\n\n### @Autowiredå’Œ@Resourceä¹‹é—´çš„åŒºåˆ«\n\n@Autowired å¯ç”¨äºï¼šæ„é€ å‡½æ•°ã€æˆå‘˜å˜é‡ã€Setter æ–¹æ³•\n\n@Autowired å’Œ@Resource ä¹‹é—´çš„åŒºåˆ«\n\n- @Autowired é»˜è®¤æ˜¯**æŒ‰ç…§ç±»å‹è£…é…æ³¨å…¥**çš„ï¼Œé»˜è®¤æƒ…å†µä¸‹å®ƒè¦æ±‚ä¾èµ–å¯¹è±¡å¿…é¡»å­˜åœ¨ï¼ˆå¯ä»¥è®¾ç½®å®ƒ required å±æ€§ä¸º falseï¼‰ã€‚\n- @Resource é»˜è®¤æ˜¯**æŒ‰ç…§åç§°æ¥è£…é…æ³¨å…¥**çš„ï¼Œåªæœ‰å½“æ‰¾ä¸åˆ°ä¸åç§°åŒ¹é…çš„ bean æ‰ä¼šæŒ‰ç…§ç±»å‹æ¥è£…é…æ³¨å…¥ã€‚\n\n### @Qualifier æ³¨è§£æœ‰ä»€ä¹ˆä½œç”¨\n\nå½“æ‚¨åˆ›å»ºå¤šä¸ªç›¸åŒç±»å‹çš„ bean å¹¶å¸Œæœ›ä»…ä½¿ç”¨å±æ€§è£…é…å…¶ä¸­ä¸€ä¸ª bean æ—¶ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨@Qualifier æ³¨è§£å’Œ @Autowired é€šè¿‡æŒ‡å®šåº”è¯¥è£…é…å“ªä¸ªç¡®åˆ‡çš„ bean æ¥æ¶ˆé™¤æ­§ä¹‰ã€‚\n\n### @RequestMapping æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ\n\n@RequestMapping æ³¨è§£ç”¨äºå°†ç‰¹å®š HTTP è¯·æ±‚æ–¹æ³•æ˜ å°„åˆ°å°†å¤„ç†ç›¸åº”è¯·æ±‚çš„æ§åˆ¶å™¨ä¸­çš„ç‰¹å®šç±»/æ–¹æ³•ã€‚æ­¤æ³¨é‡Šå¯åº”ç”¨äºä¸¤ä¸ªçº§åˆ«ï¼š\n\n- ç±»çº§åˆ«ï¼šæ˜ å°„è¯·æ±‚çš„ URL\n- æ–¹æ³•çº§åˆ«ï¼šæ˜ å°„ URL ä»¥åŠ HTTP è¯·æ±‚æ–¹æ³•\n\n## Springäº‹åŠ¡\n\n### Springæ”¯æŒçš„äº‹åŠ¡ç®¡ç†ç±»å‹/äº‹åŠ¡å®ç°æ–¹å¼æœ‰å“ªäº›ï¼Ÿ\n\nSpring æ”¯æŒä¸¤ç§ç±»å‹çš„äº‹åŠ¡ç®¡ç†ï¼š\n\n**ç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç†**ï¼šè¿™æ„å‘³ä½ é€šè¿‡ç¼–ç¨‹çš„æ–¹å¼ç®¡ç†äº‹åŠ¡ï¼Œç»™ä½ å¸¦æ¥æå¤§çš„çµæ´»æ€§ï¼Œä½†æ˜¯éš¾ç»´æŠ¤ã€‚\n\n**å£°æ˜å¼äº‹åŠ¡ç®¡ç†**ï¼šè¿™æ„å‘³ç€ä½ å¯ä»¥å°†ä¸šåŠ¡ä»£ç å’Œäº‹åŠ¡ç®¡ç†åˆ†ç¦»ï¼Œä½ åªéœ€ç”¨æ³¨è§£å’Œ XML é…ç½®æ¥ç®¡ç†äº‹åŠ¡ã€‚\n\n### Springäº‹åŠ¡çš„å®ç°æ–¹å¼å’Œå®ç°åŸç†\n\nSpring äº‹åŠ¡çš„æœ¬è´¨å…¶å®å°±æ˜¯æ•°æ®åº“å¯¹äº‹åŠ¡çš„æ”¯æŒï¼Œæ²¡æœ‰æ•°æ®åº“çš„äº‹åŠ¡æ”¯æŒï¼ŒSpring æ˜¯æ— æ³•æä¾›äº‹åŠ¡åŠŸèƒ½çš„ã€‚\n\n```xml\n<!-- 2ã€é…ç½®äº‹åŠ¡çš„é€šçŸ¥ä»¥åŠäº‹åŠ¡çš„å±æ€§-->\n<tx:advice id=\"txAdvice\" transaction-manager=\"transactionManager\">\n<!-- é…ç½®äº‹åŠ¡çš„å±æ€§\nisolationï¼šç”¨äºæŒ‡å®šäº‹åŠ¡çš„éš”ç¦»çº§åˆ«ã€‚é»˜è®¤å€¼æ˜¯DEFAULTï¼Œè¡¨ç¤ºä½¿ç”¨æ•°æ®åº“çš„é»˜è®¤éš”\nç¦»çº§åˆ«ã€‚\npropagationï¼šç”¨äºæŒ‡å®šäº‹åŠ¡çš„ä¼ æ’­è¡Œä¸ºã€‚é»˜è®¤å€¼æ˜¯REQUIRED(å¢åˆ æ”¹)ï¼Œè¡¨ç¤ºä¸€å®šä¼š\næœ‰äº‹åŠ¡ã€‚æŸ¥è¯¢æ–¹æ³•å¯ä»¥é€‰æ‹©SUPPORTSã€‚\nread-onlyï¼šç”¨äºæŒ‡å®šäº‹åŠ¡æ˜¯å¦åªè¯»ã€‚åªæœ‰æŸ¥è¯¢æ–¹æ³•æ‰èƒ½è®¾ç½®ä¸ºtrueã€‚é»˜è®¤å€¼æ˜¯\nfalseï¼Œè¡¨ç¤ºè¯»å†™ã€‚\ntimeoutï¼šç”¨äºæŒ‡å®šäº‹åŠ¡çš„è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤å€¼æ˜¯-1ï¼Œè¡¨ç¤ºæ°¸ä¸è¶…æ—¶ã€‚å¦‚æœæŒ‡å®šäº†æ•°å€¼ï¼Œ\nä»¥ç§’ä¸ºå•ä½ã€‚\nrollback-forï¼šç”¨äºæŒ‡å®šä¸€ä¸ªå¼‚å¸¸ï¼Œå½“äº§ç”Ÿè¯¥å¼‚å¸¸æ—¶ï¼Œäº‹åŠ¡å›æ»šï¼Œäº§ç”Ÿå…¶ä»–å¼‚å¸¸æ—¶ï¼Œ\näº‹åŠ¡ä¸å›æ»šã€‚æ²¡æœ‰é»˜è®¤å€¼ã€‚è¡¨ç¤ºä»»ä½•å¼‚å¸¸éƒ½å›æ»šã€‚\nno-rollback-forï¼šç”¨äºæŒ‡å®šä¸€ä¸ªå¼‚å¸¸ï¼Œå½“äº§ç”Ÿè¯¥å¼‚å¸¸æ—¶ï¼Œäº‹åŠ¡ä¸å›æ»šï¼Œäº§ç”Ÿå…¶ä»–å¼‚å¸¸\næ—¶äº‹åŠ¡å›æ»šã€‚æ²¡æœ‰é»˜è®¤å€¼ã€‚è¡¨ç¤ºä»»ä½•å¼‚å¸¸éƒ½å›æ»šã€‚\n-->\n<tx:attributes>\n    <!--éæŸ¥è¯¢æ–¹æ³•-->\n    <tx:method name=\"*\" propagation=\"REQUIRED\" read-only=\"false\"/>\n    <!--æŸ¥è¯¢æ–¹æ³•-->\n    <tx:method name=\"find*\" propagation=\"SUPPORTS\" read-only=\"true\"/>\n    </tx:attributes>\n</tx:advice>\n```\n\n### è¯´ä¸€ä¸‹Springçš„äº‹åŠ¡ä¼ æ’­è¡Œä¸º\n\nspring äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸ºè¯´çš„æ˜¯ï¼Œå½“å¤šä¸ªäº‹åŠ¡åŒæ—¶å­˜åœ¨çš„æ—¶å€™ï¼Œspring å¦‚ä½•å¤„ç†è¿™äº›äº‹åŠ¡çš„è¡Œä¸ºã€‚\n\n> â‘  **PROPAGATION_REQUIRED**ï¼šå¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œå°±åˆ›å»ºä¸€ä¸ªæ–°äº‹åŠ¡ï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±åŠ å…¥è¯¥äº‹åŠ¡ï¼Œè¯¥è®¾ç½®æ˜¯æœ€å¸¸ç”¨çš„è®¾ç½®ã€‚ï¼ˆé»˜è®¤å€¼ï¼Œé€‚ç”¨äºéæŸ¥è¯¢æ–¹æ³•ï¼Œå¢åˆ æ”¹ï¼‰ï¼ˆäº‹åŠ¡å­˜åœ¨å°±ç”¨ä¸å­˜åœ¨è¦åˆ›å»ºï¼‰\n> â‘¡ **PROPAGATION_SUPPORTS**ï¼šæ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±åŠ å…¥è¯¥äº‹åŠ¡ï¼Œå¦‚æœå½“å‰ä¸å­˜åœ¨äº‹åŠ¡ï¼Œå°±ä»¥éäº‹åŠ¡æ‰§è¡Œã€‚ï¼ˆé€‚ç”¨äºæŸ¥è¯¢æ–¹æ³•ï¼‰ï¼ˆäº‹åŠ¡å­˜åœ¨å°±ç”¨ä¸å­˜åœ¨å°±ä¸ç”¨ï¼‰\n> â‘¢ PROPAGATION_MANDATORYï¼šæ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±åŠ å…¥è¯¥äº‹åŠ¡ï¼Œå¦‚æœå½“å‰ä¸å­˜åœ¨äº‹åŠ¡ï¼Œå°±æŠ›å‡ºå¼‚å¸¸ã€‚\n> â‘£ **PROPAGATION_REQUIRES_NEW**ï¼šåˆ›å»ºæ–°äº‹åŠ¡ï¼Œæ— è®ºå½“å‰å­˜ä¸å­˜åœ¨äº‹åŠ¡ï¼Œéƒ½åˆ›å»ºæ–°äº‹åŠ¡ã€‚ï¼ˆæ°¸è¿œéƒ½è¦æ–°äº‹åŠ¡ï¼‰\n> â‘¤ PROPAGATION_NOT_SUPPORTEDï¼šä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œæ“ä½œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±æŠŠå½“å‰äº‹åŠ¡æŒ‚èµ·ã€‚\n> â‘¥ PROPAGATION_NEVERï¼šä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚\n> â‘¦ PROPAGATION_NESTEDï¼šå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åœ¨åµŒå¥—äº‹åŠ¡å†…æ‰§è¡Œã€‚å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œåˆ™æŒ‰REQUIREDå±æ€§æ‰§è¡Œã€‚\n\n### è¯´ä¸€ä¸‹ spring çš„äº‹åŠ¡éš”ç¦»ï¼Ÿ\n\nspring æœ‰äº”å¤§éš”ç¦»çº§åˆ«ï¼Œé»˜è®¤å€¼ä¸º ISOLATION_DEFAULTï¼ˆä½¿ç”¨æ•°æ®åº“çš„è®¾ç½®ï¼‰ï¼Œå…¶ä»–å››ä¸ªéš”ç¦»çº§åˆ«å’Œæ•°æ®åº“çš„éš”ç¦»çº§åˆ«ä¸€è‡´ï¼š\n\n1. ISOLATION_DEFAULTï¼šç”¨åº•å±‚æ•°æ®åº“çš„è®¾ç½®éš”ç¦»çº§åˆ«ï¼Œæ•°æ®åº“è®¾ç½®çš„æ˜¯ä»€ä¹ˆæˆ‘å°±ç”¨ä»€ä¹ˆï¼›\n2. ISOLATION_READ_UNCOMMITTEDï¼šè¯»æœªæäº¤ï¼Œæœ€ä½éš”ç¦»çº§åˆ«ã€äº‹åŠ¡æœªæäº¤å‰ï¼Œå°±å¯è¢«å…¶ä»–äº‹åŠ¡è¯»å–ï¼ˆä¼šå‡ºç°è„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»ï¼‰ï¼›\n3. ISOLATION_READ_COMMITTEDï¼šè¯»å·²æäº¤ï¼Œä¸€ä¸ªäº‹åŠ¡æäº¤åæ‰èƒ½è¢«å…¶ä»–äº‹åŠ¡è¯»å–åˆ°ï¼ˆä¼šé€ æˆä¸å¯é‡å¤è¯»ã€å¹»è¯»ï¼‰ï¼ŒSQL server çš„é»˜è®¤çº§åˆ«ï¼›\n4. ISOLATION_REPEATABLE_READï¼šå¯é‡å¤è¯»ï¼Œä¿è¯å¤šæ¬¡è¯»å–åŒä¸€ä¸ªæ•°æ®æ—¶ï¼Œå…¶å€¼éƒ½å’Œäº‹åŠ¡å¼€å§‹æ—¶å€™çš„å†…å®¹æ˜¯ä¸€è‡´ï¼Œç¦æ­¢è¯»å–åˆ°åˆ«çš„äº‹åŠ¡æœªæäº¤çš„æ•°æ®ï¼ˆä¼šé€ æˆå¹»è¯»ï¼‰ï¼ŒMySQL çš„é»˜è®¤çº§åˆ«ï¼›\n5. ISOLATION_SERIALIZABLEï¼šåºåˆ—åŒ–ï¼Œä»£ä»·æœ€é«˜æœ€å¯é çš„éš”ç¦»çº§åˆ«ï¼Œè¯¥éš”ç¦»çº§åˆ«èƒ½é˜²æ­¢è„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»ã€‚\n\n## Springé¢å‘åˆ‡é¢ç¼–ç¨‹(AOP)\n\n### ä»€ä¹ˆæ˜¯AOP\n\nOOP(Object-Oriented Programming)é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œå…è®¸å¼€å‘è€…å®šä¹‰çºµå‘çš„å…³ç³»ï¼Œä½†å¹¶é€‚ç”¨äºå®šä¹‰æ¨ªå‘çš„å…³ç³»ï¼Œå¯¼è‡´äº†å¤§é‡ä»£ç çš„é‡å¤ï¼Œè€Œä¸åˆ©äºå„ä¸ªæ¨¡å—çš„é‡ç”¨ã€‚\n\nAOP(Aspect-Oriented Programming)ï¼Œä¸€èˆ¬ç§°ä¸ºé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œä½œä¸ºé¢å‘å¯¹è±¡çš„ä¸€ç§è¡¥å……ï¼Œå°†ä¸€äº›**å…¬å…±è¡Œä¸ºå’Œé€»è¾‘ï¼ŒæŠ½å–å¹¶å°è£…ä¸ºä¸€ä¸ªå¯é‡ç”¨çš„æ¨¡å—ï¼Œå‡å°‘ç³»ç»Ÿä¸­çš„é‡å¤ä»£ç ï¼Œé™ä½äº†æ¨¡å—é—´çš„è€¦åˆåº¦ï¼ŒåŒæ—¶æé«˜äº†ç³»ç»Ÿçš„å¯ç»´æŠ¤æ€§ã€‚å¯ç”¨äºæƒé™è®¤è¯ã€æ—¥å¿—ã€äº‹åŠ¡å¤„ç†ç­‰**ã€‚\n\n### Spring AOP and AspectJ AOP æœ‰ä»€ä¹ˆåŒºåˆ«ï¼ŸAOP æœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ\n\nAOP å®ç°çš„å…³é”®åœ¨äº ä»£ç†æ¨¡å¼ï¼ŒAOP ä»£ç†ä¸»è¦åˆ†ä¸ºé™æ€ä»£ç†ï¼ˆAspectJï¼‰å’ŒåŠ¨æ€ä»£ç†ï¼ˆSpring AOPï¼‰ã€‚\n\nï¼ˆ1ï¼‰AspectJ é‡‡ç”¨é™æ€ä»£ç†æ¨¡å¼ï¼Œå±äº**ç¼–è¯‘æ—¶å¢å¼º**ï¼Œä¼šåœ¨ç¼–è¯‘é˜¶æ®µç»‡å…¥åˆ‡é¢ç”Ÿæˆç›¸åº”çš„ä»£ç†å¯¹è±¡\n\nï¼ˆ2ï¼‰Spring AOP é‡‡ç”¨åŠ¨æ€ä»£ç†æ¨¡å¼ï¼Œå±äº**è¿è¡Œæ—¶å¢å¼º**ï¼Œæ¯æ¬¡è¿è¡Œæ—¶ç»‡å…¥åˆ‡é¢åœ¨å†…å­˜ä¸­ä¸´æ—¶ç”Ÿæˆç›¸åº”çš„ä»£ç†å¯¹è±¡\n\n### JDKåŠ¨æ€ä»£ç†å’ŒCGLIBåŠ¨æ€ä»£ç†çš„åŒºåˆ«\n\nJDK åŠ¨æ€ä»£ç†ä¸»è¦æ˜¯é’ˆå¯¹ç±»å®ç°äº†æŸä¸ªæ¥å£ï¼ŒAOP åˆ™ä¼šä½¿ç”¨ JDK åŠ¨æ€ä»£ç†ã€‚åŸºäºåå°„çš„æœºåˆ¶å®ç°ï¼Œç”Ÿæˆä¸€ä¸ªå®ç°è¯¥æ¥å£çš„ä¸€ä¸ªä»£ç†ç±»ï¼Œç„¶åé€šè¿‡é‡å†™æ–¹æ³•çš„æ–¹å¼ï¼Œå®ç°å¯¹ä»£ç çš„å¢å¼ºã€‚\n\nè€Œå¦‚æœæŸä¸ªç±»æ²¡æœ‰å®ç°æ¥å£ï¼ŒAOP åˆ™ä¼šä½¿ç”¨ CGLIB ä»£ç†ã€‚åº•å±‚åŸç†æ˜¯**åŸºäº asm ç¬¬ä¸‰æ–¹æ¡†æ¶**ï¼Œé€šè¿‡ä¿®æ”¹å­—èŠ‚ç ç”Ÿæˆä¸€ä¸ªå­ç±»ï¼Œç„¶åé‡å†™çˆ¶ç±»çš„æ–¹æ³•ï¼Œå®ç°å¯¹ä»£ç çš„å¢å¼ºã€‚\n\n> ä½œè€…ï¼šé˜¿é‡Œäº‘äº‘æ –å·\n>\n> é“¾æ¥ï¼šhttps://zhuanlan.zhihu.com/p/368769721\n>\n> æ¥æºï¼šçŸ¥ä¹\n>\n> è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚\n\n### è§£é‡Šä¸€ä¸‹Spring AOPé‡Œé¢çš„å‡ ä¸ªåè¯\n\nï¼ˆ1ï¼‰åˆ‡é¢ï¼ˆAspectï¼‰ï¼šåˆ‡é¢æ˜¯é€šçŸ¥å’Œåˆ‡ç‚¹çš„ç»“åˆã€‚ åœ¨ Spring AOP ä¸­ï¼Œåˆ‡é¢å¯ä»¥ä½¿ç”¨é€šç”¨ç±»ï¼ˆåŸºäºæ¨¡å¼çš„é£æ ¼ï¼‰ æˆ–è€…åœ¨æ™®é€šç±»ä¸­ä»¥ @AspectJ æ³¨è§£æ¥å®ç°ã€‚\n\nï¼ˆ2ï¼‰è¿æ¥ç‚¹ï¼ˆJoin pointï¼‰ï¼šæ–¹æ³•\n\nï¼ˆ3ï¼‰é€šçŸ¥ï¼ˆAdviceï¼‰ï¼šåœ¨è¦å¢å¼ºä¸Šçš„è¿æ¥ç‚¹ä¸Šè¦è¿›è¡Œæ€æ ·çš„å¢å¼º\n\nï¼ˆ4ï¼‰åˆ‡å…¥ç‚¹ï¼ˆPointcutï¼‰ï¼šå“ªäº›è¿æ¥ç‚¹éœ€è¦å¢å¼º\n\nï¼ˆ5ï¼‰ç›®æ ‡å¯¹è±¡ï¼ˆTarget Objectï¼‰ï¼š è¢«ä»£ç†ï¼ˆproxiedï¼‰ å¯¹è±¡ã€‚\n\nï¼ˆ6ï¼‰ç»‡å…¥ï¼ˆWeavingï¼‰ï¼šç»‡å…¥æ˜¯æŠŠåˆ‡é¢åº”ç”¨åˆ°ç›®æ ‡å¯¹è±¡å¹¶åˆ›å»ºæ–°çš„ä»£ç†å¯¹è±¡çš„è¿‡ç¨‹ã€‚\n\nï¼ˆ7ï¼‰Proxyï¼ˆä»£ç†ï¼‰ï¼šä¸€ä¸ªç±»è¢« AOP ç»‡å…¥å¢å¼ºåï¼Œå°±äº§ç”Ÿä¸€ä¸ªç»“æœä»£ç†ç±»ã€‚\n\n> - ç¼–è¯‘æœŸï¼šåˆ‡é¢åœ¨ç›®æ ‡ç±»ç¼–è¯‘æ—¶è¢«ç»‡å…¥ã€‚AspectJçš„ç»‡å…¥ç¼–è¯‘å™¨æ˜¯ä»¥è¿™ç§æ–¹å¼ç»‡å…¥åˆ‡é¢çš„ã€‚\n> - ç±»åŠ è½½æœŸï¼šåˆ‡é¢åœ¨ç›®æ ‡ç±»åŠ è½½åˆ°JVMæ—¶è¢«ç»‡å…¥ã€‚éœ€è¦ç‰¹æ®Šçš„ç±»åŠ è½½å™¨ï¼Œå®ƒå¯ä»¥åœ¨ç›®æ ‡ç±»è¢«å¼•å…¥åº”ç”¨ä¹‹å‰å¢å¼ºè¯¥ç›®æ ‡ç±»çš„å­—èŠ‚ç ã€‚AspectJ5çš„åŠ è½½æ—¶ç»‡å…¥å°±æ”¯æŒä»¥è¿™ç§æ–¹å¼ç»‡å…¥åˆ‡é¢ã€‚\n> - è¿è¡ŒæœŸï¼šåˆ‡é¢åœ¨åº”ç”¨è¿è¡Œçš„æŸä¸ªæ—¶åˆ»è¢«ç»‡å…¥ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œåœ¨ç»‡å…¥åˆ‡é¢æ—¶ï¼ŒAOPå®¹å™¨ä¼šä¸ºç›®æ ‡å¯¹è±¡åŠ¨æ€åœ°åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡ã€‚SpringAOPå°±æ˜¯ä»¥è¿™ç§æ–¹å¼ç»‡å…¥åˆ‡é¢ã€‚\n\n### Springé€šçŸ¥æœ‰å“ªäº›ç±»å‹ï¼Ÿ\n\nåœ¨ AOP æœ¯è¯­ä¸­ï¼Œåˆ‡é¢çš„å·¥ä½œè¢«ç§°ä¸ºé€šçŸ¥ï¼Œå®é™…ä¸Šæ˜¯ç¨‹åºæ‰§è¡Œæ—¶è¦é€šè¿‡ SpringAOP æ¡†æ¶è§¦å‘çš„ä»£ç æ®µã€‚\n\nSpring åˆ‡é¢å¯ä»¥åº”ç”¨ 5 ç§ç±»å‹çš„é€šçŸ¥ï¼š\n\n1. å‰ç½®é€šçŸ¥ï¼ˆBeforeï¼‰ï¼šåœ¨ç›®æ ‡æ–¹æ³•è¢«è°ƒç”¨ä¹‹å‰è°ƒç”¨é€šçŸ¥åŠŸèƒ½ï¼›\n2. åç½®é€šçŸ¥ï¼ˆAfterï¼‰ï¼šåœ¨ç›®æ ‡æ–¹æ³•å®Œæˆä¹‹åè°ƒç”¨é€šçŸ¥ï¼Œæ­¤æ—¶ä¸ä¼šå…³å¿ƒæ–¹æ³•çš„è¾“å‡ºæ˜¯ä»€ä¹ˆï¼›\n3. è¿”å›é€šçŸ¥ï¼ˆAfter-returning ï¼‰ï¼šåœ¨ç›®æ ‡æ–¹æ³•æˆåŠŸæ‰§è¡Œä¹‹åè°ƒç”¨é€šçŸ¥ï¼›\n4. å¼‚å¸¸é€šçŸ¥ï¼ˆAfter-throwingï¼‰ï¼šåœ¨ç›®æ ‡æ–¹æ³•æŠ›å‡ºå¼‚å¸¸åè°ƒç”¨é€šçŸ¥ï¼›\n5. ç¯ç»•é€šçŸ¥ï¼ˆAroundï¼‰ï¼šé€šçŸ¥åŒ…è£¹äº†è¢«é€šçŸ¥çš„æ–¹æ³•ï¼Œåœ¨è¢«é€šçŸ¥çš„æ–¹æ³•è°ƒç”¨ä¹‹å‰å’Œè°ƒç”¨ä¹‹åæ‰§è¡Œè‡ªå®šä¹‰çš„è¡Œä¸ºã€‚\n\n> åŒä¸€ä¸ªaspectï¼Œä¸åŒadviceçš„æ‰§è¡Œé¡ºåºï¼š\n>\n> â‘ æ²¡æœ‰å¼‚å¸¸æƒ…å†µä¸‹çš„æ‰§è¡Œé¡ºåºï¼š\n>\n> around before advice\tæ–¹æ³•è°ƒç”¨ä¹‹å‰è‡ªå®šä¹‰è¡Œä¸º\n> before advice\n> target method æ‰§è¡Œ\n> around after advice\tæ–¹æ³•è°ƒç”¨åè‡ªå®šä¹‰è¡Œä¸º\n> after advice\n> afterReturning\n>\n> â‘¡æœ‰å¼‚å¸¸æƒ…å†µä¸‹çš„æ‰§è¡Œé¡ºåºï¼š\n>\n> around before advice\n> before advice\n> target method æ‰§è¡Œ\n> around after advice\n> after advice\n> afterThrowing:å¼‚å¸¸å‘ç”Ÿ\n> Java.lang.RuntimeException: å¼‚å¸¸å‘ç”Ÿ\n\n### ä»€ä¹ˆæ˜¯åˆ‡é¢ Aspectï¼Ÿ\n\naspect ç”± pointcount å’Œ advice ç»„æˆï¼Œåˆ‡é¢æ˜¯é€šçŸ¥å’Œåˆ‡ç‚¹çš„ç»“åˆã€‚ \nAOP çš„å·¥ä½œé‡å¿ƒåœ¨äºå¦‚ä½•å°†å¢å¼ºç¼–ç»‡ç›®æ ‡å¯¹è±¡çš„è¿æ¥ç‚¹ä¸Š, è¿™é‡ŒåŒ…å«ä¸¤ä¸ªå·¥ä½œ:  \n\n- å¦‚ä½•é€šè¿‡ pointcut å’Œ advice å®šä½åˆ°ç‰¹å®šçš„ joinpoint ä¸Š\n- å¦‚ä½•åœ¨ advice ä¸­ç¼–å†™åˆ‡é¢ä»£ç \n\nå¯ä»¥ç®€å•åœ°è®¤ä¸º, ä½¿ç”¨ @Aspect æ³¨è§£çš„ç±»å°±æ˜¯åˆ‡é¢\n\n![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes2020021212264438.png)\n","source":"_posts/Javaå…«è‚¡æ–‡ - Spring.md","raw":"---\ntitle: Javaå…«è‚¡æ–‡ - Spring\ncopyright: true\nmathjax: false\ncategories:\n  - Javaå…«è‚¡æ–‡\ndate: 2023-01-23 16:14:06\ntags:\ntoc: true\nurlname: java-spring\n---\n\n> æ•´ç†çš„Springæ¡†æ¶ç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½\t<!--more-->\n\n## Springæ¦‚è¿°\n\n### ä»€ä¹ˆæ˜¯spring?\n\nSpring æ˜¯**ä¸€ä¸ªè½»é‡çº§Javaå¼€å‘æ¡†æ¶**ï¼Œç›®çš„æ˜¯ä¸ºäº†è§£å†³å¼€å‘ä¸­çš„**ä¸šåŠ¡é€»è¾‘å±‚å’Œå…¶ä»–å„å±‚çš„è€¦åˆé—®é¢˜**ï¼Œç®€åŒ– Java å¼€å‘ã€‚\n\n### Springæ¡†æ¶çš„æ ¸å¿ƒæ˜¯ä»€ä¹ˆ\n\n**Springæ¡†æ¶çš„æ ¸å¿ƒ**ï¼šIoC å®¹å™¨å’Œ AOP æ¨¡å—ã€‚\né€šè¿‡ IoC å®¹å™¨ç®¡ç† Java Bean å¯¹è±¡åŠå…¶ç”Ÿå‘½å‘¨æœŸä»¥åŠä»–ä»¬ä¹‹é—´çš„è€¦åˆå…³ç³»ï¼›\né€šè¿‡ AOP å°†ä¸€äº›å…¬å…±è¡Œä¸ºå’Œé€»è¾‘ï¼ŒæŠ½å–å¹¶å°è£…ä¸ºä¸€ä¸ªå¯é‡ç”¨çš„æ¨¡å—ï¼Œå‡å°‘ç³»ç»Ÿä¸­çš„é‡å¤ä»£ç ï¼Œé™ä½æ¨¡å—é—´çš„è€¦åˆåº¦\n\n### Springçš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ\n\nä¼˜ç‚¹\n\n- æ–¹ä¾¿è§£è€¦ï¼Œç®€åŒ–å¼€å‘ï¼ˆ**IoC**ï¼‰\n\n\tSpring å°±æ˜¯ä¸€ä¸ªå¤§å·¥å‚ï¼Œå¯ä»¥å°†æ‰€æœ‰å¯¹è±¡çš„åˆ›å»ºå’Œä¾èµ–å…³ç³»çš„ç»´æŠ¤ï¼Œäº¤ç»™ Spring ç®¡ç†ã€‚\n\n- AOP ç¼–ç¨‹çš„æ”¯æŒï¼ˆ**AOP**ï¼‰\n\n\tSpring æä¾›é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œå¯ä»¥æ–¹ä¾¿çš„å®ç°å¯¹ç¨‹åºè¿›è¡Œæƒé™æ‹¦æˆªã€è¿è¡Œç›‘æ§ç­‰åŠŸèƒ½ã€‚\n\n- å£°æ˜å¼äº‹åŠ¡çš„æ”¯æŒï¼ˆ**äº‹åŠ¡**ï¼‰\n\n\tåªéœ€è¦é€šè¿‡é…ç½®å°±å¯ä»¥å®Œæˆå¯¹äº‹åŠ¡çš„ç®¡ç†ï¼Œè€Œæ— éœ€æ‰‹åŠ¨ç¼–ç¨‹ã€‚\n\n- æ–¹ä¾¿é›†æˆå„ç§ä¼˜ç§€æ¡†æ¶ï¼ˆ**é›†æˆ**ï¼‰\n\n\tSpring ä¸æ’æ–¥å„ç§ä¼˜ç§€çš„å¼€æºæ¡†æ¶ï¼Œå…¶å†…éƒ¨æä¾›äº†å¯¹å„ç§ä¼˜ç§€æ¡†æ¶çš„ç›´æ¥æ”¯æŒï¼ˆå¦‚ï¼šStrutsã€Hibernateã€MyBatis ç­‰ï¼‰ã€‚\n\n\nç¼ºç‚¹\n\n- Spring**ä¾èµ–åå°„ï¼Œåå°„å½±å“æ€§èƒ½**\n\n### Spring æ¡†æ¶ä¸­éƒ½ç”¨åˆ°äº†å“ªäº›è®¾è®¡æ¨¡å¼ï¼Ÿ\n\n1. å·¥å‚æ¨¡å¼ï¼šé€šè¿‡ BeanFactory å’Œ ApplicationContext æ¥ç®¡ç† Bean å¯¹è±¡ã€‚\n2. å•ä¾‹æ¨¡å¼ï¼šBean é»˜è®¤ä¸ºå•ä¾‹æ¨¡å¼ã€‚\n3. ä»£ç†æ¨¡å¼ï¼šSpring çš„ AOP åŠŸèƒ½ç”¨åˆ°äº†åŸºäºæ¥å£çš„ JDK çš„åŠ¨æ€ä»£ç†å’ŒåŸºäºå­ç±»çš„ CGLIB åŠ¨æ€ä»£ç†ï¼›\n\n### Springæ¡†æ¶ä¸­æœ‰å“ªäº›ä¸åŒç±»å‹çš„äº‹ä»¶\n\n**Springçš„ApplicationContext æä¾›äº†æ”¯æŒäº‹ä»¶å’Œä»£ç ä¸­ç›‘å¬å™¨çš„åŠŸèƒ½ã€‚**  \n\nå¦‚æœä¸€ä¸ª bean å®ç°äº†`ApplicationListener`æ¥å£ï¼Œå½“ä¸€ä¸ª`ApplicationEvent` è¢«å‘å¸ƒä»¥åï¼Œbean ä¼šè‡ªåŠ¨è¢«é€šçŸ¥ã€‚\n\n```javascript\npublic class AllApplicationEventListener implements ApplicationListener < ApplicationEvent >{\n    @Override\n    public void onApplicationEvent(ApplicationEvent applicationEvent){\n        //process event\n    }\n}\n```\n\n**Spring æä¾›äº†ä»¥ä¸‹5ç§æ ‡å‡†çš„äº‹ä»¶ï¼š**\n\n- ä¸Šä¸‹æ–‡æ›´æ–°äº‹ä»¶ï¼ˆContextRefreshedEventï¼‰ï¼šè¯¥äº‹ä»¶ä¼šåœ¨ ApplicationContext è¢«åˆå§‹åŒ–æˆ–è€…æ›´æ–°æ—¶å‘å¸ƒã€‚ä¹Ÿå¯ä»¥åœ¨è°ƒç”¨`ConfigurableApplicationContext` æ¥å£ä¸­çš„`refresh()`æ–¹æ³•æ—¶è¢«è§¦å‘ã€‚\n- ä¸Šä¸‹æ–‡å¼€å§‹äº‹ä»¶ï¼ˆContextStartedEventï¼‰ï¼šå½“å®¹å™¨è°ƒç”¨`ConfigurableApplicationContext`çš„`Start()`æ–¹æ³•å¼€å§‹/é‡æ–°å¼€å§‹å®¹å™¨æ—¶è§¦å‘è¯¥äº‹ä»¶ã€‚\n- ä¸Šä¸‹æ–‡åœæ­¢äº‹ä»¶ï¼ˆContextStoppedEventï¼‰ï¼šå½“å®¹å™¨è°ƒç”¨`ConfigurableApplicationContext`çš„`Stop()`æ–¹æ³•åœæ­¢å®¹å™¨æ—¶è§¦å‘è¯¥äº‹ä»¶ã€‚\n- ä¸Šä¸‹æ–‡å…³é—­äº‹ä»¶ï¼ˆContextClosedEventï¼‰ï¼šå½“`ApplicationContext`è¢«å…³é—­æ—¶è§¦å‘è¯¥äº‹ä»¶ã€‚å®¹å™¨è¢«å…³é—­æ—¶ï¼Œå…¶ç®¡ç†çš„æ‰€æœ‰å•ä¾‹ Bean éƒ½è¢«é”€æ¯ã€‚\n- è¯·æ±‚å¤„ç†äº‹ä»¶ï¼ˆRequestHandledEventï¼‰ï¼šåœ¨ Web åº”ç”¨ä¸­ï¼Œå½“ä¸€ä¸ª http è¯·æ±‚ï¼ˆrequestï¼‰ç»“æŸè§¦å‘è¯¥äº‹ä»¶ã€‚\n\n### Spring åº”ç”¨ç¨‹åºæœ‰å“ªäº›ä¸åŒç»„ä»¶ï¼Ÿ\n\nSpring åº”ç”¨ä¸€èˆ¬æœ‰ä»¥ä¸‹ç»„ä»¶ï¼š\n\n- Bean ç±» - å®ƒåŒ…å«å±æ€§ï¼Œsetter å’Œ getter æ–¹æ³•ï¼Œå‡½æ•°ç­‰ã€‚\n- Bean é…ç½®æ–‡ä»¶ - åŒ…å«ç±»çš„ä¿¡æ¯ä»¥åŠå¦‚ä½•é…ç½®å®ƒä»¬ã€‚\n- æ¥å£ - å¤„ç† Bean \n- ç”¨æˆ·ç¨‹åº - å®ƒä½¿ç”¨æ¥å£ã€‚\n\n## Springæ§åˆ¶åè½¬(IOC)\n\n### ä»€ä¹ˆæ˜¯Spring IOC å®¹å™¨ï¼Ÿ\n\nSpring IOCï¼ˆæ§åˆ¶åè½¬ï¼‰ æŠŠç»„ä»¶å¯¹è±¡æ§åˆ¶æƒäº¤ç»™å®¹å™¨ï¼Œå®¹å™¨è´Ÿè´£åˆ›å»ºå¯¹è±¡ï¼Œé…ç½®å¯¹è±¡ï¼ˆé€šè¿‡ä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰ï¼Œå¹¶ä¸”ç®¡ç†è¿™äº›å¯¹è±¡çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸã€‚IoC è®©ç›¸äº’åä½œçš„ç»„ä»¶ä¿æŒæ¾è€¦åˆã€‚\n\n### Spring IoC çš„å®ç°æœºåˆ¶\n\nSpring ä¸­çš„ IoC çš„å®ç°åŸç†å°±æ˜¯**å·¥å‚æ¨¡å¼åŠ åå°„**ã€‚\n\n```java\ninterface Fruit {\n    void eat();\n}\n\nclass Apple implements Fruit {\n    public void eat(){\n        System.out.println(\"Apple\");\n    }\n}\n\nclass Orange implements Fruit {\n    public void eat(){\n        System.out.println(\"Orange\");\n    }\n}\n\nclass Factory {\n    public static Fruit getInstance(String className) {\t// ä½¿ç”¨åå°„ï¼Œç”¨å­—ç¬¦ä¸²è·å–åˆ°å®ä¾‹\n        Fruit f=null;\n        try {\n            f = (Fruit) Class.forName(className).newInstance();\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n        return f;\n    }\n}\n\nclass Client {\n    public static void main(String[] a) {\n        Fruit f = Factory.getInstance(\"io.github.dunwu.spring.Apple\");\n        if(f != null){\n            f.eat();\n        }\n    }\n}\n```\n\n### BeanFactory å’Œ ApplicationContextæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\nBeanFactory å’Œ ApplicationContext æ˜¯ Spring çš„ä¸¤å¤§æ ¸å¿ƒæ¥å£ï¼Œéƒ½å¯ä»¥å½“åš Spring çš„å®¹å™¨ã€‚\nApplicationContext æ˜¯ BeanFactory çš„å­æ¥å£ã€‚\n\n1. ä¾èµ–å…³ç³»\n\nBeanFactoryï¼šæ˜¯ Spring é‡Œé¢æœ€åº•å±‚çš„æ¥å£ï¼ŒåŒ…å«äº†å„ç§ Bean çš„å®šä¹‰ï¼Œè¯»å– bean é…ç½®æ–‡æ¡£ï¼Œç®¡ç† bean çš„åŠ è½½ã€å®ä¾‹åŒ–ï¼Œæ§åˆ¶ bean çš„ç”Ÿå‘½å‘¨æœŸï¼Œç»´æŠ¤ bean ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚\n\nApplicationContext æ¥å£ä½œä¸º BeanFactory çš„å­æ¥å£ï¼Œé™¤äº†æä¾› BeanFactory æ‰€å…·æœ‰çš„åŠŸèƒ½å¤–ï¼Œè¿˜æä¾›äº†æ›´å®Œæ•´çš„æ¡†æ¶åŠŸèƒ½ï¼š\n\n- æ”¯æŒå›½é™…åŒ–ã€‚\n- æ”¯æŒè®¿é—®æ–‡ä»¶èµ„æº\n- æ”¯æŒäº‹ä»¶å‘å¸ƒé€šçŸ¥\n- åŒæ—¶åŠ è½½å¤šä¸ªé…ç½®æ–‡ä»¶ã€‚\n\né…ç½®æµç¨‹ï¼š\n\n1. åŠ è½½é…ç½®æ–‡ä»¶ï¼Œè§£ææˆ BeanDefinition æ”¾åœ¨ Map é‡Œï¼Œmap ä¸­å­˜æ”¾`<BeanNameï¼ŒClasså¯¹è±¡>`çš„æ˜ å°„\n2. è°ƒç”¨ getBean çš„æ—¶å€™ï¼Œä» BeanDefinition æ‰€å±çš„ Map é‡Œï¼Œæ‹¿å‡º Class å¯¹è±¡ä½¿ç”¨åå°„è¿›è¡Œå®ä¾‹åŒ–ï¼ŒåŒæ—¶ï¼Œå¦‚æœæœ‰ä¾èµ–å…³ç³»ï¼Œå°†é€’å½’è°ƒç”¨ getBean æ–¹æ³• â€”â€” å®Œæˆä¾èµ–æ³¨å…¥ã€‚\n3. åŠ è½½æ–¹å¼\n\n**BeanFactroy**é‡‡ç”¨çš„æ˜¯**å»¶è¿ŸåŠ è½½**å½¢å¼æ¥æ³¨å…¥ Bean çš„ï¼Œå³åªæœ‰åœ¨ä½¿ç”¨åˆ°æŸä¸ª Bean æ—¶(è°ƒç”¨ getBean())ï¼Œæ‰å¯¹è¯¥ Bean è¿›è¡ŒåŠ è½½å®ä¾‹åŒ–ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±ä¸èƒ½å‘ç°ä¸€äº›å­˜åœ¨çš„ Spring çš„é…ç½®é—®é¢˜ã€‚å¦‚æœ Bean çš„æŸä¸€ä¸ªå±æ€§æ²¡æœ‰æ³¨å…¥æˆ–è€…æ˜¯å±æ€§æ³¨å…¥é”™è¯¯ï¼ŒBeanFacotry åŠ è½½åï¼Œç›´è‡³ç¬¬ä¸€æ¬¡ä½¿ç”¨è°ƒç”¨ getBean æ–¹æ³•æ‰ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚\n\n**ApplicationContext**ï¼Œå®ƒæ˜¯åœ¨å®¹å™¨å¯åŠ¨æ—¶ï¼Œ**ä¸€æ¬¡æ€§åˆ›å»º**äº†æ‰€æœ‰çš„ Beanã€‚è¿™æ ·ï¼Œåœ¨å®¹å™¨å¯åŠ¨æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥**å‘ç°Springä¸­å­˜åœ¨çš„é…ç½®é”™è¯¯**ï¼Œè¿™æ ·æœ‰åˆ©äºæ£€æŸ¥æ‰€ä¾èµ–å±æ€§æ˜¯å¦æ³¨å…¥ã€‚ ApplicationContext å¯åŠ¨åé¢„è½½å…¥æ‰€æœ‰çš„å•å®ä¾‹ Beanï¼Œé€šè¿‡é¢„è½½å…¥å•å®ä¾‹ bean ,ç¡®ä¿å½“ä½ éœ€è¦çš„æ—¶å€™ï¼Œä½ å°±ä¸ç”¨ç­‰å¾…ï¼Œå› ä¸ºå®ƒä»¬å·²ç»åˆ›å»ºå¥½äº†ã€‚\n\nç”±äºåœ¨å®¹å™¨å¯åŠ¨æ—¶ä¸€æ¬¡æ€§åˆ›å»ºæ‰€æœ‰çš„ Beanï¼Œå› æ­¤ ApplicationContext æ›´åŠ å ç”¨å†…å­˜ç©ºé—´ï¼Œå½“é…ç½®çš„ Bean æ¯”è¾ƒå¤šæ—¶ï¼Œç¨‹åºå¯åŠ¨è¾ƒæ…¢ã€‚\n\n#### â­BeanFactoryå’ŒFactoryBeanåŒºåˆ«ï¼Ÿ\n\nBeanFactoryï¼šæ˜¯ spring IoC å®¹å™¨çš„åº•å±‚æ¥å£ï¼Œå¯ä»¥ç”¨æ¥ç®¡ç† bean åŠå…¶ç”Ÿå‘½å‘¨æœŸï¼›\n\nFactoryBeanï¼šå¦‚æœæŸä¸ª bean å®ç°äº† FactoryBean è¿™ä¸ªæ¥å£ï¼Œé€šè¿‡ getBean æ–¹æ³•æ¥è·å– bean çš„æ—¶å€™ï¼Œå¹¶ä¸æ˜¯è¿”å›è‡ªå·±çš„å®ä¾‹ï¼Œè€Œæ˜¯è¿”å›å…¶ getObject() æ–¹æ³•çš„è¿”å›å€¼\n\n### ApplicationContexté€šå¸¸çš„å®ç°æ˜¯ä»€ä¹ˆï¼Ÿ\n\n**FileSystemXmlApplicationContext** ï¼šæ­¤å®¹å™¨ä»ä¸€ä¸ª XML æ–‡ä»¶ä¸­åŠ è½½ beans çš„å®šä¹‰ï¼ŒXML Bean é…ç½®æ–‡ä»¶çš„å…¨è·¯å¾„åå¿…é¡»æä¾›ç»™å®ƒçš„æ„é€ å‡½æ•°ã€‚\n\n**ClassPathXmlApplicationContext**ï¼šæ­¤å®¹å™¨ä¹Ÿä»ä¸€ä¸ª XML æ–‡ä»¶ä¸­åŠ è½½ beans çš„å®šä¹‰ï¼Œè¿™é‡Œï¼Œä½ éœ€è¦æ­£ç¡®è®¾ç½® classpath å› ä¸ºè¿™ä¸ªå®¹å™¨å°†åœ¨ classpath é‡Œæ‰¾ bean é…ç½®ã€‚\n\n**AnnotationConfigApplicationContext**ï¼šå®ƒæ˜¯ç”¨äºè¯»å–æ³¨è§£åˆ›å»ºå®¹å™¨çš„\n\n### ä»€ä¹ˆæ˜¯Springçš„ä¾èµ–æ³¨å…¥ï¼Ÿ\n\nå…·ä½“å«ä¹‰æ˜¯:å½“æŸä¸ªè°ƒç”¨è€…éœ€è¦å¦ä¸€ä¸ªè¢«è°ƒç”¨è€…çš„ååŠ©æ—¶ï¼Œåœ¨ ä¼ ç»Ÿçš„ç¨‹åºè®¾è®¡è¿‡ç¨‹ä¸­ï¼Œé€šå¸¸ç”±è°ƒç”¨è€…æ¥åˆ›å»ºè¢«è°ƒç”¨è€…çš„å®ä¾‹ã€‚ä½†åœ¨ Spring é‡Œï¼Œåˆ›å»ºè¢«è°ƒç”¨è€…çš„å·¥ä½œä¸å†ç”±è°ƒç”¨è€…æ¥å®Œæˆï¼Œå› æ­¤ç§°ä¸ºæ§åˆ¶åè½¬ï¼›åˆ›å»ºè¢«è°ƒç”¨è€… å®ä¾‹çš„å·¥ä½œé€šå¸¸ç”± Spring å®¹å™¨æ¥å®Œæˆï¼Œç„¶åæ³¨å…¥è°ƒç”¨è€…ï¼Œå› æ­¤ä¹Ÿç§°ä¸ºä¾èµ–æ³¨å…¥ã€‚\n\n### ä¾èµ–æ³¨å…¥æœ‰ä»€ä¹ˆä¼˜åŠ¿\n\nä¾èµ–æ³¨å…¥ä¹‹æ‰€ä»¥æ›´æµè¡Œæ˜¯å› ä¸ºå®ƒæ˜¯ä¸€ç§æ›´å¯å–çš„æ–¹å¼ï¼šè®©å®¹å™¨å…¨æƒè´Ÿè´£ä¾èµ–æŸ¥è¯¢ï¼Œå—ç®¡ç»„ä»¶åªéœ€è¦æš´éœ² JavaBean çš„ setter æ–¹æ³•æˆ–è€…å¸¦å‚æ•°çš„æ„é€ å™¨æˆ–è€…æ¥å£ï¼Œä½¿å®¹å™¨å¯ä»¥åœ¨åˆå§‹åŒ–æ—¶ç»„è£…å¯¹è±¡çš„ä¾èµ–å…³ç³»ã€‚å…¶ä¸ä¾èµ–æŸ¥æ‰¾æ–¹å¼ç›¸æ¯”ï¼Œä¸»è¦ä¼˜åŠ¿ä¸ºï¼š\n\n- æŸ¥æ‰¾å®šä½æ“ä½œä¸åº”ç”¨ä»£ç å®Œå…¨æ— å…³ã€‚\n- ä¸ä¾èµ–äºå®¹å™¨çš„ APIï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°åœ¨ä»»ä½•å®¹å™¨ä»¥å¤–ä½¿ç”¨åº”ç”¨å¯¹è±¡ã€‚\n- ä¸éœ€è¦ç‰¹æ®Šçš„æ¥å£ï¼Œç»å¤§å¤šæ•°å¯¹è±¡å¯ä»¥åšåˆ°å®Œå…¨ä¸å¿…ä¾èµ–å®¹å™¨ã€‚\n\n### æœ‰å“ªäº›ä¸åŒç±»å‹çš„ä¾èµ–æ³¨å…¥å®ç°æ–¹å¼ï¼Ÿ\n\n**æ„é€ å™¨ä¾èµ–æ³¨å…¥**ï¼šæ„é€ å™¨ä¾èµ–æ³¨å…¥é€šè¿‡å®¹å™¨è§¦å‘ä¸€ä¸ªç±»çš„æ„é€ å™¨æ¥å®ç°çš„ï¼Œè¯¥ç±»æœ‰ä¸€ç³»åˆ—å‚æ•°ï¼Œæ¯ä¸ªå‚æ•°ä»£è¡¨ä¸€ä¸ªå¯¹å…¶ä»–ç±»çš„ä¾èµ–ã€‚\n\n**Setteræ–¹æ³•æ³¨å…¥**ï¼šSetter æ–¹æ³•æ³¨å…¥æ˜¯å®¹å™¨é€šè¿‡è°ƒç”¨æ— å‚æ„é€ å™¨æˆ–æ— å‚ static å·¥å‚ æ–¹æ³•å®ä¾‹åŒ– bean ä¹‹åï¼Œè°ƒç”¨è¯¥ bean çš„ setter æ–¹æ³•ï¼Œå³å®ç°äº†åŸºäº setter çš„ä¾èµ–æ³¨å…¥ã€‚\n\n### æ„é€ å™¨ä¾èµ–æ³¨å…¥å’Œ setteræ–¹æ³•æ³¨å…¥çš„åŒºåˆ«\n\nï¼ˆéƒ¨åˆ†æ³¨å…¥ï¼‰åœ¨ setter æ³¨å…¥,å¯ä»¥å°†ä¾èµ–é¡¹éƒ¨åˆ†æ³¨å…¥,æ„é€ æ–¹æ³•æ³¨å…¥ä¸èƒ½éƒ¨åˆ†æ³¨å…¥ã€‚\n\nï¼ˆå±æ€§è¦†ç›–ï¼‰å¦‚æœæˆ‘ä»¬ä¸ºåŒä¸€å±æ€§æä¾› setter å’Œæ„é€ æ–¹æ³•æ³¨å…¥ï¼Œsetter æ³¨å…¥å°†è¦†ç›–æ„é€ æ–¹æ³•æ³¨å…¥ã€‚ä½†æ˜¯æ„é€ æ–¹æ³•æ³¨å…¥ä¸èƒ½è¦†ç›– setter æ³¨å…¥å€¼ã€‚æ˜¾ç„¶ï¼Œæ„é€ æ–¹æ³•æ³¨å…¥è¢«ç§°ä¸ºåˆ›å»ºå®ä¾‹çš„ç¬¬ä¸€é€‰é¡¹ã€‚\n\nï¼ˆå¾ªç¯ä¾èµ–ï¼‰åœ¨æ„é€ å‡½æ•°æ³¨å…¥,å¦‚æœ A å’Œ B å¯¹è±¡ç›¸äº’ä¾èµ–ï¼šA ä¾èµ–äº B,B ä¹Ÿä¾èµ–äº A,æ­¤æ—¶åœ¨åˆ›å»ºå¯¹è±¡çš„ A æˆ–è€… B æ—¶ï¼ŒSpring æŠ›å‡º ObjectCurrentlyInCreationExceptionã€‚æ‰€ä»¥ Spring å¯ä»¥é€šè¿‡ setter æ³¨å…¥,ä»è€Œè§£å†³å¾ªç¯ä¾èµ–çš„é—®é¢˜ã€‚\n\n**æœ€å¥½çš„è§£å†³æ–¹æ¡ˆæ˜¯ç”¨æ„é€ å™¨å‚æ•°å®ç°å¼ºåˆ¶ä¾èµ–ï¼Œsetteræ–¹æ³•å®ç°å¯é€‰ä¾èµ–**\n\n### è®²ä¸€è®²Springä¸­çš„å¾ªç¯ä¾èµ–\n\nhttps://www.cnblogs.com/daimzh/p/13256413.html\n\nhttps://blog.csdn.net/weixin_49592546/article/details/108050566\n\n#### ä»€ä¹ˆæ˜¯å¾ªç¯ä¾èµ–ï¼Ÿ\n\n```java\n@Component\npublic class A {\n    // Aä¸­æ³¨å…¥äº†B\n\t@Autowired\n\tprivate B b;\n}\n\n@Component\npublic class B {\n    // Bä¸­ä¹Ÿæ³¨å…¥äº†A\n\t@Autowired\n\tprivate A a;\n}\n```\n\n#### Springæ˜¯å¦‚ä½•è§£å†³çš„å¾ªç¯ä¾èµ–ï¼Ÿ\n\n> ä»¥ä¸‹ï¼š\n>\n> ä½œè€…ï¼šé˜¿é‡Œäº‘äº‘æ –å·\n>\n> é“¾æ¥ï¼šhttps://zhuanlan.zhihu.com/p/368769721\n>\n> æ¥æºï¼šçŸ¥ä¹\n>\n> è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚\n\né¦–å…ˆï¼ŒSpring è§£å†³å¾ªç¯ä¾èµ–æœ‰ä¸¤ä¸ªå‰ææ¡ä»¶ï¼š\n\n1. ä¸å…¨æ˜¯æ„é€ å™¨æ–¹å¼çš„å¾ªç¯ä¾èµ–\n2. å¿…é¡»æ˜¯å•ä¾‹\n\nåŸºäºä¸Šé¢çš„é—®é¢˜ï¼Œæˆ‘ä»¬çŸ¥é“ Bean çš„ç”Ÿå‘½å‘¨æœŸï¼Œæœ¬è´¨ä¸Šè§£å†³å¾ªç¯ä¾èµ–çš„é—®é¢˜å°±æ˜¯ä¸‰çº§ç¼“å­˜ï¼Œé€šè¿‡ä¸‰çº§ç¼“å­˜æå‰æ‹¿åˆ°æœªåˆå§‹åŒ–å®Œå…¨çš„å¯¹è±¡ã€‚\n\n```java\n/** Cache of singleton objects: bean name to bean instance. */\nprivate final Map<String, Object> singletonObjects = new ConcurrentHashMap<>(256);\n/** Cache of early singleton objects: bean name to bean instance. */\nprivate final Map<String, Object> earlySingletonObjects = new HashMap<>(16);\n/** Cache of singleton factories: bean name to ObjectFactory. */\nprivate final Map<String, ObjectFactory<?>> singletonFactories = new HashMap<>(16);\n```\n\nç¬¬ä¸€çº§ç¼“å­˜ï¼šç”¨æ¥ä¿å­˜å®ä¾‹åŒ–ã€åˆå§‹åŒ–éƒ½å®Œæˆçš„å¯¹è±¡\n\nç¬¬äºŒçº§ç¼“å­˜ï¼šç”¨æ¥ä¿å­˜å®ä¾‹åŒ–å®Œæˆï¼Œä½†æ˜¯æœªåˆå§‹åŒ–å®Œæˆçš„å¯¹è±¡\n\nç¬¬ä¸‰çº§ç¼“å­˜ï¼šç”¨æ¥ä¿å­˜ä¸€ä¸ªå¯¹è±¡å·¥å‚ï¼Œæä¾›ä¸€ä¸ªåŒ¿åå†…éƒ¨ç±»ï¼Œç”¨äºåˆ›å»ºäºŒçº§ç¼“å­˜ä¸­çš„å¯¹è±¡\n\n![Springä¸‰çº§ç¼“å­˜](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesv2-dbda6a103e41cde4a54548386d6c1cc2_720w.jpg)\n\nå‡è®¾ä¸€ä¸ªç®€å•çš„å¾ªç¯ä¾èµ–åœºæ™¯ï¼ŒAã€B äº’ç›¸ä¾èµ–ã€‚\n\n![ç®€å•çš„å¾ªç¯ä¾èµ–åœºæ™¯](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesv2-f20f1e81c8011fd99f723127cacf7430_720w.jpg)\n\nA å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹ï¼š\n\n1. åˆ›å»ºå¯¹è±¡ Aï¼Œå®ä¾‹åŒ–çš„æ—¶å€™æŠŠ A å¯¹è±¡å·¥å‚æ”¾å…¥ä¸‰çº§ç¼“å­˜ï¼›\n\n![å®ä¾‹åŒ–å¯¹è±¡A](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesv2-b295374aff4235ee9c0538bf03856217_720w.jpg)\n\n\n\n2. A æ³¨å…¥å±æ€§æ—¶ï¼Œå‘ç°ä¾èµ– Bï¼Œè½¬è€Œå»å®ä¾‹åŒ– B\n\n3. åŒæ ·åˆ›å»ºå¯¹è±¡ Bï¼Œæ³¨å…¥å±æ€§æ—¶å‘ç°ä¾èµ– Aï¼Œä¾æ¬¡ä»ä¸€çº§åˆ°ä¸‰çº§ç¼“å­˜æŸ¥è¯¢ Aï¼Œä»ä¸‰çº§ç¼“å­˜é€šè¿‡å¯¹è±¡å·¥å‚æ‹¿åˆ° Aï¼ŒæŠŠ A æ”¾å…¥äºŒçº§ç¼“å­˜ï¼ŒåŒæ—¶åˆ é™¤ä¸‰çº§ç¼“å­˜ä¸­çš„ Aï¼Œæ­¤æ—¶ï¼ŒB å·²ç»å®ä¾‹åŒ–å¹¶ä¸”åˆå§‹åŒ–å®Œæˆï¼ŒæŠŠ B æ”¾å…¥ä¸€çº§ç¼“å­˜ã€‚\n\n![åˆ›å»ºå¯¹è±¡B](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesv2-51cb735fc6c02c2225d2f38b9b5b6da9_720w.jpg)\n\n4. æ¥ç€ç»§ç»­åˆ›å»º Aï¼Œé¡ºåˆ©ä»ä¸€çº§ç¼“å­˜æ‹¿åˆ°å®ä¾‹åŒ–ä¸”åˆå§‹åŒ–å®Œæˆçš„ B å¯¹è±¡ï¼ŒA å¯¹è±¡åˆ›å»ºä¹Ÿå®Œæˆï¼Œåˆ é™¤äºŒçº§ç¼“å­˜ä¸­çš„ Aï¼ŒåŒæ—¶æŠŠ A æ”¾å…¥ä¸€çº§ç¼“å­˜\n\n5. æœ€åï¼Œä¸€çº§ç¼“å­˜ä¸­ä¿å­˜ç€å®ä¾‹åŒ–ã€åˆå§‹åŒ–éƒ½å®Œæˆçš„ Aã€B å¯¹è±¡\n\n![æœ€ç»ˆç»“æœ](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesv2-a1eaa5d9f8bec23e373dc1b9f86ddb25_720w.jpg)\n\nå› æ­¤ï¼Œç”±äºæŠŠå®ä¾‹åŒ–å’Œåˆå§‹åŒ–çš„æµç¨‹åˆ†å¼€äº†ï¼Œæ‰€ä»¥å¦‚æœéƒ½æ˜¯ç”¨æ„é€ å™¨çš„è¯ï¼Œå°±æ²¡æ³•åˆ†ç¦»è¿™ä¸ªæ“ä½œï¼Œæ‰€ä»¥éƒ½æ˜¯æ„é€ å™¨çš„è¯å°±æ— æ³•è§£å†³å¾ªç¯ä¾èµ–çš„é—®é¢˜äº†ã€‚\n\n### 8. ä¸ºä»€ä¹ˆè¦ä¸‰çº§ç¼“å­˜ï¼ŸäºŒçº§ä¸è¡Œå—ï¼Ÿ\n\nä¸å¯ä»¥ï¼Œä¸»è¦æ˜¯ä¸ºäº†ç”Ÿæˆä»£ç†å¯¹è±¡ã€‚\n\nå› ä¸ºä¸‰çº§ç¼“å­˜ä¸­æ”¾çš„æ˜¯ç”Ÿæˆå…·ä½“å¯¹è±¡çš„å¯¹è±¡å·¥å‚ï¼Œä»–å¯ä»¥ç”Ÿæˆä»£ç†å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥æ˜¯æ™®é€šçš„å®ä¾‹å¯¹è±¡ã€‚\n\nå‡è®¾åªæœ‰äºŒçº§ç¼“å­˜çš„æƒ…å†µï¼Œå¾€äºŒçº§ç¼“å­˜ä¸­æ”¾çš„æ˜¾ç¤ºä¸€ä¸ªæ™®é€šçš„ Bean å¯¹è±¡ï¼Œ`BeanPostProcessor`å»ç”Ÿæˆä»£ç†å¯¹è±¡ä¹‹åï¼Œè¦†ç›–æ‰äºŒçº§ç¼“å­˜ä¸­çš„æ™®é€š Bean å¯¹è±¡ï¼Œé‚£ä¹ˆå¤šçº¿ç¨‹ç¯å¢ƒä¸‹å¯èƒ½å–åˆ°çš„å¯¹è±¡å°±ä¸ä¸€è‡´äº†ã€‚\n\n![Aä»£ç†å¯¹è±¡è¦†ç›–Aæ™®é€šBean](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesv2-e4e9050787017c7272dc313f88af9382_720w.jpg)\n\n\n\n## Spring Beans\n\n### å¦‚ä½•ç»™Spring å®¹å™¨æä¾›é…ç½®å…ƒæ•°æ®ï¼ŸSpringæœ‰å‡ ç§é…ç½®æ–¹å¼\n\nè¿™é‡Œæœ‰ä¸‰ç§é‡è¦çš„æ–¹æ³•ç»™ Spring å®¹å™¨æä¾›é…ç½®å…ƒæ•°æ®ã€‚\n\n- XML é…ç½®æ–‡ä»¶ã€‚\n- åŸºäºæ³¨è§£çš„é…ç½®ã€‚\n- åŸºäº Java çš„é…ç½®ã€‚\n\n### Springé…ç½®æ–‡ä»¶åŒ…å«äº†å“ªäº›ä¿¡æ¯\n\nSpring é…ç½®æ–‡ä»¶æ˜¯ä¸ª XML æ–‡ä»¶ï¼Œé€šè¿‡è¯»å–æŒ‡å®šç±»çš„å…¨é™å®šç±»åã€‚åå°„åˆ›å»ºå¯¹è±¡ï¼Œä¸¢å…¥ ioc å®¹å™¨ä¸­ï¼Œè¯¥å¯¹è±¡å¯ä»¥é€šè¿‡ id æ¥è·å–\n\n### SpringåŸºäºxmlæ³¨å…¥beançš„å‡ ç§æ–¹å¼\n\n1. Set æ–¹æ³•æ³¨å…¥ï¼š`<property name=\"xxx\" value=\"yyy\"/>`\n2. æ„é€ å™¨æ³¨å…¥ï¼š`<construtor-arg type/index/name=\"xxx\" value=\"yyy\"/>`\n3. é™æ€å·¥å‚æ³¨å…¥ï¼›factory-bean factory-method\n4. å®ä¾‹å·¥å‚ï¼› class factory-method\n\n### è§£é‡ŠSpringæ”¯æŒçš„å‡ ç§beançš„ä½œç”¨åŸŸ\n\nSpring æ¡†æ¶æ”¯æŒä»¥ä¸‹äº”ç§ bean çš„ä½œç”¨åŸŸï¼š\n\n- **singleton :** bean åœ¨æ¯ä¸ª Spring ioc å®¹å™¨ä¸­åªæœ‰ä¸€ä¸ªå®ä¾‹ã€‚\n- **prototype**ï¼šä¸€ä¸ª bean çš„å®šä¹‰å¯ä»¥æœ‰å¤šä¸ªå®ä¾‹ã€‚\n- **request**ï¼šæ¯æ¬¡ http è¯·æ±‚éƒ½ä¼šåˆ›å»ºä¸€ä¸ª beanï¼Œè¯¥ä½œç”¨åŸŸä»…åœ¨åŸºäº web çš„ Spring ApplicationContext æƒ…å½¢ä¸‹æœ‰æ•ˆã€‚\n- **session**ï¼šåœ¨ä¸€ä¸ª HTTP Session ä¸­ï¼Œä¸€ä¸ª bean å®šä¹‰å¯¹åº”ä¸€ä¸ªå®ä¾‹ã€‚è¯¥ä½œç”¨åŸŸä»…åœ¨åŸºäº web çš„ Spring ApplicationContext æƒ…å½¢ä¸‹æœ‰æ•ˆã€‚\n- **global-session**ï¼šåœ¨ä¸€ä¸ªå…¨å±€çš„ HTTP Session ä¸­ï¼Œä¸€ä¸ª bean å®šä¹‰å¯¹åº”ä¸€ä¸ªå®ä¾‹ã€‚è¯¥ä½œç”¨åŸŸä»…åœ¨åŸºäº web çš„ Spring ApplicationContext æƒ…å½¢ä¸‹æœ‰æ•ˆã€‚\n\n**æ³¨æ„ï¼š** ç¼ºçœçš„ Spring bean çš„ä½œç”¨åŸŸæ˜¯ singletonã€‚ä½¿ç”¨ prototype ä½œç”¨åŸŸéœ€è¦æ…é‡çš„æ€è€ƒï¼Œå› ä¸ºé¢‘ç¹åˆ›å»ºå’Œé”€æ¯ bean ä¼šå¸¦æ¥å¾ˆå¤§çš„æ€§èƒ½å¼€é”€ã€‚\n\n### Springæ¡†æ¶ä¸­çš„å•ä¾‹beanæ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼Ÿ\n\nä¸æ˜¯ï¼ŒSpring æ¡†æ¶ä¸­çš„å•ä¾‹ bean ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚\n\nspring ä¸­çš„ bean é»˜è®¤æ˜¯å•ä¾‹æ¨¡å¼ï¼Œspring æ¡†æ¶å¹¶æ²¡æœ‰å¯¹å•ä¾‹ bean è¿›è¡Œå¤šçº¿ç¨‹çš„å°è£…å¤„ç†ã€‚\n\nç„¶è€Œï¼Œå®é™…ä¸Šå¤§éƒ¨åˆ†æ—¶å€™ spring bean æ— çŠ¶æ€çš„ï¼ˆæ¯”å¦‚ dao ç±»ï¼‰ï¼Œæ‰€ä»¥æŸç§ç¨‹åº¦ä¸Šæ¥è¯´ bean ä¹Ÿæ˜¯å®‰å…¨çš„ï¼Œä½†å¦‚æœ bean æœ‰çŠ¶æ€çš„è¯ï¼ˆæ¯”å¦‚ view model å¯¹è±¡ï¼‰ï¼Œé‚£å°±è¦å¼€å‘è€…è‡ªå·±å»ä¿è¯çº¿ç¨‹å®‰å…¨äº†ï¼Œæœ€ç®€å•çš„å°±æ˜¯æ”¹å˜ bean çš„ä½œç”¨åŸŸï¼ŒæŠŠâ€œsingletonâ€å˜æ›´ä¸ºâ€œprototypeâ€ï¼Œè¿™æ ·è¯·æ±‚ bean ç›¸å½“äº new Bean()äº†ï¼Œæ‰€ä»¥å°±å¯ä»¥ä¿è¯çº¿ç¨‹å®‰å…¨äº†ã€‚\n\n> æœ‰çŠ¶æ€å°±æ˜¯æœ‰æ•°æ®å­˜å‚¨åŠŸèƒ½\n> æ— çŠ¶æ€å°±æ˜¯ä¸ä¼šä¿å­˜æ•°æ®\n\n### Springå¦‚ä½•å¤„ç†çº¿ç¨‹å¹¶å‘é—®é¢˜ï¼Ÿ\n\n**Springä½¿ç”¨ThreadLocalå¯¹ä¸€äº›Beançš„çº¿ç¨‹å®‰å…¨é—®é¢˜è¿›è¡Œå¤„ç†**ã€‚\n\nThreadLocal å’Œçº¿ç¨‹åŒæ­¥æœºåˆ¶éƒ½æ˜¯ä¸ºäº†è§£å†³å¤šçº¿ç¨‹ä¸­ç›¸åŒå˜é‡çš„è®¿é—®å†²çªé—®é¢˜ã€‚åŒæ­¥æœºåˆ¶é‡‡ç”¨äº†â€œæ—¶é—´æ¢ç©ºé—´â€çš„æ–¹å¼ï¼Œä»…æä¾›ä¸€ä»½å˜é‡ï¼Œä¸åŒçš„çº¿ç¨‹åœ¨è®¿é—®å‰éœ€è¦è·å–é”ï¼Œæ²¡è·å¾—é”çš„çº¿ç¨‹åˆ™éœ€è¦æ’é˜Ÿã€‚è€Œ ThreadLocal é‡‡ç”¨äº†â€œç©ºé—´æ¢æ—¶é—´â€çš„æ–¹å¼ã€‚\n\nThreadLocal ä¼šä¸ºæ¯ä¸€ä¸ªçº¿ç¨‹æä¾›ä¸€ä¸ªç‹¬ç«‹çš„å˜é‡å‰¯æœ¬ï¼Œä»è€Œéš”ç¦»äº†å¤šä¸ªçº¿ç¨‹å¯¹æ•°æ®çš„è®¿é—®å†²çªã€‚å› ä¸ºæ¯ä¸€ä¸ªçº¿ç¨‹éƒ½æ‹¥æœ‰è‡ªå·±çš„å˜é‡å‰¯æœ¬ï¼Œä»è€Œä¹Ÿå°±æ²¡æœ‰å¿…è¦å¯¹è¯¥å˜é‡è¿›è¡ŒåŒæ­¥äº†ã€‚ThreadLocal æä¾›äº†çº¿ç¨‹å®‰å…¨çš„å…±äº«å¯¹è±¡ï¼Œåœ¨ç¼–å†™å¤šçº¿ç¨‹ä»£ç æ—¶ï¼Œå¯ä»¥æŠŠä¸å®‰å…¨çš„å˜é‡å°è£…è¿› ThreadLocalã€‚\n\n### è§£é‡ŠSpringæ¡†æ¶ä¸­beançš„ç”Ÿå‘½å‘¨æœŸ\n\nå‚è€ƒï¼šhttps://www.cnblogs.com/javazhiyin/p/10905294.html\n\n![Springä¸­Beançš„ç”Ÿå‘½å‘¨æœŸ](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes201911012343410.png)\n\n**1ã€å®ä¾‹åŒ–Beanï¼š**\n\nå¯¹äº BeanFactory å®¹å™¨ï¼Œå½“å®¢æˆ·å‘å®¹å™¨è¯·æ±‚ä¸€ä¸ªå°šæœªåˆå§‹åŒ–çš„ bean æ—¶ï¼Œæˆ–åˆå§‹åŒ– bean çš„æ—¶å€™éœ€è¦æ³¨å…¥å¦ä¸€ä¸ªå°šæœªåˆå§‹åŒ–çš„ä¾èµ–æ—¶ï¼Œå®¹å™¨å°±ä¼šè°ƒç”¨ createBean è¿›è¡Œå®ä¾‹åŒ–ã€‚\nå¯¹äº ApplicationContext å®¹å™¨ï¼Œå½“å®¹å™¨å¯åŠ¨ç»“æŸåï¼Œé€šè¿‡è·å– BeanDefinition å¯¹è±¡ä¸­çš„ä¿¡æ¯ï¼Œå®ä¾‹åŒ–æ‰€æœ‰çš„ beanã€‚\n\n**2ã€ä¾èµ–æ³¨å…¥ï¼š**\n\nå®ä¾‹åŒ–åçš„å¯¹è±¡è¢«å°è£…åœ¨ BeanWrapper å¯¹è±¡ä¸­ï¼Œç´§æ¥ç€ï¼ŒSpring æ ¹æ® BeanDefinition ä¸­çš„ä¿¡æ¯ ä»¥åŠ é€šè¿‡ BeanWrapper æä¾›çš„è®¾ç½®å±æ€§çš„æ¥å£å®Œæˆä¾èµ–æ³¨å…¥ã€‚\n\n**3ã€å¤„ç†Awareæ¥å£ï¼ˆé…ç½®Beanå¯¹è±¡çš„idå€¼ã€å·¥å‚/ä¸Šä¸‹æ–‡ï¼‰ï¼š**\n\næ¥ç€ï¼ŒSpring ä¼šæ£€æµ‹è¯¥å¯¹è±¡æ˜¯å¦å®ç°äº† xxxAware æ¥å£ï¼Œå¹¶å°†ç›¸å…³çš„ xxxAware å®ä¾‹æ³¨å…¥ç»™ Beanï¼š\n\n- å¦‚æœè¿™ä¸ª Bean å·²ç»å®ç°äº† BeanNameAware æ¥å£ï¼Œä¼šè°ƒç”¨å®ƒå®ç°çš„ setBeanName(String beanId)æ–¹æ³•ï¼Œæ­¤å¤„ä¼ é€’çš„å°±æ˜¯ Spring é…ç½®æ–‡ä»¶ä¸­ Bean çš„ id å€¼ï¼›\n- å¦‚æœè¿™ä¸ª Bean å·²ç»å®ç°äº† BeanFactoryAware æ¥å£ï¼Œä¼šè°ƒç”¨å®ƒå®ç°çš„ setBeanFactory()æ–¹æ³•ï¼Œä¼ é€’çš„æ˜¯ Spring å·¥å‚è‡ªèº«ï¼›\n- å¦‚æœè¿™ä¸ª Bean å·²ç»å®ç°äº† ApplicationContextAware æ¥å£ï¼Œä¼šè°ƒ setApplicationContext(ApplicationContext)æ–¹æ³•ï¼Œä¼ å…¥ Spring ä¸Šä¸‹æ–‡ï¼›\n\n**4ã€postProcessBeforeInitializationï¼ˆåˆå§‹åŒ–å‰ç½®å¤„ç†ï¼‰ï¼š**\n\nå¦‚æœæƒ³å¯¹ Bean è¿›è¡Œä¸€äº›è‡ªå®šä¹‰çš„å¤„ç†ï¼Œé‚£ä¹ˆå¯ä»¥è®© Bean å®ç°äº† BeanPostProcessor æ¥å£ï¼Œé‚£å°†ä¼šè°ƒç”¨ postProcessBeforeInitialization(Object obj, String s)æ–¹æ³•ã€‚ç”±äºè¿™ä¸ªæ–¹æ³•æ˜¯åœ¨ Bean åˆå§‹åŒ–ç»“æŸæ—¶è°ƒç”¨çš„ï¼Œæ‰€ä»¥å¯ä»¥è¢«åº”ç”¨äºå†…å­˜æˆ–ç¼“å­˜æŠ€æœ¯ï¼›\n\n**5ã€è‡ªå®šä¹‰åˆå§‹åŒ–init-methodï¼š**\n\nå¦‚æœ Bean åœ¨ Spring é…ç½®æ–‡ä»¶ä¸­é…ç½®äº† init-method å±æ€§ï¼Œåˆ™ä¼šè‡ªåŠ¨è°ƒç”¨å…¶é…ç½®çš„**è‡ªå®šä¹‰åˆå§‹åŒ–**æ–¹æ³•ã€‚\n\n**6ã€postProcessAfterInitializationï¼ˆåˆå§‹åŒ–åç½®å¤„ç†ï¼‰**\n\nå¦‚æœè¿™ä¸ª Bean å®ç°äº† BeanPostProcessor æ¥å£ï¼Œå°†ä¼šè°ƒç”¨ postProcessAfterInitialization(Object obj, String s)æ–¹æ³•ï¼Œ**AOPåœ¨è¿™ä¸ªæ—¶å€™è¿›è¡Œä»£ç†å¯¹è±¡çš„åˆ›å»º**ã€‚\n\n**NOW** ä»¥ä¸Šå‡ ä¸ªæ­¥éª¤å®Œæˆåï¼ŒBean å°±å·²ç»è¢«æ­£ç¡®åˆ›å»ºäº†ï¼Œä¹‹åå°±å¯ä»¥ä½¿ç”¨è¿™ä¸ª Bean äº†ã€‚\n\n**7ã€æ¸…ç†é˜¶æ®µdestroyï¼š**\n\nå½“ Bean ä¸å†éœ€è¦æ—¶ï¼Œä¼šè¿›å…¥æ¸…ç†é˜¶æ®µï¼Œå¦‚æœ Bean å®ç°äº† DisposableBean è¿™ä¸ªæ¥å£ï¼Œä¼šè°ƒç”¨å…¶å®ç°çš„ destroy()æ–¹æ³•ï¼›\n\n**8ã€è‡ªå®šä¹‰é”€æ¯destroy-methodï¼š**\n\næœ€åï¼Œå¦‚æœè¿™ä¸ª Bean çš„ Spring é…ç½®ä¸­é…ç½®äº† destroy-method å±æ€§ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨å…¶é…ç½®çš„**è‡ªå®šä¹‰é”€æ¯**æ–¹æ³•ã€‚\n\n### åœ¨ Springä¸­å¦‚ä½•æ³¨å…¥ä¸€ä¸ªJavaé›†åˆï¼Ÿ\n\nç”¨`<list>`æ³¨å…¥ä¸€åˆ—å€¼ï¼Œç”¨`<map>`æ³¨å…¥ä¸€ç»„æ˜ å°„æ•°æ®ã€‚\n\n### ä»€ä¹ˆæ˜¯beanè£…é…ï¼Ÿ\n\né€šè¿‡ bean çš„ä¾èµ–å…³ç³»ï¼Œä½¿ç”¨ä¾èµ–æ³¨å…¥å°† spring ä¸­çš„ bean è£…é…åœ¨ä¸€èµ·ã€‚\nspring å¯ä»¥é€šè¿‡ bean çš„ä¾èµ–å…³ç³»è‡ªåŠ¨å®Œæˆ bean ä¹‹é—´çš„é…ç½®ã€‚\n\n### Spring è‡ªåŠ¨è£…é… bean æœ‰å“ªäº›æ–¹å¼ï¼Ÿ\n\nåœ¨ spring ä¸­ï¼Œå¯¹è±¡æ— éœ€è‡ªå·±æŸ¥æ‰¾æˆ–åˆ›å»ºä¸å…¶å…³è”çš„å…¶ä»–å¯¹è±¡ï¼Œç”±å®¹å™¨è´Ÿè´£æŠŠéœ€è¦ç›¸äº’åä½œçš„å¯¹è±¡å¼•ç”¨èµ‹äºˆå„ä¸ªå¯¹è±¡ã€‚\n\nåœ¨ Spring æ¡†æ¶ xml é…ç½®ä¸­å…±æœ‰ 5 ç§è‡ªåŠ¨è£…é…ï¼š\n\n- noï¼šé»˜è®¤çš„æ–¹å¼æ˜¯ä¸è¿›è¡Œè‡ªåŠ¨è£…é…çš„ï¼Œé€šè¿‡æ‰‹å·¥è®¾ç½® ref å±æ€§æ¥è¿›è¡Œè£…é… beanã€‚\n- byNameï¼šé€šè¿‡ bean çš„åç§°è¿›è¡Œè‡ªåŠ¨è£…é…ï¼Œå¦‚æœä¸€ä¸ª bean çš„ property ä¸å¦ä¸€ bean çš„ name ç›¸åŒï¼Œå°±è¿›è¡Œè‡ªåŠ¨è£…é…ã€‚\n- byTypeï¼šé€šè¿‡å‚æ•°çš„æ•°æ®ç±»å‹è¿›è¡Œè‡ªåŠ¨è£…é…ã€‚\n- constructorï¼šåˆ©ç”¨æ„é€ å‡½æ•°è¿›è¡Œè£…é…ï¼Œå¹¶ä¸”æ„é€ å‡½æ•°çš„å‚æ•°é€šè¿‡ byType è¿›è¡Œè£…é…ã€‚\n- autodetectï¼šè‡ªåŠ¨æ¢æµ‹ï¼Œå¦‚æœæœ‰æ„é€ æ–¹æ³•ï¼Œé€šè¿‡ construct çš„æ–¹å¼è‡ªåŠ¨è£…é…ï¼Œå¦åˆ™ä½¿ç”¨ byType çš„æ–¹å¼è‡ªåŠ¨è£…é…ã€‚\n\n### ä½¿ç”¨@Autowiredæ³¨è§£è‡ªåŠ¨è£…é…çš„è¿‡ç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ\n\nä½¿ç”¨@Autowired æ³¨è§£æ¥è‡ªåŠ¨è£…é…æŒ‡å®šçš„ beanã€‚åœ¨ä½¿ç”¨@Autowired æ³¨è§£ä¹‹å‰éœ€è¦åœ¨ Spring é…ç½®æ–‡ä»¶è¿›è¡Œé…ç½®æ³¨è§£æ‰«æ `<context:annotation-config />`ã€‚\n\nåœ¨å¯åŠ¨ spring IoC æ—¶ï¼Œå®¹å™¨è‡ªåŠ¨è£…è½½äº†ä¸€ä¸ªåç½®å¤„ç†å™¨ï¼Œå½“å®¹å™¨æ‰«æåˆ°@Autowiedã€@Resource æˆ–@Inject æ—¶ï¼Œå°±ä¼šåœ¨ IoC å®¹å™¨è‡ªåŠ¨æŸ¥æ‰¾éœ€è¦çš„ beanï¼Œå¹¶è£…é…ç»™è¯¥å¯¹è±¡çš„å±æ€§ã€‚åœ¨ä½¿ç”¨@Autowired æ—¶ï¼Œé¦–å…ˆåœ¨å®¹å™¨ä¸­**æŸ¥è¯¢å¯¹åº”ç±»å‹**çš„ beanï¼š\n\n- å¦‚æœå¯¹åº”ç±»å‹æŸ¥è¯¢ç»“æœåˆšå¥½ä¸ºä¸€ä¸ªï¼Œå°±å°†è¯¥ bean è£…é…ç»™@Autowired æŒ‡å®šçš„æ•°æ®ï¼›\n- å¦‚æœå¯¹åº”ç±»å‹æŸ¥è¯¢çš„ç»“æœä¸æ­¢ä¸€ä¸ªï¼Œé‚£ä¹ˆ@Autowired ä¼šæ ¹æ®åç§°æ¥æŸ¥æ‰¾ï¼›\n- å¦‚æœä¸Šè¿°æŸ¥æ‰¾çš„ç»“æœä¸ºç©ºæˆ–è€…ä¸æ­¢ä¸€ä¸ªï¼Œé‚£ä¹ˆä¼šæŠ›å‡ºå¼‚å¸¸ã€‚\n\n## Springæ³¨è§£\n\n### ä»€ä¹ˆæ˜¯åŸºäºJavaçš„Springæ³¨è§£é…ç½®? ç»™ä¸€äº›æ³¨è§£çš„ä¾‹å­\n\nåŸºäº Java çš„é…ç½®ï¼Œå…è®¸ä½ åœ¨å°‘é‡çš„ Java æ³¨è§£çš„å¸®åŠ©ä¸‹ï¼Œè¿›è¡Œä½ çš„å¤§éƒ¨åˆ† Spring é…ç½®è€Œéé€šè¿‡ XML æ–‡ä»¶ã€‚\n\nä»¥@Configuration æ³¨è§£ä¸ºä¾‹ï¼Œå®ƒç”¨æ¥æ ‡è®°ç±»å¯ä»¥å½“åšä¸€ä¸ª bean çš„å®šä¹‰ï¼Œè¢« Spring IOC å®¹å™¨ä½¿ç”¨ã€‚\n\nå¦ä¸€ä¸ªä¾‹å­æ˜¯@Bean æ³¨è§£ï¼Œå®ƒè¡¨ç¤ºæ­¤æ–¹æ³•å°†è¦è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œä½œä¸ºä¸€ä¸ª bean æ³¨å†Œè¿› Spring åº”ç”¨ä¸Šä¸‹æ–‡ã€‚\n\n```java\n@Configuration\npublic class StudentConfig {\n    @Bean\n    public StudentBean myStudent() {\n        return new StudentBean();\n    }\n}\n```\n\n### æ€æ ·å¼€å¯æ³¨è§£è£…é…ï¼Ÿ\n\næ³¨è§£è£…é…åœ¨é»˜è®¤æƒ…å†µä¸‹æ˜¯ä¸å¼€å¯çš„ï¼Œä¸ºäº†ä½¿ç”¨æ³¨è§£è£…é…ï¼Œå¿…é¡»åœ¨ Spring é…ç½®æ–‡ä»¶ä¸­é…ç½® `<context:annotation-config/>`ã€‚\n\n### @Component, @Controller, @Repository, @Service æœ‰ä½•åŒºåˆ«ï¼Ÿ\n\n@Componentï¼šè¿™å°† Java ç±»æ ‡è®°ä¸º beanã€‚spring çš„ç»„ä»¶æ‰«ææœºåˆ¶å¯ä»¥å°†å…¶æ‰«æå¹¶å°†å…¶æ³¨å†Œåˆ° IoC å®¹å™¨ä¸­ã€‚\n\n@Controllerï¼šè¿™å°†ä¸€ä¸ªç±»æ ‡è®°ä¸º Spring Web MVC æ§åˆ¶å™¨ã€‚æ ‡æœ‰å®ƒçš„ Bean ä¼šè‡ªåŠ¨å¯¼å…¥åˆ° IoC å®¹å™¨ä¸­ã€‚\n\n@Serviceï¼šæ­¤æ³¨è§£æ˜¯ç»„ä»¶æ³¨è§£çš„ç‰¹åŒ–ã€‚å®ƒä¸ä¼šå¯¹ @Component æ³¨è§£æä¾›ä»»ä½•å…¶ä»–è¡Œä¸ºã€‚æ‚¨å¯ä»¥åœ¨æœåŠ¡å±‚ç±»ä¸­ä½¿ç”¨ @Service è€Œä¸æ˜¯ @Componentï¼Œå› ä¸ºå®ƒä»¥æ›´å¥½çš„æ–¹å¼æŒ‡å®šäº†æ„å›¾ã€‚\n\n@Repositoryï¼šè¿™ä¸ªæ³¨è§£æ˜¯å…·æœ‰ç±»ä¼¼ç”¨é€”å’ŒåŠŸèƒ½çš„ @Component æ³¨è§£çš„ç‰¹åŒ–ã€‚å®ƒä¸º DAO æä¾›äº†é¢å¤–çš„å¥½å¤„ã€‚å®ƒå°† DAO å¯¼å…¥ IoC å®¹å™¨ï¼Œå¹¶ä½¿æœªç»æ£€æŸ¥çš„å¼‚å¸¸æœ‰èµ„æ ¼è½¬æ¢ä¸º Spring DataAccessExceptionã€‚\n\n### @Required æ³¨è§£æœ‰ä»€ä¹ˆä½œç”¨\n\n`@Required`æ³¨è§£ä½œç”¨äº Bean`setter`æ–¹æ³•ä¸Šï¼Œç”¨äºæ£€æŸ¥ä¸€ä¸ª Bean çš„å±æ€§çš„å€¼**åœ¨é…ç½®æœŸé—´æ˜¯å¦è¢«èµ‹äºˆæˆ–è®¾ç½®**ï¼Œå¦‚æœæœªè¢«è®¾ç½®ï¼Œå®¹å™¨å°†æŠ›å‡º BeanInitializationExceptionã€‚ç¤ºä¾‹ï¼š\n\n```java\npublic class Employee {\n    private String name;\n    @Required\n    public void setName(String name){\n        this.name=name;\n    }\n    public string getName(){\n        return name;\n    }\n}\n```\n\n### @Autowiredå’Œ@Resourceä¹‹é—´çš„åŒºåˆ«\n\n@Autowired å¯ç”¨äºï¼šæ„é€ å‡½æ•°ã€æˆå‘˜å˜é‡ã€Setter æ–¹æ³•\n\n@Autowired å’Œ@Resource ä¹‹é—´çš„åŒºåˆ«\n\n- @Autowired é»˜è®¤æ˜¯**æŒ‰ç…§ç±»å‹è£…é…æ³¨å…¥**çš„ï¼Œé»˜è®¤æƒ…å†µä¸‹å®ƒè¦æ±‚ä¾èµ–å¯¹è±¡å¿…é¡»å­˜åœ¨ï¼ˆå¯ä»¥è®¾ç½®å®ƒ required å±æ€§ä¸º falseï¼‰ã€‚\n- @Resource é»˜è®¤æ˜¯**æŒ‰ç…§åç§°æ¥è£…é…æ³¨å…¥**çš„ï¼Œåªæœ‰å½“æ‰¾ä¸åˆ°ä¸åç§°åŒ¹é…çš„ bean æ‰ä¼šæŒ‰ç…§ç±»å‹æ¥è£…é…æ³¨å…¥ã€‚\n\n### @Qualifier æ³¨è§£æœ‰ä»€ä¹ˆä½œç”¨\n\nå½“æ‚¨åˆ›å»ºå¤šä¸ªç›¸åŒç±»å‹çš„ bean å¹¶å¸Œæœ›ä»…ä½¿ç”¨å±æ€§è£…é…å…¶ä¸­ä¸€ä¸ª bean æ—¶ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨@Qualifier æ³¨è§£å’Œ @Autowired é€šè¿‡æŒ‡å®šåº”è¯¥è£…é…å“ªä¸ªç¡®åˆ‡çš„ bean æ¥æ¶ˆé™¤æ­§ä¹‰ã€‚\n\n### @RequestMapping æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ\n\n@RequestMapping æ³¨è§£ç”¨äºå°†ç‰¹å®š HTTP è¯·æ±‚æ–¹æ³•æ˜ å°„åˆ°å°†å¤„ç†ç›¸åº”è¯·æ±‚çš„æ§åˆ¶å™¨ä¸­çš„ç‰¹å®šç±»/æ–¹æ³•ã€‚æ­¤æ³¨é‡Šå¯åº”ç”¨äºä¸¤ä¸ªçº§åˆ«ï¼š\n\n- ç±»çº§åˆ«ï¼šæ˜ å°„è¯·æ±‚çš„ URL\n- æ–¹æ³•çº§åˆ«ï¼šæ˜ å°„ URL ä»¥åŠ HTTP è¯·æ±‚æ–¹æ³•\n\n## Springäº‹åŠ¡\n\n### Springæ”¯æŒçš„äº‹åŠ¡ç®¡ç†ç±»å‹/äº‹åŠ¡å®ç°æ–¹å¼æœ‰å“ªäº›ï¼Ÿ\n\nSpring æ”¯æŒä¸¤ç§ç±»å‹çš„äº‹åŠ¡ç®¡ç†ï¼š\n\n**ç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç†**ï¼šè¿™æ„å‘³ä½ é€šè¿‡ç¼–ç¨‹çš„æ–¹å¼ç®¡ç†äº‹åŠ¡ï¼Œç»™ä½ å¸¦æ¥æå¤§çš„çµæ´»æ€§ï¼Œä½†æ˜¯éš¾ç»´æŠ¤ã€‚\n\n**å£°æ˜å¼äº‹åŠ¡ç®¡ç†**ï¼šè¿™æ„å‘³ç€ä½ å¯ä»¥å°†ä¸šåŠ¡ä»£ç å’Œäº‹åŠ¡ç®¡ç†åˆ†ç¦»ï¼Œä½ åªéœ€ç”¨æ³¨è§£å’Œ XML é…ç½®æ¥ç®¡ç†äº‹åŠ¡ã€‚\n\n### Springäº‹åŠ¡çš„å®ç°æ–¹å¼å’Œå®ç°åŸç†\n\nSpring äº‹åŠ¡çš„æœ¬è´¨å…¶å®å°±æ˜¯æ•°æ®åº“å¯¹äº‹åŠ¡çš„æ”¯æŒï¼Œæ²¡æœ‰æ•°æ®åº“çš„äº‹åŠ¡æ”¯æŒï¼ŒSpring æ˜¯æ— æ³•æä¾›äº‹åŠ¡åŠŸèƒ½çš„ã€‚\n\n```xml\n<!-- 2ã€é…ç½®äº‹åŠ¡çš„é€šçŸ¥ä»¥åŠäº‹åŠ¡çš„å±æ€§-->\n<tx:advice id=\"txAdvice\" transaction-manager=\"transactionManager\">\n<!-- é…ç½®äº‹åŠ¡çš„å±æ€§\nisolationï¼šç”¨äºæŒ‡å®šäº‹åŠ¡çš„éš”ç¦»çº§åˆ«ã€‚é»˜è®¤å€¼æ˜¯DEFAULTï¼Œè¡¨ç¤ºä½¿ç”¨æ•°æ®åº“çš„é»˜è®¤éš”\nç¦»çº§åˆ«ã€‚\npropagationï¼šç”¨äºæŒ‡å®šäº‹åŠ¡çš„ä¼ æ’­è¡Œä¸ºã€‚é»˜è®¤å€¼æ˜¯REQUIRED(å¢åˆ æ”¹)ï¼Œè¡¨ç¤ºä¸€å®šä¼š\næœ‰äº‹åŠ¡ã€‚æŸ¥è¯¢æ–¹æ³•å¯ä»¥é€‰æ‹©SUPPORTSã€‚\nread-onlyï¼šç”¨äºæŒ‡å®šäº‹åŠ¡æ˜¯å¦åªè¯»ã€‚åªæœ‰æŸ¥è¯¢æ–¹æ³•æ‰èƒ½è®¾ç½®ä¸ºtrueã€‚é»˜è®¤å€¼æ˜¯\nfalseï¼Œè¡¨ç¤ºè¯»å†™ã€‚\ntimeoutï¼šç”¨äºæŒ‡å®šäº‹åŠ¡çš„è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤å€¼æ˜¯-1ï¼Œè¡¨ç¤ºæ°¸ä¸è¶…æ—¶ã€‚å¦‚æœæŒ‡å®šäº†æ•°å€¼ï¼Œ\nä»¥ç§’ä¸ºå•ä½ã€‚\nrollback-forï¼šç”¨äºæŒ‡å®šä¸€ä¸ªå¼‚å¸¸ï¼Œå½“äº§ç”Ÿè¯¥å¼‚å¸¸æ—¶ï¼Œäº‹åŠ¡å›æ»šï¼Œäº§ç”Ÿå…¶ä»–å¼‚å¸¸æ—¶ï¼Œ\näº‹åŠ¡ä¸å›æ»šã€‚æ²¡æœ‰é»˜è®¤å€¼ã€‚è¡¨ç¤ºä»»ä½•å¼‚å¸¸éƒ½å›æ»šã€‚\nno-rollback-forï¼šç”¨äºæŒ‡å®šä¸€ä¸ªå¼‚å¸¸ï¼Œå½“äº§ç”Ÿè¯¥å¼‚å¸¸æ—¶ï¼Œäº‹åŠ¡ä¸å›æ»šï¼Œäº§ç”Ÿå…¶ä»–å¼‚å¸¸\næ—¶äº‹åŠ¡å›æ»šã€‚æ²¡æœ‰é»˜è®¤å€¼ã€‚è¡¨ç¤ºä»»ä½•å¼‚å¸¸éƒ½å›æ»šã€‚\n-->\n<tx:attributes>\n    <!--éæŸ¥è¯¢æ–¹æ³•-->\n    <tx:method name=\"*\" propagation=\"REQUIRED\" read-only=\"false\"/>\n    <!--æŸ¥è¯¢æ–¹æ³•-->\n    <tx:method name=\"find*\" propagation=\"SUPPORTS\" read-only=\"true\"/>\n    </tx:attributes>\n</tx:advice>\n```\n\n### è¯´ä¸€ä¸‹Springçš„äº‹åŠ¡ä¼ æ’­è¡Œä¸º\n\nspring äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸ºè¯´çš„æ˜¯ï¼Œå½“å¤šä¸ªäº‹åŠ¡åŒæ—¶å­˜åœ¨çš„æ—¶å€™ï¼Œspring å¦‚ä½•å¤„ç†è¿™äº›äº‹åŠ¡çš„è¡Œä¸ºã€‚\n\n> â‘  **PROPAGATION_REQUIRED**ï¼šå¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œå°±åˆ›å»ºä¸€ä¸ªæ–°äº‹åŠ¡ï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±åŠ å…¥è¯¥äº‹åŠ¡ï¼Œè¯¥è®¾ç½®æ˜¯æœ€å¸¸ç”¨çš„è®¾ç½®ã€‚ï¼ˆé»˜è®¤å€¼ï¼Œé€‚ç”¨äºéæŸ¥è¯¢æ–¹æ³•ï¼Œå¢åˆ æ”¹ï¼‰ï¼ˆäº‹åŠ¡å­˜åœ¨å°±ç”¨ä¸å­˜åœ¨è¦åˆ›å»ºï¼‰\n> â‘¡ **PROPAGATION_SUPPORTS**ï¼šæ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±åŠ å…¥è¯¥äº‹åŠ¡ï¼Œå¦‚æœå½“å‰ä¸å­˜åœ¨äº‹åŠ¡ï¼Œå°±ä»¥éäº‹åŠ¡æ‰§è¡Œã€‚ï¼ˆé€‚ç”¨äºæŸ¥è¯¢æ–¹æ³•ï¼‰ï¼ˆäº‹åŠ¡å­˜åœ¨å°±ç”¨ä¸å­˜åœ¨å°±ä¸ç”¨ï¼‰\n> â‘¢ PROPAGATION_MANDATORYï¼šæ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±åŠ å…¥è¯¥äº‹åŠ¡ï¼Œå¦‚æœå½“å‰ä¸å­˜åœ¨äº‹åŠ¡ï¼Œå°±æŠ›å‡ºå¼‚å¸¸ã€‚\n> â‘£ **PROPAGATION_REQUIRES_NEW**ï¼šåˆ›å»ºæ–°äº‹åŠ¡ï¼Œæ— è®ºå½“å‰å­˜ä¸å­˜åœ¨äº‹åŠ¡ï¼Œéƒ½åˆ›å»ºæ–°äº‹åŠ¡ã€‚ï¼ˆæ°¸è¿œéƒ½è¦æ–°äº‹åŠ¡ï¼‰\n> â‘¤ PROPAGATION_NOT_SUPPORTEDï¼šä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œæ“ä½œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±æŠŠå½“å‰äº‹åŠ¡æŒ‚èµ·ã€‚\n> â‘¥ PROPAGATION_NEVERï¼šä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚\n> â‘¦ PROPAGATION_NESTEDï¼šå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åœ¨åµŒå¥—äº‹åŠ¡å†…æ‰§è¡Œã€‚å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œåˆ™æŒ‰REQUIREDå±æ€§æ‰§è¡Œã€‚\n\n### è¯´ä¸€ä¸‹ spring çš„äº‹åŠ¡éš”ç¦»ï¼Ÿ\n\nspring æœ‰äº”å¤§éš”ç¦»çº§åˆ«ï¼Œé»˜è®¤å€¼ä¸º ISOLATION_DEFAULTï¼ˆä½¿ç”¨æ•°æ®åº“çš„è®¾ç½®ï¼‰ï¼Œå…¶ä»–å››ä¸ªéš”ç¦»çº§åˆ«å’Œæ•°æ®åº“çš„éš”ç¦»çº§åˆ«ä¸€è‡´ï¼š\n\n1. ISOLATION_DEFAULTï¼šç”¨åº•å±‚æ•°æ®åº“çš„è®¾ç½®éš”ç¦»çº§åˆ«ï¼Œæ•°æ®åº“è®¾ç½®çš„æ˜¯ä»€ä¹ˆæˆ‘å°±ç”¨ä»€ä¹ˆï¼›\n2. ISOLATION_READ_UNCOMMITTEDï¼šè¯»æœªæäº¤ï¼Œæœ€ä½éš”ç¦»çº§åˆ«ã€äº‹åŠ¡æœªæäº¤å‰ï¼Œå°±å¯è¢«å…¶ä»–äº‹åŠ¡è¯»å–ï¼ˆä¼šå‡ºç°è„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»ï¼‰ï¼›\n3. ISOLATION_READ_COMMITTEDï¼šè¯»å·²æäº¤ï¼Œä¸€ä¸ªäº‹åŠ¡æäº¤åæ‰èƒ½è¢«å…¶ä»–äº‹åŠ¡è¯»å–åˆ°ï¼ˆä¼šé€ æˆä¸å¯é‡å¤è¯»ã€å¹»è¯»ï¼‰ï¼ŒSQL server çš„é»˜è®¤çº§åˆ«ï¼›\n4. ISOLATION_REPEATABLE_READï¼šå¯é‡å¤è¯»ï¼Œä¿è¯å¤šæ¬¡è¯»å–åŒä¸€ä¸ªæ•°æ®æ—¶ï¼Œå…¶å€¼éƒ½å’Œäº‹åŠ¡å¼€å§‹æ—¶å€™çš„å†…å®¹æ˜¯ä¸€è‡´ï¼Œç¦æ­¢è¯»å–åˆ°åˆ«çš„äº‹åŠ¡æœªæäº¤çš„æ•°æ®ï¼ˆä¼šé€ æˆå¹»è¯»ï¼‰ï¼ŒMySQL çš„é»˜è®¤çº§åˆ«ï¼›\n5. ISOLATION_SERIALIZABLEï¼šåºåˆ—åŒ–ï¼Œä»£ä»·æœ€é«˜æœ€å¯é çš„éš”ç¦»çº§åˆ«ï¼Œè¯¥éš”ç¦»çº§åˆ«èƒ½é˜²æ­¢è„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»ã€‚\n\n## Springé¢å‘åˆ‡é¢ç¼–ç¨‹(AOP)\n\n### ä»€ä¹ˆæ˜¯AOP\n\nOOP(Object-Oriented Programming)é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œå…è®¸å¼€å‘è€…å®šä¹‰çºµå‘çš„å…³ç³»ï¼Œä½†å¹¶é€‚ç”¨äºå®šä¹‰æ¨ªå‘çš„å…³ç³»ï¼Œå¯¼è‡´äº†å¤§é‡ä»£ç çš„é‡å¤ï¼Œè€Œä¸åˆ©äºå„ä¸ªæ¨¡å—çš„é‡ç”¨ã€‚\n\nAOP(Aspect-Oriented Programming)ï¼Œä¸€èˆ¬ç§°ä¸ºé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œä½œä¸ºé¢å‘å¯¹è±¡çš„ä¸€ç§è¡¥å……ï¼Œå°†ä¸€äº›**å…¬å…±è¡Œä¸ºå’Œé€»è¾‘ï¼ŒæŠ½å–å¹¶å°è£…ä¸ºä¸€ä¸ªå¯é‡ç”¨çš„æ¨¡å—ï¼Œå‡å°‘ç³»ç»Ÿä¸­çš„é‡å¤ä»£ç ï¼Œé™ä½äº†æ¨¡å—é—´çš„è€¦åˆåº¦ï¼ŒåŒæ—¶æé«˜äº†ç³»ç»Ÿçš„å¯ç»´æŠ¤æ€§ã€‚å¯ç”¨äºæƒé™è®¤è¯ã€æ—¥å¿—ã€äº‹åŠ¡å¤„ç†ç­‰**ã€‚\n\n### Spring AOP and AspectJ AOP æœ‰ä»€ä¹ˆåŒºåˆ«ï¼ŸAOP æœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ\n\nAOP å®ç°çš„å…³é”®åœ¨äº ä»£ç†æ¨¡å¼ï¼ŒAOP ä»£ç†ä¸»è¦åˆ†ä¸ºé™æ€ä»£ç†ï¼ˆAspectJï¼‰å’ŒåŠ¨æ€ä»£ç†ï¼ˆSpring AOPï¼‰ã€‚\n\nï¼ˆ1ï¼‰AspectJ é‡‡ç”¨é™æ€ä»£ç†æ¨¡å¼ï¼Œå±äº**ç¼–è¯‘æ—¶å¢å¼º**ï¼Œä¼šåœ¨ç¼–è¯‘é˜¶æ®µç»‡å…¥åˆ‡é¢ç”Ÿæˆç›¸åº”çš„ä»£ç†å¯¹è±¡\n\nï¼ˆ2ï¼‰Spring AOP é‡‡ç”¨åŠ¨æ€ä»£ç†æ¨¡å¼ï¼Œå±äº**è¿è¡Œæ—¶å¢å¼º**ï¼Œæ¯æ¬¡è¿è¡Œæ—¶ç»‡å…¥åˆ‡é¢åœ¨å†…å­˜ä¸­ä¸´æ—¶ç”Ÿæˆç›¸åº”çš„ä»£ç†å¯¹è±¡\n\n### JDKåŠ¨æ€ä»£ç†å’ŒCGLIBåŠ¨æ€ä»£ç†çš„åŒºåˆ«\n\nJDK åŠ¨æ€ä»£ç†ä¸»è¦æ˜¯é’ˆå¯¹ç±»å®ç°äº†æŸä¸ªæ¥å£ï¼ŒAOP åˆ™ä¼šä½¿ç”¨ JDK åŠ¨æ€ä»£ç†ã€‚åŸºäºåå°„çš„æœºåˆ¶å®ç°ï¼Œç”Ÿæˆä¸€ä¸ªå®ç°è¯¥æ¥å£çš„ä¸€ä¸ªä»£ç†ç±»ï¼Œç„¶åé€šè¿‡é‡å†™æ–¹æ³•çš„æ–¹å¼ï¼Œå®ç°å¯¹ä»£ç çš„å¢å¼ºã€‚\n\nè€Œå¦‚æœæŸä¸ªç±»æ²¡æœ‰å®ç°æ¥å£ï¼ŒAOP åˆ™ä¼šä½¿ç”¨ CGLIB ä»£ç†ã€‚åº•å±‚åŸç†æ˜¯**åŸºäº asm ç¬¬ä¸‰æ–¹æ¡†æ¶**ï¼Œé€šè¿‡ä¿®æ”¹å­—èŠ‚ç ç”Ÿæˆä¸€ä¸ªå­ç±»ï¼Œç„¶åé‡å†™çˆ¶ç±»çš„æ–¹æ³•ï¼Œå®ç°å¯¹ä»£ç çš„å¢å¼ºã€‚\n\n> ä½œè€…ï¼šé˜¿é‡Œäº‘äº‘æ –å·\n>\n> é“¾æ¥ï¼šhttps://zhuanlan.zhihu.com/p/368769721\n>\n> æ¥æºï¼šçŸ¥ä¹\n>\n> è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚\n\n### è§£é‡Šä¸€ä¸‹Spring AOPé‡Œé¢çš„å‡ ä¸ªåè¯\n\nï¼ˆ1ï¼‰åˆ‡é¢ï¼ˆAspectï¼‰ï¼šåˆ‡é¢æ˜¯é€šçŸ¥å’Œåˆ‡ç‚¹çš„ç»“åˆã€‚ åœ¨ Spring AOP ä¸­ï¼Œåˆ‡é¢å¯ä»¥ä½¿ç”¨é€šç”¨ç±»ï¼ˆåŸºäºæ¨¡å¼çš„é£æ ¼ï¼‰ æˆ–è€…åœ¨æ™®é€šç±»ä¸­ä»¥ @AspectJ æ³¨è§£æ¥å®ç°ã€‚\n\nï¼ˆ2ï¼‰è¿æ¥ç‚¹ï¼ˆJoin pointï¼‰ï¼šæ–¹æ³•\n\nï¼ˆ3ï¼‰é€šçŸ¥ï¼ˆAdviceï¼‰ï¼šåœ¨è¦å¢å¼ºä¸Šçš„è¿æ¥ç‚¹ä¸Šè¦è¿›è¡Œæ€æ ·çš„å¢å¼º\n\nï¼ˆ4ï¼‰åˆ‡å…¥ç‚¹ï¼ˆPointcutï¼‰ï¼šå“ªäº›è¿æ¥ç‚¹éœ€è¦å¢å¼º\n\nï¼ˆ5ï¼‰ç›®æ ‡å¯¹è±¡ï¼ˆTarget Objectï¼‰ï¼š è¢«ä»£ç†ï¼ˆproxiedï¼‰ å¯¹è±¡ã€‚\n\nï¼ˆ6ï¼‰ç»‡å…¥ï¼ˆWeavingï¼‰ï¼šç»‡å…¥æ˜¯æŠŠåˆ‡é¢åº”ç”¨åˆ°ç›®æ ‡å¯¹è±¡å¹¶åˆ›å»ºæ–°çš„ä»£ç†å¯¹è±¡çš„è¿‡ç¨‹ã€‚\n\nï¼ˆ7ï¼‰Proxyï¼ˆä»£ç†ï¼‰ï¼šä¸€ä¸ªç±»è¢« AOP ç»‡å…¥å¢å¼ºåï¼Œå°±äº§ç”Ÿä¸€ä¸ªç»“æœä»£ç†ç±»ã€‚\n\n> - ç¼–è¯‘æœŸï¼šåˆ‡é¢åœ¨ç›®æ ‡ç±»ç¼–è¯‘æ—¶è¢«ç»‡å…¥ã€‚AspectJçš„ç»‡å…¥ç¼–è¯‘å™¨æ˜¯ä»¥è¿™ç§æ–¹å¼ç»‡å…¥åˆ‡é¢çš„ã€‚\n> - ç±»åŠ è½½æœŸï¼šåˆ‡é¢åœ¨ç›®æ ‡ç±»åŠ è½½åˆ°JVMæ—¶è¢«ç»‡å…¥ã€‚éœ€è¦ç‰¹æ®Šçš„ç±»åŠ è½½å™¨ï¼Œå®ƒå¯ä»¥åœ¨ç›®æ ‡ç±»è¢«å¼•å…¥åº”ç”¨ä¹‹å‰å¢å¼ºè¯¥ç›®æ ‡ç±»çš„å­—èŠ‚ç ã€‚AspectJ5çš„åŠ è½½æ—¶ç»‡å…¥å°±æ”¯æŒä»¥è¿™ç§æ–¹å¼ç»‡å…¥åˆ‡é¢ã€‚\n> - è¿è¡ŒæœŸï¼šåˆ‡é¢åœ¨åº”ç”¨è¿è¡Œçš„æŸä¸ªæ—¶åˆ»è¢«ç»‡å…¥ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œåœ¨ç»‡å…¥åˆ‡é¢æ—¶ï¼ŒAOPå®¹å™¨ä¼šä¸ºç›®æ ‡å¯¹è±¡åŠ¨æ€åœ°åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡ã€‚SpringAOPå°±æ˜¯ä»¥è¿™ç§æ–¹å¼ç»‡å…¥åˆ‡é¢ã€‚\n\n### Springé€šçŸ¥æœ‰å“ªäº›ç±»å‹ï¼Ÿ\n\nåœ¨ AOP æœ¯è¯­ä¸­ï¼Œåˆ‡é¢çš„å·¥ä½œè¢«ç§°ä¸ºé€šçŸ¥ï¼Œå®é™…ä¸Šæ˜¯ç¨‹åºæ‰§è¡Œæ—¶è¦é€šè¿‡ SpringAOP æ¡†æ¶è§¦å‘çš„ä»£ç æ®µã€‚\n\nSpring åˆ‡é¢å¯ä»¥åº”ç”¨ 5 ç§ç±»å‹çš„é€šçŸ¥ï¼š\n\n1. å‰ç½®é€šçŸ¥ï¼ˆBeforeï¼‰ï¼šåœ¨ç›®æ ‡æ–¹æ³•è¢«è°ƒç”¨ä¹‹å‰è°ƒç”¨é€šçŸ¥åŠŸèƒ½ï¼›\n2. åç½®é€šçŸ¥ï¼ˆAfterï¼‰ï¼šåœ¨ç›®æ ‡æ–¹æ³•å®Œæˆä¹‹åè°ƒç”¨é€šçŸ¥ï¼Œæ­¤æ—¶ä¸ä¼šå…³å¿ƒæ–¹æ³•çš„è¾“å‡ºæ˜¯ä»€ä¹ˆï¼›\n3. è¿”å›é€šçŸ¥ï¼ˆAfter-returning ï¼‰ï¼šåœ¨ç›®æ ‡æ–¹æ³•æˆåŠŸæ‰§è¡Œä¹‹åè°ƒç”¨é€šçŸ¥ï¼›\n4. å¼‚å¸¸é€šçŸ¥ï¼ˆAfter-throwingï¼‰ï¼šåœ¨ç›®æ ‡æ–¹æ³•æŠ›å‡ºå¼‚å¸¸åè°ƒç”¨é€šçŸ¥ï¼›\n5. ç¯ç»•é€šçŸ¥ï¼ˆAroundï¼‰ï¼šé€šçŸ¥åŒ…è£¹äº†è¢«é€šçŸ¥çš„æ–¹æ³•ï¼Œåœ¨è¢«é€šçŸ¥çš„æ–¹æ³•è°ƒç”¨ä¹‹å‰å’Œè°ƒç”¨ä¹‹åæ‰§è¡Œè‡ªå®šä¹‰çš„è¡Œä¸ºã€‚\n\n> åŒä¸€ä¸ªaspectï¼Œä¸åŒadviceçš„æ‰§è¡Œé¡ºåºï¼š\n>\n> â‘ æ²¡æœ‰å¼‚å¸¸æƒ…å†µä¸‹çš„æ‰§è¡Œé¡ºåºï¼š\n>\n> around before advice\tæ–¹æ³•è°ƒç”¨ä¹‹å‰è‡ªå®šä¹‰è¡Œä¸º\n> before advice\n> target method æ‰§è¡Œ\n> around after advice\tæ–¹æ³•è°ƒç”¨åè‡ªå®šä¹‰è¡Œä¸º\n> after advice\n> afterReturning\n>\n> â‘¡æœ‰å¼‚å¸¸æƒ…å†µä¸‹çš„æ‰§è¡Œé¡ºåºï¼š\n>\n> around before advice\n> before advice\n> target method æ‰§è¡Œ\n> around after advice\n> after advice\n> afterThrowing:å¼‚å¸¸å‘ç”Ÿ\n> Java.lang.RuntimeException: å¼‚å¸¸å‘ç”Ÿ\n\n### ä»€ä¹ˆæ˜¯åˆ‡é¢ Aspectï¼Ÿ\n\naspect ç”± pointcount å’Œ advice ç»„æˆï¼Œåˆ‡é¢æ˜¯é€šçŸ¥å’Œåˆ‡ç‚¹çš„ç»“åˆã€‚ \nAOP çš„å·¥ä½œé‡å¿ƒåœ¨äºå¦‚ä½•å°†å¢å¼ºç¼–ç»‡ç›®æ ‡å¯¹è±¡çš„è¿æ¥ç‚¹ä¸Š, è¿™é‡ŒåŒ…å«ä¸¤ä¸ªå·¥ä½œ:  \n\n- å¦‚ä½•é€šè¿‡ pointcut å’Œ advice å®šä½åˆ°ç‰¹å®šçš„ joinpoint ä¸Š\n- å¦‚ä½•åœ¨ advice ä¸­ç¼–å†™åˆ‡é¢ä»£ç \n\nå¯ä»¥ç®€å•åœ°è®¤ä¸º, ä½¿ç”¨ @Aspect æ³¨è§£çš„ç±»å°±æ˜¯åˆ‡é¢\n\n![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes2020021212264438.png)\n","slug":"Javaå…«è‚¡æ–‡ - Spring","published":1,"updated":"2023-01-26T12:35:58.975Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cldzfw322000ht9t8001aa5cu","content":"<blockquote>\n<p>æ•´ç†çš„Springæ¡†æ¶ç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½\t<span id=\"more\"></span></p>\n</blockquote>\n<h2 id=\"Springæ¦‚è¿°\"><a href=\"#Springæ¦‚è¿°\" class=\"headerlink\" title=\"Springæ¦‚è¿°\"></a>Springæ¦‚è¿°</h2><h3 id=\"ä»€ä¹ˆæ˜¯spring\"><a href=\"#ä»€ä¹ˆæ˜¯spring\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯spring?\"></a>ä»€ä¹ˆæ˜¯spring?</h3><p>Spring æ˜¯<strong>ä¸€ä¸ªè½»é‡çº§Javaå¼€å‘æ¡†æ¶</strong>ï¼Œç›®çš„æ˜¯ä¸ºäº†è§£å†³å¼€å‘ä¸­çš„<strong>ä¸šåŠ¡é€»è¾‘å±‚å’Œå…¶ä»–å„å±‚çš„è€¦åˆé—®é¢˜</strong>ï¼Œç®€åŒ– Java å¼€å‘ã€‚</p>\n<h3 id=\"Springæ¡†æ¶çš„æ ¸å¿ƒæ˜¯ä»€ä¹ˆ\"><a href=\"#Springæ¡†æ¶çš„æ ¸å¿ƒæ˜¯ä»€ä¹ˆ\" class=\"headerlink\" title=\"Springæ¡†æ¶çš„æ ¸å¿ƒæ˜¯ä»€ä¹ˆ\"></a>Springæ¡†æ¶çš„æ ¸å¿ƒæ˜¯ä»€ä¹ˆ</h3><p><strong>Springæ¡†æ¶çš„æ ¸å¿ƒ</strong>ï¼šIoC å®¹å™¨å’Œ AOP æ¨¡å—ã€‚<br>é€šè¿‡ IoC å®¹å™¨ç®¡ç† Java Bean å¯¹è±¡åŠå…¶ç”Ÿå‘½å‘¨æœŸä»¥åŠä»–ä»¬ä¹‹é—´çš„è€¦åˆå…³ç³»ï¼›<br>é€šè¿‡ AOP å°†ä¸€äº›å…¬å…±è¡Œä¸ºå’Œé€»è¾‘ï¼ŒæŠ½å–å¹¶å°è£…ä¸ºä¸€ä¸ªå¯é‡ç”¨çš„æ¨¡å—ï¼Œå‡å°‘ç³»ç»Ÿä¸­çš„é‡å¤ä»£ç ï¼Œé™ä½æ¨¡å—é—´çš„è€¦åˆåº¦</p>\n<h3 id=\"Springçš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#Springçš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"Springçš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>Springçš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>ä¼˜ç‚¹</p>\n<ul>\n<li><p>æ–¹ä¾¿è§£è€¦ï¼Œç®€åŒ–å¼€å‘ï¼ˆ<strong>IoC</strong>ï¼‰</p>\n<p>  Spring å°±æ˜¯ä¸€ä¸ªå¤§å·¥å‚ï¼Œå¯ä»¥å°†æ‰€æœ‰å¯¹è±¡çš„åˆ›å»ºå’Œä¾èµ–å…³ç³»çš„ç»´æŠ¤ï¼Œäº¤ç»™ Spring ç®¡ç†ã€‚</p>\n</li>\n<li><p>AOP ç¼–ç¨‹çš„æ”¯æŒï¼ˆ<strong>AOP</strong>ï¼‰</p>\n<p>  Spring æä¾›é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œå¯ä»¥æ–¹ä¾¿çš„å®ç°å¯¹ç¨‹åºè¿›è¡Œæƒé™æ‹¦æˆªã€è¿è¡Œç›‘æ§ç­‰åŠŸèƒ½ã€‚</p>\n</li>\n<li><p>å£°æ˜å¼äº‹åŠ¡çš„æ”¯æŒï¼ˆ<strong>äº‹åŠ¡</strong>ï¼‰</p>\n<p>  åªéœ€è¦é€šè¿‡é…ç½®å°±å¯ä»¥å®Œæˆå¯¹äº‹åŠ¡çš„ç®¡ç†ï¼Œè€Œæ— éœ€æ‰‹åŠ¨ç¼–ç¨‹ã€‚</p>\n</li>\n<li><p>æ–¹ä¾¿é›†æˆå„ç§ä¼˜ç§€æ¡†æ¶ï¼ˆ<strong>é›†æˆ</strong>ï¼‰</p>\n<p>  Spring ä¸æ’æ–¥å„ç§ä¼˜ç§€çš„å¼€æºæ¡†æ¶ï¼Œå…¶å†…éƒ¨æä¾›äº†å¯¹å„ç§ä¼˜ç§€æ¡†æ¶çš„ç›´æ¥æ”¯æŒï¼ˆå¦‚ï¼šStrutsã€Hibernateã€MyBatis ç­‰ï¼‰ã€‚</p>\n</li>\n</ul>\n<p>ç¼ºç‚¹</p>\n<ul>\n<li>Spring<strong>ä¾èµ–åå°„ï¼Œåå°„å½±å“æ€§èƒ½</strong></li>\n</ul>\n<h3 id=\"Spring-æ¡†æ¶ä¸­éƒ½ç”¨åˆ°äº†å“ªäº›è®¾è®¡æ¨¡å¼ï¼Ÿ\"><a href=\"#Spring-æ¡†æ¶ä¸­éƒ½ç”¨åˆ°äº†å“ªäº›è®¾è®¡æ¨¡å¼ï¼Ÿ\" class=\"headerlink\" title=\"Spring æ¡†æ¶ä¸­éƒ½ç”¨åˆ°äº†å“ªäº›è®¾è®¡æ¨¡å¼ï¼Ÿ\"></a>Spring æ¡†æ¶ä¸­éƒ½ç”¨åˆ°äº†å“ªäº›è®¾è®¡æ¨¡å¼ï¼Ÿ</h3><ol>\n<li>å·¥å‚æ¨¡å¼ï¼šé€šè¿‡ BeanFactory å’Œ ApplicationContext æ¥ç®¡ç† Bean å¯¹è±¡ã€‚</li>\n<li>å•ä¾‹æ¨¡å¼ï¼šBean é»˜è®¤ä¸ºå•ä¾‹æ¨¡å¼ã€‚</li>\n<li>ä»£ç†æ¨¡å¼ï¼šSpring çš„ AOP åŠŸèƒ½ç”¨åˆ°äº†åŸºäºæ¥å£çš„ JDK çš„åŠ¨æ€ä»£ç†å’ŒåŸºäºå­ç±»çš„ CGLIB åŠ¨æ€ä»£ç†ï¼›</li>\n</ol>\n<h3 id=\"Springæ¡†æ¶ä¸­æœ‰å“ªäº›ä¸åŒç±»å‹çš„äº‹ä»¶\"><a href=\"#Springæ¡†æ¶ä¸­æœ‰å“ªäº›ä¸åŒç±»å‹çš„äº‹ä»¶\" class=\"headerlink\" title=\"Springæ¡†æ¶ä¸­æœ‰å“ªäº›ä¸åŒç±»å‹çš„äº‹ä»¶\"></a>Springæ¡†æ¶ä¸­æœ‰å“ªäº›ä¸åŒç±»å‹çš„äº‹ä»¶</h3><p><strong>Springçš„ApplicationContext æä¾›äº†æ”¯æŒäº‹ä»¶å’Œä»£ç ä¸­ç›‘å¬å™¨çš„åŠŸèƒ½ã€‚</strong>  </p>\n<p>å¦‚æœä¸€ä¸ª bean å®ç°äº†<code>ApplicationListener</code>æ¥å£ï¼Œå½“ä¸€ä¸ª<code>ApplicationEvent</code> è¢«å‘å¸ƒä»¥åï¼Œbean ä¼šè‡ªåŠ¨è¢«é€šçŸ¥ã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public <span class=\"keyword\">class</span> <span class=\"title class_\">AllApplicationEventListener</span> implements <span class=\"title class_\">ApplicationListener</span> &lt; <span class=\"title class_\">ApplicationEvent</span> &gt;&#123;</span><br><span class=\"line\">    @<span class=\"title class_\">Override</span></span><br><span class=\"line\">    public <span class=\"keyword\">void</span> <span class=\"title function_\">onApplicationEvent</span>(<span class=\"params\">ApplicationEvent applicationEvent</span>)&#123;</span><br><span class=\"line\">        <span class=\"comment\">//process event</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>Spring æä¾›äº†ä»¥ä¸‹5ç§æ ‡å‡†çš„äº‹ä»¶ï¼š</strong></p>\n<ul>\n<li>ä¸Šä¸‹æ–‡æ›´æ–°äº‹ä»¶ï¼ˆContextRefreshedEventï¼‰ï¼šè¯¥äº‹ä»¶ä¼šåœ¨ ApplicationContext è¢«åˆå§‹åŒ–æˆ–è€…æ›´æ–°æ—¶å‘å¸ƒã€‚ä¹Ÿå¯ä»¥åœ¨è°ƒç”¨<code>ConfigurableApplicationContext</code> æ¥å£ä¸­çš„<code>refresh()</code>æ–¹æ³•æ—¶è¢«è§¦å‘ã€‚</li>\n<li>ä¸Šä¸‹æ–‡å¼€å§‹äº‹ä»¶ï¼ˆContextStartedEventï¼‰ï¼šå½“å®¹å™¨è°ƒç”¨<code>ConfigurableApplicationContext</code>çš„<code>Start()</code>æ–¹æ³•å¼€å§‹&#x2F;é‡æ–°å¼€å§‹å®¹å™¨æ—¶è§¦å‘è¯¥äº‹ä»¶ã€‚</li>\n<li>ä¸Šä¸‹æ–‡åœæ­¢äº‹ä»¶ï¼ˆContextStoppedEventï¼‰ï¼šå½“å®¹å™¨è°ƒç”¨<code>ConfigurableApplicationContext</code>çš„<code>Stop()</code>æ–¹æ³•åœæ­¢å®¹å™¨æ—¶è§¦å‘è¯¥äº‹ä»¶ã€‚</li>\n<li>ä¸Šä¸‹æ–‡å…³é—­äº‹ä»¶ï¼ˆContextClosedEventï¼‰ï¼šå½“<code>ApplicationContext</code>è¢«å…³é—­æ—¶è§¦å‘è¯¥äº‹ä»¶ã€‚å®¹å™¨è¢«å…³é—­æ—¶ï¼Œå…¶ç®¡ç†çš„æ‰€æœ‰å•ä¾‹ Bean éƒ½è¢«é”€æ¯ã€‚</li>\n<li>è¯·æ±‚å¤„ç†äº‹ä»¶ï¼ˆRequestHandledEventï¼‰ï¼šåœ¨ Web åº”ç”¨ä¸­ï¼Œå½“ä¸€ä¸ª http è¯·æ±‚ï¼ˆrequestï¼‰ç»“æŸè§¦å‘è¯¥äº‹ä»¶ã€‚</li>\n</ul>\n<h3 id=\"Spring-åº”ç”¨ç¨‹åºæœ‰å“ªäº›ä¸åŒç»„ä»¶ï¼Ÿ\"><a href=\"#Spring-åº”ç”¨ç¨‹åºæœ‰å“ªäº›ä¸åŒç»„ä»¶ï¼Ÿ\" class=\"headerlink\" title=\"Spring åº”ç”¨ç¨‹åºæœ‰å“ªäº›ä¸åŒç»„ä»¶ï¼Ÿ\"></a>Spring åº”ç”¨ç¨‹åºæœ‰å“ªäº›ä¸åŒç»„ä»¶ï¼Ÿ</h3><p>Spring åº”ç”¨ä¸€èˆ¬æœ‰ä»¥ä¸‹ç»„ä»¶ï¼š</p>\n<ul>\n<li>Bean ç±» - å®ƒåŒ…å«å±æ€§ï¼Œsetter å’Œ getter æ–¹æ³•ï¼Œå‡½æ•°ç­‰ã€‚</li>\n<li>Bean é…ç½®æ–‡ä»¶ - åŒ…å«ç±»çš„ä¿¡æ¯ä»¥åŠå¦‚ä½•é…ç½®å®ƒä»¬ã€‚</li>\n<li>æ¥å£ - å¤„ç† Bean </li>\n<li>ç”¨æˆ·ç¨‹åº - å®ƒä½¿ç”¨æ¥å£ã€‚</li>\n</ul>\n<h2 id=\"Springæ§åˆ¶åè½¬-IOC\"><a href=\"#Springæ§åˆ¶åè½¬-IOC\" class=\"headerlink\" title=\"Springæ§åˆ¶åè½¬(IOC)\"></a>Springæ§åˆ¶åè½¬(IOC)</h2><h3 id=\"ä»€ä¹ˆæ˜¯Spring-IOC-å®¹å™¨ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯Spring-IOC-å®¹å™¨ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯Spring IOC å®¹å™¨ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯Spring IOC å®¹å™¨ï¼Ÿ</h3><p>Spring IOCï¼ˆæ§åˆ¶åè½¬ï¼‰ æŠŠç»„ä»¶å¯¹è±¡æ§åˆ¶æƒäº¤ç»™å®¹å™¨ï¼Œå®¹å™¨è´Ÿè´£åˆ›å»ºå¯¹è±¡ï¼Œé…ç½®å¯¹è±¡ï¼ˆé€šè¿‡ä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰ï¼Œå¹¶ä¸”ç®¡ç†è¿™äº›å¯¹è±¡çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸã€‚IoC è®©ç›¸äº’åä½œçš„ç»„ä»¶ä¿æŒæ¾è€¦åˆã€‚</p>\n<h3 id=\"Spring-IoC-çš„å®ç°æœºåˆ¶\"><a href=\"#Spring-IoC-çš„å®ç°æœºåˆ¶\" class=\"headerlink\" title=\"Spring IoC çš„å®ç°æœºåˆ¶\"></a>Spring IoC çš„å®ç°æœºåˆ¶</h3><p>Spring ä¸­çš„ IoC çš„å®ç°åŸç†å°±æ˜¯<strong>å·¥å‚æ¨¡å¼åŠ åå°„</strong>ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">interface</span> <span class=\"title class_\">Fruit</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">eat</span><span class=\"params\">()</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Apple</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Fruit</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">eat</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;Apple&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Orange</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Fruit</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">eat</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;Orange&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Factory</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Fruit <span class=\"title function_\">getInstance</span><span class=\"params\">(String className)</span> &#123;\t<span class=\"comment\">// ä½¿ç”¨åå°„ï¼Œç”¨å­—ç¬¦ä¸²è·å–åˆ°å®ä¾‹</span></span><br><span class=\"line\">        Fruit f=<span class=\"literal\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            f = (Fruit) Class.forName(className).newInstance();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> f;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Client</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] a)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Fruit</span> <span class=\"variable\">f</span> <span class=\"operator\">=</span> Factory.getInstance(<span class=\"string\">&quot;io.github.dunwu.spring.Apple&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(f != <span class=\"literal\">null</span>)&#123;</span><br><span class=\"line\">            f.eat();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"BeanFactory-å’Œ-ApplicationContextæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"><a href=\"#BeanFactory-å’Œ-ApplicationContextæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"BeanFactory å’Œ ApplicationContextæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"></a>BeanFactory å’Œ ApplicationContextæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p>BeanFactory å’Œ ApplicationContext æ˜¯ Spring çš„ä¸¤å¤§æ ¸å¿ƒæ¥å£ï¼Œéƒ½å¯ä»¥å½“åš Spring çš„å®¹å™¨ã€‚<br>ApplicationContext æ˜¯ BeanFactory çš„å­æ¥å£ã€‚</p>\n<ol>\n<li>ä¾èµ–å…³ç³»</li>\n</ol>\n<p>BeanFactoryï¼šæ˜¯ Spring é‡Œé¢æœ€åº•å±‚çš„æ¥å£ï¼ŒåŒ…å«äº†å„ç§ Bean çš„å®šä¹‰ï¼Œè¯»å– bean é…ç½®æ–‡æ¡£ï¼Œç®¡ç† bean çš„åŠ è½½ã€å®ä¾‹åŒ–ï¼Œæ§åˆ¶ bean çš„ç”Ÿå‘½å‘¨æœŸï¼Œç»´æŠ¤ bean ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚</p>\n<p>ApplicationContext æ¥å£ä½œä¸º BeanFactory çš„å­æ¥å£ï¼Œé™¤äº†æä¾› BeanFactory æ‰€å…·æœ‰çš„åŠŸèƒ½å¤–ï¼Œè¿˜æä¾›äº†æ›´å®Œæ•´çš„æ¡†æ¶åŠŸèƒ½ï¼š</p>\n<ul>\n<li>æ”¯æŒå›½é™…åŒ–ã€‚</li>\n<li>æ”¯æŒè®¿é—®æ–‡ä»¶èµ„æº</li>\n<li>æ”¯æŒäº‹ä»¶å‘å¸ƒé€šçŸ¥</li>\n<li>åŒæ—¶åŠ è½½å¤šä¸ªé…ç½®æ–‡ä»¶ã€‚</li>\n</ul>\n<p>é…ç½®æµç¨‹ï¼š</p>\n<ol>\n<li>åŠ è½½é…ç½®æ–‡ä»¶ï¼Œè§£ææˆ BeanDefinition æ”¾åœ¨ Map é‡Œï¼Œmap ä¸­å­˜æ”¾<code>&lt;BeanNameï¼ŒClasså¯¹è±¡&gt;</code>çš„æ˜ å°„</li>\n<li>è°ƒç”¨ getBean çš„æ—¶å€™ï¼Œä» BeanDefinition æ‰€å±çš„ Map é‡Œï¼Œæ‹¿å‡º Class å¯¹è±¡ä½¿ç”¨åå°„è¿›è¡Œå®ä¾‹åŒ–ï¼ŒåŒæ—¶ï¼Œå¦‚æœæœ‰ä¾èµ–å…³ç³»ï¼Œå°†é€’å½’è°ƒç”¨ getBean æ–¹æ³• â€”â€” å®Œæˆä¾èµ–æ³¨å…¥ã€‚</li>\n<li>åŠ è½½æ–¹å¼</li>\n</ol>\n<p><strong>BeanFactroy</strong>é‡‡ç”¨çš„æ˜¯<strong>å»¶è¿ŸåŠ è½½</strong>å½¢å¼æ¥æ³¨å…¥ Bean çš„ï¼Œå³åªæœ‰åœ¨ä½¿ç”¨åˆ°æŸä¸ª Bean æ—¶(è°ƒç”¨ getBean())ï¼Œæ‰å¯¹è¯¥ Bean è¿›è¡ŒåŠ è½½å®ä¾‹åŒ–ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±ä¸èƒ½å‘ç°ä¸€äº›å­˜åœ¨çš„ Spring çš„é…ç½®é—®é¢˜ã€‚å¦‚æœ Bean çš„æŸä¸€ä¸ªå±æ€§æ²¡æœ‰æ³¨å…¥æˆ–è€…æ˜¯å±æ€§æ³¨å…¥é”™è¯¯ï¼ŒBeanFacotry åŠ è½½åï¼Œç›´è‡³ç¬¬ä¸€æ¬¡ä½¿ç”¨è°ƒç”¨ getBean æ–¹æ³•æ‰ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p>\n<p><strong>ApplicationContext</strong>ï¼Œå®ƒæ˜¯åœ¨å®¹å™¨å¯åŠ¨æ—¶ï¼Œ<strong>ä¸€æ¬¡æ€§åˆ›å»º</strong>äº†æ‰€æœ‰çš„ Beanã€‚è¿™æ ·ï¼Œåœ¨å®¹å™¨å¯åŠ¨æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥<strong>å‘ç°Springä¸­å­˜åœ¨çš„é…ç½®é”™è¯¯</strong>ï¼Œè¿™æ ·æœ‰åˆ©äºæ£€æŸ¥æ‰€ä¾èµ–å±æ€§æ˜¯å¦æ³¨å…¥ã€‚ ApplicationContext å¯åŠ¨åé¢„è½½å…¥æ‰€æœ‰çš„å•å®ä¾‹ Beanï¼Œé€šè¿‡é¢„è½½å…¥å•å®ä¾‹ bean ,ç¡®ä¿å½“ä½ éœ€è¦çš„æ—¶å€™ï¼Œä½ å°±ä¸ç”¨ç­‰å¾…ï¼Œå› ä¸ºå®ƒä»¬å·²ç»åˆ›å»ºå¥½äº†ã€‚</p>\n<p>ç”±äºåœ¨å®¹å™¨å¯åŠ¨æ—¶ä¸€æ¬¡æ€§åˆ›å»ºæ‰€æœ‰çš„ Beanï¼Œå› æ­¤ ApplicationContext æ›´åŠ å ç”¨å†…å­˜ç©ºé—´ï¼Œå½“é…ç½®çš„ Bean æ¯”è¾ƒå¤šæ—¶ï¼Œç¨‹åºå¯åŠ¨è¾ƒæ…¢ã€‚</p>\n<h4 id=\"â­BeanFactoryå’ŒFactoryBeanåŒºåˆ«ï¼Ÿ\"><a href=\"#â­BeanFactoryå’ŒFactoryBeanåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"â­BeanFactoryå’ŒFactoryBeanåŒºåˆ«ï¼Ÿ\"></a>â­BeanFactoryå’ŒFactoryBeanåŒºåˆ«ï¼Ÿ</h4><p>BeanFactoryï¼šæ˜¯ spring IoC å®¹å™¨çš„åº•å±‚æ¥å£ï¼Œå¯ä»¥ç”¨æ¥ç®¡ç† bean åŠå…¶ç”Ÿå‘½å‘¨æœŸï¼›</p>\n<p>FactoryBeanï¼šå¦‚æœæŸä¸ª bean å®ç°äº† FactoryBean è¿™ä¸ªæ¥å£ï¼Œé€šè¿‡ getBean æ–¹æ³•æ¥è·å– bean çš„æ—¶å€™ï¼Œå¹¶ä¸æ˜¯è¿”å›è‡ªå·±çš„å®ä¾‹ï¼Œè€Œæ˜¯è¿”å›å…¶ getObject() æ–¹æ³•çš„è¿”å›å€¼</p>\n<h3 id=\"ApplicationContexté€šå¸¸çš„å®ç°æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#ApplicationContexté€šå¸¸çš„å®ç°æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"ApplicationContexté€šå¸¸çš„å®ç°æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>ApplicationContexté€šå¸¸çš„å®ç°æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><strong>FileSystemXmlApplicationContext</strong> ï¼šæ­¤å®¹å™¨ä»ä¸€ä¸ª XML æ–‡ä»¶ä¸­åŠ è½½ beans çš„å®šä¹‰ï¼ŒXML Bean é…ç½®æ–‡ä»¶çš„å…¨è·¯å¾„åå¿…é¡»æä¾›ç»™å®ƒçš„æ„é€ å‡½æ•°ã€‚</p>\n<p><strong>ClassPathXmlApplicationContext</strong>ï¼šæ­¤å®¹å™¨ä¹Ÿä»ä¸€ä¸ª XML æ–‡ä»¶ä¸­åŠ è½½ beans çš„å®šä¹‰ï¼Œè¿™é‡Œï¼Œä½ éœ€è¦æ­£ç¡®è®¾ç½® classpath å› ä¸ºè¿™ä¸ªå®¹å™¨å°†åœ¨ classpath é‡Œæ‰¾ bean é…ç½®ã€‚</p>\n<p><strong>AnnotationConfigApplicationContext</strong>ï¼šå®ƒæ˜¯ç”¨äºè¯»å–æ³¨è§£åˆ›å»ºå®¹å™¨çš„</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯Springçš„ä¾èµ–æ³¨å…¥ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯Springçš„ä¾èµ–æ³¨å…¥ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯Springçš„ä¾èµ–æ³¨å…¥ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯Springçš„ä¾èµ–æ³¨å…¥ï¼Ÿ</h3><p>å…·ä½“å«ä¹‰æ˜¯:å½“æŸä¸ªè°ƒç”¨è€…éœ€è¦å¦ä¸€ä¸ªè¢«è°ƒç”¨è€…çš„ååŠ©æ—¶ï¼Œåœ¨ ä¼ ç»Ÿçš„ç¨‹åºè®¾è®¡è¿‡ç¨‹ä¸­ï¼Œé€šå¸¸ç”±è°ƒç”¨è€…æ¥åˆ›å»ºè¢«è°ƒç”¨è€…çš„å®ä¾‹ã€‚ä½†åœ¨ Spring é‡Œï¼Œåˆ›å»ºè¢«è°ƒç”¨è€…çš„å·¥ä½œä¸å†ç”±è°ƒç”¨è€…æ¥å®Œæˆï¼Œå› æ­¤ç§°ä¸ºæ§åˆ¶åè½¬ï¼›åˆ›å»ºè¢«è°ƒç”¨è€… å®ä¾‹çš„å·¥ä½œé€šå¸¸ç”± Spring å®¹å™¨æ¥å®Œæˆï¼Œç„¶åæ³¨å…¥è°ƒç”¨è€…ï¼Œå› æ­¤ä¹Ÿç§°ä¸ºä¾èµ–æ³¨å…¥ã€‚</p>\n<h3 id=\"ä¾èµ–æ³¨å…¥æœ‰ä»€ä¹ˆä¼˜åŠ¿\"><a href=\"#ä¾èµ–æ³¨å…¥æœ‰ä»€ä¹ˆä¼˜åŠ¿\" class=\"headerlink\" title=\"ä¾èµ–æ³¨å…¥æœ‰ä»€ä¹ˆä¼˜åŠ¿\"></a>ä¾èµ–æ³¨å…¥æœ‰ä»€ä¹ˆä¼˜åŠ¿</h3><p>ä¾èµ–æ³¨å…¥ä¹‹æ‰€ä»¥æ›´æµè¡Œæ˜¯å› ä¸ºå®ƒæ˜¯ä¸€ç§æ›´å¯å–çš„æ–¹å¼ï¼šè®©å®¹å™¨å…¨æƒè´Ÿè´£ä¾èµ–æŸ¥è¯¢ï¼Œå—ç®¡ç»„ä»¶åªéœ€è¦æš´éœ² JavaBean çš„ setter æ–¹æ³•æˆ–è€…å¸¦å‚æ•°çš„æ„é€ å™¨æˆ–è€…æ¥å£ï¼Œä½¿å®¹å™¨å¯ä»¥åœ¨åˆå§‹åŒ–æ—¶ç»„è£…å¯¹è±¡çš„ä¾èµ–å…³ç³»ã€‚å…¶ä¸ä¾èµ–æŸ¥æ‰¾æ–¹å¼ç›¸æ¯”ï¼Œä¸»è¦ä¼˜åŠ¿ä¸ºï¼š</p>\n<ul>\n<li>æŸ¥æ‰¾å®šä½æ“ä½œä¸åº”ç”¨ä»£ç å®Œå…¨æ— å…³ã€‚</li>\n<li>ä¸ä¾èµ–äºå®¹å™¨çš„ APIï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°åœ¨ä»»ä½•å®¹å™¨ä»¥å¤–ä½¿ç”¨åº”ç”¨å¯¹è±¡ã€‚</li>\n<li>ä¸éœ€è¦ç‰¹æ®Šçš„æ¥å£ï¼Œç»å¤§å¤šæ•°å¯¹è±¡å¯ä»¥åšåˆ°å®Œå…¨ä¸å¿…ä¾èµ–å®¹å™¨ã€‚</li>\n</ul>\n<h3 id=\"æœ‰å“ªäº›ä¸åŒç±»å‹çš„ä¾èµ–æ³¨å…¥å®ç°æ–¹å¼ï¼Ÿ\"><a href=\"#æœ‰å“ªäº›ä¸åŒç±»å‹çš„ä¾èµ–æ³¨å…¥å®ç°æ–¹å¼ï¼Ÿ\" class=\"headerlink\" title=\"æœ‰å“ªäº›ä¸åŒç±»å‹çš„ä¾èµ–æ³¨å…¥å®ç°æ–¹å¼ï¼Ÿ\"></a>æœ‰å“ªäº›ä¸åŒç±»å‹çš„ä¾èµ–æ³¨å…¥å®ç°æ–¹å¼ï¼Ÿ</h3><p><strong>æ„é€ å™¨ä¾èµ–æ³¨å…¥</strong>ï¼šæ„é€ å™¨ä¾èµ–æ³¨å…¥é€šè¿‡å®¹å™¨è§¦å‘ä¸€ä¸ªç±»çš„æ„é€ å™¨æ¥å®ç°çš„ï¼Œè¯¥ç±»æœ‰ä¸€ç³»åˆ—å‚æ•°ï¼Œæ¯ä¸ªå‚æ•°ä»£è¡¨ä¸€ä¸ªå¯¹å…¶ä»–ç±»çš„ä¾èµ–ã€‚</p>\n<p><strong>Setteræ–¹æ³•æ³¨å…¥</strong>ï¼šSetter æ–¹æ³•æ³¨å…¥æ˜¯å®¹å™¨é€šè¿‡è°ƒç”¨æ— å‚æ„é€ å™¨æˆ–æ— å‚ static å·¥å‚ æ–¹æ³•å®ä¾‹åŒ– bean ä¹‹åï¼Œè°ƒç”¨è¯¥ bean çš„ setter æ–¹æ³•ï¼Œå³å®ç°äº†åŸºäº setter çš„ä¾èµ–æ³¨å…¥ã€‚</p>\n<h3 id=\"æ„é€ å™¨ä¾èµ–æ³¨å…¥å’Œ-setteræ–¹æ³•æ³¨å…¥çš„åŒºåˆ«\"><a href=\"#æ„é€ å™¨ä¾èµ–æ³¨å…¥å’Œ-setteræ–¹æ³•æ³¨å…¥çš„åŒºåˆ«\" class=\"headerlink\" title=\"æ„é€ å™¨ä¾èµ–æ³¨å…¥å’Œ setteræ–¹æ³•æ³¨å…¥çš„åŒºåˆ«\"></a>æ„é€ å™¨ä¾èµ–æ³¨å…¥å’Œ setteræ–¹æ³•æ³¨å…¥çš„åŒºåˆ«</h3><p>ï¼ˆéƒ¨åˆ†æ³¨å…¥ï¼‰åœ¨ setter æ³¨å…¥,å¯ä»¥å°†ä¾èµ–é¡¹éƒ¨åˆ†æ³¨å…¥,æ„é€ æ–¹æ³•æ³¨å…¥ä¸èƒ½éƒ¨åˆ†æ³¨å…¥ã€‚</p>\n<p>ï¼ˆå±æ€§è¦†ç›–ï¼‰å¦‚æœæˆ‘ä»¬ä¸ºåŒä¸€å±æ€§æä¾› setter å’Œæ„é€ æ–¹æ³•æ³¨å…¥ï¼Œsetter æ³¨å…¥å°†è¦†ç›–æ„é€ æ–¹æ³•æ³¨å…¥ã€‚ä½†æ˜¯æ„é€ æ–¹æ³•æ³¨å…¥ä¸èƒ½è¦†ç›– setter æ³¨å…¥å€¼ã€‚æ˜¾ç„¶ï¼Œæ„é€ æ–¹æ³•æ³¨å…¥è¢«ç§°ä¸ºåˆ›å»ºå®ä¾‹çš„ç¬¬ä¸€é€‰é¡¹ã€‚</p>\n<p>ï¼ˆå¾ªç¯ä¾èµ–ï¼‰åœ¨æ„é€ å‡½æ•°æ³¨å…¥,å¦‚æœ A å’Œ B å¯¹è±¡ç›¸äº’ä¾èµ–ï¼šA ä¾èµ–äº B,B ä¹Ÿä¾èµ–äº A,æ­¤æ—¶åœ¨åˆ›å»ºå¯¹è±¡çš„ A æˆ–è€… B æ—¶ï¼ŒSpring æŠ›å‡º ObjectCurrentlyInCreationExceptionã€‚æ‰€ä»¥ Spring å¯ä»¥é€šè¿‡ setter æ³¨å…¥,ä»è€Œè§£å†³å¾ªç¯ä¾èµ–çš„é—®é¢˜ã€‚</p>\n<p><strong>æœ€å¥½çš„è§£å†³æ–¹æ¡ˆæ˜¯ç”¨æ„é€ å™¨å‚æ•°å®ç°å¼ºåˆ¶ä¾èµ–ï¼Œsetteræ–¹æ³•å®ç°å¯é€‰ä¾èµ–</strong></p>\n<h3 id=\"è®²ä¸€è®²Springä¸­çš„å¾ªç¯ä¾èµ–\"><a href=\"#è®²ä¸€è®²Springä¸­çš„å¾ªç¯ä¾èµ–\" class=\"headerlink\" title=\"è®²ä¸€è®²Springä¸­çš„å¾ªç¯ä¾èµ–\"></a>è®²ä¸€è®²Springä¸­çš„å¾ªç¯ä¾èµ–</h3><p><a href=\"https://www.cnblogs.com/daimzh/p/13256413.html\">https://www.cnblogs.com/daimzh/p/13256413.html</a></p>\n<p><a href=\"https://blog.csdn.net/weixin_49592546/article/details/108050566\">https://blog.csdn.net/weixin_49592546/article/details/108050566</a></p>\n<h4 id=\"ä»€ä¹ˆæ˜¯å¾ªç¯ä¾èµ–ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯å¾ªç¯ä¾èµ–ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯å¾ªç¯ä¾èµ–ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯å¾ªç¯ä¾èµ–ï¼Ÿ</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">A</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// Aä¸­æ³¨å…¥äº†B</span></span><br><span class=\"line\">\t<span class=\"meta\">@Autowired</span></span><br><span class=\"line\">\t<span class=\"keyword\">private</span> B b;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">B</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// Bä¸­ä¹Ÿæ³¨å…¥äº†A</span></span><br><span class=\"line\">\t<span class=\"meta\">@Autowired</span></span><br><span class=\"line\">\t<span class=\"keyword\">private</span> A a;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Springæ˜¯å¦‚ä½•è§£å†³çš„å¾ªç¯ä¾èµ–ï¼Ÿ\"><a href=\"#Springæ˜¯å¦‚ä½•è§£å†³çš„å¾ªç¯ä¾èµ–ï¼Ÿ\" class=\"headerlink\" title=\"Springæ˜¯å¦‚ä½•è§£å†³çš„å¾ªç¯ä¾èµ–ï¼Ÿ\"></a>Springæ˜¯å¦‚ä½•è§£å†³çš„å¾ªç¯ä¾èµ–ï¼Ÿ</h4><blockquote>\n<p>ä»¥ä¸‹ï¼š</p>\n<p>ä½œè€…ï¼šé˜¿é‡Œäº‘äº‘æ –å·</p>\n<p>é“¾æ¥ï¼š<a href=\"https://zhuanlan.zhihu.com/p/368769721\">https://zhuanlan.zhihu.com/p/368769721</a></p>\n<p>æ¥æºï¼šçŸ¥ä¹</p>\n<p>è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>\n</blockquote>\n<p>é¦–å…ˆï¼ŒSpring è§£å†³å¾ªç¯ä¾èµ–æœ‰ä¸¤ä¸ªå‰ææ¡ä»¶ï¼š</p>\n<ol>\n<li>ä¸å…¨æ˜¯æ„é€ å™¨æ–¹å¼çš„å¾ªç¯ä¾èµ–</li>\n<li>å¿…é¡»æ˜¯å•ä¾‹</li>\n</ol>\n<p>åŸºäºä¸Šé¢çš„é—®é¢˜ï¼Œæˆ‘ä»¬çŸ¥é“ Bean çš„ç”Ÿå‘½å‘¨æœŸï¼Œæœ¬è´¨ä¸Šè§£å†³å¾ªç¯ä¾èµ–çš„é—®é¢˜å°±æ˜¯ä¸‰çº§ç¼“å­˜ï¼Œé€šè¿‡ä¸‰çº§ç¼“å­˜æå‰æ‹¿åˆ°æœªåˆå§‹åŒ–å®Œå…¨çš„å¯¹è±¡ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/** Cache of singleton objects: bean name to bean instance. */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> Map&lt;String, Object&gt; singletonObjects = <span class=\"keyword\">new</span> <span class=\"title class_\">ConcurrentHashMap</span>&lt;&gt;(<span class=\"number\">256</span>);</span><br><span class=\"line\"><span class=\"comment\">/** Cache of early singleton objects: bean name to bean instance. */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> Map&lt;String, Object&gt; earlySingletonObjects = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;&gt;(<span class=\"number\">16</span>);</span><br><span class=\"line\"><span class=\"comment\">/** Cache of singleton factories: bean name to ObjectFactory. */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> Map&lt;String, ObjectFactory&lt;?&gt;&gt; singletonFactories = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;&gt;(<span class=\"number\">16</span>);</span><br></pre></td></tr></table></figure>\n\n<p>ç¬¬ä¸€çº§ç¼“å­˜ï¼šç”¨æ¥ä¿å­˜å®ä¾‹åŒ–ã€åˆå§‹åŒ–éƒ½å®Œæˆçš„å¯¹è±¡</p>\n<p>ç¬¬äºŒçº§ç¼“å­˜ï¼šç”¨æ¥ä¿å­˜å®ä¾‹åŒ–å®Œæˆï¼Œä½†æ˜¯æœªåˆå§‹åŒ–å®Œæˆçš„å¯¹è±¡</p>\n<p>ç¬¬ä¸‰çº§ç¼“å­˜ï¼šç”¨æ¥ä¿å­˜ä¸€ä¸ªå¯¹è±¡å·¥å‚ï¼Œæä¾›ä¸€ä¸ªåŒ¿åå†…éƒ¨ç±»ï¼Œç”¨äºåˆ›å»ºäºŒçº§ç¼“å­˜ä¸­çš„å¯¹è±¡</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesv2-dbda6a103e41cde4a54548386d6c1cc2_720w.jpg\" alt=\"Springä¸‰çº§ç¼“å­˜\"></p>\n<p>å‡è®¾ä¸€ä¸ªç®€å•çš„å¾ªç¯ä¾èµ–åœºæ™¯ï¼ŒAã€B äº’ç›¸ä¾èµ–ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesv2-f20f1e81c8011fd99f723127cacf7430_720w.jpg\" alt=\"ç®€å•çš„å¾ªç¯ä¾èµ–åœºæ™¯\"></p>\n<p>A å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹ï¼š</p>\n<ol>\n<li>åˆ›å»ºå¯¹è±¡ Aï¼Œå®ä¾‹åŒ–çš„æ—¶å€™æŠŠ A å¯¹è±¡å·¥å‚æ”¾å…¥ä¸‰çº§ç¼“å­˜ï¼›</li>\n</ol>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesv2-b295374aff4235ee9c0538bf03856217_720w.jpg\" alt=\"å®ä¾‹åŒ–å¯¹è±¡A\"></p>\n<ol start=\"2\">\n<li><p>A æ³¨å…¥å±æ€§æ—¶ï¼Œå‘ç°ä¾èµ– Bï¼Œè½¬è€Œå»å®ä¾‹åŒ– B</p>\n</li>\n<li><p>åŒæ ·åˆ›å»ºå¯¹è±¡ Bï¼Œæ³¨å…¥å±æ€§æ—¶å‘ç°ä¾èµ– Aï¼Œä¾æ¬¡ä»ä¸€çº§åˆ°ä¸‰çº§ç¼“å­˜æŸ¥è¯¢ Aï¼Œä»ä¸‰çº§ç¼“å­˜é€šè¿‡å¯¹è±¡å·¥å‚æ‹¿åˆ° Aï¼ŒæŠŠ A æ”¾å…¥äºŒçº§ç¼“å­˜ï¼ŒåŒæ—¶åˆ é™¤ä¸‰çº§ç¼“å­˜ä¸­çš„ Aï¼Œæ­¤æ—¶ï¼ŒB å·²ç»å®ä¾‹åŒ–å¹¶ä¸”åˆå§‹åŒ–å®Œæˆï¼ŒæŠŠ B æ”¾å…¥ä¸€çº§ç¼“å­˜ã€‚</p>\n</li>\n</ol>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesv2-51cb735fc6c02c2225d2f38b9b5b6da9_720w.jpg\" alt=\"åˆ›å»ºå¯¹è±¡B\"></p>\n<ol start=\"4\">\n<li><p>æ¥ç€ç»§ç»­åˆ›å»º Aï¼Œé¡ºåˆ©ä»ä¸€çº§ç¼“å­˜æ‹¿åˆ°å®ä¾‹åŒ–ä¸”åˆå§‹åŒ–å®Œæˆçš„ B å¯¹è±¡ï¼ŒA å¯¹è±¡åˆ›å»ºä¹Ÿå®Œæˆï¼Œåˆ é™¤äºŒçº§ç¼“å­˜ä¸­çš„ Aï¼ŒåŒæ—¶æŠŠ A æ”¾å…¥ä¸€çº§ç¼“å­˜</p>\n</li>\n<li><p>æœ€åï¼Œä¸€çº§ç¼“å­˜ä¸­ä¿å­˜ç€å®ä¾‹åŒ–ã€åˆå§‹åŒ–éƒ½å®Œæˆçš„ Aã€B å¯¹è±¡</p>\n</li>\n</ol>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesv2-a1eaa5d9f8bec23e373dc1b9f86ddb25_720w.jpg\" alt=\"æœ€ç»ˆç»“æœ\"></p>\n<p>å› æ­¤ï¼Œç”±äºæŠŠå®ä¾‹åŒ–å’Œåˆå§‹åŒ–çš„æµç¨‹åˆ†å¼€äº†ï¼Œæ‰€ä»¥å¦‚æœéƒ½æ˜¯ç”¨æ„é€ å™¨çš„è¯ï¼Œå°±æ²¡æ³•åˆ†ç¦»è¿™ä¸ªæ“ä½œï¼Œæ‰€ä»¥éƒ½æ˜¯æ„é€ å™¨çš„è¯å°±æ— æ³•è§£å†³å¾ªç¯ä¾èµ–çš„é—®é¢˜äº†ã€‚</p>\n<h3 id=\"8-ä¸ºä»€ä¹ˆè¦ä¸‰çº§ç¼“å­˜ï¼ŸäºŒçº§ä¸è¡Œå—ï¼Ÿ\"><a href=\"#8-ä¸ºä»€ä¹ˆè¦ä¸‰çº§ç¼“å­˜ï¼ŸäºŒçº§ä¸è¡Œå—ï¼Ÿ\" class=\"headerlink\" title=\"8. ä¸ºä»€ä¹ˆè¦ä¸‰çº§ç¼“å­˜ï¼ŸäºŒçº§ä¸è¡Œå—ï¼Ÿ\"></a>8. ä¸ºä»€ä¹ˆè¦ä¸‰çº§ç¼“å­˜ï¼ŸäºŒçº§ä¸è¡Œå—ï¼Ÿ</h3><p>ä¸å¯ä»¥ï¼Œä¸»è¦æ˜¯ä¸ºäº†ç”Ÿæˆä»£ç†å¯¹è±¡ã€‚</p>\n<p>å› ä¸ºä¸‰çº§ç¼“å­˜ä¸­æ”¾çš„æ˜¯ç”Ÿæˆå…·ä½“å¯¹è±¡çš„å¯¹è±¡å·¥å‚ï¼Œä»–å¯ä»¥ç”Ÿæˆä»£ç†å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥æ˜¯æ™®é€šçš„å®ä¾‹å¯¹è±¡ã€‚</p>\n<p>å‡è®¾åªæœ‰äºŒçº§ç¼“å­˜çš„æƒ…å†µï¼Œå¾€äºŒçº§ç¼“å­˜ä¸­æ”¾çš„æ˜¾ç¤ºä¸€ä¸ªæ™®é€šçš„ Bean å¯¹è±¡ï¼Œ<code>BeanPostProcessor</code>å»ç”Ÿæˆä»£ç†å¯¹è±¡ä¹‹åï¼Œè¦†ç›–æ‰äºŒçº§ç¼“å­˜ä¸­çš„æ™®é€š Bean å¯¹è±¡ï¼Œé‚£ä¹ˆå¤šçº¿ç¨‹ç¯å¢ƒä¸‹å¯èƒ½å–åˆ°çš„å¯¹è±¡å°±ä¸ä¸€è‡´äº†ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesv2-e4e9050787017c7272dc313f88af9382_720w.jpg\" alt=\"Aä»£ç†å¯¹è±¡è¦†ç›–Aæ™®é€šBean\"></p>\n<h2 id=\"Spring-Beans\"><a href=\"#Spring-Beans\" class=\"headerlink\" title=\"Spring Beans\"></a>Spring Beans</h2><h3 id=\"å¦‚ä½•ç»™Spring-å®¹å™¨æä¾›é…ç½®å…ƒæ•°æ®ï¼ŸSpringæœ‰å‡ ç§é…ç½®æ–¹å¼\"><a href=\"#å¦‚ä½•ç»™Spring-å®¹å™¨æä¾›é…ç½®å…ƒæ•°æ®ï¼ŸSpringæœ‰å‡ ç§é…ç½®æ–¹å¼\" class=\"headerlink\" title=\"å¦‚ä½•ç»™Spring å®¹å™¨æä¾›é…ç½®å…ƒæ•°æ®ï¼ŸSpringæœ‰å‡ ç§é…ç½®æ–¹å¼\"></a>å¦‚ä½•ç»™Spring å®¹å™¨æä¾›é…ç½®å…ƒæ•°æ®ï¼ŸSpringæœ‰å‡ ç§é…ç½®æ–¹å¼</h3><p>è¿™é‡Œæœ‰ä¸‰ç§é‡è¦çš„æ–¹æ³•ç»™ Spring å®¹å™¨æä¾›é…ç½®å…ƒæ•°æ®ã€‚</p>\n<ul>\n<li>XML é…ç½®æ–‡ä»¶ã€‚</li>\n<li>åŸºäºæ³¨è§£çš„é…ç½®ã€‚</li>\n<li>åŸºäº Java çš„é…ç½®ã€‚</li>\n</ul>\n<h3 id=\"Springé…ç½®æ–‡ä»¶åŒ…å«äº†å“ªäº›ä¿¡æ¯\"><a href=\"#Springé…ç½®æ–‡ä»¶åŒ…å«äº†å“ªäº›ä¿¡æ¯\" class=\"headerlink\" title=\"Springé…ç½®æ–‡ä»¶åŒ…å«äº†å“ªäº›ä¿¡æ¯\"></a>Springé…ç½®æ–‡ä»¶åŒ…å«äº†å“ªäº›ä¿¡æ¯</h3><p>Spring é…ç½®æ–‡ä»¶æ˜¯ä¸ª XML æ–‡ä»¶ï¼Œé€šè¿‡è¯»å–æŒ‡å®šç±»çš„å…¨é™å®šç±»åã€‚åå°„åˆ›å»ºå¯¹è±¡ï¼Œä¸¢å…¥ ioc å®¹å™¨ä¸­ï¼Œè¯¥å¯¹è±¡å¯ä»¥é€šè¿‡ id æ¥è·å–</p>\n<h3 id=\"SpringåŸºäºxmlæ³¨å…¥beançš„å‡ ç§æ–¹å¼\"><a href=\"#SpringåŸºäºxmlæ³¨å…¥beançš„å‡ ç§æ–¹å¼\" class=\"headerlink\" title=\"SpringåŸºäºxmlæ³¨å…¥beançš„å‡ ç§æ–¹å¼\"></a>SpringåŸºäºxmlæ³¨å…¥beançš„å‡ ç§æ–¹å¼</h3><ol>\n<li>Set æ–¹æ³•æ³¨å…¥ï¼š<code>&lt;property name=&quot;xxx&quot; value=&quot;yyy&quot;/&gt;</code></li>\n<li>æ„é€ å™¨æ³¨å…¥ï¼š<code>&lt;construtor-arg type/index/name=&quot;xxx&quot; value=&quot;yyy&quot;/&gt;</code></li>\n<li>é™æ€å·¥å‚æ³¨å…¥ï¼›factory-bean factory-method</li>\n<li>å®ä¾‹å·¥å‚ï¼› class factory-method</li>\n</ol>\n<h3 id=\"è§£é‡ŠSpringæ”¯æŒçš„å‡ ç§beançš„ä½œç”¨åŸŸ\"><a href=\"#è§£é‡ŠSpringæ”¯æŒçš„å‡ ç§beançš„ä½œç”¨åŸŸ\" class=\"headerlink\" title=\"è§£é‡ŠSpringæ”¯æŒçš„å‡ ç§beançš„ä½œç”¨åŸŸ\"></a>è§£é‡ŠSpringæ”¯æŒçš„å‡ ç§beançš„ä½œç”¨åŸŸ</h3><p>Spring æ¡†æ¶æ”¯æŒä»¥ä¸‹äº”ç§ bean çš„ä½œç”¨åŸŸï¼š</p>\n<ul>\n<li><strong>singleton :</strong> bean åœ¨æ¯ä¸ª Spring ioc å®¹å™¨ä¸­åªæœ‰ä¸€ä¸ªå®ä¾‹ã€‚</li>\n<li><strong>prototype</strong>ï¼šä¸€ä¸ª bean çš„å®šä¹‰å¯ä»¥æœ‰å¤šä¸ªå®ä¾‹ã€‚</li>\n<li><strong>request</strong>ï¼šæ¯æ¬¡ http è¯·æ±‚éƒ½ä¼šåˆ›å»ºä¸€ä¸ª beanï¼Œè¯¥ä½œç”¨åŸŸä»…åœ¨åŸºäº web çš„ Spring ApplicationContext æƒ…å½¢ä¸‹æœ‰æ•ˆã€‚</li>\n<li><strong>session</strong>ï¼šåœ¨ä¸€ä¸ª HTTP Session ä¸­ï¼Œä¸€ä¸ª bean å®šä¹‰å¯¹åº”ä¸€ä¸ªå®ä¾‹ã€‚è¯¥ä½œç”¨åŸŸä»…åœ¨åŸºäº web çš„ Spring ApplicationContext æƒ…å½¢ä¸‹æœ‰æ•ˆã€‚</li>\n<li><strong>global-session</strong>ï¼šåœ¨ä¸€ä¸ªå…¨å±€çš„ HTTP Session ä¸­ï¼Œä¸€ä¸ª bean å®šä¹‰å¯¹åº”ä¸€ä¸ªå®ä¾‹ã€‚è¯¥ä½œç”¨åŸŸä»…åœ¨åŸºäº web çš„ Spring ApplicationContext æƒ…å½¢ä¸‹æœ‰æ•ˆã€‚</li>\n</ul>\n<p><strong>æ³¨æ„ï¼š</strong> ç¼ºçœçš„ Spring bean çš„ä½œç”¨åŸŸæ˜¯ singletonã€‚ä½¿ç”¨ prototype ä½œç”¨åŸŸéœ€è¦æ…é‡çš„æ€è€ƒï¼Œå› ä¸ºé¢‘ç¹åˆ›å»ºå’Œé”€æ¯ bean ä¼šå¸¦æ¥å¾ˆå¤§çš„æ€§èƒ½å¼€é”€ã€‚</p>\n<h3 id=\"Springæ¡†æ¶ä¸­çš„å•ä¾‹beanæ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼Ÿ\"><a href=\"#Springæ¡†æ¶ä¸­çš„å•ä¾‹beanæ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼Ÿ\" class=\"headerlink\" title=\"Springæ¡†æ¶ä¸­çš„å•ä¾‹beanæ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼Ÿ\"></a>Springæ¡†æ¶ä¸­çš„å•ä¾‹beanæ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼Ÿ</h3><p>ä¸æ˜¯ï¼ŒSpring æ¡†æ¶ä¸­çš„å•ä¾‹ bean ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p>\n<p>spring ä¸­çš„ bean é»˜è®¤æ˜¯å•ä¾‹æ¨¡å¼ï¼Œspring æ¡†æ¶å¹¶æ²¡æœ‰å¯¹å•ä¾‹ bean è¿›è¡Œå¤šçº¿ç¨‹çš„å°è£…å¤„ç†ã€‚</p>\n<p>ç„¶è€Œï¼Œå®é™…ä¸Šå¤§éƒ¨åˆ†æ—¶å€™ spring bean æ— çŠ¶æ€çš„ï¼ˆæ¯”å¦‚ dao ç±»ï¼‰ï¼Œæ‰€ä»¥æŸç§ç¨‹åº¦ä¸Šæ¥è¯´ bean ä¹Ÿæ˜¯å®‰å…¨çš„ï¼Œä½†å¦‚æœ bean æœ‰çŠ¶æ€çš„è¯ï¼ˆæ¯”å¦‚ view model å¯¹è±¡ï¼‰ï¼Œé‚£å°±è¦å¼€å‘è€…è‡ªå·±å»ä¿è¯çº¿ç¨‹å®‰å…¨äº†ï¼Œæœ€ç®€å•çš„å°±æ˜¯æ”¹å˜ bean çš„ä½œç”¨åŸŸï¼ŒæŠŠâ€œsingletonâ€å˜æ›´ä¸ºâ€œprototypeâ€ï¼Œè¿™æ ·è¯·æ±‚ bean ç›¸å½“äº new Bean()äº†ï¼Œæ‰€ä»¥å°±å¯ä»¥ä¿è¯çº¿ç¨‹å®‰å…¨äº†ã€‚</p>\n<blockquote>\n<p>æœ‰çŠ¶æ€å°±æ˜¯æœ‰æ•°æ®å­˜å‚¨åŠŸèƒ½<br>æ— çŠ¶æ€å°±æ˜¯ä¸ä¼šä¿å­˜æ•°æ®</p>\n</blockquote>\n<h3 id=\"Springå¦‚ä½•å¤„ç†çº¿ç¨‹å¹¶å‘é—®é¢˜ï¼Ÿ\"><a href=\"#Springå¦‚ä½•å¤„ç†çº¿ç¨‹å¹¶å‘é—®é¢˜ï¼Ÿ\" class=\"headerlink\" title=\"Springå¦‚ä½•å¤„ç†çº¿ç¨‹å¹¶å‘é—®é¢˜ï¼Ÿ\"></a>Springå¦‚ä½•å¤„ç†çº¿ç¨‹å¹¶å‘é—®é¢˜ï¼Ÿ</h3><p><strong>Springä½¿ç”¨ThreadLocalå¯¹ä¸€äº›Beançš„çº¿ç¨‹å®‰å…¨é—®é¢˜è¿›è¡Œå¤„ç†</strong>ã€‚</p>\n<p>ThreadLocal å’Œçº¿ç¨‹åŒæ­¥æœºåˆ¶éƒ½æ˜¯ä¸ºäº†è§£å†³å¤šçº¿ç¨‹ä¸­ç›¸åŒå˜é‡çš„è®¿é—®å†²çªé—®é¢˜ã€‚åŒæ­¥æœºåˆ¶é‡‡ç”¨äº†â€œæ—¶é—´æ¢ç©ºé—´â€çš„æ–¹å¼ï¼Œä»…æä¾›ä¸€ä»½å˜é‡ï¼Œä¸åŒçš„çº¿ç¨‹åœ¨è®¿é—®å‰éœ€è¦è·å–é”ï¼Œæ²¡è·å¾—é”çš„çº¿ç¨‹åˆ™éœ€è¦æ’é˜Ÿã€‚è€Œ ThreadLocal é‡‡ç”¨äº†â€œç©ºé—´æ¢æ—¶é—´â€çš„æ–¹å¼ã€‚</p>\n<p>ThreadLocal ä¼šä¸ºæ¯ä¸€ä¸ªçº¿ç¨‹æä¾›ä¸€ä¸ªç‹¬ç«‹çš„å˜é‡å‰¯æœ¬ï¼Œä»è€Œéš”ç¦»äº†å¤šä¸ªçº¿ç¨‹å¯¹æ•°æ®çš„è®¿é—®å†²çªã€‚å› ä¸ºæ¯ä¸€ä¸ªçº¿ç¨‹éƒ½æ‹¥æœ‰è‡ªå·±çš„å˜é‡å‰¯æœ¬ï¼Œä»è€Œä¹Ÿå°±æ²¡æœ‰å¿…è¦å¯¹è¯¥å˜é‡è¿›è¡ŒåŒæ­¥äº†ã€‚ThreadLocal æä¾›äº†çº¿ç¨‹å®‰å…¨çš„å…±äº«å¯¹è±¡ï¼Œåœ¨ç¼–å†™å¤šçº¿ç¨‹ä»£ç æ—¶ï¼Œå¯ä»¥æŠŠä¸å®‰å…¨çš„å˜é‡å°è£…è¿› ThreadLocalã€‚</p>\n<h3 id=\"è§£é‡ŠSpringæ¡†æ¶ä¸­beançš„ç”Ÿå‘½å‘¨æœŸ\"><a href=\"#è§£é‡ŠSpringæ¡†æ¶ä¸­beançš„ç”Ÿå‘½å‘¨æœŸ\" class=\"headerlink\" title=\"è§£é‡ŠSpringæ¡†æ¶ä¸­beançš„ç”Ÿå‘½å‘¨æœŸ\"></a>è§£é‡ŠSpringæ¡†æ¶ä¸­beançš„ç”Ÿå‘½å‘¨æœŸ</h3><p>å‚è€ƒï¼š<a href=\"https://www.cnblogs.com/javazhiyin/p/10905294.html\">https://www.cnblogs.com/javazhiyin/p/10905294.html</a></p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes201911012343410.png\" alt=\"Springä¸­Beançš„ç”Ÿå‘½å‘¨æœŸ\"></p>\n<p><strong>1ã€å®ä¾‹åŒ–Beanï¼š</strong></p>\n<p>å¯¹äº BeanFactory å®¹å™¨ï¼Œå½“å®¢æˆ·å‘å®¹å™¨è¯·æ±‚ä¸€ä¸ªå°šæœªåˆå§‹åŒ–çš„ bean æ—¶ï¼Œæˆ–åˆå§‹åŒ– bean çš„æ—¶å€™éœ€è¦æ³¨å…¥å¦ä¸€ä¸ªå°šæœªåˆå§‹åŒ–çš„ä¾èµ–æ—¶ï¼Œå®¹å™¨å°±ä¼šè°ƒç”¨ createBean è¿›è¡Œå®ä¾‹åŒ–ã€‚<br>å¯¹äº ApplicationContext å®¹å™¨ï¼Œå½“å®¹å™¨å¯åŠ¨ç»“æŸåï¼Œé€šè¿‡è·å– BeanDefinition å¯¹è±¡ä¸­çš„ä¿¡æ¯ï¼Œå®ä¾‹åŒ–æ‰€æœ‰çš„ beanã€‚</p>\n<p><strong>2ã€ä¾èµ–æ³¨å…¥ï¼š</strong></p>\n<p>å®ä¾‹åŒ–åçš„å¯¹è±¡è¢«å°è£…åœ¨ BeanWrapper å¯¹è±¡ä¸­ï¼Œç´§æ¥ç€ï¼ŒSpring æ ¹æ® BeanDefinition ä¸­çš„ä¿¡æ¯ ä»¥åŠ é€šè¿‡ BeanWrapper æä¾›çš„è®¾ç½®å±æ€§çš„æ¥å£å®Œæˆä¾èµ–æ³¨å…¥ã€‚</p>\n<p><strong>3ã€å¤„ç†Awareæ¥å£ï¼ˆé…ç½®Beanå¯¹è±¡çš„idå€¼ã€å·¥å‚&#x2F;ä¸Šä¸‹æ–‡ï¼‰ï¼š</strong></p>\n<p>æ¥ç€ï¼ŒSpring ä¼šæ£€æµ‹è¯¥å¯¹è±¡æ˜¯å¦å®ç°äº† xxxAware æ¥å£ï¼Œå¹¶å°†ç›¸å…³çš„ xxxAware å®ä¾‹æ³¨å…¥ç»™ Beanï¼š</p>\n<ul>\n<li>å¦‚æœè¿™ä¸ª Bean å·²ç»å®ç°äº† BeanNameAware æ¥å£ï¼Œä¼šè°ƒç”¨å®ƒå®ç°çš„ setBeanName(String beanId)æ–¹æ³•ï¼Œæ­¤å¤„ä¼ é€’çš„å°±æ˜¯ Spring é…ç½®æ–‡ä»¶ä¸­ Bean çš„ id å€¼ï¼›</li>\n<li>å¦‚æœè¿™ä¸ª Bean å·²ç»å®ç°äº† BeanFactoryAware æ¥å£ï¼Œä¼šè°ƒç”¨å®ƒå®ç°çš„ setBeanFactory()æ–¹æ³•ï¼Œä¼ é€’çš„æ˜¯ Spring å·¥å‚è‡ªèº«ï¼›</li>\n<li>å¦‚æœè¿™ä¸ª Bean å·²ç»å®ç°äº† ApplicationContextAware æ¥å£ï¼Œä¼šè°ƒ setApplicationContext(ApplicationContext)æ–¹æ³•ï¼Œä¼ å…¥ Spring ä¸Šä¸‹æ–‡ï¼›</li>\n</ul>\n<p><strong>4ã€postProcessBeforeInitializationï¼ˆåˆå§‹åŒ–å‰ç½®å¤„ç†ï¼‰ï¼š</strong></p>\n<p>å¦‚æœæƒ³å¯¹ Bean è¿›è¡Œä¸€äº›è‡ªå®šä¹‰çš„å¤„ç†ï¼Œé‚£ä¹ˆå¯ä»¥è®© Bean å®ç°äº† BeanPostProcessor æ¥å£ï¼Œé‚£å°†ä¼šè°ƒç”¨ postProcessBeforeInitialization(Object obj, String s)æ–¹æ³•ã€‚ç”±äºè¿™ä¸ªæ–¹æ³•æ˜¯åœ¨ Bean åˆå§‹åŒ–ç»“æŸæ—¶è°ƒç”¨çš„ï¼Œæ‰€ä»¥å¯ä»¥è¢«åº”ç”¨äºå†…å­˜æˆ–ç¼“å­˜æŠ€æœ¯ï¼›</p>\n<p><strong>5ã€è‡ªå®šä¹‰åˆå§‹åŒ–init-methodï¼š</strong></p>\n<p>å¦‚æœ Bean åœ¨ Spring é…ç½®æ–‡ä»¶ä¸­é…ç½®äº† init-method å±æ€§ï¼Œåˆ™ä¼šè‡ªåŠ¨è°ƒç”¨å…¶é…ç½®çš„<strong>è‡ªå®šä¹‰åˆå§‹åŒ–</strong>æ–¹æ³•ã€‚</p>\n<p><strong>6ã€postProcessAfterInitializationï¼ˆåˆå§‹åŒ–åç½®å¤„ç†ï¼‰</strong></p>\n<p>å¦‚æœè¿™ä¸ª Bean å®ç°äº† BeanPostProcessor æ¥å£ï¼Œå°†ä¼šè°ƒç”¨ postProcessAfterInitialization(Object obj, String s)æ–¹æ³•ï¼Œ<strong>AOPåœ¨è¿™ä¸ªæ—¶å€™è¿›è¡Œä»£ç†å¯¹è±¡çš„åˆ›å»º</strong>ã€‚</p>\n<p><strong>NOW</strong> ä»¥ä¸Šå‡ ä¸ªæ­¥éª¤å®Œæˆåï¼ŒBean å°±å·²ç»è¢«æ­£ç¡®åˆ›å»ºäº†ï¼Œä¹‹åå°±å¯ä»¥ä½¿ç”¨è¿™ä¸ª Bean äº†ã€‚</p>\n<p><strong>7ã€æ¸…ç†é˜¶æ®µdestroyï¼š</strong></p>\n<p>å½“ Bean ä¸å†éœ€è¦æ—¶ï¼Œä¼šè¿›å…¥æ¸…ç†é˜¶æ®µï¼Œå¦‚æœ Bean å®ç°äº† DisposableBean è¿™ä¸ªæ¥å£ï¼Œä¼šè°ƒç”¨å…¶å®ç°çš„ destroy()æ–¹æ³•ï¼›</p>\n<p><strong>8ã€è‡ªå®šä¹‰é”€æ¯destroy-methodï¼š</strong></p>\n<p>æœ€åï¼Œå¦‚æœè¿™ä¸ª Bean çš„ Spring é…ç½®ä¸­é…ç½®äº† destroy-method å±æ€§ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨å…¶é…ç½®çš„<strong>è‡ªå®šä¹‰é”€æ¯</strong>æ–¹æ³•ã€‚</p>\n<h3 id=\"åœ¨-Springä¸­å¦‚ä½•æ³¨å…¥ä¸€ä¸ªJavaé›†åˆï¼Ÿ\"><a href=\"#åœ¨-Springä¸­å¦‚ä½•æ³¨å…¥ä¸€ä¸ªJavaé›†åˆï¼Ÿ\" class=\"headerlink\" title=\"åœ¨ Springä¸­å¦‚ä½•æ³¨å…¥ä¸€ä¸ªJavaé›†åˆï¼Ÿ\"></a>åœ¨ Springä¸­å¦‚ä½•æ³¨å…¥ä¸€ä¸ªJavaé›†åˆï¼Ÿ</h3><p>ç”¨<code>&lt;list&gt;</code>æ³¨å…¥ä¸€åˆ—å€¼ï¼Œç”¨<code>&lt;map&gt;</code>æ³¨å…¥ä¸€ç»„æ˜ å°„æ•°æ®ã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯beanè£…é…ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯beanè£…é…ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯beanè£…é…ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯beanè£…é…ï¼Ÿ</h3><p>é€šè¿‡ bean çš„ä¾èµ–å…³ç³»ï¼Œä½¿ç”¨ä¾èµ–æ³¨å…¥å°† spring ä¸­çš„ bean è£…é…åœ¨ä¸€èµ·ã€‚<br>spring å¯ä»¥é€šè¿‡ bean çš„ä¾èµ–å…³ç³»è‡ªåŠ¨å®Œæˆ bean ä¹‹é—´çš„é…ç½®ã€‚</p>\n<h3 id=\"Spring-è‡ªåŠ¨è£…é…-bean-æœ‰å“ªäº›æ–¹å¼ï¼Ÿ\"><a href=\"#Spring-è‡ªåŠ¨è£…é…-bean-æœ‰å“ªäº›æ–¹å¼ï¼Ÿ\" class=\"headerlink\" title=\"Spring è‡ªåŠ¨è£…é… bean æœ‰å“ªäº›æ–¹å¼ï¼Ÿ\"></a>Spring è‡ªåŠ¨è£…é… bean æœ‰å“ªäº›æ–¹å¼ï¼Ÿ</h3><p>åœ¨ spring ä¸­ï¼Œå¯¹è±¡æ— éœ€è‡ªå·±æŸ¥æ‰¾æˆ–åˆ›å»ºä¸å…¶å…³è”çš„å…¶ä»–å¯¹è±¡ï¼Œç”±å®¹å™¨è´Ÿè´£æŠŠéœ€è¦ç›¸äº’åä½œçš„å¯¹è±¡å¼•ç”¨èµ‹äºˆå„ä¸ªå¯¹è±¡ã€‚</p>\n<p>åœ¨ Spring æ¡†æ¶ xml é…ç½®ä¸­å…±æœ‰ 5 ç§è‡ªåŠ¨è£…é…ï¼š</p>\n<ul>\n<li>noï¼šé»˜è®¤çš„æ–¹å¼æ˜¯ä¸è¿›è¡Œè‡ªåŠ¨è£…é…çš„ï¼Œé€šè¿‡æ‰‹å·¥è®¾ç½® ref å±æ€§æ¥è¿›è¡Œè£…é… beanã€‚</li>\n<li>byNameï¼šé€šè¿‡ bean çš„åç§°è¿›è¡Œè‡ªåŠ¨è£…é…ï¼Œå¦‚æœä¸€ä¸ª bean çš„ property ä¸å¦ä¸€ bean çš„ name ç›¸åŒï¼Œå°±è¿›è¡Œè‡ªåŠ¨è£…é…ã€‚</li>\n<li>byTypeï¼šé€šè¿‡å‚æ•°çš„æ•°æ®ç±»å‹è¿›è¡Œè‡ªåŠ¨è£…é…ã€‚</li>\n<li>constructorï¼šåˆ©ç”¨æ„é€ å‡½æ•°è¿›è¡Œè£…é…ï¼Œå¹¶ä¸”æ„é€ å‡½æ•°çš„å‚æ•°é€šè¿‡ byType è¿›è¡Œè£…é…ã€‚</li>\n<li>autodetectï¼šè‡ªåŠ¨æ¢æµ‹ï¼Œå¦‚æœæœ‰æ„é€ æ–¹æ³•ï¼Œé€šè¿‡ construct çš„æ–¹å¼è‡ªåŠ¨è£…é…ï¼Œå¦åˆ™ä½¿ç”¨ byType çš„æ–¹å¼è‡ªåŠ¨è£…é…ã€‚</li>\n</ul>\n<h3 id=\"ä½¿ç”¨-Autowiredæ³¨è§£è‡ªåŠ¨è£…é…çš„è¿‡ç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ\"><a href=\"#ä½¿ç”¨-Autowiredæ³¨è§£è‡ªåŠ¨è£…é…çš„è¿‡ç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ\" class=\"headerlink\" title=\"ä½¿ç”¨@Autowiredæ³¨è§£è‡ªåŠ¨è£…é…çš„è¿‡ç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ\"></a>ä½¿ç”¨@Autowiredæ³¨è§£è‡ªåŠ¨è£…é…çš„è¿‡ç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ</h3><p>ä½¿ç”¨@Autowired æ³¨è§£æ¥è‡ªåŠ¨è£…é…æŒ‡å®šçš„ beanã€‚åœ¨ä½¿ç”¨@Autowired æ³¨è§£ä¹‹å‰éœ€è¦åœ¨ Spring é…ç½®æ–‡ä»¶è¿›è¡Œé…ç½®æ³¨è§£æ‰«æ <code>&lt;context:annotation-config /&gt;</code>ã€‚</p>\n<p>åœ¨å¯åŠ¨ spring IoC æ—¶ï¼Œå®¹å™¨è‡ªåŠ¨è£…è½½äº†ä¸€ä¸ªåç½®å¤„ç†å™¨ï¼Œå½“å®¹å™¨æ‰«æåˆ°@Autowiedã€@Resource æˆ–@Inject æ—¶ï¼Œå°±ä¼šåœ¨ IoC å®¹å™¨è‡ªåŠ¨æŸ¥æ‰¾éœ€è¦çš„ beanï¼Œå¹¶è£…é…ç»™è¯¥å¯¹è±¡çš„å±æ€§ã€‚åœ¨ä½¿ç”¨@Autowired æ—¶ï¼Œé¦–å…ˆåœ¨å®¹å™¨ä¸­<strong>æŸ¥è¯¢å¯¹åº”ç±»å‹</strong>çš„ beanï¼š</p>\n<ul>\n<li>å¦‚æœå¯¹åº”ç±»å‹æŸ¥è¯¢ç»“æœåˆšå¥½ä¸ºä¸€ä¸ªï¼Œå°±å°†è¯¥ bean è£…é…ç»™@Autowired æŒ‡å®šçš„æ•°æ®ï¼›</li>\n<li>å¦‚æœå¯¹åº”ç±»å‹æŸ¥è¯¢çš„ç»“æœä¸æ­¢ä¸€ä¸ªï¼Œé‚£ä¹ˆ@Autowired ä¼šæ ¹æ®åç§°æ¥æŸ¥æ‰¾ï¼›</li>\n<li>å¦‚æœä¸Šè¿°æŸ¥æ‰¾çš„ç»“æœä¸ºç©ºæˆ–è€…ä¸æ­¢ä¸€ä¸ªï¼Œé‚£ä¹ˆä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</li>\n</ul>\n<h2 id=\"Springæ³¨è§£\"><a href=\"#Springæ³¨è§£\" class=\"headerlink\" title=\"Springæ³¨è§£\"></a>Springæ³¨è§£</h2><h3 id=\"ä»€ä¹ˆæ˜¯åŸºäºJavaçš„Springæ³¨è§£é…ç½®-ç»™ä¸€äº›æ³¨è§£çš„ä¾‹å­\"><a href=\"#ä»€ä¹ˆæ˜¯åŸºäºJavaçš„Springæ³¨è§£é…ç½®-ç»™ä¸€äº›æ³¨è§£çš„ä¾‹å­\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯åŸºäºJavaçš„Springæ³¨è§£é…ç½®? ç»™ä¸€äº›æ³¨è§£çš„ä¾‹å­\"></a>ä»€ä¹ˆæ˜¯åŸºäºJavaçš„Springæ³¨è§£é…ç½®? ç»™ä¸€äº›æ³¨è§£çš„ä¾‹å­</h3><p>åŸºäº Java çš„é…ç½®ï¼Œå…è®¸ä½ åœ¨å°‘é‡çš„ Java æ³¨è§£çš„å¸®åŠ©ä¸‹ï¼Œè¿›è¡Œä½ çš„å¤§éƒ¨åˆ† Spring é…ç½®è€Œéé€šè¿‡ XML æ–‡ä»¶ã€‚</p>\n<p>ä»¥@Configuration æ³¨è§£ä¸ºä¾‹ï¼Œå®ƒç”¨æ¥æ ‡è®°ç±»å¯ä»¥å½“åšä¸€ä¸ª bean çš„å®šä¹‰ï¼Œè¢« Spring IOC å®¹å™¨ä½¿ç”¨ã€‚</p>\n<p>å¦ä¸€ä¸ªä¾‹å­æ˜¯@Bean æ³¨è§£ï¼Œå®ƒè¡¨ç¤ºæ­¤æ–¹æ³•å°†è¦è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œä½œä¸ºä¸€ä¸ª bean æ³¨å†Œè¿› Spring åº”ç”¨ä¸Šä¸‹æ–‡ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">StudentConfig</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> StudentBean <span class=\"title function_\">myStudent</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">StudentBean</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"æ€æ ·å¼€å¯æ³¨è§£è£…é…ï¼Ÿ\"><a href=\"#æ€æ ·å¼€å¯æ³¨è§£è£…é…ï¼Ÿ\" class=\"headerlink\" title=\"æ€æ ·å¼€å¯æ³¨è§£è£…é…ï¼Ÿ\"></a>æ€æ ·å¼€å¯æ³¨è§£è£…é…ï¼Ÿ</h3><p>æ³¨è§£è£…é…åœ¨é»˜è®¤æƒ…å†µä¸‹æ˜¯ä¸å¼€å¯çš„ï¼Œä¸ºäº†ä½¿ç”¨æ³¨è§£è£…é…ï¼Œå¿…é¡»åœ¨ Spring é…ç½®æ–‡ä»¶ä¸­é…ç½® <code>&lt;context:annotation-config/&gt;</code>ã€‚</p>\n<h3 id=\"Component-Controller-Repository-Service-æœ‰ä½•åŒºåˆ«ï¼Ÿ\"><a href=\"#Component-Controller-Repository-Service-æœ‰ä½•åŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"@Component, @Controller, @Repository, @Service æœ‰ä½•åŒºåˆ«ï¼Ÿ\"></a>@Component, @Controller, @Repository, @Service æœ‰ä½•åŒºåˆ«ï¼Ÿ</h3><p>@Componentï¼šè¿™å°† Java ç±»æ ‡è®°ä¸º beanã€‚spring çš„ç»„ä»¶æ‰«ææœºåˆ¶å¯ä»¥å°†å…¶æ‰«æå¹¶å°†å…¶æ³¨å†Œåˆ° IoC å®¹å™¨ä¸­ã€‚</p>\n<p>@Controllerï¼šè¿™å°†ä¸€ä¸ªç±»æ ‡è®°ä¸º Spring Web MVC æ§åˆ¶å™¨ã€‚æ ‡æœ‰å®ƒçš„ Bean ä¼šè‡ªåŠ¨å¯¼å…¥åˆ° IoC å®¹å™¨ä¸­ã€‚</p>\n<p>@Serviceï¼šæ­¤æ³¨è§£æ˜¯ç»„ä»¶æ³¨è§£çš„ç‰¹åŒ–ã€‚å®ƒä¸ä¼šå¯¹ @Component æ³¨è§£æä¾›ä»»ä½•å…¶ä»–è¡Œä¸ºã€‚æ‚¨å¯ä»¥åœ¨æœåŠ¡å±‚ç±»ä¸­ä½¿ç”¨ @Service è€Œä¸æ˜¯ @Componentï¼Œå› ä¸ºå®ƒä»¥æ›´å¥½çš„æ–¹å¼æŒ‡å®šäº†æ„å›¾ã€‚</p>\n<p>@Repositoryï¼šè¿™ä¸ªæ³¨è§£æ˜¯å…·æœ‰ç±»ä¼¼ç”¨é€”å’ŒåŠŸèƒ½çš„ @Component æ³¨è§£çš„ç‰¹åŒ–ã€‚å®ƒä¸º DAO æä¾›äº†é¢å¤–çš„å¥½å¤„ã€‚å®ƒå°† DAO å¯¼å…¥ IoC å®¹å™¨ï¼Œå¹¶ä½¿æœªç»æ£€æŸ¥çš„å¼‚å¸¸æœ‰èµ„æ ¼è½¬æ¢ä¸º Spring DataAccessExceptionã€‚</p>\n<h3 id=\"Required-æ³¨è§£æœ‰ä»€ä¹ˆä½œç”¨\"><a href=\"#Required-æ³¨è§£æœ‰ä»€ä¹ˆä½œç”¨\" class=\"headerlink\" title=\"@Required æ³¨è§£æœ‰ä»€ä¹ˆä½œç”¨\"></a>@Required æ³¨è§£æœ‰ä»€ä¹ˆä½œç”¨</h3><p><code>@Required</code>æ³¨è§£ä½œç”¨äº Bean<code>setter</code>æ–¹æ³•ä¸Šï¼Œç”¨äºæ£€æŸ¥ä¸€ä¸ª Bean çš„å±æ€§çš„å€¼<strong>åœ¨é…ç½®æœŸé—´æ˜¯å¦è¢«èµ‹äºˆæˆ–è®¾ç½®</strong>ï¼Œå¦‚æœæœªè¢«è®¾ç½®ï¼Œå®¹å™¨å°†æŠ›å‡º BeanInitializationExceptionã€‚ç¤ºä¾‹ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Employee</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String name;</span><br><span class=\"line\">    <span class=\"meta\">@Required</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">setName</span><span class=\"params\">(String name)</span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.name=name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> string <span class=\"title function_\">getName</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Autowiredå’Œ-Resourceä¹‹é—´çš„åŒºåˆ«\"><a href=\"#Autowiredå’Œ-Resourceä¹‹é—´çš„åŒºåˆ«\" class=\"headerlink\" title=\"@Autowiredå’Œ@Resourceä¹‹é—´çš„åŒºåˆ«\"></a>@Autowiredå’Œ@Resourceä¹‹é—´çš„åŒºåˆ«</h3><p>@Autowired å¯ç”¨äºï¼šæ„é€ å‡½æ•°ã€æˆå‘˜å˜é‡ã€Setter æ–¹æ³•</p>\n<p>@Autowired å’Œ@Resource ä¹‹é—´çš„åŒºåˆ«</p>\n<ul>\n<li>@Autowired é»˜è®¤æ˜¯<strong>æŒ‰ç…§ç±»å‹è£…é…æ³¨å…¥</strong>çš„ï¼Œé»˜è®¤æƒ…å†µä¸‹å®ƒè¦æ±‚ä¾èµ–å¯¹è±¡å¿…é¡»å­˜åœ¨ï¼ˆå¯ä»¥è®¾ç½®å®ƒ required å±æ€§ä¸º falseï¼‰ã€‚</li>\n<li>@Resource é»˜è®¤æ˜¯<strong>æŒ‰ç…§åç§°æ¥è£…é…æ³¨å…¥</strong>çš„ï¼Œåªæœ‰å½“æ‰¾ä¸åˆ°ä¸åç§°åŒ¹é…çš„ bean æ‰ä¼šæŒ‰ç…§ç±»å‹æ¥è£…é…æ³¨å…¥ã€‚</li>\n</ul>\n<h3 id=\"Qualifier-æ³¨è§£æœ‰ä»€ä¹ˆä½œç”¨\"><a href=\"#Qualifier-æ³¨è§£æœ‰ä»€ä¹ˆä½œç”¨\" class=\"headerlink\" title=\"@Qualifier æ³¨è§£æœ‰ä»€ä¹ˆä½œç”¨\"></a>@Qualifier æ³¨è§£æœ‰ä»€ä¹ˆä½œç”¨</h3><p>å½“æ‚¨åˆ›å»ºå¤šä¸ªç›¸åŒç±»å‹çš„ bean å¹¶å¸Œæœ›ä»…ä½¿ç”¨å±æ€§è£…é…å…¶ä¸­ä¸€ä¸ª bean æ—¶ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨@Qualifier æ³¨è§£å’Œ @Autowired é€šè¿‡æŒ‡å®šåº”è¯¥è£…é…å“ªä¸ªç¡®åˆ‡çš„ bean æ¥æ¶ˆé™¤æ­§ä¹‰ã€‚</p>\n<h3 id=\"RequestMapping-æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ\"><a href=\"#RequestMapping-æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ\" class=\"headerlink\" title=\"@RequestMapping æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ\"></a>@RequestMapping æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h3><p>@RequestMapping æ³¨è§£ç”¨äºå°†ç‰¹å®š HTTP è¯·æ±‚æ–¹æ³•æ˜ å°„åˆ°å°†å¤„ç†ç›¸åº”è¯·æ±‚çš„æ§åˆ¶å™¨ä¸­çš„ç‰¹å®šç±»&#x2F;æ–¹æ³•ã€‚æ­¤æ³¨é‡Šå¯åº”ç”¨äºä¸¤ä¸ªçº§åˆ«ï¼š</p>\n<ul>\n<li>ç±»çº§åˆ«ï¼šæ˜ å°„è¯·æ±‚çš„ URL</li>\n<li>æ–¹æ³•çº§åˆ«ï¼šæ˜ å°„ URL ä»¥åŠ HTTP è¯·æ±‚æ–¹æ³•</li>\n</ul>\n<h2 id=\"Springäº‹åŠ¡\"><a href=\"#Springäº‹åŠ¡\" class=\"headerlink\" title=\"Springäº‹åŠ¡\"></a>Springäº‹åŠ¡</h2><h3 id=\"Springæ”¯æŒçš„äº‹åŠ¡ç®¡ç†ç±»å‹-x2F-äº‹åŠ¡å®ç°æ–¹å¼æœ‰å“ªäº›ï¼Ÿ\"><a href=\"#Springæ”¯æŒçš„äº‹åŠ¡ç®¡ç†ç±»å‹-x2F-äº‹åŠ¡å®ç°æ–¹å¼æœ‰å“ªäº›ï¼Ÿ\" class=\"headerlink\" title=\"Springæ”¯æŒçš„äº‹åŠ¡ç®¡ç†ç±»å‹&#x2F;äº‹åŠ¡å®ç°æ–¹å¼æœ‰å“ªäº›ï¼Ÿ\"></a>Springæ”¯æŒçš„äº‹åŠ¡ç®¡ç†ç±»å‹&#x2F;äº‹åŠ¡å®ç°æ–¹å¼æœ‰å“ªäº›ï¼Ÿ</h3><p>Spring æ”¯æŒä¸¤ç§ç±»å‹çš„äº‹åŠ¡ç®¡ç†ï¼š</p>\n<p><strong>ç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç†</strong>ï¼šè¿™æ„å‘³ä½ é€šè¿‡ç¼–ç¨‹çš„æ–¹å¼ç®¡ç†äº‹åŠ¡ï¼Œç»™ä½ å¸¦æ¥æå¤§çš„çµæ´»æ€§ï¼Œä½†æ˜¯éš¾ç»´æŠ¤ã€‚</p>\n<p><strong>å£°æ˜å¼äº‹åŠ¡ç®¡ç†</strong>ï¼šè¿™æ„å‘³ç€ä½ å¯ä»¥å°†ä¸šåŠ¡ä»£ç å’Œäº‹åŠ¡ç®¡ç†åˆ†ç¦»ï¼Œä½ åªéœ€ç”¨æ³¨è§£å’Œ XML é…ç½®æ¥ç®¡ç†äº‹åŠ¡ã€‚</p>\n<h3 id=\"Springäº‹åŠ¡çš„å®ç°æ–¹å¼å’Œå®ç°åŸç†\"><a href=\"#Springäº‹åŠ¡çš„å®ç°æ–¹å¼å’Œå®ç°åŸç†\" class=\"headerlink\" title=\"Springäº‹åŠ¡çš„å®ç°æ–¹å¼å’Œå®ç°åŸç†\"></a>Springäº‹åŠ¡çš„å®ç°æ–¹å¼å’Œå®ç°åŸç†</h3><p>Spring äº‹åŠ¡çš„æœ¬è´¨å…¶å®å°±æ˜¯æ•°æ®åº“å¯¹äº‹åŠ¡çš„æ”¯æŒï¼Œæ²¡æœ‰æ•°æ®åº“çš„äº‹åŠ¡æ”¯æŒï¼ŒSpring æ˜¯æ— æ³•æä¾›äº‹åŠ¡åŠŸèƒ½çš„ã€‚</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- 2ã€é…ç½®äº‹åŠ¡çš„é€šçŸ¥ä»¥åŠäº‹åŠ¡çš„å±æ€§--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">tx:advice</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;txAdvice&quot;</span> <span class=\"attr\">transaction-manager</span>=<span class=\"string\">&quot;transactionManager&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- é…ç½®äº‹åŠ¡çš„å±æ€§</span></span><br><span class=\"line\"><span class=\"comment\">isolationï¼šç”¨äºæŒ‡å®šäº‹åŠ¡çš„éš”ç¦»çº§åˆ«ã€‚é»˜è®¤å€¼æ˜¯DEFAULTï¼Œè¡¨ç¤ºä½¿ç”¨æ•°æ®åº“çš„é»˜è®¤éš”</span></span><br><span class=\"line\"><span class=\"comment\">ç¦»çº§åˆ«ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">propagationï¼šç”¨äºæŒ‡å®šäº‹åŠ¡çš„ä¼ æ’­è¡Œä¸ºã€‚é»˜è®¤å€¼æ˜¯REQUIRED(å¢åˆ æ”¹)ï¼Œè¡¨ç¤ºä¸€å®šä¼š</span></span><br><span class=\"line\"><span class=\"comment\">æœ‰äº‹åŠ¡ã€‚æŸ¥è¯¢æ–¹æ³•å¯ä»¥é€‰æ‹©SUPPORTSã€‚</span></span><br><span class=\"line\"><span class=\"comment\">read-onlyï¼šç”¨äºæŒ‡å®šäº‹åŠ¡æ˜¯å¦åªè¯»ã€‚åªæœ‰æŸ¥è¯¢æ–¹æ³•æ‰èƒ½è®¾ç½®ä¸ºtrueã€‚é»˜è®¤å€¼æ˜¯</span></span><br><span class=\"line\"><span class=\"comment\">falseï¼Œè¡¨ç¤ºè¯»å†™ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">timeoutï¼šç”¨äºæŒ‡å®šäº‹åŠ¡çš„è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤å€¼æ˜¯-1ï¼Œè¡¨ç¤ºæ°¸ä¸è¶…æ—¶ã€‚å¦‚æœæŒ‡å®šäº†æ•°å€¼ï¼Œ</span></span><br><span class=\"line\"><span class=\"comment\">ä»¥ç§’ä¸ºå•ä½ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">rollback-forï¼šç”¨äºæŒ‡å®šä¸€ä¸ªå¼‚å¸¸ï¼Œå½“äº§ç”Ÿè¯¥å¼‚å¸¸æ—¶ï¼Œäº‹åŠ¡å›æ»šï¼Œäº§ç”Ÿå…¶ä»–å¼‚å¸¸æ—¶ï¼Œ</span></span><br><span class=\"line\"><span class=\"comment\">äº‹åŠ¡ä¸å›æ»šã€‚æ²¡æœ‰é»˜è®¤å€¼ã€‚è¡¨ç¤ºä»»ä½•å¼‚å¸¸éƒ½å›æ»šã€‚</span></span><br><span class=\"line\"><span class=\"comment\">no-rollback-forï¼šç”¨äºæŒ‡å®šä¸€ä¸ªå¼‚å¸¸ï¼Œå½“äº§ç”Ÿè¯¥å¼‚å¸¸æ—¶ï¼Œäº‹åŠ¡ä¸å›æ»šï¼Œäº§ç”Ÿå…¶ä»–å¼‚å¸¸</span></span><br><span class=\"line\"><span class=\"comment\">æ—¶äº‹åŠ¡å›æ»šã€‚æ²¡æœ‰é»˜è®¤å€¼ã€‚è¡¨ç¤ºä»»ä½•å¼‚å¸¸éƒ½å›æ»šã€‚</span></span><br><span class=\"line\"><span class=\"comment\">--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">tx:attributes</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--éæŸ¥è¯¢æ–¹æ³•--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">tx:method</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;*&quot;</span> <span class=\"attr\">propagation</span>=<span class=\"string\">&quot;REQUIRED&quot;</span> <span class=\"attr\">read-only</span>=<span class=\"string\">&quot;false&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--æŸ¥è¯¢æ–¹æ³•--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">tx:method</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;find*&quot;</span> <span class=\"attr\">propagation</span>=<span class=\"string\">&quot;SUPPORTS&quot;</span> <span class=\"attr\">read-only</span>=<span class=\"string\">&quot;true&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">tx:attributes</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">tx:advice</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"è¯´ä¸€ä¸‹Springçš„äº‹åŠ¡ä¼ æ’­è¡Œä¸º\"><a href=\"#è¯´ä¸€ä¸‹Springçš„äº‹åŠ¡ä¼ æ’­è¡Œä¸º\" class=\"headerlink\" title=\"è¯´ä¸€ä¸‹Springçš„äº‹åŠ¡ä¼ æ’­è¡Œä¸º\"></a>è¯´ä¸€ä¸‹Springçš„äº‹åŠ¡ä¼ æ’­è¡Œä¸º</h3><p>spring äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸ºè¯´çš„æ˜¯ï¼Œå½“å¤šä¸ªäº‹åŠ¡åŒæ—¶å­˜åœ¨çš„æ—¶å€™ï¼Œspring å¦‚ä½•å¤„ç†è¿™äº›äº‹åŠ¡çš„è¡Œä¸ºã€‚</p>\n<blockquote>\n<p>â‘  <strong>PROPAGATION_REQUIRED</strong>ï¼šå¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œå°±åˆ›å»ºä¸€ä¸ªæ–°äº‹åŠ¡ï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±åŠ å…¥è¯¥äº‹åŠ¡ï¼Œè¯¥è®¾ç½®æ˜¯æœ€å¸¸ç”¨çš„è®¾ç½®ã€‚ï¼ˆé»˜è®¤å€¼ï¼Œé€‚ç”¨äºéæŸ¥è¯¢æ–¹æ³•ï¼Œå¢åˆ æ”¹ï¼‰ï¼ˆäº‹åŠ¡å­˜åœ¨å°±ç”¨ä¸å­˜åœ¨è¦åˆ›å»ºï¼‰<br>â‘¡ <strong>PROPAGATION_SUPPORTS</strong>ï¼šæ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±åŠ å…¥è¯¥äº‹åŠ¡ï¼Œå¦‚æœå½“å‰ä¸å­˜åœ¨äº‹åŠ¡ï¼Œå°±ä»¥éäº‹åŠ¡æ‰§è¡Œã€‚ï¼ˆé€‚ç”¨äºæŸ¥è¯¢æ–¹æ³•ï¼‰ï¼ˆäº‹åŠ¡å­˜åœ¨å°±ç”¨ä¸å­˜åœ¨å°±ä¸ç”¨ï¼‰<br>â‘¢ PROPAGATION_MANDATORYï¼šæ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±åŠ å…¥è¯¥äº‹åŠ¡ï¼Œå¦‚æœå½“å‰ä¸å­˜åœ¨äº‹åŠ¡ï¼Œå°±æŠ›å‡ºå¼‚å¸¸ã€‚<br>â‘£ <strong>PROPAGATION_REQUIRES_NEW</strong>ï¼šåˆ›å»ºæ–°äº‹åŠ¡ï¼Œæ— è®ºå½“å‰å­˜ä¸å­˜åœ¨äº‹åŠ¡ï¼Œéƒ½åˆ›å»ºæ–°äº‹åŠ¡ã€‚ï¼ˆæ°¸è¿œéƒ½è¦æ–°äº‹åŠ¡ï¼‰<br>â‘¤ PROPAGATION_NOT_SUPPORTEDï¼šä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œæ“ä½œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±æŠŠå½“å‰äº‹åŠ¡æŒ‚èµ·ã€‚<br>â‘¥ PROPAGATION_NEVERï¼šä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚<br>â‘¦ PROPAGATION_NESTEDï¼šå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åœ¨åµŒå¥—äº‹åŠ¡å†…æ‰§è¡Œã€‚å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œåˆ™æŒ‰REQUIREDå±æ€§æ‰§è¡Œã€‚</p>\n</blockquote>\n<h3 id=\"è¯´ä¸€ä¸‹-spring-çš„äº‹åŠ¡éš”ç¦»ï¼Ÿ\"><a href=\"#è¯´ä¸€ä¸‹-spring-çš„äº‹åŠ¡éš”ç¦»ï¼Ÿ\" class=\"headerlink\" title=\"è¯´ä¸€ä¸‹ spring çš„äº‹åŠ¡éš”ç¦»ï¼Ÿ\"></a>è¯´ä¸€ä¸‹ spring çš„äº‹åŠ¡éš”ç¦»ï¼Ÿ</h3><p>spring æœ‰äº”å¤§éš”ç¦»çº§åˆ«ï¼Œé»˜è®¤å€¼ä¸º ISOLATION_DEFAULTï¼ˆä½¿ç”¨æ•°æ®åº“çš„è®¾ç½®ï¼‰ï¼Œå…¶ä»–å››ä¸ªéš”ç¦»çº§åˆ«å’Œæ•°æ®åº“çš„éš”ç¦»çº§åˆ«ä¸€è‡´ï¼š</p>\n<ol>\n<li>ISOLATION_DEFAULTï¼šç”¨åº•å±‚æ•°æ®åº“çš„è®¾ç½®éš”ç¦»çº§åˆ«ï¼Œæ•°æ®åº“è®¾ç½®çš„æ˜¯ä»€ä¹ˆæˆ‘å°±ç”¨ä»€ä¹ˆï¼›</li>\n<li>ISOLATION_READ_UNCOMMITTEDï¼šè¯»æœªæäº¤ï¼Œæœ€ä½éš”ç¦»çº§åˆ«ã€äº‹åŠ¡æœªæäº¤å‰ï¼Œå°±å¯è¢«å…¶ä»–äº‹åŠ¡è¯»å–ï¼ˆä¼šå‡ºç°è„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»ï¼‰ï¼›</li>\n<li>ISOLATION_READ_COMMITTEDï¼šè¯»å·²æäº¤ï¼Œä¸€ä¸ªäº‹åŠ¡æäº¤åæ‰èƒ½è¢«å…¶ä»–äº‹åŠ¡è¯»å–åˆ°ï¼ˆä¼šé€ æˆä¸å¯é‡å¤è¯»ã€å¹»è¯»ï¼‰ï¼ŒSQL server çš„é»˜è®¤çº§åˆ«ï¼›</li>\n<li>ISOLATION_REPEATABLE_READï¼šå¯é‡å¤è¯»ï¼Œä¿è¯å¤šæ¬¡è¯»å–åŒä¸€ä¸ªæ•°æ®æ—¶ï¼Œå…¶å€¼éƒ½å’Œäº‹åŠ¡å¼€å§‹æ—¶å€™çš„å†…å®¹æ˜¯ä¸€è‡´ï¼Œç¦æ­¢è¯»å–åˆ°åˆ«çš„äº‹åŠ¡æœªæäº¤çš„æ•°æ®ï¼ˆä¼šé€ æˆå¹»è¯»ï¼‰ï¼ŒMySQL çš„é»˜è®¤çº§åˆ«ï¼›</li>\n<li>ISOLATION_SERIALIZABLEï¼šåºåˆ—åŒ–ï¼Œä»£ä»·æœ€é«˜æœ€å¯é çš„éš”ç¦»çº§åˆ«ï¼Œè¯¥éš”ç¦»çº§åˆ«èƒ½é˜²æ­¢è„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»ã€‚</li>\n</ol>\n<h2 id=\"Springé¢å‘åˆ‡é¢ç¼–ç¨‹-AOP\"><a href=\"#Springé¢å‘åˆ‡é¢ç¼–ç¨‹-AOP\" class=\"headerlink\" title=\"Springé¢å‘åˆ‡é¢ç¼–ç¨‹(AOP)\"></a>Springé¢å‘åˆ‡é¢ç¼–ç¨‹(AOP)</h2><h3 id=\"ä»€ä¹ˆæ˜¯AOP\"><a href=\"#ä»€ä¹ˆæ˜¯AOP\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯AOP\"></a>ä»€ä¹ˆæ˜¯AOP</h3><p>OOP(Object-Oriented Programming)é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œå…è®¸å¼€å‘è€…å®šä¹‰çºµå‘çš„å…³ç³»ï¼Œä½†å¹¶é€‚ç”¨äºå®šä¹‰æ¨ªå‘çš„å…³ç³»ï¼Œå¯¼è‡´äº†å¤§é‡ä»£ç çš„é‡å¤ï¼Œè€Œä¸åˆ©äºå„ä¸ªæ¨¡å—çš„é‡ç”¨ã€‚</p>\n<p>AOP(Aspect-Oriented Programming)ï¼Œä¸€èˆ¬ç§°ä¸ºé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œä½œä¸ºé¢å‘å¯¹è±¡çš„ä¸€ç§è¡¥å……ï¼Œå°†ä¸€äº›<strong>å…¬å…±è¡Œä¸ºå’Œé€»è¾‘ï¼ŒæŠ½å–å¹¶å°è£…ä¸ºä¸€ä¸ªå¯é‡ç”¨çš„æ¨¡å—ï¼Œå‡å°‘ç³»ç»Ÿä¸­çš„é‡å¤ä»£ç ï¼Œé™ä½äº†æ¨¡å—é—´çš„è€¦åˆåº¦ï¼ŒåŒæ—¶æé«˜äº†ç³»ç»Ÿçš„å¯ç»´æŠ¤æ€§ã€‚å¯ç”¨äºæƒé™è®¤è¯ã€æ—¥å¿—ã€äº‹åŠ¡å¤„ç†ç­‰</strong>ã€‚</p>\n<h3 id=\"Spring-AOP-and-AspectJ-AOP-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼ŸAOP-æœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ\"><a href=\"#Spring-AOP-and-AspectJ-AOP-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼ŸAOP-æœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ\" class=\"headerlink\" title=\"Spring AOP and AspectJ AOP æœ‰ä»€ä¹ˆåŒºåˆ«ï¼ŸAOP æœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ\"></a>Spring AOP and AspectJ AOP æœ‰ä»€ä¹ˆåŒºåˆ«ï¼ŸAOP æœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ</h3><p>AOP å®ç°çš„å…³é”®åœ¨äº ä»£ç†æ¨¡å¼ï¼ŒAOP ä»£ç†ä¸»è¦åˆ†ä¸ºé™æ€ä»£ç†ï¼ˆAspectJï¼‰å’ŒåŠ¨æ€ä»£ç†ï¼ˆSpring AOPï¼‰ã€‚</p>\n<p>ï¼ˆ1ï¼‰AspectJ é‡‡ç”¨é™æ€ä»£ç†æ¨¡å¼ï¼Œå±äº<strong>ç¼–è¯‘æ—¶å¢å¼º</strong>ï¼Œä¼šåœ¨ç¼–è¯‘é˜¶æ®µç»‡å…¥åˆ‡é¢ç”Ÿæˆç›¸åº”çš„ä»£ç†å¯¹è±¡</p>\n<p>ï¼ˆ2ï¼‰Spring AOP é‡‡ç”¨åŠ¨æ€ä»£ç†æ¨¡å¼ï¼Œå±äº<strong>è¿è¡Œæ—¶å¢å¼º</strong>ï¼Œæ¯æ¬¡è¿è¡Œæ—¶ç»‡å…¥åˆ‡é¢åœ¨å†…å­˜ä¸­ä¸´æ—¶ç”Ÿæˆç›¸åº”çš„ä»£ç†å¯¹è±¡</p>\n<h3 id=\"JDKåŠ¨æ€ä»£ç†å’ŒCGLIBåŠ¨æ€ä»£ç†çš„åŒºåˆ«\"><a href=\"#JDKåŠ¨æ€ä»£ç†å’ŒCGLIBåŠ¨æ€ä»£ç†çš„åŒºåˆ«\" class=\"headerlink\" title=\"JDKåŠ¨æ€ä»£ç†å’ŒCGLIBåŠ¨æ€ä»£ç†çš„åŒºåˆ«\"></a>JDKåŠ¨æ€ä»£ç†å’ŒCGLIBåŠ¨æ€ä»£ç†çš„åŒºåˆ«</h3><p>JDK åŠ¨æ€ä»£ç†ä¸»è¦æ˜¯é’ˆå¯¹ç±»å®ç°äº†æŸä¸ªæ¥å£ï¼ŒAOP åˆ™ä¼šä½¿ç”¨ JDK åŠ¨æ€ä»£ç†ã€‚åŸºäºåå°„çš„æœºåˆ¶å®ç°ï¼Œç”Ÿæˆä¸€ä¸ªå®ç°è¯¥æ¥å£çš„ä¸€ä¸ªä»£ç†ç±»ï¼Œç„¶åé€šè¿‡é‡å†™æ–¹æ³•çš„æ–¹å¼ï¼Œå®ç°å¯¹ä»£ç çš„å¢å¼ºã€‚</p>\n<p>è€Œå¦‚æœæŸä¸ªç±»æ²¡æœ‰å®ç°æ¥å£ï¼ŒAOP åˆ™ä¼šä½¿ç”¨ CGLIB ä»£ç†ã€‚åº•å±‚åŸç†æ˜¯<strong>åŸºäº asm ç¬¬ä¸‰æ–¹æ¡†æ¶</strong>ï¼Œé€šè¿‡ä¿®æ”¹å­—èŠ‚ç ç”Ÿæˆä¸€ä¸ªå­ç±»ï¼Œç„¶åé‡å†™çˆ¶ç±»çš„æ–¹æ³•ï¼Œå®ç°å¯¹ä»£ç çš„å¢å¼ºã€‚</p>\n<blockquote>\n<p>ä½œè€…ï¼šé˜¿é‡Œäº‘äº‘æ –å·</p>\n<p>é“¾æ¥ï¼š<a href=\"https://zhuanlan.zhihu.com/p/368769721\">https://zhuanlan.zhihu.com/p/368769721</a></p>\n<p>æ¥æºï¼šçŸ¥ä¹</p>\n<p>è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>\n</blockquote>\n<h3 id=\"è§£é‡Šä¸€ä¸‹Spring-AOPé‡Œé¢çš„å‡ ä¸ªåè¯\"><a href=\"#è§£é‡Šä¸€ä¸‹Spring-AOPé‡Œé¢çš„å‡ ä¸ªåè¯\" class=\"headerlink\" title=\"è§£é‡Šä¸€ä¸‹Spring AOPé‡Œé¢çš„å‡ ä¸ªåè¯\"></a>è§£é‡Šä¸€ä¸‹Spring AOPé‡Œé¢çš„å‡ ä¸ªåè¯</h3><p>ï¼ˆ1ï¼‰åˆ‡é¢ï¼ˆAspectï¼‰ï¼šåˆ‡é¢æ˜¯é€šçŸ¥å’Œåˆ‡ç‚¹çš„ç»“åˆã€‚ åœ¨ Spring AOP ä¸­ï¼Œåˆ‡é¢å¯ä»¥ä½¿ç”¨é€šç”¨ç±»ï¼ˆåŸºäºæ¨¡å¼çš„é£æ ¼ï¼‰ æˆ–è€…åœ¨æ™®é€šç±»ä¸­ä»¥ @AspectJ æ³¨è§£æ¥å®ç°ã€‚</p>\n<p>ï¼ˆ2ï¼‰è¿æ¥ç‚¹ï¼ˆJoin pointï¼‰ï¼šæ–¹æ³•</p>\n<p>ï¼ˆ3ï¼‰é€šçŸ¥ï¼ˆAdviceï¼‰ï¼šåœ¨è¦å¢å¼ºä¸Šçš„è¿æ¥ç‚¹ä¸Šè¦è¿›è¡Œæ€æ ·çš„å¢å¼º</p>\n<p>ï¼ˆ4ï¼‰åˆ‡å…¥ç‚¹ï¼ˆPointcutï¼‰ï¼šå“ªäº›è¿æ¥ç‚¹éœ€è¦å¢å¼º</p>\n<p>ï¼ˆ5ï¼‰ç›®æ ‡å¯¹è±¡ï¼ˆTarget Objectï¼‰ï¼š è¢«ä»£ç†ï¼ˆproxiedï¼‰ å¯¹è±¡ã€‚</p>\n<p>ï¼ˆ6ï¼‰ç»‡å…¥ï¼ˆWeavingï¼‰ï¼šç»‡å…¥æ˜¯æŠŠåˆ‡é¢åº”ç”¨åˆ°ç›®æ ‡å¯¹è±¡å¹¶åˆ›å»ºæ–°çš„ä»£ç†å¯¹è±¡çš„è¿‡ç¨‹ã€‚</p>\n<p>ï¼ˆ7ï¼‰Proxyï¼ˆä»£ç†ï¼‰ï¼šä¸€ä¸ªç±»è¢« AOP ç»‡å…¥å¢å¼ºåï¼Œå°±äº§ç”Ÿä¸€ä¸ªç»“æœä»£ç†ç±»ã€‚</p>\n<blockquote>\n<ul>\n<li>ç¼–è¯‘æœŸï¼šåˆ‡é¢åœ¨ç›®æ ‡ç±»ç¼–è¯‘æ—¶è¢«ç»‡å…¥ã€‚AspectJçš„ç»‡å…¥ç¼–è¯‘å™¨æ˜¯ä»¥è¿™ç§æ–¹å¼ç»‡å…¥åˆ‡é¢çš„ã€‚</li>\n<li>ç±»åŠ è½½æœŸï¼šåˆ‡é¢åœ¨ç›®æ ‡ç±»åŠ è½½åˆ°JVMæ—¶è¢«ç»‡å…¥ã€‚éœ€è¦ç‰¹æ®Šçš„ç±»åŠ è½½å™¨ï¼Œå®ƒå¯ä»¥åœ¨ç›®æ ‡ç±»è¢«å¼•å…¥åº”ç”¨ä¹‹å‰å¢å¼ºè¯¥ç›®æ ‡ç±»çš„å­—èŠ‚ç ã€‚AspectJ5çš„åŠ è½½æ—¶ç»‡å…¥å°±æ”¯æŒä»¥è¿™ç§æ–¹å¼ç»‡å…¥åˆ‡é¢ã€‚</li>\n<li>è¿è¡ŒæœŸï¼šåˆ‡é¢åœ¨åº”ç”¨è¿è¡Œçš„æŸä¸ªæ—¶åˆ»è¢«ç»‡å…¥ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œåœ¨ç»‡å…¥åˆ‡é¢æ—¶ï¼ŒAOPå®¹å™¨ä¼šä¸ºç›®æ ‡å¯¹è±¡åŠ¨æ€åœ°åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡ã€‚SpringAOPå°±æ˜¯ä»¥è¿™ç§æ–¹å¼ç»‡å…¥åˆ‡é¢ã€‚</li>\n</ul>\n</blockquote>\n<h3 id=\"Springé€šçŸ¥æœ‰å“ªäº›ç±»å‹ï¼Ÿ\"><a href=\"#Springé€šçŸ¥æœ‰å“ªäº›ç±»å‹ï¼Ÿ\" class=\"headerlink\" title=\"Springé€šçŸ¥æœ‰å“ªäº›ç±»å‹ï¼Ÿ\"></a>Springé€šçŸ¥æœ‰å“ªäº›ç±»å‹ï¼Ÿ</h3><p>åœ¨ AOP æœ¯è¯­ä¸­ï¼Œåˆ‡é¢çš„å·¥ä½œè¢«ç§°ä¸ºé€šçŸ¥ï¼Œå®é™…ä¸Šæ˜¯ç¨‹åºæ‰§è¡Œæ—¶è¦é€šè¿‡ SpringAOP æ¡†æ¶è§¦å‘çš„ä»£ç æ®µã€‚</p>\n<p>Spring åˆ‡é¢å¯ä»¥åº”ç”¨ 5 ç§ç±»å‹çš„é€šçŸ¥ï¼š</p>\n<ol>\n<li>å‰ç½®é€šçŸ¥ï¼ˆBeforeï¼‰ï¼šåœ¨ç›®æ ‡æ–¹æ³•è¢«è°ƒç”¨ä¹‹å‰è°ƒç”¨é€šçŸ¥åŠŸèƒ½ï¼›</li>\n<li>åç½®é€šçŸ¥ï¼ˆAfterï¼‰ï¼šåœ¨ç›®æ ‡æ–¹æ³•å®Œæˆä¹‹åè°ƒç”¨é€šçŸ¥ï¼Œæ­¤æ—¶ä¸ä¼šå…³å¿ƒæ–¹æ³•çš„è¾“å‡ºæ˜¯ä»€ä¹ˆï¼›</li>\n<li>è¿”å›é€šçŸ¥ï¼ˆAfter-returning ï¼‰ï¼šåœ¨ç›®æ ‡æ–¹æ³•æˆåŠŸæ‰§è¡Œä¹‹åè°ƒç”¨é€šçŸ¥ï¼›</li>\n<li>å¼‚å¸¸é€šçŸ¥ï¼ˆAfter-throwingï¼‰ï¼šåœ¨ç›®æ ‡æ–¹æ³•æŠ›å‡ºå¼‚å¸¸åè°ƒç”¨é€šçŸ¥ï¼›</li>\n<li>ç¯ç»•é€šçŸ¥ï¼ˆAroundï¼‰ï¼šé€šçŸ¥åŒ…è£¹äº†è¢«é€šçŸ¥çš„æ–¹æ³•ï¼Œåœ¨è¢«é€šçŸ¥çš„æ–¹æ³•è°ƒç”¨ä¹‹å‰å’Œè°ƒç”¨ä¹‹åæ‰§è¡Œè‡ªå®šä¹‰çš„è¡Œä¸ºã€‚</li>\n</ol>\n<blockquote>\n<p>åŒä¸€ä¸ªaspectï¼Œä¸åŒadviceçš„æ‰§è¡Œé¡ºåºï¼š</p>\n<p>â‘ æ²¡æœ‰å¼‚å¸¸æƒ…å†µä¸‹çš„æ‰§è¡Œé¡ºåºï¼š</p>\n<p>around before advice\tæ–¹æ³•è°ƒç”¨ä¹‹å‰è‡ªå®šä¹‰è¡Œä¸º<br>before advice<br>target method æ‰§è¡Œ<br>around after advice\tæ–¹æ³•è°ƒç”¨åè‡ªå®šä¹‰è¡Œä¸º<br>after advice<br>afterReturning</p>\n<p>â‘¡æœ‰å¼‚å¸¸æƒ…å†µä¸‹çš„æ‰§è¡Œé¡ºåºï¼š</p>\n<p>around before advice<br>before advice<br>target method æ‰§è¡Œ<br>around after advice<br>after advice<br>afterThrowing:å¼‚å¸¸å‘ç”Ÿ<br>Java.lang.RuntimeException: å¼‚å¸¸å‘ç”Ÿ</p>\n</blockquote>\n<h3 id=\"ä»€ä¹ˆæ˜¯åˆ‡é¢-Aspectï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯åˆ‡é¢-Aspectï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯åˆ‡é¢ Aspectï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯åˆ‡é¢ Aspectï¼Ÿ</h3><p>aspect ç”± pointcount å’Œ advice ç»„æˆï¼Œåˆ‡é¢æ˜¯é€šçŸ¥å’Œåˆ‡ç‚¹çš„ç»“åˆã€‚<br>AOP çš„å·¥ä½œé‡å¿ƒåœ¨äºå¦‚ä½•å°†å¢å¼ºç¼–ç»‡ç›®æ ‡å¯¹è±¡çš„è¿æ¥ç‚¹ä¸Š, è¿™é‡ŒåŒ…å«ä¸¤ä¸ªå·¥ä½œ:  </p>\n<ul>\n<li>å¦‚ä½•é€šè¿‡ pointcut å’Œ advice å®šä½åˆ°ç‰¹å®šçš„ joinpoint ä¸Š</li>\n<li>å¦‚ä½•åœ¨ advice ä¸­ç¼–å†™åˆ‡é¢ä»£ç </li>\n</ul>\n<p>å¯ä»¥ç®€å•åœ°è®¤ä¸º, ä½¿ç”¨ @Aspect æ³¨è§£çš„ç±»å°±æ˜¯åˆ‡é¢</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes2020021212264438.png\" alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\"></p>\n","site":{"data":{}},"length":15032,"excerpt":"<blockquote>\n<p>æ•´ç†çš„Springæ¡†æ¶ç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½","more":"</p>\n</blockquote>\n<h2 id=\"Springæ¦‚è¿°\"><a href=\"#Springæ¦‚è¿°\" class=\"headerlink\" title=\"Springæ¦‚è¿°\"></a>Springæ¦‚è¿°</h2><h3 id=\"ä»€ä¹ˆæ˜¯spring\"><a href=\"#ä»€ä¹ˆæ˜¯spring\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯spring?\"></a>ä»€ä¹ˆæ˜¯spring?</h3><p>Spring æ˜¯<strong>ä¸€ä¸ªè½»é‡çº§Javaå¼€å‘æ¡†æ¶</strong>ï¼Œç›®çš„æ˜¯ä¸ºäº†è§£å†³å¼€å‘ä¸­çš„<strong>ä¸šåŠ¡é€»è¾‘å±‚å’Œå…¶ä»–å„å±‚çš„è€¦åˆé—®é¢˜</strong>ï¼Œç®€åŒ– Java å¼€å‘ã€‚</p>\n<h3 id=\"Springæ¡†æ¶çš„æ ¸å¿ƒæ˜¯ä»€ä¹ˆ\"><a href=\"#Springæ¡†æ¶çš„æ ¸å¿ƒæ˜¯ä»€ä¹ˆ\" class=\"headerlink\" title=\"Springæ¡†æ¶çš„æ ¸å¿ƒæ˜¯ä»€ä¹ˆ\"></a>Springæ¡†æ¶çš„æ ¸å¿ƒæ˜¯ä»€ä¹ˆ</h3><p><strong>Springæ¡†æ¶çš„æ ¸å¿ƒ</strong>ï¼šIoC å®¹å™¨å’Œ AOP æ¨¡å—ã€‚<br>é€šè¿‡ IoC å®¹å™¨ç®¡ç† Java Bean å¯¹è±¡åŠå…¶ç”Ÿå‘½å‘¨æœŸä»¥åŠä»–ä»¬ä¹‹é—´çš„è€¦åˆå…³ç³»ï¼›<br>é€šè¿‡ AOP å°†ä¸€äº›å…¬å…±è¡Œä¸ºå’Œé€»è¾‘ï¼ŒæŠ½å–å¹¶å°è£…ä¸ºä¸€ä¸ªå¯é‡ç”¨çš„æ¨¡å—ï¼Œå‡å°‘ç³»ç»Ÿä¸­çš„é‡å¤ä»£ç ï¼Œé™ä½æ¨¡å—é—´çš„è€¦åˆåº¦</p>\n<h3 id=\"Springçš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#Springçš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"Springçš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>Springçš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>ä¼˜ç‚¹</p>\n<ul>\n<li><p>æ–¹ä¾¿è§£è€¦ï¼Œç®€åŒ–å¼€å‘ï¼ˆ<strong>IoC</strong>ï¼‰</p>\n<p>  Spring å°±æ˜¯ä¸€ä¸ªå¤§å·¥å‚ï¼Œå¯ä»¥å°†æ‰€æœ‰å¯¹è±¡çš„åˆ›å»ºå’Œä¾èµ–å…³ç³»çš„ç»´æŠ¤ï¼Œäº¤ç»™ Spring ç®¡ç†ã€‚</p>\n</li>\n<li><p>AOP ç¼–ç¨‹çš„æ”¯æŒï¼ˆ<strong>AOP</strong>ï¼‰</p>\n<p>  Spring æä¾›é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œå¯ä»¥æ–¹ä¾¿çš„å®ç°å¯¹ç¨‹åºè¿›è¡Œæƒé™æ‹¦æˆªã€è¿è¡Œç›‘æ§ç­‰åŠŸèƒ½ã€‚</p>\n</li>\n<li><p>å£°æ˜å¼äº‹åŠ¡çš„æ”¯æŒï¼ˆ<strong>äº‹åŠ¡</strong>ï¼‰</p>\n<p>  åªéœ€è¦é€šè¿‡é…ç½®å°±å¯ä»¥å®Œæˆå¯¹äº‹åŠ¡çš„ç®¡ç†ï¼Œè€Œæ— éœ€æ‰‹åŠ¨ç¼–ç¨‹ã€‚</p>\n</li>\n<li><p>æ–¹ä¾¿é›†æˆå„ç§ä¼˜ç§€æ¡†æ¶ï¼ˆ<strong>é›†æˆ</strong>ï¼‰</p>\n<p>  Spring ä¸æ’æ–¥å„ç§ä¼˜ç§€çš„å¼€æºæ¡†æ¶ï¼Œå…¶å†…éƒ¨æä¾›äº†å¯¹å„ç§ä¼˜ç§€æ¡†æ¶çš„ç›´æ¥æ”¯æŒï¼ˆå¦‚ï¼šStrutsã€Hibernateã€MyBatis ç­‰ï¼‰ã€‚</p>\n</li>\n</ul>\n<p>ç¼ºç‚¹</p>\n<ul>\n<li>Spring<strong>ä¾èµ–åå°„ï¼Œåå°„å½±å“æ€§èƒ½</strong></li>\n</ul>\n<h3 id=\"Spring-æ¡†æ¶ä¸­éƒ½ç”¨åˆ°äº†å“ªäº›è®¾è®¡æ¨¡å¼ï¼Ÿ\"><a href=\"#Spring-æ¡†æ¶ä¸­éƒ½ç”¨åˆ°äº†å“ªäº›è®¾è®¡æ¨¡å¼ï¼Ÿ\" class=\"headerlink\" title=\"Spring æ¡†æ¶ä¸­éƒ½ç”¨åˆ°äº†å“ªäº›è®¾è®¡æ¨¡å¼ï¼Ÿ\"></a>Spring æ¡†æ¶ä¸­éƒ½ç”¨åˆ°äº†å“ªäº›è®¾è®¡æ¨¡å¼ï¼Ÿ</h3><ol>\n<li>å·¥å‚æ¨¡å¼ï¼šé€šè¿‡ BeanFactory å’Œ ApplicationContext æ¥ç®¡ç† Bean å¯¹è±¡ã€‚</li>\n<li>å•ä¾‹æ¨¡å¼ï¼šBean é»˜è®¤ä¸ºå•ä¾‹æ¨¡å¼ã€‚</li>\n<li>ä»£ç†æ¨¡å¼ï¼šSpring çš„ AOP åŠŸèƒ½ç”¨åˆ°äº†åŸºäºæ¥å£çš„ JDK çš„åŠ¨æ€ä»£ç†å’ŒåŸºäºå­ç±»çš„ CGLIB åŠ¨æ€ä»£ç†ï¼›</li>\n</ol>\n<h3 id=\"Springæ¡†æ¶ä¸­æœ‰å“ªäº›ä¸åŒç±»å‹çš„äº‹ä»¶\"><a href=\"#Springæ¡†æ¶ä¸­æœ‰å“ªäº›ä¸åŒç±»å‹çš„äº‹ä»¶\" class=\"headerlink\" title=\"Springæ¡†æ¶ä¸­æœ‰å“ªäº›ä¸åŒç±»å‹çš„äº‹ä»¶\"></a>Springæ¡†æ¶ä¸­æœ‰å“ªäº›ä¸åŒç±»å‹çš„äº‹ä»¶</h3><p><strong>Springçš„ApplicationContext æä¾›äº†æ”¯æŒäº‹ä»¶å’Œä»£ç ä¸­ç›‘å¬å™¨çš„åŠŸèƒ½ã€‚</strong>  </p>\n<p>å¦‚æœä¸€ä¸ª bean å®ç°äº†<code>ApplicationListener</code>æ¥å£ï¼Œå½“ä¸€ä¸ª<code>ApplicationEvent</code> è¢«å‘å¸ƒä»¥åï¼Œbean ä¼šè‡ªåŠ¨è¢«é€šçŸ¥ã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public <span class=\"keyword\">class</span> <span class=\"title class_\">AllApplicationEventListener</span> implements <span class=\"title class_\">ApplicationListener</span> &lt; <span class=\"title class_\">ApplicationEvent</span> &gt;&#123;</span><br><span class=\"line\">    @<span class=\"title class_\">Override</span></span><br><span class=\"line\">    public <span class=\"keyword\">void</span> <span class=\"title function_\">onApplicationEvent</span>(<span class=\"params\">ApplicationEvent applicationEvent</span>)&#123;</span><br><span class=\"line\">        <span class=\"comment\">//process event</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>Spring æä¾›äº†ä»¥ä¸‹5ç§æ ‡å‡†çš„äº‹ä»¶ï¼š</strong></p>\n<ul>\n<li>ä¸Šä¸‹æ–‡æ›´æ–°äº‹ä»¶ï¼ˆContextRefreshedEventï¼‰ï¼šè¯¥äº‹ä»¶ä¼šåœ¨ ApplicationContext è¢«åˆå§‹åŒ–æˆ–è€…æ›´æ–°æ—¶å‘å¸ƒã€‚ä¹Ÿå¯ä»¥åœ¨è°ƒç”¨<code>ConfigurableApplicationContext</code> æ¥å£ä¸­çš„<code>refresh()</code>æ–¹æ³•æ—¶è¢«è§¦å‘ã€‚</li>\n<li>ä¸Šä¸‹æ–‡å¼€å§‹äº‹ä»¶ï¼ˆContextStartedEventï¼‰ï¼šå½“å®¹å™¨è°ƒç”¨<code>ConfigurableApplicationContext</code>çš„<code>Start()</code>æ–¹æ³•å¼€å§‹&#x2F;é‡æ–°å¼€å§‹å®¹å™¨æ—¶è§¦å‘è¯¥äº‹ä»¶ã€‚</li>\n<li>ä¸Šä¸‹æ–‡åœæ­¢äº‹ä»¶ï¼ˆContextStoppedEventï¼‰ï¼šå½“å®¹å™¨è°ƒç”¨<code>ConfigurableApplicationContext</code>çš„<code>Stop()</code>æ–¹æ³•åœæ­¢å®¹å™¨æ—¶è§¦å‘è¯¥äº‹ä»¶ã€‚</li>\n<li>ä¸Šä¸‹æ–‡å…³é—­äº‹ä»¶ï¼ˆContextClosedEventï¼‰ï¼šå½“<code>ApplicationContext</code>è¢«å…³é—­æ—¶è§¦å‘è¯¥äº‹ä»¶ã€‚å®¹å™¨è¢«å…³é—­æ—¶ï¼Œå…¶ç®¡ç†çš„æ‰€æœ‰å•ä¾‹ Bean éƒ½è¢«é”€æ¯ã€‚</li>\n<li>è¯·æ±‚å¤„ç†äº‹ä»¶ï¼ˆRequestHandledEventï¼‰ï¼šåœ¨ Web åº”ç”¨ä¸­ï¼Œå½“ä¸€ä¸ª http è¯·æ±‚ï¼ˆrequestï¼‰ç»“æŸè§¦å‘è¯¥äº‹ä»¶ã€‚</li>\n</ul>\n<h3 id=\"Spring-åº”ç”¨ç¨‹åºæœ‰å“ªäº›ä¸åŒç»„ä»¶ï¼Ÿ\"><a href=\"#Spring-åº”ç”¨ç¨‹åºæœ‰å“ªäº›ä¸åŒç»„ä»¶ï¼Ÿ\" class=\"headerlink\" title=\"Spring åº”ç”¨ç¨‹åºæœ‰å“ªäº›ä¸åŒç»„ä»¶ï¼Ÿ\"></a>Spring åº”ç”¨ç¨‹åºæœ‰å“ªäº›ä¸åŒç»„ä»¶ï¼Ÿ</h3><p>Spring åº”ç”¨ä¸€èˆ¬æœ‰ä»¥ä¸‹ç»„ä»¶ï¼š</p>\n<ul>\n<li>Bean ç±» - å®ƒåŒ…å«å±æ€§ï¼Œsetter å’Œ getter æ–¹æ³•ï¼Œå‡½æ•°ç­‰ã€‚</li>\n<li>Bean é…ç½®æ–‡ä»¶ - åŒ…å«ç±»çš„ä¿¡æ¯ä»¥åŠå¦‚ä½•é…ç½®å®ƒä»¬ã€‚</li>\n<li>æ¥å£ - å¤„ç† Bean </li>\n<li>ç”¨æˆ·ç¨‹åº - å®ƒä½¿ç”¨æ¥å£ã€‚</li>\n</ul>\n<h2 id=\"Springæ§åˆ¶åè½¬-IOC\"><a href=\"#Springæ§åˆ¶åè½¬-IOC\" class=\"headerlink\" title=\"Springæ§åˆ¶åè½¬(IOC)\"></a>Springæ§åˆ¶åè½¬(IOC)</h2><h3 id=\"ä»€ä¹ˆæ˜¯Spring-IOC-å®¹å™¨ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯Spring-IOC-å®¹å™¨ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯Spring IOC å®¹å™¨ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯Spring IOC å®¹å™¨ï¼Ÿ</h3><p>Spring IOCï¼ˆæ§åˆ¶åè½¬ï¼‰ æŠŠç»„ä»¶å¯¹è±¡æ§åˆ¶æƒäº¤ç»™å®¹å™¨ï¼Œå®¹å™¨è´Ÿè´£åˆ›å»ºå¯¹è±¡ï¼Œé…ç½®å¯¹è±¡ï¼ˆé€šè¿‡ä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰ï¼Œå¹¶ä¸”ç®¡ç†è¿™äº›å¯¹è±¡çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸã€‚IoC è®©ç›¸äº’åä½œçš„ç»„ä»¶ä¿æŒæ¾è€¦åˆã€‚</p>\n<h3 id=\"Spring-IoC-çš„å®ç°æœºåˆ¶\"><a href=\"#Spring-IoC-çš„å®ç°æœºåˆ¶\" class=\"headerlink\" title=\"Spring IoC çš„å®ç°æœºåˆ¶\"></a>Spring IoC çš„å®ç°æœºåˆ¶</h3><p>Spring ä¸­çš„ IoC çš„å®ç°åŸç†å°±æ˜¯<strong>å·¥å‚æ¨¡å¼åŠ åå°„</strong>ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">interface</span> <span class=\"title class_\">Fruit</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">eat</span><span class=\"params\">()</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Apple</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Fruit</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">eat</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;Apple&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Orange</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Fruit</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">eat</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;Orange&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Factory</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Fruit <span class=\"title function_\">getInstance</span><span class=\"params\">(String className)</span> &#123;\t<span class=\"comment\">// ä½¿ç”¨åå°„ï¼Œç”¨å­—ç¬¦ä¸²è·å–åˆ°å®ä¾‹</span></span><br><span class=\"line\">        Fruit f=<span class=\"literal\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            f = (Fruit) Class.forName(className).newInstance();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> f;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Client</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] a)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Fruit</span> <span class=\"variable\">f</span> <span class=\"operator\">=</span> Factory.getInstance(<span class=\"string\">&quot;io.github.dunwu.spring.Apple&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(f != <span class=\"literal\">null</span>)&#123;</span><br><span class=\"line\">            f.eat();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"BeanFactory-å’Œ-ApplicationContextæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"><a href=\"#BeanFactory-å’Œ-ApplicationContextæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"BeanFactory å’Œ ApplicationContextæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"></a>BeanFactory å’Œ ApplicationContextæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p>BeanFactory å’Œ ApplicationContext æ˜¯ Spring çš„ä¸¤å¤§æ ¸å¿ƒæ¥å£ï¼Œéƒ½å¯ä»¥å½“åš Spring çš„å®¹å™¨ã€‚<br>ApplicationContext æ˜¯ BeanFactory çš„å­æ¥å£ã€‚</p>\n<ol>\n<li>ä¾èµ–å…³ç³»</li>\n</ol>\n<p>BeanFactoryï¼šæ˜¯ Spring é‡Œé¢æœ€åº•å±‚çš„æ¥å£ï¼ŒåŒ…å«äº†å„ç§ Bean çš„å®šä¹‰ï¼Œè¯»å– bean é…ç½®æ–‡æ¡£ï¼Œç®¡ç† bean çš„åŠ è½½ã€å®ä¾‹åŒ–ï¼Œæ§åˆ¶ bean çš„ç”Ÿå‘½å‘¨æœŸï¼Œç»´æŠ¤ bean ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚</p>\n<p>ApplicationContext æ¥å£ä½œä¸º BeanFactory çš„å­æ¥å£ï¼Œé™¤äº†æä¾› BeanFactory æ‰€å…·æœ‰çš„åŠŸèƒ½å¤–ï¼Œè¿˜æä¾›äº†æ›´å®Œæ•´çš„æ¡†æ¶åŠŸèƒ½ï¼š</p>\n<ul>\n<li>æ”¯æŒå›½é™…åŒ–ã€‚</li>\n<li>æ”¯æŒè®¿é—®æ–‡ä»¶èµ„æº</li>\n<li>æ”¯æŒäº‹ä»¶å‘å¸ƒé€šçŸ¥</li>\n<li>åŒæ—¶åŠ è½½å¤šä¸ªé…ç½®æ–‡ä»¶ã€‚</li>\n</ul>\n<p>é…ç½®æµç¨‹ï¼š</p>\n<ol>\n<li>åŠ è½½é…ç½®æ–‡ä»¶ï¼Œè§£ææˆ BeanDefinition æ”¾åœ¨ Map é‡Œï¼Œmap ä¸­å­˜æ”¾<code>&lt;BeanNameï¼ŒClasså¯¹è±¡&gt;</code>çš„æ˜ å°„</li>\n<li>è°ƒç”¨ getBean çš„æ—¶å€™ï¼Œä» BeanDefinition æ‰€å±çš„ Map é‡Œï¼Œæ‹¿å‡º Class å¯¹è±¡ä½¿ç”¨åå°„è¿›è¡Œå®ä¾‹åŒ–ï¼ŒåŒæ—¶ï¼Œå¦‚æœæœ‰ä¾èµ–å…³ç³»ï¼Œå°†é€’å½’è°ƒç”¨ getBean æ–¹æ³• â€”â€” å®Œæˆä¾èµ–æ³¨å…¥ã€‚</li>\n<li>åŠ è½½æ–¹å¼</li>\n</ol>\n<p><strong>BeanFactroy</strong>é‡‡ç”¨çš„æ˜¯<strong>å»¶è¿ŸåŠ è½½</strong>å½¢å¼æ¥æ³¨å…¥ Bean çš„ï¼Œå³åªæœ‰åœ¨ä½¿ç”¨åˆ°æŸä¸ª Bean æ—¶(è°ƒç”¨ getBean())ï¼Œæ‰å¯¹è¯¥ Bean è¿›è¡ŒåŠ è½½å®ä¾‹åŒ–ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±ä¸èƒ½å‘ç°ä¸€äº›å­˜åœ¨çš„ Spring çš„é…ç½®é—®é¢˜ã€‚å¦‚æœ Bean çš„æŸä¸€ä¸ªå±æ€§æ²¡æœ‰æ³¨å…¥æˆ–è€…æ˜¯å±æ€§æ³¨å…¥é”™è¯¯ï¼ŒBeanFacotry åŠ è½½åï¼Œç›´è‡³ç¬¬ä¸€æ¬¡ä½¿ç”¨è°ƒç”¨ getBean æ–¹æ³•æ‰ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p>\n<p><strong>ApplicationContext</strong>ï¼Œå®ƒæ˜¯åœ¨å®¹å™¨å¯åŠ¨æ—¶ï¼Œ<strong>ä¸€æ¬¡æ€§åˆ›å»º</strong>äº†æ‰€æœ‰çš„ Beanã€‚è¿™æ ·ï¼Œåœ¨å®¹å™¨å¯åŠ¨æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥<strong>å‘ç°Springä¸­å­˜åœ¨çš„é…ç½®é”™è¯¯</strong>ï¼Œè¿™æ ·æœ‰åˆ©äºæ£€æŸ¥æ‰€ä¾èµ–å±æ€§æ˜¯å¦æ³¨å…¥ã€‚ ApplicationContext å¯åŠ¨åé¢„è½½å…¥æ‰€æœ‰çš„å•å®ä¾‹ Beanï¼Œé€šè¿‡é¢„è½½å…¥å•å®ä¾‹ bean ,ç¡®ä¿å½“ä½ éœ€è¦çš„æ—¶å€™ï¼Œä½ å°±ä¸ç”¨ç­‰å¾…ï¼Œå› ä¸ºå®ƒä»¬å·²ç»åˆ›å»ºå¥½äº†ã€‚</p>\n<p>ç”±äºåœ¨å®¹å™¨å¯åŠ¨æ—¶ä¸€æ¬¡æ€§åˆ›å»ºæ‰€æœ‰çš„ Beanï¼Œå› æ­¤ ApplicationContext æ›´åŠ å ç”¨å†…å­˜ç©ºé—´ï¼Œå½“é…ç½®çš„ Bean æ¯”è¾ƒå¤šæ—¶ï¼Œç¨‹åºå¯åŠ¨è¾ƒæ…¢ã€‚</p>\n<h4 id=\"â­BeanFactoryå’ŒFactoryBeanåŒºåˆ«ï¼Ÿ\"><a href=\"#â­BeanFactoryå’ŒFactoryBeanåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"â­BeanFactoryå’ŒFactoryBeanåŒºåˆ«ï¼Ÿ\"></a>â­BeanFactoryå’ŒFactoryBeanåŒºåˆ«ï¼Ÿ</h4><p>BeanFactoryï¼šæ˜¯ spring IoC å®¹å™¨çš„åº•å±‚æ¥å£ï¼Œå¯ä»¥ç”¨æ¥ç®¡ç† bean åŠå…¶ç”Ÿå‘½å‘¨æœŸï¼›</p>\n<p>FactoryBeanï¼šå¦‚æœæŸä¸ª bean å®ç°äº† FactoryBean è¿™ä¸ªæ¥å£ï¼Œé€šè¿‡ getBean æ–¹æ³•æ¥è·å– bean çš„æ—¶å€™ï¼Œå¹¶ä¸æ˜¯è¿”å›è‡ªå·±çš„å®ä¾‹ï¼Œè€Œæ˜¯è¿”å›å…¶ getObject() æ–¹æ³•çš„è¿”å›å€¼</p>\n<h3 id=\"ApplicationContexté€šå¸¸çš„å®ç°æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#ApplicationContexté€šå¸¸çš„å®ç°æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"ApplicationContexté€šå¸¸çš„å®ç°æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>ApplicationContexté€šå¸¸çš„å®ç°æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><strong>FileSystemXmlApplicationContext</strong> ï¼šæ­¤å®¹å™¨ä»ä¸€ä¸ª XML æ–‡ä»¶ä¸­åŠ è½½ beans çš„å®šä¹‰ï¼ŒXML Bean é…ç½®æ–‡ä»¶çš„å…¨è·¯å¾„åå¿…é¡»æä¾›ç»™å®ƒçš„æ„é€ å‡½æ•°ã€‚</p>\n<p><strong>ClassPathXmlApplicationContext</strong>ï¼šæ­¤å®¹å™¨ä¹Ÿä»ä¸€ä¸ª XML æ–‡ä»¶ä¸­åŠ è½½ beans çš„å®šä¹‰ï¼Œè¿™é‡Œï¼Œä½ éœ€è¦æ­£ç¡®è®¾ç½® classpath å› ä¸ºè¿™ä¸ªå®¹å™¨å°†åœ¨ classpath é‡Œæ‰¾ bean é…ç½®ã€‚</p>\n<p><strong>AnnotationConfigApplicationContext</strong>ï¼šå®ƒæ˜¯ç”¨äºè¯»å–æ³¨è§£åˆ›å»ºå®¹å™¨çš„</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯Springçš„ä¾èµ–æ³¨å…¥ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯Springçš„ä¾èµ–æ³¨å…¥ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯Springçš„ä¾èµ–æ³¨å…¥ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯Springçš„ä¾èµ–æ³¨å…¥ï¼Ÿ</h3><p>å…·ä½“å«ä¹‰æ˜¯:å½“æŸä¸ªè°ƒç”¨è€…éœ€è¦å¦ä¸€ä¸ªè¢«è°ƒç”¨è€…çš„ååŠ©æ—¶ï¼Œåœ¨ ä¼ ç»Ÿçš„ç¨‹åºè®¾è®¡è¿‡ç¨‹ä¸­ï¼Œé€šå¸¸ç”±è°ƒç”¨è€…æ¥åˆ›å»ºè¢«è°ƒç”¨è€…çš„å®ä¾‹ã€‚ä½†åœ¨ Spring é‡Œï¼Œåˆ›å»ºè¢«è°ƒç”¨è€…çš„å·¥ä½œä¸å†ç”±è°ƒç”¨è€…æ¥å®Œæˆï¼Œå› æ­¤ç§°ä¸ºæ§åˆ¶åè½¬ï¼›åˆ›å»ºè¢«è°ƒç”¨è€… å®ä¾‹çš„å·¥ä½œé€šå¸¸ç”± Spring å®¹å™¨æ¥å®Œæˆï¼Œç„¶åæ³¨å…¥è°ƒç”¨è€…ï¼Œå› æ­¤ä¹Ÿç§°ä¸ºä¾èµ–æ³¨å…¥ã€‚</p>\n<h3 id=\"ä¾èµ–æ³¨å…¥æœ‰ä»€ä¹ˆä¼˜åŠ¿\"><a href=\"#ä¾èµ–æ³¨å…¥æœ‰ä»€ä¹ˆä¼˜åŠ¿\" class=\"headerlink\" title=\"ä¾èµ–æ³¨å…¥æœ‰ä»€ä¹ˆä¼˜åŠ¿\"></a>ä¾èµ–æ³¨å…¥æœ‰ä»€ä¹ˆä¼˜åŠ¿</h3><p>ä¾èµ–æ³¨å…¥ä¹‹æ‰€ä»¥æ›´æµè¡Œæ˜¯å› ä¸ºå®ƒæ˜¯ä¸€ç§æ›´å¯å–çš„æ–¹å¼ï¼šè®©å®¹å™¨å…¨æƒè´Ÿè´£ä¾èµ–æŸ¥è¯¢ï¼Œå—ç®¡ç»„ä»¶åªéœ€è¦æš´éœ² JavaBean çš„ setter æ–¹æ³•æˆ–è€…å¸¦å‚æ•°çš„æ„é€ å™¨æˆ–è€…æ¥å£ï¼Œä½¿å®¹å™¨å¯ä»¥åœ¨åˆå§‹åŒ–æ—¶ç»„è£…å¯¹è±¡çš„ä¾èµ–å…³ç³»ã€‚å…¶ä¸ä¾èµ–æŸ¥æ‰¾æ–¹å¼ç›¸æ¯”ï¼Œä¸»è¦ä¼˜åŠ¿ä¸ºï¼š</p>\n<ul>\n<li>æŸ¥æ‰¾å®šä½æ“ä½œä¸åº”ç”¨ä»£ç å®Œå…¨æ— å…³ã€‚</li>\n<li>ä¸ä¾èµ–äºå®¹å™¨çš„ APIï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°åœ¨ä»»ä½•å®¹å™¨ä»¥å¤–ä½¿ç”¨åº”ç”¨å¯¹è±¡ã€‚</li>\n<li>ä¸éœ€è¦ç‰¹æ®Šçš„æ¥å£ï¼Œç»å¤§å¤šæ•°å¯¹è±¡å¯ä»¥åšåˆ°å®Œå…¨ä¸å¿…ä¾èµ–å®¹å™¨ã€‚</li>\n</ul>\n<h3 id=\"æœ‰å“ªäº›ä¸åŒç±»å‹çš„ä¾èµ–æ³¨å…¥å®ç°æ–¹å¼ï¼Ÿ\"><a href=\"#æœ‰å“ªäº›ä¸åŒç±»å‹çš„ä¾èµ–æ³¨å…¥å®ç°æ–¹å¼ï¼Ÿ\" class=\"headerlink\" title=\"æœ‰å“ªäº›ä¸åŒç±»å‹çš„ä¾èµ–æ³¨å…¥å®ç°æ–¹å¼ï¼Ÿ\"></a>æœ‰å“ªäº›ä¸åŒç±»å‹çš„ä¾èµ–æ³¨å…¥å®ç°æ–¹å¼ï¼Ÿ</h3><p><strong>æ„é€ å™¨ä¾èµ–æ³¨å…¥</strong>ï¼šæ„é€ å™¨ä¾èµ–æ³¨å…¥é€šè¿‡å®¹å™¨è§¦å‘ä¸€ä¸ªç±»çš„æ„é€ å™¨æ¥å®ç°çš„ï¼Œè¯¥ç±»æœ‰ä¸€ç³»åˆ—å‚æ•°ï¼Œæ¯ä¸ªå‚æ•°ä»£è¡¨ä¸€ä¸ªå¯¹å…¶ä»–ç±»çš„ä¾èµ–ã€‚</p>\n<p><strong>Setteræ–¹æ³•æ³¨å…¥</strong>ï¼šSetter æ–¹æ³•æ³¨å…¥æ˜¯å®¹å™¨é€šè¿‡è°ƒç”¨æ— å‚æ„é€ å™¨æˆ–æ— å‚ static å·¥å‚ æ–¹æ³•å®ä¾‹åŒ– bean ä¹‹åï¼Œè°ƒç”¨è¯¥ bean çš„ setter æ–¹æ³•ï¼Œå³å®ç°äº†åŸºäº setter çš„ä¾èµ–æ³¨å…¥ã€‚</p>\n<h3 id=\"æ„é€ å™¨ä¾èµ–æ³¨å…¥å’Œ-setteræ–¹æ³•æ³¨å…¥çš„åŒºåˆ«\"><a href=\"#æ„é€ å™¨ä¾èµ–æ³¨å…¥å’Œ-setteræ–¹æ³•æ³¨å…¥çš„åŒºåˆ«\" class=\"headerlink\" title=\"æ„é€ å™¨ä¾èµ–æ³¨å…¥å’Œ setteræ–¹æ³•æ³¨å…¥çš„åŒºåˆ«\"></a>æ„é€ å™¨ä¾èµ–æ³¨å…¥å’Œ setteræ–¹æ³•æ³¨å…¥çš„åŒºåˆ«</h3><p>ï¼ˆéƒ¨åˆ†æ³¨å…¥ï¼‰åœ¨ setter æ³¨å…¥,å¯ä»¥å°†ä¾èµ–é¡¹éƒ¨åˆ†æ³¨å…¥,æ„é€ æ–¹æ³•æ³¨å…¥ä¸èƒ½éƒ¨åˆ†æ³¨å…¥ã€‚</p>\n<p>ï¼ˆå±æ€§è¦†ç›–ï¼‰å¦‚æœæˆ‘ä»¬ä¸ºåŒä¸€å±æ€§æä¾› setter å’Œæ„é€ æ–¹æ³•æ³¨å…¥ï¼Œsetter æ³¨å…¥å°†è¦†ç›–æ„é€ æ–¹æ³•æ³¨å…¥ã€‚ä½†æ˜¯æ„é€ æ–¹æ³•æ³¨å…¥ä¸èƒ½è¦†ç›– setter æ³¨å…¥å€¼ã€‚æ˜¾ç„¶ï¼Œæ„é€ æ–¹æ³•æ³¨å…¥è¢«ç§°ä¸ºåˆ›å»ºå®ä¾‹çš„ç¬¬ä¸€é€‰é¡¹ã€‚</p>\n<p>ï¼ˆå¾ªç¯ä¾èµ–ï¼‰åœ¨æ„é€ å‡½æ•°æ³¨å…¥,å¦‚æœ A å’Œ B å¯¹è±¡ç›¸äº’ä¾èµ–ï¼šA ä¾èµ–äº B,B ä¹Ÿä¾èµ–äº A,æ­¤æ—¶åœ¨åˆ›å»ºå¯¹è±¡çš„ A æˆ–è€… B æ—¶ï¼ŒSpring æŠ›å‡º ObjectCurrentlyInCreationExceptionã€‚æ‰€ä»¥ Spring å¯ä»¥é€šè¿‡ setter æ³¨å…¥,ä»è€Œè§£å†³å¾ªç¯ä¾èµ–çš„é—®é¢˜ã€‚</p>\n<p><strong>æœ€å¥½çš„è§£å†³æ–¹æ¡ˆæ˜¯ç”¨æ„é€ å™¨å‚æ•°å®ç°å¼ºåˆ¶ä¾èµ–ï¼Œsetteræ–¹æ³•å®ç°å¯é€‰ä¾èµ–</strong></p>\n<h3 id=\"è®²ä¸€è®²Springä¸­çš„å¾ªç¯ä¾èµ–\"><a href=\"#è®²ä¸€è®²Springä¸­çš„å¾ªç¯ä¾èµ–\" class=\"headerlink\" title=\"è®²ä¸€è®²Springä¸­çš„å¾ªç¯ä¾èµ–\"></a>è®²ä¸€è®²Springä¸­çš„å¾ªç¯ä¾èµ–</h3><p><a href=\"https://www.cnblogs.com/daimzh/p/13256413.html\">https://www.cnblogs.com/daimzh/p/13256413.html</a></p>\n<p><a href=\"https://blog.csdn.net/weixin_49592546/article/details/108050566\">https://blog.csdn.net/weixin_49592546/article/details/108050566</a></p>\n<h4 id=\"ä»€ä¹ˆæ˜¯å¾ªç¯ä¾èµ–ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯å¾ªç¯ä¾èµ–ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯å¾ªç¯ä¾èµ–ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯å¾ªç¯ä¾èµ–ï¼Ÿ</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">A</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// Aä¸­æ³¨å…¥äº†B</span></span><br><span class=\"line\">\t<span class=\"meta\">@Autowired</span></span><br><span class=\"line\">\t<span class=\"keyword\">private</span> B b;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">B</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// Bä¸­ä¹Ÿæ³¨å…¥äº†A</span></span><br><span class=\"line\">\t<span class=\"meta\">@Autowired</span></span><br><span class=\"line\">\t<span class=\"keyword\">private</span> A a;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Springæ˜¯å¦‚ä½•è§£å†³çš„å¾ªç¯ä¾èµ–ï¼Ÿ\"><a href=\"#Springæ˜¯å¦‚ä½•è§£å†³çš„å¾ªç¯ä¾èµ–ï¼Ÿ\" class=\"headerlink\" title=\"Springæ˜¯å¦‚ä½•è§£å†³çš„å¾ªç¯ä¾èµ–ï¼Ÿ\"></a>Springæ˜¯å¦‚ä½•è§£å†³çš„å¾ªç¯ä¾èµ–ï¼Ÿ</h4><blockquote>\n<p>ä»¥ä¸‹ï¼š</p>\n<p>ä½œè€…ï¼šé˜¿é‡Œäº‘äº‘æ –å·</p>\n<p>é“¾æ¥ï¼š<a href=\"https://zhuanlan.zhihu.com/p/368769721\">https://zhuanlan.zhihu.com/p/368769721</a></p>\n<p>æ¥æºï¼šçŸ¥ä¹</p>\n<p>è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>\n</blockquote>\n<p>é¦–å…ˆï¼ŒSpring è§£å†³å¾ªç¯ä¾èµ–æœ‰ä¸¤ä¸ªå‰ææ¡ä»¶ï¼š</p>\n<ol>\n<li>ä¸å…¨æ˜¯æ„é€ å™¨æ–¹å¼çš„å¾ªç¯ä¾èµ–</li>\n<li>å¿…é¡»æ˜¯å•ä¾‹</li>\n</ol>\n<p>åŸºäºä¸Šé¢çš„é—®é¢˜ï¼Œæˆ‘ä»¬çŸ¥é“ Bean çš„ç”Ÿå‘½å‘¨æœŸï¼Œæœ¬è´¨ä¸Šè§£å†³å¾ªç¯ä¾èµ–çš„é—®é¢˜å°±æ˜¯ä¸‰çº§ç¼“å­˜ï¼Œé€šè¿‡ä¸‰çº§ç¼“å­˜æå‰æ‹¿åˆ°æœªåˆå§‹åŒ–å®Œå…¨çš„å¯¹è±¡ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/** Cache of singleton objects: bean name to bean instance. */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> Map&lt;String, Object&gt; singletonObjects = <span class=\"keyword\">new</span> <span class=\"title class_\">ConcurrentHashMap</span>&lt;&gt;(<span class=\"number\">256</span>);</span><br><span class=\"line\"><span class=\"comment\">/** Cache of early singleton objects: bean name to bean instance. */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> Map&lt;String, Object&gt; earlySingletonObjects = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;&gt;(<span class=\"number\">16</span>);</span><br><span class=\"line\"><span class=\"comment\">/** Cache of singleton factories: bean name to ObjectFactory. */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> Map&lt;String, ObjectFactory&lt;?&gt;&gt; singletonFactories = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;&gt;(<span class=\"number\">16</span>);</span><br></pre></td></tr></table></figure>\n\n<p>ç¬¬ä¸€çº§ç¼“å­˜ï¼šç”¨æ¥ä¿å­˜å®ä¾‹åŒ–ã€åˆå§‹åŒ–éƒ½å®Œæˆçš„å¯¹è±¡</p>\n<p>ç¬¬äºŒçº§ç¼“å­˜ï¼šç”¨æ¥ä¿å­˜å®ä¾‹åŒ–å®Œæˆï¼Œä½†æ˜¯æœªåˆå§‹åŒ–å®Œæˆçš„å¯¹è±¡</p>\n<p>ç¬¬ä¸‰çº§ç¼“å­˜ï¼šç”¨æ¥ä¿å­˜ä¸€ä¸ªå¯¹è±¡å·¥å‚ï¼Œæä¾›ä¸€ä¸ªåŒ¿åå†…éƒ¨ç±»ï¼Œç”¨äºåˆ›å»ºäºŒçº§ç¼“å­˜ä¸­çš„å¯¹è±¡</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesv2-dbda6a103e41cde4a54548386d6c1cc2_720w.jpg\" alt=\"Springä¸‰çº§ç¼“å­˜\"></p>\n<p>å‡è®¾ä¸€ä¸ªç®€å•çš„å¾ªç¯ä¾èµ–åœºæ™¯ï¼ŒAã€B äº’ç›¸ä¾èµ–ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesv2-f20f1e81c8011fd99f723127cacf7430_720w.jpg\" alt=\"ç®€å•çš„å¾ªç¯ä¾èµ–åœºæ™¯\"></p>\n<p>A å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹ï¼š</p>\n<ol>\n<li>åˆ›å»ºå¯¹è±¡ Aï¼Œå®ä¾‹åŒ–çš„æ—¶å€™æŠŠ A å¯¹è±¡å·¥å‚æ”¾å…¥ä¸‰çº§ç¼“å­˜ï¼›</li>\n</ol>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesv2-b295374aff4235ee9c0538bf03856217_720w.jpg\" alt=\"å®ä¾‹åŒ–å¯¹è±¡A\"></p>\n<ol start=\"2\">\n<li><p>A æ³¨å…¥å±æ€§æ—¶ï¼Œå‘ç°ä¾èµ– Bï¼Œè½¬è€Œå»å®ä¾‹åŒ– B</p>\n</li>\n<li><p>åŒæ ·åˆ›å»ºå¯¹è±¡ Bï¼Œæ³¨å…¥å±æ€§æ—¶å‘ç°ä¾èµ– Aï¼Œä¾æ¬¡ä»ä¸€çº§åˆ°ä¸‰çº§ç¼“å­˜æŸ¥è¯¢ Aï¼Œä»ä¸‰çº§ç¼“å­˜é€šè¿‡å¯¹è±¡å·¥å‚æ‹¿åˆ° Aï¼ŒæŠŠ A æ”¾å…¥äºŒçº§ç¼“å­˜ï¼ŒåŒæ—¶åˆ é™¤ä¸‰çº§ç¼“å­˜ä¸­çš„ Aï¼Œæ­¤æ—¶ï¼ŒB å·²ç»å®ä¾‹åŒ–å¹¶ä¸”åˆå§‹åŒ–å®Œæˆï¼ŒæŠŠ B æ”¾å…¥ä¸€çº§ç¼“å­˜ã€‚</p>\n</li>\n</ol>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesv2-51cb735fc6c02c2225d2f38b9b5b6da9_720w.jpg\" alt=\"åˆ›å»ºå¯¹è±¡B\"></p>\n<ol start=\"4\">\n<li><p>æ¥ç€ç»§ç»­åˆ›å»º Aï¼Œé¡ºåˆ©ä»ä¸€çº§ç¼“å­˜æ‹¿åˆ°å®ä¾‹åŒ–ä¸”åˆå§‹åŒ–å®Œæˆçš„ B å¯¹è±¡ï¼ŒA å¯¹è±¡åˆ›å»ºä¹Ÿå®Œæˆï¼Œåˆ é™¤äºŒçº§ç¼“å­˜ä¸­çš„ Aï¼ŒåŒæ—¶æŠŠ A æ”¾å…¥ä¸€çº§ç¼“å­˜</p>\n</li>\n<li><p>æœ€åï¼Œä¸€çº§ç¼“å­˜ä¸­ä¿å­˜ç€å®ä¾‹åŒ–ã€åˆå§‹åŒ–éƒ½å®Œæˆçš„ Aã€B å¯¹è±¡</p>\n</li>\n</ol>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesv2-a1eaa5d9f8bec23e373dc1b9f86ddb25_720w.jpg\" alt=\"æœ€ç»ˆç»“æœ\"></p>\n<p>å› æ­¤ï¼Œç”±äºæŠŠå®ä¾‹åŒ–å’Œåˆå§‹åŒ–çš„æµç¨‹åˆ†å¼€äº†ï¼Œæ‰€ä»¥å¦‚æœéƒ½æ˜¯ç”¨æ„é€ å™¨çš„è¯ï¼Œå°±æ²¡æ³•åˆ†ç¦»è¿™ä¸ªæ“ä½œï¼Œæ‰€ä»¥éƒ½æ˜¯æ„é€ å™¨çš„è¯å°±æ— æ³•è§£å†³å¾ªç¯ä¾èµ–çš„é—®é¢˜äº†ã€‚</p>\n<h3 id=\"8-ä¸ºä»€ä¹ˆè¦ä¸‰çº§ç¼“å­˜ï¼ŸäºŒçº§ä¸è¡Œå—ï¼Ÿ\"><a href=\"#8-ä¸ºä»€ä¹ˆè¦ä¸‰çº§ç¼“å­˜ï¼ŸäºŒçº§ä¸è¡Œå—ï¼Ÿ\" class=\"headerlink\" title=\"8. ä¸ºä»€ä¹ˆè¦ä¸‰çº§ç¼“å­˜ï¼ŸäºŒçº§ä¸è¡Œå—ï¼Ÿ\"></a>8. ä¸ºä»€ä¹ˆè¦ä¸‰çº§ç¼“å­˜ï¼ŸäºŒçº§ä¸è¡Œå—ï¼Ÿ</h3><p>ä¸å¯ä»¥ï¼Œä¸»è¦æ˜¯ä¸ºäº†ç”Ÿæˆä»£ç†å¯¹è±¡ã€‚</p>\n<p>å› ä¸ºä¸‰çº§ç¼“å­˜ä¸­æ”¾çš„æ˜¯ç”Ÿæˆå…·ä½“å¯¹è±¡çš„å¯¹è±¡å·¥å‚ï¼Œä»–å¯ä»¥ç”Ÿæˆä»£ç†å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥æ˜¯æ™®é€šçš„å®ä¾‹å¯¹è±¡ã€‚</p>\n<p>å‡è®¾åªæœ‰äºŒçº§ç¼“å­˜çš„æƒ…å†µï¼Œå¾€äºŒçº§ç¼“å­˜ä¸­æ”¾çš„æ˜¾ç¤ºä¸€ä¸ªæ™®é€šçš„ Bean å¯¹è±¡ï¼Œ<code>BeanPostProcessor</code>å»ç”Ÿæˆä»£ç†å¯¹è±¡ä¹‹åï¼Œè¦†ç›–æ‰äºŒçº§ç¼“å­˜ä¸­çš„æ™®é€š Bean å¯¹è±¡ï¼Œé‚£ä¹ˆå¤šçº¿ç¨‹ç¯å¢ƒä¸‹å¯èƒ½å–åˆ°çš„å¯¹è±¡å°±ä¸ä¸€è‡´äº†ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesv2-e4e9050787017c7272dc313f88af9382_720w.jpg\" alt=\"Aä»£ç†å¯¹è±¡è¦†ç›–Aæ™®é€šBean\"></p>\n<h2 id=\"Spring-Beans\"><a href=\"#Spring-Beans\" class=\"headerlink\" title=\"Spring Beans\"></a>Spring Beans</h2><h3 id=\"å¦‚ä½•ç»™Spring-å®¹å™¨æä¾›é…ç½®å…ƒæ•°æ®ï¼ŸSpringæœ‰å‡ ç§é…ç½®æ–¹å¼\"><a href=\"#å¦‚ä½•ç»™Spring-å®¹å™¨æä¾›é…ç½®å…ƒæ•°æ®ï¼ŸSpringæœ‰å‡ ç§é…ç½®æ–¹å¼\" class=\"headerlink\" title=\"å¦‚ä½•ç»™Spring å®¹å™¨æä¾›é…ç½®å…ƒæ•°æ®ï¼ŸSpringæœ‰å‡ ç§é…ç½®æ–¹å¼\"></a>å¦‚ä½•ç»™Spring å®¹å™¨æä¾›é…ç½®å…ƒæ•°æ®ï¼ŸSpringæœ‰å‡ ç§é…ç½®æ–¹å¼</h3><p>è¿™é‡Œæœ‰ä¸‰ç§é‡è¦çš„æ–¹æ³•ç»™ Spring å®¹å™¨æä¾›é…ç½®å…ƒæ•°æ®ã€‚</p>\n<ul>\n<li>XML é…ç½®æ–‡ä»¶ã€‚</li>\n<li>åŸºäºæ³¨è§£çš„é…ç½®ã€‚</li>\n<li>åŸºäº Java çš„é…ç½®ã€‚</li>\n</ul>\n<h3 id=\"Springé…ç½®æ–‡ä»¶åŒ…å«äº†å“ªäº›ä¿¡æ¯\"><a href=\"#Springé…ç½®æ–‡ä»¶åŒ…å«äº†å“ªäº›ä¿¡æ¯\" class=\"headerlink\" title=\"Springé…ç½®æ–‡ä»¶åŒ…å«äº†å“ªäº›ä¿¡æ¯\"></a>Springé…ç½®æ–‡ä»¶åŒ…å«äº†å“ªäº›ä¿¡æ¯</h3><p>Spring é…ç½®æ–‡ä»¶æ˜¯ä¸ª XML æ–‡ä»¶ï¼Œé€šè¿‡è¯»å–æŒ‡å®šç±»çš„å…¨é™å®šç±»åã€‚åå°„åˆ›å»ºå¯¹è±¡ï¼Œä¸¢å…¥ ioc å®¹å™¨ä¸­ï¼Œè¯¥å¯¹è±¡å¯ä»¥é€šè¿‡ id æ¥è·å–</p>\n<h3 id=\"SpringåŸºäºxmlæ³¨å…¥beançš„å‡ ç§æ–¹å¼\"><a href=\"#SpringåŸºäºxmlæ³¨å…¥beançš„å‡ ç§æ–¹å¼\" class=\"headerlink\" title=\"SpringåŸºäºxmlæ³¨å…¥beançš„å‡ ç§æ–¹å¼\"></a>SpringåŸºäºxmlæ³¨å…¥beançš„å‡ ç§æ–¹å¼</h3><ol>\n<li>Set æ–¹æ³•æ³¨å…¥ï¼š<code>&lt;property name=&quot;xxx&quot; value=&quot;yyy&quot;/&gt;</code></li>\n<li>æ„é€ å™¨æ³¨å…¥ï¼š<code>&lt;construtor-arg type/index/name=&quot;xxx&quot; value=&quot;yyy&quot;/&gt;</code></li>\n<li>é™æ€å·¥å‚æ³¨å…¥ï¼›factory-bean factory-method</li>\n<li>å®ä¾‹å·¥å‚ï¼› class factory-method</li>\n</ol>\n<h3 id=\"è§£é‡ŠSpringæ”¯æŒçš„å‡ ç§beançš„ä½œç”¨åŸŸ\"><a href=\"#è§£é‡ŠSpringæ”¯æŒçš„å‡ ç§beançš„ä½œç”¨åŸŸ\" class=\"headerlink\" title=\"è§£é‡ŠSpringæ”¯æŒçš„å‡ ç§beançš„ä½œç”¨åŸŸ\"></a>è§£é‡ŠSpringæ”¯æŒçš„å‡ ç§beançš„ä½œç”¨åŸŸ</h3><p>Spring æ¡†æ¶æ”¯æŒä»¥ä¸‹äº”ç§ bean çš„ä½œç”¨åŸŸï¼š</p>\n<ul>\n<li><strong>singleton :</strong> bean åœ¨æ¯ä¸ª Spring ioc å®¹å™¨ä¸­åªæœ‰ä¸€ä¸ªå®ä¾‹ã€‚</li>\n<li><strong>prototype</strong>ï¼šä¸€ä¸ª bean çš„å®šä¹‰å¯ä»¥æœ‰å¤šä¸ªå®ä¾‹ã€‚</li>\n<li><strong>request</strong>ï¼šæ¯æ¬¡ http è¯·æ±‚éƒ½ä¼šåˆ›å»ºä¸€ä¸ª beanï¼Œè¯¥ä½œç”¨åŸŸä»…åœ¨åŸºäº web çš„ Spring ApplicationContext æƒ…å½¢ä¸‹æœ‰æ•ˆã€‚</li>\n<li><strong>session</strong>ï¼šåœ¨ä¸€ä¸ª HTTP Session ä¸­ï¼Œä¸€ä¸ª bean å®šä¹‰å¯¹åº”ä¸€ä¸ªå®ä¾‹ã€‚è¯¥ä½œç”¨åŸŸä»…åœ¨åŸºäº web çš„ Spring ApplicationContext æƒ…å½¢ä¸‹æœ‰æ•ˆã€‚</li>\n<li><strong>global-session</strong>ï¼šåœ¨ä¸€ä¸ªå…¨å±€çš„ HTTP Session ä¸­ï¼Œä¸€ä¸ª bean å®šä¹‰å¯¹åº”ä¸€ä¸ªå®ä¾‹ã€‚è¯¥ä½œç”¨åŸŸä»…åœ¨åŸºäº web çš„ Spring ApplicationContext æƒ…å½¢ä¸‹æœ‰æ•ˆã€‚</li>\n</ul>\n<p><strong>æ³¨æ„ï¼š</strong> ç¼ºçœçš„ Spring bean çš„ä½œç”¨åŸŸæ˜¯ singletonã€‚ä½¿ç”¨ prototype ä½œç”¨åŸŸéœ€è¦æ…é‡çš„æ€è€ƒï¼Œå› ä¸ºé¢‘ç¹åˆ›å»ºå’Œé”€æ¯ bean ä¼šå¸¦æ¥å¾ˆå¤§çš„æ€§èƒ½å¼€é”€ã€‚</p>\n<h3 id=\"Springæ¡†æ¶ä¸­çš„å•ä¾‹beanæ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼Ÿ\"><a href=\"#Springæ¡†æ¶ä¸­çš„å•ä¾‹beanæ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼Ÿ\" class=\"headerlink\" title=\"Springæ¡†æ¶ä¸­çš„å•ä¾‹beanæ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼Ÿ\"></a>Springæ¡†æ¶ä¸­çš„å•ä¾‹beanæ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼Ÿ</h3><p>ä¸æ˜¯ï¼ŒSpring æ¡†æ¶ä¸­çš„å•ä¾‹ bean ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p>\n<p>spring ä¸­çš„ bean é»˜è®¤æ˜¯å•ä¾‹æ¨¡å¼ï¼Œspring æ¡†æ¶å¹¶æ²¡æœ‰å¯¹å•ä¾‹ bean è¿›è¡Œå¤šçº¿ç¨‹çš„å°è£…å¤„ç†ã€‚</p>\n<p>ç„¶è€Œï¼Œå®é™…ä¸Šå¤§éƒ¨åˆ†æ—¶å€™ spring bean æ— çŠ¶æ€çš„ï¼ˆæ¯”å¦‚ dao ç±»ï¼‰ï¼Œæ‰€ä»¥æŸç§ç¨‹åº¦ä¸Šæ¥è¯´ bean ä¹Ÿæ˜¯å®‰å…¨çš„ï¼Œä½†å¦‚æœ bean æœ‰çŠ¶æ€çš„è¯ï¼ˆæ¯”å¦‚ view model å¯¹è±¡ï¼‰ï¼Œé‚£å°±è¦å¼€å‘è€…è‡ªå·±å»ä¿è¯çº¿ç¨‹å®‰å…¨äº†ï¼Œæœ€ç®€å•çš„å°±æ˜¯æ”¹å˜ bean çš„ä½œç”¨åŸŸï¼ŒæŠŠâ€œsingletonâ€å˜æ›´ä¸ºâ€œprototypeâ€ï¼Œè¿™æ ·è¯·æ±‚ bean ç›¸å½“äº new Bean()äº†ï¼Œæ‰€ä»¥å°±å¯ä»¥ä¿è¯çº¿ç¨‹å®‰å…¨äº†ã€‚</p>\n<blockquote>\n<p>æœ‰çŠ¶æ€å°±æ˜¯æœ‰æ•°æ®å­˜å‚¨åŠŸèƒ½<br>æ— çŠ¶æ€å°±æ˜¯ä¸ä¼šä¿å­˜æ•°æ®</p>\n</blockquote>\n<h3 id=\"Springå¦‚ä½•å¤„ç†çº¿ç¨‹å¹¶å‘é—®é¢˜ï¼Ÿ\"><a href=\"#Springå¦‚ä½•å¤„ç†çº¿ç¨‹å¹¶å‘é—®é¢˜ï¼Ÿ\" class=\"headerlink\" title=\"Springå¦‚ä½•å¤„ç†çº¿ç¨‹å¹¶å‘é—®é¢˜ï¼Ÿ\"></a>Springå¦‚ä½•å¤„ç†çº¿ç¨‹å¹¶å‘é—®é¢˜ï¼Ÿ</h3><p><strong>Springä½¿ç”¨ThreadLocalå¯¹ä¸€äº›Beançš„çº¿ç¨‹å®‰å…¨é—®é¢˜è¿›è¡Œå¤„ç†</strong>ã€‚</p>\n<p>ThreadLocal å’Œçº¿ç¨‹åŒæ­¥æœºåˆ¶éƒ½æ˜¯ä¸ºäº†è§£å†³å¤šçº¿ç¨‹ä¸­ç›¸åŒå˜é‡çš„è®¿é—®å†²çªé—®é¢˜ã€‚åŒæ­¥æœºåˆ¶é‡‡ç”¨äº†â€œæ—¶é—´æ¢ç©ºé—´â€çš„æ–¹å¼ï¼Œä»…æä¾›ä¸€ä»½å˜é‡ï¼Œä¸åŒçš„çº¿ç¨‹åœ¨è®¿é—®å‰éœ€è¦è·å–é”ï¼Œæ²¡è·å¾—é”çš„çº¿ç¨‹åˆ™éœ€è¦æ’é˜Ÿã€‚è€Œ ThreadLocal é‡‡ç”¨äº†â€œç©ºé—´æ¢æ—¶é—´â€çš„æ–¹å¼ã€‚</p>\n<p>ThreadLocal ä¼šä¸ºæ¯ä¸€ä¸ªçº¿ç¨‹æä¾›ä¸€ä¸ªç‹¬ç«‹çš„å˜é‡å‰¯æœ¬ï¼Œä»è€Œéš”ç¦»äº†å¤šä¸ªçº¿ç¨‹å¯¹æ•°æ®çš„è®¿é—®å†²çªã€‚å› ä¸ºæ¯ä¸€ä¸ªçº¿ç¨‹éƒ½æ‹¥æœ‰è‡ªå·±çš„å˜é‡å‰¯æœ¬ï¼Œä»è€Œä¹Ÿå°±æ²¡æœ‰å¿…è¦å¯¹è¯¥å˜é‡è¿›è¡ŒåŒæ­¥äº†ã€‚ThreadLocal æä¾›äº†çº¿ç¨‹å®‰å…¨çš„å…±äº«å¯¹è±¡ï¼Œåœ¨ç¼–å†™å¤šçº¿ç¨‹ä»£ç æ—¶ï¼Œå¯ä»¥æŠŠä¸å®‰å…¨çš„å˜é‡å°è£…è¿› ThreadLocalã€‚</p>\n<h3 id=\"è§£é‡ŠSpringæ¡†æ¶ä¸­beançš„ç”Ÿå‘½å‘¨æœŸ\"><a href=\"#è§£é‡ŠSpringæ¡†æ¶ä¸­beançš„ç”Ÿå‘½å‘¨æœŸ\" class=\"headerlink\" title=\"è§£é‡ŠSpringæ¡†æ¶ä¸­beançš„ç”Ÿå‘½å‘¨æœŸ\"></a>è§£é‡ŠSpringæ¡†æ¶ä¸­beançš„ç”Ÿå‘½å‘¨æœŸ</h3><p>å‚è€ƒï¼š<a href=\"https://www.cnblogs.com/javazhiyin/p/10905294.html\">https://www.cnblogs.com/javazhiyin/p/10905294.html</a></p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes201911012343410.png\" alt=\"Springä¸­Beançš„ç”Ÿå‘½å‘¨æœŸ\"></p>\n<p><strong>1ã€å®ä¾‹åŒ–Beanï¼š</strong></p>\n<p>å¯¹äº BeanFactory å®¹å™¨ï¼Œå½“å®¢æˆ·å‘å®¹å™¨è¯·æ±‚ä¸€ä¸ªå°šæœªåˆå§‹åŒ–çš„ bean æ—¶ï¼Œæˆ–åˆå§‹åŒ– bean çš„æ—¶å€™éœ€è¦æ³¨å…¥å¦ä¸€ä¸ªå°šæœªåˆå§‹åŒ–çš„ä¾èµ–æ—¶ï¼Œå®¹å™¨å°±ä¼šè°ƒç”¨ createBean è¿›è¡Œå®ä¾‹åŒ–ã€‚<br>å¯¹äº ApplicationContext å®¹å™¨ï¼Œå½“å®¹å™¨å¯åŠ¨ç»“æŸåï¼Œé€šè¿‡è·å– BeanDefinition å¯¹è±¡ä¸­çš„ä¿¡æ¯ï¼Œå®ä¾‹åŒ–æ‰€æœ‰çš„ beanã€‚</p>\n<p><strong>2ã€ä¾èµ–æ³¨å…¥ï¼š</strong></p>\n<p>å®ä¾‹åŒ–åçš„å¯¹è±¡è¢«å°è£…åœ¨ BeanWrapper å¯¹è±¡ä¸­ï¼Œç´§æ¥ç€ï¼ŒSpring æ ¹æ® BeanDefinition ä¸­çš„ä¿¡æ¯ ä»¥åŠ é€šè¿‡ BeanWrapper æä¾›çš„è®¾ç½®å±æ€§çš„æ¥å£å®Œæˆä¾èµ–æ³¨å…¥ã€‚</p>\n<p><strong>3ã€å¤„ç†Awareæ¥å£ï¼ˆé…ç½®Beanå¯¹è±¡çš„idå€¼ã€å·¥å‚&#x2F;ä¸Šä¸‹æ–‡ï¼‰ï¼š</strong></p>\n<p>æ¥ç€ï¼ŒSpring ä¼šæ£€æµ‹è¯¥å¯¹è±¡æ˜¯å¦å®ç°äº† xxxAware æ¥å£ï¼Œå¹¶å°†ç›¸å…³çš„ xxxAware å®ä¾‹æ³¨å…¥ç»™ Beanï¼š</p>\n<ul>\n<li>å¦‚æœè¿™ä¸ª Bean å·²ç»å®ç°äº† BeanNameAware æ¥å£ï¼Œä¼šè°ƒç”¨å®ƒå®ç°çš„ setBeanName(String beanId)æ–¹æ³•ï¼Œæ­¤å¤„ä¼ é€’çš„å°±æ˜¯ Spring é…ç½®æ–‡ä»¶ä¸­ Bean çš„ id å€¼ï¼›</li>\n<li>å¦‚æœè¿™ä¸ª Bean å·²ç»å®ç°äº† BeanFactoryAware æ¥å£ï¼Œä¼šè°ƒç”¨å®ƒå®ç°çš„ setBeanFactory()æ–¹æ³•ï¼Œä¼ é€’çš„æ˜¯ Spring å·¥å‚è‡ªèº«ï¼›</li>\n<li>å¦‚æœè¿™ä¸ª Bean å·²ç»å®ç°äº† ApplicationContextAware æ¥å£ï¼Œä¼šè°ƒ setApplicationContext(ApplicationContext)æ–¹æ³•ï¼Œä¼ å…¥ Spring ä¸Šä¸‹æ–‡ï¼›</li>\n</ul>\n<p><strong>4ã€postProcessBeforeInitializationï¼ˆåˆå§‹åŒ–å‰ç½®å¤„ç†ï¼‰ï¼š</strong></p>\n<p>å¦‚æœæƒ³å¯¹ Bean è¿›è¡Œä¸€äº›è‡ªå®šä¹‰çš„å¤„ç†ï¼Œé‚£ä¹ˆå¯ä»¥è®© Bean å®ç°äº† BeanPostProcessor æ¥å£ï¼Œé‚£å°†ä¼šè°ƒç”¨ postProcessBeforeInitialization(Object obj, String s)æ–¹æ³•ã€‚ç”±äºè¿™ä¸ªæ–¹æ³•æ˜¯åœ¨ Bean åˆå§‹åŒ–ç»“æŸæ—¶è°ƒç”¨çš„ï¼Œæ‰€ä»¥å¯ä»¥è¢«åº”ç”¨äºå†…å­˜æˆ–ç¼“å­˜æŠ€æœ¯ï¼›</p>\n<p><strong>5ã€è‡ªå®šä¹‰åˆå§‹åŒ–init-methodï¼š</strong></p>\n<p>å¦‚æœ Bean åœ¨ Spring é…ç½®æ–‡ä»¶ä¸­é…ç½®äº† init-method å±æ€§ï¼Œåˆ™ä¼šè‡ªåŠ¨è°ƒç”¨å…¶é…ç½®çš„<strong>è‡ªå®šä¹‰åˆå§‹åŒ–</strong>æ–¹æ³•ã€‚</p>\n<p><strong>6ã€postProcessAfterInitializationï¼ˆåˆå§‹åŒ–åç½®å¤„ç†ï¼‰</strong></p>\n<p>å¦‚æœè¿™ä¸ª Bean å®ç°äº† BeanPostProcessor æ¥å£ï¼Œå°†ä¼šè°ƒç”¨ postProcessAfterInitialization(Object obj, String s)æ–¹æ³•ï¼Œ<strong>AOPåœ¨è¿™ä¸ªæ—¶å€™è¿›è¡Œä»£ç†å¯¹è±¡çš„åˆ›å»º</strong>ã€‚</p>\n<p><strong>NOW</strong> ä»¥ä¸Šå‡ ä¸ªæ­¥éª¤å®Œæˆåï¼ŒBean å°±å·²ç»è¢«æ­£ç¡®åˆ›å»ºäº†ï¼Œä¹‹åå°±å¯ä»¥ä½¿ç”¨è¿™ä¸ª Bean äº†ã€‚</p>\n<p><strong>7ã€æ¸…ç†é˜¶æ®µdestroyï¼š</strong></p>\n<p>å½“ Bean ä¸å†éœ€è¦æ—¶ï¼Œä¼šè¿›å…¥æ¸…ç†é˜¶æ®µï¼Œå¦‚æœ Bean å®ç°äº† DisposableBean è¿™ä¸ªæ¥å£ï¼Œä¼šè°ƒç”¨å…¶å®ç°çš„ destroy()æ–¹æ³•ï¼›</p>\n<p><strong>8ã€è‡ªå®šä¹‰é”€æ¯destroy-methodï¼š</strong></p>\n<p>æœ€åï¼Œå¦‚æœè¿™ä¸ª Bean çš„ Spring é…ç½®ä¸­é…ç½®äº† destroy-method å±æ€§ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨å…¶é…ç½®çš„<strong>è‡ªå®šä¹‰é”€æ¯</strong>æ–¹æ³•ã€‚</p>\n<h3 id=\"åœ¨-Springä¸­å¦‚ä½•æ³¨å…¥ä¸€ä¸ªJavaé›†åˆï¼Ÿ\"><a href=\"#åœ¨-Springä¸­å¦‚ä½•æ³¨å…¥ä¸€ä¸ªJavaé›†åˆï¼Ÿ\" class=\"headerlink\" title=\"åœ¨ Springä¸­å¦‚ä½•æ³¨å…¥ä¸€ä¸ªJavaé›†åˆï¼Ÿ\"></a>åœ¨ Springä¸­å¦‚ä½•æ³¨å…¥ä¸€ä¸ªJavaé›†åˆï¼Ÿ</h3><p>ç”¨<code>&lt;list&gt;</code>æ³¨å…¥ä¸€åˆ—å€¼ï¼Œç”¨<code>&lt;map&gt;</code>æ³¨å…¥ä¸€ç»„æ˜ å°„æ•°æ®ã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯beanè£…é…ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯beanè£…é…ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯beanè£…é…ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯beanè£…é…ï¼Ÿ</h3><p>é€šè¿‡ bean çš„ä¾èµ–å…³ç³»ï¼Œä½¿ç”¨ä¾èµ–æ³¨å…¥å°† spring ä¸­çš„ bean è£…é…åœ¨ä¸€èµ·ã€‚<br>spring å¯ä»¥é€šè¿‡ bean çš„ä¾èµ–å…³ç³»è‡ªåŠ¨å®Œæˆ bean ä¹‹é—´çš„é…ç½®ã€‚</p>\n<h3 id=\"Spring-è‡ªåŠ¨è£…é…-bean-æœ‰å“ªäº›æ–¹å¼ï¼Ÿ\"><a href=\"#Spring-è‡ªåŠ¨è£…é…-bean-æœ‰å“ªäº›æ–¹å¼ï¼Ÿ\" class=\"headerlink\" title=\"Spring è‡ªåŠ¨è£…é… bean æœ‰å“ªäº›æ–¹å¼ï¼Ÿ\"></a>Spring è‡ªåŠ¨è£…é… bean æœ‰å“ªäº›æ–¹å¼ï¼Ÿ</h3><p>åœ¨ spring ä¸­ï¼Œå¯¹è±¡æ— éœ€è‡ªå·±æŸ¥æ‰¾æˆ–åˆ›å»ºä¸å…¶å…³è”çš„å…¶ä»–å¯¹è±¡ï¼Œç”±å®¹å™¨è´Ÿè´£æŠŠéœ€è¦ç›¸äº’åä½œçš„å¯¹è±¡å¼•ç”¨èµ‹äºˆå„ä¸ªå¯¹è±¡ã€‚</p>\n<p>åœ¨ Spring æ¡†æ¶ xml é…ç½®ä¸­å…±æœ‰ 5 ç§è‡ªåŠ¨è£…é…ï¼š</p>\n<ul>\n<li>noï¼šé»˜è®¤çš„æ–¹å¼æ˜¯ä¸è¿›è¡Œè‡ªåŠ¨è£…é…çš„ï¼Œé€šè¿‡æ‰‹å·¥è®¾ç½® ref å±æ€§æ¥è¿›è¡Œè£…é… beanã€‚</li>\n<li>byNameï¼šé€šè¿‡ bean çš„åç§°è¿›è¡Œè‡ªåŠ¨è£…é…ï¼Œå¦‚æœä¸€ä¸ª bean çš„ property ä¸å¦ä¸€ bean çš„ name ç›¸åŒï¼Œå°±è¿›è¡Œè‡ªåŠ¨è£…é…ã€‚</li>\n<li>byTypeï¼šé€šè¿‡å‚æ•°çš„æ•°æ®ç±»å‹è¿›è¡Œè‡ªåŠ¨è£…é…ã€‚</li>\n<li>constructorï¼šåˆ©ç”¨æ„é€ å‡½æ•°è¿›è¡Œè£…é…ï¼Œå¹¶ä¸”æ„é€ å‡½æ•°çš„å‚æ•°é€šè¿‡ byType è¿›è¡Œè£…é…ã€‚</li>\n<li>autodetectï¼šè‡ªåŠ¨æ¢æµ‹ï¼Œå¦‚æœæœ‰æ„é€ æ–¹æ³•ï¼Œé€šè¿‡ construct çš„æ–¹å¼è‡ªåŠ¨è£…é…ï¼Œå¦åˆ™ä½¿ç”¨ byType çš„æ–¹å¼è‡ªåŠ¨è£…é…ã€‚</li>\n</ul>\n<h3 id=\"ä½¿ç”¨-Autowiredæ³¨è§£è‡ªåŠ¨è£…é…çš„è¿‡ç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ\"><a href=\"#ä½¿ç”¨-Autowiredæ³¨è§£è‡ªåŠ¨è£…é…çš„è¿‡ç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ\" class=\"headerlink\" title=\"ä½¿ç”¨@Autowiredæ³¨è§£è‡ªåŠ¨è£…é…çš„è¿‡ç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ\"></a>ä½¿ç”¨@Autowiredæ³¨è§£è‡ªåŠ¨è£…é…çš„è¿‡ç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ</h3><p>ä½¿ç”¨@Autowired æ³¨è§£æ¥è‡ªåŠ¨è£…é…æŒ‡å®šçš„ beanã€‚åœ¨ä½¿ç”¨@Autowired æ³¨è§£ä¹‹å‰éœ€è¦åœ¨ Spring é…ç½®æ–‡ä»¶è¿›è¡Œé…ç½®æ³¨è§£æ‰«æ <code>&lt;context:annotation-config /&gt;</code>ã€‚</p>\n<p>åœ¨å¯åŠ¨ spring IoC æ—¶ï¼Œå®¹å™¨è‡ªåŠ¨è£…è½½äº†ä¸€ä¸ªåç½®å¤„ç†å™¨ï¼Œå½“å®¹å™¨æ‰«æåˆ°@Autowiedã€@Resource æˆ–@Inject æ—¶ï¼Œå°±ä¼šåœ¨ IoC å®¹å™¨è‡ªåŠ¨æŸ¥æ‰¾éœ€è¦çš„ beanï¼Œå¹¶è£…é…ç»™è¯¥å¯¹è±¡çš„å±æ€§ã€‚åœ¨ä½¿ç”¨@Autowired æ—¶ï¼Œé¦–å…ˆåœ¨å®¹å™¨ä¸­<strong>æŸ¥è¯¢å¯¹åº”ç±»å‹</strong>çš„ beanï¼š</p>\n<ul>\n<li>å¦‚æœå¯¹åº”ç±»å‹æŸ¥è¯¢ç»“æœåˆšå¥½ä¸ºä¸€ä¸ªï¼Œå°±å°†è¯¥ bean è£…é…ç»™@Autowired æŒ‡å®šçš„æ•°æ®ï¼›</li>\n<li>å¦‚æœå¯¹åº”ç±»å‹æŸ¥è¯¢çš„ç»“æœä¸æ­¢ä¸€ä¸ªï¼Œé‚£ä¹ˆ@Autowired ä¼šæ ¹æ®åç§°æ¥æŸ¥æ‰¾ï¼›</li>\n<li>å¦‚æœä¸Šè¿°æŸ¥æ‰¾çš„ç»“æœä¸ºç©ºæˆ–è€…ä¸æ­¢ä¸€ä¸ªï¼Œé‚£ä¹ˆä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</li>\n</ul>\n<h2 id=\"Springæ³¨è§£\"><a href=\"#Springæ³¨è§£\" class=\"headerlink\" title=\"Springæ³¨è§£\"></a>Springæ³¨è§£</h2><h3 id=\"ä»€ä¹ˆæ˜¯åŸºäºJavaçš„Springæ³¨è§£é…ç½®-ç»™ä¸€äº›æ³¨è§£çš„ä¾‹å­\"><a href=\"#ä»€ä¹ˆæ˜¯åŸºäºJavaçš„Springæ³¨è§£é…ç½®-ç»™ä¸€äº›æ³¨è§£çš„ä¾‹å­\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯åŸºäºJavaçš„Springæ³¨è§£é…ç½®? ç»™ä¸€äº›æ³¨è§£çš„ä¾‹å­\"></a>ä»€ä¹ˆæ˜¯åŸºäºJavaçš„Springæ³¨è§£é…ç½®? ç»™ä¸€äº›æ³¨è§£çš„ä¾‹å­</h3><p>åŸºäº Java çš„é…ç½®ï¼Œå…è®¸ä½ åœ¨å°‘é‡çš„ Java æ³¨è§£çš„å¸®åŠ©ä¸‹ï¼Œè¿›è¡Œä½ çš„å¤§éƒ¨åˆ† Spring é…ç½®è€Œéé€šè¿‡ XML æ–‡ä»¶ã€‚</p>\n<p>ä»¥@Configuration æ³¨è§£ä¸ºä¾‹ï¼Œå®ƒç”¨æ¥æ ‡è®°ç±»å¯ä»¥å½“åšä¸€ä¸ª bean çš„å®šä¹‰ï¼Œè¢« Spring IOC å®¹å™¨ä½¿ç”¨ã€‚</p>\n<p>å¦ä¸€ä¸ªä¾‹å­æ˜¯@Bean æ³¨è§£ï¼Œå®ƒè¡¨ç¤ºæ­¤æ–¹æ³•å°†è¦è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œä½œä¸ºä¸€ä¸ª bean æ³¨å†Œè¿› Spring åº”ç”¨ä¸Šä¸‹æ–‡ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">StudentConfig</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> StudentBean <span class=\"title function_\">myStudent</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">StudentBean</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"æ€æ ·å¼€å¯æ³¨è§£è£…é…ï¼Ÿ\"><a href=\"#æ€æ ·å¼€å¯æ³¨è§£è£…é…ï¼Ÿ\" class=\"headerlink\" title=\"æ€æ ·å¼€å¯æ³¨è§£è£…é…ï¼Ÿ\"></a>æ€æ ·å¼€å¯æ³¨è§£è£…é…ï¼Ÿ</h3><p>æ³¨è§£è£…é…åœ¨é»˜è®¤æƒ…å†µä¸‹æ˜¯ä¸å¼€å¯çš„ï¼Œä¸ºäº†ä½¿ç”¨æ³¨è§£è£…é…ï¼Œå¿…é¡»åœ¨ Spring é…ç½®æ–‡ä»¶ä¸­é…ç½® <code>&lt;context:annotation-config/&gt;</code>ã€‚</p>\n<h3 id=\"Component-Controller-Repository-Service-æœ‰ä½•åŒºåˆ«ï¼Ÿ\"><a href=\"#Component-Controller-Repository-Service-æœ‰ä½•åŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"@Component, @Controller, @Repository, @Service æœ‰ä½•åŒºåˆ«ï¼Ÿ\"></a>@Component, @Controller, @Repository, @Service æœ‰ä½•åŒºåˆ«ï¼Ÿ</h3><p>@Componentï¼šè¿™å°† Java ç±»æ ‡è®°ä¸º beanã€‚spring çš„ç»„ä»¶æ‰«ææœºåˆ¶å¯ä»¥å°†å…¶æ‰«æå¹¶å°†å…¶æ³¨å†Œåˆ° IoC å®¹å™¨ä¸­ã€‚</p>\n<p>@Controllerï¼šè¿™å°†ä¸€ä¸ªç±»æ ‡è®°ä¸º Spring Web MVC æ§åˆ¶å™¨ã€‚æ ‡æœ‰å®ƒçš„ Bean ä¼šè‡ªåŠ¨å¯¼å…¥åˆ° IoC å®¹å™¨ä¸­ã€‚</p>\n<p>@Serviceï¼šæ­¤æ³¨è§£æ˜¯ç»„ä»¶æ³¨è§£çš„ç‰¹åŒ–ã€‚å®ƒä¸ä¼šå¯¹ @Component æ³¨è§£æä¾›ä»»ä½•å…¶ä»–è¡Œä¸ºã€‚æ‚¨å¯ä»¥åœ¨æœåŠ¡å±‚ç±»ä¸­ä½¿ç”¨ @Service è€Œä¸æ˜¯ @Componentï¼Œå› ä¸ºå®ƒä»¥æ›´å¥½çš„æ–¹å¼æŒ‡å®šäº†æ„å›¾ã€‚</p>\n<p>@Repositoryï¼šè¿™ä¸ªæ³¨è§£æ˜¯å…·æœ‰ç±»ä¼¼ç”¨é€”å’ŒåŠŸèƒ½çš„ @Component æ³¨è§£çš„ç‰¹åŒ–ã€‚å®ƒä¸º DAO æä¾›äº†é¢å¤–çš„å¥½å¤„ã€‚å®ƒå°† DAO å¯¼å…¥ IoC å®¹å™¨ï¼Œå¹¶ä½¿æœªç»æ£€æŸ¥çš„å¼‚å¸¸æœ‰èµ„æ ¼è½¬æ¢ä¸º Spring DataAccessExceptionã€‚</p>\n<h3 id=\"Required-æ³¨è§£æœ‰ä»€ä¹ˆä½œç”¨\"><a href=\"#Required-æ³¨è§£æœ‰ä»€ä¹ˆä½œç”¨\" class=\"headerlink\" title=\"@Required æ³¨è§£æœ‰ä»€ä¹ˆä½œç”¨\"></a>@Required æ³¨è§£æœ‰ä»€ä¹ˆä½œç”¨</h3><p><code>@Required</code>æ³¨è§£ä½œç”¨äº Bean<code>setter</code>æ–¹æ³•ä¸Šï¼Œç”¨äºæ£€æŸ¥ä¸€ä¸ª Bean çš„å±æ€§çš„å€¼<strong>åœ¨é…ç½®æœŸé—´æ˜¯å¦è¢«èµ‹äºˆæˆ–è®¾ç½®</strong>ï¼Œå¦‚æœæœªè¢«è®¾ç½®ï¼Œå®¹å™¨å°†æŠ›å‡º BeanInitializationExceptionã€‚ç¤ºä¾‹ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Employee</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String name;</span><br><span class=\"line\">    <span class=\"meta\">@Required</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">setName</span><span class=\"params\">(String name)</span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.name=name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> string <span class=\"title function_\">getName</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Autowiredå’Œ-Resourceä¹‹é—´çš„åŒºåˆ«\"><a href=\"#Autowiredå’Œ-Resourceä¹‹é—´çš„åŒºåˆ«\" class=\"headerlink\" title=\"@Autowiredå’Œ@Resourceä¹‹é—´çš„åŒºåˆ«\"></a>@Autowiredå’Œ@Resourceä¹‹é—´çš„åŒºåˆ«</h3><p>@Autowired å¯ç”¨äºï¼šæ„é€ å‡½æ•°ã€æˆå‘˜å˜é‡ã€Setter æ–¹æ³•</p>\n<p>@Autowired å’Œ@Resource ä¹‹é—´çš„åŒºåˆ«</p>\n<ul>\n<li>@Autowired é»˜è®¤æ˜¯<strong>æŒ‰ç…§ç±»å‹è£…é…æ³¨å…¥</strong>çš„ï¼Œé»˜è®¤æƒ…å†µä¸‹å®ƒè¦æ±‚ä¾èµ–å¯¹è±¡å¿…é¡»å­˜åœ¨ï¼ˆå¯ä»¥è®¾ç½®å®ƒ required å±æ€§ä¸º falseï¼‰ã€‚</li>\n<li>@Resource é»˜è®¤æ˜¯<strong>æŒ‰ç…§åç§°æ¥è£…é…æ³¨å…¥</strong>çš„ï¼Œåªæœ‰å½“æ‰¾ä¸åˆ°ä¸åç§°åŒ¹é…çš„ bean æ‰ä¼šæŒ‰ç…§ç±»å‹æ¥è£…é…æ³¨å…¥ã€‚</li>\n</ul>\n<h3 id=\"Qualifier-æ³¨è§£æœ‰ä»€ä¹ˆä½œç”¨\"><a href=\"#Qualifier-æ³¨è§£æœ‰ä»€ä¹ˆä½œç”¨\" class=\"headerlink\" title=\"@Qualifier æ³¨è§£æœ‰ä»€ä¹ˆä½œç”¨\"></a>@Qualifier æ³¨è§£æœ‰ä»€ä¹ˆä½œç”¨</h3><p>å½“æ‚¨åˆ›å»ºå¤šä¸ªç›¸åŒç±»å‹çš„ bean å¹¶å¸Œæœ›ä»…ä½¿ç”¨å±æ€§è£…é…å…¶ä¸­ä¸€ä¸ª bean æ—¶ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨@Qualifier æ³¨è§£å’Œ @Autowired é€šè¿‡æŒ‡å®šåº”è¯¥è£…é…å“ªä¸ªç¡®åˆ‡çš„ bean æ¥æ¶ˆé™¤æ­§ä¹‰ã€‚</p>\n<h3 id=\"RequestMapping-æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ\"><a href=\"#RequestMapping-æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ\" class=\"headerlink\" title=\"@RequestMapping æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ\"></a>@RequestMapping æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h3><p>@RequestMapping æ³¨è§£ç”¨äºå°†ç‰¹å®š HTTP è¯·æ±‚æ–¹æ³•æ˜ å°„åˆ°å°†å¤„ç†ç›¸åº”è¯·æ±‚çš„æ§åˆ¶å™¨ä¸­çš„ç‰¹å®šç±»&#x2F;æ–¹æ³•ã€‚æ­¤æ³¨é‡Šå¯åº”ç”¨äºä¸¤ä¸ªçº§åˆ«ï¼š</p>\n<ul>\n<li>ç±»çº§åˆ«ï¼šæ˜ å°„è¯·æ±‚çš„ URL</li>\n<li>æ–¹æ³•çº§åˆ«ï¼šæ˜ å°„ URL ä»¥åŠ HTTP è¯·æ±‚æ–¹æ³•</li>\n</ul>\n<h2 id=\"Springäº‹åŠ¡\"><a href=\"#Springäº‹åŠ¡\" class=\"headerlink\" title=\"Springäº‹åŠ¡\"></a>Springäº‹åŠ¡</h2><h3 id=\"Springæ”¯æŒçš„äº‹åŠ¡ç®¡ç†ç±»å‹-x2F-äº‹åŠ¡å®ç°æ–¹å¼æœ‰å“ªäº›ï¼Ÿ\"><a href=\"#Springæ”¯æŒçš„äº‹åŠ¡ç®¡ç†ç±»å‹-x2F-äº‹åŠ¡å®ç°æ–¹å¼æœ‰å“ªäº›ï¼Ÿ\" class=\"headerlink\" title=\"Springæ”¯æŒçš„äº‹åŠ¡ç®¡ç†ç±»å‹&#x2F;äº‹åŠ¡å®ç°æ–¹å¼æœ‰å“ªäº›ï¼Ÿ\"></a>Springæ”¯æŒçš„äº‹åŠ¡ç®¡ç†ç±»å‹&#x2F;äº‹åŠ¡å®ç°æ–¹å¼æœ‰å“ªäº›ï¼Ÿ</h3><p>Spring æ”¯æŒä¸¤ç§ç±»å‹çš„äº‹åŠ¡ç®¡ç†ï¼š</p>\n<p><strong>ç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç†</strong>ï¼šè¿™æ„å‘³ä½ é€šè¿‡ç¼–ç¨‹çš„æ–¹å¼ç®¡ç†äº‹åŠ¡ï¼Œç»™ä½ å¸¦æ¥æå¤§çš„çµæ´»æ€§ï¼Œä½†æ˜¯éš¾ç»´æŠ¤ã€‚</p>\n<p><strong>å£°æ˜å¼äº‹åŠ¡ç®¡ç†</strong>ï¼šè¿™æ„å‘³ç€ä½ å¯ä»¥å°†ä¸šåŠ¡ä»£ç å’Œäº‹åŠ¡ç®¡ç†åˆ†ç¦»ï¼Œä½ åªéœ€ç”¨æ³¨è§£å’Œ XML é…ç½®æ¥ç®¡ç†äº‹åŠ¡ã€‚</p>\n<h3 id=\"Springäº‹åŠ¡çš„å®ç°æ–¹å¼å’Œå®ç°åŸç†\"><a href=\"#Springäº‹åŠ¡çš„å®ç°æ–¹å¼å’Œå®ç°åŸç†\" class=\"headerlink\" title=\"Springäº‹åŠ¡çš„å®ç°æ–¹å¼å’Œå®ç°åŸç†\"></a>Springäº‹åŠ¡çš„å®ç°æ–¹å¼å’Œå®ç°åŸç†</h3><p>Spring äº‹åŠ¡çš„æœ¬è´¨å…¶å®å°±æ˜¯æ•°æ®åº“å¯¹äº‹åŠ¡çš„æ”¯æŒï¼Œæ²¡æœ‰æ•°æ®åº“çš„äº‹åŠ¡æ”¯æŒï¼ŒSpring æ˜¯æ— æ³•æä¾›äº‹åŠ¡åŠŸèƒ½çš„ã€‚</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- 2ã€é…ç½®äº‹åŠ¡çš„é€šçŸ¥ä»¥åŠäº‹åŠ¡çš„å±æ€§--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">tx:advice</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;txAdvice&quot;</span> <span class=\"attr\">transaction-manager</span>=<span class=\"string\">&quot;transactionManager&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- é…ç½®äº‹åŠ¡çš„å±æ€§</span></span><br><span class=\"line\"><span class=\"comment\">isolationï¼šç”¨äºæŒ‡å®šäº‹åŠ¡çš„éš”ç¦»çº§åˆ«ã€‚é»˜è®¤å€¼æ˜¯DEFAULTï¼Œè¡¨ç¤ºä½¿ç”¨æ•°æ®åº“çš„é»˜è®¤éš”</span></span><br><span class=\"line\"><span class=\"comment\">ç¦»çº§åˆ«ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">propagationï¼šç”¨äºæŒ‡å®šäº‹åŠ¡çš„ä¼ æ’­è¡Œä¸ºã€‚é»˜è®¤å€¼æ˜¯REQUIRED(å¢åˆ æ”¹)ï¼Œè¡¨ç¤ºä¸€å®šä¼š</span></span><br><span class=\"line\"><span class=\"comment\">æœ‰äº‹åŠ¡ã€‚æŸ¥è¯¢æ–¹æ³•å¯ä»¥é€‰æ‹©SUPPORTSã€‚</span></span><br><span class=\"line\"><span class=\"comment\">read-onlyï¼šç”¨äºæŒ‡å®šäº‹åŠ¡æ˜¯å¦åªè¯»ã€‚åªæœ‰æŸ¥è¯¢æ–¹æ³•æ‰èƒ½è®¾ç½®ä¸ºtrueã€‚é»˜è®¤å€¼æ˜¯</span></span><br><span class=\"line\"><span class=\"comment\">falseï¼Œè¡¨ç¤ºè¯»å†™ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">timeoutï¼šç”¨äºæŒ‡å®šäº‹åŠ¡çš„è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤å€¼æ˜¯-1ï¼Œè¡¨ç¤ºæ°¸ä¸è¶…æ—¶ã€‚å¦‚æœæŒ‡å®šäº†æ•°å€¼ï¼Œ</span></span><br><span class=\"line\"><span class=\"comment\">ä»¥ç§’ä¸ºå•ä½ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">rollback-forï¼šç”¨äºæŒ‡å®šä¸€ä¸ªå¼‚å¸¸ï¼Œå½“äº§ç”Ÿè¯¥å¼‚å¸¸æ—¶ï¼Œäº‹åŠ¡å›æ»šï¼Œäº§ç”Ÿå…¶ä»–å¼‚å¸¸æ—¶ï¼Œ</span></span><br><span class=\"line\"><span class=\"comment\">äº‹åŠ¡ä¸å›æ»šã€‚æ²¡æœ‰é»˜è®¤å€¼ã€‚è¡¨ç¤ºä»»ä½•å¼‚å¸¸éƒ½å›æ»šã€‚</span></span><br><span class=\"line\"><span class=\"comment\">no-rollback-forï¼šç”¨äºæŒ‡å®šä¸€ä¸ªå¼‚å¸¸ï¼Œå½“äº§ç”Ÿè¯¥å¼‚å¸¸æ—¶ï¼Œäº‹åŠ¡ä¸å›æ»šï¼Œäº§ç”Ÿå…¶ä»–å¼‚å¸¸</span></span><br><span class=\"line\"><span class=\"comment\">æ—¶äº‹åŠ¡å›æ»šã€‚æ²¡æœ‰é»˜è®¤å€¼ã€‚è¡¨ç¤ºä»»ä½•å¼‚å¸¸éƒ½å›æ»šã€‚</span></span><br><span class=\"line\"><span class=\"comment\">--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">tx:attributes</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--éæŸ¥è¯¢æ–¹æ³•--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">tx:method</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;*&quot;</span> <span class=\"attr\">propagation</span>=<span class=\"string\">&quot;REQUIRED&quot;</span> <span class=\"attr\">read-only</span>=<span class=\"string\">&quot;false&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--æŸ¥è¯¢æ–¹æ³•--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">tx:method</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;find*&quot;</span> <span class=\"attr\">propagation</span>=<span class=\"string\">&quot;SUPPORTS&quot;</span> <span class=\"attr\">read-only</span>=<span class=\"string\">&quot;true&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">tx:attributes</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">tx:advice</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"è¯´ä¸€ä¸‹Springçš„äº‹åŠ¡ä¼ æ’­è¡Œä¸º\"><a href=\"#è¯´ä¸€ä¸‹Springçš„äº‹åŠ¡ä¼ æ’­è¡Œä¸º\" class=\"headerlink\" title=\"è¯´ä¸€ä¸‹Springçš„äº‹åŠ¡ä¼ æ’­è¡Œä¸º\"></a>è¯´ä¸€ä¸‹Springçš„äº‹åŠ¡ä¼ æ’­è¡Œä¸º</h3><p>spring äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸ºè¯´çš„æ˜¯ï¼Œå½“å¤šä¸ªäº‹åŠ¡åŒæ—¶å­˜åœ¨çš„æ—¶å€™ï¼Œspring å¦‚ä½•å¤„ç†è¿™äº›äº‹åŠ¡çš„è¡Œä¸ºã€‚</p>\n<blockquote>\n<p>â‘  <strong>PROPAGATION_REQUIRED</strong>ï¼šå¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œå°±åˆ›å»ºä¸€ä¸ªæ–°äº‹åŠ¡ï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±åŠ å…¥è¯¥äº‹åŠ¡ï¼Œè¯¥è®¾ç½®æ˜¯æœ€å¸¸ç”¨çš„è®¾ç½®ã€‚ï¼ˆé»˜è®¤å€¼ï¼Œé€‚ç”¨äºéæŸ¥è¯¢æ–¹æ³•ï¼Œå¢åˆ æ”¹ï¼‰ï¼ˆäº‹åŠ¡å­˜åœ¨å°±ç”¨ä¸å­˜åœ¨è¦åˆ›å»ºï¼‰<br>â‘¡ <strong>PROPAGATION_SUPPORTS</strong>ï¼šæ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±åŠ å…¥è¯¥äº‹åŠ¡ï¼Œå¦‚æœå½“å‰ä¸å­˜åœ¨äº‹åŠ¡ï¼Œå°±ä»¥éäº‹åŠ¡æ‰§è¡Œã€‚ï¼ˆé€‚ç”¨äºæŸ¥è¯¢æ–¹æ³•ï¼‰ï¼ˆäº‹åŠ¡å­˜åœ¨å°±ç”¨ä¸å­˜åœ¨å°±ä¸ç”¨ï¼‰<br>â‘¢ PROPAGATION_MANDATORYï¼šæ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±åŠ å…¥è¯¥äº‹åŠ¡ï¼Œå¦‚æœå½“å‰ä¸å­˜åœ¨äº‹åŠ¡ï¼Œå°±æŠ›å‡ºå¼‚å¸¸ã€‚<br>â‘£ <strong>PROPAGATION_REQUIRES_NEW</strong>ï¼šåˆ›å»ºæ–°äº‹åŠ¡ï¼Œæ— è®ºå½“å‰å­˜ä¸å­˜åœ¨äº‹åŠ¡ï¼Œéƒ½åˆ›å»ºæ–°äº‹åŠ¡ã€‚ï¼ˆæ°¸è¿œéƒ½è¦æ–°äº‹åŠ¡ï¼‰<br>â‘¤ PROPAGATION_NOT_SUPPORTEDï¼šä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œæ“ä½œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±æŠŠå½“å‰äº‹åŠ¡æŒ‚èµ·ã€‚<br>â‘¥ PROPAGATION_NEVERï¼šä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚<br>â‘¦ PROPAGATION_NESTEDï¼šå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åœ¨åµŒå¥—äº‹åŠ¡å†…æ‰§è¡Œã€‚å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œåˆ™æŒ‰REQUIREDå±æ€§æ‰§è¡Œã€‚</p>\n</blockquote>\n<h3 id=\"è¯´ä¸€ä¸‹-spring-çš„äº‹åŠ¡éš”ç¦»ï¼Ÿ\"><a href=\"#è¯´ä¸€ä¸‹-spring-çš„äº‹åŠ¡éš”ç¦»ï¼Ÿ\" class=\"headerlink\" title=\"è¯´ä¸€ä¸‹ spring çš„äº‹åŠ¡éš”ç¦»ï¼Ÿ\"></a>è¯´ä¸€ä¸‹ spring çš„äº‹åŠ¡éš”ç¦»ï¼Ÿ</h3><p>spring æœ‰äº”å¤§éš”ç¦»çº§åˆ«ï¼Œé»˜è®¤å€¼ä¸º ISOLATION_DEFAULTï¼ˆä½¿ç”¨æ•°æ®åº“çš„è®¾ç½®ï¼‰ï¼Œå…¶ä»–å››ä¸ªéš”ç¦»çº§åˆ«å’Œæ•°æ®åº“çš„éš”ç¦»çº§åˆ«ä¸€è‡´ï¼š</p>\n<ol>\n<li>ISOLATION_DEFAULTï¼šç”¨åº•å±‚æ•°æ®åº“çš„è®¾ç½®éš”ç¦»çº§åˆ«ï¼Œæ•°æ®åº“è®¾ç½®çš„æ˜¯ä»€ä¹ˆæˆ‘å°±ç”¨ä»€ä¹ˆï¼›</li>\n<li>ISOLATION_READ_UNCOMMITTEDï¼šè¯»æœªæäº¤ï¼Œæœ€ä½éš”ç¦»çº§åˆ«ã€äº‹åŠ¡æœªæäº¤å‰ï¼Œå°±å¯è¢«å…¶ä»–äº‹åŠ¡è¯»å–ï¼ˆä¼šå‡ºç°è„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»ï¼‰ï¼›</li>\n<li>ISOLATION_READ_COMMITTEDï¼šè¯»å·²æäº¤ï¼Œä¸€ä¸ªäº‹åŠ¡æäº¤åæ‰èƒ½è¢«å…¶ä»–äº‹åŠ¡è¯»å–åˆ°ï¼ˆä¼šé€ æˆä¸å¯é‡å¤è¯»ã€å¹»è¯»ï¼‰ï¼ŒSQL server çš„é»˜è®¤çº§åˆ«ï¼›</li>\n<li>ISOLATION_REPEATABLE_READï¼šå¯é‡å¤è¯»ï¼Œä¿è¯å¤šæ¬¡è¯»å–åŒä¸€ä¸ªæ•°æ®æ—¶ï¼Œå…¶å€¼éƒ½å’Œäº‹åŠ¡å¼€å§‹æ—¶å€™çš„å†…å®¹æ˜¯ä¸€è‡´ï¼Œç¦æ­¢è¯»å–åˆ°åˆ«çš„äº‹åŠ¡æœªæäº¤çš„æ•°æ®ï¼ˆä¼šé€ æˆå¹»è¯»ï¼‰ï¼ŒMySQL çš„é»˜è®¤çº§åˆ«ï¼›</li>\n<li>ISOLATION_SERIALIZABLEï¼šåºåˆ—åŒ–ï¼Œä»£ä»·æœ€é«˜æœ€å¯é çš„éš”ç¦»çº§åˆ«ï¼Œè¯¥éš”ç¦»çº§åˆ«èƒ½é˜²æ­¢è„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»ã€‚</li>\n</ol>\n<h2 id=\"Springé¢å‘åˆ‡é¢ç¼–ç¨‹-AOP\"><a href=\"#Springé¢å‘åˆ‡é¢ç¼–ç¨‹-AOP\" class=\"headerlink\" title=\"Springé¢å‘åˆ‡é¢ç¼–ç¨‹(AOP)\"></a>Springé¢å‘åˆ‡é¢ç¼–ç¨‹(AOP)</h2><h3 id=\"ä»€ä¹ˆæ˜¯AOP\"><a href=\"#ä»€ä¹ˆæ˜¯AOP\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯AOP\"></a>ä»€ä¹ˆæ˜¯AOP</h3><p>OOP(Object-Oriented Programming)é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œå…è®¸å¼€å‘è€…å®šä¹‰çºµå‘çš„å…³ç³»ï¼Œä½†å¹¶é€‚ç”¨äºå®šä¹‰æ¨ªå‘çš„å…³ç³»ï¼Œå¯¼è‡´äº†å¤§é‡ä»£ç çš„é‡å¤ï¼Œè€Œä¸åˆ©äºå„ä¸ªæ¨¡å—çš„é‡ç”¨ã€‚</p>\n<p>AOP(Aspect-Oriented Programming)ï¼Œä¸€èˆ¬ç§°ä¸ºé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œä½œä¸ºé¢å‘å¯¹è±¡çš„ä¸€ç§è¡¥å……ï¼Œå°†ä¸€äº›<strong>å…¬å…±è¡Œä¸ºå’Œé€»è¾‘ï¼ŒæŠ½å–å¹¶å°è£…ä¸ºä¸€ä¸ªå¯é‡ç”¨çš„æ¨¡å—ï¼Œå‡å°‘ç³»ç»Ÿä¸­çš„é‡å¤ä»£ç ï¼Œé™ä½äº†æ¨¡å—é—´çš„è€¦åˆåº¦ï¼ŒåŒæ—¶æé«˜äº†ç³»ç»Ÿçš„å¯ç»´æŠ¤æ€§ã€‚å¯ç”¨äºæƒé™è®¤è¯ã€æ—¥å¿—ã€äº‹åŠ¡å¤„ç†ç­‰</strong>ã€‚</p>\n<h3 id=\"Spring-AOP-and-AspectJ-AOP-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼ŸAOP-æœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ\"><a href=\"#Spring-AOP-and-AspectJ-AOP-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼ŸAOP-æœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ\" class=\"headerlink\" title=\"Spring AOP and AspectJ AOP æœ‰ä»€ä¹ˆåŒºåˆ«ï¼ŸAOP æœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ\"></a>Spring AOP and AspectJ AOP æœ‰ä»€ä¹ˆåŒºåˆ«ï¼ŸAOP æœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ</h3><p>AOP å®ç°çš„å…³é”®åœ¨äº ä»£ç†æ¨¡å¼ï¼ŒAOP ä»£ç†ä¸»è¦åˆ†ä¸ºé™æ€ä»£ç†ï¼ˆAspectJï¼‰å’ŒåŠ¨æ€ä»£ç†ï¼ˆSpring AOPï¼‰ã€‚</p>\n<p>ï¼ˆ1ï¼‰AspectJ é‡‡ç”¨é™æ€ä»£ç†æ¨¡å¼ï¼Œå±äº<strong>ç¼–è¯‘æ—¶å¢å¼º</strong>ï¼Œä¼šåœ¨ç¼–è¯‘é˜¶æ®µç»‡å…¥åˆ‡é¢ç”Ÿæˆç›¸åº”çš„ä»£ç†å¯¹è±¡</p>\n<p>ï¼ˆ2ï¼‰Spring AOP é‡‡ç”¨åŠ¨æ€ä»£ç†æ¨¡å¼ï¼Œå±äº<strong>è¿è¡Œæ—¶å¢å¼º</strong>ï¼Œæ¯æ¬¡è¿è¡Œæ—¶ç»‡å…¥åˆ‡é¢åœ¨å†…å­˜ä¸­ä¸´æ—¶ç”Ÿæˆç›¸åº”çš„ä»£ç†å¯¹è±¡</p>\n<h3 id=\"JDKåŠ¨æ€ä»£ç†å’ŒCGLIBåŠ¨æ€ä»£ç†çš„åŒºåˆ«\"><a href=\"#JDKåŠ¨æ€ä»£ç†å’ŒCGLIBåŠ¨æ€ä»£ç†çš„åŒºåˆ«\" class=\"headerlink\" title=\"JDKåŠ¨æ€ä»£ç†å’ŒCGLIBåŠ¨æ€ä»£ç†çš„åŒºåˆ«\"></a>JDKåŠ¨æ€ä»£ç†å’ŒCGLIBåŠ¨æ€ä»£ç†çš„åŒºåˆ«</h3><p>JDK åŠ¨æ€ä»£ç†ä¸»è¦æ˜¯é’ˆå¯¹ç±»å®ç°äº†æŸä¸ªæ¥å£ï¼ŒAOP åˆ™ä¼šä½¿ç”¨ JDK åŠ¨æ€ä»£ç†ã€‚åŸºäºåå°„çš„æœºåˆ¶å®ç°ï¼Œç”Ÿæˆä¸€ä¸ªå®ç°è¯¥æ¥å£çš„ä¸€ä¸ªä»£ç†ç±»ï¼Œç„¶åé€šè¿‡é‡å†™æ–¹æ³•çš„æ–¹å¼ï¼Œå®ç°å¯¹ä»£ç çš„å¢å¼ºã€‚</p>\n<p>è€Œå¦‚æœæŸä¸ªç±»æ²¡æœ‰å®ç°æ¥å£ï¼ŒAOP åˆ™ä¼šä½¿ç”¨ CGLIB ä»£ç†ã€‚åº•å±‚åŸç†æ˜¯<strong>åŸºäº asm ç¬¬ä¸‰æ–¹æ¡†æ¶</strong>ï¼Œé€šè¿‡ä¿®æ”¹å­—èŠ‚ç ç”Ÿæˆä¸€ä¸ªå­ç±»ï¼Œç„¶åé‡å†™çˆ¶ç±»çš„æ–¹æ³•ï¼Œå®ç°å¯¹ä»£ç çš„å¢å¼ºã€‚</p>\n<blockquote>\n<p>ä½œè€…ï¼šé˜¿é‡Œäº‘äº‘æ –å·</p>\n<p>é“¾æ¥ï¼š<a href=\"https://zhuanlan.zhihu.com/p/368769721\">https://zhuanlan.zhihu.com/p/368769721</a></p>\n<p>æ¥æºï¼šçŸ¥ä¹</p>\n<p>è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>\n</blockquote>\n<h3 id=\"è§£é‡Šä¸€ä¸‹Spring-AOPé‡Œé¢çš„å‡ ä¸ªåè¯\"><a href=\"#è§£é‡Šä¸€ä¸‹Spring-AOPé‡Œé¢çš„å‡ ä¸ªåè¯\" class=\"headerlink\" title=\"è§£é‡Šä¸€ä¸‹Spring AOPé‡Œé¢çš„å‡ ä¸ªåè¯\"></a>è§£é‡Šä¸€ä¸‹Spring AOPé‡Œé¢çš„å‡ ä¸ªåè¯</h3><p>ï¼ˆ1ï¼‰åˆ‡é¢ï¼ˆAspectï¼‰ï¼šåˆ‡é¢æ˜¯é€šçŸ¥å’Œåˆ‡ç‚¹çš„ç»“åˆã€‚ åœ¨ Spring AOP ä¸­ï¼Œåˆ‡é¢å¯ä»¥ä½¿ç”¨é€šç”¨ç±»ï¼ˆåŸºäºæ¨¡å¼çš„é£æ ¼ï¼‰ æˆ–è€…åœ¨æ™®é€šç±»ä¸­ä»¥ @AspectJ æ³¨è§£æ¥å®ç°ã€‚</p>\n<p>ï¼ˆ2ï¼‰è¿æ¥ç‚¹ï¼ˆJoin pointï¼‰ï¼šæ–¹æ³•</p>\n<p>ï¼ˆ3ï¼‰é€šçŸ¥ï¼ˆAdviceï¼‰ï¼šåœ¨è¦å¢å¼ºä¸Šçš„è¿æ¥ç‚¹ä¸Šè¦è¿›è¡Œæ€æ ·çš„å¢å¼º</p>\n<p>ï¼ˆ4ï¼‰åˆ‡å…¥ç‚¹ï¼ˆPointcutï¼‰ï¼šå“ªäº›è¿æ¥ç‚¹éœ€è¦å¢å¼º</p>\n<p>ï¼ˆ5ï¼‰ç›®æ ‡å¯¹è±¡ï¼ˆTarget Objectï¼‰ï¼š è¢«ä»£ç†ï¼ˆproxiedï¼‰ å¯¹è±¡ã€‚</p>\n<p>ï¼ˆ6ï¼‰ç»‡å…¥ï¼ˆWeavingï¼‰ï¼šç»‡å…¥æ˜¯æŠŠåˆ‡é¢åº”ç”¨åˆ°ç›®æ ‡å¯¹è±¡å¹¶åˆ›å»ºæ–°çš„ä»£ç†å¯¹è±¡çš„è¿‡ç¨‹ã€‚</p>\n<p>ï¼ˆ7ï¼‰Proxyï¼ˆä»£ç†ï¼‰ï¼šä¸€ä¸ªç±»è¢« AOP ç»‡å…¥å¢å¼ºåï¼Œå°±äº§ç”Ÿä¸€ä¸ªç»“æœä»£ç†ç±»ã€‚</p>\n<blockquote>\n<ul>\n<li>ç¼–è¯‘æœŸï¼šåˆ‡é¢åœ¨ç›®æ ‡ç±»ç¼–è¯‘æ—¶è¢«ç»‡å…¥ã€‚AspectJçš„ç»‡å…¥ç¼–è¯‘å™¨æ˜¯ä»¥è¿™ç§æ–¹å¼ç»‡å…¥åˆ‡é¢çš„ã€‚</li>\n<li>ç±»åŠ è½½æœŸï¼šåˆ‡é¢åœ¨ç›®æ ‡ç±»åŠ è½½åˆ°JVMæ—¶è¢«ç»‡å…¥ã€‚éœ€è¦ç‰¹æ®Šçš„ç±»åŠ è½½å™¨ï¼Œå®ƒå¯ä»¥åœ¨ç›®æ ‡ç±»è¢«å¼•å…¥åº”ç”¨ä¹‹å‰å¢å¼ºè¯¥ç›®æ ‡ç±»çš„å­—èŠ‚ç ã€‚AspectJ5çš„åŠ è½½æ—¶ç»‡å…¥å°±æ”¯æŒä»¥è¿™ç§æ–¹å¼ç»‡å…¥åˆ‡é¢ã€‚</li>\n<li>è¿è¡ŒæœŸï¼šåˆ‡é¢åœ¨åº”ç”¨è¿è¡Œçš„æŸä¸ªæ—¶åˆ»è¢«ç»‡å…¥ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œåœ¨ç»‡å…¥åˆ‡é¢æ—¶ï¼ŒAOPå®¹å™¨ä¼šä¸ºç›®æ ‡å¯¹è±¡åŠ¨æ€åœ°åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡ã€‚SpringAOPå°±æ˜¯ä»¥è¿™ç§æ–¹å¼ç»‡å…¥åˆ‡é¢ã€‚</li>\n</ul>\n</blockquote>\n<h3 id=\"Springé€šçŸ¥æœ‰å“ªäº›ç±»å‹ï¼Ÿ\"><a href=\"#Springé€šçŸ¥æœ‰å“ªäº›ç±»å‹ï¼Ÿ\" class=\"headerlink\" title=\"Springé€šçŸ¥æœ‰å“ªäº›ç±»å‹ï¼Ÿ\"></a>Springé€šçŸ¥æœ‰å“ªäº›ç±»å‹ï¼Ÿ</h3><p>åœ¨ AOP æœ¯è¯­ä¸­ï¼Œåˆ‡é¢çš„å·¥ä½œè¢«ç§°ä¸ºé€šçŸ¥ï¼Œå®é™…ä¸Šæ˜¯ç¨‹åºæ‰§è¡Œæ—¶è¦é€šè¿‡ SpringAOP æ¡†æ¶è§¦å‘çš„ä»£ç æ®µã€‚</p>\n<p>Spring åˆ‡é¢å¯ä»¥åº”ç”¨ 5 ç§ç±»å‹çš„é€šçŸ¥ï¼š</p>\n<ol>\n<li>å‰ç½®é€šçŸ¥ï¼ˆBeforeï¼‰ï¼šåœ¨ç›®æ ‡æ–¹æ³•è¢«è°ƒç”¨ä¹‹å‰è°ƒç”¨é€šçŸ¥åŠŸèƒ½ï¼›</li>\n<li>åç½®é€šçŸ¥ï¼ˆAfterï¼‰ï¼šåœ¨ç›®æ ‡æ–¹æ³•å®Œæˆä¹‹åè°ƒç”¨é€šçŸ¥ï¼Œæ­¤æ—¶ä¸ä¼šå…³å¿ƒæ–¹æ³•çš„è¾“å‡ºæ˜¯ä»€ä¹ˆï¼›</li>\n<li>è¿”å›é€šçŸ¥ï¼ˆAfter-returning ï¼‰ï¼šåœ¨ç›®æ ‡æ–¹æ³•æˆåŠŸæ‰§è¡Œä¹‹åè°ƒç”¨é€šçŸ¥ï¼›</li>\n<li>å¼‚å¸¸é€šçŸ¥ï¼ˆAfter-throwingï¼‰ï¼šåœ¨ç›®æ ‡æ–¹æ³•æŠ›å‡ºå¼‚å¸¸åè°ƒç”¨é€šçŸ¥ï¼›</li>\n<li>ç¯ç»•é€šçŸ¥ï¼ˆAroundï¼‰ï¼šé€šçŸ¥åŒ…è£¹äº†è¢«é€šçŸ¥çš„æ–¹æ³•ï¼Œåœ¨è¢«é€šçŸ¥çš„æ–¹æ³•è°ƒç”¨ä¹‹å‰å’Œè°ƒç”¨ä¹‹åæ‰§è¡Œè‡ªå®šä¹‰çš„è¡Œä¸ºã€‚</li>\n</ol>\n<blockquote>\n<p>åŒä¸€ä¸ªaspectï¼Œä¸åŒadviceçš„æ‰§è¡Œé¡ºåºï¼š</p>\n<p>â‘ æ²¡æœ‰å¼‚å¸¸æƒ…å†µä¸‹çš„æ‰§è¡Œé¡ºåºï¼š</p>\n<p>around before advice\tæ–¹æ³•è°ƒç”¨ä¹‹å‰è‡ªå®šä¹‰è¡Œä¸º<br>before advice<br>target method æ‰§è¡Œ<br>around after advice\tæ–¹æ³•è°ƒç”¨åè‡ªå®šä¹‰è¡Œä¸º<br>after advice<br>afterReturning</p>\n<p>â‘¡æœ‰å¼‚å¸¸æƒ…å†µä¸‹çš„æ‰§è¡Œé¡ºåºï¼š</p>\n<p>around before advice<br>before advice<br>target method æ‰§è¡Œ<br>around after advice<br>after advice<br>afterThrowing:å¼‚å¸¸å‘ç”Ÿ<br>Java.lang.RuntimeException: å¼‚å¸¸å‘ç”Ÿ</p>\n</blockquote>\n<h3 id=\"ä»€ä¹ˆæ˜¯åˆ‡é¢-Aspectï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯åˆ‡é¢-Aspectï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯åˆ‡é¢ Aspectï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯åˆ‡é¢ Aspectï¼Ÿ</h3><p>aspect ç”± pointcount å’Œ advice ç»„æˆï¼Œåˆ‡é¢æ˜¯é€šçŸ¥å’Œåˆ‡ç‚¹çš„ç»“åˆã€‚<br>AOP çš„å·¥ä½œé‡å¿ƒåœ¨äºå¦‚ä½•å°†å¢å¼ºç¼–ç»‡ç›®æ ‡å¯¹è±¡çš„è¿æ¥ç‚¹ä¸Š, è¿™é‡ŒåŒ…å«ä¸¤ä¸ªå·¥ä½œ:  </p>\n<ul>\n<li>å¦‚ä½•é€šè¿‡ pointcut å’Œ advice å®šä½åˆ°ç‰¹å®šçš„ joinpoint ä¸Š</li>\n<li>å¦‚ä½•åœ¨ advice ä¸­ç¼–å†™åˆ‡é¢ä»£ç </li>\n</ul>\n<p>å¯ä»¥ç®€å•åœ°è®¤ä¸º, ä½¿ç”¨ @Aspect æ³¨è§£çš„ç±»å°±æ˜¯åˆ‡é¢</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes2020021212264438.png\" alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\"></p>"},{"title":"Javaå…«è‚¡æ–‡ - MySQL","copyright":true,"mathjax":false,"date":"2023-01-25T05:43:41.000Z","toc":true,"urlname":"mysql","_content":"\n> æ•´ç†çš„ MySQL ç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½\t<!--more-->\n\n## MySQLåŸºç¡€ç¯‡\n\n### è¯´ä¸€è¯´ä¸‰ä¸ªèŒƒå¼\n\n**ç¬¬ä¸€èŒƒå¼(ç¡®ä¿æ¯åˆ—ä¿æŒåŸå­æ€§)**\n\nç¬¬ä¸€èŒƒå¼æ˜¯æœ€åŸºæœ¬çš„èŒƒå¼ã€‚å¦‚æœæ•°æ®åº“è¡¨ä¸­çš„æ‰€æœ‰å­—æ®µå€¼éƒ½æ˜¯ä¸å¯åˆ†è§£çš„åŸå­å€¼ï¼Œå°±è¯´æ˜è¯¥æ•°æ®åº“è¡¨æ»¡è¶³äº†ç¬¬ä¸€èŒƒå¼ã€‚\n\n**ç¬¬äºŒèŒƒå¼(ç¡®ä¿è¡¨ä¸­çš„æ¯åˆ—éƒ½å’Œä¸»é”®ç›¸å…³)**ï¼ˆå‰ææ˜¯ç¬¬ä¸€èŒƒå¼ï¼‰\n\nåœ¨ä¸€ä¸ªæ•°æ®åº“è¡¨ä¸­ï¼Œä¸€ä¸ªè¡¨ä¸­åªèƒ½ä¿å­˜**ä¸€ç§**æ•°æ®ï¼Œä¸å¯ä»¥æŠŠå¤šç§æ•°æ®ä¿å­˜åœ¨åŒä¸€å¼ æ•°æ®åº“è¡¨ä¸­ã€‚\n\n**ç¬¬ä¸‰èŒƒå¼(ç¡®ä¿è¡¨ä¸­æ¯åˆ—éƒ½å’Œä¸»é”®ç›´æ¥ç›¸å…³,è€Œä¸æ˜¯é—´æ¥ç›¸å…³)**ï¼ˆå‰ææ˜¯ç¬¬ä¸€ç¬¬äºŒèŒƒå¼ï¼‰\n\nå·²ç»åˆ†å¥½äº†å¤šå¼ è¡¨çš„è¯ï¼Œä¸€å¼ è¡¨ä¸­åªèƒ½æœ‰å¦ä¸€å¼ è¡¨çš„ IDï¼Œè€Œä¸èƒ½æœ‰å…¶ä»–ä»»ä½•ä¿¡æ¯ï¼ˆå…¶ä»–ä»»ä½•ä¿¡æ¯ï¼Œä¸€å¾‹ç”¨ä¸»é”®åœ¨å¦ä¸€å¼ è¡¨ä¸­æŸ¥è¯¢ï¼‰ã€‚\n\n### è¯´ä¸€ä¸‹ MySQL æ‰§è¡Œä¸€æ¡æŸ¥è¯¢è¯­å¥çš„å†…éƒ¨æ‰§è¡Œè¿‡ç¨‹ï¼Ÿ\n\n> è¿æ¥å™¨ â†’ æŸ¥è¯¢ç¼“å­˜ â†’ åˆ†æå™¨ â†’ ä¼˜åŒ–å™¨ â†’ æ‰§è¡Œå™¨\n\n*   å®¢æˆ·ç«¯å…ˆé€šè¿‡**è¿æ¥å™¨**è¿æ¥åˆ° MySQL æœåŠ¡å™¨ã€‚\n\n*   è¿æ¥å™¨æƒé™éªŒè¯é€šè¿‡ä¹‹åï¼Œå…ˆæŸ¥è¯¢æ˜¯å¦æœ‰**æŸ¥è¯¢ç¼“å­˜**ï¼Œå¦‚æœæœ‰ç¼“å­˜ï¼ˆä¹‹å‰æ‰§è¡Œè¿‡æ­¤è¯­å¥ï¼‰åˆ™ç›´æ¥è¿”å›ç¼“å­˜æ•°æ®ï¼Œå¦‚æœæ²¡æœ‰ç¼“å­˜åˆ™è¿›å…¥åˆ†æå™¨ã€‚\n\n*   **åˆ†æå™¨**ä¼šå¯¹æŸ¥è¯¢è¯­å¥è¿›è¡Œè¯­æ³•åˆ†æå’Œè¯æ³•åˆ†æï¼Œåˆ¤æ–­ SQL è¯­æ³•æ˜¯å¦æ­£ç¡®ï¼Œå¦‚æœæŸ¥è¯¢è¯­æ³•é”™è¯¯ä¼šç›´æ¥è¿”å›ç»™å®¢æˆ·ç«¯é”™è¯¯ä¿¡æ¯ï¼Œå¦‚æœè¯­æ³•æ­£ç¡®åˆ™è¿›å…¥ä¼˜åŒ–å™¨ã€‚\n\n*   **ä¼˜åŒ–å™¨**å¯¹æŸ¥è¯¢è¯­å¥è¿›è¡Œä¼˜åŒ–å¤„ç†ï¼Œä¾‹å¦‚ä¸€ä¸ªè¡¨é‡Œé¢æœ‰å¤šä¸ªç´¢å¼•ï¼Œä¼˜åŒ–å™¨ä¼šåˆ¤åˆ«å“ªä¸ªç´¢å¼•æ€§èƒ½æ›´å¥½ã€‚\n\n*   ä¼˜åŒ–å™¨æ‰§è¡Œå®Œå°±è¿›å…¥**æ‰§è¡Œå™¨**ï¼Œå¼€å§‹æ‰§è¡ŒæŸ¥è¯¢è¯­å¥ç›´åˆ°æŸ¥è¯¢å‡ºæ»¡è¶³æ¡ä»¶çš„æ‰€æœ‰æ•°æ®ï¼Œç„¶åè¿›è¡Œè¿”å›ã€‚\n\n### MySQL æŸ¥è¯¢ç¼“å­˜çš„åŠŸèƒ½æœ‰ä½•ä¼˜ç¼ºç‚¹ï¼Ÿ\n\nä¼˜ç‚¹æ˜¯æ•ˆç‡é«˜ï¼Œå¦‚æœå·²ç»æœ‰ç¼“å­˜åˆ™ä¼šç›´æ¥è¿”å›ç»“æœã€‚ \n\nä½†æ˜¯ï¼Œå¦‚æœæ•°æ®åº“è¡¨ä¸­æ•°æ®å’Œç»“æ„å‘ç”Ÿå˜åŒ–æ—¶ï¼ˆå¢åˆ æ”¹ã€è¡¨ç»“æ„è°ƒæ•´ï¼‰ï¼ŒæŸ¥è¯¢ç¼“å­˜å°†ä¼šå¤±æ•ˆå¹¶è¢«æ¸…é™¤ï¼Œå¯¼è‡´ç¼“å­˜å‘½ä¸­ç‡æ¯”è¾ƒä½ã€‚\n\n### MySQL çš„å¸¸ç”¨å¼•æ“éƒ½æœ‰å“ªäº›ï¼Ÿ\n\nMySQL çš„å¸¸ç”¨å¼•æ“æœ‰ InnoDBã€MyISAMã€Memoryï¼ˆæ‰€æœ‰æ•°æ®æ”¾åœ¨å†…å­˜ä¸­ï¼‰ ç­‰ï¼Œä» MySQL 5.5.5 ç‰ˆæœ¬å¼€å§‹ InnoDB å°±æˆä¸ºäº†é»˜è®¤çš„å­˜å‚¨å¼•æ“ã€‚\n\n### MySQL å¯ä»¥é’ˆå¯¹è¡¨çº§åˆ«è®¾ç½®æ•°æ®åº“å¼•æ“å—ï¼Ÿæ€ä¹ˆè®¾ç½®ï¼Ÿ\n\nå¯ä»¥é’ˆå¯¹ä¸åŒçš„è¡¨è®¾ç½®ä¸åŒçš„å¼•æ“ã€‚åœ¨ create table è¯­å¥ä¸­ä½¿ç”¨ engine=å¼•æ“åï¼ˆæ¯”å¦‚ Memoryï¼‰æ¥è®¾ç½®æ­¤è¡¨çš„å­˜å‚¨å¼•æ“ã€‚\n\n###  InnoDB v.s. MyISAM\n\n* æœ€å¤§çš„åŒºåˆ«æ˜¯ InnoDB æ”¯æŒ**äº‹åŠ¡**ï¼Œè€Œ MyISAM ä¸æ”¯æŒäº‹åŠ¡ï¼›\n\n* InnoDB æ”¯æŒ**å´©æºƒåå®‰å…¨æ¢å¤**ï¼ŒMyISAM ä¸æ”¯æŒå´©æºƒåå®‰å…¨æ¢å¤ï¼›\n* InnoDB æ”¯æŒ**è¡Œé”**ï¼ŒMyISAM ä¸æ”¯æŒè¡Œé”ï¼Œåªæ”¯æŒè¡¨é”ï¼›\n* InnoDB æ”¯æŒ**å¤–é”®**ï¼ŒMyISAM ä¸æ”¯æŒå¤–é”®ï¼›\n\n### InnoDB æœ‰å“ªäº›ç‰¹æ€§ï¼Ÿ\n\n**1ï¼‰æ’å…¥ç¼“å†²(insert buffer)**ï¼šæ’å…¥ç¼“å†²å¸¦æ¥çš„æ˜¯**æ€§èƒ½**ã€‚å¯¹äºéèšé›†ç´¢å¼•çš„æ’å…¥å’Œæ›´æ–°ï¼Œä¸æ˜¯æ¯ä¸€æ¬¡ç›´æ¥æ’å…¥ç´¢å¼•é¡µä¸­ï¼Œè€Œæ˜¯é¦–å…ˆåˆ¤æ–­æ’å…¥çš„éèšé›†ç´¢å¼•é¡µæ˜¯å¦åœ¨ç¼“å†²æ± ä¸­ï¼Œå¦‚æœåœ¨ï¼Œåˆ™ç›´æ¥æ’å…¥ï¼Œå¦åˆ™ï¼Œå…ˆæ”¾å…¥ä¸€ä¸ªæ’å…¥ç¼“å†²åŒºä¸­ã€‚å¥½ä¼¼æ¬ºéª—æ•°æ®åº“è¿™ä¸ªéèšé›†çš„ç´¢å¼•å·²ç»æ’å…¥åˆ°å¶å­èŠ‚ç‚¹äº†ï¼Œç„¶åå†ä»¥ä¸€å®šçš„é¢‘ç‡æ‰§è¡Œæ’å…¥ç¼“å†²å’Œéèšé›†ç´¢å¼•å¶å­èŠ‚ç‚¹çš„åˆå¹¶æ“ä½œï¼Œè¿™æ—¶é€šå¸¸èƒ½å°†å¤šä¸ªæ’å…¥åˆå¹¶åˆ°ä¸€ä¸ªæ“ä½œä¸­ï¼Œè¿™å°±å¤§å¤§æé«˜äº†å¯¹éèšé›†ç´¢å¼•æ‰§è¡Œæ’å…¥å’Œä¿®æ”¹æ“ä½œçš„æ€§èƒ½ã€‚ï¼ˆ**å¯¹äºéèšé›†ç´¢å¼•é¡µï¼Œä¸æ˜¯ç›´æ¥æ”¾åˆ°ç´¢å¼•é¡µä¸­ï¼Œè€Œæ˜¯å…ˆæ”¾åˆ°ç¼“å†²æ± ä¸­ï¼Œè¿™æ—¶å€™ç¼“å†²æ± ä¸­å¯èƒ½å­˜æ”¾äº†å¤šä¸ªéèšé›†ç´¢å¼•é¡µï¼Œç„¶åå°†è¿™å¤šä¸ªéèšé›†ç´¢å¼•é¡µçš„æ’å…¥åˆå¹¶åˆ°ä¸€ä¸ªæ“ä½œä¸­ï¼Œå–ä»£äº†ä¹‹å‰çš„ä¸€ä¸ªä¸€ä¸ªæ’å…¥**ï¼‰\n\n**2ï¼‰ä¸¤æ¬¡å†™(double write)**ï¼šä¸¤æ¬¡å†™å¸¦æ¥çš„æ˜¯**å¯é æ€§**ï¼Œä¸»è¦ç”¨æ¥è§£å†³éƒ¨åˆ†å†™å¤±è´¥ã€‚doublewrite ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œä¸€éƒ¨åˆ†æ˜¯å†…å­˜ä¸­çš„ doublewrite buffer ï¼Œå¤§å°ä¸º 2Mï¼Œå¦å¤–ä¸€éƒ¨åˆ†å°±æ˜¯ç‰©ç†ç£ç›˜ä¸Šçš„å…±äº«è¡¨ç©ºé—´ä¸­è¿ç»­çš„ 128 ä¸ªé¡µï¼Œå³ä¸¤ä¸ªåŒºï¼Œå¤§å°åŒæ ·ä¸º 2Mã€‚å½“ç¼“å†²æ± çš„ä½œä¸šåˆ·æ–°æ—¶ï¼Œå¹¶ä¸ç›´æ¥å†™ç¡¬ç›˜ï¼Œè€Œæ˜¯é€šè¿‡ memcpy å‡½æ•°å°†è„é¡µå…ˆæ‹·è´åˆ°å†…å­˜ä¸­çš„ doublewrite bufferï¼Œä¹‹åé€šè¿‡ doublewrite buffer å†åˆ†ä¸¤æ¬¡å†™ï¼Œæ¯æ¬¡å†™å…¥ 1M åˆ°å…±äº«è¡¨ç©ºé—´çš„ç‰©ç†ç£ç›˜ä¸Šï¼Œç„¶åé©¬ä¸Šè°ƒç”¨ fsync å‡½æ•°ï¼ŒåŒæ­¥ç£ç›˜ã€‚**ï¼ˆè¦è¿›è¡Œå†™æ“ä½œæ—¶ï¼Œä¸æ˜¯ç›´æ¥å†™ç¡¬ç›˜ï¼Œè€Œæ˜¯å†™æ‹·è´åˆ°å†…å­˜ä¸­çš„ä¸¤æ¬¡å†™ç¼“å†²åŒºå¤§å°2Mï¼Œç„¶åæŠŠä¸¤æ¬¡å†™ç¼“å†²åŒºçš„å†…å®¹åˆ†ä¸¤æ¬¡å†™ï¼ˆæ¯æ¬¡å†™1Mï¼‰åˆ°å…±äº«è¡¨ç©ºé—´çš„ç£ç›˜ä¸Šï¼Œç„¶åå†å°†å…±äº«è¡¨ç©ºé—´çš„å†…å®¹åŒæ­¥åˆ°æ•°æ®æ–‡ä»¶ä¸Šï¼‰**\n\n![ä¸¤æ¬¡å†™](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes11474088-ad3fb88b0ef6d41d.png) \n\n**3ï¼‰è‡ªé€‚åº”å“ˆå¸Œç´¢å¼•(adaptive hash index)**ï¼šç”±äº InnoDB ä¸æ”¯æŒ hash ç´¢å¼•ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ hash ç´¢å¼•çš„æ•ˆç‡å¾ˆé«˜ï¼Œäºæ˜¯å‡ºç°äº† adaptive hash index åŠŸèƒ½ï¼Œ InnoDB å­˜å‚¨å¼•æ“ä¼šç›‘æ§å¯¹è¡¨ä¸Šç´¢å¼•çš„æŸ¥æ‰¾ï¼Œå¦‚æœè§‚å¯Ÿåˆ°å»ºç«‹ hash ç´¢å¼•å¯ä»¥æé«˜æ€§èƒ½çš„æ—¶å€™ï¼Œåˆ™è‡ªåŠ¨å»ºç«‹ hash ç´¢å¼•ã€‚**ï¼ˆä¸ºäº†æé«˜æ€§èƒ½ä¼šè‡ªåŠ¨å»ºç«‹ä¸€äº› hash ç´¢å¼•ï¼ŒæŸ¥æ‰¾æ•ˆç‡å¾ˆé«˜ï¼Œç›´æ¥é€šè¿‡ hash å€¼å®šä½åˆ°æ•°æ®ï¼‰**\n\n### ä¸€å¼ è‡ªå¢è¡¨ä¸­æœ‰ä¸‰æ¡æ•°æ®ï¼Œåˆ é™¤äº†ä¸¤æ¡æ•°æ®ä¹‹åé‡å¯æ•°æ®åº“ï¼Œå†æ–°å¢ä¸€æ¡æ•°æ®ï¼Œæ­¤æ—¶è¿™æ¡æ•°æ®çš„ ID æ˜¯å‡ ï¼Ÿ\n\n> ç­‰ä»·äºï¼šè‡ªå¢ä¸»é”®èƒ½ä¸èƒ½è¢«æŒä¹…åŒ–çš„é—®é¢˜ï¼Ÿ\n>\n> MyISAMï¼šè‡ªå¢ä¸»é”®ä¼šæŒä¹…åŒ–åˆ°æ•°æ®æ–‡ä»¶ä¸­\n>\n> InnoDBï¼š\n> \t5.7 ä»¥åŠä¹‹å‰ï¼šä¸ä¼šæŒä¹…åŒ–\n> \tä» 8 å¼€å§‹ï¼šè‡ªå¢ä¸»é”®ä¼šæŒä¹…åŒ–åˆ° redo log\n\n1. å¦‚æœè¡¨çš„å¼•æ“ç±»å‹æ˜¯ **MyISAM**ï¼Œé‚£ä¹ˆè¿™æ¡è®°å½•çš„ ID å°±æ˜¯ 4ã€‚å› ä¸º **MyISAMè¡¨ä¼šæŠŠè‡ªå¢ä¸»é”®çš„æœ€å¤§IDè®°å½•åˆ°æ•°æ®æ–‡ä»¶é‡Œé¢**ï¼Œé‡å¯ MySQL åï¼Œè‡ªå¢ä¸»é”®çš„æœ€å¤§ ID ä¹Ÿä¸ä¼šä¸¢å¤±ã€‚\n\n2. å¦‚æœè¡¨çš„å¼•æ“ç±»å‹æ˜¯ **InnoDB**ï¼Œé‚£ä¹ˆè¿™æ¡è®°å½•çš„ ID å°±æ˜¯ 2ã€‚å› ä¸º **InnoDBè¡¨æŠŠè‡ªå¢ä¸»é”®çš„æœ€å¤§IDè®°å½•åˆ°å†…å­˜ä¸­**ï¼Œæ‰€ä»¥é‡å¯æ•°æ®åº“åä¼šä½¿æœ€å¤§ IDï¼ˆå…¶å®æ˜¯ AUTO_INCREMENT è®¡æ•°å™¨çš„å€¼ï¼‰ä¸¢å¤±ï¼›ä¸€æ—¦æ•°æ®åº“é‡æ–°è¿è¡Œï¼Œæ•°æ®åº“ä¼šè‡ªåŠ¨è®¡ç®—è‡ªå¢ä¸»é”®çš„æœ€å¤§ IDï¼ˆ**å…¶å®å°±æ˜¯æŠŠæœ€åä¸€æ¡è®°å½• ID åŠ  1 å¹¶èµ‹å€¼ç»™ AUTO_INCREMENT**ï¼‰å†æ¬¡æ”¾å…¥åˆ°å†…å­˜ä¸­ã€‚\n\n\tã€æ³¨ã€‘**è¿™ä»…ä»…æ˜¯ MySQL 8 ä»¥å‰çš„ç‰ˆæœ¬ï¼Œä¹Ÿå°±æ˜¯ MySQL 5.7 ä»¥åŠä¹‹å‰çš„ç‰ˆæœ¬**ã€‚å› ä¸ºåœ¨ MySQL 8.0 ä¸­ï¼Œ**InnoDB çš„è¡Œä¸ºå·²æ›´æ”¹**ã€‚æ¯æ¬¡æ›´æ”¹æ—¶ï¼Œå½“å‰æœ€å¤§è‡ªåŠ¨å¢é‡è®¡æ•°å™¨å€¼ï¼ˆAUTO_INCREMENTï¼‰éƒ½ä¼šå†™å…¥é‡åšæ—¥å¿— redo logï¼Œå¹¶ä¿å­˜åˆ°æ¯ä¸ªæ£€æŸ¥ç‚¹çš„å¼•æ“ä¸“ç”¨ç³»ç»Ÿè¡¨ä¸­ã€‚è¿™äº›æ›´æ”¹ä½¿å½“å‰çš„æœ€å¤§è‡ªåŠ¨å¢é‡è®¡æ•°å™¨å€¼åœ¨æœåŠ¡å™¨é‡æ–°å¯åŠ¨åä¿æŒä¸å˜ï¼Œä¸ **MyISAM** ä¸€æ ·äº†ã€‚è¯¦è§å®˜æ–¹æ–‡æ¡£ï¼š[InnoDB AUTO_INCREMENT è®¡æ•°å™¨åˆå§‹åŒ–](https://dev.mysql.com/doc/refman/8.0/en/innodb-auto-increment-handling.html#innodb-auto-increment-initialization)\n\n\tã€æ³¨ã€‘å¦‚æœåˆ é™¤çš„ä¸æ˜¯æœ€åçš„è®°å½•ï¼Œé‚£ä¹ˆè‡ªå¢çš„æœ€å¤§ ID å…¨éƒ¨éƒ½ä¸€æ ·ï¼Œå› ä¸ºè‡ªåŠ¨å¢é‡è®¡æ•°å™¨å€¼ï¼ˆAUTO_INCREMENTï¼‰ä¸ä¼šæ”¹å˜ã€‚\n\n### MySQL ä¸­ä»€ä¹ˆæƒ…å†µä¼šå¯¼è‡´è‡ªå¢ä¸»é”®ä¸èƒ½è¿ç»­ï¼Ÿ\n\n> 1. å”¯ä¸€é”®å†²çª\n> 2. äº‹åŠ¡å›æ»š\n\n*   æ‰§è¡Œå™¨æ‰§è¡Œæ’å…¥ï¼Œè‡ªå¢é”®+1ï¼Œä½†æ˜¯ innoDB å‘ç°æ’å…¥æ—¶**å”¯ä¸€é”®å†²çª**ï¼Œæ— æ³•æ’å…¥ï¼Œå¯¼è‡´çš„ä¸è¿ç»­ã€‚\n\n*   äº‹åŠ¡æ·»åŠ è‡ªå¢é”®+1ï¼Œä½†æ˜¯ç”±äº**äº‹åŠ¡å›æ»š**ï¼Œæ•°æ®è¢«æ¸…é™¤ï¼Œå¯¼è‡´çš„ä¸è¿ç»­ã€‚\n\n### ä»€ä¹ˆæ˜¯è¦†ç›–ç´¢å¼•ï¼Ÿ\n\nè¦†ç›–ç´¢å¼•æ˜¯æŒ‡ï¼Œç´¢å¼•ä¸Šçš„ä¿¡æ¯è¶³å¤Ÿæ»¡è¶³æŸ¥è¯¢è¯·æ±‚ï¼Œä¸éœ€è¦å†å›åˆ°ä¸»é”®ä¸Šå»å–æ•°æ®å³å›è¡¨ã€‚\n\n### å¦‚æœæŠŠä¸€ä¸ª InnoDB è¡¨çš„ä¸»é”®åˆ æ‰ï¼Œæ˜¯ä¸æ˜¯å°±æ²¡æœ‰ä¸»é”®ï¼Œå°±æ²¡åŠæ³•è¿›è¡Œå›è¡¨æŸ¥è¯¢äº†ï¼Ÿ\n\nå¦‚æœæŠŠä¸»é”®åˆ æ‰äº†ï¼Œé‚£ä¹ˆ InnoDB ä¼šè‡ªå·±ç”Ÿæˆä¸€ä¸ªé•¿åº¦ä¸º 6 å­—èŠ‚çš„ rowid ä½œä¸ºä¸»é”®ã€‚\n\n### å†…å­˜è¡¨å’Œä¸´æ—¶è¡¨æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\nå†…å­˜è¡¨ï¼ŒæŒ‡çš„æ˜¯ä½¿ç”¨ Memory å¼•æ“çš„è¡¨ï¼Œæ•°æ®æ”¾åœ¨å†…å­˜ä¸­ï¼Œé‡å¯ä¼šè¢«æ¸…ç©ºï¼›\n\nä¸´æ—¶è¡¨ï¼ŒæŒ‡çš„æ˜¯ä½¿ç”¨ InnoDB å¼•æ“æˆ–è€… MyISAM å¼•æ“çš„è¡¨ï¼Œæ•°æ®æ”¾åœ¨ç£ç›˜ä¸Šï¼Œé‡å¯ä¸ä¼šæ¸…ç©ºã€‚\n\n### MySQL ä¸­çš„å­—ç¬¦ä¸²ç±»å‹éƒ½æœ‰å“ªäº›ï¼Ÿ\n\n| **ç±»å‹**     | **å–å€¼èŒƒå›´**              |\n| ------------ | ------------------------- |\n| CHAR(N)      | 0~255                     |\n| VARCHAR(N)   | 0~65536                   |\n| TINYBLOB     | 0~255                     |\n| BLOB         | 0~65535                   |\n| MEDUIMBLOB   | 0~167772150               |\n| LONGBLOB     | 0~4294967295              |\n| TINYTEXT     | 0~255                     |\n| TEXT         | 0~65535                   |\n| MEDIUMTEXT   | 0~167772150               |\n| LONGTEXT     | 0~4294967295              |\n| VARBINARY(N) | 0~Nä¸ªå­—èŠ‚çš„å˜é•¿å­—èŠ‚å­—ç¬¦é›† |\n| BINARY(N)    | 0~Nä¸ªå­—èŠ‚çš„å®šé•¿å­—èŠ‚å­—ç¬¦é›† |\n\n### VARCHAR å’Œ CHAR çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿåˆ†åˆ«é€‚ç”¨çš„åœºæ™¯æœ‰å“ªäº›ï¼Ÿ\n\nVARCHAR çš„é•¿åº¦æ˜¯å¯å˜çš„ï¼Œè€Œ CHAR æ˜¯å›ºå®šé•¿åº¦ã€‚ç”±äºå®ƒä»¬çš„ç‰¹æ€§å†³å®šäº† CHAR æ¯”è¾ƒé€‚åˆé•¿åº¦è¾ƒçŸ­çš„å­—æ®µå’Œå›ºå®šé•¿åº¦çš„å­—æ®µï¼Œå¦‚èº«ä»½è¯å·ã€æ‰‹æœºå·ç­‰ï¼Œåä¹‹åˆ™é€‚åˆä½¿ç”¨ VARCHARã€‚\n\n### MySQL å­˜å‚¨é‡‘é¢åº”è¯¥ä½¿ç”¨å“ªç§æ•°æ®ç±»å‹ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ\n\nMySQL å­˜å‚¨é‡‘é¢åº”è¯¥ä½¿ç”¨ `decimal` ï¼Œå› ä¸ºå¦‚æœå­˜å‚¨å…¶ä»–æ•°æ®ç±»å‹ï¼Œæ¯”å¦‚ `float` æœ‰å¯¼è‡´å°æ•°ç‚¹åæ•°æ®ä¸¢å¤±çš„é£é™©ã€‚\n\n### limit 3,2 çš„å«ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿ\n\nå»é™¤å‰ä¸‰æ¡æ•°æ®ä¹‹åæŸ¥è¯¢ä¸¤æ¡ä¿¡æ¯ã€‚\n\n### *lastinsertid()* å‡½æ•°åŠŸèƒ½æ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ\n\n*lastinsertid()* ç”¨äºæŸ¥è¯¢æœ€åä¸€æ¬¡è‡ªå¢è¡¨çš„ç¼–å·ï¼ˆå…¨å±€çš„ï¼‰ï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯æŸ¥è¯¢æ—¶ä¸éœ€è¦æŒ‡å®šè¡¨åï¼Œä½¿ç”¨ `select last_insert_id()` å³å¯æŸ¥è¯¢ï¼Œå› ä¸ºä¸éœ€è¦æŒ‡å®šè¡¨åæ‰€ä»¥å®ƒå§‹ç»ˆä»¥æœ€åä¸€æ¡è‡ªå¢ç¼–å·ä¸ºä¸»ï¼Œå¯ä»¥è¢«å…¶å®ƒè¡¨çš„è‡ªå¢ç¼–å·è¦†ç›–ã€‚æ¯”å¦‚ A è¡¨çš„æœ€å¤§ç¼–å·æ˜¯ 10ï¼Œ *lastinsertid()* æŸ¥è¯¢å‡ºæ¥çš„å€¼ä¸º 10ï¼Œè¿™æ—¶ B è¡¨æ’å…¥äº†ä¸€æ¡æ•°æ®ï¼Œå®ƒçš„æœ€å¤§ç¼–å·ä¸º 3ï¼Œè¿™ä¸ªæ—¶å€™ä½¿ç”¨ *lastinsertid()* æŸ¥è¯¢çš„å€¼å°±æ˜¯ 3ã€‚\n\n### åˆ é™¤è¡¨çš„æ•°æ®æœ‰å‡ ç§æ–¹å¼ï¼Ÿå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\nåˆ é™¤æ•°æ®æœ‰ä¸¤ç§æ–¹å¼ï¼šdelete å’Œ truncateï¼Œå®ƒä»¬çš„åŒºåˆ«å¦‚ä¸‹ï¼š\n\n*   delete å¯ä»¥æ·»åŠ  where æ¡ä»¶åˆ é™¤éƒ¨åˆ†æ•°æ®ï¼Œtruncate ä¸èƒ½æ·»åŠ  where æ¡ä»¶åªèƒ½åˆ é™¤æ•´å¼ è¡¨ï¼›\n\n*   delete çš„åˆ é™¤ä¿¡æ¯ä¼šåœ¨ MySQL çš„æ—¥å¿—ä¸­è®°å½•ï¼Œè€Œ truncate çš„åˆ é™¤ä¿¡æ¯ä¸è¢«è®°å½•åœ¨ MySQL çš„æ—¥å¿—ä¸­ï¼Œ\n\tå› æ­¤ detele çš„ä¿¡æ¯å¯ä»¥è¢«æ‰¾å›è€Œ truncate çš„ä¿¡æ¯æ— æ³•è¢«æ‰¾å›ï¼›\n\n*   truncate å› ä¸ºä¸è®°å½•æ—¥å¿—æ‰€ä»¥æ‰§è¡Œæ•ˆç‡æ¯” delete å¿«ã€‚\n\n### MySQL ä¸­æ”¯æŒå‡ ç§æ¨¡ç³ŠæŸ¥è¯¢ï¼Ÿå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\nMySQL ä¸­æ”¯æŒä¸¤ç§æ¨¡ç³ŠæŸ¥è¯¢ï¼šregexp å’Œ like\nlike æ˜¯å¯¹ä»»æ„å¤šå­—ç¬¦åŒ¹é…æˆ–ä»»æ„å•å­—ç¬¦è¿›è¡Œæ¨¡ç³ŠåŒ¹é…ï¼Œ\nè€Œ regexp åˆ™æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…æ–¹å¼ï¼Œæä¾›æ¯” like æ›´å¤šçš„åŒ¹é…æ–¹å¼ã€‚ \nregexp å’Œ like çš„ä½¿ç”¨ç¤ºä¾‹å¦‚ä¸‹ï¼š \n\n> select * from person where uname like '%SQL%';\n> select * from person where uname regexp '.SQL*.'; \n\n### *count(column)* å’Œ *count(\\*)* æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\n*count(column)* ç»Ÿè®¡ä¸ä¼šç»Ÿè®¡åˆ—å€¼ä¸º null çš„æ•°æ®ï¼Œ\nè€Œ *count(\\*)* åˆ™ä¼šç»Ÿè®¡æ‰€æœ‰ä¿¡æ¯ï¼Œæ‰€ä»¥æœ€ç»ˆçš„ç»Ÿè®¡ç»“æœå¯èƒ½ä¼šä¸åŒã€‚\n\n### ä¸ºä»€ä¹ˆ InnoDB ä¸æŠŠæ€»æ¡æ•°è®°å½•ä¸‹æ¥ï¼ŒæŸ¥è¯¢çš„æ—¶å€™ç›´æ¥è¿”å›å‘¢ï¼Ÿ\n\nå› ä¸º **InnoDB æ”¯æŒäº‹åŠ¡**ï¼Œå³ä½¿æ˜¯åœ¨åŒä¸€æ—¶é—´è¿›è¡ŒæŸ¥è¯¢ï¼Œå¾—åˆ°çš„ç»“æœä¹Ÿå¯èƒ½ä¸ç›¸åŒï¼Œæ‰€ä»¥ InnoDB ä¸èƒ½æŠŠç»“æœç›´æ¥ä¿å­˜ä¸‹æ¥ï¼Œå› ä¸ºè¿™æ ·æ˜¯ä¸å‡†ç¡®çš„ã€‚\n\n### InnoDB å’Œ MyISAM æ‰§è¡Œ select count(*) from tï¼Œå“ªä¸ªæ•ˆç‡æ›´é«˜ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ\n\nMyISAM æ•ˆç‡æœ€é«˜ï¼Œå› ä¸º MyISAM å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªè®¡æ•°å™¨ï¼Œç›´æ¥è¿”å›æ€»æ¡æ•°ï¼Œè€Œ InnoDB è¦é€è¡Œç»Ÿè®¡ã€‚\n\n### åœ¨ InnoDB å¼•æ“ä¸­ count(*)ã€count(1)ã€count(ä¸»é”®)ã€count(å­—æ®µ) å“ªä¸ªæ€§èƒ½æœ€é«˜ï¼Ÿ\n\ncount(å­—æ®µ)<count(ä¸»é”® id)<count(1)â‰ˆcount(*) é¢˜ç›®è§£æï¼š\n\n*   å¯¹äº count(å­—æ®µ) æ¥è¯´ï¼Œéå†æ•´å¼ è¡¨ï¼Œå–è¿™ä¸ªå­—æ®µï¼Œç„¶ååˆ¤æ–­æ˜¯å¦ä¸º nullï¼Œä¸ä¸º null åˆ™åŠ  1\n*   å¯¹äº count(ä¸»é”® id) æ¥è¯´ï¼Œéå†æ•´å¼ è¡¨ï¼Œå–ä¸»é”® idï¼Œä¸å¯èƒ½ä¸ºç©ºï¼Œæ¯æ¬¡åŠ  1ã€‚ä½†æ˜¯å¯èƒ½ä½¿ç”¨æœ€å°çš„ç´¢å¼•æ ‘ã€‚\n*   å¯¹äº count(1) æ¥è¯´ï¼Œéå†æ•´å¼ è¡¨ï¼Œä¸å–å€¼ã€‚1 æ˜¯ä¸å¯èƒ½ä¸ºç©ºçš„ï¼Œæ¯æ¬¡åŠ  1ã€‚\n*   å¯¹äº count(\\*) æ¥è¯´ï¼Œéå†æ•´å¼ è¡¨ï¼Œä¸å–å€¼ï¼Œç›´æ¥æŒ‰è¡Œç´¯åŠ ã€‚å®é™…ä¸Šï¼Œå½“ä½¿ç”¨ count(\\*) æ—¶ï¼ŒMySQL ä¼šå°† * å‚æ•°è½¬åŒ–ä¸ºå‚æ•° 0 æ¥å¤„ç†ã€‚\n\næ‰€ä»¥æœ€åå¾—å‡ºçš„ç»“æœæ˜¯ï¼šcount(å­—æ®µ)<count(ä¸»é”® id)<count(1)â‰ˆcount(*)ã€‚\n\n### MySQL ä¸­å†…è¿æ¥ã€å·¦è¿æ¥ã€å³è¿æ¥æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\n*   å†…è¿ï¼ˆinner joinï¼‰â€” æŠŠåŒ¹é…çš„å…³è”æ•°æ®æ˜¾ç¤ºå‡ºæ¥ï¼›\n\n*   å·¦è¿æ¥ï¼ˆleft joinï¼‰â€” æŠŠå·¦è¾¹çš„è¡¨å…¨éƒ¨æ˜¾ç¤ºå‡ºæ¥ï¼Œå³è¾¹çš„è¡¨æ˜¾ç¤ºå‡ºç¬¦åˆæ¡ä»¶çš„æ•°æ®ï¼›\n\n*   å³è¿æ¥ï¼ˆright joinï¼‰â€” æŠŠå³è¾¹çš„è¡¨å…¨éƒ¨æ˜¾ç¤ºå‡ºæ¥ï¼Œå·¦è¾¹çš„è¡¨æ˜¾ç¤ºå‡ºç¬¦åˆæ¡ä»¶çš„æ•°æ®ï¼›\n\n## MySQLç´¢å¼•ç¯‡\n\n### ä»€ä¹ˆæ˜¯ç´¢å¼•ï¼Ÿ  \n\nç´¢å¼•æ˜¯ä¸€ç§èƒ½å¸®åŠ© MySQL æé«˜æŸ¥è¯¢æ•ˆç‡çš„æ•°æ®ç»“æ„ã€‚\n\n### ç´¢å¼•åˆ†åˆ«æœ‰å“ªäº›ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Ÿ  \n\n**ç´¢å¼•çš„ä¼˜ç‚¹ï¼š**\n\n*   æé«˜æŸ¥è¯¢æ•ˆç‡\n\n\n**ç´¢å¼•çš„ç¼ºç‚¹ï¼š**\n\n*   è™½ç„¶æé«˜äº†æŸ¥è¯¢é€Ÿåº¦ï¼Œä½†å´é™ä½äº†æ›´æ–°è¡¨çš„é€Ÿåº¦ï¼Œæ¯”å¦‚ updateã€insertï¼›\n\tå› ä¸ºæ›´æ–°æ•°æ®æ—¶ï¼ŒMySQL ä¸ä»…è¦æ›´æ–°æ•°æ®ï¼Œè¿˜è¦æ›´æ–°ç´¢å¼•æ–‡ä»¶ï¼›\n\n*   å»ºç«‹ç´¢å¼•çš„ç´¢å¼•æ–‡ä»¶ä¼šå ç”¨ç£ç›˜ã€‚\n\n### MySQLç´¢å¼•çš„æ³¨æ„äº‹é¡¹\n\n**1ã€è”åˆç´¢å¼•éµå¾ªå‰ç¼€åŸåˆ™**\n\n**2ã€likeæ¨¡ç³ŠæŸ¥è¯¢ï¼Œ%ä¸èƒ½åœ¨å‰**\n\n**3ã€**åˆ—å€¼ä¸ºç©ºï¼ˆNULLï¼‰æ—¶æ˜¯å¯ä»¥ä½¿ç”¨ç´¢å¼•çš„ï¼Œä½† MySQL éš¾ä»¥ä¼˜åŒ–å¼•ç”¨äº†å¯ç©ºåˆ—çš„æŸ¥è¯¢,å®ƒä¼šä½¿ç´¢å¼•ã€ç´¢å¼•ç»Ÿè®¡å’Œå€¼æ›´åŠ å¤æ‚ã€‚å¯ç©ºåˆ—éœ€è¦æ›´å¤šçš„å‚¨å­˜ç©ºé—´ï¼Œè¿˜éœ€è¦åœ¨ MySQL å†…éƒ¨è¿›è¡Œç‰¹æ®Šå¤„ç†ã€‚\n\n**4ã€** å¦‚æœ MySQL ä¼°è®¡ä½¿ç”¨ç´¢å¼•æ¯”å…¨è¡¨æ‰«ææ›´æ…¢ï¼Œä¼šæ”¾å¼ƒä½¿ç”¨ç´¢å¼•ï¼Œä¾‹å¦‚ï¼š\nè¡¨ä¸­åªæœ‰ 100 æ¡æ•°æ®å·¦å³ã€‚å¯¹äº SQL è¯­å¥ WHERE id > 1 AND id < 100ï¼ŒMySQL ä¼šä¼˜å…ˆè€ƒè™‘å…¨è¡¨æ‰«æã€‚\n\n**5ã€** **å¦‚æœå…³é”®è¯orå‰é¢çš„æ¡ä»¶ä¸­çš„åˆ—æœ‰ç´¢å¼•ï¼Œåé¢çš„æ²¡æœ‰ï¼Œæ‰€æœ‰åˆ—çš„ç´¢å¼•éƒ½ä¸ä¼šè¢«ç”¨åˆ°ã€‚**\n\n**6ã€** åˆ—ç±»å‹æ˜¯å­—ç¬¦ä¸²ï¼ŒæŸ¥è¯¢æ—¶ä¸€å®šè¦ç»™å€¼åŠ å¼•å·ï¼Œå¦åˆ™ç´¢å¼•å¤±æ•ˆï¼Œä¾‹å¦‚ï¼š\nåˆ— name varchar(16)ï¼Œå­˜å‚¨äº†å­—ç¬¦ä¸²\"100\"\nWHERE name = 100;  ï¼ˆåšäº†è‡ªåŠ¨ç±»å‹è½¬æ¢ï¼‰\nä»¥ä¸Š SQL è¯­å¥èƒ½æœåˆ°ï¼Œä½†æ— æ³•ç”¨åˆ°ç´¢å¼•ã€‚\n\n**7ã€ä¸åœ¨ç´¢å¼•åˆ—ä¸Šåšä»»ä½•æ“ä½œï¼ˆè®¡ç®—ã€å‡½æ•°ã€ï¼ˆè‡ªåŠ¨æˆ–æ‰‹åŠ¨ï¼‰ç±»å‹è½¬æ¢ï¼‰ï¼Œä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆè€Œè½¬å‘å…¨è¡¨æ‰«æ** \n\n### ä¸ºä»€ä¹ˆ MySQL å®˜æ–¹å»ºè®®ä½¿ç”¨è‡ªå¢ä¸»é”®ä½œä¸ºè¡¨çš„ä¸»é”®ï¼Ÿ \n\nä¼˜ç‚¹ï¼š\n\n1. é¡µåˆ†è£‚é—®é¢˜ã€‚å¦‚æœä½¿ç”¨éè‡ªå¢ä¸»é”®ä½œä¸ºè¡¨çš„ä¸»é”®çš„è¯ï¼Œå½“æ–°æ’å…¥çš„æ•°æ®ä¼šå°†æ•°æ®é¡µå†™æ»¡ï¼Œmysql å°±éœ€è¦ç”³è¯·æ–°çš„æ•°æ®é¡µï¼Œå¹¶ä¸”æŠŠä¸Šä¸ªæ•°æ®é¡µä¸­çš„éƒ¨åˆ†æ•°æ®æŒªåˆ°æ–°çš„æ•°æ®é¡µä¸Šï¼Œä»¥ç¡®ä¿ç´¢å¼•æœ‰åºã€‚ä¹Ÿå°±æ˜¯è¯´é€ æˆäº†é¡µåˆ†è£‚ï¼Œå¤§é‡ç§»åŠ¨æ•°æ®çš„è¿‡ç¨‹ä¸¥é‡å½±å“æ’å…¥æ•ˆç‡ã€‚\n\n2. å­˜å‚¨ç©ºé—´é—®é¢˜ã€‚è‡ªå¢ä¸»é”®å­˜å‚¨ç©ºé—´å°ï¼ŒåŒä¸€ä¸ªç»“ç‚¹å†…èƒ½å­˜æ”¾æ›´å¤šçš„ä¸»é”®ï¼Œæ ‘çš„é«˜åº¦å¯èƒ½é™ä½ï¼Œå‡å°‘ io æ¬¡æ•°ã€‚\n\nç¼ºç‚¹ï¼š\n\n1. æ•°æ®é‡è¿‡å¤§ï¼Œå¯èƒ½ä¼šè¶…å‡ºè‡ªå¢é•¿å–å€¼èŒƒå›´ï¼›\n2. æ— æ³•æ»¡è¶³åˆ†å¸ƒå¼å­˜å‚¨ï¼Œåˆ†åº“åˆ†è¡¨çš„æƒ…å†µä¸‹æ— æ³•åˆå¹¶è¡¨ï¼›\n3. ä¸»é”®æœ‰è‡ªå¢è§„å¾‹ï¼Œå®¹æ˜“è¢«ç ´è§£ï¼›\n\n**ç»¼ä¸Šæ‰€è¿°ï¼š**æ˜¯å¦éœ€è¦ä½¿ç”¨è‡ªå¢ä¸»é”®ï¼Œéœ€è¦æ ¹æ®è‡ªå·±çš„ä¸šåŠ¡åœºæ™¯æ¥è®¾è®¡ã€‚å¦‚æœæ˜¯å•è¡¨å•åº“ï¼Œåˆ™ä¼˜å…ˆè€ƒè™‘è‡ªå¢ä¸»é”®ï¼Œå¦‚æœæ˜¯åˆ†å¸ƒå¼å­˜å‚¨ï¼Œåˆ†åº“åˆ†è¡¨ï¼Œåˆ™éœ€è¦è€ƒè™‘æ•°æ®åˆå¹¶çš„ä¸šåŠ¡åœºæ™¯æ¥åšæ•°æ®åº“è®¾è®¡æ–¹æ¡ˆã€‚\n\n### ç´¢å¼•æœ‰å‡ ç§ç±»å‹ï¼Ÿåˆ†åˆ«å¦‚ä½•åˆ›å»ºï¼Ÿ  \n\n**MySQL çš„ç´¢å¼•æœ‰ä¸¤ç§åˆ†ç±»æ–¹å¼ï¼šé€»è¾‘åˆ†ç±»å’Œç‰©ç†åˆ†ç±»ã€‚ **\n\n**æŒ‰ç…§é€»è¾‘åˆ†ç±»ï¼Œç´¢å¼•å¯åˆ†ä¸ºï¼š**\n\n*   ä¸»é”®ç´¢å¼•ï¼šä¸€å¼ è¡¨åªèƒ½æœ‰ä¸€ä¸ªä¸»é”®ç´¢å¼•ï¼Œä¸å…è®¸é‡å¤ã€ä¸å…è®¸ä¸º NULLï¼›\n*   å”¯ä¸€ç´¢å¼•ï¼šæ•°æ®åˆ—ä¸å…è®¸é‡å¤ï¼Œå…è®¸ä¸º NULL å€¼ï¼Œä¸€å¼ è¡¨å¯æœ‰å¤šä¸ªå”¯ä¸€ç´¢å¼•ï¼Œä½†æ˜¯ä¸€ä¸ªå”¯ä¸€ç´¢å¼•åªèƒ½åŒ…å«ä¸€åˆ—ï¼Œæ¯”å¦‚èº«ä»½è¯å·ç ã€å¡å·ç­‰éƒ½å¯ä»¥ä½œä¸ºå”¯ä¸€ç´¢å¼•ï¼›\n*   æ™®é€šç´¢å¼•ï¼šä¸€å¼ è¡¨å¯ä»¥åˆ›å»ºå¤šä¸ªæ™®é€šç´¢å¼•ï¼Œä¸€ä¸ªæ™®é€šç´¢å¼•å¯ä»¥åŒ…å«å¤šä¸ªå­—æ®µï¼Œå…è®¸æ•°æ®é‡å¤ï¼Œå…è®¸ NULL å€¼æ’å…¥ï¼›\n\n**æŒ‰ç…§ç‰©ç†åˆ†ç±»ï¼Œç´¢å¼•å¯åˆ†ä¸ºï¼š**\n\n*   èšç°‡ç´¢å¼•ï¼šInnoDB çš„ä¸»é”®ç´¢å¼•å­˜å‚¨é‡‡ç”¨èšç°‡ç´¢å¼•ï¼Œä¸»é”®å€¼å’Œæ•°æ®å­˜æ”¾åœ¨ä¸€èµ·\n*   éèšç°‡ç´¢å¼•ï¼šMyISAM çš„ä¸»é”®ç´¢å¼•å­˜å‚¨é‡‡ç”¨éèšç°‡ç´¢å¼•ï¼Œä¸»é”®å€¼å’ŒæŒ‡å‘æ•°æ®çš„æŒ‡é’ˆå­˜æ”¾åœ¨ä¸€èµ·ï¼Œæ•°æ®å¦å¼€ç©ºé—´å­˜å‚¨\n\n**å„ç§ç´¢å¼•çš„åˆ›å»ºè„šæœ¬å¦‚ä¸‹ï¼š**\n\n```sql\n-- åˆ›å»ºä¸»é”®ç´¢å¼•\nALTER TABLE user ADD PRIMARY KEY (column_list);\n-- åˆ›å»ºå”¯ä¸€ç´¢å¼•\nALTER TABLE user ADD UNIQUE index_name (column_list);\n-- åˆ›å»ºæ™®é€šç´¢å¼•\nALTER TABLE user ADD INDEX index_name (column_list);\n-- åˆ›å»ºå…¨æ–‡ç´¢å¼•\nALTER TABLE user ADD FULLTEXT index_name (column_list);\n```\n\n### ä»€ä¹ˆå«å›è¡¨æŸ¥è¯¢ï¼Ÿ  \n\næ™®é€šç´¢å¼•æŸ¥è¯¢åˆ°ä¸»é”®ç´¢å¼•åï¼Œå›åˆ°ä¸»é”®ç´¢å¼•æ ‘æœç´¢çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬ç§°ä¸ºå›è¡¨æŸ¥è¯¢ã€‚\n\nä¹Ÿå°±æ˜¯è¯´ï¼ŒåŸºäºéä¸»é”®ç´¢å¼•çš„æŸ¥è¯¢éœ€è¦å¤šæ‰«æä¸€æ¬¡ä¸»é”®ç´¢å¼•æ ‘ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨åº”ç”¨ä¸­åº”è¯¥å°½é‡ä½¿ç”¨ä¸»é”®æŸ¥è¯¢ã€‚\n\nä¾‹å¤–å°±æ˜¯ä½¿ç”¨éä¸»é”®ç´¢å¼•æ—¶ï¼Œå¦‚æœå½“å‰ç´¢å¼•æ»¡è¶³æŸ¥è¯¢éœ€æ±‚ï¼Œåˆ™ä¸ç”¨å›è¡¨ã€‚\n\n### åœ¨ InnDB ä¸­ä¸»é”®ç´¢å¼•ä¸ºä»€ä¹ˆæ¯”æ™®é€šç´¢å¼•çš„æŸ¥è¯¢æ€§èƒ½é«˜ï¼Ÿ  \n\nå›è¡¨ã€‚å› ä¸ºæ™®é€šç´¢å¼•çš„æŸ¥è¯¢ä¼šå¤šæ‰§è¡Œä¸€æ¬¡æ£€ç´¢æ“ä½œã€‚æ¯”å¦‚ä¸»é”®æŸ¥è¯¢ select * from t where id=10 åªéœ€è¦æœç´¢ id çš„è¿™æ£µ B+ æ ‘ï¼Œè€Œæ™®é€šç´¢å¼•æŸ¥è¯¢ select * from t where f=3 ä¼šå…ˆæŸ¥è¯¢ f ç´¢å¼•æ ‘ï¼Œå¾—åˆ° id çš„å€¼ä¹‹åå†å»æœç´¢ id çš„ B+ æ ‘ï¼Œå› ä¸ºå¤šæ‰§è¡Œäº†ä¸€æ¬¡æ£€ç´¢ï¼Œæ‰€ä»¥æ‰§è¡Œæ•ˆç‡å°±æ¯”ä¸»é”®ç´¢å¼•è¦ä½ã€‚\n\n### MySQL å¤åˆç´¢å¼•åº”è¯¥æ³¨æ„ä»€ä¹ˆï¼Ÿ  \n\nMySQL ä¸­çš„å¤åˆç´¢å¼•ï¼Œéµå¾ªæœ€å·¦åŒ¹é…åŸåˆ™ï¼Œæ¯”å¦‚ï¼Œè”åˆç´¢å¼•ä¸º key(a,b,c)ï¼Œåˆ™èƒ½è§¦å‘ç´¢å¼•çš„æœç´¢ç»„åˆæ˜¯ a|ab|abc è¿™ä¸‰ç§æŸ¥è¯¢ã€‚\n\n### å¤åˆç´¢å¼•çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ  \n\n*   ç”¨äºå¤šå­—æ®µæŸ¥è¯¢ï¼Œæ¯”å¦‚ï¼Œå»ºäº†ä¸€ä¸ª key(a,b,c) çš„è”åˆç´¢å¼•ï¼Œé‚£ä¹ˆå®é™…ç­‰äºå»ºäº†`key(a)ã€key(a,b)ã€key(a,b,c)`ç­‰ä¸‰ä¸ªç´¢å¼•ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œæ¯å¤šä¸€ä¸ªç´¢å¼•ï¼Œå°±ä¼šå¤šä¸€äº›å†™æ“ä½œå’Œå ç”¨ç£ç›˜ç©ºé—´çš„å¼€é”€ï¼Œå°¤å…¶æ˜¯å¯¹å¤§æ•°æ®é‡çš„è¡¨æ¥è¯´ï¼Œè¿™å¯ä»¥å‡å°‘ä¸€éƒ¨åˆ†ä¸å¿…è¦çš„å¼€é”€ï¼›\n*   è¦†ç›–ç´¢å¼•ï¼Œæ¯”å¦‚ï¼Œå¯¹äºè”åˆç´¢å¼• key(a,b,c) æ¥è¯´ï¼Œå¦‚æœä½¿ç”¨ SQLï¼š`select a,b,c from table where a=1 and b = 1` ï¼Œå°±å¯ä»¥ç›´æ¥é€šè¿‡éå†ç´¢å¼•å–å¾—æ•°æ®ï¼Œè€Œ**æ— éœ€å›è¡¨æŸ¥è¯¢**ï¼Œè¿™å°±å‡å°‘äº†éšæœºçš„ IO æ“ä½œï¼Œå‡å°‘éšæœºçš„ IO æ“ä½œï¼Œå¯ä»¥æœ‰æ•ˆçš„æå‡æ•°æ®åº“æŸ¥è¯¢çš„æ€§èƒ½ï¼Œæ˜¯éå¸¸é‡è¦çš„æ•°æ®åº“ä¼˜åŒ–æ‰‹æ®µä¹‹ä¸€ï¼›\n*   ç´¢å¼•åˆ—è¶Šå¤šï¼Œé€šè¿‡ç´¢å¼•ç­›é€‰å‡ºçš„æ•°æ®è¶Šå°‘ã€‚  \n\n### ä»€ä¹ˆæ˜¯æœ€å·¦åŒ¹é…åŸåˆ™ï¼Ÿå®ƒçš„ç”Ÿæ•ˆåŸåˆ™æœ‰å“ªäº›ï¼Ÿ  \n\næœ€å·¦åŒ¹é…åŸåˆ™ä¹Ÿå«æœ€å·¦å‰ç¼€åŸåˆ™ï¼Œæ˜¯ MySQL ä¸­çš„ä¸€ä¸ªé‡è¦åŸåˆ™ï¼Œè¯´çš„æ˜¯ç´¢å¼•ä»¥æœ€å·¦è¾¹çš„ä¸ºèµ·ç‚¹ä»»ä½•è¿ç»­çš„ç´¢å¼•éƒ½èƒ½åŒ¹é…ä¸Šï¼Œå½“é‡åˆ°èŒƒå›´æŸ¥è¯¢ï¼ˆ>ã€<ã€betweenã€likeï¼‰å°±ä¼šåœæ­¢åŒ¹é…ã€‚\n\n### ä»¥ä¸‹è¯­å¥ä¼šèµ°ç´¢å¼•ä¹ˆï¼Ÿ\n\n```\nselect * from t where year(date)>2018;\n```\n\nä¸ä¼šï¼Œå› ä¸ºåœ¨ç´¢å¼•åˆ—ä¸Šæ¶‰åŠåˆ°äº†è¿ç®—ã€‚\n\n### èƒ½å¦ç»™æ‰‹æœºå·çš„å‰ 6 ä½åˆ›å»ºç´¢å¼•ï¼Ÿå¦‚ä½•åˆ›å»ºï¼Ÿ  \n\nå¯ä»¥ï¼Œåˆ›å»ºæ–¹å¼æœ‰ä¸¤ç§ï¼š\n\n```\nalter table t add index index_phone(phone(6));\ncreate index index_phone on t(phone(6));\n```\n\n### ä»€ä¹ˆæ˜¯å‰ç¼€ç´¢å¼•ï¼Ÿ  \n\nå‰ç¼€ç´¢å¼•ä¹Ÿå«å±€éƒ¨ç´¢å¼•ï¼Œæ¯”å¦‚ç»™èº«ä»½è¯çš„å‰ 10 ä½æ·»åŠ ç´¢å¼•ã€‚\nç±»ä¼¼è¿™ç§ç»™æŸåˆ—éƒ¨åˆ†ä¿¡æ¯æ·»åŠ ç´¢å¼•çš„æ–¹å¼å«åšå‰ç¼€ç´¢å¼•ã€‚\n\n### ä¸ºä»€ä¹ˆè¦ç”¨å‰ç¼€ç´¢å¼•ï¼Ÿ  \n\nå‰ç¼€ç´¢å¼•èƒ½æœ‰æ•ˆå‡å°ç´¢å¼•æ–‡ä»¶çš„å¤§å°ï¼Œè®©æ¯ä¸ªç´¢å¼•é¡µå¯ä»¥ä¿å­˜æ›´å¤šçš„ç´¢å¼•å€¼ï¼Œä»è€Œæé«˜äº†ç´¢å¼•æŸ¥è¯¢çš„é€Ÿåº¦ã€‚ä½†å‰ç¼€ç´¢å¼•ä¹Ÿæœ‰å®ƒçš„ç¼ºç‚¹ï¼Œä¸èƒ½åœ¨ order by æˆ–è€… group by ä¸­è§¦å‘å‰ç¼€ç´¢å¼•ï¼Œä¹Ÿä¸èƒ½æŠŠå®ƒä»¬ç”¨äºè¦†ç›–ç´¢å¼•ã€‚\n\n### ä»€ä¹ˆæƒ…å†µä¸‹é€‚åˆä½¿ç”¨å‰ç¼€ç´¢å¼•ï¼Ÿ  \n\nå½“å­—ç¬¦ä¸²æœ¬èº«å¯èƒ½æ¯”è¾ƒé•¿ï¼Œè€Œä¸”å‰å‡ ä¸ªå­—ç¬¦å°±å¼€å§‹ä¸ç›¸åŒï¼Œé€‚åˆä½¿ç”¨å‰ç¼€ç´¢å¼•ï¼›ç›¸åæƒ…å†µä¸‹ä¸é€‚åˆä½¿ç”¨å‰ç¼€ç´¢å¼•ï¼Œæ¯”å¦‚ï¼Œæ•´ä¸ªå­—æ®µçš„é•¿åº¦ä¸º 20ï¼Œç´¢å¼•é€‰æ‹©æ€§ï¼ˆä¸é‡å¤çš„ç´¢å¼•å€¼å’Œè¡¨è®°å½•æ•°çš„æ¯”å€¼ï¼Œè¶Šå¤§è¯´æ˜ç´¢å¼•ä»·å€¼è¶Šå¤§ï¼‰ä¸º 0.9ï¼Œè€Œæˆ‘ä»¬å¯¹å‰ 10 ä¸ªå­—ç¬¦å»ºç«‹å‰ç¼€ç´¢å¼•å…¶é€‰æ‹©æ€§ä¹Ÿåªæœ‰ 0.5ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦ç»§ç»­åŠ å¤§å‰ç¼€å­—ç¬¦çš„é•¿åº¦ï¼Œä½†æ˜¯è¿™ä¸ªæ—¶å€™å‰ç¼€ç´¢å¼•çš„ä¼˜åŠ¿å·²ç»ä¸æ˜æ˜¾ï¼Œå°±æ²¡æœ‰åˆ›å»ºå‰ç¼€ç´¢å¼•çš„å¿…è¦äº†ã€‚\n\n### InnoDB ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ B+ æ ‘ï¼Œè€Œä¸æ˜¯ B æ ‘ã€Hashã€çº¢é»‘æ ‘æˆ–äºŒå‰æ ‘ï¼Ÿ  \n\nå› ä¸º B æ ‘ã€Hashã€çº¢é»‘æ ‘æˆ–äºŒå‰æ ‘å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š\n\n*   B æ ‘ï¼šä¸ç®¡å¶å­èŠ‚ç‚¹è¿˜æ˜¯éå¶å­èŠ‚ç‚¹ï¼Œéƒ½ä¼šä¿å­˜æ•°æ®ï¼Œè¿™æ ·å¯¼è‡´åœ¨éå¶å­èŠ‚ç‚¹ä¸­èƒ½ä¿å­˜çš„æŒ‡é’ˆæ•°é‡å˜å°‘ï¼ˆæœ‰äº›èµ„æ–™ä¹Ÿç§°ä¸ºæ‰‡å‡ºï¼‰ï¼ŒæŒ‡é’ˆå°‘çš„æƒ…å†µä¸‹è¦ä¿å­˜å¤§é‡æ•°æ®ï¼Œåªèƒ½å¢åŠ æ ‘çš„é«˜åº¦ï¼Œå¯¼è‡´ IO æ“ä½œå˜å¤šï¼ŒæŸ¥è¯¢æ€§èƒ½å˜ä½ï¼›\n*   Hashï¼šè™½ç„¶å¯ä»¥å¿«é€Ÿå®šä½ï¼Œä½†æ˜¯æ²¡æœ‰é¡ºåºï¼Œæ— æ³•è¿›è¡ŒèŒƒå›´æŸ¥æ‰¾ï¼ŒIO å¤æ‚åº¦é«˜ï¼›\n*   äºŒå‰æ ‘ï¼šæ ‘çš„é«˜åº¦ä¸å‡åŒ€ï¼Œä¸èƒ½è‡ªå¹³è¡¡ï¼ŒæŸ¥æ‰¾æ•ˆç‡è·Ÿæ•°æ®æœ‰å…³ï¼ˆæ ‘çš„é«˜åº¦ï¼‰ï¼Œå¹¶ä¸” IO ä»£ä»·é«˜ï¼›\n*   çº¢é»‘æ ‘ï¼šæ ‘çš„é«˜åº¦éšç€æ•°æ®é‡å¢åŠ è€Œå¢åŠ ï¼ŒIO ä»£ä»·é«˜ã€‚  \n\n### MySQL å¦‚ä½•æŒ‡å®šæŸ¥è¯¢çš„ç´¢å¼•ï¼Ÿ  \n\nåœ¨ MySQL ä¸­å¯ä»¥ä½¿ç”¨ force index å¼ºè¡Œé€‰æ‹©ä¸€ä¸ªç´¢å¼•ï¼Œå…·ä½“æŸ¥è¯¢è¯­å¥å¦‚ä¸‹ï¼š\n\n```sql\nselect * from t force index(index_t);\n```\n\n### åœ¨ MySQL ä¸­æŒ‡å®šäº†æŸ¥è¯¢ç´¢å¼•ï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰ç”Ÿæ•ˆï¼Ÿ  \n\næˆ‘ä»¬çŸ¥é“åœ¨ MySQL ä¸­ä½¿ç”¨ force index å¯ä»¥æŒ‡å®šæŸ¥è¯¢çš„ç´¢å¼•ï¼Œä½†å¹¶ä¸æ˜¯ä¸€å®šä¼šç”Ÿæ•ˆï¼ŒåŸå› æ˜¯ MySQL ä¼šæ ¹æ®ä¼˜åŒ–å™¨è‡ªå·±é€‰æ‹©ç´¢å¼•ï¼Œå¦‚æœ force index æŒ‡å®šçš„ç´¢å¼•å‡ºç°åœ¨å€™é€‰ç´¢å¼•ä¸Šï¼Œè¿™ä¸ªæ—¶å€™ MySQL ä¸ä¼šåœ¨åˆ¤æ–­æ‰«æçš„è¡Œæ•°çš„å¤šå°‘ç›´æ¥ä½¿ç”¨æŒ‡å®šçš„ç´¢å¼•ï¼Œå¦‚æœæ²¡åœ¨å€™é€‰ç´¢å¼•ä¸­ï¼Œå³ä½¿ force index æŒ‡å®šäº†ç´¢å¼•ä¹Ÿæ˜¯ä¸ä¼šç”Ÿæ•ˆçš„ã€‚\n\n### å¦‚ä½•ä¼˜åŒ–èº«ä»½è¯çš„ç´¢å¼•ï¼Ÿ \n\nåœ¨ä¸­å›½å› ä¸ºå‰ 6 ä½ä»£è¡¨çš„æ˜¯åœ°åŒºï¼Œæ‰€ä»¥å¾ˆå¤šäººçš„å‰å…­ä½éƒ½æ˜¯ç›¸åŒçš„ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨å‰ç¼€ç´¢å¼•ä¸º 6 ä½çš„è¯ï¼Œæ€§èƒ½æå‡ä¹Ÿå¹¶ä¸æ˜¯å¾ˆæ˜æ˜¾ï¼Œä½†å¦‚æœè®¾ç½®çš„ä½æ•°è¿‡é•¿ï¼Œé‚£ä¹ˆå ç”¨çš„ç£ç›˜ç©ºé—´ä¹Ÿè¶Šå¤§ï¼Œæ•°æ®é¡µèƒ½æ”¾ä¸‹çš„ç´¢å¼•å€¼å°±è¶Šå°‘ï¼Œæœç´¢æ•ˆç‡ä¹Ÿè¶Šä½ã€‚é’ˆå¯¹è¿™ç§æƒ…å†µä¼˜åŒ–æ–¹æ¡ˆæœ‰ä»¥ä¸‹ä¸¤ç§ï¼š\n\n*   **ä½¿ç”¨èº«ä»½è¯å€’åºå­˜å‚¨**ï¼Œè¿™æ ·è®¾ç½®å‰å…­ä½çš„æ„ä¹‰å°±å¾ˆå¤§äº†ï¼›\n*   **ä½¿ç”¨ hash å€¼**ï¼Œæ–°åˆ›å»ºä¸€ä¸ªå­—æ®µç”¨äºå­˜å‚¨èº«ä»½è¯çš„ hash å€¼ã€‚\n\n### ç´¢å¼•çš„ä½¿ç”¨åœºæ™¯\n\n- å¯¹äºéå¸¸å°çš„è¡¨ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹å…¨è¡¨æ‰«ææ•ˆç‡æ›´é«˜ã€‚\n- ä¸­åˆ°å¤§å‹è¡¨ï¼Œç´¢å¼•éå¸¸æœ‰æ•ˆã€‚\n- ç‰¹å¤§å‹çš„è¡¨ï¼Œå»ºç«‹å’Œä½¿ç”¨ç´¢å¼•çš„ä»£ä»·ä¼šéšä¹‹å¢å¤§ï¼Œå¯ä»¥ä½¿ç”¨åˆ†åŒºæŠ€æœ¯æ¥è§£å†³ã€‚\n\n\n\n### èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•\n\nInnobd ä¸­çš„ä¸»é”®ç´¢å¼•æ˜¯ä¸€ç§èšç°‡ç´¢å¼•ï¼Œéèšç°‡ç´¢å¼•éƒ½æ˜¯è¾…åŠ©ç´¢å¼•ï¼Œåƒå¤åˆç´¢å¼•ã€å‰ç¼€ç´¢å¼•ã€å”¯ä¸€ç´¢å¼•ã€‚\n\nInnodb ä½¿ç”¨çš„æ˜¯èšç°‡ç´¢å¼•ï¼ŒMyISam ä½¿ç”¨çš„æ˜¯éèšç°‡ç´¢å¼•\n\n#### èšç°‡ç´¢å¼•(èšé›†ç´¢å¼•)\n\n![img](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1464190-20191106145143172-1760681728.png)\n\n\n\nã€€ã€€Innodb èšç°‡ç´¢å¼•å’Œ MyIsam éèšç°‡ç´¢å¼•çš„æ¯”è¾ƒè¯´æ˜\nã€€ã€€å‚è€ƒåšå®¢ï¼šhttps://www.cnblogs.com/zlcxbb/p/5757245.html\n\n#### InnoDBç´¢å¼•å®ç°\n\nã€€ã€€InnoDB**ä½¿ç”¨B+Treeä½œä¸ºç´¢å¼•ç»“æ„**ï¼Œä½†å…·ä½“å®ç°æ–¹å¼å´ä¸ MyISAM æˆªç„¶ä¸åŒ.\n\n1ï¼‰ä¸»é”®ç´¢å¼•ï¼š\n\n**MyISAMç´¢å¼•æ–‡ä»¶å’Œæ•°æ®æ–‡ä»¶æ˜¯åˆ†ç¦»çš„**ï¼Œ**ç´¢å¼•æ–‡ä»¶ä»…ä¿å­˜æ•°æ®è®°å½•çš„åœ°å€**ã€‚è€Œåœ¨**InnoDBä¸­ï¼Œè¡¨æ•°æ®æ–‡ä»¶æœ¬èº«å°±æ˜¯æŒ‰B+Treeç»„ç»‡çš„ä¸€ä¸ªç´¢å¼•ç»“æ„**ï¼Œè¿™æ£µæ ‘çš„å¶èŠ‚ç‚¹ data åŸŸä¿å­˜äº†å®Œæ•´çš„æ•°æ®è®°å½•ã€‚è¿™ä¸ªç´¢å¼•çš„ key æ˜¯æ•°æ®è¡¨çš„ä¸»é”®ï¼Œå› æ­¤ InnoDB è¡¨æ•°æ®æ–‡ä»¶æœ¬èº«å°±æ˜¯ä¸»ç´¢å¼•ã€‚\n\n ![](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesTyporaNotes1464190-20191106145200302-932404581.png)\n\n(å›¾ inndb ä¸»é”®ç´¢å¼•ï¼‰æ˜¯ InnoDB ä¸»ç´¢å¼•ï¼ˆåŒæ—¶ä¹Ÿæ˜¯æ•°æ®æ–‡ä»¶ï¼‰çš„ç¤ºæ„å›¾ï¼Œå¯ä»¥çœ‹åˆ°å¶èŠ‚ç‚¹åŒ…å«äº†å®Œæ•´çš„æ•°æ®è®°å½•ã€‚è¿™ç§ç´¢å¼•å«åšèšé›†ç´¢å¼•ã€‚å› ä¸º InnoDB çš„æ•°æ®æ–‡ä»¶æœ¬èº«è¦æŒ‰ä¸»é”®èšé›†ï¼Œæ‰€ä»¥ InnoDB è¦æ±‚è¡¨å¿…é¡»æœ‰ä¸»é”®ï¼ˆMyISAM å¯ä»¥æ²¡æœ‰ï¼‰ï¼Œå¦‚æœæ²¡æœ‰æ˜¾å¼æŒ‡å®šï¼Œåˆ™ MySQL ç³»ç»Ÿä¼šè‡ªåŠ¨é€‰æ‹©ä¸€ä¸ªå¯ä»¥å”¯ä¸€æ ‡è¯†æ•°æ®è®°å½•çš„åˆ—ä½œä¸ºä¸»é”®ï¼Œå¦‚æœä¸å­˜åœ¨è¿™ç§åˆ—ï¼Œåˆ™**MySQLè‡ªåŠ¨ä¸ºInnoDBè¡¨ç”Ÿæˆä¸€ä¸ªéšå«å­—æ®µä½œä¸ºä¸»é”®ï¼Œè¿™ä¸ªå­—æ®µé•¿åº¦ä¸º6ä¸ªå­—èŠ‚ï¼Œç±»å‹ä¸ºé•¿æ•´å½¢**ã€‚\n\n2ï¼‰InnoDB çš„è¾…åŠ©ç´¢å¼•\n\n   InnoDB çš„æ‰€æœ‰è¾…åŠ©ç´¢å¼•éƒ½å¼•ç”¨ä¸»é”®ä½œä¸º data åŸŸã€‚ä¾‹å¦‚ï¼Œä¸‹å›¾ä¸ºå®šä¹‰åœ¨ Col3 ä¸Šçš„ä¸€ä¸ªè¾…åŠ©ç´¢å¼•ï¼š\n\n ![img](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1464190-20191106145241480-1330791289.png)\n\nInnoDB ä½¿ç”¨çš„æ˜¯èšç°‡ç´¢å¼•ï¼Œå°†ä¸»é”®ç»„ç»‡åˆ°ä¸€æ£µ B+æ ‘ä¸­ï¼Œè€Œè¡Œæ•°æ®å°±å‚¨å­˜åœ¨å¶å­èŠ‚ç‚¹ä¸Šï¼Œè‹¥ä½¿ç”¨\"where id = 14\"è¿™æ ·çš„æ¡ä»¶æŸ¥æ‰¾ä¸»é”®ï¼Œåˆ™æŒ‰ç…§ B+æ ‘çš„æ£€ç´¢ç®—æ³•å³å¯æŸ¥æ‰¾åˆ°å¯¹åº”çš„å¶èŠ‚ç‚¹ï¼Œä¹‹åè·å¾—è¡Œæ•°æ®ã€‚è‹¥å¯¹ Name åˆ—è¿›è¡Œæ¡ä»¶æœç´¢ï¼Œåˆ™éœ€è¦ä¸¤ä¸ªæ­¥éª¤ï¼šç¬¬ä¸€æ­¥åœ¨è¾…åŠ©ç´¢å¼• B+æ ‘ä¸­æ£€ç´¢ Nameï¼Œåˆ°è¾¾å…¶å¶å­èŠ‚ç‚¹è·å–å¯¹åº”çš„ä¸»é”®ã€‚ç¬¬äºŒæ­¥ä½¿ç”¨ä¸»é”®åœ¨ä¸»ç´¢å¼• B+æ ‘ä¸­å†æ‰§è¡Œä¸€æ¬¡ B+æ ‘æ£€ç´¢æ“ä½œï¼Œæœ€ç»ˆåˆ°è¾¾å¶å­èŠ‚ç‚¹å³å¯è·å–æ•´è¡Œæ•°æ®ã€‚\n\n#### MyISAMç´¢å¼•å®ç°\n\nMyISAM ç´¢å¼•æ–‡ä»¶å’Œæ•°æ®æ–‡ä»¶æ˜¯åˆ†ç¦»çš„ï¼Œç´¢å¼•æ–‡ä»¶ä»…ä¿å­˜æ•°æ®è®°å½•çš„åœ°å€\n\n1ï¼‰ä¸»é”®ç´¢å¼•ï¼š\n\nMyISAM å¼•æ“ä½¿ç”¨ B+Tree ä½œä¸ºç´¢å¼•ç»“æ„ï¼Œå¶èŠ‚ç‚¹çš„**dataåŸŸå­˜æ”¾çš„æ˜¯æ•°æ®è®°å½•çš„åœ°å€**ã€‚ä¸‹å›¾æ˜¯ MyISAM ä¸»é”®ç´¢å¼•çš„åŸç†å›¾ï¼š\n\n![img](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1464190-20191106151308457-531875534.png)\n\n \n\nè¿™é‡Œè®¾è¡¨ä¸€å…±æœ‰ä¸‰åˆ—ï¼Œå‡è®¾æˆ‘ä»¬ä»¥ Col1 ä¸ºä¸»é”®ï¼Œå›¾ myisam1 æ˜¯ä¸€ä¸ª MyISAM è¡¨çš„ä¸»ç´¢å¼•ï¼ˆPrimary keyï¼‰ç¤ºæ„ã€‚å¯ä»¥çœ‹å‡º MyISAM çš„ç´¢å¼•æ–‡ä»¶ä»…ä»…ä¿å­˜æ•°æ®è®°å½•çš„åœ°å€ã€‚\n\n2ï¼‰è¾…åŠ©ç´¢å¼•ï¼ˆSecondary keyï¼‰\n\nåœ¨ MyISAM ä¸­ï¼Œä¸»ç´¢å¼•å’Œè¾…åŠ©ç´¢å¼•ï¼ˆSecondary keyï¼‰åœ¨ç»“æ„ä¸Šæ²¡æœ‰ä»»ä½•åŒºåˆ«ï¼Œ**åªæ˜¯ä¸»ç´¢å¼•è¦æ±‚keyæ˜¯å”¯ä¸€çš„ï¼Œè€Œè¾…åŠ©ç´¢å¼•çš„keyå¯ä»¥é‡å¤**ã€‚å¦‚æœæˆ‘ä»¬åœ¨ Col2 ä¸Šå»ºç«‹ä¸€ä¸ªè¾…åŠ©ç´¢å¼•ï¼Œåˆ™æ­¤ç´¢å¼•çš„ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚\n\nåŒæ ·ä¹Ÿæ˜¯ä¸€é¢— B+Treeï¼Œdata åŸŸä¿å­˜æ•°æ®è®°å½•çš„åœ°å€ã€‚å› æ­¤ï¼ŒMyISAM ä¸­ç´¢å¼•æ£€ç´¢çš„ç®—æ³•ä¸ºé¦–å…ˆæŒ‰ç…§ B+Tree æœç´¢ç®—æ³•æœç´¢ç´¢å¼•ï¼Œå¦‚æœæŒ‡å®šçš„ Key å­˜åœ¨ï¼Œåˆ™å–å‡ºå…¶ data åŸŸçš„å€¼ï¼Œç„¶åä»¥ data åŸŸçš„å€¼ä¸ºåœ°å€ï¼Œè¯»å–ç›¸åº”æ•°æ®è®°å½•ã€‚\n\n ![img](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1464190-20191106151427711-625351515.png)\n\nã€€ã€€**MyISMä½¿ç”¨çš„æ˜¯éèšç°‡ç´¢å¼•**ï¼Œéèšç°‡ç´¢å¼•çš„ä¸¤æ£µ B+æ ‘çœ‹ä¸Šå»æ²¡ä»€ä¹ˆä¸åŒï¼ŒèŠ‚ç‚¹çš„ç»“æ„å®Œå…¨ä¸€è‡´åªæ˜¯å­˜å‚¨çš„å†…å®¹ä¸åŒè€Œå·²ï¼Œä¸»é”®ç´¢å¼• B+æ ‘çš„èŠ‚ç‚¹å­˜å‚¨äº†ä¸»é”®ï¼Œè¾…åŠ©é”®ç´¢å¼• B+æ ‘å­˜å‚¨äº†è¾…åŠ©é”®ã€‚è¡¨æ•°æ®å­˜å‚¨åœ¨ç‹¬ç«‹çš„åœ°æ–¹ï¼Œè¿™ä¸¤é¢— B+æ ‘çš„å¶å­èŠ‚ç‚¹éƒ½ä½¿ç”¨ä¸€ä¸ªåœ°å€æŒ‡å‘çœŸæ­£çš„è¡¨æ•°æ®ï¼Œå¯¹äºè¡¨æ•°æ®æ¥è¯´ï¼Œè¿™ä¸¤ä¸ªé”®æ²¡æœ‰ä»»ä½•å·®åˆ«ã€‚ç”±äºç´¢å¼•æ ‘æ˜¯ç‹¬ç«‹çš„ï¼Œé€šè¿‡è¾…åŠ©é”®æ£€ç´¢æ— éœ€è®¿é—®ä¸»é”®çš„ç´¢å¼•æ ‘ã€‚\n\nä¸ºäº†æ›´å½¢è±¡è¯´æ˜è¿™ä¸¤ç§ç´¢å¼•çš„åŒºåˆ«ï¼Œæˆ‘ä»¬å‡æƒ³ä¸€ä¸ªè¡¨å¦‚ä¸‹å›¾å­˜å‚¨äº† 4 è¡Œæ•°æ®ã€‚å…¶ä¸­ Id ä½œä¸ºä¸»ç´¢å¼•ï¼ŒName ä½œä¸ºè¾…åŠ©ç´¢å¼•ã€‚å›¾ç¤ºæ¸…æ™°çš„æ˜¾ç¤ºäº†èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•çš„å·®å¼‚ã€‚\n\n![img](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1464190-20191106151527647-152458631.png)\n\n \n\nğŸŒŸ**InnoDBèšç°‡ç´¢å¼•ï¼š**\n\nä¸»é”®ç´¢å¼•æ ‘ï¼Œæ ¹ç»“ç‚¹å­˜çš„æ˜¯ä¸»é”® id å’Œå¯¹åº”çš„æ•°æ®ï¼›\n\nè¾…åŠ©ç´¢å¼•æ ‘ï¼Œæ ¹ç»“ç‚¹å­˜çš„æ˜¯è¾…åŠ©ç´¢å¼•å’Œå¯¹åº”çš„ä¸»é”®ç´¢å¼•ï¼Œå› æ­¤éœ€è¦æ ¹æ®ä¸»é”®åˆ°ä¸»é”®ç´¢å¼•æ ‘ä¸Šåœ¨éå†ä¸€æ¬¡å¾—åˆ°å¯¹åº”çš„æ•°æ®ã€‚\n\nğŸŒŸ**MyISAMéèšç°‡ç´¢å¼•ï¼š**\n\nä¸»é”®ç´¢å¼•æ ‘ï¼Œæ ¹ç»“ç‚¹å­˜çš„æ˜¯ä¸»é”®åˆ°æ•°æ®åœ°å€çš„æ˜ å°„ï¼›\n\nè¾…åŠ©ç´¢å¼•æ ‘ï¼Œæ ¹ç»“ç‚¹å­˜çš„æ˜¯è¾…åŠ©ç´¢å¼•åˆ°æ•°æ®åœ°å€çš„æ˜ å°„ï¼Œä¹Ÿå¯ä»¥ç›´æ¥å¾—åˆ°æ•°æ®ï¼Œä¸éœ€è¦å›è¡¨ã€‚\n\n#### é—®é¢˜ï¼šä¸»é”®ç´¢å¼•æ˜¯èšé›†ç´¢å¼•è¿˜æ˜¯éèšé›†ç´¢å¼•ï¼Ÿ\n\nåœ¨ InnoDB ä¸‹ä¸»é”®ç´¢å¼•æ˜¯èšé›†ç´¢å¼•ï¼Œåœ¨ MyISAM ä¸‹ä¸»é”®ç´¢å¼•æ˜¯éèšé›†ç´¢å¼•\n\n#### MyISAMç´¢å¼•å®ç°ï¼Ÿ\n\nMyISAM å­˜å‚¨å¼•æ“ä½¿ç”¨ B+Tree ä½œä¸ºç´¢å¼•ç»“æ„ï¼Œå¶èŠ‚ç‚¹çš„ data åŸŸå­˜æ”¾çš„æ˜¯æ•°æ®è®°å½•çš„åœ°å€ã€‚MyISAM çš„ç´¢å¼•æ–¹å¼ä¹Ÿå«åšéèšç°‡ç´¢å¼•çš„ï¼Œä¹‹æ‰€ä»¥è¿™ä¹ˆç§°å‘¼æ˜¯ä¸ºäº†ä¸ InnoDB çš„èšç°‡ç´¢å¼•åŒºåˆ†ã€‚\n\n#### MyISAMç´¢å¼•ä¸InnoDBç´¢å¼•çš„åŒºåˆ«ï¼Ÿ\n\n- InnoDB ç´¢å¼•æ˜¯èšç°‡ç´¢å¼•ï¼ŒMyISAM ç´¢å¼•æ˜¯éèšç°‡ç´¢å¼•ã€‚\n- InnoDB çš„ä¸»é”®ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å­˜å‚¨ç€ç´¢å¼•å’Œè¡Œæ•°æ®ï¼Œå› æ­¤ä¸»é”®ç´¢å¼•éå¸¸é«˜æ•ˆã€‚\n- MyISAM ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å­˜å‚¨çš„æ˜¯è¡Œæ•°æ®åœ°å€ï¼Œéœ€è¦æ ¹æ®æ•°æ®åœ°å€è®¿é—®å¯¹åº”çš„åœ°å€æ‰èƒ½å¾—åˆ°æ•°æ®ã€‚\n- **InnoDBéä¸»é”®ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å­˜å‚¨çš„æ˜¯ä¸»é”®å’Œå…¶ä»–å¸¦ç´¢å¼•çš„åˆ—æ•°æ®ï¼Œå› æ­¤æŸ¥è¯¢æ—¶åšåˆ°è¦†ç›–ç´¢å¼•ä¼šéå¸¸é«˜æ•ˆã€‚**\n\n### ç®€å•è¯´ä¸€è¯´dropã€deleteä¸truncateçš„åŒºåˆ«\n\nSQL ä¸­çš„ dropã€deleteã€truncate éƒ½è¡¨ç¤ºåˆ é™¤ï¼Œä½†æ˜¯ä¸‰è€…æœ‰ä¸€äº›å·®åˆ«\n\n> 1ã€deleteå’Œtruncateåªåˆ é™¤è¡¨çš„æ•°æ®ä¸åˆ é™¤è¡¨çš„ç»“æ„\n> 2ã€é€Ÿåº¦,ä¸€èˆ¬æ¥è¯´: drop> truncate >delete\n> 3ã€deleteè¯­å¥æ˜¯dml,è¿™ä¸ªæ“ä½œä¼šæ”¾åˆ°rollback segementä¸­,äº‹åŠ¡æäº¤ä¹‹åæ‰ç”Ÿæ•ˆ;\n> 4ã€å¦‚æœæœ‰ç›¸åº”çš„trigger,æ‰§è¡Œçš„æ—¶å€™å°†è¢«è§¦å‘. truncate,dropæ˜¯ddl, æ“ä½œç«‹å³ç”Ÿæ•ˆ,åŸæ•°æ®ä¸æ”¾åˆ°rollback segmentä¸­,ä¸èƒ½å›æ»š. æ“ä½œä¸è§¦å‘trigger.\n\n### deleteã€truncateå’Œdropåˆ†åˆ«åœ¨ä»€ä¹ˆåœºæ™¯ä¹‹ä¸‹ä½¿ç”¨ï¼Ÿ\n\n1. æƒ³åˆ é™¤éƒ¨åˆ†æ•°æ®è¡Œæ—¶å€™ï¼Œç”¨ deleteï¼Œå¹¶ä¸”å¸¦ä¸Š where å­å¥\n2. ä¿ç•™è¡¨è€Œåˆ é™¤æ‰€æœ‰æ•°æ®çš„æ—¶å€™ç”¨ truncate\n3. ä¸å†éœ€è¦ä¸€å¼ è¡¨çš„æ—¶å€™ï¼Œç”¨ drop\n\n### â­ä¸ºä»€ä¹ˆ B+Tree æ¯” B-Tree æ›´é€‚åˆå®é™…åº”ç”¨ä¸­æ“ä½œç³»ç»Ÿçš„æ–‡ä»¶ç´¢å¼•å’Œæ•°æ®åº“ç´¢å¼•ï¼Ÿ\n\n1. B+Tree çš„ç£ç›˜è¯»å†™ä»£ä»·æ›´ä½\n\n> B+Tree çš„å†…éƒ¨ç»“ç‚¹å¹¶æ²¡æœ‰æŒ‡å‘å…³é”®å­—å…·ä½“ä¿¡æ¯çš„æŒ‡é’ˆã€‚å› æ­¤å…¶å†…éƒ¨ç»“ç‚¹ç›¸å¯¹ B-Tree æ›´å°ã€‚å¦‚æœæŠŠæ‰€æœ‰åŒä¸€å†…éƒ¨ç»“ç‚¹çš„å…³é”®å­—å­˜æ”¾åœ¨åŒä¸€ç›˜å—ä¸­ï¼Œé‚£ä¹ˆç›˜å—æ‰€èƒ½å®¹çº³çš„å…³é”®å­—æ•°é‡ä¹Ÿè¶Šå¤šã€‚ä¸€æ¬¡æ€§è¯»å…¥å†…å­˜ä¸­çš„éœ€è¦æŸ¥æ‰¾çš„å…³é”®å­—ä¹Ÿå°±è¶Šå¤šã€‚ç›¸å¯¹æ¥è¯´ IO è¯»å†™æ¬¡æ•°ä¹Ÿå°±é™ä½äº†ã€‚\n\n2. B+Tree çš„æŸ¥è¯¢æ•ˆç‡æ›´åŠ ç¨³å®š\n\n> ç”±äºéç»ˆç»“ç‚¹å¹¶ä¸æ˜¯æœ€ç»ˆæŒ‡å‘æ–‡ä»¶å†…å®¹çš„ç»“ç‚¹ï¼Œè€Œåªæ˜¯å¶å­ç»“ç‚¹ä¸­å…³é”®å­—çš„ç´¢å¼•ã€‚æ‰€ä»¥ä»»ä½•å…³é”®å­—çš„æŸ¥æ‰¾å¿…é¡»èµ°ä¸€æ¡ä»æ ¹ç»“ç‚¹åˆ°å¶å­ç»“ç‚¹çš„è·¯ã€‚æ‰€æœ‰å…³é”®å­—æŸ¥è¯¢çš„è·¯å¾„é•¿åº¦ç›¸åŒï¼Œå¯¼è‡´æ¯ä¸€ä¸ªæ•°æ®çš„æŸ¥è¯¢æ•ˆç‡ç›¸å½“ã€‚\n\n### â­Hashç´¢å¼•å’ŒB+æ ‘æ‰€æœ‰æœ‰ä»€ä¹ˆåŒºåˆ«æˆ–è€…è¯´ä¼˜åŠ£å‘¢?\n\né¦–å…ˆè¦çŸ¥é“ Hash ç´¢å¼•å’Œ B+æ ‘ç´¢å¼•çš„åº•å±‚å®ç°åŸç†ï¼š\n\n**hashç´¢å¼•åº•å±‚å°±æ˜¯hashè¡¨,è¿›è¡ŒæŸ¥æ‰¾æ—¶,è°ƒç”¨ä¸€æ¬¡hashå‡½æ•°å°±å¯ä»¥è·å–åˆ°ç›¸åº”çš„é”®å€¼,ä¹‹åè¿›è¡Œå›è¡¨æŸ¥è¯¢è·å¾—å®é™…æ•°æ®.**\nB+æ ‘åº•å±‚å®ç°æ˜¯å¤šè·¯å¹³è¡¡æŸ¥æ‰¾æ ‘.å¯¹äºæ¯ä¸€æ¬¡çš„æŸ¥è¯¢éƒ½æ˜¯ä»æ ¹èŠ‚ç‚¹å‡ºå‘,æŸ¥æ‰¾åˆ°å¶å­èŠ‚ç‚¹æ–¹å¯ä»¥è·å¾—æ‰€æŸ¥é”®å€¼,ç„¶åæ ¹æ®æŸ¥è¯¢åˆ¤æ–­æ˜¯å¦éœ€è¦å›è¡¨æŸ¥è¯¢æ•°æ®.\n\né‚£ä¹ˆå¯ä»¥çœ‹å‡ºä»–ä»¬æœ‰ä»¥ä¸‹çš„ä¸åŒï¼š\n\n- hash ç´¢å¼•è¿›è¡Œç­‰å€¼æŸ¥è¯¢æ›´å¿«(ä¸€èˆ¬æƒ…å†µä¸‹),ä½†æ˜¯å´æ— æ³•è¿›è¡ŒèŒƒå›´æŸ¥è¯¢.\n\n- hash ç´¢å¼•ä¸æ”¯æŒä½¿ç”¨ç´¢å¼•è¿›è¡Œæ’åº,åŸç†åŒä¸Š.\n- hash ç´¢å¼•ä¸æ”¯æŒæ¨¡ç³ŠæŸ¥è¯¢.\n- hash ç´¢å¼•ä»»ä½•æ—¶å€™éƒ½é¿å…ä¸äº†å›è¡¨æŸ¥è¯¢æ•°æ®,è€Œ B+æ ‘åœ¨ç¬¦åˆæŸäº›æ¡ä»¶(èšç°‡ç´¢å¼•,è¦†ç›–ç´¢å¼•ç­‰)çš„æ—¶å€™å¯ä»¥åªé€šè¿‡ç´¢å¼•å®ŒæˆæŸ¥è¯¢.\n- hash ç´¢å¼•è™½ç„¶åœ¨ç­‰å€¼æŸ¥è¯¢ä¸Šè¾ƒå¿«,ä½†æ˜¯ä¸ç¨³å®š.æ€§èƒ½ä¸å¯é¢„æµ‹,å½“æŸä¸ªé”®å€¼å­˜åœ¨å¤§é‡é‡å¤çš„æ—¶å€™,å‘ç”Ÿ hash ç¢°æ’,æ­¤æ—¶æ•ˆç‡å¯èƒ½æå·®.è€Œ B+æ ‘çš„æŸ¥è¯¢æ•ˆç‡æ¯”è¾ƒç¨³å®š,å¯¹äºæ‰€æœ‰çš„æŸ¥è¯¢éƒ½æ˜¯ä»æ ¹èŠ‚ç‚¹åˆ°å¶å­èŠ‚ç‚¹,ä¸”æ ‘çš„é«˜åº¦è¾ƒä½.\n\nå› æ­¤,åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹,ç›´æ¥é€‰æ‹© B+æ ‘ç´¢å¼•å¯ä»¥è·å¾—ç¨³å®šä¸”è¾ƒå¥½çš„æŸ¥è¯¢é€Ÿåº¦.è€Œä¸éœ€è¦ä½¿ç”¨ hash ç´¢å¼•.\n\n### éèšç°‡ç´¢å¼•ä¸€å®šä¼šå›è¡¨æŸ¥è¯¢å—?\n\næœ‰å¦‚ä¸‹ä¸€å¼  InnoDB è¡¨ï¼š\n\n```sql\nCREATE TABLE `user` (\n`id` INT NOT NULL ,\n`name` VARCHAR NOT NULL ,\n`age` INT NOT NULL);\n```\n\nå…¶ä¸­ id ä¸ºè‡ªå¢ä¸»é”®ï¼Œname æ˜¯ä¸€ä¸ªæ™®é€šç´¢å¼•ã€‚åœ¨æ‰§è¡Œ select * from user where id = 1 æ—¶ï¼Œä¼šåœ¨ä¸»é”®ç´¢å¼•å¯¹åº”çš„ B+æ ‘çš„å¶å­ç»“ç‚¹ä¸Šæœç´¢åˆ°å…³é”®å­— id=1 çš„èŠ‚ç‚¹ï¼Œå¹¶è¯»å–ä½äºè¯¥èŠ‚ç‚¹ä¸Šçš„æ•´è¡Œæ•°æ®ã€‚ä½†æ˜¯åœ¨æ‰§è¡Œ select * from user where name = 'tom'æ—¶ï¼Œä¼šåˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼š\n\nå…ˆåˆ° name ç´¢å¼•å¯¹åº”çš„ B+æ ‘çš„å¶å­ç»“ç‚¹ä¸Šæœç´¢åˆ°å…³é”®å­— name='tomâ€™çš„èŠ‚ç‚¹ï¼Œå¹¶ä»è¯¥èŠ‚ç‚¹ä¸Šè·å–å¯¹åº”çš„ä¸»é”® id å€¼ã€‚\n\nç„¶åå†æ ¹æ® id å€¼ä½¿ç”¨ä¸»é”®ç´¢å¼•è¯»å–åˆ°æ•´è¡Œæ•°æ®ã€‚\n\nå…¶ä¸­ç¬¬äºŒä¸ªæ­¥éª¤å«ä½œå›è¡¨æŸ¥è¯¢ã€‚éœ€è¦æ‰«æè¾…åŠ©ç´¢å¼•å’Œä¸»é”®ç´¢å¼•ä¸¤æ£µ B+æ ‘æ‰èƒ½æ‹¿åˆ°æ•´è¡Œæ•°æ®ï¼Œæ•ˆç‡è¾ƒä½ã€‚\n\nå¦‚æœæ‰§è¡Œ select id, name from user where name = 'tom',åˆ™åªéœ€è¦æ‰«æ name ç´¢å¼•æ ‘å°±å¯ä»¥è·å–åˆ°æ‰€æœ‰çš„å­—æ®µï¼Œå› ä¸º id å’Œ name éƒ½ä¿å­˜åœ¨ name ç´¢å¼• B+æ ‘çš„å¶å­èŠ‚ç‚¹ä¸Šï¼Œæ‰€ä»¥ä¸éœ€è¦å†å»ä¸»é”®ç´¢å¼•ä¸ŠæŸ¥æ‰¾ã€‚è¿™å°±æ˜¯æ‰€è°“çš„ç´¢å¼•è¦†ç›–ã€‚åªéœ€è¦åœ¨ä¸€æ£µç´¢å¼•æ ‘ä¸Šå°±èƒ½è·å– SQL æ‰€éœ€çš„æ‰€æœ‰åˆ—æ•°æ®ï¼Œæ— éœ€å›è¡¨ï¼Œé€Ÿåº¦æ›´å¿«ã€‚\n\nè€Œ select id, name, age from user where name = 'tom'ï¼Œå› ä¸º age å­—æ®µæ²¡æœ‰å­˜å‚¨åˆ° name ç´¢å¼•çš„å¶å­èŠ‚ç‚¹ä¸Šï¼Œæ‰€ä»¥éœ€è¦æ ¹æ®ä¸»é”®ç´¢å¼•å›è¡¨æŸ¥è¯¢åˆ° age åˆ—å€¼ã€‚å¦‚æœæŠŠ name ç´¢å¼•æ”¹æˆ(nameï¼Œage)çš„è”åˆç´¢å¼•å°±å¯ä»¥å®ç°ç´¢å¼•è¦†ç›–ï¼Œæ— éœ€å›è¡¨äº†ã€‚ï¼ˆè¦†ç›–ç´¢å¼•ï¼Œsql è¯­å¥ä¸­ç”¨åˆ°çš„å­—æ®µéƒ½æœ‰ç´¢å¼•ï¼‰\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\nç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸º CSDN åšä¸»ã€Œlmynoã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ª CC 4.0 BY-SA ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚\nåŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/weixin_33603681/article/details/113387941\n\n### è”åˆç´¢å¼•æ˜¯ä»€ä¹ˆ?ä¸ºä»€ä¹ˆéœ€è¦æ³¨æ„è”åˆç´¢å¼•ä¸­çš„é¡ºåº?\n\nå› æ­¤åœ¨å»ºç«‹è”åˆç´¢å¼•çš„æ—¶å€™åº”è¯¥æ³¨æ„ç´¢å¼•åˆ—çš„é¡ºåº,ä¸€èˆ¬æƒ…å†µä¸‹,å°†æŸ¥è¯¢éœ€æ±‚é¢‘ç¹æˆ–è€…å­—æ®µé€‰æ‹©æ€§é«˜çš„åˆ—æ”¾åœ¨å‰é¢.æ­¤å¤–å¯ä»¥æ ¹æ®ç‰¹ä¾‹çš„æŸ¥è¯¢æˆ–è€…è¡¨ç»“æ„è¿›è¡Œå•ç‹¬çš„è°ƒæ•´.\n\n### åˆ›å»ºçš„ç´¢å¼•æœ‰æ²¡æœ‰è¢«ä½¿ç”¨åˆ°?æˆ–è€…è¯´æ€ä¹ˆæ‰å¯ä»¥çŸ¥é“è¿™æ¡è¯­å¥è¿è¡Œå¾ˆæ…¢çš„åŸå› ?\n\nMySQL æä¾›äº† explain å‘½ä»¤æ¥æŸ¥çœ‹è¯­å¥çš„æ‰§è¡Œè®¡åˆ’\n\n\n\n## MySQLäº‹åŠ¡ç¯‡ï¼ˆé‡ç‚¹ï¼‰\n\n### å¯è§æ€§åˆ¤æ–­\n\n> æ€»ç»“ï¼š\n>\n> å¤§äºç­‰äºä¸‹ä¸€ä¸ªåˆ†é…çš„äº‹åŠ¡IDä¸å¯è§\n>\n> åŒ…å«åœ¨æœªæäº¤äº‹åŠ¡é›†åˆä¸­ä½†æ˜¯å’Œåˆ›å»ºread viewçš„äº‹åŠ¡IDä¸ç›¸ç­‰åˆ™ä¹Ÿä¸å¯è§ã€‚\n\näº‹åŠ¡ç‰ˆæœ¬å·å°äºå½“å‰æœ€å°çš„äº‹åŠ¡ IDï¼Œé‚£ä¹ˆè¯´æ˜å®ƒå·²ç»æäº¤äº†ï¼Œå¯è§ã€‚\n\näº‹åŠ¡ç‰ˆæœ¬å·**å¤§äºç­‰äºä¸‹ä¸€ä¸ªåˆ†é…çš„äº‹åŠ¡ID**ï¼Œè¯´æ˜è¿™ä¸ªäº‹åŠ¡åœ¨å½“å‰ read view ç”Ÿæˆååœ¨ç”Ÿæˆï¼Œ**ä¸å¯è§**ã€‚\n\näº‹åŠ¡ç‰ˆæœ¬å·åœ¨ [æœ€å°äº‹åŠ¡ IDï¼Œä¸‹ä¸€ä¸ªåˆ†é…çš„äº‹åŠ¡ ID) åŒºé—´å†…ï¼š\n\nâ€‹\tå¦‚æœæœªæäº¤äº‹åŠ¡é›†åˆåŒ…å«è¯¥äº‹åŠ¡ç‰ˆæœ¬å·ï¼Œé‚£ä¹ˆåˆ¤æ–­æ˜¯å¦è¯¥äº‹åŠ¡ç‰ˆæœ¬å·æ˜¯å¦ç­‰äºåˆ›å»ºè¯¥ read view çš„äº‹åŠ¡ IDï¼Œ\n\nâ€‹\t\tç­‰äºåˆ™è¯´æ˜è¿™ä¸ªç‰ˆæœ¬çš„æ•°æ®æ˜¯å½“å‰äº‹åŠ¡ç”Ÿæˆçš„ï¼Œå¯è§ã€‚**ä¸ç­‰äºåˆ™ä¸å¯è§**ã€‚\n\nâ€‹\tå¦‚æœä¸åŒ…å«ï¼Œè¯´æ˜è¿™ä¸ªäº‹åŠ¡ç‰ˆæœ¬å·å·²ç»æäº¤ï¼Œå¯è§ã€‚\n\n### æŸ¥è¯¢ä¸€æ¡è®°å½•ï¼ŒåŸºäºMVCCï¼Œæ˜¯æ€æ ·çš„æµç¨‹\n\n1. è·å–æ•°æ®ç‰ˆæœ¬å·å³**æ•°æ®è¡Œä¸­çš„äº‹åŠ¡idéšè—å­—æ®µ**\n2. **æ‰§è¡Œsqlï¼Œå¾—åˆ°Read View**\n3. æ ¹æ®æ•°æ®ç‰ˆæœ¬å·å’Œ read view è¿›è¡Œ**å¯è§æ€§åˆ¤æ–­**ï¼Œåˆ¤æ–­å½“å‰ç‰ˆæœ¬æ•°æ®æ˜¯å¦å¯è§\n4. å¦‚æœä¸ç¬¦åˆ Read View çš„å¯è§æ€§è§„åˆ™ï¼Œ å³å°±éœ€è¦**Undo log**ä¸­å†å²å¿«ç…§é‡æ–°å’Œ read view å¯è§æ€§åˆ¤æ–­\n5. æœ€åè¿”å›ç¬¦åˆè§„åˆ™çš„æ•°æ®\n\nInnoDB å®ç° MVCCï¼Œæ˜¯é€šè¿‡` Read View+ Undo Log` å®ç°çš„ï¼ŒUndo Log ä¿å­˜äº†å†å²å¿«ç…§ï¼ŒRead View å¯è§æ€§è§„åˆ™å¸®åŠ©åˆ¤æ–­å½“å‰ç‰ˆæœ¬çš„æ•°æ®æ˜¯å¦å¯è§ã€‚\n\n### RCä¸‹å¯ä»¥è¯»åˆ°å·²æäº¤æ•°æ®ï¼Œä½†ä¸èƒ½è¯»åˆ°æœªæäº¤æ•°æ®\n\n![1](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesTyporaNotes1.png)\n\n### RRä¸‹å·²æäº¤å’Œæœªæäº¤æ•°æ®éƒ½ä¸èƒ½è¯»åˆ°\n\n![2](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesTyporaNotes2.png)\n\n### ä¸ºä»€ä¹ˆRRä¸‹è§£å†³äº†ä¸å¯é‡å¤è¯»é—®é¢˜ï¼Ÿ\n\nå®é™…ä¸Šï¼Œå„ç§äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸‹çš„ Read view å·¥ä½œæ–¹å¼ï¼Œæ˜¯ä¸ä¸€æ ·çš„ï¼ŒRR å¯ä»¥è§£å†³ä¸å¯é‡å¤è¯»é—®é¢˜ï¼Œå°±æ˜¯è·Ÿ**Read viewå·¥ä½œæ–¹å¼æœ‰å…³**ã€‚\n\n- åœ¨è¯»å·²æäº¤ï¼ˆRCï¼‰éš”ç¦»çº§åˆ«ä¸‹ï¼ŒåŒä¸€ä¸ªäº‹åŠ¡é‡Œé¢ï¼Œ**æ¯ä¸€æ¬¡æŸ¥è¯¢éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„Read View**ï¼Œè¿™æ ·å°±å¯èƒ½é€ æˆåŒä¸€ä¸ªäº‹åŠ¡é‡Œå‰åè¯»å–æ•°æ®å¯èƒ½ä¸ä¸€è‡´çš„é—®é¢˜ï¼ˆä¸å¯é‡å¤è¯»å¹¶å‘é—®é¢˜ï¼‰ã€‚\n\n| begin                               |                   |\n| ----------------------------------- | ----------------- |\n| select * from core_user where id =1 | ç”Ÿæˆä¸€ä¸ªRead View |\n| /                                   | /                 |\n| /                                   | /                 |\n| select * from core_user where id =1 | ç”Ÿæˆä¸€ä¸ªRead View |\n\n- åœ¨å¯é‡å¤è¯»ï¼ˆRRï¼‰éš”ç¦»çº§åˆ«ä¸‹ï¼Œ**ä¸€ä¸ªäº‹åŠ¡é‡Œåªä¼šè·å–ä¸€æ¬¡read view**ï¼Œéƒ½æ˜¯å‰¯æœ¬å…±ç”¨çš„ï¼Œä»è€Œä¿è¯æ¯æ¬¡æŸ¥è¯¢çš„æ•°æ®éƒ½æ˜¯ä¸€æ ·çš„ã€‚\n\n| begin                               |                       |\n| ----------------------------------- | --------------------- |\n| select * from core_user where id =1 | ç”Ÿæˆä¸€ä¸ªRead View     |\n| /                                   |                       |\n| /                                   |                       |\n| select * from core_user where id =1 | å…±ç”¨ä¸€ä¸ªRead Viewå‰¯æœ¬ |\n\n### MVCCæ˜¯å¦è§£å†³äº†å¹»è¯»é—®é¢˜å‘¢ï¼Ÿ\n\nå¯¹äºå¹»è¯»æ¥è¯´ï¼Œå­˜åœ¨å¿«ç…§è¯»ï¼ˆå¯ä»¥è¯»åˆ°å¤šä¸ªç‰ˆæœ¬ï¼Œæ™®é€šçš„ selectï¼‰å’Œå½“å‰è¯»ï¼ˆè¯»çš„æ˜¯æœ€æ–°çš„ for updateï¼‰çš„æƒ…å†µï¼š\n\n1. RR éš”ç¦»çº§åˆ«ä¸‹ä¸ºäº†è§£å†³å¹»è¯»é—®é¢˜ï¼š**å¿«ç…§è¯»ä¾é MVCCæ§åˆ¶ï¼Œå½“å‰è¯»é€šè¿‡é—´éš™é”è§£å†³**ï¼›\n2. é—´éš™é”å’Œè¡Œé”åˆç§° Next-Key Locksï¼Œæ¯ä¸ª Next-Key Locks æ˜¯å‰å¼€åé—­åŒºé—´ï¼›\n3. **é—´éš™é”çš„å¼•å…¥ï¼Œå¯èƒ½ä¼šå¯¼è‡´åŒæ ·è¯­å¥é”ä½æ›´å¤§çš„èŒƒå›´ï¼Œå½±å“å¹¶å‘åº¦**ã€‚\n\n\n\n### å¹¶å‘äº‹åŠ¡æœ‰ä»€ä¹ˆä»€ä¹ˆé—®é¢˜ï¼Ÿåº”è¯¥å¦‚ä½•è§£å†³ï¼Ÿ\n\nå¹¶å‘äº‹åŠ¡å¯èƒ½é€ æˆï¼šè„è¯»ã€ä¸å¯é‡å¤è¯»å’Œå¹»è¯»ç­‰é—®é¢˜ ï¼Œè¿™äº›é—®é¢˜å…¶å®éƒ½æ˜¯æ•°æ®åº“è¯»ä¸€è‡´æ€§é—®é¢˜ï¼Œå¿…é¡»ç”±æ•°æ®åº“æä¾›ä¸€å®šçš„äº‹åŠ¡éš”ç¦»æœºåˆ¶æ¥è§£å†³ï¼Œè§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š\n\n*   åŠ é”ï¼šåœ¨è¯»å–æ•°æ®å‰ï¼Œå¯¹å…¶åŠ é”ï¼Œé˜»æ­¢å…¶ä»–äº‹åŠ¡å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ã€‚\n\n*   æä¾›æ•°æ®å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMultiVersion Concurrency Controlï¼Œç®€ç§° MVCC æˆ– MCCï¼‰ï¼Œä¹Ÿç§°ä¸ºå¤šç‰ˆæœ¬æ•°æ®åº“ï¼šä¸ç”¨åŠ ä»»ä½•é”ï¼Œ é€šè¿‡ä¸€å®šæœºåˆ¶ç”Ÿæˆä¸€ä¸ªæ•°æ®è¯·æ±‚æ—¶é—´ç‚¹çš„ä¸€è‡´æ€§æ•°æ®å¿«ç…§ï¼ˆSnapshot)ï¼Œ å¹¶ç”¨è¿™ä¸ªå¿«ç…§æ¥æä¾›ä¸€å®šçº§åˆ« ï¼ˆè¯­å¥çº§æˆ–äº‹åŠ¡çº§ï¼‰ çš„ä¸€è‡´æ€§è¯»å–ï¼Œä»ç”¨æˆ·çš„è§’åº¦æ¥çœ‹ï¼Œå¥½è±¡æ˜¯æ•°æ®åº“å¯ä»¥æä¾›åŒä¸€æ•°æ®çš„å¤šä¸ªç‰ˆæœ¬ã€‚\n\n### MySQL äº‹åŠ¡å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ\n\nä»¥ InnoDB çš„äº‹åŠ¡å®ç°ä¸ºä¾‹ï¼ŒInnoDB æ˜¯é€šè¿‡å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMVCCï¼ŒMultiversion Concurrency Control ï¼‰è§£å†³ä¸å¯é‡å¤è¯»é—®é¢˜ï¼ŒåŠ ä¸Šé—´éš™é”è§£å†³å¹»è¯»é—®é¢˜ã€‚å› æ­¤ InnoDB çš„ RR éš”ç¦»çº§åˆ«å…¶å®å®ç°äº†ä¸²è¡ŒåŒ–çº§åˆ«çš„æ•ˆæœï¼Œè€Œä¸”ä¿ç•™äº†æ¯”è¾ƒå¥½çš„å¹¶å‘æ€§èƒ½ã€‚\näº‹åŠ¡çš„éš”ç¦»æ€§æ˜¯é€šè¿‡é”å®ç°ï¼Œè€Œäº‹åŠ¡çš„åŸå­æ€§ã€ä¸€è‡´æ€§å’ŒæŒä¹…æ€§åˆ™æ˜¯é€šè¿‡äº‹åŠ¡æ—¥å¿—å®ç°ã€‚\n\n\n\n## MVCCè¯¦ç»†ç‰ˆ\n\n### 1. ç›¸å…³æ•°æ®åº“çŸ¥è¯†ç‚¹å›é¡¾\n\n#### 1.1 ä»€ä¹ˆæ˜¯æ•°æ®åº“äº‹åŠ¡ï¼Œä¸ºä»€ä¹ˆè¦æœ‰äº‹åŠ¡\n\näº‹åŠ¡ï¼Œç”±ä¸€ä¸ªæœ‰é™çš„æ•°æ®åº“æ“ä½œåºåˆ—æ„æˆï¼Œè¿™äº›æ“ä½œè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œ,è¦ä¹ˆå…¨éƒ¨ä¸æ‰§è¡Œï¼Œæ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„å·¥ä½œå•ä½ã€‚\n\n**ä¸ºä»€ä¹ˆè¦æœ‰äº‹åŠ¡å‘¢ï¼Ÿ** å°±æ˜¯ä¸ºäº†ä¿è¯æ•°æ®çš„æœ€ç»ˆä¸€è‡´æ€§ã€‚\n\n#### 1.2 äº‹åŠ¡åŒ…æ‹¬å“ªå‡ ä¸ªç‰¹æ€§ï¼Ÿ\n\näº‹åŠ¡å››ä¸ªå…¸å‹ç‰¹æ€§ï¼Œå³ ACIDï¼ŒåŸå­æ€§ï¼ˆAtomicityï¼‰ã€ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ã€éš”ç¦»æ€§ï¼ˆIsolationï¼‰ã€æŒä¹…æ€§ï¼ˆDurabilityï¼‰ã€‚\n\n- åŸå­æ€§ï¼š äº‹åŠ¡ä½œä¸ºä¸€ä¸ªæ•´ä½“è¢«æ‰§è¡Œï¼ŒåŒ…å«åœ¨å…¶ä¸­çš„å¯¹æ•°æ®åº“çš„æ“ä½œ**è¦ä¹ˆå…¨éƒ¨éƒ½æ‰§è¡Œï¼Œè¦ä¹ˆéƒ½ä¸æ‰§è¡Œ**ã€‚\n- ä¸€è‡´æ€§ï¼š æŒ‡åœ¨**äº‹åŠ¡å¼€å§‹ä¹‹å‰å’Œäº‹åŠ¡ç»“æŸä»¥å**ï¼Œæ•°æ®ä¸ä¼šè¢«ç ´åï¼Œå‡å¦‚ A è´¦æˆ·ç»™ B è´¦æˆ·è½¬ 10 å—é’±ï¼Œä¸ç®¡æˆåŠŸä¸å¦ï¼ŒA å’Œ B çš„æ€»é‡‘é¢æ˜¯ä¸å˜çš„ã€‚\n- éš”ç¦»æ€§ï¼š å¤šä¸ªäº‹åŠ¡å¹¶å‘è®¿é—®æ—¶ï¼Œ**äº‹åŠ¡ä¹‹é—´æ˜¯ç›¸äº’éš”ç¦»**çš„ï¼Œä¸€ä¸ªäº‹åŠ¡ä¸åº”è¯¥è¢«å…¶ä»–äº‹åŠ¡å¹²æ‰°ï¼Œå¤šä¸ªå¹¶å‘äº‹åŠ¡ä¹‹é—´è¦ç›¸äº’éš”ç¦»ã€‚\n- æŒä¹…æ€§ï¼š è¡¨ç¤ºäº‹åŠ¡å®Œæˆæäº¤åï¼Œè¯¥äº‹åŠ¡å¯¹æ•°æ®åº“æ‰€ä½œçš„æ“ä½œæ›´æ”¹ï¼Œå°†**æŒä¹…åœ°ä¿å­˜åœ¨æ•°æ®åº“**ä¹‹ä¸­ã€‚\n\n#### 1.3 äº‹åŠ¡å¹¶å‘å­˜åœ¨çš„é—®é¢˜\n\näº‹åŠ¡å¹¶å‘ä¼šå¼•èµ·**è„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»**é—®é¢˜ã€‚\n\n##### 1.3.1 è„è¯»\n\n> å¦‚æœä¸€ä¸ªäº‹åŠ¡è¯»å–åˆ°äº†å¦ä¸€ä¸ªæœªæäº¤äº‹åŠ¡ä¿®æ”¹è¿‡çš„æ•°æ®ï¼Œæˆ‘ä»¬å°±ç§°å‘ç”Ÿäº†è„è¯»ç°è±¡ã€‚\n\n##### 1.3.2 ä¸å¯é‡å¤è¯»\n\n> åŒä¸€ä¸ªäº‹åŠ¡å†…ï¼Œå‰åå¤šæ¬¡è¯»å–ï¼Œè¯»å–åˆ°çš„æ•°æ®å†…å®¹ä¸ä¸€è‡´\n\n##### 1.3.3 å¹»è¯»\n\n> å¦‚æœä¸€ä¸ªäº‹åŠ¡å…ˆæ ¹æ®æŸäº›æœç´¢æ¡ä»¶æŸ¥è¯¢å‡ºä¸€äº›è®°å½•ï¼Œåœ¨è¯¥äº‹åŠ¡æœªæäº¤æ—¶ï¼Œå¦ä¸€ä¸ªäº‹åŠ¡å†™å…¥äº†ä¸€äº›ç¬¦åˆé‚£äº›æœç´¢æ¡ä»¶çš„è®°å½•ï¼ˆå¦‚insertã€deleteã€updateï¼‰ï¼Œä¸¤æ¬¡è¯»å–åˆ°çš„ç»“æœé›†å´ä¸ä¸€æ ·äº†ï¼Œå°±æ„å‘³ç€å‘ç”Ÿäº†**å¹»è¯»**ã€‚\n\n#### 1.4 å››å¤§éš”ç¦»çº§åˆ«\n\nä¸ºäº†è§£å†³å¹¶å‘äº‹åŠ¡å­˜åœ¨çš„**è„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»**ç­‰é—®é¢˜ï¼Œæ•°æ®åº“å¤§å”è®¾è®¡äº†å››ç§éš”ç¦»çº§åˆ«ã€‚åˆ†åˆ«æ˜¯**è¯»æœªæäº¤ï¼Œè¯»å·²æäº¤ï¼Œå¯é‡å¤è¯»ï¼Œä¸²è¡ŒåŒ–ï¼ˆSerializableï¼‰**ã€‚\n\n##### 1.4.1 è¯»æœªæäº¤\n\nè¯»æœªæäº¤éš”ç¦»çº§åˆ«ï¼Œåªé™åˆ¶äº†ä¸¤ä¸ªæ•°æ®**ä¸èƒ½åŒæ—¶ä¿®æ”¹**ï¼Œä½†æ˜¯ä¿®æ”¹æ•°æ®çš„æ—¶å€™ï¼Œå³ä½¿äº‹åŠ¡**æœªæäº¤**ï¼Œéƒ½æ˜¯å¯ä»¥è¢«åˆ«çš„äº‹åŠ¡è¯»å–åˆ°çš„ï¼Œè¿™çº§åˆ«çš„äº‹åŠ¡éš”ç¦»æœ‰**è„è¯»ã€é‡å¤è¯»ã€å¹»è¯»**çš„é—®é¢˜ï¼›\n\n##### 1.4.2 è¯»å·²æäº¤\n\nè¯»å·²æäº¤éš”ç¦»çº§åˆ«ï¼Œå½“å‰äº‹åŠ¡åªèƒ½è¯»å–åˆ°å…¶ä»–äº‹åŠ¡**æäº¤**çš„æ•°æ®ï¼Œæ‰€ä»¥è¿™ç§äº‹åŠ¡çš„éš”ç¦»çº§åˆ«**è§£å†³äº†è„è¯»**é—®é¢˜ï¼Œä½†è¿˜æ˜¯ä¼šå­˜åœ¨**é‡å¤è¯»ã€å¹»è¯»**é—®é¢˜ï¼›\n\n##### 1.4 3 å¯é‡å¤è¯»\n\nå¯é‡å¤è¯»éš”ç¦»çº§åˆ«ï¼Œé™åˆ¶äº†è¯»å–æ•°æ®çš„æ—¶å€™ï¼Œä¸å¯ä»¥è¿›è¡Œä¿®æ”¹ï¼Œæ‰€ä»¥**è§£å†³äº†é‡å¤è¯»**çš„é—®é¢˜ï¼Œä½†æ˜¯è¯»å–èŒƒå›´æ•°æ®çš„æ—¶å€™ï¼Œæ˜¯å¯ä»¥æ’å…¥æ•°æ®ï¼Œæ‰€ä»¥è¿˜ä¼šå­˜åœ¨**å¹»è¯»**é—®é¢˜ï¼›\n\n##### 1.4.4 ä¸²è¡ŒåŒ–\n\näº‹åŠ¡æœ€é«˜çš„éš”ç¦»çº§åˆ«ï¼Œåœ¨è¯¥çº§åˆ«ä¸‹ï¼Œæ‰€æœ‰äº‹åŠ¡éƒ½æ˜¯è¿›è¡Œ**ä¸²è¡ŒåŒ–é¡ºåº**æ‰§è¡Œçš„ã€‚å¯ä»¥é¿å…è„è¯»ã€ä¸å¯é‡å¤è¯»ä¸å¹»è¯»æ‰€æœ‰å¹¶å‘é—®é¢˜ã€‚ä½†æ˜¯è¿™ç§äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸‹ï¼Œäº‹åŠ¡æ‰§è¡Œå¾ˆè€—æ€§èƒ½ã€‚\n\n##### 1.4.5 å››å¤§éš”ç¦»çº§åˆ«ï¼Œéƒ½ä¼šå­˜åœ¨å“ªäº›å¹¶å‘é—®é¢˜å‘¢\n\n| éš”ç¦»çº§åˆ« | è„è¯» | ä¸å¯é‡å¤è¯» | å¹»è¯» |\n| -------- | ---- | ---------- | ---- |\n| è¯»æœªæäº¤ | âˆš    | âˆš          | âˆš    |\n| è¯»å·²æäº¤ | Ã—    | âˆš          | âˆš    |\n| å¯é‡å¤è¯» | Ã—    | Ã—          | âˆš    |\n| ä¸²è¡ŒåŒ–   | Ã—    | Ã—          | Ã—    |\n\n#### 1.5 æ•°æ®åº“æ˜¯å¦‚ä½•ä¿è¯äº‹åŠ¡çš„éš”ç¦»æ€§çš„å‘¢ï¼Ÿ\n\næ•°æ®åº“æ˜¯é€šè¿‡**åŠ é”**ï¼Œæ¥å®ç°äº‹åŠ¡çš„éš”ç¦»æ€§çš„ã€‚è¿™å°±å¥½åƒï¼Œå¦‚æœä½ æƒ³ä¸€ä¸ªäººé™é™ï¼Œä¸è¢«åˆ«äººæ‰“æ‰°ï¼Œä½ å°±å¯ä»¥åœ¨æˆ¿é—¨ä¸ŠåŠ ä¸Šä¸€æŠŠé”ã€‚\n\nåŠ é”ç¡®å®å¥½ä½¿ï¼Œå¯ä»¥ä¿è¯éš”ç¦»æ€§ã€‚æ¯”å¦‚**ä¸²è¡ŒåŒ–éš”ç¦»çº§åˆ«å°±æ˜¯åŠ é”å®ç°çš„**ã€‚ä½†æ˜¯é¢‘ç¹çš„åŠ é”ï¼Œå¯¼è‡´è¯»æ•°æ®æ—¶ï¼Œæ²¡åŠæ³•ä¿®æ”¹ï¼Œä¿®æ”¹æ•°æ®æ—¶ï¼Œæ²¡åŠæ³•è¯»å–ï¼Œå¤§å¤§**é™ä½äº†æ•°æ®åº“æ€§èƒ½**ã€‚\n\n**é‚£ä¹ˆï¼Œå¦‚ä½•è§£å†³åŠ é”åçš„æ€§èƒ½é—®é¢˜çš„ï¼Ÿ**\n\nç­”æ¡ˆå°±æ˜¯,**MVCCå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶**ï¼å®ƒå®ç°è¯»å–æ•°æ®ä¸ç”¨åŠ é”ï¼Œå¯ä»¥è®©è¯»å–æ•°æ®åŒæ—¶ä¿®æ”¹ã€‚ä¿®æ”¹æ•°æ®æ—¶åŒæ—¶å¯è¯»å–ã€‚\n\n### 2. ä»€ä¹ˆæ˜¯ MVCCï¼Ÿ\n\nMVCCï¼Œå³**Multi-Version  Concurrency Control ï¼ˆå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼‰**ã€‚å®ƒæ˜¯ä¸€ç§å¹¶å‘æ§åˆ¶çš„æ–¹æ³•ï¼Œä¸€èˆ¬åœ¨æ•°æ®åº“ç®¡ç†ç³»ç»Ÿä¸­ï¼Œå®ç°å¯¹æ•°æ®åº“çš„å¹¶å‘è®¿é—®ï¼Œåœ¨ç¼–ç¨‹è¯­è¨€ä¸­å®ç°äº‹åŠ¡å†…å­˜ã€‚\n\n> é€šä¿—çš„è®²ï¼Œæ•°æ®åº“ä¸­åŒæ—¶å­˜åœ¨å¤šä¸ªç‰ˆæœ¬çš„æ•°æ®ï¼Œå¹¶ä¸æ˜¯æ•´ä¸ªæ•°æ®åº“çš„å¤šä¸ªç‰ˆæœ¬ï¼Œè€Œæ˜¯æŸä¸€æ¡è®°å½•çš„å¤šä¸ªç‰ˆæœ¬åŒæ—¶å­˜åœ¨ï¼Œåœ¨æŸä¸ªäº‹åŠ¡å¯¹å…¶è¿›è¡Œæ“ä½œçš„æ—¶å€™ï¼Œéœ€è¦æŸ¥çœ‹è¿™ä¸€æ¡è®°å½•çš„éšè—åˆ—äº‹åŠ¡ç‰ˆæœ¬idï¼Œæ¯”å¯¹äº‹åŠ¡idå¹¶æ ¹æ®äº‹ç‰©éš”ç¦»çº§åˆ«å»åˆ¤æ–­è¯»å–å“ªä¸ªç‰ˆæœ¬çš„æ•°æ®ã€‚\n\næ•°æ®åº“éš”ç¦»çº§åˆ«**è¯»å·²æäº¤ã€å¯é‡å¤è¯»** éƒ½æ˜¯åŸºäº MVCC å®ç°çš„ï¼Œç›¸å¯¹äºåŠ é”ç®€å•ç²—æš´çš„æ–¹å¼ï¼Œå®ƒç”¨æ›´å¥½çš„æ–¹å¼å»å¤„ç†è¯»å†™å†²çªï¼Œèƒ½æœ‰æ•ˆæé«˜æ•°æ®åº“å¹¶å‘æ€§èƒ½ã€‚\n\n### 3. MVCCå®ç°çš„å…³é”®çŸ¥è¯†ç‚¹\n\n#### 3.1 äº‹åŠ¡ç‰ˆæœ¬å·\n\n> äº‹åŠ¡æ¯æ¬¡å¼€å¯å‰ï¼Œéƒ½ä¼šä»æ•°æ®åº“è·å¾—ä¸€ä¸ª**è‡ªå¢é•¿**çš„äº‹åŠ¡IDï¼Œå¯ä»¥ä»äº‹åŠ¡IDåˆ¤æ–­äº‹åŠ¡çš„æ‰§è¡Œå…ˆåé¡ºåºã€‚è¿™å°±æ˜¯äº‹åŠ¡ç‰ˆæœ¬å·ã€‚\n\n#### 3.2 éšå¼å­—æ®µ\n\nå¯¹äº InnoDB å­˜å‚¨å¼•æ“ï¼Œæ¯ä¸€è¡Œè®°å½•éƒ½æœ‰ä¸¤ä¸ªéšè—åˆ—**trx_id**ã€**roll_pointer**ï¼Œå¦‚æœè¡¨ä¸­æ²¡æœ‰ä¸»é”®å’Œé NULL å”¯ä¸€é”®æ—¶ï¼Œåˆ™è¿˜ä¼šæœ‰ç¬¬ä¸‰ä¸ªéšè—çš„ä¸»é”®åˆ—**row_id**ã€‚\n\n| åˆ—å         | æ˜¯å¦å¿…é¡» | æè¿°                                                     |\n| ------------ | -------- | -------------------------------------------------------- |\n| row_id       | å¦       | å•è°ƒé€’å¢çš„è¡ŒIDï¼Œä¸æ˜¯å¿…éœ€çš„ï¼Œå ç”¨6ä¸ªå­—èŠ‚ã€‚                |\n| trx_id       | æ˜¯       | è®°å½•æ“ä½œè¯¥æ•°æ®äº‹åŠ¡çš„**äº‹åŠ¡ID**                           |\n| roll_pointer | æ˜¯       | è¿™ä¸ªéšè—åˆ—å°±ç›¸å½“äºä¸€ä¸ª**å›æ»šæŒ‡é’ˆ**ï¼ŒæŒ‡å‘å›æ»šæ®µçš„undoæ—¥å¿— |\n\n#### 3.3 undo log\n\nundo logï¼Œ**å›æ»šæ—¥å¿—**ï¼Œç”¨äº**è®°å½•æ•°æ®è¢«ä¿®æ”¹å‰**çš„ä¿¡æ¯ã€‚åœ¨è¡¨è®°å½•ä¿®æ”¹ä¹‹å‰ï¼Œä¼šå…ˆæŠŠæ•°æ®æ‹·è´åˆ° undo log é‡Œï¼Œå¦‚æœäº‹åŠ¡å›æ»šï¼Œå³å¯ä»¥é€šè¿‡ undo log æ¥è¿˜åŸæ•°æ®ã€‚\n\nå¯ä»¥è¿™æ ·è®¤ä¸ºï¼Œå½“ delete ä¸€æ¡è®°å½•æ—¶ï¼Œundo log ä¸­ä¼šè®°å½•ä¸€æ¡å¯¹åº”çš„ insert è®°å½•ï¼Œå½“ update ä¸€æ¡è®°å½•æ—¶ï¼Œå®ƒè®°å½•ä¸€æ¡å¯¹åº”ç›¸åçš„ update è®°å½•ã€‚\n\nundo log æœ‰ä»€ä¹ˆ**ç”¨é€”**å‘¢ï¼Ÿ\n\n1. äº‹åŠ¡å›æ»šæ—¶ï¼Œä¿è¯åŸå­æ€§å’Œä¸€è‡´æ€§ã€‚\n2. ç”¨äº MVCC**å¿«ç…§è¯»**ã€‚\n\n#### 3.4 ç‰ˆæœ¬é“¾\n\nå¤šä¸ªäº‹åŠ¡å¹¶è¡Œæ“ä½œæŸä¸€è¡Œæ•°æ®æ—¶ï¼Œä¸åŒäº‹åŠ¡å¯¹è¯¥è¡Œæ•°æ®çš„ä¿®æ”¹ä¼šäº§ç”Ÿå¤šä¸ªç‰ˆæœ¬ï¼Œç„¶åé€šè¿‡å›æ»šæŒ‡é’ˆï¼ˆroll_pointerï¼‰ï¼Œè¿æˆä¸€ä¸ªé“¾è¡¨ï¼Œè¿™ä¸ªé“¾è¡¨å°±ç§°ä¸º**ç‰ˆæœ¬é“¾**ã€‚å¦‚ä¸‹ï¼š\n\n![image-20220422131424393](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131424393.png)\n\nå…¶å®ï¼Œé€šè¿‡ç‰ˆæœ¬é“¾ï¼Œæˆ‘ä»¬å°±å¯ä»¥çœ‹å‡º**äº‹åŠ¡ç‰ˆæœ¬å·ã€è¡¨æ ¼éšè—çš„åˆ—å’Œundo log**å®ƒä»¬ä¹‹é—´çš„å…³ç³»ã€‚æˆ‘ä»¬å†æ¥å°åˆ†æä¸€ä¸‹ã€‚\n\n1. å‡è®¾ç°åœ¨æœ‰ä¸€å¼  core_user è¡¨ï¼Œè¡¨é‡Œé¢æœ‰ä¸€æ¡æ•°æ®,id ä¸º 1ï¼Œåå­—ä¸ºå­™æƒï¼š\n\n\t<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131445316.png\" alt=\"image-20220422131445316\" style=\"zoom: 50%;\" />\n\n2. ç°åœ¨å¼€å¯ä¸€ä¸ªäº‹åŠ¡ Aï¼š å¯¹ core_user è¡¨æ‰§è¡Œ`update core_user set name =\"æ›¹æ“\" where id=1`,ä¼šè¿›è¡Œå¦‚ä¸‹æµç¨‹æ“ä½œ\n\n- é¦–å…ˆè·å¾—ä¸€ä¸ªäº‹åŠ¡ ID=100\n- æŠŠ core_user è¡¨ä¿®æ”¹å‰çš„æ•°æ®,æ‹·è´åˆ° undo log\n- ä¿®æ”¹ core_user è¡¨ä¸­ï¼Œid=1 çš„æ•°æ®ï¼Œåå­—æ”¹ä¸ºæ›¹æ“\n- æŠŠä¿®æ”¹åçš„æ•°æ®äº‹åŠ¡ Id=101 æ”¹æˆå½“å‰äº‹åŠ¡ç‰ˆæœ¬å·ï¼Œå¹¶æŠŠ**roll_pointer**æŒ‡å‘ undo log æ•°æ®åœ°å€ã€‚\n\n\t<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131527508.png\" alt=\"image-20220422131527508\" style=\"zoom: 50%;\" />\n\n#### 3.5 å¿«ç…§è¯»å’Œå½“å‰è¯»\n\n**å¿«ç…§è¯»ï¼š** è¯»å–çš„æ˜¯è®°å½•æ•°æ®çš„å¯è§ç‰ˆæœ¬ï¼ˆæœ‰æ—§çš„ç‰ˆæœ¬ï¼‰ã€‚ä¸åŠ é”,æ™®é€šçš„ select è¯­å¥éƒ½æ˜¯å¿«ç…§è¯»,å¦‚ï¼š\n\n```\nselect * from core_user where id > 2;\n```\n\n**å½“å‰è¯»**ï¼šè¯»å–çš„æ˜¯è®°å½•æ•°æ®çš„æœ€æ–°ç‰ˆæœ¬ï¼Œæ˜¾å¼åŠ é”çš„éƒ½æ˜¯å½“å‰è¯»\n\n```\nselect * from core_user where id > 2 for update;\n```\n\n#### 3.6 Read View\n\n- **Read Viewæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ** å®ƒå°±æ˜¯äº‹åŠ¡æ‰§è¡Œ SQL è¯­å¥æ—¶ï¼Œäº§ç”Ÿçš„è¯»è§†å›¾ã€‚å®é™…ä¸Šåœ¨ innodb ä¸­ï¼Œæ¯ä¸ª SQL è¯­å¥æ‰§è¡Œå‰éƒ½ä¼šå¾—åˆ°ä¸€ä¸ª Read Viewã€‚\n- **Read Viewæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ** å®ƒä¸»è¦æ˜¯ç”¨æ¥åšå¯è§æ€§åˆ¤æ–­çš„ï¼Œå³åˆ¤æ–­å½“å‰äº‹åŠ¡å¯è§å“ªä¸ªç‰ˆæœ¬çš„æ•°æ®\n\nRead View æ˜¯å¦‚ä½•ä¿è¯å¯è§æ€§åˆ¤æ–­çš„å‘¢ï¼Ÿæˆ‘ä»¬å…ˆçœ‹çœ‹ Read view çš„å‡ ä¸ªé‡è¦å±æ€§\n\n- m_ids:å½“å‰ç³»ç»Ÿä¸­é‚£äº›æ´»è·ƒ(**æœªæäº¤**)çš„è¯»å†™äº‹åŠ¡ ID, å®ƒæ•°æ®ç»“æ„ä¸ºä¸€ä¸ª Listï¼Œ[min_limit_id, max_limit_id)\n- min_limit_id:è¡¨ç¤ºåœ¨ç”Ÿæˆ ReadView æ—¶ï¼Œå½“å‰ç³»ç»Ÿä¸­æ´»è·ƒçš„è¯»å†™äº‹åŠ¡ä¸­æœ€å°çš„äº‹åŠ¡ idï¼Œå³ m_ids ä¸­çš„æœ€å°å€¼ã€‚\n- max_limit_id:è¡¨ç¤ºç”Ÿæˆ ReadView æ—¶ï¼Œç³»ç»Ÿä¸­åº”è¯¥åˆ†é…ç»™ä¸‹ä¸€ä¸ªäº‹åŠ¡çš„ id å€¼ï¼Œå³å³ m_ids ä¸­çš„æœ€å¤§å€¼+1\n- creator_trx_id: åˆ›å»ºå½“å‰ read view çš„äº‹åŠ¡ ID\n\n**Read view åŒ¹é…æ¡ä»¶è§„åˆ™**å¦‚ä¸‹ï¼š\n\n1. å¦‚æœæ–°çš„æ•°æ®äº‹åŠ¡ ID `trx_id < min_limit_id`ï¼Œè¡¨æ˜ç”Ÿæˆè¯¥ç‰ˆæœ¬çš„äº‹åŠ¡åœ¨ç”Ÿæˆ Read View å‰ï¼Œå·²ç»æäº¤(å› ä¸ºäº‹åŠ¡ ID æ˜¯é€’å¢çš„)ï¼Œæ‰€ä»¥è¯¥ç‰ˆæœ¬å¯ä»¥è¢«å½“å‰äº‹åŠ¡è®¿é—®ã€‚\n2. å¦‚æœ`trx_id>= max_limit_id`ï¼Œè¡¨æ˜ç”Ÿæˆè¯¥ç‰ˆæœ¬çš„äº‹åŠ¡åœ¨ç”Ÿæˆ ReadView åæ‰ç”Ÿæˆï¼Œæ‰€ä»¥è¯¥ç‰ˆæœ¬ä¸å¯ä»¥è¢«å½“å‰äº‹åŠ¡è®¿é—®ã€‚\n3. å¦‚æœ `min_limit_id =<trx_id< max_limit_id`,éœ€è¦åˆ† 3 ç§æƒ…å†µè®¨è®º\n\n> ï¼ˆ1ï¼‰å¦‚æœ`m_ids`åŒ…å«`trx_id`,åˆ™ä»£è¡¨Read Viewç”Ÿæˆæ—¶åˆ»ï¼Œè¿™ä¸ªäº‹åŠ¡è¿˜æœªæäº¤ï¼Œä½†æ˜¯å¦‚æœæ•°æ®çš„`trx_id`ç­‰äº`creator_trx_id`çš„è¯ï¼Œè¡¨æ˜æ•°æ®æ˜¯è‡ªå·±ç”Ÿæˆçš„ï¼Œå› æ­¤æ˜¯**å¯è§**çš„ã€‚\n>\n> ï¼ˆ2ï¼‰å¦‚æœ`m_ids`åŒ…å«`trx_id`ï¼Œå¹¶ä¸”`trx_id`ä¸ç­‰äº`creator_trx_id`ï¼Œåˆ™Read  Viewç”Ÿæˆæ—¶ï¼Œäº‹åŠ¡æœªæäº¤ï¼Œå¹¶ä¸”ä¸æ˜¯è‡ªå·±ç”Ÿäº§çš„ï¼Œæ‰€ä»¥å½“å‰äº‹åŠ¡ä¹Ÿæ˜¯**çœ‹ä¸è§**çš„ï¼›\n>\n> ï¼ˆ3ï¼‰å¦‚æœ`m_ids`ä¸åŒ…å«`trx_id`ï¼Œåˆ™è¯´æ˜ä½ è¿™ä¸ªäº‹åŠ¡åœ¨Read Viewç”Ÿæˆä¹‹å‰å°±**å·²ç»æäº¤**äº†ï¼Œä¿®æ”¹çš„ç»“æœï¼Œå½“å‰äº‹åŠ¡æ˜¯èƒ½çœ‹è§çš„ã€‚\n\n### 4. MVCCå®ç°åŸç†åˆ†æ\n\n<img src=\"/Users/yaxing/blog/source/_posts/E:/Markdown%E6%96%87%E6%A1%A3%E5%9B%BE%E7%89%87/8%20MySQL.assets/v2-a086ef515e7d0a023ca3cfcc5759c7f6_720w.jpg\" alt=\"img\" style=\"zoom: 80%;\" />\n\n#### 4.1 æŸ¥è¯¢ä¸€æ¡è®°å½•ï¼ŒåŸºäºMVCCï¼Œæ˜¯æ€æ ·çš„æµç¨‹\n\n1. è·å–äº‹åŠ¡ ID\n2. æ‰§è¡Œ sqlï¼Œå¾—åˆ° Read View\n3. æŸ¥è¯¢å¾—åˆ°çš„æ•°æ®ï¼Œç„¶åä¸ Read View ä¸­çš„äº‹åŠ¡ ID è¿›è¡Œæ¯”è¾ƒï¼Œå¸®åŠ©åˆ¤æ–­å½“å‰ç‰ˆæœ¬çš„æ•°æ®æ˜¯å¦å¯è§ã€‚\n4. å¦‚æœä¸ç¬¦åˆ Read View çš„å¯è§æ€§è§„åˆ™ï¼Œ å³å°±éœ€è¦ Undo log ä¸­å†å²å¿«ç…§;\n5. æœ€åè¿”å›ç¬¦åˆè§„åˆ™çš„æ•°æ®\n\nInnoDB å®ç° MVCCï¼Œæ˜¯é€šè¿‡` Read View+ Undo Log` å®ç°çš„ï¼ŒUndo Log ä¿å­˜äº†å†å²å¿«ç…§ï¼ŒRead View å¯è§æ€§è§„åˆ™å¸®åŠ©åˆ¤æ–­å½“å‰ç‰ˆæœ¬çš„æ•°æ®æ˜¯å¦å¯è§ã€‚\n\n#### 4.2 è¯»å·²æäº¤ï¼ˆRCï¼‰éš”ç¦»çº§åˆ«ï¼Œå­˜åœ¨ä¸å¯é‡å¤è¯»é—®é¢˜çš„åˆ†æå†ç¨‹\n\n1. åˆ›å»º core_user è¡¨ï¼Œæ’å…¥ä¸€æ¡åˆå§‹åŒ–æ•°æ®,å¦‚ä¸‹ï¼š\n\n\t<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131554547.png\" alt=\"image-20220422131554547\" style=\"zoom: 33%;\" />\n\n2. éš”ç¦»çº§åˆ«è®¾ç½®ä¸ºè¯»å·²æäº¤ï¼ˆRCï¼‰ï¼Œäº‹åŠ¡ A å’Œäº‹åŠ¡ B åŒæ—¶å¯¹ core_user è¡¨è¿›è¡ŒæŸ¥è¯¢å’Œä¿®æ”¹æ“ä½œã€‚\n\n```\näº‹åŠ¡A: select * fom core_user where id=1\näº‹åŠ¡B: update core_user set name =â€æ›¹æ“â€\n// äº‹åŠ¡Aä¸¤æ¬¡è¯»åˆ°çš„æ•°æ®ä¸ä¸€æ ·ï¼Œäº‹åŠ¡Aä¼šè¯»åˆ°å…¶ä»–äº‹åŠ¡æäº¤çš„æ•°æ®ï¼Œä¸èƒ½è¯»åˆ°å…¶ä»–äº‹åŠ¡æœªæäº¤çš„æ•°æ®ã€‚\n```\n\næ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131620047.png\" alt=\"image-20220422131620047\" style=\"zoom: 33%;\" />\n\næœ€åäº‹åŠ¡ A æŸ¥è¯¢åˆ°çš„ç»“æœæ˜¯ï¼Œ**name=æ›¹æ“**çš„è®°å½•ï¼Œæˆ‘ä»¬**åŸºäºMVCC**ï¼Œæ¥åˆ†æä¸€ä¸‹æ‰§è¡Œæµç¨‹ï¼š\n\n(1) A å¼€å¯äº‹åŠ¡ï¼Œé¦–å…ˆå¾—åˆ°ä¸€ä¸ªäº‹åŠ¡ ID ä¸º 100\n\n(2) B å¼€å¯äº‹åŠ¡ï¼Œå¾—åˆ°äº‹åŠ¡ ID ä¸º 101\n\n(3) äº‹åŠ¡ A ç”Ÿæˆä¸€ä¸ª Read Viewï¼Œread view å¯¹åº”çš„å€¼å¦‚ä¸‹\n\n| å˜é‡                                                    | å€¼       |\n| ------------------------------------------------------- | -------- |\n| m_idsï¼ˆæœªæäº¤çš„äº‹åŠ¡IDï¼‰                                 | 100ï¼Œ101 |\n| max_limit_idï¼ˆä¸‹ä¸€ä¸ªåº”è¯¥åˆ†é…çš„äº‹åŠ¡IDï¼‰                  | 102      |\n| min_limit_idï¼ˆå½“å‰read viewä¸­æ´»è·ƒçš„æœªæäº¤äº‹åŠ¡çš„æœ€å°å€¼ï¼‰ | 100      |\n| creator_trx_idï¼ˆåˆ›å»ºè¯¥read viewçš„äº‹åŠ¡IDï¼‰               | 100      |\n\nç„¶åå›åˆ°ç‰ˆæœ¬é“¾ï¼šå¼€å§‹ä»ç‰ˆæœ¬é“¾ä¸­æŒ‘é€‰å¯è§çš„è®°å½•ï¼š\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131642264.png\" alt=\"image-20220422131642264\" style=\"zoom: 33%;\" />\n\nç”±å›¾å¯ä»¥çœ‹å‡ºï¼Œæœ€æ–°ç‰ˆæœ¬çš„åˆ— name çš„å†…å®¹æ˜¯`å­™æƒ`ï¼Œè¯¥ç‰ˆæœ¬çš„`trx_id`å€¼ä¸º 100ã€‚å¼€å§‹æ‰§è¡Œ read view å¯è§æ€§è§„åˆ™æ ¡éªŒï¼š\n\n```\nmin_limit_id(100)=<trx_idï¼ˆ100ï¼‰<102;\ncreator_trx_id = trx_id =100;\n```\n\nç”±æ­¤å¯å¾—ï¼Œtrx_id=100 çš„è¿™ä¸ªè®°å½•ï¼Œå½“å‰äº‹åŠ¡æ˜¯å¯è§çš„ã€‚æ‰€ä»¥æŸ¥åˆ°æ˜¯ name ä¸º`å­™æƒ`çš„è®°å½•ã€‚\n\n(4) äº‹åŠ¡ B è¿›è¡Œä¿®æ”¹æ“ä½œï¼ŒæŠŠåå­—æ”¹ä¸ºæ›¹æ“ã€‚æŠŠåŸæ•°æ®æ‹·è´åˆ° undo log,ç„¶åå¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œæ ‡è®°äº‹åŠ¡ ID å’Œä¸Šä¸€ä¸ªæ•°æ®ç‰ˆæœ¬åœ¨ undo log çš„åœ°å€ã€‚\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131733370.png\" alt=\"image-20220422131733370\" style=\"zoom:33%;\" />\n\n(5) æäº¤äº‹åŠ¡\n\n(6) äº‹åŠ¡ A å†æ¬¡æ‰§è¡ŒæŸ¥è¯¢æ“ä½œï¼Œ**æ–°ç”Ÿæˆä¸€ä¸ªRead View**ï¼ŒRead View å¯¹åº”çš„å€¼å¦‚ä¸‹\n\n| å˜é‡                                    | å€¼   |\n| --------------------------------------- | ---- |\n| m_idsï¼ˆæœªæäº¤çš„äº‹åŠ¡IDï¼‰                 | 100  |\n| max_limit_idï¼ˆä¸‹ä¸€ä¸ªåº”å½“åˆ†é…çš„äº‹åŠ¡IDï¼‰  | 102  |\n| min_limit_idï¼ˆæœ€å°çš„äº‹åŠ¡IDï¼‰            | 100  |\n| creator_trx_idï¼ˆåˆ›å»ºread viewçš„äº‹åŠ¡IDï¼‰ | 100  |\n\nç„¶åå†æ¬¡å›åˆ°ç‰ˆæœ¬é“¾ï¼šä»ç‰ˆæœ¬é“¾ä¸­æŒ‘é€‰å¯è§çš„è®°å½•ï¼š\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131753554.png\" alt=\"image-20220422131753554\" style=\"zoom:33%;\" />\n\nä»å›¾å¯å¾—ï¼Œæœ€æ–°ç‰ˆæœ¬çš„åˆ— name çš„å†…å®¹æ˜¯`æ›¹æ“`ï¼Œè¯¥ç‰ˆæœ¬çš„`trx_id`å€¼ä¸º 101ã€‚å¼€å§‹æ‰§è¡Œ Read View å¯è§æ€§è§„åˆ™æ ¡éªŒï¼š\n\n```\nmin_limit_id(100)=<trx_idï¼ˆ101ï¼‰<max_limit_idï¼ˆ102);\nä½†æ˜¯,trx_id=101ï¼Œä¸å±äºm_idsé›†åˆï¼Œè¯´æ˜101è¿™ä¸ªäº‹åŠ¡å·²ç»æäº¤äº†ï¼Œå½“å‰äº‹åŠ¡å¯è§\n```\n\nå› æ­¤ï¼Œ`trx_id=101`è¿™ä¸ªè®°å½•ï¼Œå¯¹äºå½“å‰äº‹åŠ¡æ˜¯å¯è§çš„ã€‚æ‰€ä»¥ SQL æŸ¥è¯¢åˆ°çš„æ˜¯ name ä¸º`æ›¹æ“`çš„è®°å½•ã€‚\n\nç»¼ä¸Šæ‰€è¿°ï¼Œåœ¨**è¯»å·²æäº¤ï¼ˆRCï¼‰éš”ç¦»çº§åˆ«**ä¸‹ï¼ŒåŒä¸€ä¸ªäº‹åŠ¡é‡Œï¼Œä¸¤ä¸ªç›¸åŒçš„æŸ¥è¯¢ï¼Œè¯»å–åŒä¸€æ¡è®°å½•ï¼ˆid=1ï¼‰ï¼Œå´è¿”å›äº†ä¸åŒçš„æ•°æ®ï¼ˆ**ç¬¬ä¸€æ¬¡æŸ¥å‡ºæ¥æ˜¯å­™æƒï¼Œç¬¬äºŒæ¬¡æŸ¥å‡ºæ¥æ˜¯æ›¹æ“é‚£æ¡è®°å½•**ï¼‰ï¼Œå› æ­¤ RC éš”ç¦»çº§åˆ«ï¼Œå­˜åœ¨**ä¸å¯é‡å¤è¯»**å¹¶å‘é—®é¢˜ã€‚\n\n#### 4.3 å¯é‡å¤è¯»ï¼ˆRRï¼‰éš”ç¦»çº§åˆ«ï¼Œè§£å†³ä¸å¯é‡å¤è¯»é—®é¢˜çš„åˆ†æ\n\nåœ¨ RR éš”ç¦»çº§åˆ«ä¸‹ï¼Œæ˜¯å¦‚ä½•è§£å†³ä¸å¯é‡å¤è¯»é—®é¢˜çš„å‘¢ï¼Ÿæˆ‘ä»¬ä¸€èµ·å†æ¥çœ‹ä¸‹ï¼Œ\n\nè¿˜æ˜¯ 4.2 å°èŠ‚é‚£ä¸ªæµç¨‹ï¼Œè¿˜æ˜¯è¿™ä¸ªäº‹åŠ¡ A å’Œäº‹åŠ¡ Bï¼Œå¦‚ä¸‹ï¼š\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131811671.png\" alt=\"image-20220422131811671\" style=\"zoom:33%;\" />\n\n##### 4.3.1 ä¸åŒéš”ç¦»çº§åˆ«ä¸‹ï¼ŒRead viewçš„å·¥ä½œæ–¹å¼ä¸åŒ\n\nå®é™…ä¸Šï¼Œå„ç§äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸‹çš„ Read view å·¥ä½œæ–¹å¼ï¼Œæ˜¯ä¸ä¸€æ ·çš„ï¼ŒRR å¯ä»¥è§£å†³ä¸å¯é‡å¤è¯»é—®é¢˜ï¼Œå°±æ˜¯è·Ÿ**Read viewå·¥ä½œæ–¹å¼æœ‰å…³**ã€‚\n\n- åœ¨è¯»å·²æäº¤ï¼ˆRCï¼‰éš”ç¦»çº§åˆ«ä¸‹ï¼ŒåŒä¸€ä¸ªäº‹åŠ¡é‡Œé¢ï¼Œ**æ¯ä¸€æ¬¡æŸ¥è¯¢éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„Read Viewå‰¯æœ¬**ï¼Œè¿™æ ·å°±å¯èƒ½é€ æˆåŒä¸€ä¸ªäº‹åŠ¡é‡Œå‰åè¯»å–æ•°æ®å¯èƒ½ä¸ä¸€è‡´çš„é—®é¢˜ï¼ˆä¸å¯é‡å¤è¯»å¹¶å‘é—®é¢˜ï¼‰ã€‚\n\n| begin                               |                   |\n| ----------------------------------- | ----------------- |\n| select * from core_user where id =1 | ç”Ÿæˆä¸€ä¸ªRead View |\n| /                                   | /                 |\n| /                                   | /                 |\n| select * from core_user where id =1 | ç”Ÿæˆä¸€ä¸ªRead View |\n\n- åœ¨å¯é‡å¤è¯»ï¼ˆRRï¼‰éš”ç¦»çº§åˆ«ä¸‹ï¼Œ**ä¸€ä¸ªäº‹åŠ¡é‡Œåªä¼šè·å–ä¸€æ¬¡read view**ï¼Œéƒ½æ˜¯å‰¯æœ¬å…±ç”¨çš„ï¼Œä»è€Œä¿è¯æ¯æ¬¡æŸ¥è¯¢çš„æ•°æ®éƒ½æ˜¯ä¸€æ ·çš„ã€‚\n\n| begin                               |                       |\n| ----------------------------------- | --------------------- |\n| select * from core_user where id =1 | ç”Ÿæˆä¸€ä¸ªRead View     |\n| /                                   |                       |\n| /                                   |                       |\n| select * from core_user where id =1 | å…±ç”¨ä¸€ä¸ªRead Viewå‰¯æœ¬ |\n\n##### 4.3.2 å®ä¾‹åˆ†æ\n\næˆ‘ä»¬ç©¿è¶Šä¸‹ï¼Œå›åˆ°**åˆš4.2çš„ä¾‹å­**ï¼Œç„¶åæ‰§è¡Œç¬¬ 2 ä¸ªæŸ¥è¯¢çš„æ—¶å€™ï¼š\n\näº‹åŠ¡ A å†æ¬¡æ‰§è¡ŒæŸ¥è¯¢æ“ä½œï¼Œå¤ç”¨è€çš„ Read View å‰¯æœ¬ï¼ŒRead View å¯¹åº”çš„å€¼å¦‚ä¸‹\n\n| å˜é‡           | å€¼       |\n| -------------- | -------- |\n| m_ids          | 100ï¼Œ101 |\n| max_limit_id   | 102      |\n| min_limit_id   | 100      |\n| creator_trx_id | 100      |\n\nç„¶åå†æ¬¡å›åˆ°ç‰ˆæœ¬é“¾ï¼šä»ç‰ˆæœ¬é“¾ä¸­æŒ‘é€‰å¯è§çš„è®°å½•ï¼š\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131828812.png\" alt=\"image-20220422131828812\" style=\"zoom:33%;\" />\n\nä»å›¾å¯å¾—ï¼Œæœ€æ–°ç‰ˆæœ¬çš„åˆ— name çš„å†…å®¹æ˜¯`æ›¹æ“`ï¼Œè¯¥ç‰ˆæœ¬çš„`trx_id`å€¼ä¸º 101ã€‚å¼€å§‹æ‰§è¡Œ read view å¯è§æ€§è§„åˆ™æ ¡éªŒï¼š\n\n```\nmin_limit_id(100)=<trx_idï¼ˆ101ï¼‰<max_limit_idï¼ˆ102);\nå› ä¸ºm_ids{100,101}åŒ…å«trx_idï¼ˆ101ï¼‰ï¼Œ\nå¹¶ä¸”creator_trx_id (100) ä¸ç­‰äºtrx_idï¼ˆ101ï¼‰\n```\n\næ‰€ä»¥ï¼Œ`trx_id=101`è¿™ä¸ªè®°å½•ï¼Œå¯¹äºå½“å‰äº‹åŠ¡æ˜¯**ä¸å¯è§**çš„ã€‚è¿™æ—¶å€™å‘¢ï¼Œç‰ˆæœ¬é“¾`roll_pointer`è·³åˆ°ä¸‹ä¸€ä¸ªç‰ˆæœ¬ï¼Œ`trx_id=100`è¿™ä¸ªè®°å½•ï¼Œå†æ¬¡æ ¡éªŒæ˜¯å¦å¯è§ï¼š\n\n```\nmin_limit_id(100)=<trx_idï¼ˆ100ï¼‰< max_limit_idï¼ˆ102);\nå› ä¸ºm_ids{100,101}åŒ…å«trx_idï¼ˆ100ï¼‰ï¼Œ\nå¹¶ä¸”creator_trx_id (100) ç­‰äºtrx_idï¼ˆ100ï¼‰\n```\n\næ‰€ä»¥ï¼Œ`trx_id=100`è¿™ä¸ªè®°å½•ï¼Œå¯¹äºå½“å‰äº‹åŠ¡æ˜¯**å¯è§**çš„ã€‚å³åœ¨å¯é‡å¤è¯»ï¼ˆRRï¼‰éš”ç¦»çº§åˆ«ä¸‹ï¼Œå¤ç”¨è€çš„ Read View å‰¯æœ¬ï¼Œè§£å†³äº†**ä¸å¯é‡å¤è¯»**çš„é—®é¢˜ã€‚\n\n#### 4.4 MVCCæ˜¯å¦è§£å†³äº†å¹»è¯»é—®é¢˜å‘¢ï¼Ÿ\n\nå¯¹äºå¹»è¯»æ¥è¯´ï¼Œå­˜åœ¨å½“å‰è¯»å’Œå¿«ç…§è¯»çš„æƒ…å†µï¼š\n\n1. RR éš”ç¦»çº§åˆ«ä¸‹ä¸ºäº†è§£å†³å¹»è¯»é—®é¢˜ï¼š**å¿«ç…§è¯»ä¾é MVCCæ§åˆ¶ï¼Œå½“å‰è¯»é€šè¿‡é—´éš™é”è§£å†³**ï¼›\n2. é—´éš™é”å’Œè¡Œé”åˆç§° Next-Key Locksï¼Œæ¯ä¸ª Next-Key Locks æ˜¯å‰å¼€åé—­åŒºé—´ï¼›\n3. é—´éš™é”çš„å¼•å…¥ï¼Œå¯èƒ½ä¼šå¯¼è‡´åŒæ ·è¯­å¥é”ä½æ›´å¤§çš„èŒƒå›´ï¼Œå½±å“å¹¶å‘åº¦ã€‚\n\nä½œè€…ï¼šæ¡ç”°èºçš„å°ç”·å­©\n\né“¾æ¥ï¼šhttps://juejin.cn/post/7016165148020703246\n\næ¥æºï¼šç¨€åœŸæ˜é‡‘\n\nè‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚\n\n## MySQLé”ç¯‡\n\n### ä»€ä¹ˆæ˜¯é”ï¼ŸMySQL ä¸­æä¾›äº†å‡ ç±»é”ï¼Ÿ\n\né”æ˜¯å®ç°æ•°æ®åº“å¹¶å‘æ§åˆ¶çš„é‡è¦æ‰‹æ®µï¼Œå¯ä»¥ä¿è¯æ•°æ®åº“åœ¨å¤šäººåŒæ—¶æ“ä½œæ—¶èƒ½å¤Ÿæ­£å¸¸è¿è¡Œã€‚\n\næ’ä»–é”ï¼ˆå†™é”ï¼‰ï¼Œå…±äº«é”ï¼ˆè¯»é”ï¼‰\nä¹è§‚é”ï¼Œæ‚²è§‚é”\nå…¨å±€é”ï¼Œè¡¨é”ï¼Œè¡Œé”ï¼Œé¡µé”\n\n### ä»€ä¹ˆæ˜¯æ­»é”ï¼Ÿ\n\næ­»é”æ˜¯æŒ‡ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„è¿›ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå› äº‰å¤ºèµ„æºè€Œé€ æˆçš„ä¸€ç§äº’ç›¸ç­‰å¾…çš„ç°è±¡,è‹¥æ— å¤–åŠ›ä½œç”¨,å®ƒä»¬éƒ½å°†æ— æ³•æ¨è¿›ä¸‹å»ã€‚æ­¤æ—¶ç§°ç³»ç»Ÿå¤„äºæ­»é”çŠ¶æ€æˆ–ç³»ç»Ÿäº§ç”Ÿäº†æ­»é”ï¼Œè¿™äº›æ°¸è¿œåœ¨äº’ç›¸ç­‰å¾…çš„è¿‡ç¨‹ç§°ä¸ºæ­»é”ã€‚\n\n### å¦‚ä½•å¤„ç†æ­»é”ï¼Ÿ\n\nå¯¹å¾…æ­»é”å¸¸è§çš„ä¸¤ç§ç­–ç•¥ï¼š\n\n*   è®¾ç½®è¶…æ—¶æ—¶é—´\n\n*   å‘ç°æ­»é”ä¹‹åï¼Œä¸»åŠ¨å›æ»šæ­»é”ä¸­çš„æŸä¸€ä¸ªäº‹åŠ¡ï¼Œè®©å…¶å®ƒäº‹åŠ¡ç»§ç»­æ‰§è¡Œã€‚\n\n### å¦‚ä½•é¿å…æ­»é”ï¼Ÿ\n\nä½¿ç”¨ SELECT â€¦ FOR UPDATE è¯­å¥æ¥è·å–å¿…è¦çš„é”ã€‚\n\n### ä»€ä¹ˆæ˜¯å…¨å±€é”ï¼Ÿå®ƒçš„åº”ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ\n\nå…¨å±€é”å°±æ˜¯å¯¹æ•´ä¸ªæ•°æ®åº“å®ä¾‹åŠ é”ï¼Œå®ƒçš„å…¸å‹ä½¿ç”¨åœºæ™¯å°±æ˜¯åšå…¨åº“é€»è¾‘å¤‡ä»½ã€‚ è¿™ä¸ªå‘½ä»¤å¯ä»¥ä½¿æ•´ä¸ªåº“å¤„äºåªè¯»çŠ¶æ€ã€‚ä½¿ç”¨è¯¥å‘½ä»¤ä¹‹åï¼Œæ•°æ®æ›´æ–°è¯­å¥ã€æ•°æ®å®šä¹‰è¯­å¥ã€æ›´æ–°ç±»äº‹åŠ¡çš„æäº¤è¯­å¥ç­‰æ“ä½œéƒ½ä¼šè¢«é˜»å¡ã€‚\n\n### ä»€ä¹ˆæ˜¯å…±äº«é”ï¼Ÿ\n\nå…±äº«é”åˆç§°è¯»é” (read lock)ï¼Œæ˜¯è¯»å–æ“ä½œåˆ›å»ºçš„é”ã€‚å…¶ä»–ç”¨æˆ·å¯ä»¥å¹¶å‘è¯»å–æ•°æ®ï¼Œä½†ä»»ä½•äº‹åŠ¡éƒ½ä¸èƒ½å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ï¼ˆè·å–æ•°æ®ä¸Šçš„æ’ä»–é”ï¼‰ï¼Œç›´åˆ°å·²é‡Šæ”¾æ‰€æœ‰å…±äº«é”ã€‚å½“å¦‚æœäº‹åŠ¡å¯¹è¯»é”è¿›è¡Œä¿®æ”¹æ“ä½œï¼Œå¾ˆå¯èƒ½ä¼šé€ æˆæ­»é”ã€‚\n\n### ä»€ä¹ˆæ˜¯æ’å®ƒé”ï¼Ÿ\n\næ’ä»–é” exclusive lockï¼ˆä¹Ÿå« writer lockï¼‰åˆç§°å†™é”ã€‚\n\nè‹¥æŸä¸ªäº‹ç‰©å¯¹æŸä¸€è¡ŒåŠ ä¸Šäº†æ’ä»–é”ï¼Œåªèƒ½è¿™ä¸ªäº‹åŠ¡å¯¹å…¶è¿›è¡Œè¯»å†™ï¼Œåœ¨æ­¤äº‹åŠ¡ç»“æŸä¹‹å‰ï¼Œå…¶ä»–äº‹åŠ¡ä¸èƒ½å¯¹å…¶è¿›è¡ŒåŠ ä»»ä½•é”ï¼Œå…¶ä»–è¿›ç¨‹å¯ä»¥è¯»å–,ä¸èƒ½è¿›è¡Œå†™æ“ä½œï¼Œéœ€ç­‰å¾…å…¶é‡Šæ”¾ã€‚\n\næ’å®ƒé”æ˜¯æ‚²è§‚é”çš„ä¸€ç§å®ç°ï¼Œåœ¨ä¸Šé¢æ‚²è§‚é”ä¹Ÿä»‹ç»è¿‡ã€‚\n\n### ä½¿ç”¨å…¨å±€é”ä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜ï¼Ÿ\n\nå¦‚æœåœ¨ä¸»åº“å¤‡ä»½ï¼Œåœ¨å¤‡ä»½æœŸé—´ä¸èƒ½æ›´æ–°ï¼Œä¸šåŠ¡åœæ‘†ï¼Œæ‰€ä»¥æ›´æ–°ä¸šåŠ¡ä¼šå¤„äºç­‰å¾…çŠ¶æ€ã€‚\n\nå¦‚æœåœ¨ä»åº“å¤‡ä»½ï¼Œåœ¨å¤‡ä»½æœŸé—´ä¸èƒ½æ‰§è¡Œä¸»åº“åŒæ­¥çš„ binlogï¼Œå¯¼è‡´ä¸»ä»å»¶è¿Ÿã€‚\n\nå¦‚æœä½¿ç”¨å…¨å±€é”è¿›è¡Œé€»è¾‘å¤‡ä»½å°±ä¼šè®©æ•´ä¸ªåº“æˆä¸ºåªè¯»çŠ¶æ€ï¼Œå¹¸å¥½å®˜æ–¹æ¨å‡ºäº†ä¸€ä¸ªé€»è¾‘å¤‡ä»½å·¥å…· MySQL dump æ¥è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œåªéœ€è¦åœ¨ä½¿ç”¨ MySQLdump æ—¶ï¼Œä½¿ç”¨å‚æ•° single-transaction å°±ä¼šåœ¨å¯¼å…¥æ•°æ®ä¹‹å‰å¯åŠ¨ä¸€ä¸ªäº‹åŠ¡æ¥ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ï¼Œå¹¶ä¸”è¿™ä¸ªè¿‡ç¨‹æ˜¯æ”¯æŒæ•°æ®æ›´æ–°æ“ä½œçš„ã€‚\n\n### æ‚²è§‚é”å’Œä¹è§‚é”æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\né¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¾ˆæ‚²è§‚ï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¼šä¿®æ”¹ï¼Œæ‰€ä»¥æ¯æ¬¡åœ¨æ‹¿æ•°æ®çš„æ—¶å€™éƒ½ä¼šä¸Šé”ï¼Œè¿™æ ·åˆ«äººæƒ³æ‹¿è¿™ä¸ªæ•°æ®å°±ä¼š block ç›´åˆ°å®ƒæ‹¿åˆ°é”ã€‚æ­£å› ä¸ºå¦‚æ­¤ï¼Œæ‚²è§‚é”éœ€è¦è€—è´¹è¾ƒå¤šçš„æ—¶é—´ï¼Œå¦å¤–ä¸ä¹è§‚é”ç›¸å¯¹åº”çš„ï¼Œæ‚²è§‚é”æ˜¯ç”±æ•°æ®åº“è‡ªå·±å®ç°äº†çš„ï¼Œè¦ç”¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç›´æ¥è°ƒç”¨æ•°æ®åº“çš„ç›¸å…³è¯­å¥å°±å¯ä»¥äº†ã€‚\n\nè¯´åˆ°è¿™é‡Œï¼Œç”±æ‚²è§‚é”æ¶‰åŠåˆ°çš„å¦å¤–ä¸¤ä¸ªé”æ¦‚å¿µå°±å‡ºæ¥äº†ï¼Œå®ƒä»¬å°±æ˜¯å…±äº«é”ä¸æ’å®ƒé”ã€‚å…±äº«é”å’Œæ’å®ƒé”æ˜¯æ‚²è§‚é”çš„ä¸åŒçš„å®ç°ï¼Œå®ƒä¿©éƒ½å±äºæ‚²è§‚é”çš„èŒƒç•´ã€‚\n\n**ä¹è§‚é”æ˜¯ç”¨æ•°æ®ç‰ˆæœ¬ï¼ˆVersionï¼‰è®°å½•æœºåˆ¶å®ç°**ï¼Œè¿™æ˜¯ä¹è§‚é”æœ€å¸¸ç”¨çš„ä¸€ç§å®ç°æ–¹å¼ã€‚ä½•è°“æ•°æ®ç‰ˆæœ¬ï¼Ÿå³ä¸ºæ•°æ®å¢åŠ ä¸€ä¸ªç‰ˆæœ¬æ ‡è¯†ï¼Œä¸€èˆ¬æ˜¯é€šè¿‡ä¸ºæ•°æ®åº“è¡¨å¢åŠ ä¸€ä¸ªæ•°å­—ç±»å‹çš„ version å­—æ®µæ¥å®ç°ã€‚å½“è¯»å–æ•°æ®æ—¶ï¼Œå°† version å­—æ®µçš„å€¼ä¸€åŒè¯»å‡ºï¼Œæ•°æ®æ¯æ›´æ–°ä¸€æ¬¡ï¼Œå¯¹æ­¤ version å€¼åŠ  1ã€‚å½“æˆ‘ä»¬æäº¤æ›´æ–°çš„æ—¶å€™ï¼Œåˆ¤æ–­æ•°æ®åº“è¡¨å¯¹åº”è®°å½•çš„å½“å‰ç‰ˆæœ¬ä¿¡æ¯ä¸ç¬¬ä¸€æ¬¡å–å‡ºæ¥çš„ version å€¼è¿›è¡Œæ¯”å¯¹ï¼Œå¦‚æœæ•°æ®åº“è¡¨å½“å‰ç‰ˆæœ¬å·ä¸ç¬¬ä¸€æ¬¡å–å‡ºæ¥çš„ version å€¼ç›¸ç­‰ï¼Œåˆ™äºˆä»¥æ›´æ–°ï¼Œå¦åˆ™è®¤ä¸ºæ˜¯è¿‡æœŸæ•°æ®ã€‚\n\n### ä¹è§‚é”æœ‰ä»€ä¹ˆä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Ÿ\n\nå› ä¸ºæ²¡æœ‰åŠ é”æ‰€ä»¥ä¹è§‚é”çš„ä¼˜ç‚¹å°±æ˜¯æ‰§è¡Œæ€§èƒ½é«˜ã€‚å®ƒçš„ç¼ºç‚¹å°±æ˜¯æœ‰å¯èƒ½äº§ç”Ÿ ABA çš„é—®é¢˜ï¼ŒABA é—®é¢˜æŒ‡çš„æ˜¯æœ‰ä¸€ä¸ªå˜é‡ V åˆæ¬¡è¯»å–çš„æ—¶å€™æ˜¯ A å€¼ï¼Œå¹¶ä¸”åœ¨å‡†å¤‡èµ‹å€¼çš„æ—¶å€™æ£€æŸ¥åˆ°å®ƒä»ç„¶æ˜¯ A å€¼ï¼Œä¼šè¯¯ä»¥ä¸ºæ²¡æœ‰è¢«ä¿®æ”¹ä¼šæ­£å¸¸çš„æ‰§è¡Œä¿®æ”¹æ“ä½œï¼Œå®é™…ä¸Šè¿™æ®µæ—¶é—´å®ƒçš„å€¼å¯èƒ½è¢«æ”¹äº†å…¶ä»–å€¼ï¼Œä¹‹ååˆæ”¹å›ä¸º A å€¼ï¼Œè¿™ä¸ªé—®é¢˜è¢«ç§°ä¸º ABA é—®é¢˜ã€‚\n\n### â­InnoDB å­˜å‚¨å¼•æ“æœ‰å‡ ç§é”ç®—æ³•ï¼Ÿ\n\n*   Record Lock â€” å•ä¸ªè¡Œè®°å½•ä¸Šçš„é”ï¼›\n\n*   Gap Lock â€” é—´éš™é”ï¼Œé”å®šä¸€ä¸ªèŒƒå›´ï¼Œä¸åŒ…æ‹¬è®°å½•æœ¬èº«ï¼›\n\n*   Next-Key Lockï¼ˆåŒ…å«è¡Œé”å’Œé—´éš™é”ï¼‰ â€” é”å®šä¸€ä¸ªèŒƒå›´ï¼ŒåŒ…æ‹¬è®°å½•æœ¬èº«ã€‚\n\n### InnoDB å¦‚ä½•å®ç°è¡Œé”ï¼Ÿ\n\nå…±äº«é”ï¼š**in share mode**\n\næ’ä»–é”ï¼š**for update**\n\n### ä¼˜åŒ–é”æ–¹é¢ä½ æœ‰ä»€ä¹ˆå»ºè®®ï¼Ÿ\n\n*   å°½é‡ä½¿ç”¨è¾ƒä½çš„éš”ç¦»çº§åˆ«ã€‚\n*   ç²¾å¿ƒè®¾è®¡ç´¢å¼•ï¼Œ å¹¶å°½é‡ä½¿ç”¨ç´¢å¼•è®¿é—®æ•°æ®ï¼Œ ä½¿åŠ é”æ›´ç²¾ç¡®ï¼Œ ä»è€Œå‡å°‘é”å†²çªçš„æœºä¼šã€‚\n*   é€‰æ‹©åˆç†çš„äº‹åŠ¡å¤§å°ï¼Œå°äº‹åŠ¡å‘ç”Ÿé”å†²çªçš„å‡ ç‡ä¹Ÿæ›´å°ã€‚\n*   ç»™è®°å½•é›†æ˜¾ç¤ºåŠ é”æ—¶ï¼Œæœ€å¥½ä¸€æ¬¡æ€§è¯·æ±‚è¶³å¤Ÿçº§åˆ«çš„é”ã€‚æ¯”å¦‚è¦ä¿®æ”¹æ•°æ®çš„è¯ï¼Œæœ€å¥½ç›´æ¥ç”³è¯·æ’ä»–é”ï¼Œè€Œä¸æ˜¯å…ˆç”³è¯·å…±äº«é”ï¼Œä¿®æ”¹æ—¶å†è¯·æ±‚æ’ä»–é”ï¼Œè¿™æ ·å®¹æ˜“äº§ç”Ÿæ­»é”ã€‚\n*   ä¸åŒçš„ç¨‹åºè®¿é—®ä¸€ç»„è¡¨æ—¶ï¼Œåº”å°½é‡çº¦å®šä»¥ç›¸åŒçš„é¡ºåºè®¿é—®å„è¡¨ï¼Œå¯¹ä¸€ä¸ªè¡¨è€Œè¨€ï¼Œå°½å¯èƒ½ä»¥å›ºå®šçš„é¡ºåºå­˜å–è¡¨ä¸­çš„è¡Œã€‚è¿™æ ·å¯ä»¥å¤§å¤§å‡å°‘æ­»é”çš„æœºä¼šã€‚\n*   å°½é‡ç”¨ç›¸ç­‰æ¡ä»¶è®¿é—®æ•°æ®ï¼Œè¿™æ ·å¯ä»¥é¿å…é—´éš™é”å¯¹å¹¶å‘æ’å…¥çš„å½±å“ã€‚\n*   ä¸è¦ç”³è¯·è¶…è¿‡å®é™…éœ€è¦çš„é”çº§åˆ«ã€‚\n*   é™¤éå¿…é¡»ï¼ŒæŸ¥è¯¢æ—¶ä¸è¦æ˜¾ç¤ºåŠ é”ã€‚ MySQL çš„ MVCC å¯ä»¥å®ç°äº‹åŠ¡ä¸­çš„æŸ¥è¯¢ä¸ç”¨åŠ é”ï¼Œä¼˜åŒ–äº‹åŠ¡æ€§èƒ½ï¼›MVCC åªåœ¨ COMMITTED READï¼ˆè¯»æäº¤ï¼‰å’Œ REPEATABLE READï¼ˆå¯é‡å¤è¯»ï¼‰ä¸¤ç§éš”ç¦»çº§åˆ«ä¸‹å·¥ä½œã€‚\n*   å¯¹äºä¸€äº›ç‰¹å®šçš„äº‹åŠ¡ï¼Œå¯ä»¥ä½¿ç”¨è¡¨é”æ¥æé«˜å¤„ç†é€Ÿåº¦æˆ–å‡å°‘æ­»é”çš„å¯èƒ½ã€‚\n\n### MySQL ä¸­æœ‰å“ªå‡ ç§é”ï¼Ÿ\n\n**1ã€è¡¨çº§é”ï¼š** å¼€é”€å°ï¼Œ åŠ é”å¿«ï¼› ä¸ä¼šå‡ºç°æ­»é”ï¼› é”å®šç²’åº¦å¤§ï¼Œ å‘ç”Ÿé”å†²çªçš„æ¦‚ç‡æœ€é«˜ï¼Œ å¹¶å‘åº¦æœ€ä½ã€‚\n\n**2ã€è¡Œçº§é”ï¼š**  å¼€é”€å¤§ï¼Œ åŠ é”æ…¢ï¼› ä¼šå‡ºç°æ­»é”ï¼› é”å®šç²’åº¦æœ€å°ï¼Œ å‘ç”Ÿé”å†²çªçš„æ¦‚ç‡æœ€ä½ï¼Œ å¹¶å‘åº¦ä¹Ÿæœ€é«˜ã€‚\n\n**3ã€é¡µé”ï¼š**  å¼€é”€å’ŒåŠ é”æ—¶é—´ç•Œäºè¡¨é”å’Œè¡Œé”ä¹‹é—´ï¼› ä¼šå‡ºç°æ­»é”ï¼› é”å®šç²’åº¦ç•Œäºè¡¨é”å’Œè¡Œé”ä¹‹é—´ï¼Œ å¹¶å‘åº¦ä¸€èˆ¬ã€‚\n\n\n\n### é”æœºåˆ¶ä¸InnoDBé”ç®—æ³•\n\n**MyISAMå’ŒInnoDBå­˜å‚¨å¼•æ“ä½¿ç”¨çš„é”ï¼š**\n\n- MyISAM é‡‡ç”¨è¡¨çº§é”(table-level locking)ã€‚\n- InnoDB æ”¯æŒè¡Œçº§é”(row-level locking)å’Œè¡¨çº§é”,é»˜è®¤ä¸ºè¡Œçº§é”\n\n**è¡¨çº§é”å’Œè¡Œçº§é”å¯¹æ¯”ï¼š**\n\n- **è¡¨çº§é”ï¼š** MySQL ä¸­é”å®š **ç²’åº¦æœ€å¤§** çš„ä¸€ç§é”ï¼Œå¯¹å½“å‰æ“ä½œçš„æ•´å¼ è¡¨åŠ é”ï¼Œå®ç°ç®€å•ï¼Œèµ„æºæ¶ˆè€—ä¹Ÿæ¯”è¾ƒå°‘ï¼ŒåŠ é”å¿«ï¼Œä¸ä¼šå‡ºç°æ­»é”ã€‚å…¶é”å®šç²’åº¦æœ€å¤§ï¼Œè§¦å‘é”å†²çªçš„æ¦‚ç‡æœ€é«˜ï¼Œå¹¶å‘åº¦æœ€ä½ï¼ŒMyISAM å’Œ InnoDB å¼•æ“éƒ½æ”¯æŒè¡¨çº§é”ã€‚\n\n- **è¡Œçº§é”ï¼š** MySQL ä¸­é”å®š **ç²’åº¦æœ€å°** çš„ä¸€ç§é”ï¼Œåªé’ˆå¯¹å½“å‰æ“ä½œçš„è¡Œè¿›è¡ŒåŠ é”ã€‚ è¡Œçº§é”èƒ½å¤§å¤§å‡å°‘æ•°æ®åº“æ“ä½œçš„å†²çªã€‚å…¶åŠ é”ç²’åº¦æœ€å°ï¼Œå¹¶å‘åº¦é«˜ï¼Œä½†åŠ é”çš„å¼€é”€ä¹Ÿæœ€å¤§ï¼ŒåŠ é”æ…¢ï¼Œä¼šå‡ºç°æ­»é”ã€‚\n\n### é”çš„ä¼˜åŒ–ç­–ç•¥\n\n**1ã€** è¯»å†™åˆ†ç¦»\n\n**2ã€** åˆ†æ®µåŠ é”\n\n**3ã€** å‡å°‘é”æŒæœ‰çš„æ—¶é—´\n\nå¤šä¸ªçº¿ç¨‹å°½é‡ä»¥ç›¸åŒçš„é¡ºåºå»è·å–èµ„æº\n\nä¸èƒ½å°†é”çš„ç²’åº¦è¿‡äºç»†åŒ–ï¼Œ ä¸ç„¶å¯èƒ½ä¼šå‡ºç°çº¿ç¨‹çš„åŠ é”å’Œé‡Šæ”¾æ¬¡æ•°è¿‡å¤šï¼Œ åè€Œæ•ˆç‡ä¸å¦‚ä¸€æ¬¡åŠ ä¸€æŠŠå¤§é”ã€‚\n\n## MySQLæ—¥å¿—ç¯‡\n\n### MySQL æœ‰å“ªäº›é‡è¦çš„æ—¥å¿—æ–‡ä»¶ï¼Ÿ  \n\nMySQL ä¸­çš„é‡è¦æ—¥å¿—åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªï¼š\n\n**â‘  é”™è¯¯æ—¥å¿—ï¼š**ç”¨æ¥è®°å½• MySQL æœåŠ¡å™¨è¿è¡Œè¿‡ç¨‹ä¸­çš„é”™è¯¯ä¿¡æ¯\n\n**â‘¡ æŸ¥è¯¢æ—¥å¿—**ï¼šæŸ¥è¯¢æ—¥å¿—åœ¨ MySQL ä¸­è¢«ç§°ä¸º general log(é€šç”¨æ—¥å¿—)ï¼ŒæŸ¥è¯¢æ—¥å¿—é‡Œçš„å†…å®¹ä¸è¦è¢«â€œæŸ¥è¯¢æ—¥å¿—â€è¯¯å¯¼ï¼Œè®¤ä¸ºé‡Œé¢åªå­˜å‚¨ select è¯­å¥ï¼Œå…¶å®ä¸ç„¶ï¼ŒæŸ¥è¯¢æ—¥å¿—é‡Œé¢è®°å½•äº†æ•°æ®åº“æ‰§è¡Œçš„æ‰€æœ‰å‘½ä»¤ï¼Œä¸ç®¡è¯­å¥æ˜¯å¦æ­£ç¡®ï¼Œéƒ½ä¼šè¢«è®°å½•ï¼Œå…·ä½“åŸå› å¦‚ä¸‹:\n\n*   insert æŸ¥è¯¢ä¸ºäº†é¿å…æ•°æ®å†²çªï¼Œå¦‚æœæ­¤å‰æ’å…¥è¿‡æ•°æ®ï¼Œå½“å‰æ’å…¥çš„æ•°æ®å¦‚æœè·Ÿä¸»é”®æˆ–å”¯ä¸€é”®çš„æ•°æ®é‡å¤é‚£è‚¯å®šä¼šæŠ¥é”™ï¼›\n\n*   update æ—¶ä¹Ÿä¼šæŸ¥è¯¢å› ä¸ºæ›´æ–°çš„æ—¶å€™å¾ˆå¯èƒ½ä¼šæ›´æ–°æŸä¸€å—æ•°æ®ï¼›\n\n*   delete æŸ¥è¯¢ï¼Œåªåˆ é™¤ç¬¦åˆæ¡ä»¶çš„æ•°æ®ï¼›\n\nå› æ­¤éƒ½ä¼šäº§ç”Ÿæ—¥å¿—ï¼Œåœ¨å¹¶å‘æ“ä½œéå¸¸å¤šçš„åœºæ™¯ä¸‹ï¼ŒæŸ¥è¯¢ä¿¡æ¯ä¼šéå¸¸å¤šï¼Œé‚£ä¹ˆå¦‚æœéƒ½è®°å½•ä¸‹æ¥ä¼šå¯¼è‡´ IO éå¸¸å¤§ï¼Œå½±å“ MySQL æ€§èƒ½ï¼Œå› æ­¤å¦‚æœä¸æ˜¯åœ¨è°ƒè¯•ç¯å¢ƒä¸‹ï¼Œæ˜¯ä¸å»ºè®®å¼€å¯æŸ¥è¯¢æ—¥å¿—åŠŸèƒ½çš„ã€‚\n\næŸ¥è¯¢æ—¥å¿—çš„å¼€å¯æœ‰åŠ©äºå¸®åŠ©æˆ‘ä»¬åˆ†æå“ªäº›è¯­å¥æ‰§è¡Œå¯†é›†ï¼Œæ‰§è¡Œå¯†é›†çš„ select è¯­å¥å¯¹åº”çš„æ•°æ®æ˜¯å¦èƒ½å¤Ÿè¢«ç¼“å­˜ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥å¸®åŠ©æˆ‘ä»¬åˆ†æé—®é¢˜ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µæ¥å†³å®šæ˜¯å¦å¼€å¯æŸ¥è¯¢æ—¥å¿—ã€‚\n\n**â‘¢ æ…¢æ—¥å¿—**ï¼šæ…¢æŸ¥è¯¢ä¼šå¯¼è‡´ CPUã€IOPSã€å†…å­˜æ¶ˆè€—è¿‡é«˜ï¼Œå½“æ•°æ®åº“é‡åˆ°æ€§èƒ½ç“¶é¢ˆæ—¶ï¼Œå¤§éƒ¨åˆ†æ—¶é—´éƒ½æ˜¯ç”±äºæ…¢æŸ¥è¯¢å¯¼è‡´çš„ã€‚å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œå¯ä»¥è®© MySQL è®°å½•ä¸‹æŸ¥è¯¢è¶…è¿‡æŒ‡å®šæ—¶é—´çš„è¯­å¥ï¼Œä¹‹åè¿ç»´äººå‘˜é€šè¿‡å®šä½åˆ†æï¼Œèƒ½å¤Ÿå¾ˆå¥½çš„ä¼˜åŒ–æ•°æ®åº“æ€§èƒ½ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ…¢æŸ¥è¯¢æ—¥å¿—æ˜¯ä¸å¼€å¯çš„ï¼Œåªæœ‰æ‰‹åŠ¨å¼€å¯äº†ï¼Œæ…¢æŸ¥è¯¢æ‰ä¼šè¢«è®°å½•åˆ°æ…¢æŸ¥è¯¢æ—¥å¿—ä¸­ã€‚ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è®°å½•å½“å‰æ•°æ®åº“çš„æ…¢æŸ¥è¯¢è¯­å¥ï¼š\n\n```\nset global slowquerylog='ON';\n```\n\nä½¿ç”¨ set global slow*query*log='ON' å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œåªæ˜¯å¯¹å½“å‰æ•°æ®åº“æœ‰æ•ˆï¼Œå¦‚æœ MySQL æ•°æ®åº“é‡å¯åå°±ä¼šå¤±æ•ˆã€‚æ‰€ä»¥å¦‚æœè¦æ°¸ä¹…ç”Ÿæ•ˆï¼Œå°±è¦ä¿®æ”¹é…ç½®æ–‡ä»¶ my.cnfï¼Œè®¾ç½® slow*query*log=1 å¹¶é‡å¯ MySQL æœåŠ¡å™¨ã€‚\n\n**â‘£ redo logï¼ˆé‡åšæ—¥å¿—ï¼‰**ï¼šä¸ºäº†æœ€å¤§ç¨‹åº¦çš„é¿å…æ•°æ®å†™å…¥æ—¶ï¼Œå› ä¸º IO ç“¶é¢ˆé€ æˆçš„æ€§èƒ½é—®é¢˜ï¼ŒMySQL é‡‡ç”¨äº†è¿™æ ·ä¸€ç§ç¼“å­˜æœºåˆ¶ï¼Œå…ˆå°†æ•°æ®å†™å…¥å†…å­˜ä¸­ï¼Œå†æ‰¹é‡æŠŠå†…å­˜ä¸­çš„æ•°æ®ç»Ÿä¸€åˆ·å›ç£ç›˜ã€‚ä¸ºäº†é¿å…å°†æ•°æ®åˆ·å›ç£ç›˜è¿‡ç¨‹ä¸­ï¼Œå› ä¸ºæ‰ç”µæˆ–ç³»ç»Ÿæ•…éšœå¸¦æ¥çš„æ•°æ®ä¸¢å¤±é—®é¢˜ï¼ŒInnoDB é‡‡ç”¨ redo log æ¥è§£å†³æ­¤é—®é¢˜ã€‚\n\n**â‘¤ undo logï¼ˆå›æ»šæ—¥å¿—ï¼‰**ï¼šç”¨äºå­˜å‚¨æ—¥å¿—è¢«ä¿®æ”¹å‰çš„å€¼ï¼Œä»è€Œä¿è¯å¦‚æœä¿®æ”¹å‡ºç°å¼‚å¸¸ï¼Œå¯ä»¥ä½¿ç”¨ undo log æ—¥å¿—æ¥å®ç°å›æ»šæ“ä½œã€‚ undo log å’Œ redo log è®°å½•ç‰©ç†æ—¥å¿—ä¸ä¸€æ ·ï¼Œå®ƒæ˜¯é€»è¾‘æ—¥å¿—ï¼Œå¯ä»¥è®¤ä¸ºå½“ delete ä¸€æ¡è®°å½•æ—¶ï¼Œundo log ä¸­ä¼šè®°å½•ä¸€æ¡å¯¹åº”çš„ insert è®°å½•ï¼Œåä¹‹äº¦ç„¶ï¼Œå½“ update ä¸€æ¡è®°å½•æ—¶ï¼Œå®ƒè®°å½•ä¸€æ¡å¯¹åº”ç›¸åçš„ update è®°å½•ï¼Œå½“æ‰§è¡Œ rollback æ—¶ï¼Œå°±å¯ä»¥ä» undo log ä¸­çš„é€»è¾‘è®°å½•è¯»å–åˆ°ç›¸åº”çš„å†…å®¹å¹¶è¿›è¡Œå›æ»šã€‚\n\n**â‘¥ bin logï¼ˆäºŒè¿›åˆ¶æ—¥å¿—ï¼‰**ï¼šæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸»è¦**è®°å½•äº†å¯¹ MySQL æ•°æ®åº“æ‰§è¡Œæ›´æ”¹çš„æ‰€æœ‰æ“ä½œ**ï¼Œæ¯”å¦‚ï¼ŒCREATEã€ALTER TABLE ç­‰ï¼Œä»¥åŠè¡¨æ•°æ®ä¿®æ”¹ï¼Œæ¯”å¦‚ï¼ŒINSERTã€UPDATEã€DELETE çš„æ‰€æœ‰æ“ä½œï¼Œä¸è®°å½• SELECTã€SHOW ç­‰é‚£äº›ä¸ä¿®æ”¹æ•°æ®æˆ–æ•°æ®åº“ç»“æ„çš„ SQL è¯­å¥ã€‚\n\nbinlog çš„ä½œç”¨å¦‚ä¸‹ï¼š\n\n*   æ¢å¤ï¼ˆrecoveryï¼‰ï¼šæŸäº›æ•°æ®çš„æ¢å¤éœ€è¦äºŒè¿›åˆ¶æ—¥å¿—ã€‚æ¯”å¦‚ï¼Œåœ¨ä¸€ä¸ªæ•°æ®åº“å…¨å¤‡æ–‡ä»¶æ¢å¤åï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡äºŒè¿›åˆ¶æ—¥å¿—è¿›è¡Œ point-in-time çš„æ¢å¤ï¼›\n\n*   å¤åˆ¶ï¼ˆreplicationï¼‰ï¼šå…¶åŸç†ä¸æ¢å¤ç±»ä¼¼ï¼Œé€šè¿‡å¤åˆ¶å’Œæ‰§è¡ŒäºŒè¿›åˆ¶æ—¥å¿—ä½¿ä¸€å°è¿œç¨‹çš„ MySQL æ•°æ®åº“ï¼ˆä¸€èˆ¬ç§°ä¸º slave æˆ–è€… standbyï¼‰ä¸ä¸€å° MySQL æ•°æ®åº“ï¼ˆä¸€èˆ¬ç§°ä¸º master æˆ–è€… primaryï¼‰è¿›è¡Œå®æ—¶åŒæ­¥ï¼›\n\n*   å®¡è®¡ï¼ˆauditï¼‰ï¼šç”¨æˆ·å¯ä»¥é€šè¿‡äºŒè¿›åˆ¶æ—¥å¿—ä¸­çš„ä¿¡æ¯æ¥è¿›è¡Œå®¡è®¡ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰å¯¹æ•°æ®åº“è¿›è¡Œæ³¨å…¥æ”»å‡»ã€‚\n\né™¤äº†ä¸Šé¢ä»‹ç»çš„å‡ ä¸ªä½œç”¨å¤–ï¼Œbinlog å¯¹äºäº‹åŠ¡å­˜å‚¨å¼•æ“çš„å´©æºƒæ¢å¤ä¹Ÿæœ‰éå¸¸é‡è¦çš„ä½œç”¨ï¼Œåœ¨å¼€å¯ binlog çš„æƒ…å†µä¸‹ï¼Œä¸ºäº†ä¿è¯ binlog ä¸ redo çš„ä¸€è‡´æ€§ï¼ŒMySQL å°†é‡‡ç”¨äº‹åŠ¡çš„ä¸¤é˜¶æ®µæäº¤åè®®ã€‚å½“ MySQL ç³»ç»Ÿå‘ç”Ÿå´©æºƒæ—¶ï¼Œäº‹åŠ¡åœ¨å­˜å‚¨å¼•æ“å†…éƒ¨çš„çŠ¶æ€å¯èƒ½ä¸º preparedï¼ˆå‡†å¤‡çŠ¶æ€ï¼‰å’Œ commitï¼ˆæäº¤çŠ¶æ€ï¼‰ä¸¤ç§ï¼Œå¯¹äº prepared çŠ¶æ€çš„äº‹åŠ¡ï¼Œæ˜¯è¿›è¡Œæäº¤æ“ä½œè¿˜æ˜¯è¿›è¡Œå›æ»šæ“ä½œï¼Œè¿™æ—¶éœ€è¦å‚è€ƒ binlogï¼Œå¦‚æœäº‹åŠ¡åœ¨ binlog ä¸­å­˜åœ¨ï¼Œé‚£ä¹ˆå°†å…¶æäº¤ï¼›å¦‚æœä¸åœ¨ binlog ä¸­å­˜åœ¨ï¼Œé‚£ä¹ˆå°†å…¶å›æ»šï¼Œè¿™æ ·å°±ä¿è¯äº†æ•°æ®åœ¨ä¸»åº“å’Œä»åº“ä¹‹é—´çš„ä¸€è‡´æ€§ã€‚\n\nbinlog é»˜è®¤æ˜¯å…³é—­çŠ¶æ€ï¼Œå¯ä»¥åœ¨ MySQL é…ç½®æ–‡ä»¶ï¼ˆmy.cnfï¼‰ä¸­é€šè¿‡é…ç½®å‚æ•° log-bin = [base-name] å¼€å¯è®°å½• binlog æ—¥å¿—ï¼Œå¦‚æœä¸æŒ‡å®š base-nameï¼Œåˆ™é»˜è®¤äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶åä¸ºä¸»æœºåï¼Œå¹¶ä»¥è‡ªå¢çš„æ•°å­—ä½œä¸ºåç¼€ï¼Œæ¯”å¦‚ï¼šmysql-bin.000001ï¼Œæ‰€åœ¨ç›®å½•ä¸ºæ•°æ®åº“æ‰€åœ¨ç›®å½•ï¼ˆdatadirï¼‰ã€‚\n\né€šè¿‡ä»¥ä¸‹å‘½ä»¤æ¥æŸ¥è¯¢ binlog æ˜¯å¦å¼€å¯ï¼š\n\n```\nshow variables like 'log_%'; \n```\n\nbinlog æ ¼å¼åˆ†ä¸º: STATEMENTã€ROW å’Œ MIXED ä¸‰ç§ï¼š\n\n*   STATEMENT æ ¼å¼çš„ binlog è®°å½•çš„æ˜¯æ•°æ®åº“ä¸Šæ‰§è¡Œçš„åŸç”Ÿ SQL è¯­å¥ã€‚è¿™ç§æ ¼å¼çš„ä¼˜ç‚¹æ˜¯ç®€å•ï¼Œç®€å•åœ°è®°å½•å’Œæ‰§è¡Œè¿™äº›è¯­å¥ï¼Œèƒ½å¤Ÿè®©ä¸»å¤‡ä¿æŒåŒæ­¥ï¼Œåœ¨ä¸»æœåŠ¡å™¨ä¸Šæ‰§è¡Œçš„ SQL è¯­å¥ï¼Œåœ¨ä»æœåŠ¡å™¨ä¸Šæ‰§è¡ŒåŒæ ·çš„è¯­å¥ã€‚å¦ä¸€ä¸ªå¥½å¤„æ˜¯äºŒè¿›åˆ¶æ—¥å¿—é‡Œçš„æ—¶é—´æ›´åŠ ç´§å‡‘ï¼Œæ‰€ä»¥ç›¸å¯¹è€Œè¨€ï¼ŒåŸºäºè¯­å¥çš„å¤åˆ¶æ¨¡å¼ä¸ä¼šä½¿ç”¨å¤ªå¤šå¸¦å®½ï¼ŒåŒæ—¶ä¹ŸèŠ‚çº¦ç£ç›˜ç©ºé—´ã€‚å¹¶ä¸”é€šè¿‡ mysqlbinlog å·¥å…·å®¹æ˜“è¯»æ‡‚å…¶ä¸­çš„å†…å®¹ã€‚ç¼ºç‚¹å°±æ˜¯åŒä¸€æ¡ SQL åœ¨ä¸»åº“å’Œä»åº“ä¸Šæ‰§è¡Œçš„æ—¶é—´å¯èƒ½ç¨å¾®æˆ–å¾ˆå¤§ä¸ç›¸åŒï¼Œå› æ­¤åœ¨ä¼ è¾“çš„äºŒè¿›åˆ¶æ—¥å¿—ä¸­ï¼Œé™¤äº†æŸ¥è¯¢è¯­å¥ï¼Œè¿˜åŒ…æ‹¬äº†ä¸€äº›å…ƒæ•°æ®ä¿¡æ¯ï¼Œå¦‚å½“å‰çš„æ—¶é—´æˆ³ã€‚å³ä¾¿å¦‚æ­¤ï¼Œè¿˜å­˜åœ¨ç€ä¸€äº›æ— æ³•è¢«æ­£ç¡®å¤åˆ¶çš„ SQLã€‚æ¯”å¦‚ï¼Œä½¿ç”¨ INSERT INTO TB1 VALUE(CUURENT_DATE()) è¿™ä¸€æ¡ä½¿ç”¨å‡½æ•°çš„è¯­å¥æ’å…¥çš„æ•°æ®å¤åˆ¶åˆ°å½“å‰ä»æœåŠ¡å™¨ä¸Šæ¥å°±ä¼šå‘ç”Ÿå˜åŒ–ï¼Œå­˜å‚¨è¿‡ç¨‹å’Œè§¦å‘å™¨åœ¨ä½¿ç”¨åŸºäºè¯­å¥çš„å¤åˆ¶æ¨¡å¼æ—¶ä¹Ÿå¯èƒ½å­˜åœ¨é—®é¢˜ï¼›å¦å¤–ä¸€ä¸ªé—®é¢˜å°±æ˜¯åŸºäºè¯­å¥çš„å¤åˆ¶å¿…é¡»æ˜¯ä¸²è¡ŒåŒ–çš„ï¼Œæ¯”å¦‚ï¼šInnoDB çš„ next-key é”ç­‰ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„å­˜å‚¨å¼•æ“éƒ½æ”¯æŒåŸºäºè¯­å¥çš„å¤åˆ¶ï¼›\n\n*   ROW æ ¼å¼æ˜¯ä» MySQL 5.1 å¼€å§‹æ”¯æŒåŸºäºè¡Œçš„å¤åˆ¶ï¼Œä¹Ÿå°±æ˜¯åŸºäºæ•°æ®çš„å¤åˆ¶ï¼ŒåŸºäºè¡Œçš„æ›´æ”¹ã€‚è¿™ç§æ–¹å¼ä¼šå°†å®é™…æ•°æ®è®°å½•åœ¨äºŒè¿›åˆ¶æ—¥å¿—ä¸­ï¼Œå®ƒæœ‰å…¶è‡ªèº«çš„ä¸€äº›ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Œæœ€å¤§çš„å¥½å¤„æ˜¯å¯ä»¥æ­£ç¡®åœ°å¤åˆ¶æ¯ä¸€è¡Œæ•°æ®ï¼Œä¸€äº›è¯­å¥å¯ä»¥è¢«æ›´åŠ æœ‰æ•ˆåœ°å¤åˆ¶ï¼Œå¦å¤–å°±æ˜¯å‡ ä¹æ²¡æœ‰åŸºäºè¡Œçš„å¤åˆ¶æ¨¡å¼æ— æ³•å¤„ç†çš„åœºæ™¯ï¼Œå¯¹äºæ‰€æœ‰çš„ SQL æ„é€ ã€è§¦å‘å™¨ã€å­˜å‚¨è¿‡ç¨‹ç­‰éƒ½èƒ½æ­£ç¡®æ‰§è¡Œï¼›å®ƒçš„ç¼ºç‚¹å°±æ˜¯äºŒè¿›åˆ¶æ—¥å¿—å¯èƒ½ä¼šå¾ˆå¤§ï¼Œè€Œä¸”ä¸ç›´è§‚ï¼Œæ‰€ä»¥ï¼Œä½ ä¸èƒ½ä½¿ç”¨ mysqlbinlog æ¥æŸ¥çœ‹äºŒè¿›åˆ¶æ—¥å¿—ï¼Œä¹Ÿæ— æ³•é€šè¿‡çœ‹äºŒè¿›åˆ¶æ—¥å¿—åˆ¤æ–­å½“å‰æ‰§è¡Œåˆ°é‚£ä¸€æ¡ SQL è¯­å¥ã€‚ç°åœ¨å¯¹äº ROW æ ¼å¼çš„äºŒè¿›åˆ¶æ—¥å¿—åŸºæœ¬æ˜¯æ ‡é…äº†ï¼Œä¸»è¦æ˜¯å› ä¸ºå®ƒçš„ä¼˜åŠ¿è¿œè¿œå¤§äºç¼ºç‚¹ï¼Œå¹¶ä¸”ç”±äº ROW æ ¼å¼è®°å½•è¡Œæ•°æ®ï¼Œæ‰€ä»¥å¯ä»¥åŸºäºè¿™ç§æ¨¡å¼åšä¸€äº› DBA å·¥å…·ï¼Œæ¯”å¦‚æ•°æ®æ¢å¤ï¼Œä¸åŒæ•°æ®åº“ä¹‹é—´æ•°æ®åŒæ­¥ç­‰ï¼›\n\n*   MIXED ä¹Ÿæ˜¯ MySQL é»˜è®¤ä½¿ç”¨çš„äºŒè¿›åˆ¶æ—¥å¿—è®°å½•æ–¹å¼ï¼Œä½† MIXED æ ¼å¼é»˜è®¤é‡‡ç”¨åŸºäºè¯­å¥çš„å¤åˆ¶ï¼Œä¸€æ—¦å‘ç°åŸºäºè¯­å¥çš„æ— æ³•ç²¾ç¡®çš„å¤åˆ¶æ—¶ï¼Œå°±ä¼šé‡‡ç”¨åŸºäºè¡Œçš„å¤åˆ¶ã€‚æ¯”å¦‚ç”¨åˆ° UUID()ã€USER()ã€CURRENT*USER()ã€ROW*COUNT() ç­‰æ— æ³•ç¡®å®šçš„å‡½æ•°ã€‚\n\n### redo log å’Œ binlog æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\nredo logï¼ˆé‡åšæ—¥å¿—ï¼‰å’Œ binlogï¼ˆå½’æ¡£æ—¥å¿—ï¼‰éƒ½æ˜¯ MySQL çš„é‡è¦çš„æ—¥å¿—ï¼Œå®ƒä»¬çš„åŒºåˆ«å¦‚ä¸‹ï¼š\n\n*   redo log æ˜¯ç‰©ç†æ—¥å¿—ï¼Œè®°å½•çš„æ˜¯â€œåœ¨æŸä¸ªæ•°æ®é¡µä¸Šåšäº†ä»€ä¹ˆä¿®æ”¹â€ã€‚\n\n*   binlog æ˜¯é€»è¾‘æ—¥å¿—ï¼Œè®°å½•çš„æ˜¯è¿™ä¸ªè¯­å¥çš„åŸå§‹é€»è¾‘ï¼Œæ¯”å¦‚â€œç»™ ID=2 è¿™ä¸€è¡Œçš„ c å­—æ®µåŠ  1 â€ã€‚\n\n*   redo log æ˜¯ InnoDB å¼•æ“ç‰¹æœ‰çš„ï¼›binlog æ˜¯ MySQL çš„ Server å±‚å®ç°çš„ï¼Œæ‰€æœ‰å¼•æ“éƒ½å¯ä»¥ä½¿ç”¨ã€‚\n\n*   redo log æ˜¯å¾ªç¯å†™çš„ï¼Œç©ºé—´å›ºå®šä¼šç”¨å®Œï¼›binlog æ˜¯å¯ä»¥è¿½åŠ å†™å…¥çš„ã€‚â€œè¿½åŠ å†™â€æ˜¯æŒ‡ binlog æ–‡ä»¶å†™åˆ°ä¸€å®šå¤§å°åä¼šåˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªï¼Œå¹¶ä¸ä¼šè¦†ç›–ä»¥å‰çš„æ—¥å¿—ã€‚\n\næœ€å¼€å§‹ MySQL é‡Œå¹¶æ²¡æœ‰ InnoDB å¼•æ“ï¼ŒMySQL è‡ªå¸¦çš„å¼•æ“æ˜¯ MyISAMï¼Œä½†æ˜¯ MyISAM æ²¡æœ‰ crash-safe çš„èƒ½åŠ›ï¼Œbinlog æ—¥å¿—åªèƒ½ç”¨äºå½’æ¡£ã€‚è€Œ InnoDB æ˜¯å¦ä¸€ä¸ªå…¬å¸ä»¥æ’ä»¶å½¢å¼å¼•å…¥ MySQL çš„ï¼Œæ—¢ç„¶åªä¾é  binlog æ˜¯æ²¡æœ‰ crash-safe èƒ½åŠ›çš„ï¼Œæ‰€ä»¥ InnoDB ä½¿ç”¨å¦å¤–ä¸€å¥—æ—¥å¿—ç³»ç»Ÿï¼Œä¹Ÿå°±æ˜¯ redo log æ¥å®ç° crash-safe èƒ½åŠ›ã€‚\n\n### ä»€ä¹ˆæ˜¯ crash-safeï¼Ÿ\n\ncrash-safe æ˜¯æŒ‡å‘ç”Ÿå®•æœºç­‰æ„å¤–æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨é‡å¯åæ•°æ®ä¾ç„¶ä¸ä¼šä¸¢å¤±çš„æƒ…å†µã€‚\n\n### ä»€ä¹ˆæ˜¯è„é¡µå’Œå¹²å‡€é¡µï¼Ÿ\n\nMySQL ä¸ºäº†æ“ä½œçš„æ€§èƒ½ä¼˜åŒ–ï¼Œä¼šæŠŠæ•°æ®æ›´æ–°å…ˆæ”¾å…¥å†…å­˜ä¸­ï¼Œä¹‹åå†ç»Ÿä¸€æ›´æ–°åˆ°ç£ç›˜ã€‚å½“å†…å­˜æ•°æ®å’Œç£ç›˜æ•°æ®å†…å®¹ä¸ä¸€è‡´çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç§°è¿™ä¸ªå†…å­˜é¡µä¸ºè„é¡µï¼›å†…å­˜æ•°æ®å†™åˆ°ç£ç›˜åï¼Œå†…å­˜çš„æ•°æ®å’Œç£ç›˜ä¸Šçš„å†…å®¹å°±ä¸€è‡´äº†ï¼Œæˆ‘ä»¬ç§°ä¸ºâ€œå¹²å‡€é¡µâ€ã€‚\n\n### ä»€ä¹ˆæƒ…å†µä¸‹ä¼šå¼•å‘ MySQL åˆ·è„é¡µï¼ˆflushï¼‰çš„æ“ä½œï¼Ÿ\n\n*   å†…å­˜å†™æ»¡äº†ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šå¼•å‘ flush æ“ä½œï¼Œå¯¹åº”åˆ° InnoDB å°±æ˜¯ redo log å†™æ»¡äº†ï¼›\n\n*   ç³»ç»Ÿçš„å†…å­˜ä¸è¶³äº†ï¼Œå½“éœ€è¦æ–°çš„å†…å­˜é¡µçš„æ—¶å€™ï¼Œå°±ä¼šæ·˜æ±°ä¸€äº›å†…å­˜é¡µï¼Œå¦‚æœæ·˜æ±°çš„æ˜¯è„é¡µè¿™ä¸ªæ—¶å€™å°±ä¼šè§¦å‘ flush æ“ä½œï¼›\n\n*   ç³»ç»Ÿç©ºé—²çš„æ—¶å€™ï¼ŒMySQL ä¼šåŒæ­¥å†…å­˜ä¸­çš„æ•°æ®åˆ°ç£ç›˜ä¹Ÿä¼šè§¦å‘ flush æ“ä½œï¼›\n\n*   MySQL æœåŠ¡å…³é—­çš„æ—¶å€™ä¹Ÿä¼šåˆ·è„é¡µï¼Œè§¦å‘ flush æ“ä½œã€‚\n\n### MySQL åˆ·è„é¡µçš„é€Ÿåº¦å¾ˆæ…¢å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ\n\nåœ¨ MySQL ä¸­å•ç‹¬åˆ·ä¸€ä¸ªè„é¡µçš„é€Ÿåº¦æ˜¯å¾ˆå¿«çš„ï¼Œå¦‚æœå‘ç°åˆ·è„é¡µçš„é€Ÿåº¦å¾ˆæ…¢ï¼Œè¯´æ˜è§¦å‘äº† MySQL åˆ·è„é¡µçš„â€œè¿åâ€æœºåˆ¶ï¼ŒMySQL çš„â€œè¿åâ€æœºåˆ¶æ˜¯æŒ‡å½“ MySQL åˆ·è„é¡µçš„æ—¶å€™å¦‚æœå‘ç°ç›¸é‚»çš„æ•°æ®é¡µä¹Ÿæ˜¯è„é¡µä¹Ÿä¼šä¸€èµ·åˆ·æ‰ï¼Œè€Œè¿™ä¸ªåŠ¨ä½œå¯ä»¥ä¸€ç›´è”“å»¶ä¸‹å»ï¼Œè¿™å°±æ˜¯å¯¼è‡´ MySQL åˆ·è„é¡µæ…¢çš„åŸå› äº†ã€‚\n\n### å¦‚ä½•æ§åˆ¶ MySQL åªåˆ·æ–°å½“å‰è„é¡µï¼Ÿ\n\nåœ¨ InnoDB ä¸­è®¾ç½® innodb*flush*neighbors è¿™ä¸ªå‚æ•°çš„å€¼ä¸º 0ï¼Œæ¥è§„å®š MySQL åªåˆ·å½“å‰è„é¡µï¼ŒMySQL 8 è¿™ä¸ªå€¼é»˜è®¤æ˜¯ 0ã€‚\n\n### MySQL çš„ WAL æŠ€æœ¯æ˜¯è§£å†³ä»€ä¹ˆé—®é¢˜çš„ï¼Ÿ\n\nA.é˜²æ­¢è¯¯åˆ é™¤ï¼Œæ‰¾å›æ•°æ®ç”¨çš„ B.å®¹ç¾æ¢å¤ï¼Œä¸ºäº†è¿˜åŸå¼‚å¸¸æ•°æ®ç”¨çš„ C.äº‹åŠ¡å¤„ç†ï¼Œä¸ºäº†æ•°æ®åº“çš„ç¨³å®šæ€§ D.ä¸ºäº†é™ä½ IO æˆæœ¬ ç­”ï¼šD é¢˜ç›®è§£æï¼šWAL æŠ€æœ¯çš„å…¨ç§°æ˜¯ Write Ahead Loggingï¼ˆä¸­æ–‡ï¼šé¢„å†™å¼æ—¥å¿—ï¼‰ï¼Œæ˜¯å…ˆå†™æ—¥å¿—ï¼Œå†å†™ç£ç›˜çš„æ–¹å¼ï¼Œå› ä¸ºæ¯æ¬¡æ›´æ–°éƒ½å†™ç£ç›˜çš„è¯ IO æˆæœ¬å¾ˆé«˜ï¼Œæ‰€ä»¥æ‰æœ‰äº† WAL æŠ€æœ¯ã€‚\n\n### ä¸ºä»€ä¹ˆæœ‰æ—¶å€™ä¼šæ„Ÿè§‰ MySQL å¶å°”å¡ä¸€ä¸‹ï¼Ÿ\n\nå¦‚æœå¶å°”æ„Ÿè§‰ MySQL å¡ä¸€ä¸‹ï¼Œå¯èƒ½æ˜¯ MySQL æ­£åœ¨åˆ·è„é¡µï¼Œæ­£åœ¨æŠŠå†…å­˜ä¸­çš„æ›´æ–°æ“ä½œåˆ·åˆ°ç£ç›˜ä¸­ã€‚\n\n### redo log å’Œ binlog æ˜¯æ€ä¹ˆå…³è”çš„?\n\nå®ƒä»¬æœ‰ä¸€ä¸ªå…±åŒçš„æ•°æ®å­—æ®µï¼Œå« XIDã€‚å´©æºƒæ¢å¤çš„æ—¶å€™ï¼Œä¼šæŒ‰é¡ºåºæ‰«æ redo logï¼š\n\n*   å¦‚æœç¢°åˆ°æ—¢æœ‰ prepareã€åˆæœ‰ commit çš„ redo logï¼Œå°±ç›´æ¥æäº¤ï¼›\n\n*   å¦‚æœç¢°åˆ°åªæœ‰ parepareã€è€Œæ²¡æœ‰ commit çš„ redo logï¼Œå°±æ‹¿ç€ XID å» binlog æ‰¾å¯¹åº”çš„äº‹åŠ¡ã€‚\n\n### MySQL æ€ä¹ˆçŸ¥é“ binlog æ˜¯å®Œæ•´çš„?\n\n*   statement æ ¼å¼çš„ binlogï¼Œå®Œæ•´çš„æ ‡è¯†æ˜¯æœ€åæœ‰ COMMIT å…³é”®å­—ã€‚\n\n*   row æ ¼å¼çš„ binlogï¼Œå®Œæ•´çš„æ ‡è¯†æ˜¯æœ€åä¼šæœ‰ä¸€ä¸ª XID event å…³é”®å­—ã€‚\n\n### MySQL ä¸­å¯ä¸å¯ä»¥åªè¦ binlogï¼Œä¸è¦ redo logï¼Ÿ\n\nä¸å¯ä»¥ï¼Œbinlog æ²¡æœ‰å´©æºƒæ¢å¤çš„èƒ½åŠ›ã€‚\n\n### MySQL ä¸­å¯ä¸å¯ä»¥åªè¦ redo logï¼Œä¸è¦ binlogï¼Ÿ\n\nä¸å¯ä»¥ï¼ŒåŸå› æœ‰ä»¥ä¸‹ä¸¤ä¸ªï¼š\n\n*   redo log æ˜¯å¾ªç¯å†™ä¸èƒ½ä¿è¯æ‰€æœ‰çš„å†å²æ•°æ®ï¼Œè¿™äº›å†å²æ•°æ®åªèƒ½åœ¨ binlog ä¸­æ‰¾åˆ°ï¼›\n\n*   binlog æ˜¯é«˜å¯ç”¨çš„åŸºç¡€ï¼Œé«˜å¯ç”¨çš„å®ç°åŸç†å°±æ˜¯ binlog å¤åˆ¶ã€‚\n\n### ä¸ºä»€ä¹ˆ binlog cache æ˜¯æ¯ä¸ªçº¿ç¨‹è‡ªå·±ç»´æŠ¤çš„ï¼Œè€Œ redo log buffer æ˜¯å…¨å±€å…±ç”¨çš„ï¼Ÿ\n\nå› ä¸º binlog æ˜¯ä¸èƒ½â€œè¢«æ‰“æ–­çš„â€ï¼Œä¸€ä¸ªäº‹åŠ¡çš„ binlog å¿…é¡»è¿ç»­å†™ï¼Œå› æ­¤è¦æ•´ä¸ªäº‹åŠ¡å®Œæˆåï¼Œå†ä¸€èµ·å†™åˆ°æ–‡ä»¶é‡Œã€‚è€Œ redo log å¹¶æ²¡æœ‰è¿™ä¸ªè¦æ±‚ï¼Œä¸­é—´æœ‰ç”Ÿæˆçš„æ—¥å¿—å¯ä»¥å†™åˆ° redo log buffer ä¸­ï¼Œredo log buffer ä¸­çš„å†…å®¹è¿˜èƒ½â€œæ­ä¾¿è½¦â€ï¼Œå…¶ä»–äº‹åŠ¡æäº¤çš„æ—¶å€™å¯ä»¥è¢«ä¸€èµ·å†™åˆ°ç£ç›˜ä¸­ã€‚\n\n### äº‹åŠ¡æ‰§è¡ŒæœŸé—´ï¼Œè¿˜æœªæäº¤ï¼Œå¦‚æœå‘ç”Ÿ crashï¼Œredo log ä¸¢å¤±ï¼Œä¼šå¯¼è‡´ä¸»å¤‡ä¸ä¸€è‡´å‘¢ï¼Ÿ\n\nä¸ä¼šï¼Œå› ä¸ºè¿™æ—¶å€™ binlog ä¹Ÿè¿˜åœ¨ binlog cache é‡Œï¼Œæ²¡å‘ç»™å¤‡åº“ï¼Œcrash ä»¥å redo log å’Œ binlog éƒ½æ²¡æœ‰äº†ï¼Œä»ä¸šåŠ¡è§’åº¦çœ‹è¿™ä¸ªäº‹åŠ¡ä¹Ÿæ²¡æœ‰æäº¤ï¼Œæ‰€ä»¥æ•°æ®æ˜¯ä¸€è‡´çš„ã€‚\n\n### åœ¨ MySQL ä¸­ç”¨ä»€ä¹ˆæœºåˆ¶æ¥ä¼˜åŒ–éšæœºè¯»/å†™ç£ç›˜å¯¹ IO çš„æ¶ˆè€—ï¼Ÿ\n\nredo log æ˜¯ç”¨æ¥èŠ‚çœéšæœºå†™ç£ç›˜çš„ IO æ¶ˆè€—ï¼Œè€Œ change buffer ä¸»è¦æ˜¯èŠ‚çœéšæœºè¯»ç£ç›˜çš„ IO æ¶ˆè€—ã€‚redo log ä¼šæŠŠ MySQL çš„æ›´æ–°æ“ä½œå…ˆè®°å½•åˆ°å†…å­˜ä¸­ï¼Œä¹‹åå†ç»Ÿä¸€æ›´æ–°åˆ°ç£ç›˜ï¼Œè€Œ change buffer ä¹Ÿæ˜¯æŠŠå…³é”®æŸ¥è¯¢æ•°æ®å…ˆåŠ è½½åˆ°å†…å­˜ä¸­ï¼Œä»¥ä¾¿ä¼˜åŒ– MySQL çš„æŸ¥è¯¢ã€‚\n\n### ä»¥ä¸‹è¯´æ³•é”™è¯¯çš„æ˜¯ï¼Ÿ\n\nA.redo log æ˜¯ InnoDB å¼•æ“ç‰¹æœ‰çš„ï¼Œå®ƒçš„å›ºå®šå¤§å°çš„ B.redo log æ—¥å¿—æ˜¯ä¸å…¨çš„ï¼Œåªæœ‰æœ€æ–°çš„ä¸€äº›æ—¥å¿—ï¼Œè¿™å’Œå®ƒçš„å†…å­˜å¤§å°æœ‰å…³ C.redo log å¯ä»¥ä¿è¯æ•°æ®åº“å¼‚å¸¸é‡å¯ä¹‹åï¼Œæ•°æ®ä¸ä¸¢å¤± D.binlog æ˜¯ MySQL è‡ªå¸¦çš„æ—¥å¿—ï¼Œå®ƒèƒ½ä¿è¯æ•°æ®åº“å¼‚å¸¸é‡å¯ä¹‹åï¼Œæ•°æ®ä¸ä¸¢å¤± ç­”ï¼šD é¢˜ç›®è§£æï¼šbinlog æ˜¯ MySQL è‡ªå¸¦çš„æ—¥å¿—ï¼Œä½†å®ƒå¹¶ä¸èƒ½ä¿è¯æ•°æ®åº“å¼‚å¸¸é‡å¯ä¹‹åæ•°æ®ä¸ä¸¢å¤±ã€‚\n\n### ä»¥ä¸‹è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼Ÿ\n\nA.redo log æ—¥å¿—æ˜¯è¿½åŠ å†™çš„ï¼Œåé¢çš„æ—¥å¿—å¹¶ä¸ä¼šè¦†ç›–å‰é¢çš„æ—¥å¿— B.binlog æ—¥å¿—æ˜¯è¿½åŠ å†™çš„ï¼Œåé¢çš„æ—¥å¿—å¹¶ä¸ä¼šè¦†ç›–å‰é¢çš„æ—¥å¿— C.redo log å’Œ binlog æ—¥å¿—éƒ½æ˜¯è¿½åŠ å†™çš„ï¼Œåé¢çš„æ—¥å¿—å¹¶ä¸ä¼šè¦†ç›–å‰é¢çš„æ—¥å¿— D.ä»¥ä¸Šè¯´æ³•éƒ½æ­£ç¡® ç­”ï¼šB é¢˜ç›®è§£æï¼šbinlog æ—¥å¿—æ˜¯è¿½åŠ å†™çš„ï¼Œåé¢çš„æ—¥å¿—å¹¶ä¸ä¼šè¦†ç›–å‰é¢çš„æ—¥å¿—ï¼Œredo log æ—¥å¿—æ˜¯å›ºå®šå¤§å°çš„ï¼Œåé¢çš„æ—¥å¿—ä¼šè¦†ç›–å‰é¢çš„æ—¥å¿—ã€‚\n\n### æœ‰æ²¡æœ‰åŠæ³•æŠŠ MySQL çš„æ•°æ®æ¢å¤åˆ°è¿‡å»æŸä¸ªæŒ‡å®šçš„æ—¶é—´èŠ‚ç‚¹ï¼Ÿæ€ä¹ˆæ¢å¤ï¼Ÿ\n\nå¯ä»¥æ¢å¤ï¼Œåªè¦ä½ å¤‡ä»½äº†è¿™æ®µæ—¶é—´çš„æ‰€æœ‰ binlogï¼ŒåŒæ—¶åšäº†å…¨é‡æ•°æ®åº“çš„å®šæœŸå¤‡ä»½ï¼Œæ¯”å¦‚ï¼Œä¸€å¤©ä¸€å¤‡ï¼Œæˆ–è€…ä¸‰å¤©ä¸€å¤‡ï¼Œè¿™å–å†³äºä½ ä»¬çš„å¤‡ä»½ç­–ç•¥ï¼Œè¿™ä¸ªæ—¶å€™ä½ å°±å¯ä»¥æŠŠä¹‹å‰å¤‡ä»½çš„æ•°æ®åº“å…ˆè¿˜åŸåˆ°æµ‹è¯•åº“ï¼Œä»å¤‡ä»½çš„æ—¶é—´ç‚¹å¼€å§‹ï¼Œå°†å¤‡ä»½çš„ binlog ä¾æ¬¡å–å‡ºæ¥ï¼Œé‡æ”¾åˆ°ä½ è¦æ¢å¤æ•°æ®çš„é‚£ä¸ªæ—¶åˆ»ï¼Œè¿™ä¸ªæ—¶å€™å°±å®Œæˆäº†æ•°æ®åˆ°æŒ‡å®šèŠ‚ç‚¹çš„æ¢å¤ã€‚æ¯”å¦‚ï¼Œä»Šå¤©æ—©ä¸Š 9 ç‚¹çš„æ—¶å€™ï¼Œä½ æƒ³æŠŠæ•°æ®æ¢å¤æˆä»Šå¤©æ—©ä¸Š 6:00:00 çš„çŠ¶æ€ï¼Œè¿™ä¸ªæ—¶å€™ä½ å¯ä»¥å…ˆå–å‡ºä»Šå¤©å‡Œæ™¨ï¼ˆ00:01:59ï¼‰å¤‡ä»½çš„æ•°æ®åº“æ–‡ä»¶ï¼Œè¿˜åŸåˆ°æµ‹è¯•åº“ï¼Œå†ä» binlog æ–‡ä»¶ä¸­ä¾æ¬¡å–å‡º 00:01:59 ä¹‹åçš„æ“ä½œä¿¡æ¯ï¼Œé‡æ”¾åˆ° 6:00:00 è¿™ä¸ªæ—¶åˆ»ï¼Œè¿™å°±å®Œæˆäº†æ•°æ®åº“çš„è¿˜åŸã€‚\n\n\n\n## MySQLæ€§èƒ½ä¼˜åŒ–\n\n### MySQL æ€§èƒ½æŒ‡æ ‡éƒ½æœ‰å“ªäº›ï¼Ÿå¦‚ä½•å¾—åˆ°è¿™äº›æŒ‡æ ‡ï¼Ÿ\n\nMySQL çš„æ€§èƒ½æŒ‡æ ‡å¦‚ä¸‹ï¼š\n\n**â‘  TPSï¼ˆTransaction Per Secondï¼‰** æ¯ç§’äº‹åŠ¡æ•°ï¼Œå³æ•°æ®åº“æ¯ç§’æ‰§è¡Œçš„äº‹åŠ¡æ•°ã€‚\n\nMySQL æœ¬èº«æ²¡æœ‰ç›´æ¥æä¾› TPS å‚æ•°å€¼ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦è·å¾— TPS çš„å€¼ï¼Œåªæœ‰æˆ‘ä»¬è‡ªå·±è®¡ç®—äº†ï¼Œå¯ä»¥æ ¹æ® MySQL æ•°æ®åº“æä¾›çš„çŠ¶æ€å˜é‡ï¼Œæ¥è®¡ç®— TPSã€‚\n\néœ€è¦ä½¿ç”¨çš„å‚æ•°ï¼š\n\n*   Com_commit ï¼šè¡¨ç¤ºæäº¤æ¬¡æ•°ï¼Œé€šè¿‡å‘½ä»¤ `show global status like 'Com_commit';` è·å–ï¼›\n\n*   Com_rollbackï¼šè¡¨ç¤ºå›æ»šæ¬¡æ•°ï¼Œé€šè¿‡å‘½ä»¤ `show global status like 'Com_rollback';` è·å–ã€‚\n\næˆ‘ä»¬å®šä¹‰ç¬¬ä¸€æ¬¡è·å–çš„ Com*commit çš„å€¼ä¸ Com*rollback å€¼çš„å’Œä¸º c_r1ï¼Œæ—¶é—´ä¸º t1ï¼›\n\nç¬¬äºŒæ¬¡è·å–çš„ Com*commit çš„å€¼ä¸ Com*rollback å€¼çš„å’Œä¸º c*r2ï¼Œæ—¶é—´ä¸º t2ï¼Œt1 ä¸ t2 å•ä½ä¸ºç§’ã€‚ é‚£ä¹ˆ TPS = ( c*r2 - c_r1 ) / ( t2 - t1 ) ç®—å‡ºæ¥çš„å°±æ˜¯è¯¥ MySQL å®ä¾‹åœ¨ t1 ä¸ t2 ç”Ÿå‘½å‘¨æœŸä¹‹é—´çš„å¹³å‡ TPSã€‚\n\n**â‘¡ QPSï¼ˆQuery Per Secondï¼‰** æ¯ç§’è¯·æ±‚æ¬¡æ•°ï¼Œä¹Ÿå°±æ˜¯æ•°æ®åº“æ¯ç§’æ‰§è¡Œçš„ SQL æ•°é‡ï¼ŒåŒ…å« INSERTã€SELECTã€UPDATEã€DELETE ç­‰ã€‚ QPS = Queries / Seconds Queries æ˜¯ç³»ç»ŸçŠ¶æ€å€¼â€”æ€»æŸ¥è¯¢æ¬¡æ•°ï¼Œå¯ä»¥é€šè¿‡ `show status like 'queries';` æŸ¥è¯¢å¾—å‡º \n\nSeconds æ˜¯ç›‘æ§çš„æ—¶é—´åŒºé—´ï¼Œå•ä½ä¸ºç§’ã€‚ æ¯”å¦‚ï¼Œé‡‡æ · 10 ç§’å†…çš„æŸ¥è¯¢æ¬¡æ•°ï¼Œé‚£ä¹ˆå…ˆæŸ¥è¯¢ä¸€æ¬¡ Queries å€¼ï¼ˆQ1ï¼‰ï¼Œç­‰å¾… 10 ç§’ï¼Œå†æŸ¥è¯¢ä¸€æ¬¡ Queries å€¼ï¼ˆQ2ï¼‰ï¼Œé‚£ä¹ˆ QPS å°±å¯ä»¥é€šè¿‡ï¼Œå¦‚ä¸‹å…¬å¼è·å¾—ï¼š\n\n> QPS = (Q2 - Q1) / 10\n\n**â‘¢ IOPSï¼ˆInput/Output Operations per Secondï¼‰** æ¯ç§’å¤„ç†çš„ I/O è¯·æ±‚æ¬¡æ•°ã€‚\n\nIOPS æ˜¯åˆ¤æ–­ç£ç›˜ I/O èƒ½åŠ›çš„æŒ‡æ ‡ä¹‹ä¸€ï¼Œä¸€èˆ¬æ¥è®² IOPS æŒ‡æ ‡è¶Šé«˜ï¼Œé‚£ä¹ˆå•ä½æ—¶é—´å†…èƒ½å¤Ÿå“åº”çš„è¯·æ±‚è‡ªç„¶ä¹Ÿå°±è¶Šå¤šã€‚ç†è®ºä¸Šè®²ï¼Œåªè¦ç³»ç»Ÿå®é™…çš„è¯·æ±‚æ•°ä½äº IOPS çš„èƒ½åŠ›ï¼Œå°±ç›¸å½“äºæ¯ä¸€ä¸ªè¯·æ±‚éƒ½èƒ½å¾—åˆ°å³æ—¶å“åº”ï¼Œé‚£ä¹ˆ I/O å°±ä¸ä¼šæ˜¯ç“¶é¢ˆäº†ã€‚\n\næ³¨æ„ï¼šIOPS ä¸ç£ç›˜ååé‡ä¸ä¸€æ ·ï¼Œååé‡æ˜¯æŒ‡å•ä½æ—¶é—´å†…å¯ä»¥æˆåŠŸä¼ è¾“çš„æ•°æ®æ•°é‡ã€‚\n\nå¯ä»¥ä½¿ç”¨ iostat å‘½ä»¤ï¼ŒæŸ¥çœ‹ç£ç›˜çš„ IOPSï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š\n\n> yum install sysstat iostat -dx 1 10\n\næ‰§è¡Œæ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š \n\nIOPS = r/s + w/s å…¶ä¸­ï¼š\n\n*   r/sï¼šä»£è¡¨æ¯ç§’è¯»äº†å¤šå°‘æ¬¡ï¼›\n\n*   w/sï¼šä»£è¡¨æ¯ç§’å†™äº†å¤šå°‘æ¬¡ã€‚\n\n### ä»€ä¹ˆæ˜¯æ…¢æŸ¥è¯¢ï¼Ÿ\n\næ…¢æŸ¥è¯¢æ˜¯ MySQL ä¸­æä¾›çš„ä¸€ç§æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œå®ƒç”¨æ¥è®°å½•åœ¨ MySQL ä¸­å“åº”æ—¶é—´è¶…è¿‡é˜€å€¼çš„è¯­å¥ï¼Œå…·ä½“æŒ‡è¿è¡Œæ—¶é—´è¶…è¿‡ *longquerytime* å€¼çš„ SQLï¼Œåˆ™ä¼šè¢«è®°å½•åˆ°æ…¢æŸ¥è¯¢æ—¥å¿—ä¸­ã€‚ *longquerytime* çš„é»˜è®¤å€¼ä¸º 10ï¼Œæ„æ€æ˜¯è¿è¡Œ 10s ä»¥ä¸Šçš„è¯­å¥ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒMySQL æ•°æ®åº“å¹¶ä¸å¯åŠ¨æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œéœ€è¦æˆ‘ä»¬æ‰‹åŠ¨æ¥è®¾ç½®è¿™ä¸ªå‚æ•°ï¼Œå¦‚æœä¸æ˜¯è°ƒä¼˜éœ€è¦çš„è¯ï¼Œä¸€èˆ¬ä¸å»ºè®®å¯åŠ¨è¯¥å‚æ•°ï¼Œå› ä¸ºå¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ä¼šç»™ MySQL æœåŠ¡å™¨å¸¦æ¥ä¸€å®šçš„æ€§èƒ½å½±å“ã€‚æ…¢æŸ¥è¯¢æ—¥å¿—æ”¯æŒå°†æ—¥å¿—è®°å½•å†™å…¥æ–‡ä»¶ï¼Œä¹Ÿæ”¯æŒå°†æ—¥å¿—è®°å½•å†™å…¥æ•°æ®åº“è¡¨ã€‚\n\nä½¿ç”¨ `mysql> show variables like '%slow_query_log%';` æ¥æŸ¥è¯¢æ…¢æŸ¥è¯¢æ—¥å¿—æ˜¯å¦å¼€å¯\n\n### å¦‚ä½•å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Ÿ\n\nå¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹ MySQL å‘½ä»¤ï¼š\n\n> mysql> set global slow*query*log=1\n\nä¸è¿‡è¿™ç§è®¾ç½®æ–¹å¼ï¼Œåªå¯¹å½“å‰æ•°æ®åº“ç”Ÿæ•ˆï¼Œå¦‚æœ MySQL é‡å¯ä¹Ÿä¼šå¤±æ•ˆï¼Œå¦‚æœè¦æ°¸ä¹…ç”Ÿæ•ˆï¼Œå°±å¿…é¡»ä¿®æ”¹ MySQL çš„é…ç½®æ–‡ä»¶ my.cnfï¼Œé…ç½®å¦‚ä¸‹ï¼š\n\n> slow*query*log =1 slow*query*log*file=/tmp/mysql*slow.log\n\n### å¦‚ä½•å®šä½æ…¢æŸ¥è¯¢ï¼Ÿ\n\nä½¿ç”¨ MySQL ä¸­çš„ explain åˆ†ææ‰§è¡Œè¯­å¥ï¼Œæ¯”å¦‚ï¼š\n\n> explain select * from t where id=5;\n\nå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n\n![avatar](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes11474088-2ff861def7876a91.png) \n\nå…¶ä¸­ï¼š\n\n*   id â€” é€‰æ‹©æ ‡è¯†ç¬¦ã€‚id è¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜ï¼Œè¶Šå…ˆè¢«æ‰§è¡Œã€‚\n\n*   select_type â€” è¡¨ç¤ºæŸ¥è¯¢çš„ç±»å‹ã€‚\n\n*   table â€” è¾“å‡ºç»“æœé›†çš„è¡¨\n\n*   partitions â€” åŒ¹é…çš„åˆ†åŒº\n\n*   type â€” è¡¨ç¤ºè¡¨çš„è¿æ¥ç±»å‹\n\n*   possible_keys â€” è¡¨ç¤ºæŸ¥è¯¢æ—¶ï¼Œå¯èƒ½ä½¿ç”¨çš„ç´¢å¼•\n\n*   key â€” è¡¨ç¤ºå®é™…ä½¿ç”¨çš„ç´¢å¼•\n\n*   key_len â€” ç´¢å¼•å­—æ®µçš„é•¿åº¦\n\n*   refâ€” åˆ—ä¸ç´¢å¼•çš„æ¯”è¾ƒ\n\n*   rows â€” å¤§æ¦‚ä¼°ç®—çš„è¡Œæ•°\n\n*   filtered â€” æŒ‰è¡¨æ¡ä»¶è¿‡æ»¤çš„è¡Œç™¾åˆ†æ¯”\n\n*   Extra â€” æ‰§è¡Œæƒ…å†µçš„æè¿°å’Œè¯´æ˜\n\nå…¶ä¸­æœ€é‡è¦çš„å°±æ˜¯ type å­—æ®µï¼Œtype å€¼ç±»å‹å¦‚ä¸‹ï¼š\n\n*   all â€” æ‰«æå…¨è¡¨æ•°æ®\n\n*   index â€” éå†ç´¢å¼•\n\n*   range â€” ç´¢å¼•èŒƒå›´æŸ¥æ‰¾\n\n*   index_subquery â€” åœ¨å­æŸ¥è¯¢ä¸­ä½¿ç”¨ ref\n\n*   uniquesubquery â€” åœ¨å­æŸ¥è¯¢ä¸­ä½¿ç”¨ eq*ref\n\n*   ref*or*null â€” å¯¹ null è¿›è¡Œç´¢å¼•çš„ä¼˜åŒ–çš„ ref\n\n*   fulltext â€” ä½¿ç”¨å…¨æ–‡ç´¢å¼•\n\n*   ref â€” ä½¿ç”¨éå”¯ä¸€ç´¢å¼•æŸ¥æ‰¾æ•°æ®\n\n*   eq_ref â€” åœ¨ join æŸ¥è¯¢ä¸­ä½¿ç”¨ä¸»é”®æˆ–å”¯ä¸€ç´¢å¼•å…³è”\n\n*   const â€” å°†ä¸€ä¸ªä¸»é”®æ”¾ç½®åˆ° where åé¢ä½œä¸ºæ¡ä»¶æŸ¥è¯¢ï¼Œ MySQL ä¼˜åŒ–å™¨å°±èƒ½æŠŠè¿™æ¬¡æŸ¥è¯¢ä¼˜åŒ–è½¬åŒ–ä¸ºä¸€ä¸ªå¸¸é‡ï¼Œå¦‚ä½•è½¬åŒ–ä»¥åŠä½•æ—¶è½¬åŒ–ï¼Œè¿™ä¸ªå–å†³äºä¼˜åŒ–å™¨ï¼Œè¿™ä¸ªæ¯” eq_ref æ•ˆç‡é«˜ä¸€ç‚¹\n\n### â­MySQL çš„ä¼˜åŒ–æ‰‹æ®µéƒ½æœ‰å“ªäº›ï¼Ÿ\n\nMySQL çš„å¸¸è§çš„ä¼˜åŒ–æ‰‹æ®µæœ‰ä»¥ä¸‹äº”ç§ï¼š\n\n#### â‘  æŸ¥è¯¢ä¼˜åŒ–\n\n*   é¿å… SELECT *ï¼ŒåªæŸ¥è¯¢éœ€è¦çš„å­—æ®µã€‚\n\n*   å°è¡¨é©±åŠ¨å¤§è¡¨ï¼Œå³å°çš„æ•°æ®é›†é©±åŠ¨å¤§çš„æ•°æ®é›†ï¼Œæ¯”å¦‚ï¼Œå½“ B è¡¨çš„æ•°æ®é›†å°äº A è¡¨æ—¶ï¼Œç”¨ in ä¼˜åŒ– existï¼Œä¸¤è¡¨æ‰§è¡Œé¡ºåºæ˜¯å…ˆæŸ¥ B è¡¨ï¼Œå†æŸ¥ A è¡¨ï¼ŒæŸ¥è¯¢è¯­å¥ï¼šselect * from A where id in (select id from B) ã€‚\n\n*   ä¸€äº›æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨è¿æ¥ä»£æ›¿å­æŸ¥è¯¢ï¼Œå› ä¸ºä½¿ç”¨ join æ—¶ï¼ŒMySQL ä¸ä¼šåœ¨å†…å­˜ä¸­åˆ›å»ºä¸´æ—¶è¡¨ã€‚\n\n#### â‘¡ ä¼˜åŒ–ç´¢å¼•çš„ä½¿ç”¨\n\n*   å°½é‡ä½¿ç”¨ä¸»é”®æŸ¥è¯¢ï¼Œè€Œéå…¶ä»–ç´¢å¼•ï¼Œå› ä¸ºä¸»é”®æŸ¥è¯¢ä¸ä¼šè§¦å‘å›è¡¨æŸ¥è¯¢ã€‚\n\n*   ä¸åšåˆ—è¿ç®—ï¼ŒæŠŠè®¡ç®—éƒ½æ”¾å…¥å„ä¸ªä¸šåŠ¡ç³»ç»Ÿå®ç°\n\n*   æŸ¥è¯¢è¯­å¥å°½å¯èƒ½ç®€å•ï¼Œå¤§è¯­å¥æ‹†å°è¯­å¥ï¼Œå‡å°‘é”æ—¶é—´\n\n*   ä¸ä½¿ç”¨ select * æŸ¥è¯¢\n\n*   or æŸ¥è¯¢æ”¹å†™æˆ in æŸ¥è¯¢\n\n*   ä¸ç”¨å‡½æ•°å’Œè§¦å‘å™¨\n\n*   é¿å… %xx æŸ¥è¯¢\n\n*   å°‘ç”¨ join æŸ¥è¯¢\n\n*   ä½¿ç”¨åŒç±»å‹æ¯”è¾ƒï¼Œæ¯”å¦‚ '123' å’Œ '123'ã€123 å’Œ 123\n\n*   å°½é‡é¿å…åœ¨ where å­å¥ä¸­ä½¿ç”¨ != æˆ–è€… <> æ“ä½œç¬¦ï¼ŒæŸ¥è¯¢å¼•ç”¨ä¼šæ”¾å¼ƒç´¢å¼•è€Œè¿›è¡Œå…¨è¡¨æ‰«æ\n\n*   é¿å…åœ¨ç´¢å¼•åˆ—ä¸Šä½¿ç”¨ is null å’Œ is not null\n\n*   å°½é‡ä½¿ç”¨ä¸»é”®æŸ¥è¯¢\n\n*   é¿å…åœ¨ where å­å¥ä¸­å¯¹å­—æ®µè¿›è¡Œè¡¨è¾¾å¼æ“ä½œ\n\n*   å°½é‡ä½¿ç”¨æ•°å­—å‹å­—æ®µï¼Œè‹¥åªå«æ•°å€¼ä¿¡æ¯çš„å­—æ®µå°½é‡ä¸è¦è®¾è®¡ä¸ºå­—ç¬¦å‹\n\n#### â‘¢ è¡¨ç»“æ„è®¾è®¡ä¼˜åŒ–\n\n*   ä½¿ç”¨å¯ä»¥å­˜ä¸‹æ•°æ®æœ€å°çš„æ•°æ®ç±»å‹ã€‚\n\n*   ä½¿ç”¨ç®€å•çš„æ•°æ®ç±»å‹ï¼Œint è¦æ¯” varchar ç±»å‹åœ¨ MySQL å¤„ç†ç®€å•ã€‚\n\n*   å°½é‡ä½¿ç”¨ tinyintã€smallintã€mediumint ä½œä¸ºæ•´æ•°ç±»å‹è€Œé intã€‚\n\n*   å°½å¯èƒ½ä½¿ç”¨ not null å®šä¹‰å­—æ®µï¼Œå› ä¸º null å ç”¨ 4 å­—èŠ‚ç©ºé—´ã€‚\n\n*   å°½é‡å°‘ç”¨ text ç±»å‹ï¼Œéç”¨ä¸å¯æ—¶æœ€å¥½è€ƒè™‘åˆ†è¡¨ã€‚\n\n*   å°½é‡ä½¿ç”¨ timestampï¼Œè€Œé datetimeã€‚\n\n*   å•è¡¨ä¸è¦æœ‰å¤ªå¤šå­—æ®µï¼Œå»ºè®®åœ¨ 20 ä¸ªå­—æ®µä»¥å†…ã€‚\n\n#### â‘£ è¡¨æ‹†åˆ†\n\nå½“æ•°æ®åº“ä¸­çš„æ•°æ®éå¸¸å¤§æ—¶ï¼ŒæŸ¥è¯¢ä¼˜åŒ–æ–¹æ¡ˆä¹Ÿä¸èƒ½è§£å†³æŸ¥è¯¢é€Ÿåº¦æ…¢çš„é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘æ‹†åˆ†è¡¨ï¼Œè®©æ¯å¼ è¡¨çš„æ•°æ®é‡å˜å°ï¼Œä»è€Œæé«˜æŸ¥è¯¢æ•ˆç‡ã€‚ \n\n**aï¼‰å‚ç›´æ‹†åˆ†**ï¼šæ˜¯æŒ‡æ•°æ®è¡¨åˆ—çš„æ‹†åˆ†ï¼ŒæŠŠä¸€å¼ åˆ—æ¯”è¾ƒå¤šçš„è¡¨æ‹†åˆ†ä¸ºå¤šå¼ è¡¨ï¼Œæ¯”å¦‚ï¼Œç”¨æˆ·è¡¨ä¸­ä¸€äº›å­—æ®µç»å¸¸è¢«è®¿é—®ï¼Œå°†è¿™äº›å­—æ®µæ”¾åœ¨ä¸€å¼ è¡¨ä¸­ï¼Œå¦å¤–ä¸€äº›ä¸å¸¸ç”¨çš„å­—æ®µæ”¾åœ¨å¦ä¸€å¼ è¡¨ä¸­ï¼Œæ’å…¥æ•°æ®æ—¶ï¼Œä½¿ç”¨äº‹åŠ¡ç¡®ä¿ä¸¤å¼ è¡¨çš„æ•°æ®ä¸€è‡´æ€§ã€‚ å‚ç›´æ‹†åˆ†çš„åŸåˆ™ï¼š\n\n*   æŠŠä¸å¸¸ç”¨çš„å­—æ®µå•ç‹¬æ”¾åœ¨ä¸€å¼ è¡¨ï¼›\n\n*   æŠŠ textï¼Œblob ç­‰å¤§å­—æ®µæ‹†åˆ†å‡ºæ¥æ”¾åœ¨é™„è¡¨ä¸­ï¼›\n\n*   ç»å¸¸ç»„åˆæŸ¥è¯¢çš„åˆ—æ”¾åœ¨ä¸€å¼ è¡¨ä¸­ã€‚\n\n**bï¼‰æ°´å¹³æ‹†åˆ†**ï¼šæŒ‡æ•°æ®è¡¨è¡Œçš„æ‹†åˆ†ï¼Œè¡¨çš„è¡Œæ•°è¶…è¿‡ 200 ä¸‡è¡Œæ—¶ï¼Œå°±ä¼šå˜æ…¢ï¼Œè¿™æ—¶å¯ä»¥æŠŠä¸€å¼ çš„è¡¨çš„æ•°æ®æ‹†æˆå¤šå¼ è¡¨æ¥å­˜æ”¾ã€‚\n\né€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨å–æ¨¡çš„æ–¹å¼æ¥è¿›è¡Œè¡¨çš„æ‹†åˆ†ï¼Œæ¯”å¦‚ï¼Œä¸€å¼ æœ‰ 400W çš„ç”¨æˆ·è¡¨ usersï¼Œä¸ºæé«˜å…¶æŸ¥è¯¢æ•ˆç‡æˆ‘ä»¬æŠŠå…¶åˆ†æˆ 4 å¼ è¡¨ users1ï¼Œusers2ï¼Œusers3ï¼Œusers4ï¼Œç„¶åé€šè¿‡ç”¨æˆ· ID å–æ¨¡çš„æ–¹æ³•ï¼ŒåŒæ—¶æŸ¥è¯¢ã€æ›´æ–°ã€åˆ é™¤ä¹Ÿæ˜¯é€šè¿‡å–æ¨¡çš„æ–¹æ³•æ¥æ“ä½œã€‚\n\n#### â‘¤ è¯»å†™åˆ†ç¦»\n\nä¸€èˆ¬æƒ…å†µä¸‹å¯¹æ•°æ®åº“è€Œè¨€éƒ½æ˜¯â€œè¯»å¤šå†™å°‘â€ï¼Œæ¢è¨€ä¹‹ï¼Œæ•°æ®åº“çš„å‹åŠ›å¤šæ•°æ˜¯å› ä¸ºå¤§é‡çš„è¯»å–æ•°æ®çš„æ“ä½œé€ æˆçš„ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨æ•°æ®åº“é›†ç¾¤çš„æ–¹æ¡ˆï¼Œä½¿ç”¨ä¸€ä¸ªåº“ä½œä¸ºä¸»åº“ï¼Œè´Ÿè´£å†™å…¥æ•°æ®ï¼›å…¶ä»–åº“ä¸ºä»åº“ï¼Œè´Ÿè´£è¯»å–æ•°æ®ã€‚è¿™æ ·å¯ä»¥ç¼“è§£å¯¹æ•°æ®åº“çš„è®¿é—®å‹åŠ›ã€‚\n\n### MySQL å¸¸è§è¯»å†™åˆ†ç¦»æ–¹æ¡ˆæœ‰å“ªäº›ï¼Ÿ\n\nMySQL å¸¸è§çš„è¯»å†™åˆ†ç¦»æ–¹æ¡ˆï¼Œå¦‚ä¸‹åˆ—è¡¨ï¼š\n\n**1ï¼‰åº”ç”¨å±‚è§£å†³æ–¹æ¡ˆ** å¯ä»¥é€šè¿‡åº”ç”¨å±‚å¯¹æ•°æ®æºåšè·¯ç”±æ¥å®ç°è¯»å†™åˆ†ç¦»ï¼Œæ¯”å¦‚ï¼Œä½¿ç”¨ SpringMVC + MyBatisï¼Œå¯ä»¥å°† SQL è·¯ç”±äº¤ç»™ Springï¼Œé€šè¿‡ AOP æˆ–è€… Annotation ç”±ä»£ç æ˜¾ç¤ºçš„æ§åˆ¶æ•°æ®æºã€‚ ä¼˜ç‚¹ï¼šè·¯ç”±ç­–ç•¥çš„æ‰©å±•æ€§å’Œå¯æ§æ€§è¾ƒå¼ºã€‚ ç¼ºç‚¹ï¼šéœ€è¦åœ¨ Spring ä¸­æ·»åŠ è€¦åˆæ§åˆ¶ä»£ç ã€‚\n\n**2ï¼‰ä¸­é—´ä»¶è§£å†³æ–¹æ¡ˆ** é€šè¿‡ MySQL çš„ä¸­é—´ä»¶åšä¸»ä»é›†ç¾¤ï¼Œæ¯”å¦‚ï¼šMysql Proxyã€Amoebaã€Atlas ç­‰ä¸­é—´ä»¶éƒ½èƒ½ç¬¦åˆéœ€æ±‚ã€‚ ä¼˜ç‚¹ï¼šä¸åº”ç”¨å±‚è§£è€¦ã€‚ ç¼ºç‚¹ï¼šå¢åŠ ä¸€ä¸ªæœåŠ¡ç»´æŠ¤çš„é£é™©ç‚¹ï¼Œæ€§èƒ½åŠç¨³å®šæ€§å¾…æµ‹è¯•ï¼Œéœ€è¦æ”¯æŒä»£ç å¼ºåˆ¶ä¸»ä»å’Œäº‹åŠ¡ã€‚\n\n### æ€æ ·ä¿è¯ç¡®ä¿å¤‡åº“æ— å»¶è¿Ÿï¼Ÿ\n\né€šå¸¸ä¿è¯ä¸»å¤‡æ— å»¶è¿Ÿæœ‰ä»¥ä¸‹ä¸‰ç§æ–¹æ³•ï¼š\n\n*   æ¯æ¬¡ä»åº“æ‰§è¡ŒæŸ¥è¯¢è¯·æ±‚å‰ï¼Œå…ˆåˆ¤æ–­ seconds*behind*master æ˜¯å¦å·²ç»ç­‰äº 0ã€‚å¦‚æœè¿˜ä¸ç­‰äº 0 ï¼Œé‚£å°±å¿…é¡»ç­‰åˆ°è¿™ä¸ªå‚æ•°å˜ä¸º 0 æ‰èƒ½æ‰§è¡ŒæŸ¥è¯¢è¯·æ±‚ï¼Œseconds*behind*master å‚æ•°æ˜¯ç”¨æ¥è¡¡é‡ä¸»å¤‡å»¶è¿Ÿæ—¶é—´çš„é•¿çŸ­ï¼›\n\n*   å¯¹æ¯”ä½ç‚¹ç¡®ä¿ä¸»å¤‡æ— å»¶è¿Ÿã€‚Master*Log*File å’Œ Read*Master*Log*Posï¼Œè¡¨ç¤ºçš„æ˜¯è¯»åˆ°çš„ä¸»åº“çš„æœ€æ–°ä½ç‚¹ï¼ŒRelay*Master*Log*File å’Œ Exec*Master*Log_Posï¼Œè¡¨ç¤ºçš„æ˜¯å¤‡åº“æ‰§è¡Œçš„æœ€æ–°ä½ç‚¹ï¼›\n\n*   å¯¹æ¯” GTID é›†åˆç¡®ä¿ä¸»å¤‡æ— å»¶è¿Ÿã€‚Auto*Position=1 ï¼Œè¡¨ç¤ºè¿™å¯¹ä¸»å¤‡å…³ç³»ä½¿ç”¨äº† GTID åè®®ï¼›Retrieved*Gtid*Setï¼Œæ˜¯å¤‡åº“æ”¶åˆ°çš„æ‰€æœ‰æ—¥å¿—çš„ GTID é›†åˆï¼›Executed*Gtid_Setï¼Œæ˜¯å¤‡åº“æ‰€æœ‰å·²ç»æ‰§è¡Œå®Œæˆçš„ GTID é›†åˆã€‚\n\n## MySQLå¼€æ”¾é—®é¢˜\n\n### æœ‰ä¸€ä¸ªè¶…çº§å¤§è¡¨ï¼Œå¦‚ä½•ä¼˜åŒ–åˆ†é¡µæŸ¥è¯¢ï¼Ÿ\n\nè¶…çº§å¤§è¡¨çš„åˆ†é¡µä¼˜åŒ–åˆ†æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹å¼ï¼š\n\n*   æ•°æ®åº“å±‚é¢ä¼˜åŒ–ï¼šåˆ©ç”¨å­æŸ¥è¯¢ä¼˜åŒ–è¶…å¤šåˆ†é¡µåœºæ™¯ï¼Œæ¯”å¦‚ï¼š`SELECT a.* FROM è¡¨ 1 a, (select id from è¡¨ 1 where æ¡ä»¶ LIMIT 100000,20 ) b where a.id=b.id` ï¼Œå…ˆå¿«é€Ÿå®šä½éœ€è¦è·å–çš„ id æ®µï¼Œç„¶åå†å…³è”æŸ¥è¯¢ã€‚MySQL å¹¶ä¸æ˜¯è·³è¿‡ offset è¡Œï¼Œè€Œæ˜¯å– offset+N è¡Œï¼Œç„¶åè¿”å›æ”¾å¼ƒå‰ offset è¡Œï¼Œè¿”å› N è¡Œï¼Œé‚£å½“ offset ç‰¹åˆ«å¤§çš„æ—¶å€™ï¼Œæ•ˆç‡å°±éå¸¸çš„ä½ä¸‹ï¼Œè¦ä¹ˆæ§åˆ¶è¿”å›çš„æ€»é¡µæ•°ï¼Œè¦ä¹ˆå¯¹è¶…è¿‡ç‰¹å®šé˜ˆå€¼çš„é¡µæ•°è¿›è¡Œ SQL æ”¹å†™ï¼Œ\n\t**åˆ©ç”¨å­æŸ¥è¯¢å…ˆå¿«é€Ÿå®šä½éœ€è¦è·å–çš„ id æ®µï¼Œç„¶åå†å…³è”æŸ¥è¯¢ï¼Œå°±æ˜¯å¯¹åˆ†é¡µè¿›è¡Œ SQL æ”¹å†™çš„å…·ä½“å®ç°**ï¼›\n\n*   ç¨‹åºå±‚é¢ä¼˜åŒ–ï¼šå¯ä»¥åˆ©ç”¨**ç¼“å­˜**æŠŠæŸ¥è¯¢çš„ç»“æœç¼“å­˜èµ·æ¥ï¼Œè¿™æ ·å†ä¸‹ä¸€æ¬¡æŸ¥è¯¢çš„æ—¶å€™æ€§èƒ½å°±éå¸¸é«˜äº†ã€‚\n\n### â­æŸ¥è¯¢é•¿æ—¶é—´ä¸è¿”å›å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿåº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ\n\næŸ¥è¯¢é€Ÿåº¦æ…¢çš„åŸå› å¾ˆå¤šï¼Œå¸¸è§å¦‚ä¸‹å‡ ç§ï¼š\n\n 1ï¼‰æŸ¥è¯¢å­—æ®µæ²¡æœ‰ç´¢å¼•æˆ–è€…æ²¡æœ‰è§¦å‘ç´¢å¼•æŸ¥è¯¢ï¼Œæ²¡æœ‰è§¦å‘ç´¢å¼•æŸ¥è¯¢çš„æƒ…å†µå¦‚ä¸‹ï¼š \n\n*   ä»¥ % å¼€å¤´çš„ like æŸ¥è¯¢\n\n*   æ•°æ®ç±»å‹å‡ºç°éšå¼è½¬æ¢æ—¶ä¸ä¼šä½¿ç”¨ç´¢å¼•\n\n*   ä¸ç¬¦åˆæœ€å·¦å‰ç¼€åŸåˆ™ï¼›\n\n*   å¦‚æœæŸ¥è¯¢æ¡ä»¶æœ‰ or åˆ†å‰²ï¼Œå¦‚æœæœ‰ or çš„å­—æ®µæ²¡æœ‰ç´¢å¼•ï¼Œä¼šå¼•èµ·å…¨è¡¨æŸ¥è¯¢ï¼›\n\n*   å¦‚æœ MySQL è®¤ä¸ºä½¿ç”¨ç´¢å¼•ä¼šæ¯”å…¨è¡¨æŸ¥è¯¢æ›´æ…¢ï¼Œåˆ™ä¸ä¼šä½¿ç”¨ç´¢å¼•ã€‚\n\n2ï¼‰I/O å‹åŠ›å¤§ï¼Œè¯»å–ç£ç›˜é€Ÿåº¦å˜æ…¢ï¼Œdf çœ‹ç¡¬ç›˜\n\n3ï¼‰å†…å­˜ä¸è¶³ï¼Œfree çœ‹å†…å­˜ï¼ˆtop çœ‹ cpuï¼‰\n\n4ï¼‰ç½‘ç»œé€Ÿåº¦æ…¢ \n\n5ï¼‰æŸ¥è¯¢å‡ºçš„æ•°æ®é‡è¿‡å¤§ï¼Œå¯ä»¥é‡‡ç”¨å¤šæ¬¡æŸ¥è¯¢æˆ–å…¶ä»–çš„æ–¹æ³•é™ä½æ•°æ®é‡ \n\n6ï¼‰æ­»é”ï¼Œä¸€èˆ¬ç¢°åˆ°è¿™ç§æƒ…å†µçš„è¯ï¼Œå¤§æ¦‚ç‡æ˜¯è¡¨è¢«é”ä½äº†ï¼Œå¯ä»¥ä½¿ç”¨ `show processlist;` å‘½ä»¤ï¼Œçœ‹çœ‹ SQL è¯­å¥çš„çŠ¶æ€ï¼Œå†é’ˆå¯¹ä¸åŒçš„çŠ¶æ€åšç›¸åº”çš„å¤„ç†ã€‚\n\n![avatar](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes11474088-1a918d44eacc26e6.png) \n\nå…¶ä¸­ï¼Œå½“ State åˆ—å€¼ä¸º Locked æ—¶ï¼Œè¡¨ç¤ºè¢«é”å®šã€‚\n\nä»¥ä¸Šé—®é¢˜çš„è§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š\n\n1ï¼‰æ­£ç¡®åˆ›å»ºå’Œä½¿ç”¨ç´¢å¼•ã€‚ \n\n2ï¼‰æŠŠæ•°æ®ã€æ—¥å¿—ã€ç´¢å¼•æ”¾åˆ°ä¸åŒçš„ IO è®¾å¤‡ä¸Šï¼Œå‡å°‘ä¸»æ•°æ®åº“çš„ IO æ“ä½œã€‚æ›´æ¢ MySQL çš„ç£ç›˜ä¸ºå›ºæ€ç¡¬ç›˜ï¼Œä»¥æé«˜ç£ç›˜çš„ IO æ€§èƒ½ã€‚ \n\n3ï¼‰å‡çº§å†…å­˜ï¼Œæ›´æ¢æ›´å¤§çš„å†…å­˜ã€‚ \n\n4ï¼‰æå‡ç½‘é€Ÿï¼Œå‡çº§å¸¦å®½ã€‚ \n\n5ï¼‰ç”¨ Profiler æ¥è·Ÿè¸ªæŸ¥è¯¢ï¼Œå¾—åˆ°æŸ¥è¯¢æ‰€éœ€çš„æ—¶é—´ï¼Œæ‰¾å‡ºæœ‰é—®é¢˜çš„ SQL è¯­å¥ï¼Œä¼˜åŒ– SQLã€‚ \n\n6ï¼‰æŸ¥è¯¢æ—¶å€¼è¿”å›éœ€è¦çš„å­—æ®µã€‚ \n\n7ï¼‰è®¾ç½®æ­»é”çš„è¶…æ—¶æ—¶é—´ï¼Œé™åˆ¶å’Œé¿å…æ­»é”æ¶ˆè€—è¿‡å¤šæœåŠ¡å™¨çš„èµ„æºã€‚ 8ï¼‰å°½é‡å°‘ç”¨è§†å›¾ï¼Œå®ƒçš„æ•ˆç‡ä½ï¼Œå¯¹è§†å›¾æ“ä½œæ¯”ç›´æ¥å¯¹è¡¨æ“ä½œæ…¢,å¯ä»¥ç”¨å­˜å‚¨è¿‡ç¨‹æ¥ä»£æ›¿è§†å›¾ã€‚ä¸è¦ç”¨è§†å›¾åµŒå¥—ï¼ŒåµŒå¥—è§†å›¾å¢åŠ äº†å¯»æ‰¾åŸå§‹æ•°æ®çš„éš¾åº¦ã€‚\n\n### MySQL ä¸»ä»å»¶è¿Ÿçš„åŸå› æœ‰å“ªäº›ï¼Ÿ\n\nä¸»ä»å»¶è¿Ÿå¯ä»¥æ ¹æ® MySQL æä¾›çš„å‘½ä»¤åˆ¤æ–­ï¼Œæ¯”å¦‚ï¼Œåœ¨ä»æœåŠ¡å™¨ä½¿ç”¨å‘½ä»¤ï¼š `show slave status;`ï¼Œå…¶ä¸­ Seconds*Behind*Master å¦‚æœä¸º 0 è¡¨ç¤ºä¸»ä»å¤åˆ¶çŠ¶æ€æ­£å¸¸ã€‚ å¯¼è‡´ä¸»ä»å»¶è¿Ÿçš„åŸå› æœ‰ä»¥ä¸‹å‡ ä¸ªï¼š\n\n*   ä¸»åº“æœ‰å¤§äº‹åŠ¡å¤„ç†ï¼›\n\n*   ä¸»åº“åšå¤§é‡çš„å¢ã€åˆ ã€æ”¹æ“ä½œï¼›\n\n*   ä¸»åº“å¯¹å¤§è¡¨è¿›è¡Œå­—æ®µæ–°å¢ã€ä¿®æ”¹æˆ–æ·»åŠ ç´¢å¼•ç­‰æ“ä½œï¼›\n\n*   ä¸»åº“çš„ä»åº“å¤ªå¤šï¼Œå¯¼è‡´å¤åˆ¶å»¶è¿Ÿã€‚ä»åº“æ•°é‡ä¸€èˆ¬ 3-5 ä¸ªä¸ºå®œï¼Œè¦å¤åˆ¶çš„èŠ‚ç‚¹è¿‡å¤šï¼Œå¯¼è‡´å¤åˆ¶å»¶è¿Ÿï¼›\n\n*   ä»åº“ç¡¬ä»¶é…ç½®æ¯”ä¸»åº“å·®ï¼Œå¯¼è‡´å»¶è¿Ÿã€‚æŸ¥çœ‹ Master å’Œ Slave çš„é…ç½®ï¼Œå¯èƒ½å› ä¸ºä»åº“çš„é…ç½®è¿‡ä½ï¼Œæ‰§è¡Œæ—¶é—´é•¿ï¼Œç”±æ­¤å¯¼è‡´çš„å¤åˆ¶å»¶è¿Ÿæ—¶é—´é•¿ï¼›\n\n*   ä¸»åº“è¯»å†™å‹åŠ›å¤§ï¼Œå¯¼è‡´å¤åˆ¶å»¶è¿Ÿï¼›\n\n*   ä»åº“ä¹‹é—´çš„ç½‘ç»œå»¶è¿Ÿã€‚ä¸»ä»åº“ç½‘å¡ã€ç½‘çº¿ã€è¿æ¥çš„äº¤æ¢æœºç­‰ç½‘ç»œè®¾å¤‡éƒ½å¯èƒ½æˆä¸ºå¤åˆ¶çš„ç“¶é¢ˆï¼Œå¯¼è‡´å¤åˆ¶å»¶è¿Ÿï¼Œå¦å¤–è·¨å…¬ç½‘ä¸»ä»å¤åˆ¶å¾ˆå®¹æ˜“å¯¼è‡´ä¸»ä»å¤åˆ¶å»¶è¿Ÿã€‚\n\n### å¦‚ä½•ä¿è¯æ•°æ®ä¸è¢«è¯¯åˆ ï¼Ÿ\n\nä¿è¯æ•°æ®ä¸è¢«è¯¯åˆ çš„æ–¹æ³•å¦‚ä¸‹åˆ—è¡¨ï¼š\n\n*   æƒé™æ§åˆ¶ä¸åˆ†é…ï¼ˆæ•°æ®åº“å’ŒæœåŠ¡å™¨æƒé™ï¼‰\n\n*   é¿å…æ•°æ®åº“è´¦å·ä¿¡æ¯æ³„éœ²ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä¸šåŠ¡ä»£ç ä¸è¦ä½¿ç”¨æ˜æ–‡ä¿å­˜æ•°æ®åº“è¿æ¥ä¿¡æ¯ï¼›\n\n*   é‡è¦çš„æ•°æ®åº“æ“ä½œï¼Œé€šè¿‡å¹³å°å‹å·¥å…·è‡ªåŠ¨å®æ–½ï¼Œå‡å°‘äººå·¥æ“ä½œï¼›\n\n*   éƒ¨ç½²å»¶è¿Ÿå¤åˆ¶ä»åº“ï¼Œä¸‡ä¸€è¯¯åˆ é™¤æ—¶ç”¨äºæ•°æ®å›æ¡£ï¼Œä¸”ä»åº“è®¾ç½®ä¸º read-onlyï¼›\n\n*   ç¡®è®¤å¤‡ä»½åˆ¶åº¦åŠæ—¶æœ‰æ•ˆï¼›\n\n*   å¯ç”¨ SQL å®¡è®¡åŠŸèƒ½ï¼Œå…»æˆè‰¯å¥½ SQL ä¹ æƒ¯ï¼›\n\n*   å¯ç”¨ sql*safe*updates é€‰é¡¹ï¼Œä¸å…è®¸æ²¡ where æ¡ä»¶çš„æ›´æ–°/åˆ é™¤ï¼›\n\n*   å°†ç³»ç»Ÿå±‚çš„ rm æ”¹ä¸º mvï¼›\n\n*   çº¿ä¸Šä¸è¿›è¡Œç‰©ç†åˆ é™¤ï¼Œæ”¹ä¸ºé€»è¾‘åˆ é™¤ï¼ˆå°† row data æ ‡è®°ä¸ºä¸å¯ç”¨ï¼‰ï¼›\n\n*   å¯ç”¨å ¡å’æœºï¼Œå±è”½é«˜å± SQLï¼›\n\n*   é™ä½æ•°æ®åº“ä¸­æ™®é€šè´¦å·çš„æƒé™çº§åˆ«ï¼›\n\n*   å¼€å¯ binlogï¼Œæ–¹ä¾¿è¿½æº¯æ•°æ®ã€‚\n\n### â­MySQL æœåŠ¡å™¨ CPU é£™å‡åº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ\n\nä½¿ç”¨ `show full processlist;` æŸ¥å‡ºæ…¢æŸ¥è¯¢ï¼Œä¸ºäº†ç¼“è§£æ•°æ®åº“æœåŠ¡å™¨å‹åŠ›ï¼Œå…ˆä½¿ç”¨ kill å‘½ä»¤æ€æ‰æ…¢æŸ¥è¯¢çš„å®¢æˆ·ç«¯ï¼Œç„¶åå†å»é¡¹ç›®ä¸­æ‰¾åˆ°æ‰§è¡Œæ…¢çš„ SQL è¯­å¥è¿›è¡Œä¿®æ”¹å’Œä¼˜åŒ–ã€‚\n\n### MySQL æ¯«æ— è§„å¾‹çš„å¼‚å¸¸é‡å¯ï¼Œå¯èƒ½äº§ç”Ÿçš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿè¯¥å¦‚ä½•è§£å†³ï¼Ÿ\n\nå¯èƒ½æ˜¯ç§¯ç´¯çš„é•¿è¿æ¥å¯¼è‡´å†…å­˜å ç”¨å¤ªå¤šï¼Œè¢«ç³»ç»Ÿå¼ºè¡Œæ€æ‰å¯¼è‡´çš„å¼‚å¸¸é‡å¯ï¼Œå› ä¸ºåœ¨ MySQL ä¸­é•¿è¿æ¥åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä½¿ç”¨çš„ä¸´æ—¶å†…å­˜å¯¹è±¡ï¼Œåªæœ‰åœ¨è¿æ¥æ–­å¼€çš„æ—¶å€™æ‰ä¼šé‡Šæ”¾ï¼Œè¿™å°±ä¼šå¯¼è‡´å†…å­˜ä¸æ–­é£™å‡ï¼Œè§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š\n\n*   å®šæœŸæ–­å¼€ç©ºé—²çš„é•¿è¿æ¥ï¼›\n\n*   å¦‚æœæ˜¯ç”¨çš„æ˜¯ MySQL 5.7 ä»¥ä¸Šçš„ç‰ˆæœ¬ï¼Œå¯ä»¥å®šæœŸæ‰§è¡Œ mysql*reset*connection é‡æ–°åˆå§‹åŒ–è¿æ¥èµ„æºï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šé‡Šæ”¾ä¹‹å‰ä½¿ç”¨çš„å†…å­˜èµ„æºï¼Œæ¢å¤åˆ°è¿æ¥åˆšåˆå§‹åŒ–çš„çŠ¶æ€ã€‚\n\n### å¦‚ä½•å®ç°ä¸€ä¸ªé«˜å¹¶å‘çš„ç³»ç»Ÿï¼Ÿ\n\nè¿™é“é¢è¯•é¢˜æ¶‰åŠçš„çŸ¥è¯†ç‚¹æ¯”è¾ƒå¤šï¼Œä¸»è¦è€ƒå¯Ÿçš„æ˜¯é¢è¯•è€…çš„ç»¼åˆæŠ€æœ¯èƒ½åŠ›ã€‚é«˜å¹¶å‘ç³»ç»Ÿçš„è®¾è®¡æ‰‹æ®µæœ‰å¾ˆå¤šï¼Œä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹äº”ä¸ªæ–¹é¢ã€‚\n\n#### 1ï¼‰å‰ç«¯ä¼˜åŒ–\n\nâ‘  é™æ€èµ„æºç¼“å­˜ï¼šå°†æ´»åŠ¨é¡µé¢ä¸Šçš„æ‰€æœ‰å¯ä»¥é™æ€çš„å…ƒç´ å…¨éƒ¨é™æ€åŒ–ï¼Œå°½é‡å‡å°‘åŠ¨æ€å…ƒç´ ï¼›é€šè¿‡ CDNã€æµè§ˆå™¨ç¼“å­˜ï¼Œæ¥å‡å°‘å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯çš„æ•°æ®è¯·æ±‚ã€‚ \nâ‘¡ ç¦æ­¢é‡å¤æäº¤ï¼šç”¨æˆ·æäº¤ä¹‹åæŒ‰é’®ç½®ç°ï¼Œç¦æ­¢é‡å¤æäº¤ã€‚ \nâ‘¢ ç”¨æˆ·é™æµï¼šåœ¨æŸä¸€æ—¶é—´æ®µå†…åªå…è®¸ç”¨æˆ·æäº¤ä¸€æ¬¡è¯·æ±‚ï¼Œæ¯”å¦‚ï¼Œé‡‡å– IP é™æµã€‚\n\n#### 2ï¼‰ä¸­é—´å±‚è´Ÿè½½åˆ†å‘\n\nå¯åˆ©ç”¨è´Ÿè½½å‡è¡¡ï¼Œæ¯”å¦‚ nginx ç­‰å·¥å…·ï¼Œå¯ä»¥å°†å¹¶å‘è¯·æ±‚åˆ†é…åˆ°ä¸åŒçš„æœåŠ¡å™¨ï¼Œä»è€Œæé«˜äº†ç³»ç»Ÿå¤„ç†å¹¶å‘çš„èƒ½åŠ›ã€‚ nginx è´Ÿè½½åˆ†å‘çš„äº”ç§æ–¹å¼ï¼š\n\nâ‘  è½®è¯¢ï¼ˆé»˜è®¤ï¼‰ æ¯ä¸ªè¯·æ±‚æŒ‰æ—¶é—´é¡ºåºé€ä¸€åˆ†é…åˆ°ä¸åŒçš„åç«¯æœåŠ¡å™¨ï¼Œå¦‚æœåç«¯æœåŠ¡å™¨ä¸èƒ½æ­£å¸¸å“åº”ï¼Œnginx èƒ½è‡ªåŠ¨å‰”é™¤æ•…éšœæœåŠ¡å™¨ã€‚ â‘¡ æŒ‰æƒé‡ï¼ˆweightï¼‰ ä½¿ç”¨ weight å‚æ•°ï¼ŒæŒ‡å®šè½®è¯¢å‡ ç‡ï¼Œweight å’Œè®¿é—®æ¯”ç‡æˆæ­£æ¯”ï¼Œç”¨äºåç«¯æœåŠ¡å™¨æ€§èƒ½ä¸å‡çš„æƒ…å†µï¼Œé…ç½®å¦‚ä¸‹ï¼š\n\n```\nupstream backend { \n    server 192.168.0.14 weight=10; \n    server 192.168.0.15 weight=10; \n}\n```\n\nâ‘¢ IP å“ˆå¸Œå€¼ï¼ˆip_hashï¼‰ æ¯ä¸ªè¯·æ±‚æŒ‰è®¿é—® IP çš„å“ˆå¸Œå€¼åˆ†é…ï¼Œè¿™æ ·æ¯ä¸ªè®¿å®¢å›ºå®šè®¿é—®ä¸€ä¸ªåç«¯æœåŠ¡å™¨ï¼Œå¯ä»¥è§£å†³ session å…±äº«çš„é—®é¢˜ï¼Œé…ç½®å¦‚ä¸‹ï¼š\n\n```\nupstream backend { \n    ip_hash; \n    server 192.168.0.14:88; \n    server 192.168.0.15:80; \n}\n```\n\nâ‘£ å“åº”æ—¶é—´ï¼ˆfairï¼‰ æŒ‰åç«¯æœåŠ¡å™¨çš„å“åº”æ—¶é—´æ¥åˆ†é…è¯·æ±‚ï¼Œå“åº”æ—¶é—´çŸ­çš„ä¼˜å…ˆåˆ†é…ï¼Œé…ç½®å¦‚ä¸‹ï¼š\n\n```\nupstream backend { \n    fair; \n    server server1.com; \n    server server2.com; \n}\n```\n\nâ‘¤ URL å“ˆå¸Œå€¼ï¼ˆurl_hashï¼‰ æŒ‰è®¿é—® url çš„ hash ç»“æœæ¥åˆ†é…è¯·æ±‚ï¼Œå’Œ IP å“ˆå¸Œå€¼ç±»ä¼¼ã€‚\n\n```\nupstream backend {\n    hash $request_uri;\n    server server1.com; \n    server server2.com;   \n}\n```\n\n#### 3ï¼‰æ§åˆ¶å±‚ï¼ˆç½‘å…³å±‚ï¼‰\n\né™åˆ¶åŒä¸€ä¸ªç”¨æˆ·çš„è®¿é—®é¢‘ç‡ï¼Œé™åˆ¶è®¿é—®æ¬¡æ•°ï¼Œé˜²æ­¢å¤šæ¬¡æ¶æ„è¯·æ±‚ã€‚\n\n#### 4ï¼‰æœåŠ¡å±‚\n\nâ‘  ä¸šåŠ¡æœåŠ¡å™¨åˆ†ç¦»ï¼šæ¯”å¦‚ï¼Œå°†ç§’æ€ä¸šåŠ¡ç³»ç»Ÿå’Œå…¶ä»–ä¸šåŠ¡åˆ†ç¦»ï¼Œå•ç‹¬æ”¾åœ¨é«˜é…æœåŠ¡å™¨ä¸Šï¼Œå¯ä»¥é›†ä¸­èµ„æºå¯¹è®¿é—®è¯·æ±‚æŠ—å‹ã€‚ \nâ‘¡ é‡‡ç”¨ MQï¼ˆæ¶ˆæ¯é˜Ÿåˆ—ï¼‰ç¼“å­˜è¯·æ±‚ï¼šMQ å…·æœ‰å‰Šå³°å¡«è°·çš„ä½œç”¨ï¼Œå¯ä»¥æŠŠå®¢æˆ·ç«¯çš„è¯·æ±‚å…ˆå¯¼æµåˆ° MQï¼Œç¨‹åºåœ¨ä» MQ ä¸­è¿›è¡Œæ¶ˆè´¹ï¼ˆæ‰§è¡Œè¯·æ±‚ï¼‰ï¼Œè¿™æ ·å¯ä»¥é¿å…çŸ­æ—¶é—´å†…å¤§é‡è¯·æ±‚ï¼Œå¯¼è‡´æœåŠ¡å™¨ç¨‹åºæ— æ³•å“åº”çš„é—®é¢˜ã€‚ \nâ‘¢ åˆ©ç”¨ç¼“å­˜åº”å¯¹è¯»è¯·æ±‚ï¼Œæ¯”å¦‚ï¼Œä½¿ç”¨ Redis ç­‰ç¼“å­˜ï¼Œåˆ©ç”¨ Redis å¯ä»¥åˆ†æ‹…æ•°æ®åº“å¾ˆå¤§ä¸€éƒ¨åˆ†å‹åŠ›ã€‚\n\n#### 5ï¼‰æ•°æ®åº“å±‚\n\nâ‘  åˆç†ä½¿ç”¨æ•°æ®åº“å¼•æ“ â‘¡ åˆç†è®¾ç½®äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Œåˆç†ä½¿ç”¨äº‹åŠ¡ â‘¢ æ­£ç¡®ä½¿ç”¨ SQL è¯­å¥å’ŒæŸ¥è¯¢ç´¢å¼• â‘£ åˆç†åˆ†åº“åˆ†è¡¨ â‘¤ ä½¿ç”¨æ•°æ®åº“ä¸­é—´ä»¶å®ç°æ•°æ®åº“è¯»å†™åˆ†ç¦» â‘¥ è®¾ç½®æ•°æ®åº“ä¸»ä»è¯»å†™åˆ†ç¦»\n\n\n\n## è¡¥å……\n\n### æŸ¥è¯¢è¯­å¥ä¸åŒå…ƒç´ ï¼ˆwhereã€jionã€limitã€group byã€having ç­‰ç­‰ï¼‰æ‰§è¡Œå…ˆåé¡ºåºï¼Ÿ\n\næŸ¥è¯¢ä¸­ç”¨åˆ°çš„å…³é”®è¯ä¸»è¦åŒ…å«å…­ä¸ªï¼Œå¹¶ä¸”ä»–ä»¬çš„é¡ºåºä¾æ¬¡ä¸º `select--from--where--group by--having--order by`\n\nå…¶ä¸­ select å’Œ from æ˜¯å¿…é¡»çš„ï¼Œå…¶ä»–å…³é”®è¯æ˜¯å¯é€‰çš„ï¼Œè¿™å…­ä¸ªå…³é”®è¯çš„æ‰§è¡Œé¡ºåº ä¸ sql è¯­å¥çš„ä¹¦å†™é¡ºåºå¹¶ä¸æ˜¯ä¸€æ ·çš„ï¼Œè€Œæ˜¯æŒ‰ç…§ä¸‹é¢çš„é¡ºåºæ¥æ‰§è¡Œ\n\n- from:éœ€è¦ä»å“ªä¸ªæ•°æ®è¡¨æ£€ç´¢æ•°æ®\n- where:è¿‡æ»¤è¡¨ä¸­æ•°æ®çš„æ¡ä»¶\n- group by:å¦‚ä½•å°†ä¸Šé¢è¿‡æ»¤å‡ºçš„æ•°æ®åˆ†ç»„\n- having:å¯¹ä¸Šé¢å·²ç»åˆ†ç»„çš„æ•°æ®è¿›è¡Œè¿‡æ»¤çš„æ¡ä»¶\n- select:æŸ¥çœ‹ç»“æœé›†ä¸­çš„å“ªä¸ªåˆ—ï¼Œæˆ–åˆ—çš„è®¡ç®—ç»“æœ\n- order by :æŒ‰ç…§ä»€ä¹ˆæ ·çš„é¡ºåºæ¥æŸ¥çœ‹è¿”å›çš„æ•°æ®\n\nfrom åé¢çš„è¡¨å…³è”ï¼Œæ˜¯è‡ªå³å‘å·¦è§£æ è€Œ where æ¡ä»¶çš„è§£æé¡ºåºæ˜¯è‡ªä¸‹è€Œä¸Šçš„ã€‚\n\nä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨å†™ SQL æ–‡çš„æ—¶å€™ï¼Œå°½é‡æŠŠæ•°æ®é‡å°çš„è¡¨æ”¾åœ¨æœ€å³è¾¹æ¥è¿›è¡Œå…³è”ï¼ˆç”¨å°è¡¨å»åŒ¹é…å¤§è¡¨ï¼‰ï¼Œè€ŒæŠŠèƒ½ç­›é€‰å‡ºå°é‡æ•°æ®çš„æ¡ä»¶æ”¾åœ¨ where è¯­å¥çš„æœ€å·¦è¾¹ ï¼ˆç”¨å°è¡¨å»åŒ¹é…å¤§è¡¨ï¼‰\n\n### éå…³ç³»å‹æ•°æ®åº“å’Œå…³ç³»å‹æ•°æ®åº“åŒºåˆ«ï¼Œä¼˜åŠ¿æ¯”è¾ƒï¼Ÿ\n\n#### éå…³ç³»å‹æ•°æ®åº“çš„ä¼˜åŠ¿\n\n**1. æ€§èƒ½**\n\nNOSQL æ˜¯åŸºäºé”®å€¼å¯¹çš„ï¼Œå¯ä»¥æƒ³è±¡æˆè¡¨ä¸­çš„ä¸»é”®å’Œå€¼çš„å¯¹åº”å…³ç³»ï¼Œè€Œä¸”ä¸éœ€è¦ç»è¿‡ SQL å±‚çš„è§£æï¼Œæ‰€ä»¥æ€§èƒ½éå¸¸é«˜ã€‚\n\n**2. å¯æ‰©å±•æ€§**\n\nåŒæ ·ä¹Ÿæ˜¯å› ä¸ºåŸºäºé”®å€¼å¯¹ï¼Œæ•°æ®ä¹‹é—´æ²¡æœ‰è€¦åˆæ€§ï¼Œæ‰€ä»¥éå¸¸å®¹æ˜“æ°´å¹³æ‰©å±•ã€‚\n\n#### å…³ç³»å‹æ•°æ®åº“çš„ä¼˜åŠ¿\n\n**1. å¤æ‚æŸ¥è¯¢**\n\nå¯ä»¥ç”¨ SQL è¯­å¥æ–¹ä¾¿çš„åœ¨ä¸€ä¸ªè¡¨ä»¥åŠå¤šä¸ªè¡¨ä¹‹é—´åšéå¸¸å¤æ‚çš„æ•°æ®æŸ¥è¯¢ã€‚\n\n**2. äº‹åŠ¡æ”¯æŒ**\n\nä½¿å¾—å¯¹äºå®‰å…¨æ€§èƒ½å¾ˆé«˜çš„æ•°æ®è®¿é—®è¦æ±‚å¾—ä»¥å®ç°ã€‚\n\n#### æ€»ç»“\n\n**å¯¹äºè¿™ä¸¤ç±»æ•°æ®åº“ï¼Œå¯¹æ–¹çš„ä¼˜åŠ¿å°±æ˜¯è‡ªå·±çš„å¼±åŠ¿ï¼Œåä¹‹äº¦ç„¶**ã€‚\n\nNOSQL æ•°æ®åº“æ…¢æ…¢å¼€å§‹å…·å¤‡ SQL æ•°æ®åº“çš„ä¸€äº›å¤æ‚æŸ¥è¯¢åŠŸèƒ½ï¼Œæ¯”å¦‚ MongoDBã€‚\n\nå¯¹äºäº‹åŠ¡çš„æ”¯æŒä¹Ÿå¯ä»¥ç”¨ä¸€äº›ç³»ç»Ÿçº§çš„åŸå­æ“ä½œæ¥å®ç°ä¾‹å¦‚ä¹è§‚é”ä¹‹ç±»çš„æ–¹æ³•æ¥æ›²çº¿æ•‘å›½ï¼Œæ¯”å¦‚ Redis set nxã€‚\n\n### æ•°æ®åº“ä¸‰èŒƒå¼ï¼Œæ ¹æ®æŸä¸ªåœºæ™¯è®¾è®¡æ•°æ®è¡¨ï¼Ÿ\n\n- æ‰€æœ‰å­—æ®µå€¼éƒ½æ˜¯ä¸å¯åˆ†è§£çš„åŸå­å€¼ã€‚\n- åœ¨ä¸€ä¸ªæ•°æ®åº“è¡¨ä¸­ï¼Œä¸€ä¸ªè¡¨ä¸­åªèƒ½ä¿å­˜ä¸€ç§æ•°æ®ï¼Œä¸å¯ä»¥æŠŠå¤šç§æ•°æ®ä¿å­˜åœ¨åŒä¸€å¼ æ•°æ®åº“è¡¨ä¸­ã€‚\n- æ•°æ®è¡¨ä¸­çš„æ¯ä¸€åˆ—æ•°æ®éƒ½å’Œä¸»é”®ç›´æ¥ç›¸å…³ï¼Œè€Œä¸èƒ½é—´æ¥ç›¸å…³ã€‚\n\n#### ç¬¬ä¸€èŒƒå¼(ç¡®ä¿æ¯åˆ—ä¿æŒåŸå­æ€§)\n\n**ç¬¬ä¸€èŒƒå¼æ˜¯æœ€åŸºæœ¬çš„èŒƒå¼ã€‚å¦‚æœæ•°æ®åº“è¡¨ä¸­çš„æ‰€æœ‰å­—æ®µå€¼éƒ½æ˜¯ä¸å¯åˆ†è§£çš„åŸå­å€¼ï¼Œå°±è¯´æ˜è¯¥æ•°æ®åº“è¡¨æ»¡è¶³äº†ç¬¬ä¸€èŒƒå¼**ã€‚\n\nç¬¬ä¸€èŒƒå¼çš„åˆç†éµå¾ªéœ€è¦æ ¹æ®ç³»ç»Ÿçš„å®é™…éœ€æ±‚æ¥å®šã€‚æ¯”å¦‚æŸäº›æ•°æ®åº“ç³»ç»Ÿä¸­éœ€è¦ç”¨åˆ°â€œåœ°å€â€è¿™ä¸ªå±æ€§ï¼Œæœ¬æ¥ç›´æ¥å°†â€œåœ°å€â€å±æ€§è®¾è®¡æˆä¸€ä¸ªæ•°æ®åº“è¡¨çš„å­—æ®µå°±è¡Œã€‚ä½†æ˜¯å¦‚æœç³»ç»Ÿç»å¸¸ä¼šè®¿é—®â€œåœ°å€â€å±æ€§ä¸­çš„â€œåŸå¸‚â€éƒ¨åˆ†ï¼Œé‚£ä¹ˆå°±éè¦å°†â€œåœ°å€â€è¿™ä¸ªå±æ€§é‡æ–°æ‹†åˆ†ä¸ºçœä»½ã€åŸå¸‚ã€è¯¦ç»†åœ°å€ç­‰å¤šä¸ªéƒ¨åˆ†è¿›è¡Œå­˜å‚¨ï¼Œè¿™æ ·åœ¨å¯¹åœ°å€ä¸­æŸä¸€éƒ¨åˆ†æ“ä½œçš„æ—¶å€™å°†éå¸¸æ–¹ä¾¿ã€‚è¿™æ ·è®¾è®¡æ‰ç®—æ»¡è¶³äº†æ•°æ®åº“çš„ç¬¬ä¸€èŒƒå¼ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚\n\nä¸Šè¡¨æ‰€ç¤ºçš„ç”¨æˆ·ä¿¡æ¯éµå¾ªäº†ç¬¬ä¸€èŒƒå¼çš„è¦æ±‚ï¼Œè¿™æ ·åœ¨å¯¹ç”¨æˆ·ä½¿ç”¨åŸå¸‚è¿›è¡Œåˆ†ç±»çš„æ—¶å€™å°±éå¸¸æ–¹ä¾¿ï¼Œä¹Ÿæé«˜äº†æ•°æ®åº“çš„æ€§èƒ½ã€‚\n\n#### ç¬¬äºŒèŒƒå¼(ç¡®ä¿è¡¨ä¸­çš„æ¯åˆ—éƒ½å’Œä¸»é”®ç›¸å…³)\n\nç¬¬äºŒèŒƒå¼åœ¨ç¬¬ä¸€èŒƒå¼çš„åŸºç¡€ä¹‹ä¸Šæ›´è¿›ä¸€å±‚ã€‚ç¬¬äºŒèŒƒå¼éœ€è¦ç¡®ä¿æ•°æ®åº“è¡¨ä¸­çš„æ¯ä¸€åˆ—éƒ½å’Œä¸»é”®ç›¸å…³ï¼Œè€Œä¸èƒ½åªä¸ä¸»é”®çš„æŸä¸€éƒ¨åˆ†ç›¸å…³ï¼ˆä¸»è¦é’ˆå¯¹è”åˆä¸»é”®è€Œè¨€ï¼‰ã€‚**ä¹Ÿå°±æ˜¯è¯´åœ¨ä¸€ä¸ªæ•°æ®åº“è¡¨ä¸­ï¼Œä¸€ä¸ªè¡¨ä¸­åªèƒ½ä¿å­˜ä¸€ç§æ•°æ®ï¼Œä¸å¯ä»¥æŠŠå¤šç§æ•°æ®ä¿å­˜åœ¨åŒä¸€å¼ æ•°æ®åº“è¡¨ä¸­**ã€‚\n\n**æ¯”å¦‚è¦è®¾è®¡ä¸€ä¸ªè®¢å•ä¿¡æ¯è¡¨ï¼Œå› ä¸ºè®¢å•ä¸­å¯èƒ½ä¼šæœ‰å¤šç§å•†å“ï¼Œæ‰€ä»¥è¦å°†è®¢å•ç¼–å·å’Œå•†å“ç¼–å·ä½œä¸ºæ•°æ®åº“è¡¨çš„è”åˆä¸»é”®**ã€‚\n\n#### ç¬¬ä¸‰èŒƒå¼(ç¡®ä¿æ¯åˆ—éƒ½å’Œä¸»é”®åˆ—ç›´æ¥ç›¸å…³,è€Œä¸æ˜¯é—´æ¥ç›¸å…³)\n\nç¬¬ä¸‰èŒƒå¼éœ€è¦ç¡®ä¿æ•°æ®è¡¨ä¸­çš„**æ¯ä¸€åˆ—æ•°æ®éƒ½å’Œä¸»é”®ç›´æ¥ç›¸å…³ï¼Œè€Œä¸èƒ½é—´æ¥ç›¸å…³**ã€‚\n\næ¯”å¦‚åœ¨è®¾è®¡ä¸€ä¸ªè®¢å•æ•°æ®è¡¨çš„æ—¶å€™ï¼Œå¯ä»¥å°†å®¢æˆ·ç¼–å·ä½œä¸ºä¸€ä¸ªå¤–é”®å’Œè®¢å•è¡¨å»ºç«‹ç›¸åº”çš„å…³ç³»ã€‚è€Œä¸å¯ä»¥åœ¨è®¢å•è¡¨ä¸­æ·»åŠ å…³äºå®¢æˆ·å…¶å®ƒä¿¡æ¯ï¼ˆæ¯”å¦‚å§“åã€æ‰€å±å…¬å¸ç­‰ï¼‰çš„å­—æ®µã€‚\n\n### MySQL é«˜å¹¶å‘ç¯å¢ƒè§£å†³æ–¹æ¡ˆï¼Ÿ\n\nMySQL é«˜å¹¶å‘ç¯å¢ƒè§£å†³æ–¹æ¡ˆ åˆ†åº“ åˆ†è¡¨ åˆ†å¸ƒå¼ å¢åŠ äºŒçº§ç¼“å­˜ã€‚\n\n**éœ€æ±‚åˆ†æ**ï¼šäº’è”ç½‘å•ä½ æ¯å¤©å¤§é‡æ•°æ®è¯»å–ï¼Œå†™å…¥ï¼Œå¹¶å‘æ€§é«˜ã€‚\n\n- **ç°æœ‰è§£å†³æ–¹å¼**ï¼šæ°´å¹³åˆ†åº“åˆ†è¡¨ï¼Œç”±å•ç‚¹åˆ†å¸ƒåˆ°å¤šç‚¹æ•°æ®åº“ä¸­ï¼Œä»è€Œé™ä½å•ç‚¹æ•°æ®åº“å‹åŠ›ã€‚\n- **é›†ç¾¤æ–¹æ¡ˆ**ï¼šè§£å†³ DB å®•æœºå¸¦æ¥çš„å•ç‚¹ DB ä¸èƒ½è®¿é—®é—®é¢˜ã€‚\n- **è¯»å†™åˆ†ç¦»ç­–ç•¥**ï¼šæå¤§é™åº¦æé«˜äº†åº”ç”¨ä¸­ Read æ•°æ®çš„é€Ÿåº¦å’Œå¹¶å‘é‡ã€‚æ— æ³•è§£å†³é«˜å†™å…¥å‹åŠ›ã€‚\n\n\n\n### æ•°æ®åº“å´©æºƒæ—¶äº‹åŠ¡çš„æ¢å¤æœºåˆ¶ï¼ˆREDO æ—¥å¿—å’Œ UNDO æ—¥å¿—ï¼‰ï¼Ÿ\n\n#### Undo Log\n\n**Undo Log æ˜¯ä¸ºäº†å®ç°äº‹åŠ¡çš„åŸå­æ€§**ï¼Œåœ¨ MySQL æ•°æ®åº“ InnoDB å­˜å‚¨å¼•æ“ä¸­ï¼Œè¿˜ç”¨äº† Undo Log æ¥å®ç°å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶(ç®€ç§°ï¼šMVCC)ã€‚\n\n- **äº‹åŠ¡çš„åŸå­æ€§**(Atomicity)äº‹åŠ¡ä¸­çš„æ‰€æœ‰æ“ä½œï¼Œè¦ä¹ˆå…¨éƒ¨å®Œæˆï¼Œè¦ä¹ˆä¸åšä»»ä½•æ“ä½œï¼Œä¸èƒ½åªåšéƒ¨åˆ†æ“ä½œã€‚å¦‚æœåœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­å‘ç”Ÿäº†é”™è¯¯ï¼Œè¦å›æ»š(Rollback)åˆ°äº‹åŠ¡å¼€å§‹å‰çš„çŠ¶æ€ï¼Œå°±åƒè¿™ä¸ªäº‹åŠ¡ä»æ¥æ²¡æœ‰æ‰§è¡Œè¿‡ã€‚\n- **åŸç†**Undo Log çš„åŸç†å¾ˆç®€å•ï¼Œ**ä¸ºäº†æ»¡è¶³äº‹åŠ¡çš„åŸå­æ€§ï¼Œåœ¨æ“ä½œä»»ä½•æ•°æ®ä¹‹å‰ï¼Œé¦–å…ˆå°†æ•°æ®å¤‡ä»½åˆ°ä¸€ä¸ªåœ°æ–¹ï¼ˆè¿™ä¸ªå­˜å‚¨æ•°æ®å¤‡ä»½çš„åœ°æ–¹ç§°ä¸º UndoLogï¼‰**ã€‚ç„¶åè¿›è¡Œæ•°æ®çš„ä¿®æ”¹ã€‚å¦‚æœå‡ºç°äº†é”™è¯¯æˆ–è€…ç”¨æˆ·æ‰§è¡Œäº† ROLLBACK è¯­å¥ï¼Œ**ç³»ç»Ÿå¯ä»¥åˆ©ç”¨ Undo Log ä¸­çš„å¤‡ä»½å°†æ•°æ®æ¢å¤åˆ°äº‹åŠ¡å¼€å§‹ä¹‹å‰çš„çŠ¶æ€**ã€‚\n\n**ä¹‹æ‰€ä»¥èƒ½åŒæ—¶ä¿è¯åŸå­æ€§å’ŒæŒä¹…åŒ–ï¼Œæ˜¯å› ä¸ºä»¥ä¸‹ç‰¹ç‚¹**ï¼š\n\n- æ›´æ–°æ•°æ®å‰è®°å½• Undo logã€‚\n- ä¸ºäº†ä¿è¯æŒä¹…æ€§ï¼Œå¿…é¡»å°†æ•°æ®åœ¨äº‹åŠ¡æäº¤å‰å†™åˆ°ç£ç›˜ã€‚åªè¦äº‹åŠ¡æˆåŠŸæäº¤ï¼Œæ•°æ®å¿…ç„¶å·²ç»æŒä¹…åŒ–ã€‚\n- **Undo log å¿…é¡»å…ˆäºæ•°æ®æŒä¹…åŒ–åˆ°ç£ç›˜**ã€‚å¦‚æœåœ¨ G,H ä¹‹é—´ç³»ç»Ÿå´©æºƒï¼Œ**undo log æ˜¯å®Œæ•´çš„ï¼Œ å¯ä»¥ç”¨æ¥å›æ»šäº‹åŠ¡**ã€‚\n- å¦‚æœåœ¨ A-F ä¹‹é—´ç³»ç»Ÿå´©æºƒ,å› ä¸ºæ•°æ®æ²¡æœ‰æŒä¹…åŒ–åˆ°ç£ç›˜ã€‚æ‰€ä»¥ç£ç›˜ä¸Šçš„æ•°æ®è¿˜æ˜¯ä¿æŒåœ¨äº‹åŠ¡å¼€å§‹å‰çš„çŠ¶æ€ã€‚\n\n**ç¼ºé™·**ï¼š**æ¯ä¸ªäº‹åŠ¡æäº¤å‰å°†æ•°æ®å’Œ Undo Log å†™å…¥ç£ç›˜ï¼Œè¿™æ ·ä¼šå¯¼è‡´å¤§é‡çš„ç£ç›˜ IOï¼Œå› æ­¤æ€§èƒ½å¾ˆä½**ã€‚\n\nå¦‚æœèƒ½å¤Ÿå°†æ•°æ®ç¼“å­˜ä¸€æ®µæ—¶é—´ï¼Œå°±èƒ½å‡å°‘ IO æé«˜æ€§èƒ½ã€‚ä½†æ˜¯è¿™æ ·å°±ä¼šä¸§å¤±äº‹åŠ¡çš„æŒä¹…æ€§ã€‚å› æ­¤å¼•å…¥äº†å¦å¤–ä¸€ç§æœºåˆ¶æ¥å®ç°æŒä¹…åŒ–ï¼Œå³ Redo Logã€‚\n\n#### Redo Log\n\n- **åŸç†å’Œ Undo Log ç›¸å**ï¼Œ**Redo Log è®°å½•çš„æ˜¯æ–°æ•°æ®çš„å¤‡ä»½**ã€‚**åœ¨äº‹åŠ¡æäº¤å‰ï¼Œåªè¦å°† Redo Log æŒä¹…åŒ–å³å¯ï¼Œä¸éœ€è¦å°†æ•°æ®æŒä¹…åŒ–ã€‚å½“ç³»ç»Ÿå´©æºƒæ—¶ï¼Œè™½ç„¶æ•°æ®æ²¡æœ‰æŒä¹…åŒ–ï¼Œä½†æ˜¯ Redo Log å·²ç»æŒä¹…åŒ–ã€‚ç³»ç»Ÿå¯ä»¥æ ¹æ® Redo Log çš„å†…å®¹ï¼Œå°†æ‰€æœ‰æ•°æ®æ¢å¤åˆ°æœ€æ–°çš„çŠ¶æ€**ã€‚\n\n### Explain æ€§èƒ½åˆ†æ\n\n**æ˜¯ä»€ä¹ˆ**\n\næŸ¥çœ‹æ‰§è¡Œè®¡åˆ’ï¼šä½¿ç”¨ EXPLAIN å…³é”®å­—å¯ä»¥æ¨¡æ‹Ÿä¼˜åŒ–å™¨æ‰§è¡Œ SQL æŸ¥è¯¢è¯­å¥ï¼Œä»è€ŒçŸ¥é“ MySQL æ˜¯å¦‚ä½•å¤„ç† SQL è¯­å¥çš„ã€‚åˆ†ææŸ¥è¯¢è¯­å¥æˆ–æ˜¯è¡¨ç»“æ„çš„æ€§èƒ½ç“¶é¢ˆã€‚\n\n**èƒ½å¹²å˜›**\n\n- è¡¨çš„è¯»å–é¡ºåº\n- æ•°æ®è¯»å–æ“ä½œçš„æ“ä½œç±»å‹\n- å“ªäº›ç´¢å¼•å¯ä»¥ä½¿ç”¨\n- å“ªäº›ç´¢å¼•è¢«å®é™…ä½¿ç”¨\n- è¡¨ä¹‹é—´çš„å¼•ç”¨\n- æ¯å¼ è¡¨æœ‰å¤šå°‘è¡Œè¢«ä¼˜åŒ–å™¨æŸ¥è¯¢\n\n**æ€ä¹ˆç©**\n\nExplain + SQL è¯­å¥ã€‚\nExplain æ‰§è¡Œåè¿”å›çš„ä¿¡æ¯ï¼š\n <img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131912576.png\" alt=\"image-20220422131912576\" style=\"zoom:50%;\" />\n\n**å„å­—æ®µè§£é‡Š**\n\n1. idï¼šselect æŸ¥è¯¢çš„åºåˆ—å·ï¼ŒåŒ…å«ä¸€ç»„æ•°å­—ï¼Œè¡¨ç¤ºæŸ¥è¯¢ä¸­æ‰§è¡Œ select å­å¥æˆ–æ“ä½œè¡¨çš„é¡ºåºã€‚\n\n\t- id ç›¸åŒï¼Œæ‰§è¡Œé¡ºåºç”±ä¸Šè‡³ä¸‹\n\t- id ä¸åŒï¼Œå¦‚æœæ˜¯å­æŸ¥è¯¢ï¼Œid çš„åºå·ä¼šé€’å¢ï¼Œid å€¼è¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜ï¼Œè¶Šå…ˆè¢«æ‰§è¡Œ\n\t- id æœ‰ç›¸åŒä¹Ÿæœ‰ä¸åŒï¼šid å¦‚æœç›¸åŒï¼Œå¯ä»¥è®¤ä¸ºæ˜¯ä¸€ç»„ï¼Œä»ä¸Šå¾€ä¸‹é¡ºåºæ‰§è¡Œï¼›åœ¨æ‰€æœ‰ç»„ä¸­ï¼Œid å€¼è¶Šå¤§ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼Œè¶Šå…ˆæ‰§è¡Œ\n\n\t> id å·æ¯ä¸ªå·ç ï¼Œè¡¨ç¤ºä¸€è¶Ÿç‹¬ç«‹çš„æŸ¥è¯¢ã€‚ä¸€ä¸ª sql çš„æŸ¥è¯¢è¶Ÿæ•°è¶Šå°‘è¶Šå¥½ã€‚\n\n2. select_typeï¼šä»£è¡¨æŸ¥è¯¢çš„ç±»å‹ï¼Œä¸»è¦æ˜¯ç”¨äºåŒºåˆ«æ™®é€šæŸ¥è¯¢ã€è”åˆæŸ¥è¯¢ã€å­æŸ¥è¯¢ç­‰çš„å¤æ‚æŸ¥è¯¢ï¼Œå–å€¼èŒƒå›´å¦‚ä¸‹ï¼š\n\n\t- simpleï¼šç®€å•çš„ select æŸ¥è¯¢ï¼ŒæŸ¥è¯¢ä¸­ä¸åŒ…å«å­æŸ¥è¯¢æˆ–è€… UNION\n\t- primaryï¼šæŸ¥è¯¢ä¸­è‹¥åŒ…å«ä»»ä½•å¤æ‚çš„å­éƒ¨åˆ†ï¼Œæœ€å¤–å±‚æŸ¥è¯¢åˆ™è¢«æ ‡è®°ä¸º primary\n\t- derivedï¼šåœ¨ FROM åˆ—è¡¨ä¸­åŒ…å«çš„å­æŸ¥è¯¢è¢«æ ‡è®°ä¸º DERIVED (è¡ç”Ÿ)ï¼ŒMySQL ä¼šé€’å½’æ‰§è¡Œè¿™äº›å­æŸ¥è¯¢, æŠŠç»“æœæ”¾åœ¨ä¸´æ—¶è¡¨é‡Œã€‚\n\t- subqueryï¼šåœ¨ SELECT æˆ– WHERE åˆ—è¡¨ä¸­åŒ…å«äº†å­æŸ¥è¯¢\n\t- depedent subqueryï¼šåœ¨ SELECT æˆ– WHERE åˆ—è¡¨ä¸­åŒ…å«äº†å­æŸ¥è¯¢ï¼Œå­æŸ¥è¯¢åŸºäºå¤–å±‚\n\t- uncacheable subqueryï¼šæ— æ³•ä½¿ç”¨ç¼“å­˜çš„å­æŸ¥è¯¢\n\t- unionï¼šè‹¥ç¬¬äºŒä¸ª SELECT å‡ºç°åœ¨ UNION ä¹‹åï¼Œåˆ™è¢«æ ‡è®°ä¸º UNIONï¼›è‹¥ UNION åŒ…å«åœ¨ FROM å­å¥çš„å­æŸ¥è¯¢ä¸­ï¼Œå¤–å±‚ SELECT å°†è¢«æ ‡è®°ä¸ºï¼šDERIVED\n\t- union resultï¼šä» UNION è¡¨è·å–ç»“æœçš„ SELECT\n\n3. tableï¼šè¿™ä¸ªæ•°æ®æ˜¯åŸºäºå“ªå¼ è¡¨çš„ã€‚\n\n4. typeï¼šæ˜¯æŸ¥è¯¢çš„è®¿é—®ç±»å‹ã€‚æ˜¯è¾ƒä¸ºé‡è¦çš„ä¸€ä¸ªæŒ‡æ ‡ï¼Œç»“æœå€¼ä»æœ€å¥½åˆ°æœ€åä¾æ¬¡æ˜¯ï¼šsystem > const > eq_ref > ref > fulltext > ref_or_null > index_merge > unique_subquery > index_subquery > range > index > ALLï¼Œä¸€èˆ¬æ¥è¯´ï¼Œå¾—ä¿è¯æŸ¥è¯¢è‡³å°‘è¾¾åˆ° range çº§åˆ«ï¼Œæœ€å¥½èƒ½è¾¾åˆ° refã€‚\n\n\t> åªéœ€è¦è®°ä½ï¼šsystem > const > eq_ref > ref > range > index > ALL å°±è¡Œäº†ï¼Œå…¶ä»–çš„ä¸å¸¸è§ã€‚\n\n\t- systemï¼šè¡¨åªæœ‰ä¸€è¡Œè®°å½•ï¼ˆç­‰äºç³»ç»Ÿè¡¨ï¼‰ï¼Œè¿™æ˜¯ const ç±»å‹çš„ç‰¹åˆ—ï¼Œå¹³æ—¶ä¸ä¼šå‡ºç°ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥å¿½ç•¥ä¸è®¡ã€‚\n\t- constï¼šè¡¨ç¤ºé€šè¿‡ç´¢å¼•ä¸€æ¬¡å°±æ‰¾åˆ°äº†ï¼Œconst ç”¨äºæ¯”è¾ƒ primary key æˆ–è€… unique ç´¢å¼•ã€‚å› ä¸ºåªåŒ¹é…ä¸€è¡Œæ•°æ®ï¼Œæ‰€ä»¥å¾ˆå¿«ã€‚å¦‚å°†ä¸»é”®ç½®äº where åˆ—è¡¨ä¸­ï¼ŒMySQL å°±èƒ½å°†è¯¥æŸ¥è¯¢è½¬æ¢ä¸ºä¸€ä¸ªå¸¸é‡ã€‚\n\t- eq_refï¼šå”¯ä¸€æ€§ç´¢å¼•æ‰«æï¼Œå¯¹äºæ¯ä¸ªç´¢å¼•é”®ï¼Œè¡¨ä¸­åªæœ‰ä¸€æ¡è®°å½•ä¸ä¹‹åŒ¹é…ã€‚å¸¸è§äºä¸»é”®æˆ–å”¯ä¸€ç´¢å¼•æ‰«æã€‚\n\t- refï¼šéå”¯ä¸€æ€§ç´¢å¼•æ‰«æï¼Œè¿”å›åŒ¹é…æŸä¸ªå•ç‹¬å€¼çš„æ‰€æœ‰è¡Œã€‚æœ¬è´¨ä¸Šä¹Ÿæ˜¯ä¸€ç§ç´¢å¼•è®¿é—®ï¼Œå®ƒè¿”å›æ‰€æœ‰åŒ¹é…æŸä¸ªå•ç‹¬å€¼çš„è¡Œï¼Œç„¶è€Œï¼Œå®ƒå¯èƒ½ä¼šæ‰¾åˆ°å¤šä¸ªç¬¦åˆæ¡ä»¶çš„è¡Œï¼Œæ‰€ä»¥ä»–åº”è¯¥å±äºæŸ¥æ‰¾å’Œæ‰«æçš„æ··åˆä½“ã€‚\n\t- rangeï¼šåªæ£€ç´¢ç»™å®šèŒƒå›´çš„è¡Œï¼Œä½¿ç”¨ä¸€ä¸ªç´¢å¼•æ¥é€‰æ‹©è¡Œã€‚key åˆ—æ˜¾ç¤ºä½¿ç”¨äº†å“ªä¸ªç´¢å¼•ä¸€èˆ¬å°±æ˜¯åœ¨ where è¯­å¥ä¸­å‡ºç°äº† betweenã€<ã€>ã€in ç­‰çš„æŸ¥è¯¢è¿™ç§èŒƒå›´æ‰«æç´¢å¼•æ‰«ææ¯”å…¨è¡¨æ‰«æè¦å¥½ï¼Œå› ä¸ºå®ƒåªéœ€è¦å¼€å§‹äºç´¢å¼•çš„æŸä¸€ç‚¹ï¼Œè€Œç»“æŸè¯­å¦ä¸€ç‚¹ï¼Œä¸ç”¨æ‰«æå…¨éƒ¨ç´¢å¼•ã€‚\n\t- indexï¼šå‡ºç° index æ˜¯ sql ä½¿ç”¨äº†ç´¢å¼•ä½†æ˜¯æ²¡ç”¨ç´¢å¼•è¿›è¡Œè¿‡æ»¤ï¼Œä¸€èˆ¬æ˜¯ä½¿ç”¨äº†è¦†ç›–ç´¢å¼•æˆ–è€…æ˜¯åˆ©ç”¨ç´¢å¼•è¿›è¡Œäº†æ’åºåˆ†ç»„ã€‚\n\t- allï¼šå°†éå†å…¨è¡¨ä»¥æ‰¾åˆ°åŒ¹é…çš„è¡Œã€‚\n\n\t> å…¶ä»– type å¦‚ä¸‹ï¼š\n\n\t- index_mergeï¼šåœ¨æŸ¥è¯¢è¿‡ç¨‹ä¸­éœ€è¦å¤šä¸ªç´¢å¼•ç»„åˆä½¿ç”¨ï¼Œé€šå¸¸å‡ºç°åœ¨æœ‰ or å…³é”®å­—çš„ sql ä¸­ã€‚\n\t- ref_or_nullï¼šå¯¹äºæŸä¸ªå­—æ®µæ—¢éœ€è¦è¿‡æ»¤æ¡ä»¶ï¼Œä¹Ÿéœ€è¦ null å€¼çš„æƒ…å†µä¸‹ã€‚æŸ¥è¯¢ä¼˜åŒ–å™¨ä¼šé€‰æ‹©ç”¨ ref_or_null è¿æ¥æŸ¥è¯¢ã€‚\n\t- index_subqueryï¼šåˆ©ç”¨ç´¢å¼•æ¥å…³è”å­æŸ¥è¯¢ï¼Œä¸å†å…¨è¡¨æ‰«æã€‚\n\t- unique_subqueryï¼šè¯¥è”æ¥ç±»å‹ç±»ä¼¼äº index_subqueryã€‚å­æŸ¥è¯¢ä¸­çš„å”¯ä¸€ç´¢å¼•ã€‚\n\n5. possible_keysï¼šæ˜¾ç¤ºå¯èƒ½åº”ç”¨åœ¨è¿™å¼ è¡¨ä¸­çš„ç´¢å¼•ï¼Œä¸€ä¸ªæˆ–å¤šä¸ªã€‚æŸ¥è¯¢æ¶‰åŠåˆ°çš„å­—æ®µä¸Šè‹¥å­˜åœ¨ç´¢å¼•ï¼Œåˆ™è¯¥ç´¢å¼•å°†è¢«åˆ—å‡ºï¼Œä½†ä¸ä¸€å®šè¢«æŸ¥è¯¢å®é™…ä½¿ç”¨ã€‚\n\n6. keyï¼šå®é™…ä½¿ç”¨çš„ç´¢å¼•ã€‚å¦‚æœä¸º NULLï¼Œåˆ™æ²¡æœ‰ä½¿ç”¨ç´¢å¼•ã€‚\n\n7. key_lenï¼šè¡¨ç¤ºç´¢å¼•ä¸­ä½¿ç”¨çš„å­—èŠ‚æ•°ï¼Œå¯é€šè¿‡è¯¥åˆ—è®¡ç®—æŸ¥è¯¢ä¸­ä½¿ç”¨çš„ç´¢å¼•çš„é•¿åº¦ã€‚key_len æ˜¾ç¤ºçš„å€¼ä¸ºç´¢å¼•å­—æ®µçš„æœ€å¤§å¯èƒ½é•¿åº¦ï¼Œå¹¶éå®é™…ä½¿ç”¨é•¿åº¦ã€‚å¦‚ä½•è®¡ç®— key_lenï¼Ÿ\n\n\t- å…ˆçœ‹ç´¢å¼•ä¸Šå­—æ®µçš„ç±»å‹ + é•¿åº¦ï¼Œæ¯”å¦‚ï¼šint=4; varchar(20)=20; char(20)=20\n\t- å¦‚æœæ˜¯ varchar æˆ–è€… char è¿™ç§å­—ç¬¦ä¸²å­—æ®µï¼Œè§†å­—ç¬¦é›†è¦ä¹˜ä¸åŒçš„å€¼ï¼Œæ¯”å¦‚ utf-8 è¦ä¹˜ 3ï¼ŒGBK è¦ä¹˜ 2\n\t- varchar è¿™ç§åŠ¨æ€å­—ç¬¦ä¸²è¦åŠ  2 ä¸ªå­—èŠ‚\n\t- å…è®¸ä¸ºç©ºçš„å­—æ®µè¦åŠ  1 ä¸ªå­—èŠ‚\n\n8. refï¼šæ˜¾ç¤ºç´¢å¼•çš„å“ªä¸€åˆ—è¢«ä½¿ç”¨äº†ï¼Œå¦‚æœå¯èƒ½çš„è¯ï¼Œæ˜¯ä¸€ä¸ªå¸¸æ•°ã€‚å“ªäº›åˆ—æˆ–å¸¸é‡è¢«ç”¨äºæŸ¥æ‰¾ç´¢å¼•åˆ—ä¸Šçš„å€¼ã€‚\n\n9. rowsï¼šæ˜¾ç¤º MySQL è®¤ä¸ºå®ƒæ‰§è¡ŒæŸ¥è¯¢æ—¶å¿…é¡»æ£€æŸ¥çš„è¡Œæ•°ã€‚è¶Šå°‘è¶Šå¥½ï¼\n\n10. Extraï¼šå…¶ä»–çš„é¢å¤–é‡è¦çš„ä¿¡æ¯ã€‚\n\n\t- Using filesortï¼šè¯´æ˜ mysql ä¼šå¯¹æ•°æ®ä½¿ç”¨ä¸€ä¸ªå¤–éƒ¨çš„ç´¢å¼•æ’åºï¼Œè€Œä¸æ˜¯æŒ‰ç…§è¡¨å†…çš„ç´¢å¼•é¡ºåºè¿›è¡Œè¯»å–ã€‚MySQL ä¸­æ— æ³•åˆ©ç”¨ç´¢å¼•å®Œæˆçš„æ’åºæ“ä½œç§°ä¸ºâ€œæ–‡ä»¶æ’åºâ€ã€‚**æ’åºå­—æ®µè‹¥é€šè¿‡ç´¢å¼•å»è®¿é—®å°†å¤§å¤§æé«˜æ’åºé€Ÿåº¦**ã€‚\n\t- Using temporaryï¼šä½¿ç”¨ä¸´æ—¶è¡¨ä¿å­˜ä¸­é—´ç»“æœï¼ŒMySQL åœ¨å¯¹æŸ¥è¯¢ç»“æœæ’åºæ—¶ä½¿ç”¨ä¸´æ—¶è¡¨ã€‚å¸¸è§äºæ’åº order by å’Œåˆ†ç»„æŸ¥è¯¢ group byã€‚\n\t- Using indexï¼šè¡¨ç¤ºç›¸åº”çš„ select æ“ä½œä¸­ä½¿ç”¨äº†è¦†ç›–ç´¢å¼• (Covering Index)ï¼Œé¿å…è®¿é—®äº†è¡¨çš„æ•°æ®è¡Œï¼Œæ•ˆç‡ä¸é”™ï¼å¦‚æœåŒæ—¶å‡ºç° using whereï¼Œè¡¨æ˜ç´¢å¼•è¢«ç”¨æ¥æ‰§è¡Œç´¢å¼•é”®å€¼çš„æŸ¥æ‰¾ï¼›å¦‚æœæ²¡æœ‰åŒæ—¶å‡ºç° using whereï¼Œè¡¨æ˜ç´¢å¼•åªæ˜¯ç”¨æ¥è¯»å–æ•°æ®è€Œéåˆ©ç”¨ç´¢å¼•æ‰§è¡ŒæŸ¥æ‰¾ã€‚\n\t- Using whereï¼šè¡¨æ˜ä½¿ç”¨äº† where è¿‡æ»¤ã€‚\n\t- Using join bufferï¼šä½¿ç”¨äº†è¿æ¥ç¼“å­˜ã€‚\n\t- impossible whereï¼šwhere å­å¥çš„å€¼æ€»æ˜¯ falseï¼Œä¸èƒ½ç”¨æ¥è·å–ä»»ä½•æ•°æ®ã€‚\n\t- select tables optimized awayï¼šåœ¨æ²¡æœ‰ group by å­å¥çš„æƒ…å†µä¸‹ï¼ŒåŸºäºç´¢å¼•ä¼˜åŒ– MIN/MAX æ“ä½œæˆ–è€…å¯¹äº MyISAM å­˜å‚¨å¼•æ“ä¼˜åŒ– COUNT(*) æ“ä½œï¼Œä¸å¿…ç­‰åˆ°æ‰§è¡Œé˜¶æ®µå†è¿›è¡Œè®¡ç®—ï¼ŒæŸ¥è¯¢æ‰§è¡Œè®¡åˆ’ç”Ÿæˆçš„é˜¶æ®µå³å®Œæˆä¼˜åŒ–ã€‚\n\t- distinctï¼šä¼˜åŒ– distinct æ“ä½œï¼Œåœ¨æ‰¾åˆ°ç¬¬ä¸€åŒ¹é…çš„å…ƒç¥–åå³åœæ­¢æ‰¾åŒæ ·å€¼çš„åŠ¨ä½œã€‚\n","source":"_posts/Javaå…«è‚¡æ–‡-MySQL.md","raw":"---\ntitle: Javaå…«è‚¡æ–‡ - MySQL\ncopyright: true\nmathjax: false\ncategories:\n  - Javaå…«è‚¡æ–‡\ndate: 2023-01-25 13:43:41\ntags:\ntoc: true\nurlname: mysql\n---\n\n> æ•´ç†çš„ MySQL ç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½\t<!--more-->\n\n## MySQLåŸºç¡€ç¯‡\n\n### è¯´ä¸€è¯´ä¸‰ä¸ªèŒƒå¼\n\n**ç¬¬ä¸€èŒƒå¼(ç¡®ä¿æ¯åˆ—ä¿æŒåŸå­æ€§)**\n\nç¬¬ä¸€èŒƒå¼æ˜¯æœ€åŸºæœ¬çš„èŒƒå¼ã€‚å¦‚æœæ•°æ®åº“è¡¨ä¸­çš„æ‰€æœ‰å­—æ®µå€¼éƒ½æ˜¯ä¸å¯åˆ†è§£çš„åŸå­å€¼ï¼Œå°±è¯´æ˜è¯¥æ•°æ®åº“è¡¨æ»¡è¶³äº†ç¬¬ä¸€èŒƒå¼ã€‚\n\n**ç¬¬äºŒèŒƒå¼(ç¡®ä¿è¡¨ä¸­çš„æ¯åˆ—éƒ½å’Œä¸»é”®ç›¸å…³)**ï¼ˆå‰ææ˜¯ç¬¬ä¸€èŒƒå¼ï¼‰\n\nåœ¨ä¸€ä¸ªæ•°æ®åº“è¡¨ä¸­ï¼Œä¸€ä¸ªè¡¨ä¸­åªèƒ½ä¿å­˜**ä¸€ç§**æ•°æ®ï¼Œä¸å¯ä»¥æŠŠå¤šç§æ•°æ®ä¿å­˜åœ¨åŒä¸€å¼ æ•°æ®åº“è¡¨ä¸­ã€‚\n\n**ç¬¬ä¸‰èŒƒå¼(ç¡®ä¿è¡¨ä¸­æ¯åˆ—éƒ½å’Œä¸»é”®ç›´æ¥ç›¸å…³,è€Œä¸æ˜¯é—´æ¥ç›¸å…³)**ï¼ˆå‰ææ˜¯ç¬¬ä¸€ç¬¬äºŒèŒƒå¼ï¼‰\n\nå·²ç»åˆ†å¥½äº†å¤šå¼ è¡¨çš„è¯ï¼Œä¸€å¼ è¡¨ä¸­åªèƒ½æœ‰å¦ä¸€å¼ è¡¨çš„ IDï¼Œè€Œä¸èƒ½æœ‰å…¶ä»–ä»»ä½•ä¿¡æ¯ï¼ˆå…¶ä»–ä»»ä½•ä¿¡æ¯ï¼Œä¸€å¾‹ç”¨ä¸»é”®åœ¨å¦ä¸€å¼ è¡¨ä¸­æŸ¥è¯¢ï¼‰ã€‚\n\n### è¯´ä¸€ä¸‹ MySQL æ‰§è¡Œä¸€æ¡æŸ¥è¯¢è¯­å¥çš„å†…éƒ¨æ‰§è¡Œè¿‡ç¨‹ï¼Ÿ\n\n> è¿æ¥å™¨ â†’ æŸ¥è¯¢ç¼“å­˜ â†’ åˆ†æå™¨ â†’ ä¼˜åŒ–å™¨ â†’ æ‰§è¡Œå™¨\n\n*   å®¢æˆ·ç«¯å…ˆé€šè¿‡**è¿æ¥å™¨**è¿æ¥åˆ° MySQL æœåŠ¡å™¨ã€‚\n\n*   è¿æ¥å™¨æƒé™éªŒè¯é€šè¿‡ä¹‹åï¼Œå…ˆæŸ¥è¯¢æ˜¯å¦æœ‰**æŸ¥è¯¢ç¼“å­˜**ï¼Œå¦‚æœæœ‰ç¼“å­˜ï¼ˆä¹‹å‰æ‰§è¡Œè¿‡æ­¤è¯­å¥ï¼‰åˆ™ç›´æ¥è¿”å›ç¼“å­˜æ•°æ®ï¼Œå¦‚æœæ²¡æœ‰ç¼“å­˜åˆ™è¿›å…¥åˆ†æå™¨ã€‚\n\n*   **åˆ†æå™¨**ä¼šå¯¹æŸ¥è¯¢è¯­å¥è¿›è¡Œè¯­æ³•åˆ†æå’Œè¯æ³•åˆ†æï¼Œåˆ¤æ–­ SQL è¯­æ³•æ˜¯å¦æ­£ç¡®ï¼Œå¦‚æœæŸ¥è¯¢è¯­æ³•é”™è¯¯ä¼šç›´æ¥è¿”å›ç»™å®¢æˆ·ç«¯é”™è¯¯ä¿¡æ¯ï¼Œå¦‚æœè¯­æ³•æ­£ç¡®åˆ™è¿›å…¥ä¼˜åŒ–å™¨ã€‚\n\n*   **ä¼˜åŒ–å™¨**å¯¹æŸ¥è¯¢è¯­å¥è¿›è¡Œä¼˜åŒ–å¤„ç†ï¼Œä¾‹å¦‚ä¸€ä¸ªè¡¨é‡Œé¢æœ‰å¤šä¸ªç´¢å¼•ï¼Œä¼˜åŒ–å™¨ä¼šåˆ¤åˆ«å“ªä¸ªç´¢å¼•æ€§èƒ½æ›´å¥½ã€‚\n\n*   ä¼˜åŒ–å™¨æ‰§è¡Œå®Œå°±è¿›å…¥**æ‰§è¡Œå™¨**ï¼Œå¼€å§‹æ‰§è¡ŒæŸ¥è¯¢è¯­å¥ç›´åˆ°æŸ¥è¯¢å‡ºæ»¡è¶³æ¡ä»¶çš„æ‰€æœ‰æ•°æ®ï¼Œç„¶åè¿›è¡Œè¿”å›ã€‚\n\n### MySQL æŸ¥è¯¢ç¼“å­˜çš„åŠŸèƒ½æœ‰ä½•ä¼˜ç¼ºç‚¹ï¼Ÿ\n\nä¼˜ç‚¹æ˜¯æ•ˆç‡é«˜ï¼Œå¦‚æœå·²ç»æœ‰ç¼“å­˜åˆ™ä¼šç›´æ¥è¿”å›ç»“æœã€‚ \n\nä½†æ˜¯ï¼Œå¦‚æœæ•°æ®åº“è¡¨ä¸­æ•°æ®å’Œç»“æ„å‘ç”Ÿå˜åŒ–æ—¶ï¼ˆå¢åˆ æ”¹ã€è¡¨ç»“æ„è°ƒæ•´ï¼‰ï¼ŒæŸ¥è¯¢ç¼“å­˜å°†ä¼šå¤±æ•ˆå¹¶è¢«æ¸…é™¤ï¼Œå¯¼è‡´ç¼“å­˜å‘½ä¸­ç‡æ¯”è¾ƒä½ã€‚\n\n### MySQL çš„å¸¸ç”¨å¼•æ“éƒ½æœ‰å“ªäº›ï¼Ÿ\n\nMySQL çš„å¸¸ç”¨å¼•æ“æœ‰ InnoDBã€MyISAMã€Memoryï¼ˆæ‰€æœ‰æ•°æ®æ”¾åœ¨å†…å­˜ä¸­ï¼‰ ç­‰ï¼Œä» MySQL 5.5.5 ç‰ˆæœ¬å¼€å§‹ InnoDB å°±æˆä¸ºäº†é»˜è®¤çš„å­˜å‚¨å¼•æ“ã€‚\n\n### MySQL å¯ä»¥é’ˆå¯¹è¡¨çº§åˆ«è®¾ç½®æ•°æ®åº“å¼•æ“å—ï¼Ÿæ€ä¹ˆè®¾ç½®ï¼Ÿ\n\nå¯ä»¥é’ˆå¯¹ä¸åŒçš„è¡¨è®¾ç½®ä¸åŒçš„å¼•æ“ã€‚åœ¨ create table è¯­å¥ä¸­ä½¿ç”¨ engine=å¼•æ“åï¼ˆæ¯”å¦‚ Memoryï¼‰æ¥è®¾ç½®æ­¤è¡¨çš„å­˜å‚¨å¼•æ“ã€‚\n\n###  InnoDB v.s. MyISAM\n\n* æœ€å¤§çš„åŒºåˆ«æ˜¯ InnoDB æ”¯æŒ**äº‹åŠ¡**ï¼Œè€Œ MyISAM ä¸æ”¯æŒäº‹åŠ¡ï¼›\n\n* InnoDB æ”¯æŒ**å´©æºƒåå®‰å…¨æ¢å¤**ï¼ŒMyISAM ä¸æ”¯æŒå´©æºƒåå®‰å…¨æ¢å¤ï¼›\n* InnoDB æ”¯æŒ**è¡Œé”**ï¼ŒMyISAM ä¸æ”¯æŒè¡Œé”ï¼Œåªæ”¯æŒè¡¨é”ï¼›\n* InnoDB æ”¯æŒ**å¤–é”®**ï¼ŒMyISAM ä¸æ”¯æŒå¤–é”®ï¼›\n\n### InnoDB æœ‰å“ªäº›ç‰¹æ€§ï¼Ÿ\n\n**1ï¼‰æ’å…¥ç¼“å†²(insert buffer)**ï¼šæ’å…¥ç¼“å†²å¸¦æ¥çš„æ˜¯**æ€§èƒ½**ã€‚å¯¹äºéèšé›†ç´¢å¼•çš„æ’å…¥å’Œæ›´æ–°ï¼Œä¸æ˜¯æ¯ä¸€æ¬¡ç›´æ¥æ’å…¥ç´¢å¼•é¡µä¸­ï¼Œè€Œæ˜¯é¦–å…ˆåˆ¤æ–­æ’å…¥çš„éèšé›†ç´¢å¼•é¡µæ˜¯å¦åœ¨ç¼“å†²æ± ä¸­ï¼Œå¦‚æœåœ¨ï¼Œåˆ™ç›´æ¥æ’å…¥ï¼Œå¦åˆ™ï¼Œå…ˆæ”¾å…¥ä¸€ä¸ªæ’å…¥ç¼“å†²åŒºä¸­ã€‚å¥½ä¼¼æ¬ºéª—æ•°æ®åº“è¿™ä¸ªéèšé›†çš„ç´¢å¼•å·²ç»æ’å…¥åˆ°å¶å­èŠ‚ç‚¹äº†ï¼Œç„¶åå†ä»¥ä¸€å®šçš„é¢‘ç‡æ‰§è¡Œæ’å…¥ç¼“å†²å’Œéèšé›†ç´¢å¼•å¶å­èŠ‚ç‚¹çš„åˆå¹¶æ“ä½œï¼Œè¿™æ—¶é€šå¸¸èƒ½å°†å¤šä¸ªæ’å…¥åˆå¹¶åˆ°ä¸€ä¸ªæ“ä½œä¸­ï¼Œè¿™å°±å¤§å¤§æé«˜äº†å¯¹éèšé›†ç´¢å¼•æ‰§è¡Œæ’å…¥å’Œä¿®æ”¹æ“ä½œçš„æ€§èƒ½ã€‚ï¼ˆ**å¯¹äºéèšé›†ç´¢å¼•é¡µï¼Œä¸æ˜¯ç›´æ¥æ”¾åˆ°ç´¢å¼•é¡µä¸­ï¼Œè€Œæ˜¯å…ˆæ”¾åˆ°ç¼“å†²æ± ä¸­ï¼Œè¿™æ—¶å€™ç¼“å†²æ± ä¸­å¯èƒ½å­˜æ”¾äº†å¤šä¸ªéèšé›†ç´¢å¼•é¡µï¼Œç„¶åå°†è¿™å¤šä¸ªéèšé›†ç´¢å¼•é¡µçš„æ’å…¥åˆå¹¶åˆ°ä¸€ä¸ªæ“ä½œä¸­ï¼Œå–ä»£äº†ä¹‹å‰çš„ä¸€ä¸ªä¸€ä¸ªæ’å…¥**ï¼‰\n\n**2ï¼‰ä¸¤æ¬¡å†™(double write)**ï¼šä¸¤æ¬¡å†™å¸¦æ¥çš„æ˜¯**å¯é æ€§**ï¼Œä¸»è¦ç”¨æ¥è§£å†³éƒ¨åˆ†å†™å¤±è´¥ã€‚doublewrite ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œä¸€éƒ¨åˆ†æ˜¯å†…å­˜ä¸­çš„ doublewrite buffer ï¼Œå¤§å°ä¸º 2Mï¼Œå¦å¤–ä¸€éƒ¨åˆ†å°±æ˜¯ç‰©ç†ç£ç›˜ä¸Šçš„å…±äº«è¡¨ç©ºé—´ä¸­è¿ç»­çš„ 128 ä¸ªé¡µï¼Œå³ä¸¤ä¸ªåŒºï¼Œå¤§å°åŒæ ·ä¸º 2Mã€‚å½“ç¼“å†²æ± çš„ä½œä¸šåˆ·æ–°æ—¶ï¼Œå¹¶ä¸ç›´æ¥å†™ç¡¬ç›˜ï¼Œè€Œæ˜¯é€šè¿‡ memcpy å‡½æ•°å°†è„é¡µå…ˆæ‹·è´åˆ°å†…å­˜ä¸­çš„ doublewrite bufferï¼Œä¹‹åé€šè¿‡ doublewrite buffer å†åˆ†ä¸¤æ¬¡å†™ï¼Œæ¯æ¬¡å†™å…¥ 1M åˆ°å…±äº«è¡¨ç©ºé—´çš„ç‰©ç†ç£ç›˜ä¸Šï¼Œç„¶åé©¬ä¸Šè°ƒç”¨ fsync å‡½æ•°ï¼ŒåŒæ­¥ç£ç›˜ã€‚**ï¼ˆè¦è¿›è¡Œå†™æ“ä½œæ—¶ï¼Œä¸æ˜¯ç›´æ¥å†™ç¡¬ç›˜ï¼Œè€Œæ˜¯å†™æ‹·è´åˆ°å†…å­˜ä¸­çš„ä¸¤æ¬¡å†™ç¼“å†²åŒºå¤§å°2Mï¼Œç„¶åæŠŠä¸¤æ¬¡å†™ç¼“å†²åŒºçš„å†…å®¹åˆ†ä¸¤æ¬¡å†™ï¼ˆæ¯æ¬¡å†™1Mï¼‰åˆ°å…±äº«è¡¨ç©ºé—´çš„ç£ç›˜ä¸Šï¼Œç„¶åå†å°†å…±äº«è¡¨ç©ºé—´çš„å†…å®¹åŒæ­¥åˆ°æ•°æ®æ–‡ä»¶ä¸Šï¼‰**\n\n![ä¸¤æ¬¡å†™](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes11474088-ad3fb88b0ef6d41d.png) \n\n**3ï¼‰è‡ªé€‚åº”å“ˆå¸Œç´¢å¼•(adaptive hash index)**ï¼šç”±äº InnoDB ä¸æ”¯æŒ hash ç´¢å¼•ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ hash ç´¢å¼•çš„æ•ˆç‡å¾ˆé«˜ï¼Œäºæ˜¯å‡ºç°äº† adaptive hash index åŠŸèƒ½ï¼Œ InnoDB å­˜å‚¨å¼•æ“ä¼šç›‘æ§å¯¹è¡¨ä¸Šç´¢å¼•çš„æŸ¥æ‰¾ï¼Œå¦‚æœè§‚å¯Ÿåˆ°å»ºç«‹ hash ç´¢å¼•å¯ä»¥æé«˜æ€§èƒ½çš„æ—¶å€™ï¼Œåˆ™è‡ªåŠ¨å»ºç«‹ hash ç´¢å¼•ã€‚**ï¼ˆä¸ºäº†æé«˜æ€§èƒ½ä¼šè‡ªåŠ¨å»ºç«‹ä¸€äº› hash ç´¢å¼•ï¼ŒæŸ¥æ‰¾æ•ˆç‡å¾ˆé«˜ï¼Œç›´æ¥é€šè¿‡ hash å€¼å®šä½åˆ°æ•°æ®ï¼‰**\n\n### ä¸€å¼ è‡ªå¢è¡¨ä¸­æœ‰ä¸‰æ¡æ•°æ®ï¼Œåˆ é™¤äº†ä¸¤æ¡æ•°æ®ä¹‹åé‡å¯æ•°æ®åº“ï¼Œå†æ–°å¢ä¸€æ¡æ•°æ®ï¼Œæ­¤æ—¶è¿™æ¡æ•°æ®çš„ ID æ˜¯å‡ ï¼Ÿ\n\n> ç­‰ä»·äºï¼šè‡ªå¢ä¸»é”®èƒ½ä¸èƒ½è¢«æŒä¹…åŒ–çš„é—®é¢˜ï¼Ÿ\n>\n> MyISAMï¼šè‡ªå¢ä¸»é”®ä¼šæŒä¹…åŒ–åˆ°æ•°æ®æ–‡ä»¶ä¸­\n>\n> InnoDBï¼š\n> \t5.7 ä»¥åŠä¹‹å‰ï¼šä¸ä¼šæŒä¹…åŒ–\n> \tä» 8 å¼€å§‹ï¼šè‡ªå¢ä¸»é”®ä¼šæŒä¹…åŒ–åˆ° redo log\n\n1. å¦‚æœè¡¨çš„å¼•æ“ç±»å‹æ˜¯ **MyISAM**ï¼Œé‚£ä¹ˆè¿™æ¡è®°å½•çš„ ID å°±æ˜¯ 4ã€‚å› ä¸º **MyISAMè¡¨ä¼šæŠŠè‡ªå¢ä¸»é”®çš„æœ€å¤§IDè®°å½•åˆ°æ•°æ®æ–‡ä»¶é‡Œé¢**ï¼Œé‡å¯ MySQL åï¼Œè‡ªå¢ä¸»é”®çš„æœ€å¤§ ID ä¹Ÿä¸ä¼šä¸¢å¤±ã€‚\n\n2. å¦‚æœè¡¨çš„å¼•æ“ç±»å‹æ˜¯ **InnoDB**ï¼Œé‚£ä¹ˆè¿™æ¡è®°å½•çš„ ID å°±æ˜¯ 2ã€‚å› ä¸º **InnoDBè¡¨æŠŠè‡ªå¢ä¸»é”®çš„æœ€å¤§IDè®°å½•åˆ°å†…å­˜ä¸­**ï¼Œæ‰€ä»¥é‡å¯æ•°æ®åº“åä¼šä½¿æœ€å¤§ IDï¼ˆå…¶å®æ˜¯ AUTO_INCREMENT è®¡æ•°å™¨çš„å€¼ï¼‰ä¸¢å¤±ï¼›ä¸€æ—¦æ•°æ®åº“é‡æ–°è¿è¡Œï¼Œæ•°æ®åº“ä¼šè‡ªåŠ¨è®¡ç®—è‡ªå¢ä¸»é”®çš„æœ€å¤§ IDï¼ˆ**å…¶å®å°±æ˜¯æŠŠæœ€åä¸€æ¡è®°å½• ID åŠ  1 å¹¶èµ‹å€¼ç»™ AUTO_INCREMENT**ï¼‰å†æ¬¡æ”¾å…¥åˆ°å†…å­˜ä¸­ã€‚\n\n\tã€æ³¨ã€‘**è¿™ä»…ä»…æ˜¯ MySQL 8 ä»¥å‰çš„ç‰ˆæœ¬ï¼Œä¹Ÿå°±æ˜¯ MySQL 5.7 ä»¥åŠä¹‹å‰çš„ç‰ˆæœ¬**ã€‚å› ä¸ºåœ¨ MySQL 8.0 ä¸­ï¼Œ**InnoDB çš„è¡Œä¸ºå·²æ›´æ”¹**ã€‚æ¯æ¬¡æ›´æ”¹æ—¶ï¼Œå½“å‰æœ€å¤§è‡ªåŠ¨å¢é‡è®¡æ•°å™¨å€¼ï¼ˆAUTO_INCREMENTï¼‰éƒ½ä¼šå†™å…¥é‡åšæ—¥å¿— redo logï¼Œå¹¶ä¿å­˜åˆ°æ¯ä¸ªæ£€æŸ¥ç‚¹çš„å¼•æ“ä¸“ç”¨ç³»ç»Ÿè¡¨ä¸­ã€‚è¿™äº›æ›´æ”¹ä½¿å½“å‰çš„æœ€å¤§è‡ªåŠ¨å¢é‡è®¡æ•°å™¨å€¼åœ¨æœåŠ¡å™¨é‡æ–°å¯åŠ¨åä¿æŒä¸å˜ï¼Œä¸ **MyISAM** ä¸€æ ·äº†ã€‚è¯¦è§å®˜æ–¹æ–‡æ¡£ï¼š[InnoDB AUTO_INCREMENT è®¡æ•°å™¨åˆå§‹åŒ–](https://dev.mysql.com/doc/refman/8.0/en/innodb-auto-increment-handling.html#innodb-auto-increment-initialization)\n\n\tã€æ³¨ã€‘å¦‚æœåˆ é™¤çš„ä¸æ˜¯æœ€åçš„è®°å½•ï¼Œé‚£ä¹ˆè‡ªå¢çš„æœ€å¤§ ID å…¨éƒ¨éƒ½ä¸€æ ·ï¼Œå› ä¸ºè‡ªåŠ¨å¢é‡è®¡æ•°å™¨å€¼ï¼ˆAUTO_INCREMENTï¼‰ä¸ä¼šæ”¹å˜ã€‚\n\n### MySQL ä¸­ä»€ä¹ˆæƒ…å†µä¼šå¯¼è‡´è‡ªå¢ä¸»é”®ä¸èƒ½è¿ç»­ï¼Ÿ\n\n> 1. å”¯ä¸€é”®å†²çª\n> 2. äº‹åŠ¡å›æ»š\n\n*   æ‰§è¡Œå™¨æ‰§è¡Œæ’å…¥ï¼Œè‡ªå¢é”®+1ï¼Œä½†æ˜¯ innoDB å‘ç°æ’å…¥æ—¶**å”¯ä¸€é”®å†²çª**ï¼Œæ— æ³•æ’å…¥ï¼Œå¯¼è‡´çš„ä¸è¿ç»­ã€‚\n\n*   äº‹åŠ¡æ·»åŠ è‡ªå¢é”®+1ï¼Œä½†æ˜¯ç”±äº**äº‹åŠ¡å›æ»š**ï¼Œæ•°æ®è¢«æ¸…é™¤ï¼Œå¯¼è‡´çš„ä¸è¿ç»­ã€‚\n\n### ä»€ä¹ˆæ˜¯è¦†ç›–ç´¢å¼•ï¼Ÿ\n\nè¦†ç›–ç´¢å¼•æ˜¯æŒ‡ï¼Œç´¢å¼•ä¸Šçš„ä¿¡æ¯è¶³å¤Ÿæ»¡è¶³æŸ¥è¯¢è¯·æ±‚ï¼Œä¸éœ€è¦å†å›åˆ°ä¸»é”®ä¸Šå»å–æ•°æ®å³å›è¡¨ã€‚\n\n### å¦‚æœæŠŠä¸€ä¸ª InnoDB è¡¨çš„ä¸»é”®åˆ æ‰ï¼Œæ˜¯ä¸æ˜¯å°±æ²¡æœ‰ä¸»é”®ï¼Œå°±æ²¡åŠæ³•è¿›è¡Œå›è¡¨æŸ¥è¯¢äº†ï¼Ÿ\n\nå¦‚æœæŠŠä¸»é”®åˆ æ‰äº†ï¼Œé‚£ä¹ˆ InnoDB ä¼šè‡ªå·±ç”Ÿæˆä¸€ä¸ªé•¿åº¦ä¸º 6 å­—èŠ‚çš„ rowid ä½œä¸ºä¸»é”®ã€‚\n\n### å†…å­˜è¡¨å’Œä¸´æ—¶è¡¨æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\nå†…å­˜è¡¨ï¼ŒæŒ‡çš„æ˜¯ä½¿ç”¨ Memory å¼•æ“çš„è¡¨ï¼Œæ•°æ®æ”¾åœ¨å†…å­˜ä¸­ï¼Œé‡å¯ä¼šè¢«æ¸…ç©ºï¼›\n\nä¸´æ—¶è¡¨ï¼ŒæŒ‡çš„æ˜¯ä½¿ç”¨ InnoDB å¼•æ“æˆ–è€… MyISAM å¼•æ“çš„è¡¨ï¼Œæ•°æ®æ”¾åœ¨ç£ç›˜ä¸Šï¼Œé‡å¯ä¸ä¼šæ¸…ç©ºã€‚\n\n### MySQL ä¸­çš„å­—ç¬¦ä¸²ç±»å‹éƒ½æœ‰å“ªäº›ï¼Ÿ\n\n| **ç±»å‹**     | **å–å€¼èŒƒå›´**              |\n| ------------ | ------------------------- |\n| CHAR(N)      | 0~255                     |\n| VARCHAR(N)   | 0~65536                   |\n| TINYBLOB     | 0~255                     |\n| BLOB         | 0~65535                   |\n| MEDUIMBLOB   | 0~167772150               |\n| LONGBLOB     | 0~4294967295              |\n| TINYTEXT     | 0~255                     |\n| TEXT         | 0~65535                   |\n| MEDIUMTEXT   | 0~167772150               |\n| LONGTEXT     | 0~4294967295              |\n| VARBINARY(N) | 0~Nä¸ªå­—èŠ‚çš„å˜é•¿å­—èŠ‚å­—ç¬¦é›† |\n| BINARY(N)    | 0~Nä¸ªå­—èŠ‚çš„å®šé•¿å­—èŠ‚å­—ç¬¦é›† |\n\n### VARCHAR å’Œ CHAR çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿåˆ†åˆ«é€‚ç”¨çš„åœºæ™¯æœ‰å“ªäº›ï¼Ÿ\n\nVARCHAR çš„é•¿åº¦æ˜¯å¯å˜çš„ï¼Œè€Œ CHAR æ˜¯å›ºå®šé•¿åº¦ã€‚ç”±äºå®ƒä»¬çš„ç‰¹æ€§å†³å®šäº† CHAR æ¯”è¾ƒé€‚åˆé•¿åº¦è¾ƒçŸ­çš„å­—æ®µå’Œå›ºå®šé•¿åº¦çš„å­—æ®µï¼Œå¦‚èº«ä»½è¯å·ã€æ‰‹æœºå·ç­‰ï¼Œåä¹‹åˆ™é€‚åˆä½¿ç”¨ VARCHARã€‚\n\n### MySQL å­˜å‚¨é‡‘é¢åº”è¯¥ä½¿ç”¨å“ªç§æ•°æ®ç±»å‹ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ\n\nMySQL å­˜å‚¨é‡‘é¢åº”è¯¥ä½¿ç”¨ `decimal` ï¼Œå› ä¸ºå¦‚æœå­˜å‚¨å…¶ä»–æ•°æ®ç±»å‹ï¼Œæ¯”å¦‚ `float` æœ‰å¯¼è‡´å°æ•°ç‚¹åæ•°æ®ä¸¢å¤±çš„é£é™©ã€‚\n\n### limit 3,2 çš„å«ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿ\n\nå»é™¤å‰ä¸‰æ¡æ•°æ®ä¹‹åæŸ¥è¯¢ä¸¤æ¡ä¿¡æ¯ã€‚\n\n### *lastinsertid()* å‡½æ•°åŠŸèƒ½æ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ\n\n*lastinsertid()* ç”¨äºæŸ¥è¯¢æœ€åä¸€æ¬¡è‡ªå¢è¡¨çš„ç¼–å·ï¼ˆå…¨å±€çš„ï¼‰ï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯æŸ¥è¯¢æ—¶ä¸éœ€è¦æŒ‡å®šè¡¨åï¼Œä½¿ç”¨ `select last_insert_id()` å³å¯æŸ¥è¯¢ï¼Œå› ä¸ºä¸éœ€è¦æŒ‡å®šè¡¨åæ‰€ä»¥å®ƒå§‹ç»ˆä»¥æœ€åä¸€æ¡è‡ªå¢ç¼–å·ä¸ºä¸»ï¼Œå¯ä»¥è¢«å…¶å®ƒè¡¨çš„è‡ªå¢ç¼–å·è¦†ç›–ã€‚æ¯”å¦‚ A è¡¨çš„æœ€å¤§ç¼–å·æ˜¯ 10ï¼Œ *lastinsertid()* æŸ¥è¯¢å‡ºæ¥çš„å€¼ä¸º 10ï¼Œè¿™æ—¶ B è¡¨æ’å…¥äº†ä¸€æ¡æ•°æ®ï¼Œå®ƒçš„æœ€å¤§ç¼–å·ä¸º 3ï¼Œè¿™ä¸ªæ—¶å€™ä½¿ç”¨ *lastinsertid()* æŸ¥è¯¢çš„å€¼å°±æ˜¯ 3ã€‚\n\n### åˆ é™¤è¡¨çš„æ•°æ®æœ‰å‡ ç§æ–¹å¼ï¼Ÿå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\nåˆ é™¤æ•°æ®æœ‰ä¸¤ç§æ–¹å¼ï¼šdelete å’Œ truncateï¼Œå®ƒä»¬çš„åŒºåˆ«å¦‚ä¸‹ï¼š\n\n*   delete å¯ä»¥æ·»åŠ  where æ¡ä»¶åˆ é™¤éƒ¨åˆ†æ•°æ®ï¼Œtruncate ä¸èƒ½æ·»åŠ  where æ¡ä»¶åªèƒ½åˆ é™¤æ•´å¼ è¡¨ï¼›\n\n*   delete çš„åˆ é™¤ä¿¡æ¯ä¼šåœ¨ MySQL çš„æ—¥å¿—ä¸­è®°å½•ï¼Œè€Œ truncate çš„åˆ é™¤ä¿¡æ¯ä¸è¢«è®°å½•åœ¨ MySQL çš„æ—¥å¿—ä¸­ï¼Œ\n\tå› æ­¤ detele çš„ä¿¡æ¯å¯ä»¥è¢«æ‰¾å›è€Œ truncate çš„ä¿¡æ¯æ— æ³•è¢«æ‰¾å›ï¼›\n\n*   truncate å› ä¸ºä¸è®°å½•æ—¥å¿—æ‰€ä»¥æ‰§è¡Œæ•ˆç‡æ¯” delete å¿«ã€‚\n\n### MySQL ä¸­æ”¯æŒå‡ ç§æ¨¡ç³ŠæŸ¥è¯¢ï¼Ÿå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\nMySQL ä¸­æ”¯æŒä¸¤ç§æ¨¡ç³ŠæŸ¥è¯¢ï¼šregexp å’Œ like\nlike æ˜¯å¯¹ä»»æ„å¤šå­—ç¬¦åŒ¹é…æˆ–ä»»æ„å•å­—ç¬¦è¿›è¡Œæ¨¡ç³ŠåŒ¹é…ï¼Œ\nè€Œ regexp åˆ™æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…æ–¹å¼ï¼Œæä¾›æ¯” like æ›´å¤šçš„åŒ¹é…æ–¹å¼ã€‚ \nregexp å’Œ like çš„ä½¿ç”¨ç¤ºä¾‹å¦‚ä¸‹ï¼š \n\n> select * from person where uname like '%SQL%';\n> select * from person where uname regexp '.SQL*.'; \n\n### *count(column)* å’Œ *count(\\*)* æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\n*count(column)* ç»Ÿè®¡ä¸ä¼šç»Ÿè®¡åˆ—å€¼ä¸º null çš„æ•°æ®ï¼Œ\nè€Œ *count(\\*)* åˆ™ä¼šç»Ÿè®¡æ‰€æœ‰ä¿¡æ¯ï¼Œæ‰€ä»¥æœ€ç»ˆçš„ç»Ÿè®¡ç»“æœå¯èƒ½ä¼šä¸åŒã€‚\n\n### ä¸ºä»€ä¹ˆ InnoDB ä¸æŠŠæ€»æ¡æ•°è®°å½•ä¸‹æ¥ï¼ŒæŸ¥è¯¢çš„æ—¶å€™ç›´æ¥è¿”å›å‘¢ï¼Ÿ\n\nå› ä¸º **InnoDB æ”¯æŒäº‹åŠ¡**ï¼Œå³ä½¿æ˜¯åœ¨åŒä¸€æ—¶é—´è¿›è¡ŒæŸ¥è¯¢ï¼Œå¾—åˆ°çš„ç»“æœä¹Ÿå¯èƒ½ä¸ç›¸åŒï¼Œæ‰€ä»¥ InnoDB ä¸èƒ½æŠŠç»“æœç›´æ¥ä¿å­˜ä¸‹æ¥ï¼Œå› ä¸ºè¿™æ ·æ˜¯ä¸å‡†ç¡®çš„ã€‚\n\n### InnoDB å’Œ MyISAM æ‰§è¡Œ select count(*) from tï¼Œå“ªä¸ªæ•ˆç‡æ›´é«˜ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ\n\nMyISAM æ•ˆç‡æœ€é«˜ï¼Œå› ä¸º MyISAM å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªè®¡æ•°å™¨ï¼Œç›´æ¥è¿”å›æ€»æ¡æ•°ï¼Œè€Œ InnoDB è¦é€è¡Œç»Ÿè®¡ã€‚\n\n### åœ¨ InnoDB å¼•æ“ä¸­ count(*)ã€count(1)ã€count(ä¸»é”®)ã€count(å­—æ®µ) å“ªä¸ªæ€§èƒ½æœ€é«˜ï¼Ÿ\n\ncount(å­—æ®µ)<count(ä¸»é”® id)<count(1)â‰ˆcount(*) é¢˜ç›®è§£æï¼š\n\n*   å¯¹äº count(å­—æ®µ) æ¥è¯´ï¼Œéå†æ•´å¼ è¡¨ï¼Œå–è¿™ä¸ªå­—æ®µï¼Œç„¶ååˆ¤æ–­æ˜¯å¦ä¸º nullï¼Œä¸ä¸º null åˆ™åŠ  1\n*   å¯¹äº count(ä¸»é”® id) æ¥è¯´ï¼Œéå†æ•´å¼ è¡¨ï¼Œå–ä¸»é”® idï¼Œä¸å¯èƒ½ä¸ºç©ºï¼Œæ¯æ¬¡åŠ  1ã€‚ä½†æ˜¯å¯èƒ½ä½¿ç”¨æœ€å°çš„ç´¢å¼•æ ‘ã€‚\n*   å¯¹äº count(1) æ¥è¯´ï¼Œéå†æ•´å¼ è¡¨ï¼Œä¸å–å€¼ã€‚1 æ˜¯ä¸å¯èƒ½ä¸ºç©ºçš„ï¼Œæ¯æ¬¡åŠ  1ã€‚\n*   å¯¹äº count(\\*) æ¥è¯´ï¼Œéå†æ•´å¼ è¡¨ï¼Œä¸å–å€¼ï¼Œç›´æ¥æŒ‰è¡Œç´¯åŠ ã€‚å®é™…ä¸Šï¼Œå½“ä½¿ç”¨ count(\\*) æ—¶ï¼ŒMySQL ä¼šå°† * å‚æ•°è½¬åŒ–ä¸ºå‚æ•° 0 æ¥å¤„ç†ã€‚\n\næ‰€ä»¥æœ€åå¾—å‡ºçš„ç»“æœæ˜¯ï¼šcount(å­—æ®µ)<count(ä¸»é”® id)<count(1)â‰ˆcount(*)ã€‚\n\n### MySQL ä¸­å†…è¿æ¥ã€å·¦è¿æ¥ã€å³è¿æ¥æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\n*   å†…è¿ï¼ˆinner joinï¼‰â€” æŠŠåŒ¹é…çš„å…³è”æ•°æ®æ˜¾ç¤ºå‡ºæ¥ï¼›\n\n*   å·¦è¿æ¥ï¼ˆleft joinï¼‰â€” æŠŠå·¦è¾¹çš„è¡¨å…¨éƒ¨æ˜¾ç¤ºå‡ºæ¥ï¼Œå³è¾¹çš„è¡¨æ˜¾ç¤ºå‡ºç¬¦åˆæ¡ä»¶çš„æ•°æ®ï¼›\n\n*   å³è¿æ¥ï¼ˆright joinï¼‰â€” æŠŠå³è¾¹çš„è¡¨å…¨éƒ¨æ˜¾ç¤ºå‡ºæ¥ï¼Œå·¦è¾¹çš„è¡¨æ˜¾ç¤ºå‡ºç¬¦åˆæ¡ä»¶çš„æ•°æ®ï¼›\n\n## MySQLç´¢å¼•ç¯‡\n\n### ä»€ä¹ˆæ˜¯ç´¢å¼•ï¼Ÿ  \n\nç´¢å¼•æ˜¯ä¸€ç§èƒ½å¸®åŠ© MySQL æé«˜æŸ¥è¯¢æ•ˆç‡çš„æ•°æ®ç»“æ„ã€‚\n\n### ç´¢å¼•åˆ†åˆ«æœ‰å“ªäº›ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Ÿ  \n\n**ç´¢å¼•çš„ä¼˜ç‚¹ï¼š**\n\n*   æé«˜æŸ¥è¯¢æ•ˆç‡\n\n\n**ç´¢å¼•çš„ç¼ºç‚¹ï¼š**\n\n*   è™½ç„¶æé«˜äº†æŸ¥è¯¢é€Ÿåº¦ï¼Œä½†å´é™ä½äº†æ›´æ–°è¡¨çš„é€Ÿåº¦ï¼Œæ¯”å¦‚ updateã€insertï¼›\n\tå› ä¸ºæ›´æ–°æ•°æ®æ—¶ï¼ŒMySQL ä¸ä»…è¦æ›´æ–°æ•°æ®ï¼Œè¿˜è¦æ›´æ–°ç´¢å¼•æ–‡ä»¶ï¼›\n\n*   å»ºç«‹ç´¢å¼•çš„ç´¢å¼•æ–‡ä»¶ä¼šå ç”¨ç£ç›˜ã€‚\n\n### MySQLç´¢å¼•çš„æ³¨æ„äº‹é¡¹\n\n**1ã€è”åˆç´¢å¼•éµå¾ªå‰ç¼€åŸåˆ™**\n\n**2ã€likeæ¨¡ç³ŠæŸ¥è¯¢ï¼Œ%ä¸èƒ½åœ¨å‰**\n\n**3ã€**åˆ—å€¼ä¸ºç©ºï¼ˆNULLï¼‰æ—¶æ˜¯å¯ä»¥ä½¿ç”¨ç´¢å¼•çš„ï¼Œä½† MySQL éš¾ä»¥ä¼˜åŒ–å¼•ç”¨äº†å¯ç©ºåˆ—çš„æŸ¥è¯¢,å®ƒä¼šä½¿ç´¢å¼•ã€ç´¢å¼•ç»Ÿè®¡å’Œå€¼æ›´åŠ å¤æ‚ã€‚å¯ç©ºåˆ—éœ€è¦æ›´å¤šçš„å‚¨å­˜ç©ºé—´ï¼Œè¿˜éœ€è¦åœ¨ MySQL å†…éƒ¨è¿›è¡Œç‰¹æ®Šå¤„ç†ã€‚\n\n**4ã€** å¦‚æœ MySQL ä¼°è®¡ä½¿ç”¨ç´¢å¼•æ¯”å…¨è¡¨æ‰«ææ›´æ…¢ï¼Œä¼šæ”¾å¼ƒä½¿ç”¨ç´¢å¼•ï¼Œä¾‹å¦‚ï¼š\nè¡¨ä¸­åªæœ‰ 100 æ¡æ•°æ®å·¦å³ã€‚å¯¹äº SQL è¯­å¥ WHERE id > 1 AND id < 100ï¼ŒMySQL ä¼šä¼˜å…ˆè€ƒè™‘å…¨è¡¨æ‰«æã€‚\n\n**5ã€** **å¦‚æœå…³é”®è¯orå‰é¢çš„æ¡ä»¶ä¸­çš„åˆ—æœ‰ç´¢å¼•ï¼Œåé¢çš„æ²¡æœ‰ï¼Œæ‰€æœ‰åˆ—çš„ç´¢å¼•éƒ½ä¸ä¼šè¢«ç”¨åˆ°ã€‚**\n\n**6ã€** åˆ—ç±»å‹æ˜¯å­—ç¬¦ä¸²ï¼ŒæŸ¥è¯¢æ—¶ä¸€å®šè¦ç»™å€¼åŠ å¼•å·ï¼Œå¦åˆ™ç´¢å¼•å¤±æ•ˆï¼Œä¾‹å¦‚ï¼š\nåˆ— name varchar(16)ï¼Œå­˜å‚¨äº†å­—ç¬¦ä¸²\"100\"\nWHERE name = 100;  ï¼ˆåšäº†è‡ªåŠ¨ç±»å‹è½¬æ¢ï¼‰\nä»¥ä¸Š SQL è¯­å¥èƒ½æœåˆ°ï¼Œä½†æ— æ³•ç”¨åˆ°ç´¢å¼•ã€‚\n\n**7ã€ä¸åœ¨ç´¢å¼•åˆ—ä¸Šåšä»»ä½•æ“ä½œï¼ˆè®¡ç®—ã€å‡½æ•°ã€ï¼ˆè‡ªåŠ¨æˆ–æ‰‹åŠ¨ï¼‰ç±»å‹è½¬æ¢ï¼‰ï¼Œä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆè€Œè½¬å‘å…¨è¡¨æ‰«æ** \n\n### ä¸ºä»€ä¹ˆ MySQL å®˜æ–¹å»ºè®®ä½¿ç”¨è‡ªå¢ä¸»é”®ä½œä¸ºè¡¨çš„ä¸»é”®ï¼Ÿ \n\nä¼˜ç‚¹ï¼š\n\n1. é¡µåˆ†è£‚é—®é¢˜ã€‚å¦‚æœä½¿ç”¨éè‡ªå¢ä¸»é”®ä½œä¸ºè¡¨çš„ä¸»é”®çš„è¯ï¼Œå½“æ–°æ’å…¥çš„æ•°æ®ä¼šå°†æ•°æ®é¡µå†™æ»¡ï¼Œmysql å°±éœ€è¦ç”³è¯·æ–°çš„æ•°æ®é¡µï¼Œå¹¶ä¸”æŠŠä¸Šä¸ªæ•°æ®é¡µä¸­çš„éƒ¨åˆ†æ•°æ®æŒªåˆ°æ–°çš„æ•°æ®é¡µä¸Šï¼Œä»¥ç¡®ä¿ç´¢å¼•æœ‰åºã€‚ä¹Ÿå°±æ˜¯è¯´é€ æˆäº†é¡µåˆ†è£‚ï¼Œå¤§é‡ç§»åŠ¨æ•°æ®çš„è¿‡ç¨‹ä¸¥é‡å½±å“æ’å…¥æ•ˆç‡ã€‚\n\n2. å­˜å‚¨ç©ºé—´é—®é¢˜ã€‚è‡ªå¢ä¸»é”®å­˜å‚¨ç©ºé—´å°ï¼ŒåŒä¸€ä¸ªç»“ç‚¹å†…èƒ½å­˜æ”¾æ›´å¤šçš„ä¸»é”®ï¼Œæ ‘çš„é«˜åº¦å¯èƒ½é™ä½ï¼Œå‡å°‘ io æ¬¡æ•°ã€‚\n\nç¼ºç‚¹ï¼š\n\n1. æ•°æ®é‡è¿‡å¤§ï¼Œå¯èƒ½ä¼šè¶…å‡ºè‡ªå¢é•¿å–å€¼èŒƒå›´ï¼›\n2. æ— æ³•æ»¡è¶³åˆ†å¸ƒå¼å­˜å‚¨ï¼Œåˆ†åº“åˆ†è¡¨çš„æƒ…å†µä¸‹æ— æ³•åˆå¹¶è¡¨ï¼›\n3. ä¸»é”®æœ‰è‡ªå¢è§„å¾‹ï¼Œå®¹æ˜“è¢«ç ´è§£ï¼›\n\n**ç»¼ä¸Šæ‰€è¿°ï¼š**æ˜¯å¦éœ€è¦ä½¿ç”¨è‡ªå¢ä¸»é”®ï¼Œéœ€è¦æ ¹æ®è‡ªå·±çš„ä¸šåŠ¡åœºæ™¯æ¥è®¾è®¡ã€‚å¦‚æœæ˜¯å•è¡¨å•åº“ï¼Œåˆ™ä¼˜å…ˆè€ƒè™‘è‡ªå¢ä¸»é”®ï¼Œå¦‚æœæ˜¯åˆ†å¸ƒå¼å­˜å‚¨ï¼Œåˆ†åº“åˆ†è¡¨ï¼Œåˆ™éœ€è¦è€ƒè™‘æ•°æ®åˆå¹¶çš„ä¸šåŠ¡åœºæ™¯æ¥åšæ•°æ®åº“è®¾è®¡æ–¹æ¡ˆã€‚\n\n### ç´¢å¼•æœ‰å‡ ç§ç±»å‹ï¼Ÿåˆ†åˆ«å¦‚ä½•åˆ›å»ºï¼Ÿ  \n\n**MySQL çš„ç´¢å¼•æœ‰ä¸¤ç§åˆ†ç±»æ–¹å¼ï¼šé€»è¾‘åˆ†ç±»å’Œç‰©ç†åˆ†ç±»ã€‚ **\n\n**æŒ‰ç…§é€»è¾‘åˆ†ç±»ï¼Œç´¢å¼•å¯åˆ†ä¸ºï¼š**\n\n*   ä¸»é”®ç´¢å¼•ï¼šä¸€å¼ è¡¨åªèƒ½æœ‰ä¸€ä¸ªä¸»é”®ç´¢å¼•ï¼Œä¸å…è®¸é‡å¤ã€ä¸å…è®¸ä¸º NULLï¼›\n*   å”¯ä¸€ç´¢å¼•ï¼šæ•°æ®åˆ—ä¸å…è®¸é‡å¤ï¼Œå…è®¸ä¸º NULL å€¼ï¼Œä¸€å¼ è¡¨å¯æœ‰å¤šä¸ªå”¯ä¸€ç´¢å¼•ï¼Œä½†æ˜¯ä¸€ä¸ªå”¯ä¸€ç´¢å¼•åªèƒ½åŒ…å«ä¸€åˆ—ï¼Œæ¯”å¦‚èº«ä»½è¯å·ç ã€å¡å·ç­‰éƒ½å¯ä»¥ä½œä¸ºå”¯ä¸€ç´¢å¼•ï¼›\n*   æ™®é€šç´¢å¼•ï¼šä¸€å¼ è¡¨å¯ä»¥åˆ›å»ºå¤šä¸ªæ™®é€šç´¢å¼•ï¼Œä¸€ä¸ªæ™®é€šç´¢å¼•å¯ä»¥åŒ…å«å¤šä¸ªå­—æ®µï¼Œå…è®¸æ•°æ®é‡å¤ï¼Œå…è®¸ NULL å€¼æ’å…¥ï¼›\n\n**æŒ‰ç…§ç‰©ç†åˆ†ç±»ï¼Œç´¢å¼•å¯åˆ†ä¸ºï¼š**\n\n*   èšç°‡ç´¢å¼•ï¼šInnoDB çš„ä¸»é”®ç´¢å¼•å­˜å‚¨é‡‡ç”¨èšç°‡ç´¢å¼•ï¼Œä¸»é”®å€¼å’Œæ•°æ®å­˜æ”¾åœ¨ä¸€èµ·\n*   éèšç°‡ç´¢å¼•ï¼šMyISAM çš„ä¸»é”®ç´¢å¼•å­˜å‚¨é‡‡ç”¨éèšç°‡ç´¢å¼•ï¼Œä¸»é”®å€¼å’ŒæŒ‡å‘æ•°æ®çš„æŒ‡é’ˆå­˜æ”¾åœ¨ä¸€èµ·ï¼Œæ•°æ®å¦å¼€ç©ºé—´å­˜å‚¨\n\n**å„ç§ç´¢å¼•çš„åˆ›å»ºè„šæœ¬å¦‚ä¸‹ï¼š**\n\n```sql\n-- åˆ›å»ºä¸»é”®ç´¢å¼•\nALTER TABLE user ADD PRIMARY KEY (column_list);\n-- åˆ›å»ºå”¯ä¸€ç´¢å¼•\nALTER TABLE user ADD UNIQUE index_name (column_list);\n-- åˆ›å»ºæ™®é€šç´¢å¼•\nALTER TABLE user ADD INDEX index_name (column_list);\n-- åˆ›å»ºå…¨æ–‡ç´¢å¼•\nALTER TABLE user ADD FULLTEXT index_name (column_list);\n```\n\n### ä»€ä¹ˆå«å›è¡¨æŸ¥è¯¢ï¼Ÿ  \n\næ™®é€šç´¢å¼•æŸ¥è¯¢åˆ°ä¸»é”®ç´¢å¼•åï¼Œå›åˆ°ä¸»é”®ç´¢å¼•æ ‘æœç´¢çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬ç§°ä¸ºå›è¡¨æŸ¥è¯¢ã€‚\n\nä¹Ÿå°±æ˜¯è¯´ï¼ŒåŸºäºéä¸»é”®ç´¢å¼•çš„æŸ¥è¯¢éœ€è¦å¤šæ‰«æä¸€æ¬¡ä¸»é”®ç´¢å¼•æ ‘ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨åº”ç”¨ä¸­åº”è¯¥å°½é‡ä½¿ç”¨ä¸»é”®æŸ¥è¯¢ã€‚\n\nä¾‹å¤–å°±æ˜¯ä½¿ç”¨éä¸»é”®ç´¢å¼•æ—¶ï¼Œå¦‚æœå½“å‰ç´¢å¼•æ»¡è¶³æŸ¥è¯¢éœ€æ±‚ï¼Œåˆ™ä¸ç”¨å›è¡¨ã€‚\n\n### åœ¨ InnDB ä¸­ä¸»é”®ç´¢å¼•ä¸ºä»€ä¹ˆæ¯”æ™®é€šç´¢å¼•çš„æŸ¥è¯¢æ€§èƒ½é«˜ï¼Ÿ  \n\nå›è¡¨ã€‚å› ä¸ºæ™®é€šç´¢å¼•çš„æŸ¥è¯¢ä¼šå¤šæ‰§è¡Œä¸€æ¬¡æ£€ç´¢æ“ä½œã€‚æ¯”å¦‚ä¸»é”®æŸ¥è¯¢ select * from t where id=10 åªéœ€è¦æœç´¢ id çš„è¿™æ£µ B+ æ ‘ï¼Œè€Œæ™®é€šç´¢å¼•æŸ¥è¯¢ select * from t where f=3 ä¼šå…ˆæŸ¥è¯¢ f ç´¢å¼•æ ‘ï¼Œå¾—åˆ° id çš„å€¼ä¹‹åå†å»æœç´¢ id çš„ B+ æ ‘ï¼Œå› ä¸ºå¤šæ‰§è¡Œäº†ä¸€æ¬¡æ£€ç´¢ï¼Œæ‰€ä»¥æ‰§è¡Œæ•ˆç‡å°±æ¯”ä¸»é”®ç´¢å¼•è¦ä½ã€‚\n\n### MySQL å¤åˆç´¢å¼•åº”è¯¥æ³¨æ„ä»€ä¹ˆï¼Ÿ  \n\nMySQL ä¸­çš„å¤åˆç´¢å¼•ï¼Œéµå¾ªæœ€å·¦åŒ¹é…åŸåˆ™ï¼Œæ¯”å¦‚ï¼Œè”åˆç´¢å¼•ä¸º key(a,b,c)ï¼Œåˆ™èƒ½è§¦å‘ç´¢å¼•çš„æœç´¢ç»„åˆæ˜¯ a|ab|abc è¿™ä¸‰ç§æŸ¥è¯¢ã€‚\n\n### å¤åˆç´¢å¼•çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ  \n\n*   ç”¨äºå¤šå­—æ®µæŸ¥è¯¢ï¼Œæ¯”å¦‚ï¼Œå»ºäº†ä¸€ä¸ª key(a,b,c) çš„è”åˆç´¢å¼•ï¼Œé‚£ä¹ˆå®é™…ç­‰äºå»ºäº†`key(a)ã€key(a,b)ã€key(a,b,c)`ç­‰ä¸‰ä¸ªç´¢å¼•ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œæ¯å¤šä¸€ä¸ªç´¢å¼•ï¼Œå°±ä¼šå¤šä¸€äº›å†™æ“ä½œå’Œå ç”¨ç£ç›˜ç©ºé—´çš„å¼€é”€ï¼Œå°¤å…¶æ˜¯å¯¹å¤§æ•°æ®é‡çš„è¡¨æ¥è¯´ï¼Œè¿™å¯ä»¥å‡å°‘ä¸€éƒ¨åˆ†ä¸å¿…è¦çš„å¼€é”€ï¼›\n*   è¦†ç›–ç´¢å¼•ï¼Œæ¯”å¦‚ï¼Œå¯¹äºè”åˆç´¢å¼• key(a,b,c) æ¥è¯´ï¼Œå¦‚æœä½¿ç”¨ SQLï¼š`select a,b,c from table where a=1 and b = 1` ï¼Œå°±å¯ä»¥ç›´æ¥é€šè¿‡éå†ç´¢å¼•å–å¾—æ•°æ®ï¼Œè€Œ**æ— éœ€å›è¡¨æŸ¥è¯¢**ï¼Œè¿™å°±å‡å°‘äº†éšæœºçš„ IO æ“ä½œï¼Œå‡å°‘éšæœºçš„ IO æ“ä½œï¼Œå¯ä»¥æœ‰æ•ˆçš„æå‡æ•°æ®åº“æŸ¥è¯¢çš„æ€§èƒ½ï¼Œæ˜¯éå¸¸é‡è¦çš„æ•°æ®åº“ä¼˜åŒ–æ‰‹æ®µä¹‹ä¸€ï¼›\n*   ç´¢å¼•åˆ—è¶Šå¤šï¼Œé€šè¿‡ç´¢å¼•ç­›é€‰å‡ºçš„æ•°æ®è¶Šå°‘ã€‚  \n\n### ä»€ä¹ˆæ˜¯æœ€å·¦åŒ¹é…åŸåˆ™ï¼Ÿå®ƒçš„ç”Ÿæ•ˆåŸåˆ™æœ‰å“ªäº›ï¼Ÿ  \n\næœ€å·¦åŒ¹é…åŸåˆ™ä¹Ÿå«æœ€å·¦å‰ç¼€åŸåˆ™ï¼Œæ˜¯ MySQL ä¸­çš„ä¸€ä¸ªé‡è¦åŸåˆ™ï¼Œè¯´çš„æ˜¯ç´¢å¼•ä»¥æœ€å·¦è¾¹çš„ä¸ºèµ·ç‚¹ä»»ä½•è¿ç»­çš„ç´¢å¼•éƒ½èƒ½åŒ¹é…ä¸Šï¼Œå½“é‡åˆ°èŒƒå›´æŸ¥è¯¢ï¼ˆ>ã€<ã€betweenã€likeï¼‰å°±ä¼šåœæ­¢åŒ¹é…ã€‚\n\n### ä»¥ä¸‹è¯­å¥ä¼šèµ°ç´¢å¼•ä¹ˆï¼Ÿ\n\n```\nselect * from t where year(date)>2018;\n```\n\nä¸ä¼šï¼Œå› ä¸ºåœ¨ç´¢å¼•åˆ—ä¸Šæ¶‰åŠåˆ°äº†è¿ç®—ã€‚\n\n### èƒ½å¦ç»™æ‰‹æœºå·çš„å‰ 6 ä½åˆ›å»ºç´¢å¼•ï¼Ÿå¦‚ä½•åˆ›å»ºï¼Ÿ  \n\nå¯ä»¥ï¼Œåˆ›å»ºæ–¹å¼æœ‰ä¸¤ç§ï¼š\n\n```\nalter table t add index index_phone(phone(6));\ncreate index index_phone on t(phone(6));\n```\n\n### ä»€ä¹ˆæ˜¯å‰ç¼€ç´¢å¼•ï¼Ÿ  \n\nå‰ç¼€ç´¢å¼•ä¹Ÿå«å±€éƒ¨ç´¢å¼•ï¼Œæ¯”å¦‚ç»™èº«ä»½è¯çš„å‰ 10 ä½æ·»åŠ ç´¢å¼•ã€‚\nç±»ä¼¼è¿™ç§ç»™æŸåˆ—éƒ¨åˆ†ä¿¡æ¯æ·»åŠ ç´¢å¼•çš„æ–¹å¼å«åšå‰ç¼€ç´¢å¼•ã€‚\n\n### ä¸ºä»€ä¹ˆè¦ç”¨å‰ç¼€ç´¢å¼•ï¼Ÿ  \n\nå‰ç¼€ç´¢å¼•èƒ½æœ‰æ•ˆå‡å°ç´¢å¼•æ–‡ä»¶çš„å¤§å°ï¼Œè®©æ¯ä¸ªç´¢å¼•é¡µå¯ä»¥ä¿å­˜æ›´å¤šçš„ç´¢å¼•å€¼ï¼Œä»è€Œæé«˜äº†ç´¢å¼•æŸ¥è¯¢çš„é€Ÿåº¦ã€‚ä½†å‰ç¼€ç´¢å¼•ä¹Ÿæœ‰å®ƒçš„ç¼ºç‚¹ï¼Œä¸èƒ½åœ¨ order by æˆ–è€… group by ä¸­è§¦å‘å‰ç¼€ç´¢å¼•ï¼Œä¹Ÿä¸èƒ½æŠŠå®ƒä»¬ç”¨äºè¦†ç›–ç´¢å¼•ã€‚\n\n### ä»€ä¹ˆæƒ…å†µä¸‹é€‚åˆä½¿ç”¨å‰ç¼€ç´¢å¼•ï¼Ÿ  \n\nå½“å­—ç¬¦ä¸²æœ¬èº«å¯èƒ½æ¯”è¾ƒé•¿ï¼Œè€Œä¸”å‰å‡ ä¸ªå­—ç¬¦å°±å¼€å§‹ä¸ç›¸åŒï¼Œé€‚åˆä½¿ç”¨å‰ç¼€ç´¢å¼•ï¼›ç›¸åæƒ…å†µä¸‹ä¸é€‚åˆä½¿ç”¨å‰ç¼€ç´¢å¼•ï¼Œæ¯”å¦‚ï¼Œæ•´ä¸ªå­—æ®µçš„é•¿åº¦ä¸º 20ï¼Œç´¢å¼•é€‰æ‹©æ€§ï¼ˆä¸é‡å¤çš„ç´¢å¼•å€¼å’Œè¡¨è®°å½•æ•°çš„æ¯”å€¼ï¼Œè¶Šå¤§è¯´æ˜ç´¢å¼•ä»·å€¼è¶Šå¤§ï¼‰ä¸º 0.9ï¼Œè€Œæˆ‘ä»¬å¯¹å‰ 10 ä¸ªå­—ç¬¦å»ºç«‹å‰ç¼€ç´¢å¼•å…¶é€‰æ‹©æ€§ä¹Ÿåªæœ‰ 0.5ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦ç»§ç»­åŠ å¤§å‰ç¼€å­—ç¬¦çš„é•¿åº¦ï¼Œä½†æ˜¯è¿™ä¸ªæ—¶å€™å‰ç¼€ç´¢å¼•çš„ä¼˜åŠ¿å·²ç»ä¸æ˜æ˜¾ï¼Œå°±æ²¡æœ‰åˆ›å»ºå‰ç¼€ç´¢å¼•çš„å¿…è¦äº†ã€‚\n\n### InnoDB ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ B+ æ ‘ï¼Œè€Œä¸æ˜¯ B æ ‘ã€Hashã€çº¢é»‘æ ‘æˆ–äºŒå‰æ ‘ï¼Ÿ  \n\nå› ä¸º B æ ‘ã€Hashã€çº¢é»‘æ ‘æˆ–äºŒå‰æ ‘å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š\n\n*   B æ ‘ï¼šä¸ç®¡å¶å­èŠ‚ç‚¹è¿˜æ˜¯éå¶å­èŠ‚ç‚¹ï¼Œéƒ½ä¼šä¿å­˜æ•°æ®ï¼Œè¿™æ ·å¯¼è‡´åœ¨éå¶å­èŠ‚ç‚¹ä¸­èƒ½ä¿å­˜çš„æŒ‡é’ˆæ•°é‡å˜å°‘ï¼ˆæœ‰äº›èµ„æ–™ä¹Ÿç§°ä¸ºæ‰‡å‡ºï¼‰ï¼ŒæŒ‡é’ˆå°‘çš„æƒ…å†µä¸‹è¦ä¿å­˜å¤§é‡æ•°æ®ï¼Œåªèƒ½å¢åŠ æ ‘çš„é«˜åº¦ï¼Œå¯¼è‡´ IO æ“ä½œå˜å¤šï¼ŒæŸ¥è¯¢æ€§èƒ½å˜ä½ï¼›\n*   Hashï¼šè™½ç„¶å¯ä»¥å¿«é€Ÿå®šä½ï¼Œä½†æ˜¯æ²¡æœ‰é¡ºåºï¼Œæ— æ³•è¿›è¡ŒèŒƒå›´æŸ¥æ‰¾ï¼ŒIO å¤æ‚åº¦é«˜ï¼›\n*   äºŒå‰æ ‘ï¼šæ ‘çš„é«˜åº¦ä¸å‡åŒ€ï¼Œä¸èƒ½è‡ªå¹³è¡¡ï¼ŒæŸ¥æ‰¾æ•ˆç‡è·Ÿæ•°æ®æœ‰å…³ï¼ˆæ ‘çš„é«˜åº¦ï¼‰ï¼Œå¹¶ä¸” IO ä»£ä»·é«˜ï¼›\n*   çº¢é»‘æ ‘ï¼šæ ‘çš„é«˜åº¦éšç€æ•°æ®é‡å¢åŠ è€Œå¢åŠ ï¼ŒIO ä»£ä»·é«˜ã€‚  \n\n### MySQL å¦‚ä½•æŒ‡å®šæŸ¥è¯¢çš„ç´¢å¼•ï¼Ÿ  \n\nåœ¨ MySQL ä¸­å¯ä»¥ä½¿ç”¨ force index å¼ºè¡Œé€‰æ‹©ä¸€ä¸ªç´¢å¼•ï¼Œå…·ä½“æŸ¥è¯¢è¯­å¥å¦‚ä¸‹ï¼š\n\n```sql\nselect * from t force index(index_t);\n```\n\n### åœ¨ MySQL ä¸­æŒ‡å®šäº†æŸ¥è¯¢ç´¢å¼•ï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰ç”Ÿæ•ˆï¼Ÿ  \n\næˆ‘ä»¬çŸ¥é“åœ¨ MySQL ä¸­ä½¿ç”¨ force index å¯ä»¥æŒ‡å®šæŸ¥è¯¢çš„ç´¢å¼•ï¼Œä½†å¹¶ä¸æ˜¯ä¸€å®šä¼šç”Ÿæ•ˆï¼ŒåŸå› æ˜¯ MySQL ä¼šæ ¹æ®ä¼˜åŒ–å™¨è‡ªå·±é€‰æ‹©ç´¢å¼•ï¼Œå¦‚æœ force index æŒ‡å®šçš„ç´¢å¼•å‡ºç°åœ¨å€™é€‰ç´¢å¼•ä¸Šï¼Œè¿™ä¸ªæ—¶å€™ MySQL ä¸ä¼šåœ¨åˆ¤æ–­æ‰«æçš„è¡Œæ•°çš„å¤šå°‘ç›´æ¥ä½¿ç”¨æŒ‡å®šçš„ç´¢å¼•ï¼Œå¦‚æœæ²¡åœ¨å€™é€‰ç´¢å¼•ä¸­ï¼Œå³ä½¿ force index æŒ‡å®šäº†ç´¢å¼•ä¹Ÿæ˜¯ä¸ä¼šç”Ÿæ•ˆçš„ã€‚\n\n### å¦‚ä½•ä¼˜åŒ–èº«ä»½è¯çš„ç´¢å¼•ï¼Ÿ \n\nåœ¨ä¸­å›½å› ä¸ºå‰ 6 ä½ä»£è¡¨çš„æ˜¯åœ°åŒºï¼Œæ‰€ä»¥å¾ˆå¤šäººçš„å‰å…­ä½éƒ½æ˜¯ç›¸åŒçš„ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨å‰ç¼€ç´¢å¼•ä¸º 6 ä½çš„è¯ï¼Œæ€§èƒ½æå‡ä¹Ÿå¹¶ä¸æ˜¯å¾ˆæ˜æ˜¾ï¼Œä½†å¦‚æœè®¾ç½®çš„ä½æ•°è¿‡é•¿ï¼Œé‚£ä¹ˆå ç”¨çš„ç£ç›˜ç©ºé—´ä¹Ÿè¶Šå¤§ï¼Œæ•°æ®é¡µèƒ½æ”¾ä¸‹çš„ç´¢å¼•å€¼å°±è¶Šå°‘ï¼Œæœç´¢æ•ˆç‡ä¹Ÿè¶Šä½ã€‚é’ˆå¯¹è¿™ç§æƒ…å†µä¼˜åŒ–æ–¹æ¡ˆæœ‰ä»¥ä¸‹ä¸¤ç§ï¼š\n\n*   **ä½¿ç”¨èº«ä»½è¯å€’åºå­˜å‚¨**ï¼Œè¿™æ ·è®¾ç½®å‰å…­ä½çš„æ„ä¹‰å°±å¾ˆå¤§äº†ï¼›\n*   **ä½¿ç”¨ hash å€¼**ï¼Œæ–°åˆ›å»ºä¸€ä¸ªå­—æ®µç”¨äºå­˜å‚¨èº«ä»½è¯çš„ hash å€¼ã€‚\n\n### ç´¢å¼•çš„ä½¿ç”¨åœºæ™¯\n\n- å¯¹äºéå¸¸å°çš„è¡¨ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹å…¨è¡¨æ‰«ææ•ˆç‡æ›´é«˜ã€‚\n- ä¸­åˆ°å¤§å‹è¡¨ï¼Œç´¢å¼•éå¸¸æœ‰æ•ˆã€‚\n- ç‰¹å¤§å‹çš„è¡¨ï¼Œå»ºç«‹å’Œä½¿ç”¨ç´¢å¼•çš„ä»£ä»·ä¼šéšä¹‹å¢å¤§ï¼Œå¯ä»¥ä½¿ç”¨åˆ†åŒºæŠ€æœ¯æ¥è§£å†³ã€‚\n\n\n\n### èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•\n\nInnobd ä¸­çš„ä¸»é”®ç´¢å¼•æ˜¯ä¸€ç§èšç°‡ç´¢å¼•ï¼Œéèšç°‡ç´¢å¼•éƒ½æ˜¯è¾…åŠ©ç´¢å¼•ï¼Œåƒå¤åˆç´¢å¼•ã€å‰ç¼€ç´¢å¼•ã€å”¯ä¸€ç´¢å¼•ã€‚\n\nInnodb ä½¿ç”¨çš„æ˜¯èšç°‡ç´¢å¼•ï¼ŒMyISam ä½¿ç”¨çš„æ˜¯éèšç°‡ç´¢å¼•\n\n#### èšç°‡ç´¢å¼•(èšé›†ç´¢å¼•)\n\n![img](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1464190-20191106145143172-1760681728.png)\n\n\n\nã€€ã€€Innodb èšç°‡ç´¢å¼•å’Œ MyIsam éèšç°‡ç´¢å¼•çš„æ¯”è¾ƒè¯´æ˜\nã€€ã€€å‚è€ƒåšå®¢ï¼šhttps://www.cnblogs.com/zlcxbb/p/5757245.html\n\n#### InnoDBç´¢å¼•å®ç°\n\nã€€ã€€InnoDB**ä½¿ç”¨B+Treeä½œä¸ºç´¢å¼•ç»“æ„**ï¼Œä½†å…·ä½“å®ç°æ–¹å¼å´ä¸ MyISAM æˆªç„¶ä¸åŒ.\n\n1ï¼‰ä¸»é”®ç´¢å¼•ï¼š\n\n**MyISAMç´¢å¼•æ–‡ä»¶å’Œæ•°æ®æ–‡ä»¶æ˜¯åˆ†ç¦»çš„**ï¼Œ**ç´¢å¼•æ–‡ä»¶ä»…ä¿å­˜æ•°æ®è®°å½•çš„åœ°å€**ã€‚è€Œåœ¨**InnoDBä¸­ï¼Œè¡¨æ•°æ®æ–‡ä»¶æœ¬èº«å°±æ˜¯æŒ‰B+Treeç»„ç»‡çš„ä¸€ä¸ªç´¢å¼•ç»“æ„**ï¼Œè¿™æ£µæ ‘çš„å¶èŠ‚ç‚¹ data åŸŸä¿å­˜äº†å®Œæ•´çš„æ•°æ®è®°å½•ã€‚è¿™ä¸ªç´¢å¼•çš„ key æ˜¯æ•°æ®è¡¨çš„ä¸»é”®ï¼Œå› æ­¤ InnoDB è¡¨æ•°æ®æ–‡ä»¶æœ¬èº«å°±æ˜¯ä¸»ç´¢å¼•ã€‚\n\n ![](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesTyporaNotes1464190-20191106145200302-932404581.png)\n\n(å›¾ inndb ä¸»é”®ç´¢å¼•ï¼‰æ˜¯ InnoDB ä¸»ç´¢å¼•ï¼ˆåŒæ—¶ä¹Ÿæ˜¯æ•°æ®æ–‡ä»¶ï¼‰çš„ç¤ºæ„å›¾ï¼Œå¯ä»¥çœ‹åˆ°å¶èŠ‚ç‚¹åŒ…å«äº†å®Œæ•´çš„æ•°æ®è®°å½•ã€‚è¿™ç§ç´¢å¼•å«åšèšé›†ç´¢å¼•ã€‚å› ä¸º InnoDB çš„æ•°æ®æ–‡ä»¶æœ¬èº«è¦æŒ‰ä¸»é”®èšé›†ï¼Œæ‰€ä»¥ InnoDB è¦æ±‚è¡¨å¿…é¡»æœ‰ä¸»é”®ï¼ˆMyISAM å¯ä»¥æ²¡æœ‰ï¼‰ï¼Œå¦‚æœæ²¡æœ‰æ˜¾å¼æŒ‡å®šï¼Œåˆ™ MySQL ç³»ç»Ÿä¼šè‡ªåŠ¨é€‰æ‹©ä¸€ä¸ªå¯ä»¥å”¯ä¸€æ ‡è¯†æ•°æ®è®°å½•çš„åˆ—ä½œä¸ºä¸»é”®ï¼Œå¦‚æœä¸å­˜åœ¨è¿™ç§åˆ—ï¼Œåˆ™**MySQLè‡ªåŠ¨ä¸ºInnoDBè¡¨ç”Ÿæˆä¸€ä¸ªéšå«å­—æ®µä½œä¸ºä¸»é”®ï¼Œè¿™ä¸ªå­—æ®µé•¿åº¦ä¸º6ä¸ªå­—èŠ‚ï¼Œç±»å‹ä¸ºé•¿æ•´å½¢**ã€‚\n\n2ï¼‰InnoDB çš„è¾…åŠ©ç´¢å¼•\n\n   InnoDB çš„æ‰€æœ‰è¾…åŠ©ç´¢å¼•éƒ½å¼•ç”¨ä¸»é”®ä½œä¸º data åŸŸã€‚ä¾‹å¦‚ï¼Œä¸‹å›¾ä¸ºå®šä¹‰åœ¨ Col3 ä¸Šçš„ä¸€ä¸ªè¾…åŠ©ç´¢å¼•ï¼š\n\n ![img](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1464190-20191106145241480-1330791289.png)\n\nInnoDB ä½¿ç”¨çš„æ˜¯èšç°‡ç´¢å¼•ï¼Œå°†ä¸»é”®ç»„ç»‡åˆ°ä¸€æ£µ B+æ ‘ä¸­ï¼Œè€Œè¡Œæ•°æ®å°±å‚¨å­˜åœ¨å¶å­èŠ‚ç‚¹ä¸Šï¼Œè‹¥ä½¿ç”¨\"where id = 14\"è¿™æ ·çš„æ¡ä»¶æŸ¥æ‰¾ä¸»é”®ï¼Œåˆ™æŒ‰ç…§ B+æ ‘çš„æ£€ç´¢ç®—æ³•å³å¯æŸ¥æ‰¾åˆ°å¯¹åº”çš„å¶èŠ‚ç‚¹ï¼Œä¹‹åè·å¾—è¡Œæ•°æ®ã€‚è‹¥å¯¹ Name åˆ—è¿›è¡Œæ¡ä»¶æœç´¢ï¼Œåˆ™éœ€è¦ä¸¤ä¸ªæ­¥éª¤ï¼šç¬¬ä¸€æ­¥åœ¨è¾…åŠ©ç´¢å¼• B+æ ‘ä¸­æ£€ç´¢ Nameï¼Œåˆ°è¾¾å…¶å¶å­èŠ‚ç‚¹è·å–å¯¹åº”çš„ä¸»é”®ã€‚ç¬¬äºŒæ­¥ä½¿ç”¨ä¸»é”®åœ¨ä¸»ç´¢å¼• B+æ ‘ä¸­å†æ‰§è¡Œä¸€æ¬¡ B+æ ‘æ£€ç´¢æ“ä½œï¼Œæœ€ç»ˆåˆ°è¾¾å¶å­èŠ‚ç‚¹å³å¯è·å–æ•´è¡Œæ•°æ®ã€‚\n\n#### MyISAMç´¢å¼•å®ç°\n\nMyISAM ç´¢å¼•æ–‡ä»¶å’Œæ•°æ®æ–‡ä»¶æ˜¯åˆ†ç¦»çš„ï¼Œç´¢å¼•æ–‡ä»¶ä»…ä¿å­˜æ•°æ®è®°å½•çš„åœ°å€\n\n1ï¼‰ä¸»é”®ç´¢å¼•ï¼š\n\nMyISAM å¼•æ“ä½¿ç”¨ B+Tree ä½œä¸ºç´¢å¼•ç»“æ„ï¼Œå¶èŠ‚ç‚¹çš„**dataåŸŸå­˜æ”¾çš„æ˜¯æ•°æ®è®°å½•çš„åœ°å€**ã€‚ä¸‹å›¾æ˜¯ MyISAM ä¸»é”®ç´¢å¼•çš„åŸç†å›¾ï¼š\n\n![img](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1464190-20191106151308457-531875534.png)\n\n \n\nè¿™é‡Œè®¾è¡¨ä¸€å…±æœ‰ä¸‰åˆ—ï¼Œå‡è®¾æˆ‘ä»¬ä»¥ Col1 ä¸ºä¸»é”®ï¼Œå›¾ myisam1 æ˜¯ä¸€ä¸ª MyISAM è¡¨çš„ä¸»ç´¢å¼•ï¼ˆPrimary keyï¼‰ç¤ºæ„ã€‚å¯ä»¥çœ‹å‡º MyISAM çš„ç´¢å¼•æ–‡ä»¶ä»…ä»…ä¿å­˜æ•°æ®è®°å½•çš„åœ°å€ã€‚\n\n2ï¼‰è¾…åŠ©ç´¢å¼•ï¼ˆSecondary keyï¼‰\n\nåœ¨ MyISAM ä¸­ï¼Œä¸»ç´¢å¼•å’Œè¾…åŠ©ç´¢å¼•ï¼ˆSecondary keyï¼‰åœ¨ç»“æ„ä¸Šæ²¡æœ‰ä»»ä½•åŒºåˆ«ï¼Œ**åªæ˜¯ä¸»ç´¢å¼•è¦æ±‚keyæ˜¯å”¯ä¸€çš„ï¼Œè€Œè¾…åŠ©ç´¢å¼•çš„keyå¯ä»¥é‡å¤**ã€‚å¦‚æœæˆ‘ä»¬åœ¨ Col2 ä¸Šå»ºç«‹ä¸€ä¸ªè¾…åŠ©ç´¢å¼•ï¼Œåˆ™æ­¤ç´¢å¼•çš„ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚\n\nåŒæ ·ä¹Ÿæ˜¯ä¸€é¢— B+Treeï¼Œdata åŸŸä¿å­˜æ•°æ®è®°å½•çš„åœ°å€ã€‚å› æ­¤ï¼ŒMyISAM ä¸­ç´¢å¼•æ£€ç´¢çš„ç®—æ³•ä¸ºé¦–å…ˆæŒ‰ç…§ B+Tree æœç´¢ç®—æ³•æœç´¢ç´¢å¼•ï¼Œå¦‚æœæŒ‡å®šçš„ Key å­˜åœ¨ï¼Œåˆ™å–å‡ºå…¶ data åŸŸçš„å€¼ï¼Œç„¶åä»¥ data åŸŸçš„å€¼ä¸ºåœ°å€ï¼Œè¯»å–ç›¸åº”æ•°æ®è®°å½•ã€‚\n\n ![img](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1464190-20191106151427711-625351515.png)\n\nã€€ã€€**MyISMä½¿ç”¨çš„æ˜¯éèšç°‡ç´¢å¼•**ï¼Œéèšç°‡ç´¢å¼•çš„ä¸¤æ£µ B+æ ‘çœ‹ä¸Šå»æ²¡ä»€ä¹ˆä¸åŒï¼ŒèŠ‚ç‚¹çš„ç»“æ„å®Œå…¨ä¸€è‡´åªæ˜¯å­˜å‚¨çš„å†…å®¹ä¸åŒè€Œå·²ï¼Œä¸»é”®ç´¢å¼• B+æ ‘çš„èŠ‚ç‚¹å­˜å‚¨äº†ä¸»é”®ï¼Œè¾…åŠ©é”®ç´¢å¼• B+æ ‘å­˜å‚¨äº†è¾…åŠ©é”®ã€‚è¡¨æ•°æ®å­˜å‚¨åœ¨ç‹¬ç«‹çš„åœ°æ–¹ï¼Œè¿™ä¸¤é¢— B+æ ‘çš„å¶å­èŠ‚ç‚¹éƒ½ä½¿ç”¨ä¸€ä¸ªåœ°å€æŒ‡å‘çœŸæ­£çš„è¡¨æ•°æ®ï¼Œå¯¹äºè¡¨æ•°æ®æ¥è¯´ï¼Œè¿™ä¸¤ä¸ªé”®æ²¡æœ‰ä»»ä½•å·®åˆ«ã€‚ç”±äºç´¢å¼•æ ‘æ˜¯ç‹¬ç«‹çš„ï¼Œé€šè¿‡è¾…åŠ©é”®æ£€ç´¢æ— éœ€è®¿é—®ä¸»é”®çš„ç´¢å¼•æ ‘ã€‚\n\nä¸ºäº†æ›´å½¢è±¡è¯´æ˜è¿™ä¸¤ç§ç´¢å¼•çš„åŒºåˆ«ï¼Œæˆ‘ä»¬å‡æƒ³ä¸€ä¸ªè¡¨å¦‚ä¸‹å›¾å­˜å‚¨äº† 4 è¡Œæ•°æ®ã€‚å…¶ä¸­ Id ä½œä¸ºä¸»ç´¢å¼•ï¼ŒName ä½œä¸ºè¾…åŠ©ç´¢å¼•ã€‚å›¾ç¤ºæ¸…æ™°çš„æ˜¾ç¤ºäº†èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•çš„å·®å¼‚ã€‚\n\n![img](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1464190-20191106151527647-152458631.png)\n\n \n\nğŸŒŸ**InnoDBèšç°‡ç´¢å¼•ï¼š**\n\nä¸»é”®ç´¢å¼•æ ‘ï¼Œæ ¹ç»“ç‚¹å­˜çš„æ˜¯ä¸»é”® id å’Œå¯¹åº”çš„æ•°æ®ï¼›\n\nè¾…åŠ©ç´¢å¼•æ ‘ï¼Œæ ¹ç»“ç‚¹å­˜çš„æ˜¯è¾…åŠ©ç´¢å¼•å’Œå¯¹åº”çš„ä¸»é”®ç´¢å¼•ï¼Œå› æ­¤éœ€è¦æ ¹æ®ä¸»é”®åˆ°ä¸»é”®ç´¢å¼•æ ‘ä¸Šåœ¨éå†ä¸€æ¬¡å¾—åˆ°å¯¹åº”çš„æ•°æ®ã€‚\n\nğŸŒŸ**MyISAMéèšç°‡ç´¢å¼•ï¼š**\n\nä¸»é”®ç´¢å¼•æ ‘ï¼Œæ ¹ç»“ç‚¹å­˜çš„æ˜¯ä¸»é”®åˆ°æ•°æ®åœ°å€çš„æ˜ å°„ï¼›\n\nè¾…åŠ©ç´¢å¼•æ ‘ï¼Œæ ¹ç»“ç‚¹å­˜çš„æ˜¯è¾…åŠ©ç´¢å¼•åˆ°æ•°æ®åœ°å€çš„æ˜ å°„ï¼Œä¹Ÿå¯ä»¥ç›´æ¥å¾—åˆ°æ•°æ®ï¼Œä¸éœ€è¦å›è¡¨ã€‚\n\n#### é—®é¢˜ï¼šä¸»é”®ç´¢å¼•æ˜¯èšé›†ç´¢å¼•è¿˜æ˜¯éèšé›†ç´¢å¼•ï¼Ÿ\n\nåœ¨ InnoDB ä¸‹ä¸»é”®ç´¢å¼•æ˜¯èšé›†ç´¢å¼•ï¼Œåœ¨ MyISAM ä¸‹ä¸»é”®ç´¢å¼•æ˜¯éèšé›†ç´¢å¼•\n\n#### MyISAMç´¢å¼•å®ç°ï¼Ÿ\n\nMyISAM å­˜å‚¨å¼•æ“ä½¿ç”¨ B+Tree ä½œä¸ºç´¢å¼•ç»“æ„ï¼Œå¶èŠ‚ç‚¹çš„ data åŸŸå­˜æ”¾çš„æ˜¯æ•°æ®è®°å½•çš„åœ°å€ã€‚MyISAM çš„ç´¢å¼•æ–¹å¼ä¹Ÿå«åšéèšç°‡ç´¢å¼•çš„ï¼Œä¹‹æ‰€ä»¥è¿™ä¹ˆç§°å‘¼æ˜¯ä¸ºäº†ä¸ InnoDB çš„èšç°‡ç´¢å¼•åŒºåˆ†ã€‚\n\n#### MyISAMç´¢å¼•ä¸InnoDBç´¢å¼•çš„åŒºåˆ«ï¼Ÿ\n\n- InnoDB ç´¢å¼•æ˜¯èšç°‡ç´¢å¼•ï¼ŒMyISAM ç´¢å¼•æ˜¯éèšç°‡ç´¢å¼•ã€‚\n- InnoDB çš„ä¸»é”®ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å­˜å‚¨ç€ç´¢å¼•å’Œè¡Œæ•°æ®ï¼Œå› æ­¤ä¸»é”®ç´¢å¼•éå¸¸é«˜æ•ˆã€‚\n- MyISAM ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å­˜å‚¨çš„æ˜¯è¡Œæ•°æ®åœ°å€ï¼Œéœ€è¦æ ¹æ®æ•°æ®åœ°å€è®¿é—®å¯¹åº”çš„åœ°å€æ‰èƒ½å¾—åˆ°æ•°æ®ã€‚\n- **InnoDBéä¸»é”®ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å­˜å‚¨çš„æ˜¯ä¸»é”®å’Œå…¶ä»–å¸¦ç´¢å¼•çš„åˆ—æ•°æ®ï¼Œå› æ­¤æŸ¥è¯¢æ—¶åšåˆ°è¦†ç›–ç´¢å¼•ä¼šéå¸¸é«˜æ•ˆã€‚**\n\n### ç®€å•è¯´ä¸€è¯´dropã€deleteä¸truncateçš„åŒºåˆ«\n\nSQL ä¸­çš„ dropã€deleteã€truncate éƒ½è¡¨ç¤ºåˆ é™¤ï¼Œä½†æ˜¯ä¸‰è€…æœ‰ä¸€äº›å·®åˆ«\n\n> 1ã€deleteå’Œtruncateåªåˆ é™¤è¡¨çš„æ•°æ®ä¸åˆ é™¤è¡¨çš„ç»“æ„\n> 2ã€é€Ÿåº¦,ä¸€èˆ¬æ¥è¯´: drop> truncate >delete\n> 3ã€deleteè¯­å¥æ˜¯dml,è¿™ä¸ªæ“ä½œä¼šæ”¾åˆ°rollback segementä¸­,äº‹åŠ¡æäº¤ä¹‹åæ‰ç”Ÿæ•ˆ;\n> 4ã€å¦‚æœæœ‰ç›¸åº”çš„trigger,æ‰§è¡Œçš„æ—¶å€™å°†è¢«è§¦å‘. truncate,dropæ˜¯ddl, æ“ä½œç«‹å³ç”Ÿæ•ˆ,åŸæ•°æ®ä¸æ”¾åˆ°rollback segmentä¸­,ä¸èƒ½å›æ»š. æ“ä½œä¸è§¦å‘trigger.\n\n### deleteã€truncateå’Œdropåˆ†åˆ«åœ¨ä»€ä¹ˆåœºæ™¯ä¹‹ä¸‹ä½¿ç”¨ï¼Ÿ\n\n1. æƒ³åˆ é™¤éƒ¨åˆ†æ•°æ®è¡Œæ—¶å€™ï¼Œç”¨ deleteï¼Œå¹¶ä¸”å¸¦ä¸Š where å­å¥\n2. ä¿ç•™è¡¨è€Œåˆ é™¤æ‰€æœ‰æ•°æ®çš„æ—¶å€™ç”¨ truncate\n3. ä¸å†éœ€è¦ä¸€å¼ è¡¨çš„æ—¶å€™ï¼Œç”¨ drop\n\n### â­ä¸ºä»€ä¹ˆ B+Tree æ¯” B-Tree æ›´é€‚åˆå®é™…åº”ç”¨ä¸­æ“ä½œç³»ç»Ÿçš„æ–‡ä»¶ç´¢å¼•å’Œæ•°æ®åº“ç´¢å¼•ï¼Ÿ\n\n1. B+Tree çš„ç£ç›˜è¯»å†™ä»£ä»·æ›´ä½\n\n> B+Tree çš„å†…éƒ¨ç»“ç‚¹å¹¶æ²¡æœ‰æŒ‡å‘å…³é”®å­—å…·ä½“ä¿¡æ¯çš„æŒ‡é’ˆã€‚å› æ­¤å…¶å†…éƒ¨ç»“ç‚¹ç›¸å¯¹ B-Tree æ›´å°ã€‚å¦‚æœæŠŠæ‰€æœ‰åŒä¸€å†…éƒ¨ç»“ç‚¹çš„å…³é”®å­—å­˜æ”¾åœ¨åŒä¸€ç›˜å—ä¸­ï¼Œé‚£ä¹ˆç›˜å—æ‰€èƒ½å®¹çº³çš„å…³é”®å­—æ•°é‡ä¹Ÿè¶Šå¤šã€‚ä¸€æ¬¡æ€§è¯»å…¥å†…å­˜ä¸­çš„éœ€è¦æŸ¥æ‰¾çš„å…³é”®å­—ä¹Ÿå°±è¶Šå¤šã€‚ç›¸å¯¹æ¥è¯´ IO è¯»å†™æ¬¡æ•°ä¹Ÿå°±é™ä½äº†ã€‚\n\n2. B+Tree çš„æŸ¥è¯¢æ•ˆç‡æ›´åŠ ç¨³å®š\n\n> ç”±äºéç»ˆç»“ç‚¹å¹¶ä¸æ˜¯æœ€ç»ˆæŒ‡å‘æ–‡ä»¶å†…å®¹çš„ç»“ç‚¹ï¼Œè€Œåªæ˜¯å¶å­ç»“ç‚¹ä¸­å…³é”®å­—çš„ç´¢å¼•ã€‚æ‰€ä»¥ä»»ä½•å…³é”®å­—çš„æŸ¥æ‰¾å¿…é¡»èµ°ä¸€æ¡ä»æ ¹ç»“ç‚¹åˆ°å¶å­ç»“ç‚¹çš„è·¯ã€‚æ‰€æœ‰å…³é”®å­—æŸ¥è¯¢çš„è·¯å¾„é•¿åº¦ç›¸åŒï¼Œå¯¼è‡´æ¯ä¸€ä¸ªæ•°æ®çš„æŸ¥è¯¢æ•ˆç‡ç›¸å½“ã€‚\n\n### â­Hashç´¢å¼•å’ŒB+æ ‘æ‰€æœ‰æœ‰ä»€ä¹ˆåŒºåˆ«æˆ–è€…è¯´ä¼˜åŠ£å‘¢?\n\né¦–å…ˆè¦çŸ¥é“ Hash ç´¢å¼•å’Œ B+æ ‘ç´¢å¼•çš„åº•å±‚å®ç°åŸç†ï¼š\n\n**hashç´¢å¼•åº•å±‚å°±æ˜¯hashè¡¨,è¿›è¡ŒæŸ¥æ‰¾æ—¶,è°ƒç”¨ä¸€æ¬¡hashå‡½æ•°å°±å¯ä»¥è·å–åˆ°ç›¸åº”çš„é”®å€¼,ä¹‹åè¿›è¡Œå›è¡¨æŸ¥è¯¢è·å¾—å®é™…æ•°æ®.**\nB+æ ‘åº•å±‚å®ç°æ˜¯å¤šè·¯å¹³è¡¡æŸ¥æ‰¾æ ‘.å¯¹äºæ¯ä¸€æ¬¡çš„æŸ¥è¯¢éƒ½æ˜¯ä»æ ¹èŠ‚ç‚¹å‡ºå‘,æŸ¥æ‰¾åˆ°å¶å­èŠ‚ç‚¹æ–¹å¯ä»¥è·å¾—æ‰€æŸ¥é”®å€¼,ç„¶åæ ¹æ®æŸ¥è¯¢åˆ¤æ–­æ˜¯å¦éœ€è¦å›è¡¨æŸ¥è¯¢æ•°æ®.\n\né‚£ä¹ˆå¯ä»¥çœ‹å‡ºä»–ä»¬æœ‰ä»¥ä¸‹çš„ä¸åŒï¼š\n\n- hash ç´¢å¼•è¿›è¡Œç­‰å€¼æŸ¥è¯¢æ›´å¿«(ä¸€èˆ¬æƒ…å†µä¸‹),ä½†æ˜¯å´æ— æ³•è¿›è¡ŒèŒƒå›´æŸ¥è¯¢.\n\n- hash ç´¢å¼•ä¸æ”¯æŒä½¿ç”¨ç´¢å¼•è¿›è¡Œæ’åº,åŸç†åŒä¸Š.\n- hash ç´¢å¼•ä¸æ”¯æŒæ¨¡ç³ŠæŸ¥è¯¢.\n- hash ç´¢å¼•ä»»ä½•æ—¶å€™éƒ½é¿å…ä¸äº†å›è¡¨æŸ¥è¯¢æ•°æ®,è€Œ B+æ ‘åœ¨ç¬¦åˆæŸäº›æ¡ä»¶(èšç°‡ç´¢å¼•,è¦†ç›–ç´¢å¼•ç­‰)çš„æ—¶å€™å¯ä»¥åªé€šè¿‡ç´¢å¼•å®ŒæˆæŸ¥è¯¢.\n- hash ç´¢å¼•è™½ç„¶åœ¨ç­‰å€¼æŸ¥è¯¢ä¸Šè¾ƒå¿«,ä½†æ˜¯ä¸ç¨³å®š.æ€§èƒ½ä¸å¯é¢„æµ‹,å½“æŸä¸ªé”®å€¼å­˜åœ¨å¤§é‡é‡å¤çš„æ—¶å€™,å‘ç”Ÿ hash ç¢°æ’,æ­¤æ—¶æ•ˆç‡å¯èƒ½æå·®.è€Œ B+æ ‘çš„æŸ¥è¯¢æ•ˆç‡æ¯”è¾ƒç¨³å®š,å¯¹äºæ‰€æœ‰çš„æŸ¥è¯¢éƒ½æ˜¯ä»æ ¹èŠ‚ç‚¹åˆ°å¶å­èŠ‚ç‚¹,ä¸”æ ‘çš„é«˜åº¦è¾ƒä½.\n\nå› æ­¤,åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹,ç›´æ¥é€‰æ‹© B+æ ‘ç´¢å¼•å¯ä»¥è·å¾—ç¨³å®šä¸”è¾ƒå¥½çš„æŸ¥è¯¢é€Ÿåº¦.è€Œä¸éœ€è¦ä½¿ç”¨ hash ç´¢å¼•.\n\n### éèšç°‡ç´¢å¼•ä¸€å®šä¼šå›è¡¨æŸ¥è¯¢å—?\n\næœ‰å¦‚ä¸‹ä¸€å¼  InnoDB è¡¨ï¼š\n\n```sql\nCREATE TABLE `user` (\n`id` INT NOT NULL ,\n`name` VARCHAR NOT NULL ,\n`age` INT NOT NULL);\n```\n\nå…¶ä¸­ id ä¸ºè‡ªå¢ä¸»é”®ï¼Œname æ˜¯ä¸€ä¸ªæ™®é€šç´¢å¼•ã€‚åœ¨æ‰§è¡Œ select * from user where id = 1 æ—¶ï¼Œä¼šåœ¨ä¸»é”®ç´¢å¼•å¯¹åº”çš„ B+æ ‘çš„å¶å­ç»“ç‚¹ä¸Šæœç´¢åˆ°å…³é”®å­— id=1 çš„èŠ‚ç‚¹ï¼Œå¹¶è¯»å–ä½äºè¯¥èŠ‚ç‚¹ä¸Šçš„æ•´è¡Œæ•°æ®ã€‚ä½†æ˜¯åœ¨æ‰§è¡Œ select * from user where name = 'tom'æ—¶ï¼Œä¼šåˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼š\n\nå…ˆåˆ° name ç´¢å¼•å¯¹åº”çš„ B+æ ‘çš„å¶å­ç»“ç‚¹ä¸Šæœç´¢åˆ°å…³é”®å­— name='tomâ€™çš„èŠ‚ç‚¹ï¼Œå¹¶ä»è¯¥èŠ‚ç‚¹ä¸Šè·å–å¯¹åº”çš„ä¸»é”® id å€¼ã€‚\n\nç„¶åå†æ ¹æ® id å€¼ä½¿ç”¨ä¸»é”®ç´¢å¼•è¯»å–åˆ°æ•´è¡Œæ•°æ®ã€‚\n\nå…¶ä¸­ç¬¬äºŒä¸ªæ­¥éª¤å«ä½œå›è¡¨æŸ¥è¯¢ã€‚éœ€è¦æ‰«æè¾…åŠ©ç´¢å¼•å’Œä¸»é”®ç´¢å¼•ä¸¤æ£µ B+æ ‘æ‰èƒ½æ‹¿åˆ°æ•´è¡Œæ•°æ®ï¼Œæ•ˆç‡è¾ƒä½ã€‚\n\nå¦‚æœæ‰§è¡Œ select id, name from user where name = 'tom',åˆ™åªéœ€è¦æ‰«æ name ç´¢å¼•æ ‘å°±å¯ä»¥è·å–åˆ°æ‰€æœ‰çš„å­—æ®µï¼Œå› ä¸º id å’Œ name éƒ½ä¿å­˜åœ¨ name ç´¢å¼• B+æ ‘çš„å¶å­èŠ‚ç‚¹ä¸Šï¼Œæ‰€ä»¥ä¸éœ€è¦å†å»ä¸»é”®ç´¢å¼•ä¸ŠæŸ¥æ‰¾ã€‚è¿™å°±æ˜¯æ‰€è°“çš„ç´¢å¼•è¦†ç›–ã€‚åªéœ€è¦åœ¨ä¸€æ£µç´¢å¼•æ ‘ä¸Šå°±èƒ½è·å– SQL æ‰€éœ€çš„æ‰€æœ‰åˆ—æ•°æ®ï¼Œæ— éœ€å›è¡¨ï¼Œé€Ÿåº¦æ›´å¿«ã€‚\n\nè€Œ select id, name, age from user where name = 'tom'ï¼Œå› ä¸º age å­—æ®µæ²¡æœ‰å­˜å‚¨åˆ° name ç´¢å¼•çš„å¶å­èŠ‚ç‚¹ä¸Šï¼Œæ‰€ä»¥éœ€è¦æ ¹æ®ä¸»é”®ç´¢å¼•å›è¡¨æŸ¥è¯¢åˆ° age åˆ—å€¼ã€‚å¦‚æœæŠŠ name ç´¢å¼•æ”¹æˆ(nameï¼Œage)çš„è”åˆç´¢å¼•å°±å¯ä»¥å®ç°ç´¢å¼•è¦†ç›–ï¼Œæ— éœ€å›è¡¨äº†ã€‚ï¼ˆè¦†ç›–ç´¢å¼•ï¼Œsql è¯­å¥ä¸­ç”¨åˆ°çš„å­—æ®µéƒ½æœ‰ç´¢å¼•ï¼‰\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\nç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸º CSDN åšä¸»ã€Œlmynoã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ª CC 4.0 BY-SA ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚\nåŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/weixin_33603681/article/details/113387941\n\n### è”åˆç´¢å¼•æ˜¯ä»€ä¹ˆ?ä¸ºä»€ä¹ˆéœ€è¦æ³¨æ„è”åˆç´¢å¼•ä¸­çš„é¡ºåº?\n\nå› æ­¤åœ¨å»ºç«‹è”åˆç´¢å¼•çš„æ—¶å€™åº”è¯¥æ³¨æ„ç´¢å¼•åˆ—çš„é¡ºåº,ä¸€èˆ¬æƒ…å†µä¸‹,å°†æŸ¥è¯¢éœ€æ±‚é¢‘ç¹æˆ–è€…å­—æ®µé€‰æ‹©æ€§é«˜çš„åˆ—æ”¾åœ¨å‰é¢.æ­¤å¤–å¯ä»¥æ ¹æ®ç‰¹ä¾‹çš„æŸ¥è¯¢æˆ–è€…è¡¨ç»“æ„è¿›è¡Œå•ç‹¬çš„è°ƒæ•´.\n\n### åˆ›å»ºçš„ç´¢å¼•æœ‰æ²¡æœ‰è¢«ä½¿ç”¨åˆ°?æˆ–è€…è¯´æ€ä¹ˆæ‰å¯ä»¥çŸ¥é“è¿™æ¡è¯­å¥è¿è¡Œå¾ˆæ…¢çš„åŸå› ?\n\nMySQL æä¾›äº† explain å‘½ä»¤æ¥æŸ¥çœ‹è¯­å¥çš„æ‰§è¡Œè®¡åˆ’\n\n\n\n## MySQLäº‹åŠ¡ç¯‡ï¼ˆé‡ç‚¹ï¼‰\n\n### å¯è§æ€§åˆ¤æ–­\n\n> æ€»ç»“ï¼š\n>\n> å¤§äºç­‰äºä¸‹ä¸€ä¸ªåˆ†é…çš„äº‹åŠ¡IDä¸å¯è§\n>\n> åŒ…å«åœ¨æœªæäº¤äº‹åŠ¡é›†åˆä¸­ä½†æ˜¯å’Œåˆ›å»ºread viewçš„äº‹åŠ¡IDä¸ç›¸ç­‰åˆ™ä¹Ÿä¸å¯è§ã€‚\n\näº‹åŠ¡ç‰ˆæœ¬å·å°äºå½“å‰æœ€å°çš„äº‹åŠ¡ IDï¼Œé‚£ä¹ˆè¯´æ˜å®ƒå·²ç»æäº¤äº†ï¼Œå¯è§ã€‚\n\näº‹åŠ¡ç‰ˆæœ¬å·**å¤§äºç­‰äºä¸‹ä¸€ä¸ªåˆ†é…çš„äº‹åŠ¡ID**ï¼Œè¯´æ˜è¿™ä¸ªäº‹åŠ¡åœ¨å½“å‰ read view ç”Ÿæˆååœ¨ç”Ÿæˆï¼Œ**ä¸å¯è§**ã€‚\n\näº‹åŠ¡ç‰ˆæœ¬å·åœ¨ [æœ€å°äº‹åŠ¡ IDï¼Œä¸‹ä¸€ä¸ªåˆ†é…çš„äº‹åŠ¡ ID) åŒºé—´å†…ï¼š\n\nâ€‹\tå¦‚æœæœªæäº¤äº‹åŠ¡é›†åˆåŒ…å«è¯¥äº‹åŠ¡ç‰ˆæœ¬å·ï¼Œé‚£ä¹ˆåˆ¤æ–­æ˜¯å¦è¯¥äº‹åŠ¡ç‰ˆæœ¬å·æ˜¯å¦ç­‰äºåˆ›å»ºè¯¥ read view çš„äº‹åŠ¡ IDï¼Œ\n\nâ€‹\t\tç­‰äºåˆ™è¯´æ˜è¿™ä¸ªç‰ˆæœ¬çš„æ•°æ®æ˜¯å½“å‰äº‹åŠ¡ç”Ÿæˆçš„ï¼Œå¯è§ã€‚**ä¸ç­‰äºåˆ™ä¸å¯è§**ã€‚\n\nâ€‹\tå¦‚æœä¸åŒ…å«ï¼Œè¯´æ˜è¿™ä¸ªäº‹åŠ¡ç‰ˆæœ¬å·å·²ç»æäº¤ï¼Œå¯è§ã€‚\n\n### æŸ¥è¯¢ä¸€æ¡è®°å½•ï¼ŒåŸºäºMVCCï¼Œæ˜¯æ€æ ·çš„æµç¨‹\n\n1. è·å–æ•°æ®ç‰ˆæœ¬å·å³**æ•°æ®è¡Œä¸­çš„äº‹åŠ¡idéšè—å­—æ®µ**\n2. **æ‰§è¡Œsqlï¼Œå¾—åˆ°Read View**\n3. æ ¹æ®æ•°æ®ç‰ˆæœ¬å·å’Œ read view è¿›è¡Œ**å¯è§æ€§åˆ¤æ–­**ï¼Œåˆ¤æ–­å½“å‰ç‰ˆæœ¬æ•°æ®æ˜¯å¦å¯è§\n4. å¦‚æœä¸ç¬¦åˆ Read View çš„å¯è§æ€§è§„åˆ™ï¼Œ å³å°±éœ€è¦**Undo log**ä¸­å†å²å¿«ç…§é‡æ–°å’Œ read view å¯è§æ€§åˆ¤æ–­\n5. æœ€åè¿”å›ç¬¦åˆè§„åˆ™çš„æ•°æ®\n\nInnoDB å®ç° MVCCï¼Œæ˜¯é€šè¿‡` Read View+ Undo Log` å®ç°çš„ï¼ŒUndo Log ä¿å­˜äº†å†å²å¿«ç…§ï¼ŒRead View å¯è§æ€§è§„åˆ™å¸®åŠ©åˆ¤æ–­å½“å‰ç‰ˆæœ¬çš„æ•°æ®æ˜¯å¦å¯è§ã€‚\n\n### RCä¸‹å¯ä»¥è¯»åˆ°å·²æäº¤æ•°æ®ï¼Œä½†ä¸èƒ½è¯»åˆ°æœªæäº¤æ•°æ®\n\n![1](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesTyporaNotes1.png)\n\n### RRä¸‹å·²æäº¤å’Œæœªæäº¤æ•°æ®éƒ½ä¸èƒ½è¯»åˆ°\n\n![2](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesTyporaNotes2.png)\n\n### ä¸ºä»€ä¹ˆRRä¸‹è§£å†³äº†ä¸å¯é‡å¤è¯»é—®é¢˜ï¼Ÿ\n\nå®é™…ä¸Šï¼Œå„ç§äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸‹çš„ Read view å·¥ä½œæ–¹å¼ï¼Œæ˜¯ä¸ä¸€æ ·çš„ï¼ŒRR å¯ä»¥è§£å†³ä¸å¯é‡å¤è¯»é—®é¢˜ï¼Œå°±æ˜¯è·Ÿ**Read viewå·¥ä½œæ–¹å¼æœ‰å…³**ã€‚\n\n- åœ¨è¯»å·²æäº¤ï¼ˆRCï¼‰éš”ç¦»çº§åˆ«ä¸‹ï¼ŒåŒä¸€ä¸ªäº‹åŠ¡é‡Œé¢ï¼Œ**æ¯ä¸€æ¬¡æŸ¥è¯¢éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„Read View**ï¼Œè¿™æ ·å°±å¯èƒ½é€ æˆåŒä¸€ä¸ªäº‹åŠ¡é‡Œå‰åè¯»å–æ•°æ®å¯èƒ½ä¸ä¸€è‡´çš„é—®é¢˜ï¼ˆä¸å¯é‡å¤è¯»å¹¶å‘é—®é¢˜ï¼‰ã€‚\n\n| begin                               |                   |\n| ----------------------------------- | ----------------- |\n| select * from core_user where id =1 | ç”Ÿæˆä¸€ä¸ªRead View |\n| /                                   | /                 |\n| /                                   | /                 |\n| select * from core_user where id =1 | ç”Ÿæˆä¸€ä¸ªRead View |\n\n- åœ¨å¯é‡å¤è¯»ï¼ˆRRï¼‰éš”ç¦»çº§åˆ«ä¸‹ï¼Œ**ä¸€ä¸ªäº‹åŠ¡é‡Œåªä¼šè·å–ä¸€æ¬¡read view**ï¼Œéƒ½æ˜¯å‰¯æœ¬å…±ç”¨çš„ï¼Œä»è€Œä¿è¯æ¯æ¬¡æŸ¥è¯¢çš„æ•°æ®éƒ½æ˜¯ä¸€æ ·çš„ã€‚\n\n| begin                               |                       |\n| ----------------------------------- | --------------------- |\n| select * from core_user where id =1 | ç”Ÿæˆä¸€ä¸ªRead View     |\n| /                                   |                       |\n| /                                   |                       |\n| select * from core_user where id =1 | å…±ç”¨ä¸€ä¸ªRead Viewå‰¯æœ¬ |\n\n### MVCCæ˜¯å¦è§£å†³äº†å¹»è¯»é—®é¢˜å‘¢ï¼Ÿ\n\nå¯¹äºå¹»è¯»æ¥è¯´ï¼Œå­˜åœ¨å¿«ç…§è¯»ï¼ˆå¯ä»¥è¯»åˆ°å¤šä¸ªç‰ˆæœ¬ï¼Œæ™®é€šçš„ selectï¼‰å’Œå½“å‰è¯»ï¼ˆè¯»çš„æ˜¯æœ€æ–°çš„ for updateï¼‰çš„æƒ…å†µï¼š\n\n1. RR éš”ç¦»çº§åˆ«ä¸‹ä¸ºäº†è§£å†³å¹»è¯»é—®é¢˜ï¼š**å¿«ç…§è¯»ä¾é MVCCæ§åˆ¶ï¼Œå½“å‰è¯»é€šè¿‡é—´éš™é”è§£å†³**ï¼›\n2. é—´éš™é”å’Œè¡Œé”åˆç§° Next-Key Locksï¼Œæ¯ä¸ª Next-Key Locks æ˜¯å‰å¼€åé—­åŒºé—´ï¼›\n3. **é—´éš™é”çš„å¼•å…¥ï¼Œå¯èƒ½ä¼šå¯¼è‡´åŒæ ·è¯­å¥é”ä½æ›´å¤§çš„èŒƒå›´ï¼Œå½±å“å¹¶å‘åº¦**ã€‚\n\n\n\n### å¹¶å‘äº‹åŠ¡æœ‰ä»€ä¹ˆä»€ä¹ˆé—®é¢˜ï¼Ÿåº”è¯¥å¦‚ä½•è§£å†³ï¼Ÿ\n\nå¹¶å‘äº‹åŠ¡å¯èƒ½é€ æˆï¼šè„è¯»ã€ä¸å¯é‡å¤è¯»å’Œå¹»è¯»ç­‰é—®é¢˜ ï¼Œè¿™äº›é—®é¢˜å…¶å®éƒ½æ˜¯æ•°æ®åº“è¯»ä¸€è‡´æ€§é—®é¢˜ï¼Œå¿…é¡»ç”±æ•°æ®åº“æä¾›ä¸€å®šçš„äº‹åŠ¡éš”ç¦»æœºåˆ¶æ¥è§£å†³ï¼Œè§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š\n\n*   åŠ é”ï¼šåœ¨è¯»å–æ•°æ®å‰ï¼Œå¯¹å…¶åŠ é”ï¼Œé˜»æ­¢å…¶ä»–äº‹åŠ¡å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ã€‚\n\n*   æä¾›æ•°æ®å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMultiVersion Concurrency Controlï¼Œç®€ç§° MVCC æˆ– MCCï¼‰ï¼Œä¹Ÿç§°ä¸ºå¤šç‰ˆæœ¬æ•°æ®åº“ï¼šä¸ç”¨åŠ ä»»ä½•é”ï¼Œ é€šè¿‡ä¸€å®šæœºåˆ¶ç”Ÿæˆä¸€ä¸ªæ•°æ®è¯·æ±‚æ—¶é—´ç‚¹çš„ä¸€è‡´æ€§æ•°æ®å¿«ç…§ï¼ˆSnapshot)ï¼Œ å¹¶ç”¨è¿™ä¸ªå¿«ç…§æ¥æä¾›ä¸€å®šçº§åˆ« ï¼ˆè¯­å¥çº§æˆ–äº‹åŠ¡çº§ï¼‰ çš„ä¸€è‡´æ€§è¯»å–ï¼Œä»ç”¨æˆ·çš„è§’åº¦æ¥çœ‹ï¼Œå¥½è±¡æ˜¯æ•°æ®åº“å¯ä»¥æä¾›åŒä¸€æ•°æ®çš„å¤šä¸ªç‰ˆæœ¬ã€‚\n\n### MySQL äº‹åŠ¡å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ\n\nä»¥ InnoDB çš„äº‹åŠ¡å®ç°ä¸ºä¾‹ï¼ŒInnoDB æ˜¯é€šè¿‡å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMVCCï¼ŒMultiversion Concurrency Control ï¼‰è§£å†³ä¸å¯é‡å¤è¯»é—®é¢˜ï¼ŒåŠ ä¸Šé—´éš™é”è§£å†³å¹»è¯»é—®é¢˜ã€‚å› æ­¤ InnoDB çš„ RR éš”ç¦»çº§åˆ«å…¶å®å®ç°äº†ä¸²è¡ŒåŒ–çº§åˆ«çš„æ•ˆæœï¼Œè€Œä¸”ä¿ç•™äº†æ¯”è¾ƒå¥½çš„å¹¶å‘æ€§èƒ½ã€‚\näº‹åŠ¡çš„éš”ç¦»æ€§æ˜¯é€šè¿‡é”å®ç°ï¼Œè€Œäº‹åŠ¡çš„åŸå­æ€§ã€ä¸€è‡´æ€§å’ŒæŒä¹…æ€§åˆ™æ˜¯é€šè¿‡äº‹åŠ¡æ—¥å¿—å®ç°ã€‚\n\n\n\n## MVCCè¯¦ç»†ç‰ˆ\n\n### 1. ç›¸å…³æ•°æ®åº“çŸ¥è¯†ç‚¹å›é¡¾\n\n#### 1.1 ä»€ä¹ˆæ˜¯æ•°æ®åº“äº‹åŠ¡ï¼Œä¸ºä»€ä¹ˆè¦æœ‰äº‹åŠ¡\n\näº‹åŠ¡ï¼Œç”±ä¸€ä¸ªæœ‰é™çš„æ•°æ®åº“æ“ä½œåºåˆ—æ„æˆï¼Œè¿™äº›æ“ä½œè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œ,è¦ä¹ˆå…¨éƒ¨ä¸æ‰§è¡Œï¼Œæ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„å·¥ä½œå•ä½ã€‚\n\n**ä¸ºä»€ä¹ˆè¦æœ‰äº‹åŠ¡å‘¢ï¼Ÿ** å°±æ˜¯ä¸ºäº†ä¿è¯æ•°æ®çš„æœ€ç»ˆä¸€è‡´æ€§ã€‚\n\n#### 1.2 äº‹åŠ¡åŒ…æ‹¬å“ªå‡ ä¸ªç‰¹æ€§ï¼Ÿ\n\näº‹åŠ¡å››ä¸ªå…¸å‹ç‰¹æ€§ï¼Œå³ ACIDï¼ŒåŸå­æ€§ï¼ˆAtomicityï¼‰ã€ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ã€éš”ç¦»æ€§ï¼ˆIsolationï¼‰ã€æŒä¹…æ€§ï¼ˆDurabilityï¼‰ã€‚\n\n- åŸå­æ€§ï¼š äº‹åŠ¡ä½œä¸ºä¸€ä¸ªæ•´ä½“è¢«æ‰§è¡Œï¼ŒåŒ…å«åœ¨å…¶ä¸­çš„å¯¹æ•°æ®åº“çš„æ“ä½œ**è¦ä¹ˆå…¨éƒ¨éƒ½æ‰§è¡Œï¼Œè¦ä¹ˆéƒ½ä¸æ‰§è¡Œ**ã€‚\n- ä¸€è‡´æ€§ï¼š æŒ‡åœ¨**äº‹åŠ¡å¼€å§‹ä¹‹å‰å’Œäº‹åŠ¡ç»“æŸä»¥å**ï¼Œæ•°æ®ä¸ä¼šè¢«ç ´åï¼Œå‡å¦‚ A è´¦æˆ·ç»™ B è´¦æˆ·è½¬ 10 å—é’±ï¼Œä¸ç®¡æˆåŠŸä¸å¦ï¼ŒA å’Œ B çš„æ€»é‡‘é¢æ˜¯ä¸å˜çš„ã€‚\n- éš”ç¦»æ€§ï¼š å¤šä¸ªäº‹åŠ¡å¹¶å‘è®¿é—®æ—¶ï¼Œ**äº‹åŠ¡ä¹‹é—´æ˜¯ç›¸äº’éš”ç¦»**çš„ï¼Œä¸€ä¸ªäº‹åŠ¡ä¸åº”è¯¥è¢«å…¶ä»–äº‹åŠ¡å¹²æ‰°ï¼Œå¤šä¸ªå¹¶å‘äº‹åŠ¡ä¹‹é—´è¦ç›¸äº’éš”ç¦»ã€‚\n- æŒä¹…æ€§ï¼š è¡¨ç¤ºäº‹åŠ¡å®Œæˆæäº¤åï¼Œè¯¥äº‹åŠ¡å¯¹æ•°æ®åº“æ‰€ä½œçš„æ“ä½œæ›´æ”¹ï¼Œå°†**æŒä¹…åœ°ä¿å­˜åœ¨æ•°æ®åº“**ä¹‹ä¸­ã€‚\n\n#### 1.3 äº‹åŠ¡å¹¶å‘å­˜åœ¨çš„é—®é¢˜\n\näº‹åŠ¡å¹¶å‘ä¼šå¼•èµ·**è„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»**é—®é¢˜ã€‚\n\n##### 1.3.1 è„è¯»\n\n> å¦‚æœä¸€ä¸ªäº‹åŠ¡è¯»å–åˆ°äº†å¦ä¸€ä¸ªæœªæäº¤äº‹åŠ¡ä¿®æ”¹è¿‡çš„æ•°æ®ï¼Œæˆ‘ä»¬å°±ç§°å‘ç”Ÿäº†è„è¯»ç°è±¡ã€‚\n\n##### 1.3.2 ä¸å¯é‡å¤è¯»\n\n> åŒä¸€ä¸ªäº‹åŠ¡å†…ï¼Œå‰åå¤šæ¬¡è¯»å–ï¼Œè¯»å–åˆ°çš„æ•°æ®å†…å®¹ä¸ä¸€è‡´\n\n##### 1.3.3 å¹»è¯»\n\n> å¦‚æœä¸€ä¸ªäº‹åŠ¡å…ˆæ ¹æ®æŸäº›æœç´¢æ¡ä»¶æŸ¥è¯¢å‡ºä¸€äº›è®°å½•ï¼Œåœ¨è¯¥äº‹åŠ¡æœªæäº¤æ—¶ï¼Œå¦ä¸€ä¸ªäº‹åŠ¡å†™å…¥äº†ä¸€äº›ç¬¦åˆé‚£äº›æœç´¢æ¡ä»¶çš„è®°å½•ï¼ˆå¦‚insertã€deleteã€updateï¼‰ï¼Œä¸¤æ¬¡è¯»å–åˆ°çš„ç»“æœé›†å´ä¸ä¸€æ ·äº†ï¼Œå°±æ„å‘³ç€å‘ç”Ÿäº†**å¹»è¯»**ã€‚\n\n#### 1.4 å››å¤§éš”ç¦»çº§åˆ«\n\nä¸ºäº†è§£å†³å¹¶å‘äº‹åŠ¡å­˜åœ¨çš„**è„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»**ç­‰é—®é¢˜ï¼Œæ•°æ®åº“å¤§å”è®¾è®¡äº†å››ç§éš”ç¦»çº§åˆ«ã€‚åˆ†åˆ«æ˜¯**è¯»æœªæäº¤ï¼Œè¯»å·²æäº¤ï¼Œå¯é‡å¤è¯»ï¼Œä¸²è¡ŒåŒ–ï¼ˆSerializableï¼‰**ã€‚\n\n##### 1.4.1 è¯»æœªæäº¤\n\nè¯»æœªæäº¤éš”ç¦»çº§åˆ«ï¼Œåªé™åˆ¶äº†ä¸¤ä¸ªæ•°æ®**ä¸èƒ½åŒæ—¶ä¿®æ”¹**ï¼Œä½†æ˜¯ä¿®æ”¹æ•°æ®çš„æ—¶å€™ï¼Œå³ä½¿äº‹åŠ¡**æœªæäº¤**ï¼Œéƒ½æ˜¯å¯ä»¥è¢«åˆ«çš„äº‹åŠ¡è¯»å–åˆ°çš„ï¼Œè¿™çº§åˆ«çš„äº‹åŠ¡éš”ç¦»æœ‰**è„è¯»ã€é‡å¤è¯»ã€å¹»è¯»**çš„é—®é¢˜ï¼›\n\n##### 1.4.2 è¯»å·²æäº¤\n\nè¯»å·²æäº¤éš”ç¦»çº§åˆ«ï¼Œå½“å‰äº‹åŠ¡åªèƒ½è¯»å–åˆ°å…¶ä»–äº‹åŠ¡**æäº¤**çš„æ•°æ®ï¼Œæ‰€ä»¥è¿™ç§äº‹åŠ¡çš„éš”ç¦»çº§åˆ«**è§£å†³äº†è„è¯»**é—®é¢˜ï¼Œä½†è¿˜æ˜¯ä¼šå­˜åœ¨**é‡å¤è¯»ã€å¹»è¯»**é—®é¢˜ï¼›\n\n##### 1.4 3 å¯é‡å¤è¯»\n\nå¯é‡å¤è¯»éš”ç¦»çº§åˆ«ï¼Œé™åˆ¶äº†è¯»å–æ•°æ®çš„æ—¶å€™ï¼Œä¸å¯ä»¥è¿›è¡Œä¿®æ”¹ï¼Œæ‰€ä»¥**è§£å†³äº†é‡å¤è¯»**çš„é—®é¢˜ï¼Œä½†æ˜¯è¯»å–èŒƒå›´æ•°æ®çš„æ—¶å€™ï¼Œæ˜¯å¯ä»¥æ’å…¥æ•°æ®ï¼Œæ‰€ä»¥è¿˜ä¼šå­˜åœ¨**å¹»è¯»**é—®é¢˜ï¼›\n\n##### 1.4.4 ä¸²è¡ŒåŒ–\n\näº‹åŠ¡æœ€é«˜çš„éš”ç¦»çº§åˆ«ï¼Œåœ¨è¯¥çº§åˆ«ä¸‹ï¼Œæ‰€æœ‰äº‹åŠ¡éƒ½æ˜¯è¿›è¡Œ**ä¸²è¡ŒåŒ–é¡ºåº**æ‰§è¡Œçš„ã€‚å¯ä»¥é¿å…è„è¯»ã€ä¸å¯é‡å¤è¯»ä¸å¹»è¯»æ‰€æœ‰å¹¶å‘é—®é¢˜ã€‚ä½†æ˜¯è¿™ç§äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸‹ï¼Œäº‹åŠ¡æ‰§è¡Œå¾ˆè€—æ€§èƒ½ã€‚\n\n##### 1.4.5 å››å¤§éš”ç¦»çº§åˆ«ï¼Œéƒ½ä¼šå­˜åœ¨å“ªäº›å¹¶å‘é—®é¢˜å‘¢\n\n| éš”ç¦»çº§åˆ« | è„è¯» | ä¸å¯é‡å¤è¯» | å¹»è¯» |\n| -------- | ---- | ---------- | ---- |\n| è¯»æœªæäº¤ | âˆš    | âˆš          | âˆš    |\n| è¯»å·²æäº¤ | Ã—    | âˆš          | âˆš    |\n| å¯é‡å¤è¯» | Ã—    | Ã—          | âˆš    |\n| ä¸²è¡ŒåŒ–   | Ã—    | Ã—          | Ã—    |\n\n#### 1.5 æ•°æ®åº“æ˜¯å¦‚ä½•ä¿è¯äº‹åŠ¡çš„éš”ç¦»æ€§çš„å‘¢ï¼Ÿ\n\næ•°æ®åº“æ˜¯é€šè¿‡**åŠ é”**ï¼Œæ¥å®ç°äº‹åŠ¡çš„éš”ç¦»æ€§çš„ã€‚è¿™å°±å¥½åƒï¼Œå¦‚æœä½ æƒ³ä¸€ä¸ªäººé™é™ï¼Œä¸è¢«åˆ«äººæ‰“æ‰°ï¼Œä½ å°±å¯ä»¥åœ¨æˆ¿é—¨ä¸ŠåŠ ä¸Šä¸€æŠŠé”ã€‚\n\nåŠ é”ç¡®å®å¥½ä½¿ï¼Œå¯ä»¥ä¿è¯éš”ç¦»æ€§ã€‚æ¯”å¦‚**ä¸²è¡ŒåŒ–éš”ç¦»çº§åˆ«å°±æ˜¯åŠ é”å®ç°çš„**ã€‚ä½†æ˜¯é¢‘ç¹çš„åŠ é”ï¼Œå¯¼è‡´è¯»æ•°æ®æ—¶ï¼Œæ²¡åŠæ³•ä¿®æ”¹ï¼Œä¿®æ”¹æ•°æ®æ—¶ï¼Œæ²¡åŠæ³•è¯»å–ï¼Œå¤§å¤§**é™ä½äº†æ•°æ®åº“æ€§èƒ½**ã€‚\n\n**é‚£ä¹ˆï¼Œå¦‚ä½•è§£å†³åŠ é”åçš„æ€§èƒ½é—®é¢˜çš„ï¼Ÿ**\n\nç­”æ¡ˆå°±æ˜¯,**MVCCå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶**ï¼å®ƒå®ç°è¯»å–æ•°æ®ä¸ç”¨åŠ é”ï¼Œå¯ä»¥è®©è¯»å–æ•°æ®åŒæ—¶ä¿®æ”¹ã€‚ä¿®æ”¹æ•°æ®æ—¶åŒæ—¶å¯è¯»å–ã€‚\n\n### 2. ä»€ä¹ˆæ˜¯ MVCCï¼Ÿ\n\nMVCCï¼Œå³**Multi-Version  Concurrency Control ï¼ˆå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼‰**ã€‚å®ƒæ˜¯ä¸€ç§å¹¶å‘æ§åˆ¶çš„æ–¹æ³•ï¼Œä¸€èˆ¬åœ¨æ•°æ®åº“ç®¡ç†ç³»ç»Ÿä¸­ï¼Œå®ç°å¯¹æ•°æ®åº“çš„å¹¶å‘è®¿é—®ï¼Œåœ¨ç¼–ç¨‹è¯­è¨€ä¸­å®ç°äº‹åŠ¡å†…å­˜ã€‚\n\n> é€šä¿—çš„è®²ï¼Œæ•°æ®åº“ä¸­åŒæ—¶å­˜åœ¨å¤šä¸ªç‰ˆæœ¬çš„æ•°æ®ï¼Œå¹¶ä¸æ˜¯æ•´ä¸ªæ•°æ®åº“çš„å¤šä¸ªç‰ˆæœ¬ï¼Œè€Œæ˜¯æŸä¸€æ¡è®°å½•çš„å¤šä¸ªç‰ˆæœ¬åŒæ—¶å­˜åœ¨ï¼Œåœ¨æŸä¸ªäº‹åŠ¡å¯¹å…¶è¿›è¡Œæ“ä½œçš„æ—¶å€™ï¼Œéœ€è¦æŸ¥çœ‹è¿™ä¸€æ¡è®°å½•çš„éšè—åˆ—äº‹åŠ¡ç‰ˆæœ¬idï¼Œæ¯”å¯¹äº‹åŠ¡idå¹¶æ ¹æ®äº‹ç‰©éš”ç¦»çº§åˆ«å»åˆ¤æ–­è¯»å–å“ªä¸ªç‰ˆæœ¬çš„æ•°æ®ã€‚\n\næ•°æ®åº“éš”ç¦»çº§åˆ«**è¯»å·²æäº¤ã€å¯é‡å¤è¯»** éƒ½æ˜¯åŸºäº MVCC å®ç°çš„ï¼Œç›¸å¯¹äºåŠ é”ç®€å•ç²—æš´çš„æ–¹å¼ï¼Œå®ƒç”¨æ›´å¥½çš„æ–¹å¼å»å¤„ç†è¯»å†™å†²çªï¼Œèƒ½æœ‰æ•ˆæé«˜æ•°æ®åº“å¹¶å‘æ€§èƒ½ã€‚\n\n### 3. MVCCå®ç°çš„å…³é”®çŸ¥è¯†ç‚¹\n\n#### 3.1 äº‹åŠ¡ç‰ˆæœ¬å·\n\n> äº‹åŠ¡æ¯æ¬¡å¼€å¯å‰ï¼Œéƒ½ä¼šä»æ•°æ®åº“è·å¾—ä¸€ä¸ª**è‡ªå¢é•¿**çš„äº‹åŠ¡IDï¼Œå¯ä»¥ä»äº‹åŠ¡IDåˆ¤æ–­äº‹åŠ¡çš„æ‰§è¡Œå…ˆåé¡ºåºã€‚è¿™å°±æ˜¯äº‹åŠ¡ç‰ˆæœ¬å·ã€‚\n\n#### 3.2 éšå¼å­—æ®µ\n\nå¯¹äº InnoDB å­˜å‚¨å¼•æ“ï¼Œæ¯ä¸€è¡Œè®°å½•éƒ½æœ‰ä¸¤ä¸ªéšè—åˆ—**trx_id**ã€**roll_pointer**ï¼Œå¦‚æœè¡¨ä¸­æ²¡æœ‰ä¸»é”®å’Œé NULL å”¯ä¸€é”®æ—¶ï¼Œåˆ™è¿˜ä¼šæœ‰ç¬¬ä¸‰ä¸ªéšè—çš„ä¸»é”®åˆ—**row_id**ã€‚\n\n| åˆ—å         | æ˜¯å¦å¿…é¡» | æè¿°                                                     |\n| ------------ | -------- | -------------------------------------------------------- |\n| row_id       | å¦       | å•è°ƒé€’å¢çš„è¡ŒIDï¼Œä¸æ˜¯å¿…éœ€çš„ï¼Œå ç”¨6ä¸ªå­—èŠ‚ã€‚                |\n| trx_id       | æ˜¯       | è®°å½•æ“ä½œè¯¥æ•°æ®äº‹åŠ¡çš„**äº‹åŠ¡ID**                           |\n| roll_pointer | æ˜¯       | è¿™ä¸ªéšè—åˆ—å°±ç›¸å½“äºä¸€ä¸ª**å›æ»šæŒ‡é’ˆ**ï¼ŒæŒ‡å‘å›æ»šæ®µçš„undoæ—¥å¿— |\n\n#### 3.3 undo log\n\nundo logï¼Œ**å›æ»šæ—¥å¿—**ï¼Œç”¨äº**è®°å½•æ•°æ®è¢«ä¿®æ”¹å‰**çš„ä¿¡æ¯ã€‚åœ¨è¡¨è®°å½•ä¿®æ”¹ä¹‹å‰ï¼Œä¼šå…ˆæŠŠæ•°æ®æ‹·è´åˆ° undo log é‡Œï¼Œå¦‚æœäº‹åŠ¡å›æ»šï¼Œå³å¯ä»¥é€šè¿‡ undo log æ¥è¿˜åŸæ•°æ®ã€‚\n\nå¯ä»¥è¿™æ ·è®¤ä¸ºï¼Œå½“ delete ä¸€æ¡è®°å½•æ—¶ï¼Œundo log ä¸­ä¼šè®°å½•ä¸€æ¡å¯¹åº”çš„ insert è®°å½•ï¼Œå½“ update ä¸€æ¡è®°å½•æ—¶ï¼Œå®ƒè®°å½•ä¸€æ¡å¯¹åº”ç›¸åçš„ update è®°å½•ã€‚\n\nundo log æœ‰ä»€ä¹ˆ**ç”¨é€”**å‘¢ï¼Ÿ\n\n1. äº‹åŠ¡å›æ»šæ—¶ï¼Œä¿è¯åŸå­æ€§å’Œä¸€è‡´æ€§ã€‚\n2. ç”¨äº MVCC**å¿«ç…§è¯»**ã€‚\n\n#### 3.4 ç‰ˆæœ¬é“¾\n\nå¤šä¸ªäº‹åŠ¡å¹¶è¡Œæ“ä½œæŸä¸€è¡Œæ•°æ®æ—¶ï¼Œä¸åŒäº‹åŠ¡å¯¹è¯¥è¡Œæ•°æ®çš„ä¿®æ”¹ä¼šäº§ç”Ÿå¤šä¸ªç‰ˆæœ¬ï¼Œç„¶åé€šè¿‡å›æ»šæŒ‡é’ˆï¼ˆroll_pointerï¼‰ï¼Œè¿æˆä¸€ä¸ªé“¾è¡¨ï¼Œè¿™ä¸ªé“¾è¡¨å°±ç§°ä¸º**ç‰ˆæœ¬é“¾**ã€‚å¦‚ä¸‹ï¼š\n\n![image-20220422131424393](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131424393.png)\n\nå…¶å®ï¼Œé€šè¿‡ç‰ˆæœ¬é“¾ï¼Œæˆ‘ä»¬å°±å¯ä»¥çœ‹å‡º**äº‹åŠ¡ç‰ˆæœ¬å·ã€è¡¨æ ¼éšè—çš„åˆ—å’Œundo log**å®ƒä»¬ä¹‹é—´çš„å…³ç³»ã€‚æˆ‘ä»¬å†æ¥å°åˆ†æä¸€ä¸‹ã€‚\n\n1. å‡è®¾ç°åœ¨æœ‰ä¸€å¼  core_user è¡¨ï¼Œè¡¨é‡Œé¢æœ‰ä¸€æ¡æ•°æ®,id ä¸º 1ï¼Œåå­—ä¸ºå­™æƒï¼š\n\n\t<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131445316.png\" alt=\"image-20220422131445316\" style=\"zoom: 50%;\" />\n\n2. ç°åœ¨å¼€å¯ä¸€ä¸ªäº‹åŠ¡ Aï¼š å¯¹ core_user è¡¨æ‰§è¡Œ`update core_user set name =\"æ›¹æ“\" where id=1`,ä¼šè¿›è¡Œå¦‚ä¸‹æµç¨‹æ“ä½œ\n\n- é¦–å…ˆè·å¾—ä¸€ä¸ªäº‹åŠ¡ ID=100\n- æŠŠ core_user è¡¨ä¿®æ”¹å‰çš„æ•°æ®,æ‹·è´åˆ° undo log\n- ä¿®æ”¹ core_user è¡¨ä¸­ï¼Œid=1 çš„æ•°æ®ï¼Œåå­—æ”¹ä¸ºæ›¹æ“\n- æŠŠä¿®æ”¹åçš„æ•°æ®äº‹åŠ¡ Id=101 æ”¹æˆå½“å‰äº‹åŠ¡ç‰ˆæœ¬å·ï¼Œå¹¶æŠŠ**roll_pointer**æŒ‡å‘ undo log æ•°æ®åœ°å€ã€‚\n\n\t<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131527508.png\" alt=\"image-20220422131527508\" style=\"zoom: 50%;\" />\n\n#### 3.5 å¿«ç…§è¯»å’Œå½“å‰è¯»\n\n**å¿«ç…§è¯»ï¼š** è¯»å–çš„æ˜¯è®°å½•æ•°æ®çš„å¯è§ç‰ˆæœ¬ï¼ˆæœ‰æ—§çš„ç‰ˆæœ¬ï¼‰ã€‚ä¸åŠ é”,æ™®é€šçš„ select è¯­å¥éƒ½æ˜¯å¿«ç…§è¯»,å¦‚ï¼š\n\n```\nselect * from core_user where id > 2;\n```\n\n**å½“å‰è¯»**ï¼šè¯»å–çš„æ˜¯è®°å½•æ•°æ®çš„æœ€æ–°ç‰ˆæœ¬ï¼Œæ˜¾å¼åŠ é”çš„éƒ½æ˜¯å½“å‰è¯»\n\n```\nselect * from core_user where id > 2 for update;\n```\n\n#### 3.6 Read View\n\n- **Read Viewæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ** å®ƒå°±æ˜¯äº‹åŠ¡æ‰§è¡Œ SQL è¯­å¥æ—¶ï¼Œäº§ç”Ÿçš„è¯»è§†å›¾ã€‚å®é™…ä¸Šåœ¨ innodb ä¸­ï¼Œæ¯ä¸ª SQL è¯­å¥æ‰§è¡Œå‰éƒ½ä¼šå¾—åˆ°ä¸€ä¸ª Read Viewã€‚\n- **Read Viewæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ** å®ƒä¸»è¦æ˜¯ç”¨æ¥åšå¯è§æ€§åˆ¤æ–­çš„ï¼Œå³åˆ¤æ–­å½“å‰äº‹åŠ¡å¯è§å“ªä¸ªç‰ˆæœ¬çš„æ•°æ®\n\nRead View æ˜¯å¦‚ä½•ä¿è¯å¯è§æ€§åˆ¤æ–­çš„å‘¢ï¼Ÿæˆ‘ä»¬å…ˆçœ‹çœ‹ Read view çš„å‡ ä¸ªé‡è¦å±æ€§\n\n- m_ids:å½“å‰ç³»ç»Ÿä¸­é‚£äº›æ´»è·ƒ(**æœªæäº¤**)çš„è¯»å†™äº‹åŠ¡ ID, å®ƒæ•°æ®ç»“æ„ä¸ºä¸€ä¸ª Listï¼Œ[min_limit_id, max_limit_id)\n- min_limit_id:è¡¨ç¤ºåœ¨ç”Ÿæˆ ReadView æ—¶ï¼Œå½“å‰ç³»ç»Ÿä¸­æ´»è·ƒçš„è¯»å†™äº‹åŠ¡ä¸­æœ€å°çš„äº‹åŠ¡ idï¼Œå³ m_ids ä¸­çš„æœ€å°å€¼ã€‚\n- max_limit_id:è¡¨ç¤ºç”Ÿæˆ ReadView æ—¶ï¼Œç³»ç»Ÿä¸­åº”è¯¥åˆ†é…ç»™ä¸‹ä¸€ä¸ªäº‹åŠ¡çš„ id å€¼ï¼Œå³å³ m_ids ä¸­çš„æœ€å¤§å€¼+1\n- creator_trx_id: åˆ›å»ºå½“å‰ read view çš„äº‹åŠ¡ ID\n\n**Read view åŒ¹é…æ¡ä»¶è§„åˆ™**å¦‚ä¸‹ï¼š\n\n1. å¦‚æœæ–°çš„æ•°æ®äº‹åŠ¡ ID `trx_id < min_limit_id`ï¼Œè¡¨æ˜ç”Ÿæˆè¯¥ç‰ˆæœ¬çš„äº‹åŠ¡åœ¨ç”Ÿæˆ Read View å‰ï¼Œå·²ç»æäº¤(å› ä¸ºäº‹åŠ¡ ID æ˜¯é€’å¢çš„)ï¼Œæ‰€ä»¥è¯¥ç‰ˆæœ¬å¯ä»¥è¢«å½“å‰äº‹åŠ¡è®¿é—®ã€‚\n2. å¦‚æœ`trx_id>= max_limit_id`ï¼Œè¡¨æ˜ç”Ÿæˆè¯¥ç‰ˆæœ¬çš„äº‹åŠ¡åœ¨ç”Ÿæˆ ReadView åæ‰ç”Ÿæˆï¼Œæ‰€ä»¥è¯¥ç‰ˆæœ¬ä¸å¯ä»¥è¢«å½“å‰äº‹åŠ¡è®¿é—®ã€‚\n3. å¦‚æœ `min_limit_id =<trx_id< max_limit_id`,éœ€è¦åˆ† 3 ç§æƒ…å†µè®¨è®º\n\n> ï¼ˆ1ï¼‰å¦‚æœ`m_ids`åŒ…å«`trx_id`,åˆ™ä»£è¡¨Read Viewç”Ÿæˆæ—¶åˆ»ï¼Œè¿™ä¸ªäº‹åŠ¡è¿˜æœªæäº¤ï¼Œä½†æ˜¯å¦‚æœæ•°æ®çš„`trx_id`ç­‰äº`creator_trx_id`çš„è¯ï¼Œè¡¨æ˜æ•°æ®æ˜¯è‡ªå·±ç”Ÿæˆçš„ï¼Œå› æ­¤æ˜¯**å¯è§**çš„ã€‚\n>\n> ï¼ˆ2ï¼‰å¦‚æœ`m_ids`åŒ…å«`trx_id`ï¼Œå¹¶ä¸”`trx_id`ä¸ç­‰äº`creator_trx_id`ï¼Œåˆ™Read  Viewç”Ÿæˆæ—¶ï¼Œäº‹åŠ¡æœªæäº¤ï¼Œå¹¶ä¸”ä¸æ˜¯è‡ªå·±ç”Ÿäº§çš„ï¼Œæ‰€ä»¥å½“å‰äº‹åŠ¡ä¹Ÿæ˜¯**çœ‹ä¸è§**çš„ï¼›\n>\n> ï¼ˆ3ï¼‰å¦‚æœ`m_ids`ä¸åŒ…å«`trx_id`ï¼Œåˆ™è¯´æ˜ä½ è¿™ä¸ªäº‹åŠ¡åœ¨Read Viewç”Ÿæˆä¹‹å‰å°±**å·²ç»æäº¤**äº†ï¼Œä¿®æ”¹çš„ç»“æœï¼Œå½“å‰äº‹åŠ¡æ˜¯èƒ½çœ‹è§çš„ã€‚\n\n### 4. MVCCå®ç°åŸç†åˆ†æ\n\n<img src=\"/Users/yaxing/blog/source/_posts/E:/Markdown%E6%96%87%E6%A1%A3%E5%9B%BE%E7%89%87/8%20MySQL.assets/v2-a086ef515e7d0a023ca3cfcc5759c7f6_720w.jpg\" alt=\"img\" style=\"zoom: 80%;\" />\n\n#### 4.1 æŸ¥è¯¢ä¸€æ¡è®°å½•ï¼ŒåŸºäºMVCCï¼Œæ˜¯æ€æ ·çš„æµç¨‹\n\n1. è·å–äº‹åŠ¡ ID\n2. æ‰§è¡Œ sqlï¼Œå¾—åˆ° Read View\n3. æŸ¥è¯¢å¾—åˆ°çš„æ•°æ®ï¼Œç„¶åä¸ Read View ä¸­çš„äº‹åŠ¡ ID è¿›è¡Œæ¯”è¾ƒï¼Œå¸®åŠ©åˆ¤æ–­å½“å‰ç‰ˆæœ¬çš„æ•°æ®æ˜¯å¦å¯è§ã€‚\n4. å¦‚æœä¸ç¬¦åˆ Read View çš„å¯è§æ€§è§„åˆ™ï¼Œ å³å°±éœ€è¦ Undo log ä¸­å†å²å¿«ç…§;\n5. æœ€åè¿”å›ç¬¦åˆè§„åˆ™çš„æ•°æ®\n\nInnoDB å®ç° MVCCï¼Œæ˜¯é€šè¿‡` Read View+ Undo Log` å®ç°çš„ï¼ŒUndo Log ä¿å­˜äº†å†å²å¿«ç…§ï¼ŒRead View å¯è§æ€§è§„åˆ™å¸®åŠ©åˆ¤æ–­å½“å‰ç‰ˆæœ¬çš„æ•°æ®æ˜¯å¦å¯è§ã€‚\n\n#### 4.2 è¯»å·²æäº¤ï¼ˆRCï¼‰éš”ç¦»çº§åˆ«ï¼Œå­˜åœ¨ä¸å¯é‡å¤è¯»é—®é¢˜çš„åˆ†æå†ç¨‹\n\n1. åˆ›å»º core_user è¡¨ï¼Œæ’å…¥ä¸€æ¡åˆå§‹åŒ–æ•°æ®,å¦‚ä¸‹ï¼š\n\n\t<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131554547.png\" alt=\"image-20220422131554547\" style=\"zoom: 33%;\" />\n\n2. éš”ç¦»çº§åˆ«è®¾ç½®ä¸ºè¯»å·²æäº¤ï¼ˆRCï¼‰ï¼Œäº‹åŠ¡ A å’Œäº‹åŠ¡ B åŒæ—¶å¯¹ core_user è¡¨è¿›è¡ŒæŸ¥è¯¢å’Œä¿®æ”¹æ“ä½œã€‚\n\n```\näº‹åŠ¡A: select * fom core_user where id=1\näº‹åŠ¡B: update core_user set name =â€æ›¹æ“â€\n// äº‹åŠ¡Aä¸¤æ¬¡è¯»åˆ°çš„æ•°æ®ä¸ä¸€æ ·ï¼Œäº‹åŠ¡Aä¼šè¯»åˆ°å…¶ä»–äº‹åŠ¡æäº¤çš„æ•°æ®ï¼Œä¸èƒ½è¯»åˆ°å…¶ä»–äº‹åŠ¡æœªæäº¤çš„æ•°æ®ã€‚\n```\n\næ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131620047.png\" alt=\"image-20220422131620047\" style=\"zoom: 33%;\" />\n\næœ€åäº‹åŠ¡ A æŸ¥è¯¢åˆ°çš„ç»“æœæ˜¯ï¼Œ**name=æ›¹æ“**çš„è®°å½•ï¼Œæˆ‘ä»¬**åŸºäºMVCC**ï¼Œæ¥åˆ†æä¸€ä¸‹æ‰§è¡Œæµç¨‹ï¼š\n\n(1) A å¼€å¯äº‹åŠ¡ï¼Œé¦–å…ˆå¾—åˆ°ä¸€ä¸ªäº‹åŠ¡ ID ä¸º 100\n\n(2) B å¼€å¯äº‹åŠ¡ï¼Œå¾—åˆ°äº‹åŠ¡ ID ä¸º 101\n\n(3) äº‹åŠ¡ A ç”Ÿæˆä¸€ä¸ª Read Viewï¼Œread view å¯¹åº”çš„å€¼å¦‚ä¸‹\n\n| å˜é‡                                                    | å€¼       |\n| ------------------------------------------------------- | -------- |\n| m_idsï¼ˆæœªæäº¤çš„äº‹åŠ¡IDï¼‰                                 | 100ï¼Œ101 |\n| max_limit_idï¼ˆä¸‹ä¸€ä¸ªåº”è¯¥åˆ†é…çš„äº‹åŠ¡IDï¼‰                  | 102      |\n| min_limit_idï¼ˆå½“å‰read viewä¸­æ´»è·ƒçš„æœªæäº¤äº‹åŠ¡çš„æœ€å°å€¼ï¼‰ | 100      |\n| creator_trx_idï¼ˆåˆ›å»ºè¯¥read viewçš„äº‹åŠ¡IDï¼‰               | 100      |\n\nç„¶åå›åˆ°ç‰ˆæœ¬é“¾ï¼šå¼€å§‹ä»ç‰ˆæœ¬é“¾ä¸­æŒ‘é€‰å¯è§çš„è®°å½•ï¼š\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131642264.png\" alt=\"image-20220422131642264\" style=\"zoom: 33%;\" />\n\nç”±å›¾å¯ä»¥çœ‹å‡ºï¼Œæœ€æ–°ç‰ˆæœ¬çš„åˆ— name çš„å†…å®¹æ˜¯`å­™æƒ`ï¼Œè¯¥ç‰ˆæœ¬çš„`trx_id`å€¼ä¸º 100ã€‚å¼€å§‹æ‰§è¡Œ read view å¯è§æ€§è§„åˆ™æ ¡éªŒï¼š\n\n```\nmin_limit_id(100)=<trx_idï¼ˆ100ï¼‰<102;\ncreator_trx_id = trx_id =100;\n```\n\nç”±æ­¤å¯å¾—ï¼Œtrx_id=100 çš„è¿™ä¸ªè®°å½•ï¼Œå½“å‰äº‹åŠ¡æ˜¯å¯è§çš„ã€‚æ‰€ä»¥æŸ¥åˆ°æ˜¯ name ä¸º`å­™æƒ`çš„è®°å½•ã€‚\n\n(4) äº‹åŠ¡ B è¿›è¡Œä¿®æ”¹æ“ä½œï¼ŒæŠŠåå­—æ”¹ä¸ºæ›¹æ“ã€‚æŠŠåŸæ•°æ®æ‹·è´åˆ° undo log,ç„¶åå¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œæ ‡è®°äº‹åŠ¡ ID å’Œä¸Šä¸€ä¸ªæ•°æ®ç‰ˆæœ¬åœ¨ undo log çš„åœ°å€ã€‚\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131733370.png\" alt=\"image-20220422131733370\" style=\"zoom:33%;\" />\n\n(5) æäº¤äº‹åŠ¡\n\n(6) äº‹åŠ¡ A å†æ¬¡æ‰§è¡ŒæŸ¥è¯¢æ“ä½œï¼Œ**æ–°ç”Ÿæˆä¸€ä¸ªRead View**ï¼ŒRead View å¯¹åº”çš„å€¼å¦‚ä¸‹\n\n| å˜é‡                                    | å€¼   |\n| --------------------------------------- | ---- |\n| m_idsï¼ˆæœªæäº¤çš„äº‹åŠ¡IDï¼‰                 | 100  |\n| max_limit_idï¼ˆä¸‹ä¸€ä¸ªåº”å½“åˆ†é…çš„äº‹åŠ¡IDï¼‰  | 102  |\n| min_limit_idï¼ˆæœ€å°çš„äº‹åŠ¡IDï¼‰            | 100  |\n| creator_trx_idï¼ˆåˆ›å»ºread viewçš„äº‹åŠ¡IDï¼‰ | 100  |\n\nç„¶åå†æ¬¡å›åˆ°ç‰ˆæœ¬é“¾ï¼šä»ç‰ˆæœ¬é“¾ä¸­æŒ‘é€‰å¯è§çš„è®°å½•ï¼š\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131753554.png\" alt=\"image-20220422131753554\" style=\"zoom:33%;\" />\n\nä»å›¾å¯å¾—ï¼Œæœ€æ–°ç‰ˆæœ¬çš„åˆ— name çš„å†…å®¹æ˜¯`æ›¹æ“`ï¼Œè¯¥ç‰ˆæœ¬çš„`trx_id`å€¼ä¸º 101ã€‚å¼€å§‹æ‰§è¡Œ Read View å¯è§æ€§è§„åˆ™æ ¡éªŒï¼š\n\n```\nmin_limit_id(100)=<trx_idï¼ˆ101ï¼‰<max_limit_idï¼ˆ102);\nä½†æ˜¯,trx_id=101ï¼Œä¸å±äºm_idsé›†åˆï¼Œè¯´æ˜101è¿™ä¸ªäº‹åŠ¡å·²ç»æäº¤äº†ï¼Œå½“å‰äº‹åŠ¡å¯è§\n```\n\nå› æ­¤ï¼Œ`trx_id=101`è¿™ä¸ªè®°å½•ï¼Œå¯¹äºå½“å‰äº‹åŠ¡æ˜¯å¯è§çš„ã€‚æ‰€ä»¥ SQL æŸ¥è¯¢åˆ°çš„æ˜¯ name ä¸º`æ›¹æ“`çš„è®°å½•ã€‚\n\nç»¼ä¸Šæ‰€è¿°ï¼Œåœ¨**è¯»å·²æäº¤ï¼ˆRCï¼‰éš”ç¦»çº§åˆ«**ä¸‹ï¼ŒåŒä¸€ä¸ªäº‹åŠ¡é‡Œï¼Œä¸¤ä¸ªç›¸åŒçš„æŸ¥è¯¢ï¼Œè¯»å–åŒä¸€æ¡è®°å½•ï¼ˆid=1ï¼‰ï¼Œå´è¿”å›äº†ä¸åŒçš„æ•°æ®ï¼ˆ**ç¬¬ä¸€æ¬¡æŸ¥å‡ºæ¥æ˜¯å­™æƒï¼Œç¬¬äºŒæ¬¡æŸ¥å‡ºæ¥æ˜¯æ›¹æ“é‚£æ¡è®°å½•**ï¼‰ï¼Œå› æ­¤ RC éš”ç¦»çº§åˆ«ï¼Œå­˜åœ¨**ä¸å¯é‡å¤è¯»**å¹¶å‘é—®é¢˜ã€‚\n\n#### 4.3 å¯é‡å¤è¯»ï¼ˆRRï¼‰éš”ç¦»çº§åˆ«ï¼Œè§£å†³ä¸å¯é‡å¤è¯»é—®é¢˜çš„åˆ†æ\n\nåœ¨ RR éš”ç¦»çº§åˆ«ä¸‹ï¼Œæ˜¯å¦‚ä½•è§£å†³ä¸å¯é‡å¤è¯»é—®é¢˜çš„å‘¢ï¼Ÿæˆ‘ä»¬ä¸€èµ·å†æ¥çœ‹ä¸‹ï¼Œ\n\nè¿˜æ˜¯ 4.2 å°èŠ‚é‚£ä¸ªæµç¨‹ï¼Œè¿˜æ˜¯è¿™ä¸ªäº‹åŠ¡ A å’Œäº‹åŠ¡ Bï¼Œå¦‚ä¸‹ï¼š\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131811671.png\" alt=\"image-20220422131811671\" style=\"zoom:33%;\" />\n\n##### 4.3.1 ä¸åŒéš”ç¦»çº§åˆ«ä¸‹ï¼ŒRead viewçš„å·¥ä½œæ–¹å¼ä¸åŒ\n\nå®é™…ä¸Šï¼Œå„ç§äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸‹çš„ Read view å·¥ä½œæ–¹å¼ï¼Œæ˜¯ä¸ä¸€æ ·çš„ï¼ŒRR å¯ä»¥è§£å†³ä¸å¯é‡å¤è¯»é—®é¢˜ï¼Œå°±æ˜¯è·Ÿ**Read viewå·¥ä½œæ–¹å¼æœ‰å…³**ã€‚\n\n- åœ¨è¯»å·²æäº¤ï¼ˆRCï¼‰éš”ç¦»çº§åˆ«ä¸‹ï¼ŒåŒä¸€ä¸ªäº‹åŠ¡é‡Œé¢ï¼Œ**æ¯ä¸€æ¬¡æŸ¥è¯¢éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„Read Viewå‰¯æœ¬**ï¼Œè¿™æ ·å°±å¯èƒ½é€ æˆåŒä¸€ä¸ªäº‹åŠ¡é‡Œå‰åè¯»å–æ•°æ®å¯èƒ½ä¸ä¸€è‡´çš„é—®é¢˜ï¼ˆä¸å¯é‡å¤è¯»å¹¶å‘é—®é¢˜ï¼‰ã€‚\n\n| begin                               |                   |\n| ----------------------------------- | ----------------- |\n| select * from core_user where id =1 | ç”Ÿæˆä¸€ä¸ªRead View |\n| /                                   | /                 |\n| /                                   | /                 |\n| select * from core_user where id =1 | ç”Ÿæˆä¸€ä¸ªRead View |\n\n- åœ¨å¯é‡å¤è¯»ï¼ˆRRï¼‰éš”ç¦»çº§åˆ«ä¸‹ï¼Œ**ä¸€ä¸ªäº‹åŠ¡é‡Œåªä¼šè·å–ä¸€æ¬¡read view**ï¼Œéƒ½æ˜¯å‰¯æœ¬å…±ç”¨çš„ï¼Œä»è€Œä¿è¯æ¯æ¬¡æŸ¥è¯¢çš„æ•°æ®éƒ½æ˜¯ä¸€æ ·çš„ã€‚\n\n| begin                               |                       |\n| ----------------------------------- | --------------------- |\n| select * from core_user where id =1 | ç”Ÿæˆä¸€ä¸ªRead View     |\n| /                                   |                       |\n| /                                   |                       |\n| select * from core_user where id =1 | å…±ç”¨ä¸€ä¸ªRead Viewå‰¯æœ¬ |\n\n##### 4.3.2 å®ä¾‹åˆ†æ\n\næˆ‘ä»¬ç©¿è¶Šä¸‹ï¼Œå›åˆ°**åˆš4.2çš„ä¾‹å­**ï¼Œç„¶åæ‰§è¡Œç¬¬ 2 ä¸ªæŸ¥è¯¢çš„æ—¶å€™ï¼š\n\näº‹åŠ¡ A å†æ¬¡æ‰§è¡ŒæŸ¥è¯¢æ“ä½œï¼Œå¤ç”¨è€çš„ Read View å‰¯æœ¬ï¼ŒRead View å¯¹åº”çš„å€¼å¦‚ä¸‹\n\n| å˜é‡           | å€¼       |\n| -------------- | -------- |\n| m_ids          | 100ï¼Œ101 |\n| max_limit_id   | 102      |\n| min_limit_id   | 100      |\n| creator_trx_id | 100      |\n\nç„¶åå†æ¬¡å›åˆ°ç‰ˆæœ¬é“¾ï¼šä»ç‰ˆæœ¬é“¾ä¸­æŒ‘é€‰å¯è§çš„è®°å½•ï¼š\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131828812.png\" alt=\"image-20220422131828812\" style=\"zoom:33%;\" />\n\nä»å›¾å¯å¾—ï¼Œæœ€æ–°ç‰ˆæœ¬çš„åˆ— name çš„å†…å®¹æ˜¯`æ›¹æ“`ï¼Œè¯¥ç‰ˆæœ¬çš„`trx_id`å€¼ä¸º 101ã€‚å¼€å§‹æ‰§è¡Œ read view å¯è§æ€§è§„åˆ™æ ¡éªŒï¼š\n\n```\nmin_limit_id(100)=<trx_idï¼ˆ101ï¼‰<max_limit_idï¼ˆ102);\nå› ä¸ºm_ids{100,101}åŒ…å«trx_idï¼ˆ101ï¼‰ï¼Œ\nå¹¶ä¸”creator_trx_id (100) ä¸ç­‰äºtrx_idï¼ˆ101ï¼‰\n```\n\næ‰€ä»¥ï¼Œ`trx_id=101`è¿™ä¸ªè®°å½•ï¼Œå¯¹äºå½“å‰äº‹åŠ¡æ˜¯**ä¸å¯è§**çš„ã€‚è¿™æ—¶å€™å‘¢ï¼Œç‰ˆæœ¬é“¾`roll_pointer`è·³åˆ°ä¸‹ä¸€ä¸ªç‰ˆæœ¬ï¼Œ`trx_id=100`è¿™ä¸ªè®°å½•ï¼Œå†æ¬¡æ ¡éªŒæ˜¯å¦å¯è§ï¼š\n\n```\nmin_limit_id(100)=<trx_idï¼ˆ100ï¼‰< max_limit_idï¼ˆ102);\nå› ä¸ºm_ids{100,101}åŒ…å«trx_idï¼ˆ100ï¼‰ï¼Œ\nå¹¶ä¸”creator_trx_id (100) ç­‰äºtrx_idï¼ˆ100ï¼‰\n```\n\næ‰€ä»¥ï¼Œ`trx_id=100`è¿™ä¸ªè®°å½•ï¼Œå¯¹äºå½“å‰äº‹åŠ¡æ˜¯**å¯è§**çš„ã€‚å³åœ¨å¯é‡å¤è¯»ï¼ˆRRï¼‰éš”ç¦»çº§åˆ«ä¸‹ï¼Œå¤ç”¨è€çš„ Read View å‰¯æœ¬ï¼Œè§£å†³äº†**ä¸å¯é‡å¤è¯»**çš„é—®é¢˜ã€‚\n\n#### 4.4 MVCCæ˜¯å¦è§£å†³äº†å¹»è¯»é—®é¢˜å‘¢ï¼Ÿ\n\nå¯¹äºå¹»è¯»æ¥è¯´ï¼Œå­˜åœ¨å½“å‰è¯»å’Œå¿«ç…§è¯»çš„æƒ…å†µï¼š\n\n1. RR éš”ç¦»çº§åˆ«ä¸‹ä¸ºäº†è§£å†³å¹»è¯»é—®é¢˜ï¼š**å¿«ç…§è¯»ä¾é MVCCæ§åˆ¶ï¼Œå½“å‰è¯»é€šè¿‡é—´éš™é”è§£å†³**ï¼›\n2. é—´éš™é”å’Œè¡Œé”åˆç§° Next-Key Locksï¼Œæ¯ä¸ª Next-Key Locks æ˜¯å‰å¼€åé—­åŒºé—´ï¼›\n3. é—´éš™é”çš„å¼•å…¥ï¼Œå¯èƒ½ä¼šå¯¼è‡´åŒæ ·è¯­å¥é”ä½æ›´å¤§çš„èŒƒå›´ï¼Œå½±å“å¹¶å‘åº¦ã€‚\n\nä½œè€…ï¼šæ¡ç”°èºçš„å°ç”·å­©\n\né“¾æ¥ï¼šhttps://juejin.cn/post/7016165148020703246\n\næ¥æºï¼šç¨€åœŸæ˜é‡‘\n\nè‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚\n\n## MySQLé”ç¯‡\n\n### ä»€ä¹ˆæ˜¯é”ï¼ŸMySQL ä¸­æä¾›äº†å‡ ç±»é”ï¼Ÿ\n\né”æ˜¯å®ç°æ•°æ®åº“å¹¶å‘æ§åˆ¶çš„é‡è¦æ‰‹æ®µï¼Œå¯ä»¥ä¿è¯æ•°æ®åº“åœ¨å¤šäººåŒæ—¶æ“ä½œæ—¶èƒ½å¤Ÿæ­£å¸¸è¿è¡Œã€‚\n\næ’ä»–é”ï¼ˆå†™é”ï¼‰ï¼Œå…±äº«é”ï¼ˆè¯»é”ï¼‰\nä¹è§‚é”ï¼Œæ‚²è§‚é”\nå…¨å±€é”ï¼Œè¡¨é”ï¼Œè¡Œé”ï¼Œé¡µé”\n\n### ä»€ä¹ˆæ˜¯æ­»é”ï¼Ÿ\n\næ­»é”æ˜¯æŒ‡ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„è¿›ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå› äº‰å¤ºèµ„æºè€Œé€ æˆçš„ä¸€ç§äº’ç›¸ç­‰å¾…çš„ç°è±¡,è‹¥æ— å¤–åŠ›ä½œç”¨,å®ƒä»¬éƒ½å°†æ— æ³•æ¨è¿›ä¸‹å»ã€‚æ­¤æ—¶ç§°ç³»ç»Ÿå¤„äºæ­»é”çŠ¶æ€æˆ–ç³»ç»Ÿäº§ç”Ÿäº†æ­»é”ï¼Œè¿™äº›æ°¸è¿œåœ¨äº’ç›¸ç­‰å¾…çš„è¿‡ç¨‹ç§°ä¸ºæ­»é”ã€‚\n\n### å¦‚ä½•å¤„ç†æ­»é”ï¼Ÿ\n\nå¯¹å¾…æ­»é”å¸¸è§çš„ä¸¤ç§ç­–ç•¥ï¼š\n\n*   è®¾ç½®è¶…æ—¶æ—¶é—´\n\n*   å‘ç°æ­»é”ä¹‹åï¼Œä¸»åŠ¨å›æ»šæ­»é”ä¸­çš„æŸä¸€ä¸ªäº‹åŠ¡ï¼Œè®©å…¶å®ƒäº‹åŠ¡ç»§ç»­æ‰§è¡Œã€‚\n\n### å¦‚ä½•é¿å…æ­»é”ï¼Ÿ\n\nä½¿ç”¨ SELECT â€¦ FOR UPDATE è¯­å¥æ¥è·å–å¿…è¦çš„é”ã€‚\n\n### ä»€ä¹ˆæ˜¯å…¨å±€é”ï¼Ÿå®ƒçš„åº”ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ\n\nå…¨å±€é”å°±æ˜¯å¯¹æ•´ä¸ªæ•°æ®åº“å®ä¾‹åŠ é”ï¼Œå®ƒçš„å…¸å‹ä½¿ç”¨åœºæ™¯å°±æ˜¯åšå…¨åº“é€»è¾‘å¤‡ä»½ã€‚ è¿™ä¸ªå‘½ä»¤å¯ä»¥ä½¿æ•´ä¸ªåº“å¤„äºåªè¯»çŠ¶æ€ã€‚ä½¿ç”¨è¯¥å‘½ä»¤ä¹‹åï¼Œæ•°æ®æ›´æ–°è¯­å¥ã€æ•°æ®å®šä¹‰è¯­å¥ã€æ›´æ–°ç±»äº‹åŠ¡çš„æäº¤è¯­å¥ç­‰æ“ä½œéƒ½ä¼šè¢«é˜»å¡ã€‚\n\n### ä»€ä¹ˆæ˜¯å…±äº«é”ï¼Ÿ\n\nå…±äº«é”åˆç§°è¯»é” (read lock)ï¼Œæ˜¯è¯»å–æ“ä½œåˆ›å»ºçš„é”ã€‚å…¶ä»–ç”¨æˆ·å¯ä»¥å¹¶å‘è¯»å–æ•°æ®ï¼Œä½†ä»»ä½•äº‹åŠ¡éƒ½ä¸èƒ½å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ï¼ˆè·å–æ•°æ®ä¸Šçš„æ’ä»–é”ï¼‰ï¼Œç›´åˆ°å·²é‡Šæ”¾æ‰€æœ‰å…±äº«é”ã€‚å½“å¦‚æœäº‹åŠ¡å¯¹è¯»é”è¿›è¡Œä¿®æ”¹æ“ä½œï¼Œå¾ˆå¯èƒ½ä¼šé€ æˆæ­»é”ã€‚\n\n### ä»€ä¹ˆæ˜¯æ’å®ƒé”ï¼Ÿ\n\næ’ä»–é” exclusive lockï¼ˆä¹Ÿå« writer lockï¼‰åˆç§°å†™é”ã€‚\n\nè‹¥æŸä¸ªäº‹ç‰©å¯¹æŸä¸€è¡ŒåŠ ä¸Šäº†æ’ä»–é”ï¼Œåªèƒ½è¿™ä¸ªäº‹åŠ¡å¯¹å…¶è¿›è¡Œè¯»å†™ï¼Œåœ¨æ­¤äº‹åŠ¡ç»“æŸä¹‹å‰ï¼Œå…¶ä»–äº‹åŠ¡ä¸èƒ½å¯¹å…¶è¿›è¡ŒåŠ ä»»ä½•é”ï¼Œå…¶ä»–è¿›ç¨‹å¯ä»¥è¯»å–,ä¸èƒ½è¿›è¡Œå†™æ“ä½œï¼Œéœ€ç­‰å¾…å…¶é‡Šæ”¾ã€‚\n\næ’å®ƒé”æ˜¯æ‚²è§‚é”çš„ä¸€ç§å®ç°ï¼Œåœ¨ä¸Šé¢æ‚²è§‚é”ä¹Ÿä»‹ç»è¿‡ã€‚\n\n### ä½¿ç”¨å…¨å±€é”ä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜ï¼Ÿ\n\nå¦‚æœåœ¨ä¸»åº“å¤‡ä»½ï¼Œåœ¨å¤‡ä»½æœŸé—´ä¸èƒ½æ›´æ–°ï¼Œä¸šåŠ¡åœæ‘†ï¼Œæ‰€ä»¥æ›´æ–°ä¸šåŠ¡ä¼šå¤„äºç­‰å¾…çŠ¶æ€ã€‚\n\nå¦‚æœåœ¨ä»åº“å¤‡ä»½ï¼Œåœ¨å¤‡ä»½æœŸé—´ä¸èƒ½æ‰§è¡Œä¸»åº“åŒæ­¥çš„ binlogï¼Œå¯¼è‡´ä¸»ä»å»¶è¿Ÿã€‚\n\nå¦‚æœä½¿ç”¨å…¨å±€é”è¿›è¡Œé€»è¾‘å¤‡ä»½å°±ä¼šè®©æ•´ä¸ªåº“æˆä¸ºåªè¯»çŠ¶æ€ï¼Œå¹¸å¥½å®˜æ–¹æ¨å‡ºäº†ä¸€ä¸ªé€»è¾‘å¤‡ä»½å·¥å…· MySQL dump æ¥è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œåªéœ€è¦åœ¨ä½¿ç”¨ MySQLdump æ—¶ï¼Œä½¿ç”¨å‚æ•° single-transaction å°±ä¼šåœ¨å¯¼å…¥æ•°æ®ä¹‹å‰å¯åŠ¨ä¸€ä¸ªäº‹åŠ¡æ¥ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ï¼Œå¹¶ä¸”è¿™ä¸ªè¿‡ç¨‹æ˜¯æ”¯æŒæ•°æ®æ›´æ–°æ“ä½œçš„ã€‚\n\n### æ‚²è§‚é”å’Œä¹è§‚é”æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\né¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¾ˆæ‚²è§‚ï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¼šä¿®æ”¹ï¼Œæ‰€ä»¥æ¯æ¬¡åœ¨æ‹¿æ•°æ®çš„æ—¶å€™éƒ½ä¼šä¸Šé”ï¼Œè¿™æ ·åˆ«äººæƒ³æ‹¿è¿™ä¸ªæ•°æ®å°±ä¼š block ç›´åˆ°å®ƒæ‹¿åˆ°é”ã€‚æ­£å› ä¸ºå¦‚æ­¤ï¼Œæ‚²è§‚é”éœ€è¦è€—è´¹è¾ƒå¤šçš„æ—¶é—´ï¼Œå¦å¤–ä¸ä¹è§‚é”ç›¸å¯¹åº”çš„ï¼Œæ‚²è§‚é”æ˜¯ç”±æ•°æ®åº“è‡ªå·±å®ç°äº†çš„ï¼Œè¦ç”¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç›´æ¥è°ƒç”¨æ•°æ®åº“çš„ç›¸å…³è¯­å¥å°±å¯ä»¥äº†ã€‚\n\nè¯´åˆ°è¿™é‡Œï¼Œç”±æ‚²è§‚é”æ¶‰åŠåˆ°çš„å¦å¤–ä¸¤ä¸ªé”æ¦‚å¿µå°±å‡ºæ¥äº†ï¼Œå®ƒä»¬å°±æ˜¯å…±äº«é”ä¸æ’å®ƒé”ã€‚å…±äº«é”å’Œæ’å®ƒé”æ˜¯æ‚²è§‚é”çš„ä¸åŒçš„å®ç°ï¼Œå®ƒä¿©éƒ½å±äºæ‚²è§‚é”çš„èŒƒç•´ã€‚\n\n**ä¹è§‚é”æ˜¯ç”¨æ•°æ®ç‰ˆæœ¬ï¼ˆVersionï¼‰è®°å½•æœºåˆ¶å®ç°**ï¼Œè¿™æ˜¯ä¹è§‚é”æœ€å¸¸ç”¨çš„ä¸€ç§å®ç°æ–¹å¼ã€‚ä½•è°“æ•°æ®ç‰ˆæœ¬ï¼Ÿå³ä¸ºæ•°æ®å¢åŠ ä¸€ä¸ªç‰ˆæœ¬æ ‡è¯†ï¼Œä¸€èˆ¬æ˜¯é€šè¿‡ä¸ºæ•°æ®åº“è¡¨å¢åŠ ä¸€ä¸ªæ•°å­—ç±»å‹çš„ version å­—æ®µæ¥å®ç°ã€‚å½“è¯»å–æ•°æ®æ—¶ï¼Œå°† version å­—æ®µçš„å€¼ä¸€åŒè¯»å‡ºï¼Œæ•°æ®æ¯æ›´æ–°ä¸€æ¬¡ï¼Œå¯¹æ­¤ version å€¼åŠ  1ã€‚å½“æˆ‘ä»¬æäº¤æ›´æ–°çš„æ—¶å€™ï¼Œåˆ¤æ–­æ•°æ®åº“è¡¨å¯¹åº”è®°å½•çš„å½“å‰ç‰ˆæœ¬ä¿¡æ¯ä¸ç¬¬ä¸€æ¬¡å–å‡ºæ¥çš„ version å€¼è¿›è¡Œæ¯”å¯¹ï¼Œå¦‚æœæ•°æ®åº“è¡¨å½“å‰ç‰ˆæœ¬å·ä¸ç¬¬ä¸€æ¬¡å–å‡ºæ¥çš„ version å€¼ç›¸ç­‰ï¼Œåˆ™äºˆä»¥æ›´æ–°ï¼Œå¦åˆ™è®¤ä¸ºæ˜¯è¿‡æœŸæ•°æ®ã€‚\n\n### ä¹è§‚é”æœ‰ä»€ä¹ˆä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Ÿ\n\nå› ä¸ºæ²¡æœ‰åŠ é”æ‰€ä»¥ä¹è§‚é”çš„ä¼˜ç‚¹å°±æ˜¯æ‰§è¡Œæ€§èƒ½é«˜ã€‚å®ƒçš„ç¼ºç‚¹å°±æ˜¯æœ‰å¯èƒ½äº§ç”Ÿ ABA çš„é—®é¢˜ï¼ŒABA é—®é¢˜æŒ‡çš„æ˜¯æœ‰ä¸€ä¸ªå˜é‡ V åˆæ¬¡è¯»å–çš„æ—¶å€™æ˜¯ A å€¼ï¼Œå¹¶ä¸”åœ¨å‡†å¤‡èµ‹å€¼çš„æ—¶å€™æ£€æŸ¥åˆ°å®ƒä»ç„¶æ˜¯ A å€¼ï¼Œä¼šè¯¯ä»¥ä¸ºæ²¡æœ‰è¢«ä¿®æ”¹ä¼šæ­£å¸¸çš„æ‰§è¡Œä¿®æ”¹æ“ä½œï¼Œå®é™…ä¸Šè¿™æ®µæ—¶é—´å®ƒçš„å€¼å¯èƒ½è¢«æ”¹äº†å…¶ä»–å€¼ï¼Œä¹‹ååˆæ”¹å›ä¸º A å€¼ï¼Œè¿™ä¸ªé—®é¢˜è¢«ç§°ä¸º ABA é—®é¢˜ã€‚\n\n### â­InnoDB å­˜å‚¨å¼•æ“æœ‰å‡ ç§é”ç®—æ³•ï¼Ÿ\n\n*   Record Lock â€” å•ä¸ªè¡Œè®°å½•ä¸Šçš„é”ï¼›\n\n*   Gap Lock â€” é—´éš™é”ï¼Œé”å®šä¸€ä¸ªèŒƒå›´ï¼Œä¸åŒ…æ‹¬è®°å½•æœ¬èº«ï¼›\n\n*   Next-Key Lockï¼ˆåŒ…å«è¡Œé”å’Œé—´éš™é”ï¼‰ â€” é”å®šä¸€ä¸ªèŒƒå›´ï¼ŒåŒ…æ‹¬è®°å½•æœ¬èº«ã€‚\n\n### InnoDB å¦‚ä½•å®ç°è¡Œé”ï¼Ÿ\n\nå…±äº«é”ï¼š**in share mode**\n\næ’ä»–é”ï¼š**for update**\n\n### ä¼˜åŒ–é”æ–¹é¢ä½ æœ‰ä»€ä¹ˆå»ºè®®ï¼Ÿ\n\n*   å°½é‡ä½¿ç”¨è¾ƒä½çš„éš”ç¦»çº§åˆ«ã€‚\n*   ç²¾å¿ƒè®¾è®¡ç´¢å¼•ï¼Œ å¹¶å°½é‡ä½¿ç”¨ç´¢å¼•è®¿é—®æ•°æ®ï¼Œ ä½¿åŠ é”æ›´ç²¾ç¡®ï¼Œ ä»è€Œå‡å°‘é”å†²çªçš„æœºä¼šã€‚\n*   é€‰æ‹©åˆç†çš„äº‹åŠ¡å¤§å°ï¼Œå°äº‹åŠ¡å‘ç”Ÿé”å†²çªçš„å‡ ç‡ä¹Ÿæ›´å°ã€‚\n*   ç»™è®°å½•é›†æ˜¾ç¤ºåŠ é”æ—¶ï¼Œæœ€å¥½ä¸€æ¬¡æ€§è¯·æ±‚è¶³å¤Ÿçº§åˆ«çš„é”ã€‚æ¯”å¦‚è¦ä¿®æ”¹æ•°æ®çš„è¯ï¼Œæœ€å¥½ç›´æ¥ç”³è¯·æ’ä»–é”ï¼Œè€Œä¸æ˜¯å…ˆç”³è¯·å…±äº«é”ï¼Œä¿®æ”¹æ—¶å†è¯·æ±‚æ’ä»–é”ï¼Œè¿™æ ·å®¹æ˜“äº§ç”Ÿæ­»é”ã€‚\n*   ä¸åŒçš„ç¨‹åºè®¿é—®ä¸€ç»„è¡¨æ—¶ï¼Œåº”å°½é‡çº¦å®šä»¥ç›¸åŒçš„é¡ºåºè®¿é—®å„è¡¨ï¼Œå¯¹ä¸€ä¸ªè¡¨è€Œè¨€ï¼Œå°½å¯èƒ½ä»¥å›ºå®šçš„é¡ºåºå­˜å–è¡¨ä¸­çš„è¡Œã€‚è¿™æ ·å¯ä»¥å¤§å¤§å‡å°‘æ­»é”çš„æœºä¼šã€‚\n*   å°½é‡ç”¨ç›¸ç­‰æ¡ä»¶è®¿é—®æ•°æ®ï¼Œè¿™æ ·å¯ä»¥é¿å…é—´éš™é”å¯¹å¹¶å‘æ’å…¥çš„å½±å“ã€‚\n*   ä¸è¦ç”³è¯·è¶…è¿‡å®é™…éœ€è¦çš„é”çº§åˆ«ã€‚\n*   é™¤éå¿…é¡»ï¼ŒæŸ¥è¯¢æ—¶ä¸è¦æ˜¾ç¤ºåŠ é”ã€‚ MySQL çš„ MVCC å¯ä»¥å®ç°äº‹åŠ¡ä¸­çš„æŸ¥è¯¢ä¸ç”¨åŠ é”ï¼Œä¼˜åŒ–äº‹åŠ¡æ€§èƒ½ï¼›MVCC åªåœ¨ COMMITTED READï¼ˆè¯»æäº¤ï¼‰å’Œ REPEATABLE READï¼ˆå¯é‡å¤è¯»ï¼‰ä¸¤ç§éš”ç¦»çº§åˆ«ä¸‹å·¥ä½œã€‚\n*   å¯¹äºä¸€äº›ç‰¹å®šçš„äº‹åŠ¡ï¼Œå¯ä»¥ä½¿ç”¨è¡¨é”æ¥æé«˜å¤„ç†é€Ÿåº¦æˆ–å‡å°‘æ­»é”çš„å¯èƒ½ã€‚\n\n### MySQL ä¸­æœ‰å“ªå‡ ç§é”ï¼Ÿ\n\n**1ã€è¡¨çº§é”ï¼š** å¼€é”€å°ï¼Œ åŠ é”å¿«ï¼› ä¸ä¼šå‡ºç°æ­»é”ï¼› é”å®šç²’åº¦å¤§ï¼Œ å‘ç”Ÿé”å†²çªçš„æ¦‚ç‡æœ€é«˜ï¼Œ å¹¶å‘åº¦æœ€ä½ã€‚\n\n**2ã€è¡Œçº§é”ï¼š**  å¼€é”€å¤§ï¼Œ åŠ é”æ…¢ï¼› ä¼šå‡ºç°æ­»é”ï¼› é”å®šç²’åº¦æœ€å°ï¼Œ å‘ç”Ÿé”å†²çªçš„æ¦‚ç‡æœ€ä½ï¼Œ å¹¶å‘åº¦ä¹Ÿæœ€é«˜ã€‚\n\n**3ã€é¡µé”ï¼š**  å¼€é”€å’ŒåŠ é”æ—¶é—´ç•Œäºè¡¨é”å’Œè¡Œé”ä¹‹é—´ï¼› ä¼šå‡ºç°æ­»é”ï¼› é”å®šç²’åº¦ç•Œäºè¡¨é”å’Œè¡Œé”ä¹‹é—´ï¼Œ å¹¶å‘åº¦ä¸€èˆ¬ã€‚\n\n\n\n### é”æœºåˆ¶ä¸InnoDBé”ç®—æ³•\n\n**MyISAMå’ŒInnoDBå­˜å‚¨å¼•æ“ä½¿ç”¨çš„é”ï¼š**\n\n- MyISAM é‡‡ç”¨è¡¨çº§é”(table-level locking)ã€‚\n- InnoDB æ”¯æŒè¡Œçº§é”(row-level locking)å’Œè¡¨çº§é”,é»˜è®¤ä¸ºè¡Œçº§é”\n\n**è¡¨çº§é”å’Œè¡Œçº§é”å¯¹æ¯”ï¼š**\n\n- **è¡¨çº§é”ï¼š** MySQL ä¸­é”å®š **ç²’åº¦æœ€å¤§** çš„ä¸€ç§é”ï¼Œå¯¹å½“å‰æ“ä½œçš„æ•´å¼ è¡¨åŠ é”ï¼Œå®ç°ç®€å•ï¼Œèµ„æºæ¶ˆè€—ä¹Ÿæ¯”è¾ƒå°‘ï¼ŒåŠ é”å¿«ï¼Œä¸ä¼šå‡ºç°æ­»é”ã€‚å…¶é”å®šç²’åº¦æœ€å¤§ï¼Œè§¦å‘é”å†²çªçš„æ¦‚ç‡æœ€é«˜ï¼Œå¹¶å‘åº¦æœ€ä½ï¼ŒMyISAM å’Œ InnoDB å¼•æ“éƒ½æ”¯æŒè¡¨çº§é”ã€‚\n\n- **è¡Œçº§é”ï¼š** MySQL ä¸­é”å®š **ç²’åº¦æœ€å°** çš„ä¸€ç§é”ï¼Œåªé’ˆå¯¹å½“å‰æ“ä½œçš„è¡Œè¿›è¡ŒåŠ é”ã€‚ è¡Œçº§é”èƒ½å¤§å¤§å‡å°‘æ•°æ®åº“æ“ä½œçš„å†²çªã€‚å…¶åŠ é”ç²’åº¦æœ€å°ï¼Œå¹¶å‘åº¦é«˜ï¼Œä½†åŠ é”çš„å¼€é”€ä¹Ÿæœ€å¤§ï¼ŒåŠ é”æ…¢ï¼Œä¼šå‡ºç°æ­»é”ã€‚\n\n### é”çš„ä¼˜åŒ–ç­–ç•¥\n\n**1ã€** è¯»å†™åˆ†ç¦»\n\n**2ã€** åˆ†æ®µåŠ é”\n\n**3ã€** å‡å°‘é”æŒæœ‰çš„æ—¶é—´\n\nå¤šä¸ªçº¿ç¨‹å°½é‡ä»¥ç›¸åŒçš„é¡ºåºå»è·å–èµ„æº\n\nä¸èƒ½å°†é”çš„ç²’åº¦è¿‡äºç»†åŒ–ï¼Œ ä¸ç„¶å¯èƒ½ä¼šå‡ºç°çº¿ç¨‹çš„åŠ é”å’Œé‡Šæ”¾æ¬¡æ•°è¿‡å¤šï¼Œ åè€Œæ•ˆç‡ä¸å¦‚ä¸€æ¬¡åŠ ä¸€æŠŠå¤§é”ã€‚\n\n## MySQLæ—¥å¿—ç¯‡\n\n### MySQL æœ‰å“ªäº›é‡è¦çš„æ—¥å¿—æ–‡ä»¶ï¼Ÿ  \n\nMySQL ä¸­çš„é‡è¦æ—¥å¿—åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªï¼š\n\n**â‘  é”™è¯¯æ—¥å¿—ï¼š**ç”¨æ¥è®°å½• MySQL æœåŠ¡å™¨è¿è¡Œè¿‡ç¨‹ä¸­çš„é”™è¯¯ä¿¡æ¯\n\n**â‘¡ æŸ¥è¯¢æ—¥å¿—**ï¼šæŸ¥è¯¢æ—¥å¿—åœ¨ MySQL ä¸­è¢«ç§°ä¸º general log(é€šç”¨æ—¥å¿—)ï¼ŒæŸ¥è¯¢æ—¥å¿—é‡Œçš„å†…å®¹ä¸è¦è¢«â€œæŸ¥è¯¢æ—¥å¿—â€è¯¯å¯¼ï¼Œè®¤ä¸ºé‡Œé¢åªå­˜å‚¨ select è¯­å¥ï¼Œå…¶å®ä¸ç„¶ï¼ŒæŸ¥è¯¢æ—¥å¿—é‡Œé¢è®°å½•äº†æ•°æ®åº“æ‰§è¡Œçš„æ‰€æœ‰å‘½ä»¤ï¼Œä¸ç®¡è¯­å¥æ˜¯å¦æ­£ç¡®ï¼Œéƒ½ä¼šè¢«è®°å½•ï¼Œå…·ä½“åŸå› å¦‚ä¸‹:\n\n*   insert æŸ¥è¯¢ä¸ºäº†é¿å…æ•°æ®å†²çªï¼Œå¦‚æœæ­¤å‰æ’å…¥è¿‡æ•°æ®ï¼Œå½“å‰æ’å…¥çš„æ•°æ®å¦‚æœè·Ÿä¸»é”®æˆ–å”¯ä¸€é”®çš„æ•°æ®é‡å¤é‚£è‚¯å®šä¼šæŠ¥é”™ï¼›\n\n*   update æ—¶ä¹Ÿä¼šæŸ¥è¯¢å› ä¸ºæ›´æ–°çš„æ—¶å€™å¾ˆå¯èƒ½ä¼šæ›´æ–°æŸä¸€å—æ•°æ®ï¼›\n\n*   delete æŸ¥è¯¢ï¼Œåªåˆ é™¤ç¬¦åˆæ¡ä»¶çš„æ•°æ®ï¼›\n\nå› æ­¤éƒ½ä¼šäº§ç”Ÿæ—¥å¿—ï¼Œåœ¨å¹¶å‘æ“ä½œéå¸¸å¤šçš„åœºæ™¯ä¸‹ï¼ŒæŸ¥è¯¢ä¿¡æ¯ä¼šéå¸¸å¤šï¼Œé‚£ä¹ˆå¦‚æœéƒ½è®°å½•ä¸‹æ¥ä¼šå¯¼è‡´ IO éå¸¸å¤§ï¼Œå½±å“ MySQL æ€§èƒ½ï¼Œå› æ­¤å¦‚æœä¸æ˜¯åœ¨è°ƒè¯•ç¯å¢ƒä¸‹ï¼Œæ˜¯ä¸å»ºè®®å¼€å¯æŸ¥è¯¢æ—¥å¿—åŠŸèƒ½çš„ã€‚\n\næŸ¥è¯¢æ—¥å¿—çš„å¼€å¯æœ‰åŠ©äºå¸®åŠ©æˆ‘ä»¬åˆ†æå“ªäº›è¯­å¥æ‰§è¡Œå¯†é›†ï¼Œæ‰§è¡Œå¯†é›†çš„ select è¯­å¥å¯¹åº”çš„æ•°æ®æ˜¯å¦èƒ½å¤Ÿè¢«ç¼“å­˜ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥å¸®åŠ©æˆ‘ä»¬åˆ†æé—®é¢˜ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µæ¥å†³å®šæ˜¯å¦å¼€å¯æŸ¥è¯¢æ—¥å¿—ã€‚\n\n**â‘¢ æ…¢æ—¥å¿—**ï¼šæ…¢æŸ¥è¯¢ä¼šå¯¼è‡´ CPUã€IOPSã€å†…å­˜æ¶ˆè€—è¿‡é«˜ï¼Œå½“æ•°æ®åº“é‡åˆ°æ€§èƒ½ç“¶é¢ˆæ—¶ï¼Œå¤§éƒ¨åˆ†æ—¶é—´éƒ½æ˜¯ç”±äºæ…¢æŸ¥è¯¢å¯¼è‡´çš„ã€‚å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œå¯ä»¥è®© MySQL è®°å½•ä¸‹æŸ¥è¯¢è¶…è¿‡æŒ‡å®šæ—¶é—´çš„è¯­å¥ï¼Œä¹‹åè¿ç»´äººå‘˜é€šè¿‡å®šä½åˆ†æï¼Œèƒ½å¤Ÿå¾ˆå¥½çš„ä¼˜åŒ–æ•°æ®åº“æ€§èƒ½ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ…¢æŸ¥è¯¢æ—¥å¿—æ˜¯ä¸å¼€å¯çš„ï¼Œåªæœ‰æ‰‹åŠ¨å¼€å¯äº†ï¼Œæ…¢æŸ¥è¯¢æ‰ä¼šè¢«è®°å½•åˆ°æ…¢æŸ¥è¯¢æ—¥å¿—ä¸­ã€‚ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è®°å½•å½“å‰æ•°æ®åº“çš„æ…¢æŸ¥è¯¢è¯­å¥ï¼š\n\n```\nset global slowquerylog='ON';\n```\n\nä½¿ç”¨ set global slow*query*log='ON' å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œåªæ˜¯å¯¹å½“å‰æ•°æ®åº“æœ‰æ•ˆï¼Œå¦‚æœ MySQL æ•°æ®åº“é‡å¯åå°±ä¼šå¤±æ•ˆã€‚æ‰€ä»¥å¦‚æœè¦æ°¸ä¹…ç”Ÿæ•ˆï¼Œå°±è¦ä¿®æ”¹é…ç½®æ–‡ä»¶ my.cnfï¼Œè®¾ç½® slow*query*log=1 å¹¶é‡å¯ MySQL æœåŠ¡å™¨ã€‚\n\n**â‘£ redo logï¼ˆé‡åšæ—¥å¿—ï¼‰**ï¼šä¸ºäº†æœ€å¤§ç¨‹åº¦çš„é¿å…æ•°æ®å†™å…¥æ—¶ï¼Œå› ä¸º IO ç“¶é¢ˆé€ æˆçš„æ€§èƒ½é—®é¢˜ï¼ŒMySQL é‡‡ç”¨äº†è¿™æ ·ä¸€ç§ç¼“å­˜æœºåˆ¶ï¼Œå…ˆå°†æ•°æ®å†™å…¥å†…å­˜ä¸­ï¼Œå†æ‰¹é‡æŠŠå†…å­˜ä¸­çš„æ•°æ®ç»Ÿä¸€åˆ·å›ç£ç›˜ã€‚ä¸ºäº†é¿å…å°†æ•°æ®åˆ·å›ç£ç›˜è¿‡ç¨‹ä¸­ï¼Œå› ä¸ºæ‰ç”µæˆ–ç³»ç»Ÿæ•…éšœå¸¦æ¥çš„æ•°æ®ä¸¢å¤±é—®é¢˜ï¼ŒInnoDB é‡‡ç”¨ redo log æ¥è§£å†³æ­¤é—®é¢˜ã€‚\n\n**â‘¤ undo logï¼ˆå›æ»šæ—¥å¿—ï¼‰**ï¼šç”¨äºå­˜å‚¨æ—¥å¿—è¢«ä¿®æ”¹å‰çš„å€¼ï¼Œä»è€Œä¿è¯å¦‚æœä¿®æ”¹å‡ºç°å¼‚å¸¸ï¼Œå¯ä»¥ä½¿ç”¨ undo log æ—¥å¿—æ¥å®ç°å›æ»šæ“ä½œã€‚ undo log å’Œ redo log è®°å½•ç‰©ç†æ—¥å¿—ä¸ä¸€æ ·ï¼Œå®ƒæ˜¯é€»è¾‘æ—¥å¿—ï¼Œå¯ä»¥è®¤ä¸ºå½“ delete ä¸€æ¡è®°å½•æ—¶ï¼Œundo log ä¸­ä¼šè®°å½•ä¸€æ¡å¯¹åº”çš„ insert è®°å½•ï¼Œåä¹‹äº¦ç„¶ï¼Œå½“ update ä¸€æ¡è®°å½•æ—¶ï¼Œå®ƒè®°å½•ä¸€æ¡å¯¹åº”ç›¸åçš„ update è®°å½•ï¼Œå½“æ‰§è¡Œ rollback æ—¶ï¼Œå°±å¯ä»¥ä» undo log ä¸­çš„é€»è¾‘è®°å½•è¯»å–åˆ°ç›¸åº”çš„å†…å®¹å¹¶è¿›è¡Œå›æ»šã€‚\n\n**â‘¥ bin logï¼ˆäºŒè¿›åˆ¶æ—¥å¿—ï¼‰**ï¼šæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸»è¦**è®°å½•äº†å¯¹ MySQL æ•°æ®åº“æ‰§è¡Œæ›´æ”¹çš„æ‰€æœ‰æ“ä½œ**ï¼Œæ¯”å¦‚ï¼ŒCREATEã€ALTER TABLE ç­‰ï¼Œä»¥åŠè¡¨æ•°æ®ä¿®æ”¹ï¼Œæ¯”å¦‚ï¼ŒINSERTã€UPDATEã€DELETE çš„æ‰€æœ‰æ“ä½œï¼Œä¸è®°å½• SELECTã€SHOW ç­‰é‚£äº›ä¸ä¿®æ”¹æ•°æ®æˆ–æ•°æ®åº“ç»“æ„çš„ SQL è¯­å¥ã€‚\n\nbinlog çš„ä½œç”¨å¦‚ä¸‹ï¼š\n\n*   æ¢å¤ï¼ˆrecoveryï¼‰ï¼šæŸäº›æ•°æ®çš„æ¢å¤éœ€è¦äºŒè¿›åˆ¶æ—¥å¿—ã€‚æ¯”å¦‚ï¼Œåœ¨ä¸€ä¸ªæ•°æ®åº“å…¨å¤‡æ–‡ä»¶æ¢å¤åï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡äºŒè¿›åˆ¶æ—¥å¿—è¿›è¡Œ point-in-time çš„æ¢å¤ï¼›\n\n*   å¤åˆ¶ï¼ˆreplicationï¼‰ï¼šå…¶åŸç†ä¸æ¢å¤ç±»ä¼¼ï¼Œé€šè¿‡å¤åˆ¶å’Œæ‰§è¡ŒäºŒè¿›åˆ¶æ—¥å¿—ä½¿ä¸€å°è¿œç¨‹çš„ MySQL æ•°æ®åº“ï¼ˆä¸€èˆ¬ç§°ä¸º slave æˆ–è€… standbyï¼‰ä¸ä¸€å° MySQL æ•°æ®åº“ï¼ˆä¸€èˆ¬ç§°ä¸º master æˆ–è€… primaryï¼‰è¿›è¡Œå®æ—¶åŒæ­¥ï¼›\n\n*   å®¡è®¡ï¼ˆauditï¼‰ï¼šç”¨æˆ·å¯ä»¥é€šè¿‡äºŒè¿›åˆ¶æ—¥å¿—ä¸­çš„ä¿¡æ¯æ¥è¿›è¡Œå®¡è®¡ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰å¯¹æ•°æ®åº“è¿›è¡Œæ³¨å…¥æ”»å‡»ã€‚\n\né™¤äº†ä¸Šé¢ä»‹ç»çš„å‡ ä¸ªä½œç”¨å¤–ï¼Œbinlog å¯¹äºäº‹åŠ¡å­˜å‚¨å¼•æ“çš„å´©æºƒæ¢å¤ä¹Ÿæœ‰éå¸¸é‡è¦çš„ä½œç”¨ï¼Œåœ¨å¼€å¯ binlog çš„æƒ…å†µä¸‹ï¼Œä¸ºäº†ä¿è¯ binlog ä¸ redo çš„ä¸€è‡´æ€§ï¼ŒMySQL å°†é‡‡ç”¨äº‹åŠ¡çš„ä¸¤é˜¶æ®µæäº¤åè®®ã€‚å½“ MySQL ç³»ç»Ÿå‘ç”Ÿå´©æºƒæ—¶ï¼Œäº‹åŠ¡åœ¨å­˜å‚¨å¼•æ“å†…éƒ¨çš„çŠ¶æ€å¯èƒ½ä¸º preparedï¼ˆå‡†å¤‡çŠ¶æ€ï¼‰å’Œ commitï¼ˆæäº¤çŠ¶æ€ï¼‰ä¸¤ç§ï¼Œå¯¹äº prepared çŠ¶æ€çš„äº‹åŠ¡ï¼Œæ˜¯è¿›è¡Œæäº¤æ“ä½œè¿˜æ˜¯è¿›è¡Œå›æ»šæ“ä½œï¼Œè¿™æ—¶éœ€è¦å‚è€ƒ binlogï¼Œå¦‚æœäº‹åŠ¡åœ¨ binlog ä¸­å­˜åœ¨ï¼Œé‚£ä¹ˆå°†å…¶æäº¤ï¼›å¦‚æœä¸åœ¨ binlog ä¸­å­˜åœ¨ï¼Œé‚£ä¹ˆå°†å…¶å›æ»šï¼Œè¿™æ ·å°±ä¿è¯äº†æ•°æ®åœ¨ä¸»åº“å’Œä»åº“ä¹‹é—´çš„ä¸€è‡´æ€§ã€‚\n\nbinlog é»˜è®¤æ˜¯å…³é—­çŠ¶æ€ï¼Œå¯ä»¥åœ¨ MySQL é…ç½®æ–‡ä»¶ï¼ˆmy.cnfï¼‰ä¸­é€šè¿‡é…ç½®å‚æ•° log-bin = [base-name] å¼€å¯è®°å½• binlog æ—¥å¿—ï¼Œå¦‚æœä¸æŒ‡å®š base-nameï¼Œåˆ™é»˜è®¤äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶åä¸ºä¸»æœºåï¼Œå¹¶ä»¥è‡ªå¢çš„æ•°å­—ä½œä¸ºåç¼€ï¼Œæ¯”å¦‚ï¼šmysql-bin.000001ï¼Œæ‰€åœ¨ç›®å½•ä¸ºæ•°æ®åº“æ‰€åœ¨ç›®å½•ï¼ˆdatadirï¼‰ã€‚\n\né€šè¿‡ä»¥ä¸‹å‘½ä»¤æ¥æŸ¥è¯¢ binlog æ˜¯å¦å¼€å¯ï¼š\n\n```\nshow variables like 'log_%'; \n```\n\nbinlog æ ¼å¼åˆ†ä¸º: STATEMENTã€ROW å’Œ MIXED ä¸‰ç§ï¼š\n\n*   STATEMENT æ ¼å¼çš„ binlog è®°å½•çš„æ˜¯æ•°æ®åº“ä¸Šæ‰§è¡Œçš„åŸç”Ÿ SQL è¯­å¥ã€‚è¿™ç§æ ¼å¼çš„ä¼˜ç‚¹æ˜¯ç®€å•ï¼Œç®€å•åœ°è®°å½•å’Œæ‰§è¡Œè¿™äº›è¯­å¥ï¼Œèƒ½å¤Ÿè®©ä¸»å¤‡ä¿æŒåŒæ­¥ï¼Œåœ¨ä¸»æœåŠ¡å™¨ä¸Šæ‰§è¡Œçš„ SQL è¯­å¥ï¼Œåœ¨ä»æœåŠ¡å™¨ä¸Šæ‰§è¡ŒåŒæ ·çš„è¯­å¥ã€‚å¦ä¸€ä¸ªå¥½å¤„æ˜¯äºŒè¿›åˆ¶æ—¥å¿—é‡Œçš„æ—¶é—´æ›´åŠ ç´§å‡‘ï¼Œæ‰€ä»¥ç›¸å¯¹è€Œè¨€ï¼ŒåŸºäºè¯­å¥çš„å¤åˆ¶æ¨¡å¼ä¸ä¼šä½¿ç”¨å¤ªå¤šå¸¦å®½ï¼ŒåŒæ—¶ä¹ŸèŠ‚çº¦ç£ç›˜ç©ºé—´ã€‚å¹¶ä¸”é€šè¿‡ mysqlbinlog å·¥å…·å®¹æ˜“è¯»æ‡‚å…¶ä¸­çš„å†…å®¹ã€‚ç¼ºç‚¹å°±æ˜¯åŒä¸€æ¡ SQL åœ¨ä¸»åº“å’Œä»åº“ä¸Šæ‰§è¡Œçš„æ—¶é—´å¯èƒ½ç¨å¾®æˆ–å¾ˆå¤§ä¸ç›¸åŒï¼Œå› æ­¤åœ¨ä¼ è¾“çš„äºŒè¿›åˆ¶æ—¥å¿—ä¸­ï¼Œé™¤äº†æŸ¥è¯¢è¯­å¥ï¼Œè¿˜åŒ…æ‹¬äº†ä¸€äº›å…ƒæ•°æ®ä¿¡æ¯ï¼Œå¦‚å½“å‰çš„æ—¶é—´æˆ³ã€‚å³ä¾¿å¦‚æ­¤ï¼Œè¿˜å­˜åœ¨ç€ä¸€äº›æ— æ³•è¢«æ­£ç¡®å¤åˆ¶çš„ SQLã€‚æ¯”å¦‚ï¼Œä½¿ç”¨ INSERT INTO TB1 VALUE(CUURENT_DATE()) è¿™ä¸€æ¡ä½¿ç”¨å‡½æ•°çš„è¯­å¥æ’å…¥çš„æ•°æ®å¤åˆ¶åˆ°å½“å‰ä»æœåŠ¡å™¨ä¸Šæ¥å°±ä¼šå‘ç”Ÿå˜åŒ–ï¼Œå­˜å‚¨è¿‡ç¨‹å’Œè§¦å‘å™¨åœ¨ä½¿ç”¨åŸºäºè¯­å¥çš„å¤åˆ¶æ¨¡å¼æ—¶ä¹Ÿå¯èƒ½å­˜åœ¨é—®é¢˜ï¼›å¦å¤–ä¸€ä¸ªé—®é¢˜å°±æ˜¯åŸºäºè¯­å¥çš„å¤åˆ¶å¿…é¡»æ˜¯ä¸²è¡ŒåŒ–çš„ï¼Œæ¯”å¦‚ï¼šInnoDB çš„ next-key é”ç­‰ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„å­˜å‚¨å¼•æ“éƒ½æ”¯æŒåŸºäºè¯­å¥çš„å¤åˆ¶ï¼›\n\n*   ROW æ ¼å¼æ˜¯ä» MySQL 5.1 å¼€å§‹æ”¯æŒåŸºäºè¡Œçš„å¤åˆ¶ï¼Œä¹Ÿå°±æ˜¯åŸºäºæ•°æ®çš„å¤åˆ¶ï¼ŒåŸºäºè¡Œçš„æ›´æ”¹ã€‚è¿™ç§æ–¹å¼ä¼šå°†å®é™…æ•°æ®è®°å½•åœ¨äºŒè¿›åˆ¶æ—¥å¿—ä¸­ï¼Œå®ƒæœ‰å…¶è‡ªèº«çš„ä¸€äº›ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Œæœ€å¤§çš„å¥½å¤„æ˜¯å¯ä»¥æ­£ç¡®åœ°å¤åˆ¶æ¯ä¸€è¡Œæ•°æ®ï¼Œä¸€äº›è¯­å¥å¯ä»¥è¢«æ›´åŠ æœ‰æ•ˆåœ°å¤åˆ¶ï¼Œå¦å¤–å°±æ˜¯å‡ ä¹æ²¡æœ‰åŸºäºè¡Œçš„å¤åˆ¶æ¨¡å¼æ— æ³•å¤„ç†çš„åœºæ™¯ï¼Œå¯¹äºæ‰€æœ‰çš„ SQL æ„é€ ã€è§¦å‘å™¨ã€å­˜å‚¨è¿‡ç¨‹ç­‰éƒ½èƒ½æ­£ç¡®æ‰§è¡Œï¼›å®ƒçš„ç¼ºç‚¹å°±æ˜¯äºŒè¿›åˆ¶æ—¥å¿—å¯èƒ½ä¼šå¾ˆå¤§ï¼Œè€Œä¸”ä¸ç›´è§‚ï¼Œæ‰€ä»¥ï¼Œä½ ä¸èƒ½ä½¿ç”¨ mysqlbinlog æ¥æŸ¥çœ‹äºŒè¿›åˆ¶æ—¥å¿—ï¼Œä¹Ÿæ— æ³•é€šè¿‡çœ‹äºŒè¿›åˆ¶æ—¥å¿—åˆ¤æ–­å½“å‰æ‰§è¡Œåˆ°é‚£ä¸€æ¡ SQL è¯­å¥ã€‚ç°åœ¨å¯¹äº ROW æ ¼å¼çš„äºŒè¿›åˆ¶æ—¥å¿—åŸºæœ¬æ˜¯æ ‡é…äº†ï¼Œä¸»è¦æ˜¯å› ä¸ºå®ƒçš„ä¼˜åŠ¿è¿œè¿œå¤§äºç¼ºç‚¹ï¼Œå¹¶ä¸”ç”±äº ROW æ ¼å¼è®°å½•è¡Œæ•°æ®ï¼Œæ‰€ä»¥å¯ä»¥åŸºäºè¿™ç§æ¨¡å¼åšä¸€äº› DBA å·¥å…·ï¼Œæ¯”å¦‚æ•°æ®æ¢å¤ï¼Œä¸åŒæ•°æ®åº“ä¹‹é—´æ•°æ®åŒæ­¥ç­‰ï¼›\n\n*   MIXED ä¹Ÿæ˜¯ MySQL é»˜è®¤ä½¿ç”¨çš„äºŒè¿›åˆ¶æ—¥å¿—è®°å½•æ–¹å¼ï¼Œä½† MIXED æ ¼å¼é»˜è®¤é‡‡ç”¨åŸºäºè¯­å¥çš„å¤åˆ¶ï¼Œä¸€æ—¦å‘ç°åŸºäºè¯­å¥çš„æ— æ³•ç²¾ç¡®çš„å¤åˆ¶æ—¶ï¼Œå°±ä¼šé‡‡ç”¨åŸºäºè¡Œçš„å¤åˆ¶ã€‚æ¯”å¦‚ç”¨åˆ° UUID()ã€USER()ã€CURRENT*USER()ã€ROW*COUNT() ç­‰æ— æ³•ç¡®å®šçš„å‡½æ•°ã€‚\n\n### redo log å’Œ binlog æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\nredo logï¼ˆé‡åšæ—¥å¿—ï¼‰å’Œ binlogï¼ˆå½’æ¡£æ—¥å¿—ï¼‰éƒ½æ˜¯ MySQL çš„é‡è¦çš„æ—¥å¿—ï¼Œå®ƒä»¬çš„åŒºåˆ«å¦‚ä¸‹ï¼š\n\n*   redo log æ˜¯ç‰©ç†æ—¥å¿—ï¼Œè®°å½•çš„æ˜¯â€œåœ¨æŸä¸ªæ•°æ®é¡µä¸Šåšäº†ä»€ä¹ˆä¿®æ”¹â€ã€‚\n\n*   binlog æ˜¯é€»è¾‘æ—¥å¿—ï¼Œè®°å½•çš„æ˜¯è¿™ä¸ªè¯­å¥çš„åŸå§‹é€»è¾‘ï¼Œæ¯”å¦‚â€œç»™ ID=2 è¿™ä¸€è¡Œçš„ c å­—æ®µåŠ  1 â€ã€‚\n\n*   redo log æ˜¯ InnoDB å¼•æ“ç‰¹æœ‰çš„ï¼›binlog æ˜¯ MySQL çš„ Server å±‚å®ç°çš„ï¼Œæ‰€æœ‰å¼•æ“éƒ½å¯ä»¥ä½¿ç”¨ã€‚\n\n*   redo log æ˜¯å¾ªç¯å†™çš„ï¼Œç©ºé—´å›ºå®šä¼šç”¨å®Œï¼›binlog æ˜¯å¯ä»¥è¿½åŠ å†™å…¥çš„ã€‚â€œè¿½åŠ å†™â€æ˜¯æŒ‡ binlog æ–‡ä»¶å†™åˆ°ä¸€å®šå¤§å°åä¼šåˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªï¼Œå¹¶ä¸ä¼šè¦†ç›–ä»¥å‰çš„æ—¥å¿—ã€‚\n\næœ€å¼€å§‹ MySQL é‡Œå¹¶æ²¡æœ‰ InnoDB å¼•æ“ï¼ŒMySQL è‡ªå¸¦çš„å¼•æ“æ˜¯ MyISAMï¼Œä½†æ˜¯ MyISAM æ²¡æœ‰ crash-safe çš„èƒ½åŠ›ï¼Œbinlog æ—¥å¿—åªèƒ½ç”¨äºå½’æ¡£ã€‚è€Œ InnoDB æ˜¯å¦ä¸€ä¸ªå…¬å¸ä»¥æ’ä»¶å½¢å¼å¼•å…¥ MySQL çš„ï¼Œæ—¢ç„¶åªä¾é  binlog æ˜¯æ²¡æœ‰ crash-safe èƒ½åŠ›çš„ï¼Œæ‰€ä»¥ InnoDB ä½¿ç”¨å¦å¤–ä¸€å¥—æ—¥å¿—ç³»ç»Ÿï¼Œä¹Ÿå°±æ˜¯ redo log æ¥å®ç° crash-safe èƒ½åŠ›ã€‚\n\n### ä»€ä¹ˆæ˜¯ crash-safeï¼Ÿ\n\ncrash-safe æ˜¯æŒ‡å‘ç”Ÿå®•æœºç­‰æ„å¤–æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨é‡å¯åæ•°æ®ä¾ç„¶ä¸ä¼šä¸¢å¤±çš„æƒ…å†µã€‚\n\n### ä»€ä¹ˆæ˜¯è„é¡µå’Œå¹²å‡€é¡µï¼Ÿ\n\nMySQL ä¸ºäº†æ“ä½œçš„æ€§èƒ½ä¼˜åŒ–ï¼Œä¼šæŠŠæ•°æ®æ›´æ–°å…ˆæ”¾å…¥å†…å­˜ä¸­ï¼Œä¹‹åå†ç»Ÿä¸€æ›´æ–°åˆ°ç£ç›˜ã€‚å½“å†…å­˜æ•°æ®å’Œç£ç›˜æ•°æ®å†…å®¹ä¸ä¸€è‡´çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç§°è¿™ä¸ªå†…å­˜é¡µä¸ºè„é¡µï¼›å†…å­˜æ•°æ®å†™åˆ°ç£ç›˜åï¼Œå†…å­˜çš„æ•°æ®å’Œç£ç›˜ä¸Šçš„å†…å®¹å°±ä¸€è‡´äº†ï¼Œæˆ‘ä»¬ç§°ä¸ºâ€œå¹²å‡€é¡µâ€ã€‚\n\n### ä»€ä¹ˆæƒ…å†µä¸‹ä¼šå¼•å‘ MySQL åˆ·è„é¡µï¼ˆflushï¼‰çš„æ“ä½œï¼Ÿ\n\n*   å†…å­˜å†™æ»¡äº†ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šå¼•å‘ flush æ“ä½œï¼Œå¯¹åº”åˆ° InnoDB å°±æ˜¯ redo log å†™æ»¡äº†ï¼›\n\n*   ç³»ç»Ÿçš„å†…å­˜ä¸è¶³äº†ï¼Œå½“éœ€è¦æ–°çš„å†…å­˜é¡µçš„æ—¶å€™ï¼Œå°±ä¼šæ·˜æ±°ä¸€äº›å†…å­˜é¡µï¼Œå¦‚æœæ·˜æ±°çš„æ˜¯è„é¡µè¿™ä¸ªæ—¶å€™å°±ä¼šè§¦å‘ flush æ“ä½œï¼›\n\n*   ç³»ç»Ÿç©ºé—²çš„æ—¶å€™ï¼ŒMySQL ä¼šåŒæ­¥å†…å­˜ä¸­çš„æ•°æ®åˆ°ç£ç›˜ä¹Ÿä¼šè§¦å‘ flush æ“ä½œï¼›\n\n*   MySQL æœåŠ¡å…³é—­çš„æ—¶å€™ä¹Ÿä¼šåˆ·è„é¡µï¼Œè§¦å‘ flush æ“ä½œã€‚\n\n### MySQL åˆ·è„é¡µçš„é€Ÿåº¦å¾ˆæ…¢å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ\n\nåœ¨ MySQL ä¸­å•ç‹¬åˆ·ä¸€ä¸ªè„é¡µçš„é€Ÿåº¦æ˜¯å¾ˆå¿«çš„ï¼Œå¦‚æœå‘ç°åˆ·è„é¡µçš„é€Ÿåº¦å¾ˆæ…¢ï¼Œè¯´æ˜è§¦å‘äº† MySQL åˆ·è„é¡µçš„â€œè¿åâ€æœºåˆ¶ï¼ŒMySQL çš„â€œè¿åâ€æœºåˆ¶æ˜¯æŒ‡å½“ MySQL åˆ·è„é¡µçš„æ—¶å€™å¦‚æœå‘ç°ç›¸é‚»çš„æ•°æ®é¡µä¹Ÿæ˜¯è„é¡µä¹Ÿä¼šä¸€èµ·åˆ·æ‰ï¼Œè€Œè¿™ä¸ªåŠ¨ä½œå¯ä»¥ä¸€ç›´è”“å»¶ä¸‹å»ï¼Œè¿™å°±æ˜¯å¯¼è‡´ MySQL åˆ·è„é¡µæ…¢çš„åŸå› äº†ã€‚\n\n### å¦‚ä½•æ§åˆ¶ MySQL åªåˆ·æ–°å½“å‰è„é¡µï¼Ÿ\n\nåœ¨ InnoDB ä¸­è®¾ç½® innodb*flush*neighbors è¿™ä¸ªå‚æ•°çš„å€¼ä¸º 0ï¼Œæ¥è§„å®š MySQL åªåˆ·å½“å‰è„é¡µï¼ŒMySQL 8 è¿™ä¸ªå€¼é»˜è®¤æ˜¯ 0ã€‚\n\n### MySQL çš„ WAL æŠ€æœ¯æ˜¯è§£å†³ä»€ä¹ˆé—®é¢˜çš„ï¼Ÿ\n\nA.é˜²æ­¢è¯¯åˆ é™¤ï¼Œæ‰¾å›æ•°æ®ç”¨çš„ B.å®¹ç¾æ¢å¤ï¼Œä¸ºäº†è¿˜åŸå¼‚å¸¸æ•°æ®ç”¨çš„ C.äº‹åŠ¡å¤„ç†ï¼Œä¸ºäº†æ•°æ®åº“çš„ç¨³å®šæ€§ D.ä¸ºäº†é™ä½ IO æˆæœ¬ ç­”ï¼šD é¢˜ç›®è§£æï¼šWAL æŠ€æœ¯çš„å…¨ç§°æ˜¯ Write Ahead Loggingï¼ˆä¸­æ–‡ï¼šé¢„å†™å¼æ—¥å¿—ï¼‰ï¼Œæ˜¯å…ˆå†™æ—¥å¿—ï¼Œå†å†™ç£ç›˜çš„æ–¹å¼ï¼Œå› ä¸ºæ¯æ¬¡æ›´æ–°éƒ½å†™ç£ç›˜çš„è¯ IO æˆæœ¬å¾ˆé«˜ï¼Œæ‰€ä»¥æ‰æœ‰äº† WAL æŠ€æœ¯ã€‚\n\n### ä¸ºä»€ä¹ˆæœ‰æ—¶å€™ä¼šæ„Ÿè§‰ MySQL å¶å°”å¡ä¸€ä¸‹ï¼Ÿ\n\nå¦‚æœå¶å°”æ„Ÿè§‰ MySQL å¡ä¸€ä¸‹ï¼Œå¯èƒ½æ˜¯ MySQL æ­£åœ¨åˆ·è„é¡µï¼Œæ­£åœ¨æŠŠå†…å­˜ä¸­çš„æ›´æ–°æ“ä½œåˆ·åˆ°ç£ç›˜ä¸­ã€‚\n\n### redo log å’Œ binlog æ˜¯æ€ä¹ˆå…³è”çš„?\n\nå®ƒä»¬æœ‰ä¸€ä¸ªå…±åŒçš„æ•°æ®å­—æ®µï¼Œå« XIDã€‚å´©æºƒæ¢å¤çš„æ—¶å€™ï¼Œä¼šæŒ‰é¡ºåºæ‰«æ redo logï¼š\n\n*   å¦‚æœç¢°åˆ°æ—¢æœ‰ prepareã€åˆæœ‰ commit çš„ redo logï¼Œå°±ç›´æ¥æäº¤ï¼›\n\n*   å¦‚æœç¢°åˆ°åªæœ‰ parepareã€è€Œæ²¡æœ‰ commit çš„ redo logï¼Œå°±æ‹¿ç€ XID å» binlog æ‰¾å¯¹åº”çš„äº‹åŠ¡ã€‚\n\n### MySQL æ€ä¹ˆçŸ¥é“ binlog æ˜¯å®Œæ•´çš„?\n\n*   statement æ ¼å¼çš„ binlogï¼Œå®Œæ•´çš„æ ‡è¯†æ˜¯æœ€åæœ‰ COMMIT å…³é”®å­—ã€‚\n\n*   row æ ¼å¼çš„ binlogï¼Œå®Œæ•´çš„æ ‡è¯†æ˜¯æœ€åä¼šæœ‰ä¸€ä¸ª XID event å…³é”®å­—ã€‚\n\n### MySQL ä¸­å¯ä¸å¯ä»¥åªè¦ binlogï¼Œä¸è¦ redo logï¼Ÿ\n\nä¸å¯ä»¥ï¼Œbinlog æ²¡æœ‰å´©æºƒæ¢å¤çš„èƒ½åŠ›ã€‚\n\n### MySQL ä¸­å¯ä¸å¯ä»¥åªè¦ redo logï¼Œä¸è¦ binlogï¼Ÿ\n\nä¸å¯ä»¥ï¼ŒåŸå› æœ‰ä»¥ä¸‹ä¸¤ä¸ªï¼š\n\n*   redo log æ˜¯å¾ªç¯å†™ä¸èƒ½ä¿è¯æ‰€æœ‰çš„å†å²æ•°æ®ï¼Œè¿™äº›å†å²æ•°æ®åªèƒ½åœ¨ binlog ä¸­æ‰¾åˆ°ï¼›\n\n*   binlog æ˜¯é«˜å¯ç”¨çš„åŸºç¡€ï¼Œé«˜å¯ç”¨çš„å®ç°åŸç†å°±æ˜¯ binlog å¤åˆ¶ã€‚\n\n### ä¸ºä»€ä¹ˆ binlog cache æ˜¯æ¯ä¸ªçº¿ç¨‹è‡ªå·±ç»´æŠ¤çš„ï¼Œè€Œ redo log buffer æ˜¯å…¨å±€å…±ç”¨çš„ï¼Ÿ\n\nå› ä¸º binlog æ˜¯ä¸èƒ½â€œè¢«æ‰“æ–­çš„â€ï¼Œä¸€ä¸ªäº‹åŠ¡çš„ binlog å¿…é¡»è¿ç»­å†™ï¼Œå› æ­¤è¦æ•´ä¸ªäº‹åŠ¡å®Œæˆåï¼Œå†ä¸€èµ·å†™åˆ°æ–‡ä»¶é‡Œã€‚è€Œ redo log å¹¶æ²¡æœ‰è¿™ä¸ªè¦æ±‚ï¼Œä¸­é—´æœ‰ç”Ÿæˆçš„æ—¥å¿—å¯ä»¥å†™åˆ° redo log buffer ä¸­ï¼Œredo log buffer ä¸­çš„å†…å®¹è¿˜èƒ½â€œæ­ä¾¿è½¦â€ï¼Œå…¶ä»–äº‹åŠ¡æäº¤çš„æ—¶å€™å¯ä»¥è¢«ä¸€èµ·å†™åˆ°ç£ç›˜ä¸­ã€‚\n\n### äº‹åŠ¡æ‰§è¡ŒæœŸé—´ï¼Œè¿˜æœªæäº¤ï¼Œå¦‚æœå‘ç”Ÿ crashï¼Œredo log ä¸¢å¤±ï¼Œä¼šå¯¼è‡´ä¸»å¤‡ä¸ä¸€è‡´å‘¢ï¼Ÿ\n\nä¸ä¼šï¼Œå› ä¸ºè¿™æ—¶å€™ binlog ä¹Ÿè¿˜åœ¨ binlog cache é‡Œï¼Œæ²¡å‘ç»™å¤‡åº“ï¼Œcrash ä»¥å redo log å’Œ binlog éƒ½æ²¡æœ‰äº†ï¼Œä»ä¸šåŠ¡è§’åº¦çœ‹è¿™ä¸ªäº‹åŠ¡ä¹Ÿæ²¡æœ‰æäº¤ï¼Œæ‰€ä»¥æ•°æ®æ˜¯ä¸€è‡´çš„ã€‚\n\n### åœ¨ MySQL ä¸­ç”¨ä»€ä¹ˆæœºåˆ¶æ¥ä¼˜åŒ–éšæœºè¯»/å†™ç£ç›˜å¯¹ IO çš„æ¶ˆè€—ï¼Ÿ\n\nredo log æ˜¯ç”¨æ¥èŠ‚çœéšæœºå†™ç£ç›˜çš„ IO æ¶ˆè€—ï¼Œè€Œ change buffer ä¸»è¦æ˜¯èŠ‚çœéšæœºè¯»ç£ç›˜çš„ IO æ¶ˆè€—ã€‚redo log ä¼šæŠŠ MySQL çš„æ›´æ–°æ“ä½œå…ˆè®°å½•åˆ°å†…å­˜ä¸­ï¼Œä¹‹åå†ç»Ÿä¸€æ›´æ–°åˆ°ç£ç›˜ï¼Œè€Œ change buffer ä¹Ÿæ˜¯æŠŠå…³é”®æŸ¥è¯¢æ•°æ®å…ˆåŠ è½½åˆ°å†…å­˜ä¸­ï¼Œä»¥ä¾¿ä¼˜åŒ– MySQL çš„æŸ¥è¯¢ã€‚\n\n### ä»¥ä¸‹è¯´æ³•é”™è¯¯çš„æ˜¯ï¼Ÿ\n\nA.redo log æ˜¯ InnoDB å¼•æ“ç‰¹æœ‰çš„ï¼Œå®ƒçš„å›ºå®šå¤§å°çš„ B.redo log æ—¥å¿—æ˜¯ä¸å…¨çš„ï¼Œåªæœ‰æœ€æ–°çš„ä¸€äº›æ—¥å¿—ï¼Œè¿™å’Œå®ƒçš„å†…å­˜å¤§å°æœ‰å…³ C.redo log å¯ä»¥ä¿è¯æ•°æ®åº“å¼‚å¸¸é‡å¯ä¹‹åï¼Œæ•°æ®ä¸ä¸¢å¤± D.binlog æ˜¯ MySQL è‡ªå¸¦çš„æ—¥å¿—ï¼Œå®ƒèƒ½ä¿è¯æ•°æ®åº“å¼‚å¸¸é‡å¯ä¹‹åï¼Œæ•°æ®ä¸ä¸¢å¤± ç­”ï¼šD é¢˜ç›®è§£æï¼šbinlog æ˜¯ MySQL è‡ªå¸¦çš„æ—¥å¿—ï¼Œä½†å®ƒå¹¶ä¸èƒ½ä¿è¯æ•°æ®åº“å¼‚å¸¸é‡å¯ä¹‹åæ•°æ®ä¸ä¸¢å¤±ã€‚\n\n### ä»¥ä¸‹è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼Ÿ\n\nA.redo log æ—¥å¿—æ˜¯è¿½åŠ å†™çš„ï¼Œåé¢çš„æ—¥å¿—å¹¶ä¸ä¼šè¦†ç›–å‰é¢çš„æ—¥å¿— B.binlog æ—¥å¿—æ˜¯è¿½åŠ å†™çš„ï¼Œåé¢çš„æ—¥å¿—å¹¶ä¸ä¼šè¦†ç›–å‰é¢çš„æ—¥å¿— C.redo log å’Œ binlog æ—¥å¿—éƒ½æ˜¯è¿½åŠ å†™çš„ï¼Œåé¢çš„æ—¥å¿—å¹¶ä¸ä¼šè¦†ç›–å‰é¢çš„æ—¥å¿— D.ä»¥ä¸Šè¯´æ³•éƒ½æ­£ç¡® ç­”ï¼šB é¢˜ç›®è§£æï¼šbinlog æ—¥å¿—æ˜¯è¿½åŠ å†™çš„ï¼Œåé¢çš„æ—¥å¿—å¹¶ä¸ä¼šè¦†ç›–å‰é¢çš„æ—¥å¿—ï¼Œredo log æ—¥å¿—æ˜¯å›ºå®šå¤§å°çš„ï¼Œåé¢çš„æ—¥å¿—ä¼šè¦†ç›–å‰é¢çš„æ—¥å¿—ã€‚\n\n### æœ‰æ²¡æœ‰åŠæ³•æŠŠ MySQL çš„æ•°æ®æ¢å¤åˆ°è¿‡å»æŸä¸ªæŒ‡å®šçš„æ—¶é—´èŠ‚ç‚¹ï¼Ÿæ€ä¹ˆæ¢å¤ï¼Ÿ\n\nå¯ä»¥æ¢å¤ï¼Œåªè¦ä½ å¤‡ä»½äº†è¿™æ®µæ—¶é—´çš„æ‰€æœ‰ binlogï¼ŒåŒæ—¶åšäº†å…¨é‡æ•°æ®åº“çš„å®šæœŸå¤‡ä»½ï¼Œæ¯”å¦‚ï¼Œä¸€å¤©ä¸€å¤‡ï¼Œæˆ–è€…ä¸‰å¤©ä¸€å¤‡ï¼Œè¿™å–å†³äºä½ ä»¬çš„å¤‡ä»½ç­–ç•¥ï¼Œè¿™ä¸ªæ—¶å€™ä½ å°±å¯ä»¥æŠŠä¹‹å‰å¤‡ä»½çš„æ•°æ®åº“å…ˆè¿˜åŸåˆ°æµ‹è¯•åº“ï¼Œä»å¤‡ä»½çš„æ—¶é—´ç‚¹å¼€å§‹ï¼Œå°†å¤‡ä»½çš„ binlog ä¾æ¬¡å–å‡ºæ¥ï¼Œé‡æ”¾åˆ°ä½ è¦æ¢å¤æ•°æ®çš„é‚£ä¸ªæ—¶åˆ»ï¼Œè¿™ä¸ªæ—¶å€™å°±å®Œæˆäº†æ•°æ®åˆ°æŒ‡å®šèŠ‚ç‚¹çš„æ¢å¤ã€‚æ¯”å¦‚ï¼Œä»Šå¤©æ—©ä¸Š 9 ç‚¹çš„æ—¶å€™ï¼Œä½ æƒ³æŠŠæ•°æ®æ¢å¤æˆä»Šå¤©æ—©ä¸Š 6:00:00 çš„çŠ¶æ€ï¼Œè¿™ä¸ªæ—¶å€™ä½ å¯ä»¥å…ˆå–å‡ºä»Šå¤©å‡Œæ™¨ï¼ˆ00:01:59ï¼‰å¤‡ä»½çš„æ•°æ®åº“æ–‡ä»¶ï¼Œè¿˜åŸåˆ°æµ‹è¯•åº“ï¼Œå†ä» binlog æ–‡ä»¶ä¸­ä¾æ¬¡å–å‡º 00:01:59 ä¹‹åçš„æ“ä½œä¿¡æ¯ï¼Œé‡æ”¾åˆ° 6:00:00 è¿™ä¸ªæ—¶åˆ»ï¼Œè¿™å°±å®Œæˆäº†æ•°æ®åº“çš„è¿˜åŸã€‚\n\n\n\n## MySQLæ€§èƒ½ä¼˜åŒ–\n\n### MySQL æ€§èƒ½æŒ‡æ ‡éƒ½æœ‰å“ªäº›ï¼Ÿå¦‚ä½•å¾—åˆ°è¿™äº›æŒ‡æ ‡ï¼Ÿ\n\nMySQL çš„æ€§èƒ½æŒ‡æ ‡å¦‚ä¸‹ï¼š\n\n**â‘  TPSï¼ˆTransaction Per Secondï¼‰** æ¯ç§’äº‹åŠ¡æ•°ï¼Œå³æ•°æ®åº“æ¯ç§’æ‰§è¡Œçš„äº‹åŠ¡æ•°ã€‚\n\nMySQL æœ¬èº«æ²¡æœ‰ç›´æ¥æä¾› TPS å‚æ•°å€¼ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦è·å¾— TPS çš„å€¼ï¼Œåªæœ‰æˆ‘ä»¬è‡ªå·±è®¡ç®—äº†ï¼Œå¯ä»¥æ ¹æ® MySQL æ•°æ®åº“æä¾›çš„çŠ¶æ€å˜é‡ï¼Œæ¥è®¡ç®— TPSã€‚\n\néœ€è¦ä½¿ç”¨çš„å‚æ•°ï¼š\n\n*   Com_commit ï¼šè¡¨ç¤ºæäº¤æ¬¡æ•°ï¼Œé€šè¿‡å‘½ä»¤ `show global status like 'Com_commit';` è·å–ï¼›\n\n*   Com_rollbackï¼šè¡¨ç¤ºå›æ»šæ¬¡æ•°ï¼Œé€šè¿‡å‘½ä»¤ `show global status like 'Com_rollback';` è·å–ã€‚\n\næˆ‘ä»¬å®šä¹‰ç¬¬ä¸€æ¬¡è·å–çš„ Com*commit çš„å€¼ä¸ Com*rollback å€¼çš„å’Œä¸º c_r1ï¼Œæ—¶é—´ä¸º t1ï¼›\n\nç¬¬äºŒæ¬¡è·å–çš„ Com*commit çš„å€¼ä¸ Com*rollback å€¼çš„å’Œä¸º c*r2ï¼Œæ—¶é—´ä¸º t2ï¼Œt1 ä¸ t2 å•ä½ä¸ºç§’ã€‚ é‚£ä¹ˆ TPS = ( c*r2 - c_r1 ) / ( t2 - t1 ) ç®—å‡ºæ¥çš„å°±æ˜¯è¯¥ MySQL å®ä¾‹åœ¨ t1 ä¸ t2 ç”Ÿå‘½å‘¨æœŸä¹‹é—´çš„å¹³å‡ TPSã€‚\n\n**â‘¡ QPSï¼ˆQuery Per Secondï¼‰** æ¯ç§’è¯·æ±‚æ¬¡æ•°ï¼Œä¹Ÿå°±æ˜¯æ•°æ®åº“æ¯ç§’æ‰§è¡Œçš„ SQL æ•°é‡ï¼ŒåŒ…å« INSERTã€SELECTã€UPDATEã€DELETE ç­‰ã€‚ QPS = Queries / Seconds Queries æ˜¯ç³»ç»ŸçŠ¶æ€å€¼â€”æ€»æŸ¥è¯¢æ¬¡æ•°ï¼Œå¯ä»¥é€šè¿‡ `show status like 'queries';` æŸ¥è¯¢å¾—å‡º \n\nSeconds æ˜¯ç›‘æ§çš„æ—¶é—´åŒºé—´ï¼Œå•ä½ä¸ºç§’ã€‚ æ¯”å¦‚ï¼Œé‡‡æ · 10 ç§’å†…çš„æŸ¥è¯¢æ¬¡æ•°ï¼Œé‚£ä¹ˆå…ˆæŸ¥è¯¢ä¸€æ¬¡ Queries å€¼ï¼ˆQ1ï¼‰ï¼Œç­‰å¾… 10 ç§’ï¼Œå†æŸ¥è¯¢ä¸€æ¬¡ Queries å€¼ï¼ˆQ2ï¼‰ï¼Œé‚£ä¹ˆ QPS å°±å¯ä»¥é€šè¿‡ï¼Œå¦‚ä¸‹å…¬å¼è·å¾—ï¼š\n\n> QPS = (Q2 - Q1) / 10\n\n**â‘¢ IOPSï¼ˆInput/Output Operations per Secondï¼‰** æ¯ç§’å¤„ç†çš„ I/O è¯·æ±‚æ¬¡æ•°ã€‚\n\nIOPS æ˜¯åˆ¤æ–­ç£ç›˜ I/O èƒ½åŠ›çš„æŒ‡æ ‡ä¹‹ä¸€ï¼Œä¸€èˆ¬æ¥è®² IOPS æŒ‡æ ‡è¶Šé«˜ï¼Œé‚£ä¹ˆå•ä½æ—¶é—´å†…èƒ½å¤Ÿå“åº”çš„è¯·æ±‚è‡ªç„¶ä¹Ÿå°±è¶Šå¤šã€‚ç†è®ºä¸Šè®²ï¼Œåªè¦ç³»ç»Ÿå®é™…çš„è¯·æ±‚æ•°ä½äº IOPS çš„èƒ½åŠ›ï¼Œå°±ç›¸å½“äºæ¯ä¸€ä¸ªè¯·æ±‚éƒ½èƒ½å¾—åˆ°å³æ—¶å“åº”ï¼Œé‚£ä¹ˆ I/O å°±ä¸ä¼šæ˜¯ç“¶é¢ˆäº†ã€‚\n\næ³¨æ„ï¼šIOPS ä¸ç£ç›˜ååé‡ä¸ä¸€æ ·ï¼Œååé‡æ˜¯æŒ‡å•ä½æ—¶é—´å†…å¯ä»¥æˆåŠŸä¼ è¾“çš„æ•°æ®æ•°é‡ã€‚\n\nå¯ä»¥ä½¿ç”¨ iostat å‘½ä»¤ï¼ŒæŸ¥çœ‹ç£ç›˜çš„ IOPSï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š\n\n> yum install sysstat iostat -dx 1 10\n\næ‰§è¡Œæ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š \n\nIOPS = r/s + w/s å…¶ä¸­ï¼š\n\n*   r/sï¼šä»£è¡¨æ¯ç§’è¯»äº†å¤šå°‘æ¬¡ï¼›\n\n*   w/sï¼šä»£è¡¨æ¯ç§’å†™äº†å¤šå°‘æ¬¡ã€‚\n\n### ä»€ä¹ˆæ˜¯æ…¢æŸ¥è¯¢ï¼Ÿ\n\næ…¢æŸ¥è¯¢æ˜¯ MySQL ä¸­æä¾›çš„ä¸€ç§æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œå®ƒç”¨æ¥è®°å½•åœ¨ MySQL ä¸­å“åº”æ—¶é—´è¶…è¿‡é˜€å€¼çš„è¯­å¥ï¼Œå…·ä½“æŒ‡è¿è¡Œæ—¶é—´è¶…è¿‡ *longquerytime* å€¼çš„ SQLï¼Œåˆ™ä¼šè¢«è®°å½•åˆ°æ…¢æŸ¥è¯¢æ—¥å¿—ä¸­ã€‚ *longquerytime* çš„é»˜è®¤å€¼ä¸º 10ï¼Œæ„æ€æ˜¯è¿è¡Œ 10s ä»¥ä¸Šçš„è¯­å¥ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒMySQL æ•°æ®åº“å¹¶ä¸å¯åŠ¨æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œéœ€è¦æˆ‘ä»¬æ‰‹åŠ¨æ¥è®¾ç½®è¿™ä¸ªå‚æ•°ï¼Œå¦‚æœä¸æ˜¯è°ƒä¼˜éœ€è¦çš„è¯ï¼Œä¸€èˆ¬ä¸å»ºè®®å¯åŠ¨è¯¥å‚æ•°ï¼Œå› ä¸ºå¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ä¼šç»™ MySQL æœåŠ¡å™¨å¸¦æ¥ä¸€å®šçš„æ€§èƒ½å½±å“ã€‚æ…¢æŸ¥è¯¢æ—¥å¿—æ”¯æŒå°†æ—¥å¿—è®°å½•å†™å…¥æ–‡ä»¶ï¼Œä¹Ÿæ”¯æŒå°†æ—¥å¿—è®°å½•å†™å…¥æ•°æ®åº“è¡¨ã€‚\n\nä½¿ç”¨ `mysql> show variables like '%slow_query_log%';` æ¥æŸ¥è¯¢æ…¢æŸ¥è¯¢æ—¥å¿—æ˜¯å¦å¼€å¯\n\n### å¦‚ä½•å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Ÿ\n\nå¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹ MySQL å‘½ä»¤ï¼š\n\n> mysql> set global slow*query*log=1\n\nä¸è¿‡è¿™ç§è®¾ç½®æ–¹å¼ï¼Œåªå¯¹å½“å‰æ•°æ®åº“ç”Ÿæ•ˆï¼Œå¦‚æœ MySQL é‡å¯ä¹Ÿä¼šå¤±æ•ˆï¼Œå¦‚æœè¦æ°¸ä¹…ç”Ÿæ•ˆï¼Œå°±å¿…é¡»ä¿®æ”¹ MySQL çš„é…ç½®æ–‡ä»¶ my.cnfï¼Œé…ç½®å¦‚ä¸‹ï¼š\n\n> slow*query*log =1 slow*query*log*file=/tmp/mysql*slow.log\n\n### å¦‚ä½•å®šä½æ…¢æŸ¥è¯¢ï¼Ÿ\n\nä½¿ç”¨ MySQL ä¸­çš„ explain åˆ†ææ‰§è¡Œè¯­å¥ï¼Œæ¯”å¦‚ï¼š\n\n> explain select * from t where id=5;\n\nå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n\n![avatar](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes11474088-2ff861def7876a91.png) \n\nå…¶ä¸­ï¼š\n\n*   id â€” é€‰æ‹©æ ‡è¯†ç¬¦ã€‚id è¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜ï¼Œè¶Šå…ˆè¢«æ‰§è¡Œã€‚\n\n*   select_type â€” è¡¨ç¤ºæŸ¥è¯¢çš„ç±»å‹ã€‚\n\n*   table â€” è¾“å‡ºç»“æœé›†çš„è¡¨\n\n*   partitions â€” åŒ¹é…çš„åˆ†åŒº\n\n*   type â€” è¡¨ç¤ºè¡¨çš„è¿æ¥ç±»å‹\n\n*   possible_keys â€” è¡¨ç¤ºæŸ¥è¯¢æ—¶ï¼Œå¯èƒ½ä½¿ç”¨çš„ç´¢å¼•\n\n*   key â€” è¡¨ç¤ºå®é™…ä½¿ç”¨çš„ç´¢å¼•\n\n*   key_len â€” ç´¢å¼•å­—æ®µçš„é•¿åº¦\n\n*   refâ€” åˆ—ä¸ç´¢å¼•çš„æ¯”è¾ƒ\n\n*   rows â€” å¤§æ¦‚ä¼°ç®—çš„è¡Œæ•°\n\n*   filtered â€” æŒ‰è¡¨æ¡ä»¶è¿‡æ»¤çš„è¡Œç™¾åˆ†æ¯”\n\n*   Extra â€” æ‰§è¡Œæƒ…å†µçš„æè¿°å’Œè¯´æ˜\n\nå…¶ä¸­æœ€é‡è¦çš„å°±æ˜¯ type å­—æ®µï¼Œtype å€¼ç±»å‹å¦‚ä¸‹ï¼š\n\n*   all â€” æ‰«æå…¨è¡¨æ•°æ®\n\n*   index â€” éå†ç´¢å¼•\n\n*   range â€” ç´¢å¼•èŒƒå›´æŸ¥æ‰¾\n\n*   index_subquery â€” åœ¨å­æŸ¥è¯¢ä¸­ä½¿ç”¨ ref\n\n*   uniquesubquery â€” åœ¨å­æŸ¥è¯¢ä¸­ä½¿ç”¨ eq*ref\n\n*   ref*or*null â€” å¯¹ null è¿›è¡Œç´¢å¼•çš„ä¼˜åŒ–çš„ ref\n\n*   fulltext â€” ä½¿ç”¨å…¨æ–‡ç´¢å¼•\n\n*   ref â€” ä½¿ç”¨éå”¯ä¸€ç´¢å¼•æŸ¥æ‰¾æ•°æ®\n\n*   eq_ref â€” åœ¨ join æŸ¥è¯¢ä¸­ä½¿ç”¨ä¸»é”®æˆ–å”¯ä¸€ç´¢å¼•å…³è”\n\n*   const â€” å°†ä¸€ä¸ªä¸»é”®æ”¾ç½®åˆ° where åé¢ä½œä¸ºæ¡ä»¶æŸ¥è¯¢ï¼Œ MySQL ä¼˜åŒ–å™¨å°±èƒ½æŠŠè¿™æ¬¡æŸ¥è¯¢ä¼˜åŒ–è½¬åŒ–ä¸ºä¸€ä¸ªå¸¸é‡ï¼Œå¦‚ä½•è½¬åŒ–ä»¥åŠä½•æ—¶è½¬åŒ–ï¼Œè¿™ä¸ªå–å†³äºä¼˜åŒ–å™¨ï¼Œè¿™ä¸ªæ¯” eq_ref æ•ˆç‡é«˜ä¸€ç‚¹\n\n### â­MySQL çš„ä¼˜åŒ–æ‰‹æ®µéƒ½æœ‰å“ªäº›ï¼Ÿ\n\nMySQL çš„å¸¸è§çš„ä¼˜åŒ–æ‰‹æ®µæœ‰ä»¥ä¸‹äº”ç§ï¼š\n\n#### â‘  æŸ¥è¯¢ä¼˜åŒ–\n\n*   é¿å… SELECT *ï¼ŒåªæŸ¥è¯¢éœ€è¦çš„å­—æ®µã€‚\n\n*   å°è¡¨é©±åŠ¨å¤§è¡¨ï¼Œå³å°çš„æ•°æ®é›†é©±åŠ¨å¤§çš„æ•°æ®é›†ï¼Œæ¯”å¦‚ï¼Œå½“ B è¡¨çš„æ•°æ®é›†å°äº A è¡¨æ—¶ï¼Œç”¨ in ä¼˜åŒ– existï¼Œä¸¤è¡¨æ‰§è¡Œé¡ºåºæ˜¯å…ˆæŸ¥ B è¡¨ï¼Œå†æŸ¥ A è¡¨ï¼ŒæŸ¥è¯¢è¯­å¥ï¼šselect * from A where id in (select id from B) ã€‚\n\n*   ä¸€äº›æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨è¿æ¥ä»£æ›¿å­æŸ¥è¯¢ï¼Œå› ä¸ºä½¿ç”¨ join æ—¶ï¼ŒMySQL ä¸ä¼šåœ¨å†…å­˜ä¸­åˆ›å»ºä¸´æ—¶è¡¨ã€‚\n\n#### â‘¡ ä¼˜åŒ–ç´¢å¼•çš„ä½¿ç”¨\n\n*   å°½é‡ä½¿ç”¨ä¸»é”®æŸ¥è¯¢ï¼Œè€Œéå…¶ä»–ç´¢å¼•ï¼Œå› ä¸ºä¸»é”®æŸ¥è¯¢ä¸ä¼šè§¦å‘å›è¡¨æŸ¥è¯¢ã€‚\n\n*   ä¸åšåˆ—è¿ç®—ï¼ŒæŠŠè®¡ç®—éƒ½æ”¾å…¥å„ä¸ªä¸šåŠ¡ç³»ç»Ÿå®ç°\n\n*   æŸ¥è¯¢è¯­å¥å°½å¯èƒ½ç®€å•ï¼Œå¤§è¯­å¥æ‹†å°è¯­å¥ï¼Œå‡å°‘é”æ—¶é—´\n\n*   ä¸ä½¿ç”¨ select * æŸ¥è¯¢\n\n*   or æŸ¥è¯¢æ”¹å†™æˆ in æŸ¥è¯¢\n\n*   ä¸ç”¨å‡½æ•°å’Œè§¦å‘å™¨\n\n*   é¿å… %xx æŸ¥è¯¢\n\n*   å°‘ç”¨ join æŸ¥è¯¢\n\n*   ä½¿ç”¨åŒç±»å‹æ¯”è¾ƒï¼Œæ¯”å¦‚ '123' å’Œ '123'ã€123 å’Œ 123\n\n*   å°½é‡é¿å…åœ¨ where å­å¥ä¸­ä½¿ç”¨ != æˆ–è€… <> æ“ä½œç¬¦ï¼ŒæŸ¥è¯¢å¼•ç”¨ä¼šæ”¾å¼ƒç´¢å¼•è€Œè¿›è¡Œå…¨è¡¨æ‰«æ\n\n*   é¿å…åœ¨ç´¢å¼•åˆ—ä¸Šä½¿ç”¨ is null å’Œ is not null\n\n*   å°½é‡ä½¿ç”¨ä¸»é”®æŸ¥è¯¢\n\n*   é¿å…åœ¨ where å­å¥ä¸­å¯¹å­—æ®µè¿›è¡Œè¡¨è¾¾å¼æ“ä½œ\n\n*   å°½é‡ä½¿ç”¨æ•°å­—å‹å­—æ®µï¼Œè‹¥åªå«æ•°å€¼ä¿¡æ¯çš„å­—æ®µå°½é‡ä¸è¦è®¾è®¡ä¸ºå­—ç¬¦å‹\n\n#### â‘¢ è¡¨ç»“æ„è®¾è®¡ä¼˜åŒ–\n\n*   ä½¿ç”¨å¯ä»¥å­˜ä¸‹æ•°æ®æœ€å°çš„æ•°æ®ç±»å‹ã€‚\n\n*   ä½¿ç”¨ç®€å•çš„æ•°æ®ç±»å‹ï¼Œint è¦æ¯” varchar ç±»å‹åœ¨ MySQL å¤„ç†ç®€å•ã€‚\n\n*   å°½é‡ä½¿ç”¨ tinyintã€smallintã€mediumint ä½œä¸ºæ•´æ•°ç±»å‹è€Œé intã€‚\n\n*   å°½å¯èƒ½ä½¿ç”¨ not null å®šä¹‰å­—æ®µï¼Œå› ä¸º null å ç”¨ 4 å­—èŠ‚ç©ºé—´ã€‚\n\n*   å°½é‡å°‘ç”¨ text ç±»å‹ï¼Œéç”¨ä¸å¯æ—¶æœ€å¥½è€ƒè™‘åˆ†è¡¨ã€‚\n\n*   å°½é‡ä½¿ç”¨ timestampï¼Œè€Œé datetimeã€‚\n\n*   å•è¡¨ä¸è¦æœ‰å¤ªå¤šå­—æ®µï¼Œå»ºè®®åœ¨ 20 ä¸ªå­—æ®µä»¥å†…ã€‚\n\n#### â‘£ è¡¨æ‹†åˆ†\n\nå½“æ•°æ®åº“ä¸­çš„æ•°æ®éå¸¸å¤§æ—¶ï¼ŒæŸ¥è¯¢ä¼˜åŒ–æ–¹æ¡ˆä¹Ÿä¸èƒ½è§£å†³æŸ¥è¯¢é€Ÿåº¦æ…¢çš„é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘æ‹†åˆ†è¡¨ï¼Œè®©æ¯å¼ è¡¨çš„æ•°æ®é‡å˜å°ï¼Œä»è€Œæé«˜æŸ¥è¯¢æ•ˆç‡ã€‚ \n\n**aï¼‰å‚ç›´æ‹†åˆ†**ï¼šæ˜¯æŒ‡æ•°æ®è¡¨åˆ—çš„æ‹†åˆ†ï¼ŒæŠŠä¸€å¼ åˆ—æ¯”è¾ƒå¤šçš„è¡¨æ‹†åˆ†ä¸ºå¤šå¼ è¡¨ï¼Œæ¯”å¦‚ï¼Œç”¨æˆ·è¡¨ä¸­ä¸€äº›å­—æ®µç»å¸¸è¢«è®¿é—®ï¼Œå°†è¿™äº›å­—æ®µæ”¾åœ¨ä¸€å¼ è¡¨ä¸­ï¼Œå¦å¤–ä¸€äº›ä¸å¸¸ç”¨çš„å­—æ®µæ”¾åœ¨å¦ä¸€å¼ è¡¨ä¸­ï¼Œæ’å…¥æ•°æ®æ—¶ï¼Œä½¿ç”¨äº‹åŠ¡ç¡®ä¿ä¸¤å¼ è¡¨çš„æ•°æ®ä¸€è‡´æ€§ã€‚ å‚ç›´æ‹†åˆ†çš„åŸåˆ™ï¼š\n\n*   æŠŠä¸å¸¸ç”¨çš„å­—æ®µå•ç‹¬æ”¾åœ¨ä¸€å¼ è¡¨ï¼›\n\n*   æŠŠ textï¼Œblob ç­‰å¤§å­—æ®µæ‹†åˆ†å‡ºæ¥æ”¾åœ¨é™„è¡¨ä¸­ï¼›\n\n*   ç»å¸¸ç»„åˆæŸ¥è¯¢çš„åˆ—æ”¾åœ¨ä¸€å¼ è¡¨ä¸­ã€‚\n\n**bï¼‰æ°´å¹³æ‹†åˆ†**ï¼šæŒ‡æ•°æ®è¡¨è¡Œçš„æ‹†åˆ†ï¼Œè¡¨çš„è¡Œæ•°è¶…è¿‡ 200 ä¸‡è¡Œæ—¶ï¼Œå°±ä¼šå˜æ…¢ï¼Œè¿™æ—¶å¯ä»¥æŠŠä¸€å¼ çš„è¡¨çš„æ•°æ®æ‹†æˆå¤šå¼ è¡¨æ¥å­˜æ”¾ã€‚\n\né€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨å–æ¨¡çš„æ–¹å¼æ¥è¿›è¡Œè¡¨çš„æ‹†åˆ†ï¼Œæ¯”å¦‚ï¼Œä¸€å¼ æœ‰ 400W çš„ç”¨æˆ·è¡¨ usersï¼Œä¸ºæé«˜å…¶æŸ¥è¯¢æ•ˆç‡æˆ‘ä»¬æŠŠå…¶åˆ†æˆ 4 å¼ è¡¨ users1ï¼Œusers2ï¼Œusers3ï¼Œusers4ï¼Œç„¶åé€šè¿‡ç”¨æˆ· ID å–æ¨¡çš„æ–¹æ³•ï¼ŒåŒæ—¶æŸ¥è¯¢ã€æ›´æ–°ã€åˆ é™¤ä¹Ÿæ˜¯é€šè¿‡å–æ¨¡çš„æ–¹æ³•æ¥æ“ä½œã€‚\n\n#### â‘¤ è¯»å†™åˆ†ç¦»\n\nä¸€èˆ¬æƒ…å†µä¸‹å¯¹æ•°æ®åº“è€Œè¨€éƒ½æ˜¯â€œè¯»å¤šå†™å°‘â€ï¼Œæ¢è¨€ä¹‹ï¼Œæ•°æ®åº“çš„å‹åŠ›å¤šæ•°æ˜¯å› ä¸ºå¤§é‡çš„è¯»å–æ•°æ®çš„æ“ä½œé€ æˆçš„ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨æ•°æ®åº“é›†ç¾¤çš„æ–¹æ¡ˆï¼Œä½¿ç”¨ä¸€ä¸ªåº“ä½œä¸ºä¸»åº“ï¼Œè´Ÿè´£å†™å…¥æ•°æ®ï¼›å…¶ä»–åº“ä¸ºä»åº“ï¼Œè´Ÿè´£è¯»å–æ•°æ®ã€‚è¿™æ ·å¯ä»¥ç¼“è§£å¯¹æ•°æ®åº“çš„è®¿é—®å‹åŠ›ã€‚\n\n### MySQL å¸¸è§è¯»å†™åˆ†ç¦»æ–¹æ¡ˆæœ‰å“ªäº›ï¼Ÿ\n\nMySQL å¸¸è§çš„è¯»å†™åˆ†ç¦»æ–¹æ¡ˆï¼Œå¦‚ä¸‹åˆ—è¡¨ï¼š\n\n**1ï¼‰åº”ç”¨å±‚è§£å†³æ–¹æ¡ˆ** å¯ä»¥é€šè¿‡åº”ç”¨å±‚å¯¹æ•°æ®æºåšè·¯ç”±æ¥å®ç°è¯»å†™åˆ†ç¦»ï¼Œæ¯”å¦‚ï¼Œä½¿ç”¨ SpringMVC + MyBatisï¼Œå¯ä»¥å°† SQL è·¯ç”±äº¤ç»™ Springï¼Œé€šè¿‡ AOP æˆ–è€… Annotation ç”±ä»£ç æ˜¾ç¤ºçš„æ§åˆ¶æ•°æ®æºã€‚ ä¼˜ç‚¹ï¼šè·¯ç”±ç­–ç•¥çš„æ‰©å±•æ€§å’Œå¯æ§æ€§è¾ƒå¼ºã€‚ ç¼ºç‚¹ï¼šéœ€è¦åœ¨ Spring ä¸­æ·»åŠ è€¦åˆæ§åˆ¶ä»£ç ã€‚\n\n**2ï¼‰ä¸­é—´ä»¶è§£å†³æ–¹æ¡ˆ** é€šè¿‡ MySQL çš„ä¸­é—´ä»¶åšä¸»ä»é›†ç¾¤ï¼Œæ¯”å¦‚ï¼šMysql Proxyã€Amoebaã€Atlas ç­‰ä¸­é—´ä»¶éƒ½èƒ½ç¬¦åˆéœ€æ±‚ã€‚ ä¼˜ç‚¹ï¼šä¸åº”ç”¨å±‚è§£è€¦ã€‚ ç¼ºç‚¹ï¼šå¢åŠ ä¸€ä¸ªæœåŠ¡ç»´æŠ¤çš„é£é™©ç‚¹ï¼Œæ€§èƒ½åŠç¨³å®šæ€§å¾…æµ‹è¯•ï¼Œéœ€è¦æ”¯æŒä»£ç å¼ºåˆ¶ä¸»ä»å’Œäº‹åŠ¡ã€‚\n\n### æ€æ ·ä¿è¯ç¡®ä¿å¤‡åº“æ— å»¶è¿Ÿï¼Ÿ\n\né€šå¸¸ä¿è¯ä¸»å¤‡æ— å»¶è¿Ÿæœ‰ä»¥ä¸‹ä¸‰ç§æ–¹æ³•ï¼š\n\n*   æ¯æ¬¡ä»åº“æ‰§è¡ŒæŸ¥è¯¢è¯·æ±‚å‰ï¼Œå…ˆåˆ¤æ–­ seconds*behind*master æ˜¯å¦å·²ç»ç­‰äº 0ã€‚å¦‚æœè¿˜ä¸ç­‰äº 0 ï¼Œé‚£å°±å¿…é¡»ç­‰åˆ°è¿™ä¸ªå‚æ•°å˜ä¸º 0 æ‰èƒ½æ‰§è¡ŒæŸ¥è¯¢è¯·æ±‚ï¼Œseconds*behind*master å‚æ•°æ˜¯ç”¨æ¥è¡¡é‡ä¸»å¤‡å»¶è¿Ÿæ—¶é—´çš„é•¿çŸ­ï¼›\n\n*   å¯¹æ¯”ä½ç‚¹ç¡®ä¿ä¸»å¤‡æ— å»¶è¿Ÿã€‚Master*Log*File å’Œ Read*Master*Log*Posï¼Œè¡¨ç¤ºçš„æ˜¯è¯»åˆ°çš„ä¸»åº“çš„æœ€æ–°ä½ç‚¹ï¼ŒRelay*Master*Log*File å’Œ Exec*Master*Log_Posï¼Œè¡¨ç¤ºçš„æ˜¯å¤‡åº“æ‰§è¡Œçš„æœ€æ–°ä½ç‚¹ï¼›\n\n*   å¯¹æ¯” GTID é›†åˆç¡®ä¿ä¸»å¤‡æ— å»¶è¿Ÿã€‚Auto*Position=1 ï¼Œè¡¨ç¤ºè¿™å¯¹ä¸»å¤‡å…³ç³»ä½¿ç”¨äº† GTID åè®®ï¼›Retrieved*Gtid*Setï¼Œæ˜¯å¤‡åº“æ”¶åˆ°çš„æ‰€æœ‰æ—¥å¿—çš„ GTID é›†åˆï¼›Executed*Gtid_Setï¼Œæ˜¯å¤‡åº“æ‰€æœ‰å·²ç»æ‰§è¡Œå®Œæˆçš„ GTID é›†åˆã€‚\n\n## MySQLå¼€æ”¾é—®é¢˜\n\n### æœ‰ä¸€ä¸ªè¶…çº§å¤§è¡¨ï¼Œå¦‚ä½•ä¼˜åŒ–åˆ†é¡µæŸ¥è¯¢ï¼Ÿ\n\nè¶…çº§å¤§è¡¨çš„åˆ†é¡µä¼˜åŒ–åˆ†æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹å¼ï¼š\n\n*   æ•°æ®åº“å±‚é¢ä¼˜åŒ–ï¼šåˆ©ç”¨å­æŸ¥è¯¢ä¼˜åŒ–è¶…å¤šåˆ†é¡µåœºæ™¯ï¼Œæ¯”å¦‚ï¼š`SELECT a.* FROM è¡¨ 1 a, (select id from è¡¨ 1 where æ¡ä»¶ LIMIT 100000,20 ) b where a.id=b.id` ï¼Œå…ˆå¿«é€Ÿå®šä½éœ€è¦è·å–çš„ id æ®µï¼Œç„¶åå†å…³è”æŸ¥è¯¢ã€‚MySQL å¹¶ä¸æ˜¯è·³è¿‡ offset è¡Œï¼Œè€Œæ˜¯å– offset+N è¡Œï¼Œç„¶åè¿”å›æ”¾å¼ƒå‰ offset è¡Œï¼Œè¿”å› N è¡Œï¼Œé‚£å½“ offset ç‰¹åˆ«å¤§çš„æ—¶å€™ï¼Œæ•ˆç‡å°±éå¸¸çš„ä½ä¸‹ï¼Œè¦ä¹ˆæ§åˆ¶è¿”å›çš„æ€»é¡µæ•°ï¼Œè¦ä¹ˆå¯¹è¶…è¿‡ç‰¹å®šé˜ˆå€¼çš„é¡µæ•°è¿›è¡Œ SQL æ”¹å†™ï¼Œ\n\t**åˆ©ç”¨å­æŸ¥è¯¢å…ˆå¿«é€Ÿå®šä½éœ€è¦è·å–çš„ id æ®µï¼Œç„¶åå†å…³è”æŸ¥è¯¢ï¼Œå°±æ˜¯å¯¹åˆ†é¡µè¿›è¡Œ SQL æ”¹å†™çš„å…·ä½“å®ç°**ï¼›\n\n*   ç¨‹åºå±‚é¢ä¼˜åŒ–ï¼šå¯ä»¥åˆ©ç”¨**ç¼“å­˜**æŠŠæŸ¥è¯¢çš„ç»“æœç¼“å­˜èµ·æ¥ï¼Œè¿™æ ·å†ä¸‹ä¸€æ¬¡æŸ¥è¯¢çš„æ—¶å€™æ€§èƒ½å°±éå¸¸é«˜äº†ã€‚\n\n### â­æŸ¥è¯¢é•¿æ—¶é—´ä¸è¿”å›å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿåº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ\n\næŸ¥è¯¢é€Ÿåº¦æ…¢çš„åŸå› å¾ˆå¤šï¼Œå¸¸è§å¦‚ä¸‹å‡ ç§ï¼š\n\n 1ï¼‰æŸ¥è¯¢å­—æ®µæ²¡æœ‰ç´¢å¼•æˆ–è€…æ²¡æœ‰è§¦å‘ç´¢å¼•æŸ¥è¯¢ï¼Œæ²¡æœ‰è§¦å‘ç´¢å¼•æŸ¥è¯¢çš„æƒ…å†µå¦‚ä¸‹ï¼š \n\n*   ä»¥ % å¼€å¤´çš„ like æŸ¥è¯¢\n\n*   æ•°æ®ç±»å‹å‡ºç°éšå¼è½¬æ¢æ—¶ä¸ä¼šä½¿ç”¨ç´¢å¼•\n\n*   ä¸ç¬¦åˆæœ€å·¦å‰ç¼€åŸåˆ™ï¼›\n\n*   å¦‚æœæŸ¥è¯¢æ¡ä»¶æœ‰ or åˆ†å‰²ï¼Œå¦‚æœæœ‰ or çš„å­—æ®µæ²¡æœ‰ç´¢å¼•ï¼Œä¼šå¼•èµ·å…¨è¡¨æŸ¥è¯¢ï¼›\n\n*   å¦‚æœ MySQL è®¤ä¸ºä½¿ç”¨ç´¢å¼•ä¼šæ¯”å…¨è¡¨æŸ¥è¯¢æ›´æ…¢ï¼Œåˆ™ä¸ä¼šä½¿ç”¨ç´¢å¼•ã€‚\n\n2ï¼‰I/O å‹åŠ›å¤§ï¼Œè¯»å–ç£ç›˜é€Ÿåº¦å˜æ…¢ï¼Œdf çœ‹ç¡¬ç›˜\n\n3ï¼‰å†…å­˜ä¸è¶³ï¼Œfree çœ‹å†…å­˜ï¼ˆtop çœ‹ cpuï¼‰\n\n4ï¼‰ç½‘ç»œé€Ÿåº¦æ…¢ \n\n5ï¼‰æŸ¥è¯¢å‡ºçš„æ•°æ®é‡è¿‡å¤§ï¼Œå¯ä»¥é‡‡ç”¨å¤šæ¬¡æŸ¥è¯¢æˆ–å…¶ä»–çš„æ–¹æ³•é™ä½æ•°æ®é‡ \n\n6ï¼‰æ­»é”ï¼Œä¸€èˆ¬ç¢°åˆ°è¿™ç§æƒ…å†µçš„è¯ï¼Œå¤§æ¦‚ç‡æ˜¯è¡¨è¢«é”ä½äº†ï¼Œå¯ä»¥ä½¿ç”¨ `show processlist;` å‘½ä»¤ï¼Œçœ‹çœ‹ SQL è¯­å¥çš„çŠ¶æ€ï¼Œå†é’ˆå¯¹ä¸åŒçš„çŠ¶æ€åšç›¸åº”çš„å¤„ç†ã€‚\n\n![avatar](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes11474088-1a918d44eacc26e6.png) \n\nå…¶ä¸­ï¼Œå½“ State åˆ—å€¼ä¸º Locked æ—¶ï¼Œè¡¨ç¤ºè¢«é”å®šã€‚\n\nä»¥ä¸Šé—®é¢˜çš„è§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š\n\n1ï¼‰æ­£ç¡®åˆ›å»ºå’Œä½¿ç”¨ç´¢å¼•ã€‚ \n\n2ï¼‰æŠŠæ•°æ®ã€æ—¥å¿—ã€ç´¢å¼•æ”¾åˆ°ä¸åŒçš„ IO è®¾å¤‡ä¸Šï¼Œå‡å°‘ä¸»æ•°æ®åº“çš„ IO æ“ä½œã€‚æ›´æ¢ MySQL çš„ç£ç›˜ä¸ºå›ºæ€ç¡¬ç›˜ï¼Œä»¥æé«˜ç£ç›˜çš„ IO æ€§èƒ½ã€‚ \n\n3ï¼‰å‡çº§å†…å­˜ï¼Œæ›´æ¢æ›´å¤§çš„å†…å­˜ã€‚ \n\n4ï¼‰æå‡ç½‘é€Ÿï¼Œå‡çº§å¸¦å®½ã€‚ \n\n5ï¼‰ç”¨ Profiler æ¥è·Ÿè¸ªæŸ¥è¯¢ï¼Œå¾—åˆ°æŸ¥è¯¢æ‰€éœ€çš„æ—¶é—´ï¼Œæ‰¾å‡ºæœ‰é—®é¢˜çš„ SQL è¯­å¥ï¼Œä¼˜åŒ– SQLã€‚ \n\n6ï¼‰æŸ¥è¯¢æ—¶å€¼è¿”å›éœ€è¦çš„å­—æ®µã€‚ \n\n7ï¼‰è®¾ç½®æ­»é”çš„è¶…æ—¶æ—¶é—´ï¼Œé™åˆ¶å’Œé¿å…æ­»é”æ¶ˆè€—è¿‡å¤šæœåŠ¡å™¨çš„èµ„æºã€‚ 8ï¼‰å°½é‡å°‘ç”¨è§†å›¾ï¼Œå®ƒçš„æ•ˆç‡ä½ï¼Œå¯¹è§†å›¾æ“ä½œæ¯”ç›´æ¥å¯¹è¡¨æ“ä½œæ…¢,å¯ä»¥ç”¨å­˜å‚¨è¿‡ç¨‹æ¥ä»£æ›¿è§†å›¾ã€‚ä¸è¦ç”¨è§†å›¾åµŒå¥—ï¼ŒåµŒå¥—è§†å›¾å¢åŠ äº†å¯»æ‰¾åŸå§‹æ•°æ®çš„éš¾åº¦ã€‚\n\n### MySQL ä¸»ä»å»¶è¿Ÿçš„åŸå› æœ‰å“ªäº›ï¼Ÿ\n\nä¸»ä»å»¶è¿Ÿå¯ä»¥æ ¹æ® MySQL æä¾›çš„å‘½ä»¤åˆ¤æ–­ï¼Œæ¯”å¦‚ï¼Œåœ¨ä»æœåŠ¡å™¨ä½¿ç”¨å‘½ä»¤ï¼š `show slave status;`ï¼Œå…¶ä¸­ Seconds*Behind*Master å¦‚æœä¸º 0 è¡¨ç¤ºä¸»ä»å¤åˆ¶çŠ¶æ€æ­£å¸¸ã€‚ å¯¼è‡´ä¸»ä»å»¶è¿Ÿçš„åŸå› æœ‰ä»¥ä¸‹å‡ ä¸ªï¼š\n\n*   ä¸»åº“æœ‰å¤§äº‹åŠ¡å¤„ç†ï¼›\n\n*   ä¸»åº“åšå¤§é‡çš„å¢ã€åˆ ã€æ”¹æ“ä½œï¼›\n\n*   ä¸»åº“å¯¹å¤§è¡¨è¿›è¡Œå­—æ®µæ–°å¢ã€ä¿®æ”¹æˆ–æ·»åŠ ç´¢å¼•ç­‰æ“ä½œï¼›\n\n*   ä¸»åº“çš„ä»åº“å¤ªå¤šï¼Œå¯¼è‡´å¤åˆ¶å»¶è¿Ÿã€‚ä»åº“æ•°é‡ä¸€èˆ¬ 3-5 ä¸ªä¸ºå®œï¼Œè¦å¤åˆ¶çš„èŠ‚ç‚¹è¿‡å¤šï¼Œå¯¼è‡´å¤åˆ¶å»¶è¿Ÿï¼›\n\n*   ä»åº“ç¡¬ä»¶é…ç½®æ¯”ä¸»åº“å·®ï¼Œå¯¼è‡´å»¶è¿Ÿã€‚æŸ¥çœ‹ Master å’Œ Slave çš„é…ç½®ï¼Œå¯èƒ½å› ä¸ºä»åº“çš„é…ç½®è¿‡ä½ï¼Œæ‰§è¡Œæ—¶é—´é•¿ï¼Œç”±æ­¤å¯¼è‡´çš„å¤åˆ¶å»¶è¿Ÿæ—¶é—´é•¿ï¼›\n\n*   ä¸»åº“è¯»å†™å‹åŠ›å¤§ï¼Œå¯¼è‡´å¤åˆ¶å»¶è¿Ÿï¼›\n\n*   ä»åº“ä¹‹é—´çš„ç½‘ç»œå»¶è¿Ÿã€‚ä¸»ä»åº“ç½‘å¡ã€ç½‘çº¿ã€è¿æ¥çš„äº¤æ¢æœºç­‰ç½‘ç»œè®¾å¤‡éƒ½å¯èƒ½æˆä¸ºå¤åˆ¶çš„ç“¶é¢ˆï¼Œå¯¼è‡´å¤åˆ¶å»¶è¿Ÿï¼Œå¦å¤–è·¨å…¬ç½‘ä¸»ä»å¤åˆ¶å¾ˆå®¹æ˜“å¯¼è‡´ä¸»ä»å¤åˆ¶å»¶è¿Ÿã€‚\n\n### å¦‚ä½•ä¿è¯æ•°æ®ä¸è¢«è¯¯åˆ ï¼Ÿ\n\nä¿è¯æ•°æ®ä¸è¢«è¯¯åˆ çš„æ–¹æ³•å¦‚ä¸‹åˆ—è¡¨ï¼š\n\n*   æƒé™æ§åˆ¶ä¸åˆ†é…ï¼ˆæ•°æ®åº“å’ŒæœåŠ¡å™¨æƒé™ï¼‰\n\n*   é¿å…æ•°æ®åº“è´¦å·ä¿¡æ¯æ³„éœ²ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä¸šåŠ¡ä»£ç ä¸è¦ä½¿ç”¨æ˜æ–‡ä¿å­˜æ•°æ®åº“è¿æ¥ä¿¡æ¯ï¼›\n\n*   é‡è¦çš„æ•°æ®åº“æ“ä½œï¼Œé€šè¿‡å¹³å°å‹å·¥å…·è‡ªåŠ¨å®æ–½ï¼Œå‡å°‘äººå·¥æ“ä½œï¼›\n\n*   éƒ¨ç½²å»¶è¿Ÿå¤åˆ¶ä»åº“ï¼Œä¸‡ä¸€è¯¯åˆ é™¤æ—¶ç”¨äºæ•°æ®å›æ¡£ï¼Œä¸”ä»åº“è®¾ç½®ä¸º read-onlyï¼›\n\n*   ç¡®è®¤å¤‡ä»½åˆ¶åº¦åŠæ—¶æœ‰æ•ˆï¼›\n\n*   å¯ç”¨ SQL å®¡è®¡åŠŸèƒ½ï¼Œå…»æˆè‰¯å¥½ SQL ä¹ æƒ¯ï¼›\n\n*   å¯ç”¨ sql*safe*updates é€‰é¡¹ï¼Œä¸å…è®¸æ²¡ where æ¡ä»¶çš„æ›´æ–°/åˆ é™¤ï¼›\n\n*   å°†ç³»ç»Ÿå±‚çš„ rm æ”¹ä¸º mvï¼›\n\n*   çº¿ä¸Šä¸è¿›è¡Œç‰©ç†åˆ é™¤ï¼Œæ”¹ä¸ºé€»è¾‘åˆ é™¤ï¼ˆå°† row data æ ‡è®°ä¸ºä¸å¯ç”¨ï¼‰ï¼›\n\n*   å¯ç”¨å ¡å’æœºï¼Œå±è”½é«˜å± SQLï¼›\n\n*   é™ä½æ•°æ®åº“ä¸­æ™®é€šè´¦å·çš„æƒé™çº§åˆ«ï¼›\n\n*   å¼€å¯ binlogï¼Œæ–¹ä¾¿è¿½æº¯æ•°æ®ã€‚\n\n### â­MySQL æœåŠ¡å™¨ CPU é£™å‡åº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ\n\nä½¿ç”¨ `show full processlist;` æŸ¥å‡ºæ…¢æŸ¥è¯¢ï¼Œä¸ºäº†ç¼“è§£æ•°æ®åº“æœåŠ¡å™¨å‹åŠ›ï¼Œå…ˆä½¿ç”¨ kill å‘½ä»¤æ€æ‰æ…¢æŸ¥è¯¢çš„å®¢æˆ·ç«¯ï¼Œç„¶åå†å»é¡¹ç›®ä¸­æ‰¾åˆ°æ‰§è¡Œæ…¢çš„ SQL è¯­å¥è¿›è¡Œä¿®æ”¹å’Œä¼˜åŒ–ã€‚\n\n### MySQL æ¯«æ— è§„å¾‹çš„å¼‚å¸¸é‡å¯ï¼Œå¯èƒ½äº§ç”Ÿçš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿè¯¥å¦‚ä½•è§£å†³ï¼Ÿ\n\nå¯èƒ½æ˜¯ç§¯ç´¯çš„é•¿è¿æ¥å¯¼è‡´å†…å­˜å ç”¨å¤ªå¤šï¼Œè¢«ç³»ç»Ÿå¼ºè¡Œæ€æ‰å¯¼è‡´çš„å¼‚å¸¸é‡å¯ï¼Œå› ä¸ºåœ¨ MySQL ä¸­é•¿è¿æ¥åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä½¿ç”¨çš„ä¸´æ—¶å†…å­˜å¯¹è±¡ï¼Œåªæœ‰åœ¨è¿æ¥æ–­å¼€çš„æ—¶å€™æ‰ä¼šé‡Šæ”¾ï¼Œè¿™å°±ä¼šå¯¼è‡´å†…å­˜ä¸æ–­é£™å‡ï¼Œè§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š\n\n*   å®šæœŸæ–­å¼€ç©ºé—²çš„é•¿è¿æ¥ï¼›\n\n*   å¦‚æœæ˜¯ç”¨çš„æ˜¯ MySQL 5.7 ä»¥ä¸Šçš„ç‰ˆæœ¬ï¼Œå¯ä»¥å®šæœŸæ‰§è¡Œ mysql*reset*connection é‡æ–°åˆå§‹åŒ–è¿æ¥èµ„æºï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šé‡Šæ”¾ä¹‹å‰ä½¿ç”¨çš„å†…å­˜èµ„æºï¼Œæ¢å¤åˆ°è¿æ¥åˆšåˆå§‹åŒ–çš„çŠ¶æ€ã€‚\n\n### å¦‚ä½•å®ç°ä¸€ä¸ªé«˜å¹¶å‘çš„ç³»ç»Ÿï¼Ÿ\n\nè¿™é“é¢è¯•é¢˜æ¶‰åŠçš„çŸ¥è¯†ç‚¹æ¯”è¾ƒå¤šï¼Œä¸»è¦è€ƒå¯Ÿçš„æ˜¯é¢è¯•è€…çš„ç»¼åˆæŠ€æœ¯èƒ½åŠ›ã€‚é«˜å¹¶å‘ç³»ç»Ÿçš„è®¾è®¡æ‰‹æ®µæœ‰å¾ˆå¤šï¼Œä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹äº”ä¸ªæ–¹é¢ã€‚\n\n#### 1ï¼‰å‰ç«¯ä¼˜åŒ–\n\nâ‘  é™æ€èµ„æºç¼“å­˜ï¼šå°†æ´»åŠ¨é¡µé¢ä¸Šçš„æ‰€æœ‰å¯ä»¥é™æ€çš„å…ƒç´ å…¨éƒ¨é™æ€åŒ–ï¼Œå°½é‡å‡å°‘åŠ¨æ€å…ƒç´ ï¼›é€šè¿‡ CDNã€æµè§ˆå™¨ç¼“å­˜ï¼Œæ¥å‡å°‘å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯çš„æ•°æ®è¯·æ±‚ã€‚ \nâ‘¡ ç¦æ­¢é‡å¤æäº¤ï¼šç”¨æˆ·æäº¤ä¹‹åæŒ‰é’®ç½®ç°ï¼Œç¦æ­¢é‡å¤æäº¤ã€‚ \nâ‘¢ ç”¨æˆ·é™æµï¼šåœ¨æŸä¸€æ—¶é—´æ®µå†…åªå…è®¸ç”¨æˆ·æäº¤ä¸€æ¬¡è¯·æ±‚ï¼Œæ¯”å¦‚ï¼Œé‡‡å– IP é™æµã€‚\n\n#### 2ï¼‰ä¸­é—´å±‚è´Ÿè½½åˆ†å‘\n\nå¯åˆ©ç”¨è´Ÿè½½å‡è¡¡ï¼Œæ¯”å¦‚ nginx ç­‰å·¥å…·ï¼Œå¯ä»¥å°†å¹¶å‘è¯·æ±‚åˆ†é…åˆ°ä¸åŒçš„æœåŠ¡å™¨ï¼Œä»è€Œæé«˜äº†ç³»ç»Ÿå¤„ç†å¹¶å‘çš„èƒ½åŠ›ã€‚ nginx è´Ÿè½½åˆ†å‘çš„äº”ç§æ–¹å¼ï¼š\n\nâ‘  è½®è¯¢ï¼ˆé»˜è®¤ï¼‰ æ¯ä¸ªè¯·æ±‚æŒ‰æ—¶é—´é¡ºåºé€ä¸€åˆ†é…åˆ°ä¸åŒçš„åç«¯æœåŠ¡å™¨ï¼Œå¦‚æœåç«¯æœåŠ¡å™¨ä¸èƒ½æ­£å¸¸å“åº”ï¼Œnginx èƒ½è‡ªåŠ¨å‰”é™¤æ•…éšœæœåŠ¡å™¨ã€‚ â‘¡ æŒ‰æƒé‡ï¼ˆweightï¼‰ ä½¿ç”¨ weight å‚æ•°ï¼ŒæŒ‡å®šè½®è¯¢å‡ ç‡ï¼Œweight å’Œè®¿é—®æ¯”ç‡æˆæ­£æ¯”ï¼Œç”¨äºåç«¯æœåŠ¡å™¨æ€§èƒ½ä¸å‡çš„æƒ…å†µï¼Œé…ç½®å¦‚ä¸‹ï¼š\n\n```\nupstream backend { \n    server 192.168.0.14 weight=10; \n    server 192.168.0.15 weight=10; \n}\n```\n\nâ‘¢ IP å“ˆå¸Œå€¼ï¼ˆip_hashï¼‰ æ¯ä¸ªè¯·æ±‚æŒ‰è®¿é—® IP çš„å“ˆå¸Œå€¼åˆ†é…ï¼Œè¿™æ ·æ¯ä¸ªè®¿å®¢å›ºå®šè®¿é—®ä¸€ä¸ªåç«¯æœåŠ¡å™¨ï¼Œå¯ä»¥è§£å†³ session å…±äº«çš„é—®é¢˜ï¼Œé…ç½®å¦‚ä¸‹ï¼š\n\n```\nupstream backend { \n    ip_hash; \n    server 192.168.0.14:88; \n    server 192.168.0.15:80; \n}\n```\n\nâ‘£ å“åº”æ—¶é—´ï¼ˆfairï¼‰ æŒ‰åç«¯æœåŠ¡å™¨çš„å“åº”æ—¶é—´æ¥åˆ†é…è¯·æ±‚ï¼Œå“åº”æ—¶é—´çŸ­çš„ä¼˜å…ˆåˆ†é…ï¼Œé…ç½®å¦‚ä¸‹ï¼š\n\n```\nupstream backend { \n    fair; \n    server server1.com; \n    server server2.com; \n}\n```\n\nâ‘¤ URL å“ˆå¸Œå€¼ï¼ˆurl_hashï¼‰ æŒ‰è®¿é—® url çš„ hash ç»“æœæ¥åˆ†é…è¯·æ±‚ï¼Œå’Œ IP å“ˆå¸Œå€¼ç±»ä¼¼ã€‚\n\n```\nupstream backend {\n    hash $request_uri;\n    server server1.com; \n    server server2.com;   \n}\n```\n\n#### 3ï¼‰æ§åˆ¶å±‚ï¼ˆç½‘å…³å±‚ï¼‰\n\né™åˆ¶åŒä¸€ä¸ªç”¨æˆ·çš„è®¿é—®é¢‘ç‡ï¼Œé™åˆ¶è®¿é—®æ¬¡æ•°ï¼Œé˜²æ­¢å¤šæ¬¡æ¶æ„è¯·æ±‚ã€‚\n\n#### 4ï¼‰æœåŠ¡å±‚\n\nâ‘  ä¸šåŠ¡æœåŠ¡å™¨åˆ†ç¦»ï¼šæ¯”å¦‚ï¼Œå°†ç§’æ€ä¸šåŠ¡ç³»ç»Ÿå’Œå…¶ä»–ä¸šåŠ¡åˆ†ç¦»ï¼Œå•ç‹¬æ”¾åœ¨é«˜é…æœåŠ¡å™¨ä¸Šï¼Œå¯ä»¥é›†ä¸­èµ„æºå¯¹è®¿é—®è¯·æ±‚æŠ—å‹ã€‚ \nâ‘¡ é‡‡ç”¨ MQï¼ˆæ¶ˆæ¯é˜Ÿåˆ—ï¼‰ç¼“å­˜è¯·æ±‚ï¼šMQ å…·æœ‰å‰Šå³°å¡«è°·çš„ä½œç”¨ï¼Œå¯ä»¥æŠŠå®¢æˆ·ç«¯çš„è¯·æ±‚å…ˆå¯¼æµåˆ° MQï¼Œç¨‹åºåœ¨ä» MQ ä¸­è¿›è¡Œæ¶ˆè´¹ï¼ˆæ‰§è¡Œè¯·æ±‚ï¼‰ï¼Œè¿™æ ·å¯ä»¥é¿å…çŸ­æ—¶é—´å†…å¤§é‡è¯·æ±‚ï¼Œå¯¼è‡´æœåŠ¡å™¨ç¨‹åºæ— æ³•å“åº”çš„é—®é¢˜ã€‚ \nâ‘¢ åˆ©ç”¨ç¼“å­˜åº”å¯¹è¯»è¯·æ±‚ï¼Œæ¯”å¦‚ï¼Œä½¿ç”¨ Redis ç­‰ç¼“å­˜ï¼Œåˆ©ç”¨ Redis å¯ä»¥åˆ†æ‹…æ•°æ®åº“å¾ˆå¤§ä¸€éƒ¨åˆ†å‹åŠ›ã€‚\n\n#### 5ï¼‰æ•°æ®åº“å±‚\n\nâ‘  åˆç†ä½¿ç”¨æ•°æ®åº“å¼•æ“ â‘¡ åˆç†è®¾ç½®äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Œåˆç†ä½¿ç”¨äº‹åŠ¡ â‘¢ æ­£ç¡®ä½¿ç”¨ SQL è¯­å¥å’ŒæŸ¥è¯¢ç´¢å¼• â‘£ åˆç†åˆ†åº“åˆ†è¡¨ â‘¤ ä½¿ç”¨æ•°æ®åº“ä¸­é—´ä»¶å®ç°æ•°æ®åº“è¯»å†™åˆ†ç¦» â‘¥ è®¾ç½®æ•°æ®åº“ä¸»ä»è¯»å†™åˆ†ç¦»\n\n\n\n## è¡¥å……\n\n### æŸ¥è¯¢è¯­å¥ä¸åŒå…ƒç´ ï¼ˆwhereã€jionã€limitã€group byã€having ç­‰ç­‰ï¼‰æ‰§è¡Œå…ˆåé¡ºåºï¼Ÿ\n\næŸ¥è¯¢ä¸­ç”¨åˆ°çš„å…³é”®è¯ä¸»è¦åŒ…å«å…­ä¸ªï¼Œå¹¶ä¸”ä»–ä»¬çš„é¡ºåºä¾æ¬¡ä¸º `select--from--where--group by--having--order by`\n\nå…¶ä¸­ select å’Œ from æ˜¯å¿…é¡»çš„ï¼Œå…¶ä»–å…³é”®è¯æ˜¯å¯é€‰çš„ï¼Œè¿™å…­ä¸ªå…³é”®è¯çš„æ‰§è¡Œé¡ºåº ä¸ sql è¯­å¥çš„ä¹¦å†™é¡ºåºå¹¶ä¸æ˜¯ä¸€æ ·çš„ï¼Œè€Œæ˜¯æŒ‰ç…§ä¸‹é¢çš„é¡ºåºæ¥æ‰§è¡Œ\n\n- from:éœ€è¦ä»å“ªä¸ªæ•°æ®è¡¨æ£€ç´¢æ•°æ®\n- where:è¿‡æ»¤è¡¨ä¸­æ•°æ®çš„æ¡ä»¶\n- group by:å¦‚ä½•å°†ä¸Šé¢è¿‡æ»¤å‡ºçš„æ•°æ®åˆ†ç»„\n- having:å¯¹ä¸Šé¢å·²ç»åˆ†ç»„çš„æ•°æ®è¿›è¡Œè¿‡æ»¤çš„æ¡ä»¶\n- select:æŸ¥çœ‹ç»“æœé›†ä¸­çš„å“ªä¸ªåˆ—ï¼Œæˆ–åˆ—çš„è®¡ç®—ç»“æœ\n- order by :æŒ‰ç…§ä»€ä¹ˆæ ·çš„é¡ºåºæ¥æŸ¥çœ‹è¿”å›çš„æ•°æ®\n\nfrom åé¢çš„è¡¨å…³è”ï¼Œæ˜¯è‡ªå³å‘å·¦è§£æ è€Œ where æ¡ä»¶çš„è§£æé¡ºåºæ˜¯è‡ªä¸‹è€Œä¸Šçš„ã€‚\n\nä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨å†™ SQL æ–‡çš„æ—¶å€™ï¼Œå°½é‡æŠŠæ•°æ®é‡å°çš„è¡¨æ”¾åœ¨æœ€å³è¾¹æ¥è¿›è¡Œå…³è”ï¼ˆç”¨å°è¡¨å»åŒ¹é…å¤§è¡¨ï¼‰ï¼Œè€ŒæŠŠèƒ½ç­›é€‰å‡ºå°é‡æ•°æ®çš„æ¡ä»¶æ”¾åœ¨ where è¯­å¥çš„æœ€å·¦è¾¹ ï¼ˆç”¨å°è¡¨å»åŒ¹é…å¤§è¡¨ï¼‰\n\n### éå…³ç³»å‹æ•°æ®åº“å’Œå…³ç³»å‹æ•°æ®åº“åŒºåˆ«ï¼Œä¼˜åŠ¿æ¯”è¾ƒï¼Ÿ\n\n#### éå…³ç³»å‹æ•°æ®åº“çš„ä¼˜åŠ¿\n\n**1. æ€§èƒ½**\n\nNOSQL æ˜¯åŸºäºé”®å€¼å¯¹çš„ï¼Œå¯ä»¥æƒ³è±¡æˆè¡¨ä¸­çš„ä¸»é”®å’Œå€¼çš„å¯¹åº”å…³ç³»ï¼Œè€Œä¸”ä¸éœ€è¦ç»è¿‡ SQL å±‚çš„è§£æï¼Œæ‰€ä»¥æ€§èƒ½éå¸¸é«˜ã€‚\n\n**2. å¯æ‰©å±•æ€§**\n\nåŒæ ·ä¹Ÿæ˜¯å› ä¸ºåŸºäºé”®å€¼å¯¹ï¼Œæ•°æ®ä¹‹é—´æ²¡æœ‰è€¦åˆæ€§ï¼Œæ‰€ä»¥éå¸¸å®¹æ˜“æ°´å¹³æ‰©å±•ã€‚\n\n#### å…³ç³»å‹æ•°æ®åº“çš„ä¼˜åŠ¿\n\n**1. å¤æ‚æŸ¥è¯¢**\n\nå¯ä»¥ç”¨ SQL è¯­å¥æ–¹ä¾¿çš„åœ¨ä¸€ä¸ªè¡¨ä»¥åŠå¤šä¸ªè¡¨ä¹‹é—´åšéå¸¸å¤æ‚çš„æ•°æ®æŸ¥è¯¢ã€‚\n\n**2. äº‹åŠ¡æ”¯æŒ**\n\nä½¿å¾—å¯¹äºå®‰å…¨æ€§èƒ½å¾ˆé«˜çš„æ•°æ®è®¿é—®è¦æ±‚å¾—ä»¥å®ç°ã€‚\n\n#### æ€»ç»“\n\n**å¯¹äºè¿™ä¸¤ç±»æ•°æ®åº“ï¼Œå¯¹æ–¹çš„ä¼˜åŠ¿å°±æ˜¯è‡ªå·±çš„å¼±åŠ¿ï¼Œåä¹‹äº¦ç„¶**ã€‚\n\nNOSQL æ•°æ®åº“æ…¢æ…¢å¼€å§‹å…·å¤‡ SQL æ•°æ®åº“çš„ä¸€äº›å¤æ‚æŸ¥è¯¢åŠŸèƒ½ï¼Œæ¯”å¦‚ MongoDBã€‚\n\nå¯¹äºäº‹åŠ¡çš„æ”¯æŒä¹Ÿå¯ä»¥ç”¨ä¸€äº›ç³»ç»Ÿçº§çš„åŸå­æ“ä½œæ¥å®ç°ä¾‹å¦‚ä¹è§‚é”ä¹‹ç±»çš„æ–¹æ³•æ¥æ›²çº¿æ•‘å›½ï¼Œæ¯”å¦‚ Redis set nxã€‚\n\n### æ•°æ®åº“ä¸‰èŒƒå¼ï¼Œæ ¹æ®æŸä¸ªåœºæ™¯è®¾è®¡æ•°æ®è¡¨ï¼Ÿ\n\n- æ‰€æœ‰å­—æ®µå€¼éƒ½æ˜¯ä¸å¯åˆ†è§£çš„åŸå­å€¼ã€‚\n- åœ¨ä¸€ä¸ªæ•°æ®åº“è¡¨ä¸­ï¼Œä¸€ä¸ªè¡¨ä¸­åªèƒ½ä¿å­˜ä¸€ç§æ•°æ®ï¼Œä¸å¯ä»¥æŠŠå¤šç§æ•°æ®ä¿å­˜åœ¨åŒä¸€å¼ æ•°æ®åº“è¡¨ä¸­ã€‚\n- æ•°æ®è¡¨ä¸­çš„æ¯ä¸€åˆ—æ•°æ®éƒ½å’Œä¸»é”®ç›´æ¥ç›¸å…³ï¼Œè€Œä¸èƒ½é—´æ¥ç›¸å…³ã€‚\n\n#### ç¬¬ä¸€èŒƒå¼(ç¡®ä¿æ¯åˆ—ä¿æŒåŸå­æ€§)\n\n**ç¬¬ä¸€èŒƒå¼æ˜¯æœ€åŸºæœ¬çš„èŒƒå¼ã€‚å¦‚æœæ•°æ®åº“è¡¨ä¸­çš„æ‰€æœ‰å­—æ®µå€¼éƒ½æ˜¯ä¸å¯åˆ†è§£çš„åŸå­å€¼ï¼Œå°±è¯´æ˜è¯¥æ•°æ®åº“è¡¨æ»¡è¶³äº†ç¬¬ä¸€èŒƒå¼**ã€‚\n\nç¬¬ä¸€èŒƒå¼çš„åˆç†éµå¾ªéœ€è¦æ ¹æ®ç³»ç»Ÿçš„å®é™…éœ€æ±‚æ¥å®šã€‚æ¯”å¦‚æŸäº›æ•°æ®åº“ç³»ç»Ÿä¸­éœ€è¦ç”¨åˆ°â€œåœ°å€â€è¿™ä¸ªå±æ€§ï¼Œæœ¬æ¥ç›´æ¥å°†â€œåœ°å€â€å±æ€§è®¾è®¡æˆä¸€ä¸ªæ•°æ®åº“è¡¨çš„å­—æ®µå°±è¡Œã€‚ä½†æ˜¯å¦‚æœç³»ç»Ÿç»å¸¸ä¼šè®¿é—®â€œåœ°å€â€å±æ€§ä¸­çš„â€œåŸå¸‚â€éƒ¨åˆ†ï¼Œé‚£ä¹ˆå°±éè¦å°†â€œåœ°å€â€è¿™ä¸ªå±æ€§é‡æ–°æ‹†åˆ†ä¸ºçœä»½ã€åŸå¸‚ã€è¯¦ç»†åœ°å€ç­‰å¤šä¸ªéƒ¨åˆ†è¿›è¡Œå­˜å‚¨ï¼Œè¿™æ ·åœ¨å¯¹åœ°å€ä¸­æŸä¸€éƒ¨åˆ†æ“ä½œçš„æ—¶å€™å°†éå¸¸æ–¹ä¾¿ã€‚è¿™æ ·è®¾è®¡æ‰ç®—æ»¡è¶³äº†æ•°æ®åº“çš„ç¬¬ä¸€èŒƒå¼ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚\n\nä¸Šè¡¨æ‰€ç¤ºçš„ç”¨æˆ·ä¿¡æ¯éµå¾ªäº†ç¬¬ä¸€èŒƒå¼çš„è¦æ±‚ï¼Œè¿™æ ·åœ¨å¯¹ç”¨æˆ·ä½¿ç”¨åŸå¸‚è¿›è¡Œåˆ†ç±»çš„æ—¶å€™å°±éå¸¸æ–¹ä¾¿ï¼Œä¹Ÿæé«˜äº†æ•°æ®åº“çš„æ€§èƒ½ã€‚\n\n#### ç¬¬äºŒèŒƒå¼(ç¡®ä¿è¡¨ä¸­çš„æ¯åˆ—éƒ½å’Œä¸»é”®ç›¸å…³)\n\nç¬¬äºŒèŒƒå¼åœ¨ç¬¬ä¸€èŒƒå¼çš„åŸºç¡€ä¹‹ä¸Šæ›´è¿›ä¸€å±‚ã€‚ç¬¬äºŒèŒƒå¼éœ€è¦ç¡®ä¿æ•°æ®åº“è¡¨ä¸­çš„æ¯ä¸€åˆ—éƒ½å’Œä¸»é”®ç›¸å…³ï¼Œè€Œä¸èƒ½åªä¸ä¸»é”®çš„æŸä¸€éƒ¨åˆ†ç›¸å…³ï¼ˆä¸»è¦é’ˆå¯¹è”åˆä¸»é”®è€Œè¨€ï¼‰ã€‚**ä¹Ÿå°±æ˜¯è¯´åœ¨ä¸€ä¸ªæ•°æ®åº“è¡¨ä¸­ï¼Œä¸€ä¸ªè¡¨ä¸­åªèƒ½ä¿å­˜ä¸€ç§æ•°æ®ï¼Œä¸å¯ä»¥æŠŠå¤šç§æ•°æ®ä¿å­˜åœ¨åŒä¸€å¼ æ•°æ®åº“è¡¨ä¸­**ã€‚\n\n**æ¯”å¦‚è¦è®¾è®¡ä¸€ä¸ªè®¢å•ä¿¡æ¯è¡¨ï¼Œå› ä¸ºè®¢å•ä¸­å¯èƒ½ä¼šæœ‰å¤šç§å•†å“ï¼Œæ‰€ä»¥è¦å°†è®¢å•ç¼–å·å’Œå•†å“ç¼–å·ä½œä¸ºæ•°æ®åº“è¡¨çš„è”åˆä¸»é”®**ã€‚\n\n#### ç¬¬ä¸‰èŒƒå¼(ç¡®ä¿æ¯åˆ—éƒ½å’Œä¸»é”®åˆ—ç›´æ¥ç›¸å…³,è€Œä¸æ˜¯é—´æ¥ç›¸å…³)\n\nç¬¬ä¸‰èŒƒå¼éœ€è¦ç¡®ä¿æ•°æ®è¡¨ä¸­çš„**æ¯ä¸€åˆ—æ•°æ®éƒ½å’Œä¸»é”®ç›´æ¥ç›¸å…³ï¼Œè€Œä¸èƒ½é—´æ¥ç›¸å…³**ã€‚\n\næ¯”å¦‚åœ¨è®¾è®¡ä¸€ä¸ªè®¢å•æ•°æ®è¡¨çš„æ—¶å€™ï¼Œå¯ä»¥å°†å®¢æˆ·ç¼–å·ä½œä¸ºä¸€ä¸ªå¤–é”®å’Œè®¢å•è¡¨å»ºç«‹ç›¸åº”çš„å…³ç³»ã€‚è€Œä¸å¯ä»¥åœ¨è®¢å•è¡¨ä¸­æ·»åŠ å…³äºå®¢æˆ·å…¶å®ƒä¿¡æ¯ï¼ˆæ¯”å¦‚å§“åã€æ‰€å±å…¬å¸ç­‰ï¼‰çš„å­—æ®µã€‚\n\n### MySQL é«˜å¹¶å‘ç¯å¢ƒè§£å†³æ–¹æ¡ˆï¼Ÿ\n\nMySQL é«˜å¹¶å‘ç¯å¢ƒè§£å†³æ–¹æ¡ˆ åˆ†åº“ åˆ†è¡¨ åˆ†å¸ƒå¼ å¢åŠ äºŒçº§ç¼“å­˜ã€‚\n\n**éœ€æ±‚åˆ†æ**ï¼šäº’è”ç½‘å•ä½ æ¯å¤©å¤§é‡æ•°æ®è¯»å–ï¼Œå†™å…¥ï¼Œå¹¶å‘æ€§é«˜ã€‚\n\n- **ç°æœ‰è§£å†³æ–¹å¼**ï¼šæ°´å¹³åˆ†åº“åˆ†è¡¨ï¼Œç”±å•ç‚¹åˆ†å¸ƒåˆ°å¤šç‚¹æ•°æ®åº“ä¸­ï¼Œä»è€Œé™ä½å•ç‚¹æ•°æ®åº“å‹åŠ›ã€‚\n- **é›†ç¾¤æ–¹æ¡ˆ**ï¼šè§£å†³ DB å®•æœºå¸¦æ¥çš„å•ç‚¹ DB ä¸èƒ½è®¿é—®é—®é¢˜ã€‚\n- **è¯»å†™åˆ†ç¦»ç­–ç•¥**ï¼šæå¤§é™åº¦æé«˜äº†åº”ç”¨ä¸­ Read æ•°æ®çš„é€Ÿåº¦å’Œå¹¶å‘é‡ã€‚æ— æ³•è§£å†³é«˜å†™å…¥å‹åŠ›ã€‚\n\n\n\n### æ•°æ®åº“å´©æºƒæ—¶äº‹åŠ¡çš„æ¢å¤æœºåˆ¶ï¼ˆREDO æ—¥å¿—å’Œ UNDO æ—¥å¿—ï¼‰ï¼Ÿ\n\n#### Undo Log\n\n**Undo Log æ˜¯ä¸ºäº†å®ç°äº‹åŠ¡çš„åŸå­æ€§**ï¼Œåœ¨ MySQL æ•°æ®åº“ InnoDB å­˜å‚¨å¼•æ“ä¸­ï¼Œè¿˜ç”¨äº† Undo Log æ¥å®ç°å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶(ç®€ç§°ï¼šMVCC)ã€‚\n\n- **äº‹åŠ¡çš„åŸå­æ€§**(Atomicity)äº‹åŠ¡ä¸­çš„æ‰€æœ‰æ“ä½œï¼Œè¦ä¹ˆå…¨éƒ¨å®Œæˆï¼Œè¦ä¹ˆä¸åšä»»ä½•æ“ä½œï¼Œä¸èƒ½åªåšéƒ¨åˆ†æ“ä½œã€‚å¦‚æœåœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­å‘ç”Ÿäº†é”™è¯¯ï¼Œè¦å›æ»š(Rollback)åˆ°äº‹åŠ¡å¼€å§‹å‰çš„çŠ¶æ€ï¼Œå°±åƒè¿™ä¸ªäº‹åŠ¡ä»æ¥æ²¡æœ‰æ‰§è¡Œè¿‡ã€‚\n- **åŸç†**Undo Log çš„åŸç†å¾ˆç®€å•ï¼Œ**ä¸ºäº†æ»¡è¶³äº‹åŠ¡çš„åŸå­æ€§ï¼Œåœ¨æ“ä½œä»»ä½•æ•°æ®ä¹‹å‰ï¼Œé¦–å…ˆå°†æ•°æ®å¤‡ä»½åˆ°ä¸€ä¸ªåœ°æ–¹ï¼ˆè¿™ä¸ªå­˜å‚¨æ•°æ®å¤‡ä»½çš„åœ°æ–¹ç§°ä¸º UndoLogï¼‰**ã€‚ç„¶åè¿›è¡Œæ•°æ®çš„ä¿®æ”¹ã€‚å¦‚æœå‡ºç°äº†é”™è¯¯æˆ–è€…ç”¨æˆ·æ‰§è¡Œäº† ROLLBACK è¯­å¥ï¼Œ**ç³»ç»Ÿå¯ä»¥åˆ©ç”¨ Undo Log ä¸­çš„å¤‡ä»½å°†æ•°æ®æ¢å¤åˆ°äº‹åŠ¡å¼€å§‹ä¹‹å‰çš„çŠ¶æ€**ã€‚\n\n**ä¹‹æ‰€ä»¥èƒ½åŒæ—¶ä¿è¯åŸå­æ€§å’ŒæŒä¹…åŒ–ï¼Œæ˜¯å› ä¸ºä»¥ä¸‹ç‰¹ç‚¹**ï¼š\n\n- æ›´æ–°æ•°æ®å‰è®°å½• Undo logã€‚\n- ä¸ºäº†ä¿è¯æŒä¹…æ€§ï¼Œå¿…é¡»å°†æ•°æ®åœ¨äº‹åŠ¡æäº¤å‰å†™åˆ°ç£ç›˜ã€‚åªè¦äº‹åŠ¡æˆåŠŸæäº¤ï¼Œæ•°æ®å¿…ç„¶å·²ç»æŒä¹…åŒ–ã€‚\n- **Undo log å¿…é¡»å…ˆäºæ•°æ®æŒä¹…åŒ–åˆ°ç£ç›˜**ã€‚å¦‚æœåœ¨ G,H ä¹‹é—´ç³»ç»Ÿå´©æºƒï¼Œ**undo log æ˜¯å®Œæ•´çš„ï¼Œ å¯ä»¥ç”¨æ¥å›æ»šäº‹åŠ¡**ã€‚\n- å¦‚æœåœ¨ A-F ä¹‹é—´ç³»ç»Ÿå´©æºƒ,å› ä¸ºæ•°æ®æ²¡æœ‰æŒä¹…åŒ–åˆ°ç£ç›˜ã€‚æ‰€ä»¥ç£ç›˜ä¸Šçš„æ•°æ®è¿˜æ˜¯ä¿æŒåœ¨äº‹åŠ¡å¼€å§‹å‰çš„çŠ¶æ€ã€‚\n\n**ç¼ºé™·**ï¼š**æ¯ä¸ªäº‹åŠ¡æäº¤å‰å°†æ•°æ®å’Œ Undo Log å†™å…¥ç£ç›˜ï¼Œè¿™æ ·ä¼šå¯¼è‡´å¤§é‡çš„ç£ç›˜ IOï¼Œå› æ­¤æ€§èƒ½å¾ˆä½**ã€‚\n\nå¦‚æœèƒ½å¤Ÿå°†æ•°æ®ç¼“å­˜ä¸€æ®µæ—¶é—´ï¼Œå°±èƒ½å‡å°‘ IO æé«˜æ€§èƒ½ã€‚ä½†æ˜¯è¿™æ ·å°±ä¼šä¸§å¤±äº‹åŠ¡çš„æŒä¹…æ€§ã€‚å› æ­¤å¼•å…¥äº†å¦å¤–ä¸€ç§æœºåˆ¶æ¥å®ç°æŒä¹…åŒ–ï¼Œå³ Redo Logã€‚\n\n#### Redo Log\n\n- **åŸç†å’Œ Undo Log ç›¸å**ï¼Œ**Redo Log è®°å½•çš„æ˜¯æ–°æ•°æ®çš„å¤‡ä»½**ã€‚**åœ¨äº‹åŠ¡æäº¤å‰ï¼Œåªè¦å°† Redo Log æŒä¹…åŒ–å³å¯ï¼Œä¸éœ€è¦å°†æ•°æ®æŒä¹…åŒ–ã€‚å½“ç³»ç»Ÿå´©æºƒæ—¶ï¼Œè™½ç„¶æ•°æ®æ²¡æœ‰æŒä¹…åŒ–ï¼Œä½†æ˜¯ Redo Log å·²ç»æŒä¹…åŒ–ã€‚ç³»ç»Ÿå¯ä»¥æ ¹æ® Redo Log çš„å†…å®¹ï¼Œå°†æ‰€æœ‰æ•°æ®æ¢å¤åˆ°æœ€æ–°çš„çŠ¶æ€**ã€‚\n\n### Explain æ€§èƒ½åˆ†æ\n\n**æ˜¯ä»€ä¹ˆ**\n\næŸ¥çœ‹æ‰§è¡Œè®¡åˆ’ï¼šä½¿ç”¨ EXPLAIN å…³é”®å­—å¯ä»¥æ¨¡æ‹Ÿä¼˜åŒ–å™¨æ‰§è¡Œ SQL æŸ¥è¯¢è¯­å¥ï¼Œä»è€ŒçŸ¥é“ MySQL æ˜¯å¦‚ä½•å¤„ç† SQL è¯­å¥çš„ã€‚åˆ†ææŸ¥è¯¢è¯­å¥æˆ–æ˜¯è¡¨ç»“æ„çš„æ€§èƒ½ç“¶é¢ˆã€‚\n\n**èƒ½å¹²å˜›**\n\n- è¡¨çš„è¯»å–é¡ºåº\n- æ•°æ®è¯»å–æ“ä½œçš„æ“ä½œç±»å‹\n- å“ªäº›ç´¢å¼•å¯ä»¥ä½¿ç”¨\n- å“ªäº›ç´¢å¼•è¢«å®é™…ä½¿ç”¨\n- è¡¨ä¹‹é—´çš„å¼•ç”¨\n- æ¯å¼ è¡¨æœ‰å¤šå°‘è¡Œè¢«ä¼˜åŒ–å™¨æŸ¥è¯¢\n\n**æ€ä¹ˆç©**\n\nExplain + SQL è¯­å¥ã€‚\nExplain æ‰§è¡Œåè¿”å›çš„ä¿¡æ¯ï¼š\n <img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131912576.png\" alt=\"image-20220422131912576\" style=\"zoom:50%;\" />\n\n**å„å­—æ®µè§£é‡Š**\n\n1. idï¼šselect æŸ¥è¯¢çš„åºåˆ—å·ï¼ŒåŒ…å«ä¸€ç»„æ•°å­—ï¼Œè¡¨ç¤ºæŸ¥è¯¢ä¸­æ‰§è¡Œ select å­å¥æˆ–æ“ä½œè¡¨çš„é¡ºåºã€‚\n\n\t- id ç›¸åŒï¼Œæ‰§è¡Œé¡ºåºç”±ä¸Šè‡³ä¸‹\n\t- id ä¸åŒï¼Œå¦‚æœæ˜¯å­æŸ¥è¯¢ï¼Œid çš„åºå·ä¼šé€’å¢ï¼Œid å€¼è¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜ï¼Œè¶Šå…ˆè¢«æ‰§è¡Œ\n\t- id æœ‰ç›¸åŒä¹Ÿæœ‰ä¸åŒï¼šid å¦‚æœç›¸åŒï¼Œå¯ä»¥è®¤ä¸ºæ˜¯ä¸€ç»„ï¼Œä»ä¸Šå¾€ä¸‹é¡ºåºæ‰§è¡Œï¼›åœ¨æ‰€æœ‰ç»„ä¸­ï¼Œid å€¼è¶Šå¤§ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼Œè¶Šå…ˆæ‰§è¡Œ\n\n\t> id å·æ¯ä¸ªå·ç ï¼Œè¡¨ç¤ºä¸€è¶Ÿç‹¬ç«‹çš„æŸ¥è¯¢ã€‚ä¸€ä¸ª sql çš„æŸ¥è¯¢è¶Ÿæ•°è¶Šå°‘è¶Šå¥½ã€‚\n\n2. select_typeï¼šä»£è¡¨æŸ¥è¯¢çš„ç±»å‹ï¼Œä¸»è¦æ˜¯ç”¨äºåŒºåˆ«æ™®é€šæŸ¥è¯¢ã€è”åˆæŸ¥è¯¢ã€å­æŸ¥è¯¢ç­‰çš„å¤æ‚æŸ¥è¯¢ï¼Œå–å€¼èŒƒå›´å¦‚ä¸‹ï¼š\n\n\t- simpleï¼šç®€å•çš„ select æŸ¥è¯¢ï¼ŒæŸ¥è¯¢ä¸­ä¸åŒ…å«å­æŸ¥è¯¢æˆ–è€… UNION\n\t- primaryï¼šæŸ¥è¯¢ä¸­è‹¥åŒ…å«ä»»ä½•å¤æ‚çš„å­éƒ¨åˆ†ï¼Œæœ€å¤–å±‚æŸ¥è¯¢åˆ™è¢«æ ‡è®°ä¸º primary\n\t- derivedï¼šåœ¨ FROM åˆ—è¡¨ä¸­åŒ…å«çš„å­æŸ¥è¯¢è¢«æ ‡è®°ä¸º DERIVED (è¡ç”Ÿ)ï¼ŒMySQL ä¼šé€’å½’æ‰§è¡Œè¿™äº›å­æŸ¥è¯¢, æŠŠç»“æœæ”¾åœ¨ä¸´æ—¶è¡¨é‡Œã€‚\n\t- subqueryï¼šåœ¨ SELECT æˆ– WHERE åˆ—è¡¨ä¸­åŒ…å«äº†å­æŸ¥è¯¢\n\t- depedent subqueryï¼šåœ¨ SELECT æˆ– WHERE åˆ—è¡¨ä¸­åŒ…å«äº†å­æŸ¥è¯¢ï¼Œå­æŸ¥è¯¢åŸºäºå¤–å±‚\n\t- uncacheable subqueryï¼šæ— æ³•ä½¿ç”¨ç¼“å­˜çš„å­æŸ¥è¯¢\n\t- unionï¼šè‹¥ç¬¬äºŒä¸ª SELECT å‡ºç°åœ¨ UNION ä¹‹åï¼Œåˆ™è¢«æ ‡è®°ä¸º UNIONï¼›è‹¥ UNION åŒ…å«åœ¨ FROM å­å¥çš„å­æŸ¥è¯¢ä¸­ï¼Œå¤–å±‚ SELECT å°†è¢«æ ‡è®°ä¸ºï¼šDERIVED\n\t- union resultï¼šä» UNION è¡¨è·å–ç»“æœçš„ SELECT\n\n3. tableï¼šè¿™ä¸ªæ•°æ®æ˜¯åŸºäºå“ªå¼ è¡¨çš„ã€‚\n\n4. typeï¼šæ˜¯æŸ¥è¯¢çš„è®¿é—®ç±»å‹ã€‚æ˜¯è¾ƒä¸ºé‡è¦çš„ä¸€ä¸ªæŒ‡æ ‡ï¼Œç»“æœå€¼ä»æœ€å¥½åˆ°æœ€åä¾æ¬¡æ˜¯ï¼šsystem > const > eq_ref > ref > fulltext > ref_or_null > index_merge > unique_subquery > index_subquery > range > index > ALLï¼Œä¸€èˆ¬æ¥è¯´ï¼Œå¾—ä¿è¯æŸ¥è¯¢è‡³å°‘è¾¾åˆ° range çº§åˆ«ï¼Œæœ€å¥½èƒ½è¾¾åˆ° refã€‚\n\n\t> åªéœ€è¦è®°ä½ï¼šsystem > const > eq_ref > ref > range > index > ALL å°±è¡Œäº†ï¼Œå…¶ä»–çš„ä¸å¸¸è§ã€‚\n\n\t- systemï¼šè¡¨åªæœ‰ä¸€è¡Œè®°å½•ï¼ˆç­‰äºç³»ç»Ÿè¡¨ï¼‰ï¼Œè¿™æ˜¯ const ç±»å‹çš„ç‰¹åˆ—ï¼Œå¹³æ—¶ä¸ä¼šå‡ºç°ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥å¿½ç•¥ä¸è®¡ã€‚\n\t- constï¼šè¡¨ç¤ºé€šè¿‡ç´¢å¼•ä¸€æ¬¡å°±æ‰¾åˆ°äº†ï¼Œconst ç”¨äºæ¯”è¾ƒ primary key æˆ–è€… unique ç´¢å¼•ã€‚å› ä¸ºåªåŒ¹é…ä¸€è¡Œæ•°æ®ï¼Œæ‰€ä»¥å¾ˆå¿«ã€‚å¦‚å°†ä¸»é”®ç½®äº where åˆ—è¡¨ä¸­ï¼ŒMySQL å°±èƒ½å°†è¯¥æŸ¥è¯¢è½¬æ¢ä¸ºä¸€ä¸ªå¸¸é‡ã€‚\n\t- eq_refï¼šå”¯ä¸€æ€§ç´¢å¼•æ‰«æï¼Œå¯¹äºæ¯ä¸ªç´¢å¼•é”®ï¼Œè¡¨ä¸­åªæœ‰ä¸€æ¡è®°å½•ä¸ä¹‹åŒ¹é…ã€‚å¸¸è§äºä¸»é”®æˆ–å”¯ä¸€ç´¢å¼•æ‰«æã€‚\n\t- refï¼šéå”¯ä¸€æ€§ç´¢å¼•æ‰«æï¼Œè¿”å›åŒ¹é…æŸä¸ªå•ç‹¬å€¼çš„æ‰€æœ‰è¡Œã€‚æœ¬è´¨ä¸Šä¹Ÿæ˜¯ä¸€ç§ç´¢å¼•è®¿é—®ï¼Œå®ƒè¿”å›æ‰€æœ‰åŒ¹é…æŸä¸ªå•ç‹¬å€¼çš„è¡Œï¼Œç„¶è€Œï¼Œå®ƒå¯èƒ½ä¼šæ‰¾åˆ°å¤šä¸ªç¬¦åˆæ¡ä»¶çš„è¡Œï¼Œæ‰€ä»¥ä»–åº”è¯¥å±äºæŸ¥æ‰¾å’Œæ‰«æçš„æ··åˆä½“ã€‚\n\t- rangeï¼šåªæ£€ç´¢ç»™å®šèŒƒå›´çš„è¡Œï¼Œä½¿ç”¨ä¸€ä¸ªç´¢å¼•æ¥é€‰æ‹©è¡Œã€‚key åˆ—æ˜¾ç¤ºä½¿ç”¨äº†å“ªä¸ªç´¢å¼•ä¸€èˆ¬å°±æ˜¯åœ¨ where è¯­å¥ä¸­å‡ºç°äº† betweenã€<ã€>ã€in ç­‰çš„æŸ¥è¯¢è¿™ç§èŒƒå›´æ‰«æç´¢å¼•æ‰«ææ¯”å…¨è¡¨æ‰«æè¦å¥½ï¼Œå› ä¸ºå®ƒåªéœ€è¦å¼€å§‹äºç´¢å¼•çš„æŸä¸€ç‚¹ï¼Œè€Œç»“æŸè¯­å¦ä¸€ç‚¹ï¼Œä¸ç”¨æ‰«æå…¨éƒ¨ç´¢å¼•ã€‚\n\t- indexï¼šå‡ºç° index æ˜¯ sql ä½¿ç”¨äº†ç´¢å¼•ä½†æ˜¯æ²¡ç”¨ç´¢å¼•è¿›è¡Œè¿‡æ»¤ï¼Œä¸€èˆ¬æ˜¯ä½¿ç”¨äº†è¦†ç›–ç´¢å¼•æˆ–è€…æ˜¯åˆ©ç”¨ç´¢å¼•è¿›è¡Œäº†æ’åºåˆ†ç»„ã€‚\n\t- allï¼šå°†éå†å…¨è¡¨ä»¥æ‰¾åˆ°åŒ¹é…çš„è¡Œã€‚\n\n\t> å…¶ä»– type å¦‚ä¸‹ï¼š\n\n\t- index_mergeï¼šåœ¨æŸ¥è¯¢è¿‡ç¨‹ä¸­éœ€è¦å¤šä¸ªç´¢å¼•ç»„åˆä½¿ç”¨ï¼Œé€šå¸¸å‡ºç°åœ¨æœ‰ or å…³é”®å­—çš„ sql ä¸­ã€‚\n\t- ref_or_nullï¼šå¯¹äºæŸä¸ªå­—æ®µæ—¢éœ€è¦è¿‡æ»¤æ¡ä»¶ï¼Œä¹Ÿéœ€è¦ null å€¼çš„æƒ…å†µä¸‹ã€‚æŸ¥è¯¢ä¼˜åŒ–å™¨ä¼šé€‰æ‹©ç”¨ ref_or_null è¿æ¥æŸ¥è¯¢ã€‚\n\t- index_subqueryï¼šåˆ©ç”¨ç´¢å¼•æ¥å…³è”å­æŸ¥è¯¢ï¼Œä¸å†å…¨è¡¨æ‰«æã€‚\n\t- unique_subqueryï¼šè¯¥è”æ¥ç±»å‹ç±»ä¼¼äº index_subqueryã€‚å­æŸ¥è¯¢ä¸­çš„å”¯ä¸€ç´¢å¼•ã€‚\n\n5. possible_keysï¼šæ˜¾ç¤ºå¯èƒ½åº”ç”¨åœ¨è¿™å¼ è¡¨ä¸­çš„ç´¢å¼•ï¼Œä¸€ä¸ªæˆ–å¤šä¸ªã€‚æŸ¥è¯¢æ¶‰åŠåˆ°çš„å­—æ®µä¸Šè‹¥å­˜åœ¨ç´¢å¼•ï¼Œåˆ™è¯¥ç´¢å¼•å°†è¢«åˆ—å‡ºï¼Œä½†ä¸ä¸€å®šè¢«æŸ¥è¯¢å®é™…ä½¿ç”¨ã€‚\n\n6. keyï¼šå®é™…ä½¿ç”¨çš„ç´¢å¼•ã€‚å¦‚æœä¸º NULLï¼Œåˆ™æ²¡æœ‰ä½¿ç”¨ç´¢å¼•ã€‚\n\n7. key_lenï¼šè¡¨ç¤ºç´¢å¼•ä¸­ä½¿ç”¨çš„å­—èŠ‚æ•°ï¼Œå¯é€šè¿‡è¯¥åˆ—è®¡ç®—æŸ¥è¯¢ä¸­ä½¿ç”¨çš„ç´¢å¼•çš„é•¿åº¦ã€‚key_len æ˜¾ç¤ºçš„å€¼ä¸ºç´¢å¼•å­—æ®µçš„æœ€å¤§å¯èƒ½é•¿åº¦ï¼Œå¹¶éå®é™…ä½¿ç”¨é•¿åº¦ã€‚å¦‚ä½•è®¡ç®— key_lenï¼Ÿ\n\n\t- å…ˆçœ‹ç´¢å¼•ä¸Šå­—æ®µçš„ç±»å‹ + é•¿åº¦ï¼Œæ¯”å¦‚ï¼šint=4; varchar(20)=20; char(20)=20\n\t- å¦‚æœæ˜¯ varchar æˆ–è€… char è¿™ç§å­—ç¬¦ä¸²å­—æ®µï¼Œè§†å­—ç¬¦é›†è¦ä¹˜ä¸åŒçš„å€¼ï¼Œæ¯”å¦‚ utf-8 è¦ä¹˜ 3ï¼ŒGBK è¦ä¹˜ 2\n\t- varchar è¿™ç§åŠ¨æ€å­—ç¬¦ä¸²è¦åŠ  2 ä¸ªå­—èŠ‚\n\t- å…è®¸ä¸ºç©ºçš„å­—æ®µè¦åŠ  1 ä¸ªå­—èŠ‚\n\n8. refï¼šæ˜¾ç¤ºç´¢å¼•çš„å“ªä¸€åˆ—è¢«ä½¿ç”¨äº†ï¼Œå¦‚æœå¯èƒ½çš„è¯ï¼Œæ˜¯ä¸€ä¸ªå¸¸æ•°ã€‚å“ªäº›åˆ—æˆ–å¸¸é‡è¢«ç”¨äºæŸ¥æ‰¾ç´¢å¼•åˆ—ä¸Šçš„å€¼ã€‚\n\n9. rowsï¼šæ˜¾ç¤º MySQL è®¤ä¸ºå®ƒæ‰§è¡ŒæŸ¥è¯¢æ—¶å¿…é¡»æ£€æŸ¥çš„è¡Œæ•°ã€‚è¶Šå°‘è¶Šå¥½ï¼\n\n10. Extraï¼šå…¶ä»–çš„é¢å¤–é‡è¦çš„ä¿¡æ¯ã€‚\n\n\t- Using filesortï¼šè¯´æ˜ mysql ä¼šå¯¹æ•°æ®ä½¿ç”¨ä¸€ä¸ªå¤–éƒ¨çš„ç´¢å¼•æ’åºï¼Œè€Œä¸æ˜¯æŒ‰ç…§è¡¨å†…çš„ç´¢å¼•é¡ºåºè¿›è¡Œè¯»å–ã€‚MySQL ä¸­æ— æ³•åˆ©ç”¨ç´¢å¼•å®Œæˆçš„æ’åºæ“ä½œç§°ä¸ºâ€œæ–‡ä»¶æ’åºâ€ã€‚**æ’åºå­—æ®µè‹¥é€šè¿‡ç´¢å¼•å»è®¿é—®å°†å¤§å¤§æé«˜æ’åºé€Ÿåº¦**ã€‚\n\t- Using temporaryï¼šä½¿ç”¨ä¸´æ—¶è¡¨ä¿å­˜ä¸­é—´ç»“æœï¼ŒMySQL åœ¨å¯¹æŸ¥è¯¢ç»“æœæ’åºæ—¶ä½¿ç”¨ä¸´æ—¶è¡¨ã€‚å¸¸è§äºæ’åº order by å’Œåˆ†ç»„æŸ¥è¯¢ group byã€‚\n\t- Using indexï¼šè¡¨ç¤ºç›¸åº”çš„ select æ“ä½œä¸­ä½¿ç”¨äº†è¦†ç›–ç´¢å¼• (Covering Index)ï¼Œé¿å…è®¿é—®äº†è¡¨çš„æ•°æ®è¡Œï¼Œæ•ˆç‡ä¸é”™ï¼å¦‚æœåŒæ—¶å‡ºç° using whereï¼Œè¡¨æ˜ç´¢å¼•è¢«ç”¨æ¥æ‰§è¡Œç´¢å¼•é”®å€¼çš„æŸ¥æ‰¾ï¼›å¦‚æœæ²¡æœ‰åŒæ—¶å‡ºç° using whereï¼Œè¡¨æ˜ç´¢å¼•åªæ˜¯ç”¨æ¥è¯»å–æ•°æ®è€Œéåˆ©ç”¨ç´¢å¼•æ‰§è¡ŒæŸ¥æ‰¾ã€‚\n\t- Using whereï¼šè¡¨æ˜ä½¿ç”¨äº† where è¿‡æ»¤ã€‚\n\t- Using join bufferï¼šä½¿ç”¨äº†è¿æ¥ç¼“å­˜ã€‚\n\t- impossible whereï¼šwhere å­å¥çš„å€¼æ€»æ˜¯ falseï¼Œä¸èƒ½ç”¨æ¥è·å–ä»»ä½•æ•°æ®ã€‚\n\t- select tables optimized awayï¼šåœ¨æ²¡æœ‰ group by å­å¥çš„æƒ…å†µä¸‹ï¼ŒåŸºäºç´¢å¼•ä¼˜åŒ– MIN/MAX æ“ä½œæˆ–è€…å¯¹äº MyISAM å­˜å‚¨å¼•æ“ä¼˜åŒ– COUNT(*) æ“ä½œï¼Œä¸å¿…ç­‰åˆ°æ‰§è¡Œé˜¶æ®µå†è¿›è¡Œè®¡ç®—ï¼ŒæŸ¥è¯¢æ‰§è¡Œè®¡åˆ’ç”Ÿæˆçš„é˜¶æ®µå³å®Œæˆä¼˜åŒ–ã€‚\n\t- distinctï¼šä¼˜åŒ– distinct æ“ä½œï¼Œåœ¨æ‰¾åˆ°ç¬¬ä¸€åŒ¹é…çš„å…ƒç¥–åå³åœæ­¢æ‰¾åŒæ ·å€¼çš„åŠ¨ä½œã€‚\n","slug":"Javaå…«è‚¡æ–‡-MySQL","published":1,"updated":"2023-01-26T12:35:58.978Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cldzfw322000it9t83h3z0w23","content":"<blockquote>\n<p>æ•´ç†çš„ MySQL ç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½\t<span id=\"more\"></span></p>\n</blockquote>\n<h2 id=\"MySQLåŸºç¡€ç¯‡\"><a href=\"#MySQLåŸºç¡€ç¯‡\" class=\"headerlink\" title=\"MySQLåŸºç¡€ç¯‡\"></a>MySQLåŸºç¡€ç¯‡</h2><h3 id=\"è¯´ä¸€è¯´ä¸‰ä¸ªèŒƒå¼\"><a href=\"#è¯´ä¸€è¯´ä¸‰ä¸ªèŒƒå¼\" class=\"headerlink\" title=\"è¯´ä¸€è¯´ä¸‰ä¸ªèŒƒå¼\"></a>è¯´ä¸€è¯´ä¸‰ä¸ªèŒƒå¼</h3><p><strong>ç¬¬ä¸€èŒƒå¼(ç¡®ä¿æ¯åˆ—ä¿æŒåŸå­æ€§)</strong></p>\n<p>ç¬¬ä¸€èŒƒå¼æ˜¯æœ€åŸºæœ¬çš„èŒƒå¼ã€‚å¦‚æœæ•°æ®åº“è¡¨ä¸­çš„æ‰€æœ‰å­—æ®µå€¼éƒ½æ˜¯ä¸å¯åˆ†è§£çš„åŸå­å€¼ï¼Œå°±è¯´æ˜è¯¥æ•°æ®åº“è¡¨æ»¡è¶³äº†ç¬¬ä¸€èŒƒå¼ã€‚</p>\n<p>**ç¬¬äºŒèŒƒå¼(ç¡®ä¿è¡¨ä¸­çš„æ¯åˆ—éƒ½å’Œä¸»é”®ç›¸å…³)**ï¼ˆå‰ææ˜¯ç¬¬ä¸€èŒƒå¼ï¼‰</p>\n<p>åœ¨ä¸€ä¸ªæ•°æ®åº“è¡¨ä¸­ï¼Œä¸€ä¸ªè¡¨ä¸­åªèƒ½ä¿å­˜<strong>ä¸€ç§</strong>æ•°æ®ï¼Œä¸å¯ä»¥æŠŠå¤šç§æ•°æ®ä¿å­˜åœ¨åŒä¸€å¼ æ•°æ®åº“è¡¨ä¸­ã€‚</p>\n<p>**ç¬¬ä¸‰èŒƒå¼(ç¡®ä¿è¡¨ä¸­æ¯åˆ—éƒ½å’Œä¸»é”®ç›´æ¥ç›¸å…³,è€Œä¸æ˜¯é—´æ¥ç›¸å…³)**ï¼ˆå‰ææ˜¯ç¬¬ä¸€ç¬¬äºŒèŒƒå¼ï¼‰</p>\n<p>å·²ç»åˆ†å¥½äº†å¤šå¼ è¡¨çš„è¯ï¼Œä¸€å¼ è¡¨ä¸­åªèƒ½æœ‰å¦ä¸€å¼ è¡¨çš„ IDï¼Œè€Œä¸èƒ½æœ‰å…¶ä»–ä»»ä½•ä¿¡æ¯ï¼ˆå…¶ä»–ä»»ä½•ä¿¡æ¯ï¼Œä¸€å¾‹ç”¨ä¸»é”®åœ¨å¦ä¸€å¼ è¡¨ä¸­æŸ¥è¯¢ï¼‰ã€‚</p>\n<h3 id=\"è¯´ä¸€ä¸‹-MySQL-æ‰§è¡Œä¸€æ¡æŸ¥è¯¢è¯­å¥çš„å†…éƒ¨æ‰§è¡Œè¿‡ç¨‹ï¼Ÿ\"><a href=\"#è¯´ä¸€ä¸‹-MySQL-æ‰§è¡Œä¸€æ¡æŸ¥è¯¢è¯­å¥çš„å†…éƒ¨æ‰§è¡Œè¿‡ç¨‹ï¼Ÿ\" class=\"headerlink\" title=\"è¯´ä¸€ä¸‹ MySQL æ‰§è¡Œä¸€æ¡æŸ¥è¯¢è¯­å¥çš„å†…éƒ¨æ‰§è¡Œè¿‡ç¨‹ï¼Ÿ\"></a>è¯´ä¸€ä¸‹ MySQL æ‰§è¡Œä¸€æ¡æŸ¥è¯¢è¯­å¥çš„å†…éƒ¨æ‰§è¡Œè¿‡ç¨‹ï¼Ÿ</h3><blockquote>\n<p>è¿æ¥å™¨ â†’ æŸ¥è¯¢ç¼“å­˜ â†’ åˆ†æå™¨ â†’ ä¼˜åŒ–å™¨ â†’ æ‰§è¡Œå™¨</p>\n</blockquote>\n<ul>\n<li><p>å®¢æˆ·ç«¯å…ˆé€šè¿‡<strong>è¿æ¥å™¨</strong>è¿æ¥åˆ° MySQL æœåŠ¡å™¨ã€‚</p>\n</li>\n<li><p>è¿æ¥å™¨æƒé™éªŒè¯é€šè¿‡ä¹‹åï¼Œå…ˆæŸ¥è¯¢æ˜¯å¦æœ‰<strong>æŸ¥è¯¢ç¼“å­˜</strong>ï¼Œå¦‚æœæœ‰ç¼“å­˜ï¼ˆä¹‹å‰æ‰§è¡Œè¿‡æ­¤è¯­å¥ï¼‰åˆ™ç›´æ¥è¿”å›ç¼“å­˜æ•°æ®ï¼Œå¦‚æœæ²¡æœ‰ç¼“å­˜åˆ™è¿›å…¥åˆ†æå™¨ã€‚</p>\n</li>\n<li><p><strong>åˆ†æå™¨</strong>ä¼šå¯¹æŸ¥è¯¢è¯­å¥è¿›è¡Œè¯­æ³•åˆ†æå’Œè¯æ³•åˆ†æï¼Œåˆ¤æ–­ SQL è¯­æ³•æ˜¯å¦æ­£ç¡®ï¼Œå¦‚æœæŸ¥è¯¢è¯­æ³•é”™è¯¯ä¼šç›´æ¥è¿”å›ç»™å®¢æˆ·ç«¯é”™è¯¯ä¿¡æ¯ï¼Œå¦‚æœè¯­æ³•æ­£ç¡®åˆ™è¿›å…¥ä¼˜åŒ–å™¨ã€‚</p>\n</li>\n<li><p><strong>ä¼˜åŒ–å™¨</strong>å¯¹æŸ¥è¯¢è¯­å¥è¿›è¡Œä¼˜åŒ–å¤„ç†ï¼Œä¾‹å¦‚ä¸€ä¸ªè¡¨é‡Œé¢æœ‰å¤šä¸ªç´¢å¼•ï¼Œä¼˜åŒ–å™¨ä¼šåˆ¤åˆ«å“ªä¸ªç´¢å¼•æ€§èƒ½æ›´å¥½ã€‚</p>\n</li>\n<li><p>ä¼˜åŒ–å™¨æ‰§è¡Œå®Œå°±è¿›å…¥<strong>æ‰§è¡Œå™¨</strong>ï¼Œå¼€å§‹æ‰§è¡ŒæŸ¥è¯¢è¯­å¥ç›´åˆ°æŸ¥è¯¢å‡ºæ»¡è¶³æ¡ä»¶çš„æ‰€æœ‰æ•°æ®ï¼Œç„¶åè¿›è¡Œè¿”å›ã€‚</p>\n</li>\n</ul>\n<h3 id=\"MySQL-æŸ¥è¯¢ç¼“å­˜çš„åŠŸèƒ½æœ‰ä½•ä¼˜ç¼ºç‚¹ï¼Ÿ\"><a href=\"#MySQL-æŸ¥è¯¢ç¼“å­˜çš„åŠŸèƒ½æœ‰ä½•ä¼˜ç¼ºç‚¹ï¼Ÿ\" class=\"headerlink\" title=\"MySQL æŸ¥è¯¢ç¼“å­˜çš„åŠŸèƒ½æœ‰ä½•ä¼˜ç¼ºç‚¹ï¼Ÿ\"></a>MySQL æŸ¥è¯¢ç¼“å­˜çš„åŠŸèƒ½æœ‰ä½•ä¼˜ç¼ºç‚¹ï¼Ÿ</h3><p>ä¼˜ç‚¹æ˜¯æ•ˆç‡é«˜ï¼Œå¦‚æœå·²ç»æœ‰ç¼“å­˜åˆ™ä¼šç›´æ¥è¿”å›ç»“æœã€‚ </p>\n<p>ä½†æ˜¯ï¼Œå¦‚æœæ•°æ®åº“è¡¨ä¸­æ•°æ®å’Œç»“æ„å‘ç”Ÿå˜åŒ–æ—¶ï¼ˆå¢åˆ æ”¹ã€è¡¨ç»“æ„è°ƒæ•´ï¼‰ï¼ŒæŸ¥è¯¢ç¼“å­˜å°†ä¼šå¤±æ•ˆå¹¶è¢«æ¸…é™¤ï¼Œå¯¼è‡´ç¼“å­˜å‘½ä¸­ç‡æ¯”è¾ƒä½ã€‚</p>\n<h3 id=\"MySQL-çš„å¸¸ç”¨å¼•æ“éƒ½æœ‰å“ªäº›ï¼Ÿ\"><a href=\"#MySQL-çš„å¸¸ç”¨å¼•æ“éƒ½æœ‰å“ªäº›ï¼Ÿ\" class=\"headerlink\" title=\"MySQL çš„å¸¸ç”¨å¼•æ“éƒ½æœ‰å“ªäº›ï¼Ÿ\"></a>MySQL çš„å¸¸ç”¨å¼•æ“éƒ½æœ‰å“ªäº›ï¼Ÿ</h3><p>MySQL çš„å¸¸ç”¨å¼•æ“æœ‰ InnoDBã€MyISAMã€Memoryï¼ˆæ‰€æœ‰æ•°æ®æ”¾åœ¨å†…å­˜ä¸­ï¼‰ ç­‰ï¼Œä» MySQL 5.5.5 ç‰ˆæœ¬å¼€å§‹ InnoDB å°±æˆä¸ºäº†é»˜è®¤çš„å­˜å‚¨å¼•æ“ã€‚</p>\n<h3 id=\"MySQL-å¯ä»¥é’ˆå¯¹è¡¨çº§åˆ«è®¾ç½®æ•°æ®åº“å¼•æ“å—ï¼Ÿæ€ä¹ˆè®¾ç½®ï¼Ÿ\"><a href=\"#MySQL-å¯ä»¥é’ˆå¯¹è¡¨çº§åˆ«è®¾ç½®æ•°æ®åº“å¼•æ“å—ï¼Ÿæ€ä¹ˆè®¾ç½®ï¼Ÿ\" class=\"headerlink\" title=\"MySQL å¯ä»¥é’ˆå¯¹è¡¨çº§åˆ«è®¾ç½®æ•°æ®åº“å¼•æ“å—ï¼Ÿæ€ä¹ˆè®¾ç½®ï¼Ÿ\"></a>MySQL å¯ä»¥é’ˆå¯¹è¡¨çº§åˆ«è®¾ç½®æ•°æ®åº“å¼•æ“å—ï¼Ÿæ€ä¹ˆè®¾ç½®ï¼Ÿ</h3><p>å¯ä»¥é’ˆå¯¹ä¸åŒçš„è¡¨è®¾ç½®ä¸åŒçš„å¼•æ“ã€‚åœ¨ create table è¯­å¥ä¸­ä½¿ç”¨ engine&#x3D;å¼•æ“åï¼ˆæ¯”å¦‚ Memoryï¼‰æ¥è®¾ç½®æ­¤è¡¨çš„å­˜å‚¨å¼•æ“ã€‚</p>\n<h3 id=\"InnoDB-v-s-MyISAM\"><a href=\"#InnoDB-v-s-MyISAM\" class=\"headerlink\" title=\"InnoDB v.s. MyISAM\"></a>InnoDB v.s. MyISAM</h3><ul>\n<li><p>æœ€å¤§çš„åŒºåˆ«æ˜¯ InnoDB æ”¯æŒ<strong>äº‹åŠ¡</strong>ï¼Œè€Œ MyISAM ä¸æ”¯æŒäº‹åŠ¡ï¼›</p>\n</li>\n<li><p>InnoDB æ”¯æŒ<strong>å´©æºƒåå®‰å…¨æ¢å¤</strong>ï¼ŒMyISAM ä¸æ”¯æŒå´©æºƒåå®‰å…¨æ¢å¤ï¼›</p>\n</li>\n<li><p>InnoDB æ”¯æŒ<strong>è¡Œé”</strong>ï¼ŒMyISAM ä¸æ”¯æŒè¡Œé”ï¼Œåªæ”¯æŒè¡¨é”ï¼›</p>\n</li>\n<li><p>InnoDB æ”¯æŒ<strong>å¤–é”®</strong>ï¼ŒMyISAM ä¸æ”¯æŒå¤–é”®ï¼›</p>\n</li>\n</ul>\n<h3 id=\"InnoDB-æœ‰å“ªäº›ç‰¹æ€§ï¼Ÿ\"><a href=\"#InnoDB-æœ‰å“ªäº›ç‰¹æ€§ï¼Ÿ\" class=\"headerlink\" title=\"InnoDB æœ‰å“ªäº›ç‰¹æ€§ï¼Ÿ\"></a>InnoDB æœ‰å“ªäº›ç‰¹æ€§ï¼Ÿ</h3><p><strong>1ï¼‰æ’å…¥ç¼“å†²(insert buffer)<strong>ï¼šæ’å…¥ç¼“å†²å¸¦æ¥çš„æ˜¯</strong>æ€§èƒ½</strong>ã€‚å¯¹äºéèšé›†ç´¢å¼•çš„æ’å…¥å’Œæ›´æ–°ï¼Œä¸æ˜¯æ¯ä¸€æ¬¡ç›´æ¥æ’å…¥ç´¢å¼•é¡µä¸­ï¼Œè€Œæ˜¯é¦–å…ˆåˆ¤æ–­æ’å…¥çš„éèšé›†ç´¢å¼•é¡µæ˜¯å¦åœ¨ç¼“å†²æ± ä¸­ï¼Œå¦‚æœåœ¨ï¼Œåˆ™ç›´æ¥æ’å…¥ï¼Œå¦åˆ™ï¼Œå…ˆæ”¾å…¥ä¸€ä¸ªæ’å…¥ç¼“å†²åŒºä¸­ã€‚å¥½ä¼¼æ¬ºéª—æ•°æ®åº“è¿™ä¸ªéèšé›†çš„ç´¢å¼•å·²ç»æ’å…¥åˆ°å¶å­èŠ‚ç‚¹äº†ï¼Œç„¶åå†ä»¥ä¸€å®šçš„é¢‘ç‡æ‰§è¡Œæ’å…¥ç¼“å†²å’Œéèšé›†ç´¢å¼•å¶å­èŠ‚ç‚¹çš„åˆå¹¶æ“ä½œï¼Œè¿™æ—¶é€šå¸¸èƒ½å°†å¤šä¸ªæ’å…¥åˆå¹¶åˆ°ä¸€ä¸ªæ“ä½œä¸­ï¼Œè¿™å°±å¤§å¤§æé«˜äº†å¯¹éèšé›†ç´¢å¼•æ‰§è¡Œæ’å…¥å’Œä¿®æ”¹æ“ä½œçš„æ€§èƒ½ã€‚ï¼ˆ<strong>å¯¹äºéèšé›†ç´¢å¼•é¡µï¼Œä¸æ˜¯ç›´æ¥æ”¾åˆ°ç´¢å¼•é¡µä¸­ï¼Œè€Œæ˜¯å…ˆæ”¾åˆ°ç¼“å†²æ± ä¸­ï¼Œè¿™æ—¶å€™ç¼“å†²æ± ä¸­å¯èƒ½å­˜æ”¾äº†å¤šä¸ªéèšé›†ç´¢å¼•é¡µï¼Œç„¶åå°†è¿™å¤šä¸ªéèšé›†ç´¢å¼•é¡µçš„æ’å…¥åˆå¹¶åˆ°ä¸€ä¸ªæ“ä½œä¸­ï¼Œå–ä»£äº†ä¹‹å‰çš„ä¸€ä¸ªä¸€ä¸ªæ’å…¥</strong>ï¼‰</p>\n<p><strong>2ï¼‰ä¸¤æ¬¡å†™(double write)<strong>ï¼šä¸¤æ¬¡å†™å¸¦æ¥çš„æ˜¯</strong>å¯é æ€§</strong>ï¼Œä¸»è¦ç”¨æ¥è§£å†³éƒ¨åˆ†å†™å¤±è´¥ã€‚doublewrite ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œä¸€éƒ¨åˆ†æ˜¯å†…å­˜ä¸­çš„ doublewrite buffer ï¼Œå¤§å°ä¸º 2Mï¼Œå¦å¤–ä¸€éƒ¨åˆ†å°±æ˜¯ç‰©ç†ç£ç›˜ä¸Šçš„å…±äº«è¡¨ç©ºé—´ä¸­è¿ç»­çš„ 128 ä¸ªé¡µï¼Œå³ä¸¤ä¸ªåŒºï¼Œå¤§å°åŒæ ·ä¸º 2Mã€‚å½“ç¼“å†²æ± çš„ä½œä¸šåˆ·æ–°æ—¶ï¼Œå¹¶ä¸ç›´æ¥å†™ç¡¬ç›˜ï¼Œè€Œæ˜¯é€šè¿‡ memcpy å‡½æ•°å°†è„é¡µå…ˆæ‹·è´åˆ°å†…å­˜ä¸­çš„ doublewrite bufferï¼Œä¹‹åé€šè¿‡ doublewrite buffer å†åˆ†ä¸¤æ¬¡å†™ï¼Œæ¯æ¬¡å†™å…¥ 1M åˆ°å…±äº«è¡¨ç©ºé—´çš„ç‰©ç†ç£ç›˜ä¸Šï¼Œç„¶åé©¬ä¸Šè°ƒç”¨ fsync å‡½æ•°ï¼ŒåŒæ­¥ç£ç›˜ã€‚<strong>ï¼ˆè¦è¿›è¡Œå†™æ“ä½œæ—¶ï¼Œä¸æ˜¯ç›´æ¥å†™ç¡¬ç›˜ï¼Œè€Œæ˜¯å†™æ‹·è´åˆ°å†…å­˜ä¸­çš„ä¸¤æ¬¡å†™ç¼“å†²åŒºå¤§å°2Mï¼Œç„¶åæŠŠä¸¤æ¬¡å†™ç¼“å†²åŒºçš„å†…å®¹åˆ†ä¸¤æ¬¡å†™ï¼ˆæ¯æ¬¡å†™1Mï¼‰åˆ°å…±äº«è¡¨ç©ºé—´çš„ç£ç›˜ä¸Šï¼Œç„¶åå†å°†å…±äº«è¡¨ç©ºé—´çš„å†…å®¹åŒæ­¥åˆ°æ•°æ®æ–‡ä»¶ä¸Šï¼‰</strong></p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes11474088-ad3fb88b0ef6d41d.png\" alt=\"ä¸¤æ¬¡å†™\"> </p>\n<p><strong>3ï¼‰è‡ªé€‚åº”å“ˆå¸Œç´¢å¼•(adaptive hash index)<strong>ï¼šç”±äº InnoDB ä¸æ”¯æŒ hash ç´¢å¼•ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ hash ç´¢å¼•çš„æ•ˆç‡å¾ˆé«˜ï¼Œäºæ˜¯å‡ºç°äº† adaptive hash index åŠŸèƒ½ï¼Œ InnoDB å­˜å‚¨å¼•æ“ä¼šç›‘æ§å¯¹è¡¨ä¸Šç´¢å¼•çš„æŸ¥æ‰¾ï¼Œå¦‚æœè§‚å¯Ÿåˆ°å»ºç«‹ hash ç´¢å¼•å¯ä»¥æé«˜æ€§èƒ½çš„æ—¶å€™ï¼Œåˆ™è‡ªåŠ¨å»ºç«‹ hash ç´¢å¼•ã€‚</strong>ï¼ˆä¸ºäº†æé«˜æ€§èƒ½ä¼šè‡ªåŠ¨å»ºç«‹ä¸€äº› hash ç´¢å¼•ï¼ŒæŸ¥æ‰¾æ•ˆç‡å¾ˆé«˜ï¼Œç›´æ¥é€šè¿‡ hash å€¼å®šä½åˆ°æ•°æ®ï¼‰</strong></p>\n<h3 id=\"ä¸€å¼ è‡ªå¢è¡¨ä¸­æœ‰ä¸‰æ¡æ•°æ®ï¼Œåˆ é™¤äº†ä¸¤æ¡æ•°æ®ä¹‹åé‡å¯æ•°æ®åº“ï¼Œå†æ–°å¢ä¸€æ¡æ•°æ®ï¼Œæ­¤æ—¶è¿™æ¡æ•°æ®çš„-ID-æ˜¯å‡ ï¼Ÿ\"><a href=\"#ä¸€å¼ è‡ªå¢è¡¨ä¸­æœ‰ä¸‰æ¡æ•°æ®ï¼Œåˆ é™¤äº†ä¸¤æ¡æ•°æ®ä¹‹åé‡å¯æ•°æ®åº“ï¼Œå†æ–°å¢ä¸€æ¡æ•°æ®ï¼Œæ­¤æ—¶è¿™æ¡æ•°æ®çš„-ID-æ˜¯å‡ ï¼Ÿ\" class=\"headerlink\" title=\"ä¸€å¼ è‡ªå¢è¡¨ä¸­æœ‰ä¸‰æ¡æ•°æ®ï¼Œåˆ é™¤äº†ä¸¤æ¡æ•°æ®ä¹‹åé‡å¯æ•°æ®åº“ï¼Œå†æ–°å¢ä¸€æ¡æ•°æ®ï¼Œæ­¤æ—¶è¿™æ¡æ•°æ®çš„ ID æ˜¯å‡ ï¼Ÿ\"></a>ä¸€å¼ è‡ªå¢è¡¨ä¸­æœ‰ä¸‰æ¡æ•°æ®ï¼Œåˆ é™¤äº†ä¸¤æ¡æ•°æ®ä¹‹åé‡å¯æ•°æ®åº“ï¼Œå†æ–°å¢ä¸€æ¡æ•°æ®ï¼Œæ­¤æ—¶è¿™æ¡æ•°æ®çš„ ID æ˜¯å‡ ï¼Ÿ</h3><blockquote>\n<p>ç­‰ä»·äºï¼šè‡ªå¢ä¸»é”®èƒ½ä¸èƒ½è¢«æŒä¹…åŒ–çš„é—®é¢˜ï¼Ÿ</p>\n<p>MyISAMï¼šè‡ªå¢ä¸»é”®ä¼šæŒä¹…åŒ–åˆ°æ•°æ®æ–‡ä»¶ä¸­</p>\n<p>InnoDBï¼š<br>    5.7 ä»¥åŠä¹‹å‰ï¼šä¸ä¼šæŒä¹…åŒ–<br>    ä» 8 å¼€å§‹ï¼šè‡ªå¢ä¸»é”®ä¼šæŒä¹…åŒ–åˆ° redo log</p>\n</blockquote>\n<ol>\n<li><p>å¦‚æœè¡¨çš„å¼•æ“ç±»å‹æ˜¯ <strong>MyISAM</strong>ï¼Œé‚£ä¹ˆè¿™æ¡è®°å½•çš„ ID å°±æ˜¯ 4ã€‚å› ä¸º <strong>MyISAMè¡¨ä¼šæŠŠè‡ªå¢ä¸»é”®çš„æœ€å¤§IDè®°å½•åˆ°æ•°æ®æ–‡ä»¶é‡Œé¢</strong>ï¼Œé‡å¯ MySQL åï¼Œè‡ªå¢ä¸»é”®çš„æœ€å¤§ ID ä¹Ÿä¸ä¼šä¸¢å¤±ã€‚</p>\n</li>\n<li><p>å¦‚æœè¡¨çš„å¼•æ“ç±»å‹æ˜¯ <strong>InnoDB</strong>ï¼Œé‚£ä¹ˆè¿™æ¡è®°å½•çš„ ID å°±æ˜¯ 2ã€‚å› ä¸º <strong>InnoDBè¡¨æŠŠè‡ªå¢ä¸»é”®çš„æœ€å¤§IDè®°å½•åˆ°å†…å­˜ä¸­</strong>ï¼Œæ‰€ä»¥é‡å¯æ•°æ®åº“åä¼šä½¿æœ€å¤§ IDï¼ˆå…¶å®æ˜¯ AUTO_INCREMENT è®¡æ•°å™¨çš„å€¼ï¼‰ä¸¢å¤±ï¼›ä¸€æ—¦æ•°æ®åº“é‡æ–°è¿è¡Œï¼Œæ•°æ®åº“ä¼šè‡ªåŠ¨è®¡ç®—è‡ªå¢ä¸»é”®çš„æœ€å¤§ IDï¼ˆ<strong>å…¶å®å°±æ˜¯æŠŠæœ€åä¸€æ¡è®°å½• ID åŠ  1 å¹¶èµ‹å€¼ç»™ AUTO_INCREMENT</strong>ï¼‰å†æ¬¡æ”¾å…¥åˆ°å†…å­˜ä¸­ã€‚</p>\n<p> ã€æ³¨ã€‘<strong>è¿™ä»…ä»…æ˜¯ MySQL 8 ä»¥å‰çš„ç‰ˆæœ¬ï¼Œä¹Ÿå°±æ˜¯ MySQL 5.7 ä»¥åŠä¹‹å‰çš„ç‰ˆæœ¬</strong>ã€‚å› ä¸ºåœ¨ MySQL 8.0 ä¸­ï¼Œ<strong>InnoDB çš„è¡Œä¸ºå·²æ›´æ”¹</strong>ã€‚æ¯æ¬¡æ›´æ”¹æ—¶ï¼Œå½“å‰æœ€å¤§è‡ªåŠ¨å¢é‡è®¡æ•°å™¨å€¼ï¼ˆAUTO_INCREMENTï¼‰éƒ½ä¼šå†™å…¥é‡åšæ—¥å¿— redo logï¼Œå¹¶ä¿å­˜åˆ°æ¯ä¸ªæ£€æŸ¥ç‚¹çš„å¼•æ“ä¸“ç”¨ç³»ç»Ÿè¡¨ä¸­ã€‚è¿™äº›æ›´æ”¹ä½¿å½“å‰çš„æœ€å¤§è‡ªåŠ¨å¢é‡è®¡æ•°å™¨å€¼åœ¨æœåŠ¡å™¨é‡æ–°å¯åŠ¨åä¿æŒä¸å˜ï¼Œä¸ <strong>MyISAM</strong> ä¸€æ ·äº†ã€‚è¯¦è§å®˜æ–¹æ–‡æ¡£ï¼š<a href=\"https://dev.mysql.com/doc/refman/8.0/en/innodb-auto-increment-handling.html#innodb-auto-increment-initialization\">InnoDB AUTO_INCREMENT è®¡æ•°å™¨åˆå§‹åŒ–</a></p>\n<p> ã€æ³¨ã€‘å¦‚æœåˆ é™¤çš„ä¸æ˜¯æœ€åçš„è®°å½•ï¼Œé‚£ä¹ˆè‡ªå¢çš„æœ€å¤§ ID å…¨éƒ¨éƒ½ä¸€æ ·ï¼Œå› ä¸ºè‡ªåŠ¨å¢é‡è®¡æ•°å™¨å€¼ï¼ˆAUTO_INCREMENTï¼‰ä¸ä¼šæ”¹å˜ã€‚</p>\n</li>\n</ol>\n<h3 id=\"MySQL-ä¸­ä»€ä¹ˆæƒ…å†µä¼šå¯¼è‡´è‡ªå¢ä¸»é”®ä¸èƒ½è¿ç»­ï¼Ÿ\"><a href=\"#MySQL-ä¸­ä»€ä¹ˆæƒ…å†µä¼šå¯¼è‡´è‡ªå¢ä¸»é”®ä¸èƒ½è¿ç»­ï¼Ÿ\" class=\"headerlink\" title=\"MySQL ä¸­ä»€ä¹ˆæƒ…å†µä¼šå¯¼è‡´è‡ªå¢ä¸»é”®ä¸èƒ½è¿ç»­ï¼Ÿ\"></a>MySQL ä¸­ä»€ä¹ˆæƒ…å†µä¼šå¯¼è‡´è‡ªå¢ä¸»é”®ä¸èƒ½è¿ç»­ï¼Ÿ</h3><blockquote>\n<ol>\n<li>å”¯ä¸€é”®å†²çª</li>\n<li>äº‹åŠ¡å›æ»š</li>\n</ol>\n</blockquote>\n<ul>\n<li><p>æ‰§è¡Œå™¨æ‰§è¡Œæ’å…¥ï¼Œè‡ªå¢é”®+1ï¼Œä½†æ˜¯ innoDB å‘ç°æ’å…¥æ—¶<strong>å”¯ä¸€é”®å†²çª</strong>ï¼Œæ— æ³•æ’å…¥ï¼Œå¯¼è‡´çš„ä¸è¿ç»­ã€‚</p>\n</li>\n<li><p>äº‹åŠ¡æ·»åŠ è‡ªå¢é”®+1ï¼Œä½†æ˜¯ç”±äº<strong>äº‹åŠ¡å›æ»š</strong>ï¼Œæ•°æ®è¢«æ¸…é™¤ï¼Œå¯¼è‡´çš„ä¸è¿ç»­ã€‚</p>\n</li>\n</ul>\n<h3 id=\"ä»€ä¹ˆæ˜¯è¦†ç›–ç´¢å¼•ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯è¦†ç›–ç´¢å¼•ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯è¦†ç›–ç´¢å¼•ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯è¦†ç›–ç´¢å¼•ï¼Ÿ</h3><p>è¦†ç›–ç´¢å¼•æ˜¯æŒ‡ï¼Œç´¢å¼•ä¸Šçš„ä¿¡æ¯è¶³å¤Ÿæ»¡è¶³æŸ¥è¯¢è¯·æ±‚ï¼Œä¸éœ€è¦å†å›åˆ°ä¸»é”®ä¸Šå»å–æ•°æ®å³å›è¡¨ã€‚</p>\n<h3 id=\"å¦‚æœæŠŠä¸€ä¸ª-InnoDB-è¡¨çš„ä¸»é”®åˆ æ‰ï¼Œæ˜¯ä¸æ˜¯å°±æ²¡æœ‰ä¸»é”®ï¼Œå°±æ²¡åŠæ³•è¿›è¡Œå›è¡¨æŸ¥è¯¢äº†ï¼Ÿ\"><a href=\"#å¦‚æœæŠŠä¸€ä¸ª-InnoDB-è¡¨çš„ä¸»é”®åˆ æ‰ï¼Œæ˜¯ä¸æ˜¯å°±æ²¡æœ‰ä¸»é”®ï¼Œå°±æ²¡åŠæ³•è¿›è¡Œå›è¡¨æŸ¥è¯¢äº†ï¼Ÿ\" class=\"headerlink\" title=\"å¦‚æœæŠŠä¸€ä¸ª InnoDB è¡¨çš„ä¸»é”®åˆ æ‰ï¼Œæ˜¯ä¸æ˜¯å°±æ²¡æœ‰ä¸»é”®ï¼Œå°±æ²¡åŠæ³•è¿›è¡Œå›è¡¨æŸ¥è¯¢äº†ï¼Ÿ\"></a>å¦‚æœæŠŠä¸€ä¸ª InnoDB è¡¨çš„ä¸»é”®åˆ æ‰ï¼Œæ˜¯ä¸æ˜¯å°±æ²¡æœ‰ä¸»é”®ï¼Œå°±æ²¡åŠæ³•è¿›è¡Œå›è¡¨æŸ¥è¯¢äº†ï¼Ÿ</h3><p>å¦‚æœæŠŠä¸»é”®åˆ æ‰äº†ï¼Œé‚£ä¹ˆ InnoDB ä¼šè‡ªå·±ç”Ÿæˆä¸€ä¸ªé•¿åº¦ä¸º 6 å­—èŠ‚çš„ rowid ä½œä¸ºä¸»é”®ã€‚</p>\n<h3 id=\"å†…å­˜è¡¨å’Œä¸´æ—¶è¡¨æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"><a href=\"#å†…å­˜è¡¨å’Œä¸´æ—¶è¡¨æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"å†…å­˜è¡¨å’Œä¸´æ—¶è¡¨æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"></a>å†…å­˜è¡¨å’Œä¸´æ—¶è¡¨æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p>å†…å­˜è¡¨ï¼ŒæŒ‡çš„æ˜¯ä½¿ç”¨ Memory å¼•æ“çš„è¡¨ï¼Œæ•°æ®æ”¾åœ¨å†…å­˜ä¸­ï¼Œé‡å¯ä¼šè¢«æ¸…ç©ºï¼›</p>\n<p>ä¸´æ—¶è¡¨ï¼ŒæŒ‡çš„æ˜¯ä½¿ç”¨ InnoDB å¼•æ“æˆ–è€… MyISAM å¼•æ“çš„è¡¨ï¼Œæ•°æ®æ”¾åœ¨ç£ç›˜ä¸Šï¼Œé‡å¯ä¸ä¼šæ¸…ç©ºã€‚</p>\n<h3 id=\"MySQL-ä¸­çš„å­—ç¬¦ä¸²ç±»å‹éƒ½æœ‰å“ªäº›ï¼Ÿ\"><a href=\"#MySQL-ä¸­çš„å­—ç¬¦ä¸²ç±»å‹éƒ½æœ‰å“ªäº›ï¼Ÿ\" class=\"headerlink\" title=\"MySQL ä¸­çš„å­—ç¬¦ä¸²ç±»å‹éƒ½æœ‰å“ªäº›ï¼Ÿ\"></a>MySQL ä¸­çš„å­—ç¬¦ä¸²ç±»å‹éƒ½æœ‰å“ªäº›ï¼Ÿ</h3><table>\n<thead>\n<tr>\n<th><strong>ç±»å‹</strong></th>\n<th><strong>å–å€¼èŒƒå›´</strong></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>CHAR(N)</td>\n<td>0~255</td>\n</tr>\n<tr>\n<td>VARCHAR(N)</td>\n<td>0~65536</td>\n</tr>\n<tr>\n<td>TINYBLOB</td>\n<td>0~255</td>\n</tr>\n<tr>\n<td>BLOB</td>\n<td>0~65535</td>\n</tr>\n<tr>\n<td>MEDUIMBLOB</td>\n<td>0~167772150</td>\n</tr>\n<tr>\n<td>LONGBLOB</td>\n<td>0~4294967295</td>\n</tr>\n<tr>\n<td>TINYTEXT</td>\n<td>0~255</td>\n</tr>\n<tr>\n<td>TEXT</td>\n<td>0~65535</td>\n</tr>\n<tr>\n<td>MEDIUMTEXT</td>\n<td>0~167772150</td>\n</tr>\n<tr>\n<td>LONGTEXT</td>\n<td>0~4294967295</td>\n</tr>\n<tr>\n<td>VARBINARY(N)</td>\n<td>0~Nä¸ªå­—èŠ‚çš„å˜é•¿å­—èŠ‚å­—ç¬¦é›†</td>\n</tr>\n<tr>\n<td>BINARY(N)</td>\n<td>0~Nä¸ªå­—èŠ‚çš„å®šé•¿å­—èŠ‚å­—ç¬¦é›†</td>\n</tr>\n</tbody></table>\n<h3 id=\"VARCHAR-å’Œ-CHAR-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿåˆ†åˆ«é€‚ç”¨çš„åœºæ™¯æœ‰å“ªäº›ï¼Ÿ\"><a href=\"#VARCHAR-å’Œ-CHAR-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿåˆ†åˆ«é€‚ç”¨çš„åœºæ™¯æœ‰å“ªäº›ï¼Ÿ\" class=\"headerlink\" title=\"VARCHAR å’Œ CHAR çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿåˆ†åˆ«é€‚ç”¨çš„åœºæ™¯æœ‰å“ªäº›ï¼Ÿ\"></a>VARCHAR å’Œ CHAR çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿåˆ†åˆ«é€‚ç”¨çš„åœºæ™¯æœ‰å“ªäº›ï¼Ÿ</h3><p>VARCHAR çš„é•¿åº¦æ˜¯å¯å˜çš„ï¼Œè€Œ CHAR æ˜¯å›ºå®šé•¿åº¦ã€‚ç”±äºå®ƒä»¬çš„ç‰¹æ€§å†³å®šäº† CHAR æ¯”è¾ƒé€‚åˆé•¿åº¦è¾ƒçŸ­çš„å­—æ®µå’Œå›ºå®šé•¿åº¦çš„å­—æ®µï¼Œå¦‚èº«ä»½è¯å·ã€æ‰‹æœºå·ç­‰ï¼Œåä¹‹åˆ™é€‚åˆä½¿ç”¨ VARCHARã€‚</p>\n<h3 id=\"MySQL-å­˜å‚¨é‡‘é¢åº”è¯¥ä½¿ç”¨å“ªç§æ•°æ®ç±»å‹ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ\"><a href=\"#MySQL-å­˜å‚¨é‡‘é¢åº”è¯¥ä½¿ç”¨å“ªç§æ•°æ®ç±»å‹ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"MySQL å­˜å‚¨é‡‘é¢åº”è¯¥ä½¿ç”¨å“ªç§æ•°æ®ç±»å‹ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ\"></a>MySQL å­˜å‚¨é‡‘é¢åº”è¯¥ä½¿ç”¨å“ªç§æ•°æ®ç±»å‹ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</h3><p>MySQL å­˜å‚¨é‡‘é¢åº”è¯¥ä½¿ç”¨ <code>decimal</code> ï¼Œå› ä¸ºå¦‚æœå­˜å‚¨å…¶ä»–æ•°æ®ç±»å‹ï¼Œæ¯”å¦‚ <code>float</code> æœ‰å¯¼è‡´å°æ•°ç‚¹åæ•°æ®ä¸¢å¤±çš„é£é™©ã€‚</p>\n<h3 id=\"limit-3-2-çš„å«ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#limit-3-2-çš„å«ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"limit 3,2 çš„å«ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>limit 3,2 çš„å«ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>å»é™¤å‰ä¸‰æ¡æ•°æ®ä¹‹åæŸ¥è¯¢ä¸¤æ¡ä¿¡æ¯ã€‚</p>\n<h3 id=\"lastinsertid-å‡½æ•°åŠŸèƒ½æ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ\"><a href=\"#lastinsertid-å‡½æ•°åŠŸèƒ½æ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ\" class=\"headerlink\" title=\"lastinsertid() å‡½æ•°åŠŸèƒ½æ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ\"></a><em>lastinsertid()</em> å‡½æ•°åŠŸèƒ½æ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ</h3><p><em>lastinsertid()</em> ç”¨äºæŸ¥è¯¢æœ€åä¸€æ¬¡è‡ªå¢è¡¨çš„ç¼–å·ï¼ˆå…¨å±€çš„ï¼‰ï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯æŸ¥è¯¢æ—¶ä¸éœ€è¦æŒ‡å®šè¡¨åï¼Œä½¿ç”¨ <code>select last_insert_id()</code> å³å¯æŸ¥è¯¢ï¼Œå› ä¸ºä¸éœ€è¦æŒ‡å®šè¡¨åæ‰€ä»¥å®ƒå§‹ç»ˆä»¥æœ€åä¸€æ¡è‡ªå¢ç¼–å·ä¸ºä¸»ï¼Œå¯ä»¥è¢«å…¶å®ƒè¡¨çš„è‡ªå¢ç¼–å·è¦†ç›–ã€‚æ¯”å¦‚ A è¡¨çš„æœ€å¤§ç¼–å·æ˜¯ 10ï¼Œ <em>lastinsertid()</em> æŸ¥è¯¢å‡ºæ¥çš„å€¼ä¸º 10ï¼Œè¿™æ—¶ B è¡¨æ’å…¥äº†ä¸€æ¡æ•°æ®ï¼Œå®ƒçš„æœ€å¤§ç¼–å·ä¸º 3ï¼Œè¿™ä¸ªæ—¶å€™ä½¿ç”¨ <em>lastinsertid()</em> æŸ¥è¯¢çš„å€¼å°±æ˜¯ 3ã€‚</p>\n<h3 id=\"åˆ é™¤è¡¨çš„æ•°æ®æœ‰å‡ ç§æ–¹å¼ï¼Ÿå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"><a href=\"#åˆ é™¤è¡¨çš„æ•°æ®æœ‰å‡ ç§æ–¹å¼ï¼Ÿå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"åˆ é™¤è¡¨çš„æ•°æ®æœ‰å‡ ç§æ–¹å¼ï¼Ÿå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"></a>åˆ é™¤è¡¨çš„æ•°æ®æœ‰å‡ ç§æ–¹å¼ï¼Ÿå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p>åˆ é™¤æ•°æ®æœ‰ä¸¤ç§æ–¹å¼ï¼šdelete å’Œ truncateï¼Œå®ƒä»¬çš„åŒºåˆ«å¦‚ä¸‹ï¼š</p>\n<ul>\n<li><p>delete å¯ä»¥æ·»åŠ  where æ¡ä»¶åˆ é™¤éƒ¨åˆ†æ•°æ®ï¼Œtruncate ä¸èƒ½æ·»åŠ  where æ¡ä»¶åªèƒ½åˆ é™¤æ•´å¼ è¡¨ï¼›</p>\n</li>\n<li><p>delete çš„åˆ é™¤ä¿¡æ¯ä¼šåœ¨ MySQL çš„æ—¥å¿—ä¸­è®°å½•ï¼Œè€Œ truncate çš„åˆ é™¤ä¿¡æ¯ä¸è¢«è®°å½•åœ¨ MySQL çš„æ—¥å¿—ä¸­ï¼Œ<br>å› æ­¤ detele çš„ä¿¡æ¯å¯ä»¥è¢«æ‰¾å›è€Œ truncate çš„ä¿¡æ¯æ— æ³•è¢«æ‰¾å›ï¼›</p>\n</li>\n<li><p>truncate å› ä¸ºä¸è®°å½•æ—¥å¿—æ‰€ä»¥æ‰§è¡Œæ•ˆç‡æ¯” delete å¿«ã€‚</p>\n</li>\n</ul>\n<h3 id=\"MySQL-ä¸­æ”¯æŒå‡ ç§æ¨¡ç³ŠæŸ¥è¯¢ï¼Ÿå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"><a href=\"#MySQL-ä¸­æ”¯æŒå‡ ç§æ¨¡ç³ŠæŸ¥è¯¢ï¼Ÿå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"MySQL ä¸­æ”¯æŒå‡ ç§æ¨¡ç³ŠæŸ¥è¯¢ï¼Ÿå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"></a>MySQL ä¸­æ”¯æŒå‡ ç§æ¨¡ç³ŠæŸ¥è¯¢ï¼Ÿå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p>MySQL ä¸­æ”¯æŒä¸¤ç§æ¨¡ç³ŠæŸ¥è¯¢ï¼šregexp å’Œ like<br>like æ˜¯å¯¹ä»»æ„å¤šå­—ç¬¦åŒ¹é…æˆ–ä»»æ„å•å­—ç¬¦è¿›è¡Œæ¨¡ç³ŠåŒ¹é…ï¼Œ<br>è€Œ regexp åˆ™æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…æ–¹å¼ï¼Œæä¾›æ¯” like æ›´å¤šçš„åŒ¹é…æ–¹å¼ã€‚<br>regexp å’Œ like çš„ä½¿ç”¨ç¤ºä¾‹å¦‚ä¸‹ï¼š </p>\n<blockquote>\n<p>select * from person where uname like â€˜%SQL%â€™;<br>select * from person where uname regexp â€˜.SQL*.â€™; </p>\n</blockquote>\n<h3 id=\"count-column-å’Œ-count-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"><a href=\"#count-column-å’Œ-count-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"count(column) å’Œ count(*) æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"></a><em>count(column)</em> å’Œ <em>count(*)</em> æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p><em>count(column)</em> ç»Ÿè®¡ä¸ä¼šç»Ÿè®¡åˆ—å€¼ä¸º null çš„æ•°æ®ï¼Œ<br>è€Œ <em>count(*)</em> åˆ™ä¼šç»Ÿè®¡æ‰€æœ‰ä¿¡æ¯ï¼Œæ‰€ä»¥æœ€ç»ˆçš„ç»Ÿè®¡ç»“æœå¯èƒ½ä¼šä¸åŒã€‚</p>\n<h3 id=\"ä¸ºä»€ä¹ˆ-InnoDB-ä¸æŠŠæ€»æ¡æ•°è®°å½•ä¸‹æ¥ï¼ŒæŸ¥è¯¢çš„æ—¶å€™ç›´æ¥è¿”å›å‘¢ï¼Ÿ\"><a href=\"#ä¸ºä»€ä¹ˆ-InnoDB-ä¸æŠŠæ€»æ¡æ•°è®°å½•ä¸‹æ¥ï¼ŒæŸ¥è¯¢çš„æ—¶å€™ç›´æ¥è¿”å›å‘¢ï¼Ÿ\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆ InnoDB ä¸æŠŠæ€»æ¡æ•°è®°å½•ä¸‹æ¥ï¼ŒæŸ¥è¯¢çš„æ—¶å€™ç›´æ¥è¿”å›å‘¢ï¼Ÿ\"></a>ä¸ºä»€ä¹ˆ InnoDB ä¸æŠŠæ€»æ¡æ•°è®°å½•ä¸‹æ¥ï¼ŒæŸ¥è¯¢çš„æ—¶å€™ç›´æ¥è¿”å›å‘¢ï¼Ÿ</h3><p>å› ä¸º <strong>InnoDB æ”¯æŒäº‹åŠ¡</strong>ï¼Œå³ä½¿æ˜¯åœ¨åŒä¸€æ—¶é—´è¿›è¡ŒæŸ¥è¯¢ï¼Œå¾—åˆ°çš„ç»“æœä¹Ÿå¯èƒ½ä¸ç›¸åŒï¼Œæ‰€ä»¥ InnoDB ä¸èƒ½æŠŠç»“æœç›´æ¥ä¿å­˜ä¸‹æ¥ï¼Œå› ä¸ºè¿™æ ·æ˜¯ä¸å‡†ç¡®çš„ã€‚</p>\n<h3 id=\"InnoDB-å’Œ-MyISAM-æ‰§è¡Œ-select-count-from-tï¼Œå“ªä¸ªæ•ˆç‡æ›´é«˜ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ\"><a href=\"#InnoDB-å’Œ-MyISAM-æ‰§è¡Œ-select-count-from-tï¼Œå“ªä¸ªæ•ˆç‡æ›´é«˜ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"InnoDB å’Œ MyISAM æ‰§è¡Œ select count(*) from tï¼Œå“ªä¸ªæ•ˆç‡æ›´é«˜ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ\"></a>InnoDB å’Œ MyISAM æ‰§è¡Œ select count(*) from tï¼Œå“ªä¸ªæ•ˆç‡æ›´é«˜ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</h3><p>MyISAM æ•ˆç‡æœ€é«˜ï¼Œå› ä¸º MyISAM å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªè®¡æ•°å™¨ï¼Œç›´æ¥è¿”å›æ€»æ¡æ•°ï¼Œè€Œ InnoDB è¦é€è¡Œç»Ÿè®¡ã€‚</p>\n<h3 id=\"åœ¨-InnoDB-å¼•æ“ä¸­-count-ã€count-1-ã€count-ä¸»é”®-ã€count-å­—æ®µ-å“ªä¸ªæ€§èƒ½æœ€é«˜ï¼Ÿ\"><a href=\"#åœ¨-InnoDB-å¼•æ“ä¸­-count-ã€count-1-ã€count-ä¸»é”®-ã€count-å­—æ®µ-å“ªä¸ªæ€§èƒ½æœ€é«˜ï¼Ÿ\" class=\"headerlink\" title=\"åœ¨ InnoDB å¼•æ“ä¸­ count(*)ã€count(1)ã€count(ä¸»é”®)ã€count(å­—æ®µ) å“ªä¸ªæ€§èƒ½æœ€é«˜ï¼Ÿ\"></a>åœ¨ InnoDB å¼•æ“ä¸­ count(*)ã€count(1)ã€count(ä¸»é”®)ã€count(å­—æ®µ) å“ªä¸ªæ€§èƒ½æœ€é«˜ï¼Ÿ</h3><p>count(å­—æ®µ)&lt;count(ä¸»é”® id)&lt;count(1)â‰ˆcount(*) é¢˜ç›®è§£æï¼š</p>\n<ul>\n<li>å¯¹äº count(å­—æ®µ) æ¥è¯´ï¼Œéå†æ•´å¼ è¡¨ï¼Œå–è¿™ä¸ªå­—æ®µï¼Œç„¶ååˆ¤æ–­æ˜¯å¦ä¸º nullï¼Œä¸ä¸º null åˆ™åŠ  1</li>\n<li>å¯¹äº count(ä¸»é”® id) æ¥è¯´ï¼Œéå†æ•´å¼ è¡¨ï¼Œå–ä¸»é”® idï¼Œä¸å¯èƒ½ä¸ºç©ºï¼Œæ¯æ¬¡åŠ  1ã€‚ä½†æ˜¯å¯èƒ½ä½¿ç”¨æœ€å°çš„ç´¢å¼•æ ‘ã€‚</li>\n<li>å¯¹äº count(1) æ¥è¯´ï¼Œéå†æ•´å¼ è¡¨ï¼Œä¸å–å€¼ã€‚1 æ˜¯ä¸å¯èƒ½ä¸ºç©ºçš„ï¼Œæ¯æ¬¡åŠ  1ã€‚</li>\n<li>å¯¹äº count(*) æ¥è¯´ï¼Œéå†æ•´å¼ è¡¨ï¼Œä¸å–å€¼ï¼Œç›´æ¥æŒ‰è¡Œç´¯åŠ ã€‚å®é™…ä¸Šï¼Œå½“ä½¿ç”¨ count(*) æ—¶ï¼ŒMySQL ä¼šå°† * å‚æ•°è½¬åŒ–ä¸ºå‚æ•° 0 æ¥å¤„ç†ã€‚</li>\n</ul>\n<p>æ‰€ä»¥æœ€åå¾—å‡ºçš„ç»“æœæ˜¯ï¼šcount(å­—æ®µ)&lt;count(ä¸»é”® id)&lt;count(1)â‰ˆcount(*)ã€‚</p>\n<h3 id=\"MySQL-ä¸­å†…è¿æ¥ã€å·¦è¿æ¥ã€å³è¿æ¥æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"><a href=\"#MySQL-ä¸­å†…è¿æ¥ã€å·¦è¿æ¥ã€å³è¿æ¥æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"MySQL ä¸­å†…è¿æ¥ã€å·¦è¿æ¥ã€å³è¿æ¥æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"></a>MySQL ä¸­å†…è¿æ¥ã€å·¦è¿æ¥ã€å³è¿æ¥æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><ul>\n<li><p>å†…è¿ï¼ˆinner joinï¼‰â€” æŠŠåŒ¹é…çš„å…³è”æ•°æ®æ˜¾ç¤ºå‡ºæ¥ï¼›</p>\n</li>\n<li><p>å·¦è¿æ¥ï¼ˆleft joinï¼‰â€” æŠŠå·¦è¾¹çš„è¡¨å…¨éƒ¨æ˜¾ç¤ºå‡ºæ¥ï¼Œå³è¾¹çš„è¡¨æ˜¾ç¤ºå‡ºç¬¦åˆæ¡ä»¶çš„æ•°æ®ï¼›</p>\n</li>\n<li><p>å³è¿æ¥ï¼ˆright joinï¼‰â€” æŠŠå³è¾¹çš„è¡¨å…¨éƒ¨æ˜¾ç¤ºå‡ºæ¥ï¼Œå·¦è¾¹çš„è¡¨æ˜¾ç¤ºå‡ºç¬¦åˆæ¡ä»¶çš„æ•°æ®ï¼›</p>\n</li>\n</ul>\n<h2 id=\"MySQLç´¢å¼•ç¯‡\"><a href=\"#MySQLç´¢å¼•ç¯‡\" class=\"headerlink\" title=\"MySQLç´¢å¼•ç¯‡\"></a>MySQLç´¢å¼•ç¯‡</h2><h3 id=\"ä»€ä¹ˆæ˜¯ç´¢å¼•ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯ç´¢å¼•ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ç´¢å¼•ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯ç´¢å¼•ï¼Ÿ</h3><p>ç´¢å¼•æ˜¯ä¸€ç§èƒ½å¸®åŠ© MySQL æé«˜æŸ¥è¯¢æ•ˆç‡çš„æ•°æ®ç»“æ„ã€‚</p>\n<h3 id=\"ç´¢å¼•åˆ†åˆ«æœ‰å“ªäº›ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Ÿ\"><a href=\"#ç´¢å¼•åˆ†åˆ«æœ‰å“ªäº›ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Ÿ\" class=\"headerlink\" title=\"ç´¢å¼•åˆ†åˆ«æœ‰å“ªäº›ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Ÿ\"></a>ç´¢å¼•åˆ†åˆ«æœ‰å“ªäº›ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Ÿ</h3><p><strong>ç´¢å¼•çš„ä¼˜ç‚¹ï¼š</strong></p>\n<ul>\n<li>æé«˜æŸ¥è¯¢æ•ˆç‡</li>\n</ul>\n<p><strong>ç´¢å¼•çš„ç¼ºç‚¹ï¼š</strong></p>\n<ul>\n<li><p>è™½ç„¶æé«˜äº†æŸ¥è¯¢é€Ÿåº¦ï¼Œä½†å´é™ä½äº†æ›´æ–°è¡¨çš„é€Ÿåº¦ï¼Œæ¯”å¦‚ updateã€insertï¼›<br>å› ä¸ºæ›´æ–°æ•°æ®æ—¶ï¼ŒMySQL ä¸ä»…è¦æ›´æ–°æ•°æ®ï¼Œè¿˜è¦æ›´æ–°ç´¢å¼•æ–‡ä»¶ï¼›</p>\n</li>\n<li><p>å»ºç«‹ç´¢å¼•çš„ç´¢å¼•æ–‡ä»¶ä¼šå ç”¨ç£ç›˜ã€‚</p>\n</li>\n</ul>\n<h3 id=\"MySQLç´¢å¼•çš„æ³¨æ„äº‹é¡¹\"><a href=\"#MySQLç´¢å¼•çš„æ³¨æ„äº‹é¡¹\" class=\"headerlink\" title=\"MySQLç´¢å¼•çš„æ³¨æ„äº‹é¡¹\"></a>MySQLç´¢å¼•çš„æ³¨æ„äº‹é¡¹</h3><p><strong>1ã€è”åˆç´¢å¼•éµå¾ªå‰ç¼€åŸåˆ™</strong></p>\n<p><strong>2ã€likeæ¨¡ç³ŠæŸ¥è¯¢ï¼Œ%ä¸èƒ½åœ¨å‰</strong></p>\n<p><strong>3ã€</strong>åˆ—å€¼ä¸ºç©ºï¼ˆNULLï¼‰æ—¶æ˜¯å¯ä»¥ä½¿ç”¨ç´¢å¼•çš„ï¼Œä½† MySQL éš¾ä»¥ä¼˜åŒ–å¼•ç”¨äº†å¯ç©ºåˆ—çš„æŸ¥è¯¢,å®ƒä¼šä½¿ç´¢å¼•ã€ç´¢å¼•ç»Ÿè®¡å’Œå€¼æ›´åŠ å¤æ‚ã€‚å¯ç©ºåˆ—éœ€è¦æ›´å¤šçš„å‚¨å­˜ç©ºé—´ï¼Œè¿˜éœ€è¦åœ¨ MySQL å†…éƒ¨è¿›è¡Œç‰¹æ®Šå¤„ç†ã€‚</p>\n<p><strong>4ã€</strong> å¦‚æœ MySQL ä¼°è®¡ä½¿ç”¨ç´¢å¼•æ¯”å…¨è¡¨æ‰«ææ›´æ…¢ï¼Œä¼šæ”¾å¼ƒä½¿ç”¨ç´¢å¼•ï¼Œä¾‹å¦‚ï¼š<br>è¡¨ä¸­åªæœ‰ 100 æ¡æ•°æ®å·¦å³ã€‚å¯¹äº SQL è¯­å¥ WHERE id &gt; 1 AND id &lt; 100ï¼ŒMySQL ä¼šä¼˜å…ˆè€ƒè™‘å…¨è¡¨æ‰«æã€‚</p>\n<p><strong>5ã€</strong> <strong>å¦‚æœå…³é”®è¯orå‰é¢çš„æ¡ä»¶ä¸­çš„åˆ—æœ‰ç´¢å¼•ï¼Œåé¢çš„æ²¡æœ‰ï¼Œæ‰€æœ‰åˆ—çš„ç´¢å¼•éƒ½ä¸ä¼šè¢«ç”¨åˆ°ã€‚</strong></p>\n<p><strong>6ã€</strong> åˆ—ç±»å‹æ˜¯å­—ç¬¦ä¸²ï¼ŒæŸ¥è¯¢æ—¶ä¸€å®šè¦ç»™å€¼åŠ å¼•å·ï¼Œå¦åˆ™ç´¢å¼•å¤±æ•ˆï¼Œä¾‹å¦‚ï¼š<br>åˆ— name varchar(16)ï¼Œå­˜å‚¨äº†å­—ç¬¦ä¸²â€100â€<br>WHERE name &#x3D; 100;  ï¼ˆåšäº†è‡ªåŠ¨ç±»å‹è½¬æ¢ï¼‰<br>ä»¥ä¸Š SQL è¯­å¥èƒ½æœåˆ°ï¼Œä½†æ— æ³•ç”¨åˆ°ç´¢å¼•ã€‚</p>\n<p><strong>7ã€ä¸åœ¨ç´¢å¼•åˆ—ä¸Šåšä»»ä½•æ“ä½œï¼ˆè®¡ç®—ã€å‡½æ•°ã€ï¼ˆè‡ªåŠ¨æˆ–æ‰‹åŠ¨ï¼‰ç±»å‹è½¬æ¢ï¼‰ï¼Œä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆè€Œè½¬å‘å…¨è¡¨æ‰«æ</strong> </p>\n<h3 id=\"ä¸ºä»€ä¹ˆ-MySQL-å®˜æ–¹å»ºè®®ä½¿ç”¨è‡ªå¢ä¸»é”®ä½œä¸ºè¡¨çš„ä¸»é”®ï¼Ÿ\"><a href=\"#ä¸ºä»€ä¹ˆ-MySQL-å®˜æ–¹å»ºè®®ä½¿ç”¨è‡ªå¢ä¸»é”®ä½œä¸ºè¡¨çš„ä¸»é”®ï¼Ÿ\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆ MySQL å®˜æ–¹å»ºè®®ä½¿ç”¨è‡ªå¢ä¸»é”®ä½œä¸ºè¡¨çš„ä¸»é”®ï¼Ÿ\"></a>ä¸ºä»€ä¹ˆ MySQL å®˜æ–¹å»ºè®®ä½¿ç”¨è‡ªå¢ä¸»é”®ä½œä¸ºè¡¨çš„ä¸»é”®ï¼Ÿ</h3><p>ä¼˜ç‚¹ï¼š</p>\n<ol>\n<li><p>é¡µåˆ†è£‚é—®é¢˜ã€‚å¦‚æœä½¿ç”¨éè‡ªå¢ä¸»é”®ä½œä¸ºè¡¨çš„ä¸»é”®çš„è¯ï¼Œå½“æ–°æ’å…¥çš„æ•°æ®ä¼šå°†æ•°æ®é¡µå†™æ»¡ï¼Œmysql å°±éœ€è¦ç”³è¯·æ–°çš„æ•°æ®é¡µï¼Œå¹¶ä¸”æŠŠä¸Šä¸ªæ•°æ®é¡µä¸­çš„éƒ¨åˆ†æ•°æ®æŒªåˆ°æ–°çš„æ•°æ®é¡µä¸Šï¼Œä»¥ç¡®ä¿ç´¢å¼•æœ‰åºã€‚ä¹Ÿå°±æ˜¯è¯´é€ æˆäº†é¡µåˆ†è£‚ï¼Œå¤§é‡ç§»åŠ¨æ•°æ®çš„è¿‡ç¨‹ä¸¥é‡å½±å“æ’å…¥æ•ˆç‡ã€‚</p>\n</li>\n<li><p>å­˜å‚¨ç©ºé—´é—®é¢˜ã€‚è‡ªå¢ä¸»é”®å­˜å‚¨ç©ºé—´å°ï¼ŒåŒä¸€ä¸ªç»“ç‚¹å†…èƒ½å­˜æ”¾æ›´å¤šçš„ä¸»é”®ï¼Œæ ‘çš„é«˜åº¦å¯èƒ½é™ä½ï¼Œå‡å°‘ io æ¬¡æ•°ã€‚</p>\n</li>\n</ol>\n<p>ç¼ºç‚¹ï¼š</p>\n<ol>\n<li>æ•°æ®é‡è¿‡å¤§ï¼Œå¯èƒ½ä¼šè¶…å‡ºè‡ªå¢é•¿å–å€¼èŒƒå›´ï¼›</li>\n<li>æ— æ³•æ»¡è¶³åˆ†å¸ƒå¼å­˜å‚¨ï¼Œåˆ†åº“åˆ†è¡¨çš„æƒ…å†µä¸‹æ— æ³•åˆå¹¶è¡¨ï¼›</li>\n<li>ä¸»é”®æœ‰è‡ªå¢è§„å¾‹ï¼Œå®¹æ˜“è¢«ç ´è§£ï¼›</li>\n</ol>\n<p><strong>ç»¼ä¸Šæ‰€è¿°ï¼š</strong>æ˜¯å¦éœ€è¦ä½¿ç”¨è‡ªå¢ä¸»é”®ï¼Œéœ€è¦æ ¹æ®è‡ªå·±çš„ä¸šåŠ¡åœºæ™¯æ¥è®¾è®¡ã€‚å¦‚æœæ˜¯å•è¡¨å•åº“ï¼Œåˆ™ä¼˜å…ˆè€ƒè™‘è‡ªå¢ä¸»é”®ï¼Œå¦‚æœæ˜¯åˆ†å¸ƒå¼å­˜å‚¨ï¼Œåˆ†åº“åˆ†è¡¨ï¼Œåˆ™éœ€è¦è€ƒè™‘æ•°æ®åˆå¹¶çš„ä¸šåŠ¡åœºæ™¯æ¥åšæ•°æ®åº“è®¾è®¡æ–¹æ¡ˆã€‚</p>\n<h3 id=\"ç´¢å¼•æœ‰å‡ ç§ç±»å‹ï¼Ÿåˆ†åˆ«å¦‚ä½•åˆ›å»ºï¼Ÿ\"><a href=\"#ç´¢å¼•æœ‰å‡ ç§ç±»å‹ï¼Ÿåˆ†åˆ«å¦‚ä½•åˆ›å»ºï¼Ÿ\" class=\"headerlink\" title=\"ç´¢å¼•æœ‰å‡ ç§ç±»å‹ï¼Ÿåˆ†åˆ«å¦‚ä½•åˆ›å»ºï¼Ÿ\"></a>ç´¢å¼•æœ‰å‡ ç§ç±»å‹ï¼Ÿåˆ†åˆ«å¦‚ä½•åˆ›å»ºï¼Ÿ</h3><p>**MySQL çš„ç´¢å¼•æœ‰ä¸¤ç§åˆ†ç±»æ–¹å¼ï¼šé€»è¾‘åˆ†ç±»å’Œç‰©ç†åˆ†ç±»ã€‚ **</p>\n<p><strong>æŒ‰ç…§é€»è¾‘åˆ†ç±»ï¼Œç´¢å¼•å¯åˆ†ä¸ºï¼š</strong></p>\n<ul>\n<li>ä¸»é”®ç´¢å¼•ï¼šä¸€å¼ è¡¨åªèƒ½æœ‰ä¸€ä¸ªä¸»é”®ç´¢å¼•ï¼Œä¸å…è®¸é‡å¤ã€ä¸å…è®¸ä¸º NULLï¼›</li>\n<li>å”¯ä¸€ç´¢å¼•ï¼šæ•°æ®åˆ—ä¸å…è®¸é‡å¤ï¼Œå…è®¸ä¸º NULL å€¼ï¼Œä¸€å¼ è¡¨å¯æœ‰å¤šä¸ªå”¯ä¸€ç´¢å¼•ï¼Œä½†æ˜¯ä¸€ä¸ªå”¯ä¸€ç´¢å¼•åªèƒ½åŒ…å«ä¸€åˆ—ï¼Œæ¯”å¦‚èº«ä»½è¯å·ç ã€å¡å·ç­‰éƒ½å¯ä»¥ä½œä¸ºå”¯ä¸€ç´¢å¼•ï¼›</li>\n<li>æ™®é€šç´¢å¼•ï¼šä¸€å¼ è¡¨å¯ä»¥åˆ›å»ºå¤šä¸ªæ™®é€šç´¢å¼•ï¼Œä¸€ä¸ªæ™®é€šç´¢å¼•å¯ä»¥åŒ…å«å¤šä¸ªå­—æ®µï¼Œå…è®¸æ•°æ®é‡å¤ï¼Œå…è®¸ NULL å€¼æ’å…¥ï¼›</li>\n</ul>\n<p><strong>æŒ‰ç…§ç‰©ç†åˆ†ç±»ï¼Œç´¢å¼•å¯åˆ†ä¸ºï¼š</strong></p>\n<ul>\n<li>èšç°‡ç´¢å¼•ï¼šInnoDB çš„ä¸»é”®ç´¢å¼•å­˜å‚¨é‡‡ç”¨èšç°‡ç´¢å¼•ï¼Œä¸»é”®å€¼å’Œæ•°æ®å­˜æ”¾åœ¨ä¸€èµ·</li>\n<li>éèšç°‡ç´¢å¼•ï¼šMyISAM çš„ä¸»é”®ç´¢å¼•å­˜å‚¨é‡‡ç”¨éèšç°‡ç´¢å¼•ï¼Œä¸»é”®å€¼å’ŒæŒ‡å‘æ•°æ®çš„æŒ‡é’ˆå­˜æ”¾åœ¨ä¸€èµ·ï¼Œæ•°æ®å¦å¼€ç©ºé—´å­˜å‚¨</li>\n</ul>\n<p><strong>å„ç§ç´¢å¼•çš„åˆ›å»ºè„šæœ¬å¦‚ä¸‹ï¼š</strong></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºä¸»é”®ç´¢å¼•</span></span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">TABLE</span> <span class=\"keyword\">user</span> <span class=\"keyword\">ADD</span> <span class=\"keyword\">PRIMARY</span> KEY (column_list);</span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºå”¯ä¸€ç´¢å¼•</span></span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">TABLE</span> <span class=\"keyword\">user</span> <span class=\"keyword\">ADD</span> <span class=\"keyword\">UNIQUE</span> index_name (column_list);</span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºæ™®é€šç´¢å¼•</span></span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">TABLE</span> <span class=\"keyword\">user</span> <span class=\"keyword\">ADD</span> INDEX index_name (column_list);</span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºå…¨æ–‡ç´¢å¼•</span></span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">TABLE</span> <span class=\"keyword\">user</span> <span class=\"keyword\">ADD</span> FULLTEXT index_name (column_list);</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"ä»€ä¹ˆå«å›è¡¨æŸ¥è¯¢ï¼Ÿ\"><a href=\"#ä»€ä¹ˆå«å›è¡¨æŸ¥è¯¢ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆå«å›è¡¨æŸ¥è¯¢ï¼Ÿ\"></a>ä»€ä¹ˆå«å›è¡¨æŸ¥è¯¢ï¼Ÿ</h3><p>æ™®é€šç´¢å¼•æŸ¥è¯¢åˆ°ä¸»é”®ç´¢å¼•åï¼Œå›åˆ°ä¸»é”®ç´¢å¼•æ ‘æœç´¢çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬ç§°ä¸ºå›è¡¨æŸ¥è¯¢ã€‚</p>\n<p>ä¹Ÿå°±æ˜¯è¯´ï¼ŒåŸºäºéä¸»é”®ç´¢å¼•çš„æŸ¥è¯¢éœ€è¦å¤šæ‰«æä¸€æ¬¡ä¸»é”®ç´¢å¼•æ ‘ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨åº”ç”¨ä¸­åº”è¯¥å°½é‡ä½¿ç”¨ä¸»é”®æŸ¥è¯¢ã€‚</p>\n<p>ä¾‹å¤–å°±æ˜¯ä½¿ç”¨éä¸»é”®ç´¢å¼•æ—¶ï¼Œå¦‚æœå½“å‰ç´¢å¼•æ»¡è¶³æŸ¥è¯¢éœ€æ±‚ï¼Œåˆ™ä¸ç”¨å›è¡¨ã€‚</p>\n<h3 id=\"åœ¨-InnDB-ä¸­ä¸»é”®ç´¢å¼•ä¸ºä»€ä¹ˆæ¯”æ™®é€šç´¢å¼•çš„æŸ¥è¯¢æ€§èƒ½é«˜ï¼Ÿ\"><a href=\"#åœ¨-InnDB-ä¸­ä¸»é”®ç´¢å¼•ä¸ºä»€ä¹ˆæ¯”æ™®é€šç´¢å¼•çš„æŸ¥è¯¢æ€§èƒ½é«˜ï¼Ÿ\" class=\"headerlink\" title=\"åœ¨ InnDB ä¸­ä¸»é”®ç´¢å¼•ä¸ºä»€ä¹ˆæ¯”æ™®é€šç´¢å¼•çš„æŸ¥è¯¢æ€§èƒ½é«˜ï¼Ÿ\"></a>åœ¨ InnDB ä¸­ä¸»é”®ç´¢å¼•ä¸ºä»€ä¹ˆæ¯”æ™®é€šç´¢å¼•çš„æŸ¥è¯¢æ€§èƒ½é«˜ï¼Ÿ</h3><p>å›è¡¨ã€‚å› ä¸ºæ™®é€šç´¢å¼•çš„æŸ¥è¯¢ä¼šå¤šæ‰§è¡Œä¸€æ¬¡æ£€ç´¢æ“ä½œã€‚æ¯”å¦‚ä¸»é”®æŸ¥è¯¢ select * from t where id&#x3D;10 åªéœ€è¦æœç´¢ id çš„è¿™æ£µ B+ æ ‘ï¼Œè€Œæ™®é€šç´¢å¼•æŸ¥è¯¢ select * from t where f&#x3D;3 ä¼šå…ˆæŸ¥è¯¢ f ç´¢å¼•æ ‘ï¼Œå¾—åˆ° id çš„å€¼ä¹‹åå†å»æœç´¢ id çš„ B+ æ ‘ï¼Œå› ä¸ºå¤šæ‰§è¡Œäº†ä¸€æ¬¡æ£€ç´¢ï¼Œæ‰€ä»¥æ‰§è¡Œæ•ˆç‡å°±æ¯”ä¸»é”®ç´¢å¼•è¦ä½ã€‚</p>\n<h3 id=\"MySQL-å¤åˆç´¢å¼•åº”è¯¥æ³¨æ„ä»€ä¹ˆï¼Ÿ\"><a href=\"#MySQL-å¤åˆç´¢å¼•åº”è¯¥æ³¨æ„ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"MySQL å¤åˆç´¢å¼•åº”è¯¥æ³¨æ„ä»€ä¹ˆï¼Ÿ\"></a>MySQL å¤åˆç´¢å¼•åº”è¯¥æ³¨æ„ä»€ä¹ˆï¼Ÿ</h3><p>MySQL ä¸­çš„å¤åˆç´¢å¼•ï¼Œéµå¾ªæœ€å·¦åŒ¹é…åŸåˆ™ï¼Œæ¯”å¦‚ï¼Œè”åˆç´¢å¼•ä¸º key(a,b,c)ï¼Œåˆ™èƒ½è§¦å‘ç´¢å¼•çš„æœç´¢ç»„åˆæ˜¯ a|ab|abc è¿™ä¸‰ç§æŸ¥è¯¢ã€‚</p>\n<h3 id=\"å¤åˆç´¢å¼•çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#å¤åˆç´¢å¼•çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"å¤åˆç´¢å¼•çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>å¤åˆç´¢å¼•çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</h3><ul>\n<li>ç”¨äºå¤šå­—æ®µæŸ¥è¯¢ï¼Œæ¯”å¦‚ï¼Œå»ºäº†ä¸€ä¸ª key(a,b,c) çš„è”åˆç´¢å¼•ï¼Œé‚£ä¹ˆå®é™…ç­‰äºå»ºäº†<code>key(a)ã€key(a,b)ã€key(a,b,c)</code>ç­‰ä¸‰ä¸ªç´¢å¼•ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œæ¯å¤šä¸€ä¸ªç´¢å¼•ï¼Œå°±ä¼šå¤šä¸€äº›å†™æ“ä½œå’Œå ç”¨ç£ç›˜ç©ºé—´çš„å¼€é”€ï¼Œå°¤å…¶æ˜¯å¯¹å¤§æ•°æ®é‡çš„è¡¨æ¥è¯´ï¼Œè¿™å¯ä»¥å‡å°‘ä¸€éƒ¨åˆ†ä¸å¿…è¦çš„å¼€é”€ï¼›</li>\n<li>è¦†ç›–ç´¢å¼•ï¼Œæ¯”å¦‚ï¼Œå¯¹äºè”åˆç´¢å¼• key(a,b,c) æ¥è¯´ï¼Œå¦‚æœä½¿ç”¨ SQLï¼š<code>select a,b,c from table where a=1 and b = 1</code> ï¼Œå°±å¯ä»¥ç›´æ¥é€šè¿‡éå†ç´¢å¼•å–å¾—æ•°æ®ï¼Œè€Œ<strong>æ— éœ€å›è¡¨æŸ¥è¯¢</strong>ï¼Œè¿™å°±å‡å°‘äº†éšæœºçš„ IO æ“ä½œï¼Œå‡å°‘éšæœºçš„ IO æ“ä½œï¼Œå¯ä»¥æœ‰æ•ˆçš„æå‡æ•°æ®åº“æŸ¥è¯¢çš„æ€§èƒ½ï¼Œæ˜¯éå¸¸é‡è¦çš„æ•°æ®åº“ä¼˜åŒ–æ‰‹æ®µä¹‹ä¸€ï¼›</li>\n<li>ç´¢å¼•åˆ—è¶Šå¤šï¼Œé€šè¿‡ç´¢å¼•ç­›é€‰å‡ºçš„æ•°æ®è¶Šå°‘ã€‚</li>\n</ul>\n<h3 id=\"ä»€ä¹ˆæ˜¯æœ€å·¦åŒ¹é…åŸåˆ™ï¼Ÿå®ƒçš„ç”Ÿæ•ˆåŸåˆ™æœ‰å“ªäº›ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯æœ€å·¦åŒ¹é…åŸåˆ™ï¼Ÿå®ƒçš„ç”Ÿæ•ˆåŸåˆ™æœ‰å“ªäº›ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯æœ€å·¦åŒ¹é…åŸåˆ™ï¼Ÿå®ƒçš„ç”Ÿæ•ˆåŸåˆ™æœ‰å“ªäº›ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯æœ€å·¦åŒ¹é…åŸåˆ™ï¼Ÿå®ƒçš„ç”Ÿæ•ˆåŸåˆ™æœ‰å“ªäº›ï¼Ÿ</h3><p>æœ€å·¦åŒ¹é…åŸåˆ™ä¹Ÿå«æœ€å·¦å‰ç¼€åŸåˆ™ï¼Œæ˜¯ MySQL ä¸­çš„ä¸€ä¸ªé‡è¦åŸåˆ™ï¼Œè¯´çš„æ˜¯ç´¢å¼•ä»¥æœ€å·¦è¾¹çš„ä¸ºèµ·ç‚¹ä»»ä½•è¿ç»­çš„ç´¢å¼•éƒ½èƒ½åŒ¹é…ä¸Šï¼Œå½“é‡åˆ°èŒƒå›´æŸ¥è¯¢ï¼ˆ&gt;ã€&lt;ã€betweenã€likeï¼‰å°±ä¼šåœæ­¢åŒ¹é…ã€‚</p>\n<h3 id=\"ä»¥ä¸‹è¯­å¥ä¼šèµ°ç´¢å¼•ä¹ˆï¼Ÿ\"><a href=\"#ä»¥ä¸‹è¯­å¥ä¼šèµ°ç´¢å¼•ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"ä»¥ä¸‹è¯­å¥ä¼šèµ°ç´¢å¼•ä¹ˆï¼Ÿ\"></a>ä»¥ä¸‹è¯­å¥ä¼šèµ°ç´¢å¼•ä¹ˆï¼Ÿ</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select * from t where year(date)&gt;2018;</span><br></pre></td></tr></table></figure>\n\n<p>ä¸ä¼šï¼Œå› ä¸ºåœ¨ç´¢å¼•åˆ—ä¸Šæ¶‰åŠåˆ°äº†è¿ç®—ã€‚</p>\n<h3 id=\"èƒ½å¦ç»™æ‰‹æœºå·çš„å‰-6-ä½åˆ›å»ºç´¢å¼•ï¼Ÿå¦‚ä½•åˆ›å»ºï¼Ÿ\"><a href=\"#èƒ½å¦ç»™æ‰‹æœºå·çš„å‰-6-ä½åˆ›å»ºç´¢å¼•ï¼Ÿå¦‚ä½•åˆ›å»ºï¼Ÿ\" class=\"headerlink\" title=\"èƒ½å¦ç»™æ‰‹æœºå·çš„å‰ 6 ä½åˆ›å»ºç´¢å¼•ï¼Ÿå¦‚ä½•åˆ›å»ºï¼Ÿ\"></a>èƒ½å¦ç»™æ‰‹æœºå·çš„å‰ 6 ä½åˆ›å»ºç´¢å¼•ï¼Ÿå¦‚ä½•åˆ›å»ºï¼Ÿ</h3><p>å¯ä»¥ï¼Œåˆ›å»ºæ–¹å¼æœ‰ä¸¤ç§ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">alter table t add index index_phone(phone(6));</span><br><span class=\"line\">create index index_phone on t(phone(6));</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"ä»€ä¹ˆæ˜¯å‰ç¼€ç´¢å¼•ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯å‰ç¼€ç´¢å¼•ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯å‰ç¼€ç´¢å¼•ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯å‰ç¼€ç´¢å¼•ï¼Ÿ</h3><p>å‰ç¼€ç´¢å¼•ä¹Ÿå«å±€éƒ¨ç´¢å¼•ï¼Œæ¯”å¦‚ç»™èº«ä»½è¯çš„å‰ 10 ä½æ·»åŠ ç´¢å¼•ã€‚<br>ç±»ä¼¼è¿™ç§ç»™æŸåˆ—éƒ¨åˆ†ä¿¡æ¯æ·»åŠ ç´¢å¼•çš„æ–¹å¼å«åšå‰ç¼€ç´¢å¼•ã€‚</p>\n<h3 id=\"ä¸ºä»€ä¹ˆè¦ç”¨å‰ç¼€ç´¢å¼•ï¼Ÿ\"><a href=\"#ä¸ºä»€ä¹ˆè¦ç”¨å‰ç¼€ç´¢å¼•ï¼Ÿ\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆè¦ç”¨å‰ç¼€ç´¢å¼•ï¼Ÿ\"></a>ä¸ºä»€ä¹ˆè¦ç”¨å‰ç¼€ç´¢å¼•ï¼Ÿ</h3><p>å‰ç¼€ç´¢å¼•èƒ½æœ‰æ•ˆå‡å°ç´¢å¼•æ–‡ä»¶çš„å¤§å°ï¼Œè®©æ¯ä¸ªç´¢å¼•é¡µå¯ä»¥ä¿å­˜æ›´å¤šçš„ç´¢å¼•å€¼ï¼Œä»è€Œæé«˜äº†ç´¢å¼•æŸ¥è¯¢çš„é€Ÿåº¦ã€‚ä½†å‰ç¼€ç´¢å¼•ä¹Ÿæœ‰å®ƒçš„ç¼ºç‚¹ï¼Œä¸èƒ½åœ¨ order by æˆ–è€… group by ä¸­è§¦å‘å‰ç¼€ç´¢å¼•ï¼Œä¹Ÿä¸èƒ½æŠŠå®ƒä»¬ç”¨äºè¦†ç›–ç´¢å¼•ã€‚</p>\n<h3 id=\"ä»€ä¹ˆæƒ…å†µä¸‹é€‚åˆä½¿ç”¨å‰ç¼€ç´¢å¼•ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæƒ…å†µä¸‹é€‚åˆä½¿ç”¨å‰ç¼€ç´¢å¼•ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæƒ…å†µä¸‹é€‚åˆä½¿ç”¨å‰ç¼€ç´¢å¼•ï¼Ÿ\"></a>ä»€ä¹ˆæƒ…å†µä¸‹é€‚åˆä½¿ç”¨å‰ç¼€ç´¢å¼•ï¼Ÿ</h3><p>å½“å­—ç¬¦ä¸²æœ¬èº«å¯èƒ½æ¯”è¾ƒé•¿ï¼Œè€Œä¸”å‰å‡ ä¸ªå­—ç¬¦å°±å¼€å§‹ä¸ç›¸åŒï¼Œé€‚åˆä½¿ç”¨å‰ç¼€ç´¢å¼•ï¼›ç›¸åæƒ…å†µä¸‹ä¸é€‚åˆä½¿ç”¨å‰ç¼€ç´¢å¼•ï¼Œæ¯”å¦‚ï¼Œæ•´ä¸ªå­—æ®µçš„é•¿åº¦ä¸º 20ï¼Œç´¢å¼•é€‰æ‹©æ€§ï¼ˆä¸é‡å¤çš„ç´¢å¼•å€¼å’Œè¡¨è®°å½•æ•°çš„æ¯”å€¼ï¼Œè¶Šå¤§è¯´æ˜ç´¢å¼•ä»·å€¼è¶Šå¤§ï¼‰ä¸º 0.9ï¼Œè€Œæˆ‘ä»¬å¯¹å‰ 10 ä¸ªå­—ç¬¦å»ºç«‹å‰ç¼€ç´¢å¼•å…¶é€‰æ‹©æ€§ä¹Ÿåªæœ‰ 0.5ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦ç»§ç»­åŠ å¤§å‰ç¼€å­—ç¬¦çš„é•¿åº¦ï¼Œä½†æ˜¯è¿™ä¸ªæ—¶å€™å‰ç¼€ç´¢å¼•çš„ä¼˜åŠ¿å·²ç»ä¸æ˜æ˜¾ï¼Œå°±æ²¡æœ‰åˆ›å»ºå‰ç¼€ç´¢å¼•çš„å¿…è¦äº†ã€‚</p>\n<h3 id=\"InnoDB-ä¸ºä»€ä¹ˆè¦ä½¿ç”¨-B-æ ‘ï¼Œè€Œä¸æ˜¯-B-æ ‘ã€Hashã€çº¢é»‘æ ‘æˆ–äºŒå‰æ ‘ï¼Ÿ\"><a href=\"#InnoDB-ä¸ºä»€ä¹ˆè¦ä½¿ç”¨-B-æ ‘ï¼Œè€Œä¸æ˜¯-B-æ ‘ã€Hashã€çº¢é»‘æ ‘æˆ–äºŒå‰æ ‘ï¼Ÿ\" class=\"headerlink\" title=\"InnoDB ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ B+ æ ‘ï¼Œè€Œä¸æ˜¯ B æ ‘ã€Hashã€çº¢é»‘æ ‘æˆ–äºŒå‰æ ‘ï¼Ÿ\"></a>InnoDB ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ B+ æ ‘ï¼Œè€Œä¸æ˜¯ B æ ‘ã€Hashã€çº¢é»‘æ ‘æˆ–äºŒå‰æ ‘ï¼Ÿ</h3><p>å› ä¸º B æ ‘ã€Hashã€çº¢é»‘æ ‘æˆ–äºŒå‰æ ‘å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š</p>\n<ul>\n<li>B æ ‘ï¼šä¸ç®¡å¶å­èŠ‚ç‚¹è¿˜æ˜¯éå¶å­èŠ‚ç‚¹ï¼Œéƒ½ä¼šä¿å­˜æ•°æ®ï¼Œè¿™æ ·å¯¼è‡´åœ¨éå¶å­èŠ‚ç‚¹ä¸­èƒ½ä¿å­˜çš„æŒ‡é’ˆæ•°é‡å˜å°‘ï¼ˆæœ‰äº›èµ„æ–™ä¹Ÿç§°ä¸ºæ‰‡å‡ºï¼‰ï¼ŒæŒ‡é’ˆå°‘çš„æƒ…å†µä¸‹è¦ä¿å­˜å¤§é‡æ•°æ®ï¼Œåªèƒ½å¢åŠ æ ‘çš„é«˜åº¦ï¼Œå¯¼è‡´ IO æ“ä½œå˜å¤šï¼ŒæŸ¥è¯¢æ€§èƒ½å˜ä½ï¼›</li>\n<li>Hashï¼šè™½ç„¶å¯ä»¥å¿«é€Ÿå®šä½ï¼Œä½†æ˜¯æ²¡æœ‰é¡ºåºï¼Œæ— æ³•è¿›è¡ŒèŒƒå›´æŸ¥æ‰¾ï¼ŒIO å¤æ‚åº¦é«˜ï¼›</li>\n<li>äºŒå‰æ ‘ï¼šæ ‘çš„é«˜åº¦ä¸å‡åŒ€ï¼Œä¸èƒ½è‡ªå¹³è¡¡ï¼ŒæŸ¥æ‰¾æ•ˆç‡è·Ÿæ•°æ®æœ‰å…³ï¼ˆæ ‘çš„é«˜åº¦ï¼‰ï¼Œå¹¶ä¸” IO ä»£ä»·é«˜ï¼›</li>\n<li>çº¢é»‘æ ‘ï¼šæ ‘çš„é«˜åº¦éšç€æ•°æ®é‡å¢åŠ è€Œå¢åŠ ï¼ŒIO ä»£ä»·é«˜ã€‚</li>\n</ul>\n<h3 id=\"MySQL-å¦‚ä½•æŒ‡å®šæŸ¥è¯¢çš„ç´¢å¼•ï¼Ÿ\"><a href=\"#MySQL-å¦‚ä½•æŒ‡å®šæŸ¥è¯¢çš„ç´¢å¼•ï¼Ÿ\" class=\"headerlink\" title=\"MySQL å¦‚ä½•æŒ‡å®šæŸ¥è¯¢çš„ç´¢å¼•ï¼Ÿ\"></a>MySQL å¦‚ä½•æŒ‡å®šæŸ¥è¯¢çš„ç´¢å¼•ï¼Ÿ</h3><p>åœ¨ MySQL ä¸­å¯ä»¥ä½¿ç”¨ force index å¼ºè¡Œé€‰æ‹©ä¸€ä¸ªç´¢å¼•ï¼Œå…·ä½“æŸ¥è¯¢è¯­å¥å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">select</span> <span class=\"operator\">*</span> <span class=\"keyword\">from</span> t force index(index_t);</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"åœ¨-MySQL-ä¸­æŒ‡å®šäº†æŸ¥è¯¢ç´¢å¼•ï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰ç”Ÿæ•ˆï¼Ÿ\"><a href=\"#åœ¨-MySQL-ä¸­æŒ‡å®šäº†æŸ¥è¯¢ç´¢å¼•ï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰ç”Ÿæ•ˆï¼Ÿ\" class=\"headerlink\" title=\"åœ¨ MySQL ä¸­æŒ‡å®šäº†æŸ¥è¯¢ç´¢å¼•ï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰ç”Ÿæ•ˆï¼Ÿ\"></a>åœ¨ MySQL ä¸­æŒ‡å®šäº†æŸ¥è¯¢ç´¢å¼•ï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰ç”Ÿæ•ˆï¼Ÿ</h3><p>æˆ‘ä»¬çŸ¥é“åœ¨ MySQL ä¸­ä½¿ç”¨ force index å¯ä»¥æŒ‡å®šæŸ¥è¯¢çš„ç´¢å¼•ï¼Œä½†å¹¶ä¸æ˜¯ä¸€å®šä¼šç”Ÿæ•ˆï¼ŒåŸå› æ˜¯ MySQL ä¼šæ ¹æ®ä¼˜åŒ–å™¨è‡ªå·±é€‰æ‹©ç´¢å¼•ï¼Œå¦‚æœ force index æŒ‡å®šçš„ç´¢å¼•å‡ºç°åœ¨å€™é€‰ç´¢å¼•ä¸Šï¼Œè¿™ä¸ªæ—¶å€™ MySQL ä¸ä¼šåœ¨åˆ¤æ–­æ‰«æçš„è¡Œæ•°çš„å¤šå°‘ç›´æ¥ä½¿ç”¨æŒ‡å®šçš„ç´¢å¼•ï¼Œå¦‚æœæ²¡åœ¨å€™é€‰ç´¢å¼•ä¸­ï¼Œå³ä½¿ force index æŒ‡å®šäº†ç´¢å¼•ä¹Ÿæ˜¯ä¸ä¼šç”Ÿæ•ˆçš„ã€‚</p>\n<h3 id=\"å¦‚ä½•ä¼˜åŒ–èº«ä»½è¯çš„ç´¢å¼•ï¼Ÿ\"><a href=\"#å¦‚ä½•ä¼˜åŒ–èº«ä»½è¯çš„ç´¢å¼•ï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•ä¼˜åŒ–èº«ä»½è¯çš„ç´¢å¼•ï¼Ÿ\"></a>å¦‚ä½•ä¼˜åŒ–èº«ä»½è¯çš„ç´¢å¼•ï¼Ÿ</h3><p>åœ¨ä¸­å›½å› ä¸ºå‰ 6 ä½ä»£è¡¨çš„æ˜¯åœ°åŒºï¼Œæ‰€ä»¥å¾ˆå¤šäººçš„å‰å…­ä½éƒ½æ˜¯ç›¸åŒçš„ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨å‰ç¼€ç´¢å¼•ä¸º 6 ä½çš„è¯ï¼Œæ€§èƒ½æå‡ä¹Ÿå¹¶ä¸æ˜¯å¾ˆæ˜æ˜¾ï¼Œä½†å¦‚æœè®¾ç½®çš„ä½æ•°è¿‡é•¿ï¼Œé‚£ä¹ˆå ç”¨çš„ç£ç›˜ç©ºé—´ä¹Ÿè¶Šå¤§ï¼Œæ•°æ®é¡µèƒ½æ”¾ä¸‹çš„ç´¢å¼•å€¼å°±è¶Šå°‘ï¼Œæœç´¢æ•ˆç‡ä¹Ÿè¶Šä½ã€‚é’ˆå¯¹è¿™ç§æƒ…å†µä¼˜åŒ–æ–¹æ¡ˆæœ‰ä»¥ä¸‹ä¸¤ç§ï¼š</p>\n<ul>\n<li><strong>ä½¿ç”¨èº«ä»½è¯å€’åºå­˜å‚¨</strong>ï¼Œè¿™æ ·è®¾ç½®å‰å…­ä½çš„æ„ä¹‰å°±å¾ˆå¤§äº†ï¼›</li>\n<li><strong>ä½¿ç”¨ hash å€¼</strong>ï¼Œæ–°åˆ›å»ºä¸€ä¸ªå­—æ®µç”¨äºå­˜å‚¨èº«ä»½è¯çš„ hash å€¼ã€‚</li>\n</ul>\n<h3 id=\"ç´¢å¼•çš„ä½¿ç”¨åœºæ™¯\"><a href=\"#ç´¢å¼•çš„ä½¿ç”¨åœºæ™¯\" class=\"headerlink\" title=\"ç´¢å¼•çš„ä½¿ç”¨åœºæ™¯\"></a>ç´¢å¼•çš„ä½¿ç”¨åœºæ™¯</h3><ul>\n<li>å¯¹äºéå¸¸å°çš„è¡¨ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹å…¨è¡¨æ‰«ææ•ˆç‡æ›´é«˜ã€‚</li>\n<li>ä¸­åˆ°å¤§å‹è¡¨ï¼Œç´¢å¼•éå¸¸æœ‰æ•ˆã€‚</li>\n<li>ç‰¹å¤§å‹çš„è¡¨ï¼Œå»ºç«‹å’Œä½¿ç”¨ç´¢å¼•çš„ä»£ä»·ä¼šéšä¹‹å¢å¤§ï¼Œå¯ä»¥ä½¿ç”¨åˆ†åŒºæŠ€æœ¯æ¥è§£å†³ã€‚</li>\n</ul>\n<h3 id=\"èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•\"><a href=\"#èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•\" class=\"headerlink\" title=\"èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•\"></a>èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•</h3><p>Innobd ä¸­çš„ä¸»é”®ç´¢å¼•æ˜¯ä¸€ç§èšç°‡ç´¢å¼•ï¼Œéèšç°‡ç´¢å¼•éƒ½æ˜¯è¾…åŠ©ç´¢å¼•ï¼Œåƒå¤åˆç´¢å¼•ã€å‰ç¼€ç´¢å¼•ã€å”¯ä¸€ç´¢å¼•ã€‚</p>\n<p>Innodb ä½¿ç”¨çš„æ˜¯èšç°‡ç´¢å¼•ï¼ŒMyISam ä½¿ç”¨çš„æ˜¯éèšç°‡ç´¢å¼•</p>\n<h4 id=\"èšç°‡ç´¢å¼•-èšé›†ç´¢å¼•\"><a href=\"#èšç°‡ç´¢å¼•-èšé›†ç´¢å¼•\" class=\"headerlink\" title=\"èšç°‡ç´¢å¼•(èšé›†ç´¢å¼•)\"></a>èšç°‡ç´¢å¼•(èšé›†ç´¢å¼•)</h4><p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1464190-20191106145143172-1760681728.png\" alt=\"img\"></p>\n<p>ã€€ã€€Innodb èšç°‡ç´¢å¼•å’Œ MyIsam éèšç°‡ç´¢å¼•çš„æ¯”è¾ƒè¯´æ˜<br>ã€€ã€€å‚è€ƒåšå®¢ï¼š<a href=\"https://www.cnblogs.com/zlcxbb/p/5757245.html\">https://www.cnblogs.com/zlcxbb/p/5757245.html</a></p>\n<h4 id=\"InnoDBç´¢å¼•å®ç°\"><a href=\"#InnoDBç´¢å¼•å®ç°\" class=\"headerlink\" title=\"InnoDBç´¢å¼•å®ç°\"></a>InnoDBç´¢å¼•å®ç°</h4><p>ã€€ã€€InnoDB<strong>ä½¿ç”¨B+Treeä½œä¸ºç´¢å¼•ç»“æ„</strong>ï¼Œä½†å…·ä½“å®ç°æ–¹å¼å´ä¸ MyISAM æˆªç„¶ä¸åŒ.</p>\n<p>1ï¼‰ä¸»é”®ç´¢å¼•ï¼š</p>\n<p><strong>MyISAMç´¢å¼•æ–‡ä»¶å’Œæ•°æ®æ–‡ä»¶æ˜¯åˆ†ç¦»çš„</strong>ï¼Œ<strong>ç´¢å¼•æ–‡ä»¶ä»…ä¿å­˜æ•°æ®è®°å½•çš„åœ°å€</strong>ã€‚è€Œåœ¨<strong>InnoDBä¸­ï¼Œè¡¨æ•°æ®æ–‡ä»¶æœ¬èº«å°±æ˜¯æŒ‰B+Treeç»„ç»‡çš„ä¸€ä¸ªç´¢å¼•ç»“æ„</strong>ï¼Œè¿™æ£µæ ‘çš„å¶èŠ‚ç‚¹ data åŸŸä¿å­˜äº†å®Œæ•´çš„æ•°æ®è®°å½•ã€‚è¿™ä¸ªç´¢å¼•çš„ key æ˜¯æ•°æ®è¡¨çš„ä¸»é”®ï¼Œå› æ­¤ InnoDB è¡¨æ•°æ®æ–‡ä»¶æœ¬èº«å°±æ˜¯ä¸»ç´¢å¼•ã€‚</p>\n<p> <img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesTyporaNotes1464190-20191106145200302-932404581.png\"></p>\n<p>(å›¾ inndb ä¸»é”®ç´¢å¼•ï¼‰æ˜¯ InnoDB ä¸»ç´¢å¼•ï¼ˆåŒæ—¶ä¹Ÿæ˜¯æ•°æ®æ–‡ä»¶ï¼‰çš„ç¤ºæ„å›¾ï¼Œå¯ä»¥çœ‹åˆ°å¶èŠ‚ç‚¹åŒ…å«äº†å®Œæ•´çš„æ•°æ®è®°å½•ã€‚è¿™ç§ç´¢å¼•å«åšèšé›†ç´¢å¼•ã€‚å› ä¸º InnoDB çš„æ•°æ®æ–‡ä»¶æœ¬èº«è¦æŒ‰ä¸»é”®èšé›†ï¼Œæ‰€ä»¥ InnoDB è¦æ±‚è¡¨å¿…é¡»æœ‰ä¸»é”®ï¼ˆMyISAM å¯ä»¥æ²¡æœ‰ï¼‰ï¼Œå¦‚æœæ²¡æœ‰æ˜¾å¼æŒ‡å®šï¼Œåˆ™ MySQL ç³»ç»Ÿä¼šè‡ªåŠ¨é€‰æ‹©ä¸€ä¸ªå¯ä»¥å”¯ä¸€æ ‡è¯†æ•°æ®è®°å½•çš„åˆ—ä½œä¸ºä¸»é”®ï¼Œå¦‚æœä¸å­˜åœ¨è¿™ç§åˆ—ï¼Œåˆ™<strong>MySQLè‡ªåŠ¨ä¸ºInnoDBè¡¨ç”Ÿæˆä¸€ä¸ªéšå«å­—æ®µä½œä¸ºä¸»é”®ï¼Œè¿™ä¸ªå­—æ®µé•¿åº¦ä¸º6ä¸ªå­—èŠ‚ï¼Œç±»å‹ä¸ºé•¿æ•´å½¢</strong>ã€‚</p>\n<p>2ï¼‰InnoDB çš„è¾…åŠ©ç´¢å¼•</p>\n<p>   InnoDB çš„æ‰€æœ‰è¾…åŠ©ç´¢å¼•éƒ½å¼•ç”¨ä¸»é”®ä½œä¸º data åŸŸã€‚ä¾‹å¦‚ï¼Œä¸‹å›¾ä¸ºå®šä¹‰åœ¨ Col3 ä¸Šçš„ä¸€ä¸ªè¾…åŠ©ç´¢å¼•ï¼š</p>\n<p> <img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1464190-20191106145241480-1330791289.png\" alt=\"img\"></p>\n<p>InnoDB ä½¿ç”¨çš„æ˜¯èšç°‡ç´¢å¼•ï¼Œå°†ä¸»é”®ç»„ç»‡åˆ°ä¸€æ£µ B+æ ‘ä¸­ï¼Œè€Œè¡Œæ•°æ®å°±å‚¨å­˜åœ¨å¶å­èŠ‚ç‚¹ä¸Šï¼Œè‹¥ä½¿ç”¨â€where id &#x3D; 14â€è¿™æ ·çš„æ¡ä»¶æŸ¥æ‰¾ä¸»é”®ï¼Œåˆ™æŒ‰ç…§ B+æ ‘çš„æ£€ç´¢ç®—æ³•å³å¯æŸ¥æ‰¾åˆ°å¯¹åº”çš„å¶èŠ‚ç‚¹ï¼Œä¹‹åè·å¾—è¡Œæ•°æ®ã€‚è‹¥å¯¹ Name åˆ—è¿›è¡Œæ¡ä»¶æœç´¢ï¼Œåˆ™éœ€è¦ä¸¤ä¸ªæ­¥éª¤ï¼šç¬¬ä¸€æ­¥åœ¨è¾…åŠ©ç´¢å¼• B+æ ‘ä¸­æ£€ç´¢ Nameï¼Œåˆ°è¾¾å…¶å¶å­èŠ‚ç‚¹è·å–å¯¹åº”çš„ä¸»é”®ã€‚ç¬¬äºŒæ­¥ä½¿ç”¨ä¸»é”®åœ¨ä¸»ç´¢å¼• B+æ ‘ä¸­å†æ‰§è¡Œä¸€æ¬¡ B+æ ‘æ£€ç´¢æ“ä½œï¼Œæœ€ç»ˆåˆ°è¾¾å¶å­èŠ‚ç‚¹å³å¯è·å–æ•´è¡Œæ•°æ®ã€‚</p>\n<h4 id=\"MyISAMç´¢å¼•å®ç°\"><a href=\"#MyISAMç´¢å¼•å®ç°\" class=\"headerlink\" title=\"MyISAMç´¢å¼•å®ç°\"></a>MyISAMç´¢å¼•å®ç°</h4><p>MyISAM ç´¢å¼•æ–‡ä»¶å’Œæ•°æ®æ–‡ä»¶æ˜¯åˆ†ç¦»çš„ï¼Œç´¢å¼•æ–‡ä»¶ä»…ä¿å­˜æ•°æ®è®°å½•çš„åœ°å€</p>\n<p>1ï¼‰ä¸»é”®ç´¢å¼•ï¼š</p>\n<p>MyISAM å¼•æ“ä½¿ç”¨ B+Tree ä½œä¸ºç´¢å¼•ç»“æ„ï¼Œå¶èŠ‚ç‚¹çš„<strong>dataåŸŸå­˜æ”¾çš„æ˜¯æ•°æ®è®°å½•çš„åœ°å€</strong>ã€‚ä¸‹å›¾æ˜¯ MyISAM ä¸»é”®ç´¢å¼•çš„åŸç†å›¾ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1464190-20191106151308457-531875534.png\" alt=\"img\"></p>\n<p>è¿™é‡Œè®¾è¡¨ä¸€å…±æœ‰ä¸‰åˆ—ï¼Œå‡è®¾æˆ‘ä»¬ä»¥ Col1 ä¸ºä¸»é”®ï¼Œå›¾ myisam1 æ˜¯ä¸€ä¸ª MyISAM è¡¨çš„ä¸»ç´¢å¼•ï¼ˆPrimary keyï¼‰ç¤ºæ„ã€‚å¯ä»¥çœ‹å‡º MyISAM çš„ç´¢å¼•æ–‡ä»¶ä»…ä»…ä¿å­˜æ•°æ®è®°å½•çš„åœ°å€ã€‚</p>\n<p>2ï¼‰è¾…åŠ©ç´¢å¼•ï¼ˆSecondary keyï¼‰</p>\n<p>åœ¨ MyISAM ä¸­ï¼Œä¸»ç´¢å¼•å’Œè¾…åŠ©ç´¢å¼•ï¼ˆSecondary keyï¼‰åœ¨ç»“æ„ä¸Šæ²¡æœ‰ä»»ä½•åŒºåˆ«ï¼Œ<strong>åªæ˜¯ä¸»ç´¢å¼•è¦æ±‚keyæ˜¯å”¯ä¸€çš„ï¼Œè€Œè¾…åŠ©ç´¢å¼•çš„keyå¯ä»¥é‡å¤</strong>ã€‚å¦‚æœæˆ‘ä»¬åœ¨ Col2 ä¸Šå»ºç«‹ä¸€ä¸ªè¾…åŠ©ç´¢å¼•ï¼Œåˆ™æ­¤ç´¢å¼•çš„ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>\n<p>åŒæ ·ä¹Ÿæ˜¯ä¸€é¢— B+Treeï¼Œdata åŸŸä¿å­˜æ•°æ®è®°å½•çš„åœ°å€ã€‚å› æ­¤ï¼ŒMyISAM ä¸­ç´¢å¼•æ£€ç´¢çš„ç®—æ³•ä¸ºé¦–å…ˆæŒ‰ç…§ B+Tree æœç´¢ç®—æ³•æœç´¢ç´¢å¼•ï¼Œå¦‚æœæŒ‡å®šçš„ Key å­˜åœ¨ï¼Œåˆ™å–å‡ºå…¶ data åŸŸçš„å€¼ï¼Œç„¶åä»¥ data åŸŸçš„å€¼ä¸ºåœ°å€ï¼Œè¯»å–ç›¸åº”æ•°æ®è®°å½•ã€‚</p>\n<p> <img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1464190-20191106151427711-625351515.png\" alt=\"img\"></p>\n<p>ã€€ã€€<strong>MyISMä½¿ç”¨çš„æ˜¯éèšç°‡ç´¢å¼•</strong>ï¼Œéèšç°‡ç´¢å¼•çš„ä¸¤æ£µ B+æ ‘çœ‹ä¸Šå»æ²¡ä»€ä¹ˆä¸åŒï¼ŒèŠ‚ç‚¹çš„ç»“æ„å®Œå…¨ä¸€è‡´åªæ˜¯å­˜å‚¨çš„å†…å®¹ä¸åŒè€Œå·²ï¼Œä¸»é”®ç´¢å¼• B+æ ‘çš„èŠ‚ç‚¹å­˜å‚¨äº†ä¸»é”®ï¼Œè¾…åŠ©é”®ç´¢å¼• B+æ ‘å­˜å‚¨äº†è¾…åŠ©é”®ã€‚è¡¨æ•°æ®å­˜å‚¨åœ¨ç‹¬ç«‹çš„åœ°æ–¹ï¼Œè¿™ä¸¤é¢— B+æ ‘çš„å¶å­èŠ‚ç‚¹éƒ½ä½¿ç”¨ä¸€ä¸ªåœ°å€æŒ‡å‘çœŸæ­£çš„è¡¨æ•°æ®ï¼Œå¯¹äºè¡¨æ•°æ®æ¥è¯´ï¼Œè¿™ä¸¤ä¸ªé”®æ²¡æœ‰ä»»ä½•å·®åˆ«ã€‚ç”±äºç´¢å¼•æ ‘æ˜¯ç‹¬ç«‹çš„ï¼Œé€šè¿‡è¾…åŠ©é”®æ£€ç´¢æ— éœ€è®¿é—®ä¸»é”®çš„ç´¢å¼•æ ‘ã€‚</p>\n<p>ä¸ºäº†æ›´å½¢è±¡è¯´æ˜è¿™ä¸¤ç§ç´¢å¼•çš„åŒºåˆ«ï¼Œæˆ‘ä»¬å‡æƒ³ä¸€ä¸ªè¡¨å¦‚ä¸‹å›¾å­˜å‚¨äº† 4 è¡Œæ•°æ®ã€‚å…¶ä¸­ Id ä½œä¸ºä¸»ç´¢å¼•ï¼ŒName ä½œä¸ºè¾…åŠ©ç´¢å¼•ã€‚å›¾ç¤ºæ¸…æ™°çš„æ˜¾ç¤ºäº†èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•çš„å·®å¼‚ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1464190-20191106151527647-152458631.png\" alt=\"img\"></p>\n<p>ğŸŒŸ<strong>InnoDBèšç°‡ç´¢å¼•ï¼š</strong></p>\n<p>ä¸»é”®ç´¢å¼•æ ‘ï¼Œæ ¹ç»“ç‚¹å­˜çš„æ˜¯ä¸»é”® id å’Œå¯¹åº”çš„æ•°æ®ï¼›</p>\n<p>è¾…åŠ©ç´¢å¼•æ ‘ï¼Œæ ¹ç»“ç‚¹å­˜çš„æ˜¯è¾…åŠ©ç´¢å¼•å’Œå¯¹åº”çš„ä¸»é”®ç´¢å¼•ï¼Œå› æ­¤éœ€è¦æ ¹æ®ä¸»é”®åˆ°ä¸»é”®ç´¢å¼•æ ‘ä¸Šåœ¨éå†ä¸€æ¬¡å¾—åˆ°å¯¹åº”çš„æ•°æ®ã€‚</p>\n<p>ğŸŒŸ<strong>MyISAMéèšç°‡ç´¢å¼•ï¼š</strong></p>\n<p>ä¸»é”®ç´¢å¼•æ ‘ï¼Œæ ¹ç»“ç‚¹å­˜çš„æ˜¯ä¸»é”®åˆ°æ•°æ®åœ°å€çš„æ˜ å°„ï¼›</p>\n<p>è¾…åŠ©ç´¢å¼•æ ‘ï¼Œæ ¹ç»“ç‚¹å­˜çš„æ˜¯è¾…åŠ©ç´¢å¼•åˆ°æ•°æ®åœ°å€çš„æ˜ å°„ï¼Œä¹Ÿå¯ä»¥ç›´æ¥å¾—åˆ°æ•°æ®ï¼Œä¸éœ€è¦å›è¡¨ã€‚</p>\n<h4 id=\"é—®é¢˜ï¼šä¸»é”®ç´¢å¼•æ˜¯èšé›†ç´¢å¼•è¿˜æ˜¯éèšé›†ç´¢å¼•ï¼Ÿ\"><a href=\"#é—®é¢˜ï¼šä¸»é”®ç´¢å¼•æ˜¯èšé›†ç´¢å¼•è¿˜æ˜¯éèšé›†ç´¢å¼•ï¼Ÿ\" class=\"headerlink\" title=\"é—®é¢˜ï¼šä¸»é”®ç´¢å¼•æ˜¯èšé›†ç´¢å¼•è¿˜æ˜¯éèšé›†ç´¢å¼•ï¼Ÿ\"></a>é—®é¢˜ï¼šä¸»é”®ç´¢å¼•æ˜¯èšé›†ç´¢å¼•è¿˜æ˜¯éèšé›†ç´¢å¼•ï¼Ÿ</h4><p>åœ¨ InnoDB ä¸‹ä¸»é”®ç´¢å¼•æ˜¯èšé›†ç´¢å¼•ï¼Œåœ¨ MyISAM ä¸‹ä¸»é”®ç´¢å¼•æ˜¯éèšé›†ç´¢å¼•</p>\n<h4 id=\"MyISAMç´¢å¼•å®ç°ï¼Ÿ\"><a href=\"#MyISAMç´¢å¼•å®ç°ï¼Ÿ\" class=\"headerlink\" title=\"MyISAMç´¢å¼•å®ç°ï¼Ÿ\"></a>MyISAMç´¢å¼•å®ç°ï¼Ÿ</h4><p>MyISAM å­˜å‚¨å¼•æ“ä½¿ç”¨ B+Tree ä½œä¸ºç´¢å¼•ç»“æ„ï¼Œå¶èŠ‚ç‚¹çš„ data åŸŸå­˜æ”¾çš„æ˜¯æ•°æ®è®°å½•çš„åœ°å€ã€‚MyISAM çš„ç´¢å¼•æ–¹å¼ä¹Ÿå«åšéèšç°‡ç´¢å¼•çš„ï¼Œä¹‹æ‰€ä»¥è¿™ä¹ˆç§°å‘¼æ˜¯ä¸ºäº†ä¸ InnoDB çš„èšç°‡ç´¢å¼•åŒºåˆ†ã€‚</p>\n<h4 id=\"MyISAMç´¢å¼•ä¸InnoDBç´¢å¼•çš„åŒºåˆ«ï¼Ÿ\"><a href=\"#MyISAMç´¢å¼•ä¸InnoDBç´¢å¼•çš„åŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"MyISAMç´¢å¼•ä¸InnoDBç´¢å¼•çš„åŒºåˆ«ï¼Ÿ\"></a>MyISAMç´¢å¼•ä¸InnoDBç´¢å¼•çš„åŒºåˆ«ï¼Ÿ</h4><ul>\n<li>InnoDB ç´¢å¼•æ˜¯èšç°‡ç´¢å¼•ï¼ŒMyISAM ç´¢å¼•æ˜¯éèšç°‡ç´¢å¼•ã€‚</li>\n<li>InnoDB çš„ä¸»é”®ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å­˜å‚¨ç€ç´¢å¼•å’Œè¡Œæ•°æ®ï¼Œå› æ­¤ä¸»é”®ç´¢å¼•éå¸¸é«˜æ•ˆã€‚</li>\n<li>MyISAM ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å­˜å‚¨çš„æ˜¯è¡Œæ•°æ®åœ°å€ï¼Œéœ€è¦æ ¹æ®æ•°æ®åœ°å€è®¿é—®å¯¹åº”çš„åœ°å€æ‰èƒ½å¾—åˆ°æ•°æ®ã€‚</li>\n<li><strong>InnoDBéä¸»é”®ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å­˜å‚¨çš„æ˜¯ä¸»é”®å’Œå…¶ä»–å¸¦ç´¢å¼•çš„åˆ—æ•°æ®ï¼Œå› æ­¤æŸ¥è¯¢æ—¶åšåˆ°è¦†ç›–ç´¢å¼•ä¼šéå¸¸é«˜æ•ˆã€‚</strong></li>\n</ul>\n<h3 id=\"ç®€å•è¯´ä¸€è¯´dropã€deleteä¸truncateçš„åŒºåˆ«\"><a href=\"#ç®€å•è¯´ä¸€è¯´dropã€deleteä¸truncateçš„åŒºåˆ«\" class=\"headerlink\" title=\"ç®€å•è¯´ä¸€è¯´dropã€deleteä¸truncateçš„åŒºåˆ«\"></a>ç®€å•è¯´ä¸€è¯´dropã€deleteä¸truncateçš„åŒºåˆ«</h3><p>SQL ä¸­çš„ dropã€deleteã€truncate éƒ½è¡¨ç¤ºåˆ é™¤ï¼Œä½†æ˜¯ä¸‰è€…æœ‰ä¸€äº›å·®åˆ«</p>\n<blockquote>\n<p>1ã€deleteå’Œtruncateåªåˆ é™¤è¡¨çš„æ•°æ®ä¸åˆ é™¤è¡¨çš„ç»“æ„<br>2ã€é€Ÿåº¦,ä¸€èˆ¬æ¥è¯´: drop&gt; truncate &gt;delete<br>3ã€deleteè¯­å¥æ˜¯dml,è¿™ä¸ªæ“ä½œä¼šæ”¾åˆ°rollback segementä¸­,äº‹åŠ¡æäº¤ä¹‹åæ‰ç”Ÿæ•ˆ;<br>4ã€å¦‚æœæœ‰ç›¸åº”çš„trigger,æ‰§è¡Œçš„æ—¶å€™å°†è¢«è§¦å‘. truncate,dropæ˜¯ddl, æ“ä½œç«‹å³ç”Ÿæ•ˆ,åŸæ•°æ®ä¸æ”¾åˆ°rollback segmentä¸­,ä¸èƒ½å›æ»š. æ“ä½œä¸è§¦å‘trigger.</p>\n</blockquote>\n<h3 id=\"deleteã€truncateå’Œdropåˆ†åˆ«åœ¨ä»€ä¹ˆåœºæ™¯ä¹‹ä¸‹ä½¿ç”¨ï¼Ÿ\"><a href=\"#deleteã€truncateå’Œdropåˆ†åˆ«åœ¨ä»€ä¹ˆåœºæ™¯ä¹‹ä¸‹ä½¿ç”¨ï¼Ÿ\" class=\"headerlink\" title=\"deleteã€truncateå’Œdropåˆ†åˆ«åœ¨ä»€ä¹ˆåœºæ™¯ä¹‹ä¸‹ä½¿ç”¨ï¼Ÿ\"></a>deleteã€truncateå’Œdropåˆ†åˆ«åœ¨ä»€ä¹ˆåœºæ™¯ä¹‹ä¸‹ä½¿ç”¨ï¼Ÿ</h3><ol>\n<li>æƒ³åˆ é™¤éƒ¨åˆ†æ•°æ®è¡Œæ—¶å€™ï¼Œç”¨ deleteï¼Œå¹¶ä¸”å¸¦ä¸Š where å­å¥</li>\n<li>ä¿ç•™è¡¨è€Œåˆ é™¤æ‰€æœ‰æ•°æ®çš„æ—¶å€™ç”¨ truncate</li>\n<li>ä¸å†éœ€è¦ä¸€å¼ è¡¨çš„æ—¶å€™ï¼Œç”¨ drop</li>\n</ol>\n<h3 id=\"â­ä¸ºä»€ä¹ˆ-B-Tree-æ¯”-B-Tree-æ›´é€‚åˆå®é™…åº”ç”¨ä¸­æ“ä½œç³»ç»Ÿçš„æ–‡ä»¶ç´¢å¼•å’Œæ•°æ®åº“ç´¢å¼•ï¼Ÿ\"><a href=\"#â­ä¸ºä»€ä¹ˆ-B-Tree-æ¯”-B-Tree-æ›´é€‚åˆå®é™…åº”ç”¨ä¸­æ“ä½œç³»ç»Ÿçš„æ–‡ä»¶ç´¢å¼•å’Œæ•°æ®åº“ç´¢å¼•ï¼Ÿ\" class=\"headerlink\" title=\"â­ä¸ºä»€ä¹ˆ B+Tree æ¯” B-Tree æ›´é€‚åˆå®é™…åº”ç”¨ä¸­æ“ä½œç³»ç»Ÿçš„æ–‡ä»¶ç´¢å¼•å’Œæ•°æ®åº“ç´¢å¼•ï¼Ÿ\"></a>â­ä¸ºä»€ä¹ˆ B+Tree æ¯” B-Tree æ›´é€‚åˆå®é™…åº”ç”¨ä¸­æ“ä½œç³»ç»Ÿçš„æ–‡ä»¶ç´¢å¼•å’Œæ•°æ®åº“ç´¢å¼•ï¼Ÿ</h3><ol>\n<li>B+Tree çš„ç£ç›˜è¯»å†™ä»£ä»·æ›´ä½</li>\n</ol>\n<blockquote>\n<p>B+Tree çš„å†…éƒ¨ç»“ç‚¹å¹¶æ²¡æœ‰æŒ‡å‘å…³é”®å­—å…·ä½“ä¿¡æ¯çš„æŒ‡é’ˆã€‚å› æ­¤å…¶å†…éƒ¨ç»“ç‚¹ç›¸å¯¹ B-Tree æ›´å°ã€‚å¦‚æœæŠŠæ‰€æœ‰åŒä¸€å†…éƒ¨ç»“ç‚¹çš„å…³é”®å­—å­˜æ”¾åœ¨åŒä¸€ç›˜å—ä¸­ï¼Œé‚£ä¹ˆç›˜å—æ‰€èƒ½å®¹çº³çš„å…³é”®å­—æ•°é‡ä¹Ÿè¶Šå¤šã€‚ä¸€æ¬¡æ€§è¯»å…¥å†…å­˜ä¸­çš„éœ€è¦æŸ¥æ‰¾çš„å…³é”®å­—ä¹Ÿå°±è¶Šå¤šã€‚ç›¸å¯¹æ¥è¯´ IO è¯»å†™æ¬¡æ•°ä¹Ÿå°±é™ä½äº†ã€‚</p>\n</blockquote>\n<ol start=\"2\">\n<li>B+Tree çš„æŸ¥è¯¢æ•ˆç‡æ›´åŠ ç¨³å®š</li>\n</ol>\n<blockquote>\n<p>ç”±äºéç»ˆç»“ç‚¹å¹¶ä¸æ˜¯æœ€ç»ˆæŒ‡å‘æ–‡ä»¶å†…å®¹çš„ç»“ç‚¹ï¼Œè€Œåªæ˜¯å¶å­ç»“ç‚¹ä¸­å…³é”®å­—çš„ç´¢å¼•ã€‚æ‰€ä»¥ä»»ä½•å…³é”®å­—çš„æŸ¥æ‰¾å¿…é¡»èµ°ä¸€æ¡ä»æ ¹ç»“ç‚¹åˆ°å¶å­ç»“ç‚¹çš„è·¯ã€‚æ‰€æœ‰å…³é”®å­—æŸ¥è¯¢çš„è·¯å¾„é•¿åº¦ç›¸åŒï¼Œå¯¼è‡´æ¯ä¸€ä¸ªæ•°æ®çš„æŸ¥è¯¢æ•ˆç‡ç›¸å½“ã€‚</p>\n</blockquote>\n<h3 id=\"â­Hashç´¢å¼•å’ŒB-æ ‘æ‰€æœ‰æœ‰ä»€ä¹ˆåŒºåˆ«æˆ–è€…è¯´ä¼˜åŠ£å‘¢\"><a href=\"#â­Hashç´¢å¼•å’ŒB-æ ‘æ‰€æœ‰æœ‰ä»€ä¹ˆåŒºåˆ«æˆ–è€…è¯´ä¼˜åŠ£å‘¢\" class=\"headerlink\" title=\"â­Hashç´¢å¼•å’ŒB+æ ‘æ‰€æœ‰æœ‰ä»€ä¹ˆåŒºåˆ«æˆ–è€…è¯´ä¼˜åŠ£å‘¢?\"></a>â­Hashç´¢å¼•å’ŒB+æ ‘æ‰€æœ‰æœ‰ä»€ä¹ˆåŒºåˆ«æˆ–è€…è¯´ä¼˜åŠ£å‘¢?</h3><p>é¦–å…ˆè¦çŸ¥é“ Hash ç´¢å¼•å’Œ B+æ ‘ç´¢å¼•çš„åº•å±‚å®ç°åŸç†ï¼š</p>\n<p><strong>hashç´¢å¼•åº•å±‚å°±æ˜¯hashè¡¨,è¿›è¡ŒæŸ¥æ‰¾æ—¶,è°ƒç”¨ä¸€æ¬¡hashå‡½æ•°å°±å¯ä»¥è·å–åˆ°ç›¸åº”çš„é”®å€¼,ä¹‹åè¿›è¡Œå›è¡¨æŸ¥è¯¢è·å¾—å®é™…æ•°æ®.</strong><br>B+æ ‘åº•å±‚å®ç°æ˜¯å¤šè·¯å¹³è¡¡æŸ¥æ‰¾æ ‘.å¯¹äºæ¯ä¸€æ¬¡çš„æŸ¥è¯¢éƒ½æ˜¯ä»æ ¹èŠ‚ç‚¹å‡ºå‘,æŸ¥æ‰¾åˆ°å¶å­èŠ‚ç‚¹æ–¹å¯ä»¥è·å¾—æ‰€æŸ¥é”®å€¼,ç„¶åæ ¹æ®æŸ¥è¯¢åˆ¤æ–­æ˜¯å¦éœ€è¦å›è¡¨æŸ¥è¯¢æ•°æ®.</p>\n<p>é‚£ä¹ˆå¯ä»¥çœ‹å‡ºä»–ä»¬æœ‰ä»¥ä¸‹çš„ä¸åŒï¼š</p>\n<ul>\n<li><p>hash ç´¢å¼•è¿›è¡Œç­‰å€¼æŸ¥è¯¢æ›´å¿«(ä¸€èˆ¬æƒ…å†µä¸‹),ä½†æ˜¯å´æ— æ³•è¿›è¡ŒèŒƒå›´æŸ¥è¯¢.</p>\n</li>\n<li><p>hash ç´¢å¼•ä¸æ”¯æŒä½¿ç”¨ç´¢å¼•è¿›è¡Œæ’åº,åŸç†åŒä¸Š.</p>\n</li>\n<li><p>hash ç´¢å¼•ä¸æ”¯æŒæ¨¡ç³ŠæŸ¥è¯¢.</p>\n</li>\n<li><p>hash ç´¢å¼•ä»»ä½•æ—¶å€™éƒ½é¿å…ä¸äº†å›è¡¨æŸ¥è¯¢æ•°æ®,è€Œ B+æ ‘åœ¨ç¬¦åˆæŸäº›æ¡ä»¶(èšç°‡ç´¢å¼•,è¦†ç›–ç´¢å¼•ç­‰)çš„æ—¶å€™å¯ä»¥åªé€šè¿‡ç´¢å¼•å®ŒæˆæŸ¥è¯¢.</p>\n</li>\n<li><p>hash ç´¢å¼•è™½ç„¶åœ¨ç­‰å€¼æŸ¥è¯¢ä¸Šè¾ƒå¿«,ä½†æ˜¯ä¸ç¨³å®š.æ€§èƒ½ä¸å¯é¢„æµ‹,å½“æŸä¸ªé”®å€¼å­˜åœ¨å¤§é‡é‡å¤çš„æ—¶å€™,å‘ç”Ÿ hash ç¢°æ’,æ­¤æ—¶æ•ˆç‡å¯èƒ½æå·®.è€Œ B+æ ‘çš„æŸ¥è¯¢æ•ˆç‡æ¯”è¾ƒç¨³å®š,å¯¹äºæ‰€æœ‰çš„æŸ¥è¯¢éƒ½æ˜¯ä»æ ¹èŠ‚ç‚¹åˆ°å¶å­èŠ‚ç‚¹,ä¸”æ ‘çš„é«˜åº¦è¾ƒä½.</p>\n</li>\n</ul>\n<p>å› æ­¤,åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹,ç›´æ¥é€‰æ‹© B+æ ‘ç´¢å¼•å¯ä»¥è·å¾—ç¨³å®šä¸”è¾ƒå¥½çš„æŸ¥è¯¢é€Ÿåº¦.è€Œä¸éœ€è¦ä½¿ç”¨ hash ç´¢å¼•.</p>\n<h3 id=\"éèšç°‡ç´¢å¼•ä¸€å®šä¼šå›è¡¨æŸ¥è¯¢å—\"><a href=\"#éèšç°‡ç´¢å¼•ä¸€å®šä¼šå›è¡¨æŸ¥è¯¢å—\" class=\"headerlink\" title=\"éèšç°‡ç´¢å¼•ä¸€å®šä¼šå›è¡¨æŸ¥è¯¢å—?\"></a>éèšç°‡ç´¢å¼•ä¸€å®šä¼šå›è¡¨æŸ¥è¯¢å—?</h3><p>æœ‰å¦‚ä¸‹ä¸€å¼  InnoDB è¡¨ï¼š</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> `<span class=\"keyword\">user</span>` (</span><br><span class=\"line\">`id` <span class=\"type\">INT</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> ,</span><br><span class=\"line\">`name` <span class=\"type\">VARCHAR</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> ,</span><br><span class=\"line\">`age` <span class=\"type\">INT</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>);</span><br></pre></td></tr></table></figure>\n\n<p>å…¶ä¸­ id ä¸ºè‡ªå¢ä¸»é”®ï¼Œname æ˜¯ä¸€ä¸ªæ™®é€šç´¢å¼•ã€‚åœ¨æ‰§è¡Œ select * from user where id &#x3D; 1 æ—¶ï¼Œä¼šåœ¨ä¸»é”®ç´¢å¼•å¯¹åº”çš„ B+æ ‘çš„å¶å­ç»“ç‚¹ä¸Šæœç´¢åˆ°å…³é”®å­— id&#x3D;1 çš„èŠ‚ç‚¹ï¼Œå¹¶è¯»å–ä½äºè¯¥èŠ‚ç‚¹ä¸Šçš„æ•´è¡Œæ•°æ®ã€‚ä½†æ˜¯åœ¨æ‰§è¡Œ select * from user where name &#x3D; â€˜tomâ€™æ—¶ï¼Œä¼šåˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼š</p>\n<p>å…ˆåˆ° name ç´¢å¼•å¯¹åº”çš„ B+æ ‘çš„å¶å­ç»“ç‚¹ä¸Šæœç´¢åˆ°å…³é”®å­— name&#x3D;â€™tomâ€™çš„èŠ‚ç‚¹ï¼Œå¹¶ä»è¯¥èŠ‚ç‚¹ä¸Šè·å–å¯¹åº”çš„ä¸»é”® id å€¼ã€‚</p>\n<p>ç„¶åå†æ ¹æ® id å€¼ä½¿ç”¨ä¸»é”®ç´¢å¼•è¯»å–åˆ°æ•´è¡Œæ•°æ®ã€‚</p>\n<p>å…¶ä¸­ç¬¬äºŒä¸ªæ­¥éª¤å«ä½œå›è¡¨æŸ¥è¯¢ã€‚éœ€è¦æ‰«æè¾…åŠ©ç´¢å¼•å’Œä¸»é”®ç´¢å¼•ä¸¤æ£µ B+æ ‘æ‰èƒ½æ‹¿åˆ°æ•´è¡Œæ•°æ®ï¼Œæ•ˆç‡è¾ƒä½ã€‚</p>\n<p>å¦‚æœæ‰§è¡Œ select id, name from user where name &#x3D; â€˜tomâ€™,åˆ™åªéœ€è¦æ‰«æ name ç´¢å¼•æ ‘å°±å¯ä»¥è·å–åˆ°æ‰€æœ‰çš„å­—æ®µï¼Œå› ä¸º id å’Œ name éƒ½ä¿å­˜åœ¨ name ç´¢å¼• B+æ ‘çš„å¶å­èŠ‚ç‚¹ä¸Šï¼Œæ‰€ä»¥ä¸éœ€è¦å†å»ä¸»é”®ç´¢å¼•ä¸ŠæŸ¥æ‰¾ã€‚è¿™å°±æ˜¯æ‰€è°“çš„ç´¢å¼•è¦†ç›–ã€‚åªéœ€è¦åœ¨ä¸€æ£µç´¢å¼•æ ‘ä¸Šå°±èƒ½è·å– SQL æ‰€éœ€çš„æ‰€æœ‰åˆ—æ•°æ®ï¼Œæ— éœ€å›è¡¨ï¼Œé€Ÿåº¦æ›´å¿«ã€‚</p>\n<p>è€Œ select id, name, age from user where name &#x3D; â€˜tomâ€™ï¼Œå› ä¸º age å­—æ®µæ²¡æœ‰å­˜å‚¨åˆ° name ç´¢å¼•çš„å¶å­èŠ‚ç‚¹ä¸Šï¼Œæ‰€ä»¥éœ€è¦æ ¹æ®ä¸»é”®ç´¢å¼•å›è¡¨æŸ¥è¯¢åˆ° age åˆ—å€¼ã€‚å¦‚æœæŠŠ name ç´¢å¼•æ”¹æˆ(nameï¼Œage)çš„è”åˆç´¢å¼•å°±å¯ä»¥å®ç°ç´¢å¼•è¦†ç›–ï¼Œæ— éœ€å›è¡¨äº†ã€‚ï¼ˆè¦†ç›–ç´¢å¼•ï¼Œsql è¯­å¥ä¸­ç”¨åˆ°çš„å­—æ®µéƒ½æœ‰ç´¢å¼•ï¼‰<br>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”<br>ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸º CSDN åšä¸»ã€Œlmynoã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ª CC 4.0 BY-SA ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚<br>åŸæ–‡é“¾æ¥ï¼š<a href=\"https://blog.csdn.net/weixin_33603681/article/details/113387941\">https://blog.csdn.net/weixin_33603681/article/details/113387941</a></p>\n<h3 id=\"è”åˆç´¢å¼•æ˜¯ä»€ä¹ˆ-ä¸ºä»€ä¹ˆéœ€è¦æ³¨æ„è”åˆç´¢å¼•ä¸­çš„é¡ºåº\"><a href=\"#è”åˆç´¢å¼•æ˜¯ä»€ä¹ˆ-ä¸ºä»€ä¹ˆéœ€è¦æ³¨æ„è”åˆç´¢å¼•ä¸­çš„é¡ºåº\" class=\"headerlink\" title=\"è”åˆç´¢å¼•æ˜¯ä»€ä¹ˆ?ä¸ºä»€ä¹ˆéœ€è¦æ³¨æ„è”åˆç´¢å¼•ä¸­çš„é¡ºåº?\"></a>è”åˆç´¢å¼•æ˜¯ä»€ä¹ˆ?ä¸ºä»€ä¹ˆéœ€è¦æ³¨æ„è”åˆç´¢å¼•ä¸­çš„é¡ºåº?</h3><p>å› æ­¤åœ¨å»ºç«‹è”åˆç´¢å¼•çš„æ—¶å€™åº”è¯¥æ³¨æ„ç´¢å¼•åˆ—çš„é¡ºåº,ä¸€èˆ¬æƒ…å†µä¸‹,å°†æŸ¥è¯¢éœ€æ±‚é¢‘ç¹æˆ–è€…å­—æ®µé€‰æ‹©æ€§é«˜çš„åˆ—æ”¾åœ¨å‰é¢.æ­¤å¤–å¯ä»¥æ ¹æ®ç‰¹ä¾‹çš„æŸ¥è¯¢æˆ–è€…è¡¨ç»“æ„è¿›è¡Œå•ç‹¬çš„è°ƒæ•´.</p>\n<h3 id=\"åˆ›å»ºçš„ç´¢å¼•æœ‰æ²¡æœ‰è¢«ä½¿ç”¨åˆ°-æˆ–è€…è¯´æ€ä¹ˆæ‰å¯ä»¥çŸ¥é“è¿™æ¡è¯­å¥è¿è¡Œå¾ˆæ…¢çš„åŸå› \"><a href=\"#åˆ›å»ºçš„ç´¢å¼•æœ‰æ²¡æœ‰è¢«ä½¿ç”¨åˆ°-æˆ–è€…è¯´æ€ä¹ˆæ‰å¯ä»¥çŸ¥é“è¿™æ¡è¯­å¥è¿è¡Œå¾ˆæ…¢çš„åŸå› \" class=\"headerlink\" title=\"åˆ›å»ºçš„ç´¢å¼•æœ‰æ²¡æœ‰è¢«ä½¿ç”¨åˆ°?æˆ–è€…è¯´æ€ä¹ˆæ‰å¯ä»¥çŸ¥é“è¿™æ¡è¯­å¥è¿è¡Œå¾ˆæ…¢çš„åŸå› ?\"></a>åˆ›å»ºçš„ç´¢å¼•æœ‰æ²¡æœ‰è¢«ä½¿ç”¨åˆ°?æˆ–è€…è¯´æ€ä¹ˆæ‰å¯ä»¥çŸ¥é“è¿™æ¡è¯­å¥è¿è¡Œå¾ˆæ…¢çš„åŸå› ?</h3><p>MySQL æä¾›äº† explain å‘½ä»¤æ¥æŸ¥çœ‹è¯­å¥çš„æ‰§è¡Œè®¡åˆ’</p>\n<h2 id=\"MySQLäº‹åŠ¡ç¯‡ï¼ˆé‡ç‚¹ï¼‰\"><a href=\"#MySQLäº‹åŠ¡ç¯‡ï¼ˆé‡ç‚¹ï¼‰\" class=\"headerlink\" title=\"MySQLäº‹åŠ¡ç¯‡ï¼ˆé‡ç‚¹ï¼‰\"></a>MySQLäº‹åŠ¡ç¯‡ï¼ˆé‡ç‚¹ï¼‰</h2><h3 id=\"å¯è§æ€§åˆ¤æ–­\"><a href=\"#å¯è§æ€§åˆ¤æ–­\" class=\"headerlink\" title=\"å¯è§æ€§åˆ¤æ–­\"></a>å¯è§æ€§åˆ¤æ–­</h3><blockquote>\n<p>æ€»ç»“ï¼š</p>\n<p>å¤§äºç­‰äºä¸‹ä¸€ä¸ªåˆ†é…çš„äº‹åŠ¡IDä¸å¯è§</p>\n<p>åŒ…å«åœ¨æœªæäº¤äº‹åŠ¡é›†åˆä¸­ä½†æ˜¯å’Œåˆ›å»ºread viewçš„äº‹åŠ¡IDä¸ç›¸ç­‰åˆ™ä¹Ÿä¸å¯è§ã€‚</p>\n</blockquote>\n<p>äº‹åŠ¡ç‰ˆæœ¬å·å°äºå½“å‰æœ€å°çš„äº‹åŠ¡ IDï¼Œé‚£ä¹ˆè¯´æ˜å®ƒå·²ç»æäº¤äº†ï¼Œå¯è§ã€‚</p>\n<p>äº‹åŠ¡ç‰ˆæœ¬å·<strong>å¤§äºç­‰äºä¸‹ä¸€ä¸ªåˆ†é…çš„äº‹åŠ¡ID</strong>ï¼Œè¯´æ˜è¿™ä¸ªäº‹åŠ¡åœ¨å½“å‰ read view ç”Ÿæˆååœ¨ç”Ÿæˆï¼Œ<strong>ä¸å¯è§</strong>ã€‚</p>\n<p>äº‹åŠ¡ç‰ˆæœ¬å·åœ¨ [æœ€å°äº‹åŠ¡ IDï¼Œä¸‹ä¸€ä¸ªåˆ†é…çš„äº‹åŠ¡ ID) åŒºé—´å†…ï¼š</p>\n<p>â€‹\tå¦‚æœæœªæäº¤äº‹åŠ¡é›†åˆåŒ…å«è¯¥äº‹åŠ¡ç‰ˆæœ¬å·ï¼Œé‚£ä¹ˆåˆ¤æ–­æ˜¯å¦è¯¥äº‹åŠ¡ç‰ˆæœ¬å·æ˜¯å¦ç­‰äºåˆ›å»ºè¯¥ read view çš„äº‹åŠ¡ IDï¼Œ</p>\n<p>â€‹\t\tç­‰äºåˆ™è¯´æ˜è¿™ä¸ªç‰ˆæœ¬çš„æ•°æ®æ˜¯å½“å‰äº‹åŠ¡ç”Ÿæˆçš„ï¼Œå¯è§ã€‚<strong>ä¸ç­‰äºåˆ™ä¸å¯è§</strong>ã€‚</p>\n<p>â€‹\tå¦‚æœä¸åŒ…å«ï¼Œè¯´æ˜è¿™ä¸ªäº‹åŠ¡ç‰ˆæœ¬å·å·²ç»æäº¤ï¼Œå¯è§ã€‚</p>\n<h3 id=\"æŸ¥è¯¢ä¸€æ¡è®°å½•ï¼ŒåŸºäºMVCCï¼Œæ˜¯æ€æ ·çš„æµç¨‹\"><a href=\"#æŸ¥è¯¢ä¸€æ¡è®°å½•ï¼ŒåŸºäºMVCCï¼Œæ˜¯æ€æ ·çš„æµç¨‹\" class=\"headerlink\" title=\"æŸ¥è¯¢ä¸€æ¡è®°å½•ï¼ŒåŸºäºMVCCï¼Œæ˜¯æ€æ ·çš„æµç¨‹\"></a>æŸ¥è¯¢ä¸€æ¡è®°å½•ï¼ŒåŸºäºMVCCï¼Œæ˜¯æ€æ ·çš„æµç¨‹</h3><ol>\n<li>è·å–æ•°æ®ç‰ˆæœ¬å·å³<strong>æ•°æ®è¡Œä¸­çš„äº‹åŠ¡idéšè—å­—æ®µ</strong></li>\n<li><strong>æ‰§è¡Œsqlï¼Œå¾—åˆ°Read View</strong></li>\n<li>æ ¹æ®æ•°æ®ç‰ˆæœ¬å·å’Œ read view è¿›è¡Œ<strong>å¯è§æ€§åˆ¤æ–­</strong>ï¼Œåˆ¤æ–­å½“å‰ç‰ˆæœ¬æ•°æ®æ˜¯å¦å¯è§</li>\n<li>å¦‚æœä¸ç¬¦åˆ Read View çš„å¯è§æ€§è§„åˆ™ï¼Œ å³å°±éœ€è¦<strong>Undo log</strong>ä¸­å†å²å¿«ç…§é‡æ–°å’Œ read view å¯è§æ€§åˆ¤æ–­</li>\n<li>æœ€åè¿”å›ç¬¦åˆè§„åˆ™çš„æ•°æ®</li>\n</ol>\n<p>InnoDB å®ç° MVCCï¼Œæ˜¯é€šè¿‡<code> Read View+ Undo Log</code> å®ç°çš„ï¼ŒUndo Log ä¿å­˜äº†å†å²å¿«ç…§ï¼ŒRead View å¯è§æ€§è§„åˆ™å¸®åŠ©åˆ¤æ–­å½“å‰ç‰ˆæœ¬çš„æ•°æ®æ˜¯å¦å¯è§ã€‚</p>\n<h3 id=\"RCä¸‹å¯ä»¥è¯»åˆ°å·²æäº¤æ•°æ®ï¼Œä½†ä¸èƒ½è¯»åˆ°æœªæäº¤æ•°æ®\"><a href=\"#RCä¸‹å¯ä»¥è¯»åˆ°å·²æäº¤æ•°æ®ï¼Œä½†ä¸èƒ½è¯»åˆ°æœªæäº¤æ•°æ®\" class=\"headerlink\" title=\"RCä¸‹å¯ä»¥è¯»åˆ°å·²æäº¤æ•°æ®ï¼Œä½†ä¸èƒ½è¯»åˆ°æœªæäº¤æ•°æ®\"></a>RCä¸‹å¯ä»¥è¯»åˆ°å·²æäº¤æ•°æ®ï¼Œä½†ä¸èƒ½è¯»åˆ°æœªæäº¤æ•°æ®</h3><p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesTyporaNotes1.png\" alt=\"1\"></p>\n<h3 id=\"RRä¸‹å·²æäº¤å’Œæœªæäº¤æ•°æ®éƒ½ä¸èƒ½è¯»åˆ°\"><a href=\"#RRä¸‹å·²æäº¤å’Œæœªæäº¤æ•°æ®éƒ½ä¸èƒ½è¯»åˆ°\" class=\"headerlink\" title=\"RRä¸‹å·²æäº¤å’Œæœªæäº¤æ•°æ®éƒ½ä¸èƒ½è¯»åˆ°\"></a>RRä¸‹å·²æäº¤å’Œæœªæäº¤æ•°æ®éƒ½ä¸èƒ½è¯»åˆ°</h3><p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesTyporaNotes2.png\" alt=\"2\"></p>\n<h3 id=\"ä¸ºä»€ä¹ˆRRä¸‹è§£å†³äº†ä¸å¯é‡å¤è¯»é—®é¢˜ï¼Ÿ\"><a href=\"#ä¸ºä»€ä¹ˆRRä¸‹è§£å†³äº†ä¸å¯é‡å¤è¯»é—®é¢˜ï¼Ÿ\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆRRä¸‹è§£å†³äº†ä¸å¯é‡å¤è¯»é—®é¢˜ï¼Ÿ\"></a>ä¸ºä»€ä¹ˆRRä¸‹è§£å†³äº†ä¸å¯é‡å¤è¯»é—®é¢˜ï¼Ÿ</h3><p>å®é™…ä¸Šï¼Œå„ç§äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸‹çš„ Read view å·¥ä½œæ–¹å¼ï¼Œæ˜¯ä¸ä¸€æ ·çš„ï¼ŒRR å¯ä»¥è§£å†³ä¸å¯é‡å¤è¯»é—®é¢˜ï¼Œå°±æ˜¯è·Ÿ<strong>Read viewå·¥ä½œæ–¹å¼æœ‰å…³</strong>ã€‚</p>\n<ul>\n<li>åœ¨è¯»å·²æäº¤ï¼ˆRCï¼‰éš”ç¦»çº§åˆ«ä¸‹ï¼ŒåŒä¸€ä¸ªäº‹åŠ¡é‡Œé¢ï¼Œ<strong>æ¯ä¸€æ¬¡æŸ¥è¯¢éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„Read View</strong>ï¼Œè¿™æ ·å°±å¯èƒ½é€ æˆåŒä¸€ä¸ªäº‹åŠ¡é‡Œå‰åè¯»å–æ•°æ®å¯èƒ½ä¸ä¸€è‡´çš„é—®é¢˜ï¼ˆä¸å¯é‡å¤è¯»å¹¶å‘é—®é¢˜ï¼‰ã€‚</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>begin</th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>select * from core_user where id &#x3D;1</td>\n<td>ç”Ÿæˆä¸€ä¸ªRead View</td>\n</tr>\n<tr>\n<td>&#x2F;</td>\n<td>&#x2F;</td>\n</tr>\n<tr>\n<td>&#x2F;</td>\n<td>&#x2F;</td>\n</tr>\n<tr>\n<td>select * from core_user where id &#x3D;1</td>\n<td>ç”Ÿæˆä¸€ä¸ªRead View</td>\n</tr>\n</tbody></table>\n<ul>\n<li>åœ¨å¯é‡å¤è¯»ï¼ˆRRï¼‰éš”ç¦»çº§åˆ«ä¸‹ï¼Œ<strong>ä¸€ä¸ªäº‹åŠ¡é‡Œåªä¼šè·å–ä¸€æ¬¡read view</strong>ï¼Œéƒ½æ˜¯å‰¯æœ¬å…±ç”¨çš„ï¼Œä»è€Œä¿è¯æ¯æ¬¡æŸ¥è¯¢çš„æ•°æ®éƒ½æ˜¯ä¸€æ ·çš„ã€‚</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>begin</th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>select * from core_user where id &#x3D;1</td>\n<td>ç”Ÿæˆä¸€ä¸ªRead View</td>\n</tr>\n<tr>\n<td>&#x2F;</td>\n<td></td>\n</tr>\n<tr>\n<td>&#x2F;</td>\n<td></td>\n</tr>\n<tr>\n<td>select * from core_user where id &#x3D;1</td>\n<td>å…±ç”¨ä¸€ä¸ªRead Viewå‰¯æœ¬</td>\n</tr>\n</tbody></table>\n<h3 id=\"MVCCæ˜¯å¦è§£å†³äº†å¹»è¯»é—®é¢˜å‘¢ï¼Ÿ\"><a href=\"#MVCCæ˜¯å¦è§£å†³äº†å¹»è¯»é—®é¢˜å‘¢ï¼Ÿ\" class=\"headerlink\" title=\"MVCCæ˜¯å¦è§£å†³äº†å¹»è¯»é—®é¢˜å‘¢ï¼Ÿ\"></a>MVCCæ˜¯å¦è§£å†³äº†å¹»è¯»é—®é¢˜å‘¢ï¼Ÿ</h3><p>å¯¹äºå¹»è¯»æ¥è¯´ï¼Œå­˜åœ¨å¿«ç…§è¯»ï¼ˆå¯ä»¥è¯»åˆ°å¤šä¸ªç‰ˆæœ¬ï¼Œæ™®é€šçš„ selectï¼‰å’Œå½“å‰è¯»ï¼ˆè¯»çš„æ˜¯æœ€æ–°çš„ for updateï¼‰çš„æƒ…å†µï¼š</p>\n<ol>\n<li>RR éš”ç¦»çº§åˆ«ä¸‹ä¸ºäº†è§£å†³å¹»è¯»é—®é¢˜ï¼š<strong>å¿«ç…§è¯»ä¾é MVCCæ§åˆ¶ï¼Œå½“å‰è¯»é€šè¿‡é—´éš™é”è§£å†³</strong>ï¼›</li>\n<li>é—´éš™é”å’Œè¡Œé”åˆç§° Next-Key Locksï¼Œæ¯ä¸ª Next-Key Locks æ˜¯å‰å¼€åé—­åŒºé—´ï¼›</li>\n<li><strong>é—´éš™é”çš„å¼•å…¥ï¼Œå¯èƒ½ä¼šå¯¼è‡´åŒæ ·è¯­å¥é”ä½æ›´å¤§çš„èŒƒå›´ï¼Œå½±å“å¹¶å‘åº¦</strong>ã€‚</li>\n</ol>\n<h3 id=\"å¹¶å‘äº‹åŠ¡æœ‰ä»€ä¹ˆä»€ä¹ˆé—®é¢˜ï¼Ÿåº”è¯¥å¦‚ä½•è§£å†³ï¼Ÿ\"><a href=\"#å¹¶å‘äº‹åŠ¡æœ‰ä»€ä¹ˆä»€ä¹ˆé—®é¢˜ï¼Ÿåº”è¯¥å¦‚ä½•è§£å†³ï¼Ÿ\" class=\"headerlink\" title=\"å¹¶å‘äº‹åŠ¡æœ‰ä»€ä¹ˆä»€ä¹ˆé—®é¢˜ï¼Ÿåº”è¯¥å¦‚ä½•è§£å†³ï¼Ÿ\"></a>å¹¶å‘äº‹åŠ¡æœ‰ä»€ä¹ˆä»€ä¹ˆé—®é¢˜ï¼Ÿåº”è¯¥å¦‚ä½•è§£å†³ï¼Ÿ</h3><p>å¹¶å‘äº‹åŠ¡å¯èƒ½é€ æˆï¼šè„è¯»ã€ä¸å¯é‡å¤è¯»å’Œå¹»è¯»ç­‰é—®é¢˜ ï¼Œè¿™äº›é—®é¢˜å…¶å®éƒ½æ˜¯æ•°æ®åº“è¯»ä¸€è‡´æ€§é—®é¢˜ï¼Œå¿…é¡»ç”±æ•°æ®åº“æä¾›ä¸€å®šçš„äº‹åŠ¡éš”ç¦»æœºåˆ¶æ¥è§£å†³ï¼Œè§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š</p>\n<ul>\n<li><p>åŠ é”ï¼šåœ¨è¯»å–æ•°æ®å‰ï¼Œå¯¹å…¶åŠ é”ï¼Œé˜»æ­¢å…¶ä»–äº‹åŠ¡å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ã€‚</p>\n</li>\n<li><p>æä¾›æ•°æ®å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMultiVersion Concurrency Controlï¼Œç®€ç§° MVCC æˆ– MCCï¼‰ï¼Œä¹Ÿç§°ä¸ºå¤šç‰ˆæœ¬æ•°æ®åº“ï¼šä¸ç”¨åŠ ä»»ä½•é”ï¼Œ é€šè¿‡ä¸€å®šæœºåˆ¶ç”Ÿæˆä¸€ä¸ªæ•°æ®è¯·æ±‚æ—¶é—´ç‚¹çš„ä¸€è‡´æ€§æ•°æ®å¿«ç…§ï¼ˆSnapshot)ï¼Œ å¹¶ç”¨è¿™ä¸ªå¿«ç…§æ¥æä¾›ä¸€å®šçº§åˆ« ï¼ˆè¯­å¥çº§æˆ–äº‹åŠ¡çº§ï¼‰ çš„ä¸€è‡´æ€§è¯»å–ï¼Œä»ç”¨æˆ·çš„è§’åº¦æ¥çœ‹ï¼Œå¥½è±¡æ˜¯æ•°æ®åº“å¯ä»¥æä¾›åŒä¸€æ•°æ®çš„å¤šä¸ªç‰ˆæœ¬ã€‚</p>\n</li>\n</ul>\n<h3 id=\"MySQL-äº‹åŠ¡å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#MySQL-äº‹åŠ¡å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"MySQL äº‹åŠ¡å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>MySQL äº‹åŠ¡å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>ä»¥ InnoDB çš„äº‹åŠ¡å®ç°ä¸ºä¾‹ï¼ŒInnoDB æ˜¯é€šè¿‡å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMVCCï¼ŒMultiversion Concurrency Control ï¼‰è§£å†³ä¸å¯é‡å¤è¯»é—®é¢˜ï¼ŒåŠ ä¸Šé—´éš™é”è§£å†³å¹»è¯»é—®é¢˜ã€‚å› æ­¤ InnoDB çš„ RR éš”ç¦»çº§åˆ«å…¶å®å®ç°äº†ä¸²è¡ŒåŒ–çº§åˆ«çš„æ•ˆæœï¼Œè€Œä¸”ä¿ç•™äº†æ¯”è¾ƒå¥½çš„å¹¶å‘æ€§èƒ½ã€‚<br>äº‹åŠ¡çš„éš”ç¦»æ€§æ˜¯é€šè¿‡é”å®ç°ï¼Œè€Œäº‹åŠ¡çš„åŸå­æ€§ã€ä¸€è‡´æ€§å’ŒæŒä¹…æ€§åˆ™æ˜¯é€šè¿‡äº‹åŠ¡æ—¥å¿—å®ç°ã€‚</p>\n<h2 id=\"MVCCè¯¦ç»†ç‰ˆ\"><a href=\"#MVCCè¯¦ç»†ç‰ˆ\" class=\"headerlink\" title=\"MVCCè¯¦ç»†ç‰ˆ\"></a>MVCCè¯¦ç»†ç‰ˆ</h2><h3 id=\"1-ç›¸å…³æ•°æ®åº“çŸ¥è¯†ç‚¹å›é¡¾\"><a href=\"#1-ç›¸å…³æ•°æ®åº“çŸ¥è¯†ç‚¹å›é¡¾\" class=\"headerlink\" title=\"1. ç›¸å…³æ•°æ®åº“çŸ¥è¯†ç‚¹å›é¡¾\"></a>1. ç›¸å…³æ•°æ®åº“çŸ¥è¯†ç‚¹å›é¡¾</h3><h4 id=\"1-1-ä»€ä¹ˆæ˜¯æ•°æ®åº“äº‹åŠ¡ï¼Œä¸ºä»€ä¹ˆè¦æœ‰äº‹åŠ¡\"><a href=\"#1-1-ä»€ä¹ˆæ˜¯æ•°æ®åº“äº‹åŠ¡ï¼Œä¸ºä»€ä¹ˆè¦æœ‰äº‹åŠ¡\" class=\"headerlink\" title=\"1.1 ä»€ä¹ˆæ˜¯æ•°æ®åº“äº‹åŠ¡ï¼Œä¸ºä»€ä¹ˆè¦æœ‰äº‹åŠ¡\"></a>1.1 ä»€ä¹ˆæ˜¯æ•°æ®åº“äº‹åŠ¡ï¼Œä¸ºä»€ä¹ˆè¦æœ‰äº‹åŠ¡</h4><p>äº‹åŠ¡ï¼Œç”±ä¸€ä¸ªæœ‰é™çš„æ•°æ®åº“æ“ä½œåºåˆ—æ„æˆï¼Œè¿™äº›æ“ä½œè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œ,è¦ä¹ˆå…¨éƒ¨ä¸æ‰§è¡Œï¼Œæ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„å·¥ä½œå•ä½ã€‚</p>\n<p><strong>ä¸ºä»€ä¹ˆè¦æœ‰äº‹åŠ¡å‘¢ï¼Ÿ</strong> å°±æ˜¯ä¸ºäº†ä¿è¯æ•°æ®çš„æœ€ç»ˆä¸€è‡´æ€§ã€‚</p>\n<h4 id=\"1-2-äº‹åŠ¡åŒ…æ‹¬å“ªå‡ ä¸ªç‰¹æ€§ï¼Ÿ\"><a href=\"#1-2-äº‹åŠ¡åŒ…æ‹¬å“ªå‡ ä¸ªç‰¹æ€§ï¼Ÿ\" class=\"headerlink\" title=\"1.2 äº‹åŠ¡åŒ…æ‹¬å“ªå‡ ä¸ªç‰¹æ€§ï¼Ÿ\"></a>1.2 äº‹åŠ¡åŒ…æ‹¬å“ªå‡ ä¸ªç‰¹æ€§ï¼Ÿ</h4><p>äº‹åŠ¡å››ä¸ªå…¸å‹ç‰¹æ€§ï¼Œå³ ACIDï¼ŒåŸå­æ€§ï¼ˆAtomicityï¼‰ã€ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ã€éš”ç¦»æ€§ï¼ˆIsolationï¼‰ã€æŒä¹…æ€§ï¼ˆDurabilityï¼‰ã€‚</p>\n<ul>\n<li>åŸå­æ€§ï¼š äº‹åŠ¡ä½œä¸ºä¸€ä¸ªæ•´ä½“è¢«æ‰§è¡Œï¼ŒåŒ…å«åœ¨å…¶ä¸­çš„å¯¹æ•°æ®åº“çš„æ“ä½œ<strong>è¦ä¹ˆå…¨éƒ¨éƒ½æ‰§è¡Œï¼Œè¦ä¹ˆéƒ½ä¸æ‰§è¡Œ</strong>ã€‚</li>\n<li>ä¸€è‡´æ€§ï¼š æŒ‡åœ¨<strong>äº‹åŠ¡å¼€å§‹ä¹‹å‰å’Œäº‹åŠ¡ç»“æŸä»¥å</strong>ï¼Œæ•°æ®ä¸ä¼šè¢«ç ´åï¼Œå‡å¦‚ A è´¦æˆ·ç»™ B è´¦æˆ·è½¬ 10 å—é’±ï¼Œä¸ç®¡æˆåŠŸä¸å¦ï¼ŒA å’Œ B çš„æ€»é‡‘é¢æ˜¯ä¸å˜çš„ã€‚</li>\n<li>éš”ç¦»æ€§ï¼š å¤šä¸ªäº‹åŠ¡å¹¶å‘è®¿é—®æ—¶ï¼Œ<strong>äº‹åŠ¡ä¹‹é—´æ˜¯ç›¸äº’éš”ç¦»</strong>çš„ï¼Œä¸€ä¸ªäº‹åŠ¡ä¸åº”è¯¥è¢«å…¶ä»–äº‹åŠ¡å¹²æ‰°ï¼Œå¤šä¸ªå¹¶å‘äº‹åŠ¡ä¹‹é—´è¦ç›¸äº’éš”ç¦»ã€‚</li>\n<li>æŒä¹…æ€§ï¼š è¡¨ç¤ºäº‹åŠ¡å®Œæˆæäº¤åï¼Œè¯¥äº‹åŠ¡å¯¹æ•°æ®åº“æ‰€ä½œçš„æ“ä½œæ›´æ”¹ï¼Œå°†<strong>æŒä¹…åœ°ä¿å­˜åœ¨æ•°æ®åº“</strong>ä¹‹ä¸­ã€‚</li>\n</ul>\n<h4 id=\"1-3-äº‹åŠ¡å¹¶å‘å­˜åœ¨çš„é—®é¢˜\"><a href=\"#1-3-äº‹åŠ¡å¹¶å‘å­˜åœ¨çš„é—®é¢˜\" class=\"headerlink\" title=\"1.3 äº‹åŠ¡å¹¶å‘å­˜åœ¨çš„é—®é¢˜\"></a>1.3 äº‹åŠ¡å¹¶å‘å­˜åœ¨çš„é—®é¢˜</h4><p>äº‹åŠ¡å¹¶å‘ä¼šå¼•èµ·<strong>è„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»</strong>é—®é¢˜ã€‚</p>\n<h5 id=\"1-3-1-è„è¯»\"><a href=\"#1-3-1-è„è¯»\" class=\"headerlink\" title=\"1.3.1 è„è¯»\"></a>1.3.1 è„è¯»</h5><blockquote>\n<p>å¦‚æœä¸€ä¸ªäº‹åŠ¡è¯»å–åˆ°äº†å¦ä¸€ä¸ªæœªæäº¤äº‹åŠ¡ä¿®æ”¹è¿‡çš„æ•°æ®ï¼Œæˆ‘ä»¬å°±ç§°å‘ç”Ÿäº†è„è¯»ç°è±¡ã€‚</p>\n</blockquote>\n<h5 id=\"1-3-2-ä¸å¯é‡å¤è¯»\"><a href=\"#1-3-2-ä¸å¯é‡å¤è¯»\" class=\"headerlink\" title=\"1.3.2 ä¸å¯é‡å¤è¯»\"></a>1.3.2 ä¸å¯é‡å¤è¯»</h5><blockquote>\n<p>åŒä¸€ä¸ªäº‹åŠ¡å†…ï¼Œå‰åå¤šæ¬¡è¯»å–ï¼Œè¯»å–åˆ°çš„æ•°æ®å†…å®¹ä¸ä¸€è‡´</p>\n</blockquote>\n<h5 id=\"1-3-3-å¹»è¯»\"><a href=\"#1-3-3-å¹»è¯»\" class=\"headerlink\" title=\"1.3.3 å¹»è¯»\"></a>1.3.3 å¹»è¯»</h5><blockquote>\n<p>å¦‚æœä¸€ä¸ªäº‹åŠ¡å…ˆæ ¹æ®æŸäº›æœç´¢æ¡ä»¶æŸ¥è¯¢å‡ºä¸€äº›è®°å½•ï¼Œåœ¨è¯¥äº‹åŠ¡æœªæäº¤æ—¶ï¼Œå¦ä¸€ä¸ªäº‹åŠ¡å†™å…¥äº†ä¸€äº›ç¬¦åˆé‚£äº›æœç´¢æ¡ä»¶çš„è®°å½•ï¼ˆå¦‚insertã€deleteã€updateï¼‰ï¼Œä¸¤æ¬¡è¯»å–åˆ°çš„ç»“æœé›†å´ä¸ä¸€æ ·äº†ï¼Œå°±æ„å‘³ç€å‘ç”Ÿäº†<strong>å¹»è¯»</strong>ã€‚</p>\n</blockquote>\n<h4 id=\"1-4-å››å¤§éš”ç¦»çº§åˆ«\"><a href=\"#1-4-å››å¤§éš”ç¦»çº§åˆ«\" class=\"headerlink\" title=\"1.4 å››å¤§éš”ç¦»çº§åˆ«\"></a>1.4 å››å¤§éš”ç¦»çº§åˆ«</h4><p>ä¸ºäº†è§£å†³å¹¶å‘äº‹åŠ¡å­˜åœ¨çš„<strong>è„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»</strong>ç­‰é—®é¢˜ï¼Œæ•°æ®åº“å¤§å”è®¾è®¡äº†å››ç§éš”ç¦»çº§åˆ«ã€‚åˆ†åˆ«æ˜¯<strong>è¯»æœªæäº¤ï¼Œè¯»å·²æäº¤ï¼Œå¯é‡å¤è¯»ï¼Œä¸²è¡ŒåŒ–ï¼ˆSerializableï¼‰</strong>ã€‚</p>\n<h5 id=\"1-4-1-è¯»æœªæäº¤\"><a href=\"#1-4-1-è¯»æœªæäº¤\" class=\"headerlink\" title=\"1.4.1 è¯»æœªæäº¤\"></a>1.4.1 è¯»æœªæäº¤</h5><p>è¯»æœªæäº¤éš”ç¦»çº§åˆ«ï¼Œåªé™åˆ¶äº†ä¸¤ä¸ªæ•°æ®<strong>ä¸èƒ½åŒæ—¶ä¿®æ”¹</strong>ï¼Œä½†æ˜¯ä¿®æ”¹æ•°æ®çš„æ—¶å€™ï¼Œå³ä½¿äº‹åŠ¡<strong>æœªæäº¤</strong>ï¼Œéƒ½æ˜¯å¯ä»¥è¢«åˆ«çš„äº‹åŠ¡è¯»å–åˆ°çš„ï¼Œè¿™çº§åˆ«çš„äº‹åŠ¡éš”ç¦»æœ‰<strong>è„è¯»ã€é‡å¤è¯»ã€å¹»è¯»</strong>çš„é—®é¢˜ï¼›</p>\n<h5 id=\"1-4-2-è¯»å·²æäº¤\"><a href=\"#1-4-2-è¯»å·²æäº¤\" class=\"headerlink\" title=\"1.4.2 è¯»å·²æäº¤\"></a>1.4.2 è¯»å·²æäº¤</h5><p>è¯»å·²æäº¤éš”ç¦»çº§åˆ«ï¼Œå½“å‰äº‹åŠ¡åªèƒ½è¯»å–åˆ°å…¶ä»–äº‹åŠ¡<strong>æäº¤</strong>çš„æ•°æ®ï¼Œæ‰€ä»¥è¿™ç§äº‹åŠ¡çš„éš”ç¦»çº§åˆ«<strong>è§£å†³äº†è„è¯»</strong>é—®é¢˜ï¼Œä½†è¿˜æ˜¯ä¼šå­˜åœ¨<strong>é‡å¤è¯»ã€å¹»è¯»</strong>é—®é¢˜ï¼›</p>\n<h5 id=\"1-4-3-å¯é‡å¤è¯»\"><a href=\"#1-4-3-å¯é‡å¤è¯»\" class=\"headerlink\" title=\"1.4 3 å¯é‡å¤è¯»\"></a>1.4 3 å¯é‡å¤è¯»</h5><p>å¯é‡å¤è¯»éš”ç¦»çº§åˆ«ï¼Œé™åˆ¶äº†è¯»å–æ•°æ®çš„æ—¶å€™ï¼Œä¸å¯ä»¥è¿›è¡Œä¿®æ”¹ï¼Œæ‰€ä»¥<strong>è§£å†³äº†é‡å¤è¯»</strong>çš„é—®é¢˜ï¼Œä½†æ˜¯è¯»å–èŒƒå›´æ•°æ®çš„æ—¶å€™ï¼Œæ˜¯å¯ä»¥æ’å…¥æ•°æ®ï¼Œæ‰€ä»¥è¿˜ä¼šå­˜åœ¨<strong>å¹»è¯»</strong>é—®é¢˜ï¼›</p>\n<h5 id=\"1-4-4-ä¸²è¡ŒåŒ–\"><a href=\"#1-4-4-ä¸²è¡ŒåŒ–\" class=\"headerlink\" title=\"1.4.4 ä¸²è¡ŒåŒ–\"></a>1.4.4 ä¸²è¡ŒåŒ–</h5><p>äº‹åŠ¡æœ€é«˜çš„éš”ç¦»çº§åˆ«ï¼Œåœ¨è¯¥çº§åˆ«ä¸‹ï¼Œæ‰€æœ‰äº‹åŠ¡éƒ½æ˜¯è¿›è¡Œ<strong>ä¸²è¡ŒåŒ–é¡ºåº</strong>æ‰§è¡Œçš„ã€‚å¯ä»¥é¿å…è„è¯»ã€ä¸å¯é‡å¤è¯»ä¸å¹»è¯»æ‰€æœ‰å¹¶å‘é—®é¢˜ã€‚ä½†æ˜¯è¿™ç§äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸‹ï¼Œäº‹åŠ¡æ‰§è¡Œå¾ˆè€—æ€§èƒ½ã€‚</p>\n<h5 id=\"1-4-5-å››å¤§éš”ç¦»çº§åˆ«ï¼Œéƒ½ä¼šå­˜åœ¨å“ªäº›å¹¶å‘é—®é¢˜å‘¢\"><a href=\"#1-4-5-å››å¤§éš”ç¦»çº§åˆ«ï¼Œéƒ½ä¼šå­˜åœ¨å“ªäº›å¹¶å‘é—®é¢˜å‘¢\" class=\"headerlink\" title=\"1.4.5 å››å¤§éš”ç¦»çº§åˆ«ï¼Œéƒ½ä¼šå­˜åœ¨å“ªäº›å¹¶å‘é—®é¢˜å‘¢\"></a>1.4.5 å››å¤§éš”ç¦»çº§åˆ«ï¼Œéƒ½ä¼šå­˜åœ¨å“ªäº›å¹¶å‘é—®é¢˜å‘¢</h5><table>\n<thead>\n<tr>\n<th>éš”ç¦»çº§åˆ«</th>\n<th>è„è¯»</th>\n<th>ä¸å¯é‡å¤è¯»</th>\n<th>å¹»è¯»</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>è¯»æœªæäº¤</td>\n<td>âˆš</td>\n<td>âˆš</td>\n<td>âˆš</td>\n</tr>\n<tr>\n<td>è¯»å·²æäº¤</td>\n<td>Ã—</td>\n<td>âˆš</td>\n<td>âˆš</td>\n</tr>\n<tr>\n<td>å¯é‡å¤è¯»</td>\n<td>Ã—</td>\n<td>Ã—</td>\n<td>âˆš</td>\n</tr>\n<tr>\n<td>ä¸²è¡ŒåŒ–</td>\n<td>Ã—</td>\n<td>Ã—</td>\n<td>Ã—</td>\n</tr>\n</tbody></table>\n<h4 id=\"1-5-æ•°æ®åº“æ˜¯å¦‚ä½•ä¿è¯äº‹åŠ¡çš„éš”ç¦»æ€§çš„å‘¢ï¼Ÿ\"><a href=\"#1-5-æ•°æ®åº“æ˜¯å¦‚ä½•ä¿è¯äº‹åŠ¡çš„éš”ç¦»æ€§çš„å‘¢ï¼Ÿ\" class=\"headerlink\" title=\"1.5 æ•°æ®åº“æ˜¯å¦‚ä½•ä¿è¯äº‹åŠ¡çš„éš”ç¦»æ€§çš„å‘¢ï¼Ÿ\"></a>1.5 æ•°æ®åº“æ˜¯å¦‚ä½•ä¿è¯äº‹åŠ¡çš„éš”ç¦»æ€§çš„å‘¢ï¼Ÿ</h4><p>æ•°æ®åº“æ˜¯é€šè¿‡<strong>åŠ é”</strong>ï¼Œæ¥å®ç°äº‹åŠ¡çš„éš”ç¦»æ€§çš„ã€‚è¿™å°±å¥½åƒï¼Œå¦‚æœä½ æƒ³ä¸€ä¸ªäººé™é™ï¼Œä¸è¢«åˆ«äººæ‰“æ‰°ï¼Œä½ å°±å¯ä»¥åœ¨æˆ¿é—¨ä¸ŠåŠ ä¸Šä¸€æŠŠé”ã€‚</p>\n<p>åŠ é”ç¡®å®å¥½ä½¿ï¼Œå¯ä»¥ä¿è¯éš”ç¦»æ€§ã€‚æ¯”å¦‚<strong>ä¸²è¡ŒåŒ–éš”ç¦»çº§åˆ«å°±æ˜¯åŠ é”å®ç°çš„</strong>ã€‚ä½†æ˜¯é¢‘ç¹çš„åŠ é”ï¼Œå¯¼è‡´è¯»æ•°æ®æ—¶ï¼Œæ²¡åŠæ³•ä¿®æ”¹ï¼Œä¿®æ”¹æ•°æ®æ—¶ï¼Œæ²¡åŠæ³•è¯»å–ï¼Œå¤§å¤§<strong>é™ä½äº†æ•°æ®åº“æ€§èƒ½</strong>ã€‚</p>\n<p><strong>é‚£ä¹ˆï¼Œå¦‚ä½•è§£å†³åŠ é”åçš„æ€§èƒ½é—®é¢˜çš„ï¼Ÿ</strong></p>\n<p>ç­”æ¡ˆå°±æ˜¯,<strong>MVCCå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶</strong>ï¼å®ƒå®ç°è¯»å–æ•°æ®ä¸ç”¨åŠ é”ï¼Œå¯ä»¥è®©è¯»å–æ•°æ®åŒæ—¶ä¿®æ”¹ã€‚ä¿®æ”¹æ•°æ®æ—¶åŒæ—¶å¯è¯»å–ã€‚</p>\n<h3 id=\"2-ä»€ä¹ˆæ˜¯-MVCCï¼Ÿ\"><a href=\"#2-ä»€ä¹ˆæ˜¯-MVCCï¼Ÿ\" class=\"headerlink\" title=\"2. ä»€ä¹ˆæ˜¯ MVCCï¼Ÿ\"></a>2. ä»€ä¹ˆæ˜¯ MVCCï¼Ÿ</h3><p>MVCCï¼Œå³<strong>Multi-Version  Concurrency Control ï¼ˆå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼‰</strong>ã€‚å®ƒæ˜¯ä¸€ç§å¹¶å‘æ§åˆ¶çš„æ–¹æ³•ï¼Œä¸€èˆ¬åœ¨æ•°æ®åº“ç®¡ç†ç³»ç»Ÿä¸­ï¼Œå®ç°å¯¹æ•°æ®åº“çš„å¹¶å‘è®¿é—®ï¼Œåœ¨ç¼–ç¨‹è¯­è¨€ä¸­å®ç°äº‹åŠ¡å†…å­˜ã€‚</p>\n<blockquote>\n<p>é€šä¿—çš„è®²ï¼Œæ•°æ®åº“ä¸­åŒæ—¶å­˜åœ¨å¤šä¸ªç‰ˆæœ¬çš„æ•°æ®ï¼Œå¹¶ä¸æ˜¯æ•´ä¸ªæ•°æ®åº“çš„å¤šä¸ªç‰ˆæœ¬ï¼Œè€Œæ˜¯æŸä¸€æ¡è®°å½•çš„å¤šä¸ªç‰ˆæœ¬åŒæ—¶å­˜åœ¨ï¼Œåœ¨æŸä¸ªäº‹åŠ¡å¯¹å…¶è¿›è¡Œæ“ä½œçš„æ—¶å€™ï¼Œéœ€è¦æŸ¥çœ‹è¿™ä¸€æ¡è®°å½•çš„éšè—åˆ—äº‹åŠ¡ç‰ˆæœ¬idï¼Œæ¯”å¯¹äº‹åŠ¡idå¹¶æ ¹æ®äº‹ç‰©éš”ç¦»çº§åˆ«å»åˆ¤æ–­è¯»å–å“ªä¸ªç‰ˆæœ¬çš„æ•°æ®ã€‚</p>\n</blockquote>\n<p>æ•°æ®åº“éš”ç¦»çº§åˆ«<strong>è¯»å·²æäº¤ã€å¯é‡å¤è¯»</strong> éƒ½æ˜¯åŸºäº MVCC å®ç°çš„ï¼Œç›¸å¯¹äºåŠ é”ç®€å•ç²—æš´çš„æ–¹å¼ï¼Œå®ƒç”¨æ›´å¥½çš„æ–¹å¼å»å¤„ç†è¯»å†™å†²çªï¼Œèƒ½æœ‰æ•ˆæé«˜æ•°æ®åº“å¹¶å‘æ€§èƒ½ã€‚</p>\n<h3 id=\"3-MVCCå®ç°çš„å…³é”®çŸ¥è¯†ç‚¹\"><a href=\"#3-MVCCå®ç°çš„å…³é”®çŸ¥è¯†ç‚¹\" class=\"headerlink\" title=\"3. MVCCå®ç°çš„å…³é”®çŸ¥è¯†ç‚¹\"></a>3. MVCCå®ç°çš„å…³é”®çŸ¥è¯†ç‚¹</h3><h4 id=\"3-1-äº‹åŠ¡ç‰ˆæœ¬å·\"><a href=\"#3-1-äº‹åŠ¡ç‰ˆæœ¬å·\" class=\"headerlink\" title=\"3.1 äº‹åŠ¡ç‰ˆæœ¬å·\"></a>3.1 äº‹åŠ¡ç‰ˆæœ¬å·</h4><blockquote>\n<p>äº‹åŠ¡æ¯æ¬¡å¼€å¯å‰ï¼Œéƒ½ä¼šä»æ•°æ®åº“è·å¾—ä¸€ä¸ª<strong>è‡ªå¢é•¿</strong>çš„äº‹åŠ¡IDï¼Œå¯ä»¥ä»äº‹åŠ¡IDåˆ¤æ–­äº‹åŠ¡çš„æ‰§è¡Œå…ˆåé¡ºåºã€‚è¿™å°±æ˜¯äº‹åŠ¡ç‰ˆæœ¬å·ã€‚</p>\n</blockquote>\n<h4 id=\"3-2-éšå¼å­—æ®µ\"><a href=\"#3-2-éšå¼å­—æ®µ\" class=\"headerlink\" title=\"3.2 éšå¼å­—æ®µ\"></a>3.2 éšå¼å­—æ®µ</h4><p>å¯¹äº InnoDB å­˜å‚¨å¼•æ“ï¼Œæ¯ä¸€è¡Œè®°å½•éƒ½æœ‰ä¸¤ä¸ªéšè—åˆ—<strong>trx_id</strong>ã€<strong>roll_pointer</strong>ï¼Œå¦‚æœè¡¨ä¸­æ²¡æœ‰ä¸»é”®å’Œé NULL å”¯ä¸€é”®æ—¶ï¼Œåˆ™è¿˜ä¼šæœ‰ç¬¬ä¸‰ä¸ªéšè—çš„ä¸»é”®åˆ—<strong>row_id</strong>ã€‚</p>\n<table>\n<thead>\n<tr>\n<th>åˆ—å</th>\n<th>æ˜¯å¦å¿…é¡»</th>\n<th>æè¿°</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>row_id</td>\n<td>å¦</td>\n<td>å•è°ƒé€’å¢çš„è¡ŒIDï¼Œä¸æ˜¯å¿…éœ€çš„ï¼Œå ç”¨6ä¸ªå­—èŠ‚ã€‚</td>\n</tr>\n<tr>\n<td>trx_id</td>\n<td>æ˜¯</td>\n<td>è®°å½•æ“ä½œè¯¥æ•°æ®äº‹åŠ¡çš„<strong>äº‹åŠ¡ID</strong></td>\n</tr>\n<tr>\n<td>roll_pointer</td>\n<td>æ˜¯</td>\n<td>è¿™ä¸ªéšè—åˆ—å°±ç›¸å½“äºä¸€ä¸ª<strong>å›æ»šæŒ‡é’ˆ</strong>ï¼ŒæŒ‡å‘å›æ»šæ®µçš„undoæ—¥å¿—</td>\n</tr>\n</tbody></table>\n<h4 id=\"3-3-undo-log\"><a href=\"#3-3-undo-log\" class=\"headerlink\" title=\"3.3 undo log\"></a>3.3 undo log</h4><p>undo logï¼Œ<strong>å›æ»šæ—¥å¿—</strong>ï¼Œç”¨äº<strong>è®°å½•æ•°æ®è¢«ä¿®æ”¹å‰</strong>çš„ä¿¡æ¯ã€‚åœ¨è¡¨è®°å½•ä¿®æ”¹ä¹‹å‰ï¼Œä¼šå…ˆæŠŠæ•°æ®æ‹·è´åˆ° undo log é‡Œï¼Œå¦‚æœäº‹åŠ¡å›æ»šï¼Œå³å¯ä»¥é€šè¿‡ undo log æ¥è¿˜åŸæ•°æ®ã€‚</p>\n<p>å¯ä»¥è¿™æ ·è®¤ä¸ºï¼Œå½“ delete ä¸€æ¡è®°å½•æ—¶ï¼Œundo log ä¸­ä¼šè®°å½•ä¸€æ¡å¯¹åº”çš„ insert è®°å½•ï¼Œå½“ update ä¸€æ¡è®°å½•æ—¶ï¼Œå®ƒè®°å½•ä¸€æ¡å¯¹åº”ç›¸åçš„ update è®°å½•ã€‚</p>\n<p>undo log æœ‰ä»€ä¹ˆ<strong>ç”¨é€”</strong>å‘¢ï¼Ÿ</p>\n<ol>\n<li>äº‹åŠ¡å›æ»šæ—¶ï¼Œä¿è¯åŸå­æ€§å’Œä¸€è‡´æ€§ã€‚</li>\n<li>ç”¨äº MVCC<strong>å¿«ç…§è¯»</strong>ã€‚</li>\n</ol>\n<h4 id=\"3-4-ç‰ˆæœ¬é“¾\"><a href=\"#3-4-ç‰ˆæœ¬é“¾\" class=\"headerlink\" title=\"3.4 ç‰ˆæœ¬é“¾\"></a>3.4 ç‰ˆæœ¬é“¾</h4><p>å¤šä¸ªäº‹åŠ¡å¹¶è¡Œæ“ä½œæŸä¸€è¡Œæ•°æ®æ—¶ï¼Œä¸åŒäº‹åŠ¡å¯¹è¯¥è¡Œæ•°æ®çš„ä¿®æ”¹ä¼šäº§ç”Ÿå¤šä¸ªç‰ˆæœ¬ï¼Œç„¶åé€šè¿‡å›æ»šæŒ‡é’ˆï¼ˆroll_pointerï¼‰ï¼Œè¿æˆä¸€ä¸ªé“¾è¡¨ï¼Œè¿™ä¸ªé“¾è¡¨å°±ç§°ä¸º<strong>ç‰ˆæœ¬é“¾</strong>ã€‚å¦‚ä¸‹ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131424393.png\" alt=\"image-20220422131424393\"></p>\n<p>å…¶å®ï¼Œé€šè¿‡ç‰ˆæœ¬é“¾ï¼Œæˆ‘ä»¬å°±å¯ä»¥çœ‹å‡º<strong>äº‹åŠ¡ç‰ˆæœ¬å·ã€è¡¨æ ¼éšè—çš„åˆ—å’Œundo log</strong>å®ƒä»¬ä¹‹é—´çš„å…³ç³»ã€‚æˆ‘ä»¬å†æ¥å°åˆ†æä¸€ä¸‹ã€‚</p>\n<ol>\n<li><p>å‡è®¾ç°åœ¨æœ‰ä¸€å¼  core_user è¡¨ï¼Œè¡¨é‡Œé¢æœ‰ä¸€æ¡æ•°æ®,id ä¸º 1ï¼Œåå­—ä¸ºå­™æƒï¼š</p>\n <img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131445316.png\" alt=\"image-20220422131445316\" style=\"zoom: 50%;\" />\n</li>\n<li><p>ç°åœ¨å¼€å¯ä¸€ä¸ªäº‹åŠ¡ Aï¼š å¯¹ core_user è¡¨æ‰§è¡Œ<code>update core_user set name =&quot;æ›¹æ“&quot; where id=1</code>,ä¼šè¿›è¡Œå¦‚ä¸‹æµç¨‹æ“ä½œ</p>\n</li>\n</ol>\n<ul>\n<li><p>é¦–å…ˆè·å¾—ä¸€ä¸ªäº‹åŠ¡ ID&#x3D;100</p>\n</li>\n<li><p>æŠŠ core_user è¡¨ä¿®æ”¹å‰çš„æ•°æ®,æ‹·è´åˆ° undo log</p>\n</li>\n<li><p>ä¿®æ”¹ core_user è¡¨ä¸­ï¼Œid&#x3D;1 çš„æ•°æ®ï¼Œåå­—æ”¹ä¸ºæ›¹æ“</p>\n</li>\n<li><p>æŠŠä¿®æ”¹åçš„æ•°æ®äº‹åŠ¡ Id&#x3D;101 æ”¹æˆå½“å‰äº‹åŠ¡ç‰ˆæœ¬å·ï¼Œå¹¶æŠŠ<strong>roll_pointer</strong>æŒ‡å‘ undo log æ•°æ®åœ°å€ã€‚</p>\n  <img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131527508.png\" alt=\"image-20220422131527508\" style=\"zoom: 50%;\" /></li>\n</ul>\n<h4 id=\"3-5-å¿«ç…§è¯»å’Œå½“å‰è¯»\"><a href=\"#3-5-å¿«ç…§è¯»å’Œå½“å‰è¯»\" class=\"headerlink\" title=\"3.5 å¿«ç…§è¯»å’Œå½“å‰è¯»\"></a>3.5 å¿«ç…§è¯»å’Œå½“å‰è¯»</h4><p><strong>å¿«ç…§è¯»ï¼š</strong> è¯»å–çš„æ˜¯è®°å½•æ•°æ®çš„å¯è§ç‰ˆæœ¬ï¼ˆæœ‰æ—§çš„ç‰ˆæœ¬ï¼‰ã€‚ä¸åŠ é”,æ™®é€šçš„ select è¯­å¥éƒ½æ˜¯å¿«ç…§è¯»,å¦‚ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select * from core_user where id &gt; 2;</span><br></pre></td></tr></table></figure>\n\n<p><strong>å½“å‰è¯»</strong>ï¼šè¯»å–çš„æ˜¯è®°å½•æ•°æ®çš„æœ€æ–°ç‰ˆæœ¬ï¼Œæ˜¾å¼åŠ é”çš„éƒ½æ˜¯å½“å‰è¯»</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select * from core_user where id &gt; 2 for update;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"3-6-Read-View\"><a href=\"#3-6-Read-View\" class=\"headerlink\" title=\"3.6 Read View\"></a>3.6 Read View</h4><ul>\n<li><strong>Read Viewæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</strong> å®ƒå°±æ˜¯äº‹åŠ¡æ‰§è¡Œ SQL è¯­å¥æ—¶ï¼Œäº§ç”Ÿçš„è¯»è§†å›¾ã€‚å®é™…ä¸Šåœ¨ innodb ä¸­ï¼Œæ¯ä¸ª SQL è¯­å¥æ‰§è¡Œå‰éƒ½ä¼šå¾—åˆ°ä¸€ä¸ª Read Viewã€‚</li>\n<li><strong>Read Viewæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ</strong> å®ƒä¸»è¦æ˜¯ç”¨æ¥åšå¯è§æ€§åˆ¤æ–­çš„ï¼Œå³åˆ¤æ–­å½“å‰äº‹åŠ¡å¯è§å“ªä¸ªç‰ˆæœ¬çš„æ•°æ®</li>\n</ul>\n<p>Read View æ˜¯å¦‚ä½•ä¿è¯å¯è§æ€§åˆ¤æ–­çš„å‘¢ï¼Ÿæˆ‘ä»¬å…ˆçœ‹çœ‹ Read view çš„å‡ ä¸ªé‡è¦å±æ€§</p>\n<ul>\n<li>m_ids:å½“å‰ç³»ç»Ÿä¸­é‚£äº›æ´»è·ƒ(<strong>æœªæäº¤</strong>)çš„è¯»å†™äº‹åŠ¡ ID, å®ƒæ•°æ®ç»“æ„ä¸ºä¸€ä¸ª Listï¼Œ[min_limit_id, max_limit_id)</li>\n<li>min_limit_id:è¡¨ç¤ºåœ¨ç”Ÿæˆ ReadView æ—¶ï¼Œå½“å‰ç³»ç»Ÿä¸­æ´»è·ƒçš„è¯»å†™äº‹åŠ¡ä¸­æœ€å°çš„äº‹åŠ¡ idï¼Œå³ m_ids ä¸­çš„æœ€å°å€¼ã€‚</li>\n<li>max_limit_id:è¡¨ç¤ºç”Ÿæˆ ReadView æ—¶ï¼Œç³»ç»Ÿä¸­åº”è¯¥åˆ†é…ç»™ä¸‹ä¸€ä¸ªäº‹åŠ¡çš„ id å€¼ï¼Œå³å³ m_ids ä¸­çš„æœ€å¤§å€¼+1</li>\n<li>creator_trx_id: åˆ›å»ºå½“å‰ read view çš„äº‹åŠ¡ ID</li>\n</ul>\n<p><strong>Read view åŒ¹é…æ¡ä»¶è§„åˆ™</strong>å¦‚ä¸‹ï¼š</p>\n<ol>\n<li>å¦‚æœæ–°çš„æ•°æ®äº‹åŠ¡ ID <code>trx_id &lt; min_limit_id</code>ï¼Œè¡¨æ˜ç”Ÿæˆè¯¥ç‰ˆæœ¬çš„äº‹åŠ¡åœ¨ç”Ÿæˆ Read View å‰ï¼Œå·²ç»æäº¤(å› ä¸ºäº‹åŠ¡ ID æ˜¯é€’å¢çš„)ï¼Œæ‰€ä»¥è¯¥ç‰ˆæœ¬å¯ä»¥è¢«å½“å‰äº‹åŠ¡è®¿é—®ã€‚</li>\n<li>å¦‚æœ<code>trx_id&gt;= max_limit_id</code>ï¼Œè¡¨æ˜ç”Ÿæˆè¯¥ç‰ˆæœ¬çš„äº‹åŠ¡åœ¨ç”Ÿæˆ ReadView åæ‰ç”Ÿæˆï¼Œæ‰€ä»¥è¯¥ç‰ˆæœ¬ä¸å¯ä»¥è¢«å½“å‰äº‹åŠ¡è®¿é—®ã€‚</li>\n<li>å¦‚æœ <code>min_limit_id =&lt;trx_id&lt; max_limit_id</code>,éœ€è¦åˆ† 3 ç§æƒ…å†µè®¨è®º</li>\n</ol>\n<blockquote>\n<p>ï¼ˆ1ï¼‰å¦‚æœ<code>m_ids</code>åŒ…å«<code>trx_id</code>,åˆ™ä»£è¡¨Read Viewç”Ÿæˆæ—¶åˆ»ï¼Œè¿™ä¸ªäº‹åŠ¡è¿˜æœªæäº¤ï¼Œä½†æ˜¯å¦‚æœæ•°æ®çš„<code>trx_id</code>ç­‰äº<code>creator_trx_id</code>çš„è¯ï¼Œè¡¨æ˜æ•°æ®æ˜¯è‡ªå·±ç”Ÿæˆçš„ï¼Œå› æ­¤æ˜¯<strong>å¯è§</strong>çš„ã€‚</p>\n<p>ï¼ˆ2ï¼‰å¦‚æœ<code>m_ids</code>åŒ…å«<code>trx_id</code>ï¼Œå¹¶ä¸”<code>trx_id</code>ä¸ç­‰äº<code>creator_trx_id</code>ï¼Œåˆ™Read  Viewç”Ÿæˆæ—¶ï¼Œäº‹åŠ¡æœªæäº¤ï¼Œå¹¶ä¸”ä¸æ˜¯è‡ªå·±ç”Ÿäº§çš„ï¼Œæ‰€ä»¥å½“å‰äº‹åŠ¡ä¹Ÿæ˜¯<strong>çœ‹ä¸è§</strong>çš„ï¼›</p>\n<p>ï¼ˆ3ï¼‰å¦‚æœ<code>m_ids</code>ä¸åŒ…å«<code>trx_id</code>ï¼Œåˆ™è¯´æ˜ä½ è¿™ä¸ªäº‹åŠ¡åœ¨Read Viewç”Ÿæˆä¹‹å‰å°±<strong>å·²ç»æäº¤</strong>äº†ï¼Œä¿®æ”¹çš„ç»“æœï¼Œå½“å‰äº‹åŠ¡æ˜¯èƒ½çœ‹è§çš„ã€‚</p>\n</blockquote>\n<h3 id=\"4-MVCCå®ç°åŸç†åˆ†æ\"><a href=\"#4-MVCCå®ç°åŸç†åˆ†æ\" class=\"headerlink\" title=\"4. MVCCå®ç°åŸç†åˆ†æ\"></a>4. MVCCå®ç°åŸç†åˆ†æ</h3><img src=\"/Users/yaxing/blog/source/_posts/E:/Markdown%E6%96%87%E6%A1%A3%E5%9B%BE%E7%89%87/8%20MySQL.assets/v2-a086ef515e7d0a023ca3cfcc5759c7f6_720w.jpg\" alt=\"img\" style=\"zoom: 80%;\" />\n\n<h4 id=\"4-1-æŸ¥è¯¢ä¸€æ¡è®°å½•ï¼ŒåŸºäºMVCCï¼Œæ˜¯æ€æ ·çš„æµç¨‹\"><a href=\"#4-1-æŸ¥è¯¢ä¸€æ¡è®°å½•ï¼ŒåŸºäºMVCCï¼Œæ˜¯æ€æ ·çš„æµç¨‹\" class=\"headerlink\" title=\"4.1 æŸ¥è¯¢ä¸€æ¡è®°å½•ï¼ŒåŸºäºMVCCï¼Œæ˜¯æ€æ ·çš„æµç¨‹\"></a>4.1 æŸ¥è¯¢ä¸€æ¡è®°å½•ï¼ŒåŸºäºMVCCï¼Œæ˜¯æ€æ ·çš„æµç¨‹</h4><ol>\n<li>è·å–äº‹åŠ¡ ID</li>\n<li>æ‰§è¡Œ sqlï¼Œå¾—åˆ° Read View</li>\n<li>æŸ¥è¯¢å¾—åˆ°çš„æ•°æ®ï¼Œç„¶åä¸ Read View ä¸­çš„äº‹åŠ¡ ID è¿›è¡Œæ¯”è¾ƒï¼Œå¸®åŠ©åˆ¤æ–­å½“å‰ç‰ˆæœ¬çš„æ•°æ®æ˜¯å¦å¯è§ã€‚</li>\n<li>å¦‚æœä¸ç¬¦åˆ Read View çš„å¯è§æ€§è§„åˆ™ï¼Œ å³å°±éœ€è¦ Undo log ä¸­å†å²å¿«ç…§;</li>\n<li>æœ€åè¿”å›ç¬¦åˆè§„åˆ™çš„æ•°æ®</li>\n</ol>\n<p>InnoDB å®ç° MVCCï¼Œæ˜¯é€šè¿‡<code> Read View+ Undo Log</code> å®ç°çš„ï¼ŒUndo Log ä¿å­˜äº†å†å²å¿«ç…§ï¼ŒRead View å¯è§æ€§è§„åˆ™å¸®åŠ©åˆ¤æ–­å½“å‰ç‰ˆæœ¬çš„æ•°æ®æ˜¯å¦å¯è§ã€‚</p>\n<h4 id=\"4-2-è¯»å·²æäº¤ï¼ˆRCï¼‰éš”ç¦»çº§åˆ«ï¼Œå­˜åœ¨ä¸å¯é‡å¤è¯»é—®é¢˜çš„åˆ†æå†ç¨‹\"><a href=\"#4-2-è¯»å·²æäº¤ï¼ˆRCï¼‰éš”ç¦»çº§åˆ«ï¼Œå­˜åœ¨ä¸å¯é‡å¤è¯»é—®é¢˜çš„åˆ†æå†ç¨‹\" class=\"headerlink\" title=\"4.2 è¯»å·²æäº¤ï¼ˆRCï¼‰éš”ç¦»çº§åˆ«ï¼Œå­˜åœ¨ä¸å¯é‡å¤è¯»é—®é¢˜çš„åˆ†æå†ç¨‹\"></a>4.2 è¯»å·²æäº¤ï¼ˆRCï¼‰éš”ç¦»çº§åˆ«ï¼Œå­˜åœ¨ä¸å¯é‡å¤è¯»é—®é¢˜çš„åˆ†æå†ç¨‹</h4><ol>\n<li><p>åˆ›å»º core_user è¡¨ï¼Œæ’å…¥ä¸€æ¡åˆå§‹åŒ–æ•°æ®,å¦‚ä¸‹ï¼š</p>\n <img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131554547.png\" alt=\"image-20220422131554547\" style=\"zoom: 33%;\" />\n</li>\n<li><p>éš”ç¦»çº§åˆ«è®¾ç½®ä¸ºè¯»å·²æäº¤ï¼ˆRCï¼‰ï¼Œäº‹åŠ¡ A å’Œäº‹åŠ¡ B åŒæ—¶å¯¹ core_user è¡¨è¿›è¡ŒæŸ¥è¯¢å’Œä¿®æ”¹æ“ä½œã€‚</p>\n</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">äº‹åŠ¡A: select * fom core_user where id=1</span><br><span class=\"line\">äº‹åŠ¡B: update core_user set name =â€æ›¹æ“â€</span><br><span class=\"line\">// äº‹åŠ¡Aä¸¤æ¬¡è¯»åˆ°çš„æ•°æ®ä¸ä¸€æ ·ï¼Œäº‹åŠ¡Aä¼šè¯»åˆ°å…¶ä»–äº‹åŠ¡æäº¤çš„æ•°æ®ï¼Œä¸èƒ½è¯»åˆ°å…¶ä»–äº‹åŠ¡æœªæäº¤çš„æ•°æ®ã€‚</span><br></pre></td></tr></table></figure>\n\n<p>æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š</p>\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131620047.png\" alt=\"image-20220422131620047\" style=\"zoom: 33%;\" />\n\n<p>æœ€åäº‹åŠ¡ A æŸ¥è¯¢åˆ°çš„ç»“æœæ˜¯ï¼Œ<strong>name&#x3D;æ›¹æ“</strong>çš„è®°å½•ï¼Œæˆ‘ä»¬<strong>åŸºäºMVCC</strong>ï¼Œæ¥åˆ†æä¸€ä¸‹æ‰§è¡Œæµç¨‹ï¼š</p>\n<p>(1) A å¼€å¯äº‹åŠ¡ï¼Œé¦–å…ˆå¾—åˆ°ä¸€ä¸ªäº‹åŠ¡ ID ä¸º 100</p>\n<p>(2) B å¼€å¯äº‹åŠ¡ï¼Œå¾—åˆ°äº‹åŠ¡ ID ä¸º 101</p>\n<p>(3) äº‹åŠ¡ A ç”Ÿæˆä¸€ä¸ª Read Viewï¼Œread view å¯¹åº”çš„å€¼å¦‚ä¸‹</p>\n<table>\n<thead>\n<tr>\n<th>å˜é‡</th>\n<th>å€¼</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>m_idsï¼ˆæœªæäº¤çš„äº‹åŠ¡IDï¼‰</td>\n<td>100ï¼Œ101</td>\n</tr>\n<tr>\n<td>max_limit_idï¼ˆä¸‹ä¸€ä¸ªåº”è¯¥åˆ†é…çš„äº‹åŠ¡IDï¼‰</td>\n<td>102</td>\n</tr>\n<tr>\n<td>min_limit_idï¼ˆå½“å‰read viewä¸­æ´»è·ƒçš„æœªæäº¤äº‹åŠ¡çš„æœ€å°å€¼ï¼‰</td>\n<td>100</td>\n</tr>\n<tr>\n<td>creator_trx_idï¼ˆåˆ›å»ºè¯¥read viewçš„äº‹åŠ¡IDï¼‰</td>\n<td>100</td>\n</tr>\n</tbody></table>\n<p>ç„¶åå›åˆ°ç‰ˆæœ¬é“¾ï¼šå¼€å§‹ä»ç‰ˆæœ¬é“¾ä¸­æŒ‘é€‰å¯è§çš„è®°å½•ï¼š</p>\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131642264.png\" alt=\"image-20220422131642264\" style=\"zoom: 33%;\" />\n\n<p>ç”±å›¾å¯ä»¥çœ‹å‡ºï¼Œæœ€æ–°ç‰ˆæœ¬çš„åˆ— name çš„å†…å®¹æ˜¯<code>å­™æƒ</code>ï¼Œè¯¥ç‰ˆæœ¬çš„<code>trx_id</code>å€¼ä¸º 100ã€‚å¼€å§‹æ‰§è¡Œ read view å¯è§æ€§è§„åˆ™æ ¡éªŒï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">min_limit_id(100)=&lt;trx_idï¼ˆ100ï¼‰&lt;102;</span><br><span class=\"line\">creator_trx_id = trx_id =100;</span><br></pre></td></tr></table></figure>\n\n<p>ç”±æ­¤å¯å¾—ï¼Œtrx_id&#x3D;100 çš„è¿™ä¸ªè®°å½•ï¼Œå½“å‰äº‹åŠ¡æ˜¯å¯è§çš„ã€‚æ‰€ä»¥æŸ¥åˆ°æ˜¯ name ä¸º<code>å­™æƒ</code>çš„è®°å½•ã€‚</p>\n<p>(4) äº‹åŠ¡ B è¿›è¡Œä¿®æ”¹æ“ä½œï¼ŒæŠŠåå­—æ”¹ä¸ºæ›¹æ“ã€‚æŠŠåŸæ•°æ®æ‹·è´åˆ° undo log,ç„¶åå¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œæ ‡è®°äº‹åŠ¡ ID å’Œä¸Šä¸€ä¸ªæ•°æ®ç‰ˆæœ¬åœ¨ undo log çš„åœ°å€ã€‚</p>\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131733370.png\" alt=\"image-20220422131733370\" style=\"zoom:33%;\" />\n\n<p>(5) æäº¤äº‹åŠ¡</p>\n<p>(6) äº‹åŠ¡ A å†æ¬¡æ‰§è¡ŒæŸ¥è¯¢æ“ä½œï¼Œ<strong>æ–°ç”Ÿæˆä¸€ä¸ªRead View</strong>ï¼ŒRead View å¯¹åº”çš„å€¼å¦‚ä¸‹</p>\n<table>\n<thead>\n<tr>\n<th>å˜é‡</th>\n<th>å€¼</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>m_idsï¼ˆæœªæäº¤çš„äº‹åŠ¡IDï¼‰</td>\n<td>100</td>\n</tr>\n<tr>\n<td>max_limit_idï¼ˆä¸‹ä¸€ä¸ªåº”å½“åˆ†é…çš„äº‹åŠ¡IDï¼‰</td>\n<td>102</td>\n</tr>\n<tr>\n<td>min_limit_idï¼ˆæœ€å°çš„äº‹åŠ¡IDï¼‰</td>\n<td>100</td>\n</tr>\n<tr>\n<td>creator_trx_idï¼ˆåˆ›å»ºread viewçš„äº‹åŠ¡IDï¼‰</td>\n<td>100</td>\n</tr>\n</tbody></table>\n<p>ç„¶åå†æ¬¡å›åˆ°ç‰ˆæœ¬é“¾ï¼šä»ç‰ˆæœ¬é“¾ä¸­æŒ‘é€‰å¯è§çš„è®°å½•ï¼š</p>\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131753554.png\" alt=\"image-20220422131753554\" style=\"zoom:33%;\" />\n\n<p>ä»å›¾å¯å¾—ï¼Œæœ€æ–°ç‰ˆæœ¬çš„åˆ— name çš„å†…å®¹æ˜¯<code>æ›¹æ“</code>ï¼Œè¯¥ç‰ˆæœ¬çš„<code>trx_id</code>å€¼ä¸º 101ã€‚å¼€å§‹æ‰§è¡Œ Read View å¯è§æ€§è§„åˆ™æ ¡éªŒï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">min_limit_id(100)=&lt;trx_idï¼ˆ101ï¼‰&lt;max_limit_idï¼ˆ102);</span><br><span class=\"line\">ä½†æ˜¯,trx_id=101ï¼Œä¸å±äºm_idsé›†åˆï¼Œè¯´æ˜101è¿™ä¸ªäº‹åŠ¡å·²ç»æäº¤äº†ï¼Œå½“å‰äº‹åŠ¡å¯è§</span><br></pre></td></tr></table></figure>\n\n<p>å› æ­¤ï¼Œ<code>trx_id=101</code>è¿™ä¸ªè®°å½•ï¼Œå¯¹äºå½“å‰äº‹åŠ¡æ˜¯å¯è§çš„ã€‚æ‰€ä»¥ SQL æŸ¥è¯¢åˆ°çš„æ˜¯ name ä¸º<code>æ›¹æ“</code>çš„è®°å½•ã€‚</p>\n<p>ç»¼ä¸Šæ‰€è¿°ï¼Œåœ¨<strong>è¯»å·²æäº¤ï¼ˆRCï¼‰éš”ç¦»çº§åˆ«</strong>ä¸‹ï¼ŒåŒä¸€ä¸ªäº‹åŠ¡é‡Œï¼Œä¸¤ä¸ªç›¸åŒçš„æŸ¥è¯¢ï¼Œè¯»å–åŒä¸€æ¡è®°å½•ï¼ˆid&#x3D;1ï¼‰ï¼Œå´è¿”å›äº†ä¸åŒçš„æ•°æ®ï¼ˆ<strong>ç¬¬ä¸€æ¬¡æŸ¥å‡ºæ¥æ˜¯å­™æƒï¼Œç¬¬äºŒæ¬¡æŸ¥å‡ºæ¥æ˜¯æ›¹æ“é‚£æ¡è®°å½•</strong>ï¼‰ï¼Œå› æ­¤ RC éš”ç¦»çº§åˆ«ï¼Œå­˜åœ¨<strong>ä¸å¯é‡å¤è¯»</strong>å¹¶å‘é—®é¢˜ã€‚</p>\n<h4 id=\"4-3-å¯é‡å¤è¯»ï¼ˆRRï¼‰éš”ç¦»çº§åˆ«ï¼Œè§£å†³ä¸å¯é‡å¤è¯»é—®é¢˜çš„åˆ†æ\"><a href=\"#4-3-å¯é‡å¤è¯»ï¼ˆRRï¼‰éš”ç¦»çº§åˆ«ï¼Œè§£å†³ä¸å¯é‡å¤è¯»é—®é¢˜çš„åˆ†æ\" class=\"headerlink\" title=\"4.3 å¯é‡å¤è¯»ï¼ˆRRï¼‰éš”ç¦»çº§åˆ«ï¼Œè§£å†³ä¸å¯é‡å¤è¯»é—®é¢˜çš„åˆ†æ\"></a>4.3 å¯é‡å¤è¯»ï¼ˆRRï¼‰éš”ç¦»çº§åˆ«ï¼Œè§£å†³ä¸å¯é‡å¤è¯»é—®é¢˜çš„åˆ†æ</h4><p>åœ¨ RR éš”ç¦»çº§åˆ«ä¸‹ï¼Œæ˜¯å¦‚ä½•è§£å†³ä¸å¯é‡å¤è¯»é—®é¢˜çš„å‘¢ï¼Ÿæˆ‘ä»¬ä¸€èµ·å†æ¥çœ‹ä¸‹ï¼Œ</p>\n<p>è¿˜æ˜¯ 4.2 å°èŠ‚é‚£ä¸ªæµç¨‹ï¼Œè¿˜æ˜¯è¿™ä¸ªäº‹åŠ¡ A å’Œäº‹åŠ¡ Bï¼Œå¦‚ä¸‹ï¼š</p>\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131811671.png\" alt=\"image-20220422131811671\" style=\"zoom:33%;\" />\n\n<h5 id=\"4-3-1-ä¸åŒéš”ç¦»çº§åˆ«ä¸‹ï¼ŒRead-viewçš„å·¥ä½œæ–¹å¼ä¸åŒ\"><a href=\"#4-3-1-ä¸åŒéš”ç¦»çº§åˆ«ä¸‹ï¼ŒRead-viewçš„å·¥ä½œæ–¹å¼ä¸åŒ\" class=\"headerlink\" title=\"4.3.1 ä¸åŒéš”ç¦»çº§åˆ«ä¸‹ï¼ŒRead viewçš„å·¥ä½œæ–¹å¼ä¸åŒ\"></a>4.3.1 ä¸åŒéš”ç¦»çº§åˆ«ä¸‹ï¼ŒRead viewçš„å·¥ä½œæ–¹å¼ä¸åŒ</h5><p>å®é™…ä¸Šï¼Œå„ç§äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸‹çš„ Read view å·¥ä½œæ–¹å¼ï¼Œæ˜¯ä¸ä¸€æ ·çš„ï¼ŒRR å¯ä»¥è§£å†³ä¸å¯é‡å¤è¯»é—®é¢˜ï¼Œå°±æ˜¯è·Ÿ<strong>Read viewå·¥ä½œæ–¹å¼æœ‰å…³</strong>ã€‚</p>\n<ul>\n<li>åœ¨è¯»å·²æäº¤ï¼ˆRCï¼‰éš”ç¦»çº§åˆ«ä¸‹ï¼ŒåŒä¸€ä¸ªäº‹åŠ¡é‡Œé¢ï¼Œ<strong>æ¯ä¸€æ¬¡æŸ¥è¯¢éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„Read Viewå‰¯æœ¬</strong>ï¼Œè¿™æ ·å°±å¯èƒ½é€ æˆåŒä¸€ä¸ªäº‹åŠ¡é‡Œå‰åè¯»å–æ•°æ®å¯èƒ½ä¸ä¸€è‡´çš„é—®é¢˜ï¼ˆä¸å¯é‡å¤è¯»å¹¶å‘é—®é¢˜ï¼‰ã€‚</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>begin</th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>select * from core_user where id &#x3D;1</td>\n<td>ç”Ÿæˆä¸€ä¸ªRead View</td>\n</tr>\n<tr>\n<td>&#x2F;</td>\n<td>&#x2F;</td>\n</tr>\n<tr>\n<td>&#x2F;</td>\n<td>&#x2F;</td>\n</tr>\n<tr>\n<td>select * from core_user where id &#x3D;1</td>\n<td>ç”Ÿæˆä¸€ä¸ªRead View</td>\n</tr>\n</tbody></table>\n<ul>\n<li>åœ¨å¯é‡å¤è¯»ï¼ˆRRï¼‰éš”ç¦»çº§åˆ«ä¸‹ï¼Œ<strong>ä¸€ä¸ªäº‹åŠ¡é‡Œåªä¼šè·å–ä¸€æ¬¡read view</strong>ï¼Œéƒ½æ˜¯å‰¯æœ¬å…±ç”¨çš„ï¼Œä»è€Œä¿è¯æ¯æ¬¡æŸ¥è¯¢çš„æ•°æ®éƒ½æ˜¯ä¸€æ ·çš„ã€‚</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>begin</th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>select * from core_user where id &#x3D;1</td>\n<td>ç”Ÿæˆä¸€ä¸ªRead View</td>\n</tr>\n<tr>\n<td>&#x2F;</td>\n<td></td>\n</tr>\n<tr>\n<td>&#x2F;</td>\n<td></td>\n</tr>\n<tr>\n<td>select * from core_user where id &#x3D;1</td>\n<td>å…±ç”¨ä¸€ä¸ªRead Viewå‰¯æœ¬</td>\n</tr>\n</tbody></table>\n<h5 id=\"4-3-2-å®ä¾‹åˆ†æ\"><a href=\"#4-3-2-å®ä¾‹åˆ†æ\" class=\"headerlink\" title=\"4.3.2 å®ä¾‹åˆ†æ\"></a>4.3.2 å®ä¾‹åˆ†æ</h5><p>æˆ‘ä»¬ç©¿è¶Šä¸‹ï¼Œå›åˆ°<strong>åˆš4.2çš„ä¾‹å­</strong>ï¼Œç„¶åæ‰§è¡Œç¬¬ 2 ä¸ªæŸ¥è¯¢çš„æ—¶å€™ï¼š</p>\n<p>äº‹åŠ¡ A å†æ¬¡æ‰§è¡ŒæŸ¥è¯¢æ“ä½œï¼Œå¤ç”¨è€çš„ Read View å‰¯æœ¬ï¼ŒRead View å¯¹åº”çš„å€¼å¦‚ä¸‹</p>\n<table>\n<thead>\n<tr>\n<th>å˜é‡</th>\n<th>å€¼</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>m_ids</td>\n<td>100ï¼Œ101</td>\n</tr>\n<tr>\n<td>max_limit_id</td>\n<td>102</td>\n</tr>\n<tr>\n<td>min_limit_id</td>\n<td>100</td>\n</tr>\n<tr>\n<td>creator_trx_id</td>\n<td>100</td>\n</tr>\n</tbody></table>\n<p>ç„¶åå†æ¬¡å›åˆ°ç‰ˆæœ¬é“¾ï¼šä»ç‰ˆæœ¬é“¾ä¸­æŒ‘é€‰å¯è§çš„è®°å½•ï¼š</p>\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131828812.png\" alt=\"image-20220422131828812\" style=\"zoom:33%;\" />\n\n<p>ä»å›¾å¯å¾—ï¼Œæœ€æ–°ç‰ˆæœ¬çš„åˆ— name çš„å†…å®¹æ˜¯<code>æ›¹æ“</code>ï¼Œè¯¥ç‰ˆæœ¬çš„<code>trx_id</code>å€¼ä¸º 101ã€‚å¼€å§‹æ‰§è¡Œ read view å¯è§æ€§è§„åˆ™æ ¡éªŒï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">min_limit_id(100)=&lt;trx_idï¼ˆ101ï¼‰&lt;max_limit_idï¼ˆ102);</span><br><span class=\"line\">å› ä¸ºm_ids&#123;100,101&#125;åŒ…å«trx_idï¼ˆ101ï¼‰ï¼Œ</span><br><span class=\"line\">å¹¶ä¸”creator_trx_id (100) ä¸ç­‰äºtrx_idï¼ˆ101ï¼‰</span><br></pre></td></tr></table></figure>\n\n<p>æ‰€ä»¥ï¼Œ<code>trx_id=101</code>è¿™ä¸ªè®°å½•ï¼Œå¯¹äºå½“å‰äº‹åŠ¡æ˜¯<strong>ä¸å¯è§</strong>çš„ã€‚è¿™æ—¶å€™å‘¢ï¼Œç‰ˆæœ¬é“¾<code>roll_pointer</code>è·³åˆ°ä¸‹ä¸€ä¸ªç‰ˆæœ¬ï¼Œ<code>trx_id=100</code>è¿™ä¸ªè®°å½•ï¼Œå†æ¬¡æ ¡éªŒæ˜¯å¦å¯è§ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">min_limit_id(100)=&lt;trx_idï¼ˆ100ï¼‰&lt; max_limit_idï¼ˆ102);</span><br><span class=\"line\">å› ä¸ºm_ids&#123;100,101&#125;åŒ…å«trx_idï¼ˆ100ï¼‰ï¼Œ</span><br><span class=\"line\">å¹¶ä¸”creator_trx_id (100) ç­‰äºtrx_idï¼ˆ100ï¼‰</span><br></pre></td></tr></table></figure>\n\n<p>æ‰€ä»¥ï¼Œ<code>trx_id=100</code>è¿™ä¸ªè®°å½•ï¼Œå¯¹äºå½“å‰äº‹åŠ¡æ˜¯<strong>å¯è§</strong>çš„ã€‚å³åœ¨å¯é‡å¤è¯»ï¼ˆRRï¼‰éš”ç¦»çº§åˆ«ä¸‹ï¼Œå¤ç”¨è€çš„ Read View å‰¯æœ¬ï¼Œè§£å†³äº†<strong>ä¸å¯é‡å¤è¯»</strong>çš„é—®é¢˜ã€‚</p>\n<h4 id=\"4-4-MVCCæ˜¯å¦è§£å†³äº†å¹»è¯»é—®é¢˜å‘¢ï¼Ÿ\"><a href=\"#4-4-MVCCæ˜¯å¦è§£å†³äº†å¹»è¯»é—®é¢˜å‘¢ï¼Ÿ\" class=\"headerlink\" title=\"4.4 MVCCæ˜¯å¦è§£å†³äº†å¹»è¯»é—®é¢˜å‘¢ï¼Ÿ\"></a>4.4 MVCCæ˜¯å¦è§£å†³äº†å¹»è¯»é—®é¢˜å‘¢ï¼Ÿ</h4><p>å¯¹äºå¹»è¯»æ¥è¯´ï¼Œå­˜åœ¨å½“å‰è¯»å’Œå¿«ç…§è¯»çš„æƒ…å†µï¼š</p>\n<ol>\n<li>RR éš”ç¦»çº§åˆ«ä¸‹ä¸ºäº†è§£å†³å¹»è¯»é—®é¢˜ï¼š<strong>å¿«ç…§è¯»ä¾é MVCCæ§åˆ¶ï¼Œå½“å‰è¯»é€šè¿‡é—´éš™é”è§£å†³</strong>ï¼›</li>\n<li>é—´éš™é”å’Œè¡Œé”åˆç§° Next-Key Locksï¼Œæ¯ä¸ª Next-Key Locks æ˜¯å‰å¼€åé—­åŒºé—´ï¼›</li>\n<li>é—´éš™é”çš„å¼•å…¥ï¼Œå¯èƒ½ä¼šå¯¼è‡´åŒæ ·è¯­å¥é”ä½æ›´å¤§çš„èŒƒå›´ï¼Œå½±å“å¹¶å‘åº¦ã€‚</li>\n</ol>\n<p>ä½œè€…ï¼šæ¡ç”°èºçš„å°ç”·å­©</p>\n<p>é“¾æ¥ï¼š<a href=\"https://juejin.cn/post/7016165148020703246\">https://juejin.cn/post/7016165148020703246</a></p>\n<p>æ¥æºï¼šç¨€åœŸæ˜é‡‘</p>\n<p>è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>\n<h2 id=\"MySQLé”ç¯‡\"><a href=\"#MySQLé”ç¯‡\" class=\"headerlink\" title=\"MySQLé”ç¯‡\"></a>MySQLé”ç¯‡</h2><h3 id=\"ä»€ä¹ˆæ˜¯é”ï¼ŸMySQL-ä¸­æä¾›äº†å‡ ç±»é”ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯é”ï¼ŸMySQL-ä¸­æä¾›äº†å‡ ç±»é”ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯é”ï¼ŸMySQL ä¸­æä¾›äº†å‡ ç±»é”ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯é”ï¼ŸMySQL ä¸­æä¾›äº†å‡ ç±»é”ï¼Ÿ</h3><p>é”æ˜¯å®ç°æ•°æ®åº“å¹¶å‘æ§åˆ¶çš„é‡è¦æ‰‹æ®µï¼Œå¯ä»¥ä¿è¯æ•°æ®åº“åœ¨å¤šäººåŒæ—¶æ“ä½œæ—¶èƒ½å¤Ÿæ­£å¸¸è¿è¡Œã€‚</p>\n<p>æ’ä»–é”ï¼ˆå†™é”ï¼‰ï¼Œå…±äº«é”ï¼ˆè¯»é”ï¼‰<br>ä¹è§‚é”ï¼Œæ‚²è§‚é”<br>å…¨å±€é”ï¼Œè¡¨é”ï¼Œè¡Œé”ï¼Œé¡µé”</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯æ­»é”ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯æ­»é”ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯æ­»é”ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯æ­»é”ï¼Ÿ</h3><p>æ­»é”æ˜¯æŒ‡ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„è¿›ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå› äº‰å¤ºèµ„æºè€Œé€ æˆçš„ä¸€ç§äº’ç›¸ç­‰å¾…çš„ç°è±¡,è‹¥æ— å¤–åŠ›ä½œç”¨,å®ƒä»¬éƒ½å°†æ— æ³•æ¨è¿›ä¸‹å»ã€‚æ­¤æ—¶ç§°ç³»ç»Ÿå¤„äºæ­»é”çŠ¶æ€æˆ–ç³»ç»Ÿäº§ç”Ÿäº†æ­»é”ï¼Œè¿™äº›æ°¸è¿œåœ¨äº’ç›¸ç­‰å¾…çš„è¿‡ç¨‹ç§°ä¸ºæ­»é”ã€‚</p>\n<h3 id=\"å¦‚ä½•å¤„ç†æ­»é”ï¼Ÿ\"><a href=\"#å¦‚ä½•å¤„ç†æ­»é”ï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•å¤„ç†æ­»é”ï¼Ÿ\"></a>å¦‚ä½•å¤„ç†æ­»é”ï¼Ÿ</h3><p>å¯¹å¾…æ­»é”å¸¸è§çš„ä¸¤ç§ç­–ç•¥ï¼š</p>\n<ul>\n<li><p>è®¾ç½®è¶…æ—¶æ—¶é—´</p>\n</li>\n<li><p>å‘ç°æ­»é”ä¹‹åï¼Œä¸»åŠ¨å›æ»šæ­»é”ä¸­çš„æŸä¸€ä¸ªäº‹åŠ¡ï¼Œè®©å…¶å®ƒäº‹åŠ¡ç»§ç»­æ‰§è¡Œã€‚</p>\n</li>\n</ul>\n<h3 id=\"å¦‚ä½•é¿å…æ­»é”ï¼Ÿ\"><a href=\"#å¦‚ä½•é¿å…æ­»é”ï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•é¿å…æ­»é”ï¼Ÿ\"></a>å¦‚ä½•é¿å…æ­»é”ï¼Ÿ</h3><p>ä½¿ç”¨ SELECT â€¦ FOR UPDATE è¯­å¥æ¥è·å–å¿…è¦çš„é”ã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯å…¨å±€é”ï¼Ÿå®ƒçš„åº”ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯å…¨å±€é”ï¼Ÿå®ƒçš„åº”ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯å…¨å±€é”ï¼Ÿå®ƒçš„åº”ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯å…¨å±€é”ï¼Ÿå®ƒçš„åº”ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ</h3><p>å…¨å±€é”å°±æ˜¯å¯¹æ•´ä¸ªæ•°æ®åº“å®ä¾‹åŠ é”ï¼Œå®ƒçš„å…¸å‹ä½¿ç”¨åœºæ™¯å°±æ˜¯åšå…¨åº“é€»è¾‘å¤‡ä»½ã€‚ è¿™ä¸ªå‘½ä»¤å¯ä»¥ä½¿æ•´ä¸ªåº“å¤„äºåªè¯»çŠ¶æ€ã€‚ä½¿ç”¨è¯¥å‘½ä»¤ä¹‹åï¼Œæ•°æ®æ›´æ–°è¯­å¥ã€æ•°æ®å®šä¹‰è¯­å¥ã€æ›´æ–°ç±»äº‹åŠ¡çš„æäº¤è¯­å¥ç­‰æ“ä½œéƒ½ä¼šè¢«é˜»å¡ã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯å…±äº«é”ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯å…±äº«é”ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯å…±äº«é”ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯å…±äº«é”ï¼Ÿ</h3><p>å…±äº«é”åˆç§°è¯»é” (read lock)ï¼Œæ˜¯è¯»å–æ“ä½œåˆ›å»ºçš„é”ã€‚å…¶ä»–ç”¨æˆ·å¯ä»¥å¹¶å‘è¯»å–æ•°æ®ï¼Œä½†ä»»ä½•äº‹åŠ¡éƒ½ä¸èƒ½å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ï¼ˆè·å–æ•°æ®ä¸Šçš„æ’ä»–é”ï¼‰ï¼Œç›´åˆ°å·²é‡Šæ”¾æ‰€æœ‰å…±äº«é”ã€‚å½“å¦‚æœäº‹åŠ¡å¯¹è¯»é”è¿›è¡Œä¿®æ”¹æ“ä½œï¼Œå¾ˆå¯èƒ½ä¼šé€ æˆæ­»é”ã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯æ’å®ƒé”ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯æ’å®ƒé”ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯æ’å®ƒé”ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯æ’å®ƒé”ï¼Ÿ</h3><p>æ’ä»–é” exclusive lockï¼ˆä¹Ÿå« writer lockï¼‰åˆç§°å†™é”ã€‚</p>\n<p>è‹¥æŸä¸ªäº‹ç‰©å¯¹æŸä¸€è¡ŒåŠ ä¸Šäº†æ’ä»–é”ï¼Œåªèƒ½è¿™ä¸ªäº‹åŠ¡å¯¹å…¶è¿›è¡Œè¯»å†™ï¼Œåœ¨æ­¤äº‹åŠ¡ç»“æŸä¹‹å‰ï¼Œå…¶ä»–äº‹åŠ¡ä¸èƒ½å¯¹å…¶è¿›è¡ŒåŠ ä»»ä½•é”ï¼Œå…¶ä»–è¿›ç¨‹å¯ä»¥è¯»å–,ä¸èƒ½è¿›è¡Œå†™æ“ä½œï¼Œéœ€ç­‰å¾…å…¶é‡Šæ”¾ã€‚</p>\n<p>æ’å®ƒé”æ˜¯æ‚²è§‚é”çš„ä¸€ç§å®ç°ï¼Œåœ¨ä¸Šé¢æ‚²è§‚é”ä¹Ÿä»‹ç»è¿‡ã€‚</p>\n<h3 id=\"ä½¿ç”¨å…¨å±€é”ä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜ï¼Ÿ\"><a href=\"#ä½¿ç”¨å…¨å±€é”ä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜ï¼Ÿ\" class=\"headerlink\" title=\"ä½¿ç”¨å…¨å±€é”ä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜ï¼Ÿ\"></a>ä½¿ç”¨å…¨å±€é”ä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜ï¼Ÿ</h3><p>å¦‚æœåœ¨ä¸»åº“å¤‡ä»½ï¼Œåœ¨å¤‡ä»½æœŸé—´ä¸èƒ½æ›´æ–°ï¼Œä¸šåŠ¡åœæ‘†ï¼Œæ‰€ä»¥æ›´æ–°ä¸šåŠ¡ä¼šå¤„äºç­‰å¾…çŠ¶æ€ã€‚</p>\n<p>å¦‚æœåœ¨ä»åº“å¤‡ä»½ï¼Œåœ¨å¤‡ä»½æœŸé—´ä¸èƒ½æ‰§è¡Œä¸»åº“åŒæ­¥çš„ binlogï¼Œå¯¼è‡´ä¸»ä»å»¶è¿Ÿã€‚</p>\n<p>å¦‚æœä½¿ç”¨å…¨å±€é”è¿›è¡Œé€»è¾‘å¤‡ä»½å°±ä¼šè®©æ•´ä¸ªåº“æˆä¸ºåªè¯»çŠ¶æ€ï¼Œå¹¸å¥½å®˜æ–¹æ¨å‡ºäº†ä¸€ä¸ªé€»è¾‘å¤‡ä»½å·¥å…· MySQL dump æ¥è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œåªéœ€è¦åœ¨ä½¿ç”¨ MySQLdump æ—¶ï¼Œä½¿ç”¨å‚æ•° single-transaction å°±ä¼šåœ¨å¯¼å…¥æ•°æ®ä¹‹å‰å¯åŠ¨ä¸€ä¸ªäº‹åŠ¡æ¥ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ï¼Œå¹¶ä¸”è¿™ä¸ªè¿‡ç¨‹æ˜¯æ”¯æŒæ•°æ®æ›´æ–°æ“ä½œçš„ã€‚</p>\n<h3 id=\"æ‚²è§‚é”å’Œä¹è§‚é”æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"><a href=\"#æ‚²è§‚é”å’Œä¹è§‚é”æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"æ‚²è§‚é”å’Œä¹è§‚é”æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"></a>æ‚²è§‚é”å’Œä¹è§‚é”æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p>é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¾ˆæ‚²è§‚ï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¼šä¿®æ”¹ï¼Œæ‰€ä»¥æ¯æ¬¡åœ¨æ‹¿æ•°æ®çš„æ—¶å€™éƒ½ä¼šä¸Šé”ï¼Œè¿™æ ·åˆ«äººæƒ³æ‹¿è¿™ä¸ªæ•°æ®å°±ä¼š block ç›´åˆ°å®ƒæ‹¿åˆ°é”ã€‚æ­£å› ä¸ºå¦‚æ­¤ï¼Œæ‚²è§‚é”éœ€è¦è€—è´¹è¾ƒå¤šçš„æ—¶é—´ï¼Œå¦å¤–ä¸ä¹è§‚é”ç›¸å¯¹åº”çš„ï¼Œæ‚²è§‚é”æ˜¯ç”±æ•°æ®åº“è‡ªå·±å®ç°äº†çš„ï¼Œè¦ç”¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç›´æ¥è°ƒç”¨æ•°æ®åº“çš„ç›¸å…³è¯­å¥å°±å¯ä»¥äº†ã€‚</p>\n<p>è¯´åˆ°è¿™é‡Œï¼Œç”±æ‚²è§‚é”æ¶‰åŠåˆ°çš„å¦å¤–ä¸¤ä¸ªé”æ¦‚å¿µå°±å‡ºæ¥äº†ï¼Œå®ƒä»¬å°±æ˜¯å…±äº«é”ä¸æ’å®ƒé”ã€‚å…±äº«é”å’Œæ’å®ƒé”æ˜¯æ‚²è§‚é”çš„ä¸åŒçš„å®ç°ï¼Œå®ƒä¿©éƒ½å±äºæ‚²è§‚é”çš„èŒƒç•´ã€‚</p>\n<p><strong>ä¹è§‚é”æ˜¯ç”¨æ•°æ®ç‰ˆæœ¬ï¼ˆVersionï¼‰è®°å½•æœºåˆ¶å®ç°</strong>ï¼Œè¿™æ˜¯ä¹è§‚é”æœ€å¸¸ç”¨çš„ä¸€ç§å®ç°æ–¹å¼ã€‚ä½•è°“æ•°æ®ç‰ˆæœ¬ï¼Ÿå³ä¸ºæ•°æ®å¢åŠ ä¸€ä¸ªç‰ˆæœ¬æ ‡è¯†ï¼Œä¸€èˆ¬æ˜¯é€šè¿‡ä¸ºæ•°æ®åº“è¡¨å¢åŠ ä¸€ä¸ªæ•°å­—ç±»å‹çš„ version å­—æ®µæ¥å®ç°ã€‚å½“è¯»å–æ•°æ®æ—¶ï¼Œå°† version å­—æ®µçš„å€¼ä¸€åŒè¯»å‡ºï¼Œæ•°æ®æ¯æ›´æ–°ä¸€æ¬¡ï¼Œå¯¹æ­¤ version å€¼åŠ  1ã€‚å½“æˆ‘ä»¬æäº¤æ›´æ–°çš„æ—¶å€™ï¼Œåˆ¤æ–­æ•°æ®åº“è¡¨å¯¹åº”è®°å½•çš„å½“å‰ç‰ˆæœ¬ä¿¡æ¯ä¸ç¬¬ä¸€æ¬¡å–å‡ºæ¥çš„ version å€¼è¿›è¡Œæ¯”å¯¹ï¼Œå¦‚æœæ•°æ®åº“è¡¨å½“å‰ç‰ˆæœ¬å·ä¸ç¬¬ä¸€æ¬¡å–å‡ºæ¥çš„ version å€¼ç›¸ç­‰ï¼Œåˆ™äºˆä»¥æ›´æ–°ï¼Œå¦åˆ™è®¤ä¸ºæ˜¯è¿‡æœŸæ•°æ®ã€‚</p>\n<h3 id=\"ä¹è§‚é”æœ‰ä»€ä¹ˆä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Ÿ\"><a href=\"#ä¹è§‚é”æœ‰ä»€ä¹ˆä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Ÿ\" class=\"headerlink\" title=\"ä¹è§‚é”æœ‰ä»€ä¹ˆä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Ÿ\"></a>ä¹è§‚é”æœ‰ä»€ä¹ˆä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Ÿ</h3><p>å› ä¸ºæ²¡æœ‰åŠ é”æ‰€ä»¥ä¹è§‚é”çš„ä¼˜ç‚¹å°±æ˜¯æ‰§è¡Œæ€§èƒ½é«˜ã€‚å®ƒçš„ç¼ºç‚¹å°±æ˜¯æœ‰å¯èƒ½äº§ç”Ÿ ABA çš„é—®é¢˜ï¼ŒABA é—®é¢˜æŒ‡çš„æ˜¯æœ‰ä¸€ä¸ªå˜é‡ V åˆæ¬¡è¯»å–çš„æ—¶å€™æ˜¯ A å€¼ï¼Œå¹¶ä¸”åœ¨å‡†å¤‡èµ‹å€¼çš„æ—¶å€™æ£€æŸ¥åˆ°å®ƒä»ç„¶æ˜¯ A å€¼ï¼Œä¼šè¯¯ä»¥ä¸ºæ²¡æœ‰è¢«ä¿®æ”¹ä¼šæ­£å¸¸çš„æ‰§è¡Œä¿®æ”¹æ“ä½œï¼Œå®é™…ä¸Šè¿™æ®µæ—¶é—´å®ƒçš„å€¼å¯èƒ½è¢«æ”¹äº†å…¶ä»–å€¼ï¼Œä¹‹ååˆæ”¹å›ä¸º A å€¼ï¼Œè¿™ä¸ªé—®é¢˜è¢«ç§°ä¸º ABA é—®é¢˜ã€‚</p>\n<h3 id=\"â­InnoDB-å­˜å‚¨å¼•æ“æœ‰å‡ ç§é”ç®—æ³•ï¼Ÿ\"><a href=\"#â­InnoDB-å­˜å‚¨å¼•æ“æœ‰å‡ ç§é”ç®—æ³•ï¼Ÿ\" class=\"headerlink\" title=\"â­InnoDB å­˜å‚¨å¼•æ“æœ‰å‡ ç§é”ç®—æ³•ï¼Ÿ\"></a>â­InnoDB å­˜å‚¨å¼•æ“æœ‰å‡ ç§é”ç®—æ³•ï¼Ÿ</h3><ul>\n<li><p>Record Lock â€” å•ä¸ªè¡Œè®°å½•ä¸Šçš„é”ï¼›</p>\n</li>\n<li><p>Gap Lock â€” é—´éš™é”ï¼Œé”å®šä¸€ä¸ªèŒƒå›´ï¼Œä¸åŒ…æ‹¬è®°å½•æœ¬èº«ï¼›</p>\n</li>\n<li><p>Next-Key Lockï¼ˆåŒ…å«è¡Œé”å’Œé—´éš™é”ï¼‰ â€” é”å®šä¸€ä¸ªèŒƒå›´ï¼ŒåŒ…æ‹¬è®°å½•æœ¬èº«ã€‚</p>\n</li>\n</ul>\n<h3 id=\"InnoDB-å¦‚ä½•å®ç°è¡Œé”ï¼Ÿ\"><a href=\"#InnoDB-å¦‚ä½•å®ç°è¡Œé”ï¼Ÿ\" class=\"headerlink\" title=\"InnoDB å¦‚ä½•å®ç°è¡Œé”ï¼Ÿ\"></a>InnoDB å¦‚ä½•å®ç°è¡Œé”ï¼Ÿ</h3><p>å…±äº«é”ï¼š<strong>in share mode</strong></p>\n<p>æ’ä»–é”ï¼š<strong>for update</strong></p>\n<h3 id=\"ä¼˜åŒ–é”æ–¹é¢ä½ æœ‰ä»€ä¹ˆå»ºè®®ï¼Ÿ\"><a href=\"#ä¼˜åŒ–é”æ–¹é¢ä½ æœ‰ä»€ä¹ˆå»ºè®®ï¼Ÿ\" class=\"headerlink\" title=\"ä¼˜åŒ–é”æ–¹é¢ä½ æœ‰ä»€ä¹ˆå»ºè®®ï¼Ÿ\"></a>ä¼˜åŒ–é”æ–¹é¢ä½ æœ‰ä»€ä¹ˆå»ºè®®ï¼Ÿ</h3><ul>\n<li>å°½é‡ä½¿ç”¨è¾ƒä½çš„éš”ç¦»çº§åˆ«ã€‚</li>\n<li>ç²¾å¿ƒè®¾è®¡ç´¢å¼•ï¼Œ å¹¶å°½é‡ä½¿ç”¨ç´¢å¼•è®¿é—®æ•°æ®ï¼Œ ä½¿åŠ é”æ›´ç²¾ç¡®ï¼Œ ä»è€Œå‡å°‘é”å†²çªçš„æœºä¼šã€‚</li>\n<li>é€‰æ‹©åˆç†çš„äº‹åŠ¡å¤§å°ï¼Œå°äº‹åŠ¡å‘ç”Ÿé”å†²çªçš„å‡ ç‡ä¹Ÿæ›´å°ã€‚</li>\n<li>ç»™è®°å½•é›†æ˜¾ç¤ºåŠ é”æ—¶ï¼Œæœ€å¥½ä¸€æ¬¡æ€§è¯·æ±‚è¶³å¤Ÿçº§åˆ«çš„é”ã€‚æ¯”å¦‚è¦ä¿®æ”¹æ•°æ®çš„è¯ï¼Œæœ€å¥½ç›´æ¥ç”³è¯·æ’ä»–é”ï¼Œè€Œä¸æ˜¯å…ˆç”³è¯·å…±äº«é”ï¼Œä¿®æ”¹æ—¶å†è¯·æ±‚æ’ä»–é”ï¼Œè¿™æ ·å®¹æ˜“äº§ç”Ÿæ­»é”ã€‚</li>\n<li>ä¸åŒçš„ç¨‹åºè®¿é—®ä¸€ç»„è¡¨æ—¶ï¼Œåº”å°½é‡çº¦å®šä»¥ç›¸åŒçš„é¡ºåºè®¿é—®å„è¡¨ï¼Œå¯¹ä¸€ä¸ªè¡¨è€Œè¨€ï¼Œå°½å¯èƒ½ä»¥å›ºå®šçš„é¡ºåºå­˜å–è¡¨ä¸­çš„è¡Œã€‚è¿™æ ·å¯ä»¥å¤§å¤§å‡å°‘æ­»é”çš„æœºä¼šã€‚</li>\n<li>å°½é‡ç”¨ç›¸ç­‰æ¡ä»¶è®¿é—®æ•°æ®ï¼Œè¿™æ ·å¯ä»¥é¿å…é—´éš™é”å¯¹å¹¶å‘æ’å…¥çš„å½±å“ã€‚</li>\n<li>ä¸è¦ç”³è¯·è¶…è¿‡å®é™…éœ€è¦çš„é”çº§åˆ«ã€‚</li>\n<li>é™¤éå¿…é¡»ï¼ŒæŸ¥è¯¢æ—¶ä¸è¦æ˜¾ç¤ºåŠ é”ã€‚ MySQL çš„ MVCC å¯ä»¥å®ç°äº‹åŠ¡ä¸­çš„æŸ¥è¯¢ä¸ç”¨åŠ é”ï¼Œä¼˜åŒ–äº‹åŠ¡æ€§èƒ½ï¼›MVCC åªåœ¨ COMMITTED READï¼ˆè¯»æäº¤ï¼‰å’Œ REPEATABLE READï¼ˆå¯é‡å¤è¯»ï¼‰ä¸¤ç§éš”ç¦»çº§åˆ«ä¸‹å·¥ä½œã€‚</li>\n<li>å¯¹äºä¸€äº›ç‰¹å®šçš„äº‹åŠ¡ï¼Œå¯ä»¥ä½¿ç”¨è¡¨é”æ¥æé«˜å¤„ç†é€Ÿåº¦æˆ–å‡å°‘æ­»é”çš„å¯èƒ½ã€‚</li>\n</ul>\n<h3 id=\"MySQL-ä¸­æœ‰å“ªå‡ ç§é”ï¼Ÿ\"><a href=\"#MySQL-ä¸­æœ‰å“ªå‡ ç§é”ï¼Ÿ\" class=\"headerlink\" title=\"MySQL ä¸­æœ‰å“ªå‡ ç§é”ï¼Ÿ\"></a>MySQL ä¸­æœ‰å“ªå‡ ç§é”ï¼Ÿ</h3><p><strong>1ã€è¡¨çº§é”ï¼š</strong> å¼€é”€å°ï¼Œ åŠ é”å¿«ï¼› ä¸ä¼šå‡ºç°æ­»é”ï¼› é”å®šç²’åº¦å¤§ï¼Œ å‘ç”Ÿé”å†²çªçš„æ¦‚ç‡æœ€é«˜ï¼Œ å¹¶å‘åº¦æœ€ä½ã€‚</p>\n<p><strong>2ã€è¡Œçº§é”ï¼š</strong>  å¼€é”€å¤§ï¼Œ åŠ é”æ…¢ï¼› ä¼šå‡ºç°æ­»é”ï¼› é”å®šç²’åº¦æœ€å°ï¼Œ å‘ç”Ÿé”å†²çªçš„æ¦‚ç‡æœ€ä½ï¼Œ å¹¶å‘åº¦ä¹Ÿæœ€é«˜ã€‚</p>\n<p><strong>3ã€é¡µé”ï¼š</strong>  å¼€é”€å’ŒåŠ é”æ—¶é—´ç•Œäºè¡¨é”å’Œè¡Œé”ä¹‹é—´ï¼› ä¼šå‡ºç°æ­»é”ï¼› é”å®šç²’åº¦ç•Œäºè¡¨é”å’Œè¡Œé”ä¹‹é—´ï¼Œ å¹¶å‘åº¦ä¸€èˆ¬ã€‚</p>\n<h3 id=\"é”æœºåˆ¶ä¸InnoDBé”ç®—æ³•\"><a href=\"#é”æœºåˆ¶ä¸InnoDBé”ç®—æ³•\" class=\"headerlink\" title=\"é”æœºåˆ¶ä¸InnoDBé”ç®—æ³•\"></a>é”æœºåˆ¶ä¸InnoDBé”ç®—æ³•</h3><p><strong>MyISAMå’ŒInnoDBå­˜å‚¨å¼•æ“ä½¿ç”¨çš„é”ï¼š</strong></p>\n<ul>\n<li>MyISAM é‡‡ç”¨è¡¨çº§é”(table-level locking)ã€‚</li>\n<li>InnoDB æ”¯æŒè¡Œçº§é”(row-level locking)å’Œè¡¨çº§é”,é»˜è®¤ä¸ºè¡Œçº§é”</li>\n</ul>\n<p><strong>è¡¨çº§é”å’Œè¡Œçº§é”å¯¹æ¯”ï¼š</strong></p>\n<ul>\n<li><p><strong>è¡¨çº§é”ï¼š</strong> MySQL ä¸­é”å®š <strong>ç²’åº¦æœ€å¤§</strong> çš„ä¸€ç§é”ï¼Œå¯¹å½“å‰æ“ä½œçš„æ•´å¼ è¡¨åŠ é”ï¼Œå®ç°ç®€å•ï¼Œèµ„æºæ¶ˆè€—ä¹Ÿæ¯”è¾ƒå°‘ï¼ŒåŠ é”å¿«ï¼Œä¸ä¼šå‡ºç°æ­»é”ã€‚å…¶é”å®šç²’åº¦æœ€å¤§ï¼Œè§¦å‘é”å†²çªçš„æ¦‚ç‡æœ€é«˜ï¼Œå¹¶å‘åº¦æœ€ä½ï¼ŒMyISAM å’Œ InnoDB å¼•æ“éƒ½æ”¯æŒè¡¨çº§é”ã€‚</p>\n</li>\n<li><p><strong>è¡Œçº§é”ï¼š</strong> MySQL ä¸­é”å®š <strong>ç²’åº¦æœ€å°</strong> çš„ä¸€ç§é”ï¼Œåªé’ˆå¯¹å½“å‰æ“ä½œçš„è¡Œè¿›è¡ŒåŠ é”ã€‚ è¡Œçº§é”èƒ½å¤§å¤§å‡å°‘æ•°æ®åº“æ“ä½œçš„å†²çªã€‚å…¶åŠ é”ç²’åº¦æœ€å°ï¼Œå¹¶å‘åº¦é«˜ï¼Œä½†åŠ é”çš„å¼€é”€ä¹Ÿæœ€å¤§ï¼ŒåŠ é”æ…¢ï¼Œä¼šå‡ºç°æ­»é”ã€‚</p>\n</li>\n</ul>\n<h3 id=\"é”çš„ä¼˜åŒ–ç­–ç•¥\"><a href=\"#é”çš„ä¼˜åŒ–ç­–ç•¥\" class=\"headerlink\" title=\"é”çš„ä¼˜åŒ–ç­–ç•¥\"></a>é”çš„ä¼˜åŒ–ç­–ç•¥</h3><p><strong>1ã€</strong> è¯»å†™åˆ†ç¦»</p>\n<p><strong>2ã€</strong> åˆ†æ®µåŠ é”</p>\n<p><strong>3ã€</strong> å‡å°‘é”æŒæœ‰çš„æ—¶é—´</p>\n<p>å¤šä¸ªçº¿ç¨‹å°½é‡ä»¥ç›¸åŒçš„é¡ºåºå»è·å–èµ„æº</p>\n<p>ä¸èƒ½å°†é”çš„ç²’åº¦è¿‡äºç»†åŒ–ï¼Œ ä¸ç„¶å¯èƒ½ä¼šå‡ºç°çº¿ç¨‹çš„åŠ é”å’Œé‡Šæ”¾æ¬¡æ•°è¿‡å¤šï¼Œ åè€Œæ•ˆç‡ä¸å¦‚ä¸€æ¬¡åŠ ä¸€æŠŠå¤§é”ã€‚</p>\n<h2 id=\"MySQLæ—¥å¿—ç¯‡\"><a href=\"#MySQLæ—¥å¿—ç¯‡\" class=\"headerlink\" title=\"MySQLæ—¥å¿—ç¯‡\"></a>MySQLæ—¥å¿—ç¯‡</h2><h3 id=\"MySQL-æœ‰å“ªäº›é‡è¦çš„æ—¥å¿—æ–‡ä»¶ï¼Ÿ\"><a href=\"#MySQL-æœ‰å“ªäº›é‡è¦çš„æ—¥å¿—æ–‡ä»¶ï¼Ÿ\" class=\"headerlink\" title=\"MySQL æœ‰å“ªäº›é‡è¦çš„æ—¥å¿—æ–‡ä»¶ï¼Ÿ\"></a>MySQL æœ‰å“ªäº›é‡è¦çš„æ—¥å¿—æ–‡ä»¶ï¼Ÿ</h3><p>MySQL ä¸­çš„é‡è¦æ—¥å¿—åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªï¼š</p>\n<p><strong>â‘  é”™è¯¯æ—¥å¿—ï¼š</strong>ç”¨æ¥è®°å½• MySQL æœåŠ¡å™¨è¿è¡Œè¿‡ç¨‹ä¸­çš„é”™è¯¯ä¿¡æ¯</p>\n<p><strong>â‘¡ æŸ¥è¯¢æ—¥å¿—</strong>ï¼šæŸ¥è¯¢æ—¥å¿—åœ¨ MySQL ä¸­è¢«ç§°ä¸º general log(é€šç”¨æ—¥å¿—)ï¼ŒæŸ¥è¯¢æ—¥å¿—é‡Œçš„å†…å®¹ä¸è¦è¢«â€œæŸ¥è¯¢æ—¥å¿—â€è¯¯å¯¼ï¼Œè®¤ä¸ºé‡Œé¢åªå­˜å‚¨ select è¯­å¥ï¼Œå…¶å®ä¸ç„¶ï¼ŒæŸ¥è¯¢æ—¥å¿—é‡Œé¢è®°å½•äº†æ•°æ®åº“æ‰§è¡Œçš„æ‰€æœ‰å‘½ä»¤ï¼Œä¸ç®¡è¯­å¥æ˜¯å¦æ­£ç¡®ï¼Œéƒ½ä¼šè¢«è®°å½•ï¼Œå…·ä½“åŸå› å¦‚ä¸‹:</p>\n<ul>\n<li><p>insert æŸ¥è¯¢ä¸ºäº†é¿å…æ•°æ®å†²çªï¼Œå¦‚æœæ­¤å‰æ’å…¥è¿‡æ•°æ®ï¼Œå½“å‰æ’å…¥çš„æ•°æ®å¦‚æœè·Ÿä¸»é”®æˆ–å”¯ä¸€é”®çš„æ•°æ®é‡å¤é‚£è‚¯å®šä¼šæŠ¥é”™ï¼›</p>\n</li>\n<li><p>update æ—¶ä¹Ÿä¼šæŸ¥è¯¢å› ä¸ºæ›´æ–°çš„æ—¶å€™å¾ˆå¯èƒ½ä¼šæ›´æ–°æŸä¸€å—æ•°æ®ï¼›</p>\n</li>\n<li><p>delete æŸ¥è¯¢ï¼Œåªåˆ é™¤ç¬¦åˆæ¡ä»¶çš„æ•°æ®ï¼›</p>\n</li>\n</ul>\n<p>å› æ­¤éƒ½ä¼šäº§ç”Ÿæ—¥å¿—ï¼Œåœ¨å¹¶å‘æ“ä½œéå¸¸å¤šçš„åœºæ™¯ä¸‹ï¼ŒæŸ¥è¯¢ä¿¡æ¯ä¼šéå¸¸å¤šï¼Œé‚£ä¹ˆå¦‚æœéƒ½è®°å½•ä¸‹æ¥ä¼šå¯¼è‡´ IO éå¸¸å¤§ï¼Œå½±å“ MySQL æ€§èƒ½ï¼Œå› æ­¤å¦‚æœä¸æ˜¯åœ¨è°ƒè¯•ç¯å¢ƒä¸‹ï¼Œæ˜¯ä¸å»ºè®®å¼€å¯æŸ¥è¯¢æ—¥å¿—åŠŸèƒ½çš„ã€‚</p>\n<p>æŸ¥è¯¢æ—¥å¿—çš„å¼€å¯æœ‰åŠ©äºå¸®åŠ©æˆ‘ä»¬åˆ†æå“ªäº›è¯­å¥æ‰§è¡Œå¯†é›†ï¼Œæ‰§è¡Œå¯†é›†çš„ select è¯­å¥å¯¹åº”çš„æ•°æ®æ˜¯å¦èƒ½å¤Ÿè¢«ç¼“å­˜ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥å¸®åŠ©æˆ‘ä»¬åˆ†æé—®é¢˜ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µæ¥å†³å®šæ˜¯å¦å¼€å¯æŸ¥è¯¢æ—¥å¿—ã€‚</p>\n<p><strong>â‘¢ æ…¢æ—¥å¿—</strong>ï¼šæ…¢æŸ¥è¯¢ä¼šå¯¼è‡´ CPUã€IOPSã€å†…å­˜æ¶ˆè€—è¿‡é«˜ï¼Œå½“æ•°æ®åº“é‡åˆ°æ€§èƒ½ç“¶é¢ˆæ—¶ï¼Œå¤§éƒ¨åˆ†æ—¶é—´éƒ½æ˜¯ç”±äºæ…¢æŸ¥è¯¢å¯¼è‡´çš„ã€‚å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œå¯ä»¥è®© MySQL è®°å½•ä¸‹æŸ¥è¯¢è¶…è¿‡æŒ‡å®šæ—¶é—´çš„è¯­å¥ï¼Œä¹‹åè¿ç»´äººå‘˜é€šè¿‡å®šä½åˆ†æï¼Œèƒ½å¤Ÿå¾ˆå¥½çš„ä¼˜åŒ–æ•°æ®åº“æ€§èƒ½ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ…¢æŸ¥è¯¢æ—¥å¿—æ˜¯ä¸å¼€å¯çš„ï¼Œåªæœ‰æ‰‹åŠ¨å¼€å¯äº†ï¼Œæ…¢æŸ¥è¯¢æ‰ä¼šè¢«è®°å½•åˆ°æ…¢æŸ¥è¯¢æ—¥å¿—ä¸­ã€‚ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è®°å½•å½“å‰æ•°æ®åº“çš„æ…¢æŸ¥è¯¢è¯­å¥ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">set global slowquerylog=&#x27;ON&#x27;;</span><br></pre></td></tr></table></figure>\n\n<p>ä½¿ç”¨ set global slow<em>query</em>log&#x3D;â€™ONâ€™ å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œåªæ˜¯å¯¹å½“å‰æ•°æ®åº“æœ‰æ•ˆï¼Œå¦‚æœ MySQL æ•°æ®åº“é‡å¯åå°±ä¼šå¤±æ•ˆã€‚æ‰€ä»¥å¦‚æœè¦æ°¸ä¹…ç”Ÿæ•ˆï¼Œå°±è¦ä¿®æ”¹é…ç½®æ–‡ä»¶ my.cnfï¼Œè®¾ç½® slow<em>query</em>log&#x3D;1 å¹¶é‡å¯ MySQL æœåŠ¡å™¨ã€‚</p>\n<p><strong>â‘£ redo logï¼ˆé‡åšæ—¥å¿—ï¼‰</strong>ï¼šä¸ºäº†æœ€å¤§ç¨‹åº¦çš„é¿å…æ•°æ®å†™å…¥æ—¶ï¼Œå› ä¸º IO ç“¶é¢ˆé€ æˆçš„æ€§èƒ½é—®é¢˜ï¼ŒMySQL é‡‡ç”¨äº†è¿™æ ·ä¸€ç§ç¼“å­˜æœºåˆ¶ï¼Œå…ˆå°†æ•°æ®å†™å…¥å†…å­˜ä¸­ï¼Œå†æ‰¹é‡æŠŠå†…å­˜ä¸­çš„æ•°æ®ç»Ÿä¸€åˆ·å›ç£ç›˜ã€‚ä¸ºäº†é¿å…å°†æ•°æ®åˆ·å›ç£ç›˜è¿‡ç¨‹ä¸­ï¼Œå› ä¸ºæ‰ç”µæˆ–ç³»ç»Ÿæ•…éšœå¸¦æ¥çš„æ•°æ®ä¸¢å¤±é—®é¢˜ï¼ŒInnoDB é‡‡ç”¨ redo log æ¥è§£å†³æ­¤é—®é¢˜ã€‚</p>\n<p><strong>â‘¤ undo logï¼ˆå›æ»šæ—¥å¿—ï¼‰</strong>ï¼šç”¨äºå­˜å‚¨æ—¥å¿—è¢«ä¿®æ”¹å‰çš„å€¼ï¼Œä»è€Œä¿è¯å¦‚æœä¿®æ”¹å‡ºç°å¼‚å¸¸ï¼Œå¯ä»¥ä½¿ç”¨ undo log æ—¥å¿—æ¥å®ç°å›æ»šæ“ä½œã€‚ undo log å’Œ redo log è®°å½•ç‰©ç†æ—¥å¿—ä¸ä¸€æ ·ï¼Œå®ƒæ˜¯é€»è¾‘æ—¥å¿—ï¼Œå¯ä»¥è®¤ä¸ºå½“ delete ä¸€æ¡è®°å½•æ—¶ï¼Œundo log ä¸­ä¼šè®°å½•ä¸€æ¡å¯¹åº”çš„ insert è®°å½•ï¼Œåä¹‹äº¦ç„¶ï¼Œå½“ update ä¸€æ¡è®°å½•æ—¶ï¼Œå®ƒè®°å½•ä¸€æ¡å¯¹åº”ç›¸åçš„ update è®°å½•ï¼Œå½“æ‰§è¡Œ rollback æ—¶ï¼Œå°±å¯ä»¥ä» undo log ä¸­çš„é€»è¾‘è®°å½•è¯»å–åˆ°ç›¸åº”çš„å†…å®¹å¹¶è¿›è¡Œå›æ»šã€‚</p>\n<p><strong>â‘¥ bin logï¼ˆäºŒè¿›åˆ¶æ—¥å¿—ï¼‰</strong>ï¼šæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸»è¦<strong>è®°å½•äº†å¯¹ MySQL æ•°æ®åº“æ‰§è¡Œæ›´æ”¹çš„æ‰€æœ‰æ“ä½œ</strong>ï¼Œæ¯”å¦‚ï¼ŒCREATEã€ALTER TABLE ç­‰ï¼Œä»¥åŠè¡¨æ•°æ®ä¿®æ”¹ï¼Œæ¯”å¦‚ï¼ŒINSERTã€UPDATEã€DELETE çš„æ‰€æœ‰æ“ä½œï¼Œä¸è®°å½• SELECTã€SHOW ç­‰é‚£äº›ä¸ä¿®æ”¹æ•°æ®æˆ–æ•°æ®åº“ç»“æ„çš„ SQL è¯­å¥ã€‚</p>\n<p>binlog çš„ä½œç”¨å¦‚ä¸‹ï¼š</p>\n<ul>\n<li><p>æ¢å¤ï¼ˆrecoveryï¼‰ï¼šæŸäº›æ•°æ®çš„æ¢å¤éœ€è¦äºŒè¿›åˆ¶æ—¥å¿—ã€‚æ¯”å¦‚ï¼Œåœ¨ä¸€ä¸ªæ•°æ®åº“å…¨å¤‡æ–‡ä»¶æ¢å¤åï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡äºŒè¿›åˆ¶æ—¥å¿—è¿›è¡Œ point-in-time çš„æ¢å¤ï¼›</p>\n</li>\n<li><p>å¤åˆ¶ï¼ˆreplicationï¼‰ï¼šå…¶åŸç†ä¸æ¢å¤ç±»ä¼¼ï¼Œé€šè¿‡å¤åˆ¶å’Œæ‰§è¡ŒäºŒè¿›åˆ¶æ—¥å¿—ä½¿ä¸€å°è¿œç¨‹çš„ MySQL æ•°æ®åº“ï¼ˆä¸€èˆ¬ç§°ä¸º slave æˆ–è€… standbyï¼‰ä¸ä¸€å° MySQL æ•°æ®åº“ï¼ˆä¸€èˆ¬ç§°ä¸º master æˆ–è€… primaryï¼‰è¿›è¡Œå®æ—¶åŒæ­¥ï¼›</p>\n</li>\n<li><p>å®¡è®¡ï¼ˆauditï¼‰ï¼šç”¨æˆ·å¯ä»¥é€šè¿‡äºŒè¿›åˆ¶æ—¥å¿—ä¸­çš„ä¿¡æ¯æ¥è¿›è¡Œå®¡è®¡ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰å¯¹æ•°æ®åº“è¿›è¡Œæ³¨å…¥æ”»å‡»ã€‚</p>\n</li>\n</ul>\n<p>é™¤äº†ä¸Šé¢ä»‹ç»çš„å‡ ä¸ªä½œç”¨å¤–ï¼Œbinlog å¯¹äºäº‹åŠ¡å­˜å‚¨å¼•æ“çš„å´©æºƒæ¢å¤ä¹Ÿæœ‰éå¸¸é‡è¦çš„ä½œç”¨ï¼Œåœ¨å¼€å¯ binlog çš„æƒ…å†µä¸‹ï¼Œä¸ºäº†ä¿è¯ binlog ä¸ redo çš„ä¸€è‡´æ€§ï¼ŒMySQL å°†é‡‡ç”¨äº‹åŠ¡çš„ä¸¤é˜¶æ®µæäº¤åè®®ã€‚å½“ MySQL ç³»ç»Ÿå‘ç”Ÿå´©æºƒæ—¶ï¼Œäº‹åŠ¡åœ¨å­˜å‚¨å¼•æ“å†…éƒ¨çš„çŠ¶æ€å¯èƒ½ä¸º preparedï¼ˆå‡†å¤‡çŠ¶æ€ï¼‰å’Œ commitï¼ˆæäº¤çŠ¶æ€ï¼‰ä¸¤ç§ï¼Œå¯¹äº prepared çŠ¶æ€çš„äº‹åŠ¡ï¼Œæ˜¯è¿›è¡Œæäº¤æ“ä½œè¿˜æ˜¯è¿›è¡Œå›æ»šæ“ä½œï¼Œè¿™æ—¶éœ€è¦å‚è€ƒ binlogï¼Œå¦‚æœäº‹åŠ¡åœ¨ binlog ä¸­å­˜åœ¨ï¼Œé‚£ä¹ˆå°†å…¶æäº¤ï¼›å¦‚æœä¸åœ¨ binlog ä¸­å­˜åœ¨ï¼Œé‚£ä¹ˆå°†å…¶å›æ»šï¼Œè¿™æ ·å°±ä¿è¯äº†æ•°æ®åœ¨ä¸»åº“å’Œä»åº“ä¹‹é—´çš„ä¸€è‡´æ€§ã€‚</p>\n<p>binlog é»˜è®¤æ˜¯å…³é—­çŠ¶æ€ï¼Œå¯ä»¥åœ¨ MySQL é…ç½®æ–‡ä»¶ï¼ˆmy.cnfï¼‰ä¸­é€šè¿‡é…ç½®å‚æ•° log-bin &#x3D; [base-name] å¼€å¯è®°å½• binlog æ—¥å¿—ï¼Œå¦‚æœä¸æŒ‡å®š base-nameï¼Œåˆ™é»˜è®¤äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶åä¸ºä¸»æœºåï¼Œå¹¶ä»¥è‡ªå¢çš„æ•°å­—ä½œä¸ºåç¼€ï¼Œæ¯”å¦‚ï¼šmysql-bin.000001ï¼Œæ‰€åœ¨ç›®å½•ä¸ºæ•°æ®åº“æ‰€åœ¨ç›®å½•ï¼ˆdatadirï¼‰ã€‚</p>\n<p>é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ¥æŸ¥è¯¢ binlog æ˜¯å¦å¼€å¯ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">show variables like &#x27;log_%&#x27;; </span><br></pre></td></tr></table></figure>\n\n<p>binlog æ ¼å¼åˆ†ä¸º: STATEMENTã€ROW å’Œ MIXED ä¸‰ç§ï¼š</p>\n<ul>\n<li><p>STATEMENT æ ¼å¼çš„ binlog è®°å½•çš„æ˜¯æ•°æ®åº“ä¸Šæ‰§è¡Œçš„åŸç”Ÿ SQL è¯­å¥ã€‚è¿™ç§æ ¼å¼çš„ä¼˜ç‚¹æ˜¯ç®€å•ï¼Œç®€å•åœ°è®°å½•å’Œæ‰§è¡Œè¿™äº›è¯­å¥ï¼Œèƒ½å¤Ÿè®©ä¸»å¤‡ä¿æŒåŒæ­¥ï¼Œåœ¨ä¸»æœåŠ¡å™¨ä¸Šæ‰§è¡Œçš„ SQL è¯­å¥ï¼Œåœ¨ä»æœåŠ¡å™¨ä¸Šæ‰§è¡ŒåŒæ ·çš„è¯­å¥ã€‚å¦ä¸€ä¸ªå¥½å¤„æ˜¯äºŒè¿›åˆ¶æ—¥å¿—é‡Œçš„æ—¶é—´æ›´åŠ ç´§å‡‘ï¼Œæ‰€ä»¥ç›¸å¯¹è€Œè¨€ï¼ŒåŸºäºè¯­å¥çš„å¤åˆ¶æ¨¡å¼ä¸ä¼šä½¿ç”¨å¤ªå¤šå¸¦å®½ï¼ŒåŒæ—¶ä¹ŸèŠ‚çº¦ç£ç›˜ç©ºé—´ã€‚å¹¶ä¸”é€šè¿‡ mysqlbinlog å·¥å…·å®¹æ˜“è¯»æ‡‚å…¶ä¸­çš„å†…å®¹ã€‚ç¼ºç‚¹å°±æ˜¯åŒä¸€æ¡ SQL åœ¨ä¸»åº“å’Œä»åº“ä¸Šæ‰§è¡Œçš„æ—¶é—´å¯èƒ½ç¨å¾®æˆ–å¾ˆå¤§ä¸ç›¸åŒï¼Œå› æ­¤åœ¨ä¼ è¾“çš„äºŒè¿›åˆ¶æ—¥å¿—ä¸­ï¼Œé™¤äº†æŸ¥è¯¢è¯­å¥ï¼Œè¿˜åŒ…æ‹¬äº†ä¸€äº›å…ƒæ•°æ®ä¿¡æ¯ï¼Œå¦‚å½“å‰çš„æ—¶é—´æˆ³ã€‚å³ä¾¿å¦‚æ­¤ï¼Œè¿˜å­˜åœ¨ç€ä¸€äº›æ— æ³•è¢«æ­£ç¡®å¤åˆ¶çš„ SQLã€‚æ¯”å¦‚ï¼Œä½¿ç”¨ INSERT INTO TB1 VALUE(CUURENT_DATE()) è¿™ä¸€æ¡ä½¿ç”¨å‡½æ•°çš„è¯­å¥æ’å…¥çš„æ•°æ®å¤åˆ¶åˆ°å½“å‰ä»æœåŠ¡å™¨ä¸Šæ¥å°±ä¼šå‘ç”Ÿå˜åŒ–ï¼Œå­˜å‚¨è¿‡ç¨‹å’Œè§¦å‘å™¨åœ¨ä½¿ç”¨åŸºäºè¯­å¥çš„å¤åˆ¶æ¨¡å¼æ—¶ä¹Ÿå¯èƒ½å­˜åœ¨é—®é¢˜ï¼›å¦å¤–ä¸€ä¸ªé—®é¢˜å°±æ˜¯åŸºäºè¯­å¥çš„å¤åˆ¶å¿…é¡»æ˜¯ä¸²è¡ŒåŒ–çš„ï¼Œæ¯”å¦‚ï¼šInnoDB çš„ next-key é”ç­‰ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„å­˜å‚¨å¼•æ“éƒ½æ”¯æŒåŸºäºè¯­å¥çš„å¤åˆ¶ï¼›</p>\n</li>\n<li><p>ROW æ ¼å¼æ˜¯ä» MySQL 5.1 å¼€å§‹æ”¯æŒåŸºäºè¡Œçš„å¤åˆ¶ï¼Œä¹Ÿå°±æ˜¯åŸºäºæ•°æ®çš„å¤åˆ¶ï¼ŒåŸºäºè¡Œçš„æ›´æ”¹ã€‚è¿™ç§æ–¹å¼ä¼šå°†å®é™…æ•°æ®è®°å½•åœ¨äºŒè¿›åˆ¶æ—¥å¿—ä¸­ï¼Œå®ƒæœ‰å…¶è‡ªèº«çš„ä¸€äº›ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Œæœ€å¤§çš„å¥½å¤„æ˜¯å¯ä»¥æ­£ç¡®åœ°å¤åˆ¶æ¯ä¸€è¡Œæ•°æ®ï¼Œä¸€äº›è¯­å¥å¯ä»¥è¢«æ›´åŠ æœ‰æ•ˆåœ°å¤åˆ¶ï¼Œå¦å¤–å°±æ˜¯å‡ ä¹æ²¡æœ‰åŸºäºè¡Œçš„å¤åˆ¶æ¨¡å¼æ— æ³•å¤„ç†çš„åœºæ™¯ï¼Œå¯¹äºæ‰€æœ‰çš„ SQL æ„é€ ã€è§¦å‘å™¨ã€å­˜å‚¨è¿‡ç¨‹ç­‰éƒ½èƒ½æ­£ç¡®æ‰§è¡Œï¼›å®ƒçš„ç¼ºç‚¹å°±æ˜¯äºŒè¿›åˆ¶æ—¥å¿—å¯èƒ½ä¼šå¾ˆå¤§ï¼Œè€Œä¸”ä¸ç›´è§‚ï¼Œæ‰€ä»¥ï¼Œä½ ä¸èƒ½ä½¿ç”¨ mysqlbinlog æ¥æŸ¥çœ‹äºŒè¿›åˆ¶æ—¥å¿—ï¼Œä¹Ÿæ— æ³•é€šè¿‡çœ‹äºŒè¿›åˆ¶æ—¥å¿—åˆ¤æ–­å½“å‰æ‰§è¡Œåˆ°é‚£ä¸€æ¡ SQL è¯­å¥ã€‚ç°åœ¨å¯¹äº ROW æ ¼å¼çš„äºŒè¿›åˆ¶æ—¥å¿—åŸºæœ¬æ˜¯æ ‡é…äº†ï¼Œä¸»è¦æ˜¯å› ä¸ºå®ƒçš„ä¼˜åŠ¿è¿œè¿œå¤§äºç¼ºç‚¹ï¼Œå¹¶ä¸”ç”±äº ROW æ ¼å¼è®°å½•è¡Œæ•°æ®ï¼Œæ‰€ä»¥å¯ä»¥åŸºäºè¿™ç§æ¨¡å¼åšä¸€äº› DBA å·¥å…·ï¼Œæ¯”å¦‚æ•°æ®æ¢å¤ï¼Œä¸åŒæ•°æ®åº“ä¹‹é—´æ•°æ®åŒæ­¥ç­‰ï¼›</p>\n</li>\n<li><p>MIXED ä¹Ÿæ˜¯ MySQL é»˜è®¤ä½¿ç”¨çš„äºŒè¿›åˆ¶æ—¥å¿—è®°å½•æ–¹å¼ï¼Œä½† MIXED æ ¼å¼é»˜è®¤é‡‡ç”¨åŸºäºè¯­å¥çš„å¤åˆ¶ï¼Œä¸€æ—¦å‘ç°åŸºäºè¯­å¥çš„æ— æ³•ç²¾ç¡®çš„å¤åˆ¶æ—¶ï¼Œå°±ä¼šé‡‡ç”¨åŸºäºè¡Œçš„å¤åˆ¶ã€‚æ¯”å¦‚ç”¨åˆ° UUID()ã€USER()ã€CURRENT<em>USER()ã€ROW</em>COUNT() ç­‰æ— æ³•ç¡®å®šçš„å‡½æ•°ã€‚</p>\n</li>\n</ul>\n<h3 id=\"redo-log-å’Œ-binlog-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"><a href=\"#redo-log-å’Œ-binlog-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"redo log å’Œ binlog æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"></a>redo log å’Œ binlog æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p>redo logï¼ˆé‡åšæ—¥å¿—ï¼‰å’Œ binlogï¼ˆå½’æ¡£æ—¥å¿—ï¼‰éƒ½æ˜¯ MySQL çš„é‡è¦çš„æ—¥å¿—ï¼Œå®ƒä»¬çš„åŒºåˆ«å¦‚ä¸‹ï¼š</p>\n<ul>\n<li><p>redo log æ˜¯ç‰©ç†æ—¥å¿—ï¼Œè®°å½•çš„æ˜¯â€œåœ¨æŸä¸ªæ•°æ®é¡µä¸Šåšäº†ä»€ä¹ˆä¿®æ”¹â€ã€‚</p>\n</li>\n<li><p>binlog æ˜¯é€»è¾‘æ—¥å¿—ï¼Œè®°å½•çš„æ˜¯è¿™ä¸ªè¯­å¥çš„åŸå§‹é€»è¾‘ï¼Œæ¯”å¦‚â€œç»™ ID&#x3D;2 è¿™ä¸€è¡Œçš„ c å­—æ®µåŠ  1 â€ã€‚</p>\n</li>\n<li><p>redo log æ˜¯ InnoDB å¼•æ“ç‰¹æœ‰çš„ï¼›binlog æ˜¯ MySQL çš„ Server å±‚å®ç°çš„ï¼Œæ‰€æœ‰å¼•æ“éƒ½å¯ä»¥ä½¿ç”¨ã€‚</p>\n</li>\n<li><p>redo log æ˜¯å¾ªç¯å†™çš„ï¼Œç©ºé—´å›ºå®šä¼šç”¨å®Œï¼›binlog æ˜¯å¯ä»¥è¿½åŠ å†™å…¥çš„ã€‚â€œè¿½åŠ å†™â€æ˜¯æŒ‡ binlog æ–‡ä»¶å†™åˆ°ä¸€å®šå¤§å°åä¼šåˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªï¼Œå¹¶ä¸ä¼šè¦†ç›–ä»¥å‰çš„æ—¥å¿—ã€‚</p>\n</li>\n</ul>\n<p>æœ€å¼€å§‹ MySQL é‡Œå¹¶æ²¡æœ‰ InnoDB å¼•æ“ï¼ŒMySQL è‡ªå¸¦çš„å¼•æ“æ˜¯ MyISAMï¼Œä½†æ˜¯ MyISAM æ²¡æœ‰ crash-safe çš„èƒ½åŠ›ï¼Œbinlog æ—¥å¿—åªèƒ½ç”¨äºå½’æ¡£ã€‚è€Œ InnoDB æ˜¯å¦ä¸€ä¸ªå…¬å¸ä»¥æ’ä»¶å½¢å¼å¼•å…¥ MySQL çš„ï¼Œæ—¢ç„¶åªä¾é  binlog æ˜¯æ²¡æœ‰ crash-safe èƒ½åŠ›çš„ï¼Œæ‰€ä»¥ InnoDB ä½¿ç”¨å¦å¤–ä¸€å¥—æ—¥å¿—ç³»ç»Ÿï¼Œä¹Ÿå°±æ˜¯ redo log æ¥å®ç° crash-safe èƒ½åŠ›ã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯-crash-safeï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯-crash-safeï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ crash-safeï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯ crash-safeï¼Ÿ</h3><p>crash-safe æ˜¯æŒ‡å‘ç”Ÿå®•æœºç­‰æ„å¤–æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨é‡å¯åæ•°æ®ä¾ç„¶ä¸ä¼šä¸¢å¤±çš„æƒ…å†µã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯è„é¡µå’Œå¹²å‡€é¡µï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯è„é¡µå’Œå¹²å‡€é¡µï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯è„é¡µå’Œå¹²å‡€é¡µï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯è„é¡µå’Œå¹²å‡€é¡µï¼Ÿ</h3><p>MySQL ä¸ºäº†æ“ä½œçš„æ€§èƒ½ä¼˜åŒ–ï¼Œä¼šæŠŠæ•°æ®æ›´æ–°å…ˆæ”¾å…¥å†…å­˜ä¸­ï¼Œä¹‹åå†ç»Ÿä¸€æ›´æ–°åˆ°ç£ç›˜ã€‚å½“å†…å­˜æ•°æ®å’Œç£ç›˜æ•°æ®å†…å®¹ä¸ä¸€è‡´çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç§°è¿™ä¸ªå†…å­˜é¡µä¸ºè„é¡µï¼›å†…å­˜æ•°æ®å†™åˆ°ç£ç›˜åï¼Œå†…å­˜çš„æ•°æ®å’Œç£ç›˜ä¸Šçš„å†…å®¹å°±ä¸€è‡´äº†ï¼Œæˆ‘ä»¬ç§°ä¸ºâ€œå¹²å‡€é¡µâ€ã€‚</p>\n<h3 id=\"ä»€ä¹ˆæƒ…å†µä¸‹ä¼šå¼•å‘-MySQL-åˆ·è„é¡µï¼ˆflushï¼‰çš„æ“ä½œï¼Ÿ\"><a href=\"#ä»€ä¹ˆæƒ…å†µä¸‹ä¼šå¼•å‘-MySQL-åˆ·è„é¡µï¼ˆflushï¼‰çš„æ“ä½œï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæƒ…å†µä¸‹ä¼šå¼•å‘ MySQL åˆ·è„é¡µï¼ˆflushï¼‰çš„æ“ä½œï¼Ÿ\"></a>ä»€ä¹ˆæƒ…å†µä¸‹ä¼šå¼•å‘ MySQL åˆ·è„é¡µï¼ˆflushï¼‰çš„æ“ä½œï¼Ÿ</h3><ul>\n<li><p>å†…å­˜å†™æ»¡äº†ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šå¼•å‘ flush æ“ä½œï¼Œå¯¹åº”åˆ° InnoDB å°±æ˜¯ redo log å†™æ»¡äº†ï¼›</p>\n</li>\n<li><p>ç³»ç»Ÿçš„å†…å­˜ä¸è¶³äº†ï¼Œå½“éœ€è¦æ–°çš„å†…å­˜é¡µçš„æ—¶å€™ï¼Œå°±ä¼šæ·˜æ±°ä¸€äº›å†…å­˜é¡µï¼Œå¦‚æœæ·˜æ±°çš„æ˜¯è„é¡µè¿™ä¸ªæ—¶å€™å°±ä¼šè§¦å‘ flush æ“ä½œï¼›</p>\n</li>\n<li><p>ç³»ç»Ÿç©ºé—²çš„æ—¶å€™ï¼ŒMySQL ä¼šåŒæ­¥å†…å­˜ä¸­çš„æ•°æ®åˆ°ç£ç›˜ä¹Ÿä¼šè§¦å‘ flush æ“ä½œï¼›</p>\n</li>\n<li><p>MySQL æœåŠ¡å…³é—­çš„æ—¶å€™ä¹Ÿä¼šåˆ·è„é¡µï¼Œè§¦å‘ flush æ“ä½œã€‚</p>\n</li>\n</ul>\n<h3 id=\"MySQL-åˆ·è„é¡µçš„é€Ÿåº¦å¾ˆæ…¢å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ\"><a href=\"#MySQL-åˆ·è„é¡µçš„é€Ÿåº¦å¾ˆæ…¢å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ\" class=\"headerlink\" title=\"MySQL åˆ·è„é¡µçš„é€Ÿåº¦å¾ˆæ…¢å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ\"></a>MySQL åˆ·è„é¡µçš„é€Ÿåº¦å¾ˆæ…¢å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ</h3><p>åœ¨ MySQL ä¸­å•ç‹¬åˆ·ä¸€ä¸ªè„é¡µçš„é€Ÿåº¦æ˜¯å¾ˆå¿«çš„ï¼Œå¦‚æœå‘ç°åˆ·è„é¡µçš„é€Ÿåº¦å¾ˆæ…¢ï¼Œè¯´æ˜è§¦å‘äº† MySQL åˆ·è„é¡µçš„â€œè¿åâ€æœºåˆ¶ï¼ŒMySQL çš„â€œè¿åâ€æœºåˆ¶æ˜¯æŒ‡å½“ MySQL åˆ·è„é¡µçš„æ—¶å€™å¦‚æœå‘ç°ç›¸é‚»çš„æ•°æ®é¡µä¹Ÿæ˜¯è„é¡µä¹Ÿä¼šä¸€èµ·åˆ·æ‰ï¼Œè€Œè¿™ä¸ªåŠ¨ä½œå¯ä»¥ä¸€ç›´è”“å»¶ä¸‹å»ï¼Œè¿™å°±æ˜¯å¯¼è‡´ MySQL åˆ·è„é¡µæ…¢çš„åŸå› äº†ã€‚</p>\n<h3 id=\"å¦‚ä½•æ§åˆ¶-MySQL-åªåˆ·æ–°å½“å‰è„é¡µï¼Ÿ\"><a href=\"#å¦‚ä½•æ§åˆ¶-MySQL-åªåˆ·æ–°å½“å‰è„é¡µï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•æ§åˆ¶ MySQL åªåˆ·æ–°å½“å‰è„é¡µï¼Ÿ\"></a>å¦‚ä½•æ§åˆ¶ MySQL åªåˆ·æ–°å½“å‰è„é¡µï¼Ÿ</h3><p>åœ¨ InnoDB ä¸­è®¾ç½® innodb<em>flush</em>neighbors è¿™ä¸ªå‚æ•°çš„å€¼ä¸º 0ï¼Œæ¥è§„å®š MySQL åªåˆ·å½“å‰è„é¡µï¼ŒMySQL 8 è¿™ä¸ªå€¼é»˜è®¤æ˜¯ 0ã€‚</p>\n<h3 id=\"MySQL-çš„-WAL-æŠ€æœ¯æ˜¯è§£å†³ä»€ä¹ˆé—®é¢˜çš„ï¼Ÿ\"><a href=\"#MySQL-çš„-WAL-æŠ€æœ¯æ˜¯è§£å†³ä»€ä¹ˆé—®é¢˜çš„ï¼Ÿ\" class=\"headerlink\" title=\"MySQL çš„ WAL æŠ€æœ¯æ˜¯è§£å†³ä»€ä¹ˆé—®é¢˜çš„ï¼Ÿ\"></a>MySQL çš„ WAL æŠ€æœ¯æ˜¯è§£å†³ä»€ä¹ˆé—®é¢˜çš„ï¼Ÿ</h3><p>A.é˜²æ­¢è¯¯åˆ é™¤ï¼Œæ‰¾å›æ•°æ®ç”¨çš„ B.å®¹ç¾æ¢å¤ï¼Œä¸ºäº†è¿˜åŸå¼‚å¸¸æ•°æ®ç”¨çš„ C.äº‹åŠ¡å¤„ç†ï¼Œä¸ºäº†æ•°æ®åº“çš„ç¨³å®šæ€§ D.ä¸ºäº†é™ä½ IO æˆæœ¬ ç­”ï¼šD é¢˜ç›®è§£æï¼šWAL æŠ€æœ¯çš„å…¨ç§°æ˜¯ Write Ahead Loggingï¼ˆä¸­æ–‡ï¼šé¢„å†™å¼æ—¥å¿—ï¼‰ï¼Œæ˜¯å…ˆå†™æ—¥å¿—ï¼Œå†å†™ç£ç›˜çš„æ–¹å¼ï¼Œå› ä¸ºæ¯æ¬¡æ›´æ–°éƒ½å†™ç£ç›˜çš„è¯ IO æˆæœ¬å¾ˆé«˜ï¼Œæ‰€ä»¥æ‰æœ‰äº† WAL æŠ€æœ¯ã€‚</p>\n<h3 id=\"ä¸ºä»€ä¹ˆæœ‰æ—¶å€™ä¼šæ„Ÿè§‰-MySQL-å¶å°”å¡ä¸€ä¸‹ï¼Ÿ\"><a href=\"#ä¸ºä»€ä¹ˆæœ‰æ—¶å€™ä¼šæ„Ÿè§‰-MySQL-å¶å°”å¡ä¸€ä¸‹ï¼Ÿ\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆæœ‰æ—¶å€™ä¼šæ„Ÿè§‰ MySQL å¶å°”å¡ä¸€ä¸‹ï¼Ÿ\"></a>ä¸ºä»€ä¹ˆæœ‰æ—¶å€™ä¼šæ„Ÿè§‰ MySQL å¶å°”å¡ä¸€ä¸‹ï¼Ÿ</h3><p>å¦‚æœå¶å°”æ„Ÿè§‰ MySQL å¡ä¸€ä¸‹ï¼Œå¯èƒ½æ˜¯ MySQL æ­£åœ¨åˆ·è„é¡µï¼Œæ­£åœ¨æŠŠå†…å­˜ä¸­çš„æ›´æ–°æ“ä½œåˆ·åˆ°ç£ç›˜ä¸­ã€‚</p>\n<h3 id=\"redo-log-å’Œ-binlog-æ˜¯æ€ä¹ˆå…³è”çš„\"><a href=\"#redo-log-å’Œ-binlog-æ˜¯æ€ä¹ˆå…³è”çš„\" class=\"headerlink\" title=\"redo log å’Œ binlog æ˜¯æ€ä¹ˆå…³è”çš„?\"></a>redo log å’Œ binlog æ˜¯æ€ä¹ˆå…³è”çš„?</h3><p>å®ƒä»¬æœ‰ä¸€ä¸ªå…±åŒçš„æ•°æ®å­—æ®µï¼Œå« XIDã€‚å´©æºƒæ¢å¤çš„æ—¶å€™ï¼Œä¼šæŒ‰é¡ºåºæ‰«æ redo logï¼š</p>\n<ul>\n<li><p>å¦‚æœç¢°åˆ°æ—¢æœ‰ prepareã€åˆæœ‰ commit çš„ redo logï¼Œå°±ç›´æ¥æäº¤ï¼›</p>\n</li>\n<li><p>å¦‚æœç¢°åˆ°åªæœ‰ parepareã€è€Œæ²¡æœ‰ commit çš„ redo logï¼Œå°±æ‹¿ç€ XID å» binlog æ‰¾å¯¹åº”çš„äº‹åŠ¡ã€‚</p>\n</li>\n</ul>\n<h3 id=\"MySQL-æ€ä¹ˆçŸ¥é“-binlog-æ˜¯å®Œæ•´çš„\"><a href=\"#MySQL-æ€ä¹ˆçŸ¥é“-binlog-æ˜¯å®Œæ•´çš„\" class=\"headerlink\" title=\"MySQL æ€ä¹ˆçŸ¥é“ binlog æ˜¯å®Œæ•´çš„?\"></a>MySQL æ€ä¹ˆçŸ¥é“ binlog æ˜¯å®Œæ•´çš„?</h3><ul>\n<li><p>statement æ ¼å¼çš„ binlogï¼Œå®Œæ•´çš„æ ‡è¯†æ˜¯æœ€åæœ‰ COMMIT å…³é”®å­—ã€‚</p>\n</li>\n<li><p>row æ ¼å¼çš„ binlogï¼Œå®Œæ•´çš„æ ‡è¯†æ˜¯æœ€åä¼šæœ‰ä¸€ä¸ª XID event å…³é”®å­—ã€‚</p>\n</li>\n</ul>\n<h3 id=\"MySQL-ä¸­å¯ä¸å¯ä»¥åªè¦-binlogï¼Œä¸è¦-redo-logï¼Ÿ\"><a href=\"#MySQL-ä¸­å¯ä¸å¯ä»¥åªè¦-binlogï¼Œä¸è¦-redo-logï¼Ÿ\" class=\"headerlink\" title=\"MySQL ä¸­å¯ä¸å¯ä»¥åªè¦ binlogï¼Œä¸è¦ redo logï¼Ÿ\"></a>MySQL ä¸­å¯ä¸å¯ä»¥åªè¦ binlogï¼Œä¸è¦ redo logï¼Ÿ</h3><p>ä¸å¯ä»¥ï¼Œbinlog æ²¡æœ‰å´©æºƒæ¢å¤çš„èƒ½åŠ›ã€‚</p>\n<h3 id=\"MySQL-ä¸­å¯ä¸å¯ä»¥åªè¦-redo-logï¼Œä¸è¦-binlogï¼Ÿ\"><a href=\"#MySQL-ä¸­å¯ä¸å¯ä»¥åªè¦-redo-logï¼Œä¸è¦-binlogï¼Ÿ\" class=\"headerlink\" title=\"MySQL ä¸­å¯ä¸å¯ä»¥åªè¦ redo logï¼Œä¸è¦ binlogï¼Ÿ\"></a>MySQL ä¸­å¯ä¸å¯ä»¥åªè¦ redo logï¼Œä¸è¦ binlogï¼Ÿ</h3><p>ä¸å¯ä»¥ï¼ŒåŸå› æœ‰ä»¥ä¸‹ä¸¤ä¸ªï¼š</p>\n<ul>\n<li><p>redo log æ˜¯å¾ªç¯å†™ä¸èƒ½ä¿è¯æ‰€æœ‰çš„å†å²æ•°æ®ï¼Œè¿™äº›å†å²æ•°æ®åªèƒ½åœ¨ binlog ä¸­æ‰¾åˆ°ï¼›</p>\n</li>\n<li><p>binlog æ˜¯é«˜å¯ç”¨çš„åŸºç¡€ï¼Œé«˜å¯ç”¨çš„å®ç°åŸç†å°±æ˜¯ binlog å¤åˆ¶ã€‚</p>\n</li>\n</ul>\n<h3 id=\"ä¸ºä»€ä¹ˆ-binlog-cache-æ˜¯æ¯ä¸ªçº¿ç¨‹è‡ªå·±ç»´æŠ¤çš„ï¼Œè€Œ-redo-log-buffer-æ˜¯å…¨å±€å…±ç”¨çš„ï¼Ÿ\"><a href=\"#ä¸ºä»€ä¹ˆ-binlog-cache-æ˜¯æ¯ä¸ªçº¿ç¨‹è‡ªå·±ç»´æŠ¤çš„ï¼Œè€Œ-redo-log-buffer-æ˜¯å…¨å±€å…±ç”¨çš„ï¼Ÿ\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆ binlog cache æ˜¯æ¯ä¸ªçº¿ç¨‹è‡ªå·±ç»´æŠ¤çš„ï¼Œè€Œ redo log buffer æ˜¯å…¨å±€å…±ç”¨çš„ï¼Ÿ\"></a>ä¸ºä»€ä¹ˆ binlog cache æ˜¯æ¯ä¸ªçº¿ç¨‹è‡ªå·±ç»´æŠ¤çš„ï¼Œè€Œ redo log buffer æ˜¯å…¨å±€å…±ç”¨çš„ï¼Ÿ</h3><p>å› ä¸º binlog æ˜¯ä¸èƒ½â€œè¢«æ‰“æ–­çš„â€ï¼Œä¸€ä¸ªäº‹åŠ¡çš„ binlog å¿…é¡»è¿ç»­å†™ï¼Œå› æ­¤è¦æ•´ä¸ªäº‹åŠ¡å®Œæˆåï¼Œå†ä¸€èµ·å†™åˆ°æ–‡ä»¶é‡Œã€‚è€Œ redo log å¹¶æ²¡æœ‰è¿™ä¸ªè¦æ±‚ï¼Œä¸­é—´æœ‰ç”Ÿæˆçš„æ—¥å¿—å¯ä»¥å†™åˆ° redo log buffer ä¸­ï¼Œredo log buffer ä¸­çš„å†…å®¹è¿˜èƒ½â€œæ­ä¾¿è½¦â€ï¼Œå…¶ä»–äº‹åŠ¡æäº¤çš„æ—¶å€™å¯ä»¥è¢«ä¸€èµ·å†™åˆ°ç£ç›˜ä¸­ã€‚</p>\n<h3 id=\"äº‹åŠ¡æ‰§è¡ŒæœŸé—´ï¼Œè¿˜æœªæäº¤ï¼Œå¦‚æœå‘ç”Ÿ-crashï¼Œredo-log-ä¸¢å¤±ï¼Œä¼šå¯¼è‡´ä¸»å¤‡ä¸ä¸€è‡´å‘¢ï¼Ÿ\"><a href=\"#äº‹åŠ¡æ‰§è¡ŒæœŸé—´ï¼Œè¿˜æœªæäº¤ï¼Œå¦‚æœå‘ç”Ÿ-crashï¼Œredo-log-ä¸¢å¤±ï¼Œä¼šå¯¼è‡´ä¸»å¤‡ä¸ä¸€è‡´å‘¢ï¼Ÿ\" class=\"headerlink\" title=\"äº‹åŠ¡æ‰§è¡ŒæœŸé—´ï¼Œè¿˜æœªæäº¤ï¼Œå¦‚æœå‘ç”Ÿ crashï¼Œredo log ä¸¢å¤±ï¼Œä¼šå¯¼è‡´ä¸»å¤‡ä¸ä¸€è‡´å‘¢ï¼Ÿ\"></a>äº‹åŠ¡æ‰§è¡ŒæœŸé—´ï¼Œè¿˜æœªæäº¤ï¼Œå¦‚æœå‘ç”Ÿ crashï¼Œredo log ä¸¢å¤±ï¼Œä¼šå¯¼è‡´ä¸»å¤‡ä¸ä¸€è‡´å‘¢ï¼Ÿ</h3><p>ä¸ä¼šï¼Œå› ä¸ºè¿™æ—¶å€™ binlog ä¹Ÿè¿˜åœ¨ binlog cache é‡Œï¼Œæ²¡å‘ç»™å¤‡åº“ï¼Œcrash ä»¥å redo log å’Œ binlog éƒ½æ²¡æœ‰äº†ï¼Œä»ä¸šåŠ¡è§’åº¦çœ‹è¿™ä¸ªäº‹åŠ¡ä¹Ÿæ²¡æœ‰æäº¤ï¼Œæ‰€ä»¥æ•°æ®æ˜¯ä¸€è‡´çš„ã€‚</p>\n<h3 id=\"åœ¨-MySQL-ä¸­ç”¨ä»€ä¹ˆæœºåˆ¶æ¥ä¼˜åŒ–éšæœºè¯»-x2F-å†™ç£ç›˜å¯¹-IO-çš„æ¶ˆè€—ï¼Ÿ\"><a href=\"#åœ¨-MySQL-ä¸­ç”¨ä»€ä¹ˆæœºåˆ¶æ¥ä¼˜åŒ–éšæœºè¯»-x2F-å†™ç£ç›˜å¯¹-IO-çš„æ¶ˆè€—ï¼Ÿ\" class=\"headerlink\" title=\"åœ¨ MySQL ä¸­ç”¨ä»€ä¹ˆæœºåˆ¶æ¥ä¼˜åŒ–éšæœºè¯»&#x2F;å†™ç£ç›˜å¯¹ IO çš„æ¶ˆè€—ï¼Ÿ\"></a>åœ¨ MySQL ä¸­ç”¨ä»€ä¹ˆæœºåˆ¶æ¥ä¼˜åŒ–éšæœºè¯»&#x2F;å†™ç£ç›˜å¯¹ IO çš„æ¶ˆè€—ï¼Ÿ</h3><p>redo log æ˜¯ç”¨æ¥èŠ‚çœéšæœºå†™ç£ç›˜çš„ IO æ¶ˆè€—ï¼Œè€Œ change buffer ä¸»è¦æ˜¯èŠ‚çœéšæœºè¯»ç£ç›˜çš„ IO æ¶ˆè€—ã€‚redo log ä¼šæŠŠ MySQL çš„æ›´æ–°æ“ä½œå…ˆè®°å½•åˆ°å†…å­˜ä¸­ï¼Œä¹‹åå†ç»Ÿä¸€æ›´æ–°åˆ°ç£ç›˜ï¼Œè€Œ change buffer ä¹Ÿæ˜¯æŠŠå…³é”®æŸ¥è¯¢æ•°æ®å…ˆåŠ è½½åˆ°å†…å­˜ä¸­ï¼Œä»¥ä¾¿ä¼˜åŒ– MySQL çš„æŸ¥è¯¢ã€‚</p>\n<h3 id=\"ä»¥ä¸‹è¯´æ³•é”™è¯¯çš„æ˜¯ï¼Ÿ\"><a href=\"#ä»¥ä¸‹è¯´æ³•é”™è¯¯çš„æ˜¯ï¼Ÿ\" class=\"headerlink\" title=\"ä»¥ä¸‹è¯´æ³•é”™è¯¯çš„æ˜¯ï¼Ÿ\"></a>ä»¥ä¸‹è¯´æ³•é”™è¯¯çš„æ˜¯ï¼Ÿ</h3><p>A.redo log æ˜¯ InnoDB å¼•æ“ç‰¹æœ‰çš„ï¼Œå®ƒçš„å›ºå®šå¤§å°çš„ B.redo log æ—¥å¿—æ˜¯ä¸å…¨çš„ï¼Œåªæœ‰æœ€æ–°çš„ä¸€äº›æ—¥å¿—ï¼Œè¿™å’Œå®ƒçš„å†…å­˜å¤§å°æœ‰å…³ C.redo log å¯ä»¥ä¿è¯æ•°æ®åº“å¼‚å¸¸é‡å¯ä¹‹åï¼Œæ•°æ®ä¸ä¸¢å¤± D.binlog æ˜¯ MySQL è‡ªå¸¦çš„æ—¥å¿—ï¼Œå®ƒèƒ½ä¿è¯æ•°æ®åº“å¼‚å¸¸é‡å¯ä¹‹åï¼Œæ•°æ®ä¸ä¸¢å¤± ç­”ï¼šD é¢˜ç›®è§£æï¼šbinlog æ˜¯ MySQL è‡ªå¸¦çš„æ—¥å¿—ï¼Œä½†å®ƒå¹¶ä¸èƒ½ä¿è¯æ•°æ®åº“å¼‚å¸¸é‡å¯ä¹‹åæ•°æ®ä¸ä¸¢å¤±ã€‚</p>\n<h3 id=\"ä»¥ä¸‹è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼Ÿ\"><a href=\"#ä»¥ä¸‹è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼Ÿ\" class=\"headerlink\" title=\"ä»¥ä¸‹è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼Ÿ\"></a>ä»¥ä¸‹è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼Ÿ</h3><p>A.redo log æ—¥å¿—æ˜¯è¿½åŠ å†™çš„ï¼Œåé¢çš„æ—¥å¿—å¹¶ä¸ä¼šè¦†ç›–å‰é¢çš„æ—¥å¿— B.binlog æ—¥å¿—æ˜¯è¿½åŠ å†™çš„ï¼Œåé¢çš„æ—¥å¿—å¹¶ä¸ä¼šè¦†ç›–å‰é¢çš„æ—¥å¿— C.redo log å’Œ binlog æ—¥å¿—éƒ½æ˜¯è¿½åŠ å†™çš„ï¼Œåé¢çš„æ—¥å¿—å¹¶ä¸ä¼šè¦†ç›–å‰é¢çš„æ—¥å¿— D.ä»¥ä¸Šè¯´æ³•éƒ½æ­£ç¡® ç­”ï¼šB é¢˜ç›®è§£æï¼šbinlog æ—¥å¿—æ˜¯è¿½åŠ å†™çš„ï¼Œåé¢çš„æ—¥å¿—å¹¶ä¸ä¼šè¦†ç›–å‰é¢çš„æ—¥å¿—ï¼Œredo log æ—¥å¿—æ˜¯å›ºå®šå¤§å°çš„ï¼Œåé¢çš„æ—¥å¿—ä¼šè¦†ç›–å‰é¢çš„æ—¥å¿—ã€‚</p>\n<h3 id=\"æœ‰æ²¡æœ‰åŠæ³•æŠŠ-MySQL-çš„æ•°æ®æ¢å¤åˆ°è¿‡å»æŸä¸ªæŒ‡å®šçš„æ—¶é—´èŠ‚ç‚¹ï¼Ÿæ€ä¹ˆæ¢å¤ï¼Ÿ\"><a href=\"#æœ‰æ²¡æœ‰åŠæ³•æŠŠ-MySQL-çš„æ•°æ®æ¢å¤åˆ°è¿‡å»æŸä¸ªæŒ‡å®šçš„æ—¶é—´èŠ‚ç‚¹ï¼Ÿæ€ä¹ˆæ¢å¤ï¼Ÿ\" class=\"headerlink\" title=\"æœ‰æ²¡æœ‰åŠæ³•æŠŠ MySQL çš„æ•°æ®æ¢å¤åˆ°è¿‡å»æŸä¸ªæŒ‡å®šçš„æ—¶é—´èŠ‚ç‚¹ï¼Ÿæ€ä¹ˆæ¢å¤ï¼Ÿ\"></a>æœ‰æ²¡æœ‰åŠæ³•æŠŠ MySQL çš„æ•°æ®æ¢å¤åˆ°è¿‡å»æŸä¸ªæŒ‡å®šçš„æ—¶é—´èŠ‚ç‚¹ï¼Ÿæ€ä¹ˆæ¢å¤ï¼Ÿ</h3><p>å¯ä»¥æ¢å¤ï¼Œåªè¦ä½ å¤‡ä»½äº†è¿™æ®µæ—¶é—´çš„æ‰€æœ‰ binlogï¼ŒåŒæ—¶åšäº†å…¨é‡æ•°æ®åº“çš„å®šæœŸå¤‡ä»½ï¼Œæ¯”å¦‚ï¼Œä¸€å¤©ä¸€å¤‡ï¼Œæˆ–è€…ä¸‰å¤©ä¸€å¤‡ï¼Œè¿™å–å†³äºä½ ä»¬çš„å¤‡ä»½ç­–ç•¥ï¼Œè¿™ä¸ªæ—¶å€™ä½ å°±å¯ä»¥æŠŠä¹‹å‰å¤‡ä»½çš„æ•°æ®åº“å…ˆè¿˜åŸåˆ°æµ‹è¯•åº“ï¼Œä»å¤‡ä»½çš„æ—¶é—´ç‚¹å¼€å§‹ï¼Œå°†å¤‡ä»½çš„ binlog ä¾æ¬¡å–å‡ºæ¥ï¼Œé‡æ”¾åˆ°ä½ è¦æ¢å¤æ•°æ®çš„é‚£ä¸ªæ—¶åˆ»ï¼Œè¿™ä¸ªæ—¶å€™å°±å®Œæˆäº†æ•°æ®åˆ°æŒ‡å®šèŠ‚ç‚¹çš„æ¢å¤ã€‚æ¯”å¦‚ï¼Œä»Šå¤©æ—©ä¸Š 9 ç‚¹çš„æ—¶å€™ï¼Œä½ æƒ³æŠŠæ•°æ®æ¢å¤æˆä»Šå¤©æ—©ä¸Š 6:00:00 çš„çŠ¶æ€ï¼Œè¿™ä¸ªæ—¶å€™ä½ å¯ä»¥å…ˆå–å‡ºä»Šå¤©å‡Œæ™¨ï¼ˆ00:01:59ï¼‰å¤‡ä»½çš„æ•°æ®åº“æ–‡ä»¶ï¼Œè¿˜åŸåˆ°æµ‹è¯•åº“ï¼Œå†ä» binlog æ–‡ä»¶ä¸­ä¾æ¬¡å–å‡º 00:01:59 ä¹‹åçš„æ“ä½œä¿¡æ¯ï¼Œé‡æ”¾åˆ° 6:00:00 è¿™ä¸ªæ—¶åˆ»ï¼Œè¿™å°±å®Œæˆäº†æ•°æ®åº“çš„è¿˜åŸã€‚</p>\n<h2 id=\"MySQLæ€§èƒ½ä¼˜åŒ–\"><a href=\"#MySQLæ€§èƒ½ä¼˜åŒ–\" class=\"headerlink\" title=\"MySQLæ€§èƒ½ä¼˜åŒ–\"></a>MySQLæ€§èƒ½ä¼˜åŒ–</h2><h3 id=\"MySQL-æ€§èƒ½æŒ‡æ ‡éƒ½æœ‰å“ªäº›ï¼Ÿå¦‚ä½•å¾—åˆ°è¿™äº›æŒ‡æ ‡ï¼Ÿ\"><a href=\"#MySQL-æ€§èƒ½æŒ‡æ ‡éƒ½æœ‰å“ªäº›ï¼Ÿå¦‚ä½•å¾—åˆ°è¿™äº›æŒ‡æ ‡ï¼Ÿ\" class=\"headerlink\" title=\"MySQL æ€§èƒ½æŒ‡æ ‡éƒ½æœ‰å“ªäº›ï¼Ÿå¦‚ä½•å¾—åˆ°è¿™äº›æŒ‡æ ‡ï¼Ÿ\"></a>MySQL æ€§èƒ½æŒ‡æ ‡éƒ½æœ‰å“ªäº›ï¼Ÿå¦‚ä½•å¾—åˆ°è¿™äº›æŒ‡æ ‡ï¼Ÿ</h3><p>MySQL çš„æ€§èƒ½æŒ‡æ ‡å¦‚ä¸‹ï¼š</p>\n<p><strong>â‘  TPSï¼ˆTransaction Per Secondï¼‰</strong> æ¯ç§’äº‹åŠ¡æ•°ï¼Œå³æ•°æ®åº“æ¯ç§’æ‰§è¡Œçš„äº‹åŠ¡æ•°ã€‚</p>\n<p>MySQL æœ¬èº«æ²¡æœ‰ç›´æ¥æä¾› TPS å‚æ•°å€¼ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦è·å¾— TPS çš„å€¼ï¼Œåªæœ‰æˆ‘ä»¬è‡ªå·±è®¡ç®—äº†ï¼Œå¯ä»¥æ ¹æ® MySQL æ•°æ®åº“æä¾›çš„çŠ¶æ€å˜é‡ï¼Œæ¥è®¡ç®— TPSã€‚</p>\n<p>éœ€è¦ä½¿ç”¨çš„å‚æ•°ï¼š</p>\n<ul>\n<li><p>Com_commit ï¼šè¡¨ç¤ºæäº¤æ¬¡æ•°ï¼Œé€šè¿‡å‘½ä»¤ <code>show global status like &#39;Com_commit&#39;;</code> è·å–ï¼›</p>\n</li>\n<li><p>Com_rollbackï¼šè¡¨ç¤ºå›æ»šæ¬¡æ•°ï¼Œé€šè¿‡å‘½ä»¤ <code>show global status like &#39;Com_rollback&#39;;</code> è·å–ã€‚</p>\n</li>\n</ul>\n<p>æˆ‘ä»¬å®šä¹‰ç¬¬ä¸€æ¬¡è·å–çš„ Com<em>commit çš„å€¼ä¸ Com</em>rollback å€¼çš„å’Œä¸º c_r1ï¼Œæ—¶é—´ä¸º t1ï¼›</p>\n<p>ç¬¬äºŒæ¬¡è·å–çš„ Com<em>commit çš„å€¼ä¸ Com</em>rollback å€¼çš„å’Œä¸º c<em>r2ï¼Œæ—¶é—´ä¸º t2ï¼Œt1 ä¸ t2 å•ä½ä¸ºç§’ã€‚ é‚£ä¹ˆ TPS &#x3D; ( c</em>r2 - c_r1 ) &#x2F; ( t2 - t1 ) ç®—å‡ºæ¥çš„å°±æ˜¯è¯¥ MySQL å®ä¾‹åœ¨ t1 ä¸ t2 ç”Ÿå‘½å‘¨æœŸä¹‹é—´çš„å¹³å‡ TPSã€‚</p>\n<p><strong>â‘¡ QPSï¼ˆQuery Per Secondï¼‰</strong> æ¯ç§’è¯·æ±‚æ¬¡æ•°ï¼Œä¹Ÿå°±æ˜¯æ•°æ®åº“æ¯ç§’æ‰§è¡Œçš„ SQL æ•°é‡ï¼ŒåŒ…å« INSERTã€SELECTã€UPDATEã€DELETE ç­‰ã€‚ QPS &#x3D; Queries &#x2F; Seconds Queries æ˜¯ç³»ç»ŸçŠ¶æ€å€¼â€”æ€»æŸ¥è¯¢æ¬¡æ•°ï¼Œå¯ä»¥é€šè¿‡ <code>show status like &#39;queries&#39;;</code> æŸ¥è¯¢å¾—å‡º </p>\n<p>Seconds æ˜¯ç›‘æ§çš„æ—¶é—´åŒºé—´ï¼Œå•ä½ä¸ºç§’ã€‚ æ¯”å¦‚ï¼Œé‡‡æ · 10 ç§’å†…çš„æŸ¥è¯¢æ¬¡æ•°ï¼Œé‚£ä¹ˆå…ˆæŸ¥è¯¢ä¸€æ¬¡ Queries å€¼ï¼ˆQ1ï¼‰ï¼Œç­‰å¾… 10 ç§’ï¼Œå†æŸ¥è¯¢ä¸€æ¬¡ Queries å€¼ï¼ˆQ2ï¼‰ï¼Œé‚£ä¹ˆ QPS å°±å¯ä»¥é€šè¿‡ï¼Œå¦‚ä¸‹å…¬å¼è·å¾—ï¼š</p>\n<blockquote>\n<p>QPS &#x3D; (Q2 - Q1) &#x2F; 10</p>\n</blockquote>\n<p><strong>â‘¢ IOPSï¼ˆInput&#x2F;Output Operations per Secondï¼‰</strong> æ¯ç§’å¤„ç†çš„ I&#x2F;O è¯·æ±‚æ¬¡æ•°ã€‚</p>\n<p>IOPS æ˜¯åˆ¤æ–­ç£ç›˜ I&#x2F;O èƒ½åŠ›çš„æŒ‡æ ‡ä¹‹ä¸€ï¼Œä¸€èˆ¬æ¥è®² IOPS æŒ‡æ ‡è¶Šé«˜ï¼Œé‚£ä¹ˆå•ä½æ—¶é—´å†…èƒ½å¤Ÿå“åº”çš„è¯·æ±‚è‡ªç„¶ä¹Ÿå°±è¶Šå¤šã€‚ç†è®ºä¸Šè®²ï¼Œåªè¦ç³»ç»Ÿå®é™…çš„è¯·æ±‚æ•°ä½äº IOPS çš„èƒ½åŠ›ï¼Œå°±ç›¸å½“äºæ¯ä¸€ä¸ªè¯·æ±‚éƒ½èƒ½å¾—åˆ°å³æ—¶å“åº”ï¼Œé‚£ä¹ˆ I&#x2F;O å°±ä¸ä¼šæ˜¯ç“¶é¢ˆäº†ã€‚</p>\n<p>æ³¨æ„ï¼šIOPS ä¸ç£ç›˜ååé‡ä¸ä¸€æ ·ï¼Œååé‡æ˜¯æŒ‡å•ä½æ—¶é—´å†…å¯ä»¥æˆåŠŸä¼ è¾“çš„æ•°æ®æ•°é‡ã€‚</p>\n<p>å¯ä»¥ä½¿ç”¨ iostat å‘½ä»¤ï¼ŒæŸ¥çœ‹ç£ç›˜çš„ IOPSï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>\n<blockquote>\n<p>yum install sysstat iostat -dx 1 10</p>\n</blockquote>\n<p>æ‰§è¡Œæ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š </p>\n<p>IOPS &#x3D; r&#x2F;s + w&#x2F;s å…¶ä¸­ï¼š</p>\n<ul>\n<li><p>r&#x2F;sï¼šä»£è¡¨æ¯ç§’è¯»äº†å¤šå°‘æ¬¡ï¼›</p>\n</li>\n<li><p>w&#x2F;sï¼šä»£è¡¨æ¯ç§’å†™äº†å¤šå°‘æ¬¡ã€‚</p>\n</li>\n</ul>\n<h3 id=\"ä»€ä¹ˆæ˜¯æ…¢æŸ¥è¯¢ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯æ…¢æŸ¥è¯¢ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯æ…¢æŸ¥è¯¢ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯æ…¢æŸ¥è¯¢ï¼Ÿ</h3><p>æ…¢æŸ¥è¯¢æ˜¯ MySQL ä¸­æä¾›çš„ä¸€ç§æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œå®ƒç”¨æ¥è®°å½•åœ¨ MySQL ä¸­å“åº”æ—¶é—´è¶…è¿‡é˜€å€¼çš„è¯­å¥ï¼Œå…·ä½“æŒ‡è¿è¡Œæ—¶é—´è¶…è¿‡ <em>longquerytime</em> å€¼çš„ SQLï¼Œåˆ™ä¼šè¢«è®°å½•åˆ°æ…¢æŸ¥è¯¢æ—¥å¿—ä¸­ã€‚ <em>longquerytime</em> çš„é»˜è®¤å€¼ä¸º 10ï¼Œæ„æ€æ˜¯è¿è¡Œ 10s ä»¥ä¸Šçš„è¯­å¥ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒMySQL æ•°æ®åº“å¹¶ä¸å¯åŠ¨æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œéœ€è¦æˆ‘ä»¬æ‰‹åŠ¨æ¥è®¾ç½®è¿™ä¸ªå‚æ•°ï¼Œå¦‚æœä¸æ˜¯è°ƒä¼˜éœ€è¦çš„è¯ï¼Œä¸€èˆ¬ä¸å»ºè®®å¯åŠ¨è¯¥å‚æ•°ï¼Œå› ä¸ºå¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ä¼šç»™ MySQL æœåŠ¡å™¨å¸¦æ¥ä¸€å®šçš„æ€§èƒ½å½±å“ã€‚æ…¢æŸ¥è¯¢æ—¥å¿—æ”¯æŒå°†æ—¥å¿—è®°å½•å†™å…¥æ–‡ä»¶ï¼Œä¹Ÿæ”¯æŒå°†æ—¥å¿—è®°å½•å†™å…¥æ•°æ®åº“è¡¨ã€‚</p>\n<p>ä½¿ç”¨ <code>mysql&gt; show variables like &#39;%slow_query_log%&#39;;</code> æ¥æŸ¥è¯¢æ…¢æŸ¥è¯¢æ—¥å¿—æ˜¯å¦å¼€å¯</p>\n<h3 id=\"å¦‚ä½•å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Ÿ\"><a href=\"#å¦‚ä½•å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Ÿ\"></a>å¦‚ä½•å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Ÿ</h3><p>å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹ MySQL å‘½ä»¤ï¼š</p>\n<blockquote>\n<p>mysql&gt; set global slow<em>query</em>log&#x3D;1</p>\n</blockquote>\n<p>ä¸è¿‡è¿™ç§è®¾ç½®æ–¹å¼ï¼Œåªå¯¹å½“å‰æ•°æ®åº“ç”Ÿæ•ˆï¼Œå¦‚æœ MySQL é‡å¯ä¹Ÿä¼šå¤±æ•ˆï¼Œå¦‚æœè¦æ°¸ä¹…ç”Ÿæ•ˆï¼Œå°±å¿…é¡»ä¿®æ”¹ MySQL çš„é…ç½®æ–‡ä»¶ my.cnfï¼Œé…ç½®å¦‚ä¸‹ï¼š</p>\n<blockquote>\n<p>slow<em>query</em>log &#x3D;1 slow<em>query</em>log<em>file&#x3D;&#x2F;tmp&#x2F;mysql</em>slow.log</p>\n</blockquote>\n<h3 id=\"å¦‚ä½•å®šä½æ…¢æŸ¥è¯¢ï¼Ÿ\"><a href=\"#å¦‚ä½•å®šä½æ…¢æŸ¥è¯¢ï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•å®šä½æ…¢æŸ¥è¯¢ï¼Ÿ\"></a>å¦‚ä½•å®šä½æ…¢æŸ¥è¯¢ï¼Ÿ</h3><p>ä½¿ç”¨ MySQL ä¸­çš„ explain åˆ†ææ‰§è¡Œè¯­å¥ï¼Œæ¯”å¦‚ï¼š</p>\n<blockquote>\n<p>explain select * from t where id&#x3D;5;</p>\n</blockquote>\n<p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes11474088-2ff861def7876a91.png\" alt=\"avatar\"> </p>\n<p>å…¶ä¸­ï¼š</p>\n<ul>\n<li><p>id â€” é€‰æ‹©æ ‡è¯†ç¬¦ã€‚id è¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜ï¼Œè¶Šå…ˆè¢«æ‰§è¡Œã€‚</p>\n</li>\n<li><p>select_type â€” è¡¨ç¤ºæŸ¥è¯¢çš„ç±»å‹ã€‚</p>\n</li>\n<li><p>table â€” è¾“å‡ºç»“æœé›†çš„è¡¨</p>\n</li>\n<li><p>partitions â€” åŒ¹é…çš„åˆ†åŒº</p>\n</li>\n<li><p>type â€” è¡¨ç¤ºè¡¨çš„è¿æ¥ç±»å‹</p>\n</li>\n<li><p>possible_keys â€” è¡¨ç¤ºæŸ¥è¯¢æ—¶ï¼Œå¯èƒ½ä½¿ç”¨çš„ç´¢å¼•</p>\n</li>\n<li><p>key â€” è¡¨ç¤ºå®é™…ä½¿ç”¨çš„ç´¢å¼•</p>\n</li>\n<li><p>key_len â€” ç´¢å¼•å­—æ®µçš„é•¿åº¦</p>\n</li>\n<li><p>refâ€” åˆ—ä¸ç´¢å¼•çš„æ¯”è¾ƒ</p>\n</li>\n<li><p>rows â€” å¤§æ¦‚ä¼°ç®—çš„è¡Œæ•°</p>\n</li>\n<li><p>filtered â€” æŒ‰è¡¨æ¡ä»¶è¿‡æ»¤çš„è¡Œç™¾åˆ†æ¯”</p>\n</li>\n<li><p>Extra â€” æ‰§è¡Œæƒ…å†µçš„æè¿°å’Œè¯´æ˜</p>\n</li>\n</ul>\n<p>å…¶ä¸­æœ€é‡è¦çš„å°±æ˜¯ type å­—æ®µï¼Œtype å€¼ç±»å‹å¦‚ä¸‹ï¼š</p>\n<ul>\n<li><p>all â€” æ‰«æå…¨è¡¨æ•°æ®</p>\n</li>\n<li><p>index â€” éå†ç´¢å¼•</p>\n</li>\n<li><p>range â€” ç´¢å¼•èŒƒå›´æŸ¥æ‰¾</p>\n</li>\n<li><p>index_subquery â€” åœ¨å­æŸ¥è¯¢ä¸­ä½¿ç”¨ ref</p>\n</li>\n<li><p>uniquesubquery â€” åœ¨å­æŸ¥è¯¢ä¸­ä½¿ç”¨ eq*ref</p>\n</li>\n<li><p>ref<em>or</em>null â€” å¯¹ null è¿›è¡Œç´¢å¼•çš„ä¼˜åŒ–çš„ ref</p>\n</li>\n<li><p>fulltext â€” ä½¿ç”¨å…¨æ–‡ç´¢å¼•</p>\n</li>\n<li><p>ref â€” ä½¿ç”¨éå”¯ä¸€ç´¢å¼•æŸ¥æ‰¾æ•°æ®</p>\n</li>\n<li><p>eq_ref â€” åœ¨ join æŸ¥è¯¢ä¸­ä½¿ç”¨ä¸»é”®æˆ–å”¯ä¸€ç´¢å¼•å…³è”</p>\n</li>\n<li><p>const â€” å°†ä¸€ä¸ªä¸»é”®æ”¾ç½®åˆ° where åé¢ä½œä¸ºæ¡ä»¶æŸ¥è¯¢ï¼Œ MySQL ä¼˜åŒ–å™¨å°±èƒ½æŠŠè¿™æ¬¡æŸ¥è¯¢ä¼˜åŒ–è½¬åŒ–ä¸ºä¸€ä¸ªå¸¸é‡ï¼Œå¦‚ä½•è½¬åŒ–ä»¥åŠä½•æ—¶è½¬åŒ–ï¼Œè¿™ä¸ªå–å†³äºä¼˜åŒ–å™¨ï¼Œè¿™ä¸ªæ¯” eq_ref æ•ˆç‡é«˜ä¸€ç‚¹</p>\n</li>\n</ul>\n<h3 id=\"â­MySQL-çš„ä¼˜åŒ–æ‰‹æ®µéƒ½æœ‰å“ªäº›ï¼Ÿ\"><a href=\"#â­MySQL-çš„ä¼˜åŒ–æ‰‹æ®µéƒ½æœ‰å“ªäº›ï¼Ÿ\" class=\"headerlink\" title=\"â­MySQL çš„ä¼˜åŒ–æ‰‹æ®µéƒ½æœ‰å“ªäº›ï¼Ÿ\"></a>â­MySQL çš„ä¼˜åŒ–æ‰‹æ®µéƒ½æœ‰å“ªäº›ï¼Ÿ</h3><p>MySQL çš„å¸¸è§çš„ä¼˜åŒ–æ‰‹æ®µæœ‰ä»¥ä¸‹äº”ç§ï¼š</p>\n<h4 id=\"â‘ -æŸ¥è¯¢ä¼˜åŒ–\"><a href=\"#â‘ -æŸ¥è¯¢ä¼˜åŒ–\" class=\"headerlink\" title=\"â‘  æŸ¥è¯¢ä¼˜åŒ–\"></a>â‘  æŸ¥è¯¢ä¼˜åŒ–</h4><ul>\n<li><p>é¿å… SELECT *ï¼ŒåªæŸ¥è¯¢éœ€è¦çš„å­—æ®µã€‚</p>\n</li>\n<li><p>å°è¡¨é©±åŠ¨å¤§è¡¨ï¼Œå³å°çš„æ•°æ®é›†é©±åŠ¨å¤§çš„æ•°æ®é›†ï¼Œæ¯”å¦‚ï¼Œå½“ B è¡¨çš„æ•°æ®é›†å°äº A è¡¨æ—¶ï¼Œç”¨ in ä¼˜åŒ– existï¼Œä¸¤è¡¨æ‰§è¡Œé¡ºåºæ˜¯å…ˆæŸ¥ B è¡¨ï¼Œå†æŸ¥ A è¡¨ï¼ŒæŸ¥è¯¢è¯­å¥ï¼šselect * from A where id in (select id from B) ã€‚</p>\n</li>\n<li><p>ä¸€äº›æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨è¿æ¥ä»£æ›¿å­æŸ¥è¯¢ï¼Œå› ä¸ºä½¿ç”¨ join æ—¶ï¼ŒMySQL ä¸ä¼šåœ¨å†…å­˜ä¸­åˆ›å»ºä¸´æ—¶è¡¨ã€‚</p>\n</li>\n</ul>\n<h4 id=\"â‘¡-ä¼˜åŒ–ç´¢å¼•çš„ä½¿ç”¨\"><a href=\"#â‘¡-ä¼˜åŒ–ç´¢å¼•çš„ä½¿ç”¨\" class=\"headerlink\" title=\"â‘¡ ä¼˜åŒ–ç´¢å¼•çš„ä½¿ç”¨\"></a>â‘¡ ä¼˜åŒ–ç´¢å¼•çš„ä½¿ç”¨</h4><ul>\n<li><p>å°½é‡ä½¿ç”¨ä¸»é”®æŸ¥è¯¢ï¼Œè€Œéå…¶ä»–ç´¢å¼•ï¼Œå› ä¸ºä¸»é”®æŸ¥è¯¢ä¸ä¼šè§¦å‘å›è¡¨æŸ¥è¯¢ã€‚</p>\n</li>\n<li><p>ä¸åšåˆ—è¿ç®—ï¼ŒæŠŠè®¡ç®—éƒ½æ”¾å…¥å„ä¸ªä¸šåŠ¡ç³»ç»Ÿå®ç°</p>\n</li>\n<li><p>æŸ¥è¯¢è¯­å¥å°½å¯èƒ½ç®€å•ï¼Œå¤§è¯­å¥æ‹†å°è¯­å¥ï¼Œå‡å°‘é”æ—¶é—´</p>\n</li>\n<li><p>ä¸ä½¿ç”¨ select * æŸ¥è¯¢</p>\n</li>\n<li><p>or æŸ¥è¯¢æ”¹å†™æˆ in æŸ¥è¯¢</p>\n</li>\n<li><p>ä¸ç”¨å‡½æ•°å’Œè§¦å‘å™¨</p>\n</li>\n<li><p>é¿å… %xx æŸ¥è¯¢</p>\n</li>\n<li><p>å°‘ç”¨ join æŸ¥è¯¢</p>\n</li>\n<li><p>ä½¿ç”¨åŒç±»å‹æ¯”è¾ƒï¼Œæ¯”å¦‚ â€˜123â€™ å’Œ â€˜123â€™ã€123 å’Œ 123</p>\n</li>\n<li><p>å°½é‡é¿å…åœ¨ where å­å¥ä¸­ä½¿ç”¨ !&#x3D; æˆ–è€… &lt;&gt; æ“ä½œç¬¦ï¼ŒæŸ¥è¯¢å¼•ç”¨ä¼šæ”¾å¼ƒç´¢å¼•è€Œè¿›è¡Œå…¨è¡¨æ‰«æ</p>\n</li>\n<li><p>é¿å…åœ¨ç´¢å¼•åˆ—ä¸Šä½¿ç”¨ is null å’Œ is not null</p>\n</li>\n<li><p>å°½é‡ä½¿ç”¨ä¸»é”®æŸ¥è¯¢</p>\n</li>\n<li><p>é¿å…åœ¨ where å­å¥ä¸­å¯¹å­—æ®µè¿›è¡Œè¡¨è¾¾å¼æ“ä½œ</p>\n</li>\n<li><p>å°½é‡ä½¿ç”¨æ•°å­—å‹å­—æ®µï¼Œè‹¥åªå«æ•°å€¼ä¿¡æ¯çš„å­—æ®µå°½é‡ä¸è¦è®¾è®¡ä¸ºå­—ç¬¦å‹</p>\n</li>\n</ul>\n<h4 id=\"â‘¢-è¡¨ç»“æ„è®¾è®¡ä¼˜åŒ–\"><a href=\"#â‘¢-è¡¨ç»“æ„è®¾è®¡ä¼˜åŒ–\" class=\"headerlink\" title=\"â‘¢ è¡¨ç»“æ„è®¾è®¡ä¼˜åŒ–\"></a>â‘¢ è¡¨ç»“æ„è®¾è®¡ä¼˜åŒ–</h4><ul>\n<li><p>ä½¿ç”¨å¯ä»¥å­˜ä¸‹æ•°æ®æœ€å°çš„æ•°æ®ç±»å‹ã€‚</p>\n</li>\n<li><p>ä½¿ç”¨ç®€å•çš„æ•°æ®ç±»å‹ï¼Œint è¦æ¯” varchar ç±»å‹åœ¨ MySQL å¤„ç†ç®€å•ã€‚</p>\n</li>\n<li><p>å°½é‡ä½¿ç”¨ tinyintã€smallintã€mediumint ä½œä¸ºæ•´æ•°ç±»å‹è€Œé intã€‚</p>\n</li>\n<li><p>å°½å¯èƒ½ä½¿ç”¨ not null å®šä¹‰å­—æ®µï¼Œå› ä¸º null å ç”¨ 4 å­—èŠ‚ç©ºé—´ã€‚</p>\n</li>\n<li><p>å°½é‡å°‘ç”¨ text ç±»å‹ï¼Œéç”¨ä¸å¯æ—¶æœ€å¥½è€ƒè™‘åˆ†è¡¨ã€‚</p>\n</li>\n<li><p>å°½é‡ä½¿ç”¨ timestampï¼Œè€Œé datetimeã€‚</p>\n</li>\n<li><p>å•è¡¨ä¸è¦æœ‰å¤ªå¤šå­—æ®µï¼Œå»ºè®®åœ¨ 20 ä¸ªå­—æ®µä»¥å†…ã€‚</p>\n</li>\n</ul>\n<h4 id=\"â‘£-è¡¨æ‹†åˆ†\"><a href=\"#â‘£-è¡¨æ‹†åˆ†\" class=\"headerlink\" title=\"â‘£ è¡¨æ‹†åˆ†\"></a>â‘£ è¡¨æ‹†åˆ†</h4><p>å½“æ•°æ®åº“ä¸­çš„æ•°æ®éå¸¸å¤§æ—¶ï¼ŒæŸ¥è¯¢ä¼˜åŒ–æ–¹æ¡ˆä¹Ÿä¸èƒ½è§£å†³æŸ¥è¯¢é€Ÿåº¦æ…¢çš„é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘æ‹†åˆ†è¡¨ï¼Œè®©æ¯å¼ è¡¨çš„æ•°æ®é‡å˜å°ï¼Œä»è€Œæé«˜æŸ¥è¯¢æ•ˆç‡ã€‚ </p>\n<p><strong>aï¼‰å‚ç›´æ‹†åˆ†</strong>ï¼šæ˜¯æŒ‡æ•°æ®è¡¨åˆ—çš„æ‹†åˆ†ï¼ŒæŠŠä¸€å¼ åˆ—æ¯”è¾ƒå¤šçš„è¡¨æ‹†åˆ†ä¸ºå¤šå¼ è¡¨ï¼Œæ¯”å¦‚ï¼Œç”¨æˆ·è¡¨ä¸­ä¸€äº›å­—æ®µç»å¸¸è¢«è®¿é—®ï¼Œå°†è¿™äº›å­—æ®µæ”¾åœ¨ä¸€å¼ è¡¨ä¸­ï¼Œå¦å¤–ä¸€äº›ä¸å¸¸ç”¨çš„å­—æ®µæ”¾åœ¨å¦ä¸€å¼ è¡¨ä¸­ï¼Œæ’å…¥æ•°æ®æ—¶ï¼Œä½¿ç”¨äº‹åŠ¡ç¡®ä¿ä¸¤å¼ è¡¨çš„æ•°æ®ä¸€è‡´æ€§ã€‚ å‚ç›´æ‹†åˆ†çš„åŸåˆ™ï¼š</p>\n<ul>\n<li><p>æŠŠä¸å¸¸ç”¨çš„å­—æ®µå•ç‹¬æ”¾åœ¨ä¸€å¼ è¡¨ï¼›</p>\n</li>\n<li><p>æŠŠ textï¼Œblob ç­‰å¤§å­—æ®µæ‹†åˆ†å‡ºæ¥æ”¾åœ¨é™„è¡¨ä¸­ï¼›</p>\n</li>\n<li><p>ç»å¸¸ç»„åˆæŸ¥è¯¢çš„åˆ—æ”¾åœ¨ä¸€å¼ è¡¨ä¸­ã€‚</p>\n</li>\n</ul>\n<p><strong>bï¼‰æ°´å¹³æ‹†åˆ†</strong>ï¼šæŒ‡æ•°æ®è¡¨è¡Œçš„æ‹†åˆ†ï¼Œè¡¨çš„è¡Œæ•°è¶…è¿‡ 200 ä¸‡è¡Œæ—¶ï¼Œå°±ä¼šå˜æ…¢ï¼Œè¿™æ—¶å¯ä»¥æŠŠä¸€å¼ çš„è¡¨çš„æ•°æ®æ‹†æˆå¤šå¼ è¡¨æ¥å­˜æ”¾ã€‚</p>\n<p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨å–æ¨¡çš„æ–¹å¼æ¥è¿›è¡Œè¡¨çš„æ‹†åˆ†ï¼Œæ¯”å¦‚ï¼Œä¸€å¼ æœ‰ 400W çš„ç”¨æˆ·è¡¨ usersï¼Œä¸ºæé«˜å…¶æŸ¥è¯¢æ•ˆç‡æˆ‘ä»¬æŠŠå…¶åˆ†æˆ 4 å¼ è¡¨ users1ï¼Œusers2ï¼Œusers3ï¼Œusers4ï¼Œç„¶åé€šè¿‡ç”¨æˆ· ID å–æ¨¡çš„æ–¹æ³•ï¼ŒåŒæ—¶æŸ¥è¯¢ã€æ›´æ–°ã€åˆ é™¤ä¹Ÿæ˜¯é€šè¿‡å–æ¨¡çš„æ–¹æ³•æ¥æ“ä½œã€‚</p>\n<h4 id=\"â‘¤-è¯»å†™åˆ†ç¦»\"><a href=\"#â‘¤-è¯»å†™åˆ†ç¦»\" class=\"headerlink\" title=\"â‘¤ è¯»å†™åˆ†ç¦»\"></a>â‘¤ è¯»å†™åˆ†ç¦»</h4><p>ä¸€èˆ¬æƒ…å†µä¸‹å¯¹æ•°æ®åº“è€Œè¨€éƒ½æ˜¯â€œè¯»å¤šå†™å°‘â€ï¼Œæ¢è¨€ä¹‹ï¼Œæ•°æ®åº“çš„å‹åŠ›å¤šæ•°æ˜¯å› ä¸ºå¤§é‡çš„è¯»å–æ•°æ®çš„æ“ä½œé€ æˆçš„ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨æ•°æ®åº“é›†ç¾¤çš„æ–¹æ¡ˆï¼Œä½¿ç”¨ä¸€ä¸ªåº“ä½œä¸ºä¸»åº“ï¼Œè´Ÿè´£å†™å…¥æ•°æ®ï¼›å…¶ä»–åº“ä¸ºä»åº“ï¼Œè´Ÿè´£è¯»å–æ•°æ®ã€‚è¿™æ ·å¯ä»¥ç¼“è§£å¯¹æ•°æ®åº“çš„è®¿é—®å‹åŠ›ã€‚</p>\n<h3 id=\"MySQL-å¸¸è§è¯»å†™åˆ†ç¦»æ–¹æ¡ˆæœ‰å“ªäº›ï¼Ÿ\"><a href=\"#MySQL-å¸¸è§è¯»å†™åˆ†ç¦»æ–¹æ¡ˆæœ‰å“ªäº›ï¼Ÿ\" class=\"headerlink\" title=\"MySQL å¸¸è§è¯»å†™åˆ†ç¦»æ–¹æ¡ˆæœ‰å“ªäº›ï¼Ÿ\"></a>MySQL å¸¸è§è¯»å†™åˆ†ç¦»æ–¹æ¡ˆæœ‰å“ªäº›ï¼Ÿ</h3><p>MySQL å¸¸è§çš„è¯»å†™åˆ†ç¦»æ–¹æ¡ˆï¼Œå¦‚ä¸‹åˆ—è¡¨ï¼š</p>\n<p><strong>1ï¼‰åº”ç”¨å±‚è§£å†³æ–¹æ¡ˆ</strong> å¯ä»¥é€šè¿‡åº”ç”¨å±‚å¯¹æ•°æ®æºåšè·¯ç”±æ¥å®ç°è¯»å†™åˆ†ç¦»ï¼Œæ¯”å¦‚ï¼Œä½¿ç”¨ SpringMVC + MyBatisï¼Œå¯ä»¥å°† SQL è·¯ç”±äº¤ç»™ Springï¼Œé€šè¿‡ AOP æˆ–è€… Annotation ç”±ä»£ç æ˜¾ç¤ºçš„æ§åˆ¶æ•°æ®æºã€‚ ä¼˜ç‚¹ï¼šè·¯ç”±ç­–ç•¥çš„æ‰©å±•æ€§å’Œå¯æ§æ€§è¾ƒå¼ºã€‚ ç¼ºç‚¹ï¼šéœ€è¦åœ¨ Spring ä¸­æ·»åŠ è€¦åˆæ§åˆ¶ä»£ç ã€‚</p>\n<p><strong>2ï¼‰ä¸­é—´ä»¶è§£å†³æ–¹æ¡ˆ</strong> é€šè¿‡ MySQL çš„ä¸­é—´ä»¶åšä¸»ä»é›†ç¾¤ï¼Œæ¯”å¦‚ï¼šMysql Proxyã€Amoebaã€Atlas ç­‰ä¸­é—´ä»¶éƒ½èƒ½ç¬¦åˆéœ€æ±‚ã€‚ ä¼˜ç‚¹ï¼šä¸åº”ç”¨å±‚è§£è€¦ã€‚ ç¼ºç‚¹ï¼šå¢åŠ ä¸€ä¸ªæœåŠ¡ç»´æŠ¤çš„é£é™©ç‚¹ï¼Œæ€§èƒ½åŠç¨³å®šæ€§å¾…æµ‹è¯•ï¼Œéœ€è¦æ”¯æŒä»£ç å¼ºåˆ¶ä¸»ä»å’Œäº‹åŠ¡ã€‚</p>\n<h3 id=\"æ€æ ·ä¿è¯ç¡®ä¿å¤‡åº“æ— å»¶è¿Ÿï¼Ÿ\"><a href=\"#æ€æ ·ä¿è¯ç¡®ä¿å¤‡åº“æ— å»¶è¿Ÿï¼Ÿ\" class=\"headerlink\" title=\"æ€æ ·ä¿è¯ç¡®ä¿å¤‡åº“æ— å»¶è¿Ÿï¼Ÿ\"></a>æ€æ ·ä¿è¯ç¡®ä¿å¤‡åº“æ— å»¶è¿Ÿï¼Ÿ</h3><p>é€šå¸¸ä¿è¯ä¸»å¤‡æ— å»¶è¿Ÿæœ‰ä»¥ä¸‹ä¸‰ç§æ–¹æ³•ï¼š</p>\n<ul>\n<li><p>æ¯æ¬¡ä»åº“æ‰§è¡ŒæŸ¥è¯¢è¯·æ±‚å‰ï¼Œå…ˆåˆ¤æ–­ seconds<em>behind</em>master æ˜¯å¦å·²ç»ç­‰äº 0ã€‚å¦‚æœè¿˜ä¸ç­‰äº 0 ï¼Œé‚£å°±å¿…é¡»ç­‰åˆ°è¿™ä¸ªå‚æ•°å˜ä¸º 0 æ‰èƒ½æ‰§è¡ŒæŸ¥è¯¢è¯·æ±‚ï¼Œseconds<em>behind</em>master å‚æ•°æ˜¯ç”¨æ¥è¡¡é‡ä¸»å¤‡å»¶è¿Ÿæ—¶é—´çš„é•¿çŸ­ï¼›</p>\n</li>\n<li><p>å¯¹æ¯”ä½ç‚¹ç¡®ä¿ä¸»å¤‡æ— å»¶è¿Ÿã€‚Master<em>Log</em>File å’Œ Read<em>Master</em>Log<em>Posï¼Œè¡¨ç¤ºçš„æ˜¯è¯»åˆ°çš„ä¸»åº“çš„æœ€æ–°ä½ç‚¹ï¼ŒRelay</em>Master<em>Log</em>File å’Œ Exec<em>Master</em>Log_Posï¼Œè¡¨ç¤ºçš„æ˜¯å¤‡åº“æ‰§è¡Œçš„æœ€æ–°ä½ç‚¹ï¼›</p>\n</li>\n<li><p>å¯¹æ¯” GTID é›†åˆç¡®ä¿ä¸»å¤‡æ— å»¶è¿Ÿã€‚Auto<em>Position&#x3D;1 ï¼Œè¡¨ç¤ºè¿™å¯¹ä¸»å¤‡å…³ç³»ä½¿ç”¨äº† GTID åè®®ï¼›Retrieved</em>Gtid<em>Setï¼Œæ˜¯å¤‡åº“æ”¶åˆ°çš„æ‰€æœ‰æ—¥å¿—çš„ GTID é›†åˆï¼›Executed</em>Gtid_Setï¼Œæ˜¯å¤‡åº“æ‰€æœ‰å·²ç»æ‰§è¡Œå®Œæˆçš„ GTID é›†åˆã€‚</p>\n</li>\n</ul>\n<h2 id=\"MySQLå¼€æ”¾é—®é¢˜\"><a href=\"#MySQLå¼€æ”¾é—®é¢˜\" class=\"headerlink\" title=\"MySQLå¼€æ”¾é—®é¢˜\"></a>MySQLå¼€æ”¾é—®é¢˜</h2><h3 id=\"æœ‰ä¸€ä¸ªè¶…çº§å¤§è¡¨ï¼Œå¦‚ä½•ä¼˜åŒ–åˆ†é¡µæŸ¥è¯¢ï¼Ÿ\"><a href=\"#æœ‰ä¸€ä¸ªè¶…çº§å¤§è¡¨ï¼Œå¦‚ä½•ä¼˜åŒ–åˆ†é¡µæŸ¥è¯¢ï¼Ÿ\" class=\"headerlink\" title=\"æœ‰ä¸€ä¸ªè¶…çº§å¤§è¡¨ï¼Œå¦‚ä½•ä¼˜åŒ–åˆ†é¡µæŸ¥è¯¢ï¼Ÿ\"></a>æœ‰ä¸€ä¸ªè¶…çº§å¤§è¡¨ï¼Œå¦‚ä½•ä¼˜åŒ–åˆ†é¡µæŸ¥è¯¢ï¼Ÿ</h3><p>è¶…çº§å¤§è¡¨çš„åˆ†é¡µä¼˜åŒ–åˆ†æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹å¼ï¼š</p>\n<ul>\n<li><p>æ•°æ®åº“å±‚é¢ä¼˜åŒ–ï¼šåˆ©ç”¨å­æŸ¥è¯¢ä¼˜åŒ–è¶…å¤šåˆ†é¡µåœºæ™¯ï¼Œæ¯”å¦‚ï¼š<code>SELECT a.* FROM è¡¨ 1 a, (select id from è¡¨ 1 where æ¡ä»¶ LIMIT 100000,20 ) b where a.id=b.id</code> ï¼Œå…ˆå¿«é€Ÿå®šä½éœ€è¦è·å–çš„ id æ®µï¼Œç„¶åå†å…³è”æŸ¥è¯¢ã€‚MySQL å¹¶ä¸æ˜¯è·³è¿‡ offset è¡Œï¼Œè€Œæ˜¯å– offset+N è¡Œï¼Œç„¶åè¿”å›æ”¾å¼ƒå‰ offset è¡Œï¼Œè¿”å› N è¡Œï¼Œé‚£å½“ offset ç‰¹åˆ«å¤§çš„æ—¶å€™ï¼Œæ•ˆç‡å°±éå¸¸çš„ä½ä¸‹ï¼Œè¦ä¹ˆæ§åˆ¶è¿”å›çš„æ€»é¡µæ•°ï¼Œè¦ä¹ˆå¯¹è¶…è¿‡ç‰¹å®šé˜ˆå€¼çš„é¡µæ•°è¿›è¡Œ SQL æ”¹å†™ï¼Œ<br><strong>åˆ©ç”¨å­æŸ¥è¯¢å…ˆå¿«é€Ÿå®šä½éœ€è¦è·å–çš„ id æ®µï¼Œç„¶åå†å…³è”æŸ¥è¯¢ï¼Œå°±æ˜¯å¯¹åˆ†é¡µè¿›è¡Œ SQL æ”¹å†™çš„å…·ä½“å®ç°</strong>ï¼›</p>\n</li>\n<li><p>ç¨‹åºå±‚é¢ä¼˜åŒ–ï¼šå¯ä»¥åˆ©ç”¨<strong>ç¼“å­˜</strong>æŠŠæŸ¥è¯¢çš„ç»“æœç¼“å­˜èµ·æ¥ï¼Œè¿™æ ·å†ä¸‹ä¸€æ¬¡æŸ¥è¯¢çš„æ—¶å€™æ€§èƒ½å°±éå¸¸é«˜äº†ã€‚</p>\n</li>\n</ul>\n<h3 id=\"â­æŸ¥è¯¢é•¿æ—¶é—´ä¸è¿”å›å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿåº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ\"><a href=\"#â­æŸ¥è¯¢é•¿æ—¶é—´ä¸è¿”å›å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿåº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ\" class=\"headerlink\" title=\"â­æŸ¥è¯¢é•¿æ—¶é—´ä¸è¿”å›å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿåº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ\"></a>â­æŸ¥è¯¢é•¿æ—¶é—´ä¸è¿”å›å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿåº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ</h3><p>æŸ¥è¯¢é€Ÿåº¦æ…¢çš„åŸå› å¾ˆå¤šï¼Œå¸¸è§å¦‚ä¸‹å‡ ç§ï¼š</p>\n<p> 1ï¼‰æŸ¥è¯¢å­—æ®µæ²¡æœ‰ç´¢å¼•æˆ–è€…æ²¡æœ‰è§¦å‘ç´¢å¼•æŸ¥è¯¢ï¼Œæ²¡æœ‰è§¦å‘ç´¢å¼•æŸ¥è¯¢çš„æƒ…å†µå¦‚ä¸‹ï¼š </p>\n<ul>\n<li><p>ä»¥ % å¼€å¤´çš„ like æŸ¥è¯¢</p>\n</li>\n<li><p>æ•°æ®ç±»å‹å‡ºç°éšå¼è½¬æ¢æ—¶ä¸ä¼šä½¿ç”¨ç´¢å¼•</p>\n</li>\n<li><p>ä¸ç¬¦åˆæœ€å·¦å‰ç¼€åŸåˆ™ï¼›</p>\n</li>\n<li><p>å¦‚æœæŸ¥è¯¢æ¡ä»¶æœ‰ or åˆ†å‰²ï¼Œå¦‚æœæœ‰ or çš„å­—æ®µæ²¡æœ‰ç´¢å¼•ï¼Œä¼šå¼•èµ·å…¨è¡¨æŸ¥è¯¢ï¼›</p>\n</li>\n<li><p>å¦‚æœ MySQL è®¤ä¸ºä½¿ç”¨ç´¢å¼•ä¼šæ¯”å…¨è¡¨æŸ¥è¯¢æ›´æ…¢ï¼Œåˆ™ä¸ä¼šä½¿ç”¨ç´¢å¼•ã€‚</p>\n</li>\n</ul>\n<p>2ï¼‰I&#x2F;O å‹åŠ›å¤§ï¼Œè¯»å–ç£ç›˜é€Ÿåº¦å˜æ…¢ï¼Œdf çœ‹ç¡¬ç›˜</p>\n<p>3ï¼‰å†…å­˜ä¸è¶³ï¼Œfree çœ‹å†…å­˜ï¼ˆtop çœ‹ cpuï¼‰</p>\n<p>4ï¼‰ç½‘ç»œé€Ÿåº¦æ…¢ </p>\n<p>5ï¼‰æŸ¥è¯¢å‡ºçš„æ•°æ®é‡è¿‡å¤§ï¼Œå¯ä»¥é‡‡ç”¨å¤šæ¬¡æŸ¥è¯¢æˆ–å…¶ä»–çš„æ–¹æ³•é™ä½æ•°æ®é‡ </p>\n<p>6ï¼‰æ­»é”ï¼Œä¸€èˆ¬ç¢°åˆ°è¿™ç§æƒ…å†µçš„è¯ï¼Œå¤§æ¦‚ç‡æ˜¯è¡¨è¢«é”ä½äº†ï¼Œå¯ä»¥ä½¿ç”¨ <code>show processlist;</code> å‘½ä»¤ï¼Œçœ‹çœ‹ SQL è¯­å¥çš„çŠ¶æ€ï¼Œå†é’ˆå¯¹ä¸åŒçš„çŠ¶æ€åšç›¸åº”çš„å¤„ç†ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes11474088-1a918d44eacc26e6.png\" alt=\"avatar\"> </p>\n<p>å…¶ä¸­ï¼Œå½“ State åˆ—å€¼ä¸º Locked æ—¶ï¼Œè¡¨ç¤ºè¢«é”å®šã€‚</p>\n<p>ä»¥ä¸Šé—®é¢˜çš„è§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š</p>\n<p>1ï¼‰æ­£ç¡®åˆ›å»ºå’Œä½¿ç”¨ç´¢å¼•ã€‚ </p>\n<p>2ï¼‰æŠŠæ•°æ®ã€æ—¥å¿—ã€ç´¢å¼•æ”¾åˆ°ä¸åŒçš„ IO è®¾å¤‡ä¸Šï¼Œå‡å°‘ä¸»æ•°æ®åº“çš„ IO æ“ä½œã€‚æ›´æ¢ MySQL çš„ç£ç›˜ä¸ºå›ºæ€ç¡¬ç›˜ï¼Œä»¥æé«˜ç£ç›˜çš„ IO æ€§èƒ½ã€‚ </p>\n<p>3ï¼‰å‡çº§å†…å­˜ï¼Œæ›´æ¢æ›´å¤§çš„å†…å­˜ã€‚ </p>\n<p>4ï¼‰æå‡ç½‘é€Ÿï¼Œå‡çº§å¸¦å®½ã€‚ </p>\n<p>5ï¼‰ç”¨ Profiler æ¥è·Ÿè¸ªæŸ¥è¯¢ï¼Œå¾—åˆ°æŸ¥è¯¢æ‰€éœ€çš„æ—¶é—´ï¼Œæ‰¾å‡ºæœ‰é—®é¢˜çš„ SQL è¯­å¥ï¼Œä¼˜åŒ– SQLã€‚ </p>\n<p>6ï¼‰æŸ¥è¯¢æ—¶å€¼è¿”å›éœ€è¦çš„å­—æ®µã€‚ </p>\n<p>7ï¼‰è®¾ç½®æ­»é”çš„è¶…æ—¶æ—¶é—´ï¼Œé™åˆ¶å’Œé¿å…æ­»é”æ¶ˆè€—è¿‡å¤šæœåŠ¡å™¨çš„èµ„æºã€‚ 8ï¼‰å°½é‡å°‘ç”¨è§†å›¾ï¼Œå®ƒçš„æ•ˆç‡ä½ï¼Œå¯¹è§†å›¾æ“ä½œæ¯”ç›´æ¥å¯¹è¡¨æ“ä½œæ…¢,å¯ä»¥ç”¨å­˜å‚¨è¿‡ç¨‹æ¥ä»£æ›¿è§†å›¾ã€‚ä¸è¦ç”¨è§†å›¾åµŒå¥—ï¼ŒåµŒå¥—è§†å›¾å¢åŠ äº†å¯»æ‰¾åŸå§‹æ•°æ®çš„éš¾åº¦ã€‚</p>\n<h3 id=\"MySQL-ä¸»ä»å»¶è¿Ÿçš„åŸå› æœ‰å“ªäº›ï¼Ÿ\"><a href=\"#MySQL-ä¸»ä»å»¶è¿Ÿçš„åŸå› æœ‰å“ªäº›ï¼Ÿ\" class=\"headerlink\" title=\"MySQL ä¸»ä»å»¶è¿Ÿçš„åŸå› æœ‰å“ªäº›ï¼Ÿ\"></a>MySQL ä¸»ä»å»¶è¿Ÿçš„åŸå› æœ‰å“ªäº›ï¼Ÿ</h3><p>ä¸»ä»å»¶è¿Ÿå¯ä»¥æ ¹æ® MySQL æä¾›çš„å‘½ä»¤åˆ¤æ–­ï¼Œæ¯”å¦‚ï¼Œåœ¨ä»æœåŠ¡å™¨ä½¿ç”¨å‘½ä»¤ï¼š <code>show slave status;</code>ï¼Œå…¶ä¸­ Seconds<em>Behind</em>Master å¦‚æœä¸º 0 è¡¨ç¤ºä¸»ä»å¤åˆ¶çŠ¶æ€æ­£å¸¸ã€‚ å¯¼è‡´ä¸»ä»å»¶è¿Ÿçš„åŸå› æœ‰ä»¥ä¸‹å‡ ä¸ªï¼š</p>\n<ul>\n<li><p>ä¸»åº“æœ‰å¤§äº‹åŠ¡å¤„ç†ï¼›</p>\n</li>\n<li><p>ä¸»åº“åšå¤§é‡çš„å¢ã€åˆ ã€æ”¹æ“ä½œï¼›</p>\n</li>\n<li><p>ä¸»åº“å¯¹å¤§è¡¨è¿›è¡Œå­—æ®µæ–°å¢ã€ä¿®æ”¹æˆ–æ·»åŠ ç´¢å¼•ç­‰æ“ä½œï¼›</p>\n</li>\n<li><p>ä¸»åº“çš„ä»åº“å¤ªå¤šï¼Œå¯¼è‡´å¤åˆ¶å»¶è¿Ÿã€‚ä»åº“æ•°é‡ä¸€èˆ¬ 3-5 ä¸ªä¸ºå®œï¼Œè¦å¤åˆ¶çš„èŠ‚ç‚¹è¿‡å¤šï¼Œå¯¼è‡´å¤åˆ¶å»¶è¿Ÿï¼›</p>\n</li>\n<li><p>ä»åº“ç¡¬ä»¶é…ç½®æ¯”ä¸»åº“å·®ï¼Œå¯¼è‡´å»¶è¿Ÿã€‚æŸ¥çœ‹ Master å’Œ Slave çš„é…ç½®ï¼Œå¯èƒ½å› ä¸ºä»åº“çš„é…ç½®è¿‡ä½ï¼Œæ‰§è¡Œæ—¶é—´é•¿ï¼Œç”±æ­¤å¯¼è‡´çš„å¤åˆ¶å»¶è¿Ÿæ—¶é—´é•¿ï¼›</p>\n</li>\n<li><p>ä¸»åº“è¯»å†™å‹åŠ›å¤§ï¼Œå¯¼è‡´å¤åˆ¶å»¶è¿Ÿï¼›</p>\n</li>\n<li><p>ä»åº“ä¹‹é—´çš„ç½‘ç»œå»¶è¿Ÿã€‚ä¸»ä»åº“ç½‘å¡ã€ç½‘çº¿ã€è¿æ¥çš„äº¤æ¢æœºç­‰ç½‘ç»œè®¾å¤‡éƒ½å¯èƒ½æˆä¸ºå¤åˆ¶çš„ç“¶é¢ˆï¼Œå¯¼è‡´å¤åˆ¶å»¶è¿Ÿï¼Œå¦å¤–è·¨å…¬ç½‘ä¸»ä»å¤åˆ¶å¾ˆå®¹æ˜“å¯¼è‡´ä¸»ä»å¤åˆ¶å»¶è¿Ÿã€‚</p>\n</li>\n</ul>\n<h3 id=\"å¦‚ä½•ä¿è¯æ•°æ®ä¸è¢«è¯¯åˆ ï¼Ÿ\"><a href=\"#å¦‚ä½•ä¿è¯æ•°æ®ä¸è¢«è¯¯åˆ ï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•ä¿è¯æ•°æ®ä¸è¢«è¯¯åˆ ï¼Ÿ\"></a>å¦‚ä½•ä¿è¯æ•°æ®ä¸è¢«è¯¯åˆ ï¼Ÿ</h3><p>ä¿è¯æ•°æ®ä¸è¢«è¯¯åˆ çš„æ–¹æ³•å¦‚ä¸‹åˆ—è¡¨ï¼š</p>\n<ul>\n<li><p>æƒé™æ§åˆ¶ä¸åˆ†é…ï¼ˆæ•°æ®åº“å’ŒæœåŠ¡å™¨æƒé™ï¼‰</p>\n</li>\n<li><p>é¿å…æ•°æ®åº“è´¦å·ä¿¡æ¯æ³„éœ²ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä¸šåŠ¡ä»£ç ä¸è¦ä½¿ç”¨æ˜æ–‡ä¿å­˜æ•°æ®åº“è¿æ¥ä¿¡æ¯ï¼›</p>\n</li>\n<li><p>é‡è¦çš„æ•°æ®åº“æ“ä½œï¼Œé€šè¿‡å¹³å°å‹å·¥å…·è‡ªåŠ¨å®æ–½ï¼Œå‡å°‘äººå·¥æ“ä½œï¼›</p>\n</li>\n<li><p>éƒ¨ç½²å»¶è¿Ÿå¤åˆ¶ä»åº“ï¼Œä¸‡ä¸€è¯¯åˆ é™¤æ—¶ç”¨äºæ•°æ®å›æ¡£ï¼Œä¸”ä»åº“è®¾ç½®ä¸º read-onlyï¼›</p>\n</li>\n<li><p>ç¡®è®¤å¤‡ä»½åˆ¶åº¦åŠæ—¶æœ‰æ•ˆï¼›</p>\n</li>\n<li><p>å¯ç”¨ SQL å®¡è®¡åŠŸèƒ½ï¼Œå…»æˆè‰¯å¥½ SQL ä¹ æƒ¯ï¼›</p>\n</li>\n<li><p>å¯ç”¨ sql<em>safe</em>updates é€‰é¡¹ï¼Œä¸å…è®¸æ²¡ where æ¡ä»¶çš„æ›´æ–°&#x2F;åˆ é™¤ï¼›</p>\n</li>\n<li><p>å°†ç³»ç»Ÿå±‚çš„ rm æ”¹ä¸º mvï¼›</p>\n</li>\n<li><p>çº¿ä¸Šä¸è¿›è¡Œç‰©ç†åˆ é™¤ï¼Œæ”¹ä¸ºé€»è¾‘åˆ é™¤ï¼ˆå°† row data æ ‡è®°ä¸ºä¸å¯ç”¨ï¼‰ï¼›</p>\n</li>\n<li><p>å¯ç”¨å ¡å’æœºï¼Œå±è”½é«˜å± SQLï¼›</p>\n</li>\n<li><p>é™ä½æ•°æ®åº“ä¸­æ™®é€šè´¦å·çš„æƒé™çº§åˆ«ï¼›</p>\n</li>\n<li><p>å¼€å¯ binlogï¼Œæ–¹ä¾¿è¿½æº¯æ•°æ®ã€‚</p>\n</li>\n</ul>\n<h3 id=\"â­MySQL-æœåŠ¡å™¨-CPU-é£™å‡åº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ\"><a href=\"#â­MySQL-æœåŠ¡å™¨-CPU-é£™å‡åº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ\" class=\"headerlink\" title=\"â­MySQL æœåŠ¡å™¨ CPU é£™å‡åº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ\"></a>â­MySQL æœåŠ¡å™¨ CPU é£™å‡åº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ</h3><p>ä½¿ç”¨ <code>show full processlist;</code> æŸ¥å‡ºæ…¢æŸ¥è¯¢ï¼Œä¸ºäº†ç¼“è§£æ•°æ®åº“æœåŠ¡å™¨å‹åŠ›ï¼Œå…ˆä½¿ç”¨ kill å‘½ä»¤æ€æ‰æ…¢æŸ¥è¯¢çš„å®¢æˆ·ç«¯ï¼Œç„¶åå†å»é¡¹ç›®ä¸­æ‰¾åˆ°æ‰§è¡Œæ…¢çš„ SQL è¯­å¥è¿›è¡Œä¿®æ”¹å’Œä¼˜åŒ–ã€‚</p>\n<h3 id=\"MySQL-æ¯«æ— è§„å¾‹çš„å¼‚å¸¸é‡å¯ï¼Œå¯èƒ½äº§ç”Ÿçš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿè¯¥å¦‚ä½•è§£å†³ï¼Ÿ\"><a href=\"#MySQL-æ¯«æ— è§„å¾‹çš„å¼‚å¸¸é‡å¯ï¼Œå¯èƒ½äº§ç”Ÿçš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿè¯¥å¦‚ä½•è§£å†³ï¼Ÿ\" class=\"headerlink\" title=\"MySQL æ¯«æ— è§„å¾‹çš„å¼‚å¸¸é‡å¯ï¼Œå¯èƒ½äº§ç”Ÿçš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿè¯¥å¦‚ä½•è§£å†³ï¼Ÿ\"></a>MySQL æ¯«æ— è§„å¾‹çš„å¼‚å¸¸é‡å¯ï¼Œå¯èƒ½äº§ç”Ÿçš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿè¯¥å¦‚ä½•è§£å†³ï¼Ÿ</h3><p>å¯èƒ½æ˜¯ç§¯ç´¯çš„é•¿è¿æ¥å¯¼è‡´å†…å­˜å ç”¨å¤ªå¤šï¼Œè¢«ç³»ç»Ÿå¼ºè¡Œæ€æ‰å¯¼è‡´çš„å¼‚å¸¸é‡å¯ï¼Œå› ä¸ºåœ¨ MySQL ä¸­é•¿è¿æ¥åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä½¿ç”¨çš„ä¸´æ—¶å†…å­˜å¯¹è±¡ï¼Œåªæœ‰åœ¨è¿æ¥æ–­å¼€çš„æ—¶å€™æ‰ä¼šé‡Šæ”¾ï¼Œè¿™å°±ä¼šå¯¼è‡´å†…å­˜ä¸æ–­é£™å‡ï¼Œè§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š</p>\n<ul>\n<li><p>å®šæœŸæ–­å¼€ç©ºé—²çš„é•¿è¿æ¥ï¼›</p>\n</li>\n<li><p>å¦‚æœæ˜¯ç”¨çš„æ˜¯ MySQL 5.7 ä»¥ä¸Šçš„ç‰ˆæœ¬ï¼Œå¯ä»¥å®šæœŸæ‰§è¡Œ mysql<em>reset</em>connection é‡æ–°åˆå§‹åŒ–è¿æ¥èµ„æºï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šé‡Šæ”¾ä¹‹å‰ä½¿ç”¨çš„å†…å­˜èµ„æºï¼Œæ¢å¤åˆ°è¿æ¥åˆšåˆå§‹åŒ–çš„çŠ¶æ€ã€‚</p>\n</li>\n</ul>\n<h3 id=\"å¦‚ä½•å®ç°ä¸€ä¸ªé«˜å¹¶å‘çš„ç³»ç»Ÿï¼Ÿ\"><a href=\"#å¦‚ä½•å®ç°ä¸€ä¸ªé«˜å¹¶å‘çš„ç³»ç»Ÿï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•å®ç°ä¸€ä¸ªé«˜å¹¶å‘çš„ç³»ç»Ÿï¼Ÿ\"></a>å¦‚ä½•å®ç°ä¸€ä¸ªé«˜å¹¶å‘çš„ç³»ç»Ÿï¼Ÿ</h3><p>è¿™é“é¢è¯•é¢˜æ¶‰åŠçš„çŸ¥è¯†ç‚¹æ¯”è¾ƒå¤šï¼Œä¸»è¦è€ƒå¯Ÿçš„æ˜¯é¢è¯•è€…çš„ç»¼åˆæŠ€æœ¯èƒ½åŠ›ã€‚é«˜å¹¶å‘ç³»ç»Ÿçš„è®¾è®¡æ‰‹æ®µæœ‰å¾ˆå¤šï¼Œä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹äº”ä¸ªæ–¹é¢ã€‚</p>\n<h4 id=\"1ï¼‰å‰ç«¯ä¼˜åŒ–\"><a href=\"#1ï¼‰å‰ç«¯ä¼˜åŒ–\" class=\"headerlink\" title=\"1ï¼‰å‰ç«¯ä¼˜åŒ–\"></a>1ï¼‰å‰ç«¯ä¼˜åŒ–</h4><p>â‘  é™æ€èµ„æºç¼“å­˜ï¼šå°†æ´»åŠ¨é¡µé¢ä¸Šçš„æ‰€æœ‰å¯ä»¥é™æ€çš„å…ƒç´ å…¨éƒ¨é™æ€åŒ–ï¼Œå°½é‡å‡å°‘åŠ¨æ€å…ƒç´ ï¼›é€šè¿‡ CDNã€æµè§ˆå™¨ç¼“å­˜ï¼Œæ¥å‡å°‘å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯çš„æ•°æ®è¯·æ±‚ã€‚<br>â‘¡ ç¦æ­¢é‡å¤æäº¤ï¼šç”¨æˆ·æäº¤ä¹‹åæŒ‰é’®ç½®ç°ï¼Œç¦æ­¢é‡å¤æäº¤ã€‚<br>â‘¢ ç”¨æˆ·é™æµï¼šåœ¨æŸä¸€æ—¶é—´æ®µå†…åªå…è®¸ç”¨æˆ·æäº¤ä¸€æ¬¡è¯·æ±‚ï¼Œæ¯”å¦‚ï¼Œé‡‡å– IP é™æµã€‚</p>\n<h4 id=\"2ï¼‰ä¸­é—´å±‚è´Ÿè½½åˆ†å‘\"><a href=\"#2ï¼‰ä¸­é—´å±‚è´Ÿè½½åˆ†å‘\" class=\"headerlink\" title=\"2ï¼‰ä¸­é—´å±‚è´Ÿè½½åˆ†å‘\"></a>2ï¼‰ä¸­é—´å±‚è´Ÿè½½åˆ†å‘</h4><p>å¯åˆ©ç”¨è´Ÿè½½å‡è¡¡ï¼Œæ¯”å¦‚ nginx ç­‰å·¥å…·ï¼Œå¯ä»¥å°†å¹¶å‘è¯·æ±‚åˆ†é…åˆ°ä¸åŒçš„æœåŠ¡å™¨ï¼Œä»è€Œæé«˜äº†ç³»ç»Ÿå¤„ç†å¹¶å‘çš„èƒ½åŠ›ã€‚ nginx è´Ÿè½½åˆ†å‘çš„äº”ç§æ–¹å¼ï¼š</p>\n<p>â‘  è½®è¯¢ï¼ˆé»˜è®¤ï¼‰ æ¯ä¸ªè¯·æ±‚æŒ‰æ—¶é—´é¡ºåºé€ä¸€åˆ†é…åˆ°ä¸åŒçš„åç«¯æœåŠ¡å™¨ï¼Œå¦‚æœåç«¯æœåŠ¡å™¨ä¸èƒ½æ­£å¸¸å“åº”ï¼Œnginx èƒ½è‡ªåŠ¨å‰”é™¤æ•…éšœæœåŠ¡å™¨ã€‚ â‘¡ æŒ‰æƒé‡ï¼ˆweightï¼‰ ä½¿ç”¨ weight å‚æ•°ï¼ŒæŒ‡å®šè½®è¯¢å‡ ç‡ï¼Œweight å’Œè®¿é—®æ¯”ç‡æˆæ­£æ¯”ï¼Œç”¨äºåç«¯æœåŠ¡å™¨æ€§èƒ½ä¸å‡çš„æƒ…å†µï¼Œé…ç½®å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">upstream backend &#123; </span><br><span class=\"line\">    server 192.168.0.14 weight=10; </span><br><span class=\"line\">    server 192.168.0.15 weight=10; </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>â‘¢ IP å“ˆå¸Œå€¼ï¼ˆip_hashï¼‰ æ¯ä¸ªè¯·æ±‚æŒ‰è®¿é—® IP çš„å“ˆå¸Œå€¼åˆ†é…ï¼Œè¿™æ ·æ¯ä¸ªè®¿å®¢å›ºå®šè®¿é—®ä¸€ä¸ªåç«¯æœåŠ¡å™¨ï¼Œå¯ä»¥è§£å†³ session å…±äº«çš„é—®é¢˜ï¼Œé…ç½®å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">upstream backend &#123; </span><br><span class=\"line\">    ip_hash; </span><br><span class=\"line\">    server 192.168.0.14:88; </span><br><span class=\"line\">    server 192.168.0.15:80; </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>â‘£ å“åº”æ—¶é—´ï¼ˆfairï¼‰ æŒ‰åç«¯æœåŠ¡å™¨çš„å“åº”æ—¶é—´æ¥åˆ†é…è¯·æ±‚ï¼Œå“åº”æ—¶é—´çŸ­çš„ä¼˜å…ˆåˆ†é…ï¼Œé…ç½®å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">upstream backend &#123; </span><br><span class=\"line\">    fair; </span><br><span class=\"line\">    server server1.com; </span><br><span class=\"line\">    server server2.com; </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>â‘¤ URL å“ˆå¸Œå€¼ï¼ˆurl_hashï¼‰ æŒ‰è®¿é—® url çš„ hash ç»“æœæ¥åˆ†é…è¯·æ±‚ï¼Œå’Œ IP å“ˆå¸Œå€¼ç±»ä¼¼ã€‚</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">upstream backend &#123;</span><br><span class=\"line\">    hash $request_uri;</span><br><span class=\"line\">    server server1.com; </span><br><span class=\"line\">    server server2.com;   </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"3ï¼‰æ§åˆ¶å±‚ï¼ˆç½‘å…³å±‚ï¼‰\"><a href=\"#3ï¼‰æ§åˆ¶å±‚ï¼ˆç½‘å…³å±‚ï¼‰\" class=\"headerlink\" title=\"3ï¼‰æ§åˆ¶å±‚ï¼ˆç½‘å…³å±‚ï¼‰\"></a>3ï¼‰æ§åˆ¶å±‚ï¼ˆç½‘å…³å±‚ï¼‰</h4><p>é™åˆ¶åŒä¸€ä¸ªç”¨æˆ·çš„è®¿é—®é¢‘ç‡ï¼Œé™åˆ¶è®¿é—®æ¬¡æ•°ï¼Œé˜²æ­¢å¤šæ¬¡æ¶æ„è¯·æ±‚ã€‚</p>\n<h4 id=\"4ï¼‰æœåŠ¡å±‚\"><a href=\"#4ï¼‰æœåŠ¡å±‚\" class=\"headerlink\" title=\"4ï¼‰æœåŠ¡å±‚\"></a>4ï¼‰æœåŠ¡å±‚</h4><p>â‘  ä¸šåŠ¡æœåŠ¡å™¨åˆ†ç¦»ï¼šæ¯”å¦‚ï¼Œå°†ç§’æ€ä¸šåŠ¡ç³»ç»Ÿå’Œå…¶ä»–ä¸šåŠ¡åˆ†ç¦»ï¼Œå•ç‹¬æ”¾åœ¨é«˜é…æœåŠ¡å™¨ä¸Šï¼Œå¯ä»¥é›†ä¸­èµ„æºå¯¹è®¿é—®è¯·æ±‚æŠ—å‹ã€‚<br>â‘¡ é‡‡ç”¨ MQï¼ˆæ¶ˆæ¯é˜Ÿåˆ—ï¼‰ç¼“å­˜è¯·æ±‚ï¼šMQ å…·æœ‰å‰Šå³°å¡«è°·çš„ä½œç”¨ï¼Œå¯ä»¥æŠŠå®¢æˆ·ç«¯çš„è¯·æ±‚å…ˆå¯¼æµåˆ° MQï¼Œç¨‹åºåœ¨ä» MQ ä¸­è¿›è¡Œæ¶ˆè´¹ï¼ˆæ‰§è¡Œè¯·æ±‚ï¼‰ï¼Œè¿™æ ·å¯ä»¥é¿å…çŸ­æ—¶é—´å†…å¤§é‡è¯·æ±‚ï¼Œå¯¼è‡´æœåŠ¡å™¨ç¨‹åºæ— æ³•å“åº”çš„é—®é¢˜ã€‚<br>â‘¢ åˆ©ç”¨ç¼“å­˜åº”å¯¹è¯»è¯·æ±‚ï¼Œæ¯”å¦‚ï¼Œä½¿ç”¨ Redis ç­‰ç¼“å­˜ï¼Œåˆ©ç”¨ Redis å¯ä»¥åˆ†æ‹…æ•°æ®åº“å¾ˆå¤§ä¸€éƒ¨åˆ†å‹åŠ›ã€‚</p>\n<h4 id=\"5ï¼‰æ•°æ®åº“å±‚\"><a href=\"#5ï¼‰æ•°æ®åº“å±‚\" class=\"headerlink\" title=\"5ï¼‰æ•°æ®åº“å±‚\"></a>5ï¼‰æ•°æ®åº“å±‚</h4><p>â‘  åˆç†ä½¿ç”¨æ•°æ®åº“å¼•æ“ â‘¡ åˆç†è®¾ç½®äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Œåˆç†ä½¿ç”¨äº‹åŠ¡ â‘¢ æ­£ç¡®ä½¿ç”¨ SQL è¯­å¥å’ŒæŸ¥è¯¢ç´¢å¼• â‘£ åˆç†åˆ†åº“åˆ†è¡¨ â‘¤ ä½¿ç”¨æ•°æ®åº“ä¸­é—´ä»¶å®ç°æ•°æ®åº“è¯»å†™åˆ†ç¦» â‘¥ è®¾ç½®æ•°æ®åº“ä¸»ä»è¯»å†™åˆ†ç¦»</p>\n<h2 id=\"è¡¥å……\"><a href=\"#è¡¥å……\" class=\"headerlink\" title=\"è¡¥å……\"></a>è¡¥å……</h2><h3 id=\"æŸ¥è¯¢è¯­å¥ä¸åŒå…ƒç´ ï¼ˆwhereã€jionã€limitã€group-byã€having-ç­‰ç­‰ï¼‰æ‰§è¡Œå…ˆåé¡ºåºï¼Ÿ\"><a href=\"#æŸ¥è¯¢è¯­å¥ä¸åŒå…ƒç´ ï¼ˆwhereã€jionã€limitã€group-byã€having-ç­‰ç­‰ï¼‰æ‰§è¡Œå…ˆåé¡ºåºï¼Ÿ\" class=\"headerlink\" title=\"æŸ¥è¯¢è¯­å¥ä¸åŒå…ƒç´ ï¼ˆwhereã€jionã€limitã€group byã€having ç­‰ç­‰ï¼‰æ‰§è¡Œå…ˆåé¡ºåºï¼Ÿ\"></a>æŸ¥è¯¢è¯­å¥ä¸åŒå…ƒç´ ï¼ˆwhereã€jionã€limitã€group byã€having ç­‰ç­‰ï¼‰æ‰§è¡Œå…ˆåé¡ºåºï¼Ÿ</h3><p>æŸ¥è¯¢ä¸­ç”¨åˆ°çš„å…³é”®è¯ä¸»è¦åŒ…å«å…­ä¸ªï¼Œå¹¶ä¸”ä»–ä»¬çš„é¡ºåºä¾æ¬¡ä¸º <code>select--from--where--group by--having--order by</code></p>\n<p>å…¶ä¸­ select å’Œ from æ˜¯å¿…é¡»çš„ï¼Œå…¶ä»–å…³é”®è¯æ˜¯å¯é€‰çš„ï¼Œè¿™å…­ä¸ªå…³é”®è¯çš„æ‰§è¡Œé¡ºåº ä¸ sql è¯­å¥çš„ä¹¦å†™é¡ºåºå¹¶ä¸æ˜¯ä¸€æ ·çš„ï¼Œè€Œæ˜¯æŒ‰ç…§ä¸‹é¢çš„é¡ºåºæ¥æ‰§è¡Œ</p>\n<ul>\n<li>from:éœ€è¦ä»å“ªä¸ªæ•°æ®è¡¨æ£€ç´¢æ•°æ®</li>\n<li>where:è¿‡æ»¤è¡¨ä¸­æ•°æ®çš„æ¡ä»¶</li>\n<li>group by:å¦‚ä½•å°†ä¸Šé¢è¿‡æ»¤å‡ºçš„æ•°æ®åˆ†ç»„</li>\n<li>having:å¯¹ä¸Šé¢å·²ç»åˆ†ç»„çš„æ•°æ®è¿›è¡Œè¿‡æ»¤çš„æ¡ä»¶</li>\n<li>select:æŸ¥çœ‹ç»“æœé›†ä¸­çš„å“ªä¸ªåˆ—ï¼Œæˆ–åˆ—çš„è®¡ç®—ç»“æœ</li>\n<li>order by :æŒ‰ç…§ä»€ä¹ˆæ ·çš„é¡ºåºæ¥æŸ¥çœ‹è¿”å›çš„æ•°æ®</li>\n</ul>\n<p>from åé¢çš„è¡¨å…³è”ï¼Œæ˜¯è‡ªå³å‘å·¦è§£æ è€Œ where æ¡ä»¶çš„è§£æé¡ºåºæ˜¯è‡ªä¸‹è€Œä¸Šçš„ã€‚</p>\n<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨å†™ SQL æ–‡çš„æ—¶å€™ï¼Œå°½é‡æŠŠæ•°æ®é‡å°çš„è¡¨æ”¾åœ¨æœ€å³è¾¹æ¥è¿›è¡Œå…³è”ï¼ˆç”¨å°è¡¨å»åŒ¹é…å¤§è¡¨ï¼‰ï¼Œè€ŒæŠŠèƒ½ç­›é€‰å‡ºå°é‡æ•°æ®çš„æ¡ä»¶æ”¾åœ¨ where è¯­å¥çš„æœ€å·¦è¾¹ ï¼ˆç”¨å°è¡¨å»åŒ¹é…å¤§è¡¨ï¼‰</p>\n<h3 id=\"éå…³ç³»å‹æ•°æ®åº“å’Œå…³ç³»å‹æ•°æ®åº“åŒºåˆ«ï¼Œä¼˜åŠ¿æ¯”è¾ƒï¼Ÿ\"><a href=\"#éå…³ç³»å‹æ•°æ®åº“å’Œå…³ç³»å‹æ•°æ®åº“åŒºåˆ«ï¼Œä¼˜åŠ¿æ¯”è¾ƒï¼Ÿ\" class=\"headerlink\" title=\"éå…³ç³»å‹æ•°æ®åº“å’Œå…³ç³»å‹æ•°æ®åº“åŒºåˆ«ï¼Œä¼˜åŠ¿æ¯”è¾ƒï¼Ÿ\"></a>éå…³ç³»å‹æ•°æ®åº“å’Œå…³ç³»å‹æ•°æ®åº“åŒºåˆ«ï¼Œä¼˜åŠ¿æ¯”è¾ƒï¼Ÿ</h3><h4 id=\"éå…³ç³»å‹æ•°æ®åº“çš„ä¼˜åŠ¿\"><a href=\"#éå…³ç³»å‹æ•°æ®åº“çš„ä¼˜åŠ¿\" class=\"headerlink\" title=\"éå…³ç³»å‹æ•°æ®åº“çš„ä¼˜åŠ¿\"></a>éå…³ç³»å‹æ•°æ®åº“çš„ä¼˜åŠ¿</h4><p><strong>1. æ€§èƒ½</strong></p>\n<p>NOSQL æ˜¯åŸºäºé”®å€¼å¯¹çš„ï¼Œå¯ä»¥æƒ³è±¡æˆè¡¨ä¸­çš„ä¸»é”®å’Œå€¼çš„å¯¹åº”å…³ç³»ï¼Œè€Œä¸”ä¸éœ€è¦ç»è¿‡ SQL å±‚çš„è§£æï¼Œæ‰€ä»¥æ€§èƒ½éå¸¸é«˜ã€‚</p>\n<p><strong>2. å¯æ‰©å±•æ€§</strong></p>\n<p>åŒæ ·ä¹Ÿæ˜¯å› ä¸ºåŸºäºé”®å€¼å¯¹ï¼Œæ•°æ®ä¹‹é—´æ²¡æœ‰è€¦åˆæ€§ï¼Œæ‰€ä»¥éå¸¸å®¹æ˜“æ°´å¹³æ‰©å±•ã€‚</p>\n<h4 id=\"å…³ç³»å‹æ•°æ®åº“çš„ä¼˜åŠ¿\"><a href=\"#å…³ç³»å‹æ•°æ®åº“çš„ä¼˜åŠ¿\" class=\"headerlink\" title=\"å…³ç³»å‹æ•°æ®åº“çš„ä¼˜åŠ¿\"></a>å…³ç³»å‹æ•°æ®åº“çš„ä¼˜åŠ¿</h4><p><strong>1. å¤æ‚æŸ¥è¯¢</strong></p>\n<p>å¯ä»¥ç”¨ SQL è¯­å¥æ–¹ä¾¿çš„åœ¨ä¸€ä¸ªè¡¨ä»¥åŠå¤šä¸ªè¡¨ä¹‹é—´åšéå¸¸å¤æ‚çš„æ•°æ®æŸ¥è¯¢ã€‚</p>\n<p><strong>2. äº‹åŠ¡æ”¯æŒ</strong></p>\n<p>ä½¿å¾—å¯¹äºå®‰å…¨æ€§èƒ½å¾ˆé«˜çš„æ•°æ®è®¿é—®è¦æ±‚å¾—ä»¥å®ç°ã€‚</p>\n<h4 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h4><p><strong>å¯¹äºè¿™ä¸¤ç±»æ•°æ®åº“ï¼Œå¯¹æ–¹çš„ä¼˜åŠ¿å°±æ˜¯è‡ªå·±çš„å¼±åŠ¿ï¼Œåä¹‹äº¦ç„¶</strong>ã€‚</p>\n<p>NOSQL æ•°æ®åº“æ…¢æ…¢å¼€å§‹å…·å¤‡ SQL æ•°æ®åº“çš„ä¸€äº›å¤æ‚æŸ¥è¯¢åŠŸèƒ½ï¼Œæ¯”å¦‚ MongoDBã€‚</p>\n<p>å¯¹äºäº‹åŠ¡çš„æ”¯æŒä¹Ÿå¯ä»¥ç”¨ä¸€äº›ç³»ç»Ÿçº§çš„åŸå­æ“ä½œæ¥å®ç°ä¾‹å¦‚ä¹è§‚é”ä¹‹ç±»çš„æ–¹æ³•æ¥æ›²çº¿æ•‘å›½ï¼Œæ¯”å¦‚ Redis set nxã€‚</p>\n<h3 id=\"æ•°æ®åº“ä¸‰èŒƒå¼ï¼Œæ ¹æ®æŸä¸ªåœºæ™¯è®¾è®¡æ•°æ®è¡¨ï¼Ÿ\"><a href=\"#æ•°æ®åº“ä¸‰èŒƒå¼ï¼Œæ ¹æ®æŸä¸ªåœºæ™¯è®¾è®¡æ•°æ®è¡¨ï¼Ÿ\" class=\"headerlink\" title=\"æ•°æ®åº“ä¸‰èŒƒå¼ï¼Œæ ¹æ®æŸä¸ªåœºæ™¯è®¾è®¡æ•°æ®è¡¨ï¼Ÿ\"></a>æ•°æ®åº“ä¸‰èŒƒå¼ï¼Œæ ¹æ®æŸä¸ªåœºæ™¯è®¾è®¡æ•°æ®è¡¨ï¼Ÿ</h3><ul>\n<li>æ‰€æœ‰å­—æ®µå€¼éƒ½æ˜¯ä¸å¯åˆ†è§£çš„åŸå­å€¼ã€‚</li>\n<li>åœ¨ä¸€ä¸ªæ•°æ®åº“è¡¨ä¸­ï¼Œä¸€ä¸ªè¡¨ä¸­åªèƒ½ä¿å­˜ä¸€ç§æ•°æ®ï¼Œä¸å¯ä»¥æŠŠå¤šç§æ•°æ®ä¿å­˜åœ¨åŒä¸€å¼ æ•°æ®åº“è¡¨ä¸­ã€‚</li>\n<li>æ•°æ®è¡¨ä¸­çš„æ¯ä¸€åˆ—æ•°æ®éƒ½å’Œä¸»é”®ç›´æ¥ç›¸å…³ï¼Œè€Œä¸èƒ½é—´æ¥ç›¸å…³ã€‚</li>\n</ul>\n<h4 id=\"ç¬¬ä¸€èŒƒå¼-ç¡®ä¿æ¯åˆ—ä¿æŒåŸå­æ€§\"><a href=\"#ç¬¬ä¸€èŒƒå¼-ç¡®ä¿æ¯åˆ—ä¿æŒåŸå­æ€§\" class=\"headerlink\" title=\"ç¬¬ä¸€èŒƒå¼(ç¡®ä¿æ¯åˆ—ä¿æŒåŸå­æ€§)\"></a>ç¬¬ä¸€èŒƒå¼(ç¡®ä¿æ¯åˆ—ä¿æŒåŸå­æ€§)</h4><p><strong>ç¬¬ä¸€èŒƒå¼æ˜¯æœ€åŸºæœ¬çš„èŒƒå¼ã€‚å¦‚æœæ•°æ®åº“è¡¨ä¸­çš„æ‰€æœ‰å­—æ®µå€¼éƒ½æ˜¯ä¸å¯åˆ†è§£çš„åŸå­å€¼ï¼Œå°±è¯´æ˜è¯¥æ•°æ®åº“è¡¨æ»¡è¶³äº†ç¬¬ä¸€èŒƒå¼</strong>ã€‚</p>\n<p>ç¬¬ä¸€èŒƒå¼çš„åˆç†éµå¾ªéœ€è¦æ ¹æ®ç³»ç»Ÿçš„å®é™…éœ€æ±‚æ¥å®šã€‚æ¯”å¦‚æŸäº›æ•°æ®åº“ç³»ç»Ÿä¸­éœ€è¦ç”¨åˆ°â€œåœ°å€â€è¿™ä¸ªå±æ€§ï¼Œæœ¬æ¥ç›´æ¥å°†â€œåœ°å€â€å±æ€§è®¾è®¡æˆä¸€ä¸ªæ•°æ®åº“è¡¨çš„å­—æ®µå°±è¡Œã€‚ä½†æ˜¯å¦‚æœç³»ç»Ÿç»å¸¸ä¼šè®¿é—®â€œåœ°å€â€å±æ€§ä¸­çš„â€œåŸå¸‚â€éƒ¨åˆ†ï¼Œé‚£ä¹ˆå°±éè¦å°†â€œåœ°å€â€è¿™ä¸ªå±æ€§é‡æ–°æ‹†åˆ†ä¸ºçœä»½ã€åŸå¸‚ã€è¯¦ç»†åœ°å€ç­‰å¤šä¸ªéƒ¨åˆ†è¿›è¡Œå­˜å‚¨ï¼Œè¿™æ ·åœ¨å¯¹åœ°å€ä¸­æŸä¸€éƒ¨åˆ†æ“ä½œçš„æ—¶å€™å°†éå¸¸æ–¹ä¾¿ã€‚è¿™æ ·è®¾è®¡æ‰ç®—æ»¡è¶³äº†æ•°æ®åº“çš„ç¬¬ä¸€èŒƒå¼ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚</p>\n<p>ä¸Šè¡¨æ‰€ç¤ºçš„ç”¨æˆ·ä¿¡æ¯éµå¾ªäº†ç¬¬ä¸€èŒƒå¼çš„è¦æ±‚ï¼Œè¿™æ ·åœ¨å¯¹ç”¨æˆ·ä½¿ç”¨åŸå¸‚è¿›è¡Œåˆ†ç±»çš„æ—¶å€™å°±éå¸¸æ–¹ä¾¿ï¼Œä¹Ÿæé«˜äº†æ•°æ®åº“çš„æ€§èƒ½ã€‚</p>\n<h4 id=\"ç¬¬äºŒèŒƒå¼-ç¡®ä¿è¡¨ä¸­çš„æ¯åˆ—éƒ½å’Œä¸»é”®ç›¸å…³\"><a href=\"#ç¬¬äºŒèŒƒå¼-ç¡®ä¿è¡¨ä¸­çš„æ¯åˆ—éƒ½å’Œä¸»é”®ç›¸å…³\" class=\"headerlink\" title=\"ç¬¬äºŒèŒƒå¼(ç¡®ä¿è¡¨ä¸­çš„æ¯åˆ—éƒ½å’Œä¸»é”®ç›¸å…³)\"></a>ç¬¬äºŒèŒƒå¼(ç¡®ä¿è¡¨ä¸­çš„æ¯åˆ—éƒ½å’Œä¸»é”®ç›¸å…³)</h4><p>ç¬¬äºŒèŒƒå¼åœ¨ç¬¬ä¸€èŒƒå¼çš„åŸºç¡€ä¹‹ä¸Šæ›´è¿›ä¸€å±‚ã€‚ç¬¬äºŒèŒƒå¼éœ€è¦ç¡®ä¿æ•°æ®åº“è¡¨ä¸­çš„æ¯ä¸€åˆ—éƒ½å’Œä¸»é”®ç›¸å…³ï¼Œè€Œä¸èƒ½åªä¸ä¸»é”®çš„æŸä¸€éƒ¨åˆ†ç›¸å…³ï¼ˆä¸»è¦é’ˆå¯¹è”åˆä¸»é”®è€Œè¨€ï¼‰ã€‚<strong>ä¹Ÿå°±æ˜¯è¯´åœ¨ä¸€ä¸ªæ•°æ®åº“è¡¨ä¸­ï¼Œä¸€ä¸ªè¡¨ä¸­åªèƒ½ä¿å­˜ä¸€ç§æ•°æ®ï¼Œä¸å¯ä»¥æŠŠå¤šç§æ•°æ®ä¿å­˜åœ¨åŒä¸€å¼ æ•°æ®åº“è¡¨ä¸­</strong>ã€‚</p>\n<p><strong>æ¯”å¦‚è¦è®¾è®¡ä¸€ä¸ªè®¢å•ä¿¡æ¯è¡¨ï¼Œå› ä¸ºè®¢å•ä¸­å¯èƒ½ä¼šæœ‰å¤šç§å•†å“ï¼Œæ‰€ä»¥è¦å°†è®¢å•ç¼–å·å’Œå•†å“ç¼–å·ä½œä¸ºæ•°æ®åº“è¡¨çš„è”åˆä¸»é”®</strong>ã€‚</p>\n<h4 id=\"ç¬¬ä¸‰èŒƒå¼-ç¡®ä¿æ¯åˆ—éƒ½å’Œä¸»é”®åˆ—ç›´æ¥ç›¸å…³-è€Œä¸æ˜¯é—´æ¥ç›¸å…³\"><a href=\"#ç¬¬ä¸‰èŒƒå¼-ç¡®ä¿æ¯åˆ—éƒ½å’Œä¸»é”®åˆ—ç›´æ¥ç›¸å…³-è€Œä¸æ˜¯é—´æ¥ç›¸å…³\" class=\"headerlink\" title=\"ç¬¬ä¸‰èŒƒå¼(ç¡®ä¿æ¯åˆ—éƒ½å’Œä¸»é”®åˆ—ç›´æ¥ç›¸å…³,è€Œä¸æ˜¯é—´æ¥ç›¸å…³)\"></a>ç¬¬ä¸‰èŒƒå¼(ç¡®ä¿æ¯åˆ—éƒ½å’Œä¸»é”®åˆ—ç›´æ¥ç›¸å…³,è€Œä¸æ˜¯é—´æ¥ç›¸å…³)</h4><p>ç¬¬ä¸‰èŒƒå¼éœ€è¦ç¡®ä¿æ•°æ®è¡¨ä¸­çš„<strong>æ¯ä¸€åˆ—æ•°æ®éƒ½å’Œä¸»é”®ç›´æ¥ç›¸å…³ï¼Œè€Œä¸èƒ½é—´æ¥ç›¸å…³</strong>ã€‚</p>\n<p>æ¯”å¦‚åœ¨è®¾è®¡ä¸€ä¸ªè®¢å•æ•°æ®è¡¨çš„æ—¶å€™ï¼Œå¯ä»¥å°†å®¢æˆ·ç¼–å·ä½œä¸ºä¸€ä¸ªå¤–é”®å’Œè®¢å•è¡¨å»ºç«‹ç›¸åº”çš„å…³ç³»ã€‚è€Œä¸å¯ä»¥åœ¨è®¢å•è¡¨ä¸­æ·»åŠ å…³äºå®¢æˆ·å…¶å®ƒä¿¡æ¯ï¼ˆæ¯”å¦‚å§“åã€æ‰€å±å…¬å¸ç­‰ï¼‰çš„å­—æ®µã€‚</p>\n<h3 id=\"MySQL-é«˜å¹¶å‘ç¯å¢ƒè§£å†³æ–¹æ¡ˆï¼Ÿ\"><a href=\"#MySQL-é«˜å¹¶å‘ç¯å¢ƒè§£å†³æ–¹æ¡ˆï¼Ÿ\" class=\"headerlink\" title=\"MySQL é«˜å¹¶å‘ç¯å¢ƒè§£å†³æ–¹æ¡ˆï¼Ÿ\"></a>MySQL é«˜å¹¶å‘ç¯å¢ƒè§£å†³æ–¹æ¡ˆï¼Ÿ</h3><p>MySQL é«˜å¹¶å‘ç¯å¢ƒè§£å†³æ–¹æ¡ˆ åˆ†åº“ åˆ†è¡¨ åˆ†å¸ƒå¼ å¢åŠ äºŒçº§ç¼“å­˜ã€‚</p>\n<p><strong>éœ€æ±‚åˆ†æ</strong>ï¼šäº’è”ç½‘å•ä½ æ¯å¤©å¤§é‡æ•°æ®è¯»å–ï¼Œå†™å…¥ï¼Œå¹¶å‘æ€§é«˜ã€‚</p>\n<ul>\n<li><strong>ç°æœ‰è§£å†³æ–¹å¼</strong>ï¼šæ°´å¹³åˆ†åº“åˆ†è¡¨ï¼Œç”±å•ç‚¹åˆ†å¸ƒåˆ°å¤šç‚¹æ•°æ®åº“ä¸­ï¼Œä»è€Œé™ä½å•ç‚¹æ•°æ®åº“å‹åŠ›ã€‚</li>\n<li><strong>é›†ç¾¤æ–¹æ¡ˆ</strong>ï¼šè§£å†³ DB å®•æœºå¸¦æ¥çš„å•ç‚¹ DB ä¸èƒ½è®¿é—®é—®é¢˜ã€‚</li>\n<li><strong>è¯»å†™åˆ†ç¦»ç­–ç•¥</strong>ï¼šæå¤§é™åº¦æé«˜äº†åº”ç”¨ä¸­ Read æ•°æ®çš„é€Ÿåº¦å’Œå¹¶å‘é‡ã€‚æ— æ³•è§£å†³é«˜å†™å…¥å‹åŠ›ã€‚</li>\n</ul>\n<h3 id=\"æ•°æ®åº“å´©æºƒæ—¶äº‹åŠ¡çš„æ¢å¤æœºåˆ¶ï¼ˆREDO-æ—¥å¿—å’Œ-UNDO-æ—¥å¿—ï¼‰ï¼Ÿ\"><a href=\"#æ•°æ®åº“å´©æºƒæ—¶äº‹åŠ¡çš„æ¢å¤æœºåˆ¶ï¼ˆREDO-æ—¥å¿—å’Œ-UNDO-æ—¥å¿—ï¼‰ï¼Ÿ\" class=\"headerlink\" title=\"æ•°æ®åº“å´©æºƒæ—¶äº‹åŠ¡çš„æ¢å¤æœºåˆ¶ï¼ˆREDO æ—¥å¿—å’Œ UNDO æ—¥å¿—ï¼‰ï¼Ÿ\"></a>æ•°æ®åº“å´©æºƒæ—¶äº‹åŠ¡çš„æ¢å¤æœºåˆ¶ï¼ˆREDO æ—¥å¿—å’Œ UNDO æ—¥å¿—ï¼‰ï¼Ÿ</h3><h4 id=\"Undo-Log\"><a href=\"#Undo-Log\" class=\"headerlink\" title=\"Undo Log\"></a>Undo Log</h4><p><strong>Undo Log æ˜¯ä¸ºäº†å®ç°äº‹åŠ¡çš„åŸå­æ€§</strong>ï¼Œåœ¨ MySQL æ•°æ®åº“ InnoDB å­˜å‚¨å¼•æ“ä¸­ï¼Œè¿˜ç”¨äº† Undo Log æ¥å®ç°å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶(ç®€ç§°ï¼šMVCC)ã€‚</p>\n<ul>\n<li><strong>äº‹åŠ¡çš„åŸå­æ€§</strong>(Atomicity)äº‹åŠ¡ä¸­çš„æ‰€æœ‰æ“ä½œï¼Œè¦ä¹ˆå…¨éƒ¨å®Œæˆï¼Œè¦ä¹ˆä¸åšä»»ä½•æ“ä½œï¼Œä¸èƒ½åªåšéƒ¨åˆ†æ“ä½œã€‚å¦‚æœåœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­å‘ç”Ÿäº†é”™è¯¯ï¼Œè¦å›æ»š(Rollback)åˆ°äº‹åŠ¡å¼€å§‹å‰çš„çŠ¶æ€ï¼Œå°±åƒè¿™ä¸ªäº‹åŠ¡ä»æ¥æ²¡æœ‰æ‰§è¡Œè¿‡ã€‚</li>\n<li><strong>åŸç†</strong>Undo Log çš„åŸç†å¾ˆç®€å•ï¼Œ<strong>ä¸ºäº†æ»¡è¶³äº‹åŠ¡çš„åŸå­æ€§ï¼Œåœ¨æ“ä½œä»»ä½•æ•°æ®ä¹‹å‰ï¼Œé¦–å…ˆå°†æ•°æ®å¤‡ä»½åˆ°ä¸€ä¸ªåœ°æ–¹ï¼ˆè¿™ä¸ªå­˜å‚¨æ•°æ®å¤‡ä»½çš„åœ°æ–¹ç§°ä¸º UndoLogï¼‰</strong>ã€‚ç„¶åè¿›è¡Œæ•°æ®çš„ä¿®æ”¹ã€‚å¦‚æœå‡ºç°äº†é”™è¯¯æˆ–è€…ç”¨æˆ·æ‰§è¡Œäº† ROLLBACK è¯­å¥ï¼Œ<strong>ç³»ç»Ÿå¯ä»¥åˆ©ç”¨ Undo Log ä¸­çš„å¤‡ä»½å°†æ•°æ®æ¢å¤åˆ°äº‹åŠ¡å¼€å§‹ä¹‹å‰çš„çŠ¶æ€</strong>ã€‚</li>\n</ul>\n<p><strong>ä¹‹æ‰€ä»¥èƒ½åŒæ—¶ä¿è¯åŸå­æ€§å’ŒæŒä¹…åŒ–ï¼Œæ˜¯å› ä¸ºä»¥ä¸‹ç‰¹ç‚¹</strong>ï¼š</p>\n<ul>\n<li>æ›´æ–°æ•°æ®å‰è®°å½• Undo logã€‚</li>\n<li>ä¸ºäº†ä¿è¯æŒä¹…æ€§ï¼Œå¿…é¡»å°†æ•°æ®åœ¨äº‹åŠ¡æäº¤å‰å†™åˆ°ç£ç›˜ã€‚åªè¦äº‹åŠ¡æˆåŠŸæäº¤ï¼Œæ•°æ®å¿…ç„¶å·²ç»æŒä¹…åŒ–ã€‚</li>\n<li><strong>Undo log å¿…é¡»å…ˆäºæ•°æ®æŒä¹…åŒ–åˆ°ç£ç›˜</strong>ã€‚å¦‚æœåœ¨ G,H ä¹‹é—´ç³»ç»Ÿå´©æºƒï¼Œ<strong>undo log æ˜¯å®Œæ•´çš„ï¼Œ å¯ä»¥ç”¨æ¥å›æ»šäº‹åŠ¡</strong>ã€‚</li>\n<li>å¦‚æœåœ¨ A-F ä¹‹é—´ç³»ç»Ÿå´©æºƒ,å› ä¸ºæ•°æ®æ²¡æœ‰æŒä¹…åŒ–åˆ°ç£ç›˜ã€‚æ‰€ä»¥ç£ç›˜ä¸Šçš„æ•°æ®è¿˜æ˜¯ä¿æŒåœ¨äº‹åŠ¡å¼€å§‹å‰çš„çŠ¶æ€ã€‚</li>\n</ul>\n<p><strong>ç¼ºé™·</strong>ï¼š<strong>æ¯ä¸ªäº‹åŠ¡æäº¤å‰å°†æ•°æ®å’Œ Undo Log å†™å…¥ç£ç›˜ï¼Œè¿™æ ·ä¼šå¯¼è‡´å¤§é‡çš„ç£ç›˜ IOï¼Œå› æ­¤æ€§èƒ½å¾ˆä½</strong>ã€‚</p>\n<p>å¦‚æœèƒ½å¤Ÿå°†æ•°æ®ç¼“å­˜ä¸€æ®µæ—¶é—´ï¼Œå°±èƒ½å‡å°‘ IO æé«˜æ€§èƒ½ã€‚ä½†æ˜¯è¿™æ ·å°±ä¼šä¸§å¤±äº‹åŠ¡çš„æŒä¹…æ€§ã€‚å› æ­¤å¼•å…¥äº†å¦å¤–ä¸€ç§æœºåˆ¶æ¥å®ç°æŒä¹…åŒ–ï¼Œå³ Redo Logã€‚</p>\n<h4 id=\"Redo-Log\"><a href=\"#Redo-Log\" class=\"headerlink\" title=\"Redo Log\"></a>Redo Log</h4><ul>\n<li><strong>åŸç†å’Œ Undo Log ç›¸å</strong>ï¼Œ<strong>Redo Log è®°å½•çš„æ˜¯æ–°æ•°æ®çš„å¤‡ä»½</strong>ã€‚<strong>åœ¨äº‹åŠ¡æäº¤å‰ï¼Œåªè¦å°† Redo Log æŒä¹…åŒ–å³å¯ï¼Œä¸éœ€è¦å°†æ•°æ®æŒä¹…åŒ–ã€‚å½“ç³»ç»Ÿå´©æºƒæ—¶ï¼Œè™½ç„¶æ•°æ®æ²¡æœ‰æŒä¹…åŒ–ï¼Œä½†æ˜¯ Redo Log å·²ç»æŒä¹…åŒ–ã€‚ç³»ç»Ÿå¯ä»¥æ ¹æ® Redo Log çš„å†…å®¹ï¼Œå°†æ‰€æœ‰æ•°æ®æ¢å¤åˆ°æœ€æ–°çš„çŠ¶æ€</strong>ã€‚</li>\n</ul>\n<h3 id=\"Explain-æ€§èƒ½åˆ†æ\"><a href=\"#Explain-æ€§èƒ½åˆ†æ\" class=\"headerlink\" title=\"Explain æ€§èƒ½åˆ†æ\"></a>Explain æ€§èƒ½åˆ†æ</h3><p><strong>æ˜¯ä»€ä¹ˆ</strong></p>\n<p>æŸ¥çœ‹æ‰§è¡Œè®¡åˆ’ï¼šä½¿ç”¨ EXPLAIN å…³é”®å­—å¯ä»¥æ¨¡æ‹Ÿä¼˜åŒ–å™¨æ‰§è¡Œ SQL æŸ¥è¯¢è¯­å¥ï¼Œä»è€ŒçŸ¥é“ MySQL æ˜¯å¦‚ä½•å¤„ç† SQL è¯­å¥çš„ã€‚åˆ†ææŸ¥è¯¢è¯­å¥æˆ–æ˜¯è¡¨ç»“æ„çš„æ€§èƒ½ç“¶é¢ˆã€‚</p>\n<p><strong>èƒ½å¹²å˜›</strong></p>\n<ul>\n<li>è¡¨çš„è¯»å–é¡ºåº</li>\n<li>æ•°æ®è¯»å–æ“ä½œçš„æ“ä½œç±»å‹</li>\n<li>å“ªäº›ç´¢å¼•å¯ä»¥ä½¿ç”¨</li>\n<li>å“ªäº›ç´¢å¼•è¢«å®é™…ä½¿ç”¨</li>\n<li>è¡¨ä¹‹é—´çš„å¼•ç”¨</li>\n<li>æ¯å¼ è¡¨æœ‰å¤šå°‘è¡Œè¢«ä¼˜åŒ–å™¨æŸ¥è¯¢</li>\n</ul>\n<p><strong>æ€ä¹ˆç©</strong></p>\n<p>Explain + SQL è¯­å¥ã€‚<br>Explain æ‰§è¡Œåè¿”å›çš„ä¿¡æ¯ï¼š<br> <img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131912576.png\" alt=\"image-20220422131912576\" style=\"zoom:50%;\" /></p>\n<p><strong>å„å­—æ®µè§£é‡Š</strong></p>\n<ol>\n<li><p>idï¼šselect æŸ¥è¯¢çš„åºåˆ—å·ï¼ŒåŒ…å«ä¸€ç»„æ•°å­—ï¼Œè¡¨ç¤ºæŸ¥è¯¢ä¸­æ‰§è¡Œ select å­å¥æˆ–æ“ä½œè¡¨çš„é¡ºåºã€‚</p>\n<ul>\n<li>id ç›¸åŒï¼Œæ‰§è¡Œé¡ºåºç”±ä¸Šè‡³ä¸‹</li>\n<li>id ä¸åŒï¼Œå¦‚æœæ˜¯å­æŸ¥è¯¢ï¼Œid çš„åºå·ä¼šé€’å¢ï¼Œid å€¼è¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜ï¼Œè¶Šå…ˆè¢«æ‰§è¡Œ</li>\n<li>id æœ‰ç›¸åŒä¹Ÿæœ‰ä¸åŒï¼šid å¦‚æœç›¸åŒï¼Œå¯ä»¥è®¤ä¸ºæ˜¯ä¸€ç»„ï¼Œä»ä¸Šå¾€ä¸‹é¡ºåºæ‰§è¡Œï¼›åœ¨æ‰€æœ‰ç»„ä¸­ï¼Œid å€¼è¶Šå¤§ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼Œè¶Šå…ˆæ‰§è¡Œ</li>\n</ul>\n<blockquote>\n<p>id å·æ¯ä¸ªå·ç ï¼Œè¡¨ç¤ºä¸€è¶Ÿç‹¬ç«‹çš„æŸ¥è¯¢ã€‚ä¸€ä¸ª sql çš„æŸ¥è¯¢è¶Ÿæ•°è¶Šå°‘è¶Šå¥½ã€‚</p>\n</blockquote>\n</li>\n<li><p>select_typeï¼šä»£è¡¨æŸ¥è¯¢çš„ç±»å‹ï¼Œä¸»è¦æ˜¯ç”¨äºåŒºåˆ«æ™®é€šæŸ¥è¯¢ã€è”åˆæŸ¥è¯¢ã€å­æŸ¥è¯¢ç­‰çš„å¤æ‚æŸ¥è¯¢ï¼Œå–å€¼èŒƒå›´å¦‚ä¸‹ï¼š</p>\n<ul>\n<li>simpleï¼šç®€å•çš„ select æŸ¥è¯¢ï¼ŒæŸ¥è¯¢ä¸­ä¸åŒ…å«å­æŸ¥è¯¢æˆ–è€… UNION</li>\n<li>primaryï¼šæŸ¥è¯¢ä¸­è‹¥åŒ…å«ä»»ä½•å¤æ‚çš„å­éƒ¨åˆ†ï¼Œæœ€å¤–å±‚æŸ¥è¯¢åˆ™è¢«æ ‡è®°ä¸º primary</li>\n<li>derivedï¼šåœ¨ FROM åˆ—è¡¨ä¸­åŒ…å«çš„å­æŸ¥è¯¢è¢«æ ‡è®°ä¸º DERIVED (è¡ç”Ÿ)ï¼ŒMySQL ä¼šé€’å½’æ‰§è¡Œè¿™äº›å­æŸ¥è¯¢, æŠŠç»“æœæ”¾åœ¨ä¸´æ—¶è¡¨é‡Œã€‚</li>\n<li>subqueryï¼šåœ¨ SELECT æˆ– WHERE åˆ—è¡¨ä¸­åŒ…å«äº†å­æŸ¥è¯¢</li>\n<li>depedent subqueryï¼šåœ¨ SELECT æˆ– WHERE åˆ—è¡¨ä¸­åŒ…å«äº†å­æŸ¥è¯¢ï¼Œå­æŸ¥è¯¢åŸºäºå¤–å±‚</li>\n<li>uncacheable subqueryï¼šæ— æ³•ä½¿ç”¨ç¼“å­˜çš„å­æŸ¥è¯¢</li>\n<li>unionï¼šè‹¥ç¬¬äºŒä¸ª SELECT å‡ºç°åœ¨ UNION ä¹‹åï¼Œåˆ™è¢«æ ‡è®°ä¸º UNIONï¼›è‹¥ UNION åŒ…å«åœ¨ FROM å­å¥çš„å­æŸ¥è¯¢ä¸­ï¼Œå¤–å±‚ SELECT å°†è¢«æ ‡è®°ä¸ºï¼šDERIVED</li>\n<li>union resultï¼šä» UNION è¡¨è·å–ç»“æœçš„ SELECT</li>\n</ul>\n</li>\n<li><p>tableï¼šè¿™ä¸ªæ•°æ®æ˜¯åŸºäºå“ªå¼ è¡¨çš„ã€‚</p>\n</li>\n<li><p>typeï¼šæ˜¯æŸ¥è¯¢çš„è®¿é—®ç±»å‹ã€‚æ˜¯è¾ƒä¸ºé‡è¦çš„ä¸€ä¸ªæŒ‡æ ‡ï¼Œç»“æœå€¼ä»æœ€å¥½åˆ°æœ€åä¾æ¬¡æ˜¯ï¼šsystem &gt; const &gt; eq_ref &gt; ref &gt; fulltext &gt; ref_or_null &gt; index_merge &gt; unique_subquery &gt; index_subquery &gt; range &gt; index &gt; ALLï¼Œä¸€èˆ¬æ¥è¯´ï¼Œå¾—ä¿è¯æŸ¥è¯¢è‡³å°‘è¾¾åˆ° range çº§åˆ«ï¼Œæœ€å¥½èƒ½è¾¾åˆ° refã€‚</p>\n<blockquote>\n<p>åªéœ€è¦è®°ä½ï¼šsystem &gt; const &gt; eq_ref &gt; ref &gt; range &gt; index &gt; ALL å°±è¡Œäº†ï¼Œå…¶ä»–çš„ä¸å¸¸è§ã€‚</p>\n</blockquote>\n<ul>\n<li>systemï¼šè¡¨åªæœ‰ä¸€è¡Œè®°å½•ï¼ˆç­‰äºç³»ç»Ÿè¡¨ï¼‰ï¼Œè¿™æ˜¯ const ç±»å‹çš„ç‰¹åˆ—ï¼Œå¹³æ—¶ä¸ä¼šå‡ºç°ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥å¿½ç•¥ä¸è®¡ã€‚</li>\n<li>constï¼šè¡¨ç¤ºé€šè¿‡ç´¢å¼•ä¸€æ¬¡å°±æ‰¾åˆ°äº†ï¼Œconst ç”¨äºæ¯”è¾ƒ primary key æˆ–è€… unique ç´¢å¼•ã€‚å› ä¸ºåªåŒ¹é…ä¸€è¡Œæ•°æ®ï¼Œæ‰€ä»¥å¾ˆå¿«ã€‚å¦‚å°†ä¸»é”®ç½®äº where åˆ—è¡¨ä¸­ï¼ŒMySQL å°±èƒ½å°†è¯¥æŸ¥è¯¢è½¬æ¢ä¸ºä¸€ä¸ªå¸¸é‡ã€‚</li>\n<li>eq_refï¼šå”¯ä¸€æ€§ç´¢å¼•æ‰«æï¼Œå¯¹äºæ¯ä¸ªç´¢å¼•é”®ï¼Œè¡¨ä¸­åªæœ‰ä¸€æ¡è®°å½•ä¸ä¹‹åŒ¹é…ã€‚å¸¸è§äºä¸»é”®æˆ–å”¯ä¸€ç´¢å¼•æ‰«æã€‚</li>\n<li>refï¼šéå”¯ä¸€æ€§ç´¢å¼•æ‰«æï¼Œè¿”å›åŒ¹é…æŸä¸ªå•ç‹¬å€¼çš„æ‰€æœ‰è¡Œã€‚æœ¬è´¨ä¸Šä¹Ÿæ˜¯ä¸€ç§ç´¢å¼•è®¿é—®ï¼Œå®ƒè¿”å›æ‰€æœ‰åŒ¹é…æŸä¸ªå•ç‹¬å€¼çš„è¡Œï¼Œç„¶è€Œï¼Œå®ƒå¯èƒ½ä¼šæ‰¾åˆ°å¤šä¸ªç¬¦åˆæ¡ä»¶çš„è¡Œï¼Œæ‰€ä»¥ä»–åº”è¯¥å±äºæŸ¥æ‰¾å’Œæ‰«æçš„æ··åˆä½“ã€‚</li>\n<li>rangeï¼šåªæ£€ç´¢ç»™å®šèŒƒå›´çš„è¡Œï¼Œä½¿ç”¨ä¸€ä¸ªç´¢å¼•æ¥é€‰æ‹©è¡Œã€‚key åˆ—æ˜¾ç¤ºä½¿ç”¨äº†å“ªä¸ªç´¢å¼•ä¸€èˆ¬å°±æ˜¯åœ¨ where è¯­å¥ä¸­å‡ºç°äº† betweenã€&lt;ã€&gt;ã€in ç­‰çš„æŸ¥è¯¢è¿™ç§èŒƒå›´æ‰«æç´¢å¼•æ‰«ææ¯”å…¨è¡¨æ‰«æè¦å¥½ï¼Œå› ä¸ºå®ƒåªéœ€è¦å¼€å§‹äºç´¢å¼•çš„æŸä¸€ç‚¹ï¼Œè€Œç»“æŸè¯­å¦ä¸€ç‚¹ï¼Œä¸ç”¨æ‰«æå…¨éƒ¨ç´¢å¼•ã€‚</li>\n<li>indexï¼šå‡ºç° index æ˜¯ sql ä½¿ç”¨äº†ç´¢å¼•ä½†æ˜¯æ²¡ç”¨ç´¢å¼•è¿›è¡Œè¿‡æ»¤ï¼Œä¸€èˆ¬æ˜¯ä½¿ç”¨äº†è¦†ç›–ç´¢å¼•æˆ–è€…æ˜¯åˆ©ç”¨ç´¢å¼•è¿›è¡Œäº†æ’åºåˆ†ç»„ã€‚</li>\n<li>allï¼šå°†éå†å…¨è¡¨ä»¥æ‰¾åˆ°åŒ¹é…çš„è¡Œã€‚</li>\n</ul>\n<blockquote>\n<p>å…¶ä»– type å¦‚ä¸‹ï¼š</p>\n</blockquote>\n<ul>\n<li>index_mergeï¼šåœ¨æŸ¥è¯¢è¿‡ç¨‹ä¸­éœ€è¦å¤šä¸ªç´¢å¼•ç»„åˆä½¿ç”¨ï¼Œé€šå¸¸å‡ºç°åœ¨æœ‰ or å…³é”®å­—çš„ sql ä¸­ã€‚</li>\n<li>ref_or_nullï¼šå¯¹äºæŸä¸ªå­—æ®µæ—¢éœ€è¦è¿‡æ»¤æ¡ä»¶ï¼Œä¹Ÿéœ€è¦ null å€¼çš„æƒ…å†µä¸‹ã€‚æŸ¥è¯¢ä¼˜åŒ–å™¨ä¼šé€‰æ‹©ç”¨ ref_or_null è¿æ¥æŸ¥è¯¢ã€‚</li>\n<li>index_subqueryï¼šåˆ©ç”¨ç´¢å¼•æ¥å…³è”å­æŸ¥è¯¢ï¼Œä¸å†å…¨è¡¨æ‰«æã€‚</li>\n<li>unique_subqueryï¼šè¯¥è”æ¥ç±»å‹ç±»ä¼¼äº index_subqueryã€‚å­æŸ¥è¯¢ä¸­çš„å”¯ä¸€ç´¢å¼•ã€‚</li>\n</ul>\n</li>\n<li><p>possible_keysï¼šæ˜¾ç¤ºå¯èƒ½åº”ç”¨åœ¨è¿™å¼ è¡¨ä¸­çš„ç´¢å¼•ï¼Œä¸€ä¸ªæˆ–å¤šä¸ªã€‚æŸ¥è¯¢æ¶‰åŠåˆ°çš„å­—æ®µä¸Šè‹¥å­˜åœ¨ç´¢å¼•ï¼Œåˆ™è¯¥ç´¢å¼•å°†è¢«åˆ—å‡ºï¼Œä½†ä¸ä¸€å®šè¢«æŸ¥è¯¢å®é™…ä½¿ç”¨ã€‚</p>\n</li>\n<li><p>keyï¼šå®é™…ä½¿ç”¨çš„ç´¢å¼•ã€‚å¦‚æœä¸º NULLï¼Œåˆ™æ²¡æœ‰ä½¿ç”¨ç´¢å¼•ã€‚</p>\n</li>\n<li><p>key_lenï¼šè¡¨ç¤ºç´¢å¼•ä¸­ä½¿ç”¨çš„å­—èŠ‚æ•°ï¼Œå¯é€šè¿‡è¯¥åˆ—è®¡ç®—æŸ¥è¯¢ä¸­ä½¿ç”¨çš„ç´¢å¼•çš„é•¿åº¦ã€‚key_len æ˜¾ç¤ºçš„å€¼ä¸ºç´¢å¼•å­—æ®µçš„æœ€å¤§å¯èƒ½é•¿åº¦ï¼Œå¹¶éå®é™…ä½¿ç”¨é•¿åº¦ã€‚å¦‚ä½•è®¡ç®— key_lenï¼Ÿ</p>\n<ul>\n<li>å…ˆçœ‹ç´¢å¼•ä¸Šå­—æ®µçš„ç±»å‹ + é•¿åº¦ï¼Œæ¯”å¦‚ï¼šint&#x3D;4; varchar(20)&#x3D;20; char(20)&#x3D;20</li>\n<li>å¦‚æœæ˜¯ varchar æˆ–è€… char è¿™ç§å­—ç¬¦ä¸²å­—æ®µï¼Œè§†å­—ç¬¦é›†è¦ä¹˜ä¸åŒçš„å€¼ï¼Œæ¯”å¦‚ utf-8 è¦ä¹˜ 3ï¼ŒGBK è¦ä¹˜ 2</li>\n<li>varchar è¿™ç§åŠ¨æ€å­—ç¬¦ä¸²è¦åŠ  2 ä¸ªå­—èŠ‚</li>\n<li>å…è®¸ä¸ºç©ºçš„å­—æ®µè¦åŠ  1 ä¸ªå­—èŠ‚</li>\n</ul>\n</li>\n<li><p>refï¼šæ˜¾ç¤ºç´¢å¼•çš„å“ªä¸€åˆ—è¢«ä½¿ç”¨äº†ï¼Œå¦‚æœå¯èƒ½çš„è¯ï¼Œæ˜¯ä¸€ä¸ªå¸¸æ•°ã€‚å“ªäº›åˆ—æˆ–å¸¸é‡è¢«ç”¨äºæŸ¥æ‰¾ç´¢å¼•åˆ—ä¸Šçš„å€¼ã€‚</p>\n</li>\n<li><p>rowsï¼šæ˜¾ç¤º MySQL è®¤ä¸ºå®ƒæ‰§è¡ŒæŸ¥è¯¢æ—¶å¿…é¡»æ£€æŸ¥çš„è¡Œæ•°ã€‚è¶Šå°‘è¶Šå¥½ï¼</p>\n</li>\n<li><p>Extraï¼šå…¶ä»–çš„é¢å¤–é‡è¦çš„ä¿¡æ¯ã€‚</p>\n<ul>\n<li>Using filesortï¼šè¯´æ˜ mysql ä¼šå¯¹æ•°æ®ä½¿ç”¨ä¸€ä¸ªå¤–éƒ¨çš„ç´¢å¼•æ’åºï¼Œè€Œä¸æ˜¯æŒ‰ç…§è¡¨å†…çš„ç´¢å¼•é¡ºåºè¿›è¡Œè¯»å–ã€‚MySQL ä¸­æ— æ³•åˆ©ç”¨ç´¢å¼•å®Œæˆçš„æ’åºæ“ä½œç§°ä¸ºâ€œæ–‡ä»¶æ’åºâ€ã€‚<strong>æ’åºå­—æ®µè‹¥é€šè¿‡ç´¢å¼•å»è®¿é—®å°†å¤§å¤§æé«˜æ’åºé€Ÿåº¦</strong>ã€‚</li>\n<li>Using temporaryï¼šä½¿ç”¨ä¸´æ—¶è¡¨ä¿å­˜ä¸­é—´ç»“æœï¼ŒMySQL åœ¨å¯¹æŸ¥è¯¢ç»“æœæ’åºæ—¶ä½¿ç”¨ä¸´æ—¶è¡¨ã€‚å¸¸è§äºæ’åº order by å’Œåˆ†ç»„æŸ¥è¯¢ group byã€‚</li>\n<li>Using indexï¼šè¡¨ç¤ºç›¸åº”çš„ select æ“ä½œä¸­ä½¿ç”¨äº†è¦†ç›–ç´¢å¼• (Covering Index)ï¼Œé¿å…è®¿é—®äº†è¡¨çš„æ•°æ®è¡Œï¼Œæ•ˆç‡ä¸é”™ï¼å¦‚æœåŒæ—¶å‡ºç° using whereï¼Œè¡¨æ˜ç´¢å¼•è¢«ç”¨æ¥æ‰§è¡Œç´¢å¼•é”®å€¼çš„æŸ¥æ‰¾ï¼›å¦‚æœæ²¡æœ‰åŒæ—¶å‡ºç° using whereï¼Œè¡¨æ˜ç´¢å¼•åªæ˜¯ç”¨æ¥è¯»å–æ•°æ®è€Œéåˆ©ç”¨ç´¢å¼•æ‰§è¡ŒæŸ¥æ‰¾ã€‚</li>\n<li>Using whereï¼šè¡¨æ˜ä½¿ç”¨äº† where è¿‡æ»¤ã€‚</li>\n<li>Using join bufferï¼šä½¿ç”¨äº†è¿æ¥ç¼“å­˜ã€‚</li>\n<li>impossible whereï¼šwhere å­å¥çš„å€¼æ€»æ˜¯ falseï¼Œä¸èƒ½ç”¨æ¥è·å–ä»»ä½•æ•°æ®ã€‚</li>\n<li>select tables optimized awayï¼šåœ¨æ²¡æœ‰ group by å­å¥çš„æƒ…å†µä¸‹ï¼ŒåŸºäºç´¢å¼•ä¼˜åŒ– MIN&#x2F;MAX æ“ä½œæˆ–è€…å¯¹äº MyISAM å­˜å‚¨å¼•æ“ä¼˜åŒ– COUNT(*) æ“ä½œï¼Œä¸å¿…ç­‰åˆ°æ‰§è¡Œé˜¶æ®µå†è¿›è¡Œè®¡ç®—ï¼ŒæŸ¥è¯¢æ‰§è¡Œè®¡åˆ’ç”Ÿæˆçš„é˜¶æ®µå³å®Œæˆä¼˜åŒ–ã€‚</li>\n<li>distinctï¼šä¼˜åŒ– distinct æ“ä½œï¼Œåœ¨æ‰¾åˆ°ç¬¬ä¸€åŒ¹é…çš„å…ƒç¥–åå³åœæ­¢æ‰¾åŒæ ·å€¼çš„åŠ¨ä½œã€‚</li>\n</ul>\n</li>\n</ol>\n","site":{"data":{}},"length":41593,"excerpt":"<blockquote>\n<p>æ•´ç†çš„ MySQL ç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½","more":"</p>\n</blockquote>\n<h2 id=\"MySQLåŸºç¡€ç¯‡\"><a href=\"#MySQLåŸºç¡€ç¯‡\" class=\"headerlink\" title=\"MySQLåŸºç¡€ç¯‡\"></a>MySQLåŸºç¡€ç¯‡</h2><h3 id=\"è¯´ä¸€è¯´ä¸‰ä¸ªèŒƒå¼\"><a href=\"#è¯´ä¸€è¯´ä¸‰ä¸ªèŒƒå¼\" class=\"headerlink\" title=\"è¯´ä¸€è¯´ä¸‰ä¸ªèŒƒå¼\"></a>è¯´ä¸€è¯´ä¸‰ä¸ªèŒƒå¼</h3><p><strong>ç¬¬ä¸€èŒƒå¼(ç¡®ä¿æ¯åˆ—ä¿æŒåŸå­æ€§)</strong></p>\n<p>ç¬¬ä¸€èŒƒå¼æ˜¯æœ€åŸºæœ¬çš„èŒƒå¼ã€‚å¦‚æœæ•°æ®åº“è¡¨ä¸­çš„æ‰€æœ‰å­—æ®µå€¼éƒ½æ˜¯ä¸å¯åˆ†è§£çš„åŸå­å€¼ï¼Œå°±è¯´æ˜è¯¥æ•°æ®åº“è¡¨æ»¡è¶³äº†ç¬¬ä¸€èŒƒå¼ã€‚</p>\n<p>**ç¬¬äºŒèŒƒå¼(ç¡®ä¿è¡¨ä¸­çš„æ¯åˆ—éƒ½å’Œä¸»é”®ç›¸å…³)**ï¼ˆå‰ææ˜¯ç¬¬ä¸€èŒƒå¼ï¼‰</p>\n<p>åœ¨ä¸€ä¸ªæ•°æ®åº“è¡¨ä¸­ï¼Œä¸€ä¸ªè¡¨ä¸­åªèƒ½ä¿å­˜<strong>ä¸€ç§</strong>æ•°æ®ï¼Œä¸å¯ä»¥æŠŠå¤šç§æ•°æ®ä¿å­˜åœ¨åŒä¸€å¼ æ•°æ®åº“è¡¨ä¸­ã€‚</p>\n<p>**ç¬¬ä¸‰èŒƒå¼(ç¡®ä¿è¡¨ä¸­æ¯åˆ—éƒ½å’Œä¸»é”®ç›´æ¥ç›¸å…³,è€Œä¸æ˜¯é—´æ¥ç›¸å…³)**ï¼ˆå‰ææ˜¯ç¬¬ä¸€ç¬¬äºŒèŒƒå¼ï¼‰</p>\n<p>å·²ç»åˆ†å¥½äº†å¤šå¼ è¡¨çš„è¯ï¼Œä¸€å¼ è¡¨ä¸­åªèƒ½æœ‰å¦ä¸€å¼ è¡¨çš„ IDï¼Œè€Œä¸èƒ½æœ‰å…¶ä»–ä»»ä½•ä¿¡æ¯ï¼ˆå…¶ä»–ä»»ä½•ä¿¡æ¯ï¼Œä¸€å¾‹ç”¨ä¸»é”®åœ¨å¦ä¸€å¼ è¡¨ä¸­æŸ¥è¯¢ï¼‰ã€‚</p>\n<h3 id=\"è¯´ä¸€ä¸‹-MySQL-æ‰§è¡Œä¸€æ¡æŸ¥è¯¢è¯­å¥çš„å†…éƒ¨æ‰§è¡Œè¿‡ç¨‹ï¼Ÿ\"><a href=\"#è¯´ä¸€ä¸‹-MySQL-æ‰§è¡Œä¸€æ¡æŸ¥è¯¢è¯­å¥çš„å†…éƒ¨æ‰§è¡Œè¿‡ç¨‹ï¼Ÿ\" class=\"headerlink\" title=\"è¯´ä¸€ä¸‹ MySQL æ‰§è¡Œä¸€æ¡æŸ¥è¯¢è¯­å¥çš„å†…éƒ¨æ‰§è¡Œè¿‡ç¨‹ï¼Ÿ\"></a>è¯´ä¸€ä¸‹ MySQL æ‰§è¡Œä¸€æ¡æŸ¥è¯¢è¯­å¥çš„å†…éƒ¨æ‰§è¡Œè¿‡ç¨‹ï¼Ÿ</h3><blockquote>\n<p>è¿æ¥å™¨ â†’ æŸ¥è¯¢ç¼“å­˜ â†’ åˆ†æå™¨ â†’ ä¼˜åŒ–å™¨ â†’ æ‰§è¡Œå™¨</p>\n</blockquote>\n<ul>\n<li><p>å®¢æˆ·ç«¯å…ˆé€šè¿‡<strong>è¿æ¥å™¨</strong>è¿æ¥åˆ° MySQL æœåŠ¡å™¨ã€‚</p>\n</li>\n<li><p>è¿æ¥å™¨æƒé™éªŒè¯é€šè¿‡ä¹‹åï¼Œå…ˆæŸ¥è¯¢æ˜¯å¦æœ‰<strong>æŸ¥è¯¢ç¼“å­˜</strong>ï¼Œå¦‚æœæœ‰ç¼“å­˜ï¼ˆä¹‹å‰æ‰§è¡Œè¿‡æ­¤è¯­å¥ï¼‰åˆ™ç›´æ¥è¿”å›ç¼“å­˜æ•°æ®ï¼Œå¦‚æœæ²¡æœ‰ç¼“å­˜åˆ™è¿›å…¥åˆ†æå™¨ã€‚</p>\n</li>\n<li><p><strong>åˆ†æå™¨</strong>ä¼šå¯¹æŸ¥è¯¢è¯­å¥è¿›è¡Œè¯­æ³•åˆ†æå’Œè¯æ³•åˆ†æï¼Œåˆ¤æ–­ SQL è¯­æ³•æ˜¯å¦æ­£ç¡®ï¼Œå¦‚æœæŸ¥è¯¢è¯­æ³•é”™è¯¯ä¼šç›´æ¥è¿”å›ç»™å®¢æˆ·ç«¯é”™è¯¯ä¿¡æ¯ï¼Œå¦‚æœè¯­æ³•æ­£ç¡®åˆ™è¿›å…¥ä¼˜åŒ–å™¨ã€‚</p>\n</li>\n<li><p><strong>ä¼˜åŒ–å™¨</strong>å¯¹æŸ¥è¯¢è¯­å¥è¿›è¡Œä¼˜åŒ–å¤„ç†ï¼Œä¾‹å¦‚ä¸€ä¸ªè¡¨é‡Œé¢æœ‰å¤šä¸ªç´¢å¼•ï¼Œä¼˜åŒ–å™¨ä¼šåˆ¤åˆ«å“ªä¸ªç´¢å¼•æ€§èƒ½æ›´å¥½ã€‚</p>\n</li>\n<li><p>ä¼˜åŒ–å™¨æ‰§è¡Œå®Œå°±è¿›å…¥<strong>æ‰§è¡Œå™¨</strong>ï¼Œå¼€å§‹æ‰§è¡ŒæŸ¥è¯¢è¯­å¥ç›´åˆ°æŸ¥è¯¢å‡ºæ»¡è¶³æ¡ä»¶çš„æ‰€æœ‰æ•°æ®ï¼Œç„¶åè¿›è¡Œè¿”å›ã€‚</p>\n</li>\n</ul>\n<h3 id=\"MySQL-æŸ¥è¯¢ç¼“å­˜çš„åŠŸèƒ½æœ‰ä½•ä¼˜ç¼ºç‚¹ï¼Ÿ\"><a href=\"#MySQL-æŸ¥è¯¢ç¼“å­˜çš„åŠŸèƒ½æœ‰ä½•ä¼˜ç¼ºç‚¹ï¼Ÿ\" class=\"headerlink\" title=\"MySQL æŸ¥è¯¢ç¼“å­˜çš„åŠŸèƒ½æœ‰ä½•ä¼˜ç¼ºç‚¹ï¼Ÿ\"></a>MySQL æŸ¥è¯¢ç¼“å­˜çš„åŠŸèƒ½æœ‰ä½•ä¼˜ç¼ºç‚¹ï¼Ÿ</h3><p>ä¼˜ç‚¹æ˜¯æ•ˆç‡é«˜ï¼Œå¦‚æœå·²ç»æœ‰ç¼“å­˜åˆ™ä¼šç›´æ¥è¿”å›ç»“æœã€‚ </p>\n<p>ä½†æ˜¯ï¼Œå¦‚æœæ•°æ®åº“è¡¨ä¸­æ•°æ®å’Œç»“æ„å‘ç”Ÿå˜åŒ–æ—¶ï¼ˆå¢åˆ æ”¹ã€è¡¨ç»“æ„è°ƒæ•´ï¼‰ï¼ŒæŸ¥è¯¢ç¼“å­˜å°†ä¼šå¤±æ•ˆå¹¶è¢«æ¸…é™¤ï¼Œå¯¼è‡´ç¼“å­˜å‘½ä¸­ç‡æ¯”è¾ƒä½ã€‚</p>\n<h3 id=\"MySQL-çš„å¸¸ç”¨å¼•æ“éƒ½æœ‰å“ªäº›ï¼Ÿ\"><a href=\"#MySQL-çš„å¸¸ç”¨å¼•æ“éƒ½æœ‰å“ªäº›ï¼Ÿ\" class=\"headerlink\" title=\"MySQL çš„å¸¸ç”¨å¼•æ“éƒ½æœ‰å“ªäº›ï¼Ÿ\"></a>MySQL çš„å¸¸ç”¨å¼•æ“éƒ½æœ‰å“ªäº›ï¼Ÿ</h3><p>MySQL çš„å¸¸ç”¨å¼•æ“æœ‰ InnoDBã€MyISAMã€Memoryï¼ˆæ‰€æœ‰æ•°æ®æ”¾åœ¨å†…å­˜ä¸­ï¼‰ ç­‰ï¼Œä» MySQL 5.5.5 ç‰ˆæœ¬å¼€å§‹ InnoDB å°±æˆä¸ºäº†é»˜è®¤çš„å­˜å‚¨å¼•æ“ã€‚</p>\n<h3 id=\"MySQL-å¯ä»¥é’ˆå¯¹è¡¨çº§åˆ«è®¾ç½®æ•°æ®åº“å¼•æ“å—ï¼Ÿæ€ä¹ˆè®¾ç½®ï¼Ÿ\"><a href=\"#MySQL-å¯ä»¥é’ˆå¯¹è¡¨çº§åˆ«è®¾ç½®æ•°æ®åº“å¼•æ“å—ï¼Ÿæ€ä¹ˆè®¾ç½®ï¼Ÿ\" class=\"headerlink\" title=\"MySQL å¯ä»¥é’ˆå¯¹è¡¨çº§åˆ«è®¾ç½®æ•°æ®åº“å¼•æ“å—ï¼Ÿæ€ä¹ˆè®¾ç½®ï¼Ÿ\"></a>MySQL å¯ä»¥é’ˆå¯¹è¡¨çº§åˆ«è®¾ç½®æ•°æ®åº“å¼•æ“å—ï¼Ÿæ€ä¹ˆè®¾ç½®ï¼Ÿ</h3><p>å¯ä»¥é’ˆå¯¹ä¸åŒçš„è¡¨è®¾ç½®ä¸åŒçš„å¼•æ“ã€‚åœ¨ create table è¯­å¥ä¸­ä½¿ç”¨ engine&#x3D;å¼•æ“åï¼ˆæ¯”å¦‚ Memoryï¼‰æ¥è®¾ç½®æ­¤è¡¨çš„å­˜å‚¨å¼•æ“ã€‚</p>\n<h3 id=\"InnoDB-v-s-MyISAM\"><a href=\"#InnoDB-v-s-MyISAM\" class=\"headerlink\" title=\"InnoDB v.s. MyISAM\"></a>InnoDB v.s. MyISAM</h3><ul>\n<li><p>æœ€å¤§çš„åŒºåˆ«æ˜¯ InnoDB æ”¯æŒ<strong>äº‹åŠ¡</strong>ï¼Œè€Œ MyISAM ä¸æ”¯æŒäº‹åŠ¡ï¼›</p>\n</li>\n<li><p>InnoDB æ”¯æŒ<strong>å´©æºƒåå®‰å…¨æ¢å¤</strong>ï¼ŒMyISAM ä¸æ”¯æŒå´©æºƒåå®‰å…¨æ¢å¤ï¼›</p>\n</li>\n<li><p>InnoDB æ”¯æŒ<strong>è¡Œé”</strong>ï¼ŒMyISAM ä¸æ”¯æŒè¡Œé”ï¼Œåªæ”¯æŒè¡¨é”ï¼›</p>\n</li>\n<li><p>InnoDB æ”¯æŒ<strong>å¤–é”®</strong>ï¼ŒMyISAM ä¸æ”¯æŒå¤–é”®ï¼›</p>\n</li>\n</ul>\n<h3 id=\"InnoDB-æœ‰å“ªäº›ç‰¹æ€§ï¼Ÿ\"><a href=\"#InnoDB-æœ‰å“ªäº›ç‰¹æ€§ï¼Ÿ\" class=\"headerlink\" title=\"InnoDB æœ‰å“ªäº›ç‰¹æ€§ï¼Ÿ\"></a>InnoDB æœ‰å“ªäº›ç‰¹æ€§ï¼Ÿ</h3><p><strong>1ï¼‰æ’å…¥ç¼“å†²(insert buffer)<strong>ï¼šæ’å…¥ç¼“å†²å¸¦æ¥çš„æ˜¯</strong>æ€§èƒ½</strong>ã€‚å¯¹äºéèšé›†ç´¢å¼•çš„æ’å…¥å’Œæ›´æ–°ï¼Œä¸æ˜¯æ¯ä¸€æ¬¡ç›´æ¥æ’å…¥ç´¢å¼•é¡µä¸­ï¼Œè€Œæ˜¯é¦–å…ˆåˆ¤æ–­æ’å…¥çš„éèšé›†ç´¢å¼•é¡µæ˜¯å¦åœ¨ç¼“å†²æ± ä¸­ï¼Œå¦‚æœåœ¨ï¼Œåˆ™ç›´æ¥æ’å…¥ï¼Œå¦åˆ™ï¼Œå…ˆæ”¾å…¥ä¸€ä¸ªæ’å…¥ç¼“å†²åŒºä¸­ã€‚å¥½ä¼¼æ¬ºéª—æ•°æ®åº“è¿™ä¸ªéèšé›†çš„ç´¢å¼•å·²ç»æ’å…¥åˆ°å¶å­èŠ‚ç‚¹äº†ï¼Œç„¶åå†ä»¥ä¸€å®šçš„é¢‘ç‡æ‰§è¡Œæ’å…¥ç¼“å†²å’Œéèšé›†ç´¢å¼•å¶å­èŠ‚ç‚¹çš„åˆå¹¶æ“ä½œï¼Œè¿™æ—¶é€šå¸¸èƒ½å°†å¤šä¸ªæ’å…¥åˆå¹¶åˆ°ä¸€ä¸ªæ“ä½œä¸­ï¼Œè¿™å°±å¤§å¤§æé«˜äº†å¯¹éèšé›†ç´¢å¼•æ‰§è¡Œæ’å…¥å’Œä¿®æ”¹æ“ä½œçš„æ€§èƒ½ã€‚ï¼ˆ<strong>å¯¹äºéèšé›†ç´¢å¼•é¡µï¼Œä¸æ˜¯ç›´æ¥æ”¾åˆ°ç´¢å¼•é¡µä¸­ï¼Œè€Œæ˜¯å…ˆæ”¾åˆ°ç¼“å†²æ± ä¸­ï¼Œè¿™æ—¶å€™ç¼“å†²æ± ä¸­å¯èƒ½å­˜æ”¾äº†å¤šä¸ªéèšé›†ç´¢å¼•é¡µï¼Œç„¶åå°†è¿™å¤šä¸ªéèšé›†ç´¢å¼•é¡µçš„æ’å…¥åˆå¹¶åˆ°ä¸€ä¸ªæ“ä½œä¸­ï¼Œå–ä»£äº†ä¹‹å‰çš„ä¸€ä¸ªä¸€ä¸ªæ’å…¥</strong>ï¼‰</p>\n<p><strong>2ï¼‰ä¸¤æ¬¡å†™(double write)<strong>ï¼šä¸¤æ¬¡å†™å¸¦æ¥çš„æ˜¯</strong>å¯é æ€§</strong>ï¼Œä¸»è¦ç”¨æ¥è§£å†³éƒ¨åˆ†å†™å¤±è´¥ã€‚doublewrite ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œä¸€éƒ¨åˆ†æ˜¯å†…å­˜ä¸­çš„ doublewrite buffer ï¼Œå¤§å°ä¸º 2Mï¼Œå¦å¤–ä¸€éƒ¨åˆ†å°±æ˜¯ç‰©ç†ç£ç›˜ä¸Šçš„å…±äº«è¡¨ç©ºé—´ä¸­è¿ç»­çš„ 128 ä¸ªé¡µï¼Œå³ä¸¤ä¸ªåŒºï¼Œå¤§å°åŒæ ·ä¸º 2Mã€‚å½“ç¼“å†²æ± çš„ä½œä¸šåˆ·æ–°æ—¶ï¼Œå¹¶ä¸ç›´æ¥å†™ç¡¬ç›˜ï¼Œè€Œæ˜¯é€šè¿‡ memcpy å‡½æ•°å°†è„é¡µå…ˆæ‹·è´åˆ°å†…å­˜ä¸­çš„ doublewrite bufferï¼Œä¹‹åé€šè¿‡ doublewrite buffer å†åˆ†ä¸¤æ¬¡å†™ï¼Œæ¯æ¬¡å†™å…¥ 1M åˆ°å…±äº«è¡¨ç©ºé—´çš„ç‰©ç†ç£ç›˜ä¸Šï¼Œç„¶åé©¬ä¸Šè°ƒç”¨ fsync å‡½æ•°ï¼ŒåŒæ­¥ç£ç›˜ã€‚<strong>ï¼ˆè¦è¿›è¡Œå†™æ“ä½œæ—¶ï¼Œä¸æ˜¯ç›´æ¥å†™ç¡¬ç›˜ï¼Œè€Œæ˜¯å†™æ‹·è´åˆ°å†…å­˜ä¸­çš„ä¸¤æ¬¡å†™ç¼“å†²åŒºå¤§å°2Mï¼Œç„¶åæŠŠä¸¤æ¬¡å†™ç¼“å†²åŒºçš„å†…å®¹åˆ†ä¸¤æ¬¡å†™ï¼ˆæ¯æ¬¡å†™1Mï¼‰åˆ°å…±äº«è¡¨ç©ºé—´çš„ç£ç›˜ä¸Šï¼Œç„¶åå†å°†å…±äº«è¡¨ç©ºé—´çš„å†…å®¹åŒæ­¥åˆ°æ•°æ®æ–‡ä»¶ä¸Šï¼‰</strong></p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes11474088-ad3fb88b0ef6d41d.png\" alt=\"ä¸¤æ¬¡å†™\"> </p>\n<p><strong>3ï¼‰è‡ªé€‚åº”å“ˆå¸Œç´¢å¼•(adaptive hash index)<strong>ï¼šç”±äº InnoDB ä¸æ”¯æŒ hash ç´¢å¼•ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ hash ç´¢å¼•çš„æ•ˆç‡å¾ˆé«˜ï¼Œäºæ˜¯å‡ºç°äº† adaptive hash index åŠŸèƒ½ï¼Œ InnoDB å­˜å‚¨å¼•æ“ä¼šç›‘æ§å¯¹è¡¨ä¸Šç´¢å¼•çš„æŸ¥æ‰¾ï¼Œå¦‚æœè§‚å¯Ÿåˆ°å»ºç«‹ hash ç´¢å¼•å¯ä»¥æé«˜æ€§èƒ½çš„æ—¶å€™ï¼Œåˆ™è‡ªåŠ¨å»ºç«‹ hash ç´¢å¼•ã€‚</strong>ï¼ˆä¸ºäº†æé«˜æ€§èƒ½ä¼šè‡ªåŠ¨å»ºç«‹ä¸€äº› hash ç´¢å¼•ï¼ŒæŸ¥æ‰¾æ•ˆç‡å¾ˆé«˜ï¼Œç›´æ¥é€šè¿‡ hash å€¼å®šä½åˆ°æ•°æ®ï¼‰</strong></p>\n<h3 id=\"ä¸€å¼ è‡ªå¢è¡¨ä¸­æœ‰ä¸‰æ¡æ•°æ®ï¼Œåˆ é™¤äº†ä¸¤æ¡æ•°æ®ä¹‹åé‡å¯æ•°æ®åº“ï¼Œå†æ–°å¢ä¸€æ¡æ•°æ®ï¼Œæ­¤æ—¶è¿™æ¡æ•°æ®çš„-ID-æ˜¯å‡ ï¼Ÿ\"><a href=\"#ä¸€å¼ è‡ªå¢è¡¨ä¸­æœ‰ä¸‰æ¡æ•°æ®ï¼Œåˆ é™¤äº†ä¸¤æ¡æ•°æ®ä¹‹åé‡å¯æ•°æ®åº“ï¼Œå†æ–°å¢ä¸€æ¡æ•°æ®ï¼Œæ­¤æ—¶è¿™æ¡æ•°æ®çš„-ID-æ˜¯å‡ ï¼Ÿ\" class=\"headerlink\" title=\"ä¸€å¼ è‡ªå¢è¡¨ä¸­æœ‰ä¸‰æ¡æ•°æ®ï¼Œåˆ é™¤äº†ä¸¤æ¡æ•°æ®ä¹‹åé‡å¯æ•°æ®åº“ï¼Œå†æ–°å¢ä¸€æ¡æ•°æ®ï¼Œæ­¤æ—¶è¿™æ¡æ•°æ®çš„ ID æ˜¯å‡ ï¼Ÿ\"></a>ä¸€å¼ è‡ªå¢è¡¨ä¸­æœ‰ä¸‰æ¡æ•°æ®ï¼Œåˆ é™¤äº†ä¸¤æ¡æ•°æ®ä¹‹åé‡å¯æ•°æ®åº“ï¼Œå†æ–°å¢ä¸€æ¡æ•°æ®ï¼Œæ­¤æ—¶è¿™æ¡æ•°æ®çš„ ID æ˜¯å‡ ï¼Ÿ</h3><blockquote>\n<p>ç­‰ä»·äºï¼šè‡ªå¢ä¸»é”®èƒ½ä¸èƒ½è¢«æŒä¹…åŒ–çš„é—®é¢˜ï¼Ÿ</p>\n<p>MyISAMï¼šè‡ªå¢ä¸»é”®ä¼šæŒä¹…åŒ–åˆ°æ•°æ®æ–‡ä»¶ä¸­</p>\n<p>InnoDBï¼š<br>    5.7 ä»¥åŠä¹‹å‰ï¼šä¸ä¼šæŒä¹…åŒ–<br>    ä» 8 å¼€å§‹ï¼šè‡ªå¢ä¸»é”®ä¼šæŒä¹…åŒ–åˆ° redo log</p>\n</blockquote>\n<ol>\n<li><p>å¦‚æœè¡¨çš„å¼•æ“ç±»å‹æ˜¯ <strong>MyISAM</strong>ï¼Œé‚£ä¹ˆè¿™æ¡è®°å½•çš„ ID å°±æ˜¯ 4ã€‚å› ä¸º <strong>MyISAMè¡¨ä¼šæŠŠè‡ªå¢ä¸»é”®çš„æœ€å¤§IDè®°å½•åˆ°æ•°æ®æ–‡ä»¶é‡Œé¢</strong>ï¼Œé‡å¯ MySQL åï¼Œè‡ªå¢ä¸»é”®çš„æœ€å¤§ ID ä¹Ÿä¸ä¼šä¸¢å¤±ã€‚</p>\n</li>\n<li><p>å¦‚æœè¡¨çš„å¼•æ“ç±»å‹æ˜¯ <strong>InnoDB</strong>ï¼Œé‚£ä¹ˆè¿™æ¡è®°å½•çš„ ID å°±æ˜¯ 2ã€‚å› ä¸º <strong>InnoDBè¡¨æŠŠè‡ªå¢ä¸»é”®çš„æœ€å¤§IDè®°å½•åˆ°å†…å­˜ä¸­</strong>ï¼Œæ‰€ä»¥é‡å¯æ•°æ®åº“åä¼šä½¿æœ€å¤§ IDï¼ˆå…¶å®æ˜¯ AUTO_INCREMENT è®¡æ•°å™¨çš„å€¼ï¼‰ä¸¢å¤±ï¼›ä¸€æ—¦æ•°æ®åº“é‡æ–°è¿è¡Œï¼Œæ•°æ®åº“ä¼šè‡ªåŠ¨è®¡ç®—è‡ªå¢ä¸»é”®çš„æœ€å¤§ IDï¼ˆ<strong>å…¶å®å°±æ˜¯æŠŠæœ€åä¸€æ¡è®°å½• ID åŠ  1 å¹¶èµ‹å€¼ç»™ AUTO_INCREMENT</strong>ï¼‰å†æ¬¡æ”¾å…¥åˆ°å†…å­˜ä¸­ã€‚</p>\n<p> ã€æ³¨ã€‘<strong>è¿™ä»…ä»…æ˜¯ MySQL 8 ä»¥å‰çš„ç‰ˆæœ¬ï¼Œä¹Ÿå°±æ˜¯ MySQL 5.7 ä»¥åŠä¹‹å‰çš„ç‰ˆæœ¬</strong>ã€‚å› ä¸ºåœ¨ MySQL 8.0 ä¸­ï¼Œ<strong>InnoDB çš„è¡Œä¸ºå·²æ›´æ”¹</strong>ã€‚æ¯æ¬¡æ›´æ”¹æ—¶ï¼Œå½“å‰æœ€å¤§è‡ªåŠ¨å¢é‡è®¡æ•°å™¨å€¼ï¼ˆAUTO_INCREMENTï¼‰éƒ½ä¼šå†™å…¥é‡åšæ—¥å¿— redo logï¼Œå¹¶ä¿å­˜åˆ°æ¯ä¸ªæ£€æŸ¥ç‚¹çš„å¼•æ“ä¸“ç”¨ç³»ç»Ÿè¡¨ä¸­ã€‚è¿™äº›æ›´æ”¹ä½¿å½“å‰çš„æœ€å¤§è‡ªåŠ¨å¢é‡è®¡æ•°å™¨å€¼åœ¨æœåŠ¡å™¨é‡æ–°å¯åŠ¨åä¿æŒä¸å˜ï¼Œä¸ <strong>MyISAM</strong> ä¸€æ ·äº†ã€‚è¯¦è§å®˜æ–¹æ–‡æ¡£ï¼š<a href=\"https://dev.mysql.com/doc/refman/8.0/en/innodb-auto-increment-handling.html#innodb-auto-increment-initialization\">InnoDB AUTO_INCREMENT è®¡æ•°å™¨åˆå§‹åŒ–</a></p>\n<p> ã€æ³¨ã€‘å¦‚æœåˆ é™¤çš„ä¸æ˜¯æœ€åçš„è®°å½•ï¼Œé‚£ä¹ˆè‡ªå¢çš„æœ€å¤§ ID å…¨éƒ¨éƒ½ä¸€æ ·ï¼Œå› ä¸ºè‡ªåŠ¨å¢é‡è®¡æ•°å™¨å€¼ï¼ˆAUTO_INCREMENTï¼‰ä¸ä¼šæ”¹å˜ã€‚</p>\n</li>\n</ol>\n<h3 id=\"MySQL-ä¸­ä»€ä¹ˆæƒ…å†µä¼šå¯¼è‡´è‡ªå¢ä¸»é”®ä¸èƒ½è¿ç»­ï¼Ÿ\"><a href=\"#MySQL-ä¸­ä»€ä¹ˆæƒ…å†µä¼šå¯¼è‡´è‡ªå¢ä¸»é”®ä¸èƒ½è¿ç»­ï¼Ÿ\" class=\"headerlink\" title=\"MySQL ä¸­ä»€ä¹ˆæƒ…å†µä¼šå¯¼è‡´è‡ªå¢ä¸»é”®ä¸èƒ½è¿ç»­ï¼Ÿ\"></a>MySQL ä¸­ä»€ä¹ˆæƒ…å†µä¼šå¯¼è‡´è‡ªå¢ä¸»é”®ä¸èƒ½è¿ç»­ï¼Ÿ</h3><blockquote>\n<ol>\n<li>å”¯ä¸€é”®å†²çª</li>\n<li>äº‹åŠ¡å›æ»š</li>\n</ol>\n</blockquote>\n<ul>\n<li><p>æ‰§è¡Œå™¨æ‰§è¡Œæ’å…¥ï¼Œè‡ªå¢é”®+1ï¼Œä½†æ˜¯ innoDB å‘ç°æ’å…¥æ—¶<strong>å”¯ä¸€é”®å†²çª</strong>ï¼Œæ— æ³•æ’å…¥ï¼Œå¯¼è‡´çš„ä¸è¿ç»­ã€‚</p>\n</li>\n<li><p>äº‹åŠ¡æ·»åŠ è‡ªå¢é”®+1ï¼Œä½†æ˜¯ç”±äº<strong>äº‹åŠ¡å›æ»š</strong>ï¼Œæ•°æ®è¢«æ¸…é™¤ï¼Œå¯¼è‡´çš„ä¸è¿ç»­ã€‚</p>\n</li>\n</ul>\n<h3 id=\"ä»€ä¹ˆæ˜¯è¦†ç›–ç´¢å¼•ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯è¦†ç›–ç´¢å¼•ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯è¦†ç›–ç´¢å¼•ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯è¦†ç›–ç´¢å¼•ï¼Ÿ</h3><p>è¦†ç›–ç´¢å¼•æ˜¯æŒ‡ï¼Œç´¢å¼•ä¸Šçš„ä¿¡æ¯è¶³å¤Ÿæ»¡è¶³æŸ¥è¯¢è¯·æ±‚ï¼Œä¸éœ€è¦å†å›åˆ°ä¸»é”®ä¸Šå»å–æ•°æ®å³å›è¡¨ã€‚</p>\n<h3 id=\"å¦‚æœæŠŠä¸€ä¸ª-InnoDB-è¡¨çš„ä¸»é”®åˆ æ‰ï¼Œæ˜¯ä¸æ˜¯å°±æ²¡æœ‰ä¸»é”®ï¼Œå°±æ²¡åŠæ³•è¿›è¡Œå›è¡¨æŸ¥è¯¢äº†ï¼Ÿ\"><a href=\"#å¦‚æœæŠŠä¸€ä¸ª-InnoDB-è¡¨çš„ä¸»é”®åˆ æ‰ï¼Œæ˜¯ä¸æ˜¯å°±æ²¡æœ‰ä¸»é”®ï¼Œå°±æ²¡åŠæ³•è¿›è¡Œå›è¡¨æŸ¥è¯¢äº†ï¼Ÿ\" class=\"headerlink\" title=\"å¦‚æœæŠŠä¸€ä¸ª InnoDB è¡¨çš„ä¸»é”®åˆ æ‰ï¼Œæ˜¯ä¸æ˜¯å°±æ²¡æœ‰ä¸»é”®ï¼Œå°±æ²¡åŠæ³•è¿›è¡Œå›è¡¨æŸ¥è¯¢äº†ï¼Ÿ\"></a>å¦‚æœæŠŠä¸€ä¸ª InnoDB è¡¨çš„ä¸»é”®åˆ æ‰ï¼Œæ˜¯ä¸æ˜¯å°±æ²¡æœ‰ä¸»é”®ï¼Œå°±æ²¡åŠæ³•è¿›è¡Œå›è¡¨æŸ¥è¯¢äº†ï¼Ÿ</h3><p>å¦‚æœæŠŠä¸»é”®åˆ æ‰äº†ï¼Œé‚£ä¹ˆ InnoDB ä¼šè‡ªå·±ç”Ÿæˆä¸€ä¸ªé•¿åº¦ä¸º 6 å­—èŠ‚çš„ rowid ä½œä¸ºä¸»é”®ã€‚</p>\n<h3 id=\"å†…å­˜è¡¨å’Œä¸´æ—¶è¡¨æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"><a href=\"#å†…å­˜è¡¨å’Œä¸´æ—¶è¡¨æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"å†…å­˜è¡¨å’Œä¸´æ—¶è¡¨æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"></a>å†…å­˜è¡¨å’Œä¸´æ—¶è¡¨æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p>å†…å­˜è¡¨ï¼ŒæŒ‡çš„æ˜¯ä½¿ç”¨ Memory å¼•æ“çš„è¡¨ï¼Œæ•°æ®æ”¾åœ¨å†…å­˜ä¸­ï¼Œé‡å¯ä¼šè¢«æ¸…ç©ºï¼›</p>\n<p>ä¸´æ—¶è¡¨ï¼ŒæŒ‡çš„æ˜¯ä½¿ç”¨ InnoDB å¼•æ“æˆ–è€… MyISAM å¼•æ“çš„è¡¨ï¼Œæ•°æ®æ”¾åœ¨ç£ç›˜ä¸Šï¼Œé‡å¯ä¸ä¼šæ¸…ç©ºã€‚</p>\n<h3 id=\"MySQL-ä¸­çš„å­—ç¬¦ä¸²ç±»å‹éƒ½æœ‰å“ªäº›ï¼Ÿ\"><a href=\"#MySQL-ä¸­çš„å­—ç¬¦ä¸²ç±»å‹éƒ½æœ‰å“ªäº›ï¼Ÿ\" class=\"headerlink\" title=\"MySQL ä¸­çš„å­—ç¬¦ä¸²ç±»å‹éƒ½æœ‰å“ªäº›ï¼Ÿ\"></a>MySQL ä¸­çš„å­—ç¬¦ä¸²ç±»å‹éƒ½æœ‰å“ªäº›ï¼Ÿ</h3><table>\n<thead>\n<tr>\n<th><strong>ç±»å‹</strong></th>\n<th><strong>å–å€¼èŒƒå›´</strong></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>CHAR(N)</td>\n<td>0~255</td>\n</tr>\n<tr>\n<td>VARCHAR(N)</td>\n<td>0~65536</td>\n</tr>\n<tr>\n<td>TINYBLOB</td>\n<td>0~255</td>\n</tr>\n<tr>\n<td>BLOB</td>\n<td>0~65535</td>\n</tr>\n<tr>\n<td>MEDUIMBLOB</td>\n<td>0~167772150</td>\n</tr>\n<tr>\n<td>LONGBLOB</td>\n<td>0~4294967295</td>\n</tr>\n<tr>\n<td>TINYTEXT</td>\n<td>0~255</td>\n</tr>\n<tr>\n<td>TEXT</td>\n<td>0~65535</td>\n</tr>\n<tr>\n<td>MEDIUMTEXT</td>\n<td>0~167772150</td>\n</tr>\n<tr>\n<td>LONGTEXT</td>\n<td>0~4294967295</td>\n</tr>\n<tr>\n<td>VARBINARY(N)</td>\n<td>0~Nä¸ªå­—èŠ‚çš„å˜é•¿å­—èŠ‚å­—ç¬¦é›†</td>\n</tr>\n<tr>\n<td>BINARY(N)</td>\n<td>0~Nä¸ªå­—èŠ‚çš„å®šé•¿å­—èŠ‚å­—ç¬¦é›†</td>\n</tr>\n</tbody></table>\n<h3 id=\"VARCHAR-å’Œ-CHAR-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿåˆ†åˆ«é€‚ç”¨çš„åœºæ™¯æœ‰å“ªäº›ï¼Ÿ\"><a href=\"#VARCHAR-å’Œ-CHAR-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿåˆ†åˆ«é€‚ç”¨çš„åœºæ™¯æœ‰å“ªäº›ï¼Ÿ\" class=\"headerlink\" title=\"VARCHAR å’Œ CHAR çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿåˆ†åˆ«é€‚ç”¨çš„åœºæ™¯æœ‰å“ªäº›ï¼Ÿ\"></a>VARCHAR å’Œ CHAR çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿåˆ†åˆ«é€‚ç”¨çš„åœºæ™¯æœ‰å“ªäº›ï¼Ÿ</h3><p>VARCHAR çš„é•¿åº¦æ˜¯å¯å˜çš„ï¼Œè€Œ CHAR æ˜¯å›ºå®šé•¿åº¦ã€‚ç”±äºå®ƒä»¬çš„ç‰¹æ€§å†³å®šäº† CHAR æ¯”è¾ƒé€‚åˆé•¿åº¦è¾ƒçŸ­çš„å­—æ®µå’Œå›ºå®šé•¿åº¦çš„å­—æ®µï¼Œå¦‚èº«ä»½è¯å·ã€æ‰‹æœºå·ç­‰ï¼Œåä¹‹åˆ™é€‚åˆä½¿ç”¨ VARCHARã€‚</p>\n<h3 id=\"MySQL-å­˜å‚¨é‡‘é¢åº”è¯¥ä½¿ç”¨å“ªç§æ•°æ®ç±»å‹ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ\"><a href=\"#MySQL-å­˜å‚¨é‡‘é¢åº”è¯¥ä½¿ç”¨å“ªç§æ•°æ®ç±»å‹ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"MySQL å­˜å‚¨é‡‘é¢åº”è¯¥ä½¿ç”¨å“ªç§æ•°æ®ç±»å‹ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ\"></a>MySQL å­˜å‚¨é‡‘é¢åº”è¯¥ä½¿ç”¨å“ªç§æ•°æ®ç±»å‹ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</h3><p>MySQL å­˜å‚¨é‡‘é¢åº”è¯¥ä½¿ç”¨ <code>decimal</code> ï¼Œå› ä¸ºå¦‚æœå­˜å‚¨å…¶ä»–æ•°æ®ç±»å‹ï¼Œæ¯”å¦‚ <code>float</code> æœ‰å¯¼è‡´å°æ•°ç‚¹åæ•°æ®ä¸¢å¤±çš„é£é™©ã€‚</p>\n<h3 id=\"limit-3-2-çš„å«ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#limit-3-2-çš„å«ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"limit 3,2 çš„å«ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>limit 3,2 çš„å«ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>å»é™¤å‰ä¸‰æ¡æ•°æ®ä¹‹åæŸ¥è¯¢ä¸¤æ¡ä¿¡æ¯ã€‚</p>\n<h3 id=\"lastinsertid-å‡½æ•°åŠŸèƒ½æ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ\"><a href=\"#lastinsertid-å‡½æ•°åŠŸèƒ½æ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ\" class=\"headerlink\" title=\"lastinsertid() å‡½æ•°åŠŸèƒ½æ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ\"></a><em>lastinsertid()</em> å‡½æ•°åŠŸèƒ½æ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ</h3><p><em>lastinsertid()</em> ç”¨äºæŸ¥è¯¢æœ€åä¸€æ¬¡è‡ªå¢è¡¨çš„ç¼–å·ï¼ˆå…¨å±€çš„ï¼‰ï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯æŸ¥è¯¢æ—¶ä¸éœ€è¦æŒ‡å®šè¡¨åï¼Œä½¿ç”¨ <code>select last_insert_id()</code> å³å¯æŸ¥è¯¢ï¼Œå› ä¸ºä¸éœ€è¦æŒ‡å®šè¡¨åæ‰€ä»¥å®ƒå§‹ç»ˆä»¥æœ€åä¸€æ¡è‡ªå¢ç¼–å·ä¸ºä¸»ï¼Œå¯ä»¥è¢«å…¶å®ƒè¡¨çš„è‡ªå¢ç¼–å·è¦†ç›–ã€‚æ¯”å¦‚ A è¡¨çš„æœ€å¤§ç¼–å·æ˜¯ 10ï¼Œ <em>lastinsertid()</em> æŸ¥è¯¢å‡ºæ¥çš„å€¼ä¸º 10ï¼Œè¿™æ—¶ B è¡¨æ’å…¥äº†ä¸€æ¡æ•°æ®ï¼Œå®ƒçš„æœ€å¤§ç¼–å·ä¸º 3ï¼Œè¿™ä¸ªæ—¶å€™ä½¿ç”¨ <em>lastinsertid()</em> æŸ¥è¯¢çš„å€¼å°±æ˜¯ 3ã€‚</p>\n<h3 id=\"åˆ é™¤è¡¨çš„æ•°æ®æœ‰å‡ ç§æ–¹å¼ï¼Ÿå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"><a href=\"#åˆ é™¤è¡¨çš„æ•°æ®æœ‰å‡ ç§æ–¹å¼ï¼Ÿå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"åˆ é™¤è¡¨çš„æ•°æ®æœ‰å‡ ç§æ–¹å¼ï¼Ÿå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"></a>åˆ é™¤è¡¨çš„æ•°æ®æœ‰å‡ ç§æ–¹å¼ï¼Ÿå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p>åˆ é™¤æ•°æ®æœ‰ä¸¤ç§æ–¹å¼ï¼šdelete å’Œ truncateï¼Œå®ƒä»¬çš„åŒºåˆ«å¦‚ä¸‹ï¼š</p>\n<ul>\n<li><p>delete å¯ä»¥æ·»åŠ  where æ¡ä»¶åˆ é™¤éƒ¨åˆ†æ•°æ®ï¼Œtruncate ä¸èƒ½æ·»åŠ  where æ¡ä»¶åªèƒ½åˆ é™¤æ•´å¼ è¡¨ï¼›</p>\n</li>\n<li><p>delete çš„åˆ é™¤ä¿¡æ¯ä¼šåœ¨ MySQL çš„æ—¥å¿—ä¸­è®°å½•ï¼Œè€Œ truncate çš„åˆ é™¤ä¿¡æ¯ä¸è¢«è®°å½•åœ¨ MySQL çš„æ—¥å¿—ä¸­ï¼Œ<br>å› æ­¤ detele çš„ä¿¡æ¯å¯ä»¥è¢«æ‰¾å›è€Œ truncate çš„ä¿¡æ¯æ— æ³•è¢«æ‰¾å›ï¼›</p>\n</li>\n<li><p>truncate å› ä¸ºä¸è®°å½•æ—¥å¿—æ‰€ä»¥æ‰§è¡Œæ•ˆç‡æ¯” delete å¿«ã€‚</p>\n</li>\n</ul>\n<h3 id=\"MySQL-ä¸­æ”¯æŒå‡ ç§æ¨¡ç³ŠæŸ¥è¯¢ï¼Ÿå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"><a href=\"#MySQL-ä¸­æ”¯æŒå‡ ç§æ¨¡ç³ŠæŸ¥è¯¢ï¼Ÿå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"MySQL ä¸­æ”¯æŒå‡ ç§æ¨¡ç³ŠæŸ¥è¯¢ï¼Ÿå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"></a>MySQL ä¸­æ”¯æŒå‡ ç§æ¨¡ç³ŠæŸ¥è¯¢ï¼Ÿå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p>MySQL ä¸­æ”¯æŒä¸¤ç§æ¨¡ç³ŠæŸ¥è¯¢ï¼šregexp å’Œ like<br>like æ˜¯å¯¹ä»»æ„å¤šå­—ç¬¦åŒ¹é…æˆ–ä»»æ„å•å­—ç¬¦è¿›è¡Œæ¨¡ç³ŠåŒ¹é…ï¼Œ<br>è€Œ regexp åˆ™æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…æ–¹å¼ï¼Œæä¾›æ¯” like æ›´å¤šçš„åŒ¹é…æ–¹å¼ã€‚<br>regexp å’Œ like çš„ä½¿ç”¨ç¤ºä¾‹å¦‚ä¸‹ï¼š </p>\n<blockquote>\n<p>select * from person where uname like â€˜%SQL%â€™;<br>select * from person where uname regexp â€˜.SQL*.â€™; </p>\n</blockquote>\n<h3 id=\"count-column-å’Œ-count-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"><a href=\"#count-column-å’Œ-count-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"count(column) å’Œ count(*) æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"></a><em>count(column)</em> å’Œ <em>count(*)</em> æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p><em>count(column)</em> ç»Ÿè®¡ä¸ä¼šç»Ÿè®¡åˆ—å€¼ä¸º null çš„æ•°æ®ï¼Œ<br>è€Œ <em>count(*)</em> åˆ™ä¼šç»Ÿè®¡æ‰€æœ‰ä¿¡æ¯ï¼Œæ‰€ä»¥æœ€ç»ˆçš„ç»Ÿè®¡ç»“æœå¯èƒ½ä¼šä¸åŒã€‚</p>\n<h3 id=\"ä¸ºä»€ä¹ˆ-InnoDB-ä¸æŠŠæ€»æ¡æ•°è®°å½•ä¸‹æ¥ï¼ŒæŸ¥è¯¢çš„æ—¶å€™ç›´æ¥è¿”å›å‘¢ï¼Ÿ\"><a href=\"#ä¸ºä»€ä¹ˆ-InnoDB-ä¸æŠŠæ€»æ¡æ•°è®°å½•ä¸‹æ¥ï¼ŒæŸ¥è¯¢çš„æ—¶å€™ç›´æ¥è¿”å›å‘¢ï¼Ÿ\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆ InnoDB ä¸æŠŠæ€»æ¡æ•°è®°å½•ä¸‹æ¥ï¼ŒæŸ¥è¯¢çš„æ—¶å€™ç›´æ¥è¿”å›å‘¢ï¼Ÿ\"></a>ä¸ºä»€ä¹ˆ InnoDB ä¸æŠŠæ€»æ¡æ•°è®°å½•ä¸‹æ¥ï¼ŒæŸ¥è¯¢çš„æ—¶å€™ç›´æ¥è¿”å›å‘¢ï¼Ÿ</h3><p>å› ä¸º <strong>InnoDB æ”¯æŒäº‹åŠ¡</strong>ï¼Œå³ä½¿æ˜¯åœ¨åŒä¸€æ—¶é—´è¿›è¡ŒæŸ¥è¯¢ï¼Œå¾—åˆ°çš„ç»“æœä¹Ÿå¯èƒ½ä¸ç›¸åŒï¼Œæ‰€ä»¥ InnoDB ä¸èƒ½æŠŠç»“æœç›´æ¥ä¿å­˜ä¸‹æ¥ï¼Œå› ä¸ºè¿™æ ·æ˜¯ä¸å‡†ç¡®çš„ã€‚</p>\n<h3 id=\"InnoDB-å’Œ-MyISAM-æ‰§è¡Œ-select-count-from-tï¼Œå“ªä¸ªæ•ˆç‡æ›´é«˜ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ\"><a href=\"#InnoDB-å’Œ-MyISAM-æ‰§è¡Œ-select-count-from-tï¼Œå“ªä¸ªæ•ˆç‡æ›´é«˜ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"InnoDB å’Œ MyISAM æ‰§è¡Œ select count(*) from tï¼Œå“ªä¸ªæ•ˆç‡æ›´é«˜ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ\"></a>InnoDB å’Œ MyISAM æ‰§è¡Œ select count(*) from tï¼Œå“ªä¸ªæ•ˆç‡æ›´é«˜ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</h3><p>MyISAM æ•ˆç‡æœ€é«˜ï¼Œå› ä¸º MyISAM å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªè®¡æ•°å™¨ï¼Œç›´æ¥è¿”å›æ€»æ¡æ•°ï¼Œè€Œ InnoDB è¦é€è¡Œç»Ÿè®¡ã€‚</p>\n<h3 id=\"åœ¨-InnoDB-å¼•æ“ä¸­-count-ã€count-1-ã€count-ä¸»é”®-ã€count-å­—æ®µ-å“ªä¸ªæ€§èƒ½æœ€é«˜ï¼Ÿ\"><a href=\"#åœ¨-InnoDB-å¼•æ“ä¸­-count-ã€count-1-ã€count-ä¸»é”®-ã€count-å­—æ®µ-å“ªä¸ªæ€§èƒ½æœ€é«˜ï¼Ÿ\" class=\"headerlink\" title=\"åœ¨ InnoDB å¼•æ“ä¸­ count(*)ã€count(1)ã€count(ä¸»é”®)ã€count(å­—æ®µ) å“ªä¸ªæ€§èƒ½æœ€é«˜ï¼Ÿ\"></a>åœ¨ InnoDB å¼•æ“ä¸­ count(*)ã€count(1)ã€count(ä¸»é”®)ã€count(å­—æ®µ) å“ªä¸ªæ€§èƒ½æœ€é«˜ï¼Ÿ</h3><p>count(å­—æ®µ)&lt;count(ä¸»é”® id)&lt;count(1)â‰ˆcount(*) é¢˜ç›®è§£æï¼š</p>\n<ul>\n<li>å¯¹äº count(å­—æ®µ) æ¥è¯´ï¼Œéå†æ•´å¼ è¡¨ï¼Œå–è¿™ä¸ªå­—æ®µï¼Œç„¶ååˆ¤æ–­æ˜¯å¦ä¸º nullï¼Œä¸ä¸º null åˆ™åŠ  1</li>\n<li>å¯¹äº count(ä¸»é”® id) æ¥è¯´ï¼Œéå†æ•´å¼ è¡¨ï¼Œå–ä¸»é”® idï¼Œä¸å¯èƒ½ä¸ºç©ºï¼Œæ¯æ¬¡åŠ  1ã€‚ä½†æ˜¯å¯èƒ½ä½¿ç”¨æœ€å°çš„ç´¢å¼•æ ‘ã€‚</li>\n<li>å¯¹äº count(1) æ¥è¯´ï¼Œéå†æ•´å¼ è¡¨ï¼Œä¸å–å€¼ã€‚1 æ˜¯ä¸å¯èƒ½ä¸ºç©ºçš„ï¼Œæ¯æ¬¡åŠ  1ã€‚</li>\n<li>å¯¹äº count(*) æ¥è¯´ï¼Œéå†æ•´å¼ è¡¨ï¼Œä¸å–å€¼ï¼Œç›´æ¥æŒ‰è¡Œç´¯åŠ ã€‚å®é™…ä¸Šï¼Œå½“ä½¿ç”¨ count(*) æ—¶ï¼ŒMySQL ä¼šå°† * å‚æ•°è½¬åŒ–ä¸ºå‚æ•° 0 æ¥å¤„ç†ã€‚</li>\n</ul>\n<p>æ‰€ä»¥æœ€åå¾—å‡ºçš„ç»“æœæ˜¯ï¼šcount(å­—æ®µ)&lt;count(ä¸»é”® id)&lt;count(1)â‰ˆcount(*)ã€‚</p>\n<h3 id=\"MySQL-ä¸­å†…è¿æ¥ã€å·¦è¿æ¥ã€å³è¿æ¥æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"><a href=\"#MySQL-ä¸­å†…è¿æ¥ã€å·¦è¿æ¥ã€å³è¿æ¥æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"MySQL ä¸­å†…è¿æ¥ã€å·¦è¿æ¥ã€å³è¿æ¥æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"></a>MySQL ä¸­å†…è¿æ¥ã€å·¦è¿æ¥ã€å³è¿æ¥æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><ul>\n<li><p>å†…è¿ï¼ˆinner joinï¼‰â€” æŠŠåŒ¹é…çš„å…³è”æ•°æ®æ˜¾ç¤ºå‡ºæ¥ï¼›</p>\n</li>\n<li><p>å·¦è¿æ¥ï¼ˆleft joinï¼‰â€” æŠŠå·¦è¾¹çš„è¡¨å…¨éƒ¨æ˜¾ç¤ºå‡ºæ¥ï¼Œå³è¾¹çš„è¡¨æ˜¾ç¤ºå‡ºç¬¦åˆæ¡ä»¶çš„æ•°æ®ï¼›</p>\n</li>\n<li><p>å³è¿æ¥ï¼ˆright joinï¼‰â€” æŠŠå³è¾¹çš„è¡¨å…¨éƒ¨æ˜¾ç¤ºå‡ºæ¥ï¼Œå·¦è¾¹çš„è¡¨æ˜¾ç¤ºå‡ºç¬¦åˆæ¡ä»¶çš„æ•°æ®ï¼›</p>\n</li>\n</ul>\n<h2 id=\"MySQLç´¢å¼•ç¯‡\"><a href=\"#MySQLç´¢å¼•ç¯‡\" class=\"headerlink\" title=\"MySQLç´¢å¼•ç¯‡\"></a>MySQLç´¢å¼•ç¯‡</h2><h3 id=\"ä»€ä¹ˆæ˜¯ç´¢å¼•ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯ç´¢å¼•ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ç´¢å¼•ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯ç´¢å¼•ï¼Ÿ</h3><p>ç´¢å¼•æ˜¯ä¸€ç§èƒ½å¸®åŠ© MySQL æé«˜æŸ¥è¯¢æ•ˆç‡çš„æ•°æ®ç»“æ„ã€‚</p>\n<h3 id=\"ç´¢å¼•åˆ†åˆ«æœ‰å“ªäº›ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Ÿ\"><a href=\"#ç´¢å¼•åˆ†åˆ«æœ‰å“ªäº›ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Ÿ\" class=\"headerlink\" title=\"ç´¢å¼•åˆ†åˆ«æœ‰å“ªäº›ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Ÿ\"></a>ç´¢å¼•åˆ†åˆ«æœ‰å“ªäº›ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Ÿ</h3><p><strong>ç´¢å¼•çš„ä¼˜ç‚¹ï¼š</strong></p>\n<ul>\n<li>æé«˜æŸ¥è¯¢æ•ˆç‡</li>\n</ul>\n<p><strong>ç´¢å¼•çš„ç¼ºç‚¹ï¼š</strong></p>\n<ul>\n<li><p>è™½ç„¶æé«˜äº†æŸ¥è¯¢é€Ÿåº¦ï¼Œä½†å´é™ä½äº†æ›´æ–°è¡¨çš„é€Ÿåº¦ï¼Œæ¯”å¦‚ updateã€insertï¼›<br>å› ä¸ºæ›´æ–°æ•°æ®æ—¶ï¼ŒMySQL ä¸ä»…è¦æ›´æ–°æ•°æ®ï¼Œè¿˜è¦æ›´æ–°ç´¢å¼•æ–‡ä»¶ï¼›</p>\n</li>\n<li><p>å»ºç«‹ç´¢å¼•çš„ç´¢å¼•æ–‡ä»¶ä¼šå ç”¨ç£ç›˜ã€‚</p>\n</li>\n</ul>\n<h3 id=\"MySQLç´¢å¼•çš„æ³¨æ„äº‹é¡¹\"><a href=\"#MySQLç´¢å¼•çš„æ³¨æ„äº‹é¡¹\" class=\"headerlink\" title=\"MySQLç´¢å¼•çš„æ³¨æ„äº‹é¡¹\"></a>MySQLç´¢å¼•çš„æ³¨æ„äº‹é¡¹</h3><p><strong>1ã€è”åˆç´¢å¼•éµå¾ªå‰ç¼€åŸåˆ™</strong></p>\n<p><strong>2ã€likeæ¨¡ç³ŠæŸ¥è¯¢ï¼Œ%ä¸èƒ½åœ¨å‰</strong></p>\n<p><strong>3ã€</strong>åˆ—å€¼ä¸ºç©ºï¼ˆNULLï¼‰æ—¶æ˜¯å¯ä»¥ä½¿ç”¨ç´¢å¼•çš„ï¼Œä½† MySQL éš¾ä»¥ä¼˜åŒ–å¼•ç”¨äº†å¯ç©ºåˆ—çš„æŸ¥è¯¢,å®ƒä¼šä½¿ç´¢å¼•ã€ç´¢å¼•ç»Ÿè®¡å’Œå€¼æ›´åŠ å¤æ‚ã€‚å¯ç©ºåˆ—éœ€è¦æ›´å¤šçš„å‚¨å­˜ç©ºé—´ï¼Œè¿˜éœ€è¦åœ¨ MySQL å†…éƒ¨è¿›è¡Œç‰¹æ®Šå¤„ç†ã€‚</p>\n<p><strong>4ã€</strong> å¦‚æœ MySQL ä¼°è®¡ä½¿ç”¨ç´¢å¼•æ¯”å…¨è¡¨æ‰«ææ›´æ…¢ï¼Œä¼šæ”¾å¼ƒä½¿ç”¨ç´¢å¼•ï¼Œä¾‹å¦‚ï¼š<br>è¡¨ä¸­åªæœ‰ 100 æ¡æ•°æ®å·¦å³ã€‚å¯¹äº SQL è¯­å¥ WHERE id &gt; 1 AND id &lt; 100ï¼ŒMySQL ä¼šä¼˜å…ˆè€ƒè™‘å…¨è¡¨æ‰«æã€‚</p>\n<p><strong>5ã€</strong> <strong>å¦‚æœå…³é”®è¯orå‰é¢çš„æ¡ä»¶ä¸­çš„åˆ—æœ‰ç´¢å¼•ï¼Œåé¢çš„æ²¡æœ‰ï¼Œæ‰€æœ‰åˆ—çš„ç´¢å¼•éƒ½ä¸ä¼šè¢«ç”¨åˆ°ã€‚</strong></p>\n<p><strong>6ã€</strong> åˆ—ç±»å‹æ˜¯å­—ç¬¦ä¸²ï¼ŒæŸ¥è¯¢æ—¶ä¸€å®šè¦ç»™å€¼åŠ å¼•å·ï¼Œå¦åˆ™ç´¢å¼•å¤±æ•ˆï¼Œä¾‹å¦‚ï¼š<br>åˆ— name varchar(16)ï¼Œå­˜å‚¨äº†å­—ç¬¦ä¸²â€100â€<br>WHERE name &#x3D; 100;  ï¼ˆåšäº†è‡ªåŠ¨ç±»å‹è½¬æ¢ï¼‰<br>ä»¥ä¸Š SQL è¯­å¥èƒ½æœåˆ°ï¼Œä½†æ— æ³•ç”¨åˆ°ç´¢å¼•ã€‚</p>\n<p><strong>7ã€ä¸åœ¨ç´¢å¼•åˆ—ä¸Šåšä»»ä½•æ“ä½œï¼ˆè®¡ç®—ã€å‡½æ•°ã€ï¼ˆè‡ªåŠ¨æˆ–æ‰‹åŠ¨ï¼‰ç±»å‹è½¬æ¢ï¼‰ï¼Œä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆè€Œè½¬å‘å…¨è¡¨æ‰«æ</strong> </p>\n<h3 id=\"ä¸ºä»€ä¹ˆ-MySQL-å®˜æ–¹å»ºè®®ä½¿ç”¨è‡ªå¢ä¸»é”®ä½œä¸ºè¡¨çš„ä¸»é”®ï¼Ÿ\"><a href=\"#ä¸ºä»€ä¹ˆ-MySQL-å®˜æ–¹å»ºè®®ä½¿ç”¨è‡ªå¢ä¸»é”®ä½œä¸ºè¡¨çš„ä¸»é”®ï¼Ÿ\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆ MySQL å®˜æ–¹å»ºè®®ä½¿ç”¨è‡ªå¢ä¸»é”®ä½œä¸ºè¡¨çš„ä¸»é”®ï¼Ÿ\"></a>ä¸ºä»€ä¹ˆ MySQL å®˜æ–¹å»ºè®®ä½¿ç”¨è‡ªå¢ä¸»é”®ä½œä¸ºè¡¨çš„ä¸»é”®ï¼Ÿ</h3><p>ä¼˜ç‚¹ï¼š</p>\n<ol>\n<li><p>é¡µåˆ†è£‚é—®é¢˜ã€‚å¦‚æœä½¿ç”¨éè‡ªå¢ä¸»é”®ä½œä¸ºè¡¨çš„ä¸»é”®çš„è¯ï¼Œå½“æ–°æ’å…¥çš„æ•°æ®ä¼šå°†æ•°æ®é¡µå†™æ»¡ï¼Œmysql å°±éœ€è¦ç”³è¯·æ–°çš„æ•°æ®é¡µï¼Œå¹¶ä¸”æŠŠä¸Šä¸ªæ•°æ®é¡µä¸­çš„éƒ¨åˆ†æ•°æ®æŒªåˆ°æ–°çš„æ•°æ®é¡µä¸Šï¼Œä»¥ç¡®ä¿ç´¢å¼•æœ‰åºã€‚ä¹Ÿå°±æ˜¯è¯´é€ æˆäº†é¡µåˆ†è£‚ï¼Œå¤§é‡ç§»åŠ¨æ•°æ®çš„è¿‡ç¨‹ä¸¥é‡å½±å“æ’å…¥æ•ˆç‡ã€‚</p>\n</li>\n<li><p>å­˜å‚¨ç©ºé—´é—®é¢˜ã€‚è‡ªå¢ä¸»é”®å­˜å‚¨ç©ºé—´å°ï¼ŒåŒä¸€ä¸ªç»“ç‚¹å†…èƒ½å­˜æ”¾æ›´å¤šçš„ä¸»é”®ï¼Œæ ‘çš„é«˜åº¦å¯èƒ½é™ä½ï¼Œå‡å°‘ io æ¬¡æ•°ã€‚</p>\n</li>\n</ol>\n<p>ç¼ºç‚¹ï¼š</p>\n<ol>\n<li>æ•°æ®é‡è¿‡å¤§ï¼Œå¯èƒ½ä¼šè¶…å‡ºè‡ªå¢é•¿å–å€¼èŒƒå›´ï¼›</li>\n<li>æ— æ³•æ»¡è¶³åˆ†å¸ƒå¼å­˜å‚¨ï¼Œåˆ†åº“åˆ†è¡¨çš„æƒ…å†µä¸‹æ— æ³•åˆå¹¶è¡¨ï¼›</li>\n<li>ä¸»é”®æœ‰è‡ªå¢è§„å¾‹ï¼Œå®¹æ˜“è¢«ç ´è§£ï¼›</li>\n</ol>\n<p><strong>ç»¼ä¸Šæ‰€è¿°ï¼š</strong>æ˜¯å¦éœ€è¦ä½¿ç”¨è‡ªå¢ä¸»é”®ï¼Œéœ€è¦æ ¹æ®è‡ªå·±çš„ä¸šåŠ¡åœºæ™¯æ¥è®¾è®¡ã€‚å¦‚æœæ˜¯å•è¡¨å•åº“ï¼Œåˆ™ä¼˜å…ˆè€ƒè™‘è‡ªå¢ä¸»é”®ï¼Œå¦‚æœæ˜¯åˆ†å¸ƒå¼å­˜å‚¨ï¼Œåˆ†åº“åˆ†è¡¨ï¼Œåˆ™éœ€è¦è€ƒè™‘æ•°æ®åˆå¹¶çš„ä¸šåŠ¡åœºæ™¯æ¥åšæ•°æ®åº“è®¾è®¡æ–¹æ¡ˆã€‚</p>\n<h3 id=\"ç´¢å¼•æœ‰å‡ ç§ç±»å‹ï¼Ÿåˆ†åˆ«å¦‚ä½•åˆ›å»ºï¼Ÿ\"><a href=\"#ç´¢å¼•æœ‰å‡ ç§ç±»å‹ï¼Ÿåˆ†åˆ«å¦‚ä½•åˆ›å»ºï¼Ÿ\" class=\"headerlink\" title=\"ç´¢å¼•æœ‰å‡ ç§ç±»å‹ï¼Ÿåˆ†åˆ«å¦‚ä½•åˆ›å»ºï¼Ÿ\"></a>ç´¢å¼•æœ‰å‡ ç§ç±»å‹ï¼Ÿåˆ†åˆ«å¦‚ä½•åˆ›å»ºï¼Ÿ</h3><p>**MySQL çš„ç´¢å¼•æœ‰ä¸¤ç§åˆ†ç±»æ–¹å¼ï¼šé€»è¾‘åˆ†ç±»å’Œç‰©ç†åˆ†ç±»ã€‚ **</p>\n<p><strong>æŒ‰ç…§é€»è¾‘åˆ†ç±»ï¼Œç´¢å¼•å¯åˆ†ä¸ºï¼š</strong></p>\n<ul>\n<li>ä¸»é”®ç´¢å¼•ï¼šä¸€å¼ è¡¨åªèƒ½æœ‰ä¸€ä¸ªä¸»é”®ç´¢å¼•ï¼Œä¸å…è®¸é‡å¤ã€ä¸å…è®¸ä¸º NULLï¼›</li>\n<li>å”¯ä¸€ç´¢å¼•ï¼šæ•°æ®åˆ—ä¸å…è®¸é‡å¤ï¼Œå…è®¸ä¸º NULL å€¼ï¼Œä¸€å¼ è¡¨å¯æœ‰å¤šä¸ªå”¯ä¸€ç´¢å¼•ï¼Œä½†æ˜¯ä¸€ä¸ªå”¯ä¸€ç´¢å¼•åªèƒ½åŒ…å«ä¸€åˆ—ï¼Œæ¯”å¦‚èº«ä»½è¯å·ç ã€å¡å·ç­‰éƒ½å¯ä»¥ä½œä¸ºå”¯ä¸€ç´¢å¼•ï¼›</li>\n<li>æ™®é€šç´¢å¼•ï¼šä¸€å¼ è¡¨å¯ä»¥åˆ›å»ºå¤šä¸ªæ™®é€šç´¢å¼•ï¼Œä¸€ä¸ªæ™®é€šç´¢å¼•å¯ä»¥åŒ…å«å¤šä¸ªå­—æ®µï¼Œå…è®¸æ•°æ®é‡å¤ï¼Œå…è®¸ NULL å€¼æ’å…¥ï¼›</li>\n</ul>\n<p><strong>æŒ‰ç…§ç‰©ç†åˆ†ç±»ï¼Œç´¢å¼•å¯åˆ†ä¸ºï¼š</strong></p>\n<ul>\n<li>èšç°‡ç´¢å¼•ï¼šInnoDB çš„ä¸»é”®ç´¢å¼•å­˜å‚¨é‡‡ç”¨èšç°‡ç´¢å¼•ï¼Œä¸»é”®å€¼å’Œæ•°æ®å­˜æ”¾åœ¨ä¸€èµ·</li>\n<li>éèšç°‡ç´¢å¼•ï¼šMyISAM çš„ä¸»é”®ç´¢å¼•å­˜å‚¨é‡‡ç”¨éèšç°‡ç´¢å¼•ï¼Œä¸»é”®å€¼å’ŒæŒ‡å‘æ•°æ®çš„æŒ‡é’ˆå­˜æ”¾åœ¨ä¸€èµ·ï¼Œæ•°æ®å¦å¼€ç©ºé—´å­˜å‚¨</li>\n</ul>\n<p><strong>å„ç§ç´¢å¼•çš„åˆ›å»ºè„šæœ¬å¦‚ä¸‹ï¼š</strong></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºä¸»é”®ç´¢å¼•</span></span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">TABLE</span> <span class=\"keyword\">user</span> <span class=\"keyword\">ADD</span> <span class=\"keyword\">PRIMARY</span> KEY (column_list);</span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºå”¯ä¸€ç´¢å¼•</span></span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">TABLE</span> <span class=\"keyword\">user</span> <span class=\"keyword\">ADD</span> <span class=\"keyword\">UNIQUE</span> index_name (column_list);</span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºæ™®é€šç´¢å¼•</span></span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">TABLE</span> <span class=\"keyword\">user</span> <span class=\"keyword\">ADD</span> INDEX index_name (column_list);</span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºå…¨æ–‡ç´¢å¼•</span></span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">TABLE</span> <span class=\"keyword\">user</span> <span class=\"keyword\">ADD</span> FULLTEXT index_name (column_list);</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"ä»€ä¹ˆå«å›è¡¨æŸ¥è¯¢ï¼Ÿ\"><a href=\"#ä»€ä¹ˆå«å›è¡¨æŸ¥è¯¢ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆå«å›è¡¨æŸ¥è¯¢ï¼Ÿ\"></a>ä»€ä¹ˆå«å›è¡¨æŸ¥è¯¢ï¼Ÿ</h3><p>æ™®é€šç´¢å¼•æŸ¥è¯¢åˆ°ä¸»é”®ç´¢å¼•åï¼Œå›åˆ°ä¸»é”®ç´¢å¼•æ ‘æœç´¢çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬ç§°ä¸ºå›è¡¨æŸ¥è¯¢ã€‚</p>\n<p>ä¹Ÿå°±æ˜¯è¯´ï¼ŒåŸºäºéä¸»é”®ç´¢å¼•çš„æŸ¥è¯¢éœ€è¦å¤šæ‰«æä¸€æ¬¡ä¸»é”®ç´¢å¼•æ ‘ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨åº”ç”¨ä¸­åº”è¯¥å°½é‡ä½¿ç”¨ä¸»é”®æŸ¥è¯¢ã€‚</p>\n<p>ä¾‹å¤–å°±æ˜¯ä½¿ç”¨éä¸»é”®ç´¢å¼•æ—¶ï¼Œå¦‚æœå½“å‰ç´¢å¼•æ»¡è¶³æŸ¥è¯¢éœ€æ±‚ï¼Œåˆ™ä¸ç”¨å›è¡¨ã€‚</p>\n<h3 id=\"åœ¨-InnDB-ä¸­ä¸»é”®ç´¢å¼•ä¸ºä»€ä¹ˆæ¯”æ™®é€šç´¢å¼•çš„æŸ¥è¯¢æ€§èƒ½é«˜ï¼Ÿ\"><a href=\"#åœ¨-InnDB-ä¸­ä¸»é”®ç´¢å¼•ä¸ºä»€ä¹ˆæ¯”æ™®é€šç´¢å¼•çš„æŸ¥è¯¢æ€§èƒ½é«˜ï¼Ÿ\" class=\"headerlink\" title=\"åœ¨ InnDB ä¸­ä¸»é”®ç´¢å¼•ä¸ºä»€ä¹ˆæ¯”æ™®é€šç´¢å¼•çš„æŸ¥è¯¢æ€§èƒ½é«˜ï¼Ÿ\"></a>åœ¨ InnDB ä¸­ä¸»é”®ç´¢å¼•ä¸ºä»€ä¹ˆæ¯”æ™®é€šç´¢å¼•çš„æŸ¥è¯¢æ€§èƒ½é«˜ï¼Ÿ</h3><p>å›è¡¨ã€‚å› ä¸ºæ™®é€šç´¢å¼•çš„æŸ¥è¯¢ä¼šå¤šæ‰§è¡Œä¸€æ¬¡æ£€ç´¢æ“ä½œã€‚æ¯”å¦‚ä¸»é”®æŸ¥è¯¢ select * from t where id&#x3D;10 åªéœ€è¦æœç´¢ id çš„è¿™æ£µ B+ æ ‘ï¼Œè€Œæ™®é€šç´¢å¼•æŸ¥è¯¢ select * from t where f&#x3D;3 ä¼šå…ˆæŸ¥è¯¢ f ç´¢å¼•æ ‘ï¼Œå¾—åˆ° id çš„å€¼ä¹‹åå†å»æœç´¢ id çš„ B+ æ ‘ï¼Œå› ä¸ºå¤šæ‰§è¡Œäº†ä¸€æ¬¡æ£€ç´¢ï¼Œæ‰€ä»¥æ‰§è¡Œæ•ˆç‡å°±æ¯”ä¸»é”®ç´¢å¼•è¦ä½ã€‚</p>\n<h3 id=\"MySQL-å¤åˆç´¢å¼•åº”è¯¥æ³¨æ„ä»€ä¹ˆï¼Ÿ\"><a href=\"#MySQL-å¤åˆç´¢å¼•åº”è¯¥æ³¨æ„ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"MySQL å¤åˆç´¢å¼•åº”è¯¥æ³¨æ„ä»€ä¹ˆï¼Ÿ\"></a>MySQL å¤åˆç´¢å¼•åº”è¯¥æ³¨æ„ä»€ä¹ˆï¼Ÿ</h3><p>MySQL ä¸­çš„å¤åˆç´¢å¼•ï¼Œéµå¾ªæœ€å·¦åŒ¹é…åŸåˆ™ï¼Œæ¯”å¦‚ï¼Œè”åˆç´¢å¼•ä¸º key(a,b,c)ï¼Œåˆ™èƒ½è§¦å‘ç´¢å¼•çš„æœç´¢ç»„åˆæ˜¯ a|ab|abc è¿™ä¸‰ç§æŸ¥è¯¢ã€‚</p>\n<h3 id=\"å¤åˆç´¢å¼•çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#å¤åˆç´¢å¼•çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"å¤åˆç´¢å¼•çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>å¤åˆç´¢å¼•çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</h3><ul>\n<li>ç”¨äºå¤šå­—æ®µæŸ¥è¯¢ï¼Œæ¯”å¦‚ï¼Œå»ºäº†ä¸€ä¸ª key(a,b,c) çš„è”åˆç´¢å¼•ï¼Œé‚£ä¹ˆå®é™…ç­‰äºå»ºäº†<code>key(a)ã€key(a,b)ã€key(a,b,c)</code>ç­‰ä¸‰ä¸ªç´¢å¼•ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œæ¯å¤šä¸€ä¸ªç´¢å¼•ï¼Œå°±ä¼šå¤šä¸€äº›å†™æ“ä½œå’Œå ç”¨ç£ç›˜ç©ºé—´çš„å¼€é”€ï¼Œå°¤å…¶æ˜¯å¯¹å¤§æ•°æ®é‡çš„è¡¨æ¥è¯´ï¼Œè¿™å¯ä»¥å‡å°‘ä¸€éƒ¨åˆ†ä¸å¿…è¦çš„å¼€é”€ï¼›</li>\n<li>è¦†ç›–ç´¢å¼•ï¼Œæ¯”å¦‚ï¼Œå¯¹äºè”åˆç´¢å¼• key(a,b,c) æ¥è¯´ï¼Œå¦‚æœä½¿ç”¨ SQLï¼š<code>select a,b,c from table where a=1 and b = 1</code> ï¼Œå°±å¯ä»¥ç›´æ¥é€šè¿‡éå†ç´¢å¼•å–å¾—æ•°æ®ï¼Œè€Œ<strong>æ— éœ€å›è¡¨æŸ¥è¯¢</strong>ï¼Œè¿™å°±å‡å°‘äº†éšæœºçš„ IO æ“ä½œï¼Œå‡å°‘éšæœºçš„ IO æ“ä½œï¼Œå¯ä»¥æœ‰æ•ˆçš„æå‡æ•°æ®åº“æŸ¥è¯¢çš„æ€§èƒ½ï¼Œæ˜¯éå¸¸é‡è¦çš„æ•°æ®åº“ä¼˜åŒ–æ‰‹æ®µä¹‹ä¸€ï¼›</li>\n<li>ç´¢å¼•åˆ—è¶Šå¤šï¼Œé€šè¿‡ç´¢å¼•ç­›é€‰å‡ºçš„æ•°æ®è¶Šå°‘ã€‚</li>\n</ul>\n<h3 id=\"ä»€ä¹ˆæ˜¯æœ€å·¦åŒ¹é…åŸåˆ™ï¼Ÿå®ƒçš„ç”Ÿæ•ˆåŸåˆ™æœ‰å“ªäº›ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯æœ€å·¦åŒ¹é…åŸåˆ™ï¼Ÿå®ƒçš„ç”Ÿæ•ˆåŸåˆ™æœ‰å“ªäº›ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯æœ€å·¦åŒ¹é…åŸåˆ™ï¼Ÿå®ƒçš„ç”Ÿæ•ˆåŸåˆ™æœ‰å“ªäº›ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯æœ€å·¦åŒ¹é…åŸåˆ™ï¼Ÿå®ƒçš„ç”Ÿæ•ˆåŸåˆ™æœ‰å“ªäº›ï¼Ÿ</h3><p>æœ€å·¦åŒ¹é…åŸåˆ™ä¹Ÿå«æœ€å·¦å‰ç¼€åŸåˆ™ï¼Œæ˜¯ MySQL ä¸­çš„ä¸€ä¸ªé‡è¦åŸåˆ™ï¼Œè¯´çš„æ˜¯ç´¢å¼•ä»¥æœ€å·¦è¾¹çš„ä¸ºèµ·ç‚¹ä»»ä½•è¿ç»­çš„ç´¢å¼•éƒ½èƒ½åŒ¹é…ä¸Šï¼Œå½“é‡åˆ°èŒƒå›´æŸ¥è¯¢ï¼ˆ&gt;ã€&lt;ã€betweenã€likeï¼‰å°±ä¼šåœæ­¢åŒ¹é…ã€‚</p>\n<h3 id=\"ä»¥ä¸‹è¯­å¥ä¼šèµ°ç´¢å¼•ä¹ˆï¼Ÿ\"><a href=\"#ä»¥ä¸‹è¯­å¥ä¼šèµ°ç´¢å¼•ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"ä»¥ä¸‹è¯­å¥ä¼šèµ°ç´¢å¼•ä¹ˆï¼Ÿ\"></a>ä»¥ä¸‹è¯­å¥ä¼šèµ°ç´¢å¼•ä¹ˆï¼Ÿ</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select * from t where year(date)&gt;2018;</span><br></pre></td></tr></table></figure>\n\n<p>ä¸ä¼šï¼Œå› ä¸ºåœ¨ç´¢å¼•åˆ—ä¸Šæ¶‰åŠåˆ°äº†è¿ç®—ã€‚</p>\n<h3 id=\"èƒ½å¦ç»™æ‰‹æœºå·çš„å‰-6-ä½åˆ›å»ºç´¢å¼•ï¼Ÿå¦‚ä½•åˆ›å»ºï¼Ÿ\"><a href=\"#èƒ½å¦ç»™æ‰‹æœºå·çš„å‰-6-ä½åˆ›å»ºç´¢å¼•ï¼Ÿå¦‚ä½•åˆ›å»ºï¼Ÿ\" class=\"headerlink\" title=\"èƒ½å¦ç»™æ‰‹æœºå·çš„å‰ 6 ä½åˆ›å»ºç´¢å¼•ï¼Ÿå¦‚ä½•åˆ›å»ºï¼Ÿ\"></a>èƒ½å¦ç»™æ‰‹æœºå·çš„å‰ 6 ä½åˆ›å»ºç´¢å¼•ï¼Ÿå¦‚ä½•åˆ›å»ºï¼Ÿ</h3><p>å¯ä»¥ï¼Œåˆ›å»ºæ–¹å¼æœ‰ä¸¤ç§ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">alter table t add index index_phone(phone(6));</span><br><span class=\"line\">create index index_phone on t(phone(6));</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"ä»€ä¹ˆæ˜¯å‰ç¼€ç´¢å¼•ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯å‰ç¼€ç´¢å¼•ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯å‰ç¼€ç´¢å¼•ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯å‰ç¼€ç´¢å¼•ï¼Ÿ</h3><p>å‰ç¼€ç´¢å¼•ä¹Ÿå«å±€éƒ¨ç´¢å¼•ï¼Œæ¯”å¦‚ç»™èº«ä»½è¯çš„å‰ 10 ä½æ·»åŠ ç´¢å¼•ã€‚<br>ç±»ä¼¼è¿™ç§ç»™æŸåˆ—éƒ¨åˆ†ä¿¡æ¯æ·»åŠ ç´¢å¼•çš„æ–¹å¼å«åšå‰ç¼€ç´¢å¼•ã€‚</p>\n<h3 id=\"ä¸ºä»€ä¹ˆè¦ç”¨å‰ç¼€ç´¢å¼•ï¼Ÿ\"><a href=\"#ä¸ºä»€ä¹ˆè¦ç”¨å‰ç¼€ç´¢å¼•ï¼Ÿ\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆè¦ç”¨å‰ç¼€ç´¢å¼•ï¼Ÿ\"></a>ä¸ºä»€ä¹ˆè¦ç”¨å‰ç¼€ç´¢å¼•ï¼Ÿ</h3><p>å‰ç¼€ç´¢å¼•èƒ½æœ‰æ•ˆå‡å°ç´¢å¼•æ–‡ä»¶çš„å¤§å°ï¼Œè®©æ¯ä¸ªç´¢å¼•é¡µå¯ä»¥ä¿å­˜æ›´å¤šçš„ç´¢å¼•å€¼ï¼Œä»è€Œæé«˜äº†ç´¢å¼•æŸ¥è¯¢çš„é€Ÿåº¦ã€‚ä½†å‰ç¼€ç´¢å¼•ä¹Ÿæœ‰å®ƒçš„ç¼ºç‚¹ï¼Œä¸èƒ½åœ¨ order by æˆ–è€… group by ä¸­è§¦å‘å‰ç¼€ç´¢å¼•ï¼Œä¹Ÿä¸èƒ½æŠŠå®ƒä»¬ç”¨äºè¦†ç›–ç´¢å¼•ã€‚</p>\n<h3 id=\"ä»€ä¹ˆæƒ…å†µä¸‹é€‚åˆä½¿ç”¨å‰ç¼€ç´¢å¼•ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæƒ…å†µä¸‹é€‚åˆä½¿ç”¨å‰ç¼€ç´¢å¼•ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæƒ…å†µä¸‹é€‚åˆä½¿ç”¨å‰ç¼€ç´¢å¼•ï¼Ÿ\"></a>ä»€ä¹ˆæƒ…å†µä¸‹é€‚åˆä½¿ç”¨å‰ç¼€ç´¢å¼•ï¼Ÿ</h3><p>å½“å­—ç¬¦ä¸²æœ¬èº«å¯èƒ½æ¯”è¾ƒé•¿ï¼Œè€Œä¸”å‰å‡ ä¸ªå­—ç¬¦å°±å¼€å§‹ä¸ç›¸åŒï¼Œé€‚åˆä½¿ç”¨å‰ç¼€ç´¢å¼•ï¼›ç›¸åæƒ…å†µä¸‹ä¸é€‚åˆä½¿ç”¨å‰ç¼€ç´¢å¼•ï¼Œæ¯”å¦‚ï¼Œæ•´ä¸ªå­—æ®µçš„é•¿åº¦ä¸º 20ï¼Œç´¢å¼•é€‰æ‹©æ€§ï¼ˆä¸é‡å¤çš„ç´¢å¼•å€¼å’Œè¡¨è®°å½•æ•°çš„æ¯”å€¼ï¼Œè¶Šå¤§è¯´æ˜ç´¢å¼•ä»·å€¼è¶Šå¤§ï¼‰ä¸º 0.9ï¼Œè€Œæˆ‘ä»¬å¯¹å‰ 10 ä¸ªå­—ç¬¦å»ºç«‹å‰ç¼€ç´¢å¼•å…¶é€‰æ‹©æ€§ä¹Ÿåªæœ‰ 0.5ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦ç»§ç»­åŠ å¤§å‰ç¼€å­—ç¬¦çš„é•¿åº¦ï¼Œä½†æ˜¯è¿™ä¸ªæ—¶å€™å‰ç¼€ç´¢å¼•çš„ä¼˜åŠ¿å·²ç»ä¸æ˜æ˜¾ï¼Œå°±æ²¡æœ‰åˆ›å»ºå‰ç¼€ç´¢å¼•çš„å¿…è¦äº†ã€‚</p>\n<h3 id=\"InnoDB-ä¸ºä»€ä¹ˆè¦ä½¿ç”¨-B-æ ‘ï¼Œè€Œä¸æ˜¯-B-æ ‘ã€Hashã€çº¢é»‘æ ‘æˆ–äºŒå‰æ ‘ï¼Ÿ\"><a href=\"#InnoDB-ä¸ºä»€ä¹ˆè¦ä½¿ç”¨-B-æ ‘ï¼Œè€Œä¸æ˜¯-B-æ ‘ã€Hashã€çº¢é»‘æ ‘æˆ–äºŒå‰æ ‘ï¼Ÿ\" class=\"headerlink\" title=\"InnoDB ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ B+ æ ‘ï¼Œè€Œä¸æ˜¯ B æ ‘ã€Hashã€çº¢é»‘æ ‘æˆ–äºŒå‰æ ‘ï¼Ÿ\"></a>InnoDB ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ B+ æ ‘ï¼Œè€Œä¸æ˜¯ B æ ‘ã€Hashã€çº¢é»‘æ ‘æˆ–äºŒå‰æ ‘ï¼Ÿ</h3><p>å› ä¸º B æ ‘ã€Hashã€çº¢é»‘æ ‘æˆ–äºŒå‰æ ‘å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š</p>\n<ul>\n<li>B æ ‘ï¼šä¸ç®¡å¶å­èŠ‚ç‚¹è¿˜æ˜¯éå¶å­èŠ‚ç‚¹ï¼Œéƒ½ä¼šä¿å­˜æ•°æ®ï¼Œè¿™æ ·å¯¼è‡´åœ¨éå¶å­èŠ‚ç‚¹ä¸­èƒ½ä¿å­˜çš„æŒ‡é’ˆæ•°é‡å˜å°‘ï¼ˆæœ‰äº›èµ„æ–™ä¹Ÿç§°ä¸ºæ‰‡å‡ºï¼‰ï¼ŒæŒ‡é’ˆå°‘çš„æƒ…å†µä¸‹è¦ä¿å­˜å¤§é‡æ•°æ®ï¼Œåªèƒ½å¢åŠ æ ‘çš„é«˜åº¦ï¼Œå¯¼è‡´ IO æ“ä½œå˜å¤šï¼ŒæŸ¥è¯¢æ€§èƒ½å˜ä½ï¼›</li>\n<li>Hashï¼šè™½ç„¶å¯ä»¥å¿«é€Ÿå®šä½ï¼Œä½†æ˜¯æ²¡æœ‰é¡ºåºï¼Œæ— æ³•è¿›è¡ŒèŒƒå›´æŸ¥æ‰¾ï¼ŒIO å¤æ‚åº¦é«˜ï¼›</li>\n<li>äºŒå‰æ ‘ï¼šæ ‘çš„é«˜åº¦ä¸å‡åŒ€ï¼Œä¸èƒ½è‡ªå¹³è¡¡ï¼ŒæŸ¥æ‰¾æ•ˆç‡è·Ÿæ•°æ®æœ‰å…³ï¼ˆæ ‘çš„é«˜åº¦ï¼‰ï¼Œå¹¶ä¸” IO ä»£ä»·é«˜ï¼›</li>\n<li>çº¢é»‘æ ‘ï¼šæ ‘çš„é«˜åº¦éšç€æ•°æ®é‡å¢åŠ è€Œå¢åŠ ï¼ŒIO ä»£ä»·é«˜ã€‚</li>\n</ul>\n<h3 id=\"MySQL-å¦‚ä½•æŒ‡å®šæŸ¥è¯¢çš„ç´¢å¼•ï¼Ÿ\"><a href=\"#MySQL-å¦‚ä½•æŒ‡å®šæŸ¥è¯¢çš„ç´¢å¼•ï¼Ÿ\" class=\"headerlink\" title=\"MySQL å¦‚ä½•æŒ‡å®šæŸ¥è¯¢çš„ç´¢å¼•ï¼Ÿ\"></a>MySQL å¦‚ä½•æŒ‡å®šæŸ¥è¯¢çš„ç´¢å¼•ï¼Ÿ</h3><p>åœ¨ MySQL ä¸­å¯ä»¥ä½¿ç”¨ force index å¼ºè¡Œé€‰æ‹©ä¸€ä¸ªç´¢å¼•ï¼Œå…·ä½“æŸ¥è¯¢è¯­å¥å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">select</span> <span class=\"operator\">*</span> <span class=\"keyword\">from</span> t force index(index_t);</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"åœ¨-MySQL-ä¸­æŒ‡å®šäº†æŸ¥è¯¢ç´¢å¼•ï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰ç”Ÿæ•ˆï¼Ÿ\"><a href=\"#åœ¨-MySQL-ä¸­æŒ‡å®šäº†æŸ¥è¯¢ç´¢å¼•ï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰ç”Ÿæ•ˆï¼Ÿ\" class=\"headerlink\" title=\"åœ¨ MySQL ä¸­æŒ‡å®šäº†æŸ¥è¯¢ç´¢å¼•ï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰ç”Ÿæ•ˆï¼Ÿ\"></a>åœ¨ MySQL ä¸­æŒ‡å®šäº†æŸ¥è¯¢ç´¢å¼•ï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰ç”Ÿæ•ˆï¼Ÿ</h3><p>æˆ‘ä»¬çŸ¥é“åœ¨ MySQL ä¸­ä½¿ç”¨ force index å¯ä»¥æŒ‡å®šæŸ¥è¯¢çš„ç´¢å¼•ï¼Œä½†å¹¶ä¸æ˜¯ä¸€å®šä¼šç”Ÿæ•ˆï¼ŒåŸå› æ˜¯ MySQL ä¼šæ ¹æ®ä¼˜åŒ–å™¨è‡ªå·±é€‰æ‹©ç´¢å¼•ï¼Œå¦‚æœ force index æŒ‡å®šçš„ç´¢å¼•å‡ºç°åœ¨å€™é€‰ç´¢å¼•ä¸Šï¼Œè¿™ä¸ªæ—¶å€™ MySQL ä¸ä¼šåœ¨åˆ¤æ–­æ‰«æçš„è¡Œæ•°çš„å¤šå°‘ç›´æ¥ä½¿ç”¨æŒ‡å®šçš„ç´¢å¼•ï¼Œå¦‚æœæ²¡åœ¨å€™é€‰ç´¢å¼•ä¸­ï¼Œå³ä½¿ force index æŒ‡å®šäº†ç´¢å¼•ä¹Ÿæ˜¯ä¸ä¼šç”Ÿæ•ˆçš„ã€‚</p>\n<h3 id=\"å¦‚ä½•ä¼˜åŒ–èº«ä»½è¯çš„ç´¢å¼•ï¼Ÿ\"><a href=\"#å¦‚ä½•ä¼˜åŒ–èº«ä»½è¯çš„ç´¢å¼•ï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•ä¼˜åŒ–èº«ä»½è¯çš„ç´¢å¼•ï¼Ÿ\"></a>å¦‚ä½•ä¼˜åŒ–èº«ä»½è¯çš„ç´¢å¼•ï¼Ÿ</h3><p>åœ¨ä¸­å›½å› ä¸ºå‰ 6 ä½ä»£è¡¨çš„æ˜¯åœ°åŒºï¼Œæ‰€ä»¥å¾ˆå¤šäººçš„å‰å…­ä½éƒ½æ˜¯ç›¸åŒçš„ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨å‰ç¼€ç´¢å¼•ä¸º 6 ä½çš„è¯ï¼Œæ€§èƒ½æå‡ä¹Ÿå¹¶ä¸æ˜¯å¾ˆæ˜æ˜¾ï¼Œä½†å¦‚æœè®¾ç½®çš„ä½æ•°è¿‡é•¿ï¼Œé‚£ä¹ˆå ç”¨çš„ç£ç›˜ç©ºé—´ä¹Ÿè¶Šå¤§ï¼Œæ•°æ®é¡µèƒ½æ”¾ä¸‹çš„ç´¢å¼•å€¼å°±è¶Šå°‘ï¼Œæœç´¢æ•ˆç‡ä¹Ÿè¶Šä½ã€‚é’ˆå¯¹è¿™ç§æƒ…å†µä¼˜åŒ–æ–¹æ¡ˆæœ‰ä»¥ä¸‹ä¸¤ç§ï¼š</p>\n<ul>\n<li><strong>ä½¿ç”¨èº«ä»½è¯å€’åºå­˜å‚¨</strong>ï¼Œè¿™æ ·è®¾ç½®å‰å…­ä½çš„æ„ä¹‰å°±å¾ˆå¤§äº†ï¼›</li>\n<li><strong>ä½¿ç”¨ hash å€¼</strong>ï¼Œæ–°åˆ›å»ºä¸€ä¸ªå­—æ®µç”¨äºå­˜å‚¨èº«ä»½è¯çš„ hash å€¼ã€‚</li>\n</ul>\n<h3 id=\"ç´¢å¼•çš„ä½¿ç”¨åœºæ™¯\"><a href=\"#ç´¢å¼•çš„ä½¿ç”¨åœºæ™¯\" class=\"headerlink\" title=\"ç´¢å¼•çš„ä½¿ç”¨åœºæ™¯\"></a>ç´¢å¼•çš„ä½¿ç”¨åœºæ™¯</h3><ul>\n<li>å¯¹äºéå¸¸å°çš„è¡¨ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹å…¨è¡¨æ‰«ææ•ˆç‡æ›´é«˜ã€‚</li>\n<li>ä¸­åˆ°å¤§å‹è¡¨ï¼Œç´¢å¼•éå¸¸æœ‰æ•ˆã€‚</li>\n<li>ç‰¹å¤§å‹çš„è¡¨ï¼Œå»ºç«‹å’Œä½¿ç”¨ç´¢å¼•çš„ä»£ä»·ä¼šéšä¹‹å¢å¤§ï¼Œå¯ä»¥ä½¿ç”¨åˆ†åŒºæŠ€æœ¯æ¥è§£å†³ã€‚</li>\n</ul>\n<h3 id=\"èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•\"><a href=\"#èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•\" class=\"headerlink\" title=\"èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•\"></a>èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•</h3><p>Innobd ä¸­çš„ä¸»é”®ç´¢å¼•æ˜¯ä¸€ç§èšç°‡ç´¢å¼•ï¼Œéèšç°‡ç´¢å¼•éƒ½æ˜¯è¾…åŠ©ç´¢å¼•ï¼Œåƒå¤åˆç´¢å¼•ã€å‰ç¼€ç´¢å¼•ã€å”¯ä¸€ç´¢å¼•ã€‚</p>\n<p>Innodb ä½¿ç”¨çš„æ˜¯èšç°‡ç´¢å¼•ï¼ŒMyISam ä½¿ç”¨çš„æ˜¯éèšç°‡ç´¢å¼•</p>\n<h4 id=\"èšç°‡ç´¢å¼•-èšé›†ç´¢å¼•\"><a href=\"#èšç°‡ç´¢å¼•-èšé›†ç´¢å¼•\" class=\"headerlink\" title=\"èšç°‡ç´¢å¼•(èšé›†ç´¢å¼•)\"></a>èšç°‡ç´¢å¼•(èšé›†ç´¢å¼•)</h4><p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1464190-20191106145143172-1760681728.png\" alt=\"img\"></p>\n<p>ã€€ã€€Innodb èšç°‡ç´¢å¼•å’Œ MyIsam éèšç°‡ç´¢å¼•çš„æ¯”è¾ƒè¯´æ˜<br>ã€€ã€€å‚è€ƒåšå®¢ï¼š<a href=\"https://www.cnblogs.com/zlcxbb/p/5757245.html\">https://www.cnblogs.com/zlcxbb/p/5757245.html</a></p>\n<h4 id=\"InnoDBç´¢å¼•å®ç°\"><a href=\"#InnoDBç´¢å¼•å®ç°\" class=\"headerlink\" title=\"InnoDBç´¢å¼•å®ç°\"></a>InnoDBç´¢å¼•å®ç°</h4><p>ã€€ã€€InnoDB<strong>ä½¿ç”¨B+Treeä½œä¸ºç´¢å¼•ç»“æ„</strong>ï¼Œä½†å…·ä½“å®ç°æ–¹å¼å´ä¸ MyISAM æˆªç„¶ä¸åŒ.</p>\n<p>1ï¼‰ä¸»é”®ç´¢å¼•ï¼š</p>\n<p><strong>MyISAMç´¢å¼•æ–‡ä»¶å’Œæ•°æ®æ–‡ä»¶æ˜¯åˆ†ç¦»çš„</strong>ï¼Œ<strong>ç´¢å¼•æ–‡ä»¶ä»…ä¿å­˜æ•°æ®è®°å½•çš„åœ°å€</strong>ã€‚è€Œåœ¨<strong>InnoDBä¸­ï¼Œè¡¨æ•°æ®æ–‡ä»¶æœ¬èº«å°±æ˜¯æŒ‰B+Treeç»„ç»‡çš„ä¸€ä¸ªç´¢å¼•ç»“æ„</strong>ï¼Œè¿™æ£µæ ‘çš„å¶èŠ‚ç‚¹ data åŸŸä¿å­˜äº†å®Œæ•´çš„æ•°æ®è®°å½•ã€‚è¿™ä¸ªç´¢å¼•çš„ key æ˜¯æ•°æ®è¡¨çš„ä¸»é”®ï¼Œå› æ­¤ InnoDB è¡¨æ•°æ®æ–‡ä»¶æœ¬èº«å°±æ˜¯ä¸»ç´¢å¼•ã€‚</p>\n<p> <img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesTyporaNotes1464190-20191106145200302-932404581.png\"></p>\n<p>(å›¾ inndb ä¸»é”®ç´¢å¼•ï¼‰æ˜¯ InnoDB ä¸»ç´¢å¼•ï¼ˆåŒæ—¶ä¹Ÿæ˜¯æ•°æ®æ–‡ä»¶ï¼‰çš„ç¤ºæ„å›¾ï¼Œå¯ä»¥çœ‹åˆ°å¶èŠ‚ç‚¹åŒ…å«äº†å®Œæ•´çš„æ•°æ®è®°å½•ã€‚è¿™ç§ç´¢å¼•å«åšèšé›†ç´¢å¼•ã€‚å› ä¸º InnoDB çš„æ•°æ®æ–‡ä»¶æœ¬èº«è¦æŒ‰ä¸»é”®èšé›†ï¼Œæ‰€ä»¥ InnoDB è¦æ±‚è¡¨å¿…é¡»æœ‰ä¸»é”®ï¼ˆMyISAM å¯ä»¥æ²¡æœ‰ï¼‰ï¼Œå¦‚æœæ²¡æœ‰æ˜¾å¼æŒ‡å®šï¼Œåˆ™ MySQL ç³»ç»Ÿä¼šè‡ªåŠ¨é€‰æ‹©ä¸€ä¸ªå¯ä»¥å”¯ä¸€æ ‡è¯†æ•°æ®è®°å½•çš„åˆ—ä½œä¸ºä¸»é”®ï¼Œå¦‚æœä¸å­˜åœ¨è¿™ç§åˆ—ï¼Œåˆ™<strong>MySQLè‡ªåŠ¨ä¸ºInnoDBè¡¨ç”Ÿæˆä¸€ä¸ªéšå«å­—æ®µä½œä¸ºä¸»é”®ï¼Œè¿™ä¸ªå­—æ®µé•¿åº¦ä¸º6ä¸ªå­—èŠ‚ï¼Œç±»å‹ä¸ºé•¿æ•´å½¢</strong>ã€‚</p>\n<p>2ï¼‰InnoDB çš„è¾…åŠ©ç´¢å¼•</p>\n<p>   InnoDB çš„æ‰€æœ‰è¾…åŠ©ç´¢å¼•éƒ½å¼•ç”¨ä¸»é”®ä½œä¸º data åŸŸã€‚ä¾‹å¦‚ï¼Œä¸‹å›¾ä¸ºå®šä¹‰åœ¨ Col3 ä¸Šçš„ä¸€ä¸ªè¾…åŠ©ç´¢å¼•ï¼š</p>\n<p> <img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1464190-20191106145241480-1330791289.png\" alt=\"img\"></p>\n<p>InnoDB ä½¿ç”¨çš„æ˜¯èšç°‡ç´¢å¼•ï¼Œå°†ä¸»é”®ç»„ç»‡åˆ°ä¸€æ£µ B+æ ‘ä¸­ï¼Œè€Œè¡Œæ•°æ®å°±å‚¨å­˜åœ¨å¶å­èŠ‚ç‚¹ä¸Šï¼Œè‹¥ä½¿ç”¨â€where id &#x3D; 14â€è¿™æ ·çš„æ¡ä»¶æŸ¥æ‰¾ä¸»é”®ï¼Œåˆ™æŒ‰ç…§ B+æ ‘çš„æ£€ç´¢ç®—æ³•å³å¯æŸ¥æ‰¾åˆ°å¯¹åº”çš„å¶èŠ‚ç‚¹ï¼Œä¹‹åè·å¾—è¡Œæ•°æ®ã€‚è‹¥å¯¹ Name åˆ—è¿›è¡Œæ¡ä»¶æœç´¢ï¼Œåˆ™éœ€è¦ä¸¤ä¸ªæ­¥éª¤ï¼šç¬¬ä¸€æ­¥åœ¨è¾…åŠ©ç´¢å¼• B+æ ‘ä¸­æ£€ç´¢ Nameï¼Œåˆ°è¾¾å…¶å¶å­èŠ‚ç‚¹è·å–å¯¹åº”çš„ä¸»é”®ã€‚ç¬¬äºŒæ­¥ä½¿ç”¨ä¸»é”®åœ¨ä¸»ç´¢å¼• B+æ ‘ä¸­å†æ‰§è¡Œä¸€æ¬¡ B+æ ‘æ£€ç´¢æ“ä½œï¼Œæœ€ç»ˆåˆ°è¾¾å¶å­èŠ‚ç‚¹å³å¯è·å–æ•´è¡Œæ•°æ®ã€‚</p>\n<h4 id=\"MyISAMç´¢å¼•å®ç°\"><a href=\"#MyISAMç´¢å¼•å®ç°\" class=\"headerlink\" title=\"MyISAMç´¢å¼•å®ç°\"></a>MyISAMç´¢å¼•å®ç°</h4><p>MyISAM ç´¢å¼•æ–‡ä»¶å’Œæ•°æ®æ–‡ä»¶æ˜¯åˆ†ç¦»çš„ï¼Œç´¢å¼•æ–‡ä»¶ä»…ä¿å­˜æ•°æ®è®°å½•çš„åœ°å€</p>\n<p>1ï¼‰ä¸»é”®ç´¢å¼•ï¼š</p>\n<p>MyISAM å¼•æ“ä½¿ç”¨ B+Tree ä½œä¸ºç´¢å¼•ç»“æ„ï¼Œå¶èŠ‚ç‚¹çš„<strong>dataåŸŸå­˜æ”¾çš„æ˜¯æ•°æ®è®°å½•çš„åœ°å€</strong>ã€‚ä¸‹å›¾æ˜¯ MyISAM ä¸»é”®ç´¢å¼•çš„åŸç†å›¾ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1464190-20191106151308457-531875534.png\" alt=\"img\"></p>\n<p>è¿™é‡Œè®¾è¡¨ä¸€å…±æœ‰ä¸‰åˆ—ï¼Œå‡è®¾æˆ‘ä»¬ä»¥ Col1 ä¸ºä¸»é”®ï¼Œå›¾ myisam1 æ˜¯ä¸€ä¸ª MyISAM è¡¨çš„ä¸»ç´¢å¼•ï¼ˆPrimary keyï¼‰ç¤ºæ„ã€‚å¯ä»¥çœ‹å‡º MyISAM çš„ç´¢å¼•æ–‡ä»¶ä»…ä»…ä¿å­˜æ•°æ®è®°å½•çš„åœ°å€ã€‚</p>\n<p>2ï¼‰è¾…åŠ©ç´¢å¼•ï¼ˆSecondary keyï¼‰</p>\n<p>åœ¨ MyISAM ä¸­ï¼Œä¸»ç´¢å¼•å’Œè¾…åŠ©ç´¢å¼•ï¼ˆSecondary keyï¼‰åœ¨ç»“æ„ä¸Šæ²¡æœ‰ä»»ä½•åŒºåˆ«ï¼Œ<strong>åªæ˜¯ä¸»ç´¢å¼•è¦æ±‚keyæ˜¯å”¯ä¸€çš„ï¼Œè€Œè¾…åŠ©ç´¢å¼•çš„keyå¯ä»¥é‡å¤</strong>ã€‚å¦‚æœæˆ‘ä»¬åœ¨ Col2 ä¸Šå»ºç«‹ä¸€ä¸ªè¾…åŠ©ç´¢å¼•ï¼Œåˆ™æ­¤ç´¢å¼•çš„ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>\n<p>åŒæ ·ä¹Ÿæ˜¯ä¸€é¢— B+Treeï¼Œdata åŸŸä¿å­˜æ•°æ®è®°å½•çš„åœ°å€ã€‚å› æ­¤ï¼ŒMyISAM ä¸­ç´¢å¼•æ£€ç´¢çš„ç®—æ³•ä¸ºé¦–å…ˆæŒ‰ç…§ B+Tree æœç´¢ç®—æ³•æœç´¢ç´¢å¼•ï¼Œå¦‚æœæŒ‡å®šçš„ Key å­˜åœ¨ï¼Œåˆ™å–å‡ºå…¶ data åŸŸçš„å€¼ï¼Œç„¶åä»¥ data åŸŸçš„å€¼ä¸ºåœ°å€ï¼Œè¯»å–ç›¸åº”æ•°æ®è®°å½•ã€‚</p>\n<p> <img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1464190-20191106151427711-625351515.png\" alt=\"img\"></p>\n<p>ã€€ã€€<strong>MyISMä½¿ç”¨çš„æ˜¯éèšç°‡ç´¢å¼•</strong>ï¼Œéèšç°‡ç´¢å¼•çš„ä¸¤æ£µ B+æ ‘çœ‹ä¸Šå»æ²¡ä»€ä¹ˆä¸åŒï¼ŒèŠ‚ç‚¹çš„ç»“æ„å®Œå…¨ä¸€è‡´åªæ˜¯å­˜å‚¨çš„å†…å®¹ä¸åŒè€Œå·²ï¼Œä¸»é”®ç´¢å¼• B+æ ‘çš„èŠ‚ç‚¹å­˜å‚¨äº†ä¸»é”®ï¼Œè¾…åŠ©é”®ç´¢å¼• B+æ ‘å­˜å‚¨äº†è¾…åŠ©é”®ã€‚è¡¨æ•°æ®å­˜å‚¨åœ¨ç‹¬ç«‹çš„åœ°æ–¹ï¼Œè¿™ä¸¤é¢— B+æ ‘çš„å¶å­èŠ‚ç‚¹éƒ½ä½¿ç”¨ä¸€ä¸ªåœ°å€æŒ‡å‘çœŸæ­£çš„è¡¨æ•°æ®ï¼Œå¯¹äºè¡¨æ•°æ®æ¥è¯´ï¼Œè¿™ä¸¤ä¸ªé”®æ²¡æœ‰ä»»ä½•å·®åˆ«ã€‚ç”±äºç´¢å¼•æ ‘æ˜¯ç‹¬ç«‹çš„ï¼Œé€šè¿‡è¾…åŠ©é”®æ£€ç´¢æ— éœ€è®¿é—®ä¸»é”®çš„ç´¢å¼•æ ‘ã€‚</p>\n<p>ä¸ºäº†æ›´å½¢è±¡è¯´æ˜è¿™ä¸¤ç§ç´¢å¼•çš„åŒºåˆ«ï¼Œæˆ‘ä»¬å‡æƒ³ä¸€ä¸ªè¡¨å¦‚ä¸‹å›¾å­˜å‚¨äº† 4 è¡Œæ•°æ®ã€‚å…¶ä¸­ Id ä½œä¸ºä¸»ç´¢å¼•ï¼ŒName ä½œä¸ºè¾…åŠ©ç´¢å¼•ã€‚å›¾ç¤ºæ¸…æ™°çš„æ˜¾ç¤ºäº†èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•çš„å·®å¼‚ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1464190-20191106151527647-152458631.png\" alt=\"img\"></p>\n<p>ğŸŒŸ<strong>InnoDBèšç°‡ç´¢å¼•ï¼š</strong></p>\n<p>ä¸»é”®ç´¢å¼•æ ‘ï¼Œæ ¹ç»“ç‚¹å­˜çš„æ˜¯ä¸»é”® id å’Œå¯¹åº”çš„æ•°æ®ï¼›</p>\n<p>è¾…åŠ©ç´¢å¼•æ ‘ï¼Œæ ¹ç»“ç‚¹å­˜çš„æ˜¯è¾…åŠ©ç´¢å¼•å’Œå¯¹åº”çš„ä¸»é”®ç´¢å¼•ï¼Œå› æ­¤éœ€è¦æ ¹æ®ä¸»é”®åˆ°ä¸»é”®ç´¢å¼•æ ‘ä¸Šåœ¨éå†ä¸€æ¬¡å¾—åˆ°å¯¹åº”çš„æ•°æ®ã€‚</p>\n<p>ğŸŒŸ<strong>MyISAMéèšç°‡ç´¢å¼•ï¼š</strong></p>\n<p>ä¸»é”®ç´¢å¼•æ ‘ï¼Œæ ¹ç»“ç‚¹å­˜çš„æ˜¯ä¸»é”®åˆ°æ•°æ®åœ°å€çš„æ˜ å°„ï¼›</p>\n<p>è¾…åŠ©ç´¢å¼•æ ‘ï¼Œæ ¹ç»“ç‚¹å­˜çš„æ˜¯è¾…åŠ©ç´¢å¼•åˆ°æ•°æ®åœ°å€çš„æ˜ å°„ï¼Œä¹Ÿå¯ä»¥ç›´æ¥å¾—åˆ°æ•°æ®ï¼Œä¸éœ€è¦å›è¡¨ã€‚</p>\n<h4 id=\"é—®é¢˜ï¼šä¸»é”®ç´¢å¼•æ˜¯èšé›†ç´¢å¼•è¿˜æ˜¯éèšé›†ç´¢å¼•ï¼Ÿ\"><a href=\"#é—®é¢˜ï¼šä¸»é”®ç´¢å¼•æ˜¯èšé›†ç´¢å¼•è¿˜æ˜¯éèšé›†ç´¢å¼•ï¼Ÿ\" class=\"headerlink\" title=\"é—®é¢˜ï¼šä¸»é”®ç´¢å¼•æ˜¯èšé›†ç´¢å¼•è¿˜æ˜¯éèšé›†ç´¢å¼•ï¼Ÿ\"></a>é—®é¢˜ï¼šä¸»é”®ç´¢å¼•æ˜¯èšé›†ç´¢å¼•è¿˜æ˜¯éèšé›†ç´¢å¼•ï¼Ÿ</h4><p>åœ¨ InnoDB ä¸‹ä¸»é”®ç´¢å¼•æ˜¯èšé›†ç´¢å¼•ï¼Œåœ¨ MyISAM ä¸‹ä¸»é”®ç´¢å¼•æ˜¯éèšé›†ç´¢å¼•</p>\n<h4 id=\"MyISAMç´¢å¼•å®ç°ï¼Ÿ\"><a href=\"#MyISAMç´¢å¼•å®ç°ï¼Ÿ\" class=\"headerlink\" title=\"MyISAMç´¢å¼•å®ç°ï¼Ÿ\"></a>MyISAMç´¢å¼•å®ç°ï¼Ÿ</h4><p>MyISAM å­˜å‚¨å¼•æ“ä½¿ç”¨ B+Tree ä½œä¸ºç´¢å¼•ç»“æ„ï¼Œå¶èŠ‚ç‚¹çš„ data åŸŸå­˜æ”¾çš„æ˜¯æ•°æ®è®°å½•çš„åœ°å€ã€‚MyISAM çš„ç´¢å¼•æ–¹å¼ä¹Ÿå«åšéèšç°‡ç´¢å¼•çš„ï¼Œä¹‹æ‰€ä»¥è¿™ä¹ˆç§°å‘¼æ˜¯ä¸ºäº†ä¸ InnoDB çš„èšç°‡ç´¢å¼•åŒºåˆ†ã€‚</p>\n<h4 id=\"MyISAMç´¢å¼•ä¸InnoDBç´¢å¼•çš„åŒºåˆ«ï¼Ÿ\"><a href=\"#MyISAMç´¢å¼•ä¸InnoDBç´¢å¼•çš„åŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"MyISAMç´¢å¼•ä¸InnoDBç´¢å¼•çš„åŒºåˆ«ï¼Ÿ\"></a>MyISAMç´¢å¼•ä¸InnoDBç´¢å¼•çš„åŒºåˆ«ï¼Ÿ</h4><ul>\n<li>InnoDB ç´¢å¼•æ˜¯èšç°‡ç´¢å¼•ï¼ŒMyISAM ç´¢å¼•æ˜¯éèšç°‡ç´¢å¼•ã€‚</li>\n<li>InnoDB çš„ä¸»é”®ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å­˜å‚¨ç€ç´¢å¼•å’Œè¡Œæ•°æ®ï¼Œå› æ­¤ä¸»é”®ç´¢å¼•éå¸¸é«˜æ•ˆã€‚</li>\n<li>MyISAM ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å­˜å‚¨çš„æ˜¯è¡Œæ•°æ®åœ°å€ï¼Œéœ€è¦æ ¹æ®æ•°æ®åœ°å€è®¿é—®å¯¹åº”çš„åœ°å€æ‰èƒ½å¾—åˆ°æ•°æ®ã€‚</li>\n<li><strong>InnoDBéä¸»é”®ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å­˜å‚¨çš„æ˜¯ä¸»é”®å’Œå…¶ä»–å¸¦ç´¢å¼•çš„åˆ—æ•°æ®ï¼Œå› æ­¤æŸ¥è¯¢æ—¶åšåˆ°è¦†ç›–ç´¢å¼•ä¼šéå¸¸é«˜æ•ˆã€‚</strong></li>\n</ul>\n<h3 id=\"ç®€å•è¯´ä¸€è¯´dropã€deleteä¸truncateçš„åŒºåˆ«\"><a href=\"#ç®€å•è¯´ä¸€è¯´dropã€deleteä¸truncateçš„åŒºåˆ«\" class=\"headerlink\" title=\"ç®€å•è¯´ä¸€è¯´dropã€deleteä¸truncateçš„åŒºåˆ«\"></a>ç®€å•è¯´ä¸€è¯´dropã€deleteä¸truncateçš„åŒºåˆ«</h3><p>SQL ä¸­çš„ dropã€deleteã€truncate éƒ½è¡¨ç¤ºåˆ é™¤ï¼Œä½†æ˜¯ä¸‰è€…æœ‰ä¸€äº›å·®åˆ«</p>\n<blockquote>\n<p>1ã€deleteå’Œtruncateåªåˆ é™¤è¡¨çš„æ•°æ®ä¸åˆ é™¤è¡¨çš„ç»“æ„<br>2ã€é€Ÿåº¦,ä¸€èˆ¬æ¥è¯´: drop&gt; truncate &gt;delete<br>3ã€deleteè¯­å¥æ˜¯dml,è¿™ä¸ªæ“ä½œä¼šæ”¾åˆ°rollback segementä¸­,äº‹åŠ¡æäº¤ä¹‹åæ‰ç”Ÿæ•ˆ;<br>4ã€å¦‚æœæœ‰ç›¸åº”çš„trigger,æ‰§è¡Œçš„æ—¶å€™å°†è¢«è§¦å‘. truncate,dropæ˜¯ddl, æ“ä½œç«‹å³ç”Ÿæ•ˆ,åŸæ•°æ®ä¸æ”¾åˆ°rollback segmentä¸­,ä¸èƒ½å›æ»š. æ“ä½œä¸è§¦å‘trigger.</p>\n</blockquote>\n<h3 id=\"deleteã€truncateå’Œdropåˆ†åˆ«åœ¨ä»€ä¹ˆåœºæ™¯ä¹‹ä¸‹ä½¿ç”¨ï¼Ÿ\"><a href=\"#deleteã€truncateå’Œdropåˆ†åˆ«åœ¨ä»€ä¹ˆåœºæ™¯ä¹‹ä¸‹ä½¿ç”¨ï¼Ÿ\" class=\"headerlink\" title=\"deleteã€truncateå’Œdropåˆ†åˆ«åœ¨ä»€ä¹ˆåœºæ™¯ä¹‹ä¸‹ä½¿ç”¨ï¼Ÿ\"></a>deleteã€truncateå’Œdropåˆ†åˆ«åœ¨ä»€ä¹ˆåœºæ™¯ä¹‹ä¸‹ä½¿ç”¨ï¼Ÿ</h3><ol>\n<li>æƒ³åˆ é™¤éƒ¨åˆ†æ•°æ®è¡Œæ—¶å€™ï¼Œç”¨ deleteï¼Œå¹¶ä¸”å¸¦ä¸Š where å­å¥</li>\n<li>ä¿ç•™è¡¨è€Œåˆ é™¤æ‰€æœ‰æ•°æ®çš„æ—¶å€™ç”¨ truncate</li>\n<li>ä¸å†éœ€è¦ä¸€å¼ è¡¨çš„æ—¶å€™ï¼Œç”¨ drop</li>\n</ol>\n<h3 id=\"â­ä¸ºä»€ä¹ˆ-B-Tree-æ¯”-B-Tree-æ›´é€‚åˆå®é™…åº”ç”¨ä¸­æ“ä½œç³»ç»Ÿçš„æ–‡ä»¶ç´¢å¼•å’Œæ•°æ®åº“ç´¢å¼•ï¼Ÿ\"><a href=\"#â­ä¸ºä»€ä¹ˆ-B-Tree-æ¯”-B-Tree-æ›´é€‚åˆå®é™…åº”ç”¨ä¸­æ“ä½œç³»ç»Ÿçš„æ–‡ä»¶ç´¢å¼•å’Œæ•°æ®åº“ç´¢å¼•ï¼Ÿ\" class=\"headerlink\" title=\"â­ä¸ºä»€ä¹ˆ B+Tree æ¯” B-Tree æ›´é€‚åˆå®é™…åº”ç”¨ä¸­æ“ä½œç³»ç»Ÿçš„æ–‡ä»¶ç´¢å¼•å’Œæ•°æ®åº“ç´¢å¼•ï¼Ÿ\"></a>â­ä¸ºä»€ä¹ˆ B+Tree æ¯” B-Tree æ›´é€‚åˆå®é™…åº”ç”¨ä¸­æ“ä½œç³»ç»Ÿçš„æ–‡ä»¶ç´¢å¼•å’Œæ•°æ®åº“ç´¢å¼•ï¼Ÿ</h3><ol>\n<li>B+Tree çš„ç£ç›˜è¯»å†™ä»£ä»·æ›´ä½</li>\n</ol>\n<blockquote>\n<p>B+Tree çš„å†…éƒ¨ç»“ç‚¹å¹¶æ²¡æœ‰æŒ‡å‘å…³é”®å­—å…·ä½“ä¿¡æ¯çš„æŒ‡é’ˆã€‚å› æ­¤å…¶å†…éƒ¨ç»“ç‚¹ç›¸å¯¹ B-Tree æ›´å°ã€‚å¦‚æœæŠŠæ‰€æœ‰åŒä¸€å†…éƒ¨ç»“ç‚¹çš„å…³é”®å­—å­˜æ”¾åœ¨åŒä¸€ç›˜å—ä¸­ï¼Œé‚£ä¹ˆç›˜å—æ‰€èƒ½å®¹çº³çš„å…³é”®å­—æ•°é‡ä¹Ÿè¶Šå¤šã€‚ä¸€æ¬¡æ€§è¯»å…¥å†…å­˜ä¸­çš„éœ€è¦æŸ¥æ‰¾çš„å…³é”®å­—ä¹Ÿå°±è¶Šå¤šã€‚ç›¸å¯¹æ¥è¯´ IO è¯»å†™æ¬¡æ•°ä¹Ÿå°±é™ä½äº†ã€‚</p>\n</blockquote>\n<ol start=\"2\">\n<li>B+Tree çš„æŸ¥è¯¢æ•ˆç‡æ›´åŠ ç¨³å®š</li>\n</ol>\n<blockquote>\n<p>ç”±äºéç»ˆç»“ç‚¹å¹¶ä¸æ˜¯æœ€ç»ˆæŒ‡å‘æ–‡ä»¶å†…å®¹çš„ç»“ç‚¹ï¼Œè€Œåªæ˜¯å¶å­ç»“ç‚¹ä¸­å…³é”®å­—çš„ç´¢å¼•ã€‚æ‰€ä»¥ä»»ä½•å…³é”®å­—çš„æŸ¥æ‰¾å¿…é¡»èµ°ä¸€æ¡ä»æ ¹ç»“ç‚¹åˆ°å¶å­ç»“ç‚¹çš„è·¯ã€‚æ‰€æœ‰å…³é”®å­—æŸ¥è¯¢çš„è·¯å¾„é•¿åº¦ç›¸åŒï¼Œå¯¼è‡´æ¯ä¸€ä¸ªæ•°æ®çš„æŸ¥è¯¢æ•ˆç‡ç›¸å½“ã€‚</p>\n</blockquote>\n<h3 id=\"â­Hashç´¢å¼•å’ŒB-æ ‘æ‰€æœ‰æœ‰ä»€ä¹ˆåŒºåˆ«æˆ–è€…è¯´ä¼˜åŠ£å‘¢\"><a href=\"#â­Hashç´¢å¼•å’ŒB-æ ‘æ‰€æœ‰æœ‰ä»€ä¹ˆåŒºåˆ«æˆ–è€…è¯´ä¼˜åŠ£å‘¢\" class=\"headerlink\" title=\"â­Hashç´¢å¼•å’ŒB+æ ‘æ‰€æœ‰æœ‰ä»€ä¹ˆåŒºåˆ«æˆ–è€…è¯´ä¼˜åŠ£å‘¢?\"></a>â­Hashç´¢å¼•å’ŒB+æ ‘æ‰€æœ‰æœ‰ä»€ä¹ˆåŒºåˆ«æˆ–è€…è¯´ä¼˜åŠ£å‘¢?</h3><p>é¦–å…ˆè¦çŸ¥é“ Hash ç´¢å¼•å’Œ B+æ ‘ç´¢å¼•çš„åº•å±‚å®ç°åŸç†ï¼š</p>\n<p><strong>hashç´¢å¼•åº•å±‚å°±æ˜¯hashè¡¨,è¿›è¡ŒæŸ¥æ‰¾æ—¶,è°ƒç”¨ä¸€æ¬¡hashå‡½æ•°å°±å¯ä»¥è·å–åˆ°ç›¸åº”çš„é”®å€¼,ä¹‹åè¿›è¡Œå›è¡¨æŸ¥è¯¢è·å¾—å®é™…æ•°æ®.</strong><br>B+æ ‘åº•å±‚å®ç°æ˜¯å¤šè·¯å¹³è¡¡æŸ¥æ‰¾æ ‘.å¯¹äºæ¯ä¸€æ¬¡çš„æŸ¥è¯¢éƒ½æ˜¯ä»æ ¹èŠ‚ç‚¹å‡ºå‘,æŸ¥æ‰¾åˆ°å¶å­èŠ‚ç‚¹æ–¹å¯ä»¥è·å¾—æ‰€æŸ¥é”®å€¼,ç„¶åæ ¹æ®æŸ¥è¯¢åˆ¤æ–­æ˜¯å¦éœ€è¦å›è¡¨æŸ¥è¯¢æ•°æ®.</p>\n<p>é‚£ä¹ˆå¯ä»¥çœ‹å‡ºä»–ä»¬æœ‰ä»¥ä¸‹çš„ä¸åŒï¼š</p>\n<ul>\n<li><p>hash ç´¢å¼•è¿›è¡Œç­‰å€¼æŸ¥è¯¢æ›´å¿«(ä¸€èˆ¬æƒ…å†µä¸‹),ä½†æ˜¯å´æ— æ³•è¿›è¡ŒèŒƒå›´æŸ¥è¯¢.</p>\n</li>\n<li><p>hash ç´¢å¼•ä¸æ”¯æŒä½¿ç”¨ç´¢å¼•è¿›è¡Œæ’åº,åŸç†åŒä¸Š.</p>\n</li>\n<li><p>hash ç´¢å¼•ä¸æ”¯æŒæ¨¡ç³ŠæŸ¥è¯¢.</p>\n</li>\n<li><p>hash ç´¢å¼•ä»»ä½•æ—¶å€™éƒ½é¿å…ä¸äº†å›è¡¨æŸ¥è¯¢æ•°æ®,è€Œ B+æ ‘åœ¨ç¬¦åˆæŸäº›æ¡ä»¶(èšç°‡ç´¢å¼•,è¦†ç›–ç´¢å¼•ç­‰)çš„æ—¶å€™å¯ä»¥åªé€šè¿‡ç´¢å¼•å®ŒæˆæŸ¥è¯¢.</p>\n</li>\n<li><p>hash ç´¢å¼•è™½ç„¶åœ¨ç­‰å€¼æŸ¥è¯¢ä¸Šè¾ƒå¿«,ä½†æ˜¯ä¸ç¨³å®š.æ€§èƒ½ä¸å¯é¢„æµ‹,å½“æŸä¸ªé”®å€¼å­˜åœ¨å¤§é‡é‡å¤çš„æ—¶å€™,å‘ç”Ÿ hash ç¢°æ’,æ­¤æ—¶æ•ˆç‡å¯èƒ½æå·®.è€Œ B+æ ‘çš„æŸ¥è¯¢æ•ˆç‡æ¯”è¾ƒç¨³å®š,å¯¹äºæ‰€æœ‰çš„æŸ¥è¯¢éƒ½æ˜¯ä»æ ¹èŠ‚ç‚¹åˆ°å¶å­èŠ‚ç‚¹,ä¸”æ ‘çš„é«˜åº¦è¾ƒä½.</p>\n</li>\n</ul>\n<p>å› æ­¤,åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹,ç›´æ¥é€‰æ‹© B+æ ‘ç´¢å¼•å¯ä»¥è·å¾—ç¨³å®šä¸”è¾ƒå¥½çš„æŸ¥è¯¢é€Ÿåº¦.è€Œä¸éœ€è¦ä½¿ç”¨ hash ç´¢å¼•.</p>\n<h3 id=\"éèšç°‡ç´¢å¼•ä¸€å®šä¼šå›è¡¨æŸ¥è¯¢å—\"><a href=\"#éèšç°‡ç´¢å¼•ä¸€å®šä¼šå›è¡¨æŸ¥è¯¢å—\" class=\"headerlink\" title=\"éèšç°‡ç´¢å¼•ä¸€å®šä¼šå›è¡¨æŸ¥è¯¢å—?\"></a>éèšç°‡ç´¢å¼•ä¸€å®šä¼šå›è¡¨æŸ¥è¯¢å—?</h3><p>æœ‰å¦‚ä¸‹ä¸€å¼  InnoDB è¡¨ï¼š</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> `<span class=\"keyword\">user</span>` (</span><br><span class=\"line\">`id` <span class=\"type\">INT</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> ,</span><br><span class=\"line\">`name` <span class=\"type\">VARCHAR</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> ,</span><br><span class=\"line\">`age` <span class=\"type\">INT</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>);</span><br></pre></td></tr></table></figure>\n\n<p>å…¶ä¸­ id ä¸ºè‡ªå¢ä¸»é”®ï¼Œname æ˜¯ä¸€ä¸ªæ™®é€šç´¢å¼•ã€‚åœ¨æ‰§è¡Œ select * from user where id &#x3D; 1 æ—¶ï¼Œä¼šåœ¨ä¸»é”®ç´¢å¼•å¯¹åº”çš„ B+æ ‘çš„å¶å­ç»“ç‚¹ä¸Šæœç´¢åˆ°å…³é”®å­— id&#x3D;1 çš„èŠ‚ç‚¹ï¼Œå¹¶è¯»å–ä½äºè¯¥èŠ‚ç‚¹ä¸Šçš„æ•´è¡Œæ•°æ®ã€‚ä½†æ˜¯åœ¨æ‰§è¡Œ select * from user where name &#x3D; â€˜tomâ€™æ—¶ï¼Œä¼šåˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼š</p>\n<p>å…ˆåˆ° name ç´¢å¼•å¯¹åº”çš„ B+æ ‘çš„å¶å­ç»“ç‚¹ä¸Šæœç´¢åˆ°å…³é”®å­— name&#x3D;â€™tomâ€™çš„èŠ‚ç‚¹ï¼Œå¹¶ä»è¯¥èŠ‚ç‚¹ä¸Šè·å–å¯¹åº”çš„ä¸»é”® id å€¼ã€‚</p>\n<p>ç„¶åå†æ ¹æ® id å€¼ä½¿ç”¨ä¸»é”®ç´¢å¼•è¯»å–åˆ°æ•´è¡Œæ•°æ®ã€‚</p>\n<p>å…¶ä¸­ç¬¬äºŒä¸ªæ­¥éª¤å«ä½œå›è¡¨æŸ¥è¯¢ã€‚éœ€è¦æ‰«æè¾…åŠ©ç´¢å¼•å’Œä¸»é”®ç´¢å¼•ä¸¤æ£µ B+æ ‘æ‰èƒ½æ‹¿åˆ°æ•´è¡Œæ•°æ®ï¼Œæ•ˆç‡è¾ƒä½ã€‚</p>\n<p>å¦‚æœæ‰§è¡Œ select id, name from user where name &#x3D; â€˜tomâ€™,åˆ™åªéœ€è¦æ‰«æ name ç´¢å¼•æ ‘å°±å¯ä»¥è·å–åˆ°æ‰€æœ‰çš„å­—æ®µï¼Œå› ä¸º id å’Œ name éƒ½ä¿å­˜åœ¨ name ç´¢å¼• B+æ ‘çš„å¶å­èŠ‚ç‚¹ä¸Šï¼Œæ‰€ä»¥ä¸éœ€è¦å†å»ä¸»é”®ç´¢å¼•ä¸ŠæŸ¥æ‰¾ã€‚è¿™å°±æ˜¯æ‰€è°“çš„ç´¢å¼•è¦†ç›–ã€‚åªéœ€è¦åœ¨ä¸€æ£µç´¢å¼•æ ‘ä¸Šå°±èƒ½è·å– SQL æ‰€éœ€çš„æ‰€æœ‰åˆ—æ•°æ®ï¼Œæ— éœ€å›è¡¨ï¼Œé€Ÿåº¦æ›´å¿«ã€‚</p>\n<p>è€Œ select id, name, age from user where name &#x3D; â€˜tomâ€™ï¼Œå› ä¸º age å­—æ®µæ²¡æœ‰å­˜å‚¨åˆ° name ç´¢å¼•çš„å¶å­èŠ‚ç‚¹ä¸Šï¼Œæ‰€ä»¥éœ€è¦æ ¹æ®ä¸»é”®ç´¢å¼•å›è¡¨æŸ¥è¯¢åˆ° age åˆ—å€¼ã€‚å¦‚æœæŠŠ name ç´¢å¼•æ”¹æˆ(nameï¼Œage)çš„è”åˆç´¢å¼•å°±å¯ä»¥å®ç°ç´¢å¼•è¦†ç›–ï¼Œæ— éœ€å›è¡¨äº†ã€‚ï¼ˆè¦†ç›–ç´¢å¼•ï¼Œsql è¯­å¥ä¸­ç”¨åˆ°çš„å­—æ®µéƒ½æœ‰ç´¢å¼•ï¼‰<br>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”<br>ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸º CSDN åšä¸»ã€Œlmynoã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ª CC 4.0 BY-SA ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚<br>åŸæ–‡é“¾æ¥ï¼š<a href=\"https://blog.csdn.net/weixin_33603681/article/details/113387941\">https://blog.csdn.net/weixin_33603681/article/details/113387941</a></p>\n<h3 id=\"è”åˆç´¢å¼•æ˜¯ä»€ä¹ˆ-ä¸ºä»€ä¹ˆéœ€è¦æ³¨æ„è”åˆç´¢å¼•ä¸­çš„é¡ºåº\"><a href=\"#è”åˆç´¢å¼•æ˜¯ä»€ä¹ˆ-ä¸ºä»€ä¹ˆéœ€è¦æ³¨æ„è”åˆç´¢å¼•ä¸­çš„é¡ºåº\" class=\"headerlink\" title=\"è”åˆç´¢å¼•æ˜¯ä»€ä¹ˆ?ä¸ºä»€ä¹ˆéœ€è¦æ³¨æ„è”åˆç´¢å¼•ä¸­çš„é¡ºåº?\"></a>è”åˆç´¢å¼•æ˜¯ä»€ä¹ˆ?ä¸ºä»€ä¹ˆéœ€è¦æ³¨æ„è”åˆç´¢å¼•ä¸­çš„é¡ºåº?</h3><p>å› æ­¤åœ¨å»ºç«‹è”åˆç´¢å¼•çš„æ—¶å€™åº”è¯¥æ³¨æ„ç´¢å¼•åˆ—çš„é¡ºåº,ä¸€èˆ¬æƒ…å†µä¸‹,å°†æŸ¥è¯¢éœ€æ±‚é¢‘ç¹æˆ–è€…å­—æ®µé€‰æ‹©æ€§é«˜çš„åˆ—æ”¾åœ¨å‰é¢.æ­¤å¤–å¯ä»¥æ ¹æ®ç‰¹ä¾‹çš„æŸ¥è¯¢æˆ–è€…è¡¨ç»“æ„è¿›è¡Œå•ç‹¬çš„è°ƒæ•´.</p>\n<h3 id=\"åˆ›å»ºçš„ç´¢å¼•æœ‰æ²¡æœ‰è¢«ä½¿ç”¨åˆ°-æˆ–è€…è¯´æ€ä¹ˆæ‰å¯ä»¥çŸ¥é“è¿™æ¡è¯­å¥è¿è¡Œå¾ˆæ…¢çš„åŸå› \"><a href=\"#åˆ›å»ºçš„ç´¢å¼•æœ‰æ²¡æœ‰è¢«ä½¿ç”¨åˆ°-æˆ–è€…è¯´æ€ä¹ˆæ‰å¯ä»¥çŸ¥é“è¿™æ¡è¯­å¥è¿è¡Œå¾ˆæ…¢çš„åŸå› \" class=\"headerlink\" title=\"åˆ›å»ºçš„ç´¢å¼•æœ‰æ²¡æœ‰è¢«ä½¿ç”¨åˆ°?æˆ–è€…è¯´æ€ä¹ˆæ‰å¯ä»¥çŸ¥é“è¿™æ¡è¯­å¥è¿è¡Œå¾ˆæ…¢çš„åŸå› ?\"></a>åˆ›å»ºçš„ç´¢å¼•æœ‰æ²¡æœ‰è¢«ä½¿ç”¨åˆ°?æˆ–è€…è¯´æ€ä¹ˆæ‰å¯ä»¥çŸ¥é“è¿™æ¡è¯­å¥è¿è¡Œå¾ˆæ…¢çš„åŸå› ?</h3><p>MySQL æä¾›äº† explain å‘½ä»¤æ¥æŸ¥çœ‹è¯­å¥çš„æ‰§è¡Œè®¡åˆ’</p>\n<h2 id=\"MySQLäº‹åŠ¡ç¯‡ï¼ˆé‡ç‚¹ï¼‰\"><a href=\"#MySQLäº‹åŠ¡ç¯‡ï¼ˆé‡ç‚¹ï¼‰\" class=\"headerlink\" title=\"MySQLäº‹åŠ¡ç¯‡ï¼ˆé‡ç‚¹ï¼‰\"></a>MySQLäº‹åŠ¡ç¯‡ï¼ˆé‡ç‚¹ï¼‰</h2><h3 id=\"å¯è§æ€§åˆ¤æ–­\"><a href=\"#å¯è§æ€§åˆ¤æ–­\" class=\"headerlink\" title=\"å¯è§æ€§åˆ¤æ–­\"></a>å¯è§æ€§åˆ¤æ–­</h3><blockquote>\n<p>æ€»ç»“ï¼š</p>\n<p>å¤§äºç­‰äºä¸‹ä¸€ä¸ªåˆ†é…çš„äº‹åŠ¡IDä¸å¯è§</p>\n<p>åŒ…å«åœ¨æœªæäº¤äº‹åŠ¡é›†åˆä¸­ä½†æ˜¯å’Œåˆ›å»ºread viewçš„äº‹åŠ¡IDä¸ç›¸ç­‰åˆ™ä¹Ÿä¸å¯è§ã€‚</p>\n</blockquote>\n<p>äº‹åŠ¡ç‰ˆæœ¬å·å°äºå½“å‰æœ€å°çš„äº‹åŠ¡ IDï¼Œé‚£ä¹ˆè¯´æ˜å®ƒå·²ç»æäº¤äº†ï¼Œå¯è§ã€‚</p>\n<p>äº‹åŠ¡ç‰ˆæœ¬å·<strong>å¤§äºç­‰äºä¸‹ä¸€ä¸ªåˆ†é…çš„äº‹åŠ¡ID</strong>ï¼Œè¯´æ˜è¿™ä¸ªäº‹åŠ¡åœ¨å½“å‰ read view ç”Ÿæˆååœ¨ç”Ÿæˆï¼Œ<strong>ä¸å¯è§</strong>ã€‚</p>\n<p>äº‹åŠ¡ç‰ˆæœ¬å·åœ¨ [æœ€å°äº‹åŠ¡ IDï¼Œä¸‹ä¸€ä¸ªåˆ†é…çš„äº‹åŠ¡ ID) åŒºé—´å†…ï¼š</p>\n<p>â€‹\tå¦‚æœæœªæäº¤äº‹åŠ¡é›†åˆåŒ…å«è¯¥äº‹åŠ¡ç‰ˆæœ¬å·ï¼Œé‚£ä¹ˆåˆ¤æ–­æ˜¯å¦è¯¥äº‹åŠ¡ç‰ˆæœ¬å·æ˜¯å¦ç­‰äºåˆ›å»ºè¯¥ read view çš„äº‹åŠ¡ IDï¼Œ</p>\n<p>â€‹\t\tç­‰äºåˆ™è¯´æ˜è¿™ä¸ªç‰ˆæœ¬çš„æ•°æ®æ˜¯å½“å‰äº‹åŠ¡ç”Ÿæˆçš„ï¼Œå¯è§ã€‚<strong>ä¸ç­‰äºåˆ™ä¸å¯è§</strong>ã€‚</p>\n<p>â€‹\tå¦‚æœä¸åŒ…å«ï¼Œè¯´æ˜è¿™ä¸ªäº‹åŠ¡ç‰ˆæœ¬å·å·²ç»æäº¤ï¼Œå¯è§ã€‚</p>\n<h3 id=\"æŸ¥è¯¢ä¸€æ¡è®°å½•ï¼ŒåŸºäºMVCCï¼Œæ˜¯æ€æ ·çš„æµç¨‹\"><a href=\"#æŸ¥è¯¢ä¸€æ¡è®°å½•ï¼ŒåŸºäºMVCCï¼Œæ˜¯æ€æ ·çš„æµç¨‹\" class=\"headerlink\" title=\"æŸ¥è¯¢ä¸€æ¡è®°å½•ï¼ŒåŸºäºMVCCï¼Œæ˜¯æ€æ ·çš„æµç¨‹\"></a>æŸ¥è¯¢ä¸€æ¡è®°å½•ï¼ŒåŸºäºMVCCï¼Œæ˜¯æ€æ ·çš„æµç¨‹</h3><ol>\n<li>è·å–æ•°æ®ç‰ˆæœ¬å·å³<strong>æ•°æ®è¡Œä¸­çš„äº‹åŠ¡idéšè—å­—æ®µ</strong></li>\n<li><strong>æ‰§è¡Œsqlï¼Œå¾—åˆ°Read View</strong></li>\n<li>æ ¹æ®æ•°æ®ç‰ˆæœ¬å·å’Œ read view è¿›è¡Œ<strong>å¯è§æ€§åˆ¤æ–­</strong>ï¼Œåˆ¤æ–­å½“å‰ç‰ˆæœ¬æ•°æ®æ˜¯å¦å¯è§</li>\n<li>å¦‚æœä¸ç¬¦åˆ Read View çš„å¯è§æ€§è§„åˆ™ï¼Œ å³å°±éœ€è¦<strong>Undo log</strong>ä¸­å†å²å¿«ç…§é‡æ–°å’Œ read view å¯è§æ€§åˆ¤æ–­</li>\n<li>æœ€åè¿”å›ç¬¦åˆè§„åˆ™çš„æ•°æ®</li>\n</ol>\n<p>InnoDB å®ç° MVCCï¼Œæ˜¯é€šè¿‡<code> Read View+ Undo Log</code> å®ç°çš„ï¼ŒUndo Log ä¿å­˜äº†å†å²å¿«ç…§ï¼ŒRead View å¯è§æ€§è§„åˆ™å¸®åŠ©åˆ¤æ–­å½“å‰ç‰ˆæœ¬çš„æ•°æ®æ˜¯å¦å¯è§ã€‚</p>\n<h3 id=\"RCä¸‹å¯ä»¥è¯»åˆ°å·²æäº¤æ•°æ®ï¼Œä½†ä¸èƒ½è¯»åˆ°æœªæäº¤æ•°æ®\"><a href=\"#RCä¸‹å¯ä»¥è¯»åˆ°å·²æäº¤æ•°æ®ï¼Œä½†ä¸èƒ½è¯»åˆ°æœªæäº¤æ•°æ®\" class=\"headerlink\" title=\"RCä¸‹å¯ä»¥è¯»åˆ°å·²æäº¤æ•°æ®ï¼Œä½†ä¸èƒ½è¯»åˆ°æœªæäº¤æ•°æ®\"></a>RCä¸‹å¯ä»¥è¯»åˆ°å·²æäº¤æ•°æ®ï¼Œä½†ä¸èƒ½è¯»åˆ°æœªæäº¤æ•°æ®</h3><p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesTyporaNotes1.png\" alt=\"1\"></p>\n<h3 id=\"RRä¸‹å·²æäº¤å’Œæœªæäº¤æ•°æ®éƒ½ä¸èƒ½è¯»åˆ°\"><a href=\"#RRä¸‹å·²æäº¤å’Œæœªæäº¤æ•°æ®éƒ½ä¸èƒ½è¯»åˆ°\" class=\"headerlink\" title=\"RRä¸‹å·²æäº¤å’Œæœªæäº¤æ•°æ®éƒ½ä¸èƒ½è¯»åˆ°\"></a>RRä¸‹å·²æäº¤å’Œæœªæäº¤æ•°æ®éƒ½ä¸èƒ½è¯»åˆ°</h3><p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesTyporaNotes2.png\" alt=\"2\"></p>\n<h3 id=\"ä¸ºä»€ä¹ˆRRä¸‹è§£å†³äº†ä¸å¯é‡å¤è¯»é—®é¢˜ï¼Ÿ\"><a href=\"#ä¸ºä»€ä¹ˆRRä¸‹è§£å†³äº†ä¸å¯é‡å¤è¯»é—®é¢˜ï¼Ÿ\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆRRä¸‹è§£å†³äº†ä¸å¯é‡å¤è¯»é—®é¢˜ï¼Ÿ\"></a>ä¸ºä»€ä¹ˆRRä¸‹è§£å†³äº†ä¸å¯é‡å¤è¯»é—®é¢˜ï¼Ÿ</h3><p>å®é™…ä¸Šï¼Œå„ç§äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸‹çš„ Read view å·¥ä½œæ–¹å¼ï¼Œæ˜¯ä¸ä¸€æ ·çš„ï¼ŒRR å¯ä»¥è§£å†³ä¸å¯é‡å¤è¯»é—®é¢˜ï¼Œå°±æ˜¯è·Ÿ<strong>Read viewå·¥ä½œæ–¹å¼æœ‰å…³</strong>ã€‚</p>\n<ul>\n<li>åœ¨è¯»å·²æäº¤ï¼ˆRCï¼‰éš”ç¦»çº§åˆ«ä¸‹ï¼ŒåŒä¸€ä¸ªäº‹åŠ¡é‡Œé¢ï¼Œ<strong>æ¯ä¸€æ¬¡æŸ¥è¯¢éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„Read View</strong>ï¼Œè¿™æ ·å°±å¯èƒ½é€ æˆåŒä¸€ä¸ªäº‹åŠ¡é‡Œå‰åè¯»å–æ•°æ®å¯èƒ½ä¸ä¸€è‡´çš„é—®é¢˜ï¼ˆä¸å¯é‡å¤è¯»å¹¶å‘é—®é¢˜ï¼‰ã€‚</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>begin</th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>select * from core_user where id &#x3D;1</td>\n<td>ç”Ÿæˆä¸€ä¸ªRead View</td>\n</tr>\n<tr>\n<td>&#x2F;</td>\n<td>&#x2F;</td>\n</tr>\n<tr>\n<td>&#x2F;</td>\n<td>&#x2F;</td>\n</tr>\n<tr>\n<td>select * from core_user where id &#x3D;1</td>\n<td>ç”Ÿæˆä¸€ä¸ªRead View</td>\n</tr>\n</tbody></table>\n<ul>\n<li>åœ¨å¯é‡å¤è¯»ï¼ˆRRï¼‰éš”ç¦»çº§åˆ«ä¸‹ï¼Œ<strong>ä¸€ä¸ªäº‹åŠ¡é‡Œåªä¼šè·å–ä¸€æ¬¡read view</strong>ï¼Œéƒ½æ˜¯å‰¯æœ¬å…±ç”¨çš„ï¼Œä»è€Œä¿è¯æ¯æ¬¡æŸ¥è¯¢çš„æ•°æ®éƒ½æ˜¯ä¸€æ ·çš„ã€‚</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>begin</th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>select * from core_user where id &#x3D;1</td>\n<td>ç”Ÿæˆä¸€ä¸ªRead View</td>\n</tr>\n<tr>\n<td>&#x2F;</td>\n<td></td>\n</tr>\n<tr>\n<td>&#x2F;</td>\n<td></td>\n</tr>\n<tr>\n<td>select * from core_user where id &#x3D;1</td>\n<td>å…±ç”¨ä¸€ä¸ªRead Viewå‰¯æœ¬</td>\n</tr>\n</tbody></table>\n<h3 id=\"MVCCæ˜¯å¦è§£å†³äº†å¹»è¯»é—®é¢˜å‘¢ï¼Ÿ\"><a href=\"#MVCCæ˜¯å¦è§£å†³äº†å¹»è¯»é—®é¢˜å‘¢ï¼Ÿ\" class=\"headerlink\" title=\"MVCCæ˜¯å¦è§£å†³äº†å¹»è¯»é—®é¢˜å‘¢ï¼Ÿ\"></a>MVCCæ˜¯å¦è§£å†³äº†å¹»è¯»é—®é¢˜å‘¢ï¼Ÿ</h3><p>å¯¹äºå¹»è¯»æ¥è¯´ï¼Œå­˜åœ¨å¿«ç…§è¯»ï¼ˆå¯ä»¥è¯»åˆ°å¤šä¸ªç‰ˆæœ¬ï¼Œæ™®é€šçš„ selectï¼‰å’Œå½“å‰è¯»ï¼ˆè¯»çš„æ˜¯æœ€æ–°çš„ for updateï¼‰çš„æƒ…å†µï¼š</p>\n<ol>\n<li>RR éš”ç¦»çº§åˆ«ä¸‹ä¸ºäº†è§£å†³å¹»è¯»é—®é¢˜ï¼š<strong>å¿«ç…§è¯»ä¾é MVCCæ§åˆ¶ï¼Œå½“å‰è¯»é€šè¿‡é—´éš™é”è§£å†³</strong>ï¼›</li>\n<li>é—´éš™é”å’Œè¡Œé”åˆç§° Next-Key Locksï¼Œæ¯ä¸ª Next-Key Locks æ˜¯å‰å¼€åé—­åŒºé—´ï¼›</li>\n<li><strong>é—´éš™é”çš„å¼•å…¥ï¼Œå¯èƒ½ä¼šå¯¼è‡´åŒæ ·è¯­å¥é”ä½æ›´å¤§çš„èŒƒå›´ï¼Œå½±å“å¹¶å‘åº¦</strong>ã€‚</li>\n</ol>\n<h3 id=\"å¹¶å‘äº‹åŠ¡æœ‰ä»€ä¹ˆä»€ä¹ˆé—®é¢˜ï¼Ÿåº”è¯¥å¦‚ä½•è§£å†³ï¼Ÿ\"><a href=\"#å¹¶å‘äº‹åŠ¡æœ‰ä»€ä¹ˆä»€ä¹ˆé—®é¢˜ï¼Ÿåº”è¯¥å¦‚ä½•è§£å†³ï¼Ÿ\" class=\"headerlink\" title=\"å¹¶å‘äº‹åŠ¡æœ‰ä»€ä¹ˆä»€ä¹ˆé—®é¢˜ï¼Ÿåº”è¯¥å¦‚ä½•è§£å†³ï¼Ÿ\"></a>å¹¶å‘äº‹åŠ¡æœ‰ä»€ä¹ˆä»€ä¹ˆé—®é¢˜ï¼Ÿåº”è¯¥å¦‚ä½•è§£å†³ï¼Ÿ</h3><p>å¹¶å‘äº‹åŠ¡å¯èƒ½é€ æˆï¼šè„è¯»ã€ä¸å¯é‡å¤è¯»å’Œå¹»è¯»ç­‰é—®é¢˜ ï¼Œè¿™äº›é—®é¢˜å…¶å®éƒ½æ˜¯æ•°æ®åº“è¯»ä¸€è‡´æ€§é—®é¢˜ï¼Œå¿…é¡»ç”±æ•°æ®åº“æä¾›ä¸€å®šçš„äº‹åŠ¡éš”ç¦»æœºåˆ¶æ¥è§£å†³ï¼Œè§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š</p>\n<ul>\n<li><p>åŠ é”ï¼šåœ¨è¯»å–æ•°æ®å‰ï¼Œå¯¹å…¶åŠ é”ï¼Œé˜»æ­¢å…¶ä»–äº‹åŠ¡å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ã€‚</p>\n</li>\n<li><p>æä¾›æ•°æ®å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMultiVersion Concurrency Controlï¼Œç®€ç§° MVCC æˆ– MCCï¼‰ï¼Œä¹Ÿç§°ä¸ºå¤šç‰ˆæœ¬æ•°æ®åº“ï¼šä¸ç”¨åŠ ä»»ä½•é”ï¼Œ é€šè¿‡ä¸€å®šæœºåˆ¶ç”Ÿæˆä¸€ä¸ªæ•°æ®è¯·æ±‚æ—¶é—´ç‚¹çš„ä¸€è‡´æ€§æ•°æ®å¿«ç…§ï¼ˆSnapshot)ï¼Œ å¹¶ç”¨è¿™ä¸ªå¿«ç…§æ¥æä¾›ä¸€å®šçº§åˆ« ï¼ˆè¯­å¥çº§æˆ–äº‹åŠ¡çº§ï¼‰ çš„ä¸€è‡´æ€§è¯»å–ï¼Œä»ç”¨æˆ·çš„è§’åº¦æ¥çœ‹ï¼Œå¥½è±¡æ˜¯æ•°æ®åº“å¯ä»¥æä¾›åŒä¸€æ•°æ®çš„å¤šä¸ªç‰ˆæœ¬ã€‚</p>\n</li>\n</ul>\n<h3 id=\"MySQL-äº‹åŠ¡å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#MySQL-äº‹åŠ¡å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"MySQL äº‹åŠ¡å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>MySQL äº‹åŠ¡å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>ä»¥ InnoDB çš„äº‹åŠ¡å®ç°ä¸ºä¾‹ï¼ŒInnoDB æ˜¯é€šè¿‡å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMVCCï¼ŒMultiversion Concurrency Control ï¼‰è§£å†³ä¸å¯é‡å¤è¯»é—®é¢˜ï¼ŒåŠ ä¸Šé—´éš™é”è§£å†³å¹»è¯»é—®é¢˜ã€‚å› æ­¤ InnoDB çš„ RR éš”ç¦»çº§åˆ«å…¶å®å®ç°äº†ä¸²è¡ŒåŒ–çº§åˆ«çš„æ•ˆæœï¼Œè€Œä¸”ä¿ç•™äº†æ¯”è¾ƒå¥½çš„å¹¶å‘æ€§èƒ½ã€‚<br>äº‹åŠ¡çš„éš”ç¦»æ€§æ˜¯é€šè¿‡é”å®ç°ï¼Œè€Œäº‹åŠ¡çš„åŸå­æ€§ã€ä¸€è‡´æ€§å’ŒæŒä¹…æ€§åˆ™æ˜¯é€šè¿‡äº‹åŠ¡æ—¥å¿—å®ç°ã€‚</p>\n<h2 id=\"MVCCè¯¦ç»†ç‰ˆ\"><a href=\"#MVCCè¯¦ç»†ç‰ˆ\" class=\"headerlink\" title=\"MVCCè¯¦ç»†ç‰ˆ\"></a>MVCCè¯¦ç»†ç‰ˆ</h2><h3 id=\"1-ç›¸å…³æ•°æ®åº“çŸ¥è¯†ç‚¹å›é¡¾\"><a href=\"#1-ç›¸å…³æ•°æ®åº“çŸ¥è¯†ç‚¹å›é¡¾\" class=\"headerlink\" title=\"1. ç›¸å…³æ•°æ®åº“çŸ¥è¯†ç‚¹å›é¡¾\"></a>1. ç›¸å…³æ•°æ®åº“çŸ¥è¯†ç‚¹å›é¡¾</h3><h4 id=\"1-1-ä»€ä¹ˆæ˜¯æ•°æ®åº“äº‹åŠ¡ï¼Œä¸ºä»€ä¹ˆè¦æœ‰äº‹åŠ¡\"><a href=\"#1-1-ä»€ä¹ˆæ˜¯æ•°æ®åº“äº‹åŠ¡ï¼Œä¸ºä»€ä¹ˆè¦æœ‰äº‹åŠ¡\" class=\"headerlink\" title=\"1.1 ä»€ä¹ˆæ˜¯æ•°æ®åº“äº‹åŠ¡ï¼Œä¸ºä»€ä¹ˆè¦æœ‰äº‹åŠ¡\"></a>1.1 ä»€ä¹ˆæ˜¯æ•°æ®åº“äº‹åŠ¡ï¼Œä¸ºä»€ä¹ˆè¦æœ‰äº‹åŠ¡</h4><p>äº‹åŠ¡ï¼Œç”±ä¸€ä¸ªæœ‰é™çš„æ•°æ®åº“æ“ä½œåºåˆ—æ„æˆï¼Œè¿™äº›æ“ä½œè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œ,è¦ä¹ˆå…¨éƒ¨ä¸æ‰§è¡Œï¼Œæ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„å·¥ä½œå•ä½ã€‚</p>\n<p><strong>ä¸ºä»€ä¹ˆè¦æœ‰äº‹åŠ¡å‘¢ï¼Ÿ</strong> å°±æ˜¯ä¸ºäº†ä¿è¯æ•°æ®çš„æœ€ç»ˆä¸€è‡´æ€§ã€‚</p>\n<h4 id=\"1-2-äº‹åŠ¡åŒ…æ‹¬å“ªå‡ ä¸ªç‰¹æ€§ï¼Ÿ\"><a href=\"#1-2-äº‹åŠ¡åŒ…æ‹¬å“ªå‡ ä¸ªç‰¹æ€§ï¼Ÿ\" class=\"headerlink\" title=\"1.2 äº‹åŠ¡åŒ…æ‹¬å“ªå‡ ä¸ªç‰¹æ€§ï¼Ÿ\"></a>1.2 äº‹åŠ¡åŒ…æ‹¬å“ªå‡ ä¸ªç‰¹æ€§ï¼Ÿ</h4><p>äº‹åŠ¡å››ä¸ªå…¸å‹ç‰¹æ€§ï¼Œå³ ACIDï¼ŒåŸå­æ€§ï¼ˆAtomicityï¼‰ã€ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ã€éš”ç¦»æ€§ï¼ˆIsolationï¼‰ã€æŒä¹…æ€§ï¼ˆDurabilityï¼‰ã€‚</p>\n<ul>\n<li>åŸå­æ€§ï¼š äº‹åŠ¡ä½œä¸ºä¸€ä¸ªæ•´ä½“è¢«æ‰§è¡Œï¼ŒåŒ…å«åœ¨å…¶ä¸­çš„å¯¹æ•°æ®åº“çš„æ“ä½œ<strong>è¦ä¹ˆå…¨éƒ¨éƒ½æ‰§è¡Œï¼Œè¦ä¹ˆéƒ½ä¸æ‰§è¡Œ</strong>ã€‚</li>\n<li>ä¸€è‡´æ€§ï¼š æŒ‡åœ¨<strong>äº‹åŠ¡å¼€å§‹ä¹‹å‰å’Œäº‹åŠ¡ç»“æŸä»¥å</strong>ï¼Œæ•°æ®ä¸ä¼šè¢«ç ´åï¼Œå‡å¦‚ A è´¦æˆ·ç»™ B è´¦æˆ·è½¬ 10 å—é’±ï¼Œä¸ç®¡æˆåŠŸä¸å¦ï¼ŒA å’Œ B çš„æ€»é‡‘é¢æ˜¯ä¸å˜çš„ã€‚</li>\n<li>éš”ç¦»æ€§ï¼š å¤šä¸ªäº‹åŠ¡å¹¶å‘è®¿é—®æ—¶ï¼Œ<strong>äº‹åŠ¡ä¹‹é—´æ˜¯ç›¸äº’éš”ç¦»</strong>çš„ï¼Œä¸€ä¸ªäº‹åŠ¡ä¸åº”è¯¥è¢«å…¶ä»–äº‹åŠ¡å¹²æ‰°ï¼Œå¤šä¸ªå¹¶å‘äº‹åŠ¡ä¹‹é—´è¦ç›¸äº’éš”ç¦»ã€‚</li>\n<li>æŒä¹…æ€§ï¼š è¡¨ç¤ºäº‹åŠ¡å®Œæˆæäº¤åï¼Œè¯¥äº‹åŠ¡å¯¹æ•°æ®åº“æ‰€ä½œçš„æ“ä½œæ›´æ”¹ï¼Œå°†<strong>æŒä¹…åœ°ä¿å­˜åœ¨æ•°æ®åº“</strong>ä¹‹ä¸­ã€‚</li>\n</ul>\n<h4 id=\"1-3-äº‹åŠ¡å¹¶å‘å­˜åœ¨çš„é—®é¢˜\"><a href=\"#1-3-äº‹åŠ¡å¹¶å‘å­˜åœ¨çš„é—®é¢˜\" class=\"headerlink\" title=\"1.3 äº‹åŠ¡å¹¶å‘å­˜åœ¨çš„é—®é¢˜\"></a>1.3 äº‹åŠ¡å¹¶å‘å­˜åœ¨çš„é—®é¢˜</h4><p>äº‹åŠ¡å¹¶å‘ä¼šå¼•èµ·<strong>è„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»</strong>é—®é¢˜ã€‚</p>\n<h5 id=\"1-3-1-è„è¯»\"><a href=\"#1-3-1-è„è¯»\" class=\"headerlink\" title=\"1.3.1 è„è¯»\"></a>1.3.1 è„è¯»</h5><blockquote>\n<p>å¦‚æœä¸€ä¸ªäº‹åŠ¡è¯»å–åˆ°äº†å¦ä¸€ä¸ªæœªæäº¤äº‹åŠ¡ä¿®æ”¹è¿‡çš„æ•°æ®ï¼Œæˆ‘ä»¬å°±ç§°å‘ç”Ÿäº†è„è¯»ç°è±¡ã€‚</p>\n</blockquote>\n<h5 id=\"1-3-2-ä¸å¯é‡å¤è¯»\"><a href=\"#1-3-2-ä¸å¯é‡å¤è¯»\" class=\"headerlink\" title=\"1.3.2 ä¸å¯é‡å¤è¯»\"></a>1.3.2 ä¸å¯é‡å¤è¯»</h5><blockquote>\n<p>åŒä¸€ä¸ªäº‹åŠ¡å†…ï¼Œå‰åå¤šæ¬¡è¯»å–ï¼Œè¯»å–åˆ°çš„æ•°æ®å†…å®¹ä¸ä¸€è‡´</p>\n</blockquote>\n<h5 id=\"1-3-3-å¹»è¯»\"><a href=\"#1-3-3-å¹»è¯»\" class=\"headerlink\" title=\"1.3.3 å¹»è¯»\"></a>1.3.3 å¹»è¯»</h5><blockquote>\n<p>å¦‚æœä¸€ä¸ªäº‹åŠ¡å…ˆæ ¹æ®æŸäº›æœç´¢æ¡ä»¶æŸ¥è¯¢å‡ºä¸€äº›è®°å½•ï¼Œåœ¨è¯¥äº‹åŠ¡æœªæäº¤æ—¶ï¼Œå¦ä¸€ä¸ªäº‹åŠ¡å†™å…¥äº†ä¸€äº›ç¬¦åˆé‚£äº›æœç´¢æ¡ä»¶çš„è®°å½•ï¼ˆå¦‚insertã€deleteã€updateï¼‰ï¼Œä¸¤æ¬¡è¯»å–åˆ°çš„ç»“æœé›†å´ä¸ä¸€æ ·äº†ï¼Œå°±æ„å‘³ç€å‘ç”Ÿäº†<strong>å¹»è¯»</strong>ã€‚</p>\n</blockquote>\n<h4 id=\"1-4-å››å¤§éš”ç¦»çº§åˆ«\"><a href=\"#1-4-å››å¤§éš”ç¦»çº§åˆ«\" class=\"headerlink\" title=\"1.4 å››å¤§éš”ç¦»çº§åˆ«\"></a>1.4 å››å¤§éš”ç¦»çº§åˆ«</h4><p>ä¸ºäº†è§£å†³å¹¶å‘äº‹åŠ¡å­˜åœ¨çš„<strong>è„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»</strong>ç­‰é—®é¢˜ï¼Œæ•°æ®åº“å¤§å”è®¾è®¡äº†å››ç§éš”ç¦»çº§åˆ«ã€‚åˆ†åˆ«æ˜¯<strong>è¯»æœªæäº¤ï¼Œè¯»å·²æäº¤ï¼Œå¯é‡å¤è¯»ï¼Œä¸²è¡ŒåŒ–ï¼ˆSerializableï¼‰</strong>ã€‚</p>\n<h5 id=\"1-4-1-è¯»æœªæäº¤\"><a href=\"#1-4-1-è¯»æœªæäº¤\" class=\"headerlink\" title=\"1.4.1 è¯»æœªæäº¤\"></a>1.4.1 è¯»æœªæäº¤</h5><p>è¯»æœªæäº¤éš”ç¦»çº§åˆ«ï¼Œåªé™åˆ¶äº†ä¸¤ä¸ªæ•°æ®<strong>ä¸èƒ½åŒæ—¶ä¿®æ”¹</strong>ï¼Œä½†æ˜¯ä¿®æ”¹æ•°æ®çš„æ—¶å€™ï¼Œå³ä½¿äº‹åŠ¡<strong>æœªæäº¤</strong>ï¼Œéƒ½æ˜¯å¯ä»¥è¢«åˆ«çš„äº‹åŠ¡è¯»å–åˆ°çš„ï¼Œè¿™çº§åˆ«çš„äº‹åŠ¡éš”ç¦»æœ‰<strong>è„è¯»ã€é‡å¤è¯»ã€å¹»è¯»</strong>çš„é—®é¢˜ï¼›</p>\n<h5 id=\"1-4-2-è¯»å·²æäº¤\"><a href=\"#1-4-2-è¯»å·²æäº¤\" class=\"headerlink\" title=\"1.4.2 è¯»å·²æäº¤\"></a>1.4.2 è¯»å·²æäº¤</h5><p>è¯»å·²æäº¤éš”ç¦»çº§åˆ«ï¼Œå½“å‰äº‹åŠ¡åªèƒ½è¯»å–åˆ°å…¶ä»–äº‹åŠ¡<strong>æäº¤</strong>çš„æ•°æ®ï¼Œæ‰€ä»¥è¿™ç§äº‹åŠ¡çš„éš”ç¦»çº§åˆ«<strong>è§£å†³äº†è„è¯»</strong>é—®é¢˜ï¼Œä½†è¿˜æ˜¯ä¼šå­˜åœ¨<strong>é‡å¤è¯»ã€å¹»è¯»</strong>é—®é¢˜ï¼›</p>\n<h5 id=\"1-4-3-å¯é‡å¤è¯»\"><a href=\"#1-4-3-å¯é‡å¤è¯»\" class=\"headerlink\" title=\"1.4 3 å¯é‡å¤è¯»\"></a>1.4 3 å¯é‡å¤è¯»</h5><p>å¯é‡å¤è¯»éš”ç¦»çº§åˆ«ï¼Œé™åˆ¶äº†è¯»å–æ•°æ®çš„æ—¶å€™ï¼Œä¸å¯ä»¥è¿›è¡Œä¿®æ”¹ï¼Œæ‰€ä»¥<strong>è§£å†³äº†é‡å¤è¯»</strong>çš„é—®é¢˜ï¼Œä½†æ˜¯è¯»å–èŒƒå›´æ•°æ®çš„æ—¶å€™ï¼Œæ˜¯å¯ä»¥æ’å…¥æ•°æ®ï¼Œæ‰€ä»¥è¿˜ä¼šå­˜åœ¨<strong>å¹»è¯»</strong>é—®é¢˜ï¼›</p>\n<h5 id=\"1-4-4-ä¸²è¡ŒåŒ–\"><a href=\"#1-4-4-ä¸²è¡ŒåŒ–\" class=\"headerlink\" title=\"1.4.4 ä¸²è¡ŒåŒ–\"></a>1.4.4 ä¸²è¡ŒåŒ–</h5><p>äº‹åŠ¡æœ€é«˜çš„éš”ç¦»çº§åˆ«ï¼Œåœ¨è¯¥çº§åˆ«ä¸‹ï¼Œæ‰€æœ‰äº‹åŠ¡éƒ½æ˜¯è¿›è¡Œ<strong>ä¸²è¡ŒåŒ–é¡ºåº</strong>æ‰§è¡Œçš„ã€‚å¯ä»¥é¿å…è„è¯»ã€ä¸å¯é‡å¤è¯»ä¸å¹»è¯»æ‰€æœ‰å¹¶å‘é—®é¢˜ã€‚ä½†æ˜¯è¿™ç§äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸‹ï¼Œäº‹åŠ¡æ‰§è¡Œå¾ˆè€—æ€§èƒ½ã€‚</p>\n<h5 id=\"1-4-5-å››å¤§éš”ç¦»çº§åˆ«ï¼Œéƒ½ä¼šå­˜åœ¨å“ªäº›å¹¶å‘é—®é¢˜å‘¢\"><a href=\"#1-4-5-å››å¤§éš”ç¦»çº§åˆ«ï¼Œéƒ½ä¼šå­˜åœ¨å“ªäº›å¹¶å‘é—®é¢˜å‘¢\" class=\"headerlink\" title=\"1.4.5 å››å¤§éš”ç¦»çº§åˆ«ï¼Œéƒ½ä¼šå­˜åœ¨å“ªäº›å¹¶å‘é—®é¢˜å‘¢\"></a>1.4.5 å››å¤§éš”ç¦»çº§åˆ«ï¼Œéƒ½ä¼šå­˜åœ¨å“ªäº›å¹¶å‘é—®é¢˜å‘¢</h5><table>\n<thead>\n<tr>\n<th>éš”ç¦»çº§åˆ«</th>\n<th>è„è¯»</th>\n<th>ä¸å¯é‡å¤è¯»</th>\n<th>å¹»è¯»</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>è¯»æœªæäº¤</td>\n<td>âˆš</td>\n<td>âˆš</td>\n<td>âˆš</td>\n</tr>\n<tr>\n<td>è¯»å·²æäº¤</td>\n<td>Ã—</td>\n<td>âˆš</td>\n<td>âˆš</td>\n</tr>\n<tr>\n<td>å¯é‡å¤è¯»</td>\n<td>Ã—</td>\n<td>Ã—</td>\n<td>âˆš</td>\n</tr>\n<tr>\n<td>ä¸²è¡ŒåŒ–</td>\n<td>Ã—</td>\n<td>Ã—</td>\n<td>Ã—</td>\n</tr>\n</tbody></table>\n<h4 id=\"1-5-æ•°æ®åº“æ˜¯å¦‚ä½•ä¿è¯äº‹åŠ¡çš„éš”ç¦»æ€§çš„å‘¢ï¼Ÿ\"><a href=\"#1-5-æ•°æ®åº“æ˜¯å¦‚ä½•ä¿è¯äº‹åŠ¡çš„éš”ç¦»æ€§çš„å‘¢ï¼Ÿ\" class=\"headerlink\" title=\"1.5 æ•°æ®åº“æ˜¯å¦‚ä½•ä¿è¯äº‹åŠ¡çš„éš”ç¦»æ€§çš„å‘¢ï¼Ÿ\"></a>1.5 æ•°æ®åº“æ˜¯å¦‚ä½•ä¿è¯äº‹åŠ¡çš„éš”ç¦»æ€§çš„å‘¢ï¼Ÿ</h4><p>æ•°æ®åº“æ˜¯é€šè¿‡<strong>åŠ é”</strong>ï¼Œæ¥å®ç°äº‹åŠ¡çš„éš”ç¦»æ€§çš„ã€‚è¿™å°±å¥½åƒï¼Œå¦‚æœä½ æƒ³ä¸€ä¸ªäººé™é™ï¼Œä¸è¢«åˆ«äººæ‰“æ‰°ï¼Œä½ å°±å¯ä»¥åœ¨æˆ¿é—¨ä¸ŠåŠ ä¸Šä¸€æŠŠé”ã€‚</p>\n<p>åŠ é”ç¡®å®å¥½ä½¿ï¼Œå¯ä»¥ä¿è¯éš”ç¦»æ€§ã€‚æ¯”å¦‚<strong>ä¸²è¡ŒåŒ–éš”ç¦»çº§åˆ«å°±æ˜¯åŠ é”å®ç°çš„</strong>ã€‚ä½†æ˜¯é¢‘ç¹çš„åŠ é”ï¼Œå¯¼è‡´è¯»æ•°æ®æ—¶ï¼Œæ²¡åŠæ³•ä¿®æ”¹ï¼Œä¿®æ”¹æ•°æ®æ—¶ï¼Œæ²¡åŠæ³•è¯»å–ï¼Œå¤§å¤§<strong>é™ä½äº†æ•°æ®åº“æ€§èƒ½</strong>ã€‚</p>\n<p><strong>é‚£ä¹ˆï¼Œå¦‚ä½•è§£å†³åŠ é”åçš„æ€§èƒ½é—®é¢˜çš„ï¼Ÿ</strong></p>\n<p>ç­”æ¡ˆå°±æ˜¯,<strong>MVCCå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶</strong>ï¼å®ƒå®ç°è¯»å–æ•°æ®ä¸ç”¨åŠ é”ï¼Œå¯ä»¥è®©è¯»å–æ•°æ®åŒæ—¶ä¿®æ”¹ã€‚ä¿®æ”¹æ•°æ®æ—¶åŒæ—¶å¯è¯»å–ã€‚</p>\n<h3 id=\"2-ä»€ä¹ˆæ˜¯-MVCCï¼Ÿ\"><a href=\"#2-ä»€ä¹ˆæ˜¯-MVCCï¼Ÿ\" class=\"headerlink\" title=\"2. ä»€ä¹ˆæ˜¯ MVCCï¼Ÿ\"></a>2. ä»€ä¹ˆæ˜¯ MVCCï¼Ÿ</h3><p>MVCCï¼Œå³<strong>Multi-Version  Concurrency Control ï¼ˆå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼‰</strong>ã€‚å®ƒæ˜¯ä¸€ç§å¹¶å‘æ§åˆ¶çš„æ–¹æ³•ï¼Œä¸€èˆ¬åœ¨æ•°æ®åº“ç®¡ç†ç³»ç»Ÿä¸­ï¼Œå®ç°å¯¹æ•°æ®åº“çš„å¹¶å‘è®¿é—®ï¼Œåœ¨ç¼–ç¨‹è¯­è¨€ä¸­å®ç°äº‹åŠ¡å†…å­˜ã€‚</p>\n<blockquote>\n<p>é€šä¿—çš„è®²ï¼Œæ•°æ®åº“ä¸­åŒæ—¶å­˜åœ¨å¤šä¸ªç‰ˆæœ¬çš„æ•°æ®ï¼Œå¹¶ä¸æ˜¯æ•´ä¸ªæ•°æ®åº“çš„å¤šä¸ªç‰ˆæœ¬ï¼Œè€Œæ˜¯æŸä¸€æ¡è®°å½•çš„å¤šä¸ªç‰ˆæœ¬åŒæ—¶å­˜åœ¨ï¼Œåœ¨æŸä¸ªäº‹åŠ¡å¯¹å…¶è¿›è¡Œæ“ä½œçš„æ—¶å€™ï¼Œéœ€è¦æŸ¥çœ‹è¿™ä¸€æ¡è®°å½•çš„éšè—åˆ—äº‹åŠ¡ç‰ˆæœ¬idï¼Œæ¯”å¯¹äº‹åŠ¡idå¹¶æ ¹æ®äº‹ç‰©éš”ç¦»çº§åˆ«å»åˆ¤æ–­è¯»å–å“ªä¸ªç‰ˆæœ¬çš„æ•°æ®ã€‚</p>\n</blockquote>\n<p>æ•°æ®åº“éš”ç¦»çº§åˆ«<strong>è¯»å·²æäº¤ã€å¯é‡å¤è¯»</strong> éƒ½æ˜¯åŸºäº MVCC å®ç°çš„ï¼Œç›¸å¯¹äºåŠ é”ç®€å•ç²—æš´çš„æ–¹å¼ï¼Œå®ƒç”¨æ›´å¥½çš„æ–¹å¼å»å¤„ç†è¯»å†™å†²çªï¼Œèƒ½æœ‰æ•ˆæé«˜æ•°æ®åº“å¹¶å‘æ€§èƒ½ã€‚</p>\n<h3 id=\"3-MVCCå®ç°çš„å…³é”®çŸ¥è¯†ç‚¹\"><a href=\"#3-MVCCå®ç°çš„å…³é”®çŸ¥è¯†ç‚¹\" class=\"headerlink\" title=\"3. MVCCå®ç°çš„å…³é”®çŸ¥è¯†ç‚¹\"></a>3. MVCCå®ç°çš„å…³é”®çŸ¥è¯†ç‚¹</h3><h4 id=\"3-1-äº‹åŠ¡ç‰ˆæœ¬å·\"><a href=\"#3-1-äº‹åŠ¡ç‰ˆæœ¬å·\" class=\"headerlink\" title=\"3.1 äº‹åŠ¡ç‰ˆæœ¬å·\"></a>3.1 äº‹åŠ¡ç‰ˆæœ¬å·</h4><blockquote>\n<p>äº‹åŠ¡æ¯æ¬¡å¼€å¯å‰ï¼Œéƒ½ä¼šä»æ•°æ®åº“è·å¾—ä¸€ä¸ª<strong>è‡ªå¢é•¿</strong>çš„äº‹åŠ¡IDï¼Œå¯ä»¥ä»äº‹åŠ¡IDåˆ¤æ–­äº‹åŠ¡çš„æ‰§è¡Œå…ˆåé¡ºåºã€‚è¿™å°±æ˜¯äº‹åŠ¡ç‰ˆæœ¬å·ã€‚</p>\n</blockquote>\n<h4 id=\"3-2-éšå¼å­—æ®µ\"><a href=\"#3-2-éšå¼å­—æ®µ\" class=\"headerlink\" title=\"3.2 éšå¼å­—æ®µ\"></a>3.2 éšå¼å­—æ®µ</h4><p>å¯¹äº InnoDB å­˜å‚¨å¼•æ“ï¼Œæ¯ä¸€è¡Œè®°å½•éƒ½æœ‰ä¸¤ä¸ªéšè—åˆ—<strong>trx_id</strong>ã€<strong>roll_pointer</strong>ï¼Œå¦‚æœè¡¨ä¸­æ²¡æœ‰ä¸»é”®å’Œé NULL å”¯ä¸€é”®æ—¶ï¼Œåˆ™è¿˜ä¼šæœ‰ç¬¬ä¸‰ä¸ªéšè—çš„ä¸»é”®åˆ—<strong>row_id</strong>ã€‚</p>\n<table>\n<thead>\n<tr>\n<th>åˆ—å</th>\n<th>æ˜¯å¦å¿…é¡»</th>\n<th>æè¿°</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>row_id</td>\n<td>å¦</td>\n<td>å•è°ƒé€’å¢çš„è¡ŒIDï¼Œä¸æ˜¯å¿…éœ€çš„ï¼Œå ç”¨6ä¸ªå­—èŠ‚ã€‚</td>\n</tr>\n<tr>\n<td>trx_id</td>\n<td>æ˜¯</td>\n<td>è®°å½•æ“ä½œè¯¥æ•°æ®äº‹åŠ¡çš„<strong>äº‹åŠ¡ID</strong></td>\n</tr>\n<tr>\n<td>roll_pointer</td>\n<td>æ˜¯</td>\n<td>è¿™ä¸ªéšè—åˆ—å°±ç›¸å½“äºä¸€ä¸ª<strong>å›æ»šæŒ‡é’ˆ</strong>ï¼ŒæŒ‡å‘å›æ»šæ®µçš„undoæ—¥å¿—</td>\n</tr>\n</tbody></table>\n<h4 id=\"3-3-undo-log\"><a href=\"#3-3-undo-log\" class=\"headerlink\" title=\"3.3 undo log\"></a>3.3 undo log</h4><p>undo logï¼Œ<strong>å›æ»šæ—¥å¿—</strong>ï¼Œç”¨äº<strong>è®°å½•æ•°æ®è¢«ä¿®æ”¹å‰</strong>çš„ä¿¡æ¯ã€‚åœ¨è¡¨è®°å½•ä¿®æ”¹ä¹‹å‰ï¼Œä¼šå…ˆæŠŠæ•°æ®æ‹·è´åˆ° undo log é‡Œï¼Œå¦‚æœäº‹åŠ¡å›æ»šï¼Œå³å¯ä»¥é€šè¿‡ undo log æ¥è¿˜åŸæ•°æ®ã€‚</p>\n<p>å¯ä»¥è¿™æ ·è®¤ä¸ºï¼Œå½“ delete ä¸€æ¡è®°å½•æ—¶ï¼Œundo log ä¸­ä¼šè®°å½•ä¸€æ¡å¯¹åº”çš„ insert è®°å½•ï¼Œå½“ update ä¸€æ¡è®°å½•æ—¶ï¼Œå®ƒè®°å½•ä¸€æ¡å¯¹åº”ç›¸åçš„ update è®°å½•ã€‚</p>\n<p>undo log æœ‰ä»€ä¹ˆ<strong>ç”¨é€”</strong>å‘¢ï¼Ÿ</p>\n<ol>\n<li>äº‹åŠ¡å›æ»šæ—¶ï¼Œä¿è¯åŸå­æ€§å’Œä¸€è‡´æ€§ã€‚</li>\n<li>ç”¨äº MVCC<strong>å¿«ç…§è¯»</strong>ã€‚</li>\n</ol>\n<h4 id=\"3-4-ç‰ˆæœ¬é“¾\"><a href=\"#3-4-ç‰ˆæœ¬é“¾\" class=\"headerlink\" title=\"3.4 ç‰ˆæœ¬é“¾\"></a>3.4 ç‰ˆæœ¬é“¾</h4><p>å¤šä¸ªäº‹åŠ¡å¹¶è¡Œæ“ä½œæŸä¸€è¡Œæ•°æ®æ—¶ï¼Œä¸åŒäº‹åŠ¡å¯¹è¯¥è¡Œæ•°æ®çš„ä¿®æ”¹ä¼šäº§ç”Ÿå¤šä¸ªç‰ˆæœ¬ï¼Œç„¶åé€šè¿‡å›æ»šæŒ‡é’ˆï¼ˆroll_pointerï¼‰ï¼Œè¿æˆä¸€ä¸ªé“¾è¡¨ï¼Œè¿™ä¸ªé“¾è¡¨å°±ç§°ä¸º<strong>ç‰ˆæœ¬é“¾</strong>ã€‚å¦‚ä¸‹ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131424393.png\" alt=\"image-20220422131424393\"></p>\n<p>å…¶å®ï¼Œé€šè¿‡ç‰ˆæœ¬é“¾ï¼Œæˆ‘ä»¬å°±å¯ä»¥çœ‹å‡º<strong>äº‹åŠ¡ç‰ˆæœ¬å·ã€è¡¨æ ¼éšè—çš„åˆ—å’Œundo log</strong>å®ƒä»¬ä¹‹é—´çš„å…³ç³»ã€‚æˆ‘ä»¬å†æ¥å°åˆ†æä¸€ä¸‹ã€‚</p>\n<ol>\n<li><p>å‡è®¾ç°åœ¨æœ‰ä¸€å¼  core_user è¡¨ï¼Œè¡¨é‡Œé¢æœ‰ä¸€æ¡æ•°æ®,id ä¸º 1ï¼Œåå­—ä¸ºå­™æƒï¼š</p>\n <img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131445316.png\" alt=\"image-20220422131445316\" style=\"zoom: 50%;\" />\n</li>\n<li><p>ç°åœ¨å¼€å¯ä¸€ä¸ªäº‹åŠ¡ Aï¼š å¯¹ core_user è¡¨æ‰§è¡Œ<code>update core_user set name =&quot;æ›¹æ“&quot; where id=1</code>,ä¼šè¿›è¡Œå¦‚ä¸‹æµç¨‹æ“ä½œ</p>\n</li>\n</ol>\n<ul>\n<li><p>é¦–å…ˆè·å¾—ä¸€ä¸ªäº‹åŠ¡ ID&#x3D;100</p>\n</li>\n<li><p>æŠŠ core_user è¡¨ä¿®æ”¹å‰çš„æ•°æ®,æ‹·è´åˆ° undo log</p>\n</li>\n<li><p>ä¿®æ”¹ core_user è¡¨ä¸­ï¼Œid&#x3D;1 çš„æ•°æ®ï¼Œåå­—æ”¹ä¸ºæ›¹æ“</p>\n</li>\n<li><p>æŠŠä¿®æ”¹åçš„æ•°æ®äº‹åŠ¡ Id&#x3D;101 æ”¹æˆå½“å‰äº‹åŠ¡ç‰ˆæœ¬å·ï¼Œå¹¶æŠŠ<strong>roll_pointer</strong>æŒ‡å‘ undo log æ•°æ®åœ°å€ã€‚</p>\n  <img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131527508.png\" alt=\"image-20220422131527508\" style=\"zoom: 50%;\" /></li>\n</ul>\n<h4 id=\"3-5-å¿«ç…§è¯»å’Œå½“å‰è¯»\"><a href=\"#3-5-å¿«ç…§è¯»å’Œå½“å‰è¯»\" class=\"headerlink\" title=\"3.5 å¿«ç…§è¯»å’Œå½“å‰è¯»\"></a>3.5 å¿«ç…§è¯»å’Œå½“å‰è¯»</h4><p><strong>å¿«ç…§è¯»ï¼š</strong> è¯»å–çš„æ˜¯è®°å½•æ•°æ®çš„å¯è§ç‰ˆæœ¬ï¼ˆæœ‰æ—§çš„ç‰ˆæœ¬ï¼‰ã€‚ä¸åŠ é”,æ™®é€šçš„ select è¯­å¥éƒ½æ˜¯å¿«ç…§è¯»,å¦‚ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select * from core_user where id &gt; 2;</span><br></pre></td></tr></table></figure>\n\n<p><strong>å½“å‰è¯»</strong>ï¼šè¯»å–çš„æ˜¯è®°å½•æ•°æ®çš„æœ€æ–°ç‰ˆæœ¬ï¼Œæ˜¾å¼åŠ é”çš„éƒ½æ˜¯å½“å‰è¯»</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select * from core_user where id &gt; 2 for update;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"3-6-Read-View\"><a href=\"#3-6-Read-View\" class=\"headerlink\" title=\"3.6 Read View\"></a>3.6 Read View</h4><ul>\n<li><strong>Read Viewæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</strong> å®ƒå°±æ˜¯äº‹åŠ¡æ‰§è¡Œ SQL è¯­å¥æ—¶ï¼Œäº§ç”Ÿçš„è¯»è§†å›¾ã€‚å®é™…ä¸Šåœ¨ innodb ä¸­ï¼Œæ¯ä¸ª SQL è¯­å¥æ‰§è¡Œå‰éƒ½ä¼šå¾—åˆ°ä¸€ä¸ª Read Viewã€‚</li>\n<li><strong>Read Viewæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ</strong> å®ƒä¸»è¦æ˜¯ç”¨æ¥åšå¯è§æ€§åˆ¤æ–­çš„ï¼Œå³åˆ¤æ–­å½“å‰äº‹åŠ¡å¯è§å“ªä¸ªç‰ˆæœ¬çš„æ•°æ®</li>\n</ul>\n<p>Read View æ˜¯å¦‚ä½•ä¿è¯å¯è§æ€§åˆ¤æ–­çš„å‘¢ï¼Ÿæˆ‘ä»¬å…ˆçœ‹çœ‹ Read view çš„å‡ ä¸ªé‡è¦å±æ€§</p>\n<ul>\n<li>m_ids:å½“å‰ç³»ç»Ÿä¸­é‚£äº›æ´»è·ƒ(<strong>æœªæäº¤</strong>)çš„è¯»å†™äº‹åŠ¡ ID, å®ƒæ•°æ®ç»“æ„ä¸ºä¸€ä¸ª Listï¼Œ[min_limit_id, max_limit_id)</li>\n<li>min_limit_id:è¡¨ç¤ºåœ¨ç”Ÿæˆ ReadView æ—¶ï¼Œå½“å‰ç³»ç»Ÿä¸­æ´»è·ƒçš„è¯»å†™äº‹åŠ¡ä¸­æœ€å°çš„äº‹åŠ¡ idï¼Œå³ m_ids ä¸­çš„æœ€å°å€¼ã€‚</li>\n<li>max_limit_id:è¡¨ç¤ºç”Ÿæˆ ReadView æ—¶ï¼Œç³»ç»Ÿä¸­åº”è¯¥åˆ†é…ç»™ä¸‹ä¸€ä¸ªäº‹åŠ¡çš„ id å€¼ï¼Œå³å³ m_ids ä¸­çš„æœ€å¤§å€¼+1</li>\n<li>creator_trx_id: åˆ›å»ºå½“å‰ read view çš„äº‹åŠ¡ ID</li>\n</ul>\n<p><strong>Read view åŒ¹é…æ¡ä»¶è§„åˆ™</strong>å¦‚ä¸‹ï¼š</p>\n<ol>\n<li>å¦‚æœæ–°çš„æ•°æ®äº‹åŠ¡ ID <code>trx_id &lt; min_limit_id</code>ï¼Œè¡¨æ˜ç”Ÿæˆè¯¥ç‰ˆæœ¬çš„äº‹åŠ¡åœ¨ç”Ÿæˆ Read View å‰ï¼Œå·²ç»æäº¤(å› ä¸ºäº‹åŠ¡ ID æ˜¯é€’å¢çš„)ï¼Œæ‰€ä»¥è¯¥ç‰ˆæœ¬å¯ä»¥è¢«å½“å‰äº‹åŠ¡è®¿é—®ã€‚</li>\n<li>å¦‚æœ<code>trx_id&gt;= max_limit_id</code>ï¼Œè¡¨æ˜ç”Ÿæˆè¯¥ç‰ˆæœ¬çš„äº‹åŠ¡åœ¨ç”Ÿæˆ ReadView åæ‰ç”Ÿæˆï¼Œæ‰€ä»¥è¯¥ç‰ˆæœ¬ä¸å¯ä»¥è¢«å½“å‰äº‹åŠ¡è®¿é—®ã€‚</li>\n<li>å¦‚æœ <code>min_limit_id =&lt;trx_id&lt; max_limit_id</code>,éœ€è¦åˆ† 3 ç§æƒ…å†µè®¨è®º</li>\n</ol>\n<blockquote>\n<p>ï¼ˆ1ï¼‰å¦‚æœ<code>m_ids</code>åŒ…å«<code>trx_id</code>,åˆ™ä»£è¡¨Read Viewç”Ÿæˆæ—¶åˆ»ï¼Œè¿™ä¸ªäº‹åŠ¡è¿˜æœªæäº¤ï¼Œä½†æ˜¯å¦‚æœæ•°æ®çš„<code>trx_id</code>ç­‰äº<code>creator_trx_id</code>çš„è¯ï¼Œè¡¨æ˜æ•°æ®æ˜¯è‡ªå·±ç”Ÿæˆçš„ï¼Œå› æ­¤æ˜¯<strong>å¯è§</strong>çš„ã€‚</p>\n<p>ï¼ˆ2ï¼‰å¦‚æœ<code>m_ids</code>åŒ…å«<code>trx_id</code>ï¼Œå¹¶ä¸”<code>trx_id</code>ä¸ç­‰äº<code>creator_trx_id</code>ï¼Œåˆ™Read  Viewç”Ÿæˆæ—¶ï¼Œäº‹åŠ¡æœªæäº¤ï¼Œå¹¶ä¸”ä¸æ˜¯è‡ªå·±ç”Ÿäº§çš„ï¼Œæ‰€ä»¥å½“å‰äº‹åŠ¡ä¹Ÿæ˜¯<strong>çœ‹ä¸è§</strong>çš„ï¼›</p>\n<p>ï¼ˆ3ï¼‰å¦‚æœ<code>m_ids</code>ä¸åŒ…å«<code>trx_id</code>ï¼Œåˆ™è¯´æ˜ä½ è¿™ä¸ªäº‹åŠ¡åœ¨Read Viewç”Ÿæˆä¹‹å‰å°±<strong>å·²ç»æäº¤</strong>äº†ï¼Œä¿®æ”¹çš„ç»“æœï¼Œå½“å‰äº‹åŠ¡æ˜¯èƒ½çœ‹è§çš„ã€‚</p>\n</blockquote>\n<h3 id=\"4-MVCCå®ç°åŸç†åˆ†æ\"><a href=\"#4-MVCCå®ç°åŸç†åˆ†æ\" class=\"headerlink\" title=\"4. MVCCå®ç°åŸç†åˆ†æ\"></a>4. MVCCå®ç°åŸç†åˆ†æ</h3><img src=\"/Users/yaxing/blog/source/_posts/E:/Markdown%E6%96%87%E6%A1%A3%E5%9B%BE%E7%89%87/8%20MySQL.assets/v2-a086ef515e7d0a023ca3cfcc5759c7f6_720w.jpg\" alt=\"img\" style=\"zoom: 80%;\" />\n\n<h4 id=\"4-1-æŸ¥è¯¢ä¸€æ¡è®°å½•ï¼ŒåŸºäºMVCCï¼Œæ˜¯æ€æ ·çš„æµç¨‹\"><a href=\"#4-1-æŸ¥è¯¢ä¸€æ¡è®°å½•ï¼ŒåŸºäºMVCCï¼Œæ˜¯æ€æ ·çš„æµç¨‹\" class=\"headerlink\" title=\"4.1 æŸ¥è¯¢ä¸€æ¡è®°å½•ï¼ŒåŸºäºMVCCï¼Œæ˜¯æ€æ ·çš„æµç¨‹\"></a>4.1 æŸ¥è¯¢ä¸€æ¡è®°å½•ï¼ŒåŸºäºMVCCï¼Œæ˜¯æ€æ ·çš„æµç¨‹</h4><ol>\n<li>è·å–äº‹åŠ¡ ID</li>\n<li>æ‰§è¡Œ sqlï¼Œå¾—åˆ° Read View</li>\n<li>æŸ¥è¯¢å¾—åˆ°çš„æ•°æ®ï¼Œç„¶åä¸ Read View ä¸­çš„äº‹åŠ¡ ID è¿›è¡Œæ¯”è¾ƒï¼Œå¸®åŠ©åˆ¤æ–­å½“å‰ç‰ˆæœ¬çš„æ•°æ®æ˜¯å¦å¯è§ã€‚</li>\n<li>å¦‚æœä¸ç¬¦åˆ Read View çš„å¯è§æ€§è§„åˆ™ï¼Œ å³å°±éœ€è¦ Undo log ä¸­å†å²å¿«ç…§;</li>\n<li>æœ€åè¿”å›ç¬¦åˆè§„åˆ™çš„æ•°æ®</li>\n</ol>\n<p>InnoDB å®ç° MVCCï¼Œæ˜¯é€šè¿‡<code> Read View+ Undo Log</code> å®ç°çš„ï¼ŒUndo Log ä¿å­˜äº†å†å²å¿«ç…§ï¼ŒRead View å¯è§æ€§è§„åˆ™å¸®åŠ©åˆ¤æ–­å½“å‰ç‰ˆæœ¬çš„æ•°æ®æ˜¯å¦å¯è§ã€‚</p>\n<h4 id=\"4-2-è¯»å·²æäº¤ï¼ˆRCï¼‰éš”ç¦»çº§åˆ«ï¼Œå­˜åœ¨ä¸å¯é‡å¤è¯»é—®é¢˜çš„åˆ†æå†ç¨‹\"><a href=\"#4-2-è¯»å·²æäº¤ï¼ˆRCï¼‰éš”ç¦»çº§åˆ«ï¼Œå­˜åœ¨ä¸å¯é‡å¤è¯»é—®é¢˜çš„åˆ†æå†ç¨‹\" class=\"headerlink\" title=\"4.2 è¯»å·²æäº¤ï¼ˆRCï¼‰éš”ç¦»çº§åˆ«ï¼Œå­˜åœ¨ä¸å¯é‡å¤è¯»é—®é¢˜çš„åˆ†æå†ç¨‹\"></a>4.2 è¯»å·²æäº¤ï¼ˆRCï¼‰éš”ç¦»çº§åˆ«ï¼Œå­˜åœ¨ä¸å¯é‡å¤è¯»é—®é¢˜çš„åˆ†æå†ç¨‹</h4><ol>\n<li><p>åˆ›å»º core_user è¡¨ï¼Œæ’å…¥ä¸€æ¡åˆå§‹åŒ–æ•°æ®,å¦‚ä¸‹ï¼š</p>\n <img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131554547.png\" alt=\"image-20220422131554547\" style=\"zoom: 33%;\" />\n</li>\n<li><p>éš”ç¦»çº§åˆ«è®¾ç½®ä¸ºè¯»å·²æäº¤ï¼ˆRCï¼‰ï¼Œäº‹åŠ¡ A å’Œäº‹åŠ¡ B åŒæ—¶å¯¹ core_user è¡¨è¿›è¡ŒæŸ¥è¯¢å’Œä¿®æ”¹æ“ä½œã€‚</p>\n</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">äº‹åŠ¡A: select * fom core_user where id=1</span><br><span class=\"line\">äº‹åŠ¡B: update core_user set name =â€æ›¹æ“â€</span><br><span class=\"line\">// äº‹åŠ¡Aä¸¤æ¬¡è¯»åˆ°çš„æ•°æ®ä¸ä¸€æ ·ï¼Œäº‹åŠ¡Aä¼šè¯»åˆ°å…¶ä»–äº‹åŠ¡æäº¤çš„æ•°æ®ï¼Œä¸èƒ½è¯»åˆ°å…¶ä»–äº‹åŠ¡æœªæäº¤çš„æ•°æ®ã€‚</span><br></pre></td></tr></table></figure>\n\n<p>æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š</p>\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131620047.png\" alt=\"image-20220422131620047\" style=\"zoom: 33%;\" />\n\n<p>æœ€åäº‹åŠ¡ A æŸ¥è¯¢åˆ°çš„ç»“æœæ˜¯ï¼Œ<strong>name&#x3D;æ›¹æ“</strong>çš„è®°å½•ï¼Œæˆ‘ä»¬<strong>åŸºäºMVCC</strong>ï¼Œæ¥åˆ†æä¸€ä¸‹æ‰§è¡Œæµç¨‹ï¼š</p>\n<p>(1) A å¼€å¯äº‹åŠ¡ï¼Œé¦–å…ˆå¾—åˆ°ä¸€ä¸ªäº‹åŠ¡ ID ä¸º 100</p>\n<p>(2) B å¼€å¯äº‹åŠ¡ï¼Œå¾—åˆ°äº‹åŠ¡ ID ä¸º 101</p>\n<p>(3) äº‹åŠ¡ A ç”Ÿæˆä¸€ä¸ª Read Viewï¼Œread view å¯¹åº”çš„å€¼å¦‚ä¸‹</p>\n<table>\n<thead>\n<tr>\n<th>å˜é‡</th>\n<th>å€¼</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>m_idsï¼ˆæœªæäº¤çš„äº‹åŠ¡IDï¼‰</td>\n<td>100ï¼Œ101</td>\n</tr>\n<tr>\n<td>max_limit_idï¼ˆä¸‹ä¸€ä¸ªåº”è¯¥åˆ†é…çš„äº‹åŠ¡IDï¼‰</td>\n<td>102</td>\n</tr>\n<tr>\n<td>min_limit_idï¼ˆå½“å‰read viewä¸­æ´»è·ƒçš„æœªæäº¤äº‹åŠ¡çš„æœ€å°å€¼ï¼‰</td>\n<td>100</td>\n</tr>\n<tr>\n<td>creator_trx_idï¼ˆåˆ›å»ºè¯¥read viewçš„äº‹åŠ¡IDï¼‰</td>\n<td>100</td>\n</tr>\n</tbody></table>\n<p>ç„¶åå›åˆ°ç‰ˆæœ¬é“¾ï¼šå¼€å§‹ä»ç‰ˆæœ¬é“¾ä¸­æŒ‘é€‰å¯è§çš„è®°å½•ï¼š</p>\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131642264.png\" alt=\"image-20220422131642264\" style=\"zoom: 33%;\" />\n\n<p>ç”±å›¾å¯ä»¥çœ‹å‡ºï¼Œæœ€æ–°ç‰ˆæœ¬çš„åˆ— name çš„å†…å®¹æ˜¯<code>å­™æƒ</code>ï¼Œè¯¥ç‰ˆæœ¬çš„<code>trx_id</code>å€¼ä¸º 100ã€‚å¼€å§‹æ‰§è¡Œ read view å¯è§æ€§è§„åˆ™æ ¡éªŒï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">min_limit_id(100)=&lt;trx_idï¼ˆ100ï¼‰&lt;102;</span><br><span class=\"line\">creator_trx_id = trx_id =100;</span><br></pre></td></tr></table></figure>\n\n<p>ç”±æ­¤å¯å¾—ï¼Œtrx_id&#x3D;100 çš„è¿™ä¸ªè®°å½•ï¼Œå½“å‰äº‹åŠ¡æ˜¯å¯è§çš„ã€‚æ‰€ä»¥æŸ¥åˆ°æ˜¯ name ä¸º<code>å­™æƒ</code>çš„è®°å½•ã€‚</p>\n<p>(4) äº‹åŠ¡ B è¿›è¡Œä¿®æ”¹æ“ä½œï¼ŒæŠŠåå­—æ”¹ä¸ºæ›¹æ“ã€‚æŠŠåŸæ•°æ®æ‹·è´åˆ° undo log,ç„¶åå¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œæ ‡è®°äº‹åŠ¡ ID å’Œä¸Šä¸€ä¸ªæ•°æ®ç‰ˆæœ¬åœ¨ undo log çš„åœ°å€ã€‚</p>\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131733370.png\" alt=\"image-20220422131733370\" style=\"zoom:33%;\" />\n\n<p>(5) æäº¤äº‹åŠ¡</p>\n<p>(6) äº‹åŠ¡ A å†æ¬¡æ‰§è¡ŒæŸ¥è¯¢æ“ä½œï¼Œ<strong>æ–°ç”Ÿæˆä¸€ä¸ªRead View</strong>ï¼ŒRead View å¯¹åº”çš„å€¼å¦‚ä¸‹</p>\n<table>\n<thead>\n<tr>\n<th>å˜é‡</th>\n<th>å€¼</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>m_idsï¼ˆæœªæäº¤çš„äº‹åŠ¡IDï¼‰</td>\n<td>100</td>\n</tr>\n<tr>\n<td>max_limit_idï¼ˆä¸‹ä¸€ä¸ªåº”å½“åˆ†é…çš„äº‹åŠ¡IDï¼‰</td>\n<td>102</td>\n</tr>\n<tr>\n<td>min_limit_idï¼ˆæœ€å°çš„äº‹åŠ¡IDï¼‰</td>\n<td>100</td>\n</tr>\n<tr>\n<td>creator_trx_idï¼ˆåˆ›å»ºread viewçš„äº‹åŠ¡IDï¼‰</td>\n<td>100</td>\n</tr>\n</tbody></table>\n<p>ç„¶åå†æ¬¡å›åˆ°ç‰ˆæœ¬é“¾ï¼šä»ç‰ˆæœ¬é“¾ä¸­æŒ‘é€‰å¯è§çš„è®°å½•ï¼š</p>\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131753554.png\" alt=\"image-20220422131753554\" style=\"zoom:33%;\" />\n\n<p>ä»å›¾å¯å¾—ï¼Œæœ€æ–°ç‰ˆæœ¬çš„åˆ— name çš„å†…å®¹æ˜¯<code>æ›¹æ“</code>ï¼Œè¯¥ç‰ˆæœ¬çš„<code>trx_id</code>å€¼ä¸º 101ã€‚å¼€å§‹æ‰§è¡Œ Read View å¯è§æ€§è§„åˆ™æ ¡éªŒï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">min_limit_id(100)=&lt;trx_idï¼ˆ101ï¼‰&lt;max_limit_idï¼ˆ102);</span><br><span class=\"line\">ä½†æ˜¯,trx_id=101ï¼Œä¸å±äºm_idsé›†åˆï¼Œè¯´æ˜101è¿™ä¸ªäº‹åŠ¡å·²ç»æäº¤äº†ï¼Œå½“å‰äº‹åŠ¡å¯è§</span><br></pre></td></tr></table></figure>\n\n<p>å› æ­¤ï¼Œ<code>trx_id=101</code>è¿™ä¸ªè®°å½•ï¼Œå¯¹äºå½“å‰äº‹åŠ¡æ˜¯å¯è§çš„ã€‚æ‰€ä»¥ SQL æŸ¥è¯¢åˆ°çš„æ˜¯ name ä¸º<code>æ›¹æ“</code>çš„è®°å½•ã€‚</p>\n<p>ç»¼ä¸Šæ‰€è¿°ï¼Œåœ¨<strong>è¯»å·²æäº¤ï¼ˆRCï¼‰éš”ç¦»çº§åˆ«</strong>ä¸‹ï¼ŒåŒä¸€ä¸ªäº‹åŠ¡é‡Œï¼Œä¸¤ä¸ªç›¸åŒçš„æŸ¥è¯¢ï¼Œè¯»å–åŒä¸€æ¡è®°å½•ï¼ˆid&#x3D;1ï¼‰ï¼Œå´è¿”å›äº†ä¸åŒçš„æ•°æ®ï¼ˆ<strong>ç¬¬ä¸€æ¬¡æŸ¥å‡ºæ¥æ˜¯å­™æƒï¼Œç¬¬äºŒæ¬¡æŸ¥å‡ºæ¥æ˜¯æ›¹æ“é‚£æ¡è®°å½•</strong>ï¼‰ï¼Œå› æ­¤ RC éš”ç¦»çº§åˆ«ï¼Œå­˜åœ¨<strong>ä¸å¯é‡å¤è¯»</strong>å¹¶å‘é—®é¢˜ã€‚</p>\n<h4 id=\"4-3-å¯é‡å¤è¯»ï¼ˆRRï¼‰éš”ç¦»çº§åˆ«ï¼Œè§£å†³ä¸å¯é‡å¤è¯»é—®é¢˜çš„åˆ†æ\"><a href=\"#4-3-å¯é‡å¤è¯»ï¼ˆRRï¼‰éš”ç¦»çº§åˆ«ï¼Œè§£å†³ä¸å¯é‡å¤è¯»é—®é¢˜çš„åˆ†æ\" class=\"headerlink\" title=\"4.3 å¯é‡å¤è¯»ï¼ˆRRï¼‰éš”ç¦»çº§åˆ«ï¼Œè§£å†³ä¸å¯é‡å¤è¯»é—®é¢˜çš„åˆ†æ\"></a>4.3 å¯é‡å¤è¯»ï¼ˆRRï¼‰éš”ç¦»çº§åˆ«ï¼Œè§£å†³ä¸å¯é‡å¤è¯»é—®é¢˜çš„åˆ†æ</h4><p>åœ¨ RR éš”ç¦»çº§åˆ«ä¸‹ï¼Œæ˜¯å¦‚ä½•è§£å†³ä¸å¯é‡å¤è¯»é—®é¢˜çš„å‘¢ï¼Ÿæˆ‘ä»¬ä¸€èµ·å†æ¥çœ‹ä¸‹ï¼Œ</p>\n<p>è¿˜æ˜¯ 4.2 å°èŠ‚é‚£ä¸ªæµç¨‹ï¼Œè¿˜æ˜¯è¿™ä¸ªäº‹åŠ¡ A å’Œäº‹åŠ¡ Bï¼Œå¦‚ä¸‹ï¼š</p>\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131811671.png\" alt=\"image-20220422131811671\" style=\"zoom:33%;\" />\n\n<h5 id=\"4-3-1-ä¸åŒéš”ç¦»çº§åˆ«ä¸‹ï¼ŒRead-viewçš„å·¥ä½œæ–¹å¼ä¸åŒ\"><a href=\"#4-3-1-ä¸åŒéš”ç¦»çº§åˆ«ä¸‹ï¼ŒRead-viewçš„å·¥ä½œæ–¹å¼ä¸åŒ\" class=\"headerlink\" title=\"4.3.1 ä¸åŒéš”ç¦»çº§åˆ«ä¸‹ï¼ŒRead viewçš„å·¥ä½œæ–¹å¼ä¸åŒ\"></a>4.3.1 ä¸åŒéš”ç¦»çº§åˆ«ä¸‹ï¼ŒRead viewçš„å·¥ä½œæ–¹å¼ä¸åŒ</h5><p>å®é™…ä¸Šï¼Œå„ç§äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸‹çš„ Read view å·¥ä½œæ–¹å¼ï¼Œæ˜¯ä¸ä¸€æ ·çš„ï¼ŒRR å¯ä»¥è§£å†³ä¸å¯é‡å¤è¯»é—®é¢˜ï¼Œå°±æ˜¯è·Ÿ<strong>Read viewå·¥ä½œæ–¹å¼æœ‰å…³</strong>ã€‚</p>\n<ul>\n<li>åœ¨è¯»å·²æäº¤ï¼ˆRCï¼‰éš”ç¦»çº§åˆ«ä¸‹ï¼ŒåŒä¸€ä¸ªäº‹åŠ¡é‡Œé¢ï¼Œ<strong>æ¯ä¸€æ¬¡æŸ¥è¯¢éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„Read Viewå‰¯æœ¬</strong>ï¼Œè¿™æ ·å°±å¯èƒ½é€ æˆåŒä¸€ä¸ªäº‹åŠ¡é‡Œå‰åè¯»å–æ•°æ®å¯èƒ½ä¸ä¸€è‡´çš„é—®é¢˜ï¼ˆä¸å¯é‡å¤è¯»å¹¶å‘é—®é¢˜ï¼‰ã€‚</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>begin</th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>select * from core_user where id &#x3D;1</td>\n<td>ç”Ÿæˆä¸€ä¸ªRead View</td>\n</tr>\n<tr>\n<td>&#x2F;</td>\n<td>&#x2F;</td>\n</tr>\n<tr>\n<td>&#x2F;</td>\n<td>&#x2F;</td>\n</tr>\n<tr>\n<td>select * from core_user where id &#x3D;1</td>\n<td>ç”Ÿæˆä¸€ä¸ªRead View</td>\n</tr>\n</tbody></table>\n<ul>\n<li>åœ¨å¯é‡å¤è¯»ï¼ˆRRï¼‰éš”ç¦»çº§åˆ«ä¸‹ï¼Œ<strong>ä¸€ä¸ªäº‹åŠ¡é‡Œåªä¼šè·å–ä¸€æ¬¡read view</strong>ï¼Œéƒ½æ˜¯å‰¯æœ¬å…±ç”¨çš„ï¼Œä»è€Œä¿è¯æ¯æ¬¡æŸ¥è¯¢çš„æ•°æ®éƒ½æ˜¯ä¸€æ ·çš„ã€‚</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>begin</th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>select * from core_user where id &#x3D;1</td>\n<td>ç”Ÿæˆä¸€ä¸ªRead View</td>\n</tr>\n<tr>\n<td>&#x2F;</td>\n<td></td>\n</tr>\n<tr>\n<td>&#x2F;</td>\n<td></td>\n</tr>\n<tr>\n<td>select * from core_user where id &#x3D;1</td>\n<td>å…±ç”¨ä¸€ä¸ªRead Viewå‰¯æœ¬</td>\n</tr>\n</tbody></table>\n<h5 id=\"4-3-2-å®ä¾‹åˆ†æ\"><a href=\"#4-3-2-å®ä¾‹åˆ†æ\" class=\"headerlink\" title=\"4.3.2 å®ä¾‹åˆ†æ\"></a>4.3.2 å®ä¾‹åˆ†æ</h5><p>æˆ‘ä»¬ç©¿è¶Šä¸‹ï¼Œå›åˆ°<strong>åˆš4.2çš„ä¾‹å­</strong>ï¼Œç„¶åæ‰§è¡Œç¬¬ 2 ä¸ªæŸ¥è¯¢çš„æ—¶å€™ï¼š</p>\n<p>äº‹åŠ¡ A å†æ¬¡æ‰§è¡ŒæŸ¥è¯¢æ“ä½œï¼Œå¤ç”¨è€çš„ Read View å‰¯æœ¬ï¼ŒRead View å¯¹åº”çš„å€¼å¦‚ä¸‹</p>\n<table>\n<thead>\n<tr>\n<th>å˜é‡</th>\n<th>å€¼</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>m_ids</td>\n<td>100ï¼Œ101</td>\n</tr>\n<tr>\n<td>max_limit_id</td>\n<td>102</td>\n</tr>\n<tr>\n<td>min_limit_id</td>\n<td>100</td>\n</tr>\n<tr>\n<td>creator_trx_id</td>\n<td>100</td>\n</tr>\n</tbody></table>\n<p>ç„¶åå†æ¬¡å›åˆ°ç‰ˆæœ¬é“¾ï¼šä»ç‰ˆæœ¬é“¾ä¸­æŒ‘é€‰å¯è§çš„è®°å½•ï¼š</p>\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131828812.png\" alt=\"image-20220422131828812\" style=\"zoom:33%;\" />\n\n<p>ä»å›¾å¯å¾—ï¼Œæœ€æ–°ç‰ˆæœ¬çš„åˆ— name çš„å†…å®¹æ˜¯<code>æ›¹æ“</code>ï¼Œè¯¥ç‰ˆæœ¬çš„<code>trx_id</code>å€¼ä¸º 101ã€‚å¼€å§‹æ‰§è¡Œ read view å¯è§æ€§è§„åˆ™æ ¡éªŒï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">min_limit_id(100)=&lt;trx_idï¼ˆ101ï¼‰&lt;max_limit_idï¼ˆ102);</span><br><span class=\"line\">å› ä¸ºm_ids&#123;100,101&#125;åŒ…å«trx_idï¼ˆ101ï¼‰ï¼Œ</span><br><span class=\"line\">å¹¶ä¸”creator_trx_id (100) ä¸ç­‰äºtrx_idï¼ˆ101ï¼‰</span><br></pre></td></tr></table></figure>\n\n<p>æ‰€ä»¥ï¼Œ<code>trx_id=101</code>è¿™ä¸ªè®°å½•ï¼Œå¯¹äºå½“å‰äº‹åŠ¡æ˜¯<strong>ä¸å¯è§</strong>çš„ã€‚è¿™æ—¶å€™å‘¢ï¼Œç‰ˆæœ¬é“¾<code>roll_pointer</code>è·³åˆ°ä¸‹ä¸€ä¸ªç‰ˆæœ¬ï¼Œ<code>trx_id=100</code>è¿™ä¸ªè®°å½•ï¼Œå†æ¬¡æ ¡éªŒæ˜¯å¦å¯è§ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">min_limit_id(100)=&lt;trx_idï¼ˆ100ï¼‰&lt; max_limit_idï¼ˆ102);</span><br><span class=\"line\">å› ä¸ºm_ids&#123;100,101&#125;åŒ…å«trx_idï¼ˆ100ï¼‰ï¼Œ</span><br><span class=\"line\">å¹¶ä¸”creator_trx_id (100) ç­‰äºtrx_idï¼ˆ100ï¼‰</span><br></pre></td></tr></table></figure>\n\n<p>æ‰€ä»¥ï¼Œ<code>trx_id=100</code>è¿™ä¸ªè®°å½•ï¼Œå¯¹äºå½“å‰äº‹åŠ¡æ˜¯<strong>å¯è§</strong>çš„ã€‚å³åœ¨å¯é‡å¤è¯»ï¼ˆRRï¼‰éš”ç¦»çº§åˆ«ä¸‹ï¼Œå¤ç”¨è€çš„ Read View å‰¯æœ¬ï¼Œè§£å†³äº†<strong>ä¸å¯é‡å¤è¯»</strong>çš„é—®é¢˜ã€‚</p>\n<h4 id=\"4-4-MVCCæ˜¯å¦è§£å†³äº†å¹»è¯»é—®é¢˜å‘¢ï¼Ÿ\"><a href=\"#4-4-MVCCæ˜¯å¦è§£å†³äº†å¹»è¯»é—®é¢˜å‘¢ï¼Ÿ\" class=\"headerlink\" title=\"4.4 MVCCæ˜¯å¦è§£å†³äº†å¹»è¯»é—®é¢˜å‘¢ï¼Ÿ\"></a>4.4 MVCCæ˜¯å¦è§£å†³äº†å¹»è¯»é—®é¢˜å‘¢ï¼Ÿ</h4><p>å¯¹äºå¹»è¯»æ¥è¯´ï¼Œå­˜åœ¨å½“å‰è¯»å’Œå¿«ç…§è¯»çš„æƒ…å†µï¼š</p>\n<ol>\n<li>RR éš”ç¦»çº§åˆ«ä¸‹ä¸ºäº†è§£å†³å¹»è¯»é—®é¢˜ï¼š<strong>å¿«ç…§è¯»ä¾é MVCCæ§åˆ¶ï¼Œå½“å‰è¯»é€šè¿‡é—´éš™é”è§£å†³</strong>ï¼›</li>\n<li>é—´éš™é”å’Œè¡Œé”åˆç§° Next-Key Locksï¼Œæ¯ä¸ª Next-Key Locks æ˜¯å‰å¼€åé—­åŒºé—´ï¼›</li>\n<li>é—´éš™é”çš„å¼•å…¥ï¼Œå¯èƒ½ä¼šå¯¼è‡´åŒæ ·è¯­å¥é”ä½æ›´å¤§çš„èŒƒå›´ï¼Œå½±å“å¹¶å‘åº¦ã€‚</li>\n</ol>\n<p>ä½œè€…ï¼šæ¡ç”°èºçš„å°ç”·å­©</p>\n<p>é“¾æ¥ï¼š<a href=\"https://juejin.cn/post/7016165148020703246\">https://juejin.cn/post/7016165148020703246</a></p>\n<p>æ¥æºï¼šç¨€åœŸæ˜é‡‘</p>\n<p>è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>\n<h2 id=\"MySQLé”ç¯‡\"><a href=\"#MySQLé”ç¯‡\" class=\"headerlink\" title=\"MySQLé”ç¯‡\"></a>MySQLé”ç¯‡</h2><h3 id=\"ä»€ä¹ˆæ˜¯é”ï¼ŸMySQL-ä¸­æä¾›äº†å‡ ç±»é”ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯é”ï¼ŸMySQL-ä¸­æä¾›äº†å‡ ç±»é”ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯é”ï¼ŸMySQL ä¸­æä¾›äº†å‡ ç±»é”ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯é”ï¼ŸMySQL ä¸­æä¾›äº†å‡ ç±»é”ï¼Ÿ</h3><p>é”æ˜¯å®ç°æ•°æ®åº“å¹¶å‘æ§åˆ¶çš„é‡è¦æ‰‹æ®µï¼Œå¯ä»¥ä¿è¯æ•°æ®åº“åœ¨å¤šäººåŒæ—¶æ“ä½œæ—¶èƒ½å¤Ÿæ­£å¸¸è¿è¡Œã€‚</p>\n<p>æ’ä»–é”ï¼ˆå†™é”ï¼‰ï¼Œå…±äº«é”ï¼ˆè¯»é”ï¼‰<br>ä¹è§‚é”ï¼Œæ‚²è§‚é”<br>å…¨å±€é”ï¼Œè¡¨é”ï¼Œè¡Œé”ï¼Œé¡µé”</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯æ­»é”ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯æ­»é”ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯æ­»é”ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯æ­»é”ï¼Ÿ</h3><p>æ­»é”æ˜¯æŒ‡ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„è¿›ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå› äº‰å¤ºèµ„æºè€Œé€ æˆçš„ä¸€ç§äº’ç›¸ç­‰å¾…çš„ç°è±¡,è‹¥æ— å¤–åŠ›ä½œç”¨,å®ƒä»¬éƒ½å°†æ— æ³•æ¨è¿›ä¸‹å»ã€‚æ­¤æ—¶ç§°ç³»ç»Ÿå¤„äºæ­»é”çŠ¶æ€æˆ–ç³»ç»Ÿäº§ç”Ÿäº†æ­»é”ï¼Œè¿™äº›æ°¸è¿œåœ¨äº’ç›¸ç­‰å¾…çš„è¿‡ç¨‹ç§°ä¸ºæ­»é”ã€‚</p>\n<h3 id=\"å¦‚ä½•å¤„ç†æ­»é”ï¼Ÿ\"><a href=\"#å¦‚ä½•å¤„ç†æ­»é”ï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•å¤„ç†æ­»é”ï¼Ÿ\"></a>å¦‚ä½•å¤„ç†æ­»é”ï¼Ÿ</h3><p>å¯¹å¾…æ­»é”å¸¸è§çš„ä¸¤ç§ç­–ç•¥ï¼š</p>\n<ul>\n<li><p>è®¾ç½®è¶…æ—¶æ—¶é—´</p>\n</li>\n<li><p>å‘ç°æ­»é”ä¹‹åï¼Œä¸»åŠ¨å›æ»šæ­»é”ä¸­çš„æŸä¸€ä¸ªäº‹åŠ¡ï¼Œè®©å…¶å®ƒäº‹åŠ¡ç»§ç»­æ‰§è¡Œã€‚</p>\n</li>\n</ul>\n<h3 id=\"å¦‚ä½•é¿å…æ­»é”ï¼Ÿ\"><a href=\"#å¦‚ä½•é¿å…æ­»é”ï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•é¿å…æ­»é”ï¼Ÿ\"></a>å¦‚ä½•é¿å…æ­»é”ï¼Ÿ</h3><p>ä½¿ç”¨ SELECT â€¦ FOR UPDATE è¯­å¥æ¥è·å–å¿…è¦çš„é”ã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯å…¨å±€é”ï¼Ÿå®ƒçš„åº”ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯å…¨å±€é”ï¼Ÿå®ƒçš„åº”ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯å…¨å±€é”ï¼Ÿå®ƒçš„åº”ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯å…¨å±€é”ï¼Ÿå®ƒçš„åº”ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ</h3><p>å…¨å±€é”å°±æ˜¯å¯¹æ•´ä¸ªæ•°æ®åº“å®ä¾‹åŠ é”ï¼Œå®ƒçš„å…¸å‹ä½¿ç”¨åœºæ™¯å°±æ˜¯åšå…¨åº“é€»è¾‘å¤‡ä»½ã€‚ è¿™ä¸ªå‘½ä»¤å¯ä»¥ä½¿æ•´ä¸ªåº“å¤„äºåªè¯»çŠ¶æ€ã€‚ä½¿ç”¨è¯¥å‘½ä»¤ä¹‹åï¼Œæ•°æ®æ›´æ–°è¯­å¥ã€æ•°æ®å®šä¹‰è¯­å¥ã€æ›´æ–°ç±»äº‹åŠ¡çš„æäº¤è¯­å¥ç­‰æ“ä½œéƒ½ä¼šè¢«é˜»å¡ã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯å…±äº«é”ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯å…±äº«é”ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯å…±äº«é”ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯å…±äº«é”ï¼Ÿ</h3><p>å…±äº«é”åˆç§°è¯»é” (read lock)ï¼Œæ˜¯è¯»å–æ“ä½œåˆ›å»ºçš„é”ã€‚å…¶ä»–ç”¨æˆ·å¯ä»¥å¹¶å‘è¯»å–æ•°æ®ï¼Œä½†ä»»ä½•äº‹åŠ¡éƒ½ä¸èƒ½å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ï¼ˆè·å–æ•°æ®ä¸Šçš„æ’ä»–é”ï¼‰ï¼Œç›´åˆ°å·²é‡Šæ”¾æ‰€æœ‰å…±äº«é”ã€‚å½“å¦‚æœäº‹åŠ¡å¯¹è¯»é”è¿›è¡Œä¿®æ”¹æ“ä½œï¼Œå¾ˆå¯èƒ½ä¼šé€ æˆæ­»é”ã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯æ’å®ƒé”ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯æ’å®ƒé”ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯æ’å®ƒé”ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯æ’å®ƒé”ï¼Ÿ</h3><p>æ’ä»–é” exclusive lockï¼ˆä¹Ÿå« writer lockï¼‰åˆç§°å†™é”ã€‚</p>\n<p>è‹¥æŸä¸ªäº‹ç‰©å¯¹æŸä¸€è¡ŒåŠ ä¸Šäº†æ’ä»–é”ï¼Œåªèƒ½è¿™ä¸ªäº‹åŠ¡å¯¹å…¶è¿›è¡Œè¯»å†™ï¼Œåœ¨æ­¤äº‹åŠ¡ç»“æŸä¹‹å‰ï¼Œå…¶ä»–äº‹åŠ¡ä¸èƒ½å¯¹å…¶è¿›è¡ŒåŠ ä»»ä½•é”ï¼Œå…¶ä»–è¿›ç¨‹å¯ä»¥è¯»å–,ä¸èƒ½è¿›è¡Œå†™æ“ä½œï¼Œéœ€ç­‰å¾…å…¶é‡Šæ”¾ã€‚</p>\n<p>æ’å®ƒé”æ˜¯æ‚²è§‚é”çš„ä¸€ç§å®ç°ï¼Œåœ¨ä¸Šé¢æ‚²è§‚é”ä¹Ÿä»‹ç»è¿‡ã€‚</p>\n<h3 id=\"ä½¿ç”¨å…¨å±€é”ä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜ï¼Ÿ\"><a href=\"#ä½¿ç”¨å…¨å±€é”ä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜ï¼Ÿ\" class=\"headerlink\" title=\"ä½¿ç”¨å…¨å±€é”ä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜ï¼Ÿ\"></a>ä½¿ç”¨å…¨å±€é”ä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜ï¼Ÿ</h3><p>å¦‚æœåœ¨ä¸»åº“å¤‡ä»½ï¼Œåœ¨å¤‡ä»½æœŸé—´ä¸èƒ½æ›´æ–°ï¼Œä¸šåŠ¡åœæ‘†ï¼Œæ‰€ä»¥æ›´æ–°ä¸šåŠ¡ä¼šå¤„äºç­‰å¾…çŠ¶æ€ã€‚</p>\n<p>å¦‚æœåœ¨ä»åº“å¤‡ä»½ï¼Œåœ¨å¤‡ä»½æœŸé—´ä¸èƒ½æ‰§è¡Œä¸»åº“åŒæ­¥çš„ binlogï¼Œå¯¼è‡´ä¸»ä»å»¶è¿Ÿã€‚</p>\n<p>å¦‚æœä½¿ç”¨å…¨å±€é”è¿›è¡Œé€»è¾‘å¤‡ä»½å°±ä¼šè®©æ•´ä¸ªåº“æˆä¸ºåªè¯»çŠ¶æ€ï¼Œå¹¸å¥½å®˜æ–¹æ¨å‡ºäº†ä¸€ä¸ªé€»è¾‘å¤‡ä»½å·¥å…· MySQL dump æ¥è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œåªéœ€è¦åœ¨ä½¿ç”¨ MySQLdump æ—¶ï¼Œä½¿ç”¨å‚æ•° single-transaction å°±ä¼šåœ¨å¯¼å…¥æ•°æ®ä¹‹å‰å¯åŠ¨ä¸€ä¸ªäº‹åŠ¡æ¥ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ï¼Œå¹¶ä¸”è¿™ä¸ªè¿‡ç¨‹æ˜¯æ”¯æŒæ•°æ®æ›´æ–°æ“ä½œçš„ã€‚</p>\n<h3 id=\"æ‚²è§‚é”å’Œä¹è§‚é”æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"><a href=\"#æ‚²è§‚é”å’Œä¹è§‚é”æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"æ‚²è§‚é”å’Œä¹è§‚é”æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"></a>æ‚²è§‚é”å’Œä¹è§‚é”æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p>é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¾ˆæ‚²è§‚ï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¼šä¿®æ”¹ï¼Œæ‰€ä»¥æ¯æ¬¡åœ¨æ‹¿æ•°æ®çš„æ—¶å€™éƒ½ä¼šä¸Šé”ï¼Œè¿™æ ·åˆ«äººæƒ³æ‹¿è¿™ä¸ªæ•°æ®å°±ä¼š block ç›´åˆ°å®ƒæ‹¿åˆ°é”ã€‚æ­£å› ä¸ºå¦‚æ­¤ï¼Œæ‚²è§‚é”éœ€è¦è€—è´¹è¾ƒå¤šçš„æ—¶é—´ï¼Œå¦å¤–ä¸ä¹è§‚é”ç›¸å¯¹åº”çš„ï¼Œæ‚²è§‚é”æ˜¯ç”±æ•°æ®åº“è‡ªå·±å®ç°äº†çš„ï¼Œè¦ç”¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç›´æ¥è°ƒç”¨æ•°æ®åº“çš„ç›¸å…³è¯­å¥å°±å¯ä»¥äº†ã€‚</p>\n<p>è¯´åˆ°è¿™é‡Œï¼Œç”±æ‚²è§‚é”æ¶‰åŠåˆ°çš„å¦å¤–ä¸¤ä¸ªé”æ¦‚å¿µå°±å‡ºæ¥äº†ï¼Œå®ƒä»¬å°±æ˜¯å…±äº«é”ä¸æ’å®ƒé”ã€‚å…±äº«é”å’Œæ’å®ƒé”æ˜¯æ‚²è§‚é”çš„ä¸åŒçš„å®ç°ï¼Œå®ƒä¿©éƒ½å±äºæ‚²è§‚é”çš„èŒƒç•´ã€‚</p>\n<p><strong>ä¹è§‚é”æ˜¯ç”¨æ•°æ®ç‰ˆæœ¬ï¼ˆVersionï¼‰è®°å½•æœºåˆ¶å®ç°</strong>ï¼Œè¿™æ˜¯ä¹è§‚é”æœ€å¸¸ç”¨çš„ä¸€ç§å®ç°æ–¹å¼ã€‚ä½•è°“æ•°æ®ç‰ˆæœ¬ï¼Ÿå³ä¸ºæ•°æ®å¢åŠ ä¸€ä¸ªç‰ˆæœ¬æ ‡è¯†ï¼Œä¸€èˆ¬æ˜¯é€šè¿‡ä¸ºæ•°æ®åº“è¡¨å¢åŠ ä¸€ä¸ªæ•°å­—ç±»å‹çš„ version å­—æ®µæ¥å®ç°ã€‚å½“è¯»å–æ•°æ®æ—¶ï¼Œå°† version å­—æ®µçš„å€¼ä¸€åŒè¯»å‡ºï¼Œæ•°æ®æ¯æ›´æ–°ä¸€æ¬¡ï¼Œå¯¹æ­¤ version å€¼åŠ  1ã€‚å½“æˆ‘ä»¬æäº¤æ›´æ–°çš„æ—¶å€™ï¼Œåˆ¤æ–­æ•°æ®åº“è¡¨å¯¹åº”è®°å½•çš„å½“å‰ç‰ˆæœ¬ä¿¡æ¯ä¸ç¬¬ä¸€æ¬¡å–å‡ºæ¥çš„ version å€¼è¿›è¡Œæ¯”å¯¹ï¼Œå¦‚æœæ•°æ®åº“è¡¨å½“å‰ç‰ˆæœ¬å·ä¸ç¬¬ä¸€æ¬¡å–å‡ºæ¥çš„ version å€¼ç›¸ç­‰ï¼Œåˆ™äºˆä»¥æ›´æ–°ï¼Œå¦åˆ™è®¤ä¸ºæ˜¯è¿‡æœŸæ•°æ®ã€‚</p>\n<h3 id=\"ä¹è§‚é”æœ‰ä»€ä¹ˆä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Ÿ\"><a href=\"#ä¹è§‚é”æœ‰ä»€ä¹ˆä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Ÿ\" class=\"headerlink\" title=\"ä¹è§‚é”æœ‰ä»€ä¹ˆä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Ÿ\"></a>ä¹è§‚é”æœ‰ä»€ä¹ˆä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Ÿ</h3><p>å› ä¸ºæ²¡æœ‰åŠ é”æ‰€ä»¥ä¹è§‚é”çš„ä¼˜ç‚¹å°±æ˜¯æ‰§è¡Œæ€§èƒ½é«˜ã€‚å®ƒçš„ç¼ºç‚¹å°±æ˜¯æœ‰å¯èƒ½äº§ç”Ÿ ABA çš„é—®é¢˜ï¼ŒABA é—®é¢˜æŒ‡çš„æ˜¯æœ‰ä¸€ä¸ªå˜é‡ V åˆæ¬¡è¯»å–çš„æ—¶å€™æ˜¯ A å€¼ï¼Œå¹¶ä¸”åœ¨å‡†å¤‡èµ‹å€¼çš„æ—¶å€™æ£€æŸ¥åˆ°å®ƒä»ç„¶æ˜¯ A å€¼ï¼Œä¼šè¯¯ä»¥ä¸ºæ²¡æœ‰è¢«ä¿®æ”¹ä¼šæ­£å¸¸çš„æ‰§è¡Œä¿®æ”¹æ“ä½œï¼Œå®é™…ä¸Šè¿™æ®µæ—¶é—´å®ƒçš„å€¼å¯èƒ½è¢«æ”¹äº†å…¶ä»–å€¼ï¼Œä¹‹ååˆæ”¹å›ä¸º A å€¼ï¼Œè¿™ä¸ªé—®é¢˜è¢«ç§°ä¸º ABA é—®é¢˜ã€‚</p>\n<h3 id=\"â­InnoDB-å­˜å‚¨å¼•æ“æœ‰å‡ ç§é”ç®—æ³•ï¼Ÿ\"><a href=\"#â­InnoDB-å­˜å‚¨å¼•æ“æœ‰å‡ ç§é”ç®—æ³•ï¼Ÿ\" class=\"headerlink\" title=\"â­InnoDB å­˜å‚¨å¼•æ“æœ‰å‡ ç§é”ç®—æ³•ï¼Ÿ\"></a>â­InnoDB å­˜å‚¨å¼•æ“æœ‰å‡ ç§é”ç®—æ³•ï¼Ÿ</h3><ul>\n<li><p>Record Lock â€” å•ä¸ªè¡Œè®°å½•ä¸Šçš„é”ï¼›</p>\n</li>\n<li><p>Gap Lock â€” é—´éš™é”ï¼Œé”å®šä¸€ä¸ªèŒƒå›´ï¼Œä¸åŒ…æ‹¬è®°å½•æœ¬èº«ï¼›</p>\n</li>\n<li><p>Next-Key Lockï¼ˆåŒ…å«è¡Œé”å’Œé—´éš™é”ï¼‰ â€” é”å®šä¸€ä¸ªèŒƒå›´ï¼ŒåŒ…æ‹¬è®°å½•æœ¬èº«ã€‚</p>\n</li>\n</ul>\n<h3 id=\"InnoDB-å¦‚ä½•å®ç°è¡Œé”ï¼Ÿ\"><a href=\"#InnoDB-å¦‚ä½•å®ç°è¡Œé”ï¼Ÿ\" class=\"headerlink\" title=\"InnoDB å¦‚ä½•å®ç°è¡Œé”ï¼Ÿ\"></a>InnoDB å¦‚ä½•å®ç°è¡Œé”ï¼Ÿ</h3><p>å…±äº«é”ï¼š<strong>in share mode</strong></p>\n<p>æ’ä»–é”ï¼š<strong>for update</strong></p>\n<h3 id=\"ä¼˜åŒ–é”æ–¹é¢ä½ æœ‰ä»€ä¹ˆå»ºè®®ï¼Ÿ\"><a href=\"#ä¼˜åŒ–é”æ–¹é¢ä½ æœ‰ä»€ä¹ˆå»ºè®®ï¼Ÿ\" class=\"headerlink\" title=\"ä¼˜åŒ–é”æ–¹é¢ä½ æœ‰ä»€ä¹ˆå»ºè®®ï¼Ÿ\"></a>ä¼˜åŒ–é”æ–¹é¢ä½ æœ‰ä»€ä¹ˆå»ºè®®ï¼Ÿ</h3><ul>\n<li>å°½é‡ä½¿ç”¨è¾ƒä½çš„éš”ç¦»çº§åˆ«ã€‚</li>\n<li>ç²¾å¿ƒè®¾è®¡ç´¢å¼•ï¼Œ å¹¶å°½é‡ä½¿ç”¨ç´¢å¼•è®¿é—®æ•°æ®ï¼Œ ä½¿åŠ é”æ›´ç²¾ç¡®ï¼Œ ä»è€Œå‡å°‘é”å†²çªçš„æœºä¼šã€‚</li>\n<li>é€‰æ‹©åˆç†çš„äº‹åŠ¡å¤§å°ï¼Œå°äº‹åŠ¡å‘ç”Ÿé”å†²çªçš„å‡ ç‡ä¹Ÿæ›´å°ã€‚</li>\n<li>ç»™è®°å½•é›†æ˜¾ç¤ºåŠ é”æ—¶ï¼Œæœ€å¥½ä¸€æ¬¡æ€§è¯·æ±‚è¶³å¤Ÿçº§åˆ«çš„é”ã€‚æ¯”å¦‚è¦ä¿®æ”¹æ•°æ®çš„è¯ï¼Œæœ€å¥½ç›´æ¥ç”³è¯·æ’ä»–é”ï¼Œè€Œä¸æ˜¯å…ˆç”³è¯·å…±äº«é”ï¼Œä¿®æ”¹æ—¶å†è¯·æ±‚æ’ä»–é”ï¼Œè¿™æ ·å®¹æ˜“äº§ç”Ÿæ­»é”ã€‚</li>\n<li>ä¸åŒçš„ç¨‹åºè®¿é—®ä¸€ç»„è¡¨æ—¶ï¼Œåº”å°½é‡çº¦å®šä»¥ç›¸åŒçš„é¡ºåºè®¿é—®å„è¡¨ï¼Œå¯¹ä¸€ä¸ªè¡¨è€Œè¨€ï¼Œå°½å¯èƒ½ä»¥å›ºå®šçš„é¡ºåºå­˜å–è¡¨ä¸­çš„è¡Œã€‚è¿™æ ·å¯ä»¥å¤§å¤§å‡å°‘æ­»é”çš„æœºä¼šã€‚</li>\n<li>å°½é‡ç”¨ç›¸ç­‰æ¡ä»¶è®¿é—®æ•°æ®ï¼Œè¿™æ ·å¯ä»¥é¿å…é—´éš™é”å¯¹å¹¶å‘æ’å…¥çš„å½±å“ã€‚</li>\n<li>ä¸è¦ç”³è¯·è¶…è¿‡å®é™…éœ€è¦çš„é”çº§åˆ«ã€‚</li>\n<li>é™¤éå¿…é¡»ï¼ŒæŸ¥è¯¢æ—¶ä¸è¦æ˜¾ç¤ºåŠ é”ã€‚ MySQL çš„ MVCC å¯ä»¥å®ç°äº‹åŠ¡ä¸­çš„æŸ¥è¯¢ä¸ç”¨åŠ é”ï¼Œä¼˜åŒ–äº‹åŠ¡æ€§èƒ½ï¼›MVCC åªåœ¨ COMMITTED READï¼ˆè¯»æäº¤ï¼‰å’Œ REPEATABLE READï¼ˆå¯é‡å¤è¯»ï¼‰ä¸¤ç§éš”ç¦»çº§åˆ«ä¸‹å·¥ä½œã€‚</li>\n<li>å¯¹äºä¸€äº›ç‰¹å®šçš„äº‹åŠ¡ï¼Œå¯ä»¥ä½¿ç”¨è¡¨é”æ¥æé«˜å¤„ç†é€Ÿåº¦æˆ–å‡å°‘æ­»é”çš„å¯èƒ½ã€‚</li>\n</ul>\n<h3 id=\"MySQL-ä¸­æœ‰å“ªå‡ ç§é”ï¼Ÿ\"><a href=\"#MySQL-ä¸­æœ‰å“ªå‡ ç§é”ï¼Ÿ\" class=\"headerlink\" title=\"MySQL ä¸­æœ‰å“ªå‡ ç§é”ï¼Ÿ\"></a>MySQL ä¸­æœ‰å“ªå‡ ç§é”ï¼Ÿ</h3><p><strong>1ã€è¡¨çº§é”ï¼š</strong> å¼€é”€å°ï¼Œ åŠ é”å¿«ï¼› ä¸ä¼šå‡ºç°æ­»é”ï¼› é”å®šç²’åº¦å¤§ï¼Œ å‘ç”Ÿé”å†²çªçš„æ¦‚ç‡æœ€é«˜ï¼Œ å¹¶å‘åº¦æœ€ä½ã€‚</p>\n<p><strong>2ã€è¡Œçº§é”ï¼š</strong>  å¼€é”€å¤§ï¼Œ åŠ é”æ…¢ï¼› ä¼šå‡ºç°æ­»é”ï¼› é”å®šç²’åº¦æœ€å°ï¼Œ å‘ç”Ÿé”å†²çªçš„æ¦‚ç‡æœ€ä½ï¼Œ å¹¶å‘åº¦ä¹Ÿæœ€é«˜ã€‚</p>\n<p><strong>3ã€é¡µé”ï¼š</strong>  å¼€é”€å’ŒåŠ é”æ—¶é—´ç•Œäºè¡¨é”å’Œè¡Œé”ä¹‹é—´ï¼› ä¼šå‡ºç°æ­»é”ï¼› é”å®šç²’åº¦ç•Œäºè¡¨é”å’Œè¡Œé”ä¹‹é—´ï¼Œ å¹¶å‘åº¦ä¸€èˆ¬ã€‚</p>\n<h3 id=\"é”æœºåˆ¶ä¸InnoDBé”ç®—æ³•\"><a href=\"#é”æœºåˆ¶ä¸InnoDBé”ç®—æ³•\" class=\"headerlink\" title=\"é”æœºåˆ¶ä¸InnoDBé”ç®—æ³•\"></a>é”æœºåˆ¶ä¸InnoDBé”ç®—æ³•</h3><p><strong>MyISAMå’ŒInnoDBå­˜å‚¨å¼•æ“ä½¿ç”¨çš„é”ï¼š</strong></p>\n<ul>\n<li>MyISAM é‡‡ç”¨è¡¨çº§é”(table-level locking)ã€‚</li>\n<li>InnoDB æ”¯æŒè¡Œçº§é”(row-level locking)å’Œè¡¨çº§é”,é»˜è®¤ä¸ºè¡Œçº§é”</li>\n</ul>\n<p><strong>è¡¨çº§é”å’Œè¡Œçº§é”å¯¹æ¯”ï¼š</strong></p>\n<ul>\n<li><p><strong>è¡¨çº§é”ï¼š</strong> MySQL ä¸­é”å®š <strong>ç²’åº¦æœ€å¤§</strong> çš„ä¸€ç§é”ï¼Œå¯¹å½“å‰æ“ä½œçš„æ•´å¼ è¡¨åŠ é”ï¼Œå®ç°ç®€å•ï¼Œèµ„æºæ¶ˆè€—ä¹Ÿæ¯”è¾ƒå°‘ï¼ŒåŠ é”å¿«ï¼Œä¸ä¼šå‡ºç°æ­»é”ã€‚å…¶é”å®šç²’åº¦æœ€å¤§ï¼Œè§¦å‘é”å†²çªçš„æ¦‚ç‡æœ€é«˜ï¼Œå¹¶å‘åº¦æœ€ä½ï¼ŒMyISAM å’Œ InnoDB å¼•æ“éƒ½æ”¯æŒè¡¨çº§é”ã€‚</p>\n</li>\n<li><p><strong>è¡Œçº§é”ï¼š</strong> MySQL ä¸­é”å®š <strong>ç²’åº¦æœ€å°</strong> çš„ä¸€ç§é”ï¼Œåªé’ˆå¯¹å½“å‰æ“ä½œçš„è¡Œè¿›è¡ŒåŠ é”ã€‚ è¡Œçº§é”èƒ½å¤§å¤§å‡å°‘æ•°æ®åº“æ“ä½œçš„å†²çªã€‚å…¶åŠ é”ç²’åº¦æœ€å°ï¼Œå¹¶å‘åº¦é«˜ï¼Œä½†åŠ é”çš„å¼€é”€ä¹Ÿæœ€å¤§ï¼ŒåŠ é”æ…¢ï¼Œä¼šå‡ºç°æ­»é”ã€‚</p>\n</li>\n</ul>\n<h3 id=\"é”çš„ä¼˜åŒ–ç­–ç•¥\"><a href=\"#é”çš„ä¼˜åŒ–ç­–ç•¥\" class=\"headerlink\" title=\"é”çš„ä¼˜åŒ–ç­–ç•¥\"></a>é”çš„ä¼˜åŒ–ç­–ç•¥</h3><p><strong>1ã€</strong> è¯»å†™åˆ†ç¦»</p>\n<p><strong>2ã€</strong> åˆ†æ®µåŠ é”</p>\n<p><strong>3ã€</strong> å‡å°‘é”æŒæœ‰çš„æ—¶é—´</p>\n<p>å¤šä¸ªçº¿ç¨‹å°½é‡ä»¥ç›¸åŒçš„é¡ºåºå»è·å–èµ„æº</p>\n<p>ä¸èƒ½å°†é”çš„ç²’åº¦è¿‡äºç»†åŒ–ï¼Œ ä¸ç„¶å¯èƒ½ä¼šå‡ºç°çº¿ç¨‹çš„åŠ é”å’Œé‡Šæ”¾æ¬¡æ•°è¿‡å¤šï¼Œ åè€Œæ•ˆç‡ä¸å¦‚ä¸€æ¬¡åŠ ä¸€æŠŠå¤§é”ã€‚</p>\n<h2 id=\"MySQLæ—¥å¿—ç¯‡\"><a href=\"#MySQLæ—¥å¿—ç¯‡\" class=\"headerlink\" title=\"MySQLæ—¥å¿—ç¯‡\"></a>MySQLæ—¥å¿—ç¯‡</h2><h3 id=\"MySQL-æœ‰å“ªäº›é‡è¦çš„æ—¥å¿—æ–‡ä»¶ï¼Ÿ\"><a href=\"#MySQL-æœ‰å“ªäº›é‡è¦çš„æ—¥å¿—æ–‡ä»¶ï¼Ÿ\" class=\"headerlink\" title=\"MySQL æœ‰å“ªäº›é‡è¦çš„æ—¥å¿—æ–‡ä»¶ï¼Ÿ\"></a>MySQL æœ‰å“ªäº›é‡è¦çš„æ—¥å¿—æ–‡ä»¶ï¼Ÿ</h3><p>MySQL ä¸­çš„é‡è¦æ—¥å¿—åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªï¼š</p>\n<p><strong>â‘  é”™è¯¯æ—¥å¿—ï¼š</strong>ç”¨æ¥è®°å½• MySQL æœåŠ¡å™¨è¿è¡Œè¿‡ç¨‹ä¸­çš„é”™è¯¯ä¿¡æ¯</p>\n<p><strong>â‘¡ æŸ¥è¯¢æ—¥å¿—</strong>ï¼šæŸ¥è¯¢æ—¥å¿—åœ¨ MySQL ä¸­è¢«ç§°ä¸º general log(é€šç”¨æ—¥å¿—)ï¼ŒæŸ¥è¯¢æ—¥å¿—é‡Œçš„å†…å®¹ä¸è¦è¢«â€œæŸ¥è¯¢æ—¥å¿—â€è¯¯å¯¼ï¼Œè®¤ä¸ºé‡Œé¢åªå­˜å‚¨ select è¯­å¥ï¼Œå…¶å®ä¸ç„¶ï¼ŒæŸ¥è¯¢æ—¥å¿—é‡Œé¢è®°å½•äº†æ•°æ®åº“æ‰§è¡Œçš„æ‰€æœ‰å‘½ä»¤ï¼Œä¸ç®¡è¯­å¥æ˜¯å¦æ­£ç¡®ï¼Œéƒ½ä¼šè¢«è®°å½•ï¼Œå…·ä½“åŸå› å¦‚ä¸‹:</p>\n<ul>\n<li><p>insert æŸ¥è¯¢ä¸ºäº†é¿å…æ•°æ®å†²çªï¼Œå¦‚æœæ­¤å‰æ’å…¥è¿‡æ•°æ®ï¼Œå½“å‰æ’å…¥çš„æ•°æ®å¦‚æœè·Ÿä¸»é”®æˆ–å”¯ä¸€é”®çš„æ•°æ®é‡å¤é‚£è‚¯å®šä¼šæŠ¥é”™ï¼›</p>\n</li>\n<li><p>update æ—¶ä¹Ÿä¼šæŸ¥è¯¢å› ä¸ºæ›´æ–°çš„æ—¶å€™å¾ˆå¯èƒ½ä¼šæ›´æ–°æŸä¸€å—æ•°æ®ï¼›</p>\n</li>\n<li><p>delete æŸ¥è¯¢ï¼Œåªåˆ é™¤ç¬¦åˆæ¡ä»¶çš„æ•°æ®ï¼›</p>\n</li>\n</ul>\n<p>å› æ­¤éƒ½ä¼šäº§ç”Ÿæ—¥å¿—ï¼Œåœ¨å¹¶å‘æ“ä½œéå¸¸å¤šçš„åœºæ™¯ä¸‹ï¼ŒæŸ¥è¯¢ä¿¡æ¯ä¼šéå¸¸å¤šï¼Œé‚£ä¹ˆå¦‚æœéƒ½è®°å½•ä¸‹æ¥ä¼šå¯¼è‡´ IO éå¸¸å¤§ï¼Œå½±å“ MySQL æ€§èƒ½ï¼Œå› æ­¤å¦‚æœä¸æ˜¯åœ¨è°ƒè¯•ç¯å¢ƒä¸‹ï¼Œæ˜¯ä¸å»ºè®®å¼€å¯æŸ¥è¯¢æ—¥å¿—åŠŸèƒ½çš„ã€‚</p>\n<p>æŸ¥è¯¢æ—¥å¿—çš„å¼€å¯æœ‰åŠ©äºå¸®åŠ©æˆ‘ä»¬åˆ†æå“ªäº›è¯­å¥æ‰§è¡Œå¯†é›†ï¼Œæ‰§è¡Œå¯†é›†çš„ select è¯­å¥å¯¹åº”çš„æ•°æ®æ˜¯å¦èƒ½å¤Ÿè¢«ç¼“å­˜ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥å¸®åŠ©æˆ‘ä»¬åˆ†æé—®é¢˜ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µæ¥å†³å®šæ˜¯å¦å¼€å¯æŸ¥è¯¢æ—¥å¿—ã€‚</p>\n<p><strong>â‘¢ æ…¢æ—¥å¿—</strong>ï¼šæ…¢æŸ¥è¯¢ä¼šå¯¼è‡´ CPUã€IOPSã€å†…å­˜æ¶ˆè€—è¿‡é«˜ï¼Œå½“æ•°æ®åº“é‡åˆ°æ€§èƒ½ç“¶é¢ˆæ—¶ï¼Œå¤§éƒ¨åˆ†æ—¶é—´éƒ½æ˜¯ç”±äºæ…¢æŸ¥è¯¢å¯¼è‡´çš„ã€‚å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œå¯ä»¥è®© MySQL è®°å½•ä¸‹æŸ¥è¯¢è¶…è¿‡æŒ‡å®šæ—¶é—´çš„è¯­å¥ï¼Œä¹‹åè¿ç»´äººå‘˜é€šè¿‡å®šä½åˆ†æï¼Œèƒ½å¤Ÿå¾ˆå¥½çš„ä¼˜åŒ–æ•°æ®åº“æ€§èƒ½ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ…¢æŸ¥è¯¢æ—¥å¿—æ˜¯ä¸å¼€å¯çš„ï¼Œåªæœ‰æ‰‹åŠ¨å¼€å¯äº†ï¼Œæ…¢æŸ¥è¯¢æ‰ä¼šè¢«è®°å½•åˆ°æ…¢æŸ¥è¯¢æ—¥å¿—ä¸­ã€‚ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è®°å½•å½“å‰æ•°æ®åº“çš„æ…¢æŸ¥è¯¢è¯­å¥ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">set global slowquerylog=&#x27;ON&#x27;;</span><br></pre></td></tr></table></figure>\n\n<p>ä½¿ç”¨ set global slow<em>query</em>log&#x3D;â€™ONâ€™ å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œåªæ˜¯å¯¹å½“å‰æ•°æ®åº“æœ‰æ•ˆï¼Œå¦‚æœ MySQL æ•°æ®åº“é‡å¯åå°±ä¼šå¤±æ•ˆã€‚æ‰€ä»¥å¦‚æœè¦æ°¸ä¹…ç”Ÿæ•ˆï¼Œå°±è¦ä¿®æ”¹é…ç½®æ–‡ä»¶ my.cnfï¼Œè®¾ç½® slow<em>query</em>log&#x3D;1 å¹¶é‡å¯ MySQL æœåŠ¡å™¨ã€‚</p>\n<p><strong>â‘£ redo logï¼ˆé‡åšæ—¥å¿—ï¼‰</strong>ï¼šä¸ºäº†æœ€å¤§ç¨‹åº¦çš„é¿å…æ•°æ®å†™å…¥æ—¶ï¼Œå› ä¸º IO ç“¶é¢ˆé€ æˆçš„æ€§èƒ½é—®é¢˜ï¼ŒMySQL é‡‡ç”¨äº†è¿™æ ·ä¸€ç§ç¼“å­˜æœºåˆ¶ï¼Œå…ˆå°†æ•°æ®å†™å…¥å†…å­˜ä¸­ï¼Œå†æ‰¹é‡æŠŠå†…å­˜ä¸­çš„æ•°æ®ç»Ÿä¸€åˆ·å›ç£ç›˜ã€‚ä¸ºäº†é¿å…å°†æ•°æ®åˆ·å›ç£ç›˜è¿‡ç¨‹ä¸­ï¼Œå› ä¸ºæ‰ç”µæˆ–ç³»ç»Ÿæ•…éšœå¸¦æ¥çš„æ•°æ®ä¸¢å¤±é—®é¢˜ï¼ŒInnoDB é‡‡ç”¨ redo log æ¥è§£å†³æ­¤é—®é¢˜ã€‚</p>\n<p><strong>â‘¤ undo logï¼ˆå›æ»šæ—¥å¿—ï¼‰</strong>ï¼šç”¨äºå­˜å‚¨æ—¥å¿—è¢«ä¿®æ”¹å‰çš„å€¼ï¼Œä»è€Œä¿è¯å¦‚æœä¿®æ”¹å‡ºç°å¼‚å¸¸ï¼Œå¯ä»¥ä½¿ç”¨ undo log æ—¥å¿—æ¥å®ç°å›æ»šæ“ä½œã€‚ undo log å’Œ redo log è®°å½•ç‰©ç†æ—¥å¿—ä¸ä¸€æ ·ï¼Œå®ƒæ˜¯é€»è¾‘æ—¥å¿—ï¼Œå¯ä»¥è®¤ä¸ºå½“ delete ä¸€æ¡è®°å½•æ—¶ï¼Œundo log ä¸­ä¼šè®°å½•ä¸€æ¡å¯¹åº”çš„ insert è®°å½•ï¼Œåä¹‹äº¦ç„¶ï¼Œå½“ update ä¸€æ¡è®°å½•æ—¶ï¼Œå®ƒè®°å½•ä¸€æ¡å¯¹åº”ç›¸åçš„ update è®°å½•ï¼Œå½“æ‰§è¡Œ rollback æ—¶ï¼Œå°±å¯ä»¥ä» undo log ä¸­çš„é€»è¾‘è®°å½•è¯»å–åˆ°ç›¸åº”çš„å†…å®¹å¹¶è¿›è¡Œå›æ»šã€‚</p>\n<p><strong>â‘¥ bin logï¼ˆäºŒè¿›åˆ¶æ—¥å¿—ï¼‰</strong>ï¼šæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸»è¦<strong>è®°å½•äº†å¯¹ MySQL æ•°æ®åº“æ‰§è¡Œæ›´æ”¹çš„æ‰€æœ‰æ“ä½œ</strong>ï¼Œæ¯”å¦‚ï¼ŒCREATEã€ALTER TABLE ç­‰ï¼Œä»¥åŠè¡¨æ•°æ®ä¿®æ”¹ï¼Œæ¯”å¦‚ï¼ŒINSERTã€UPDATEã€DELETE çš„æ‰€æœ‰æ“ä½œï¼Œä¸è®°å½• SELECTã€SHOW ç­‰é‚£äº›ä¸ä¿®æ”¹æ•°æ®æˆ–æ•°æ®åº“ç»“æ„çš„ SQL è¯­å¥ã€‚</p>\n<p>binlog çš„ä½œç”¨å¦‚ä¸‹ï¼š</p>\n<ul>\n<li><p>æ¢å¤ï¼ˆrecoveryï¼‰ï¼šæŸäº›æ•°æ®çš„æ¢å¤éœ€è¦äºŒè¿›åˆ¶æ—¥å¿—ã€‚æ¯”å¦‚ï¼Œåœ¨ä¸€ä¸ªæ•°æ®åº“å…¨å¤‡æ–‡ä»¶æ¢å¤åï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡äºŒè¿›åˆ¶æ—¥å¿—è¿›è¡Œ point-in-time çš„æ¢å¤ï¼›</p>\n</li>\n<li><p>å¤åˆ¶ï¼ˆreplicationï¼‰ï¼šå…¶åŸç†ä¸æ¢å¤ç±»ä¼¼ï¼Œé€šè¿‡å¤åˆ¶å’Œæ‰§è¡ŒäºŒè¿›åˆ¶æ—¥å¿—ä½¿ä¸€å°è¿œç¨‹çš„ MySQL æ•°æ®åº“ï¼ˆä¸€èˆ¬ç§°ä¸º slave æˆ–è€… standbyï¼‰ä¸ä¸€å° MySQL æ•°æ®åº“ï¼ˆä¸€èˆ¬ç§°ä¸º master æˆ–è€… primaryï¼‰è¿›è¡Œå®æ—¶åŒæ­¥ï¼›</p>\n</li>\n<li><p>å®¡è®¡ï¼ˆauditï¼‰ï¼šç”¨æˆ·å¯ä»¥é€šè¿‡äºŒè¿›åˆ¶æ—¥å¿—ä¸­çš„ä¿¡æ¯æ¥è¿›è¡Œå®¡è®¡ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰å¯¹æ•°æ®åº“è¿›è¡Œæ³¨å…¥æ”»å‡»ã€‚</p>\n</li>\n</ul>\n<p>é™¤äº†ä¸Šé¢ä»‹ç»çš„å‡ ä¸ªä½œç”¨å¤–ï¼Œbinlog å¯¹äºäº‹åŠ¡å­˜å‚¨å¼•æ“çš„å´©æºƒæ¢å¤ä¹Ÿæœ‰éå¸¸é‡è¦çš„ä½œç”¨ï¼Œåœ¨å¼€å¯ binlog çš„æƒ…å†µä¸‹ï¼Œä¸ºäº†ä¿è¯ binlog ä¸ redo çš„ä¸€è‡´æ€§ï¼ŒMySQL å°†é‡‡ç”¨äº‹åŠ¡çš„ä¸¤é˜¶æ®µæäº¤åè®®ã€‚å½“ MySQL ç³»ç»Ÿå‘ç”Ÿå´©æºƒæ—¶ï¼Œäº‹åŠ¡åœ¨å­˜å‚¨å¼•æ“å†…éƒ¨çš„çŠ¶æ€å¯èƒ½ä¸º preparedï¼ˆå‡†å¤‡çŠ¶æ€ï¼‰å’Œ commitï¼ˆæäº¤çŠ¶æ€ï¼‰ä¸¤ç§ï¼Œå¯¹äº prepared çŠ¶æ€çš„äº‹åŠ¡ï¼Œæ˜¯è¿›è¡Œæäº¤æ“ä½œè¿˜æ˜¯è¿›è¡Œå›æ»šæ“ä½œï¼Œè¿™æ—¶éœ€è¦å‚è€ƒ binlogï¼Œå¦‚æœäº‹åŠ¡åœ¨ binlog ä¸­å­˜åœ¨ï¼Œé‚£ä¹ˆå°†å…¶æäº¤ï¼›å¦‚æœä¸åœ¨ binlog ä¸­å­˜åœ¨ï¼Œé‚£ä¹ˆå°†å…¶å›æ»šï¼Œè¿™æ ·å°±ä¿è¯äº†æ•°æ®åœ¨ä¸»åº“å’Œä»åº“ä¹‹é—´çš„ä¸€è‡´æ€§ã€‚</p>\n<p>binlog é»˜è®¤æ˜¯å…³é—­çŠ¶æ€ï¼Œå¯ä»¥åœ¨ MySQL é…ç½®æ–‡ä»¶ï¼ˆmy.cnfï¼‰ä¸­é€šè¿‡é…ç½®å‚æ•° log-bin &#x3D; [base-name] å¼€å¯è®°å½• binlog æ—¥å¿—ï¼Œå¦‚æœä¸æŒ‡å®š base-nameï¼Œåˆ™é»˜è®¤äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶åä¸ºä¸»æœºåï¼Œå¹¶ä»¥è‡ªå¢çš„æ•°å­—ä½œä¸ºåç¼€ï¼Œæ¯”å¦‚ï¼šmysql-bin.000001ï¼Œæ‰€åœ¨ç›®å½•ä¸ºæ•°æ®åº“æ‰€åœ¨ç›®å½•ï¼ˆdatadirï¼‰ã€‚</p>\n<p>é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ¥æŸ¥è¯¢ binlog æ˜¯å¦å¼€å¯ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">show variables like &#x27;log_%&#x27;; </span><br></pre></td></tr></table></figure>\n\n<p>binlog æ ¼å¼åˆ†ä¸º: STATEMENTã€ROW å’Œ MIXED ä¸‰ç§ï¼š</p>\n<ul>\n<li><p>STATEMENT æ ¼å¼çš„ binlog è®°å½•çš„æ˜¯æ•°æ®åº“ä¸Šæ‰§è¡Œçš„åŸç”Ÿ SQL è¯­å¥ã€‚è¿™ç§æ ¼å¼çš„ä¼˜ç‚¹æ˜¯ç®€å•ï¼Œç®€å•åœ°è®°å½•å’Œæ‰§è¡Œè¿™äº›è¯­å¥ï¼Œèƒ½å¤Ÿè®©ä¸»å¤‡ä¿æŒåŒæ­¥ï¼Œåœ¨ä¸»æœåŠ¡å™¨ä¸Šæ‰§è¡Œçš„ SQL è¯­å¥ï¼Œåœ¨ä»æœåŠ¡å™¨ä¸Šæ‰§è¡ŒåŒæ ·çš„è¯­å¥ã€‚å¦ä¸€ä¸ªå¥½å¤„æ˜¯äºŒè¿›åˆ¶æ—¥å¿—é‡Œçš„æ—¶é—´æ›´åŠ ç´§å‡‘ï¼Œæ‰€ä»¥ç›¸å¯¹è€Œè¨€ï¼ŒåŸºäºè¯­å¥çš„å¤åˆ¶æ¨¡å¼ä¸ä¼šä½¿ç”¨å¤ªå¤šå¸¦å®½ï¼ŒåŒæ—¶ä¹ŸèŠ‚çº¦ç£ç›˜ç©ºé—´ã€‚å¹¶ä¸”é€šè¿‡ mysqlbinlog å·¥å…·å®¹æ˜“è¯»æ‡‚å…¶ä¸­çš„å†…å®¹ã€‚ç¼ºç‚¹å°±æ˜¯åŒä¸€æ¡ SQL åœ¨ä¸»åº“å’Œä»åº“ä¸Šæ‰§è¡Œçš„æ—¶é—´å¯èƒ½ç¨å¾®æˆ–å¾ˆå¤§ä¸ç›¸åŒï¼Œå› æ­¤åœ¨ä¼ è¾“çš„äºŒè¿›åˆ¶æ—¥å¿—ä¸­ï¼Œé™¤äº†æŸ¥è¯¢è¯­å¥ï¼Œè¿˜åŒ…æ‹¬äº†ä¸€äº›å…ƒæ•°æ®ä¿¡æ¯ï¼Œå¦‚å½“å‰çš„æ—¶é—´æˆ³ã€‚å³ä¾¿å¦‚æ­¤ï¼Œè¿˜å­˜åœ¨ç€ä¸€äº›æ— æ³•è¢«æ­£ç¡®å¤åˆ¶çš„ SQLã€‚æ¯”å¦‚ï¼Œä½¿ç”¨ INSERT INTO TB1 VALUE(CUURENT_DATE()) è¿™ä¸€æ¡ä½¿ç”¨å‡½æ•°çš„è¯­å¥æ’å…¥çš„æ•°æ®å¤åˆ¶åˆ°å½“å‰ä»æœåŠ¡å™¨ä¸Šæ¥å°±ä¼šå‘ç”Ÿå˜åŒ–ï¼Œå­˜å‚¨è¿‡ç¨‹å’Œè§¦å‘å™¨åœ¨ä½¿ç”¨åŸºäºè¯­å¥çš„å¤åˆ¶æ¨¡å¼æ—¶ä¹Ÿå¯èƒ½å­˜åœ¨é—®é¢˜ï¼›å¦å¤–ä¸€ä¸ªé—®é¢˜å°±æ˜¯åŸºäºè¯­å¥çš„å¤åˆ¶å¿…é¡»æ˜¯ä¸²è¡ŒåŒ–çš„ï¼Œæ¯”å¦‚ï¼šInnoDB çš„ next-key é”ç­‰ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„å­˜å‚¨å¼•æ“éƒ½æ”¯æŒåŸºäºè¯­å¥çš„å¤åˆ¶ï¼›</p>\n</li>\n<li><p>ROW æ ¼å¼æ˜¯ä» MySQL 5.1 å¼€å§‹æ”¯æŒåŸºäºè¡Œçš„å¤åˆ¶ï¼Œä¹Ÿå°±æ˜¯åŸºäºæ•°æ®çš„å¤åˆ¶ï¼ŒåŸºäºè¡Œçš„æ›´æ”¹ã€‚è¿™ç§æ–¹å¼ä¼šå°†å®é™…æ•°æ®è®°å½•åœ¨äºŒè¿›åˆ¶æ—¥å¿—ä¸­ï¼Œå®ƒæœ‰å…¶è‡ªèº«çš„ä¸€äº›ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Œæœ€å¤§çš„å¥½å¤„æ˜¯å¯ä»¥æ­£ç¡®åœ°å¤åˆ¶æ¯ä¸€è¡Œæ•°æ®ï¼Œä¸€äº›è¯­å¥å¯ä»¥è¢«æ›´åŠ æœ‰æ•ˆåœ°å¤åˆ¶ï¼Œå¦å¤–å°±æ˜¯å‡ ä¹æ²¡æœ‰åŸºäºè¡Œçš„å¤åˆ¶æ¨¡å¼æ— æ³•å¤„ç†çš„åœºæ™¯ï¼Œå¯¹äºæ‰€æœ‰çš„ SQL æ„é€ ã€è§¦å‘å™¨ã€å­˜å‚¨è¿‡ç¨‹ç­‰éƒ½èƒ½æ­£ç¡®æ‰§è¡Œï¼›å®ƒçš„ç¼ºç‚¹å°±æ˜¯äºŒè¿›åˆ¶æ—¥å¿—å¯èƒ½ä¼šå¾ˆå¤§ï¼Œè€Œä¸”ä¸ç›´è§‚ï¼Œæ‰€ä»¥ï¼Œä½ ä¸èƒ½ä½¿ç”¨ mysqlbinlog æ¥æŸ¥çœ‹äºŒè¿›åˆ¶æ—¥å¿—ï¼Œä¹Ÿæ— æ³•é€šè¿‡çœ‹äºŒè¿›åˆ¶æ—¥å¿—åˆ¤æ–­å½“å‰æ‰§è¡Œåˆ°é‚£ä¸€æ¡ SQL è¯­å¥ã€‚ç°åœ¨å¯¹äº ROW æ ¼å¼çš„äºŒè¿›åˆ¶æ—¥å¿—åŸºæœ¬æ˜¯æ ‡é…äº†ï¼Œä¸»è¦æ˜¯å› ä¸ºå®ƒçš„ä¼˜åŠ¿è¿œè¿œå¤§äºç¼ºç‚¹ï¼Œå¹¶ä¸”ç”±äº ROW æ ¼å¼è®°å½•è¡Œæ•°æ®ï¼Œæ‰€ä»¥å¯ä»¥åŸºäºè¿™ç§æ¨¡å¼åšä¸€äº› DBA å·¥å…·ï¼Œæ¯”å¦‚æ•°æ®æ¢å¤ï¼Œä¸åŒæ•°æ®åº“ä¹‹é—´æ•°æ®åŒæ­¥ç­‰ï¼›</p>\n</li>\n<li><p>MIXED ä¹Ÿæ˜¯ MySQL é»˜è®¤ä½¿ç”¨çš„äºŒè¿›åˆ¶æ—¥å¿—è®°å½•æ–¹å¼ï¼Œä½† MIXED æ ¼å¼é»˜è®¤é‡‡ç”¨åŸºäºè¯­å¥çš„å¤åˆ¶ï¼Œä¸€æ—¦å‘ç°åŸºäºè¯­å¥çš„æ— æ³•ç²¾ç¡®çš„å¤åˆ¶æ—¶ï¼Œå°±ä¼šé‡‡ç”¨åŸºäºè¡Œçš„å¤åˆ¶ã€‚æ¯”å¦‚ç”¨åˆ° UUID()ã€USER()ã€CURRENT<em>USER()ã€ROW</em>COUNT() ç­‰æ— æ³•ç¡®å®šçš„å‡½æ•°ã€‚</p>\n</li>\n</ul>\n<h3 id=\"redo-log-å’Œ-binlog-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"><a href=\"#redo-log-å’Œ-binlog-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"redo log å’Œ binlog æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"></a>redo log å’Œ binlog æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p>redo logï¼ˆé‡åšæ—¥å¿—ï¼‰å’Œ binlogï¼ˆå½’æ¡£æ—¥å¿—ï¼‰éƒ½æ˜¯ MySQL çš„é‡è¦çš„æ—¥å¿—ï¼Œå®ƒä»¬çš„åŒºåˆ«å¦‚ä¸‹ï¼š</p>\n<ul>\n<li><p>redo log æ˜¯ç‰©ç†æ—¥å¿—ï¼Œè®°å½•çš„æ˜¯â€œåœ¨æŸä¸ªæ•°æ®é¡µä¸Šåšäº†ä»€ä¹ˆä¿®æ”¹â€ã€‚</p>\n</li>\n<li><p>binlog æ˜¯é€»è¾‘æ—¥å¿—ï¼Œè®°å½•çš„æ˜¯è¿™ä¸ªè¯­å¥çš„åŸå§‹é€»è¾‘ï¼Œæ¯”å¦‚â€œç»™ ID&#x3D;2 è¿™ä¸€è¡Œçš„ c å­—æ®µåŠ  1 â€ã€‚</p>\n</li>\n<li><p>redo log æ˜¯ InnoDB å¼•æ“ç‰¹æœ‰çš„ï¼›binlog æ˜¯ MySQL çš„ Server å±‚å®ç°çš„ï¼Œæ‰€æœ‰å¼•æ“éƒ½å¯ä»¥ä½¿ç”¨ã€‚</p>\n</li>\n<li><p>redo log æ˜¯å¾ªç¯å†™çš„ï¼Œç©ºé—´å›ºå®šä¼šç”¨å®Œï¼›binlog æ˜¯å¯ä»¥è¿½åŠ å†™å…¥çš„ã€‚â€œè¿½åŠ å†™â€æ˜¯æŒ‡ binlog æ–‡ä»¶å†™åˆ°ä¸€å®šå¤§å°åä¼šåˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªï¼Œå¹¶ä¸ä¼šè¦†ç›–ä»¥å‰çš„æ—¥å¿—ã€‚</p>\n</li>\n</ul>\n<p>æœ€å¼€å§‹ MySQL é‡Œå¹¶æ²¡æœ‰ InnoDB å¼•æ“ï¼ŒMySQL è‡ªå¸¦çš„å¼•æ“æ˜¯ MyISAMï¼Œä½†æ˜¯ MyISAM æ²¡æœ‰ crash-safe çš„èƒ½åŠ›ï¼Œbinlog æ—¥å¿—åªèƒ½ç”¨äºå½’æ¡£ã€‚è€Œ InnoDB æ˜¯å¦ä¸€ä¸ªå…¬å¸ä»¥æ’ä»¶å½¢å¼å¼•å…¥ MySQL çš„ï¼Œæ—¢ç„¶åªä¾é  binlog æ˜¯æ²¡æœ‰ crash-safe èƒ½åŠ›çš„ï¼Œæ‰€ä»¥ InnoDB ä½¿ç”¨å¦å¤–ä¸€å¥—æ—¥å¿—ç³»ç»Ÿï¼Œä¹Ÿå°±æ˜¯ redo log æ¥å®ç° crash-safe èƒ½åŠ›ã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯-crash-safeï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯-crash-safeï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ crash-safeï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯ crash-safeï¼Ÿ</h3><p>crash-safe æ˜¯æŒ‡å‘ç”Ÿå®•æœºç­‰æ„å¤–æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨é‡å¯åæ•°æ®ä¾ç„¶ä¸ä¼šä¸¢å¤±çš„æƒ…å†µã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯è„é¡µå’Œå¹²å‡€é¡µï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯è„é¡µå’Œå¹²å‡€é¡µï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯è„é¡µå’Œå¹²å‡€é¡µï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯è„é¡µå’Œå¹²å‡€é¡µï¼Ÿ</h3><p>MySQL ä¸ºäº†æ“ä½œçš„æ€§èƒ½ä¼˜åŒ–ï¼Œä¼šæŠŠæ•°æ®æ›´æ–°å…ˆæ”¾å…¥å†…å­˜ä¸­ï¼Œä¹‹åå†ç»Ÿä¸€æ›´æ–°åˆ°ç£ç›˜ã€‚å½“å†…å­˜æ•°æ®å’Œç£ç›˜æ•°æ®å†…å®¹ä¸ä¸€è‡´çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç§°è¿™ä¸ªå†…å­˜é¡µä¸ºè„é¡µï¼›å†…å­˜æ•°æ®å†™åˆ°ç£ç›˜åï¼Œå†…å­˜çš„æ•°æ®å’Œç£ç›˜ä¸Šçš„å†…å®¹å°±ä¸€è‡´äº†ï¼Œæˆ‘ä»¬ç§°ä¸ºâ€œå¹²å‡€é¡µâ€ã€‚</p>\n<h3 id=\"ä»€ä¹ˆæƒ…å†µä¸‹ä¼šå¼•å‘-MySQL-åˆ·è„é¡µï¼ˆflushï¼‰çš„æ“ä½œï¼Ÿ\"><a href=\"#ä»€ä¹ˆæƒ…å†µä¸‹ä¼šå¼•å‘-MySQL-åˆ·è„é¡µï¼ˆflushï¼‰çš„æ“ä½œï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæƒ…å†µä¸‹ä¼šå¼•å‘ MySQL åˆ·è„é¡µï¼ˆflushï¼‰çš„æ“ä½œï¼Ÿ\"></a>ä»€ä¹ˆæƒ…å†µä¸‹ä¼šå¼•å‘ MySQL åˆ·è„é¡µï¼ˆflushï¼‰çš„æ“ä½œï¼Ÿ</h3><ul>\n<li><p>å†…å­˜å†™æ»¡äº†ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šå¼•å‘ flush æ“ä½œï¼Œå¯¹åº”åˆ° InnoDB å°±æ˜¯ redo log å†™æ»¡äº†ï¼›</p>\n</li>\n<li><p>ç³»ç»Ÿçš„å†…å­˜ä¸è¶³äº†ï¼Œå½“éœ€è¦æ–°çš„å†…å­˜é¡µçš„æ—¶å€™ï¼Œå°±ä¼šæ·˜æ±°ä¸€äº›å†…å­˜é¡µï¼Œå¦‚æœæ·˜æ±°çš„æ˜¯è„é¡µè¿™ä¸ªæ—¶å€™å°±ä¼šè§¦å‘ flush æ“ä½œï¼›</p>\n</li>\n<li><p>ç³»ç»Ÿç©ºé—²çš„æ—¶å€™ï¼ŒMySQL ä¼šåŒæ­¥å†…å­˜ä¸­çš„æ•°æ®åˆ°ç£ç›˜ä¹Ÿä¼šè§¦å‘ flush æ“ä½œï¼›</p>\n</li>\n<li><p>MySQL æœåŠ¡å…³é—­çš„æ—¶å€™ä¹Ÿä¼šåˆ·è„é¡µï¼Œè§¦å‘ flush æ“ä½œã€‚</p>\n</li>\n</ul>\n<h3 id=\"MySQL-åˆ·è„é¡µçš„é€Ÿåº¦å¾ˆæ…¢å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ\"><a href=\"#MySQL-åˆ·è„é¡µçš„é€Ÿåº¦å¾ˆæ…¢å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ\" class=\"headerlink\" title=\"MySQL åˆ·è„é¡µçš„é€Ÿåº¦å¾ˆæ…¢å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ\"></a>MySQL åˆ·è„é¡µçš„é€Ÿåº¦å¾ˆæ…¢å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ</h3><p>åœ¨ MySQL ä¸­å•ç‹¬åˆ·ä¸€ä¸ªè„é¡µçš„é€Ÿåº¦æ˜¯å¾ˆå¿«çš„ï¼Œå¦‚æœå‘ç°åˆ·è„é¡µçš„é€Ÿåº¦å¾ˆæ…¢ï¼Œè¯´æ˜è§¦å‘äº† MySQL åˆ·è„é¡µçš„â€œè¿åâ€æœºåˆ¶ï¼ŒMySQL çš„â€œè¿åâ€æœºåˆ¶æ˜¯æŒ‡å½“ MySQL åˆ·è„é¡µçš„æ—¶å€™å¦‚æœå‘ç°ç›¸é‚»çš„æ•°æ®é¡µä¹Ÿæ˜¯è„é¡µä¹Ÿä¼šä¸€èµ·åˆ·æ‰ï¼Œè€Œè¿™ä¸ªåŠ¨ä½œå¯ä»¥ä¸€ç›´è”“å»¶ä¸‹å»ï¼Œè¿™å°±æ˜¯å¯¼è‡´ MySQL åˆ·è„é¡µæ…¢çš„åŸå› äº†ã€‚</p>\n<h3 id=\"å¦‚ä½•æ§åˆ¶-MySQL-åªåˆ·æ–°å½“å‰è„é¡µï¼Ÿ\"><a href=\"#å¦‚ä½•æ§åˆ¶-MySQL-åªåˆ·æ–°å½“å‰è„é¡µï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•æ§åˆ¶ MySQL åªåˆ·æ–°å½“å‰è„é¡µï¼Ÿ\"></a>å¦‚ä½•æ§åˆ¶ MySQL åªåˆ·æ–°å½“å‰è„é¡µï¼Ÿ</h3><p>åœ¨ InnoDB ä¸­è®¾ç½® innodb<em>flush</em>neighbors è¿™ä¸ªå‚æ•°çš„å€¼ä¸º 0ï¼Œæ¥è§„å®š MySQL åªåˆ·å½“å‰è„é¡µï¼ŒMySQL 8 è¿™ä¸ªå€¼é»˜è®¤æ˜¯ 0ã€‚</p>\n<h3 id=\"MySQL-çš„-WAL-æŠ€æœ¯æ˜¯è§£å†³ä»€ä¹ˆé—®é¢˜çš„ï¼Ÿ\"><a href=\"#MySQL-çš„-WAL-æŠ€æœ¯æ˜¯è§£å†³ä»€ä¹ˆé—®é¢˜çš„ï¼Ÿ\" class=\"headerlink\" title=\"MySQL çš„ WAL æŠ€æœ¯æ˜¯è§£å†³ä»€ä¹ˆé—®é¢˜çš„ï¼Ÿ\"></a>MySQL çš„ WAL æŠ€æœ¯æ˜¯è§£å†³ä»€ä¹ˆé—®é¢˜çš„ï¼Ÿ</h3><p>A.é˜²æ­¢è¯¯åˆ é™¤ï¼Œæ‰¾å›æ•°æ®ç”¨çš„ B.å®¹ç¾æ¢å¤ï¼Œä¸ºäº†è¿˜åŸå¼‚å¸¸æ•°æ®ç”¨çš„ C.äº‹åŠ¡å¤„ç†ï¼Œä¸ºäº†æ•°æ®åº“çš„ç¨³å®šæ€§ D.ä¸ºäº†é™ä½ IO æˆæœ¬ ç­”ï¼šD é¢˜ç›®è§£æï¼šWAL æŠ€æœ¯çš„å…¨ç§°æ˜¯ Write Ahead Loggingï¼ˆä¸­æ–‡ï¼šé¢„å†™å¼æ—¥å¿—ï¼‰ï¼Œæ˜¯å…ˆå†™æ—¥å¿—ï¼Œå†å†™ç£ç›˜çš„æ–¹å¼ï¼Œå› ä¸ºæ¯æ¬¡æ›´æ–°éƒ½å†™ç£ç›˜çš„è¯ IO æˆæœ¬å¾ˆé«˜ï¼Œæ‰€ä»¥æ‰æœ‰äº† WAL æŠ€æœ¯ã€‚</p>\n<h3 id=\"ä¸ºä»€ä¹ˆæœ‰æ—¶å€™ä¼šæ„Ÿè§‰-MySQL-å¶å°”å¡ä¸€ä¸‹ï¼Ÿ\"><a href=\"#ä¸ºä»€ä¹ˆæœ‰æ—¶å€™ä¼šæ„Ÿè§‰-MySQL-å¶å°”å¡ä¸€ä¸‹ï¼Ÿ\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆæœ‰æ—¶å€™ä¼šæ„Ÿè§‰ MySQL å¶å°”å¡ä¸€ä¸‹ï¼Ÿ\"></a>ä¸ºä»€ä¹ˆæœ‰æ—¶å€™ä¼šæ„Ÿè§‰ MySQL å¶å°”å¡ä¸€ä¸‹ï¼Ÿ</h3><p>å¦‚æœå¶å°”æ„Ÿè§‰ MySQL å¡ä¸€ä¸‹ï¼Œå¯èƒ½æ˜¯ MySQL æ­£åœ¨åˆ·è„é¡µï¼Œæ­£åœ¨æŠŠå†…å­˜ä¸­çš„æ›´æ–°æ“ä½œåˆ·åˆ°ç£ç›˜ä¸­ã€‚</p>\n<h3 id=\"redo-log-å’Œ-binlog-æ˜¯æ€ä¹ˆå…³è”çš„\"><a href=\"#redo-log-å’Œ-binlog-æ˜¯æ€ä¹ˆå…³è”çš„\" class=\"headerlink\" title=\"redo log å’Œ binlog æ˜¯æ€ä¹ˆå…³è”çš„?\"></a>redo log å’Œ binlog æ˜¯æ€ä¹ˆå…³è”çš„?</h3><p>å®ƒä»¬æœ‰ä¸€ä¸ªå…±åŒçš„æ•°æ®å­—æ®µï¼Œå« XIDã€‚å´©æºƒæ¢å¤çš„æ—¶å€™ï¼Œä¼šæŒ‰é¡ºåºæ‰«æ redo logï¼š</p>\n<ul>\n<li><p>å¦‚æœç¢°åˆ°æ—¢æœ‰ prepareã€åˆæœ‰ commit çš„ redo logï¼Œå°±ç›´æ¥æäº¤ï¼›</p>\n</li>\n<li><p>å¦‚æœç¢°åˆ°åªæœ‰ parepareã€è€Œæ²¡æœ‰ commit çš„ redo logï¼Œå°±æ‹¿ç€ XID å» binlog æ‰¾å¯¹åº”çš„äº‹åŠ¡ã€‚</p>\n</li>\n</ul>\n<h3 id=\"MySQL-æ€ä¹ˆçŸ¥é“-binlog-æ˜¯å®Œæ•´çš„\"><a href=\"#MySQL-æ€ä¹ˆçŸ¥é“-binlog-æ˜¯å®Œæ•´çš„\" class=\"headerlink\" title=\"MySQL æ€ä¹ˆçŸ¥é“ binlog æ˜¯å®Œæ•´çš„?\"></a>MySQL æ€ä¹ˆçŸ¥é“ binlog æ˜¯å®Œæ•´çš„?</h3><ul>\n<li><p>statement æ ¼å¼çš„ binlogï¼Œå®Œæ•´çš„æ ‡è¯†æ˜¯æœ€åæœ‰ COMMIT å…³é”®å­—ã€‚</p>\n</li>\n<li><p>row æ ¼å¼çš„ binlogï¼Œå®Œæ•´çš„æ ‡è¯†æ˜¯æœ€åä¼šæœ‰ä¸€ä¸ª XID event å…³é”®å­—ã€‚</p>\n</li>\n</ul>\n<h3 id=\"MySQL-ä¸­å¯ä¸å¯ä»¥åªè¦-binlogï¼Œä¸è¦-redo-logï¼Ÿ\"><a href=\"#MySQL-ä¸­å¯ä¸å¯ä»¥åªè¦-binlogï¼Œä¸è¦-redo-logï¼Ÿ\" class=\"headerlink\" title=\"MySQL ä¸­å¯ä¸å¯ä»¥åªè¦ binlogï¼Œä¸è¦ redo logï¼Ÿ\"></a>MySQL ä¸­å¯ä¸å¯ä»¥åªè¦ binlogï¼Œä¸è¦ redo logï¼Ÿ</h3><p>ä¸å¯ä»¥ï¼Œbinlog æ²¡æœ‰å´©æºƒæ¢å¤çš„èƒ½åŠ›ã€‚</p>\n<h3 id=\"MySQL-ä¸­å¯ä¸å¯ä»¥åªè¦-redo-logï¼Œä¸è¦-binlogï¼Ÿ\"><a href=\"#MySQL-ä¸­å¯ä¸å¯ä»¥åªè¦-redo-logï¼Œä¸è¦-binlogï¼Ÿ\" class=\"headerlink\" title=\"MySQL ä¸­å¯ä¸å¯ä»¥åªè¦ redo logï¼Œä¸è¦ binlogï¼Ÿ\"></a>MySQL ä¸­å¯ä¸å¯ä»¥åªè¦ redo logï¼Œä¸è¦ binlogï¼Ÿ</h3><p>ä¸å¯ä»¥ï¼ŒåŸå› æœ‰ä»¥ä¸‹ä¸¤ä¸ªï¼š</p>\n<ul>\n<li><p>redo log æ˜¯å¾ªç¯å†™ä¸èƒ½ä¿è¯æ‰€æœ‰çš„å†å²æ•°æ®ï¼Œè¿™äº›å†å²æ•°æ®åªèƒ½åœ¨ binlog ä¸­æ‰¾åˆ°ï¼›</p>\n</li>\n<li><p>binlog æ˜¯é«˜å¯ç”¨çš„åŸºç¡€ï¼Œé«˜å¯ç”¨çš„å®ç°åŸç†å°±æ˜¯ binlog å¤åˆ¶ã€‚</p>\n</li>\n</ul>\n<h3 id=\"ä¸ºä»€ä¹ˆ-binlog-cache-æ˜¯æ¯ä¸ªçº¿ç¨‹è‡ªå·±ç»´æŠ¤çš„ï¼Œè€Œ-redo-log-buffer-æ˜¯å…¨å±€å…±ç”¨çš„ï¼Ÿ\"><a href=\"#ä¸ºä»€ä¹ˆ-binlog-cache-æ˜¯æ¯ä¸ªçº¿ç¨‹è‡ªå·±ç»´æŠ¤çš„ï¼Œè€Œ-redo-log-buffer-æ˜¯å…¨å±€å…±ç”¨çš„ï¼Ÿ\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆ binlog cache æ˜¯æ¯ä¸ªçº¿ç¨‹è‡ªå·±ç»´æŠ¤çš„ï¼Œè€Œ redo log buffer æ˜¯å…¨å±€å…±ç”¨çš„ï¼Ÿ\"></a>ä¸ºä»€ä¹ˆ binlog cache æ˜¯æ¯ä¸ªçº¿ç¨‹è‡ªå·±ç»´æŠ¤çš„ï¼Œè€Œ redo log buffer æ˜¯å…¨å±€å…±ç”¨çš„ï¼Ÿ</h3><p>å› ä¸º binlog æ˜¯ä¸èƒ½â€œè¢«æ‰“æ–­çš„â€ï¼Œä¸€ä¸ªäº‹åŠ¡çš„ binlog å¿…é¡»è¿ç»­å†™ï¼Œå› æ­¤è¦æ•´ä¸ªäº‹åŠ¡å®Œæˆåï¼Œå†ä¸€èµ·å†™åˆ°æ–‡ä»¶é‡Œã€‚è€Œ redo log å¹¶æ²¡æœ‰è¿™ä¸ªè¦æ±‚ï¼Œä¸­é—´æœ‰ç”Ÿæˆçš„æ—¥å¿—å¯ä»¥å†™åˆ° redo log buffer ä¸­ï¼Œredo log buffer ä¸­çš„å†…å®¹è¿˜èƒ½â€œæ­ä¾¿è½¦â€ï¼Œå…¶ä»–äº‹åŠ¡æäº¤çš„æ—¶å€™å¯ä»¥è¢«ä¸€èµ·å†™åˆ°ç£ç›˜ä¸­ã€‚</p>\n<h3 id=\"äº‹åŠ¡æ‰§è¡ŒæœŸé—´ï¼Œè¿˜æœªæäº¤ï¼Œå¦‚æœå‘ç”Ÿ-crashï¼Œredo-log-ä¸¢å¤±ï¼Œä¼šå¯¼è‡´ä¸»å¤‡ä¸ä¸€è‡´å‘¢ï¼Ÿ\"><a href=\"#äº‹åŠ¡æ‰§è¡ŒæœŸé—´ï¼Œè¿˜æœªæäº¤ï¼Œå¦‚æœå‘ç”Ÿ-crashï¼Œredo-log-ä¸¢å¤±ï¼Œä¼šå¯¼è‡´ä¸»å¤‡ä¸ä¸€è‡´å‘¢ï¼Ÿ\" class=\"headerlink\" title=\"äº‹åŠ¡æ‰§è¡ŒæœŸé—´ï¼Œè¿˜æœªæäº¤ï¼Œå¦‚æœå‘ç”Ÿ crashï¼Œredo log ä¸¢å¤±ï¼Œä¼šå¯¼è‡´ä¸»å¤‡ä¸ä¸€è‡´å‘¢ï¼Ÿ\"></a>äº‹åŠ¡æ‰§è¡ŒæœŸé—´ï¼Œè¿˜æœªæäº¤ï¼Œå¦‚æœå‘ç”Ÿ crashï¼Œredo log ä¸¢å¤±ï¼Œä¼šå¯¼è‡´ä¸»å¤‡ä¸ä¸€è‡´å‘¢ï¼Ÿ</h3><p>ä¸ä¼šï¼Œå› ä¸ºè¿™æ—¶å€™ binlog ä¹Ÿè¿˜åœ¨ binlog cache é‡Œï¼Œæ²¡å‘ç»™å¤‡åº“ï¼Œcrash ä»¥å redo log å’Œ binlog éƒ½æ²¡æœ‰äº†ï¼Œä»ä¸šåŠ¡è§’åº¦çœ‹è¿™ä¸ªäº‹åŠ¡ä¹Ÿæ²¡æœ‰æäº¤ï¼Œæ‰€ä»¥æ•°æ®æ˜¯ä¸€è‡´çš„ã€‚</p>\n<h3 id=\"åœ¨-MySQL-ä¸­ç”¨ä»€ä¹ˆæœºåˆ¶æ¥ä¼˜åŒ–éšæœºè¯»-x2F-å†™ç£ç›˜å¯¹-IO-çš„æ¶ˆè€—ï¼Ÿ\"><a href=\"#åœ¨-MySQL-ä¸­ç”¨ä»€ä¹ˆæœºåˆ¶æ¥ä¼˜åŒ–éšæœºè¯»-x2F-å†™ç£ç›˜å¯¹-IO-çš„æ¶ˆè€—ï¼Ÿ\" class=\"headerlink\" title=\"åœ¨ MySQL ä¸­ç”¨ä»€ä¹ˆæœºåˆ¶æ¥ä¼˜åŒ–éšæœºè¯»&#x2F;å†™ç£ç›˜å¯¹ IO çš„æ¶ˆè€—ï¼Ÿ\"></a>åœ¨ MySQL ä¸­ç”¨ä»€ä¹ˆæœºåˆ¶æ¥ä¼˜åŒ–éšæœºè¯»&#x2F;å†™ç£ç›˜å¯¹ IO çš„æ¶ˆè€—ï¼Ÿ</h3><p>redo log æ˜¯ç”¨æ¥èŠ‚çœéšæœºå†™ç£ç›˜çš„ IO æ¶ˆè€—ï¼Œè€Œ change buffer ä¸»è¦æ˜¯èŠ‚çœéšæœºè¯»ç£ç›˜çš„ IO æ¶ˆè€—ã€‚redo log ä¼šæŠŠ MySQL çš„æ›´æ–°æ“ä½œå…ˆè®°å½•åˆ°å†…å­˜ä¸­ï¼Œä¹‹åå†ç»Ÿä¸€æ›´æ–°åˆ°ç£ç›˜ï¼Œè€Œ change buffer ä¹Ÿæ˜¯æŠŠå…³é”®æŸ¥è¯¢æ•°æ®å…ˆåŠ è½½åˆ°å†…å­˜ä¸­ï¼Œä»¥ä¾¿ä¼˜åŒ– MySQL çš„æŸ¥è¯¢ã€‚</p>\n<h3 id=\"ä»¥ä¸‹è¯´æ³•é”™è¯¯çš„æ˜¯ï¼Ÿ\"><a href=\"#ä»¥ä¸‹è¯´æ³•é”™è¯¯çš„æ˜¯ï¼Ÿ\" class=\"headerlink\" title=\"ä»¥ä¸‹è¯´æ³•é”™è¯¯çš„æ˜¯ï¼Ÿ\"></a>ä»¥ä¸‹è¯´æ³•é”™è¯¯çš„æ˜¯ï¼Ÿ</h3><p>A.redo log æ˜¯ InnoDB å¼•æ“ç‰¹æœ‰çš„ï¼Œå®ƒçš„å›ºå®šå¤§å°çš„ B.redo log æ—¥å¿—æ˜¯ä¸å…¨çš„ï¼Œåªæœ‰æœ€æ–°çš„ä¸€äº›æ—¥å¿—ï¼Œè¿™å’Œå®ƒçš„å†…å­˜å¤§å°æœ‰å…³ C.redo log å¯ä»¥ä¿è¯æ•°æ®åº“å¼‚å¸¸é‡å¯ä¹‹åï¼Œæ•°æ®ä¸ä¸¢å¤± D.binlog æ˜¯ MySQL è‡ªå¸¦çš„æ—¥å¿—ï¼Œå®ƒèƒ½ä¿è¯æ•°æ®åº“å¼‚å¸¸é‡å¯ä¹‹åï¼Œæ•°æ®ä¸ä¸¢å¤± ç­”ï¼šD é¢˜ç›®è§£æï¼šbinlog æ˜¯ MySQL è‡ªå¸¦çš„æ—¥å¿—ï¼Œä½†å®ƒå¹¶ä¸èƒ½ä¿è¯æ•°æ®åº“å¼‚å¸¸é‡å¯ä¹‹åæ•°æ®ä¸ä¸¢å¤±ã€‚</p>\n<h3 id=\"ä»¥ä¸‹è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼Ÿ\"><a href=\"#ä»¥ä¸‹è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼Ÿ\" class=\"headerlink\" title=\"ä»¥ä¸‹è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼Ÿ\"></a>ä»¥ä¸‹è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼Ÿ</h3><p>A.redo log æ—¥å¿—æ˜¯è¿½åŠ å†™çš„ï¼Œåé¢çš„æ—¥å¿—å¹¶ä¸ä¼šè¦†ç›–å‰é¢çš„æ—¥å¿— B.binlog æ—¥å¿—æ˜¯è¿½åŠ å†™çš„ï¼Œåé¢çš„æ—¥å¿—å¹¶ä¸ä¼šè¦†ç›–å‰é¢çš„æ—¥å¿— C.redo log å’Œ binlog æ—¥å¿—éƒ½æ˜¯è¿½åŠ å†™çš„ï¼Œåé¢çš„æ—¥å¿—å¹¶ä¸ä¼šè¦†ç›–å‰é¢çš„æ—¥å¿— D.ä»¥ä¸Šè¯´æ³•éƒ½æ­£ç¡® ç­”ï¼šB é¢˜ç›®è§£æï¼šbinlog æ—¥å¿—æ˜¯è¿½åŠ å†™çš„ï¼Œåé¢çš„æ—¥å¿—å¹¶ä¸ä¼šè¦†ç›–å‰é¢çš„æ—¥å¿—ï¼Œredo log æ—¥å¿—æ˜¯å›ºå®šå¤§å°çš„ï¼Œåé¢çš„æ—¥å¿—ä¼šè¦†ç›–å‰é¢çš„æ—¥å¿—ã€‚</p>\n<h3 id=\"æœ‰æ²¡æœ‰åŠæ³•æŠŠ-MySQL-çš„æ•°æ®æ¢å¤åˆ°è¿‡å»æŸä¸ªæŒ‡å®šçš„æ—¶é—´èŠ‚ç‚¹ï¼Ÿæ€ä¹ˆæ¢å¤ï¼Ÿ\"><a href=\"#æœ‰æ²¡æœ‰åŠæ³•æŠŠ-MySQL-çš„æ•°æ®æ¢å¤åˆ°è¿‡å»æŸä¸ªæŒ‡å®šçš„æ—¶é—´èŠ‚ç‚¹ï¼Ÿæ€ä¹ˆæ¢å¤ï¼Ÿ\" class=\"headerlink\" title=\"æœ‰æ²¡æœ‰åŠæ³•æŠŠ MySQL çš„æ•°æ®æ¢å¤åˆ°è¿‡å»æŸä¸ªæŒ‡å®šçš„æ—¶é—´èŠ‚ç‚¹ï¼Ÿæ€ä¹ˆæ¢å¤ï¼Ÿ\"></a>æœ‰æ²¡æœ‰åŠæ³•æŠŠ MySQL çš„æ•°æ®æ¢å¤åˆ°è¿‡å»æŸä¸ªæŒ‡å®šçš„æ—¶é—´èŠ‚ç‚¹ï¼Ÿæ€ä¹ˆæ¢å¤ï¼Ÿ</h3><p>å¯ä»¥æ¢å¤ï¼Œåªè¦ä½ å¤‡ä»½äº†è¿™æ®µæ—¶é—´çš„æ‰€æœ‰ binlogï¼ŒåŒæ—¶åšäº†å…¨é‡æ•°æ®åº“çš„å®šæœŸå¤‡ä»½ï¼Œæ¯”å¦‚ï¼Œä¸€å¤©ä¸€å¤‡ï¼Œæˆ–è€…ä¸‰å¤©ä¸€å¤‡ï¼Œè¿™å–å†³äºä½ ä»¬çš„å¤‡ä»½ç­–ç•¥ï¼Œè¿™ä¸ªæ—¶å€™ä½ å°±å¯ä»¥æŠŠä¹‹å‰å¤‡ä»½çš„æ•°æ®åº“å…ˆè¿˜åŸåˆ°æµ‹è¯•åº“ï¼Œä»å¤‡ä»½çš„æ—¶é—´ç‚¹å¼€å§‹ï¼Œå°†å¤‡ä»½çš„ binlog ä¾æ¬¡å–å‡ºæ¥ï¼Œé‡æ”¾åˆ°ä½ è¦æ¢å¤æ•°æ®çš„é‚£ä¸ªæ—¶åˆ»ï¼Œè¿™ä¸ªæ—¶å€™å°±å®Œæˆäº†æ•°æ®åˆ°æŒ‡å®šèŠ‚ç‚¹çš„æ¢å¤ã€‚æ¯”å¦‚ï¼Œä»Šå¤©æ—©ä¸Š 9 ç‚¹çš„æ—¶å€™ï¼Œä½ æƒ³æŠŠæ•°æ®æ¢å¤æˆä»Šå¤©æ—©ä¸Š 6:00:00 çš„çŠ¶æ€ï¼Œè¿™ä¸ªæ—¶å€™ä½ å¯ä»¥å…ˆå–å‡ºä»Šå¤©å‡Œæ™¨ï¼ˆ00:01:59ï¼‰å¤‡ä»½çš„æ•°æ®åº“æ–‡ä»¶ï¼Œè¿˜åŸåˆ°æµ‹è¯•åº“ï¼Œå†ä» binlog æ–‡ä»¶ä¸­ä¾æ¬¡å–å‡º 00:01:59 ä¹‹åçš„æ“ä½œä¿¡æ¯ï¼Œé‡æ”¾åˆ° 6:00:00 è¿™ä¸ªæ—¶åˆ»ï¼Œè¿™å°±å®Œæˆäº†æ•°æ®åº“çš„è¿˜åŸã€‚</p>\n<h2 id=\"MySQLæ€§èƒ½ä¼˜åŒ–\"><a href=\"#MySQLæ€§èƒ½ä¼˜åŒ–\" class=\"headerlink\" title=\"MySQLæ€§èƒ½ä¼˜åŒ–\"></a>MySQLæ€§èƒ½ä¼˜åŒ–</h2><h3 id=\"MySQL-æ€§èƒ½æŒ‡æ ‡éƒ½æœ‰å“ªäº›ï¼Ÿå¦‚ä½•å¾—åˆ°è¿™äº›æŒ‡æ ‡ï¼Ÿ\"><a href=\"#MySQL-æ€§èƒ½æŒ‡æ ‡éƒ½æœ‰å“ªäº›ï¼Ÿå¦‚ä½•å¾—åˆ°è¿™äº›æŒ‡æ ‡ï¼Ÿ\" class=\"headerlink\" title=\"MySQL æ€§èƒ½æŒ‡æ ‡éƒ½æœ‰å“ªäº›ï¼Ÿå¦‚ä½•å¾—åˆ°è¿™äº›æŒ‡æ ‡ï¼Ÿ\"></a>MySQL æ€§èƒ½æŒ‡æ ‡éƒ½æœ‰å“ªäº›ï¼Ÿå¦‚ä½•å¾—åˆ°è¿™äº›æŒ‡æ ‡ï¼Ÿ</h3><p>MySQL çš„æ€§èƒ½æŒ‡æ ‡å¦‚ä¸‹ï¼š</p>\n<p><strong>â‘  TPSï¼ˆTransaction Per Secondï¼‰</strong> æ¯ç§’äº‹åŠ¡æ•°ï¼Œå³æ•°æ®åº“æ¯ç§’æ‰§è¡Œçš„äº‹åŠ¡æ•°ã€‚</p>\n<p>MySQL æœ¬èº«æ²¡æœ‰ç›´æ¥æä¾› TPS å‚æ•°å€¼ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦è·å¾— TPS çš„å€¼ï¼Œåªæœ‰æˆ‘ä»¬è‡ªå·±è®¡ç®—äº†ï¼Œå¯ä»¥æ ¹æ® MySQL æ•°æ®åº“æä¾›çš„çŠ¶æ€å˜é‡ï¼Œæ¥è®¡ç®— TPSã€‚</p>\n<p>éœ€è¦ä½¿ç”¨çš„å‚æ•°ï¼š</p>\n<ul>\n<li><p>Com_commit ï¼šè¡¨ç¤ºæäº¤æ¬¡æ•°ï¼Œé€šè¿‡å‘½ä»¤ <code>show global status like &#39;Com_commit&#39;;</code> è·å–ï¼›</p>\n</li>\n<li><p>Com_rollbackï¼šè¡¨ç¤ºå›æ»šæ¬¡æ•°ï¼Œé€šè¿‡å‘½ä»¤ <code>show global status like &#39;Com_rollback&#39;;</code> è·å–ã€‚</p>\n</li>\n</ul>\n<p>æˆ‘ä»¬å®šä¹‰ç¬¬ä¸€æ¬¡è·å–çš„ Com<em>commit çš„å€¼ä¸ Com</em>rollback å€¼çš„å’Œä¸º c_r1ï¼Œæ—¶é—´ä¸º t1ï¼›</p>\n<p>ç¬¬äºŒæ¬¡è·å–çš„ Com<em>commit çš„å€¼ä¸ Com</em>rollback å€¼çš„å’Œä¸º c<em>r2ï¼Œæ—¶é—´ä¸º t2ï¼Œt1 ä¸ t2 å•ä½ä¸ºç§’ã€‚ é‚£ä¹ˆ TPS &#x3D; ( c</em>r2 - c_r1 ) &#x2F; ( t2 - t1 ) ç®—å‡ºæ¥çš„å°±æ˜¯è¯¥ MySQL å®ä¾‹åœ¨ t1 ä¸ t2 ç”Ÿå‘½å‘¨æœŸä¹‹é—´çš„å¹³å‡ TPSã€‚</p>\n<p><strong>â‘¡ QPSï¼ˆQuery Per Secondï¼‰</strong> æ¯ç§’è¯·æ±‚æ¬¡æ•°ï¼Œä¹Ÿå°±æ˜¯æ•°æ®åº“æ¯ç§’æ‰§è¡Œçš„ SQL æ•°é‡ï¼ŒåŒ…å« INSERTã€SELECTã€UPDATEã€DELETE ç­‰ã€‚ QPS &#x3D; Queries &#x2F; Seconds Queries æ˜¯ç³»ç»ŸçŠ¶æ€å€¼â€”æ€»æŸ¥è¯¢æ¬¡æ•°ï¼Œå¯ä»¥é€šè¿‡ <code>show status like &#39;queries&#39;;</code> æŸ¥è¯¢å¾—å‡º </p>\n<p>Seconds æ˜¯ç›‘æ§çš„æ—¶é—´åŒºé—´ï¼Œå•ä½ä¸ºç§’ã€‚ æ¯”å¦‚ï¼Œé‡‡æ · 10 ç§’å†…çš„æŸ¥è¯¢æ¬¡æ•°ï¼Œé‚£ä¹ˆå…ˆæŸ¥è¯¢ä¸€æ¬¡ Queries å€¼ï¼ˆQ1ï¼‰ï¼Œç­‰å¾… 10 ç§’ï¼Œå†æŸ¥è¯¢ä¸€æ¬¡ Queries å€¼ï¼ˆQ2ï¼‰ï¼Œé‚£ä¹ˆ QPS å°±å¯ä»¥é€šè¿‡ï¼Œå¦‚ä¸‹å…¬å¼è·å¾—ï¼š</p>\n<blockquote>\n<p>QPS &#x3D; (Q2 - Q1) &#x2F; 10</p>\n</blockquote>\n<p><strong>â‘¢ IOPSï¼ˆInput&#x2F;Output Operations per Secondï¼‰</strong> æ¯ç§’å¤„ç†çš„ I&#x2F;O è¯·æ±‚æ¬¡æ•°ã€‚</p>\n<p>IOPS æ˜¯åˆ¤æ–­ç£ç›˜ I&#x2F;O èƒ½åŠ›çš„æŒ‡æ ‡ä¹‹ä¸€ï¼Œä¸€èˆ¬æ¥è®² IOPS æŒ‡æ ‡è¶Šé«˜ï¼Œé‚£ä¹ˆå•ä½æ—¶é—´å†…èƒ½å¤Ÿå“åº”çš„è¯·æ±‚è‡ªç„¶ä¹Ÿå°±è¶Šå¤šã€‚ç†è®ºä¸Šè®²ï¼Œåªè¦ç³»ç»Ÿå®é™…çš„è¯·æ±‚æ•°ä½äº IOPS çš„èƒ½åŠ›ï¼Œå°±ç›¸å½“äºæ¯ä¸€ä¸ªè¯·æ±‚éƒ½èƒ½å¾—åˆ°å³æ—¶å“åº”ï¼Œé‚£ä¹ˆ I&#x2F;O å°±ä¸ä¼šæ˜¯ç“¶é¢ˆäº†ã€‚</p>\n<p>æ³¨æ„ï¼šIOPS ä¸ç£ç›˜ååé‡ä¸ä¸€æ ·ï¼Œååé‡æ˜¯æŒ‡å•ä½æ—¶é—´å†…å¯ä»¥æˆåŠŸä¼ è¾“çš„æ•°æ®æ•°é‡ã€‚</p>\n<p>å¯ä»¥ä½¿ç”¨ iostat å‘½ä»¤ï¼ŒæŸ¥çœ‹ç£ç›˜çš„ IOPSï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>\n<blockquote>\n<p>yum install sysstat iostat -dx 1 10</p>\n</blockquote>\n<p>æ‰§è¡Œæ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š </p>\n<p>IOPS &#x3D; r&#x2F;s + w&#x2F;s å…¶ä¸­ï¼š</p>\n<ul>\n<li><p>r&#x2F;sï¼šä»£è¡¨æ¯ç§’è¯»äº†å¤šå°‘æ¬¡ï¼›</p>\n</li>\n<li><p>w&#x2F;sï¼šä»£è¡¨æ¯ç§’å†™äº†å¤šå°‘æ¬¡ã€‚</p>\n</li>\n</ul>\n<h3 id=\"ä»€ä¹ˆæ˜¯æ…¢æŸ¥è¯¢ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯æ…¢æŸ¥è¯¢ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯æ…¢æŸ¥è¯¢ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯æ…¢æŸ¥è¯¢ï¼Ÿ</h3><p>æ…¢æŸ¥è¯¢æ˜¯ MySQL ä¸­æä¾›çš„ä¸€ç§æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œå®ƒç”¨æ¥è®°å½•åœ¨ MySQL ä¸­å“åº”æ—¶é—´è¶…è¿‡é˜€å€¼çš„è¯­å¥ï¼Œå…·ä½“æŒ‡è¿è¡Œæ—¶é—´è¶…è¿‡ <em>longquerytime</em> å€¼çš„ SQLï¼Œåˆ™ä¼šè¢«è®°å½•åˆ°æ…¢æŸ¥è¯¢æ—¥å¿—ä¸­ã€‚ <em>longquerytime</em> çš„é»˜è®¤å€¼ä¸º 10ï¼Œæ„æ€æ˜¯è¿è¡Œ 10s ä»¥ä¸Šçš„è¯­å¥ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒMySQL æ•°æ®åº“å¹¶ä¸å¯åŠ¨æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œéœ€è¦æˆ‘ä»¬æ‰‹åŠ¨æ¥è®¾ç½®è¿™ä¸ªå‚æ•°ï¼Œå¦‚æœä¸æ˜¯è°ƒä¼˜éœ€è¦çš„è¯ï¼Œä¸€èˆ¬ä¸å»ºè®®å¯åŠ¨è¯¥å‚æ•°ï¼Œå› ä¸ºå¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ä¼šç»™ MySQL æœåŠ¡å™¨å¸¦æ¥ä¸€å®šçš„æ€§èƒ½å½±å“ã€‚æ…¢æŸ¥è¯¢æ—¥å¿—æ”¯æŒå°†æ—¥å¿—è®°å½•å†™å…¥æ–‡ä»¶ï¼Œä¹Ÿæ”¯æŒå°†æ—¥å¿—è®°å½•å†™å…¥æ•°æ®åº“è¡¨ã€‚</p>\n<p>ä½¿ç”¨ <code>mysql&gt; show variables like &#39;%slow_query_log%&#39;;</code> æ¥æŸ¥è¯¢æ…¢æŸ¥è¯¢æ—¥å¿—æ˜¯å¦å¼€å¯</p>\n<h3 id=\"å¦‚ä½•å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Ÿ\"><a href=\"#å¦‚ä½•å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Ÿ\"></a>å¦‚ä½•å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Ÿ</h3><p>å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹ MySQL å‘½ä»¤ï¼š</p>\n<blockquote>\n<p>mysql&gt; set global slow<em>query</em>log&#x3D;1</p>\n</blockquote>\n<p>ä¸è¿‡è¿™ç§è®¾ç½®æ–¹å¼ï¼Œåªå¯¹å½“å‰æ•°æ®åº“ç”Ÿæ•ˆï¼Œå¦‚æœ MySQL é‡å¯ä¹Ÿä¼šå¤±æ•ˆï¼Œå¦‚æœè¦æ°¸ä¹…ç”Ÿæ•ˆï¼Œå°±å¿…é¡»ä¿®æ”¹ MySQL çš„é…ç½®æ–‡ä»¶ my.cnfï¼Œé…ç½®å¦‚ä¸‹ï¼š</p>\n<blockquote>\n<p>slow<em>query</em>log &#x3D;1 slow<em>query</em>log<em>file&#x3D;&#x2F;tmp&#x2F;mysql</em>slow.log</p>\n</blockquote>\n<h3 id=\"å¦‚ä½•å®šä½æ…¢æŸ¥è¯¢ï¼Ÿ\"><a href=\"#å¦‚ä½•å®šä½æ…¢æŸ¥è¯¢ï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•å®šä½æ…¢æŸ¥è¯¢ï¼Ÿ\"></a>å¦‚ä½•å®šä½æ…¢æŸ¥è¯¢ï¼Ÿ</h3><p>ä½¿ç”¨ MySQL ä¸­çš„ explain åˆ†ææ‰§è¡Œè¯­å¥ï¼Œæ¯”å¦‚ï¼š</p>\n<blockquote>\n<p>explain select * from t where id&#x3D;5;</p>\n</blockquote>\n<p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes11474088-2ff861def7876a91.png\" alt=\"avatar\"> </p>\n<p>å…¶ä¸­ï¼š</p>\n<ul>\n<li><p>id â€” é€‰æ‹©æ ‡è¯†ç¬¦ã€‚id è¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜ï¼Œè¶Šå…ˆè¢«æ‰§è¡Œã€‚</p>\n</li>\n<li><p>select_type â€” è¡¨ç¤ºæŸ¥è¯¢çš„ç±»å‹ã€‚</p>\n</li>\n<li><p>table â€” è¾“å‡ºç»“æœé›†çš„è¡¨</p>\n</li>\n<li><p>partitions â€” åŒ¹é…çš„åˆ†åŒº</p>\n</li>\n<li><p>type â€” è¡¨ç¤ºè¡¨çš„è¿æ¥ç±»å‹</p>\n</li>\n<li><p>possible_keys â€” è¡¨ç¤ºæŸ¥è¯¢æ—¶ï¼Œå¯èƒ½ä½¿ç”¨çš„ç´¢å¼•</p>\n</li>\n<li><p>key â€” è¡¨ç¤ºå®é™…ä½¿ç”¨çš„ç´¢å¼•</p>\n</li>\n<li><p>key_len â€” ç´¢å¼•å­—æ®µçš„é•¿åº¦</p>\n</li>\n<li><p>refâ€” åˆ—ä¸ç´¢å¼•çš„æ¯”è¾ƒ</p>\n</li>\n<li><p>rows â€” å¤§æ¦‚ä¼°ç®—çš„è¡Œæ•°</p>\n</li>\n<li><p>filtered â€” æŒ‰è¡¨æ¡ä»¶è¿‡æ»¤çš„è¡Œç™¾åˆ†æ¯”</p>\n</li>\n<li><p>Extra â€” æ‰§è¡Œæƒ…å†µçš„æè¿°å’Œè¯´æ˜</p>\n</li>\n</ul>\n<p>å…¶ä¸­æœ€é‡è¦çš„å°±æ˜¯ type å­—æ®µï¼Œtype å€¼ç±»å‹å¦‚ä¸‹ï¼š</p>\n<ul>\n<li><p>all â€” æ‰«æå…¨è¡¨æ•°æ®</p>\n</li>\n<li><p>index â€” éå†ç´¢å¼•</p>\n</li>\n<li><p>range â€” ç´¢å¼•èŒƒå›´æŸ¥æ‰¾</p>\n</li>\n<li><p>index_subquery â€” åœ¨å­æŸ¥è¯¢ä¸­ä½¿ç”¨ ref</p>\n</li>\n<li><p>uniquesubquery â€” åœ¨å­æŸ¥è¯¢ä¸­ä½¿ç”¨ eq*ref</p>\n</li>\n<li><p>ref<em>or</em>null â€” å¯¹ null è¿›è¡Œç´¢å¼•çš„ä¼˜åŒ–çš„ ref</p>\n</li>\n<li><p>fulltext â€” ä½¿ç”¨å…¨æ–‡ç´¢å¼•</p>\n</li>\n<li><p>ref â€” ä½¿ç”¨éå”¯ä¸€ç´¢å¼•æŸ¥æ‰¾æ•°æ®</p>\n</li>\n<li><p>eq_ref â€” åœ¨ join æŸ¥è¯¢ä¸­ä½¿ç”¨ä¸»é”®æˆ–å”¯ä¸€ç´¢å¼•å…³è”</p>\n</li>\n<li><p>const â€” å°†ä¸€ä¸ªä¸»é”®æ”¾ç½®åˆ° where åé¢ä½œä¸ºæ¡ä»¶æŸ¥è¯¢ï¼Œ MySQL ä¼˜åŒ–å™¨å°±èƒ½æŠŠè¿™æ¬¡æŸ¥è¯¢ä¼˜åŒ–è½¬åŒ–ä¸ºä¸€ä¸ªå¸¸é‡ï¼Œå¦‚ä½•è½¬åŒ–ä»¥åŠä½•æ—¶è½¬åŒ–ï¼Œè¿™ä¸ªå–å†³äºä¼˜åŒ–å™¨ï¼Œè¿™ä¸ªæ¯” eq_ref æ•ˆç‡é«˜ä¸€ç‚¹</p>\n</li>\n</ul>\n<h3 id=\"â­MySQL-çš„ä¼˜åŒ–æ‰‹æ®µéƒ½æœ‰å“ªäº›ï¼Ÿ\"><a href=\"#â­MySQL-çš„ä¼˜åŒ–æ‰‹æ®µéƒ½æœ‰å“ªäº›ï¼Ÿ\" class=\"headerlink\" title=\"â­MySQL çš„ä¼˜åŒ–æ‰‹æ®µéƒ½æœ‰å“ªäº›ï¼Ÿ\"></a>â­MySQL çš„ä¼˜åŒ–æ‰‹æ®µéƒ½æœ‰å“ªäº›ï¼Ÿ</h3><p>MySQL çš„å¸¸è§çš„ä¼˜åŒ–æ‰‹æ®µæœ‰ä»¥ä¸‹äº”ç§ï¼š</p>\n<h4 id=\"â‘ -æŸ¥è¯¢ä¼˜åŒ–\"><a href=\"#â‘ -æŸ¥è¯¢ä¼˜åŒ–\" class=\"headerlink\" title=\"â‘  æŸ¥è¯¢ä¼˜åŒ–\"></a>â‘  æŸ¥è¯¢ä¼˜åŒ–</h4><ul>\n<li><p>é¿å… SELECT *ï¼ŒåªæŸ¥è¯¢éœ€è¦çš„å­—æ®µã€‚</p>\n</li>\n<li><p>å°è¡¨é©±åŠ¨å¤§è¡¨ï¼Œå³å°çš„æ•°æ®é›†é©±åŠ¨å¤§çš„æ•°æ®é›†ï¼Œæ¯”å¦‚ï¼Œå½“ B è¡¨çš„æ•°æ®é›†å°äº A è¡¨æ—¶ï¼Œç”¨ in ä¼˜åŒ– existï¼Œä¸¤è¡¨æ‰§è¡Œé¡ºåºæ˜¯å…ˆæŸ¥ B è¡¨ï¼Œå†æŸ¥ A è¡¨ï¼ŒæŸ¥è¯¢è¯­å¥ï¼šselect * from A where id in (select id from B) ã€‚</p>\n</li>\n<li><p>ä¸€äº›æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨è¿æ¥ä»£æ›¿å­æŸ¥è¯¢ï¼Œå› ä¸ºä½¿ç”¨ join æ—¶ï¼ŒMySQL ä¸ä¼šåœ¨å†…å­˜ä¸­åˆ›å»ºä¸´æ—¶è¡¨ã€‚</p>\n</li>\n</ul>\n<h4 id=\"â‘¡-ä¼˜åŒ–ç´¢å¼•çš„ä½¿ç”¨\"><a href=\"#â‘¡-ä¼˜åŒ–ç´¢å¼•çš„ä½¿ç”¨\" class=\"headerlink\" title=\"â‘¡ ä¼˜åŒ–ç´¢å¼•çš„ä½¿ç”¨\"></a>â‘¡ ä¼˜åŒ–ç´¢å¼•çš„ä½¿ç”¨</h4><ul>\n<li><p>å°½é‡ä½¿ç”¨ä¸»é”®æŸ¥è¯¢ï¼Œè€Œéå…¶ä»–ç´¢å¼•ï¼Œå› ä¸ºä¸»é”®æŸ¥è¯¢ä¸ä¼šè§¦å‘å›è¡¨æŸ¥è¯¢ã€‚</p>\n</li>\n<li><p>ä¸åšåˆ—è¿ç®—ï¼ŒæŠŠè®¡ç®—éƒ½æ”¾å…¥å„ä¸ªä¸šåŠ¡ç³»ç»Ÿå®ç°</p>\n</li>\n<li><p>æŸ¥è¯¢è¯­å¥å°½å¯èƒ½ç®€å•ï¼Œå¤§è¯­å¥æ‹†å°è¯­å¥ï¼Œå‡å°‘é”æ—¶é—´</p>\n</li>\n<li><p>ä¸ä½¿ç”¨ select * æŸ¥è¯¢</p>\n</li>\n<li><p>or æŸ¥è¯¢æ”¹å†™æˆ in æŸ¥è¯¢</p>\n</li>\n<li><p>ä¸ç”¨å‡½æ•°å’Œè§¦å‘å™¨</p>\n</li>\n<li><p>é¿å… %xx æŸ¥è¯¢</p>\n</li>\n<li><p>å°‘ç”¨ join æŸ¥è¯¢</p>\n</li>\n<li><p>ä½¿ç”¨åŒç±»å‹æ¯”è¾ƒï¼Œæ¯”å¦‚ â€˜123â€™ å’Œ â€˜123â€™ã€123 å’Œ 123</p>\n</li>\n<li><p>å°½é‡é¿å…åœ¨ where å­å¥ä¸­ä½¿ç”¨ !&#x3D; æˆ–è€… &lt;&gt; æ“ä½œç¬¦ï¼ŒæŸ¥è¯¢å¼•ç”¨ä¼šæ”¾å¼ƒç´¢å¼•è€Œè¿›è¡Œå…¨è¡¨æ‰«æ</p>\n</li>\n<li><p>é¿å…åœ¨ç´¢å¼•åˆ—ä¸Šä½¿ç”¨ is null å’Œ is not null</p>\n</li>\n<li><p>å°½é‡ä½¿ç”¨ä¸»é”®æŸ¥è¯¢</p>\n</li>\n<li><p>é¿å…åœ¨ where å­å¥ä¸­å¯¹å­—æ®µè¿›è¡Œè¡¨è¾¾å¼æ“ä½œ</p>\n</li>\n<li><p>å°½é‡ä½¿ç”¨æ•°å­—å‹å­—æ®µï¼Œè‹¥åªå«æ•°å€¼ä¿¡æ¯çš„å­—æ®µå°½é‡ä¸è¦è®¾è®¡ä¸ºå­—ç¬¦å‹</p>\n</li>\n</ul>\n<h4 id=\"â‘¢-è¡¨ç»“æ„è®¾è®¡ä¼˜åŒ–\"><a href=\"#â‘¢-è¡¨ç»“æ„è®¾è®¡ä¼˜åŒ–\" class=\"headerlink\" title=\"â‘¢ è¡¨ç»“æ„è®¾è®¡ä¼˜åŒ–\"></a>â‘¢ è¡¨ç»“æ„è®¾è®¡ä¼˜åŒ–</h4><ul>\n<li><p>ä½¿ç”¨å¯ä»¥å­˜ä¸‹æ•°æ®æœ€å°çš„æ•°æ®ç±»å‹ã€‚</p>\n</li>\n<li><p>ä½¿ç”¨ç®€å•çš„æ•°æ®ç±»å‹ï¼Œint è¦æ¯” varchar ç±»å‹åœ¨ MySQL å¤„ç†ç®€å•ã€‚</p>\n</li>\n<li><p>å°½é‡ä½¿ç”¨ tinyintã€smallintã€mediumint ä½œä¸ºæ•´æ•°ç±»å‹è€Œé intã€‚</p>\n</li>\n<li><p>å°½å¯èƒ½ä½¿ç”¨ not null å®šä¹‰å­—æ®µï¼Œå› ä¸º null å ç”¨ 4 å­—èŠ‚ç©ºé—´ã€‚</p>\n</li>\n<li><p>å°½é‡å°‘ç”¨ text ç±»å‹ï¼Œéç”¨ä¸å¯æ—¶æœ€å¥½è€ƒè™‘åˆ†è¡¨ã€‚</p>\n</li>\n<li><p>å°½é‡ä½¿ç”¨ timestampï¼Œè€Œé datetimeã€‚</p>\n</li>\n<li><p>å•è¡¨ä¸è¦æœ‰å¤ªå¤šå­—æ®µï¼Œå»ºè®®åœ¨ 20 ä¸ªå­—æ®µä»¥å†…ã€‚</p>\n</li>\n</ul>\n<h4 id=\"â‘£-è¡¨æ‹†åˆ†\"><a href=\"#â‘£-è¡¨æ‹†åˆ†\" class=\"headerlink\" title=\"â‘£ è¡¨æ‹†åˆ†\"></a>â‘£ è¡¨æ‹†åˆ†</h4><p>å½“æ•°æ®åº“ä¸­çš„æ•°æ®éå¸¸å¤§æ—¶ï¼ŒæŸ¥è¯¢ä¼˜åŒ–æ–¹æ¡ˆä¹Ÿä¸èƒ½è§£å†³æŸ¥è¯¢é€Ÿåº¦æ…¢çš„é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘æ‹†åˆ†è¡¨ï¼Œè®©æ¯å¼ è¡¨çš„æ•°æ®é‡å˜å°ï¼Œä»è€Œæé«˜æŸ¥è¯¢æ•ˆç‡ã€‚ </p>\n<p><strong>aï¼‰å‚ç›´æ‹†åˆ†</strong>ï¼šæ˜¯æŒ‡æ•°æ®è¡¨åˆ—çš„æ‹†åˆ†ï¼ŒæŠŠä¸€å¼ åˆ—æ¯”è¾ƒå¤šçš„è¡¨æ‹†åˆ†ä¸ºå¤šå¼ è¡¨ï¼Œæ¯”å¦‚ï¼Œç”¨æˆ·è¡¨ä¸­ä¸€äº›å­—æ®µç»å¸¸è¢«è®¿é—®ï¼Œå°†è¿™äº›å­—æ®µæ”¾åœ¨ä¸€å¼ è¡¨ä¸­ï¼Œå¦å¤–ä¸€äº›ä¸å¸¸ç”¨çš„å­—æ®µæ”¾åœ¨å¦ä¸€å¼ è¡¨ä¸­ï¼Œæ’å…¥æ•°æ®æ—¶ï¼Œä½¿ç”¨äº‹åŠ¡ç¡®ä¿ä¸¤å¼ è¡¨çš„æ•°æ®ä¸€è‡´æ€§ã€‚ å‚ç›´æ‹†åˆ†çš„åŸåˆ™ï¼š</p>\n<ul>\n<li><p>æŠŠä¸å¸¸ç”¨çš„å­—æ®µå•ç‹¬æ”¾åœ¨ä¸€å¼ è¡¨ï¼›</p>\n</li>\n<li><p>æŠŠ textï¼Œblob ç­‰å¤§å­—æ®µæ‹†åˆ†å‡ºæ¥æ”¾åœ¨é™„è¡¨ä¸­ï¼›</p>\n</li>\n<li><p>ç»å¸¸ç»„åˆæŸ¥è¯¢çš„åˆ—æ”¾åœ¨ä¸€å¼ è¡¨ä¸­ã€‚</p>\n</li>\n</ul>\n<p><strong>bï¼‰æ°´å¹³æ‹†åˆ†</strong>ï¼šæŒ‡æ•°æ®è¡¨è¡Œçš„æ‹†åˆ†ï¼Œè¡¨çš„è¡Œæ•°è¶…è¿‡ 200 ä¸‡è¡Œæ—¶ï¼Œå°±ä¼šå˜æ…¢ï¼Œè¿™æ—¶å¯ä»¥æŠŠä¸€å¼ çš„è¡¨çš„æ•°æ®æ‹†æˆå¤šå¼ è¡¨æ¥å­˜æ”¾ã€‚</p>\n<p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨å–æ¨¡çš„æ–¹å¼æ¥è¿›è¡Œè¡¨çš„æ‹†åˆ†ï¼Œæ¯”å¦‚ï¼Œä¸€å¼ æœ‰ 400W çš„ç”¨æˆ·è¡¨ usersï¼Œä¸ºæé«˜å…¶æŸ¥è¯¢æ•ˆç‡æˆ‘ä»¬æŠŠå…¶åˆ†æˆ 4 å¼ è¡¨ users1ï¼Œusers2ï¼Œusers3ï¼Œusers4ï¼Œç„¶åé€šè¿‡ç”¨æˆ· ID å–æ¨¡çš„æ–¹æ³•ï¼ŒåŒæ—¶æŸ¥è¯¢ã€æ›´æ–°ã€åˆ é™¤ä¹Ÿæ˜¯é€šè¿‡å–æ¨¡çš„æ–¹æ³•æ¥æ“ä½œã€‚</p>\n<h4 id=\"â‘¤-è¯»å†™åˆ†ç¦»\"><a href=\"#â‘¤-è¯»å†™åˆ†ç¦»\" class=\"headerlink\" title=\"â‘¤ è¯»å†™åˆ†ç¦»\"></a>â‘¤ è¯»å†™åˆ†ç¦»</h4><p>ä¸€èˆ¬æƒ…å†µä¸‹å¯¹æ•°æ®åº“è€Œè¨€éƒ½æ˜¯â€œè¯»å¤šå†™å°‘â€ï¼Œæ¢è¨€ä¹‹ï¼Œæ•°æ®åº“çš„å‹åŠ›å¤šæ•°æ˜¯å› ä¸ºå¤§é‡çš„è¯»å–æ•°æ®çš„æ“ä½œé€ æˆçš„ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨æ•°æ®åº“é›†ç¾¤çš„æ–¹æ¡ˆï¼Œä½¿ç”¨ä¸€ä¸ªåº“ä½œä¸ºä¸»åº“ï¼Œè´Ÿè´£å†™å…¥æ•°æ®ï¼›å…¶ä»–åº“ä¸ºä»åº“ï¼Œè´Ÿè´£è¯»å–æ•°æ®ã€‚è¿™æ ·å¯ä»¥ç¼“è§£å¯¹æ•°æ®åº“çš„è®¿é—®å‹åŠ›ã€‚</p>\n<h3 id=\"MySQL-å¸¸è§è¯»å†™åˆ†ç¦»æ–¹æ¡ˆæœ‰å“ªäº›ï¼Ÿ\"><a href=\"#MySQL-å¸¸è§è¯»å†™åˆ†ç¦»æ–¹æ¡ˆæœ‰å“ªäº›ï¼Ÿ\" class=\"headerlink\" title=\"MySQL å¸¸è§è¯»å†™åˆ†ç¦»æ–¹æ¡ˆæœ‰å“ªäº›ï¼Ÿ\"></a>MySQL å¸¸è§è¯»å†™åˆ†ç¦»æ–¹æ¡ˆæœ‰å“ªäº›ï¼Ÿ</h3><p>MySQL å¸¸è§çš„è¯»å†™åˆ†ç¦»æ–¹æ¡ˆï¼Œå¦‚ä¸‹åˆ—è¡¨ï¼š</p>\n<p><strong>1ï¼‰åº”ç”¨å±‚è§£å†³æ–¹æ¡ˆ</strong> å¯ä»¥é€šè¿‡åº”ç”¨å±‚å¯¹æ•°æ®æºåšè·¯ç”±æ¥å®ç°è¯»å†™åˆ†ç¦»ï¼Œæ¯”å¦‚ï¼Œä½¿ç”¨ SpringMVC + MyBatisï¼Œå¯ä»¥å°† SQL è·¯ç”±äº¤ç»™ Springï¼Œé€šè¿‡ AOP æˆ–è€… Annotation ç”±ä»£ç æ˜¾ç¤ºçš„æ§åˆ¶æ•°æ®æºã€‚ ä¼˜ç‚¹ï¼šè·¯ç”±ç­–ç•¥çš„æ‰©å±•æ€§å’Œå¯æ§æ€§è¾ƒå¼ºã€‚ ç¼ºç‚¹ï¼šéœ€è¦åœ¨ Spring ä¸­æ·»åŠ è€¦åˆæ§åˆ¶ä»£ç ã€‚</p>\n<p><strong>2ï¼‰ä¸­é—´ä»¶è§£å†³æ–¹æ¡ˆ</strong> é€šè¿‡ MySQL çš„ä¸­é—´ä»¶åšä¸»ä»é›†ç¾¤ï¼Œæ¯”å¦‚ï¼šMysql Proxyã€Amoebaã€Atlas ç­‰ä¸­é—´ä»¶éƒ½èƒ½ç¬¦åˆéœ€æ±‚ã€‚ ä¼˜ç‚¹ï¼šä¸åº”ç”¨å±‚è§£è€¦ã€‚ ç¼ºç‚¹ï¼šå¢åŠ ä¸€ä¸ªæœåŠ¡ç»´æŠ¤çš„é£é™©ç‚¹ï¼Œæ€§èƒ½åŠç¨³å®šæ€§å¾…æµ‹è¯•ï¼Œéœ€è¦æ”¯æŒä»£ç å¼ºåˆ¶ä¸»ä»å’Œäº‹åŠ¡ã€‚</p>\n<h3 id=\"æ€æ ·ä¿è¯ç¡®ä¿å¤‡åº“æ— å»¶è¿Ÿï¼Ÿ\"><a href=\"#æ€æ ·ä¿è¯ç¡®ä¿å¤‡åº“æ— å»¶è¿Ÿï¼Ÿ\" class=\"headerlink\" title=\"æ€æ ·ä¿è¯ç¡®ä¿å¤‡åº“æ— å»¶è¿Ÿï¼Ÿ\"></a>æ€æ ·ä¿è¯ç¡®ä¿å¤‡åº“æ— å»¶è¿Ÿï¼Ÿ</h3><p>é€šå¸¸ä¿è¯ä¸»å¤‡æ— å»¶è¿Ÿæœ‰ä»¥ä¸‹ä¸‰ç§æ–¹æ³•ï¼š</p>\n<ul>\n<li><p>æ¯æ¬¡ä»åº“æ‰§è¡ŒæŸ¥è¯¢è¯·æ±‚å‰ï¼Œå…ˆåˆ¤æ–­ seconds<em>behind</em>master æ˜¯å¦å·²ç»ç­‰äº 0ã€‚å¦‚æœè¿˜ä¸ç­‰äº 0 ï¼Œé‚£å°±å¿…é¡»ç­‰åˆ°è¿™ä¸ªå‚æ•°å˜ä¸º 0 æ‰èƒ½æ‰§è¡ŒæŸ¥è¯¢è¯·æ±‚ï¼Œseconds<em>behind</em>master å‚æ•°æ˜¯ç”¨æ¥è¡¡é‡ä¸»å¤‡å»¶è¿Ÿæ—¶é—´çš„é•¿çŸ­ï¼›</p>\n</li>\n<li><p>å¯¹æ¯”ä½ç‚¹ç¡®ä¿ä¸»å¤‡æ— å»¶è¿Ÿã€‚Master<em>Log</em>File å’Œ Read<em>Master</em>Log<em>Posï¼Œè¡¨ç¤ºçš„æ˜¯è¯»åˆ°çš„ä¸»åº“çš„æœ€æ–°ä½ç‚¹ï¼ŒRelay</em>Master<em>Log</em>File å’Œ Exec<em>Master</em>Log_Posï¼Œè¡¨ç¤ºçš„æ˜¯å¤‡åº“æ‰§è¡Œçš„æœ€æ–°ä½ç‚¹ï¼›</p>\n</li>\n<li><p>å¯¹æ¯” GTID é›†åˆç¡®ä¿ä¸»å¤‡æ— å»¶è¿Ÿã€‚Auto<em>Position&#x3D;1 ï¼Œè¡¨ç¤ºè¿™å¯¹ä¸»å¤‡å…³ç³»ä½¿ç”¨äº† GTID åè®®ï¼›Retrieved</em>Gtid<em>Setï¼Œæ˜¯å¤‡åº“æ”¶åˆ°çš„æ‰€æœ‰æ—¥å¿—çš„ GTID é›†åˆï¼›Executed</em>Gtid_Setï¼Œæ˜¯å¤‡åº“æ‰€æœ‰å·²ç»æ‰§è¡Œå®Œæˆçš„ GTID é›†åˆã€‚</p>\n</li>\n</ul>\n<h2 id=\"MySQLå¼€æ”¾é—®é¢˜\"><a href=\"#MySQLå¼€æ”¾é—®é¢˜\" class=\"headerlink\" title=\"MySQLå¼€æ”¾é—®é¢˜\"></a>MySQLå¼€æ”¾é—®é¢˜</h2><h3 id=\"æœ‰ä¸€ä¸ªè¶…çº§å¤§è¡¨ï¼Œå¦‚ä½•ä¼˜åŒ–åˆ†é¡µæŸ¥è¯¢ï¼Ÿ\"><a href=\"#æœ‰ä¸€ä¸ªè¶…çº§å¤§è¡¨ï¼Œå¦‚ä½•ä¼˜åŒ–åˆ†é¡µæŸ¥è¯¢ï¼Ÿ\" class=\"headerlink\" title=\"æœ‰ä¸€ä¸ªè¶…çº§å¤§è¡¨ï¼Œå¦‚ä½•ä¼˜åŒ–åˆ†é¡µæŸ¥è¯¢ï¼Ÿ\"></a>æœ‰ä¸€ä¸ªè¶…çº§å¤§è¡¨ï¼Œå¦‚ä½•ä¼˜åŒ–åˆ†é¡µæŸ¥è¯¢ï¼Ÿ</h3><p>è¶…çº§å¤§è¡¨çš„åˆ†é¡µä¼˜åŒ–åˆ†æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹å¼ï¼š</p>\n<ul>\n<li><p>æ•°æ®åº“å±‚é¢ä¼˜åŒ–ï¼šåˆ©ç”¨å­æŸ¥è¯¢ä¼˜åŒ–è¶…å¤šåˆ†é¡µåœºæ™¯ï¼Œæ¯”å¦‚ï¼š<code>SELECT a.* FROM è¡¨ 1 a, (select id from è¡¨ 1 where æ¡ä»¶ LIMIT 100000,20 ) b where a.id=b.id</code> ï¼Œå…ˆå¿«é€Ÿå®šä½éœ€è¦è·å–çš„ id æ®µï¼Œç„¶åå†å…³è”æŸ¥è¯¢ã€‚MySQL å¹¶ä¸æ˜¯è·³è¿‡ offset è¡Œï¼Œè€Œæ˜¯å– offset+N è¡Œï¼Œç„¶åè¿”å›æ”¾å¼ƒå‰ offset è¡Œï¼Œè¿”å› N è¡Œï¼Œé‚£å½“ offset ç‰¹åˆ«å¤§çš„æ—¶å€™ï¼Œæ•ˆç‡å°±éå¸¸çš„ä½ä¸‹ï¼Œè¦ä¹ˆæ§åˆ¶è¿”å›çš„æ€»é¡µæ•°ï¼Œè¦ä¹ˆå¯¹è¶…è¿‡ç‰¹å®šé˜ˆå€¼çš„é¡µæ•°è¿›è¡Œ SQL æ”¹å†™ï¼Œ<br><strong>åˆ©ç”¨å­æŸ¥è¯¢å…ˆå¿«é€Ÿå®šä½éœ€è¦è·å–çš„ id æ®µï¼Œç„¶åå†å…³è”æŸ¥è¯¢ï¼Œå°±æ˜¯å¯¹åˆ†é¡µè¿›è¡Œ SQL æ”¹å†™çš„å…·ä½“å®ç°</strong>ï¼›</p>\n</li>\n<li><p>ç¨‹åºå±‚é¢ä¼˜åŒ–ï¼šå¯ä»¥åˆ©ç”¨<strong>ç¼“å­˜</strong>æŠŠæŸ¥è¯¢çš„ç»“æœç¼“å­˜èµ·æ¥ï¼Œè¿™æ ·å†ä¸‹ä¸€æ¬¡æŸ¥è¯¢çš„æ—¶å€™æ€§èƒ½å°±éå¸¸é«˜äº†ã€‚</p>\n</li>\n</ul>\n<h3 id=\"â­æŸ¥è¯¢é•¿æ—¶é—´ä¸è¿”å›å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿåº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ\"><a href=\"#â­æŸ¥è¯¢é•¿æ—¶é—´ä¸è¿”å›å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿåº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ\" class=\"headerlink\" title=\"â­æŸ¥è¯¢é•¿æ—¶é—´ä¸è¿”å›å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿåº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ\"></a>â­æŸ¥è¯¢é•¿æ—¶é—´ä¸è¿”å›å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿåº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ</h3><p>æŸ¥è¯¢é€Ÿåº¦æ…¢çš„åŸå› å¾ˆå¤šï¼Œå¸¸è§å¦‚ä¸‹å‡ ç§ï¼š</p>\n<p> 1ï¼‰æŸ¥è¯¢å­—æ®µæ²¡æœ‰ç´¢å¼•æˆ–è€…æ²¡æœ‰è§¦å‘ç´¢å¼•æŸ¥è¯¢ï¼Œæ²¡æœ‰è§¦å‘ç´¢å¼•æŸ¥è¯¢çš„æƒ…å†µå¦‚ä¸‹ï¼š </p>\n<ul>\n<li><p>ä»¥ % å¼€å¤´çš„ like æŸ¥è¯¢</p>\n</li>\n<li><p>æ•°æ®ç±»å‹å‡ºç°éšå¼è½¬æ¢æ—¶ä¸ä¼šä½¿ç”¨ç´¢å¼•</p>\n</li>\n<li><p>ä¸ç¬¦åˆæœ€å·¦å‰ç¼€åŸåˆ™ï¼›</p>\n</li>\n<li><p>å¦‚æœæŸ¥è¯¢æ¡ä»¶æœ‰ or åˆ†å‰²ï¼Œå¦‚æœæœ‰ or çš„å­—æ®µæ²¡æœ‰ç´¢å¼•ï¼Œä¼šå¼•èµ·å…¨è¡¨æŸ¥è¯¢ï¼›</p>\n</li>\n<li><p>å¦‚æœ MySQL è®¤ä¸ºä½¿ç”¨ç´¢å¼•ä¼šæ¯”å…¨è¡¨æŸ¥è¯¢æ›´æ…¢ï¼Œåˆ™ä¸ä¼šä½¿ç”¨ç´¢å¼•ã€‚</p>\n</li>\n</ul>\n<p>2ï¼‰I&#x2F;O å‹åŠ›å¤§ï¼Œè¯»å–ç£ç›˜é€Ÿåº¦å˜æ…¢ï¼Œdf çœ‹ç¡¬ç›˜</p>\n<p>3ï¼‰å†…å­˜ä¸è¶³ï¼Œfree çœ‹å†…å­˜ï¼ˆtop çœ‹ cpuï¼‰</p>\n<p>4ï¼‰ç½‘ç»œé€Ÿåº¦æ…¢ </p>\n<p>5ï¼‰æŸ¥è¯¢å‡ºçš„æ•°æ®é‡è¿‡å¤§ï¼Œå¯ä»¥é‡‡ç”¨å¤šæ¬¡æŸ¥è¯¢æˆ–å…¶ä»–çš„æ–¹æ³•é™ä½æ•°æ®é‡ </p>\n<p>6ï¼‰æ­»é”ï¼Œä¸€èˆ¬ç¢°åˆ°è¿™ç§æƒ…å†µçš„è¯ï¼Œå¤§æ¦‚ç‡æ˜¯è¡¨è¢«é”ä½äº†ï¼Œå¯ä»¥ä½¿ç”¨ <code>show processlist;</code> å‘½ä»¤ï¼Œçœ‹çœ‹ SQL è¯­å¥çš„çŠ¶æ€ï¼Œå†é’ˆå¯¹ä¸åŒçš„çŠ¶æ€åšç›¸åº”çš„å¤„ç†ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes11474088-1a918d44eacc26e6.png\" alt=\"avatar\"> </p>\n<p>å…¶ä¸­ï¼Œå½“ State åˆ—å€¼ä¸º Locked æ—¶ï¼Œè¡¨ç¤ºè¢«é”å®šã€‚</p>\n<p>ä»¥ä¸Šé—®é¢˜çš„è§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š</p>\n<p>1ï¼‰æ­£ç¡®åˆ›å»ºå’Œä½¿ç”¨ç´¢å¼•ã€‚ </p>\n<p>2ï¼‰æŠŠæ•°æ®ã€æ—¥å¿—ã€ç´¢å¼•æ”¾åˆ°ä¸åŒçš„ IO è®¾å¤‡ä¸Šï¼Œå‡å°‘ä¸»æ•°æ®åº“çš„ IO æ“ä½œã€‚æ›´æ¢ MySQL çš„ç£ç›˜ä¸ºå›ºæ€ç¡¬ç›˜ï¼Œä»¥æé«˜ç£ç›˜çš„ IO æ€§èƒ½ã€‚ </p>\n<p>3ï¼‰å‡çº§å†…å­˜ï¼Œæ›´æ¢æ›´å¤§çš„å†…å­˜ã€‚ </p>\n<p>4ï¼‰æå‡ç½‘é€Ÿï¼Œå‡çº§å¸¦å®½ã€‚ </p>\n<p>5ï¼‰ç”¨ Profiler æ¥è·Ÿè¸ªæŸ¥è¯¢ï¼Œå¾—åˆ°æŸ¥è¯¢æ‰€éœ€çš„æ—¶é—´ï¼Œæ‰¾å‡ºæœ‰é—®é¢˜çš„ SQL è¯­å¥ï¼Œä¼˜åŒ– SQLã€‚ </p>\n<p>6ï¼‰æŸ¥è¯¢æ—¶å€¼è¿”å›éœ€è¦çš„å­—æ®µã€‚ </p>\n<p>7ï¼‰è®¾ç½®æ­»é”çš„è¶…æ—¶æ—¶é—´ï¼Œé™åˆ¶å’Œé¿å…æ­»é”æ¶ˆè€—è¿‡å¤šæœåŠ¡å™¨çš„èµ„æºã€‚ 8ï¼‰å°½é‡å°‘ç”¨è§†å›¾ï¼Œå®ƒçš„æ•ˆç‡ä½ï¼Œå¯¹è§†å›¾æ“ä½œæ¯”ç›´æ¥å¯¹è¡¨æ“ä½œæ…¢,å¯ä»¥ç”¨å­˜å‚¨è¿‡ç¨‹æ¥ä»£æ›¿è§†å›¾ã€‚ä¸è¦ç”¨è§†å›¾åµŒå¥—ï¼ŒåµŒå¥—è§†å›¾å¢åŠ äº†å¯»æ‰¾åŸå§‹æ•°æ®çš„éš¾åº¦ã€‚</p>\n<h3 id=\"MySQL-ä¸»ä»å»¶è¿Ÿçš„åŸå› æœ‰å“ªäº›ï¼Ÿ\"><a href=\"#MySQL-ä¸»ä»å»¶è¿Ÿçš„åŸå› æœ‰å“ªäº›ï¼Ÿ\" class=\"headerlink\" title=\"MySQL ä¸»ä»å»¶è¿Ÿçš„åŸå› æœ‰å“ªäº›ï¼Ÿ\"></a>MySQL ä¸»ä»å»¶è¿Ÿçš„åŸå› æœ‰å“ªäº›ï¼Ÿ</h3><p>ä¸»ä»å»¶è¿Ÿå¯ä»¥æ ¹æ® MySQL æä¾›çš„å‘½ä»¤åˆ¤æ–­ï¼Œæ¯”å¦‚ï¼Œåœ¨ä»æœåŠ¡å™¨ä½¿ç”¨å‘½ä»¤ï¼š <code>show slave status;</code>ï¼Œå…¶ä¸­ Seconds<em>Behind</em>Master å¦‚æœä¸º 0 è¡¨ç¤ºä¸»ä»å¤åˆ¶çŠ¶æ€æ­£å¸¸ã€‚ å¯¼è‡´ä¸»ä»å»¶è¿Ÿçš„åŸå› æœ‰ä»¥ä¸‹å‡ ä¸ªï¼š</p>\n<ul>\n<li><p>ä¸»åº“æœ‰å¤§äº‹åŠ¡å¤„ç†ï¼›</p>\n</li>\n<li><p>ä¸»åº“åšå¤§é‡çš„å¢ã€åˆ ã€æ”¹æ“ä½œï¼›</p>\n</li>\n<li><p>ä¸»åº“å¯¹å¤§è¡¨è¿›è¡Œå­—æ®µæ–°å¢ã€ä¿®æ”¹æˆ–æ·»åŠ ç´¢å¼•ç­‰æ“ä½œï¼›</p>\n</li>\n<li><p>ä¸»åº“çš„ä»åº“å¤ªå¤šï¼Œå¯¼è‡´å¤åˆ¶å»¶è¿Ÿã€‚ä»åº“æ•°é‡ä¸€èˆ¬ 3-5 ä¸ªä¸ºå®œï¼Œè¦å¤åˆ¶çš„èŠ‚ç‚¹è¿‡å¤šï¼Œå¯¼è‡´å¤åˆ¶å»¶è¿Ÿï¼›</p>\n</li>\n<li><p>ä»åº“ç¡¬ä»¶é…ç½®æ¯”ä¸»åº“å·®ï¼Œå¯¼è‡´å»¶è¿Ÿã€‚æŸ¥çœ‹ Master å’Œ Slave çš„é…ç½®ï¼Œå¯èƒ½å› ä¸ºä»åº“çš„é…ç½®è¿‡ä½ï¼Œæ‰§è¡Œæ—¶é—´é•¿ï¼Œç”±æ­¤å¯¼è‡´çš„å¤åˆ¶å»¶è¿Ÿæ—¶é—´é•¿ï¼›</p>\n</li>\n<li><p>ä¸»åº“è¯»å†™å‹åŠ›å¤§ï¼Œå¯¼è‡´å¤åˆ¶å»¶è¿Ÿï¼›</p>\n</li>\n<li><p>ä»åº“ä¹‹é—´çš„ç½‘ç»œå»¶è¿Ÿã€‚ä¸»ä»åº“ç½‘å¡ã€ç½‘çº¿ã€è¿æ¥çš„äº¤æ¢æœºç­‰ç½‘ç»œè®¾å¤‡éƒ½å¯èƒ½æˆä¸ºå¤åˆ¶çš„ç“¶é¢ˆï¼Œå¯¼è‡´å¤åˆ¶å»¶è¿Ÿï¼Œå¦å¤–è·¨å…¬ç½‘ä¸»ä»å¤åˆ¶å¾ˆå®¹æ˜“å¯¼è‡´ä¸»ä»å¤åˆ¶å»¶è¿Ÿã€‚</p>\n</li>\n</ul>\n<h3 id=\"å¦‚ä½•ä¿è¯æ•°æ®ä¸è¢«è¯¯åˆ ï¼Ÿ\"><a href=\"#å¦‚ä½•ä¿è¯æ•°æ®ä¸è¢«è¯¯åˆ ï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•ä¿è¯æ•°æ®ä¸è¢«è¯¯åˆ ï¼Ÿ\"></a>å¦‚ä½•ä¿è¯æ•°æ®ä¸è¢«è¯¯åˆ ï¼Ÿ</h3><p>ä¿è¯æ•°æ®ä¸è¢«è¯¯åˆ çš„æ–¹æ³•å¦‚ä¸‹åˆ—è¡¨ï¼š</p>\n<ul>\n<li><p>æƒé™æ§åˆ¶ä¸åˆ†é…ï¼ˆæ•°æ®åº“å’ŒæœåŠ¡å™¨æƒé™ï¼‰</p>\n</li>\n<li><p>é¿å…æ•°æ®åº“è´¦å·ä¿¡æ¯æ³„éœ²ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä¸šåŠ¡ä»£ç ä¸è¦ä½¿ç”¨æ˜æ–‡ä¿å­˜æ•°æ®åº“è¿æ¥ä¿¡æ¯ï¼›</p>\n</li>\n<li><p>é‡è¦çš„æ•°æ®åº“æ“ä½œï¼Œé€šè¿‡å¹³å°å‹å·¥å…·è‡ªåŠ¨å®æ–½ï¼Œå‡å°‘äººå·¥æ“ä½œï¼›</p>\n</li>\n<li><p>éƒ¨ç½²å»¶è¿Ÿå¤åˆ¶ä»åº“ï¼Œä¸‡ä¸€è¯¯åˆ é™¤æ—¶ç”¨äºæ•°æ®å›æ¡£ï¼Œä¸”ä»åº“è®¾ç½®ä¸º read-onlyï¼›</p>\n</li>\n<li><p>ç¡®è®¤å¤‡ä»½åˆ¶åº¦åŠæ—¶æœ‰æ•ˆï¼›</p>\n</li>\n<li><p>å¯ç”¨ SQL å®¡è®¡åŠŸèƒ½ï¼Œå…»æˆè‰¯å¥½ SQL ä¹ æƒ¯ï¼›</p>\n</li>\n<li><p>å¯ç”¨ sql<em>safe</em>updates é€‰é¡¹ï¼Œä¸å…è®¸æ²¡ where æ¡ä»¶çš„æ›´æ–°&#x2F;åˆ é™¤ï¼›</p>\n</li>\n<li><p>å°†ç³»ç»Ÿå±‚çš„ rm æ”¹ä¸º mvï¼›</p>\n</li>\n<li><p>çº¿ä¸Šä¸è¿›è¡Œç‰©ç†åˆ é™¤ï¼Œæ”¹ä¸ºé€»è¾‘åˆ é™¤ï¼ˆå°† row data æ ‡è®°ä¸ºä¸å¯ç”¨ï¼‰ï¼›</p>\n</li>\n<li><p>å¯ç”¨å ¡å’æœºï¼Œå±è”½é«˜å± SQLï¼›</p>\n</li>\n<li><p>é™ä½æ•°æ®åº“ä¸­æ™®é€šè´¦å·çš„æƒé™çº§åˆ«ï¼›</p>\n</li>\n<li><p>å¼€å¯ binlogï¼Œæ–¹ä¾¿è¿½æº¯æ•°æ®ã€‚</p>\n</li>\n</ul>\n<h3 id=\"â­MySQL-æœåŠ¡å™¨-CPU-é£™å‡åº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ\"><a href=\"#â­MySQL-æœåŠ¡å™¨-CPU-é£™å‡åº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ\" class=\"headerlink\" title=\"â­MySQL æœåŠ¡å™¨ CPU é£™å‡åº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ\"></a>â­MySQL æœåŠ¡å™¨ CPU é£™å‡åº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ</h3><p>ä½¿ç”¨ <code>show full processlist;</code> æŸ¥å‡ºæ…¢æŸ¥è¯¢ï¼Œä¸ºäº†ç¼“è§£æ•°æ®åº“æœåŠ¡å™¨å‹åŠ›ï¼Œå…ˆä½¿ç”¨ kill å‘½ä»¤æ€æ‰æ…¢æŸ¥è¯¢çš„å®¢æˆ·ç«¯ï¼Œç„¶åå†å»é¡¹ç›®ä¸­æ‰¾åˆ°æ‰§è¡Œæ…¢çš„ SQL è¯­å¥è¿›è¡Œä¿®æ”¹å’Œä¼˜åŒ–ã€‚</p>\n<h3 id=\"MySQL-æ¯«æ— è§„å¾‹çš„å¼‚å¸¸é‡å¯ï¼Œå¯èƒ½äº§ç”Ÿçš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿè¯¥å¦‚ä½•è§£å†³ï¼Ÿ\"><a href=\"#MySQL-æ¯«æ— è§„å¾‹çš„å¼‚å¸¸é‡å¯ï¼Œå¯èƒ½äº§ç”Ÿçš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿè¯¥å¦‚ä½•è§£å†³ï¼Ÿ\" class=\"headerlink\" title=\"MySQL æ¯«æ— è§„å¾‹çš„å¼‚å¸¸é‡å¯ï¼Œå¯èƒ½äº§ç”Ÿçš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿè¯¥å¦‚ä½•è§£å†³ï¼Ÿ\"></a>MySQL æ¯«æ— è§„å¾‹çš„å¼‚å¸¸é‡å¯ï¼Œå¯èƒ½äº§ç”Ÿçš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿè¯¥å¦‚ä½•è§£å†³ï¼Ÿ</h3><p>å¯èƒ½æ˜¯ç§¯ç´¯çš„é•¿è¿æ¥å¯¼è‡´å†…å­˜å ç”¨å¤ªå¤šï¼Œè¢«ç³»ç»Ÿå¼ºè¡Œæ€æ‰å¯¼è‡´çš„å¼‚å¸¸é‡å¯ï¼Œå› ä¸ºåœ¨ MySQL ä¸­é•¿è¿æ¥åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä½¿ç”¨çš„ä¸´æ—¶å†…å­˜å¯¹è±¡ï¼Œåªæœ‰åœ¨è¿æ¥æ–­å¼€çš„æ—¶å€™æ‰ä¼šé‡Šæ”¾ï¼Œè¿™å°±ä¼šå¯¼è‡´å†…å­˜ä¸æ–­é£™å‡ï¼Œè§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š</p>\n<ul>\n<li><p>å®šæœŸæ–­å¼€ç©ºé—²çš„é•¿è¿æ¥ï¼›</p>\n</li>\n<li><p>å¦‚æœæ˜¯ç”¨çš„æ˜¯ MySQL 5.7 ä»¥ä¸Šçš„ç‰ˆæœ¬ï¼Œå¯ä»¥å®šæœŸæ‰§è¡Œ mysql<em>reset</em>connection é‡æ–°åˆå§‹åŒ–è¿æ¥èµ„æºï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šé‡Šæ”¾ä¹‹å‰ä½¿ç”¨çš„å†…å­˜èµ„æºï¼Œæ¢å¤åˆ°è¿æ¥åˆšåˆå§‹åŒ–çš„çŠ¶æ€ã€‚</p>\n</li>\n</ul>\n<h3 id=\"å¦‚ä½•å®ç°ä¸€ä¸ªé«˜å¹¶å‘çš„ç³»ç»Ÿï¼Ÿ\"><a href=\"#å¦‚ä½•å®ç°ä¸€ä¸ªé«˜å¹¶å‘çš„ç³»ç»Ÿï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•å®ç°ä¸€ä¸ªé«˜å¹¶å‘çš„ç³»ç»Ÿï¼Ÿ\"></a>å¦‚ä½•å®ç°ä¸€ä¸ªé«˜å¹¶å‘çš„ç³»ç»Ÿï¼Ÿ</h3><p>è¿™é“é¢è¯•é¢˜æ¶‰åŠçš„çŸ¥è¯†ç‚¹æ¯”è¾ƒå¤šï¼Œä¸»è¦è€ƒå¯Ÿçš„æ˜¯é¢è¯•è€…çš„ç»¼åˆæŠ€æœ¯èƒ½åŠ›ã€‚é«˜å¹¶å‘ç³»ç»Ÿçš„è®¾è®¡æ‰‹æ®µæœ‰å¾ˆå¤šï¼Œä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹äº”ä¸ªæ–¹é¢ã€‚</p>\n<h4 id=\"1ï¼‰å‰ç«¯ä¼˜åŒ–\"><a href=\"#1ï¼‰å‰ç«¯ä¼˜åŒ–\" class=\"headerlink\" title=\"1ï¼‰å‰ç«¯ä¼˜åŒ–\"></a>1ï¼‰å‰ç«¯ä¼˜åŒ–</h4><p>â‘  é™æ€èµ„æºç¼“å­˜ï¼šå°†æ´»åŠ¨é¡µé¢ä¸Šçš„æ‰€æœ‰å¯ä»¥é™æ€çš„å…ƒç´ å…¨éƒ¨é™æ€åŒ–ï¼Œå°½é‡å‡å°‘åŠ¨æ€å…ƒç´ ï¼›é€šè¿‡ CDNã€æµè§ˆå™¨ç¼“å­˜ï¼Œæ¥å‡å°‘å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯çš„æ•°æ®è¯·æ±‚ã€‚<br>â‘¡ ç¦æ­¢é‡å¤æäº¤ï¼šç”¨æˆ·æäº¤ä¹‹åæŒ‰é’®ç½®ç°ï¼Œç¦æ­¢é‡å¤æäº¤ã€‚<br>â‘¢ ç”¨æˆ·é™æµï¼šåœ¨æŸä¸€æ—¶é—´æ®µå†…åªå…è®¸ç”¨æˆ·æäº¤ä¸€æ¬¡è¯·æ±‚ï¼Œæ¯”å¦‚ï¼Œé‡‡å– IP é™æµã€‚</p>\n<h4 id=\"2ï¼‰ä¸­é—´å±‚è´Ÿè½½åˆ†å‘\"><a href=\"#2ï¼‰ä¸­é—´å±‚è´Ÿè½½åˆ†å‘\" class=\"headerlink\" title=\"2ï¼‰ä¸­é—´å±‚è´Ÿè½½åˆ†å‘\"></a>2ï¼‰ä¸­é—´å±‚è´Ÿè½½åˆ†å‘</h4><p>å¯åˆ©ç”¨è´Ÿè½½å‡è¡¡ï¼Œæ¯”å¦‚ nginx ç­‰å·¥å…·ï¼Œå¯ä»¥å°†å¹¶å‘è¯·æ±‚åˆ†é…åˆ°ä¸åŒçš„æœåŠ¡å™¨ï¼Œä»è€Œæé«˜äº†ç³»ç»Ÿå¤„ç†å¹¶å‘çš„èƒ½åŠ›ã€‚ nginx è´Ÿè½½åˆ†å‘çš„äº”ç§æ–¹å¼ï¼š</p>\n<p>â‘  è½®è¯¢ï¼ˆé»˜è®¤ï¼‰ æ¯ä¸ªè¯·æ±‚æŒ‰æ—¶é—´é¡ºåºé€ä¸€åˆ†é…åˆ°ä¸åŒçš„åç«¯æœåŠ¡å™¨ï¼Œå¦‚æœåç«¯æœåŠ¡å™¨ä¸èƒ½æ­£å¸¸å“åº”ï¼Œnginx èƒ½è‡ªåŠ¨å‰”é™¤æ•…éšœæœåŠ¡å™¨ã€‚ â‘¡ æŒ‰æƒé‡ï¼ˆweightï¼‰ ä½¿ç”¨ weight å‚æ•°ï¼ŒæŒ‡å®šè½®è¯¢å‡ ç‡ï¼Œweight å’Œè®¿é—®æ¯”ç‡æˆæ­£æ¯”ï¼Œç”¨äºåç«¯æœåŠ¡å™¨æ€§èƒ½ä¸å‡çš„æƒ…å†µï¼Œé…ç½®å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">upstream backend &#123; </span><br><span class=\"line\">    server 192.168.0.14 weight=10; </span><br><span class=\"line\">    server 192.168.0.15 weight=10; </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>â‘¢ IP å“ˆå¸Œå€¼ï¼ˆip_hashï¼‰ æ¯ä¸ªè¯·æ±‚æŒ‰è®¿é—® IP çš„å“ˆå¸Œå€¼åˆ†é…ï¼Œè¿™æ ·æ¯ä¸ªè®¿å®¢å›ºå®šè®¿é—®ä¸€ä¸ªåç«¯æœåŠ¡å™¨ï¼Œå¯ä»¥è§£å†³ session å…±äº«çš„é—®é¢˜ï¼Œé…ç½®å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">upstream backend &#123; </span><br><span class=\"line\">    ip_hash; </span><br><span class=\"line\">    server 192.168.0.14:88; </span><br><span class=\"line\">    server 192.168.0.15:80; </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>â‘£ å“åº”æ—¶é—´ï¼ˆfairï¼‰ æŒ‰åç«¯æœåŠ¡å™¨çš„å“åº”æ—¶é—´æ¥åˆ†é…è¯·æ±‚ï¼Œå“åº”æ—¶é—´çŸ­çš„ä¼˜å…ˆåˆ†é…ï¼Œé…ç½®å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">upstream backend &#123; </span><br><span class=\"line\">    fair; </span><br><span class=\"line\">    server server1.com; </span><br><span class=\"line\">    server server2.com; </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>â‘¤ URL å“ˆå¸Œå€¼ï¼ˆurl_hashï¼‰ æŒ‰è®¿é—® url çš„ hash ç»“æœæ¥åˆ†é…è¯·æ±‚ï¼Œå’Œ IP å“ˆå¸Œå€¼ç±»ä¼¼ã€‚</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">upstream backend &#123;</span><br><span class=\"line\">    hash $request_uri;</span><br><span class=\"line\">    server server1.com; </span><br><span class=\"line\">    server server2.com;   </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"3ï¼‰æ§åˆ¶å±‚ï¼ˆç½‘å…³å±‚ï¼‰\"><a href=\"#3ï¼‰æ§åˆ¶å±‚ï¼ˆç½‘å…³å±‚ï¼‰\" class=\"headerlink\" title=\"3ï¼‰æ§åˆ¶å±‚ï¼ˆç½‘å…³å±‚ï¼‰\"></a>3ï¼‰æ§åˆ¶å±‚ï¼ˆç½‘å…³å±‚ï¼‰</h4><p>é™åˆ¶åŒä¸€ä¸ªç”¨æˆ·çš„è®¿é—®é¢‘ç‡ï¼Œé™åˆ¶è®¿é—®æ¬¡æ•°ï¼Œé˜²æ­¢å¤šæ¬¡æ¶æ„è¯·æ±‚ã€‚</p>\n<h4 id=\"4ï¼‰æœåŠ¡å±‚\"><a href=\"#4ï¼‰æœåŠ¡å±‚\" class=\"headerlink\" title=\"4ï¼‰æœåŠ¡å±‚\"></a>4ï¼‰æœåŠ¡å±‚</h4><p>â‘  ä¸šåŠ¡æœåŠ¡å™¨åˆ†ç¦»ï¼šæ¯”å¦‚ï¼Œå°†ç§’æ€ä¸šåŠ¡ç³»ç»Ÿå’Œå…¶ä»–ä¸šåŠ¡åˆ†ç¦»ï¼Œå•ç‹¬æ”¾åœ¨é«˜é…æœåŠ¡å™¨ä¸Šï¼Œå¯ä»¥é›†ä¸­èµ„æºå¯¹è®¿é—®è¯·æ±‚æŠ—å‹ã€‚<br>â‘¡ é‡‡ç”¨ MQï¼ˆæ¶ˆæ¯é˜Ÿåˆ—ï¼‰ç¼“å­˜è¯·æ±‚ï¼šMQ å…·æœ‰å‰Šå³°å¡«è°·çš„ä½œç”¨ï¼Œå¯ä»¥æŠŠå®¢æˆ·ç«¯çš„è¯·æ±‚å…ˆå¯¼æµåˆ° MQï¼Œç¨‹åºåœ¨ä» MQ ä¸­è¿›è¡Œæ¶ˆè´¹ï¼ˆæ‰§è¡Œè¯·æ±‚ï¼‰ï¼Œè¿™æ ·å¯ä»¥é¿å…çŸ­æ—¶é—´å†…å¤§é‡è¯·æ±‚ï¼Œå¯¼è‡´æœåŠ¡å™¨ç¨‹åºæ— æ³•å“åº”çš„é—®é¢˜ã€‚<br>â‘¢ åˆ©ç”¨ç¼“å­˜åº”å¯¹è¯»è¯·æ±‚ï¼Œæ¯”å¦‚ï¼Œä½¿ç”¨ Redis ç­‰ç¼“å­˜ï¼Œåˆ©ç”¨ Redis å¯ä»¥åˆ†æ‹…æ•°æ®åº“å¾ˆå¤§ä¸€éƒ¨åˆ†å‹åŠ›ã€‚</p>\n<h4 id=\"5ï¼‰æ•°æ®åº“å±‚\"><a href=\"#5ï¼‰æ•°æ®åº“å±‚\" class=\"headerlink\" title=\"5ï¼‰æ•°æ®åº“å±‚\"></a>5ï¼‰æ•°æ®åº“å±‚</h4><p>â‘  åˆç†ä½¿ç”¨æ•°æ®åº“å¼•æ“ â‘¡ åˆç†è®¾ç½®äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Œåˆç†ä½¿ç”¨äº‹åŠ¡ â‘¢ æ­£ç¡®ä½¿ç”¨ SQL è¯­å¥å’ŒæŸ¥è¯¢ç´¢å¼• â‘£ åˆç†åˆ†åº“åˆ†è¡¨ â‘¤ ä½¿ç”¨æ•°æ®åº“ä¸­é—´ä»¶å®ç°æ•°æ®åº“è¯»å†™åˆ†ç¦» â‘¥ è®¾ç½®æ•°æ®åº“ä¸»ä»è¯»å†™åˆ†ç¦»</p>\n<h2 id=\"è¡¥å……\"><a href=\"#è¡¥å……\" class=\"headerlink\" title=\"è¡¥å……\"></a>è¡¥å……</h2><h3 id=\"æŸ¥è¯¢è¯­å¥ä¸åŒå…ƒç´ ï¼ˆwhereã€jionã€limitã€group-byã€having-ç­‰ç­‰ï¼‰æ‰§è¡Œå…ˆåé¡ºåºï¼Ÿ\"><a href=\"#æŸ¥è¯¢è¯­å¥ä¸åŒå…ƒç´ ï¼ˆwhereã€jionã€limitã€group-byã€having-ç­‰ç­‰ï¼‰æ‰§è¡Œå…ˆåé¡ºåºï¼Ÿ\" class=\"headerlink\" title=\"æŸ¥è¯¢è¯­å¥ä¸åŒå…ƒç´ ï¼ˆwhereã€jionã€limitã€group byã€having ç­‰ç­‰ï¼‰æ‰§è¡Œå…ˆåé¡ºåºï¼Ÿ\"></a>æŸ¥è¯¢è¯­å¥ä¸åŒå…ƒç´ ï¼ˆwhereã€jionã€limitã€group byã€having ç­‰ç­‰ï¼‰æ‰§è¡Œå…ˆåé¡ºåºï¼Ÿ</h3><p>æŸ¥è¯¢ä¸­ç”¨åˆ°çš„å…³é”®è¯ä¸»è¦åŒ…å«å…­ä¸ªï¼Œå¹¶ä¸”ä»–ä»¬çš„é¡ºåºä¾æ¬¡ä¸º <code>select--from--where--group by--having--order by</code></p>\n<p>å…¶ä¸­ select å’Œ from æ˜¯å¿…é¡»çš„ï¼Œå…¶ä»–å…³é”®è¯æ˜¯å¯é€‰çš„ï¼Œè¿™å…­ä¸ªå…³é”®è¯çš„æ‰§è¡Œé¡ºåº ä¸ sql è¯­å¥çš„ä¹¦å†™é¡ºåºå¹¶ä¸æ˜¯ä¸€æ ·çš„ï¼Œè€Œæ˜¯æŒ‰ç…§ä¸‹é¢çš„é¡ºåºæ¥æ‰§è¡Œ</p>\n<ul>\n<li>from:éœ€è¦ä»å“ªä¸ªæ•°æ®è¡¨æ£€ç´¢æ•°æ®</li>\n<li>where:è¿‡æ»¤è¡¨ä¸­æ•°æ®çš„æ¡ä»¶</li>\n<li>group by:å¦‚ä½•å°†ä¸Šé¢è¿‡æ»¤å‡ºçš„æ•°æ®åˆ†ç»„</li>\n<li>having:å¯¹ä¸Šé¢å·²ç»åˆ†ç»„çš„æ•°æ®è¿›è¡Œè¿‡æ»¤çš„æ¡ä»¶</li>\n<li>select:æŸ¥çœ‹ç»“æœé›†ä¸­çš„å“ªä¸ªåˆ—ï¼Œæˆ–åˆ—çš„è®¡ç®—ç»“æœ</li>\n<li>order by :æŒ‰ç…§ä»€ä¹ˆæ ·çš„é¡ºåºæ¥æŸ¥çœ‹è¿”å›çš„æ•°æ®</li>\n</ul>\n<p>from åé¢çš„è¡¨å…³è”ï¼Œæ˜¯è‡ªå³å‘å·¦è§£æ è€Œ where æ¡ä»¶çš„è§£æé¡ºåºæ˜¯è‡ªä¸‹è€Œä¸Šçš„ã€‚</p>\n<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨å†™ SQL æ–‡çš„æ—¶å€™ï¼Œå°½é‡æŠŠæ•°æ®é‡å°çš„è¡¨æ”¾åœ¨æœ€å³è¾¹æ¥è¿›è¡Œå…³è”ï¼ˆç”¨å°è¡¨å»åŒ¹é…å¤§è¡¨ï¼‰ï¼Œè€ŒæŠŠèƒ½ç­›é€‰å‡ºå°é‡æ•°æ®çš„æ¡ä»¶æ”¾åœ¨ where è¯­å¥çš„æœ€å·¦è¾¹ ï¼ˆç”¨å°è¡¨å»åŒ¹é…å¤§è¡¨ï¼‰</p>\n<h3 id=\"éå…³ç³»å‹æ•°æ®åº“å’Œå…³ç³»å‹æ•°æ®åº“åŒºåˆ«ï¼Œä¼˜åŠ¿æ¯”è¾ƒï¼Ÿ\"><a href=\"#éå…³ç³»å‹æ•°æ®åº“å’Œå…³ç³»å‹æ•°æ®åº“åŒºåˆ«ï¼Œä¼˜åŠ¿æ¯”è¾ƒï¼Ÿ\" class=\"headerlink\" title=\"éå…³ç³»å‹æ•°æ®åº“å’Œå…³ç³»å‹æ•°æ®åº“åŒºåˆ«ï¼Œä¼˜åŠ¿æ¯”è¾ƒï¼Ÿ\"></a>éå…³ç³»å‹æ•°æ®åº“å’Œå…³ç³»å‹æ•°æ®åº“åŒºåˆ«ï¼Œä¼˜åŠ¿æ¯”è¾ƒï¼Ÿ</h3><h4 id=\"éå…³ç³»å‹æ•°æ®åº“çš„ä¼˜åŠ¿\"><a href=\"#éå…³ç³»å‹æ•°æ®åº“çš„ä¼˜åŠ¿\" class=\"headerlink\" title=\"éå…³ç³»å‹æ•°æ®åº“çš„ä¼˜åŠ¿\"></a>éå…³ç³»å‹æ•°æ®åº“çš„ä¼˜åŠ¿</h4><p><strong>1. æ€§èƒ½</strong></p>\n<p>NOSQL æ˜¯åŸºäºé”®å€¼å¯¹çš„ï¼Œå¯ä»¥æƒ³è±¡æˆè¡¨ä¸­çš„ä¸»é”®å’Œå€¼çš„å¯¹åº”å…³ç³»ï¼Œè€Œä¸”ä¸éœ€è¦ç»è¿‡ SQL å±‚çš„è§£æï¼Œæ‰€ä»¥æ€§èƒ½éå¸¸é«˜ã€‚</p>\n<p><strong>2. å¯æ‰©å±•æ€§</strong></p>\n<p>åŒæ ·ä¹Ÿæ˜¯å› ä¸ºåŸºäºé”®å€¼å¯¹ï¼Œæ•°æ®ä¹‹é—´æ²¡æœ‰è€¦åˆæ€§ï¼Œæ‰€ä»¥éå¸¸å®¹æ˜“æ°´å¹³æ‰©å±•ã€‚</p>\n<h4 id=\"å…³ç³»å‹æ•°æ®åº“çš„ä¼˜åŠ¿\"><a href=\"#å…³ç³»å‹æ•°æ®åº“çš„ä¼˜åŠ¿\" class=\"headerlink\" title=\"å…³ç³»å‹æ•°æ®åº“çš„ä¼˜åŠ¿\"></a>å…³ç³»å‹æ•°æ®åº“çš„ä¼˜åŠ¿</h4><p><strong>1. å¤æ‚æŸ¥è¯¢</strong></p>\n<p>å¯ä»¥ç”¨ SQL è¯­å¥æ–¹ä¾¿çš„åœ¨ä¸€ä¸ªè¡¨ä»¥åŠå¤šä¸ªè¡¨ä¹‹é—´åšéå¸¸å¤æ‚çš„æ•°æ®æŸ¥è¯¢ã€‚</p>\n<p><strong>2. äº‹åŠ¡æ”¯æŒ</strong></p>\n<p>ä½¿å¾—å¯¹äºå®‰å…¨æ€§èƒ½å¾ˆé«˜çš„æ•°æ®è®¿é—®è¦æ±‚å¾—ä»¥å®ç°ã€‚</p>\n<h4 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h4><p><strong>å¯¹äºè¿™ä¸¤ç±»æ•°æ®åº“ï¼Œå¯¹æ–¹çš„ä¼˜åŠ¿å°±æ˜¯è‡ªå·±çš„å¼±åŠ¿ï¼Œåä¹‹äº¦ç„¶</strong>ã€‚</p>\n<p>NOSQL æ•°æ®åº“æ…¢æ…¢å¼€å§‹å…·å¤‡ SQL æ•°æ®åº“çš„ä¸€äº›å¤æ‚æŸ¥è¯¢åŠŸèƒ½ï¼Œæ¯”å¦‚ MongoDBã€‚</p>\n<p>å¯¹äºäº‹åŠ¡çš„æ”¯æŒä¹Ÿå¯ä»¥ç”¨ä¸€äº›ç³»ç»Ÿçº§çš„åŸå­æ“ä½œæ¥å®ç°ä¾‹å¦‚ä¹è§‚é”ä¹‹ç±»çš„æ–¹æ³•æ¥æ›²çº¿æ•‘å›½ï¼Œæ¯”å¦‚ Redis set nxã€‚</p>\n<h3 id=\"æ•°æ®åº“ä¸‰èŒƒå¼ï¼Œæ ¹æ®æŸä¸ªåœºæ™¯è®¾è®¡æ•°æ®è¡¨ï¼Ÿ\"><a href=\"#æ•°æ®åº“ä¸‰èŒƒå¼ï¼Œæ ¹æ®æŸä¸ªåœºæ™¯è®¾è®¡æ•°æ®è¡¨ï¼Ÿ\" class=\"headerlink\" title=\"æ•°æ®åº“ä¸‰èŒƒå¼ï¼Œæ ¹æ®æŸä¸ªåœºæ™¯è®¾è®¡æ•°æ®è¡¨ï¼Ÿ\"></a>æ•°æ®åº“ä¸‰èŒƒå¼ï¼Œæ ¹æ®æŸä¸ªåœºæ™¯è®¾è®¡æ•°æ®è¡¨ï¼Ÿ</h3><ul>\n<li>æ‰€æœ‰å­—æ®µå€¼éƒ½æ˜¯ä¸å¯åˆ†è§£çš„åŸå­å€¼ã€‚</li>\n<li>åœ¨ä¸€ä¸ªæ•°æ®åº“è¡¨ä¸­ï¼Œä¸€ä¸ªè¡¨ä¸­åªèƒ½ä¿å­˜ä¸€ç§æ•°æ®ï¼Œä¸å¯ä»¥æŠŠå¤šç§æ•°æ®ä¿å­˜åœ¨åŒä¸€å¼ æ•°æ®åº“è¡¨ä¸­ã€‚</li>\n<li>æ•°æ®è¡¨ä¸­çš„æ¯ä¸€åˆ—æ•°æ®éƒ½å’Œä¸»é”®ç›´æ¥ç›¸å…³ï¼Œè€Œä¸èƒ½é—´æ¥ç›¸å…³ã€‚</li>\n</ul>\n<h4 id=\"ç¬¬ä¸€èŒƒå¼-ç¡®ä¿æ¯åˆ—ä¿æŒåŸå­æ€§\"><a href=\"#ç¬¬ä¸€èŒƒå¼-ç¡®ä¿æ¯åˆ—ä¿æŒåŸå­æ€§\" class=\"headerlink\" title=\"ç¬¬ä¸€èŒƒå¼(ç¡®ä¿æ¯åˆ—ä¿æŒåŸå­æ€§)\"></a>ç¬¬ä¸€èŒƒå¼(ç¡®ä¿æ¯åˆ—ä¿æŒåŸå­æ€§)</h4><p><strong>ç¬¬ä¸€èŒƒå¼æ˜¯æœ€åŸºæœ¬çš„èŒƒå¼ã€‚å¦‚æœæ•°æ®åº“è¡¨ä¸­çš„æ‰€æœ‰å­—æ®µå€¼éƒ½æ˜¯ä¸å¯åˆ†è§£çš„åŸå­å€¼ï¼Œå°±è¯´æ˜è¯¥æ•°æ®åº“è¡¨æ»¡è¶³äº†ç¬¬ä¸€èŒƒå¼</strong>ã€‚</p>\n<p>ç¬¬ä¸€èŒƒå¼çš„åˆç†éµå¾ªéœ€è¦æ ¹æ®ç³»ç»Ÿçš„å®é™…éœ€æ±‚æ¥å®šã€‚æ¯”å¦‚æŸäº›æ•°æ®åº“ç³»ç»Ÿä¸­éœ€è¦ç”¨åˆ°â€œåœ°å€â€è¿™ä¸ªå±æ€§ï¼Œæœ¬æ¥ç›´æ¥å°†â€œåœ°å€â€å±æ€§è®¾è®¡æˆä¸€ä¸ªæ•°æ®åº“è¡¨çš„å­—æ®µå°±è¡Œã€‚ä½†æ˜¯å¦‚æœç³»ç»Ÿç»å¸¸ä¼šè®¿é—®â€œåœ°å€â€å±æ€§ä¸­çš„â€œåŸå¸‚â€éƒ¨åˆ†ï¼Œé‚£ä¹ˆå°±éè¦å°†â€œåœ°å€â€è¿™ä¸ªå±æ€§é‡æ–°æ‹†åˆ†ä¸ºçœä»½ã€åŸå¸‚ã€è¯¦ç»†åœ°å€ç­‰å¤šä¸ªéƒ¨åˆ†è¿›è¡Œå­˜å‚¨ï¼Œè¿™æ ·åœ¨å¯¹åœ°å€ä¸­æŸä¸€éƒ¨åˆ†æ“ä½œçš„æ—¶å€™å°†éå¸¸æ–¹ä¾¿ã€‚è¿™æ ·è®¾è®¡æ‰ç®—æ»¡è¶³äº†æ•°æ®åº“çš„ç¬¬ä¸€èŒƒå¼ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚</p>\n<p>ä¸Šè¡¨æ‰€ç¤ºçš„ç”¨æˆ·ä¿¡æ¯éµå¾ªäº†ç¬¬ä¸€èŒƒå¼çš„è¦æ±‚ï¼Œè¿™æ ·åœ¨å¯¹ç”¨æˆ·ä½¿ç”¨åŸå¸‚è¿›è¡Œåˆ†ç±»çš„æ—¶å€™å°±éå¸¸æ–¹ä¾¿ï¼Œä¹Ÿæé«˜äº†æ•°æ®åº“çš„æ€§èƒ½ã€‚</p>\n<h4 id=\"ç¬¬äºŒèŒƒå¼-ç¡®ä¿è¡¨ä¸­çš„æ¯åˆ—éƒ½å’Œä¸»é”®ç›¸å…³\"><a href=\"#ç¬¬äºŒèŒƒå¼-ç¡®ä¿è¡¨ä¸­çš„æ¯åˆ—éƒ½å’Œä¸»é”®ç›¸å…³\" class=\"headerlink\" title=\"ç¬¬äºŒèŒƒå¼(ç¡®ä¿è¡¨ä¸­çš„æ¯åˆ—éƒ½å’Œä¸»é”®ç›¸å…³)\"></a>ç¬¬äºŒèŒƒå¼(ç¡®ä¿è¡¨ä¸­çš„æ¯åˆ—éƒ½å’Œä¸»é”®ç›¸å…³)</h4><p>ç¬¬äºŒèŒƒå¼åœ¨ç¬¬ä¸€èŒƒå¼çš„åŸºç¡€ä¹‹ä¸Šæ›´è¿›ä¸€å±‚ã€‚ç¬¬äºŒèŒƒå¼éœ€è¦ç¡®ä¿æ•°æ®åº“è¡¨ä¸­çš„æ¯ä¸€åˆ—éƒ½å’Œä¸»é”®ç›¸å…³ï¼Œè€Œä¸èƒ½åªä¸ä¸»é”®çš„æŸä¸€éƒ¨åˆ†ç›¸å…³ï¼ˆä¸»è¦é’ˆå¯¹è”åˆä¸»é”®è€Œè¨€ï¼‰ã€‚<strong>ä¹Ÿå°±æ˜¯è¯´åœ¨ä¸€ä¸ªæ•°æ®åº“è¡¨ä¸­ï¼Œä¸€ä¸ªè¡¨ä¸­åªèƒ½ä¿å­˜ä¸€ç§æ•°æ®ï¼Œä¸å¯ä»¥æŠŠå¤šç§æ•°æ®ä¿å­˜åœ¨åŒä¸€å¼ æ•°æ®åº“è¡¨ä¸­</strong>ã€‚</p>\n<p><strong>æ¯”å¦‚è¦è®¾è®¡ä¸€ä¸ªè®¢å•ä¿¡æ¯è¡¨ï¼Œå› ä¸ºè®¢å•ä¸­å¯èƒ½ä¼šæœ‰å¤šç§å•†å“ï¼Œæ‰€ä»¥è¦å°†è®¢å•ç¼–å·å’Œå•†å“ç¼–å·ä½œä¸ºæ•°æ®åº“è¡¨çš„è”åˆä¸»é”®</strong>ã€‚</p>\n<h4 id=\"ç¬¬ä¸‰èŒƒå¼-ç¡®ä¿æ¯åˆ—éƒ½å’Œä¸»é”®åˆ—ç›´æ¥ç›¸å…³-è€Œä¸æ˜¯é—´æ¥ç›¸å…³\"><a href=\"#ç¬¬ä¸‰èŒƒå¼-ç¡®ä¿æ¯åˆ—éƒ½å’Œä¸»é”®åˆ—ç›´æ¥ç›¸å…³-è€Œä¸æ˜¯é—´æ¥ç›¸å…³\" class=\"headerlink\" title=\"ç¬¬ä¸‰èŒƒå¼(ç¡®ä¿æ¯åˆ—éƒ½å’Œä¸»é”®åˆ—ç›´æ¥ç›¸å…³,è€Œä¸æ˜¯é—´æ¥ç›¸å…³)\"></a>ç¬¬ä¸‰èŒƒå¼(ç¡®ä¿æ¯åˆ—éƒ½å’Œä¸»é”®åˆ—ç›´æ¥ç›¸å…³,è€Œä¸æ˜¯é—´æ¥ç›¸å…³)</h4><p>ç¬¬ä¸‰èŒƒå¼éœ€è¦ç¡®ä¿æ•°æ®è¡¨ä¸­çš„<strong>æ¯ä¸€åˆ—æ•°æ®éƒ½å’Œä¸»é”®ç›´æ¥ç›¸å…³ï¼Œè€Œä¸èƒ½é—´æ¥ç›¸å…³</strong>ã€‚</p>\n<p>æ¯”å¦‚åœ¨è®¾è®¡ä¸€ä¸ªè®¢å•æ•°æ®è¡¨çš„æ—¶å€™ï¼Œå¯ä»¥å°†å®¢æˆ·ç¼–å·ä½œä¸ºä¸€ä¸ªå¤–é”®å’Œè®¢å•è¡¨å»ºç«‹ç›¸åº”çš„å…³ç³»ã€‚è€Œä¸å¯ä»¥åœ¨è®¢å•è¡¨ä¸­æ·»åŠ å…³äºå®¢æˆ·å…¶å®ƒä¿¡æ¯ï¼ˆæ¯”å¦‚å§“åã€æ‰€å±å…¬å¸ç­‰ï¼‰çš„å­—æ®µã€‚</p>\n<h3 id=\"MySQL-é«˜å¹¶å‘ç¯å¢ƒè§£å†³æ–¹æ¡ˆï¼Ÿ\"><a href=\"#MySQL-é«˜å¹¶å‘ç¯å¢ƒè§£å†³æ–¹æ¡ˆï¼Ÿ\" class=\"headerlink\" title=\"MySQL é«˜å¹¶å‘ç¯å¢ƒè§£å†³æ–¹æ¡ˆï¼Ÿ\"></a>MySQL é«˜å¹¶å‘ç¯å¢ƒè§£å†³æ–¹æ¡ˆï¼Ÿ</h3><p>MySQL é«˜å¹¶å‘ç¯å¢ƒè§£å†³æ–¹æ¡ˆ åˆ†åº“ åˆ†è¡¨ åˆ†å¸ƒå¼ å¢åŠ äºŒçº§ç¼“å­˜ã€‚</p>\n<p><strong>éœ€æ±‚åˆ†æ</strong>ï¼šäº’è”ç½‘å•ä½ æ¯å¤©å¤§é‡æ•°æ®è¯»å–ï¼Œå†™å…¥ï¼Œå¹¶å‘æ€§é«˜ã€‚</p>\n<ul>\n<li><strong>ç°æœ‰è§£å†³æ–¹å¼</strong>ï¼šæ°´å¹³åˆ†åº“åˆ†è¡¨ï¼Œç”±å•ç‚¹åˆ†å¸ƒåˆ°å¤šç‚¹æ•°æ®åº“ä¸­ï¼Œä»è€Œé™ä½å•ç‚¹æ•°æ®åº“å‹åŠ›ã€‚</li>\n<li><strong>é›†ç¾¤æ–¹æ¡ˆ</strong>ï¼šè§£å†³ DB å®•æœºå¸¦æ¥çš„å•ç‚¹ DB ä¸èƒ½è®¿é—®é—®é¢˜ã€‚</li>\n<li><strong>è¯»å†™åˆ†ç¦»ç­–ç•¥</strong>ï¼šæå¤§é™åº¦æé«˜äº†åº”ç”¨ä¸­ Read æ•°æ®çš„é€Ÿåº¦å’Œå¹¶å‘é‡ã€‚æ— æ³•è§£å†³é«˜å†™å…¥å‹åŠ›ã€‚</li>\n</ul>\n<h3 id=\"æ•°æ®åº“å´©æºƒæ—¶äº‹åŠ¡çš„æ¢å¤æœºåˆ¶ï¼ˆREDO-æ—¥å¿—å’Œ-UNDO-æ—¥å¿—ï¼‰ï¼Ÿ\"><a href=\"#æ•°æ®åº“å´©æºƒæ—¶äº‹åŠ¡çš„æ¢å¤æœºåˆ¶ï¼ˆREDO-æ—¥å¿—å’Œ-UNDO-æ—¥å¿—ï¼‰ï¼Ÿ\" class=\"headerlink\" title=\"æ•°æ®åº“å´©æºƒæ—¶äº‹åŠ¡çš„æ¢å¤æœºåˆ¶ï¼ˆREDO æ—¥å¿—å’Œ UNDO æ—¥å¿—ï¼‰ï¼Ÿ\"></a>æ•°æ®åº“å´©æºƒæ—¶äº‹åŠ¡çš„æ¢å¤æœºåˆ¶ï¼ˆREDO æ—¥å¿—å’Œ UNDO æ—¥å¿—ï¼‰ï¼Ÿ</h3><h4 id=\"Undo-Log\"><a href=\"#Undo-Log\" class=\"headerlink\" title=\"Undo Log\"></a>Undo Log</h4><p><strong>Undo Log æ˜¯ä¸ºäº†å®ç°äº‹åŠ¡çš„åŸå­æ€§</strong>ï¼Œåœ¨ MySQL æ•°æ®åº“ InnoDB å­˜å‚¨å¼•æ“ä¸­ï¼Œè¿˜ç”¨äº† Undo Log æ¥å®ç°å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶(ç®€ç§°ï¼šMVCC)ã€‚</p>\n<ul>\n<li><strong>äº‹åŠ¡çš„åŸå­æ€§</strong>(Atomicity)äº‹åŠ¡ä¸­çš„æ‰€æœ‰æ“ä½œï¼Œè¦ä¹ˆå…¨éƒ¨å®Œæˆï¼Œè¦ä¹ˆä¸åšä»»ä½•æ“ä½œï¼Œä¸èƒ½åªåšéƒ¨åˆ†æ“ä½œã€‚å¦‚æœåœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­å‘ç”Ÿäº†é”™è¯¯ï¼Œè¦å›æ»š(Rollback)åˆ°äº‹åŠ¡å¼€å§‹å‰çš„çŠ¶æ€ï¼Œå°±åƒè¿™ä¸ªäº‹åŠ¡ä»æ¥æ²¡æœ‰æ‰§è¡Œè¿‡ã€‚</li>\n<li><strong>åŸç†</strong>Undo Log çš„åŸç†å¾ˆç®€å•ï¼Œ<strong>ä¸ºäº†æ»¡è¶³äº‹åŠ¡çš„åŸå­æ€§ï¼Œåœ¨æ“ä½œä»»ä½•æ•°æ®ä¹‹å‰ï¼Œé¦–å…ˆå°†æ•°æ®å¤‡ä»½åˆ°ä¸€ä¸ªåœ°æ–¹ï¼ˆè¿™ä¸ªå­˜å‚¨æ•°æ®å¤‡ä»½çš„åœ°æ–¹ç§°ä¸º UndoLogï¼‰</strong>ã€‚ç„¶åè¿›è¡Œæ•°æ®çš„ä¿®æ”¹ã€‚å¦‚æœå‡ºç°äº†é”™è¯¯æˆ–è€…ç”¨æˆ·æ‰§è¡Œäº† ROLLBACK è¯­å¥ï¼Œ<strong>ç³»ç»Ÿå¯ä»¥åˆ©ç”¨ Undo Log ä¸­çš„å¤‡ä»½å°†æ•°æ®æ¢å¤åˆ°äº‹åŠ¡å¼€å§‹ä¹‹å‰çš„çŠ¶æ€</strong>ã€‚</li>\n</ul>\n<p><strong>ä¹‹æ‰€ä»¥èƒ½åŒæ—¶ä¿è¯åŸå­æ€§å’ŒæŒä¹…åŒ–ï¼Œæ˜¯å› ä¸ºä»¥ä¸‹ç‰¹ç‚¹</strong>ï¼š</p>\n<ul>\n<li>æ›´æ–°æ•°æ®å‰è®°å½• Undo logã€‚</li>\n<li>ä¸ºäº†ä¿è¯æŒä¹…æ€§ï¼Œå¿…é¡»å°†æ•°æ®åœ¨äº‹åŠ¡æäº¤å‰å†™åˆ°ç£ç›˜ã€‚åªè¦äº‹åŠ¡æˆåŠŸæäº¤ï¼Œæ•°æ®å¿…ç„¶å·²ç»æŒä¹…åŒ–ã€‚</li>\n<li><strong>Undo log å¿…é¡»å…ˆäºæ•°æ®æŒä¹…åŒ–åˆ°ç£ç›˜</strong>ã€‚å¦‚æœåœ¨ G,H ä¹‹é—´ç³»ç»Ÿå´©æºƒï¼Œ<strong>undo log æ˜¯å®Œæ•´çš„ï¼Œ å¯ä»¥ç”¨æ¥å›æ»šäº‹åŠ¡</strong>ã€‚</li>\n<li>å¦‚æœåœ¨ A-F ä¹‹é—´ç³»ç»Ÿå´©æºƒ,å› ä¸ºæ•°æ®æ²¡æœ‰æŒä¹…åŒ–åˆ°ç£ç›˜ã€‚æ‰€ä»¥ç£ç›˜ä¸Šçš„æ•°æ®è¿˜æ˜¯ä¿æŒåœ¨äº‹åŠ¡å¼€å§‹å‰çš„çŠ¶æ€ã€‚</li>\n</ul>\n<p><strong>ç¼ºé™·</strong>ï¼š<strong>æ¯ä¸ªäº‹åŠ¡æäº¤å‰å°†æ•°æ®å’Œ Undo Log å†™å…¥ç£ç›˜ï¼Œè¿™æ ·ä¼šå¯¼è‡´å¤§é‡çš„ç£ç›˜ IOï¼Œå› æ­¤æ€§èƒ½å¾ˆä½</strong>ã€‚</p>\n<p>å¦‚æœèƒ½å¤Ÿå°†æ•°æ®ç¼“å­˜ä¸€æ®µæ—¶é—´ï¼Œå°±èƒ½å‡å°‘ IO æé«˜æ€§èƒ½ã€‚ä½†æ˜¯è¿™æ ·å°±ä¼šä¸§å¤±äº‹åŠ¡çš„æŒä¹…æ€§ã€‚å› æ­¤å¼•å…¥äº†å¦å¤–ä¸€ç§æœºåˆ¶æ¥å®ç°æŒä¹…åŒ–ï¼Œå³ Redo Logã€‚</p>\n<h4 id=\"Redo-Log\"><a href=\"#Redo-Log\" class=\"headerlink\" title=\"Redo Log\"></a>Redo Log</h4><ul>\n<li><strong>åŸç†å’Œ Undo Log ç›¸å</strong>ï¼Œ<strong>Redo Log è®°å½•çš„æ˜¯æ–°æ•°æ®çš„å¤‡ä»½</strong>ã€‚<strong>åœ¨äº‹åŠ¡æäº¤å‰ï¼Œåªè¦å°† Redo Log æŒä¹…åŒ–å³å¯ï¼Œä¸éœ€è¦å°†æ•°æ®æŒä¹…åŒ–ã€‚å½“ç³»ç»Ÿå´©æºƒæ—¶ï¼Œè™½ç„¶æ•°æ®æ²¡æœ‰æŒä¹…åŒ–ï¼Œä½†æ˜¯ Redo Log å·²ç»æŒä¹…åŒ–ã€‚ç³»ç»Ÿå¯ä»¥æ ¹æ® Redo Log çš„å†…å®¹ï¼Œå°†æ‰€æœ‰æ•°æ®æ¢å¤åˆ°æœ€æ–°çš„çŠ¶æ€</strong>ã€‚</li>\n</ul>\n<h3 id=\"Explain-æ€§èƒ½åˆ†æ\"><a href=\"#Explain-æ€§èƒ½åˆ†æ\" class=\"headerlink\" title=\"Explain æ€§èƒ½åˆ†æ\"></a>Explain æ€§èƒ½åˆ†æ</h3><p><strong>æ˜¯ä»€ä¹ˆ</strong></p>\n<p>æŸ¥çœ‹æ‰§è¡Œè®¡åˆ’ï¼šä½¿ç”¨ EXPLAIN å…³é”®å­—å¯ä»¥æ¨¡æ‹Ÿä¼˜åŒ–å™¨æ‰§è¡Œ SQL æŸ¥è¯¢è¯­å¥ï¼Œä»è€ŒçŸ¥é“ MySQL æ˜¯å¦‚ä½•å¤„ç† SQL è¯­å¥çš„ã€‚åˆ†ææŸ¥è¯¢è¯­å¥æˆ–æ˜¯è¡¨ç»“æ„çš„æ€§èƒ½ç“¶é¢ˆã€‚</p>\n<p><strong>èƒ½å¹²å˜›</strong></p>\n<ul>\n<li>è¡¨çš„è¯»å–é¡ºåº</li>\n<li>æ•°æ®è¯»å–æ“ä½œçš„æ“ä½œç±»å‹</li>\n<li>å“ªäº›ç´¢å¼•å¯ä»¥ä½¿ç”¨</li>\n<li>å“ªäº›ç´¢å¼•è¢«å®é™…ä½¿ç”¨</li>\n<li>è¡¨ä¹‹é—´çš„å¼•ç”¨</li>\n<li>æ¯å¼ è¡¨æœ‰å¤šå°‘è¡Œè¢«ä¼˜åŒ–å™¨æŸ¥è¯¢</li>\n</ul>\n<p><strong>æ€ä¹ˆç©</strong></p>\n<p>Explain + SQL è¯­å¥ã€‚<br>Explain æ‰§è¡Œåè¿”å›çš„ä¿¡æ¯ï¼š<br> <img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422131912576.png\" alt=\"image-20220422131912576\" style=\"zoom:50%;\" /></p>\n<p><strong>å„å­—æ®µè§£é‡Š</strong></p>\n<ol>\n<li><p>idï¼šselect æŸ¥è¯¢çš„åºåˆ—å·ï¼ŒåŒ…å«ä¸€ç»„æ•°å­—ï¼Œè¡¨ç¤ºæŸ¥è¯¢ä¸­æ‰§è¡Œ select å­å¥æˆ–æ“ä½œè¡¨çš„é¡ºåºã€‚</p>\n<ul>\n<li>id ç›¸åŒï¼Œæ‰§è¡Œé¡ºåºç”±ä¸Šè‡³ä¸‹</li>\n<li>id ä¸åŒï¼Œå¦‚æœæ˜¯å­æŸ¥è¯¢ï¼Œid çš„åºå·ä¼šé€’å¢ï¼Œid å€¼è¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜ï¼Œè¶Šå…ˆè¢«æ‰§è¡Œ</li>\n<li>id æœ‰ç›¸åŒä¹Ÿæœ‰ä¸åŒï¼šid å¦‚æœç›¸åŒï¼Œå¯ä»¥è®¤ä¸ºæ˜¯ä¸€ç»„ï¼Œä»ä¸Šå¾€ä¸‹é¡ºåºæ‰§è¡Œï¼›åœ¨æ‰€æœ‰ç»„ä¸­ï¼Œid å€¼è¶Šå¤§ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼Œè¶Šå…ˆæ‰§è¡Œ</li>\n</ul>\n<blockquote>\n<p>id å·æ¯ä¸ªå·ç ï¼Œè¡¨ç¤ºä¸€è¶Ÿç‹¬ç«‹çš„æŸ¥è¯¢ã€‚ä¸€ä¸ª sql çš„æŸ¥è¯¢è¶Ÿæ•°è¶Šå°‘è¶Šå¥½ã€‚</p>\n</blockquote>\n</li>\n<li><p>select_typeï¼šä»£è¡¨æŸ¥è¯¢çš„ç±»å‹ï¼Œä¸»è¦æ˜¯ç”¨äºåŒºåˆ«æ™®é€šæŸ¥è¯¢ã€è”åˆæŸ¥è¯¢ã€å­æŸ¥è¯¢ç­‰çš„å¤æ‚æŸ¥è¯¢ï¼Œå–å€¼èŒƒå›´å¦‚ä¸‹ï¼š</p>\n<ul>\n<li>simpleï¼šç®€å•çš„ select æŸ¥è¯¢ï¼ŒæŸ¥è¯¢ä¸­ä¸åŒ…å«å­æŸ¥è¯¢æˆ–è€… UNION</li>\n<li>primaryï¼šæŸ¥è¯¢ä¸­è‹¥åŒ…å«ä»»ä½•å¤æ‚çš„å­éƒ¨åˆ†ï¼Œæœ€å¤–å±‚æŸ¥è¯¢åˆ™è¢«æ ‡è®°ä¸º primary</li>\n<li>derivedï¼šåœ¨ FROM åˆ—è¡¨ä¸­åŒ…å«çš„å­æŸ¥è¯¢è¢«æ ‡è®°ä¸º DERIVED (è¡ç”Ÿ)ï¼ŒMySQL ä¼šé€’å½’æ‰§è¡Œè¿™äº›å­æŸ¥è¯¢, æŠŠç»“æœæ”¾åœ¨ä¸´æ—¶è¡¨é‡Œã€‚</li>\n<li>subqueryï¼šåœ¨ SELECT æˆ– WHERE åˆ—è¡¨ä¸­åŒ…å«äº†å­æŸ¥è¯¢</li>\n<li>depedent subqueryï¼šåœ¨ SELECT æˆ– WHERE åˆ—è¡¨ä¸­åŒ…å«äº†å­æŸ¥è¯¢ï¼Œå­æŸ¥è¯¢åŸºäºå¤–å±‚</li>\n<li>uncacheable subqueryï¼šæ— æ³•ä½¿ç”¨ç¼“å­˜çš„å­æŸ¥è¯¢</li>\n<li>unionï¼šè‹¥ç¬¬äºŒä¸ª SELECT å‡ºç°åœ¨ UNION ä¹‹åï¼Œåˆ™è¢«æ ‡è®°ä¸º UNIONï¼›è‹¥ UNION åŒ…å«åœ¨ FROM å­å¥çš„å­æŸ¥è¯¢ä¸­ï¼Œå¤–å±‚ SELECT å°†è¢«æ ‡è®°ä¸ºï¼šDERIVED</li>\n<li>union resultï¼šä» UNION è¡¨è·å–ç»“æœçš„ SELECT</li>\n</ul>\n</li>\n<li><p>tableï¼šè¿™ä¸ªæ•°æ®æ˜¯åŸºäºå“ªå¼ è¡¨çš„ã€‚</p>\n</li>\n<li><p>typeï¼šæ˜¯æŸ¥è¯¢çš„è®¿é—®ç±»å‹ã€‚æ˜¯è¾ƒä¸ºé‡è¦çš„ä¸€ä¸ªæŒ‡æ ‡ï¼Œç»“æœå€¼ä»æœ€å¥½åˆ°æœ€åä¾æ¬¡æ˜¯ï¼šsystem &gt; const &gt; eq_ref &gt; ref &gt; fulltext &gt; ref_or_null &gt; index_merge &gt; unique_subquery &gt; index_subquery &gt; range &gt; index &gt; ALLï¼Œä¸€èˆ¬æ¥è¯´ï¼Œå¾—ä¿è¯æŸ¥è¯¢è‡³å°‘è¾¾åˆ° range çº§åˆ«ï¼Œæœ€å¥½èƒ½è¾¾åˆ° refã€‚</p>\n<blockquote>\n<p>åªéœ€è¦è®°ä½ï¼šsystem &gt; const &gt; eq_ref &gt; ref &gt; range &gt; index &gt; ALL å°±è¡Œäº†ï¼Œå…¶ä»–çš„ä¸å¸¸è§ã€‚</p>\n</blockquote>\n<ul>\n<li>systemï¼šè¡¨åªæœ‰ä¸€è¡Œè®°å½•ï¼ˆç­‰äºç³»ç»Ÿè¡¨ï¼‰ï¼Œè¿™æ˜¯ const ç±»å‹çš„ç‰¹åˆ—ï¼Œå¹³æ—¶ä¸ä¼šå‡ºç°ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥å¿½ç•¥ä¸è®¡ã€‚</li>\n<li>constï¼šè¡¨ç¤ºé€šè¿‡ç´¢å¼•ä¸€æ¬¡å°±æ‰¾åˆ°äº†ï¼Œconst ç”¨äºæ¯”è¾ƒ primary key æˆ–è€… unique ç´¢å¼•ã€‚å› ä¸ºåªåŒ¹é…ä¸€è¡Œæ•°æ®ï¼Œæ‰€ä»¥å¾ˆå¿«ã€‚å¦‚å°†ä¸»é”®ç½®äº where åˆ—è¡¨ä¸­ï¼ŒMySQL å°±èƒ½å°†è¯¥æŸ¥è¯¢è½¬æ¢ä¸ºä¸€ä¸ªå¸¸é‡ã€‚</li>\n<li>eq_refï¼šå”¯ä¸€æ€§ç´¢å¼•æ‰«æï¼Œå¯¹äºæ¯ä¸ªç´¢å¼•é”®ï¼Œè¡¨ä¸­åªæœ‰ä¸€æ¡è®°å½•ä¸ä¹‹åŒ¹é…ã€‚å¸¸è§äºä¸»é”®æˆ–å”¯ä¸€ç´¢å¼•æ‰«æã€‚</li>\n<li>refï¼šéå”¯ä¸€æ€§ç´¢å¼•æ‰«æï¼Œè¿”å›åŒ¹é…æŸä¸ªå•ç‹¬å€¼çš„æ‰€æœ‰è¡Œã€‚æœ¬è´¨ä¸Šä¹Ÿæ˜¯ä¸€ç§ç´¢å¼•è®¿é—®ï¼Œå®ƒè¿”å›æ‰€æœ‰åŒ¹é…æŸä¸ªå•ç‹¬å€¼çš„è¡Œï¼Œç„¶è€Œï¼Œå®ƒå¯èƒ½ä¼šæ‰¾åˆ°å¤šä¸ªç¬¦åˆæ¡ä»¶çš„è¡Œï¼Œæ‰€ä»¥ä»–åº”è¯¥å±äºæŸ¥æ‰¾å’Œæ‰«æçš„æ··åˆä½“ã€‚</li>\n<li>rangeï¼šåªæ£€ç´¢ç»™å®šèŒƒå›´çš„è¡Œï¼Œä½¿ç”¨ä¸€ä¸ªç´¢å¼•æ¥é€‰æ‹©è¡Œã€‚key åˆ—æ˜¾ç¤ºä½¿ç”¨äº†å“ªä¸ªç´¢å¼•ä¸€èˆ¬å°±æ˜¯åœ¨ where è¯­å¥ä¸­å‡ºç°äº† betweenã€&lt;ã€&gt;ã€in ç­‰çš„æŸ¥è¯¢è¿™ç§èŒƒå›´æ‰«æç´¢å¼•æ‰«ææ¯”å…¨è¡¨æ‰«æè¦å¥½ï¼Œå› ä¸ºå®ƒåªéœ€è¦å¼€å§‹äºç´¢å¼•çš„æŸä¸€ç‚¹ï¼Œè€Œç»“æŸè¯­å¦ä¸€ç‚¹ï¼Œä¸ç”¨æ‰«æå…¨éƒ¨ç´¢å¼•ã€‚</li>\n<li>indexï¼šå‡ºç° index æ˜¯ sql ä½¿ç”¨äº†ç´¢å¼•ä½†æ˜¯æ²¡ç”¨ç´¢å¼•è¿›è¡Œè¿‡æ»¤ï¼Œä¸€èˆ¬æ˜¯ä½¿ç”¨äº†è¦†ç›–ç´¢å¼•æˆ–è€…æ˜¯åˆ©ç”¨ç´¢å¼•è¿›è¡Œäº†æ’åºåˆ†ç»„ã€‚</li>\n<li>allï¼šå°†éå†å…¨è¡¨ä»¥æ‰¾åˆ°åŒ¹é…çš„è¡Œã€‚</li>\n</ul>\n<blockquote>\n<p>å…¶ä»– type å¦‚ä¸‹ï¼š</p>\n</blockquote>\n<ul>\n<li>index_mergeï¼šåœ¨æŸ¥è¯¢è¿‡ç¨‹ä¸­éœ€è¦å¤šä¸ªç´¢å¼•ç»„åˆä½¿ç”¨ï¼Œé€šå¸¸å‡ºç°åœ¨æœ‰ or å…³é”®å­—çš„ sql ä¸­ã€‚</li>\n<li>ref_or_nullï¼šå¯¹äºæŸä¸ªå­—æ®µæ—¢éœ€è¦è¿‡æ»¤æ¡ä»¶ï¼Œä¹Ÿéœ€è¦ null å€¼çš„æƒ…å†µä¸‹ã€‚æŸ¥è¯¢ä¼˜åŒ–å™¨ä¼šé€‰æ‹©ç”¨ ref_or_null è¿æ¥æŸ¥è¯¢ã€‚</li>\n<li>index_subqueryï¼šåˆ©ç”¨ç´¢å¼•æ¥å…³è”å­æŸ¥è¯¢ï¼Œä¸å†å…¨è¡¨æ‰«æã€‚</li>\n<li>unique_subqueryï¼šè¯¥è”æ¥ç±»å‹ç±»ä¼¼äº index_subqueryã€‚å­æŸ¥è¯¢ä¸­çš„å”¯ä¸€ç´¢å¼•ã€‚</li>\n</ul>\n</li>\n<li><p>possible_keysï¼šæ˜¾ç¤ºå¯èƒ½åº”ç”¨åœ¨è¿™å¼ è¡¨ä¸­çš„ç´¢å¼•ï¼Œä¸€ä¸ªæˆ–å¤šä¸ªã€‚æŸ¥è¯¢æ¶‰åŠåˆ°çš„å­—æ®µä¸Šè‹¥å­˜åœ¨ç´¢å¼•ï¼Œåˆ™è¯¥ç´¢å¼•å°†è¢«åˆ—å‡ºï¼Œä½†ä¸ä¸€å®šè¢«æŸ¥è¯¢å®é™…ä½¿ç”¨ã€‚</p>\n</li>\n<li><p>keyï¼šå®é™…ä½¿ç”¨çš„ç´¢å¼•ã€‚å¦‚æœä¸º NULLï¼Œåˆ™æ²¡æœ‰ä½¿ç”¨ç´¢å¼•ã€‚</p>\n</li>\n<li><p>key_lenï¼šè¡¨ç¤ºç´¢å¼•ä¸­ä½¿ç”¨çš„å­—èŠ‚æ•°ï¼Œå¯é€šè¿‡è¯¥åˆ—è®¡ç®—æŸ¥è¯¢ä¸­ä½¿ç”¨çš„ç´¢å¼•çš„é•¿åº¦ã€‚key_len æ˜¾ç¤ºçš„å€¼ä¸ºç´¢å¼•å­—æ®µçš„æœ€å¤§å¯èƒ½é•¿åº¦ï¼Œå¹¶éå®é™…ä½¿ç”¨é•¿åº¦ã€‚å¦‚ä½•è®¡ç®— key_lenï¼Ÿ</p>\n<ul>\n<li>å…ˆçœ‹ç´¢å¼•ä¸Šå­—æ®µçš„ç±»å‹ + é•¿åº¦ï¼Œæ¯”å¦‚ï¼šint&#x3D;4; varchar(20)&#x3D;20; char(20)&#x3D;20</li>\n<li>å¦‚æœæ˜¯ varchar æˆ–è€… char è¿™ç§å­—ç¬¦ä¸²å­—æ®µï¼Œè§†å­—ç¬¦é›†è¦ä¹˜ä¸åŒçš„å€¼ï¼Œæ¯”å¦‚ utf-8 è¦ä¹˜ 3ï¼ŒGBK è¦ä¹˜ 2</li>\n<li>varchar è¿™ç§åŠ¨æ€å­—ç¬¦ä¸²è¦åŠ  2 ä¸ªå­—èŠ‚</li>\n<li>å…è®¸ä¸ºç©ºçš„å­—æ®µè¦åŠ  1 ä¸ªå­—èŠ‚</li>\n</ul>\n</li>\n<li><p>refï¼šæ˜¾ç¤ºç´¢å¼•çš„å“ªä¸€åˆ—è¢«ä½¿ç”¨äº†ï¼Œå¦‚æœå¯èƒ½çš„è¯ï¼Œæ˜¯ä¸€ä¸ªå¸¸æ•°ã€‚å“ªäº›åˆ—æˆ–å¸¸é‡è¢«ç”¨äºæŸ¥æ‰¾ç´¢å¼•åˆ—ä¸Šçš„å€¼ã€‚</p>\n</li>\n<li><p>rowsï¼šæ˜¾ç¤º MySQL è®¤ä¸ºå®ƒæ‰§è¡ŒæŸ¥è¯¢æ—¶å¿…é¡»æ£€æŸ¥çš„è¡Œæ•°ã€‚è¶Šå°‘è¶Šå¥½ï¼</p>\n</li>\n<li><p>Extraï¼šå…¶ä»–çš„é¢å¤–é‡è¦çš„ä¿¡æ¯ã€‚</p>\n<ul>\n<li>Using filesortï¼šè¯´æ˜ mysql ä¼šå¯¹æ•°æ®ä½¿ç”¨ä¸€ä¸ªå¤–éƒ¨çš„ç´¢å¼•æ’åºï¼Œè€Œä¸æ˜¯æŒ‰ç…§è¡¨å†…çš„ç´¢å¼•é¡ºåºè¿›è¡Œè¯»å–ã€‚MySQL ä¸­æ— æ³•åˆ©ç”¨ç´¢å¼•å®Œæˆçš„æ’åºæ“ä½œç§°ä¸ºâ€œæ–‡ä»¶æ’åºâ€ã€‚<strong>æ’åºå­—æ®µè‹¥é€šè¿‡ç´¢å¼•å»è®¿é—®å°†å¤§å¤§æé«˜æ’åºé€Ÿåº¦</strong>ã€‚</li>\n<li>Using temporaryï¼šä½¿ç”¨ä¸´æ—¶è¡¨ä¿å­˜ä¸­é—´ç»“æœï¼ŒMySQL åœ¨å¯¹æŸ¥è¯¢ç»“æœæ’åºæ—¶ä½¿ç”¨ä¸´æ—¶è¡¨ã€‚å¸¸è§äºæ’åº order by å’Œåˆ†ç»„æŸ¥è¯¢ group byã€‚</li>\n<li>Using indexï¼šè¡¨ç¤ºç›¸åº”çš„ select æ“ä½œä¸­ä½¿ç”¨äº†è¦†ç›–ç´¢å¼• (Covering Index)ï¼Œé¿å…è®¿é—®äº†è¡¨çš„æ•°æ®è¡Œï¼Œæ•ˆç‡ä¸é”™ï¼å¦‚æœåŒæ—¶å‡ºç° using whereï¼Œè¡¨æ˜ç´¢å¼•è¢«ç”¨æ¥æ‰§è¡Œç´¢å¼•é”®å€¼çš„æŸ¥æ‰¾ï¼›å¦‚æœæ²¡æœ‰åŒæ—¶å‡ºç° using whereï¼Œè¡¨æ˜ç´¢å¼•åªæ˜¯ç”¨æ¥è¯»å–æ•°æ®è€Œéåˆ©ç”¨ç´¢å¼•æ‰§è¡ŒæŸ¥æ‰¾ã€‚</li>\n<li>Using whereï¼šè¡¨æ˜ä½¿ç”¨äº† where è¿‡æ»¤ã€‚</li>\n<li>Using join bufferï¼šä½¿ç”¨äº†è¿æ¥ç¼“å­˜ã€‚</li>\n<li>impossible whereï¼šwhere å­å¥çš„å€¼æ€»æ˜¯ falseï¼Œä¸èƒ½ç”¨æ¥è·å–ä»»ä½•æ•°æ®ã€‚</li>\n<li>select tables optimized awayï¼šåœ¨æ²¡æœ‰ group by å­å¥çš„æƒ…å†µä¸‹ï¼ŒåŸºäºç´¢å¼•ä¼˜åŒ– MIN&#x2F;MAX æ“ä½œæˆ–è€…å¯¹äº MyISAM å­˜å‚¨å¼•æ“ä¼˜åŒ– COUNT(*) æ“ä½œï¼Œä¸å¿…ç­‰åˆ°æ‰§è¡Œé˜¶æ®µå†è¿›è¡Œè®¡ç®—ï¼ŒæŸ¥è¯¢æ‰§è¡Œè®¡åˆ’ç”Ÿæˆçš„é˜¶æ®µå³å®Œæˆä¼˜åŒ–ã€‚</li>\n<li>distinctï¼šä¼˜åŒ– distinct æ“ä½œï¼Œåœ¨æ‰¾åˆ°ç¬¬ä¸€åŒ¹é…çš„å…ƒç¥–åå³åœæ­¢æ‰¾åŒæ ·å€¼çš„åŠ¨ä½œã€‚</li>\n</ul>\n</li>\n</ol>"},{"title":"Javaå…«è‚¡æ–‡ - Linux","copyright":true,"mathjax":false,"date":"2023-01-25T05:45:06.000Z","toc":true,"urlname":"linux","_content":"\n> æ•´ç†çš„ Linux ç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½\t<!--more-->\n\n## Linux æ¦‚è¿°\n\n### ä»€ä¹ˆæ˜¯Linux\n\nLinux æ˜¯ä¸€å¥—**å…è´¹ä½¿ç”¨å’Œè‡ªç”±ä¼ æ’­çš„ç±» Unix æ“ä½œç³»ç»Ÿ**ï¼Œæ˜¯ä¸€ä¸ªåŸºäº POSIX å’Œ Unix çš„å¤šç”¨æˆ·ã€å¤šä»»åŠ¡ã€æ”¯æŒå¤šçº¿ç¨‹å’Œå¤š CPU çš„æ“ä½œç³»ç»Ÿã€‚å®ƒèƒ½è¿è¡Œä¸»è¦çš„ Unix å·¥å…·è½¯ä»¶ã€åº”ç”¨ç¨‹åºå’Œç½‘ç»œåè®®ã€‚å®ƒæ”¯æŒ 32 ä½å’Œ 64 ä½ç¡¬ä»¶ã€‚Linux ç»§æ‰¿äº† Unix ä»¥ç½‘ç»œä¸ºæ ¸å¿ƒçš„è®¾è®¡æ€æƒ³ï¼Œæ˜¯ä¸€ä¸ªæ€§èƒ½ç¨³å®šçš„å¤šç”¨æˆ·ç½‘ç»œæ“ä½œç³»ç»Ÿã€‚\n\n### Unixå’ŒLinuxæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\nLinux å’Œ Unix éƒ½æ˜¯åŠŸèƒ½å¼ºå¤§çš„æ“ä½œç³»ç»Ÿï¼Œéƒ½æ˜¯åº”ç”¨å¹¿æ³›çš„æœåŠ¡å™¨æ“ä½œç³»ç»Ÿï¼Œæœ‰å¾ˆå¤šç›¸ä¼¼ä¹‹å¤„ï¼Œç”šè‡³æœ‰ä¸€éƒ¨åˆ†äººé”™è¯¯åœ°è®¤ä¸º Unix å’Œ Linux æ“ä½œç³»ç»Ÿæ˜¯ä¸€æ ·çš„ï¼Œç„¶è€Œï¼Œäº‹å®å¹¶éå¦‚æ­¤ï¼Œä»¥ä¸‹æ˜¯ä¸¤è€…çš„åŒºåˆ«ã€‚\n\n1. å¼€æºæ€§\n\tLinux æ˜¯ä¸€æ¬¾å¼€æºæ“ä½œç³»ç»Ÿï¼Œä¸éœ€è¦ä»˜è´¹ï¼Œå³å¯ä½¿ç”¨ï¼›Unix æ˜¯ä¸€æ¬¾å¯¹æºç å®è¡ŒçŸ¥è¯†äº§æƒä¿æŠ¤çš„ä¼ ç»Ÿå•†ä¸šè½¯ä»¶ï¼Œä½¿ç”¨éœ€è¦ä»˜è´¹æˆæƒä½¿ç”¨ã€‚\n2. è·¨å¹³å°æ€§\n\tLinux æ“ä½œç³»ç»Ÿå…·æœ‰è‰¯å¥½çš„è·¨å¹³å°æ€§èƒ½ï¼Œå¯è¿è¡Œåœ¨å¤šç§ç¡¬ä»¶å¹³å°ä¸Šï¼›Unix æ“ä½œç³»ç»Ÿè·¨å¹³å°æ€§èƒ½è¾ƒå¼±ï¼Œå¤§å¤šéœ€ä¸ç¡¬ä»¶é…å¥—ä½¿ç”¨ã€‚\n3. å¯è§†åŒ–ç•Œé¢\n\tLinux é™¤äº†è¿›è¡Œå‘½ä»¤è¡Œæ“ä½œï¼Œè¿˜æœ‰çª—ä½“ç®¡ç†ç³»ç»Ÿï¼›Unix åªæ˜¯å‘½ä»¤è¡Œä¸‹çš„ç³»ç»Ÿã€‚\n4. ç¡¬ä»¶ç¯å¢ƒ\n\tLinux æ“ä½œç³»ç»Ÿå¯¹ç¡¬ä»¶çš„è¦æ±‚è¾ƒä½ï¼Œå®‰è£…æ–¹æ³•æ›´æ˜“æŒæ¡ï¼›Unix å¯¹ç¡¬ä»¶è¦æ±‚æ¯”è¾ƒè‹›åˆ»ï¼ŒæŒ‰ç…§éš¾åº¦è¾ƒå¤§ã€‚\n5. ç”¨æˆ·ç¾¤ä½“\n\tLinux çš„ç”¨æˆ·ç¾¤ä½“å¾ˆå¹¿æ³›ï¼Œä¸ªäººå’Œä¼ä¸šå‡å¯ä½¿ç”¨ï¼›Unix çš„ç”¨æˆ·ç¾¤ä½“æ¯”è¾ƒçª„ï¼Œå¤šæ˜¯å®‰å…¨æ€§è¦æ±‚é«˜çš„å¤§å‹ä¼ä¸šä½¿ç”¨ï¼Œå¦‚é“¶è¡Œã€ç”µä¿¡éƒ¨é—¨ç­‰ï¼Œæˆ–è€… Unix ç¡¬ä»¶å‚å•†ä½¿ç”¨ï¼Œå¦‚ Sun ç­‰ã€‚\n\tç›¸æ¯”äº Unix æ“ä½œç³»ç»Ÿï¼ŒLinux æ“ä½œç³»ç»Ÿæ›´å—å¹¿å¤§è®¡ç®—æœºçˆ±å¥½è€…çš„å–œçˆ±ï¼Œä¸»è¦åŸå› æ˜¯ Linux æ“ä½œç³»ç»Ÿå…·æœ‰ Unix æ“ä½œç³»ç»Ÿçš„å…¨éƒ¨åŠŸèƒ½ï¼Œå¹¶ä¸”èƒ½å¤Ÿåœ¨æ™®é€š PC è®¡ç®—æœºä¸Šå®ç°å…¨éƒ¨çš„ Unix ç‰¹æ€§ï¼Œå¼€æºå…è´¹çš„ç‰¹æ€§ï¼Œæ›´å®¹æ˜“æ™®åŠä½¿ç”¨ï¼\n\n### ä»€ä¹ˆæ˜¯ Linux å†…æ ¸ï¼Ÿ\n\nLinux ç³»ç»Ÿçš„æ ¸å¿ƒæ˜¯å†…æ ¸ã€‚å†…æ ¸æ§åˆ¶ç€è®¡ç®—æœºç³»ç»Ÿä¸Šçš„æ‰€æœ‰ç¡¬ä»¶å’Œè½¯ä»¶ï¼Œåœ¨å¿…è¦æ—¶åˆ†é…ç¡¬ä»¶ï¼Œå¹¶æ ¹æ®éœ€è¦æ‰§è¡Œè½¯ä»¶ã€‚\n\n1. ç³»ç»Ÿå†…å­˜ç®¡ç†\n2. åº”ç”¨ç¨‹åºç®¡ç†\n3. ç¡¬ä»¶è®¾å¤‡ç®¡ç†\n4. æ–‡ä»¶ç³»ç»Ÿç®¡ç†\n\n### Linuxçš„åŸºæœ¬ç»„ä»¶æ˜¯ä»€ä¹ˆï¼Ÿ\n\nå°±åƒä»»ä½•å…¶ä»–å…¸å‹çš„æ“ä½œç³»ç»Ÿä¸€æ ·ï¼ŒLinux æ‹¥æœ‰æ‰€æœ‰è¿™äº›ç»„ä»¶ï¼šå†…æ ¸ï¼Œshell å’Œ GUIï¼Œç³»ç»Ÿå®ç”¨ç¨‹åºå’Œåº”ç”¨ç¨‹åºã€‚Linux æ¯”å…¶ä»–æ“ä½œç³»ç»Ÿæ›´å…·ä¼˜åŠ¿çš„æ˜¯æ¯ä¸ªæ–¹é¢éƒ½é™„å¸¦å…¶ä»–åŠŸèƒ½ï¼Œæ‰€æœ‰ä»£ç éƒ½å¯ä»¥å…è´¹ä¸‹è½½ã€‚\n\n### Linux çš„ä½“ç³»ç»“æ„\n\nä»å¤§çš„æ–¹é¢è®²ï¼ŒLinux ä½“ç³»ç»“æ„å¯ä»¥åˆ†ä¸ºä¸¤å—ï¼š\n\n![Linux ä½“ç³»ç»“æ„](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1RoaW5rV29u,size_16,color_FFFFFF,t_70.png)\n\n- ç”¨æˆ·ç©ºé—´(User Space) ï¼šç”¨æˆ·ç©ºé—´åˆåŒ…æ‹¬ç”¨æˆ·çš„åº”ç”¨ç¨‹åº(User Applications)ã€C åº“(C Library) ã€‚\n- å†…æ ¸ç©ºé—´(Kernel Space) ï¼šå†…æ ¸ç©ºé—´åˆåŒ…æ‹¬ç³»ç»Ÿè°ƒç”¨æ¥å£(System Call Interface)ã€å†…æ ¸(Kernel)ã€å¹³å°æ¶æ„ç›¸å…³çš„ä»£ç (Architecture-Dependent Kernel Code) ã€‚\n\n**ä¸ºä»€ä¹ˆ Linux ä½“ç³»ç»“æ„è¦åˆ†ä¸ºç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´çš„åŸå› ï¼Ÿ**\n\n1. ç°ä»£ CPU å®ç°äº†ä¸åŒçš„å·¥ä½œæ¨¡å¼ï¼Œä¸åŒæ¨¡å¼ä¸‹ CPU å¯ä»¥æ‰§è¡Œçš„æŒ‡ä»¤å’Œè®¿é—®çš„å¯„å­˜å™¨ä¸åŒã€‚\n2. Linux ä» CPU çš„è§’åº¦å‡ºå‘ï¼Œä¸ºäº†ä¿æŠ¤å†…æ ¸çš„å®‰å…¨ï¼ŒæŠŠç³»ç»Ÿåˆ†æˆäº†ä¸¤éƒ¨åˆ†ã€‚\n\nç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´æ˜¯ç¨‹åºæ‰§è¡Œçš„**ä¸¤ç§ä¸åŒçš„çŠ¶æ€**ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼å®Œæˆç”¨æˆ·ç©ºé—´åˆ°å†…æ ¸ç©ºé—´çš„è½¬ç§»ï¼š\n\n1ï¼‰ç³»ç»Ÿè°ƒç”¨ï¼›2ï¼‰ç¡¬ä»¶ä¸­æ–­ã€‚\n\n### BASHå’ŒDOSä¹‹é—´çš„åŸºæœ¬åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\n\nBASH å’Œ DOS æ§åˆ¶å°ä¹‹é—´çš„ä¸»è¦åŒºåˆ«åœ¨äº 3 ä¸ªæ–¹é¢ï¼š\n\n- BASH å‘½ä»¤åŒºåˆ†å¤§å°å†™ï¼Œè€Œ DOS å‘½ä»¤åˆ™ä¸åŒºåˆ†ï¼›\n- åœ¨ BASH ä¸‹ï¼Œ/ character æ˜¯ç›®å½•åˆ†éš”ç¬¦ï¼Œ\\ä½œä¸ºè½¬ä¹‰å­—ç¬¦ã€‚åœ¨ DOS ä¸‹ï¼Œ/ç”¨ä½œå‘½ä»¤å‚æ•°åˆ†éš”ç¬¦ï¼Œ\\æ˜¯ç›®å½•åˆ†éš”ç¬¦ï¼›\n- DOS éµå¾ªå‘½åæ–‡ä»¶ä¸­çš„çº¦å®šï¼Œå³ 8 ä¸ªå­—ç¬¦çš„æ–‡ä»¶ååè·Ÿä¸€ä¸ªç‚¹ï¼Œæ‰©å±•åä¸º 3 ä¸ªå­—ç¬¦ã€‚BASH æ²¡æœ‰éµå¾ªè¿™æ ·çš„æƒ¯ä¾‹ã€‚\n\n### Linux å¼€æœºå¯åŠ¨è¿‡ç¨‹ï¼Ÿ\n\n> äº†è§£å³å¯ã€‚\n\n1ã€ä¸»æœºåŠ ç”µè‡ªæ£€ï¼ŒåŠ è½½ BIOS ç¡¬ä»¶ä¿¡æ¯ã€‚\n\n2ã€è¯»å– MBR çš„å¼•å¯¼æ–‡ä»¶(GRUBã€LILO)ã€‚\n\n3ã€å¼•å¯¼ Linux å†…æ ¸ã€‚\n\n4ã€è¿è¡Œç¬¬ä¸€ä¸ªè¿›ç¨‹ init (è¿›ç¨‹å·æ°¸è¿œä¸º 1 )ã€‚\n\n5ã€è¿›å…¥ç›¸åº”çš„è¿è¡Œçº§åˆ«ã€‚\n\n6ã€è¿è¡Œç»ˆç«¯ï¼Œè¾“å…¥ç”¨æˆ·åå’Œå¯†ç ã€‚\n\n### Linuxç³»ç»Ÿç¼ºçœçš„è¿è¡Œçº§åˆ«ï¼Ÿ\n\n- å…³æœºã€‚\n- å•æœºç”¨æˆ·æ¨¡å¼ã€‚\n- å­—ç¬¦ç•Œé¢çš„å¤šç”¨æˆ·æ¨¡å¼(ä¸æ”¯æŒç½‘ç»œ)ã€‚\n- å­—ç¬¦ç•Œé¢çš„å¤šç”¨æˆ·æ¨¡å¼ã€‚\n- æœªåˆ†é…ä½¿ç”¨ã€‚\n- å›¾å½¢ç•Œé¢çš„å¤šç”¨æˆ·æ¨¡å¼ã€‚\n- é‡å¯ã€‚\n\n### Linux ä½¿ç”¨çš„è¿›ç¨‹é—´é€šä¿¡æ–¹å¼ï¼Ÿ\n\n> äº†è§£å³å¯ï¼Œä¸éœ€è¦å¤ªæ·±å…¥ã€‚\n\n- ç®¡é“(pipe)ã€æµç®¡é“(s_pipe)ã€æœ‰åç®¡é“(FIFO)ã€‚\n- ä¿¡å·(signal) ã€‚\n- æ¶ˆæ¯é˜Ÿåˆ—ã€‚\n- å…±äº«å†…å­˜ã€‚\n- ä¿¡å·é‡ã€‚\n- å¥—æ¥å­—(socket) ã€‚\n\n### Linux æœ‰å“ªäº›ç³»ç»Ÿæ—¥å¿—æ–‡ä»¶ï¼Ÿ\n\næ¯”è¾ƒé‡è¦çš„æ˜¯ `/var/log/messages` æ—¥å¿—æ–‡ä»¶ã€‚\n\nè¯¥æ—¥å¿—æ–‡ä»¶æ˜¯è®¸å¤šè¿›ç¨‹æ—¥å¿—æ–‡ä»¶çš„æ±‡æ€»ï¼Œä»è¯¥æ–‡ä»¶å¯ä»¥çœ‹å‡ºä»»ä½•å…¥ä¾µä¼å›¾æˆ–æˆåŠŸçš„å…¥ä¾µã€‚\n\n### ä»€ä¹ˆæ˜¯äº¤æ¢ç©ºé—´ï¼Ÿ\n\näº¤æ¢ç©ºé—´æ˜¯ Linux ä½¿ç”¨çš„ä¸€å®šç©ºé—´ï¼Œç”¨äºä¸´æ—¶ä¿å­˜ä¸€äº›å¹¶å‘è¿è¡Œçš„ç¨‹åºã€‚å½“ RAM æ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜æ¥å®¹çº³æ­£åœ¨æ‰§è¡Œçš„æ‰€æœ‰ç¨‹åºæ—¶ï¼Œå°±ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚\n\n### ä»€ä¹ˆæ˜¯rootå¸æˆ·\n\nroot å¸æˆ·å°±åƒä¸€ä¸ªç³»ç»Ÿç®¡ç†å‘˜å¸æˆ·ï¼Œå…è®¸ä½ å®Œå…¨æ§åˆ¶ç³»ç»Ÿã€‚ä½ å¯ä»¥åœ¨æ­¤å¤„åˆ›å»ºå’Œç»´æŠ¤ç”¨æˆ·å¸æˆ·ï¼Œä¸ºæ¯ä¸ªå¸æˆ·åˆ†é…ä¸åŒçš„æƒé™ã€‚æ¯æ¬¡å®‰è£… Linux æ—¶éƒ½æ˜¯é»˜è®¤å¸æˆ·ã€‚\n\n### ä»€ä¹ˆæ˜¯LILOï¼Ÿ\n\nLILO æ˜¯ Linux çš„å¼•å¯¼åŠ è½½ç¨‹åºã€‚å®ƒä¸»è¦ç”¨äºå°† Linux æ“ä½œç³»ç»ŸåŠ è½½åˆ°ä¸»å†…å­˜ä¸­ï¼Œä»¥ä¾¿å®ƒå¯ä»¥å¼€å§‹è¿è¡Œã€‚\n\n### ä»€ä¹ˆæ˜¯BASHï¼Ÿ\n\nBASH æ˜¯ Bourne Again SHell çš„ç¼©å†™ã€‚å®ƒç”± Steve Bourne ç¼–å†™ï¼Œä½œä¸ºåŸå§‹ Bourne Shellï¼ˆç”±/ bin / sh è¡¨ç¤ºï¼‰çš„æ›¿ä»£å“ã€‚å®ƒç»“åˆäº†åŸå§‹ç‰ˆæœ¬çš„ Bourne Shell çš„æ‰€æœ‰åŠŸèƒ½ï¼Œä»¥åŠå…¶ä»–åŠŸèƒ½ï¼Œä½¿å…¶æ›´å®¹æ˜“ä½¿ç”¨ã€‚ä»é‚£ä»¥åï¼Œå®ƒå·²è¢«æ”¹ç¼–ä¸ºè¿è¡Œ Linux çš„å¤§å¤šæ•°ç³»ç»Ÿçš„é»˜è®¤ shellã€‚\n\n### ä»€ä¹ˆæ˜¯CLIï¼Ÿ\n\n**å‘½ä»¤è¡Œç•Œé¢**ï¼ˆè‹±è¯­**ï¼šcommand-line interface**ï¼Œç¼©å†™]**ï¼šCLI**ï¼‰æ˜¯åœ¨å›¾å½¢ç”¨æˆ·ç•Œé¢å¾—åˆ°æ™®åŠä¹‹å‰ä½¿ç”¨æœ€ä¸ºå¹¿æ³›çš„ç”¨æˆ·ç•Œé¢ï¼Œå®ƒé€šå¸¸ä¸æ”¯æŒé¼ æ ‡ï¼Œç”¨æˆ·é€šè¿‡é”®ç›˜è¾“å…¥æŒ‡ä»¤ï¼Œè®¡ç®—æœºæ¥æ”¶åˆ°æŒ‡ä»¤åï¼Œäºˆä»¥æ‰§è¡Œã€‚ä¹Ÿæœ‰äººç§°ä¹‹ä¸º**å­—ç¬¦ç”¨æˆ·ç•Œé¢**ï¼ˆCUIï¼‰ã€‚\n\né€šå¸¸è®¤ä¸ºï¼Œå‘½ä»¤è¡Œç•Œé¢ï¼ˆCLIï¼‰æ²¡æœ‰å›¾å½¢ç”¨æˆ·ç•Œé¢ï¼ˆGUIï¼‰é‚£ä¹ˆæ–¹ä¾¿ç”¨æˆ·æ“ä½œã€‚å› ä¸ºï¼Œå‘½ä»¤è¡Œç•Œé¢çš„è½¯ä»¶é€šå¸¸éœ€è¦ç”¨æˆ·è®°å¿†æ“ä½œçš„å‘½ä»¤ï¼Œä½†æ˜¯ï¼Œç”±äºå…¶æœ¬èº«çš„ç‰¹ç‚¹ï¼Œå‘½ä»¤è¡Œç•Œé¢è¦è¾ƒå›¾å½¢ç”¨æˆ·ç•Œé¢èŠ‚çº¦è®¡ç®—æœºç³»ç»Ÿçš„èµ„æºã€‚åœ¨ç†Ÿè®°å‘½ä»¤çš„å‰æä¸‹ï¼Œä½¿ç”¨å‘½ä»¤è¡Œç•Œé¢å¾€å¾€è¦è¾ƒä½¿ç”¨å›¾å½¢ç”¨æˆ·ç•Œé¢çš„æ“ä½œé€Ÿåº¦è¦å¿«ã€‚æ‰€ä»¥ï¼Œå›¾å½¢ç”¨æˆ·ç•Œé¢çš„æ“ä½œç³»ç»Ÿä¸­ï¼Œéƒ½ä¿ç•™ç€å¯é€‰çš„å‘½ä»¤è¡Œç•Œé¢ã€‚\n\n### ä»€ä¹ˆæ˜¯GUIï¼Ÿ\n\nå›¾å½¢ç”¨æˆ·ç•Œé¢ï¼ˆGraphical User Interfaceï¼Œç®€ç§° GUIï¼Œåˆç§°å›¾å½¢ç”¨æˆ·æ¥å£ï¼‰æ˜¯æŒ‡é‡‡ç”¨å›¾å½¢æ–¹å¼æ˜¾ç¤ºçš„è®¡ç®—æœºæ“ä½œç”¨æˆ·ç•Œé¢ã€‚\n\nå›¾å½¢ç”¨æˆ·ç•Œé¢æ˜¯ä¸€ç§äººä¸è®¡ç®—æœºé€šä¿¡çš„ç•Œé¢æ˜¾ç¤ºæ ¼å¼ï¼Œå…è®¸ç”¨æˆ·ä½¿ç”¨é¼ æ ‡ç­‰è¾“å…¥è®¾å¤‡æ“çºµå±å¹•ä¸Šçš„å›¾æ ‡æˆ–èœå•é€‰é¡¹ï¼Œä»¥é€‰æ‹©å‘½ä»¤ã€è°ƒç”¨æ–‡ä»¶ã€å¯åŠ¨ç¨‹åºæˆ–æ‰§è¡Œå…¶å®ƒä¸€äº›æ—¥å¸¸ä»»åŠ¡ã€‚ä¸é€šè¿‡é”®ç›˜è¾“å…¥æ–‡æœ¬æˆ–å­—ç¬¦å‘½ä»¤æ¥å®Œæˆä¾‹è¡Œä»»åŠ¡çš„å­—ç¬¦ç•Œé¢ç›¸æ¯”ï¼Œå›¾å½¢ç”¨æˆ·ç•Œé¢æœ‰è®¸å¤šä¼˜ç‚¹ã€‚\n\n### å¼€æºçš„ä¼˜åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿ\n\nå¼€æºå…è®¸ä½ å°†è½¯ä»¶ï¼ˆåŒ…æ‹¬æºä»£ç ï¼‰å…è´¹åˆ†å‘ç»™ä»»ä½•æ„Ÿå…´è¶£çš„äººã€‚ç„¶åï¼Œäººä»¬å¯ä»¥æ·»åŠ åŠŸèƒ½ï¼Œç”šè‡³å¯ä»¥è°ƒè¯•å’Œæ›´æ­£æºä»£ç ä¸­çš„é”™è¯¯ã€‚å®ƒä»¬ç”šè‡³å¯ä»¥è®©å®ƒè¿è¡Œå¾—æ›´å¥½ï¼Œç„¶åå†æ¬¡è‡ªç”±åœ°é‡æ–°åˆ†é…è¿™äº›å¢å¼ºçš„æºä»£ç ã€‚è¿™æœ€ç»ˆä½¿ç¤¾åŒºä¸­çš„æ¯ä¸ªäººå—ç›Šã€‚\n\n### GNUé¡¹ç›®çš„é‡è¦æ€§æ˜¯ä»€ä¹ˆï¼Ÿ\n\nè¿™ç§æ‰€è°“çš„è‡ªç”±è½¯ä»¶è¿åŠ¨å…·æœ‰å¤šç§ä¼˜åŠ¿ï¼Œä¾‹å¦‚å¯ä»¥è‡ªç”±åœ°è¿è¡Œç¨‹åºä»¥åŠæ ¹æ®ä½ çš„éœ€è¦è‡ªç”±å­¦ä¹ å’Œä¿®æ”¹ç¨‹åºã€‚å®ƒè¿˜å…è®¸ä½ å°†è½¯ä»¶å‰¯æœ¬é‡æ–°åˆ†å‘ç»™å…¶ä»–äººï¼Œä»¥åŠè‡ªç”±æ”¹è¿›è½¯ä»¶å¹¶å°†å…¶å‘å¸ƒç»™å…¬ä¼—ã€‚\n\n## ç£ç›˜ã€ç›®å½•ã€æ–‡ä»¶\n\n### ç®€å• Linux æ–‡ä»¶ç³»ç»Ÿï¼Ÿ\n\n**åœ¨ Linux æ“ä½œç³»ç»Ÿä¸­ï¼Œæ‰€æœ‰è¢«æ“ä½œç³»ç»Ÿç®¡ç†çš„èµ„æºï¼Œä¾‹å¦‚ç½‘ç»œæ¥å£å¡ã€ç£ç›˜é©±åŠ¨å™¨ã€æ‰“å°æœºã€è¾“å…¥è¾“å‡ºè®¾å¤‡ã€æ™®é€šæ–‡ä»¶æˆ–æ˜¯ç›®å½•éƒ½è¢«çœ‹ä½œæ˜¯ä¸€ä¸ªæ–‡ä»¶ã€‚**\n\nä¹Ÿå°±æ˜¯è¯´åœ¨ Linux ç³»ç»Ÿä¸­æœ‰ä¸€ä¸ªé‡è¦çš„æ¦‚å¿µ**ï¼šä¸€åˆ‡éƒ½æ˜¯æ–‡ä»¶**ã€‚å…¶å®è¿™æ˜¯ Unix å“²å­¦çš„ä¸€ä¸ªä½“ç°ï¼Œè€Œ Linux æ˜¯é‡å†™ Unix è€Œæ¥ï¼Œæ‰€ä»¥è¿™ä¸ªæ¦‚å¿µä¹Ÿå°±ä¼ æ‰¿äº†ä¸‹æ¥ã€‚åœ¨ Unix ç³»ç»Ÿä¸­ï¼ŒæŠŠä¸€åˆ‡èµ„æºéƒ½çœ‹ä½œæ˜¯æ–‡ä»¶ï¼ŒåŒ…æ‹¬ç¡¬ä»¶è®¾å¤‡ã€‚UNIX ç³»ç»ŸæŠŠæ¯ä¸ªç¡¬ä»¶éƒ½çœ‹æˆæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œé€šå¸¸ç§°ä¸ºè®¾å¤‡æ–‡ä»¶ï¼Œè¿™æ ·ç”¨æˆ·å°±**å¯ä»¥ç”¨è¯»å†™æ–‡ä»¶çš„æ–¹å¼å®ç°å¯¹ç¡¬ä»¶çš„è®¿é—®**ã€‚\n\nLinux æ”¯æŒ 5 ç§æ–‡ä»¶ç±»å‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n\n![5 ç§æ–‡ä»¶ç±»å‹](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/format,png.png)\n\n### Linux çš„ç›®å½•ç»“æ„æ˜¯æ€æ ·çš„ï¼Ÿ\n\n> è¿™ä¸ªé—®é¢˜ï¼Œä¸€èˆ¬ä¸ä¼šé—®ã€‚æ›´å¤šæ˜¯å®é™…ä½¿ç”¨æ—¶ï¼Œéœ€è¦çŸ¥é“ã€‚\n\nLinux æ–‡ä»¶ç³»ç»Ÿçš„ç»“æ„å±‚æ¬¡é²œæ˜ï¼Œå°±åƒä¸€æ£µå€’ç«‹çš„æ ‘ï¼Œæœ€é¡¶å±‚æ˜¯å…¶æ ¹ç›®å½•ï¼š\n![Linux çš„ç›®å½•ç»“æ„](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/format,png-20230125135806288.png)\n\n**å¸¸è§ç›®å½•è¯´æ˜**ï¼š\n\n- **/bin**ï¼š å­˜æ”¾äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶(ls,cat,mkdir ç­‰)ï¼Œå¸¸ç”¨å‘½ä»¤ä¸€èˆ¬éƒ½åœ¨è¿™é‡Œï¼›\n- **/etc**ï¼š å­˜æ”¾ç³»ç»Ÿç®¡ç†å’Œé…ç½®æ–‡ä»¶ï¼›\n- **/home**ï¼š å­˜æ”¾æ‰€æœ‰ç”¨æˆ·æ–‡ä»¶çš„æ ¹ç›®å½•ï¼Œæ˜¯ç”¨æˆ·ä¸»ç›®å½•çš„åŸºç‚¹ï¼Œæ¯”å¦‚ç”¨æˆ· user çš„ä¸»ç›®å½•å°±æ˜¯/home/userï¼Œå¯ä»¥ç”¨~user è¡¨ç¤ºï¼›\n- **/usr **ï¼š ç”¨äºå­˜æ”¾ç³»ç»Ÿåº”ç”¨ç¨‹åºï¼›\n- **/opt**ï¼š é¢å¤–å®‰è£…çš„å¯é€‰åº”ç”¨ç¨‹åºåŒ…æ‰€æ”¾ç½®çš„ä½ç½®ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ tomcat ç­‰éƒ½å®‰è£…åˆ°è¿™é‡Œï¼›\n- **/proc**ï¼š è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿç›®å½•ï¼Œæ˜¯ç³»ç»Ÿå†…å­˜çš„æ˜ å°„ã€‚å¯ç›´æ¥è®¿é—®è¿™ä¸ªç›®å½•æ¥è·å–ç³»ç»Ÿä¿¡æ¯ï¼›\n- **/root**ï¼š è¶…çº§ç”¨æˆ·ï¼ˆç³»ç»Ÿç®¡ç†å‘˜ï¼‰çš„ä¸»ç›®å½•ï¼ˆç‰¹æƒé˜¶çº§ oï¼‰ï¼›\n- **/sbin:** å­˜æ”¾äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ï¼Œåªæœ‰ root æ‰èƒ½è®¿é—®ã€‚è¿™é‡Œå­˜æ”¾çš„æ˜¯ç³»ç»Ÿç®¡ç†å‘˜ä½¿ç”¨çš„ç³»ç»Ÿçº§åˆ«çš„ç®¡ç†å‘½ä»¤å’Œç¨‹åºã€‚å¦‚ ifconfig ç­‰ï¼›\n- **/dev**ï¼š ç”¨äºå­˜æ”¾è®¾å¤‡æ–‡ä»¶ï¼›\n- **/mnt**ï¼š ç³»ç»Ÿç®¡ç†å‘˜å®‰è£…ä¸´æ—¶æ–‡ä»¶ç³»ç»Ÿçš„å®‰è£…ç‚¹ï¼Œç³»ç»Ÿæä¾›è¿™ä¸ªç›®å½•æ˜¯è®©ç”¨æˆ·ä¸´æ—¶æŒ‚è½½å…¶ä»–çš„æ–‡ä»¶ç³»ç»Ÿï¼›\n- **/boot**ï¼š å­˜æ”¾ç”¨äºç³»ç»Ÿå¼•å¯¼æ—¶ä½¿ç”¨çš„å„ç§æ–‡ä»¶ï¼›\n- **/lib **ï¼š å­˜æ”¾ç€å’Œç³»ç»Ÿè¿è¡Œç›¸å…³çš„åº“æ–‡ä»¶ ï¼›\n- **/tmp**ï¼š ç”¨äºå­˜æ”¾å„ç§ä¸´æ—¶æ–‡ä»¶ï¼Œæ˜¯å…¬ç”¨çš„ä¸´æ—¶æ–‡ä»¶å­˜å‚¨ç‚¹ï¼›\n- **/var**ï¼š ç”¨äºå­˜æ”¾è¿è¡Œæ—¶éœ€è¦æ”¹å˜æ•°æ®çš„æ–‡ä»¶ï¼Œä¹Ÿæ˜¯æŸäº›å¤§æ–‡ä»¶çš„æº¢å‡ºåŒºï¼Œæ¯”æ–¹è¯´å„ç§æœåŠ¡çš„æ—¥å¿—æ–‡ä»¶ï¼ˆç³»ç»Ÿå¯åŠ¨æ—¥å¿—ç­‰ã€‚ï¼‰ç­‰ï¼›\n- **/lost+found**ï¼š è¿™ä¸ªç›®å½•å¹³æ—¶æ˜¯ç©ºçš„ï¼Œç³»ç»Ÿéæ­£å¸¸å…³æœºè€Œç•™ä¸‹â€œæ— å®¶å¯å½’â€çš„æ–‡ä»¶ï¼ˆwindows ä¸‹å«ä»€ä¹ˆ.chkï¼‰å°±åœ¨è¿™é‡Œã€‚\n\n### ä»€ä¹ˆæ˜¯ inode ï¼Ÿ\n\n> ä¸€èˆ¬æ¥è¯´ï¼Œé¢è¯•ä¸ä¼šé—® inode ã€‚ä½†æ˜¯ inode æ˜¯ä¸€ä¸ªé‡è¦æ¦‚å¿µï¼Œæ˜¯ç†è§£ Unix/Linux æ–‡ä»¶ç³»ç»Ÿå’Œç¡¬ç›˜å‚¨å­˜çš„åŸºç¡€ã€‚\n\nç†è§£ inodeï¼Œè¦ä»æ–‡ä»¶å‚¨å­˜è¯´èµ·ã€‚\n\næ–‡ä»¶å‚¨å­˜åœ¨ç¡¬ç›˜ä¸Šï¼Œç¡¬ç›˜çš„æœ€å°å­˜å‚¨å•ä½å«åš\"æ‰‡åŒº\"ï¼ˆSectorï¼‰ã€‚æ¯ä¸ªæ‰‡åŒºå‚¨å­˜ 512 å­—èŠ‚ï¼ˆç›¸å½“äº 0.5KBï¼‰ã€‚\n\næ“ä½œç³»ç»Ÿè¯»å–ç¡¬ç›˜çš„æ—¶å€™ï¼Œä¸ä¼šä¸€ä¸ªä¸ªæ‰‡åŒºåœ°è¯»å–ï¼Œè¿™æ ·æ•ˆç‡å¤ªä½ï¼Œè€Œæ˜¯ä¸€æ¬¡æ€§è¿ç»­è¯»å–å¤šä¸ªæ‰‡åŒºï¼Œå³ä¸€æ¬¡æ€§è¯»å–ä¸€ä¸ª\"å—\"ï¼ˆblockï¼‰ã€‚è¿™ç§ç”±å¤šä¸ªæ‰‡åŒºç»„æˆçš„\"å—\"ï¼Œæ˜¯æ–‡ä»¶å­˜å–çš„æœ€å°å•ä½ã€‚\"å—\"çš„å¤§å°ï¼Œæœ€å¸¸è§çš„æ˜¯ 4KBï¼Œå³è¿ç»­å…«ä¸ª sector ç»„æˆä¸€ä¸ª blockã€‚\n\næ–‡ä»¶æ•°æ®éƒ½å‚¨å­˜åœ¨\"å—\"ä¸­ï¼Œé‚£ä¹ˆå¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬è¿˜å¿…é¡»æ‰¾åˆ°ä¸€ä¸ªåœ°æ–¹å‚¨å­˜æ–‡ä»¶çš„å…ƒä¿¡æ¯ï¼Œæ¯”å¦‚æ–‡ä»¶çš„åˆ›å»ºè€…ã€æ–‡ä»¶çš„åˆ›å»ºæ—¥æœŸã€æ–‡ä»¶çš„å¤§å°ç­‰ç­‰ã€‚è¿™ç§å‚¨å­˜æ–‡ä»¶å…ƒä¿¡æ¯çš„åŒºåŸŸå°±å«åš inodeï¼Œä¸­æ–‡è¯‘åä¸º\"ç´¢å¼•èŠ‚ç‚¹\"ã€‚\n\næ¯ä¸€ä¸ªæ–‡ä»¶éƒ½æœ‰å¯¹åº”çš„ inodeï¼Œé‡Œé¢åŒ…å«äº†ä¸è¯¥æ–‡ä»¶æœ‰å…³çš„ä¸€äº›ä¿¡æ¯ã€‚\n\n**ç®€è¿° Linux æ–‡ä»¶ç³»ç»Ÿé€šè¿‡ i èŠ‚ç‚¹æŠŠæ–‡ä»¶çš„é€»è¾‘ç»“æ„å’Œç‰©ç†ç»“æ„è½¬æ¢çš„å·¥ä½œè¿‡ç¨‹ï¼Ÿ**\n\n> å¦‚æœçœ‹çš„ä¸€è„¸æ‡µé€¼ï¼Œä¹Ÿæ²¡å…³ç³»ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œé¢è¯•å®˜ä¸å¤ªä¼šé—®è¿™ä¸ªé¢˜ç›®ã€‚\n\nLinux é€šè¿‡ inode èŠ‚ç‚¹è¡¨å°†æ–‡ä»¶çš„é€»è¾‘ç»“æ„å’Œç‰©ç†ç»“æ„è¿›è¡Œè½¬æ¢ã€‚\n\n- inode èŠ‚ç‚¹æ˜¯ä¸€ä¸ª 64 å­—èŠ‚é•¿çš„è¡¨ï¼Œè¡¨ä¸­åŒ…å«äº†æ–‡ä»¶çš„ç›¸å…³ä¿¡æ¯ï¼Œå…¶ä¸­æœ‰æ–‡ä»¶çš„å¤§å°ã€æ–‡ä»¶æ‰€æœ‰è€…ã€æ–‡ä»¶çš„å­˜å–è®¸å¯æ–¹å¼ä»¥åŠæ–‡ä»¶çš„ç±»å‹ç­‰é‡è¦ä¿¡æ¯ã€‚åœ¨ inode èŠ‚ç‚¹è¡¨ä¸­æœ€é‡è¦çš„å†…å®¹æ˜¯ç£ç›˜åœ°å€è¡¨ã€‚åœ¨ç£ç›˜åœ°å€è¡¨ä¸­æœ‰ 13 ä¸ªå—å·ï¼Œæ–‡ä»¶å°†ä»¥å—å·åœ¨ç£ç›˜åœ°å€è¡¨ä¸­å‡ºç°çš„é¡ºåºä¾æ¬¡è¯»å–ç›¸åº”çš„å—ã€‚\n- Linux æ–‡ä»¶ç³»ç»Ÿé€šè¿‡æŠŠ inode èŠ‚ç‚¹å’Œæ–‡ä»¶åè¿›è¡Œè¿æ¥ï¼Œå½“éœ€è¦è¯»å–è¯¥æ–‡ä»¶æ—¶ï¼Œæ–‡ä»¶ç³»ç»Ÿåœ¨å½“å‰ç›®å½•è¡¨ä¸­æŸ¥æ‰¾è¯¥æ–‡ä»¶åå¯¹åº”çš„é¡¹ï¼Œç”±æ­¤å¾—åˆ°è¯¥æ–‡ä»¶ç›¸å¯¹åº”çš„ inode èŠ‚ç‚¹å·ï¼Œé€šè¿‡è¯¥ inode èŠ‚ç‚¹çš„ç£ç›˜åœ°å€è¡¨æŠŠåˆ†æ•£å­˜æ”¾çš„æ–‡ä»¶ç‰©ç†å—è¿æ¥æˆæ–‡ä»¶çš„é€»è¾‘ç»“æ„ã€‚\n\n### ä»€ä¹ˆæ˜¯ç¡¬é“¾æ¥å’Œè½¯é“¾æ¥ï¼Ÿ\n\n1ï¼‰ç¡¬é“¾æ¥\n\nç”±äº Linux ä¸‹çš„æ–‡ä»¶æ˜¯é€šè¿‡ç´¢å¼•èŠ‚ç‚¹(inode)æ¥è¯†åˆ«æ–‡ä»¶ï¼Œç¡¬é“¾æ¥å¯ä»¥è®¤ä¸ºæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘æ–‡ä»¶ç´¢å¼•èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œç³»ç»Ÿå¹¶ä¸ä¸ºå®ƒé‡æ–°åˆ†é… inode ã€‚æ¯æ·»åŠ ä¸€ä¸ªä¸€ä¸ªç¡¬é“¾æ¥ï¼Œæ–‡ä»¶çš„é“¾æ¥æ•°å°±åŠ  1 ã€‚\n\n- ä¸è¶³ï¼š1ï¼‰ä¸å¯ä»¥åœ¨ä¸åŒæ–‡ä»¶ç³»ç»Ÿçš„æ–‡ä»¶é—´å»ºç«‹é“¾æ¥ï¼›2ï¼‰åªæœ‰è¶…çº§ç”¨æˆ·æ‰å¯ä»¥ä¸ºç›®å½•åˆ›å»ºç¡¬é“¾æ¥ã€‚\n\n2ï¼‰è½¯é“¾æ¥\n\nè½¯é“¾æ¥å…‹æœäº†ç¡¬é“¾æ¥çš„ä¸è¶³ï¼Œæ²¡æœ‰ä»»ä½•æ–‡ä»¶ç³»ç»Ÿçš„é™åˆ¶ï¼Œä»»ä½•ç”¨æˆ·å¯ä»¥åˆ›å»ºæŒ‡å‘ç›®å½•çš„ç¬¦å·é“¾æ¥ã€‚å› è€Œç°åœ¨æ›´ä¸ºå¹¿æ³›ä½¿ç”¨ï¼Œå®ƒå…·æœ‰æ›´å¤§çš„çµæ´»æ€§ï¼Œç”šè‡³å¯ä»¥è·¨è¶Šä¸åŒæœºå™¨ã€ä¸åŒç½‘ç»œå¯¹æ–‡ä»¶è¿›è¡Œé“¾æ¥ã€‚\n\n- ä¸è¶³ï¼šå› ä¸ºé“¾æ¥æ–‡ä»¶åŒ…å«æœ‰åŸæ–‡ä»¶çš„è·¯å¾„ä¿¡æ¯ï¼Œæ‰€ä»¥å½“åŸæ–‡ä»¶ä»ä¸€ä¸ªç›®å½•ä¸‹ç§»åˆ°å…¶ä»–ç›®å½•ä¸­ï¼Œå†è®¿é—®é“¾æ¥æ–‡ä»¶ï¼Œç³»ç»Ÿå°±æ‰¾ä¸åˆ°äº†ï¼Œè€Œç¡¬é“¾æ¥å°±æ²¡æœ‰è¿™ä¸ªç¼ºé™·ï¼Œä½ æƒ³æ€ä¹ˆç§»å°±æ€ä¹ˆç§»ï¼›è¿˜æœ‰å®ƒè¦ç³»ç»Ÿåˆ†é…é¢å¤–çš„ç©ºé—´ç”¨äºå»ºç«‹æ–°çš„ç´¢å¼•èŠ‚ç‚¹å’Œä¿å­˜åŸæ–‡ä»¶çš„è·¯å¾„ã€‚\n\n**å®é™…åœºæ™¯ä¸‹ï¼ŒåŸºæœ¬æ˜¯ä½¿ç”¨è½¯é“¾æ¥**ã€‚æ€»ç»“åŒºåˆ«å¦‚ä¸‹ï¼š\n\n- ç¡¬é“¾æ¥ä¸å¯ä»¥è·¨åˆ†åŒºï¼Œè½¯ä»¶é“¾å¯ä»¥è·¨åˆ†åŒºã€‚\n- ç¡¬é“¾æ¥æŒ‡å‘ä¸€ä¸ª inode èŠ‚ç‚¹ï¼Œè€Œè½¯é“¾æ¥åˆ™æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„ inode èŠ‚ç‚¹ã€‚\n- åˆ é™¤ç¡¬é“¾æ¥æ–‡ä»¶ï¼Œä¸ä¼šåˆ é™¤åŸæ–‡ä»¶ï¼Œåˆ é™¤è½¯é“¾æ¥æ–‡ä»¶ï¼Œä¼šæŠŠåŸæ–‡ä»¶åˆ é™¤ã€‚\n\n### RAID æ˜¯ä»€ä¹ˆ?\n\n> RAID å…¨ç§°ä¸ºç‹¬ç«‹ç£ç›˜å†—ä½™é˜µåˆ—(Redundant Array of Independent Disks)ï¼ŒåŸºæœ¬æ€æƒ³å°±æ˜¯æŠŠå¤šä¸ªç›¸å¯¹ä¾¿å®œçš„ç¡¬ç›˜ç»„åˆèµ·æ¥ï¼Œæˆä¸ºä¸€ä¸ªç¡¬ç›˜é˜µåˆ—ç»„ï¼Œä½¿æ€§èƒ½è¾¾åˆ°ç”šè‡³è¶…è¿‡ä¸€ä¸ªä»·æ ¼æ˜‚è´µã€ å®¹é‡å·¨å¤§çš„ç¡¬ç›˜ã€‚RAID é€šå¸¸è¢«ç”¨åœ¨æœåŠ¡å™¨ç”µè„‘ä¸Šï¼Œä½¿ç”¨å®Œå…¨ç›¸åŒçš„ç¡¬ç›˜ç»„æˆä¸€ä¸ªé€»è¾‘æ‰‡åŒºï¼Œå› æ­¤æ“ä½œç³»ç»Ÿåªä¼šæŠŠå®ƒå½“åšä¸€ä¸ªç¡¬ç›˜ã€‚\n>\n> RAID åˆ†ä¸ºä¸åŒçš„ç­‰çº§ï¼Œå„ä¸ªä¸åŒçš„ç­‰çº§å‡åœ¨æ•°æ®å¯é æ€§åŠè¯»å†™æ€§èƒ½ä¸Šåšäº†ä¸åŒçš„æƒè¡¡ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¯ä»¥ä¾æ®è‡ªå·±çš„å®é™…éœ€æ±‚é€‰æ‹©ä¸åŒçš„ RAID æ–¹æ¡ˆã€‚\n\nå½“ç„¶ï¼Œå› ä¸ºå¾ˆå¤šå…¬å¸éƒ½ä½¿ç”¨äº‘æœåŠ¡ï¼Œå¤§å®¶å¾ˆéš¾æ¥è§¦åˆ° RAID è¿™ä¸ªæ¦‚å¿µï¼Œæ›´å¤šçš„å¯èƒ½æ˜¯æ™®é€šäº‘ç›˜ã€SSD äº‘ç›˜é…±ç´«çš„æ¦‚å¿µã€‚\n\n## å®‰å…¨\n\n### ä¸€å° Linux ç³»ç»Ÿåˆå§‹åŒ–ç¯å¢ƒåéœ€è¦åšä¸€äº›ä»€ä¹ˆå®‰å…¨å·¥ä½œï¼Ÿ\n\n1ã€æ·»åŠ æ™®é€šç”¨æˆ·ç™»é™†ï¼Œç¦æ­¢ root ç”¨æˆ·ç™»é™†ï¼Œæ›´æ”¹ SSH ç«¯å£å·ã€‚\n\n> ä¿®æ”¹ SSH ç«¯å£ä¸ä¸€å®šç»å¯¹å“ˆã€‚å½“ç„¶ï¼Œå¦‚æœè¦æš´éœ²åœ¨å¤–ç½‘ï¼Œå»ºè®®æ”¹ä¸‹ã€‚l\n\n2ã€æœåŠ¡å™¨ä½¿ç”¨å¯†é’¥ç™»é™†ï¼Œç¦æ­¢å¯†ç ç™»é™†ã€‚\n\n3ã€å¼€å¯é˜²ç«å¢™ï¼Œå…³é—­ SElinux ï¼Œæ ¹æ®ä¸šåŠ¡éœ€æ±‚è®¾ç½®ç›¸åº”çš„é˜²ç«å¢™è§„åˆ™ã€‚\n\n4ã€è£… fail2ban è¿™ç§é˜²æ­¢ SSH æš´åŠ›ç ´å‡»çš„è½¯ä»¶ã€‚\n\n5ã€è®¾ç½®åªå…è®¸å…¬å¸åŠå…¬ç½‘å‡ºå£ IP èƒ½ç™»é™†æœåŠ¡å™¨(çœ‹å…¬å¸å®é™…éœ€è¦)\n\n> ä¹Ÿå¯ä»¥å®‰è£… VPN ç­‰è½¯ä»¶ï¼Œåªå…è®¸è¿æ¥ VPN åˆ°æœåŠ¡å™¨ä¸Šã€‚\n\n6ã€ä¿®æ”¹å†å²å‘½ä»¤è®°å½•çš„æ¡æ•°ä¸º 10 æ¡ã€‚\n\n7ã€åªå…è®¸æœ‰éœ€è¦çš„æœåŠ¡å™¨å¯ä»¥è®¿é—®å¤–ç½‘ï¼Œå…¶å®ƒå…¨éƒ¨ç¦æ­¢ã€‚\n\n8ã€åšå¥½è½¯ä»¶å±‚é¢çš„é˜²æŠ¤ã€‚\n\n- 8.1 è®¾ç½® nginx_waf æ¨¡å—é˜²æ­¢ SQL æ³¨å…¥ã€‚\n- 8.2 æŠŠ Web æœåŠ¡ä½¿ç”¨ www ç”¨æˆ·å¯åŠ¨ï¼Œæ›´æ”¹ç½‘ç«™ç›®å½•çš„æ‰€æœ‰è€…å’Œæ‰€å±ç»„ä¸º www ã€‚\n\n### ä»€ä¹ˆå« CC æ”»å‡»ï¼Ÿä»€ä¹ˆå« DDOS æ”»å‡»ï¼Ÿ\n\n- CC æ”»å‡»ï¼Œä¸»è¦æ˜¯ç”¨æ¥æ”»å‡»é¡µé¢çš„ï¼Œæ¨¡æ‹Ÿå¤šä¸ªç”¨æˆ·ä¸åœçš„å¯¹ä½ çš„é¡µé¢è¿›è¡Œè®¿é—®ï¼Œä»è€Œä½¿ä½ çš„ç³»ç»Ÿèµ„æºæ¶ˆè€—æ®†å°½ã€‚\n\n- DDOS æ”»å‡»ï¼Œä¸­æ–‡åå«åˆ†å¸ƒå¼æ‹’ç»æœåŠ¡æ”»å‡»ï¼ŒæŒ‡å€ŸåŠ©æœåŠ¡å™¨æŠ€æœ¯å°†å¤šä¸ªè®¡ç®—æœºè”åˆèµ·æ¥ä½œä¸ºæ”»å‡»å¹³å°ï¼Œæ¥å¯¹ä¸€ä¸ªæˆ–å¤šä¸ªç›®æ ‡å‘åŠ¨ DDOS æ”»å‡»ã€‚\n\n\t> æ”»å‡»ï¼Œå³æ˜¯é€šè¿‡å¤§é‡åˆæ³•çš„è¯·æ±‚å ç”¨å¤§é‡ç½‘ç»œèµ„æºï¼Œä»¥è¾¾åˆ°ç˜«ç—ªç½‘ç»œçš„ç›®çš„ã€‚\n\n**æ€ä¹ˆé¢„é˜² CC æ”»å‡»å’Œ DDOS æ”»å‡»ï¼Ÿ**\n\né˜² CCã€DDOS æ”»å‡»ï¼Œè¿™äº›åªèƒ½æ˜¯ç”¨ç¡¬ä»¶é˜²ç«å¢™åšæµé‡æ¸…æ´—ï¼Œå°†æ”»å‡»æµé‡å¼•å…¥é»‘æ´ã€‚\n\n> æµé‡æ¸…æ´—è¿™ä¸€å—ï¼Œä¸»è¦æ˜¯ä¹° ISP æœåŠ¡å•†çš„é˜²æ”»å‡»çš„æœåŠ¡å°±å¯ä»¥ï¼Œæœºæˆ¿ä¸€èˆ¬æœ‰ç©ºä½™æµé‡ï¼Œæˆ‘ä»¬ä¸€èˆ¬æ˜¯ä¹°æœåŠ¡ï¼Œæ¯•ç«Ÿæ”»å‡»ä¸ä¼šæ˜¯æŒç»­é•¿æ—¶é—´ã€‚\n\n### ä»€ä¹ˆæ˜¯ç½‘ç«™æ•°æ®åº“æ³¨å…¥ï¼Ÿ\n\n- ç”±äºç¨‹åºå‘˜çš„æ°´å¹³åŠç»éªŒå‚å·®ä¸é½ï¼Œå¤§éƒ¨åˆ†ç¨‹åºå‘˜åœ¨ç¼–å†™ä»£ç çš„æ—¶å€™ï¼Œæ²¡æœ‰å¯¹ç”¨æˆ·è¾“å…¥æ•°æ®çš„åˆæ³•æ€§è¿›è¡Œåˆ¤æ–­ã€‚\n- åº”ç”¨ç¨‹åºå­˜åœ¨å®‰å…¨éšæ‚£ã€‚ç”¨æˆ·å¯ä»¥æäº¤ä¸€æ®µæ•°æ®åº“æŸ¥è¯¢ä»£ç ï¼Œæ ¹æ®ç¨‹åºè¿”å›çš„ç»“æœï¼Œè·å¾—æŸäº›ä»–æƒ³å¾—çŸ¥çš„æ•°æ®ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„ SQL æ³¨å…¥ã€‚\n- SQL æ³¨å…¥ï¼Œæ˜¯ä»æ­£å¸¸çš„ WWW ç«¯å£è®¿é—®ï¼Œè€Œä¸”è¡¨é¢çœ‹èµ·æ¥è·Ÿä¸€èˆ¬çš„ Web é¡µé¢è®¿é—®æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œå¦‚æœç®¡ç†å‘˜æ²¡æŸ¥çœ‹æ—¥å¿—çš„ä¹ æƒ¯ï¼Œå¯èƒ½è¢«å…¥ä¾µå¾ˆé•¿æ—¶é—´éƒ½ä¸ä¼šå‘è§‰ã€‚\n\n**å¦‚ä½•è¿‡æ»¤ä¸é¢„é˜²ï¼Ÿ**\n\næ•°æ®åº“ç½‘é¡µç«¯æ³¨å…¥è¿™ç§ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ nginx_waf åšè¿‡æ»¤ä¸é¢„é˜²ã€‚\n\n## Shell\n\n### Shell è„šæœ¬æ˜¯ä»€ä¹ˆï¼Ÿ\n\nä¸€ä¸ª Shell è„šæœ¬æ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼ŒåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå‘½ä»¤ã€‚ä½œä¸ºç³»ç»Ÿç®¡ç†å‘˜ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦ä½¿ç”¨å¤šä¸ªå‘½ä»¤æ¥å®Œæˆä¸€é¡¹ä»»åŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ è¿™äº›æ‰€æœ‰å‘½ä»¤åœ¨ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶(Shell è„šæœ¬)æ¥å®Œæˆè¿™äº›æ—¥å¸¸å·¥ä½œä»»åŠ¡ã€‚\n\n**ä»€ä¹ˆæ˜¯é»˜è®¤ç™»å½• Shell ï¼Ÿ**\n\nåœ¨ Linux æ“ä½œç³»ç»Ÿï¼Œ`\"/bin/bash\"` æ˜¯é»˜è®¤ç™»å½• Shellï¼Œæ˜¯åœ¨åˆ›å»ºç”¨æˆ·æ—¶åˆ†é…çš„ã€‚\n\nä½¿ç”¨ chsh å‘½ä»¤å¯ä»¥æ”¹å˜é»˜è®¤çš„ Shell ã€‚ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºï¼š\n\n```bash\nchsh <ç”¨æˆ·å> -s <æ–°shell>\nchsh ThinkWon -s /bin/sh\n```\n\n**åœ¨ Shell è„šæœ¬ä¸­ï¼Œå¦‚ä½•å†™å…¥æ³¨é‡Šï¼Ÿ**\n\næ³¨é‡Šå¯ä»¥ç”¨æ¥æè¿°ä¸€ä¸ªè„šæœ¬å¯ä»¥åšä»€ä¹ˆå’Œå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚æ¯ä¸€è¡Œæ³¨é‡Šä»¥ `#` å¼€å¤´ã€‚ä¾‹å­å¦‚ä¸‹ï¼š\n\n```bash\n#!/bin/bash\n# This is a command\necho â€œI am logged in as $USERâ€\n```\n\n### è¯­æ³•çº§\n\n#### å¯ä»¥åœ¨ Shell è„šæœ¬ä¸­ä½¿ç”¨å“ªäº›ç±»å‹çš„å˜é‡ï¼Ÿ\n\nåœ¨ Shell è„šæœ¬ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸¤ç§ç±»å‹çš„å˜é‡ï¼š\n\n- ç³»ç»Ÿå®šä¹‰å˜é‡\n\n\t> ç³»ç»Ÿå˜é‡æ˜¯ç”±ç³»ç»Ÿç³»ç»Ÿè‡ªå·±åˆ›å»ºçš„ã€‚è¿™äº›å˜é‡é€šå¸¸ç”±å¤§å†™å­—æ¯ç»„æˆï¼Œå¯ä»¥é€šè¿‡ `set` å‘½ä»¤æŸ¥çœ‹ã€‚\n\n- ç”¨æˆ·å®šä¹‰å˜é‡\n\n\t> ç”¨æˆ·å˜é‡ç”±ç³»ç»Ÿç”¨æˆ·æ¥ç”Ÿæˆå’Œå®šä¹‰ï¼Œå˜é‡çš„å€¼å¯ä»¥é€šè¿‡å‘½ä»¤ `\"echo $<å˜é‡å>\"` æŸ¥çœ‹ã€‚\n\n**Shellè„šæœ¬ä¸­ $? æ ‡è®°çš„ç”¨é€”æ˜¯ä»€ä¹ˆï¼Ÿ**\n\nåœ¨å†™ä¸€ä¸ª Shell è„šæœ¬æ—¶ï¼Œå¦‚æœä½ æƒ³è¦æ£€æŸ¥å‰ä¸€å‘½ä»¤æ˜¯å¦æ‰§è¡ŒæˆåŠŸï¼Œåœ¨ `if` æ¡ä»¶ä¸­ä½¿ç”¨ `$?` å¯ä»¥æ¥æ£€æŸ¥å‰ä¸€å‘½ä»¤çš„ç»“æŸçŠ¶æ€ã€‚\n\n- å¦‚æœç»“æŸçŠ¶æ€æ˜¯ 0 ï¼Œè¯´æ˜å‰ä¸€ä¸ªå‘½ä»¤æ‰§è¡ŒæˆåŠŸã€‚ä¾‹å¦‚ï¼š\n\n\t```bash\n\troot@localhost:~## ls /usr/bin/shar\n\t/usr/bin/shar\n\troot@localhost:~## echo $?\n\t0\n\t```\n\n- å¦‚æœç»“æŸçŠ¶æ€ä¸æ˜¯ 0ï¼Œè¯´æ˜å‘½ä»¤æ‰§è¡Œå¤±è´¥ã€‚ä¾‹å¦‚ï¼š\n\n\t```bash\n\troot@localhost:~## ls /usr/bin/share\n\tls: cannot access /usr/bin/share: No such file or directory\n\troot@localhost:~## echo $?\n\t2\n\t```\n\n**Bourne Shell(bash) ä¸­æœ‰å“ªäº›ç‰¹æ®Šçš„å˜é‡ï¼Ÿ**\n\nä¸‹é¢çš„è¡¨åˆ—å‡ºäº† Bourne Shell ä¸ºå‘½ä»¤è¡Œè®¾ç½®çš„ç‰¹æ®Šå˜é‡ã€‚\n\n```bash\nå†…å»ºå˜é‡    è§£é‡Š\n$0    å‘½ä»¤è¡Œä¸­çš„è„šæœ¬åå­—\n$1    ç¬¬ä¸€ä¸ªå‘½ä»¤è¡Œå‚æ•°\n$2    ç¬¬äºŒä¸ªå‘½ä»¤è¡Œå‚æ•°\nâ€¦..    â€¦â€¦.\n$9    ç¬¬ä¹ä¸ªå‘½ä»¤è¡Œå‚æ•°\n$##    å‘½ä»¤è¡Œå‚æ•°çš„æ•°é‡\n$*    æ‰€æœ‰å‘½ä»¤è¡Œå‚æ•°ï¼Œä»¥ç©ºæ ¼éš”å¼€\n```\n\n**å¦‚ä½•å–æ¶ˆå˜é‡æˆ–å–æ¶ˆå˜é‡èµ‹å€¼ï¼Ÿ**\n\n`unset` å‘½ä»¤ç”¨äºå–æ¶ˆå˜é‡æˆ–å–æ¶ˆå˜é‡èµ‹å€¼ã€‚è¯­æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š\n\n```bash\n## unset <å˜é‡å>\n```\n\n#### Shell è„šæœ¬ä¸­ `if` è¯­æ³•å¦‚ä½•åµŒå¥—?\n\n```bash\nif [ æ¡ä»¶ ]\nthen\nå‘½ä»¤1\nå‘½ä»¤2\nâ€¦..\nelse\nif [ æ¡ä»¶ ]\nthen\nå‘½ä»¤1\nå‘½ä»¤2\nâ€¦.\nelse\nå‘½ä»¤1\nå‘½ä»¤2\nâ€¦..\nfi\nfi\n```\n\n**åœ¨ Shell è„šæœ¬ä¸­å¦‚ä½•æ¯”è¾ƒä¸¤ä¸ªæ•°å­—ï¼Ÿ**\n\nåœ¨ `if-then` ä¸­ä½¿ç”¨æµ‹è¯•å‘½ä»¤ï¼ˆ `-gt` ç­‰ï¼‰æ¥æ¯”è¾ƒä¸¤ä¸ªæ•°å­—ã€‚ä¾‹å¦‚ï¼š\n\n```bash\n#!/bin/bash\nx=10\ny=20\nif [ $x -gt $y ]\nthen\necho â€œx is greater than yâ€\nelse\necho â€œy is greater than xâ€\nfi\n```\n\n#### Shell è„šæœ¬ä¸­ `case` è¯­å¥çš„è¯­æ³•?\n\nåŸºç¡€è¯­æ³•å¦‚ä¸‹ï¼š\n\n```bash\ncase å˜é‡ in\nå€¼1)\nå‘½ä»¤1\nå‘½ä»¤2\nâ€¦..\næœ€åå‘½ä»¤\n!!\nå€¼2)\nå‘½ä»¤1\nå‘½ä»¤2\nâ€¦â€¦\næœ€åå‘½ä»¤\n;;\nesac\n```\n\n#### Shell è„šæœ¬ä¸­ `for` å¾ªç¯è¯­æ³•ï¼Ÿ\n\nåŸºç¡€è¯­æ³•å¦‚ä¸‹ï¼š\n\n```bash\nfor å˜é‡ in å¾ªç¯åˆ—è¡¨\ndo\nå‘½ä»¤1\nå‘½ä»¤2\nâ€¦.\næœ€åå‘½ä»¤\ndone\n```\n\n#### Shell è„šæœ¬ä¸­ `while` å¾ªç¯è¯­æ³•ï¼Ÿ\n\nå¦‚åŒ `for` å¾ªç¯ï¼Œ`while` å¾ªç¯åªè¦æ¡ä»¶æˆç«‹å°±é‡å¤å®ƒçš„å‘½ä»¤å—ã€‚\nä¸åŒäº `for`å¾ªç¯ï¼Œ`while` å¾ªç¯ä¼šä¸æ–­è¿­ä»£ï¼Œç›´åˆ°å®ƒçš„æ¡ä»¶ä¸ä¸ºçœŸã€‚\n\nåŸºç¡€è¯­æ³•ï¼š\n\n```bash\nwhile [ æ¡ä»¶ ]\ndo\nå‘½ä»¤â€¦\ndone\n```\n\n**do-while è¯­å¥çš„åŸºæœ¬æ ¼å¼ï¼Ÿ**\n\n`do-while` è¯­å¥ç±»ä¼¼äº `while` è¯­å¥ï¼Œä½†æ£€æŸ¥æ¡ä»¶è¯­å¥ä¹‹å‰å…ˆæ‰§è¡Œå‘½ä»¤ï¼ˆLCTT è¯‘æ³¨ï¼šæ„å³è‡³å°‘æ‰§è¡Œä¸€æ¬¡ã€‚ï¼‰ã€‚ä¸‹é¢æ˜¯ç”¨ `do-while` è¯­å¥çš„è¯­æ³•ï¼š\n\n```bash\ndo\n{\nå‘½ä»¤\n} while (æ¡ä»¶)\n```\n\n**Shell è„šæœ¬ä¸­ break å‘½ä»¤çš„ä½œç”¨ï¼Ÿ**\n\n`break` å‘½ä»¤ä¸€ä¸ªç®€å•çš„ç”¨é€”æ˜¯é€€å‡ºæ‰§è¡Œä¸­çš„å¾ªç¯ã€‚æˆ‘ä»¬å¯ä»¥åœ¨ `while` å’Œ `until` å¾ªç¯ä¸­ä½¿ç”¨ `break` å‘½ä»¤è·³å‡ºå¾ªç¯ã€‚\n\n**Shell è„šæœ¬ä¸­ continue å‘½ä»¤çš„ä½œç”¨ï¼Ÿ**\n\n`continue` å‘½ä»¤ä¸åŒäº `break` å‘½ä»¤ï¼Œå®ƒåªè·³å‡ºå½“å‰å¾ªç¯çš„è¿­ä»£ï¼Œè€Œä¸æ˜¯æ•´ä¸ªå¾ªç¯ã€‚`continue` å‘½ä»¤å¾ˆå¤šæ—¶å€™æ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œä¾‹å¦‚é”™è¯¯å‘ç”Ÿï¼Œä½†æˆ‘ä»¬ä¾ç„¶å¸Œæœ›ç»§ç»­æ‰§è¡Œå¤§å¾ªç¯çš„æ—¶å€™ã€‚\n\n#### å¦‚ä½•ä½¿è„šæœ¬å¯æ‰§è¡Œ?\n\nä½¿ç”¨ chmod å‘½ä»¤æ¥ä½¿è„šæœ¬å¯æ‰§è¡Œã€‚ä¾‹å­å¦‚ä¸‹ï¼š`chmod a+x myscript.sh` ã€‚\n\n**#!/bin/bash çš„ä½œç”¨ï¼Ÿ**\n\n`#!/bin/bash` æ˜¯ Shell è„šæœ¬çš„ç¬¬ä¸€è¡Œï¼Œç§°ä¸ºé‡Šä¼´ï¼ˆshebangï¼‰è¡Œã€‚\n\n- è¿™é‡Œ `#` ç¬¦å·å«åš hash ï¼Œè€Œ `!` å«åš bangã€‚\n- å®ƒçš„æ„æ€æ˜¯å‘½ä»¤é€šè¿‡ `/bin/bash` æ¥æ‰§è¡Œã€‚\n\n**å¦‚ä½•è°ƒè¯• Shellè„šæœ¬ï¼Ÿ**\n\n- ä½¿ç”¨ `-x'` æ•°ï¼ˆ`sh -x myscript.sh`ï¼‰å¯ä»¥è°ƒè¯• Shell è„šæœ¬ã€‚\n- å¦ä¸€ä¸ªç§æ–¹æ³•æ˜¯ä½¿ç”¨ `-nv` å‚æ•°(`sh -nv myscript.sh`)ã€‚\n\n**å¦‚ä½•å°†æ ‡å‡†è¾“å‡ºå’Œé”™è¯¯è¾“å‡ºåŒæ—¶é‡å®šå‘åˆ°åŒä¸€ä½ç½®?**\n\n- æ–¹æ³•ä¸€ï¼š`2>&1 (å¦‚## ls /usr/share/doc > out.txt 2>&1 )` ã€‚\n- æ–¹æ³•äºŒï¼š`&> (å¦‚## ls /usr/share/doc &> out.txt )` ã€‚\n\n**åœ¨ Shell è„šæœ¬ä¸­ï¼Œå¦‚ä½•æµ‹è¯•æ–‡ä»¶ï¼Ÿ**\n\ntest å‘½ä»¤å¯ä»¥ç”¨æ¥æµ‹è¯•æ–‡ä»¶ã€‚åŸºç¡€ç”¨æ³•å¦‚ä¸‹è¡¨æ ¼ï¼š\n\n```bash\nTest         ç”¨æ³•\n-d æ–‡ä»¶å    å¦‚æœæ–‡ä»¶å­˜åœ¨å¹¶ä¸”æ˜¯ç›®å½•ï¼Œè¿”å›true\n-e æ–‡ä»¶å    å¦‚æœæ–‡ä»¶å­˜åœ¨ï¼Œè¿”å›true\n-f æ–‡ä»¶å    å¦‚æœæ–‡ä»¶å­˜åœ¨å¹¶ä¸”æ˜¯æ™®é€šæ–‡ä»¶ï¼Œè¿”å›true\n-r æ–‡ä»¶å    å¦‚æœæ–‡ä»¶å­˜åœ¨å¹¶å¯è¯»ï¼Œè¿”å›true\n-s æ–‡ä»¶å    å¦‚æœæ–‡ä»¶å­˜åœ¨å¹¶ä¸”ä¸ä¸ºç©ºï¼Œè¿”å›true\n-w æ–‡ä»¶å    å¦‚æœæ–‡ä»¶å­˜åœ¨å¹¶å¯å†™ï¼Œè¿”å›true\n-x æ–‡ä»¶å    å¦‚æœæ–‡ä»¶å­˜åœ¨å¹¶å¯æ‰§è¡Œï¼Œè¿”å›true\n```\n\n#### åœ¨ Shell è„šæœ¬å¦‚ä½•å®šä¹‰å‡½æ•°å‘¢ï¼Ÿ\n\nå‡½æ•°æ˜¯æ‹¥æœ‰åå­—çš„ä»£ç å—ã€‚å½“æˆ‘ä»¬å®šä¹‰ä»£ç å—ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨æˆ‘ä»¬çš„è„šæœ¬è°ƒç”¨å‡½æ•°åå­—ï¼Œè¯¥å—å°±ä¼šè¢«æ‰§è¡Œã€‚ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºï¼š\n\n```bash\n$ diskusage () { df -h ; }\nè¯‘æ³¨ï¼šä¸‹é¢æ˜¯æˆ‘ç»™çš„shellå‡½æ•°è¯­æ³•ï¼ŒåŸæ–‡æ²¡æœ‰\n[ function ] å‡½æ•°å [()]\n{\nå‘½ä»¤;\n[return int;]\n}\n```\n\n**å¦‚ä½•è®© Shell å°±è„šæœ¬å¾—åˆ°æ¥è‡ªç»ˆç«¯çš„è¾“å…¥?**\n\nread å‘½ä»¤å¯ä»¥è¯»å–æ¥è‡ªç»ˆç«¯ï¼ˆä½¿ç”¨é”®ç›˜ï¼‰çš„æ•°æ®ã€‚read å‘½ä»¤å¾—åˆ°ç”¨æˆ·çš„è¾“å…¥å¹¶ç½®äºä½ ç»™å‡ºçš„å˜é‡ä¸­ã€‚ä¾‹å­å¦‚ä¸‹ï¼š\n\n```bash\n## vi /tmp/test.sh\n#!/bin/bash\necho â€˜Please enter your nameâ€™\nread name\necho â€œMy Name is $nameâ€\n## ./test.sh\nPlease enter your name\nThinkWon\nMy Name is ThinkWon\n```\n\n**å¦‚ä½•æ‰§è¡Œç®—æœ¯è¿ç®—ï¼Ÿ**\n\næœ‰ä¸¤ç§æ–¹æ³•æ¥æ‰§è¡Œç®—æœ¯è¿ç®—ï¼š\n\n- 1ã€ä½¿ç”¨ expr å‘½ä»¤ï¼š`## expr 5 + 2` ã€‚\n- 2ã€ç”¨ä¸€ä¸ªç¾å…ƒç¬¦å·å’Œæ–¹æ‹¬å·ï¼ˆ`$[ è¡¨è¾¾å¼ ]`ï¼‰ï¼š`test=$[16 + 4] ; test=$[16 + 4]` ã€‚\n\n### ç¼–ç¨‹é¢˜\n\n#### åˆ¤æ–­ä¸€æ–‡ä»¶æ˜¯ä¸æ˜¯å­—ç¬¦è®¾å¤‡æ–‡ä»¶ï¼Œå¦‚æœæ˜¯å°†å…¶æ‹·è´åˆ° `/dev` ç›®å½•ä¸‹ï¼Ÿ\n\n```bash\n#!/bin/bash\nread -p \"Input file name: \" FILENAME\nif [ -c \"$FILENAME\" ];then\nã€€ã€€cp $FILENAME /dev\nfi\n```\n\n#### æ·»åŠ ä¸€ä¸ªæ–°ç»„ä¸º class1 ï¼Œç„¶åæ·»åŠ å±äºè¿™ä¸ªç»„çš„ 30 ä¸ªç”¨æˆ·ï¼Œç”¨æˆ·åçš„å½¢å¼ä¸º stdxx ï¼Œå…¶ä¸­ xx ä» 01 åˆ° 30 ï¼Ÿ\n\n```bash\n#!/bin/bash\ngroupadd class1\nfor((i=1;i<31;i++))\ndo\n        if [ $i -le 10 ];then\n                useradd -g class1 std0$i\n        else\n                useradd -g class1 std$i\n        fi\ndone\n```\n\n**ç¼–å†™ Shell ç¨‹åºï¼Œå®ç°è‡ªåŠ¨åˆ é™¤ 50 ä¸ªè´¦å·çš„åŠŸèƒ½ï¼Œè´¦å·åä¸ºstud1 è‡³ stud50 ï¼Ÿ**\n\n```bash\n#!/bin/bash\nfor((i=1;i<51;i++))\ndo\n                userdel -r stud$i\ndone\n```\n\n#### å†™ä¸€ä¸ª sed å‘½ä»¤ï¼Œä¿®æ”¹ `/tmp/input.txt` æ–‡ä»¶çš„å†…å®¹ï¼Ÿ\n\nè¦æ±‚ï¼š\n\n- åˆ é™¤æ‰€æœ‰ç©ºè¡Œã€‚\n- ä¸€è¡Œä¸­ï¼Œå¦‚æœåŒ…å« â€œ11111â€ï¼Œåˆ™åœ¨ â€œ11111â€ å‰é¢æ’å…¥ â€œAAAâ€ï¼Œåœ¨ â€œ11111â€ åé¢æ’å…¥ â€œBBBâ€ ã€‚æ¯”å¦‚ï¼šå°†å†…å®¹ä¸º 0000111112222 çš„ä¸€è¡Œæ”¹ä¸º 0000AAA11111BBB2222 ã€‚\n\n```bash\n[root@~]## cat -n /tmp/input.txt\n     1  000011111222\n     2\n     3  000011111222222\n     4  11111000000222\n     5\n     6\n     7  111111111111122222222222\n     8  2211111111\n     9  112222222\n    10  1122\n    11\n\n## åˆ é™¤æ‰€æœ‰ç©ºè¡Œå‘½ä»¤\n[root@~]## sed '/^$/d' /tmp/input.txt\n000011111222\n000011111222222\n11111000000222\n111111111111122222222222\n2211111111\n112222222\n1122\n\n## æ’å…¥æŒ‡å®šçš„å­—ç¬¦\n[root@~]## sed 's#\\(11111\\)#AAA\\1BBB#g' /tmp/input.txt\n0000AAA11111BBB222\n0000AAA11111BBB222222\nAAA11111BBB000000222\nAAA11111BBBAAA11111BBB11122222222222\n22AAA11111BBB111\n112222222\n1122\n```\n\n## å®æˆ˜\n\n### å¦‚ä½•é€‰æ‹© Linux æ“ä½œç³»ç»Ÿç‰ˆæœ¬?\n\nä¸€èˆ¬æ¥è®²ï¼Œæ¡Œé¢ç”¨æˆ·é¦–é€‰ Ubuntu ï¼›æœåŠ¡å™¨é¦–é€‰ RHEL æˆ– CentOS ï¼Œä¸¤è€…ä¸­é¦–é€‰ CentOS ã€‚\n\næ ¹æ®å…·ä½“è¦æ±‚ï¼š\n\n- å®‰å…¨æ€§è¦æ±‚è¾ƒé«˜ï¼Œåˆ™é€‰æ‹© Debian æˆ–è€… FreeBSD ã€‚\n\n- éœ€è¦ä½¿ç”¨æ•°æ®åº“é«˜çº§æœåŠ¡å’Œç”µå­é‚®ä»¶ç½‘ç»œåº”ç”¨çš„ç”¨æˆ·å¯ä»¥é€‰æ‹© SUSE ã€‚\n\n- æƒ³è¦æ–°æŠ€æœ¯æ–°åŠŸèƒ½å¯ä»¥é€‰æ‹© Feddora ï¼ŒFeddora æ˜¯ RHEL å’Œ CentOS çš„ä¸€ä¸ªæµ‹è¯•ç‰ˆå’Œé¢„å‘å¸ƒç‰ˆæœ¬ã€‚\n\n- ã€é‡ç‚¹ã€‘**æ ¹æ®ç°æœ‰çŠ¶å†µï¼Œç»å¤§å¤šæ•°äº’è”ç½‘å…¬å¸é€‰æ‹© CentOS ã€‚ç°åœ¨æ¯”è¾ƒå¸¸ç”¨çš„æ˜¯ 6 ç³»åˆ—ï¼Œç°åœ¨å¸‚åœºå æœ‰å¤§æ¦‚ä¸€åŠå·¦å³ã€‚å¦å¤–çš„åŸå› æ˜¯ CentOS æ›´ä¾§é‡æœåŠ¡å™¨é¢†åŸŸï¼Œå¹¶ä¸”æ— ç‰ˆæƒçº¦æŸ**ã€‚\n\n\t> CentOS 7 ç³»åˆ—ï¼Œä¹Ÿæ…¢æ…¢ä½¿ç”¨çš„ä¼šæ¯”è¾ƒå¤šäº†ã€‚\n\n### å¦‚ä½•è§„åˆ’ä¸€å° Linux ä¸»æœºï¼Œæ­¥éª¤æ˜¯æ€æ ·ï¼Ÿ\n\n1ã€ç¡®å®šæœºå™¨æ˜¯åšä»€ä¹ˆç”¨çš„ï¼Œæ¯”å¦‚æ˜¯åš WEB ã€DBã€è¿˜æ˜¯æ¸¸æˆæœåŠ¡å™¨ã€‚\n\n> ä¸åŒçš„ç”¨é€”ï¼Œæœºå™¨çš„é…ç½®ä¼šæœ‰æ‰€ä¸åŒã€‚\n\n2ã€ç¡®å®šå¥½ä¹‹åï¼Œå°±è¦å®šç³»ç»Ÿéœ€è¦æ€ä¹ˆå®‰è£…ï¼Œé»˜è®¤å®‰è£…å“ªäº›ç³»ç»Ÿã€åˆ†åŒºæ€ä¹ˆåšã€‚\n\n3ã€éœ€è¦ä¼˜åŒ–ç³»ç»Ÿçš„å“ªäº›å‚æ•°ï¼Œéœ€è¦åˆ›å»ºå“ªäº›ç”¨æˆ·ç­‰ç­‰çš„ã€‚\n\n### è¯·é—®å½“ç”¨æˆ·åé¦ˆç½‘ç«™è®¿é—®æ…¢ï¼Œä½ ä¼šå¦‚ä½•å¤„ç†ï¼Ÿ\n\n**æœ‰å“ªäº›æ–¹é¢çš„å› ç´ ä¼šå¯¼è‡´ç½‘ç«™ç½‘ç«™è®¿é—®æ…¢ï¼Ÿ**\n\n1ã€æœåŠ¡å™¨å‡ºå£å¸¦å®½ä¸å¤Ÿç”¨\n\n> - æœ¬èº«æœåŠ¡å™¨è´­ä¹°çš„å‡ºå£å¸¦å®½æ¯”è¾ƒå°ã€‚ä¸€æ—¦å¹¶å‘é‡å¤§çš„è¯ï¼Œå°±ä¼šé€ æˆåˆ†ç»™æ¯ä¸ªç”¨æˆ·çš„å‡ºå£å¸¦å®½å°±å°ï¼Œè®¿é—®é€Ÿåº¦è‡ªç„¶å°±ä¼šæ…¢ã€‚\n> - è·¨è¿è¥å•†ç½‘ç»œå¯¼è‡´å¸¦å®½ç¼©å‡ã€‚ä¾‹å¦‚ï¼Œå…¬å¸ç½‘ç«™æ”¾åœ¨ç”µä¿¡çš„ç½‘ç»œä¸Šï¼Œé‚£ä¹ˆå®¢æˆ·è¿™è¾¹å¯¹æ¥æ˜¯é•¿åŸå®½å¸¦æˆ–è”é€šï¼Œè¿™ä¹Ÿå¯èƒ½å¯¼è‡´å¸¦å®½çš„ç¼©å‡ã€‚\n\n2ã€æœåŠ¡å™¨è´Ÿè½½è¿‡å¤§ï¼Œå¯¼è‡´å“åº”ä¸è¿‡æ¥\n\n> å¯ä»¥ä»ä¸¤ä¸ªæ–¹é¢å…¥æ‰‹åˆ†æï¼š\n>\n> - åˆ†æç³»ç»Ÿè´Ÿè½½ï¼Œä½¿ç”¨ w å‘½ä»¤æˆ–è€… uptime å‘½ä»¤æŸ¥çœ‹ç³»ç»Ÿè´Ÿè½½ã€‚å¦‚æœè´Ÿè½½å¾ˆé«˜ï¼Œåˆ™ä½¿ç”¨ top å‘½ä»¤æŸ¥çœ‹ CPU ï¼ŒMEM ç­‰å ç”¨æƒ…å†µï¼Œè¦ä¹ˆæ˜¯ CPU ç¹å¿™ï¼Œè¦ä¹ˆæ˜¯å†…å­˜ä¸å¤Ÿã€‚\n> - å¦‚æœè¿™äºŒè€…éƒ½æ­£å¸¸ï¼Œå†å»ä½¿ç”¨ sar å‘½ä»¤åˆ†æç½‘å¡æµé‡ï¼Œåˆ†ææ˜¯ä¸æ˜¯é­åˆ°äº†æ”»å‡»ã€‚ä¸€æ—¦åˆ†æå‡ºé—®é¢˜çš„åŸå› ï¼Œé‡‡å–å¯¹åº”çš„æªæ–½è§£å†³ï¼Œå¦‚å†³å®šè¦ä¸è¦æ€æ­»ä¸€äº›è¿›ç¨‹ï¼Œæˆ–è€…ç¦æ­¢ä¸€äº›è®¿é—®ç­‰ã€‚\n\n3ã€æ•°æ®åº“ç“¶é¢ˆ\n\n> - å¦‚æœæ…¢æŸ¥è¯¢æ¯”è¾ƒå¤šã€‚é‚£ä¹ˆå°±è¦å¼€å‘äººå‘˜æˆ– DBA ååŠ©è¿›è¡Œ SQL è¯­å¥çš„ä¼˜åŒ–ã€‚\n> - å¦‚æœæ•°æ®åº“å“åº”æ…¢ï¼Œè€ƒè™‘å¯ä»¥åŠ ä¸€ä¸ªæ•°æ®åº“ç¼“å­˜ï¼Œå¦‚ Redis ç­‰ã€‚ç„¶åï¼Œä¹Ÿå¯ä»¥æ­å»º MySQL ä¸»ä»ï¼Œä¸€å° MySQL æœåŠ¡å™¨è´Ÿè´£å†™ï¼Œå…¶ä»–å‡ å°ä»æ•°æ®åº“è´Ÿè´£è¯»ã€‚\n\n4ã€ç½‘ç«™å¼€å‘ä»£ç æ²¡æœ‰ä¼˜åŒ–å¥½\n\n> - ä¾‹å¦‚ SQL è¯­å¥æ²¡æœ‰ä¼˜åŒ–ï¼Œå¯¼è‡´æ•°æ®åº“è¯»å†™ç›¸å½“è€—æ—¶ã€‚\n\n**é’ˆå¯¹ç½‘ç«™è®¿é—®æ…¢ï¼Œæ€ä¹ˆå»æ’æŸ¥ï¼Ÿ**\n\n1ã€é¦–å…ˆè¦ç¡®å®šæ˜¯ç”¨æˆ·ç«¯è¿˜æ˜¯æœåŠ¡ç«¯çš„é—®é¢˜ã€‚å½“æ¥åˆ°ç”¨æˆ·åé¦ˆè®¿é—®æ…¢ï¼Œé‚£è¾¹è‡ªå·±ç«‹å³è®¿é—®ç½‘ç«™çœ‹çœ‹ï¼Œå¦‚æœè‡ªå·±è¿™è¾¹è®¿é—®å¿«ï¼ŒåŸºæœ¬æ–­å®šæ˜¯ç”¨æˆ·ç«¯é—®é¢˜ï¼Œå°±éœ€è¦è€å¿ƒè·Ÿå®¢æˆ·è§£é‡Šï¼ŒååŠ©å®¢æˆ·è§£å†³é—®é¢˜ã€‚\n\n> ä¸è¦ä¸Šæ¥å°±çœ‹æœåŠ¡ç«¯çš„é—®é¢˜ã€‚ä¸€å®šè¦ä»æºå¤´å¼€å§‹ï¼Œé€æ­¥é€æ­¥å¾€ä¸‹ã€‚\n\n2ã€å¦‚æœè®¿é—®ä¹Ÿæ…¢ï¼Œé‚£ä¹ˆå¯ä»¥åˆ©ç”¨æµè§ˆå™¨çš„è°ƒè¯•åŠŸèƒ½ï¼Œçœ‹çœ‹åŠ è½½é‚£ä¸€é¡¹æ•°æ®æ¶ˆè€—æ—¶é—´è¿‡å¤šï¼Œæ˜¯å›¾ç‰‡åŠ è½½æ…¢ï¼Œè¿˜æ˜¯æŸäº›æ•°æ®åŠ è½½æ…¢ã€‚\n\n3ã€é’ˆå¯¹æœåŠ¡å™¨è´Ÿè½½æƒ…å†µã€‚æŸ¥çœ‹æœåŠ¡å™¨ç¡¬ä»¶(ç½‘ç»œã€CPUã€å†…å­˜)çš„æ¶ˆè€—æƒ…å†µã€‚å¦‚æœæ˜¯è´­ä¹°çš„äº‘ä¸»æœºï¼Œæ¯”å¦‚é˜¿é‡Œäº‘ï¼Œå¯ä»¥ç™»å½•é˜¿é‡Œäº‘å¹³å°æä¾›å„æ–¹é¢çš„ç›‘æ§ï¼Œæ¯”å¦‚ CPUã€å†…å­˜ã€å¸¦å®½çš„ä½¿ç”¨æƒ…å†µã€‚\n\n4ã€å¦‚æœå‘ç°ç¡¬ä»¶èµ„æºæ¶ˆè€—éƒ½ä¸é«˜ï¼Œé‚£ä¹ˆå°±éœ€è¦é€šè¿‡æŸ¥æ—¥å¿—ï¼Œæ¯”å¦‚çœ‹çœ‹ MySQL æ…¢æŸ¥è¯¢çš„æ—¥å¿—ï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯æŸæ¡ SQL è¯­å¥æŸ¥è¯¢æ…¢ï¼Œå¯¼è‡´ç½‘ç«™è®¿é—®æ…¢ã€‚\n\n**æ€ä¹ˆå»è§£å†³ï¼Ÿ**\n\n1ã€å¦‚æœæ˜¯å‡ºå£å¸¦å®½é—®é¢˜ï¼Œé‚£ä¹ˆä¹…ç”³è¯·åŠ å¤§å‡ºå£å¸¦å®½ã€‚\n\n2ã€å¦‚æœæ…¢æŸ¥è¯¢æ¯”è¾ƒå¤šï¼Œé‚£ä¹ˆå°±è¦å¼€å‘äººå‘˜æˆ– DBA ååŠ©è¿›è¡Œ SQL è¯­å¥çš„ä¼˜åŒ–ã€‚\n\n3ã€å¦‚æœæ•°æ®åº“å“åº”æ…¢ï¼Œè€ƒè™‘å¯ä»¥åŠ ä¸€ä¸ªæ•°æ®åº“ç¼“å­˜ï¼Œå¦‚ Redis ç­‰ç­‰ã€‚ç„¶åä¹Ÿå¯ä»¥æ­å»º MySQL ä¸»ä»ï¼Œä¸€å° MySQL æœåŠ¡å™¨è´Ÿè´£å†™ï¼Œå…¶ä»–å‡ å°ä»æ•°æ®åº“è´Ÿè´£è¯»ã€‚\n\n4ã€ç”³è¯·è´­ä¹° CDN æœåŠ¡ï¼ŒåŠ è½½ç”¨æˆ·çš„è®¿é—®ã€‚\n\n5ã€å¦‚æœè®¿é—®è¿˜æ¯”è¾ƒæ…¢ï¼Œé‚£å°±éœ€è¦ä»æ•´ä½“æ¶æ„ä¸Šè¿›è¡Œä¼˜åŒ–å’¯ã€‚åšåˆ°ä¸“è§’è‰²ä¸“ç”¨ï¼Œå¤šå°æœåŠ¡å™¨æä¾›åŒä¸€ä¸ªæœåŠ¡ã€‚\n\n### Linux æ€§èƒ½è°ƒä¼˜éƒ½æœ‰å“ªå‡ ç§æ–¹æ³•ï¼Ÿ\n\n1ã€Disabling daemons (å…³é—­ daemons)ã€‚\n\n2ã€Shutting down the GUI (å…³é—­ GUI)ã€‚\n\n3ã€Changing kernel parameters (æ”¹å˜å†…æ ¸å‚æ•°)ã€‚\n\n4ã€Kernel parameters (å†…æ ¸å‚æ•°)ã€‚\n\n5ã€Tuning the processor subsystem (å¤„ç†å™¨å­ç³»ç»Ÿè°ƒä¼˜)ã€‚\n\n6ã€Tuning the memory subsystem (å†…å­˜å­ç³»ç»Ÿè°ƒä¼˜)ã€‚\n\n7ã€Tuning the file system (æ–‡ä»¶ç³»ç»Ÿå­ç³»ç»Ÿè°ƒä¼˜)ã€‚\n\n8ã€Tuning the network subsystemï¼ˆç½‘ç»œå­ç³»ç»Ÿè°ƒä¼˜)ã€‚\n\n## æ–‡ä»¶ç®¡ç†å‘½ä»¤\n\n### cat å‘½ä»¤\n\ncat å‘½ä»¤ç”¨äºè¿æ¥æ–‡ä»¶å¹¶æ‰“å°åˆ°æ ‡å‡†è¾“å‡ºè®¾å¤‡ä¸Šã€‚\n\ncat ä¸»è¦æœ‰ä¸‰å¤§åŠŸèƒ½ï¼š\n\n1ã€ä¸€æ¬¡æ˜¾ç¤ºæ•´ä¸ªæ–‡ä»¶:\n\n```sh\ncat filename\n```\n\n2ã€ä»é”®ç›˜åˆ›å»ºä¸€ä¸ªæ–‡ä»¶:\n\n```shell\ncat > filename\n```\n\nåªèƒ½åˆ›å»ºæ–°æ–‡ä»¶ï¼Œä¸èƒ½ç¼–è¾‘å·²æœ‰æ–‡ä»¶ã€‚\n\n3ã€å°†å‡ ä¸ªæ–‡ä»¶åˆå¹¶ä¸ºä¸€ä¸ªæ–‡ä»¶ï¼š\n\n```shell\ncat file1 file2 > file\n```\n\n- -b å¯¹éç©ºè¾“å‡ºè¡Œå·\n- -n è¾“å‡ºæ‰€æœ‰è¡Œå·\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰æŠŠ log2012.log çš„æ–‡ä»¶å†…å®¹åŠ ä¸Šè¡Œå·åè¾“å…¥ log2013.log è¿™ä¸ªæ–‡ä»¶é‡Œ\n\n```shell\ncat -n log2012.log > log2013.log\n```\n\nï¼ˆ2ï¼‰æŠŠ log2012.log å’Œ log2013.log çš„æ–‡ä»¶å†…å®¹åŠ ä¸Šè¡Œå·ï¼ˆç©ºç™½è¡Œä¸åŠ ï¼‰ä¹‹åå°†å†…å®¹é™„åŠ åˆ° log.log é‡Œ\n\n```shell\ncat -b log2012.log log2013.log > log.log\n```\n\n### chmod å‘½ä»¤\n\nLinux/Unix çš„æ–‡ä»¶è°ƒç”¨æƒé™åˆ†ä¸ºä¸‰çº§ : æ–‡ä»¶æ‹¥æœ‰è€…ã€ç¾¤ç»„ã€å…¶ä»–ã€‚åˆ©ç”¨ chmod å¯ä»¥æ§åˆ¶æ–‡ä»¶å¦‚ä½•è¢«ä»–äººæ‰€è°ƒç”¨ã€‚\n\nç”¨äºæ”¹å˜ linux ç³»ç»Ÿæ–‡ä»¶æˆ–ç›®å½•çš„è®¿é—®æƒé™ã€‚ç”¨å®ƒæ§åˆ¶æ–‡ä»¶æˆ–ç›®å½•çš„è®¿é—®æƒé™ã€‚è¯¥å‘½ä»¤æœ‰ä¸¤ç§ç”¨æ³•ã€‚ä¸€ç§æ˜¯åŒ…å«å­—æ¯å’Œæ“ä½œç¬¦è¡¨è¾¾å¼çš„æ–‡å­—è®¾å®šæ³•ï¼›å¦ä¸€ç§æ˜¯åŒ…å«æ•°å­—çš„æ•°å­—è®¾å®šæ³•ã€‚\n\næ¯ä¸€æ–‡ä»¶æˆ–ç›®å½•çš„è®¿é—®æƒé™éƒ½æœ‰ä¸‰ç»„ï¼Œæ¯ç»„ç”¨ä¸‰ä½è¡¨ç¤ºï¼Œåˆ†åˆ«ä¸ºæ–‡ä»¶**å±ä¸»**çš„è¯»ã€å†™å’Œæ‰§è¡Œæƒé™ï¼›ä¸å±ä¸»**åŒç»„**çš„ç”¨æˆ·çš„è¯»ã€å†™å’Œæ‰§è¡Œæƒé™ï¼›ç³»ç»Ÿä¸­**å…¶ä»–ç”¨æˆ·**çš„è¯»ã€å†™å’Œæ‰§è¡Œæƒé™ã€‚å¯ä½¿ç”¨ ls -l test.txt æŸ¥æ‰¾ã€‚\n\nä»¥æ–‡ä»¶ log2012.log ä¸ºä¾‹ï¼š\n\n```shell\n-rw-r--r-- 1 root root 296K 11-13 06:03 log2012.log\n```\n\nç¬¬ä¸€åˆ—å…±æœ‰ 10 ä¸ªä½ç½®ï¼Œç¬¬ä¸€ä¸ªå­—ç¬¦æŒ‡å®šäº†æ–‡ä»¶ç±»å‹ã€‚åœ¨é€šå¸¸æ„ä¹‰ä¸Šï¼Œä¸€ä¸ªç›®å½•ä¹Ÿæ˜¯ä¸€ä¸ªæ–‡ä»¶ã€‚å¦‚æœç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯æ¨ªçº¿ï¼Œè¡¨ç¤ºæ˜¯ä¸€ä¸ªéç›®å½•çš„æ–‡ä»¶ã€‚å¦‚æœæ˜¯ dï¼Œè¡¨ç¤ºæ˜¯ä¸€ä¸ªç›®å½•ã€‚ä»ç¬¬äºŒä¸ªå­—ç¬¦å¼€å§‹åˆ°ç¬¬åä¸ª 9 ä¸ªå­—ç¬¦ï¼Œ3 ä¸ªå­—ç¬¦ä¸€ç»„ï¼Œåˆ†åˆ«è¡¨ç¤ºäº† 3 ç»„ç”¨æˆ·å¯¹æ–‡ä»¶æˆ–è€…ç›®å½•çš„æƒé™ã€‚æƒé™å­—ç¬¦ç”¨æ¨ªçº¿ä»£è¡¨ç©ºè®¸å¯ï¼Œr ä»£è¡¨åªè¯»(4)ï¼Œw ä»£è¡¨å†™(2)ï¼Œx ä»£è¡¨å¯æ‰§è¡Œ(1)ã€‚\n\n**å¸¸ç”¨å‚æ•°**ï¼š\n\n```\n-c å½“å‘ç”Ÿæ”¹å˜æ—¶ï¼ŒæŠ¥å‘Šå¤„ç†ä¿¡æ¯\n-R å¤„ç†æŒ‡å®šç›®å½•ä»¥åŠå…¶å­ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶\n```\n\næƒé™èŒƒå›´ï¼š\n\n```\nu ï¼šç›®å½•æˆ–è€…æ–‡ä»¶çš„å½“å‰çš„ç”¨æˆ·\ng ï¼šç›®å½•æˆ–è€…æ–‡ä»¶çš„å½“å‰çš„ç¾¤ç»„\no ï¼šé™¤äº†ç›®å½•æˆ–è€…æ–‡ä»¶çš„å½“å‰ç”¨æˆ·æˆ–ç¾¤ç»„ä¹‹å¤–çš„ç”¨æˆ·æˆ–è€…ç¾¤ç»„\na ï¼šæ‰€æœ‰çš„ç”¨æˆ·åŠç¾¤ç»„\n```\n\næƒé™ä»£å·ï¼š\n\n```\nr ï¼šè¯»æƒé™ï¼Œç”¨æ•°å­—4è¡¨ç¤º\nw ï¼šå†™æƒé™ï¼Œç”¨æ•°å­—2è¡¨ç¤º\nx ï¼šæ‰§è¡Œæƒé™ï¼Œç”¨æ•°å­—1è¡¨ç¤º\n- ï¼šåˆ é™¤æƒé™ï¼Œç”¨æ•°å­—0è¡¨ç¤º\ns ï¼šç‰¹æ®Šæƒé™\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰å¢åŠ æ–‡ä»¶ t.log æ‰€æœ‰ç”¨æˆ·å¯æ‰§è¡Œæƒé™\n\n```shell\nchmod a+x t.log\n```\n\nï¼ˆ2ï¼‰æ’¤é”€åŸæ¥æ‰€æœ‰çš„æƒé™ï¼Œç„¶åä½¿æ‹¥æœ‰è€…å…·æœ‰å¯è¯»æƒé™,å¹¶è¾“å‡ºå¤„ç†ä¿¡æ¯\n\n```shell\nchmod u=r t.log -c\n```\n\nï¼ˆ3ï¼‰ç»™ file çš„å±ä¸»åˆ†é…è¯»ã€å†™ã€æ‰§è¡Œ(7)çš„æƒé™ï¼Œç»™ file çš„æ‰€åœ¨ç»„åˆ†é…è¯»ã€æ‰§è¡Œ(5)çš„æƒé™ï¼Œç»™å…¶ä»–ç”¨æˆ·åˆ†é…æ‰§è¡Œ(1)çš„æƒé™\n\n```shell\nchmod 751 t.log -cï¼ˆæˆ–è€…ï¼šchmod u=rwx,g=rx,o=x t.log -c\n```\n\nï¼ˆ4ï¼‰å°† test ç›®å½•åŠå…¶å­ç›®å½•æ‰€æœ‰æ–‡ä»¶æ·»åŠ å¯è¯»æƒé™\n\n```shell\nchmod u+r,g+r,o+r -R text/ -c\n```\n\n### chown å‘½ä»¤\n\nchown å°†æŒ‡å®šæ–‡ä»¶çš„æ‹¥æœ‰è€…æ”¹ä¸ºæŒ‡å®šçš„ç”¨æˆ·æˆ–ç»„ï¼Œç”¨æˆ·å¯ä»¥æ˜¯ç”¨æˆ·åæˆ–è€…ç”¨æˆ· IDï¼›ç»„å¯ä»¥æ˜¯ç»„åæˆ–è€…ç»„ IDï¼›æ–‡ä»¶æ˜¯ä»¥ç©ºæ ¼åˆ†å¼€çš„è¦æ”¹å˜æƒé™çš„æ–‡ä»¶åˆ—è¡¨ï¼Œæ”¯æŒé€šé…ç¬¦ã€‚\n\n```\n-c æ˜¾ç¤ºæ›´æ”¹çš„éƒ¨åˆ†çš„ä¿¡æ¯\n-R å¤„ç†æŒ‡å®šç›®å½•åŠå­ç›®å½•\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰æ”¹å˜æ‹¥æœ‰è€…å’Œç¾¤ç»„ å¹¶æ˜¾ç¤ºæ”¹å˜ä¿¡æ¯\n\n```shell\nchown -c mail:mail log2012.log\n```\n\nï¼ˆ2ï¼‰æ”¹å˜æ–‡ä»¶ç¾¤ç»„\n\n```shell\nchown -c :mail t.log\n```\n\nï¼ˆ3ï¼‰æ”¹å˜æ–‡ä»¶å¤¹åŠå­æ–‡ä»¶ç›®å½•å±ä¸»åŠå±ç»„ä¸º mail\n\n```shell\nchown -cR mail: test/\n```\n\n### cp å‘½ä»¤\n\nå°†æºæ–‡ä»¶å¤åˆ¶è‡³ç›®æ ‡æ–‡ä»¶ï¼Œæˆ–å°†å¤šä¸ªæºæ–‡ä»¶å¤åˆ¶è‡³ç›®æ ‡ç›®å½•ã€‚\n\næ³¨æ„ï¼šå‘½ä»¤è¡Œå¤åˆ¶ï¼Œå¦‚æœç›®æ ‡æ–‡ä»¶å·²ç»å­˜åœ¨ä¼šæç¤ºæ˜¯å¦è¦†ç›–ï¼Œè€Œåœ¨ shell è„šæœ¬ä¸­ï¼Œå¦‚æœä¸åŠ  -i å‚æ•°ï¼Œåˆ™ä¸ä¼šæç¤ºï¼Œè€Œæ˜¯ç›´æ¥è¦†ç›–ï¼\n\n```\n-i æç¤º\n-r å¤åˆ¶ç›®å½•åŠç›®å½•å†…æ‰€æœ‰é¡¹ç›®\n-a å¤åˆ¶çš„æ–‡ä»¶ä¸åŸæ–‡ä»¶æ—¶é—´ä¸€æ ·\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰å¤åˆ¶ a.txt åˆ° test ç›®å½•ä¸‹ï¼Œä¿æŒåŸæ–‡ä»¶æ—¶é—´ï¼Œå¦‚æœåŸæ–‡ä»¶å­˜åœ¨æç¤ºæ˜¯å¦è¦†ç›–ã€‚\n\n```shell\ncp -ai a.txt test\n```\n\nï¼ˆ2ï¼‰ä¸º a.txt å»ºè®®ä¸€ä¸ªé“¾æ¥ï¼ˆå¿«æ·æ–¹å¼ï¼‰\n\n```shell\ncp -s a.txt link_a.txt\n```\n\n### find å‘½ä»¤\n\nç”¨äºåœ¨æ–‡ä»¶æ ‘ä¸­æŸ¥æ‰¾æ–‡ä»¶ï¼Œå¹¶ä½œå‡ºç›¸åº”çš„å¤„ç†ã€‚\n\nå‘½ä»¤æ ¼å¼ï¼š\n\n```shell\nfind pathname -options [-print -exec -ok ...]\n```\n\nå‘½ä»¤å‚æ•°ï¼š\n\n```\npathname: findå‘½ä»¤æ‰€æŸ¥æ‰¾çš„ç›®å½•è·¯å¾„ã€‚ä¾‹å¦‚ç”¨.æ¥è¡¨ç¤ºå½“å‰ç›®å½•ï¼Œç”¨/æ¥è¡¨ç¤ºç³»ç»Ÿæ ¹ç›®å½•ã€‚\n-printï¼š findå‘½ä»¤å°†åŒ¹é…çš„æ–‡ä»¶è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºã€‚\n-execï¼š findå‘½ä»¤å¯¹åŒ¹é…çš„æ–‡ä»¶æ‰§è¡Œè¯¥å‚æ•°æ‰€ç»™å‡ºçš„shellå‘½ä»¤ã€‚ç›¸åº”å‘½ä»¤çš„å½¢å¼ä¸º'command' {  } \\;ï¼Œæ³¨æ„{   }å’Œ\\ï¼›ä¹‹é—´çš„ç©ºæ ¼ã€‚\n-okï¼š å’Œ-execçš„ä½œç”¨ç›¸åŒï¼Œåªä¸è¿‡ä»¥ä¸€ç§æ›´ä¸ºå®‰å…¨çš„æ¨¡å¼æ¥æ‰§è¡Œè¯¥å‚æ•°æ‰€ç»™å‡ºçš„shellå‘½ä»¤ï¼Œåœ¨æ‰§è¡Œæ¯ä¸€ä¸ªå‘½ä»¤ä¹‹å‰ï¼Œéƒ½ä¼šç»™å‡ºæç¤ºï¼Œè®©ç”¨æˆ·æ¥ç¡®å®šæ˜¯å¦æ‰§è¡Œã€‚\n```\n\n**å‘½ä»¤é€‰é¡¹**ï¼š\n\n```\n-name æŒ‰ç…§æ–‡ä»¶åæŸ¥æ‰¾æ–‡ä»¶\n-perm æŒ‰æ–‡ä»¶æƒé™æŸ¥æ‰¾æ–‡ä»¶\n-user æŒ‰æ–‡ä»¶å±ä¸»æŸ¥æ‰¾æ–‡ä»¶\n-group  æŒ‰ç…§æ–‡ä»¶æ‰€å±çš„ç»„æ¥æŸ¥æ‰¾æ–‡ä»¶ã€‚\n-type  æŸ¥æ‰¾æŸä¸€ç±»å‹çš„æ–‡ä»¶ï¼Œè¯¸å¦‚ï¼š\n   b - å—è®¾å¤‡æ–‡ä»¶\n   d - ç›®å½•\n   c - å­—ç¬¦è®¾å¤‡æ–‡ä»¶\n   l - ç¬¦å·é“¾æ¥æ–‡ä»¶\n   p - ç®¡é“æ–‡ä»¶\n   f - æ™®é€šæ–‡ä»¶\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰æŸ¥æ‰¾ 48 å°æ—¶å†…ä¿®æ”¹è¿‡çš„æ–‡ä»¶\n\n```shell\nfind -atime -2\n```\n\nï¼ˆ2ï¼‰åœ¨å½“å‰ç›®å½•æŸ¥æ‰¾ ä»¥ .log ç»“å°¾çš„æ–‡ä»¶ã€‚ **.** ä»£è¡¨å½“å‰ç›®å½•\n\n```shell\nfind ./ -name '*.log'\n```\n\nï¼ˆ3ï¼‰æŸ¥æ‰¾ /opt ç›®å½•ä¸‹ æƒé™ä¸º 777 çš„æ–‡ä»¶\n\n```shell\nfind /opt -perm 777\n```\n\nï¼ˆ4ï¼‰æŸ¥æ‰¾å¤§äº 1K çš„æ–‡ä»¶\n\n```shell\nfind -size +1000c\n```\n\næŸ¥æ‰¾ç­‰äº 1000 å­—ç¬¦çš„æ–‡ä»¶\n\n```shell\nfind -size 1000c \n```\n\n-exec å‚æ•°åé¢è·Ÿçš„æ˜¯ command å‘½ä»¤ï¼Œå®ƒçš„ç»ˆæ­¢æ˜¯ä»¥ ; ä¸ºç»“æŸæ ‡å¿—çš„ï¼Œæ‰€ä»¥è¿™å¥å‘½ä»¤åé¢çš„åˆ†å·æ˜¯ä¸å¯ç¼ºå°‘çš„ï¼Œè€ƒè™‘åˆ°å„ä¸ªç³»ç»Ÿä¸­åˆ†å·ä¼šæœ‰ä¸åŒçš„æ„ä¹‰ï¼Œæ‰€ä»¥å‰é¢åŠ åæ–œæ ã€‚{} èŠ±æ‹¬å·ä»£è¡¨å‰é¢ find æŸ¥æ‰¾å‡ºæ¥çš„æ–‡ä»¶åã€‚\n\n### head å‘½ä»¤\n\nhead ç”¨æ¥æ˜¾ç¤ºæ¡£æ¡ˆçš„å¼€å¤´è‡³æ ‡å‡†è¾“å‡ºä¸­ï¼Œé»˜è®¤ head å‘½ä»¤æ‰“å°å…¶ç›¸åº”æ–‡ä»¶çš„å¼€å¤´ 10 è¡Œã€‚\n\n**å¸¸ç”¨å‚æ•°**ï¼š\n\n```\n-n<è¡Œæ•°> æ˜¾ç¤ºçš„è¡Œæ•°ï¼ˆè¡Œæ•°ä¸ºå¤æ•°è¡¨ç¤ºä»æœ€åå‘å‰æ•°ï¼‰\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰æ˜¾ç¤º 1.log æ–‡ä»¶ä¸­å‰ 20 è¡Œ\n\n```shell\nhead 1.log -n 20\n```\n\nï¼ˆ2ï¼‰æ˜¾ç¤º 1.log æ–‡ä»¶å‰ 20 å­—èŠ‚\n\n```shell\nhead 1.log -c 20 \n1\n```\n\nï¼ˆ3ï¼‰æ˜¾ç¤º 1.log æœ€å 10 è¡Œ\n\n```shell\nhead 1.log -n -10\n```\n\n### less å‘½ä»¤\n\nless ä¸ more ç±»ä¼¼ï¼Œä½†ä½¿ç”¨ less å¯ä»¥éšæ„æµè§ˆæ–‡ä»¶ï¼Œè€Œ more ä»…èƒ½å‘å‰ç§»åŠ¨ï¼Œå´ä¸èƒ½å‘åç§»åŠ¨ï¼Œè€Œä¸” less åœ¨æŸ¥çœ‹ä¹‹å‰ä¸ä¼šåŠ è½½æ•´ä¸ªæ–‡ä»¶ã€‚\n\n**å¸¸ç”¨å‘½ä»¤å‚æ•°**ï¼š\n\n```\n-i  å¿½ç•¥æœç´¢æ—¶çš„å¤§å°å†™\n-N  æ˜¾ç¤ºæ¯è¡Œçš„è¡Œå·\n-o  <æ–‡ä»¶å> å°†less è¾“å‡ºçš„å†…å®¹åœ¨æŒ‡å®šæ–‡ä»¶ä¸­ä¿å­˜èµ·æ¥\n-s  æ˜¾ç¤ºè¿ç»­ç©ºè¡Œä¸ºä¸€è¡Œ\n/å­—ç¬¦ä¸²ï¼šå‘ä¸‹æœç´¢â€œå­—ç¬¦ä¸²â€çš„åŠŸèƒ½\n?å­—ç¬¦ä¸²ï¼šå‘ä¸Šæœç´¢â€œå­—ç¬¦ä¸²â€çš„åŠŸèƒ½\nnï¼šé‡å¤å‰ä¸€ä¸ªæœç´¢ï¼ˆä¸ / æˆ– ? æœ‰å…³ï¼‰\nNï¼šåå‘é‡å¤å‰ä¸€ä¸ªæœç´¢ï¼ˆä¸ / æˆ– ? æœ‰å…³ï¼‰\n-x <æ•°å­—> å°†â€œtabâ€é”®æ˜¾ç¤ºä¸ºè§„å®šçš„æ•°å­—ç©ºæ ¼\nb  å‘åç¿»ä¸€é¡µ\nd  å‘åç¿»åŠé¡µ\nh  æ˜¾ç¤ºå¸®åŠ©ç•Œé¢\nQ  é€€å‡ºless å‘½ä»¤\nu  å‘å‰æ»šåŠ¨åŠé¡µ\ny  å‘å‰æ»šåŠ¨ä¸€è¡Œ\nç©ºæ ¼é”® æ»šåŠ¨ä¸€è¡Œ\nå›è½¦é”® æ»šåŠ¨ä¸€é¡µ\n[pagedown]ï¼š å‘ä¸‹ç¿»åŠ¨ä¸€é¡µ\n[pageup]ï¼š   å‘ä¸Šç¿»åŠ¨ä¸€é¡µ\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰ps æŸ¥çœ‹è¿›ç¨‹ä¿¡æ¯å¹¶é€šè¿‡ less åˆ†é¡µæ˜¾ç¤º\n\n```shell\nps -aux | less -N\n```\n\nï¼ˆ2ï¼‰æŸ¥çœ‹å¤šä¸ªæ–‡ä»¶\n\n```shell\nless 1.log 2.log\n```\n\nå¯ä»¥ä½¿ç”¨ n æŸ¥çœ‹ä¸‹ä¸€ä¸ªï¼Œä½¿ç”¨ p æŸ¥çœ‹å‰ä¸€ä¸ªã€‚\n\n### ln å‘½ä»¤\n\nåŠŸèƒ½æ˜¯ä¸ºæ–‡ä»¶åœ¨å¦å¤–ä¸€ä¸ªä½ç½®å»ºç«‹ä¸€ä¸ªåŒæ­¥çš„é“¾æ¥ï¼Œå½“åœ¨ä¸åŒç›®å½•éœ€è¦è¯¥é—®é¢˜æ—¶ï¼Œå°±ä¸éœ€è¦ä¸ºæ¯ä¸€ä¸ªç›®å½•åˆ›å»ºåŒæ ·çš„æ–‡ä»¶ï¼Œé€šè¿‡ ln åˆ›å»ºçš„é“¾æ¥ï¼ˆlinkï¼‰å‡å°‘ç£ç›˜å ç”¨é‡ã€‚\n\né“¾æ¥åˆ†ç±»ï¼šè½¯ä»¶é“¾æ¥åŠç¡¬é“¾æ¥\n\nè½¯é“¾æ¥ï¼š\n\n- 1.è½¯é“¾æ¥ï¼Œä»¥è·¯å¾„çš„å½¢å¼å­˜åœ¨ã€‚ç±»ä¼¼äº Windows æ“ä½œç³»ç»Ÿä¸­çš„å¿«æ·æ–¹å¼\n- 2.è½¯é“¾æ¥å¯ä»¥ è·¨æ–‡ä»¶ç³»ç»Ÿ ï¼Œç¡¬é“¾æ¥ä¸å¯ä»¥\n- 3.è½¯é“¾æ¥å¯ä»¥å¯¹ä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶åè¿›è¡Œé“¾æ¥\n- 4.è½¯é“¾æ¥å¯ä»¥å¯¹ç›®å½•è¿›è¡Œé“¾æ¥\n\nç¡¬é“¾æ¥:\n\n- 1.ç¡¬é“¾æ¥ï¼Œä»¥æ–‡ä»¶å‰¯æœ¬çš„å½¢å¼å­˜åœ¨ã€‚ä½†ä¸å ç”¨å®é™…ç©ºé—´ã€‚\n- 2.ä¸å…è®¸ç»™ç›®å½•åˆ›å»ºç¡¬é“¾æ¥\n- 3.ç¡¬é“¾æ¥åªæœ‰åœ¨åŒä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿä¸­æ‰èƒ½åˆ›å»º\n\n**éœ€è¦æ³¨æ„**ï¼š\n\n- ç¬¬ä¸€ï¼šln å‘½ä»¤ä¼šä¿æŒæ¯ä¸€å¤„é“¾æ¥æ–‡ä»¶çš„åŒæ­¥æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸è®ºä½ æ”¹åŠ¨äº†å“ªä¸€å¤„ï¼Œå…¶å®ƒçš„æ–‡ä»¶éƒ½ä¼šå‘ç”Ÿç›¸åŒçš„å˜åŒ–ï¼›\n- ç¬¬äºŒï¼šln çš„é“¾æ¥åˆåˆ†è½¯é“¾æ¥å’Œç¡¬é“¾æ¥ä¸¤ç§ï¼Œè½¯é“¾æ¥å°±æ˜¯ ln â€“s æºæ–‡ä»¶ ç›®æ ‡æ–‡ä»¶ï¼Œå®ƒåªä¼šåœ¨ä½ é€‰å®šçš„ä½ç½®ä¸Šç”Ÿæˆä¸€ä¸ªæ–‡ä»¶çš„é•œåƒï¼Œä¸ä¼šå ç”¨ç£ç›˜ç©ºé—´ï¼Œç¡¬é“¾æ¥ ln æºæ–‡ä»¶ ç›®æ ‡æ–‡ä»¶ï¼Œæ²¡æœ‰å‚æ•°-sï¼Œ å®ƒä¼šåœ¨ä½ é€‰å®šçš„ä½ç½®ä¸Šç”Ÿæˆä¸€ä¸ªå’Œæºæ–‡ä»¶å¤§å°ç›¸åŒçš„æ–‡ä»¶ï¼Œæ— è®ºæ˜¯è½¯é“¾æ¥è¿˜æ˜¯ç¡¬é“¾æ¥ï¼Œæ–‡ä»¶éƒ½ä¿æŒåŒæ­¥å˜åŒ–ã€‚\n- ç¬¬ä¸‰ï¼šln æŒ‡ä»¤ç”¨åœ¨é“¾æ¥æ–‡ä»¶æˆ–ç›®å½•ï¼Œå¦‚åŒæ—¶æŒ‡å®šä¸¤ä¸ªä»¥ä¸Šçš„æ–‡ä»¶æˆ–ç›®å½•ï¼Œä¸”æœ€åçš„ç›®çš„åœ°æ˜¯ä¸€ä¸ªå·²ç»å­˜åœ¨çš„ç›®å½•ï¼Œåˆ™ä¼šæŠŠå‰é¢æŒ‡å®šçš„æ‰€æœ‰æ–‡ä»¶æˆ–ç›®å½•å¤åˆ¶åˆ°è¯¥ç›®å½•ä¸­ã€‚è‹¥åŒæ—¶æŒ‡å®šå¤šä¸ªæ–‡ä»¶æˆ–ç›®å½•ï¼Œä¸”æœ€åçš„ç›®çš„åœ°å¹¶éæ˜¯ä¸€ä¸ªå·²å­˜åœ¨çš„ç›®å½•ï¼Œåˆ™ä¼šå‡ºç°é”™è¯¯ä¿¡æ¯ã€‚\n\n**å¸¸ç”¨å‚æ•°**ï¼š\n\n```\n-b åˆ é™¤ï¼Œè¦†ç›–ä»¥å‰å»ºç«‹çš„é“¾æ¥\n-s è½¯é“¾æ¥ï¼ˆç¬¦å·é“¾æ¥ï¼‰\n-v æ˜¾ç¤ºè¯¦ç»†å¤„ç†è¿‡ç¨‹\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰ç»™æ–‡ä»¶åˆ›å»ºè½¯é“¾æ¥ï¼Œå¹¶æ˜¾ç¤ºæ“ä½œä¿¡æ¯\n\n```shell\nln -sv source.log link.log\n```\n\nï¼ˆ2ï¼‰ç»™æ–‡ä»¶åˆ›å»ºç¡¬é“¾æ¥ï¼Œå¹¶æ˜¾ç¤ºæ“ä½œä¿¡æ¯\n\n```shell\nln -v source.log link1.log\n```\n\nï¼ˆ3ï¼‰ç»™ç›®å½•åˆ›å»ºè½¯é“¾æ¥\n\n```shell\nln -sv /opt/soft/test/test3 /opt/soft/test/test5\n```\n\n### locate å‘½ä»¤\n\nlocate é€šè¿‡æœå¯»ç³»ç»Ÿå†…å»ºæ–‡æ¡£æ•°æ®åº“è¾¾åˆ°å¿«é€Ÿæ‰¾åˆ°æ¡£æ¡ˆï¼Œæ•°æ®åº“ç”± updatedb ç¨‹åºæ¥æ›´æ–°ï¼Œupdatedb æ˜¯ç”± cron daemon å‘¨æœŸæ€§è°ƒç”¨çš„ã€‚é»˜è®¤æƒ…å†µä¸‹ locate å‘½ä»¤åœ¨æœå¯»æ•°æ®åº“æ—¶æ¯”ç”±æ•´ä¸ªç”±ç¡¬ç›˜èµ„æ–™æ¥æœå¯»èµ„æ–™æ¥å¾—å¿«ï¼Œä½†è¾ƒå·®åŠ²çš„æ˜¯ locate æ‰€æ‰¾åˆ°çš„æ¡£æ¡ˆè‹¥æ˜¯æœ€è¿‘æ‰å»ºç«‹æˆ– åˆšæ›´åçš„ï¼Œå¯èƒ½ä¼šæ‰¾ä¸åˆ°ï¼Œåœ¨å†…å®šå€¼ä¸­ï¼Œupdatedb æ¯å¤©ä¼šè·‘ä¸€æ¬¡ï¼Œå¯ä»¥ç”±ä¿®æ”¹ crontab æ¥æ›´æ–°è®¾å®šå€¼ (etc/crontab)ã€‚\n\nlocate ä¸ find å‘½ä»¤ç›¸ä¼¼ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ *ã€? ç­‰è¿›è¡Œæ­£åˆ™åŒ¹é…æŸ¥æ‰¾\n\n**å¸¸ç”¨å‚æ•°**ï¼š\n\n```\n-l numï¼ˆè¦æ˜¾ç¤ºçš„è¡Œæ•°ï¼‰\n-f   å°†ç‰¹å®šçš„æ¡£æ¡ˆç³»ç»Ÿæ’é™¤åœ¨å¤–ï¼Œå¦‚å°†procæ’é™¤åœ¨å¤–\n-r   ä½¿ç”¨æ­£åˆ™è¿ç®—å¼åšä¸ºå¯»æ‰¾æ¡ä»¶\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰æŸ¥æ‰¾å’Œ pwd ç›¸å…³çš„æ‰€æœ‰æ–‡ä»¶(æ–‡ä»¶åä¸­åŒ…å« pwdï¼‰\n\n```shell\nlocate pwd\n```\n\nï¼ˆ2ï¼‰æœç´¢ etc ç›®å½•ä¸‹æ‰€æœ‰ä»¥ sh å¼€å¤´çš„æ–‡ä»¶\n\n```shell\nlocate /etc/sh\n```\n\nï¼ˆ3ï¼‰æŸ¥æ‰¾ /var ç›®å½•ä¸‹ï¼Œä»¥ reason ç»“å°¾çš„æ–‡ä»¶\n\n```shell\nlocate -r '^/var.*reason$'ï¼ˆå…¶ä¸­.è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼Œ*è¡¨ç¤ºä»»åŠ¡å¤šä¸ªï¼›.*è¡¨ç¤ºä»»æ„å¤šä¸ªå­—ç¬¦ï¼‰\n```\n\n### more å‘½ä»¤\n\nåŠŸèƒ½ç±»ä¼¼äº cat, more ä¼šä»¥ä¸€é¡µä¸€é¡µçš„æ˜¾ç¤ºæ–¹ä¾¿ä½¿ç”¨è€…é€é¡µé˜…è¯»ï¼Œè€Œæœ€åŸºæœ¬çš„æŒ‡ä»¤å°±æ˜¯æŒ‰ç©ºç™½é”®ï¼ˆspaceï¼‰å°±å¾€ä¸‹ä¸€é¡µæ˜¾ç¤ºï¼ŒæŒ‰ b é”®å°±ä¼šå¾€å›ï¼ˆbackï¼‰ä¸€é¡µæ˜¾ç¤ºã€‚\n\n**å‘½ä»¤å‚æ•°**ï¼š\n\n```\n+n      ä»ç¬« n è¡Œå¼€å§‹æ˜¾ç¤º\n-n       å®šä¹‰å±å¹•å¤§å°ä¸ºnè¡Œ\n+/pattern åœ¨æ¯ä¸ªæ¡£æ¡ˆæ˜¾ç¤ºå‰æœå¯»è¯¥å­—ä¸²ï¼ˆpatternï¼‰ï¼Œç„¶åä»è¯¥å­—ä¸²å‰ä¸¤è¡Œä¹‹åå¼€å§‹æ˜¾ç¤º \n-c       ä»é¡¶éƒ¨æ¸…å±ï¼Œç„¶åæ˜¾ç¤º\n-d       æç¤ºâ€œPress space to continueï¼Œâ€™qâ€™ to quitï¼ˆæŒ‰ç©ºæ ¼é”®ç»§ç»­ï¼ŒæŒ‰qé”®é€€å‡ºï¼‰â€ï¼Œç¦ç”¨å“é“ƒåŠŸèƒ½\n-l        å¿½ç•¥Ctrl+lï¼ˆæ¢é¡µï¼‰å­—ç¬¦\n-p       é€šè¿‡æ¸…é™¤çª—å£è€Œä¸æ˜¯æ»šå±æ¥å¯¹æ–‡ä»¶è¿›è¡Œæ¢é¡µï¼Œä¸-cé€‰é¡¹ç›¸ä¼¼\n-s       æŠŠè¿ç»­çš„å¤šä¸ªç©ºè¡Œæ˜¾ç¤ºä¸ºä¸€è¡Œ\n-u       æŠŠæ–‡ä»¶å†…å®¹ä¸­çš„ä¸‹ç”»çº¿å»æ‰\n```\n\n**å¸¸ç”¨æ“ä½œå‘½ä»¤**ï¼š\n\n```\nEnter    å‘ä¸‹ n è¡Œï¼Œéœ€è¦å®šä¹‰ã€‚é»˜è®¤ä¸º 1 è¡Œ\nCtrl+F   å‘ä¸‹æ»šåŠ¨ä¸€å±\nç©ºæ ¼é”®  å‘ä¸‹æ»šåŠ¨ä¸€å±\nCtrl+B  è¿”å›ä¸Šä¸€å±\n=       è¾“å‡ºå½“å‰è¡Œçš„è¡Œå·\n:f     è¾“å‡ºæ–‡ä»¶åå’Œå½“å‰è¡Œçš„è¡Œå·\nV      è°ƒç”¨viç¼–è¾‘å™¨\n!å‘½ä»¤   è°ƒç”¨Shellï¼Œå¹¶æ‰§è¡Œå‘½ä»¤\nq       é€€å‡ºmore\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰æ˜¾ç¤ºæ–‡ä»¶ä¸­ä»ç¬¬ 3 è¡Œèµ·çš„å†…å®¹\n\n```shell\nmore +3 text.txt\n```\n\nï¼ˆ2ï¼‰åœ¨æ‰€åˆ—å‡ºæ–‡ä»¶ç›®å½•è¯¦ç»†ä¿¡æ¯ï¼Œå€ŸåŠ©ç®¡é“ä½¿æ¯æ¬¡æ˜¾ç¤º 5 è¡Œ\n\n```shell\nls -l | more -5\n```\n\næŒ‰ç©ºæ ¼æ˜¾ç¤ºä¸‹ 5 è¡Œã€‚\n\n### mv å‘½ä»¤\n\nç§»åŠ¨æ–‡ä»¶æˆ–ä¿®æ”¹æ–‡ä»¶åï¼Œæ ¹æ®ç¬¬äºŒå‚æ•°ç±»å‹ï¼ˆå¦‚ç›®å½•ï¼Œåˆ™ç§»åŠ¨æ–‡ä»¶ï¼›å¦‚ä¸ºæ–‡ä»¶åˆ™é‡å‘½ä»¤è¯¥æ–‡ä»¶ï¼‰ã€‚\n\nå½“ç¬¬äºŒä¸ªå‚æ•°ä¸ºç›®å½•æ—¶ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥æ˜¯å¤šä¸ªä»¥ç©ºæ ¼åˆ†éš”çš„æ–‡ä»¶æˆ–ç›®å½•ï¼Œç„¶åç§»åŠ¨ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šçš„å¤šä¸ªæ–‡ä»¶åˆ°ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šçš„ç›®å½•ä¸­ã€‚\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰å°†æ–‡ä»¶ test.log é‡å‘½åä¸º test1.txt\n\n```shell\nmv test.log test1.txt\n```\n\nï¼ˆ2ï¼‰å°†æ–‡ä»¶ log1.txtã€log2.txtã€log3.txt ç§»åŠ¨åˆ°æ ¹çš„ test3 ç›®å½•ä¸­\n\n```shell\nmv llog1.txt log2.txt log3.txt /test3\n```\n\nï¼ˆ3ï¼‰å°†æ–‡ä»¶ file1 æ”¹åä¸º file2ï¼Œå¦‚æœ file2 å·²ç»å­˜åœ¨ï¼Œåˆ™è¯¢é—®æ˜¯å¦è¦†ç›–\n\n```shell\nmv -i log1.txt log2.txt\n```\n\nï¼ˆ4ï¼‰ç§»åŠ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åˆ°ä¸Šä¸€çº§ç›®å½•\n\n```shell\nmv * ../\n```\n\n### rm å‘½ä»¤\n\nåˆ é™¤ä¸€ä¸ªç›®å½•ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶æˆ–ç›®å½•ï¼Œå¦‚æœæ²¡æœ‰ä½¿ç”¨ -r é€‰é¡¹ï¼Œåˆ™ rm ä¸ä¼šåˆ é™¤ç›®å½•ã€‚å¦‚æœä½¿ç”¨ rm æ¥åˆ é™¤æ–‡ä»¶ï¼Œé€šå¸¸ä»å¯ä»¥å°†è¯¥æ–‡ä»¶æ¢å¤åŸçŠ¶ã€‚\n\n```shell\nrm [é€‰é¡¹] æ–‡ä»¶â€¦\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰åˆ é™¤ä»»ä½• .log æ–‡ä»¶ï¼Œåˆ é™¤å‰é€ä¸€è¯¢é—®ç¡®è®¤ï¼š\n\n```shell\nrm -i *.log\n```\n\nï¼ˆ2ï¼‰åˆ é™¤ test å­ç›®å½•åŠå­ç›®å½•ä¸­æ‰€æœ‰æ¡£æ¡ˆåˆ é™¤ï¼Œå¹¶ä¸”ä¸ç”¨ä¸€ä¸€ç¡®è®¤ï¼š\n\n```shell\nrm -rf test\n```\n\nï¼ˆ3ï¼‰åˆ é™¤ä»¥ -f å¼€å¤´çš„æ–‡ä»¶\n\n```shell\nrm -- -f*\n```\n\n### tail å‘½ä»¤\n\nç”¨äºæ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶æœ«å°¾å†…å®¹ï¼Œä¸æŒ‡å®šæ–‡ä»¶æ—¶ï¼Œä½œä¸ºè¾“å…¥ä¿¡æ¯è¿›è¡Œå¤„ç†ã€‚å¸¸ç”¨æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ã€‚\n\n**å¸¸ç”¨å‚æ•°**ï¼š\n\n```\n-f å¾ªç¯è¯»å–ï¼ˆå¸¸ç”¨äºæŸ¥çœ‹é€’å¢çš„æ—¥å¿—æ–‡ä»¶ï¼‰\n-n<è¡Œæ•°> æ˜¾ç¤ºè¡Œæ•°ï¼ˆä»åå‘å‰ï¼‰\n```\n\nï¼ˆ1ï¼‰å¾ªç¯è¯»å–é€æ¸å¢åŠ çš„æ–‡ä»¶å†…å®¹\n\n```shell\nping 127.0.0.1 > ping.log &\n```\n\nåå°è¿è¡Œï¼šå¯ä½¿ç”¨ jobs -l æŸ¥çœ‹ï¼Œä¹Ÿå¯ä½¿ç”¨ fg å°†å…¶ç§»åˆ°å‰å°è¿è¡Œã€‚\n\n```shell\ntail -f ping.log\n```\n\nï¼ˆæŸ¥çœ‹æ—¥å¿—ï¼‰\n\n### touch å‘½ä»¤\n\nLinux touch å‘½ä»¤ç”¨äºä¿®æ”¹æ–‡ä»¶æˆ–è€…ç›®å½•çš„æ—¶é—´å±æ€§ï¼ŒåŒ…æ‹¬å­˜å–æ—¶é—´å’Œæ›´æ”¹æ—¶é—´ã€‚è‹¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œç³»ç»Ÿä¼šå»ºç«‹ä¸€ä¸ªæ–°çš„æ–‡ä»¶ã€‚\n\nls -l å¯ä»¥æ˜¾ç¤ºæ¡£æ¡ˆçš„æ—¶é—´è®°å½•ã€‚\n\n**è¯­æ³•**\n\n```\ntouch [-acfm][-d<æ—¥æœŸæ—¶é—´>][-r<å‚è€ƒæ–‡ä»¶æˆ–ç›®å½•>] [-t<æ—¥æœŸæ—¶é—´>][--help][--version][æ–‡ä»¶æˆ–ç›®å½•â€¦]\n```\n\n- **å‚æ•°è¯´æ˜**ï¼š\n- a æ”¹å˜æ¡£æ¡ˆçš„è¯»å–æ—¶é—´è®°å½•ã€‚\n- m æ”¹å˜æ¡£æ¡ˆçš„ä¿®æ”¹æ—¶é—´è®°å½•ã€‚\n- c å‡å¦‚ç›®çš„æ¡£æ¡ˆä¸å­˜åœ¨ï¼Œä¸ä¼šå»ºç«‹æ–°çš„æ¡£æ¡ˆã€‚ä¸ --no-create çš„æ•ˆæœä¸€æ ·ã€‚\n- f ä¸ä½¿ç”¨ï¼Œæ˜¯ä¸ºäº†ä¸å…¶ä»– unix ç³»ç»Ÿçš„ç›¸å®¹æ€§è€Œä¿ç•™ã€‚\n- r ä½¿ç”¨å‚è€ƒæ¡£çš„æ—¶é—´è®°å½•ï¼Œä¸ --file çš„æ•ˆæœä¸€æ ·ã€‚\n- d è®¾å®šæ—¶é—´ä¸æ—¥æœŸï¼Œå¯ä»¥ä½¿ç”¨å„ç§ä¸åŒçš„æ ¼å¼ã€‚\n- t è®¾å®šæ¡£æ¡ˆçš„æ—¶é—´è®°å½•ï¼Œæ ¼å¼ä¸ date æŒ‡ä»¤ç›¸åŒã€‚\n- â€“no-create ä¸ä¼šå»ºç«‹æ–°æ¡£æ¡ˆã€‚\n- â€“help åˆ—å‡ºæŒ‡ä»¤æ ¼å¼ã€‚\n- â€“version åˆ—å‡ºç‰ˆæœ¬è®¯æ¯ã€‚\n\n**å®ä¾‹**\n\nä½¿ç”¨æŒ‡ä»¤\"touch\"ä¿®æ”¹æ–‡ä»¶\"testfile\"çš„æ—¶é—´å±æ€§ä¸ºå½“å‰ç³»ç»Ÿæ—¶é—´ï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š\n\n```shell\n$ touch testfile                #ä¿®æ”¹æ–‡ä»¶çš„æ—¶é—´å±æ€§ \n```\n\né¦–å…ˆï¼Œä½¿ç”¨ ls å‘½ä»¤æŸ¥çœ‹ testfile æ–‡ä»¶çš„å±æ€§ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\n\n```shell\n$ ls -l testfile                #æŸ¥çœ‹æ–‡ä»¶çš„æ—¶é—´å±æ€§  \n#åŸæ¥æ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´ä¸º16:09  \n-rw-r--r-- 1 hdd hdd 55 2011-08-22 16:09 testfile  \n```\n\næ‰§è¡ŒæŒ‡ä»¤\"touch\"ä¿®æ”¹æ–‡ä»¶å±æ€§ä»¥åï¼Œå¹¶å†æ¬¡æŸ¥çœ‹è¯¥æ–‡ä»¶çš„æ—¶é—´å±æ€§ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\n\n```shell\n$ touch testfile                #ä¿®æ”¹æ–‡ä»¶æ—¶é—´å±æ€§ä¸ºå½“å‰ç³»ç»Ÿæ—¶é—´  \n$ ls -l testfile                #æŸ¥çœ‹æ–‡ä»¶çš„æ—¶é—´å±æ€§  \n#ä¿®æ”¹åæ–‡ä»¶çš„æ—¶é—´å±æ€§ä¸ºå½“å‰ç³»ç»Ÿæ—¶é—´  \n-rw-r--r-- 1 hdd hdd 55 2011-08-22 19:53 testfile  \n```\n\nä½¿ç”¨æŒ‡ä»¤\"touch\"æ—¶ï¼Œå¦‚æœæŒ‡å®šçš„æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™å°†åˆ›å»ºä¸€ä¸ªæ–°çš„ç©ºç™½æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼Œåœ¨å½“å‰ç›®å½•ä¸‹ï¼Œä½¿ç”¨è¯¥æŒ‡ä»¤åˆ›å»ºä¸€ä¸ªç©ºç™½æ–‡ä»¶\"file\"ï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š\n\n```shell\n$ touch file            #åˆ›å»ºä¸€ä¸ªåä¸ºâ€œfileâ€çš„æ–°çš„ç©ºç™½æ–‡ä»¶ \n```\n\n### vim å‘½ä»¤\n\nVim æ˜¯ä» vi å‘å±•å‡ºæ¥çš„ä¸€ä¸ªæ–‡æœ¬ç¼–è¾‘å™¨ã€‚ä»£ç è¡¥å®Œã€ç¼–è¯‘åŠé”™è¯¯è·³è½¬ç­‰æ–¹ä¾¿ç¼–ç¨‹çš„åŠŸèƒ½ç‰¹åˆ«ä¸°å¯Œï¼Œåœ¨ç¨‹åºå‘˜ä¸­è¢«å¹¿æ³›ä½¿ç”¨ã€‚\n\n- æ‰“å¼€æ–‡ä»¶å¹¶è·³åˆ°ç¬¬ 10 è¡Œï¼š`vim +10 filename.txt` ã€‚\n- æ‰“å¼€æ–‡ä»¶è·³åˆ°ç¬¬ä¸€ä¸ªåŒ¹é…çš„è¡Œï¼š`vim +/search-term filename.txt` ã€‚\n- ä»¥åªè¯»æ¨¡å¼æ‰“å¼€æ–‡ä»¶ï¼š`vim -R /etc/passwd` ã€‚\n\nåŸºæœ¬ä¸Š vi/vim å…±åˆ†ä¸ºä¸‰ç§æ¨¡å¼ï¼Œåˆ†åˆ«æ˜¯**å‘½ä»¤æ¨¡å¼ï¼ˆCommand modeï¼‰**ï¼Œ**è¾“å…¥æ¨¡å¼ï¼ˆInsert modeï¼‰\\**å’Œ\\**åº•çº¿å‘½ä»¤æ¨¡å¼ï¼ˆLast line modeï¼‰**ã€‚\n\nç®€å•çš„è¯´ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸‰ä¸ªæ¨¡å¼æƒ³æˆåº•ä¸‹çš„å›¾æ ‡æ¥è¡¨ç¤ºï¼š\n\n![vim å·¥ä½œæ¨¡å¼](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/format,png-20230125135806349.png)\n\n### whereis å‘½ä»¤\n\nwhereis å‘½ä»¤åªèƒ½ç”¨äºç¨‹åºåçš„æœç´¢ï¼Œè€Œä¸”åªæœç´¢äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆå‚æ•°-bï¼‰ã€man è¯´æ˜æ–‡ä»¶ï¼ˆå‚æ•°-mï¼‰å’Œæºä»£ç æ–‡ä»¶ï¼ˆå‚æ•°-sï¼‰ã€‚å¦‚æœçœç•¥å‚æ•°ï¼Œåˆ™è¿”å›æ‰€æœ‰ä¿¡æ¯ã€‚whereis åŠ locate éƒ½æ˜¯åŸºäºç³»ç»Ÿå†…å»ºçš„æ•°æ®åº“è¿›è¡Œæœç´¢ï¼Œå› æ­¤æ•ˆç‡å¾ˆé«˜ï¼Œè€Œ find åˆ™æ˜¯éå†ç¡¬ç›˜æŸ¥æ‰¾æ–‡ä»¶ã€‚\n\n**å¸¸ç”¨å‚æ•°**ï¼š\n\n```\n-b   å®šä½å¯æ‰§è¡Œæ–‡ä»¶ã€‚\n-m   å®šä½å¸®åŠ©æ–‡ä»¶ã€‚\n-s   å®šä½æºä»£ç æ–‡ä»¶ã€‚\n-u   æœç´¢é»˜è®¤è·¯å¾„ä¸‹é™¤å¯æ‰§è¡Œæ–‡ä»¶ã€æºä»£ç æ–‡ä»¶ã€å¸®åŠ©æ–‡ä»¶ä»¥å¤–çš„å…¶å®ƒæ–‡ä»¶ã€‚\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰æŸ¥æ‰¾ locate ç¨‹åºç›¸å…³æ–‡ä»¶\n\n```shell\nwhereis locate\n```\n\nï¼ˆ2ï¼‰æŸ¥æ‰¾ locate çš„æºç æ–‡ä»¶\n\n```shell\nwhereis -s locate\n```\n\nï¼ˆ3ï¼‰æŸ¥æ‰¾ lcoate çš„å¸®åŠ©æ–‡ä»¶\n\n```shell\nwhereis -m locate\n```\n\n### which å‘½ä»¤\n\nåœ¨ linux è¦æŸ¥æ‰¾æŸä¸ªæ–‡ä»¶ï¼Œä½†ä¸çŸ¥é“æ”¾åœ¨å“ªé‡Œäº†ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä¸€äº›å‘½ä»¤æ¥æœç´¢ï¼š\n\n```\nwhich     æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶çš„ä½ç½®ã€‚\nwhereis æŸ¥çœ‹æ–‡ä»¶çš„ä½ç½®ã€‚\nlocate  é…åˆæ•°æ®åº“æŸ¥çœ‹æ–‡ä»¶ä½ç½®ã€‚\nfind        å®é™…æœå¯»ç¡¬ç›˜æŸ¥è¯¢æ–‡ä»¶åç§°ã€‚\n```\n\nwhich æ˜¯åœ¨ PATH å°±æ˜¯æŒ‡å®šçš„è·¯å¾„ä¸­ï¼Œæœç´¢æŸä¸ªç³»ç»Ÿå‘½ä»¤çš„ä½ç½®ï¼Œå¹¶è¿”å›ç¬¬ä¸€ä¸ªæœç´¢ç»“æœã€‚ä½¿ç”¨ which å‘½ä»¤ï¼Œå°±å¯ä»¥çœ‹åˆ°æŸä¸ªç³»ç»Ÿå‘½ä»¤æ˜¯å¦å­˜åœ¨ï¼Œä»¥åŠæ‰§è¡Œçš„åˆ°åº•æ˜¯å“ªä¸€ä¸ªä½ç½®çš„å‘½ä»¤ã€‚\n\n**å¸¸ç”¨å‚æ•°**ï¼š\n\n```\n-n ã€€æŒ‡å®šæ–‡ä»¶åé•¿åº¦ï¼ŒæŒ‡å®šçš„é•¿åº¦å¿…é¡»å¤§äºæˆ–ç­‰äºæ‰€æœ‰æ–‡ä»¶ä¸­æœ€é•¿çš„æ–‡ä»¶åã€‚\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰æŸ¥çœ‹ ls å‘½ä»¤æ˜¯å¦å­˜åœ¨ï¼Œæ‰§è¡Œå“ªä¸ª\n\n```shell\nwhich ls\n```\n\nï¼ˆ2ï¼‰æŸ¥çœ‹ which\n\n```shell\nwhich which\n```\n\nï¼ˆ3ï¼‰æŸ¥çœ‹ cd\n\n```shell\nwhich cdï¼ˆæ˜¾ç¤ºä¸å­˜åœ¨ï¼Œå› ä¸º cd æ˜¯å†…å»ºå‘½ä»¤ï¼Œè€Œ which æŸ¥æ‰¾æ˜¾ç¤ºæ˜¯ PATH ä¸­çš„å‘½ä»¤ï¼‰\n```\n\næŸ¥çœ‹å½“å‰ PATH é…ç½®ï¼š\n\n```shell\necho $PATH\n```\n\næˆ–ä½¿ç”¨ env æŸ¥çœ‹æ‰€æœ‰ç¯å¢ƒå˜é‡åŠå¯¹åº”å€¼\n\n## æ–‡æ¡£ç¼–è¾‘å‘½ä»¤\n\n### grep å‘½ä»¤\n\nå¼ºå¤§çš„æ–‡æœ¬æœç´¢å‘½ä»¤ï¼Œgrep(Global Regular Expression Print) å…¨å±€æ­£åˆ™è¡¨è¾¾å¼æœç´¢ã€‚\n\ngrep çš„å·¥ä½œæ–¹å¼æ˜¯è¿™æ ·çš„ï¼Œå®ƒåœ¨ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶ä¸­æœç´¢å­—ç¬¦ä¸²æ¨¡æ¿ã€‚å¦‚æœæ¨¡æ¿åŒ…æ‹¬ç©ºæ ¼ï¼Œåˆ™å¿…é¡»è¢«å¼•ç”¨ï¼Œæ¨¡æ¿åçš„æ‰€æœ‰å­—ç¬¦ä¸²è¢«çœ‹ä½œæ–‡ä»¶åã€‚æœç´¢çš„ç»“æœè¢«é€åˆ°æ ‡å‡†è¾“å‡ºï¼Œä¸å½±å“åŸæ–‡ä»¶å†…å®¹ã€‚\n\nå‘½ä»¤æ ¼å¼ï¼š\n\n```\ngrep [option] pattern file|dir\n```\n\n**å¸¸ç”¨å‚æ•°**ï¼š\n\n```\n-A n --after-contextæ˜¾ç¤ºåŒ¹é…å­—ç¬¦ånè¡Œ\n-B n --before-contextæ˜¾ç¤ºåŒ¹é…å­—ç¬¦å‰nè¡Œ\n-C n --context æ˜¾ç¤ºåŒ¹é…å­—ç¬¦å‰ånè¡Œ\n-c --count è®¡ç®—ç¬¦åˆæ ·å¼çš„åˆ—æ•°\n-i å¿½ç•¥å¤§å°å†™\n-l åªåˆ—å‡ºæ–‡ä»¶å†…å®¹ç¬¦åˆæŒ‡å®šçš„æ ·å¼çš„æ–‡ä»¶åç§°\n-f ä»æ–‡ä»¶ä¸­è¯»å–å…³é”®è¯\n-n æ˜¾ç¤ºåŒ¹é…å†…å®¹çš„æ‰€åœ¨æ–‡ä»¶ä¸­è¡Œæ•°\n-R é€’å½’æŸ¥æ‰¾æ–‡ä»¶å¤¹\n```\n\ngrep çš„è§„åˆ™è¡¨è¾¾å¼:\n\n```\n^  #é”šå®šè¡Œçš„å¼€å§‹ å¦‚ï¼š'^grep'åŒ¹é…æ‰€æœ‰ä»¥grepå¼€å¤´çš„è¡Œã€‚ \n$  #é”šå®šè¡Œçš„ç»“æŸ å¦‚ï¼š'grep$'åŒ¹é…æ‰€æœ‰ä»¥grepç»“å°¾çš„è¡Œã€‚ \n.  #åŒ¹é…ä¸€ä¸ªéæ¢è¡Œç¬¦çš„å­—ç¬¦ å¦‚ï¼š'gr.p'åŒ¹é…gråæ¥ä¸€ä¸ªä»»æ„å­—ç¬¦ï¼Œç„¶åæ˜¯pã€‚  \n*  #åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªå…ˆå‰å­—ç¬¦ å¦‚ï¼š'*grep'åŒ¹é…æ‰€æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªç©ºæ ¼åç´§è·Ÿgrepçš„è¡Œã€‚\n.*   #ä¸€èµ·ç”¨ä»£è¡¨ä»»æ„å­—ç¬¦ã€‚  \n[]   #åŒ¹é…ä¸€ä¸ªæŒ‡å®šèŒƒå›´å†…çš„å­—ç¬¦ï¼Œå¦‚'[Gg]rep'åŒ¹é…Grepå’Œgrepã€‚ \n[^]  #åŒ¹é…ä¸€ä¸ªä¸åœ¨æŒ‡å®šèŒƒå›´å†…çš„å­—ç¬¦ï¼Œå¦‚ï¼š'[^A-FH-Z]rep'åŒ¹é…ä¸åŒ…å«A-Rå’ŒT-Zçš„ä¸€ä¸ªå­—æ¯å¼€å¤´ï¼Œç´§è·Ÿrepçš„è¡Œã€‚  \n\\(..\\)  #æ ‡è®°åŒ¹é…å­—ç¬¦ï¼Œå¦‚'\\(love\\)'ï¼Œloveè¢«æ ‡è®°ä¸º1ã€‚   \n\\<      #é”šå®šå•è¯çš„å¼€å§‹ï¼Œå¦‚:'\\<grep'åŒ¹é…åŒ…å«ä»¥grepå¼€å¤´çš„å•è¯çš„è¡Œã€‚\n\\>      #é”šå®šå•è¯çš„ç»“æŸï¼Œå¦‚'grep\\>'åŒ¹é…åŒ…å«ä»¥grepç»“å°¾çš„å•è¯çš„è¡Œã€‚\nx\\{m\\}  #é‡å¤å­—ç¬¦xï¼Œmæ¬¡ï¼Œå¦‚ï¼š'0\\{5\\}'åŒ¹é…åŒ…å«5ä¸ªoçš„è¡Œã€‚ \nx\\{m,\\}  #é‡å¤å­—ç¬¦x,è‡³å°‘mæ¬¡ï¼Œå¦‚ï¼š'o\\{5,\\}'åŒ¹é…è‡³å°‘æœ‰5ä¸ªoçš„è¡Œã€‚  \nx\\{m,n\\}  #é‡å¤å­—ç¬¦xï¼Œè‡³å°‘mæ¬¡ï¼Œä¸å¤šäºnæ¬¡ï¼Œå¦‚ï¼š'o\\{5,10\\}'åŒ¹é…5--10ä¸ªoçš„è¡Œã€‚  \n\\w    #åŒ¹é…æ–‡å­—å’Œæ•°å­—å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯[A-Za-z0-9]ï¼Œå¦‚ï¼š'G\\w*p'åŒ¹é…ä»¥Gåè·Ÿé›¶ä¸ªæˆ–å¤šä¸ªæ–‡å­—æˆ–æ•°å­—å­—ç¬¦ï¼Œç„¶åæ˜¯pã€‚  \n\\W    #\\wçš„åç½®å½¢å¼ï¼ŒåŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªéå•è¯å­—ç¬¦ï¼Œå¦‚ç‚¹å·å¥å·ç­‰ã€‚  \n\\b    #å•è¯é”å®šç¬¦ï¼Œå¦‚: '\\bgrep\\b'åªåŒ¹é…grepã€‚\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰æŸ¥æ‰¾æŒ‡å®šè¿›ç¨‹\n\n```shell\nps -ef | grep svn\n```\n\nï¼ˆ2ï¼‰æŸ¥æ‰¾æŒ‡å®šè¿›ç¨‹ä¸ªæ•°\n\n```shell\nps -ef | grep svn -c\n```\n\nï¼ˆ3ï¼‰ä»æ–‡ä»¶ä¸­è¯»å–å…³é”®è¯\n\n```shell\ncat test1.txt | grep -f key.log\n```\n\nï¼ˆ4ï¼‰ä»æ–‡ä»¶å¤¹ä¸­é€’å½’æŸ¥æ‰¾ä»¥ grep å¼€å¤´çš„è¡Œï¼Œå¹¶åªåˆ—å‡ºæ–‡ä»¶\n\n```shell\ngrep -lR '^grep' /tmp\n```\n\nï¼ˆ5ï¼‰æŸ¥æ‰¾é x å¼€å…³çš„è¡Œå†…å®¹\n\n```shell\ngrep '^[^x]' test.txt\n```\n\nï¼ˆ6ï¼‰æ˜¾ç¤ºåŒ…å« ed æˆ–è€… at å­—ç¬¦çš„å†…å®¹è¡Œ\n\n```shell\ngrep -E 'ed|at' test.txt\n```\n\n### wc å‘½ä»¤\n\nwc(word count)åŠŸèƒ½ä¸ºç»Ÿè®¡æŒ‡å®šçš„æ–‡ä»¶ä¸­å­—èŠ‚æ•°ã€å­—æ•°ã€è¡Œæ•°ï¼Œå¹¶å°†ç»Ÿè®¡ç»“æœè¾“å‡º\n\nå‘½ä»¤æ ¼å¼ï¼š\n\n```\nwc [option] file..\n```\n\n**å‘½ä»¤å‚æ•°**ï¼š\n\n```\n-c ç»Ÿè®¡å­—èŠ‚æ•°\n-l ç»Ÿè®¡è¡Œæ•°\n-m ç»Ÿè®¡å­—ç¬¦æ•°\n-w ç»Ÿè®¡è¯æ•°ï¼Œä¸€ä¸ªå­—è¢«å®šä¹‰ä¸ºç”±ç©ºç™½ã€è·³æ ¼æˆ–æ¢è¡Œå­—ç¬¦åˆ†éš”çš„å­—ç¬¦ä¸²\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰æŸ¥æ‰¾æ–‡ä»¶çš„ è¡Œæ•° å•è¯æ•° å­—èŠ‚æ•° æ–‡ä»¶å\n\n```shell\nwc text.txt\n```\n\nç»“æœï¼š\n\n```shell\n7     8     70     test.txt\n```\n\nï¼ˆ2ï¼‰ç»Ÿè®¡è¾“å‡ºç»“æœçš„è¡Œæ•°\n\n```shell\ncat test.txt | wc -l\n```\n\n## ç£ç›˜ç®¡ç†å‘½ä»¤\n\n### cd å‘½ä»¤\n\ncd(changeDirectory) å‘½ä»¤è¯­æ³•ï¼š\n\n```\ncd [ç›®å½•å]\n```\n\nè¯´æ˜ï¼šåˆ‡æ¢å½“å‰ç›®å½•è‡³ dirNameã€‚\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰è¿›å…¥è¦ç›®å½•\n\n```shell\ncd /\n```\n\nï¼ˆ2ï¼‰è¿›å…¥ â€œhomeâ€ ç›®å½•\n\n```shell\ncd ~\n```\n\nï¼ˆ3ï¼‰è¿›å…¥ä¸Šä¸€æ¬¡å·¥ä½œè·¯å¾„\n\n```shell\ncd -\n```\n\nï¼ˆ4ï¼‰æŠŠä¸Šä¸ªå‘½ä»¤çš„å‚æ•°ä½œä¸º cd å‚æ•°ä½¿ç”¨ã€‚\n\n```shell\ncd !$\n```\n\n### df å‘½ä»¤\n\næ˜¾ç¤ºç£ç›˜ç©ºé—´ä½¿ç”¨æƒ…å†µã€‚è·å–ç¡¬ç›˜è¢«å ç”¨äº†å¤šå°‘ç©ºé—´ï¼Œç›®å‰è¿˜å‰©ä¸‹å¤šå°‘ç©ºé—´ç­‰ä¿¡æ¯ï¼Œå¦‚æœæ²¡æœ‰æ–‡ä»¶åè¢«æŒ‡å®šï¼Œåˆ™æ‰€æœ‰å½“å‰è¢«æŒ‚è½½çš„æ–‡ä»¶ç³»ç»Ÿçš„å¯ç”¨ç©ºé—´å°†è¢«æ˜¾ç¤ºã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œç£ç›˜ç©ºé—´å°†ä»¥ 1KB ä¸ºå•ä½è¿›è¡Œæ˜¾ç¤ºï¼Œé™¤éç¯å¢ƒå˜é‡ POSIXLY_CORRECT è¢«æŒ‡å®šï¼Œé‚£æ ·å°†ä»¥ 512 å­—èŠ‚ä¸ºå•ä½è¿›è¡Œæ˜¾ç¤ºï¼š\n\n```\n-a å…¨éƒ¨æ–‡ä»¶ç³»ç»Ÿåˆ—è¡¨\n-h ä»¥æ–¹ä¾¿é˜…è¯»çš„æ–¹å¼æ˜¾ç¤ºä¿¡æ¯\n-i æ˜¾ç¤ºinodeä¿¡æ¯\n-k åŒºå—ä¸º1024å­—èŠ‚\n-l åªæ˜¾ç¤ºæœ¬åœ°ç£ç›˜\n-T åˆ—å‡ºæ–‡ä»¶ç³»ç»Ÿç±»å‹\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰æ˜¾ç¤ºç£ç›˜ä½¿ç”¨æƒ…å†µ\n\n```shell\ndf -l\n```\n\nï¼ˆ2ï¼‰ä»¥æ˜“è¯»æ–¹å¼åˆ—å‡ºæ‰€æœ‰æ–‡ä»¶ç³»ç»ŸåŠå…¶ç±»å‹\n\n```shell\ndf -haT\n```\n\n### du å‘½ä»¤\n\ndu å‘½ä»¤ä¹Ÿæ˜¯æŸ¥çœ‹ä½¿ç”¨ç©ºé—´çš„ï¼Œä½†æ˜¯ä¸ df å‘½ä»¤ä¸åŒçš„æ˜¯ Linux du å‘½ä»¤æ˜¯å¯¹æ–‡ä»¶å’Œç›®å½•ç£ç›˜ä½¿ç”¨çš„ç©ºé—´çš„æŸ¥çœ‹ï¼š\n\nå‘½ä»¤æ ¼å¼ï¼š\n\n```\ndu [é€‰é¡¹] [æ–‡ä»¶]\n1\n```\n\n**å¸¸ç”¨å‚æ•°**ï¼š\n\n```\n-a æ˜¾ç¤ºç›®å½•ä¸­æ‰€æœ‰æ–‡ä»¶å¤§å°\n-k ä»¥KBä¸ºå•ä½æ˜¾ç¤ºæ–‡ä»¶å¤§å°\n-m ä»¥MBä¸ºå•ä½æ˜¾ç¤ºæ–‡ä»¶å¤§å°\n-g ä»¥GBä¸ºå•ä½æ˜¾ç¤ºæ–‡ä»¶å¤§å°\n-h ä»¥æ˜“è¯»æ–¹å¼æ˜¾ç¤ºæ–‡ä»¶å¤§å°\n-s ä»…æ˜¾ç¤ºæ€»è®¡\n-cæˆ–--total  é™¤äº†æ˜¾ç¤ºä¸ªåˆ«ç›®å½•æˆ–æ–‡ä»¶çš„å¤§å°å¤–ï¼ŒåŒæ—¶ä¹Ÿæ˜¾ç¤ºæ‰€æœ‰ç›®å½•æˆ–æ–‡ä»¶çš„æ€»å’Œ\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰ä»¥æ˜“è¯»æ–¹å¼æ˜¾ç¤ºæ–‡ä»¶å¤¹å†…åŠå­æ–‡ä»¶å¤¹å¤§å°\n\n```shell\ndu -h scf/\n```\n\nï¼ˆ2ï¼‰ä»¥æ˜“è¯»æ–¹å¼æ˜¾ç¤ºæ–‡ä»¶å¤¹å†…æ‰€æœ‰æ–‡ä»¶å¤§å°\n\n```shell\ndu -ah scf/\n```\n\nï¼ˆ3ï¼‰æ˜¾ç¤ºå‡ ä¸ªæ–‡ä»¶æˆ–ç›®å½•å„è‡ªå ç”¨ç£ç›˜ç©ºé—´çš„å¤§å°ï¼Œè¿˜ç»Ÿè®¡å®ƒä»¬çš„æ€»å’Œ\n\n```shell\ndu -hc test/ scf/\n```\n\nï¼ˆ4ï¼‰è¾“å‡ºå½“å‰ç›®å½•ä¸‹å„ä¸ªå­ç›®å½•æ‰€ä½¿ç”¨çš„ç©ºé—´\n\n```shell\ndu -hc --max-depth=1 scf/\n```\n\n### lså‘½ä»¤\n\nå°±æ˜¯ list çš„ç¼©å†™ï¼Œé€šè¿‡ ls å‘½ä»¤ä¸ä»…å¯ä»¥æŸ¥çœ‹ linux æ–‡ä»¶å¤¹åŒ…å«çš„æ–‡ä»¶ï¼Œè€Œä¸”å¯ä»¥æŸ¥çœ‹æ–‡ä»¶æƒé™(åŒ…æ‹¬ç›®å½•ã€æ–‡ä»¶å¤¹ã€æ–‡ä»¶æƒé™)î€‚æŸ¥çœ‹ç›®å½•ä¿¡æ¯ç­‰ç­‰ã€‚\n\n**å¸¸ç”¨å‚æ•°æ­é…**ï¼š\n\n```\nls -a åˆ—å‡ºç›®å½•æ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…å«ä»¥.å¼€å§‹çš„éšè—æ–‡ä»¶\nls -A åˆ—å‡ºé™¤.åŠ..çš„å…¶å®ƒæ–‡ä»¶\nls -r ååºæ’åˆ—\nls -t ä»¥æ–‡ä»¶ä¿®æ”¹æ—¶é—´æ’åº\nls -S ä»¥æ–‡ä»¶å¤§å°æ’åº\nls -h ä»¥æ˜“è¯»å¤§å°æ˜¾ç¤º\nls -l é™¤äº†æ–‡ä»¶åä¹‹å¤–ï¼Œè¿˜å°†æ–‡ä»¶çš„æƒé™ã€æ‰€æœ‰è€…ã€æ–‡ä»¶å¤§å°ç­‰ä¿¡æ¯è¯¦ç»†åˆ—å‡ºæ¥\n```\n\n**å®ä¾‹**ï¼š\n\n(1) æŒ‰æ˜“è¯»æ–¹å¼æŒ‰æ—¶é—´ååºæ’åºï¼Œå¹¶æ˜¾ç¤ºæ–‡ä»¶è¯¦ç»†ä¿¡æ¯\n\n```shell\nls -lhrt\n```\n\n(2) æŒ‰å¤§å°ååºæ˜¾ç¤ºæ–‡ä»¶è¯¦ç»†ä¿¡æ¯\n\n```shell\nls -lrS\n```\n\n(3)åˆ—å‡ºå½“å‰ç›®å½•ä¸­æ‰€æœ‰ä»¥\"t\"å¼€å¤´çš„ç›®å½•çš„è¯¦ç»†å†…å®¹\n\n```shell\nls -l t*\n```\n\n(4) åˆ—å‡ºæ–‡ä»¶ç»å¯¹è·¯å¾„ï¼ˆä¸åŒ…å«éšè—æ–‡ä»¶ï¼‰\n\n```shell\nls | sed \"s:^:`pwd`/:\"\n```\n\n(5) åˆ—å‡ºæ–‡ä»¶ç»å¯¹è·¯å¾„ï¼ˆåŒ…å«éšè—æ–‡ä»¶ï¼‰\n\n```shell\nfind $pwd -maxdepth 1 | xargs ls -ld\n```\n\n### mkdir å‘½ä»¤\n\nmkdir å‘½ä»¤ç”¨äºåˆ›å»ºæ–‡ä»¶å¤¹ã€‚\n\nå¯ç”¨é€‰é¡¹ï¼š\n\n- **-m**: å¯¹æ–°å»ºç›®å½•è®¾ç½®å­˜å–æƒé™ï¼Œä¹Ÿå¯ä»¥ç”¨ chmod å‘½ä»¤è®¾ç½®;\n- **-p**: å¯ä»¥æ˜¯ä¸€ä¸ªè·¯å¾„åç§°ã€‚æ­¤æ—¶è‹¥è·¯å¾„ä¸­çš„æŸäº›ç›®å½•å°šä¸å­˜åœ¨,åŠ ä¸Šæ­¤é€‰é¡¹åï¼Œç³»ç»Ÿå°†è‡ªåŠ¨å»ºç«‹å¥½é‚£äº›å°šä¸åœ¨çš„ç›®å½•ï¼Œå³ä¸€æ¬¡å¯ä»¥å»ºç«‹å¤šä¸ªç›®å½•ã€‚\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰å½“å‰å·¥ä½œç›®å½•ä¸‹åˆ›å»ºåä¸º t çš„æ–‡ä»¶å¤¹\n\n```shell\nmkdir t\n```\n\nï¼ˆ2ï¼‰åœ¨ tmp ç›®å½•ä¸‹åˆ›å»ºè·¯å¾„ä¸º test/t1/t çš„ç›®å½•ï¼Œè‹¥ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºï¼š\n\n```shell\nmkdir -p /tmp/test/t1/t\n```\n\n### pwd å‘½ä»¤\n\npwd å‘½ä»¤ç”¨äºæŸ¥çœ‹å½“å‰å·¥ä½œç›®å½•è·¯å¾„ã€‚\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰æŸ¥çœ‹å½“å‰è·¯å¾„\n\n```shell\npwd\n```\n\nï¼ˆ2ï¼‰æŸ¥çœ‹è½¯é“¾æ¥çš„å®é™…è·¯å¾„\n\n```shell\npwd -P\n```\n\n### rmdir å‘½ä»¤\n\nä»ä¸€ä¸ªç›®å½•ä¸­åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªå­ç›®å½•é¡¹ï¼Œåˆ é™¤æŸç›®å½•æ—¶ä¹Ÿå¿…é¡»å…·æœ‰å¯¹å…¶çˆ¶ç›®å½•çš„å†™æƒé™ã€‚\n\n**æ³¨æ„**ï¼šä¸èƒ½åˆ é™¤éç©ºç›®å½•\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰å½“ parent å­ç›®å½•è¢«åˆ é™¤åä½¿å®ƒä¹Ÿæˆä¸ºç©ºç›®å½•çš„è¯ï¼Œåˆ™é¡ºä¾¿ä¸€å¹¶åˆ é™¤ï¼š\n\n```shell\nrmdir -p parent/child/child11\n```\n\n## ç½‘ç»œé€šè®¯å‘½ä»¤\n\n### ifconfig å‘½ä»¤\n\n- ifconfig ç”¨äºæŸ¥çœ‹å’Œé…ç½® Linux ç³»ç»Ÿçš„ç½‘ç»œæ¥å£ã€‚\n- æŸ¥çœ‹æ‰€æœ‰ç½‘ç»œæ¥å£åŠå…¶çŠ¶æ€ï¼š`ifconfig -a` ã€‚\n- ä½¿ç”¨ up å’Œ down å‘½ä»¤å¯åŠ¨æˆ–åœæ­¢æŸä¸ªæ¥å£ï¼š`ifconfig eth0 up` å’Œ `ifconfig eth0 down` ã€‚\n\n### iptables å‘½ä»¤\n\niptables ï¼Œæ˜¯ä¸€ä¸ªé…ç½® Linux å†…æ ¸é˜²ç«å¢™çš„å‘½ä»¤è¡Œå·¥å…·ã€‚åŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œå¯¹äºæˆ‘ä»¬å¼€å‘æ¥è¯´ï¼Œä¸»è¦æŒæ¡å¦‚ä½•å¼€æ”¾ç«¯å£å³å¯ã€‚ä¾‹å¦‚ï¼š\n\n- æŠŠæ¥æº IP ä¸º 192.168.1.101 è®¿é—®æœ¬æœº 80 ç«¯å£çš„åŒ…ç›´æ¥æ‹’ç»ï¼š`iptables -I INPUT -s 192.168.1.101 -p tcp --dport 80 -j REJECT` ã€‚\n\n- å¼€å¯ 80 ç«¯å£ï¼Œå› ä¸º web å¯¹å¤–éƒ½æ˜¯è¿™ä¸ªç«¯å£\n\n\t```shell\n\tiptables -A INPUT -p tcp --dport 80 -j ACCEP\n\t```\n\n- å¦å¤–ï¼Œè¦æ³¨æ„ä½¿ç”¨ `iptables save` å‘½ä»¤ï¼Œè¿›è¡Œä¿å­˜ã€‚å¦åˆ™ï¼ŒæœåŠ¡å™¨é‡å¯åï¼Œé…ç½®çš„è§„åˆ™å°†ä¸¢å¤±ã€‚\n\n### netstat å‘½ä»¤\n\nLinux netstat å‘½ä»¤ç”¨äºæ˜¾ç¤ºç½‘ç»œçŠ¶æ€ã€‚\n\nåˆ©ç”¨ netstat æŒ‡ä»¤å¯è®©ä½ å¾—çŸ¥æ•´ä¸ª Linux ç³»ç»Ÿçš„ç½‘ç»œæƒ…å†µã€‚\n\nè¯­æ³•\n\n```\nnetstat [-acCeFghilMnNoprstuvVwx][-A<ç½‘ç»œç±»å‹>][--ip]\n```\n\n**å‚æ•°è¯´æ˜**ï¼š\n\n- -a æˆ–â€“all æ˜¾ç¤ºæ‰€æœ‰è¿çº¿ä¸­çš„ Socketã€‚\n- -A<ç½‘ç»œç±»å‹>æˆ–â€“<ç½‘ç»œç±»å‹> åˆ—å‡ºè¯¥ç½‘ç»œç±»å‹è¿çº¿ä¸­çš„ç›¸å…³åœ°å€ã€‚\n- -c æˆ–â€“continuous æŒç»­åˆ—å‡ºç½‘ç»œçŠ¶æ€ã€‚\n- -C æˆ–â€“cache æ˜¾ç¤ºè·¯ç”±å™¨é…ç½®çš„å¿«å–ä¿¡æ¯ã€‚\n- -e æˆ–â€“extend æ˜¾ç¤ºç½‘ç»œå…¶ä»–ç›¸å…³ä¿¡æ¯ã€‚\n- -F æˆ–â€“fib æ˜¾ç¤º FIBã€‚\n- -g æˆ–â€“groups æ˜¾ç¤ºå¤šé‡å¹¿æ’­åŠŸèƒ½ç¾¤ç»„ç»„å‘˜åå•ã€‚\n- -h æˆ–â€“help åœ¨çº¿å¸®åŠ©ã€‚\n- -i æˆ–â€“interfaces æ˜¾ç¤ºç½‘ç»œç•Œé¢ä¿¡æ¯è¡¨å•ã€‚\n- -l æˆ–â€“listening æ˜¾ç¤ºç›‘æ§ä¸­çš„æœåŠ¡å™¨çš„ Socketã€‚\n- -M æˆ–â€“masquerade æ˜¾ç¤ºä¼ªè£…çš„ç½‘ç»œè¿çº¿ã€‚\n- -n æˆ–â€“numeric ç›´æ¥ä½¿ç”¨ IP åœ°å€ï¼Œè€Œä¸é€šè¿‡åŸŸåæœåŠ¡å™¨ã€‚\n- -N æˆ–â€“netlink æˆ–â€“symbolic æ˜¾ç¤ºç½‘ç»œç¡¬ä»¶å¤–å›´è®¾å¤‡çš„ç¬¦å·è¿æ¥åç§°ã€‚\n- -o æˆ–â€“timers æ˜¾ç¤ºè®¡æ—¶å™¨ã€‚\n- -p æˆ–â€“programs æ˜¾ç¤ºæ­£åœ¨ä½¿ç”¨ Socket çš„ç¨‹åºè¯†åˆ«ç å’Œç¨‹åºåç§°ã€‚\n- -r æˆ–â€“route æ˜¾ç¤º Routing Tableã€‚\n- -s æˆ–â€“statistice æ˜¾ç¤ºç½‘ç»œå·¥ä½œä¿¡æ¯ç»Ÿè®¡è¡¨ã€‚\n- -t æˆ–â€“tcp æ˜¾ç¤º TCP ä¼ è¾“åè®®çš„è¿çº¿çŠ¶å†µã€‚\n- -u æˆ–â€“udp æ˜¾ç¤º UDP ä¼ è¾“åè®®çš„è¿çº¿çŠ¶å†µã€‚\n- -v æˆ–â€“verbose æ˜¾ç¤ºæŒ‡ä»¤æ‰§è¡Œè¿‡ç¨‹ã€‚\n- -V æˆ–â€“version æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ã€‚\n- -w æˆ–â€“raw æ˜¾ç¤º RAW ä¼ è¾“åè®®çš„è¿çº¿çŠ¶å†µã€‚\n- -x æˆ–â€“unix æ­¤å‚æ•°çš„æ•ˆæœå’ŒæŒ‡å®š\"-A unix\"å‚æ•°ç›¸åŒã€‚\n- â€“ip æˆ–â€“inet æ­¤å‚æ•°çš„æ•ˆæœå’ŒæŒ‡å®š\"-A inet\"å‚æ•°ç›¸åŒã€‚\n\n**å®ä¾‹**\n\n**å¦‚ä½•æŸ¥çœ‹ç³»ç»Ÿéƒ½å¼€å¯äº†å“ªäº›ç«¯å£ï¼Ÿ**\n\n```shell\n[root@centos6 ~ 13:20 #55]# netstat -lnp\nActive Internet connections (only servers)\nProto Recv-Q Send-Q Local Address               Foreign Address             State       PID/Program name\ntcp        0      0 0.0.0.0:22                  0.0.0.0:*                   LISTEN      1035/sshd\ntcp        0      0 :::22                       :::*                        LISTEN      1035/sshd\nudp        0      0 0.0.0.0:68                  0.0.0.0:*                               931/dhclient\nActive UNIX domain sockets (only servers)\nProto RefCnt Flags       Type       State         I-Node PID/Program name    Path\nunix  2      [ ACC ]     STREAM     LISTENING     6825   1/init              @/com/ubuntu/upstart\nunix  2      [ ACC ]     STREAM     LISTENING     8429   1003/dbus-daemon    /var/run/dbus/system_bus_socket\n```\n\n**å¦‚ä½•æŸ¥çœ‹ç½‘ç»œè¿æ¥çŠ¶å†µï¼Ÿ**\n\n```shell\n[root@centos6 ~ 13:22 #58]# netstat -an\nActive Internet connections (servers and established)\nProto Recv-Q Send-Q Local Address               Foreign Address             State\ntcp        0      0 0.0.0.0:22                  0.0.0.0:*                   LISTEN\ntcp        0      0 192.168.147.130:22          192.168.147.1:23893         ESTABLISHED\ntcp        0      0 :::22                       :::*                        LISTEN\nudp        0      0 0.0.0.0:68                  0.0.0.0:*\n```\n\n**å¦‚ä½•ç»Ÿè®¡ç³»ç»Ÿå½“å‰è¿›ç¨‹è¿æ¥æ•°ï¼Ÿ**\n\n- è¾“å…¥å‘½ä»¤ `netstat -an | grep ESTABLISHED | wc -l` ã€‚\n- è¾“å‡ºç»“æœ `177` ã€‚ä¸€å…±æœ‰ 177 è¿æ¥æ•°ã€‚\n\n**ç”¨ netstat å‘½ä»¤é…åˆå…¶ä»–å‘½ä»¤ï¼ŒæŒ‰ç…§æº IP ç»Ÿè®¡æ‰€æœ‰åˆ° 80 ç«¯å£çš„ ESTABLISHED çŠ¶æ€é“¾æ¥çš„ä¸ªæ•°ï¼Ÿ**\n\n> ä¸¥æ ¼æ¥è¯´ï¼Œè¿™ä¸ªé¢˜ç›®è€ƒéªŒçš„æ˜¯å¯¹ awk çš„ä½¿ç”¨ã€‚\n\né¦–å…ˆï¼Œä½¿ç”¨ `netstat -an|grep ESTABLISHED` å‘½ä»¤ã€‚ç»“æœå¦‚ä¸‹ï¼š\n\n```shell\ntcp        0      0 120.27.146.122:80       113.65.18.33:62721      ESTABLISHED\ntcp        0      0 120.27.146.122:80       27.43.83.115:47148      ESTABLISHED\ntcp        0      0 120.27.146.122:58838    106.39.162.96:443       ESTABLISHED\ntcp        0      0 120.27.146.122:52304    203.208.40.121:443      ESTABLISHED\ntcp        0      0 120.27.146.122:33194    203.208.40.122:443      ESTABLISHED\ntcp        0      0 120.27.146.122:53758    101.37.183.144:443      ESTABLISHED\ntcp        0      0 120.27.146.122:27017    23.105.193.30:50556     ESTABLISHED\n```\n\n### ping å‘½ä»¤\n\nLinux ping å‘½ä»¤ç”¨äºæ£€æµ‹ä¸»æœºã€‚\n\næ‰§è¡Œ ping æŒ‡ä»¤ä¼šä½¿ç”¨ ICMP ä¼ è¾“åè®®ï¼Œå‘å‡ºè¦æ±‚å›åº”çš„ä¿¡æ¯ï¼Œè‹¥è¿œç«¯ä¸»æœºçš„ç½‘ç»œåŠŸèƒ½æ²¡æœ‰é—®é¢˜ï¼Œå°±ä¼šå›åº”è¯¥ä¿¡æ¯ï¼Œå› è€Œå¾—çŸ¥è¯¥ä¸»æœºè¿ä½œæ­£å¸¸ã€‚\n\næŒ‡å®šæ¥æ”¶åŒ…çš„æ¬¡æ•°\n\n```shell\nping -c 2 www.baidu.com\n```\n\n### telnet å‘½ä»¤\n\nLinux telnet å‘½ä»¤ç”¨äºè¿œç«¯ç™»å…¥ã€‚\n\næ‰§è¡Œ telnet æŒ‡ä»¤å¼€å¯ç»ˆç«¯æœºé˜¶æ®µä½œä¸šï¼Œå¹¶ç™»å…¥è¿œç«¯ä¸»æœºã€‚\n\nè¯­æ³•\n\n```\ntelnet [-8acdEfFKLrx][-b<ä¸»æœºåˆ«å>][-e<è„±ç¦»å­—ç¬¦>][-k<åŸŸå>][-l<ç”¨æˆ·åç§°>][-n<è®°å½•æ–‡ä»¶>][-S<æœåŠ¡ç±»å‹>][-X<è®¤è¯å½¢æ€>][ä¸»æœºåç§°æˆ–IPåœ°å€<é€šä¿¡ç«¯å£>]\n```\n\n**å‚æ•°è¯´æ˜**ï¼š\n\n- -8 å…è®¸ä½¿ç”¨ 8 ä½å­—ç¬¦èµ„æ–™ï¼ŒåŒ…æ‹¬è¾“å…¥ä¸è¾“å‡ºã€‚\n- -a å°è¯•è‡ªåŠ¨ç™»å…¥è¿œç«¯ç³»ç»Ÿã€‚\n- -b<ä¸»æœºåˆ«å> ä½¿ç”¨åˆ«åæŒ‡å®šè¿œç«¯ä¸»æœºåç§°ã€‚\n- -c ä¸è¯»å–ç”¨æˆ·ä¸“å±ç›®å½•é‡Œçš„.telnetrc æ–‡ä»¶ã€‚\n- -d å¯åŠ¨æ’é”™æ¨¡å¼ã€‚\n- -e<è„±ç¦»å­—ç¬¦> è®¾ç½®è„±ç¦»å­—ç¬¦ã€‚\n- -E æ»¤é™¤è„±ç¦»å­—ç¬¦ã€‚\n- -f æ­¤å‚æ•°çš„æ•ˆæœå’ŒæŒ‡å®š\"-F\"å‚æ•°ç›¸åŒã€‚\n- -F ä½¿ç”¨ Kerberos V5 è®¤è¯æ—¶ï¼ŒåŠ ä¸Šæ­¤å‚æ•°å¯æŠŠæœ¬åœ°ä¸»æœºçš„è®¤è¯æ•°æ®ä¸Šä¼ åˆ°è¿œç«¯ä¸»æœºã€‚\n- -k<åŸŸå> ä½¿ç”¨ Kerberos è®¤è¯æ—¶ï¼ŒåŠ ä¸Šæ­¤å‚æ•°è®©è¿œç«¯ä¸»æœºé‡‡ç”¨æŒ‡å®šçš„é¢†åŸŸåï¼Œè€Œéè¯¥ä¸»æœºçš„åŸŸåã€‚\n- -K ä¸è‡ªåŠ¨ç™»å…¥è¿œç«¯ä¸»æœºã€‚\n- -l<ç”¨æˆ·åç§°> æŒ‡å®šè¦ç™»å…¥è¿œç«¯ä¸»æœºçš„ç”¨æˆ·åç§°ã€‚\n- -L å…è®¸è¾“å‡º 8 ä½å­—ç¬¦èµ„æ–™ã€‚\n- -n<è®°å½•æ–‡ä»¶> æŒ‡å®šæ–‡ä»¶è®°å½•ç›¸å…³ä¿¡æ¯ã€‚\n- -r ä½¿ç”¨ç±»ä¼¼ rlogin æŒ‡ä»¤çš„ç”¨æˆ·ç•Œé¢ã€‚\n- -S<æœåŠ¡ç±»å‹> è®¾ç½® telnet è¿çº¿æ‰€éœ€çš„ IP TOS ä¿¡æ¯ã€‚\n- -x å‡è®¾ä¸»æœºæœ‰æ”¯æŒæ•°æ®åŠ å¯†çš„åŠŸèƒ½ï¼Œå°±ä½¿ç”¨å®ƒã€‚\n- -X<è®¤è¯å½¢æ€> å…³é—­æŒ‡å®šçš„è®¤è¯å½¢æ€ã€‚\n\n**å®ä¾‹**\n\nç™»å½•è¿œç¨‹ä¸»æœº\n\n```shell\n# ç™»å½•IPä¸º 192.168.0.5 çš„è¿œç¨‹ä¸»æœº\ntelnet 192.168.0.5 \n```\n\n## ç³»ç»Ÿç®¡ç†å‘½ä»¤\n\n### date å‘½ä»¤\n\næ˜¾ç¤ºæˆ–è®¾å®šç³»ç»Ÿçš„æ—¥æœŸä¸æ—¶é—´ã€‚\n\nå‘½ä»¤å‚æ•°ï¼š\n\n```\n-d<å­—ç¬¦ä¸²> ã€€æ˜¾ç¤ºå­—ç¬¦ä¸²æ‰€æŒ‡çš„æ—¥æœŸä¸æ—¶é—´ã€‚å­—ç¬¦ä¸²å‰åå¿…é¡»åŠ ä¸ŠåŒå¼•å·ã€‚\n-s<å­—ç¬¦ä¸²> ã€€æ ¹æ®å­—ç¬¦ä¸²æ¥è®¾ç½®æ—¥æœŸä¸æ—¶é—´ã€‚å­—ç¬¦ä¸²å‰åå¿…é¡»åŠ ä¸ŠåŒå¼•å·ã€‚\n-u ã€€æ˜¾ç¤ºGMTã€‚\n%H å°æ—¶(00-23)\n%I å°æ—¶(00-12)\n%M åˆ†é’Ÿ(ä»¥00-59æ¥è¡¨ç¤º)\n%s æ€»ç§’æ•°ã€‚èµ·ç®—æ—¶é—´ä¸º1970-01-01 00:00:00 UTCã€‚\n%S ç§’(ä»¥æœ¬åœ°çš„æƒ¯ç”¨æ³•æ¥è¡¨ç¤º)\n%a æ˜ŸæœŸçš„ç¼©å†™ã€‚\n%A æ˜ŸæœŸçš„å®Œæ•´åç§°ã€‚\n%d æ—¥æœŸ(ä»¥01-31æ¥è¡¨ç¤º)ã€‚\n%D æ—¥æœŸ(å«å¹´æœˆæ—¥)ã€‚\n%m æœˆä»½(ä»¥01-12æ¥è¡¨ç¤º)ã€‚\n%y å¹´ä»½(ä»¥00-99æ¥è¡¨ç¤º)ã€‚\n%Y å¹´ä»½(ä»¥å››ä½æ•°æ¥è¡¨ç¤º)ã€‚\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰æ˜¾ç¤ºä¸‹ä¸€å¤©\n\n```shell\ndate +%Y%m%d --date=\"+1 day\"  //æ˜¾ç¤ºä¸‹ä¸€å¤©çš„æ—¥æœŸ\n```\n\nï¼ˆ2ï¼‰-d å‚æ•°ä½¿ç”¨\n\n```shell\ndate -d \"nov 22\"  ä»Šå¹´çš„ 11 æœˆ 22 æ—¥æ˜¯æ˜ŸæœŸä¸‰\ndate -d '2 weeks' 2å‘¨åçš„æ—¥æœŸ\ndate -d 'next monday' (ä¸‹å‘¨ä¸€çš„æ—¥æœŸ)\ndate -d next-day +%Y%m%dï¼ˆæ˜å¤©çš„æ—¥æœŸï¼‰æˆ–è€…ï¼šdate -d tomorrow +%Y%m%d\ndate -d last-day +%Y%m%d(æ˜¨å¤©çš„æ—¥æœŸ) æˆ–è€…ï¼šdate -d yesterday +%Y%m%d\ndate -d last-month +%Y%m(ä¸Šä¸ªæœˆæ˜¯å‡ æœˆ)\ndate -d next-month +%Y%m(ä¸‹ä¸ªæœˆæ˜¯å‡ æœˆ)\n```\n\n### free å‘½ä»¤\n\næ˜¾ç¤ºç³»ç»Ÿå†…å­˜ä½¿ç”¨æƒ…å†µï¼ŒåŒ…æ‹¬ç‰©ç†å†…å­˜ã€äº¤äº’åŒºå†…å­˜(swap)å’Œå†…æ ¸ç¼“å†²åŒºå†…å­˜ã€‚\n\n**å‘½ä»¤å‚æ•°**ï¼š\n\n```\n-b ä»¥Byteæ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ\n-k ä»¥kbä¸ºå•ä½æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ\n-m ä»¥mbä¸ºå•ä½æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ\n-g ä»¥gbä¸ºå•ä½æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ\n-s<é—´éš”ç§’æ•°> æŒç»­æ˜¾ç¤ºå†…å­˜\n-t æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æ€»åˆ\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ\n\n```shell\nfree\nfree -k\nfree -m\n```\n\nï¼ˆ2ï¼‰ä»¥æ€»å’Œçš„å½¢å¼æ˜¾ç¤ºå†…å­˜çš„ä½¿ç”¨ä¿¡æ¯\n\n```shell\nfree -t\n```\n\nï¼ˆ3ï¼‰å‘¨æœŸæ€§æŸ¥è¯¢å†…å­˜ä½¿ç”¨æƒ…å†µ\n\n```shell\nfree -s 10\n```\n\n### kill å‘½ä»¤\n\nå‘é€æŒ‡å®šçš„ä¿¡å·åˆ°ç›¸åº”è¿›ç¨‹ã€‚ä¸æŒ‡å®šå‹å·å°†å‘é€ SIGTERMï¼ˆ15ï¼‰ç»ˆæ­¢æŒ‡å®šè¿›ç¨‹ã€‚å¦‚æœä»»æ— æ³•ç»ˆæ­¢è¯¥ç¨‹åºå¯ç”¨\"-KILL\" å‚æ•°ï¼Œå…¶å‘é€çš„ä¿¡å·ä¸º SIGKILL(9) ï¼Œå°†å¼ºåˆ¶ç»“æŸè¿›ç¨‹ï¼Œä½¿ç”¨ ps å‘½ä»¤æˆ–è€… jobs å‘½ä»¤å¯ä»¥æŸ¥çœ‹è¿›ç¨‹å·ã€‚root ç”¨æˆ·å°†å½±å“ç”¨æˆ·çš„è¿›ç¨‹ï¼Œé root ç”¨æˆ·åªèƒ½å½±å“è‡ªå·±çš„è¿›ç¨‹ã€‚\n\n**å¸¸ç”¨å‚æ•°**ï¼š\n\n```\n-l  ä¿¡å·ï¼Œè‹¥æœä¸åŠ ä¿¡å·çš„ç¼–å·å‚æ•°ï¼Œåˆ™ä½¿ç”¨â€œ-lâ€å‚æ•°ä¼šåˆ—å‡ºå…¨éƒ¨çš„ä¿¡å·åç§°\n-a  å½“å¤„ç†å½“å‰è¿›ç¨‹æ—¶ï¼Œä¸é™åˆ¶å‘½ä»¤åå’Œè¿›ç¨‹å·çš„å¯¹åº”å…³ç³»\n-p  æŒ‡å®škill å‘½ä»¤åªæ‰“å°ç›¸å…³è¿›ç¨‹çš„è¿›ç¨‹å·ï¼Œè€Œä¸å‘é€ä»»ä½•ä¿¡å·\n-s  æŒ‡å®šå‘é€ä¿¡å·\n-u  æŒ‡å®šç”¨æˆ·\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰å…ˆä½¿ç”¨ ps æŸ¥æ‰¾è¿›ç¨‹ pro1ï¼Œç„¶åç”¨ kill æ€æ‰\n\n```shell\nkill -9 $(ps -ef | grep pro1)\n```\n\n### ps å‘½ä»¤\n\nps(process status)ï¼Œç”¨æ¥æŸ¥çœ‹å½“å‰è¿è¡Œçš„è¿›ç¨‹çŠ¶æ€ï¼Œä¸€æ¬¡æ€§æŸ¥çœ‹ï¼Œå¦‚æœéœ€è¦åŠ¨æ€è¿ç»­ç»“æœä½¿ç”¨ top\n\nlinux ä¸Šè¿›ç¨‹æœ‰ 5 ç§çŠ¶æ€:\n\n1. è¿è¡Œ(æ­£åœ¨è¿è¡Œæˆ–åœ¨è¿è¡Œé˜Ÿåˆ—ä¸­ç­‰å¾…)\n2. ä¸­æ–­(ä¼‘çœ ä¸­, å—é˜», åœ¨ç­‰å¾…æŸä¸ªæ¡ä»¶çš„å½¢æˆæˆ–æ¥å—åˆ°ä¿¡å·)\n3. ä¸å¯ä¸­æ–­(æ”¶åˆ°ä¿¡å·ä¸å”¤é†’å’Œä¸å¯è¿è¡Œ, è¿›ç¨‹å¿…é¡»ç­‰å¾…ç›´åˆ°æœ‰ä¸­æ–­å‘ç”Ÿ)\n4. åƒµæ­»(è¿›ç¨‹å·²ç»ˆæ­¢, ä½†è¿›ç¨‹æè¿°ç¬¦å­˜åœ¨, ç›´åˆ°çˆ¶è¿›ç¨‹è°ƒç”¨ wait4()ç³»ç»Ÿè°ƒç”¨åé‡Šæ”¾)\n5. åœæ­¢(è¿›ç¨‹æ”¶åˆ° SIGSTOP, SIGSTP, SIGTIN, SIGTOU ä¿¡å·ååœæ­¢è¿è¡Œè¿è¡Œ)\n\nps å·¥å…·æ ‡è¯†è¿›ç¨‹çš„ 5 ç§çŠ¶æ€ç :\n\n```\nD ä¸å¯ä¸­æ–­ uninterruptible sleep (usually IO)\nR è¿è¡Œ runnable (on run queue)\nS ä¸­æ–­ sleeping\nT åœæ­¢ traced or stopped\nZ åƒµæ­» a defunct (â€zombieâ€) process\n```\n\n**å‘½ä»¤å‚æ•°**ï¼š\n\n```\n-A æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹\na æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹\n-a æ˜¾ç¤ºåŒä¸€ç»ˆç«¯ä¸‹æ‰€æœ‰è¿›ç¨‹\nc æ˜¾ç¤ºè¿›ç¨‹çœŸå®åç§°\ne æ˜¾ç¤ºç¯å¢ƒå˜é‡\nf æ˜¾ç¤ºè¿›ç¨‹é—´çš„å…³ç³»\nr æ˜¾ç¤ºå½“å‰ç»ˆç«¯è¿è¡Œçš„è¿›ç¨‹\n-aux æ˜¾ç¤ºæ‰€æœ‰åŒ…å«å…¶å®ƒä½¿ç”¨çš„è¿›ç¨‹\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰æ˜¾ç¤ºå½“å‰æ‰€æœ‰è¿›ç¨‹ç¯å¢ƒå˜é‡åŠè¿›ç¨‹é—´å…³ç³»\n\n```shell\nps -ef\n```\n\nï¼ˆ2ï¼‰æ˜¾ç¤ºå½“å‰æ‰€æœ‰è¿›ç¨‹\n\n```shell\nps -A\n```\n\nï¼ˆ3ï¼‰ä¸ grep è”ç”¨æŸ¥æ‰¾æŸè¿›ç¨‹\n\n```shell\nps -aux | grep apache\n```\n\nï¼ˆ4ï¼‰æ‰¾å‡ºä¸ cron ä¸ syslog è¿™ä¸¤ä¸ªæœåŠ¡æœ‰å…³çš„ PID å·ç \n\n```shell\nps aux | grep '(cron|syslog)'\n```\n\n### rpm å‘½ä»¤\n\nLinux rpm å‘½ä»¤ç”¨äºç®¡ç†å¥—ä»¶ã€‚\n\nrpm(redhat package manager) åŸæœ¬æ˜¯ Red Hat Linux å‘è¡Œç‰ˆä¸“é—¨ç”¨æ¥ç®¡ç† Linux å„é¡¹å¥—ä»¶çš„ç¨‹åºï¼Œç”±äºå®ƒéµå¾ª GPL è§„åˆ™ä¸”åŠŸèƒ½å¼ºå¤§æ–¹ä¾¿ï¼Œå› è€Œå¹¿å—æ¬¢è¿ã€‚é€æ¸å—åˆ°å…¶ä»–å‘è¡Œç‰ˆçš„é‡‡ç”¨ã€‚RPM å¥—ä»¶ç®¡ç†æ–¹å¼çš„å‡ºç°ï¼Œè®© Linux æ˜“äºå®‰è£…ï¼Œå‡çº§ï¼Œé—´æ¥æå‡äº† Linux çš„é€‚ç”¨åº¦ã€‚\n\n```shell\n# æŸ¥çœ‹ç³»ç»Ÿè‡ªå¸¦jdk\nrpm -qa | grep jdk\n# åˆ é™¤ç³»ç»Ÿè‡ªå¸¦jdk\nrpm -e --nodeps æŸ¥çœ‹jdkæ˜¾ç¤ºçš„æ•°æ®\n# å®‰è£…jdk\nrpm -ivh jdk-7u80-linux-x64.rpm\n```\n\n### top å‘½ä»¤\n\næ˜¾ç¤ºå½“å‰ç³»ç»Ÿæ­£åœ¨æ‰§è¡Œçš„è¿›ç¨‹çš„ç›¸å…³ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¿›ç¨‹ IDã€å†…å­˜å ç”¨ç‡ã€CPU å ç”¨ç‡ç­‰\n\n**å¸¸ç”¨å‚æ•°**ï¼š\n\n```\n-c æ˜¾ç¤ºå®Œæ•´çš„è¿›ç¨‹å‘½ä»¤\n-s ä¿å¯†æ¨¡å¼\n-p <è¿›ç¨‹å·> æŒ‡å®šè¿›ç¨‹æ˜¾ç¤º\n-n <æ¬¡æ•°>å¾ªç¯æ˜¾ç¤ºæ¬¡æ•°\n```\n\n**å®ä¾‹**ï¼š\n\n```shell\ntop - 14:06:23 up 70 days, 16:44,  2 users,  load average: 1.25, 1.32, 1.35\nTasks: 206 total,   1 running, 205 sleeping,   0 stopped,   0 zombie\nCpu(s):  5.9%us,  3.4%sy,  0.0%ni, 90.4%id,  0.0%wa,  0.0%hi,  0.2%si,  0.0%st\nMem:  32949016k total, 14411180k used, 18537836k free,   169884k buffers\nSwap: 32764556k total,        0k used, 32764556k free,  3612636k cached\nPID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND  \n28894 root      22   0 1501m 405m  10m S 52.2  1.3   2534:16 java  \n```\n\nå‰äº”è¡Œæ˜¯å½“å‰ç³»ç»Ÿæƒ…å†µæ•´ä½“çš„ç»Ÿè®¡ä¿¡æ¯åŒºã€‚\n\n**ç¬¬ä¸€è¡Œï¼Œä»»åŠ¡é˜Ÿåˆ—ä¿¡æ¯ï¼ŒåŒ uptime å‘½ä»¤çš„æ‰§è¡Œç»“æœï¼Œå…·ä½“å‚æ•°è¯´æ˜æƒ…å†µå¦‚ä¸‹**ï¼š\n\n14:06:23 â€” å½“å‰ç³»ç»Ÿæ—¶é—´\n\nup 70 days, 16:44 â€” ç³»ç»Ÿå·²ç»è¿è¡Œäº† 70 å¤© 16 å°æ—¶ 44 åˆ†é’Ÿï¼ˆåœ¨è¿™æœŸé—´ç³»ç»Ÿæ²¡æœ‰é‡å¯è¿‡çš„å†ï¼ï¼‰\n\n2 users â€” å½“å‰æœ‰ 2 ä¸ªç”¨æˆ·ç™»å½•ç³»ç»Ÿ\n\nload average: 1.15, 1.42, 1.44 â€” load average åé¢çš„ä¸‰ä¸ªæ•°åˆ†åˆ«æ˜¯ 1 åˆ†é’Ÿã€5 åˆ†é’Ÿã€15 åˆ†é’Ÿçš„è´Ÿè½½æƒ…å†µã€‚\n\nload average æ•°æ®æ˜¯æ¯éš” 5 ç§’é’Ÿæ£€æŸ¥ä¸€æ¬¡æ´»è·ƒçš„è¿›ç¨‹æ•°ï¼Œç„¶åæŒ‰ç‰¹å®šç®—æ³•è®¡ç®—å‡ºçš„æ•°å€¼ã€‚å¦‚æœè¿™ä¸ªæ•°é™¤ä»¥é€»è¾‘ CPU çš„æ•°é‡ï¼Œç»“æœé«˜äº 5 çš„æ—¶å€™å°±è¡¨æ˜ç³»ç»Ÿåœ¨è¶…è´Ÿè·è¿è½¬äº†ã€‚\n\n**ç¬¬äºŒè¡Œï¼ŒTasks â€” ä»»åŠ¡ï¼ˆè¿›ç¨‹ï¼‰ï¼Œå…·ä½“ä¿¡æ¯è¯´æ˜å¦‚ä¸‹**ï¼š\n\nç³»ç»Ÿç°åœ¨å…±æœ‰ 206 ä¸ªè¿›ç¨‹ï¼Œå…¶ä¸­å¤„äºè¿è¡Œä¸­çš„æœ‰ 1 ä¸ªï¼Œ205 ä¸ªåœ¨ä¼‘çœ ï¼ˆsleepï¼‰ï¼Œstoped çŠ¶æ€çš„æœ‰ 0 ä¸ªï¼Œzombie çŠ¶æ€ï¼ˆåƒµå°¸ï¼‰çš„æœ‰ 0 ä¸ªã€‚\n\n**ç¬¬ä¸‰è¡Œï¼ŒcpuçŠ¶æ€ä¿¡æ¯ï¼Œå…·ä½“å±æ€§è¯´æ˜å¦‚ä¸‹**ï¼š\n\n```\n5.9%us â€” ç”¨æˆ·ç©ºé—´å ç”¨CPUçš„ç™¾åˆ†æ¯”ã€‚\n3.4% sy â€” å†…æ ¸ç©ºé—´å ç”¨CPUçš„ç™¾åˆ†æ¯”ã€‚\n0.0% ni â€” æ”¹å˜è¿‡ä¼˜å…ˆçº§çš„è¿›ç¨‹å ç”¨CPUçš„ç™¾åˆ†æ¯”\n90.4% id â€” ç©ºé—²CPUç™¾åˆ†æ¯”\n0.0% wa â€” IOç­‰å¾…å ç”¨CPUçš„ç™¾åˆ†æ¯”\n0.0% hi â€” ç¡¬ä¸­æ–­ï¼ˆHardware IRQï¼‰å ç”¨CPUçš„ç™¾åˆ†æ¯”\n0.2% si â€” è½¯ä¸­æ–­ï¼ˆSoftware Interruptsï¼‰å ç”¨CPUçš„ç™¾åˆ†æ¯”\n```\n\n**å¤‡æ³¨**ï¼šåœ¨è¿™é‡Œ CPU çš„ä½¿ç”¨æ¯”ç‡å’Œ windows æ¦‚å¿µä¸åŒï¼Œéœ€è¦ç†è§£ linux ç³»ç»Ÿç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´çš„ç›¸å…³çŸ¥è¯†ï¼\n\nç¬¬å››è¡Œï¼Œå†…å­˜çŠ¶æ€ï¼Œå…·ä½“ä¿¡æ¯å¦‚ä¸‹ï¼š\n\n```\n32949016k total â€” ç‰©ç†å†…å­˜æ€»é‡ï¼ˆ32GBï¼‰\n14411180k used â€” ä½¿ç”¨ä¸­çš„å†…å­˜æ€»é‡ï¼ˆ14GBï¼‰\n18537836k free â€” ç©ºé—²å†…å­˜æ€»é‡ï¼ˆ18GBï¼‰\n169884k buffers â€” ç¼“å­˜çš„å†…å­˜é‡ ï¼ˆ169Mï¼‰\n```\n\n**ç¬¬äº”è¡Œï¼Œswapäº¤æ¢åˆ†åŒºä¿¡æ¯ï¼Œå…·ä½“ä¿¡æ¯è¯´æ˜å¦‚ä¸‹**ï¼š\n\n```\n32764556k total â€” äº¤æ¢åŒºæ€»é‡ï¼ˆ32GBï¼‰\n0k used â€” ä½¿ç”¨çš„äº¤æ¢åŒºæ€»é‡ï¼ˆ0Kï¼‰\n32764556k free â€” ç©ºé—²äº¤æ¢åŒºæ€»é‡ï¼ˆ32GBï¼‰\n3612636k cached â€” ç¼“å†²çš„äº¤æ¢åŒºæ€»é‡ï¼ˆ3.6GBï¼‰\n```\n\n**ç¬¬å…­è¡Œï¼Œç©ºè¡Œã€‚**\n\n**ç¬¬ä¸ƒè¡Œä»¥ä¸‹ï¼šå„è¿›ç¨‹ï¼ˆä»»åŠ¡ï¼‰çš„çŠ¶æ€ç›‘æ§ï¼Œé¡¹ç›®åˆ—ä¿¡æ¯è¯´æ˜å¦‚ä¸‹**ï¼š\n\n```\nPID â€” è¿›ç¨‹id\nUSER â€” è¿›ç¨‹æ‰€æœ‰è€…\nPR â€” è¿›ç¨‹ä¼˜å…ˆçº§\nNI â€” niceå€¼ã€‚è´Ÿå€¼è¡¨ç¤ºé«˜ä¼˜å…ˆçº§ï¼Œæ­£å€¼è¡¨ç¤ºä½ä¼˜å…ˆçº§\nVIRT â€” è¿›ç¨‹ä½¿ç”¨çš„è™šæ‹Ÿå†…å­˜æ€»é‡ï¼Œå•ä½kbã€‚VIRT=SWAP+RES\nRES â€” è¿›ç¨‹ä½¿ç”¨çš„ã€æœªè¢«æ¢å‡ºçš„ç‰©ç†å†…å­˜å¤§å°ï¼Œå•ä½kbã€‚RES=CODE+DATA\nSHR â€” å…±äº«å†…å­˜å¤§å°ï¼Œå•ä½kb\nS â€” è¿›ç¨‹çŠ¶æ€ã€‚D=ä¸å¯ä¸­æ–­çš„ç¡çœ çŠ¶æ€ R=è¿è¡Œ S=ç¡çœ  T=è·Ÿè¸ª/åœæ­¢ Z=åƒµå°¸è¿›ç¨‹\n%CPU â€” ä¸Šæ¬¡æ›´æ–°åˆ°ç°åœ¨çš„CPUæ—¶é—´å ç”¨ç™¾åˆ†æ¯”\n%MEM â€” è¿›ç¨‹ä½¿ç”¨çš„ç‰©ç†å†…å­˜ç™¾åˆ†æ¯”\nTIME+ â€” è¿›ç¨‹ä½¿ç”¨çš„CPUæ—¶é—´æ€»è®¡ï¼Œå•ä½1/100ç§’\nCOMMAND â€” è¿›ç¨‹åç§°ï¼ˆå‘½ä»¤å/å‘½ä»¤è¡Œï¼‰\n```\n\n**top äº¤äº’å‘½ä»¤**\n\n```\nh æ˜¾ç¤ºtopäº¤äº’å‘½ä»¤å¸®åŠ©ä¿¡æ¯\nc åˆ‡æ¢æ˜¾ç¤ºå‘½ä»¤åç§°å’Œå®Œæ•´å‘½ä»¤è¡Œ\nm ä»¥å†…å­˜ä½¿ç”¨ç‡æ’åº\nP æ ¹æ®CPUä½¿ç”¨ç™¾åˆ†æ¯”å¤§å°è¿›è¡Œæ’åº\nT æ ¹æ®æ—¶é—´/ç´¯è®¡æ—¶é—´è¿›è¡Œæ’åº\nW å°†å½“å‰è®¾ç½®å†™å…¥~/.toprcæ–‡ä»¶ä¸­\noæˆ–è€…O æ”¹å˜æ˜¾ç¤ºé¡¹ç›®çš„é¡ºåº\n```\n\n### yum å‘½ä»¤\n\nyumï¼ˆ Yellow dog Updater, Modifiedï¼‰æ˜¯ä¸€ä¸ªåœ¨ Fedora å’Œ RedHat ä»¥åŠ SUSE ä¸­çš„ Shell å‰ç«¯è½¯ä»¶åŒ…ç®¡ç†å™¨ã€‚\n\nåŸºæ–¼ RPM åŒ…ç®¡ç†ï¼Œèƒ½å¤Ÿä»æŒ‡å®šçš„æœåŠ¡å™¨è‡ªåŠ¨ä¸‹è½½ RPM åŒ…å¹¶ä¸”å®‰è£…ï¼Œå¯ä»¥è‡ªåŠ¨å¤„ç†ä¾èµ–æ€§å…³ç³»ï¼Œå¹¶ä¸”ä¸€æ¬¡å®‰è£…æ‰€æœ‰ä¾èµ–çš„è½¯ä½“åŒ…ï¼Œæ— é¡»ç¹çåœ°ä¸€æ¬¡æ¬¡ä¸‹è½½ã€å®‰è£…ã€‚\n\nyum æä¾›äº†æŸ¥æ‰¾ã€å®‰è£…ã€åˆ é™¤æŸä¸€ä¸ªã€ä¸€ç»„ç”šè‡³å…¨éƒ¨è½¯ä»¶åŒ…çš„å‘½ä»¤ï¼Œè€Œä¸”å‘½ä»¤ç®€æ´è€Œåˆå¥½è®°ã€‚\n\n- 1.åˆ—å‡ºæ‰€æœ‰å¯æ›´æ–°çš„è½¯ä»¶æ¸…å•å‘½ä»¤ï¼šyum check-update\n- 2.æ›´æ–°æ‰€æœ‰è½¯ä»¶å‘½ä»¤ï¼šyum update\n- 3.ä»…å®‰è£…æŒ‡å®šçš„è½¯ä»¶å‘½ä»¤ï¼šyum install <package_name>\n- 4.ä»…æ›´æ–°æŒ‡å®šçš„è½¯ä»¶å‘½ä»¤ï¼šyum update <package_name>\n- 5.åˆ—å‡ºæ‰€æœ‰å¯å®‰è£çš„è½¯ä»¶æ¸…å•å‘½ä»¤ï¼šyum list\n- 6.åˆ é™¤è½¯ä»¶åŒ…å‘½ä»¤ï¼šyum remove <package_name>\n- 7.æŸ¥æ‰¾è½¯ä»¶åŒ… å‘½ä»¤ï¼šyum search\n- 8.æ¸…é™¤ç¼“å­˜å‘½ä»¤:\n\t- yum clean packages: æ¸…é™¤ç¼“å­˜ç›®å½•ä¸‹çš„è½¯ä»¶åŒ…\n\t- yum clean headers: æ¸…é™¤ç¼“å­˜ç›®å½•ä¸‹çš„ headers\n\t- yum clean oldheaders: æ¸…é™¤ç¼“å­˜ç›®å½•ä¸‹æ—§çš„ headers\n\t- yum clean, yum clean all (= yum clean packages; yum clean oldheaders) :æ¸…é™¤ç¼“å­˜ç›®å½•ä¸‹çš„è½¯ä»¶åŒ…åŠæ—§çš„ headers\n\n**å®ä¾‹**\n\nå®‰è£… pam-devel\n\n```shell\n[root@www ~]# yum install pam-devel\n```\n\n## å¤‡ä»½å‹ç¼©å‘½ä»¤\n\n### bzip2 å‘½ä»¤\n\n- åˆ›å»º `*.bz2` å‹ç¼©æ–‡ä»¶ï¼š`bzip2 test.txt` ã€‚\n- è§£å‹ `*.bz2` æ–‡ä»¶ï¼š`bzip2 -d test.txt.bz2` ã€‚\n\n### gzip å‘½ä»¤\n\n- åˆ›å»ºä¸€ä¸ª `*.gz` çš„å‹ç¼©æ–‡ä»¶ï¼š`gzip test.txt` ã€‚\n- è§£å‹ `*.gz` æ–‡ä»¶ï¼š`gzip -d test.txt.gz` ã€‚\n- æ˜¾ç¤ºå‹ç¼©çš„æ¯”ç‡ï¼š`gzip -l *.gz` ã€‚\n\n### tar å‘½ä»¤\n\nç”¨æ¥å‹ç¼©å’Œè§£å‹æ–‡ä»¶ã€‚tar æœ¬èº«ä¸å…·æœ‰å‹ç¼©åŠŸèƒ½ï¼Œåªå…·æœ‰æ‰“åŒ…åŠŸèƒ½ï¼Œæœ‰å…³å‹ç¼©åŠè§£å‹æ˜¯è°ƒç”¨å…¶å®ƒçš„åŠŸèƒ½æ¥å®Œæˆã€‚\n\nå¼„æ¸…ä¸¤ä¸ªæ¦‚å¿µï¼šæ‰“åŒ…å’Œå‹ç¼©ã€‚æ‰“åŒ…æ˜¯æŒ‡å°†ä¸€å¤§å †æ–‡ä»¶æˆ–ç›®å½•å˜æˆä¸€ä¸ªæ€»çš„æ–‡ä»¶ï¼›å‹ç¼©åˆ™æ˜¯å°†ä¸€ä¸ªå¤§çš„æ–‡ä»¶é€šè¿‡ä¸€äº›å‹ç¼©ç®—æ³•å˜æˆä¸€ä¸ªå°æ–‡ä»¶\n\n**å¸¸ç”¨å‚æ•°**ï¼š\n\n```\n-c å»ºç«‹æ–°çš„å‹ç¼©æ–‡ä»¶\n-f æŒ‡å®šå‹ç¼©æ–‡ä»¶\n-r æ·»åŠ æ–‡ä»¶åˆ°å·²ç»å‹ç¼©æ–‡ä»¶åŒ…ä¸­\n-u æ·»åŠ æ”¹äº†å’Œç°æœ‰çš„æ–‡ä»¶åˆ°å‹ç¼©åŒ…ä¸­\n-x ä»å‹ç¼©åŒ…ä¸­æŠ½å–æ–‡ä»¶\n-t æ˜¾ç¤ºå‹ç¼©æ–‡ä»¶ä¸­çš„å†…å®¹\n-z æ”¯æŒgzipå‹ç¼©\n-j æ”¯æŒbzip2å‹ç¼©\n-Z æ”¯æŒcompressè§£å‹æ–‡ä»¶\n-v æ˜¾ç¤ºæ“ä½œè¿‡ç¨‹\n```\n\næœ‰å…³ gzip åŠ bzip2 å‹ç¼©:\n\n```\ngzip å®ä¾‹ï¼šå‹ç¼© gzip fileName .tar.gz å’Œ.tgz  è§£å‹ï¼šgunzip filename.gz æˆ– gzip -d filename.gz\n          å¯¹åº”ï¼štar zcvf filename.tar.gz     tar zxvf filename.tar.gz\n\nbz2å®ä¾‹ï¼šå‹ç¼© bzip2 -z filename .tar.bz2 è§£å‹ï¼šbunzip filename.bz2æˆ–bzip -d filename.bz2\n       å¯¹åº”ï¼štar jcvf filename.tar.gz         è§£å‹ï¼štar jxvf filename.tar.bz2\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰å°†æ–‡ä»¶å…¨éƒ¨æ‰“åŒ…æˆ tar åŒ…\n\n```shell\ntar -cvf log.tar 1.log,2.log æˆ–tar -cvf log.*\n```\n\nï¼ˆ2ï¼‰å°† /etc ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åŠç›®å½•æ‰“åŒ…åˆ°æŒ‡å®šç›®å½•ï¼Œå¹¶ä½¿ç”¨ gz å‹ç¼©\n\n```shell\ntar -zcvf /tmp/etc.tar.gz /etc\n```\n\nï¼ˆ3ï¼‰æŸ¥çœ‹åˆšæ‰“åŒ…çš„æ–‡ä»¶å†…å®¹ï¼ˆä¸€å®šåŠ  zï¼Œå› ä¸ºæ˜¯ä½¿ç”¨ gzip å‹ç¼©çš„ï¼‰\n\n```shell\ntar -ztvf /tmp/etc.tar.gz\n```\n\nï¼ˆ4ï¼‰è¦å‹ç¼©æ‰“åŒ… /home, /etc ï¼Œä½†ä¸è¦ /home/dmtsai\n\n```shell\ntar --exclude /home/dmtsai -zcvf myfile.tar.gz /home/* /etc\n```\n\n### unzip å‘½ä»¤\n\n- è§£å‹ `*.zip` æ–‡ä»¶ï¼š`unzip test.zip` ã€‚\n- æŸ¥çœ‹ `*.zip` æ–‡ä»¶çš„å†…å®¹ï¼š`unzip -l jasper.zip` ã€‚\n\n","source":"_posts/Javaå…«è‚¡æ–‡-Linux.md","raw":"---\ntitle: Javaå…«è‚¡æ–‡ - Linux\ncopyright: true\nmathjax: false\ncategories:\n  - Javaå…«è‚¡æ–‡\ndate: 2023-01-25 13:45:06\ntags:\ntoc: true\nurlname: linux\n---\n\n> æ•´ç†çš„ Linux ç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½\t<!--more-->\n\n## Linux æ¦‚è¿°\n\n### ä»€ä¹ˆæ˜¯Linux\n\nLinux æ˜¯ä¸€å¥—**å…è´¹ä½¿ç”¨å’Œè‡ªç”±ä¼ æ’­çš„ç±» Unix æ“ä½œç³»ç»Ÿ**ï¼Œæ˜¯ä¸€ä¸ªåŸºäº POSIX å’Œ Unix çš„å¤šç”¨æˆ·ã€å¤šä»»åŠ¡ã€æ”¯æŒå¤šçº¿ç¨‹å’Œå¤š CPU çš„æ“ä½œç³»ç»Ÿã€‚å®ƒèƒ½è¿è¡Œä¸»è¦çš„ Unix å·¥å…·è½¯ä»¶ã€åº”ç”¨ç¨‹åºå’Œç½‘ç»œåè®®ã€‚å®ƒæ”¯æŒ 32 ä½å’Œ 64 ä½ç¡¬ä»¶ã€‚Linux ç»§æ‰¿äº† Unix ä»¥ç½‘ç»œä¸ºæ ¸å¿ƒçš„è®¾è®¡æ€æƒ³ï¼Œæ˜¯ä¸€ä¸ªæ€§èƒ½ç¨³å®šçš„å¤šç”¨æˆ·ç½‘ç»œæ“ä½œç³»ç»Ÿã€‚\n\n### Unixå’ŒLinuxæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\nLinux å’Œ Unix éƒ½æ˜¯åŠŸèƒ½å¼ºå¤§çš„æ“ä½œç³»ç»Ÿï¼Œéƒ½æ˜¯åº”ç”¨å¹¿æ³›çš„æœåŠ¡å™¨æ“ä½œç³»ç»Ÿï¼Œæœ‰å¾ˆå¤šç›¸ä¼¼ä¹‹å¤„ï¼Œç”šè‡³æœ‰ä¸€éƒ¨åˆ†äººé”™è¯¯åœ°è®¤ä¸º Unix å’Œ Linux æ“ä½œç³»ç»Ÿæ˜¯ä¸€æ ·çš„ï¼Œç„¶è€Œï¼Œäº‹å®å¹¶éå¦‚æ­¤ï¼Œä»¥ä¸‹æ˜¯ä¸¤è€…çš„åŒºåˆ«ã€‚\n\n1. å¼€æºæ€§\n\tLinux æ˜¯ä¸€æ¬¾å¼€æºæ“ä½œç³»ç»Ÿï¼Œä¸éœ€è¦ä»˜è´¹ï¼Œå³å¯ä½¿ç”¨ï¼›Unix æ˜¯ä¸€æ¬¾å¯¹æºç å®è¡ŒçŸ¥è¯†äº§æƒä¿æŠ¤çš„ä¼ ç»Ÿå•†ä¸šè½¯ä»¶ï¼Œä½¿ç”¨éœ€è¦ä»˜è´¹æˆæƒä½¿ç”¨ã€‚\n2. è·¨å¹³å°æ€§\n\tLinux æ“ä½œç³»ç»Ÿå…·æœ‰è‰¯å¥½çš„è·¨å¹³å°æ€§èƒ½ï¼Œå¯è¿è¡Œåœ¨å¤šç§ç¡¬ä»¶å¹³å°ä¸Šï¼›Unix æ“ä½œç³»ç»Ÿè·¨å¹³å°æ€§èƒ½è¾ƒå¼±ï¼Œå¤§å¤šéœ€ä¸ç¡¬ä»¶é…å¥—ä½¿ç”¨ã€‚\n3. å¯è§†åŒ–ç•Œé¢\n\tLinux é™¤äº†è¿›è¡Œå‘½ä»¤è¡Œæ“ä½œï¼Œè¿˜æœ‰çª—ä½“ç®¡ç†ç³»ç»Ÿï¼›Unix åªæ˜¯å‘½ä»¤è¡Œä¸‹çš„ç³»ç»Ÿã€‚\n4. ç¡¬ä»¶ç¯å¢ƒ\n\tLinux æ“ä½œç³»ç»Ÿå¯¹ç¡¬ä»¶çš„è¦æ±‚è¾ƒä½ï¼Œå®‰è£…æ–¹æ³•æ›´æ˜“æŒæ¡ï¼›Unix å¯¹ç¡¬ä»¶è¦æ±‚æ¯”è¾ƒè‹›åˆ»ï¼ŒæŒ‰ç…§éš¾åº¦è¾ƒå¤§ã€‚\n5. ç”¨æˆ·ç¾¤ä½“\n\tLinux çš„ç”¨æˆ·ç¾¤ä½“å¾ˆå¹¿æ³›ï¼Œä¸ªäººå’Œä¼ä¸šå‡å¯ä½¿ç”¨ï¼›Unix çš„ç”¨æˆ·ç¾¤ä½“æ¯”è¾ƒçª„ï¼Œå¤šæ˜¯å®‰å…¨æ€§è¦æ±‚é«˜çš„å¤§å‹ä¼ä¸šä½¿ç”¨ï¼Œå¦‚é“¶è¡Œã€ç”µä¿¡éƒ¨é—¨ç­‰ï¼Œæˆ–è€… Unix ç¡¬ä»¶å‚å•†ä½¿ç”¨ï¼Œå¦‚ Sun ç­‰ã€‚\n\tç›¸æ¯”äº Unix æ“ä½œç³»ç»Ÿï¼ŒLinux æ“ä½œç³»ç»Ÿæ›´å—å¹¿å¤§è®¡ç®—æœºçˆ±å¥½è€…çš„å–œçˆ±ï¼Œä¸»è¦åŸå› æ˜¯ Linux æ“ä½œç³»ç»Ÿå…·æœ‰ Unix æ“ä½œç³»ç»Ÿçš„å…¨éƒ¨åŠŸèƒ½ï¼Œå¹¶ä¸”èƒ½å¤Ÿåœ¨æ™®é€š PC è®¡ç®—æœºä¸Šå®ç°å…¨éƒ¨çš„ Unix ç‰¹æ€§ï¼Œå¼€æºå…è´¹çš„ç‰¹æ€§ï¼Œæ›´å®¹æ˜“æ™®åŠä½¿ç”¨ï¼\n\n### ä»€ä¹ˆæ˜¯ Linux å†…æ ¸ï¼Ÿ\n\nLinux ç³»ç»Ÿçš„æ ¸å¿ƒæ˜¯å†…æ ¸ã€‚å†…æ ¸æ§åˆ¶ç€è®¡ç®—æœºç³»ç»Ÿä¸Šçš„æ‰€æœ‰ç¡¬ä»¶å’Œè½¯ä»¶ï¼Œåœ¨å¿…è¦æ—¶åˆ†é…ç¡¬ä»¶ï¼Œå¹¶æ ¹æ®éœ€è¦æ‰§è¡Œè½¯ä»¶ã€‚\n\n1. ç³»ç»Ÿå†…å­˜ç®¡ç†\n2. åº”ç”¨ç¨‹åºç®¡ç†\n3. ç¡¬ä»¶è®¾å¤‡ç®¡ç†\n4. æ–‡ä»¶ç³»ç»Ÿç®¡ç†\n\n### Linuxçš„åŸºæœ¬ç»„ä»¶æ˜¯ä»€ä¹ˆï¼Ÿ\n\nå°±åƒä»»ä½•å…¶ä»–å…¸å‹çš„æ“ä½œç³»ç»Ÿä¸€æ ·ï¼ŒLinux æ‹¥æœ‰æ‰€æœ‰è¿™äº›ç»„ä»¶ï¼šå†…æ ¸ï¼Œshell å’Œ GUIï¼Œç³»ç»Ÿå®ç”¨ç¨‹åºå’Œåº”ç”¨ç¨‹åºã€‚Linux æ¯”å…¶ä»–æ“ä½œç³»ç»Ÿæ›´å…·ä¼˜åŠ¿çš„æ˜¯æ¯ä¸ªæ–¹é¢éƒ½é™„å¸¦å…¶ä»–åŠŸèƒ½ï¼Œæ‰€æœ‰ä»£ç éƒ½å¯ä»¥å…è´¹ä¸‹è½½ã€‚\n\n### Linux çš„ä½“ç³»ç»“æ„\n\nä»å¤§çš„æ–¹é¢è®²ï¼ŒLinux ä½“ç³»ç»“æ„å¯ä»¥åˆ†ä¸ºä¸¤å—ï¼š\n\n![Linux ä½“ç³»ç»“æ„](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1RoaW5rV29u,size_16,color_FFFFFF,t_70.png)\n\n- ç”¨æˆ·ç©ºé—´(User Space) ï¼šç”¨æˆ·ç©ºé—´åˆåŒ…æ‹¬ç”¨æˆ·çš„åº”ç”¨ç¨‹åº(User Applications)ã€C åº“(C Library) ã€‚\n- å†…æ ¸ç©ºé—´(Kernel Space) ï¼šå†…æ ¸ç©ºé—´åˆåŒ…æ‹¬ç³»ç»Ÿè°ƒç”¨æ¥å£(System Call Interface)ã€å†…æ ¸(Kernel)ã€å¹³å°æ¶æ„ç›¸å…³çš„ä»£ç (Architecture-Dependent Kernel Code) ã€‚\n\n**ä¸ºä»€ä¹ˆ Linux ä½“ç³»ç»“æ„è¦åˆ†ä¸ºç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´çš„åŸå› ï¼Ÿ**\n\n1. ç°ä»£ CPU å®ç°äº†ä¸åŒçš„å·¥ä½œæ¨¡å¼ï¼Œä¸åŒæ¨¡å¼ä¸‹ CPU å¯ä»¥æ‰§è¡Œçš„æŒ‡ä»¤å’Œè®¿é—®çš„å¯„å­˜å™¨ä¸åŒã€‚\n2. Linux ä» CPU çš„è§’åº¦å‡ºå‘ï¼Œä¸ºäº†ä¿æŠ¤å†…æ ¸çš„å®‰å…¨ï¼ŒæŠŠç³»ç»Ÿåˆ†æˆäº†ä¸¤éƒ¨åˆ†ã€‚\n\nç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´æ˜¯ç¨‹åºæ‰§è¡Œçš„**ä¸¤ç§ä¸åŒçš„çŠ¶æ€**ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼å®Œæˆç”¨æˆ·ç©ºé—´åˆ°å†…æ ¸ç©ºé—´çš„è½¬ç§»ï¼š\n\n1ï¼‰ç³»ç»Ÿè°ƒç”¨ï¼›2ï¼‰ç¡¬ä»¶ä¸­æ–­ã€‚\n\n### BASHå’ŒDOSä¹‹é—´çš„åŸºæœ¬åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\n\nBASH å’Œ DOS æ§åˆ¶å°ä¹‹é—´çš„ä¸»è¦åŒºåˆ«åœ¨äº 3 ä¸ªæ–¹é¢ï¼š\n\n- BASH å‘½ä»¤åŒºåˆ†å¤§å°å†™ï¼Œè€Œ DOS å‘½ä»¤åˆ™ä¸åŒºåˆ†ï¼›\n- åœ¨ BASH ä¸‹ï¼Œ/ character æ˜¯ç›®å½•åˆ†éš”ç¬¦ï¼Œ\\ä½œä¸ºè½¬ä¹‰å­—ç¬¦ã€‚åœ¨ DOS ä¸‹ï¼Œ/ç”¨ä½œå‘½ä»¤å‚æ•°åˆ†éš”ç¬¦ï¼Œ\\æ˜¯ç›®å½•åˆ†éš”ç¬¦ï¼›\n- DOS éµå¾ªå‘½åæ–‡ä»¶ä¸­çš„çº¦å®šï¼Œå³ 8 ä¸ªå­—ç¬¦çš„æ–‡ä»¶ååè·Ÿä¸€ä¸ªç‚¹ï¼Œæ‰©å±•åä¸º 3 ä¸ªå­—ç¬¦ã€‚BASH æ²¡æœ‰éµå¾ªè¿™æ ·çš„æƒ¯ä¾‹ã€‚\n\n### Linux å¼€æœºå¯åŠ¨è¿‡ç¨‹ï¼Ÿ\n\n> äº†è§£å³å¯ã€‚\n\n1ã€ä¸»æœºåŠ ç”µè‡ªæ£€ï¼ŒåŠ è½½ BIOS ç¡¬ä»¶ä¿¡æ¯ã€‚\n\n2ã€è¯»å– MBR çš„å¼•å¯¼æ–‡ä»¶(GRUBã€LILO)ã€‚\n\n3ã€å¼•å¯¼ Linux å†…æ ¸ã€‚\n\n4ã€è¿è¡Œç¬¬ä¸€ä¸ªè¿›ç¨‹ init (è¿›ç¨‹å·æ°¸è¿œä¸º 1 )ã€‚\n\n5ã€è¿›å…¥ç›¸åº”çš„è¿è¡Œçº§åˆ«ã€‚\n\n6ã€è¿è¡Œç»ˆç«¯ï¼Œè¾“å…¥ç”¨æˆ·åå’Œå¯†ç ã€‚\n\n### Linuxç³»ç»Ÿç¼ºçœçš„è¿è¡Œçº§åˆ«ï¼Ÿ\n\n- å…³æœºã€‚\n- å•æœºç”¨æˆ·æ¨¡å¼ã€‚\n- å­—ç¬¦ç•Œé¢çš„å¤šç”¨æˆ·æ¨¡å¼(ä¸æ”¯æŒç½‘ç»œ)ã€‚\n- å­—ç¬¦ç•Œé¢çš„å¤šç”¨æˆ·æ¨¡å¼ã€‚\n- æœªåˆ†é…ä½¿ç”¨ã€‚\n- å›¾å½¢ç•Œé¢çš„å¤šç”¨æˆ·æ¨¡å¼ã€‚\n- é‡å¯ã€‚\n\n### Linux ä½¿ç”¨çš„è¿›ç¨‹é—´é€šä¿¡æ–¹å¼ï¼Ÿ\n\n> äº†è§£å³å¯ï¼Œä¸éœ€è¦å¤ªæ·±å…¥ã€‚\n\n- ç®¡é“(pipe)ã€æµç®¡é“(s_pipe)ã€æœ‰åç®¡é“(FIFO)ã€‚\n- ä¿¡å·(signal) ã€‚\n- æ¶ˆæ¯é˜Ÿåˆ—ã€‚\n- å…±äº«å†…å­˜ã€‚\n- ä¿¡å·é‡ã€‚\n- å¥—æ¥å­—(socket) ã€‚\n\n### Linux æœ‰å“ªäº›ç³»ç»Ÿæ—¥å¿—æ–‡ä»¶ï¼Ÿ\n\næ¯”è¾ƒé‡è¦çš„æ˜¯ `/var/log/messages` æ—¥å¿—æ–‡ä»¶ã€‚\n\nè¯¥æ—¥å¿—æ–‡ä»¶æ˜¯è®¸å¤šè¿›ç¨‹æ—¥å¿—æ–‡ä»¶çš„æ±‡æ€»ï¼Œä»è¯¥æ–‡ä»¶å¯ä»¥çœ‹å‡ºä»»ä½•å…¥ä¾µä¼å›¾æˆ–æˆåŠŸçš„å…¥ä¾µã€‚\n\n### ä»€ä¹ˆæ˜¯äº¤æ¢ç©ºé—´ï¼Ÿ\n\näº¤æ¢ç©ºé—´æ˜¯ Linux ä½¿ç”¨çš„ä¸€å®šç©ºé—´ï¼Œç”¨äºä¸´æ—¶ä¿å­˜ä¸€äº›å¹¶å‘è¿è¡Œçš„ç¨‹åºã€‚å½“ RAM æ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜æ¥å®¹çº³æ­£åœ¨æ‰§è¡Œçš„æ‰€æœ‰ç¨‹åºæ—¶ï¼Œå°±ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚\n\n### ä»€ä¹ˆæ˜¯rootå¸æˆ·\n\nroot å¸æˆ·å°±åƒä¸€ä¸ªç³»ç»Ÿç®¡ç†å‘˜å¸æˆ·ï¼Œå…è®¸ä½ å®Œå…¨æ§åˆ¶ç³»ç»Ÿã€‚ä½ å¯ä»¥åœ¨æ­¤å¤„åˆ›å»ºå’Œç»´æŠ¤ç”¨æˆ·å¸æˆ·ï¼Œä¸ºæ¯ä¸ªå¸æˆ·åˆ†é…ä¸åŒçš„æƒé™ã€‚æ¯æ¬¡å®‰è£… Linux æ—¶éƒ½æ˜¯é»˜è®¤å¸æˆ·ã€‚\n\n### ä»€ä¹ˆæ˜¯LILOï¼Ÿ\n\nLILO æ˜¯ Linux çš„å¼•å¯¼åŠ è½½ç¨‹åºã€‚å®ƒä¸»è¦ç”¨äºå°† Linux æ“ä½œç³»ç»ŸåŠ è½½åˆ°ä¸»å†…å­˜ä¸­ï¼Œä»¥ä¾¿å®ƒå¯ä»¥å¼€å§‹è¿è¡Œã€‚\n\n### ä»€ä¹ˆæ˜¯BASHï¼Ÿ\n\nBASH æ˜¯ Bourne Again SHell çš„ç¼©å†™ã€‚å®ƒç”± Steve Bourne ç¼–å†™ï¼Œä½œä¸ºåŸå§‹ Bourne Shellï¼ˆç”±/ bin / sh è¡¨ç¤ºï¼‰çš„æ›¿ä»£å“ã€‚å®ƒç»“åˆäº†åŸå§‹ç‰ˆæœ¬çš„ Bourne Shell çš„æ‰€æœ‰åŠŸèƒ½ï¼Œä»¥åŠå…¶ä»–åŠŸèƒ½ï¼Œä½¿å…¶æ›´å®¹æ˜“ä½¿ç”¨ã€‚ä»é‚£ä»¥åï¼Œå®ƒå·²è¢«æ”¹ç¼–ä¸ºè¿è¡Œ Linux çš„å¤§å¤šæ•°ç³»ç»Ÿçš„é»˜è®¤ shellã€‚\n\n### ä»€ä¹ˆæ˜¯CLIï¼Ÿ\n\n**å‘½ä»¤è¡Œç•Œé¢**ï¼ˆè‹±è¯­**ï¼šcommand-line interface**ï¼Œç¼©å†™]**ï¼šCLI**ï¼‰æ˜¯åœ¨å›¾å½¢ç”¨æˆ·ç•Œé¢å¾—åˆ°æ™®åŠä¹‹å‰ä½¿ç”¨æœ€ä¸ºå¹¿æ³›çš„ç”¨æˆ·ç•Œé¢ï¼Œå®ƒé€šå¸¸ä¸æ”¯æŒé¼ æ ‡ï¼Œç”¨æˆ·é€šè¿‡é”®ç›˜è¾“å…¥æŒ‡ä»¤ï¼Œè®¡ç®—æœºæ¥æ”¶åˆ°æŒ‡ä»¤åï¼Œäºˆä»¥æ‰§è¡Œã€‚ä¹Ÿæœ‰äººç§°ä¹‹ä¸º**å­—ç¬¦ç”¨æˆ·ç•Œé¢**ï¼ˆCUIï¼‰ã€‚\n\né€šå¸¸è®¤ä¸ºï¼Œå‘½ä»¤è¡Œç•Œé¢ï¼ˆCLIï¼‰æ²¡æœ‰å›¾å½¢ç”¨æˆ·ç•Œé¢ï¼ˆGUIï¼‰é‚£ä¹ˆæ–¹ä¾¿ç”¨æˆ·æ“ä½œã€‚å› ä¸ºï¼Œå‘½ä»¤è¡Œç•Œé¢çš„è½¯ä»¶é€šå¸¸éœ€è¦ç”¨æˆ·è®°å¿†æ“ä½œçš„å‘½ä»¤ï¼Œä½†æ˜¯ï¼Œç”±äºå…¶æœ¬èº«çš„ç‰¹ç‚¹ï¼Œå‘½ä»¤è¡Œç•Œé¢è¦è¾ƒå›¾å½¢ç”¨æˆ·ç•Œé¢èŠ‚çº¦è®¡ç®—æœºç³»ç»Ÿçš„èµ„æºã€‚åœ¨ç†Ÿè®°å‘½ä»¤çš„å‰æä¸‹ï¼Œä½¿ç”¨å‘½ä»¤è¡Œç•Œé¢å¾€å¾€è¦è¾ƒä½¿ç”¨å›¾å½¢ç”¨æˆ·ç•Œé¢çš„æ“ä½œé€Ÿåº¦è¦å¿«ã€‚æ‰€ä»¥ï¼Œå›¾å½¢ç”¨æˆ·ç•Œé¢çš„æ“ä½œç³»ç»Ÿä¸­ï¼Œéƒ½ä¿ç•™ç€å¯é€‰çš„å‘½ä»¤è¡Œç•Œé¢ã€‚\n\n### ä»€ä¹ˆæ˜¯GUIï¼Ÿ\n\nå›¾å½¢ç”¨æˆ·ç•Œé¢ï¼ˆGraphical User Interfaceï¼Œç®€ç§° GUIï¼Œåˆç§°å›¾å½¢ç”¨æˆ·æ¥å£ï¼‰æ˜¯æŒ‡é‡‡ç”¨å›¾å½¢æ–¹å¼æ˜¾ç¤ºçš„è®¡ç®—æœºæ“ä½œç”¨æˆ·ç•Œé¢ã€‚\n\nå›¾å½¢ç”¨æˆ·ç•Œé¢æ˜¯ä¸€ç§äººä¸è®¡ç®—æœºé€šä¿¡çš„ç•Œé¢æ˜¾ç¤ºæ ¼å¼ï¼Œå…è®¸ç”¨æˆ·ä½¿ç”¨é¼ æ ‡ç­‰è¾“å…¥è®¾å¤‡æ“çºµå±å¹•ä¸Šçš„å›¾æ ‡æˆ–èœå•é€‰é¡¹ï¼Œä»¥é€‰æ‹©å‘½ä»¤ã€è°ƒç”¨æ–‡ä»¶ã€å¯åŠ¨ç¨‹åºæˆ–æ‰§è¡Œå…¶å®ƒä¸€äº›æ—¥å¸¸ä»»åŠ¡ã€‚ä¸é€šè¿‡é”®ç›˜è¾“å…¥æ–‡æœ¬æˆ–å­—ç¬¦å‘½ä»¤æ¥å®Œæˆä¾‹è¡Œä»»åŠ¡çš„å­—ç¬¦ç•Œé¢ç›¸æ¯”ï¼Œå›¾å½¢ç”¨æˆ·ç•Œé¢æœ‰è®¸å¤šä¼˜ç‚¹ã€‚\n\n### å¼€æºçš„ä¼˜åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿ\n\nå¼€æºå…è®¸ä½ å°†è½¯ä»¶ï¼ˆåŒ…æ‹¬æºä»£ç ï¼‰å…è´¹åˆ†å‘ç»™ä»»ä½•æ„Ÿå…´è¶£çš„äººã€‚ç„¶åï¼Œäººä»¬å¯ä»¥æ·»åŠ åŠŸèƒ½ï¼Œç”šè‡³å¯ä»¥è°ƒè¯•å’Œæ›´æ­£æºä»£ç ä¸­çš„é”™è¯¯ã€‚å®ƒä»¬ç”šè‡³å¯ä»¥è®©å®ƒè¿è¡Œå¾—æ›´å¥½ï¼Œç„¶åå†æ¬¡è‡ªç”±åœ°é‡æ–°åˆ†é…è¿™äº›å¢å¼ºçš„æºä»£ç ã€‚è¿™æœ€ç»ˆä½¿ç¤¾åŒºä¸­çš„æ¯ä¸ªäººå—ç›Šã€‚\n\n### GNUé¡¹ç›®çš„é‡è¦æ€§æ˜¯ä»€ä¹ˆï¼Ÿ\n\nè¿™ç§æ‰€è°“çš„è‡ªç”±è½¯ä»¶è¿åŠ¨å…·æœ‰å¤šç§ä¼˜åŠ¿ï¼Œä¾‹å¦‚å¯ä»¥è‡ªç”±åœ°è¿è¡Œç¨‹åºä»¥åŠæ ¹æ®ä½ çš„éœ€è¦è‡ªç”±å­¦ä¹ å’Œä¿®æ”¹ç¨‹åºã€‚å®ƒè¿˜å…è®¸ä½ å°†è½¯ä»¶å‰¯æœ¬é‡æ–°åˆ†å‘ç»™å…¶ä»–äººï¼Œä»¥åŠè‡ªç”±æ”¹è¿›è½¯ä»¶å¹¶å°†å…¶å‘å¸ƒç»™å…¬ä¼—ã€‚\n\n## ç£ç›˜ã€ç›®å½•ã€æ–‡ä»¶\n\n### ç®€å• Linux æ–‡ä»¶ç³»ç»Ÿï¼Ÿ\n\n**åœ¨ Linux æ“ä½œç³»ç»Ÿä¸­ï¼Œæ‰€æœ‰è¢«æ“ä½œç³»ç»Ÿç®¡ç†çš„èµ„æºï¼Œä¾‹å¦‚ç½‘ç»œæ¥å£å¡ã€ç£ç›˜é©±åŠ¨å™¨ã€æ‰“å°æœºã€è¾“å…¥è¾“å‡ºè®¾å¤‡ã€æ™®é€šæ–‡ä»¶æˆ–æ˜¯ç›®å½•éƒ½è¢«çœ‹ä½œæ˜¯ä¸€ä¸ªæ–‡ä»¶ã€‚**\n\nä¹Ÿå°±æ˜¯è¯´åœ¨ Linux ç³»ç»Ÿä¸­æœ‰ä¸€ä¸ªé‡è¦çš„æ¦‚å¿µ**ï¼šä¸€åˆ‡éƒ½æ˜¯æ–‡ä»¶**ã€‚å…¶å®è¿™æ˜¯ Unix å“²å­¦çš„ä¸€ä¸ªä½“ç°ï¼Œè€Œ Linux æ˜¯é‡å†™ Unix è€Œæ¥ï¼Œæ‰€ä»¥è¿™ä¸ªæ¦‚å¿µä¹Ÿå°±ä¼ æ‰¿äº†ä¸‹æ¥ã€‚åœ¨ Unix ç³»ç»Ÿä¸­ï¼ŒæŠŠä¸€åˆ‡èµ„æºéƒ½çœ‹ä½œæ˜¯æ–‡ä»¶ï¼ŒåŒ…æ‹¬ç¡¬ä»¶è®¾å¤‡ã€‚UNIX ç³»ç»ŸæŠŠæ¯ä¸ªç¡¬ä»¶éƒ½çœ‹æˆæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œé€šå¸¸ç§°ä¸ºè®¾å¤‡æ–‡ä»¶ï¼Œè¿™æ ·ç”¨æˆ·å°±**å¯ä»¥ç”¨è¯»å†™æ–‡ä»¶çš„æ–¹å¼å®ç°å¯¹ç¡¬ä»¶çš„è®¿é—®**ã€‚\n\nLinux æ”¯æŒ 5 ç§æ–‡ä»¶ç±»å‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n\n![5 ç§æ–‡ä»¶ç±»å‹](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/format,png.png)\n\n### Linux çš„ç›®å½•ç»“æ„æ˜¯æ€æ ·çš„ï¼Ÿ\n\n> è¿™ä¸ªé—®é¢˜ï¼Œä¸€èˆ¬ä¸ä¼šé—®ã€‚æ›´å¤šæ˜¯å®é™…ä½¿ç”¨æ—¶ï¼Œéœ€è¦çŸ¥é“ã€‚\n\nLinux æ–‡ä»¶ç³»ç»Ÿçš„ç»“æ„å±‚æ¬¡é²œæ˜ï¼Œå°±åƒä¸€æ£µå€’ç«‹çš„æ ‘ï¼Œæœ€é¡¶å±‚æ˜¯å…¶æ ¹ç›®å½•ï¼š\n![Linux çš„ç›®å½•ç»“æ„](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/format,png-20230125135806288.png)\n\n**å¸¸è§ç›®å½•è¯´æ˜**ï¼š\n\n- **/bin**ï¼š å­˜æ”¾äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶(ls,cat,mkdir ç­‰)ï¼Œå¸¸ç”¨å‘½ä»¤ä¸€èˆ¬éƒ½åœ¨è¿™é‡Œï¼›\n- **/etc**ï¼š å­˜æ”¾ç³»ç»Ÿç®¡ç†å’Œé…ç½®æ–‡ä»¶ï¼›\n- **/home**ï¼š å­˜æ”¾æ‰€æœ‰ç”¨æˆ·æ–‡ä»¶çš„æ ¹ç›®å½•ï¼Œæ˜¯ç”¨æˆ·ä¸»ç›®å½•çš„åŸºç‚¹ï¼Œæ¯”å¦‚ç”¨æˆ· user çš„ä¸»ç›®å½•å°±æ˜¯/home/userï¼Œå¯ä»¥ç”¨~user è¡¨ç¤ºï¼›\n- **/usr **ï¼š ç”¨äºå­˜æ”¾ç³»ç»Ÿåº”ç”¨ç¨‹åºï¼›\n- **/opt**ï¼š é¢å¤–å®‰è£…çš„å¯é€‰åº”ç”¨ç¨‹åºåŒ…æ‰€æ”¾ç½®çš„ä½ç½®ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ tomcat ç­‰éƒ½å®‰è£…åˆ°è¿™é‡Œï¼›\n- **/proc**ï¼š è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿç›®å½•ï¼Œæ˜¯ç³»ç»Ÿå†…å­˜çš„æ˜ å°„ã€‚å¯ç›´æ¥è®¿é—®è¿™ä¸ªç›®å½•æ¥è·å–ç³»ç»Ÿä¿¡æ¯ï¼›\n- **/root**ï¼š è¶…çº§ç”¨æˆ·ï¼ˆç³»ç»Ÿç®¡ç†å‘˜ï¼‰çš„ä¸»ç›®å½•ï¼ˆç‰¹æƒé˜¶çº§ oï¼‰ï¼›\n- **/sbin:** å­˜æ”¾äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ï¼Œåªæœ‰ root æ‰èƒ½è®¿é—®ã€‚è¿™é‡Œå­˜æ”¾çš„æ˜¯ç³»ç»Ÿç®¡ç†å‘˜ä½¿ç”¨çš„ç³»ç»Ÿçº§åˆ«çš„ç®¡ç†å‘½ä»¤å’Œç¨‹åºã€‚å¦‚ ifconfig ç­‰ï¼›\n- **/dev**ï¼š ç”¨äºå­˜æ”¾è®¾å¤‡æ–‡ä»¶ï¼›\n- **/mnt**ï¼š ç³»ç»Ÿç®¡ç†å‘˜å®‰è£…ä¸´æ—¶æ–‡ä»¶ç³»ç»Ÿçš„å®‰è£…ç‚¹ï¼Œç³»ç»Ÿæä¾›è¿™ä¸ªç›®å½•æ˜¯è®©ç”¨æˆ·ä¸´æ—¶æŒ‚è½½å…¶ä»–çš„æ–‡ä»¶ç³»ç»Ÿï¼›\n- **/boot**ï¼š å­˜æ”¾ç”¨äºç³»ç»Ÿå¼•å¯¼æ—¶ä½¿ç”¨çš„å„ç§æ–‡ä»¶ï¼›\n- **/lib **ï¼š å­˜æ”¾ç€å’Œç³»ç»Ÿè¿è¡Œç›¸å…³çš„åº“æ–‡ä»¶ ï¼›\n- **/tmp**ï¼š ç”¨äºå­˜æ”¾å„ç§ä¸´æ—¶æ–‡ä»¶ï¼Œæ˜¯å…¬ç”¨çš„ä¸´æ—¶æ–‡ä»¶å­˜å‚¨ç‚¹ï¼›\n- **/var**ï¼š ç”¨äºå­˜æ”¾è¿è¡Œæ—¶éœ€è¦æ”¹å˜æ•°æ®çš„æ–‡ä»¶ï¼Œä¹Ÿæ˜¯æŸäº›å¤§æ–‡ä»¶çš„æº¢å‡ºåŒºï¼Œæ¯”æ–¹è¯´å„ç§æœåŠ¡çš„æ—¥å¿—æ–‡ä»¶ï¼ˆç³»ç»Ÿå¯åŠ¨æ—¥å¿—ç­‰ã€‚ï¼‰ç­‰ï¼›\n- **/lost+found**ï¼š è¿™ä¸ªç›®å½•å¹³æ—¶æ˜¯ç©ºçš„ï¼Œç³»ç»Ÿéæ­£å¸¸å…³æœºè€Œç•™ä¸‹â€œæ— å®¶å¯å½’â€çš„æ–‡ä»¶ï¼ˆwindows ä¸‹å«ä»€ä¹ˆ.chkï¼‰å°±åœ¨è¿™é‡Œã€‚\n\n### ä»€ä¹ˆæ˜¯ inode ï¼Ÿ\n\n> ä¸€èˆ¬æ¥è¯´ï¼Œé¢è¯•ä¸ä¼šé—® inode ã€‚ä½†æ˜¯ inode æ˜¯ä¸€ä¸ªé‡è¦æ¦‚å¿µï¼Œæ˜¯ç†è§£ Unix/Linux æ–‡ä»¶ç³»ç»Ÿå’Œç¡¬ç›˜å‚¨å­˜çš„åŸºç¡€ã€‚\n\nç†è§£ inodeï¼Œè¦ä»æ–‡ä»¶å‚¨å­˜è¯´èµ·ã€‚\n\næ–‡ä»¶å‚¨å­˜åœ¨ç¡¬ç›˜ä¸Šï¼Œç¡¬ç›˜çš„æœ€å°å­˜å‚¨å•ä½å«åš\"æ‰‡åŒº\"ï¼ˆSectorï¼‰ã€‚æ¯ä¸ªæ‰‡åŒºå‚¨å­˜ 512 å­—èŠ‚ï¼ˆç›¸å½“äº 0.5KBï¼‰ã€‚\n\næ“ä½œç³»ç»Ÿè¯»å–ç¡¬ç›˜çš„æ—¶å€™ï¼Œä¸ä¼šä¸€ä¸ªä¸ªæ‰‡åŒºåœ°è¯»å–ï¼Œè¿™æ ·æ•ˆç‡å¤ªä½ï¼Œè€Œæ˜¯ä¸€æ¬¡æ€§è¿ç»­è¯»å–å¤šä¸ªæ‰‡åŒºï¼Œå³ä¸€æ¬¡æ€§è¯»å–ä¸€ä¸ª\"å—\"ï¼ˆblockï¼‰ã€‚è¿™ç§ç”±å¤šä¸ªæ‰‡åŒºç»„æˆçš„\"å—\"ï¼Œæ˜¯æ–‡ä»¶å­˜å–çš„æœ€å°å•ä½ã€‚\"å—\"çš„å¤§å°ï¼Œæœ€å¸¸è§çš„æ˜¯ 4KBï¼Œå³è¿ç»­å…«ä¸ª sector ç»„æˆä¸€ä¸ª blockã€‚\n\næ–‡ä»¶æ•°æ®éƒ½å‚¨å­˜åœ¨\"å—\"ä¸­ï¼Œé‚£ä¹ˆå¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬è¿˜å¿…é¡»æ‰¾åˆ°ä¸€ä¸ªåœ°æ–¹å‚¨å­˜æ–‡ä»¶çš„å…ƒä¿¡æ¯ï¼Œæ¯”å¦‚æ–‡ä»¶çš„åˆ›å»ºè€…ã€æ–‡ä»¶çš„åˆ›å»ºæ—¥æœŸã€æ–‡ä»¶çš„å¤§å°ç­‰ç­‰ã€‚è¿™ç§å‚¨å­˜æ–‡ä»¶å…ƒä¿¡æ¯çš„åŒºåŸŸå°±å«åš inodeï¼Œä¸­æ–‡è¯‘åä¸º\"ç´¢å¼•èŠ‚ç‚¹\"ã€‚\n\næ¯ä¸€ä¸ªæ–‡ä»¶éƒ½æœ‰å¯¹åº”çš„ inodeï¼Œé‡Œé¢åŒ…å«äº†ä¸è¯¥æ–‡ä»¶æœ‰å…³çš„ä¸€äº›ä¿¡æ¯ã€‚\n\n**ç®€è¿° Linux æ–‡ä»¶ç³»ç»Ÿé€šè¿‡ i èŠ‚ç‚¹æŠŠæ–‡ä»¶çš„é€»è¾‘ç»“æ„å’Œç‰©ç†ç»“æ„è½¬æ¢çš„å·¥ä½œè¿‡ç¨‹ï¼Ÿ**\n\n> å¦‚æœçœ‹çš„ä¸€è„¸æ‡µé€¼ï¼Œä¹Ÿæ²¡å…³ç³»ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œé¢è¯•å®˜ä¸å¤ªä¼šé—®è¿™ä¸ªé¢˜ç›®ã€‚\n\nLinux é€šè¿‡ inode èŠ‚ç‚¹è¡¨å°†æ–‡ä»¶çš„é€»è¾‘ç»“æ„å’Œç‰©ç†ç»“æ„è¿›è¡Œè½¬æ¢ã€‚\n\n- inode èŠ‚ç‚¹æ˜¯ä¸€ä¸ª 64 å­—èŠ‚é•¿çš„è¡¨ï¼Œè¡¨ä¸­åŒ…å«äº†æ–‡ä»¶çš„ç›¸å…³ä¿¡æ¯ï¼Œå…¶ä¸­æœ‰æ–‡ä»¶çš„å¤§å°ã€æ–‡ä»¶æ‰€æœ‰è€…ã€æ–‡ä»¶çš„å­˜å–è®¸å¯æ–¹å¼ä»¥åŠæ–‡ä»¶çš„ç±»å‹ç­‰é‡è¦ä¿¡æ¯ã€‚åœ¨ inode èŠ‚ç‚¹è¡¨ä¸­æœ€é‡è¦çš„å†…å®¹æ˜¯ç£ç›˜åœ°å€è¡¨ã€‚åœ¨ç£ç›˜åœ°å€è¡¨ä¸­æœ‰ 13 ä¸ªå—å·ï¼Œæ–‡ä»¶å°†ä»¥å—å·åœ¨ç£ç›˜åœ°å€è¡¨ä¸­å‡ºç°çš„é¡ºåºä¾æ¬¡è¯»å–ç›¸åº”çš„å—ã€‚\n- Linux æ–‡ä»¶ç³»ç»Ÿé€šè¿‡æŠŠ inode èŠ‚ç‚¹å’Œæ–‡ä»¶åè¿›è¡Œè¿æ¥ï¼Œå½“éœ€è¦è¯»å–è¯¥æ–‡ä»¶æ—¶ï¼Œæ–‡ä»¶ç³»ç»Ÿåœ¨å½“å‰ç›®å½•è¡¨ä¸­æŸ¥æ‰¾è¯¥æ–‡ä»¶åå¯¹åº”çš„é¡¹ï¼Œç”±æ­¤å¾—åˆ°è¯¥æ–‡ä»¶ç›¸å¯¹åº”çš„ inode èŠ‚ç‚¹å·ï¼Œé€šè¿‡è¯¥ inode èŠ‚ç‚¹çš„ç£ç›˜åœ°å€è¡¨æŠŠåˆ†æ•£å­˜æ”¾çš„æ–‡ä»¶ç‰©ç†å—è¿æ¥æˆæ–‡ä»¶çš„é€»è¾‘ç»“æ„ã€‚\n\n### ä»€ä¹ˆæ˜¯ç¡¬é“¾æ¥å’Œè½¯é“¾æ¥ï¼Ÿ\n\n1ï¼‰ç¡¬é“¾æ¥\n\nç”±äº Linux ä¸‹çš„æ–‡ä»¶æ˜¯é€šè¿‡ç´¢å¼•èŠ‚ç‚¹(inode)æ¥è¯†åˆ«æ–‡ä»¶ï¼Œç¡¬é“¾æ¥å¯ä»¥è®¤ä¸ºæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘æ–‡ä»¶ç´¢å¼•èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œç³»ç»Ÿå¹¶ä¸ä¸ºå®ƒé‡æ–°åˆ†é… inode ã€‚æ¯æ·»åŠ ä¸€ä¸ªä¸€ä¸ªç¡¬é“¾æ¥ï¼Œæ–‡ä»¶çš„é“¾æ¥æ•°å°±åŠ  1 ã€‚\n\n- ä¸è¶³ï¼š1ï¼‰ä¸å¯ä»¥åœ¨ä¸åŒæ–‡ä»¶ç³»ç»Ÿçš„æ–‡ä»¶é—´å»ºç«‹é“¾æ¥ï¼›2ï¼‰åªæœ‰è¶…çº§ç”¨æˆ·æ‰å¯ä»¥ä¸ºç›®å½•åˆ›å»ºç¡¬é“¾æ¥ã€‚\n\n2ï¼‰è½¯é“¾æ¥\n\nè½¯é“¾æ¥å…‹æœäº†ç¡¬é“¾æ¥çš„ä¸è¶³ï¼Œæ²¡æœ‰ä»»ä½•æ–‡ä»¶ç³»ç»Ÿçš„é™åˆ¶ï¼Œä»»ä½•ç”¨æˆ·å¯ä»¥åˆ›å»ºæŒ‡å‘ç›®å½•çš„ç¬¦å·é“¾æ¥ã€‚å› è€Œç°åœ¨æ›´ä¸ºå¹¿æ³›ä½¿ç”¨ï¼Œå®ƒå…·æœ‰æ›´å¤§çš„çµæ´»æ€§ï¼Œç”šè‡³å¯ä»¥è·¨è¶Šä¸åŒæœºå™¨ã€ä¸åŒç½‘ç»œå¯¹æ–‡ä»¶è¿›è¡Œé“¾æ¥ã€‚\n\n- ä¸è¶³ï¼šå› ä¸ºé“¾æ¥æ–‡ä»¶åŒ…å«æœ‰åŸæ–‡ä»¶çš„è·¯å¾„ä¿¡æ¯ï¼Œæ‰€ä»¥å½“åŸæ–‡ä»¶ä»ä¸€ä¸ªç›®å½•ä¸‹ç§»åˆ°å…¶ä»–ç›®å½•ä¸­ï¼Œå†è®¿é—®é“¾æ¥æ–‡ä»¶ï¼Œç³»ç»Ÿå°±æ‰¾ä¸åˆ°äº†ï¼Œè€Œç¡¬é“¾æ¥å°±æ²¡æœ‰è¿™ä¸ªç¼ºé™·ï¼Œä½ æƒ³æ€ä¹ˆç§»å°±æ€ä¹ˆç§»ï¼›è¿˜æœ‰å®ƒè¦ç³»ç»Ÿåˆ†é…é¢å¤–çš„ç©ºé—´ç”¨äºå»ºç«‹æ–°çš„ç´¢å¼•èŠ‚ç‚¹å’Œä¿å­˜åŸæ–‡ä»¶çš„è·¯å¾„ã€‚\n\n**å®é™…åœºæ™¯ä¸‹ï¼ŒåŸºæœ¬æ˜¯ä½¿ç”¨è½¯é“¾æ¥**ã€‚æ€»ç»“åŒºåˆ«å¦‚ä¸‹ï¼š\n\n- ç¡¬é“¾æ¥ä¸å¯ä»¥è·¨åˆ†åŒºï¼Œè½¯ä»¶é“¾å¯ä»¥è·¨åˆ†åŒºã€‚\n- ç¡¬é“¾æ¥æŒ‡å‘ä¸€ä¸ª inode èŠ‚ç‚¹ï¼Œè€Œè½¯é“¾æ¥åˆ™æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„ inode èŠ‚ç‚¹ã€‚\n- åˆ é™¤ç¡¬é“¾æ¥æ–‡ä»¶ï¼Œä¸ä¼šåˆ é™¤åŸæ–‡ä»¶ï¼Œåˆ é™¤è½¯é“¾æ¥æ–‡ä»¶ï¼Œä¼šæŠŠåŸæ–‡ä»¶åˆ é™¤ã€‚\n\n### RAID æ˜¯ä»€ä¹ˆ?\n\n> RAID å…¨ç§°ä¸ºç‹¬ç«‹ç£ç›˜å†—ä½™é˜µåˆ—(Redundant Array of Independent Disks)ï¼ŒåŸºæœ¬æ€æƒ³å°±æ˜¯æŠŠå¤šä¸ªç›¸å¯¹ä¾¿å®œçš„ç¡¬ç›˜ç»„åˆèµ·æ¥ï¼Œæˆä¸ºä¸€ä¸ªç¡¬ç›˜é˜µåˆ—ç»„ï¼Œä½¿æ€§èƒ½è¾¾åˆ°ç”šè‡³è¶…è¿‡ä¸€ä¸ªä»·æ ¼æ˜‚è´µã€ å®¹é‡å·¨å¤§çš„ç¡¬ç›˜ã€‚RAID é€šå¸¸è¢«ç”¨åœ¨æœåŠ¡å™¨ç”µè„‘ä¸Šï¼Œä½¿ç”¨å®Œå…¨ç›¸åŒçš„ç¡¬ç›˜ç»„æˆä¸€ä¸ªé€»è¾‘æ‰‡åŒºï¼Œå› æ­¤æ“ä½œç³»ç»Ÿåªä¼šæŠŠå®ƒå½“åšä¸€ä¸ªç¡¬ç›˜ã€‚\n>\n> RAID åˆ†ä¸ºä¸åŒçš„ç­‰çº§ï¼Œå„ä¸ªä¸åŒçš„ç­‰çº§å‡åœ¨æ•°æ®å¯é æ€§åŠè¯»å†™æ€§èƒ½ä¸Šåšäº†ä¸åŒçš„æƒè¡¡ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¯ä»¥ä¾æ®è‡ªå·±çš„å®é™…éœ€æ±‚é€‰æ‹©ä¸åŒçš„ RAID æ–¹æ¡ˆã€‚\n\nå½“ç„¶ï¼Œå› ä¸ºå¾ˆå¤šå…¬å¸éƒ½ä½¿ç”¨äº‘æœåŠ¡ï¼Œå¤§å®¶å¾ˆéš¾æ¥è§¦åˆ° RAID è¿™ä¸ªæ¦‚å¿µï¼Œæ›´å¤šçš„å¯èƒ½æ˜¯æ™®é€šäº‘ç›˜ã€SSD äº‘ç›˜é…±ç´«çš„æ¦‚å¿µã€‚\n\n## å®‰å…¨\n\n### ä¸€å° Linux ç³»ç»Ÿåˆå§‹åŒ–ç¯å¢ƒåéœ€è¦åšä¸€äº›ä»€ä¹ˆå®‰å…¨å·¥ä½œï¼Ÿ\n\n1ã€æ·»åŠ æ™®é€šç”¨æˆ·ç™»é™†ï¼Œç¦æ­¢ root ç”¨æˆ·ç™»é™†ï¼Œæ›´æ”¹ SSH ç«¯å£å·ã€‚\n\n> ä¿®æ”¹ SSH ç«¯å£ä¸ä¸€å®šç»å¯¹å“ˆã€‚å½“ç„¶ï¼Œå¦‚æœè¦æš´éœ²åœ¨å¤–ç½‘ï¼Œå»ºè®®æ”¹ä¸‹ã€‚l\n\n2ã€æœåŠ¡å™¨ä½¿ç”¨å¯†é’¥ç™»é™†ï¼Œç¦æ­¢å¯†ç ç™»é™†ã€‚\n\n3ã€å¼€å¯é˜²ç«å¢™ï¼Œå…³é—­ SElinux ï¼Œæ ¹æ®ä¸šåŠ¡éœ€æ±‚è®¾ç½®ç›¸åº”çš„é˜²ç«å¢™è§„åˆ™ã€‚\n\n4ã€è£… fail2ban è¿™ç§é˜²æ­¢ SSH æš´åŠ›ç ´å‡»çš„è½¯ä»¶ã€‚\n\n5ã€è®¾ç½®åªå…è®¸å…¬å¸åŠå…¬ç½‘å‡ºå£ IP èƒ½ç™»é™†æœåŠ¡å™¨(çœ‹å…¬å¸å®é™…éœ€è¦)\n\n> ä¹Ÿå¯ä»¥å®‰è£… VPN ç­‰è½¯ä»¶ï¼Œåªå…è®¸è¿æ¥ VPN åˆ°æœåŠ¡å™¨ä¸Šã€‚\n\n6ã€ä¿®æ”¹å†å²å‘½ä»¤è®°å½•çš„æ¡æ•°ä¸º 10 æ¡ã€‚\n\n7ã€åªå…è®¸æœ‰éœ€è¦çš„æœåŠ¡å™¨å¯ä»¥è®¿é—®å¤–ç½‘ï¼Œå…¶å®ƒå…¨éƒ¨ç¦æ­¢ã€‚\n\n8ã€åšå¥½è½¯ä»¶å±‚é¢çš„é˜²æŠ¤ã€‚\n\n- 8.1 è®¾ç½® nginx_waf æ¨¡å—é˜²æ­¢ SQL æ³¨å…¥ã€‚\n- 8.2 æŠŠ Web æœåŠ¡ä½¿ç”¨ www ç”¨æˆ·å¯åŠ¨ï¼Œæ›´æ”¹ç½‘ç«™ç›®å½•çš„æ‰€æœ‰è€…å’Œæ‰€å±ç»„ä¸º www ã€‚\n\n### ä»€ä¹ˆå« CC æ”»å‡»ï¼Ÿä»€ä¹ˆå« DDOS æ”»å‡»ï¼Ÿ\n\n- CC æ”»å‡»ï¼Œä¸»è¦æ˜¯ç”¨æ¥æ”»å‡»é¡µé¢çš„ï¼Œæ¨¡æ‹Ÿå¤šä¸ªç”¨æˆ·ä¸åœçš„å¯¹ä½ çš„é¡µé¢è¿›è¡Œè®¿é—®ï¼Œä»è€Œä½¿ä½ çš„ç³»ç»Ÿèµ„æºæ¶ˆè€—æ®†å°½ã€‚\n\n- DDOS æ”»å‡»ï¼Œä¸­æ–‡åå«åˆ†å¸ƒå¼æ‹’ç»æœåŠ¡æ”»å‡»ï¼ŒæŒ‡å€ŸåŠ©æœåŠ¡å™¨æŠ€æœ¯å°†å¤šä¸ªè®¡ç®—æœºè”åˆèµ·æ¥ä½œä¸ºæ”»å‡»å¹³å°ï¼Œæ¥å¯¹ä¸€ä¸ªæˆ–å¤šä¸ªç›®æ ‡å‘åŠ¨ DDOS æ”»å‡»ã€‚\n\n\t> æ”»å‡»ï¼Œå³æ˜¯é€šè¿‡å¤§é‡åˆæ³•çš„è¯·æ±‚å ç”¨å¤§é‡ç½‘ç»œèµ„æºï¼Œä»¥è¾¾åˆ°ç˜«ç—ªç½‘ç»œçš„ç›®çš„ã€‚\n\n**æ€ä¹ˆé¢„é˜² CC æ”»å‡»å’Œ DDOS æ”»å‡»ï¼Ÿ**\n\né˜² CCã€DDOS æ”»å‡»ï¼Œè¿™äº›åªèƒ½æ˜¯ç”¨ç¡¬ä»¶é˜²ç«å¢™åšæµé‡æ¸…æ´—ï¼Œå°†æ”»å‡»æµé‡å¼•å…¥é»‘æ´ã€‚\n\n> æµé‡æ¸…æ´—è¿™ä¸€å—ï¼Œä¸»è¦æ˜¯ä¹° ISP æœåŠ¡å•†çš„é˜²æ”»å‡»çš„æœåŠ¡å°±å¯ä»¥ï¼Œæœºæˆ¿ä¸€èˆ¬æœ‰ç©ºä½™æµé‡ï¼Œæˆ‘ä»¬ä¸€èˆ¬æ˜¯ä¹°æœåŠ¡ï¼Œæ¯•ç«Ÿæ”»å‡»ä¸ä¼šæ˜¯æŒç»­é•¿æ—¶é—´ã€‚\n\n### ä»€ä¹ˆæ˜¯ç½‘ç«™æ•°æ®åº“æ³¨å…¥ï¼Ÿ\n\n- ç”±äºç¨‹åºå‘˜çš„æ°´å¹³åŠç»éªŒå‚å·®ä¸é½ï¼Œå¤§éƒ¨åˆ†ç¨‹åºå‘˜åœ¨ç¼–å†™ä»£ç çš„æ—¶å€™ï¼Œæ²¡æœ‰å¯¹ç”¨æˆ·è¾“å…¥æ•°æ®çš„åˆæ³•æ€§è¿›è¡Œåˆ¤æ–­ã€‚\n- åº”ç”¨ç¨‹åºå­˜åœ¨å®‰å…¨éšæ‚£ã€‚ç”¨æˆ·å¯ä»¥æäº¤ä¸€æ®µæ•°æ®åº“æŸ¥è¯¢ä»£ç ï¼Œæ ¹æ®ç¨‹åºè¿”å›çš„ç»“æœï¼Œè·å¾—æŸäº›ä»–æƒ³å¾—çŸ¥çš„æ•°æ®ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„ SQL æ³¨å…¥ã€‚\n- SQL æ³¨å…¥ï¼Œæ˜¯ä»æ­£å¸¸çš„ WWW ç«¯å£è®¿é—®ï¼Œè€Œä¸”è¡¨é¢çœ‹èµ·æ¥è·Ÿä¸€èˆ¬çš„ Web é¡µé¢è®¿é—®æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œå¦‚æœç®¡ç†å‘˜æ²¡æŸ¥çœ‹æ—¥å¿—çš„ä¹ æƒ¯ï¼Œå¯èƒ½è¢«å…¥ä¾µå¾ˆé•¿æ—¶é—´éƒ½ä¸ä¼šå‘è§‰ã€‚\n\n**å¦‚ä½•è¿‡æ»¤ä¸é¢„é˜²ï¼Ÿ**\n\næ•°æ®åº“ç½‘é¡µç«¯æ³¨å…¥è¿™ç§ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ nginx_waf åšè¿‡æ»¤ä¸é¢„é˜²ã€‚\n\n## Shell\n\n### Shell è„šæœ¬æ˜¯ä»€ä¹ˆï¼Ÿ\n\nä¸€ä¸ª Shell è„šæœ¬æ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼ŒåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå‘½ä»¤ã€‚ä½œä¸ºç³»ç»Ÿç®¡ç†å‘˜ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦ä½¿ç”¨å¤šä¸ªå‘½ä»¤æ¥å®Œæˆä¸€é¡¹ä»»åŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ è¿™äº›æ‰€æœ‰å‘½ä»¤åœ¨ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶(Shell è„šæœ¬)æ¥å®Œæˆè¿™äº›æ—¥å¸¸å·¥ä½œä»»åŠ¡ã€‚\n\n**ä»€ä¹ˆæ˜¯é»˜è®¤ç™»å½• Shell ï¼Ÿ**\n\nåœ¨ Linux æ“ä½œç³»ç»Ÿï¼Œ`\"/bin/bash\"` æ˜¯é»˜è®¤ç™»å½• Shellï¼Œæ˜¯åœ¨åˆ›å»ºç”¨æˆ·æ—¶åˆ†é…çš„ã€‚\n\nä½¿ç”¨ chsh å‘½ä»¤å¯ä»¥æ”¹å˜é»˜è®¤çš„ Shell ã€‚ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºï¼š\n\n```bash\nchsh <ç”¨æˆ·å> -s <æ–°shell>\nchsh ThinkWon -s /bin/sh\n```\n\n**åœ¨ Shell è„šæœ¬ä¸­ï¼Œå¦‚ä½•å†™å…¥æ³¨é‡Šï¼Ÿ**\n\næ³¨é‡Šå¯ä»¥ç”¨æ¥æè¿°ä¸€ä¸ªè„šæœ¬å¯ä»¥åšä»€ä¹ˆå’Œå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚æ¯ä¸€è¡Œæ³¨é‡Šä»¥ `#` å¼€å¤´ã€‚ä¾‹å­å¦‚ä¸‹ï¼š\n\n```bash\n#!/bin/bash\n# This is a command\necho â€œI am logged in as $USERâ€\n```\n\n### è¯­æ³•çº§\n\n#### å¯ä»¥åœ¨ Shell è„šæœ¬ä¸­ä½¿ç”¨å“ªäº›ç±»å‹çš„å˜é‡ï¼Ÿ\n\nåœ¨ Shell è„šæœ¬ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸¤ç§ç±»å‹çš„å˜é‡ï¼š\n\n- ç³»ç»Ÿå®šä¹‰å˜é‡\n\n\t> ç³»ç»Ÿå˜é‡æ˜¯ç”±ç³»ç»Ÿç³»ç»Ÿè‡ªå·±åˆ›å»ºçš„ã€‚è¿™äº›å˜é‡é€šå¸¸ç”±å¤§å†™å­—æ¯ç»„æˆï¼Œå¯ä»¥é€šè¿‡ `set` å‘½ä»¤æŸ¥çœ‹ã€‚\n\n- ç”¨æˆ·å®šä¹‰å˜é‡\n\n\t> ç”¨æˆ·å˜é‡ç”±ç³»ç»Ÿç”¨æˆ·æ¥ç”Ÿæˆå’Œå®šä¹‰ï¼Œå˜é‡çš„å€¼å¯ä»¥é€šè¿‡å‘½ä»¤ `\"echo $<å˜é‡å>\"` æŸ¥çœ‹ã€‚\n\n**Shellè„šæœ¬ä¸­ $? æ ‡è®°çš„ç”¨é€”æ˜¯ä»€ä¹ˆï¼Ÿ**\n\nåœ¨å†™ä¸€ä¸ª Shell è„šæœ¬æ—¶ï¼Œå¦‚æœä½ æƒ³è¦æ£€æŸ¥å‰ä¸€å‘½ä»¤æ˜¯å¦æ‰§è¡ŒæˆåŠŸï¼Œåœ¨ `if` æ¡ä»¶ä¸­ä½¿ç”¨ `$?` å¯ä»¥æ¥æ£€æŸ¥å‰ä¸€å‘½ä»¤çš„ç»“æŸçŠ¶æ€ã€‚\n\n- å¦‚æœç»“æŸçŠ¶æ€æ˜¯ 0 ï¼Œè¯´æ˜å‰ä¸€ä¸ªå‘½ä»¤æ‰§è¡ŒæˆåŠŸã€‚ä¾‹å¦‚ï¼š\n\n\t```bash\n\troot@localhost:~## ls /usr/bin/shar\n\t/usr/bin/shar\n\troot@localhost:~## echo $?\n\t0\n\t```\n\n- å¦‚æœç»“æŸçŠ¶æ€ä¸æ˜¯ 0ï¼Œè¯´æ˜å‘½ä»¤æ‰§è¡Œå¤±è´¥ã€‚ä¾‹å¦‚ï¼š\n\n\t```bash\n\troot@localhost:~## ls /usr/bin/share\n\tls: cannot access /usr/bin/share: No such file or directory\n\troot@localhost:~## echo $?\n\t2\n\t```\n\n**Bourne Shell(bash) ä¸­æœ‰å“ªäº›ç‰¹æ®Šçš„å˜é‡ï¼Ÿ**\n\nä¸‹é¢çš„è¡¨åˆ—å‡ºäº† Bourne Shell ä¸ºå‘½ä»¤è¡Œè®¾ç½®çš„ç‰¹æ®Šå˜é‡ã€‚\n\n```bash\nå†…å»ºå˜é‡    è§£é‡Š\n$0    å‘½ä»¤è¡Œä¸­çš„è„šæœ¬åå­—\n$1    ç¬¬ä¸€ä¸ªå‘½ä»¤è¡Œå‚æ•°\n$2    ç¬¬äºŒä¸ªå‘½ä»¤è¡Œå‚æ•°\nâ€¦..    â€¦â€¦.\n$9    ç¬¬ä¹ä¸ªå‘½ä»¤è¡Œå‚æ•°\n$##    å‘½ä»¤è¡Œå‚æ•°çš„æ•°é‡\n$*    æ‰€æœ‰å‘½ä»¤è¡Œå‚æ•°ï¼Œä»¥ç©ºæ ¼éš”å¼€\n```\n\n**å¦‚ä½•å–æ¶ˆå˜é‡æˆ–å–æ¶ˆå˜é‡èµ‹å€¼ï¼Ÿ**\n\n`unset` å‘½ä»¤ç”¨äºå–æ¶ˆå˜é‡æˆ–å–æ¶ˆå˜é‡èµ‹å€¼ã€‚è¯­æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š\n\n```bash\n## unset <å˜é‡å>\n```\n\n#### Shell è„šæœ¬ä¸­ `if` è¯­æ³•å¦‚ä½•åµŒå¥—?\n\n```bash\nif [ æ¡ä»¶ ]\nthen\nå‘½ä»¤1\nå‘½ä»¤2\nâ€¦..\nelse\nif [ æ¡ä»¶ ]\nthen\nå‘½ä»¤1\nå‘½ä»¤2\nâ€¦.\nelse\nå‘½ä»¤1\nå‘½ä»¤2\nâ€¦..\nfi\nfi\n```\n\n**åœ¨ Shell è„šæœ¬ä¸­å¦‚ä½•æ¯”è¾ƒä¸¤ä¸ªæ•°å­—ï¼Ÿ**\n\nåœ¨ `if-then` ä¸­ä½¿ç”¨æµ‹è¯•å‘½ä»¤ï¼ˆ `-gt` ç­‰ï¼‰æ¥æ¯”è¾ƒä¸¤ä¸ªæ•°å­—ã€‚ä¾‹å¦‚ï¼š\n\n```bash\n#!/bin/bash\nx=10\ny=20\nif [ $x -gt $y ]\nthen\necho â€œx is greater than yâ€\nelse\necho â€œy is greater than xâ€\nfi\n```\n\n#### Shell è„šæœ¬ä¸­ `case` è¯­å¥çš„è¯­æ³•?\n\nåŸºç¡€è¯­æ³•å¦‚ä¸‹ï¼š\n\n```bash\ncase å˜é‡ in\nå€¼1)\nå‘½ä»¤1\nå‘½ä»¤2\nâ€¦..\næœ€åå‘½ä»¤\n!!\nå€¼2)\nå‘½ä»¤1\nå‘½ä»¤2\nâ€¦â€¦\næœ€åå‘½ä»¤\n;;\nesac\n```\n\n#### Shell è„šæœ¬ä¸­ `for` å¾ªç¯è¯­æ³•ï¼Ÿ\n\nåŸºç¡€è¯­æ³•å¦‚ä¸‹ï¼š\n\n```bash\nfor å˜é‡ in å¾ªç¯åˆ—è¡¨\ndo\nå‘½ä»¤1\nå‘½ä»¤2\nâ€¦.\næœ€åå‘½ä»¤\ndone\n```\n\n#### Shell è„šæœ¬ä¸­ `while` å¾ªç¯è¯­æ³•ï¼Ÿ\n\nå¦‚åŒ `for` å¾ªç¯ï¼Œ`while` å¾ªç¯åªè¦æ¡ä»¶æˆç«‹å°±é‡å¤å®ƒçš„å‘½ä»¤å—ã€‚\nä¸åŒäº `for`å¾ªç¯ï¼Œ`while` å¾ªç¯ä¼šä¸æ–­è¿­ä»£ï¼Œç›´åˆ°å®ƒçš„æ¡ä»¶ä¸ä¸ºçœŸã€‚\n\nåŸºç¡€è¯­æ³•ï¼š\n\n```bash\nwhile [ æ¡ä»¶ ]\ndo\nå‘½ä»¤â€¦\ndone\n```\n\n**do-while è¯­å¥çš„åŸºæœ¬æ ¼å¼ï¼Ÿ**\n\n`do-while` è¯­å¥ç±»ä¼¼äº `while` è¯­å¥ï¼Œä½†æ£€æŸ¥æ¡ä»¶è¯­å¥ä¹‹å‰å…ˆæ‰§è¡Œå‘½ä»¤ï¼ˆLCTT è¯‘æ³¨ï¼šæ„å³è‡³å°‘æ‰§è¡Œä¸€æ¬¡ã€‚ï¼‰ã€‚ä¸‹é¢æ˜¯ç”¨ `do-while` è¯­å¥çš„è¯­æ³•ï¼š\n\n```bash\ndo\n{\nå‘½ä»¤\n} while (æ¡ä»¶)\n```\n\n**Shell è„šæœ¬ä¸­ break å‘½ä»¤çš„ä½œç”¨ï¼Ÿ**\n\n`break` å‘½ä»¤ä¸€ä¸ªç®€å•çš„ç”¨é€”æ˜¯é€€å‡ºæ‰§è¡Œä¸­çš„å¾ªç¯ã€‚æˆ‘ä»¬å¯ä»¥åœ¨ `while` å’Œ `until` å¾ªç¯ä¸­ä½¿ç”¨ `break` å‘½ä»¤è·³å‡ºå¾ªç¯ã€‚\n\n**Shell è„šæœ¬ä¸­ continue å‘½ä»¤çš„ä½œç”¨ï¼Ÿ**\n\n`continue` å‘½ä»¤ä¸åŒäº `break` å‘½ä»¤ï¼Œå®ƒåªè·³å‡ºå½“å‰å¾ªç¯çš„è¿­ä»£ï¼Œè€Œä¸æ˜¯æ•´ä¸ªå¾ªç¯ã€‚`continue` å‘½ä»¤å¾ˆå¤šæ—¶å€™æ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œä¾‹å¦‚é”™è¯¯å‘ç”Ÿï¼Œä½†æˆ‘ä»¬ä¾ç„¶å¸Œæœ›ç»§ç»­æ‰§è¡Œå¤§å¾ªç¯çš„æ—¶å€™ã€‚\n\n#### å¦‚ä½•ä½¿è„šæœ¬å¯æ‰§è¡Œ?\n\nä½¿ç”¨ chmod å‘½ä»¤æ¥ä½¿è„šæœ¬å¯æ‰§è¡Œã€‚ä¾‹å­å¦‚ä¸‹ï¼š`chmod a+x myscript.sh` ã€‚\n\n**#!/bin/bash çš„ä½œç”¨ï¼Ÿ**\n\n`#!/bin/bash` æ˜¯ Shell è„šæœ¬çš„ç¬¬ä¸€è¡Œï¼Œç§°ä¸ºé‡Šä¼´ï¼ˆshebangï¼‰è¡Œã€‚\n\n- è¿™é‡Œ `#` ç¬¦å·å«åš hash ï¼Œè€Œ `!` å«åš bangã€‚\n- å®ƒçš„æ„æ€æ˜¯å‘½ä»¤é€šè¿‡ `/bin/bash` æ¥æ‰§è¡Œã€‚\n\n**å¦‚ä½•è°ƒè¯• Shellè„šæœ¬ï¼Ÿ**\n\n- ä½¿ç”¨ `-x'` æ•°ï¼ˆ`sh -x myscript.sh`ï¼‰å¯ä»¥è°ƒè¯• Shell è„šæœ¬ã€‚\n- å¦ä¸€ä¸ªç§æ–¹æ³•æ˜¯ä½¿ç”¨ `-nv` å‚æ•°(`sh -nv myscript.sh`)ã€‚\n\n**å¦‚ä½•å°†æ ‡å‡†è¾“å‡ºå’Œé”™è¯¯è¾“å‡ºåŒæ—¶é‡å®šå‘åˆ°åŒä¸€ä½ç½®?**\n\n- æ–¹æ³•ä¸€ï¼š`2>&1 (å¦‚## ls /usr/share/doc > out.txt 2>&1 )` ã€‚\n- æ–¹æ³•äºŒï¼š`&> (å¦‚## ls /usr/share/doc &> out.txt )` ã€‚\n\n**åœ¨ Shell è„šæœ¬ä¸­ï¼Œå¦‚ä½•æµ‹è¯•æ–‡ä»¶ï¼Ÿ**\n\ntest å‘½ä»¤å¯ä»¥ç”¨æ¥æµ‹è¯•æ–‡ä»¶ã€‚åŸºç¡€ç”¨æ³•å¦‚ä¸‹è¡¨æ ¼ï¼š\n\n```bash\nTest         ç”¨æ³•\n-d æ–‡ä»¶å    å¦‚æœæ–‡ä»¶å­˜åœ¨å¹¶ä¸”æ˜¯ç›®å½•ï¼Œè¿”å›true\n-e æ–‡ä»¶å    å¦‚æœæ–‡ä»¶å­˜åœ¨ï¼Œè¿”å›true\n-f æ–‡ä»¶å    å¦‚æœæ–‡ä»¶å­˜åœ¨å¹¶ä¸”æ˜¯æ™®é€šæ–‡ä»¶ï¼Œè¿”å›true\n-r æ–‡ä»¶å    å¦‚æœæ–‡ä»¶å­˜åœ¨å¹¶å¯è¯»ï¼Œè¿”å›true\n-s æ–‡ä»¶å    å¦‚æœæ–‡ä»¶å­˜åœ¨å¹¶ä¸”ä¸ä¸ºç©ºï¼Œè¿”å›true\n-w æ–‡ä»¶å    å¦‚æœæ–‡ä»¶å­˜åœ¨å¹¶å¯å†™ï¼Œè¿”å›true\n-x æ–‡ä»¶å    å¦‚æœæ–‡ä»¶å­˜åœ¨å¹¶å¯æ‰§è¡Œï¼Œè¿”å›true\n```\n\n#### åœ¨ Shell è„šæœ¬å¦‚ä½•å®šä¹‰å‡½æ•°å‘¢ï¼Ÿ\n\nå‡½æ•°æ˜¯æ‹¥æœ‰åå­—çš„ä»£ç å—ã€‚å½“æˆ‘ä»¬å®šä¹‰ä»£ç å—ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨æˆ‘ä»¬çš„è„šæœ¬è°ƒç”¨å‡½æ•°åå­—ï¼Œè¯¥å—å°±ä¼šè¢«æ‰§è¡Œã€‚ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºï¼š\n\n```bash\n$ diskusage () { df -h ; }\nè¯‘æ³¨ï¼šä¸‹é¢æ˜¯æˆ‘ç»™çš„shellå‡½æ•°è¯­æ³•ï¼ŒåŸæ–‡æ²¡æœ‰\n[ function ] å‡½æ•°å [()]\n{\nå‘½ä»¤;\n[return int;]\n}\n```\n\n**å¦‚ä½•è®© Shell å°±è„šæœ¬å¾—åˆ°æ¥è‡ªç»ˆç«¯çš„è¾“å…¥?**\n\nread å‘½ä»¤å¯ä»¥è¯»å–æ¥è‡ªç»ˆç«¯ï¼ˆä½¿ç”¨é”®ç›˜ï¼‰çš„æ•°æ®ã€‚read å‘½ä»¤å¾—åˆ°ç”¨æˆ·çš„è¾“å…¥å¹¶ç½®äºä½ ç»™å‡ºçš„å˜é‡ä¸­ã€‚ä¾‹å­å¦‚ä¸‹ï¼š\n\n```bash\n## vi /tmp/test.sh\n#!/bin/bash\necho â€˜Please enter your nameâ€™\nread name\necho â€œMy Name is $nameâ€\n## ./test.sh\nPlease enter your name\nThinkWon\nMy Name is ThinkWon\n```\n\n**å¦‚ä½•æ‰§è¡Œç®—æœ¯è¿ç®—ï¼Ÿ**\n\næœ‰ä¸¤ç§æ–¹æ³•æ¥æ‰§è¡Œç®—æœ¯è¿ç®—ï¼š\n\n- 1ã€ä½¿ç”¨ expr å‘½ä»¤ï¼š`## expr 5 + 2` ã€‚\n- 2ã€ç”¨ä¸€ä¸ªç¾å…ƒç¬¦å·å’Œæ–¹æ‹¬å·ï¼ˆ`$[ è¡¨è¾¾å¼ ]`ï¼‰ï¼š`test=$[16 + 4] ; test=$[16 + 4]` ã€‚\n\n### ç¼–ç¨‹é¢˜\n\n#### åˆ¤æ–­ä¸€æ–‡ä»¶æ˜¯ä¸æ˜¯å­—ç¬¦è®¾å¤‡æ–‡ä»¶ï¼Œå¦‚æœæ˜¯å°†å…¶æ‹·è´åˆ° `/dev` ç›®å½•ä¸‹ï¼Ÿ\n\n```bash\n#!/bin/bash\nread -p \"Input file name: \" FILENAME\nif [ -c \"$FILENAME\" ];then\nã€€ã€€cp $FILENAME /dev\nfi\n```\n\n#### æ·»åŠ ä¸€ä¸ªæ–°ç»„ä¸º class1 ï¼Œç„¶åæ·»åŠ å±äºè¿™ä¸ªç»„çš„ 30 ä¸ªç”¨æˆ·ï¼Œç”¨æˆ·åçš„å½¢å¼ä¸º stdxx ï¼Œå…¶ä¸­ xx ä» 01 åˆ° 30 ï¼Ÿ\n\n```bash\n#!/bin/bash\ngroupadd class1\nfor((i=1;i<31;i++))\ndo\n        if [ $i -le 10 ];then\n                useradd -g class1 std0$i\n        else\n                useradd -g class1 std$i\n        fi\ndone\n```\n\n**ç¼–å†™ Shell ç¨‹åºï¼Œå®ç°è‡ªåŠ¨åˆ é™¤ 50 ä¸ªè´¦å·çš„åŠŸèƒ½ï¼Œè´¦å·åä¸ºstud1 è‡³ stud50 ï¼Ÿ**\n\n```bash\n#!/bin/bash\nfor((i=1;i<51;i++))\ndo\n                userdel -r stud$i\ndone\n```\n\n#### å†™ä¸€ä¸ª sed å‘½ä»¤ï¼Œä¿®æ”¹ `/tmp/input.txt` æ–‡ä»¶çš„å†…å®¹ï¼Ÿ\n\nè¦æ±‚ï¼š\n\n- åˆ é™¤æ‰€æœ‰ç©ºè¡Œã€‚\n- ä¸€è¡Œä¸­ï¼Œå¦‚æœåŒ…å« â€œ11111â€ï¼Œåˆ™åœ¨ â€œ11111â€ å‰é¢æ’å…¥ â€œAAAâ€ï¼Œåœ¨ â€œ11111â€ åé¢æ’å…¥ â€œBBBâ€ ã€‚æ¯”å¦‚ï¼šå°†å†…å®¹ä¸º 0000111112222 çš„ä¸€è¡Œæ”¹ä¸º 0000AAA11111BBB2222 ã€‚\n\n```bash\n[root@~]## cat -n /tmp/input.txt\n     1  000011111222\n     2\n     3  000011111222222\n     4  11111000000222\n     5\n     6\n     7  111111111111122222222222\n     8  2211111111\n     9  112222222\n    10  1122\n    11\n\n## åˆ é™¤æ‰€æœ‰ç©ºè¡Œå‘½ä»¤\n[root@~]## sed '/^$/d' /tmp/input.txt\n000011111222\n000011111222222\n11111000000222\n111111111111122222222222\n2211111111\n112222222\n1122\n\n## æ’å…¥æŒ‡å®šçš„å­—ç¬¦\n[root@~]## sed 's#\\(11111\\)#AAA\\1BBB#g' /tmp/input.txt\n0000AAA11111BBB222\n0000AAA11111BBB222222\nAAA11111BBB000000222\nAAA11111BBBAAA11111BBB11122222222222\n22AAA11111BBB111\n112222222\n1122\n```\n\n## å®æˆ˜\n\n### å¦‚ä½•é€‰æ‹© Linux æ“ä½œç³»ç»Ÿç‰ˆæœ¬?\n\nä¸€èˆ¬æ¥è®²ï¼Œæ¡Œé¢ç”¨æˆ·é¦–é€‰ Ubuntu ï¼›æœåŠ¡å™¨é¦–é€‰ RHEL æˆ– CentOS ï¼Œä¸¤è€…ä¸­é¦–é€‰ CentOS ã€‚\n\næ ¹æ®å…·ä½“è¦æ±‚ï¼š\n\n- å®‰å…¨æ€§è¦æ±‚è¾ƒé«˜ï¼Œåˆ™é€‰æ‹© Debian æˆ–è€… FreeBSD ã€‚\n\n- éœ€è¦ä½¿ç”¨æ•°æ®åº“é«˜çº§æœåŠ¡å’Œç”µå­é‚®ä»¶ç½‘ç»œåº”ç”¨çš„ç”¨æˆ·å¯ä»¥é€‰æ‹© SUSE ã€‚\n\n- æƒ³è¦æ–°æŠ€æœ¯æ–°åŠŸèƒ½å¯ä»¥é€‰æ‹© Feddora ï¼ŒFeddora æ˜¯ RHEL å’Œ CentOS çš„ä¸€ä¸ªæµ‹è¯•ç‰ˆå’Œé¢„å‘å¸ƒç‰ˆæœ¬ã€‚\n\n- ã€é‡ç‚¹ã€‘**æ ¹æ®ç°æœ‰çŠ¶å†µï¼Œç»å¤§å¤šæ•°äº’è”ç½‘å…¬å¸é€‰æ‹© CentOS ã€‚ç°åœ¨æ¯”è¾ƒå¸¸ç”¨çš„æ˜¯ 6 ç³»åˆ—ï¼Œç°åœ¨å¸‚åœºå æœ‰å¤§æ¦‚ä¸€åŠå·¦å³ã€‚å¦å¤–çš„åŸå› æ˜¯ CentOS æ›´ä¾§é‡æœåŠ¡å™¨é¢†åŸŸï¼Œå¹¶ä¸”æ— ç‰ˆæƒçº¦æŸ**ã€‚\n\n\t> CentOS 7 ç³»åˆ—ï¼Œä¹Ÿæ…¢æ…¢ä½¿ç”¨çš„ä¼šæ¯”è¾ƒå¤šäº†ã€‚\n\n### å¦‚ä½•è§„åˆ’ä¸€å° Linux ä¸»æœºï¼Œæ­¥éª¤æ˜¯æ€æ ·ï¼Ÿ\n\n1ã€ç¡®å®šæœºå™¨æ˜¯åšä»€ä¹ˆç”¨çš„ï¼Œæ¯”å¦‚æ˜¯åš WEB ã€DBã€è¿˜æ˜¯æ¸¸æˆæœåŠ¡å™¨ã€‚\n\n> ä¸åŒçš„ç”¨é€”ï¼Œæœºå™¨çš„é…ç½®ä¼šæœ‰æ‰€ä¸åŒã€‚\n\n2ã€ç¡®å®šå¥½ä¹‹åï¼Œå°±è¦å®šç³»ç»Ÿéœ€è¦æ€ä¹ˆå®‰è£…ï¼Œé»˜è®¤å®‰è£…å“ªäº›ç³»ç»Ÿã€åˆ†åŒºæ€ä¹ˆåšã€‚\n\n3ã€éœ€è¦ä¼˜åŒ–ç³»ç»Ÿçš„å“ªäº›å‚æ•°ï¼Œéœ€è¦åˆ›å»ºå“ªäº›ç”¨æˆ·ç­‰ç­‰çš„ã€‚\n\n### è¯·é—®å½“ç”¨æˆ·åé¦ˆç½‘ç«™è®¿é—®æ…¢ï¼Œä½ ä¼šå¦‚ä½•å¤„ç†ï¼Ÿ\n\n**æœ‰å“ªäº›æ–¹é¢çš„å› ç´ ä¼šå¯¼è‡´ç½‘ç«™ç½‘ç«™è®¿é—®æ…¢ï¼Ÿ**\n\n1ã€æœåŠ¡å™¨å‡ºå£å¸¦å®½ä¸å¤Ÿç”¨\n\n> - æœ¬èº«æœåŠ¡å™¨è´­ä¹°çš„å‡ºå£å¸¦å®½æ¯”è¾ƒå°ã€‚ä¸€æ—¦å¹¶å‘é‡å¤§çš„è¯ï¼Œå°±ä¼šé€ æˆåˆ†ç»™æ¯ä¸ªç”¨æˆ·çš„å‡ºå£å¸¦å®½å°±å°ï¼Œè®¿é—®é€Ÿåº¦è‡ªç„¶å°±ä¼šæ…¢ã€‚\n> - è·¨è¿è¥å•†ç½‘ç»œå¯¼è‡´å¸¦å®½ç¼©å‡ã€‚ä¾‹å¦‚ï¼Œå…¬å¸ç½‘ç«™æ”¾åœ¨ç”µä¿¡çš„ç½‘ç»œä¸Šï¼Œé‚£ä¹ˆå®¢æˆ·è¿™è¾¹å¯¹æ¥æ˜¯é•¿åŸå®½å¸¦æˆ–è”é€šï¼Œè¿™ä¹Ÿå¯èƒ½å¯¼è‡´å¸¦å®½çš„ç¼©å‡ã€‚\n\n2ã€æœåŠ¡å™¨è´Ÿè½½è¿‡å¤§ï¼Œå¯¼è‡´å“åº”ä¸è¿‡æ¥\n\n> å¯ä»¥ä»ä¸¤ä¸ªæ–¹é¢å…¥æ‰‹åˆ†æï¼š\n>\n> - åˆ†æç³»ç»Ÿè´Ÿè½½ï¼Œä½¿ç”¨ w å‘½ä»¤æˆ–è€… uptime å‘½ä»¤æŸ¥çœ‹ç³»ç»Ÿè´Ÿè½½ã€‚å¦‚æœè´Ÿè½½å¾ˆé«˜ï¼Œåˆ™ä½¿ç”¨ top å‘½ä»¤æŸ¥çœ‹ CPU ï¼ŒMEM ç­‰å ç”¨æƒ…å†µï¼Œè¦ä¹ˆæ˜¯ CPU ç¹å¿™ï¼Œè¦ä¹ˆæ˜¯å†…å­˜ä¸å¤Ÿã€‚\n> - å¦‚æœè¿™äºŒè€…éƒ½æ­£å¸¸ï¼Œå†å»ä½¿ç”¨ sar å‘½ä»¤åˆ†æç½‘å¡æµé‡ï¼Œåˆ†ææ˜¯ä¸æ˜¯é­åˆ°äº†æ”»å‡»ã€‚ä¸€æ—¦åˆ†æå‡ºé—®é¢˜çš„åŸå› ï¼Œé‡‡å–å¯¹åº”çš„æªæ–½è§£å†³ï¼Œå¦‚å†³å®šè¦ä¸è¦æ€æ­»ä¸€äº›è¿›ç¨‹ï¼Œæˆ–è€…ç¦æ­¢ä¸€äº›è®¿é—®ç­‰ã€‚\n\n3ã€æ•°æ®åº“ç“¶é¢ˆ\n\n> - å¦‚æœæ…¢æŸ¥è¯¢æ¯”è¾ƒå¤šã€‚é‚£ä¹ˆå°±è¦å¼€å‘äººå‘˜æˆ– DBA ååŠ©è¿›è¡Œ SQL è¯­å¥çš„ä¼˜åŒ–ã€‚\n> - å¦‚æœæ•°æ®åº“å“åº”æ…¢ï¼Œè€ƒè™‘å¯ä»¥åŠ ä¸€ä¸ªæ•°æ®åº“ç¼“å­˜ï¼Œå¦‚ Redis ç­‰ã€‚ç„¶åï¼Œä¹Ÿå¯ä»¥æ­å»º MySQL ä¸»ä»ï¼Œä¸€å° MySQL æœåŠ¡å™¨è´Ÿè´£å†™ï¼Œå…¶ä»–å‡ å°ä»æ•°æ®åº“è´Ÿè´£è¯»ã€‚\n\n4ã€ç½‘ç«™å¼€å‘ä»£ç æ²¡æœ‰ä¼˜åŒ–å¥½\n\n> - ä¾‹å¦‚ SQL è¯­å¥æ²¡æœ‰ä¼˜åŒ–ï¼Œå¯¼è‡´æ•°æ®åº“è¯»å†™ç›¸å½“è€—æ—¶ã€‚\n\n**é’ˆå¯¹ç½‘ç«™è®¿é—®æ…¢ï¼Œæ€ä¹ˆå»æ’æŸ¥ï¼Ÿ**\n\n1ã€é¦–å…ˆè¦ç¡®å®šæ˜¯ç”¨æˆ·ç«¯è¿˜æ˜¯æœåŠ¡ç«¯çš„é—®é¢˜ã€‚å½“æ¥åˆ°ç”¨æˆ·åé¦ˆè®¿é—®æ…¢ï¼Œé‚£è¾¹è‡ªå·±ç«‹å³è®¿é—®ç½‘ç«™çœ‹çœ‹ï¼Œå¦‚æœè‡ªå·±è¿™è¾¹è®¿é—®å¿«ï¼ŒåŸºæœ¬æ–­å®šæ˜¯ç”¨æˆ·ç«¯é—®é¢˜ï¼Œå°±éœ€è¦è€å¿ƒè·Ÿå®¢æˆ·è§£é‡Šï¼ŒååŠ©å®¢æˆ·è§£å†³é—®é¢˜ã€‚\n\n> ä¸è¦ä¸Šæ¥å°±çœ‹æœåŠ¡ç«¯çš„é—®é¢˜ã€‚ä¸€å®šè¦ä»æºå¤´å¼€å§‹ï¼Œé€æ­¥é€æ­¥å¾€ä¸‹ã€‚\n\n2ã€å¦‚æœè®¿é—®ä¹Ÿæ…¢ï¼Œé‚£ä¹ˆå¯ä»¥åˆ©ç”¨æµè§ˆå™¨çš„è°ƒè¯•åŠŸèƒ½ï¼Œçœ‹çœ‹åŠ è½½é‚£ä¸€é¡¹æ•°æ®æ¶ˆè€—æ—¶é—´è¿‡å¤šï¼Œæ˜¯å›¾ç‰‡åŠ è½½æ…¢ï¼Œè¿˜æ˜¯æŸäº›æ•°æ®åŠ è½½æ…¢ã€‚\n\n3ã€é’ˆå¯¹æœåŠ¡å™¨è´Ÿè½½æƒ…å†µã€‚æŸ¥çœ‹æœåŠ¡å™¨ç¡¬ä»¶(ç½‘ç»œã€CPUã€å†…å­˜)çš„æ¶ˆè€—æƒ…å†µã€‚å¦‚æœæ˜¯è´­ä¹°çš„äº‘ä¸»æœºï¼Œæ¯”å¦‚é˜¿é‡Œäº‘ï¼Œå¯ä»¥ç™»å½•é˜¿é‡Œäº‘å¹³å°æä¾›å„æ–¹é¢çš„ç›‘æ§ï¼Œæ¯”å¦‚ CPUã€å†…å­˜ã€å¸¦å®½çš„ä½¿ç”¨æƒ…å†µã€‚\n\n4ã€å¦‚æœå‘ç°ç¡¬ä»¶èµ„æºæ¶ˆè€—éƒ½ä¸é«˜ï¼Œé‚£ä¹ˆå°±éœ€è¦é€šè¿‡æŸ¥æ—¥å¿—ï¼Œæ¯”å¦‚çœ‹çœ‹ MySQL æ…¢æŸ¥è¯¢çš„æ—¥å¿—ï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯æŸæ¡ SQL è¯­å¥æŸ¥è¯¢æ…¢ï¼Œå¯¼è‡´ç½‘ç«™è®¿é—®æ…¢ã€‚\n\n**æ€ä¹ˆå»è§£å†³ï¼Ÿ**\n\n1ã€å¦‚æœæ˜¯å‡ºå£å¸¦å®½é—®é¢˜ï¼Œé‚£ä¹ˆä¹…ç”³è¯·åŠ å¤§å‡ºå£å¸¦å®½ã€‚\n\n2ã€å¦‚æœæ…¢æŸ¥è¯¢æ¯”è¾ƒå¤šï¼Œé‚£ä¹ˆå°±è¦å¼€å‘äººå‘˜æˆ– DBA ååŠ©è¿›è¡Œ SQL è¯­å¥çš„ä¼˜åŒ–ã€‚\n\n3ã€å¦‚æœæ•°æ®åº“å“åº”æ…¢ï¼Œè€ƒè™‘å¯ä»¥åŠ ä¸€ä¸ªæ•°æ®åº“ç¼“å­˜ï¼Œå¦‚ Redis ç­‰ç­‰ã€‚ç„¶åä¹Ÿå¯ä»¥æ­å»º MySQL ä¸»ä»ï¼Œä¸€å° MySQL æœåŠ¡å™¨è´Ÿè´£å†™ï¼Œå…¶ä»–å‡ å°ä»æ•°æ®åº“è´Ÿè´£è¯»ã€‚\n\n4ã€ç”³è¯·è´­ä¹° CDN æœåŠ¡ï¼ŒåŠ è½½ç”¨æˆ·çš„è®¿é—®ã€‚\n\n5ã€å¦‚æœè®¿é—®è¿˜æ¯”è¾ƒæ…¢ï¼Œé‚£å°±éœ€è¦ä»æ•´ä½“æ¶æ„ä¸Šè¿›è¡Œä¼˜åŒ–å’¯ã€‚åšåˆ°ä¸“è§’è‰²ä¸“ç”¨ï¼Œå¤šå°æœåŠ¡å™¨æä¾›åŒä¸€ä¸ªæœåŠ¡ã€‚\n\n### Linux æ€§èƒ½è°ƒä¼˜éƒ½æœ‰å“ªå‡ ç§æ–¹æ³•ï¼Ÿ\n\n1ã€Disabling daemons (å…³é—­ daemons)ã€‚\n\n2ã€Shutting down the GUI (å…³é—­ GUI)ã€‚\n\n3ã€Changing kernel parameters (æ”¹å˜å†…æ ¸å‚æ•°)ã€‚\n\n4ã€Kernel parameters (å†…æ ¸å‚æ•°)ã€‚\n\n5ã€Tuning the processor subsystem (å¤„ç†å™¨å­ç³»ç»Ÿè°ƒä¼˜)ã€‚\n\n6ã€Tuning the memory subsystem (å†…å­˜å­ç³»ç»Ÿè°ƒä¼˜)ã€‚\n\n7ã€Tuning the file system (æ–‡ä»¶ç³»ç»Ÿå­ç³»ç»Ÿè°ƒä¼˜)ã€‚\n\n8ã€Tuning the network subsystemï¼ˆç½‘ç»œå­ç³»ç»Ÿè°ƒä¼˜)ã€‚\n\n## æ–‡ä»¶ç®¡ç†å‘½ä»¤\n\n### cat å‘½ä»¤\n\ncat å‘½ä»¤ç”¨äºè¿æ¥æ–‡ä»¶å¹¶æ‰“å°åˆ°æ ‡å‡†è¾“å‡ºè®¾å¤‡ä¸Šã€‚\n\ncat ä¸»è¦æœ‰ä¸‰å¤§åŠŸèƒ½ï¼š\n\n1ã€ä¸€æ¬¡æ˜¾ç¤ºæ•´ä¸ªæ–‡ä»¶:\n\n```sh\ncat filename\n```\n\n2ã€ä»é”®ç›˜åˆ›å»ºä¸€ä¸ªæ–‡ä»¶:\n\n```shell\ncat > filename\n```\n\nåªèƒ½åˆ›å»ºæ–°æ–‡ä»¶ï¼Œä¸èƒ½ç¼–è¾‘å·²æœ‰æ–‡ä»¶ã€‚\n\n3ã€å°†å‡ ä¸ªæ–‡ä»¶åˆå¹¶ä¸ºä¸€ä¸ªæ–‡ä»¶ï¼š\n\n```shell\ncat file1 file2 > file\n```\n\n- -b å¯¹éç©ºè¾“å‡ºè¡Œå·\n- -n è¾“å‡ºæ‰€æœ‰è¡Œå·\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰æŠŠ log2012.log çš„æ–‡ä»¶å†…å®¹åŠ ä¸Šè¡Œå·åè¾“å…¥ log2013.log è¿™ä¸ªæ–‡ä»¶é‡Œ\n\n```shell\ncat -n log2012.log > log2013.log\n```\n\nï¼ˆ2ï¼‰æŠŠ log2012.log å’Œ log2013.log çš„æ–‡ä»¶å†…å®¹åŠ ä¸Šè¡Œå·ï¼ˆç©ºç™½è¡Œä¸åŠ ï¼‰ä¹‹åå°†å†…å®¹é™„åŠ åˆ° log.log é‡Œ\n\n```shell\ncat -b log2012.log log2013.log > log.log\n```\n\n### chmod å‘½ä»¤\n\nLinux/Unix çš„æ–‡ä»¶è°ƒç”¨æƒé™åˆ†ä¸ºä¸‰çº§ : æ–‡ä»¶æ‹¥æœ‰è€…ã€ç¾¤ç»„ã€å…¶ä»–ã€‚åˆ©ç”¨ chmod å¯ä»¥æ§åˆ¶æ–‡ä»¶å¦‚ä½•è¢«ä»–äººæ‰€è°ƒç”¨ã€‚\n\nç”¨äºæ”¹å˜ linux ç³»ç»Ÿæ–‡ä»¶æˆ–ç›®å½•çš„è®¿é—®æƒé™ã€‚ç”¨å®ƒæ§åˆ¶æ–‡ä»¶æˆ–ç›®å½•çš„è®¿é—®æƒé™ã€‚è¯¥å‘½ä»¤æœ‰ä¸¤ç§ç”¨æ³•ã€‚ä¸€ç§æ˜¯åŒ…å«å­—æ¯å’Œæ“ä½œç¬¦è¡¨è¾¾å¼çš„æ–‡å­—è®¾å®šæ³•ï¼›å¦ä¸€ç§æ˜¯åŒ…å«æ•°å­—çš„æ•°å­—è®¾å®šæ³•ã€‚\n\næ¯ä¸€æ–‡ä»¶æˆ–ç›®å½•çš„è®¿é—®æƒé™éƒ½æœ‰ä¸‰ç»„ï¼Œæ¯ç»„ç”¨ä¸‰ä½è¡¨ç¤ºï¼Œåˆ†åˆ«ä¸ºæ–‡ä»¶**å±ä¸»**çš„è¯»ã€å†™å’Œæ‰§è¡Œæƒé™ï¼›ä¸å±ä¸»**åŒç»„**çš„ç”¨æˆ·çš„è¯»ã€å†™å’Œæ‰§è¡Œæƒé™ï¼›ç³»ç»Ÿä¸­**å…¶ä»–ç”¨æˆ·**çš„è¯»ã€å†™å’Œæ‰§è¡Œæƒé™ã€‚å¯ä½¿ç”¨ ls -l test.txt æŸ¥æ‰¾ã€‚\n\nä»¥æ–‡ä»¶ log2012.log ä¸ºä¾‹ï¼š\n\n```shell\n-rw-r--r-- 1 root root 296K 11-13 06:03 log2012.log\n```\n\nç¬¬ä¸€åˆ—å…±æœ‰ 10 ä¸ªä½ç½®ï¼Œç¬¬ä¸€ä¸ªå­—ç¬¦æŒ‡å®šäº†æ–‡ä»¶ç±»å‹ã€‚åœ¨é€šå¸¸æ„ä¹‰ä¸Šï¼Œä¸€ä¸ªç›®å½•ä¹Ÿæ˜¯ä¸€ä¸ªæ–‡ä»¶ã€‚å¦‚æœç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯æ¨ªçº¿ï¼Œè¡¨ç¤ºæ˜¯ä¸€ä¸ªéç›®å½•çš„æ–‡ä»¶ã€‚å¦‚æœæ˜¯ dï¼Œè¡¨ç¤ºæ˜¯ä¸€ä¸ªç›®å½•ã€‚ä»ç¬¬äºŒä¸ªå­—ç¬¦å¼€å§‹åˆ°ç¬¬åä¸ª 9 ä¸ªå­—ç¬¦ï¼Œ3 ä¸ªå­—ç¬¦ä¸€ç»„ï¼Œåˆ†åˆ«è¡¨ç¤ºäº† 3 ç»„ç”¨æˆ·å¯¹æ–‡ä»¶æˆ–è€…ç›®å½•çš„æƒé™ã€‚æƒé™å­—ç¬¦ç”¨æ¨ªçº¿ä»£è¡¨ç©ºè®¸å¯ï¼Œr ä»£è¡¨åªè¯»(4)ï¼Œw ä»£è¡¨å†™(2)ï¼Œx ä»£è¡¨å¯æ‰§è¡Œ(1)ã€‚\n\n**å¸¸ç”¨å‚æ•°**ï¼š\n\n```\n-c å½“å‘ç”Ÿæ”¹å˜æ—¶ï¼ŒæŠ¥å‘Šå¤„ç†ä¿¡æ¯\n-R å¤„ç†æŒ‡å®šç›®å½•ä»¥åŠå…¶å­ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶\n```\n\næƒé™èŒƒå›´ï¼š\n\n```\nu ï¼šç›®å½•æˆ–è€…æ–‡ä»¶çš„å½“å‰çš„ç”¨æˆ·\ng ï¼šç›®å½•æˆ–è€…æ–‡ä»¶çš„å½“å‰çš„ç¾¤ç»„\no ï¼šé™¤äº†ç›®å½•æˆ–è€…æ–‡ä»¶çš„å½“å‰ç”¨æˆ·æˆ–ç¾¤ç»„ä¹‹å¤–çš„ç”¨æˆ·æˆ–è€…ç¾¤ç»„\na ï¼šæ‰€æœ‰çš„ç”¨æˆ·åŠç¾¤ç»„\n```\n\næƒé™ä»£å·ï¼š\n\n```\nr ï¼šè¯»æƒé™ï¼Œç”¨æ•°å­—4è¡¨ç¤º\nw ï¼šå†™æƒé™ï¼Œç”¨æ•°å­—2è¡¨ç¤º\nx ï¼šæ‰§è¡Œæƒé™ï¼Œç”¨æ•°å­—1è¡¨ç¤º\n- ï¼šåˆ é™¤æƒé™ï¼Œç”¨æ•°å­—0è¡¨ç¤º\ns ï¼šç‰¹æ®Šæƒé™\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰å¢åŠ æ–‡ä»¶ t.log æ‰€æœ‰ç”¨æˆ·å¯æ‰§è¡Œæƒé™\n\n```shell\nchmod a+x t.log\n```\n\nï¼ˆ2ï¼‰æ’¤é”€åŸæ¥æ‰€æœ‰çš„æƒé™ï¼Œç„¶åä½¿æ‹¥æœ‰è€…å…·æœ‰å¯è¯»æƒé™,å¹¶è¾“å‡ºå¤„ç†ä¿¡æ¯\n\n```shell\nchmod u=r t.log -c\n```\n\nï¼ˆ3ï¼‰ç»™ file çš„å±ä¸»åˆ†é…è¯»ã€å†™ã€æ‰§è¡Œ(7)çš„æƒé™ï¼Œç»™ file çš„æ‰€åœ¨ç»„åˆ†é…è¯»ã€æ‰§è¡Œ(5)çš„æƒé™ï¼Œç»™å…¶ä»–ç”¨æˆ·åˆ†é…æ‰§è¡Œ(1)çš„æƒé™\n\n```shell\nchmod 751 t.log -cï¼ˆæˆ–è€…ï¼šchmod u=rwx,g=rx,o=x t.log -c\n```\n\nï¼ˆ4ï¼‰å°† test ç›®å½•åŠå…¶å­ç›®å½•æ‰€æœ‰æ–‡ä»¶æ·»åŠ å¯è¯»æƒé™\n\n```shell\nchmod u+r,g+r,o+r -R text/ -c\n```\n\n### chown å‘½ä»¤\n\nchown å°†æŒ‡å®šæ–‡ä»¶çš„æ‹¥æœ‰è€…æ”¹ä¸ºæŒ‡å®šçš„ç”¨æˆ·æˆ–ç»„ï¼Œç”¨æˆ·å¯ä»¥æ˜¯ç”¨æˆ·åæˆ–è€…ç”¨æˆ· IDï¼›ç»„å¯ä»¥æ˜¯ç»„åæˆ–è€…ç»„ IDï¼›æ–‡ä»¶æ˜¯ä»¥ç©ºæ ¼åˆ†å¼€çš„è¦æ”¹å˜æƒé™çš„æ–‡ä»¶åˆ—è¡¨ï¼Œæ”¯æŒé€šé…ç¬¦ã€‚\n\n```\n-c æ˜¾ç¤ºæ›´æ”¹çš„éƒ¨åˆ†çš„ä¿¡æ¯\n-R å¤„ç†æŒ‡å®šç›®å½•åŠå­ç›®å½•\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰æ”¹å˜æ‹¥æœ‰è€…å’Œç¾¤ç»„ å¹¶æ˜¾ç¤ºæ”¹å˜ä¿¡æ¯\n\n```shell\nchown -c mail:mail log2012.log\n```\n\nï¼ˆ2ï¼‰æ”¹å˜æ–‡ä»¶ç¾¤ç»„\n\n```shell\nchown -c :mail t.log\n```\n\nï¼ˆ3ï¼‰æ”¹å˜æ–‡ä»¶å¤¹åŠå­æ–‡ä»¶ç›®å½•å±ä¸»åŠå±ç»„ä¸º mail\n\n```shell\nchown -cR mail: test/\n```\n\n### cp å‘½ä»¤\n\nå°†æºæ–‡ä»¶å¤åˆ¶è‡³ç›®æ ‡æ–‡ä»¶ï¼Œæˆ–å°†å¤šä¸ªæºæ–‡ä»¶å¤åˆ¶è‡³ç›®æ ‡ç›®å½•ã€‚\n\næ³¨æ„ï¼šå‘½ä»¤è¡Œå¤åˆ¶ï¼Œå¦‚æœç›®æ ‡æ–‡ä»¶å·²ç»å­˜åœ¨ä¼šæç¤ºæ˜¯å¦è¦†ç›–ï¼Œè€Œåœ¨ shell è„šæœ¬ä¸­ï¼Œå¦‚æœä¸åŠ  -i å‚æ•°ï¼Œåˆ™ä¸ä¼šæç¤ºï¼Œè€Œæ˜¯ç›´æ¥è¦†ç›–ï¼\n\n```\n-i æç¤º\n-r å¤åˆ¶ç›®å½•åŠç›®å½•å†…æ‰€æœ‰é¡¹ç›®\n-a å¤åˆ¶çš„æ–‡ä»¶ä¸åŸæ–‡ä»¶æ—¶é—´ä¸€æ ·\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰å¤åˆ¶ a.txt åˆ° test ç›®å½•ä¸‹ï¼Œä¿æŒåŸæ–‡ä»¶æ—¶é—´ï¼Œå¦‚æœåŸæ–‡ä»¶å­˜åœ¨æç¤ºæ˜¯å¦è¦†ç›–ã€‚\n\n```shell\ncp -ai a.txt test\n```\n\nï¼ˆ2ï¼‰ä¸º a.txt å»ºè®®ä¸€ä¸ªé“¾æ¥ï¼ˆå¿«æ·æ–¹å¼ï¼‰\n\n```shell\ncp -s a.txt link_a.txt\n```\n\n### find å‘½ä»¤\n\nç”¨äºåœ¨æ–‡ä»¶æ ‘ä¸­æŸ¥æ‰¾æ–‡ä»¶ï¼Œå¹¶ä½œå‡ºç›¸åº”çš„å¤„ç†ã€‚\n\nå‘½ä»¤æ ¼å¼ï¼š\n\n```shell\nfind pathname -options [-print -exec -ok ...]\n```\n\nå‘½ä»¤å‚æ•°ï¼š\n\n```\npathname: findå‘½ä»¤æ‰€æŸ¥æ‰¾çš„ç›®å½•è·¯å¾„ã€‚ä¾‹å¦‚ç”¨.æ¥è¡¨ç¤ºå½“å‰ç›®å½•ï¼Œç”¨/æ¥è¡¨ç¤ºç³»ç»Ÿæ ¹ç›®å½•ã€‚\n-printï¼š findå‘½ä»¤å°†åŒ¹é…çš„æ–‡ä»¶è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºã€‚\n-execï¼š findå‘½ä»¤å¯¹åŒ¹é…çš„æ–‡ä»¶æ‰§è¡Œè¯¥å‚æ•°æ‰€ç»™å‡ºçš„shellå‘½ä»¤ã€‚ç›¸åº”å‘½ä»¤çš„å½¢å¼ä¸º'command' {  } \\;ï¼Œæ³¨æ„{   }å’Œ\\ï¼›ä¹‹é—´çš„ç©ºæ ¼ã€‚\n-okï¼š å’Œ-execçš„ä½œç”¨ç›¸åŒï¼Œåªä¸è¿‡ä»¥ä¸€ç§æ›´ä¸ºå®‰å…¨çš„æ¨¡å¼æ¥æ‰§è¡Œè¯¥å‚æ•°æ‰€ç»™å‡ºçš„shellå‘½ä»¤ï¼Œåœ¨æ‰§è¡Œæ¯ä¸€ä¸ªå‘½ä»¤ä¹‹å‰ï¼Œéƒ½ä¼šç»™å‡ºæç¤ºï¼Œè®©ç”¨æˆ·æ¥ç¡®å®šæ˜¯å¦æ‰§è¡Œã€‚\n```\n\n**å‘½ä»¤é€‰é¡¹**ï¼š\n\n```\n-name æŒ‰ç…§æ–‡ä»¶åæŸ¥æ‰¾æ–‡ä»¶\n-perm æŒ‰æ–‡ä»¶æƒé™æŸ¥æ‰¾æ–‡ä»¶\n-user æŒ‰æ–‡ä»¶å±ä¸»æŸ¥æ‰¾æ–‡ä»¶\n-group  æŒ‰ç…§æ–‡ä»¶æ‰€å±çš„ç»„æ¥æŸ¥æ‰¾æ–‡ä»¶ã€‚\n-type  æŸ¥æ‰¾æŸä¸€ç±»å‹çš„æ–‡ä»¶ï¼Œè¯¸å¦‚ï¼š\n   b - å—è®¾å¤‡æ–‡ä»¶\n   d - ç›®å½•\n   c - å­—ç¬¦è®¾å¤‡æ–‡ä»¶\n   l - ç¬¦å·é“¾æ¥æ–‡ä»¶\n   p - ç®¡é“æ–‡ä»¶\n   f - æ™®é€šæ–‡ä»¶\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰æŸ¥æ‰¾ 48 å°æ—¶å†…ä¿®æ”¹è¿‡çš„æ–‡ä»¶\n\n```shell\nfind -atime -2\n```\n\nï¼ˆ2ï¼‰åœ¨å½“å‰ç›®å½•æŸ¥æ‰¾ ä»¥ .log ç»“å°¾çš„æ–‡ä»¶ã€‚ **.** ä»£è¡¨å½“å‰ç›®å½•\n\n```shell\nfind ./ -name '*.log'\n```\n\nï¼ˆ3ï¼‰æŸ¥æ‰¾ /opt ç›®å½•ä¸‹ æƒé™ä¸º 777 çš„æ–‡ä»¶\n\n```shell\nfind /opt -perm 777\n```\n\nï¼ˆ4ï¼‰æŸ¥æ‰¾å¤§äº 1K çš„æ–‡ä»¶\n\n```shell\nfind -size +1000c\n```\n\næŸ¥æ‰¾ç­‰äº 1000 å­—ç¬¦çš„æ–‡ä»¶\n\n```shell\nfind -size 1000c \n```\n\n-exec å‚æ•°åé¢è·Ÿçš„æ˜¯ command å‘½ä»¤ï¼Œå®ƒçš„ç»ˆæ­¢æ˜¯ä»¥ ; ä¸ºç»“æŸæ ‡å¿—çš„ï¼Œæ‰€ä»¥è¿™å¥å‘½ä»¤åé¢çš„åˆ†å·æ˜¯ä¸å¯ç¼ºå°‘çš„ï¼Œè€ƒè™‘åˆ°å„ä¸ªç³»ç»Ÿä¸­åˆ†å·ä¼šæœ‰ä¸åŒçš„æ„ä¹‰ï¼Œæ‰€ä»¥å‰é¢åŠ åæ–œæ ã€‚{} èŠ±æ‹¬å·ä»£è¡¨å‰é¢ find æŸ¥æ‰¾å‡ºæ¥çš„æ–‡ä»¶åã€‚\n\n### head å‘½ä»¤\n\nhead ç”¨æ¥æ˜¾ç¤ºæ¡£æ¡ˆçš„å¼€å¤´è‡³æ ‡å‡†è¾“å‡ºä¸­ï¼Œé»˜è®¤ head å‘½ä»¤æ‰“å°å…¶ç›¸åº”æ–‡ä»¶çš„å¼€å¤´ 10 è¡Œã€‚\n\n**å¸¸ç”¨å‚æ•°**ï¼š\n\n```\n-n<è¡Œæ•°> æ˜¾ç¤ºçš„è¡Œæ•°ï¼ˆè¡Œæ•°ä¸ºå¤æ•°è¡¨ç¤ºä»æœ€åå‘å‰æ•°ï¼‰\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰æ˜¾ç¤º 1.log æ–‡ä»¶ä¸­å‰ 20 è¡Œ\n\n```shell\nhead 1.log -n 20\n```\n\nï¼ˆ2ï¼‰æ˜¾ç¤º 1.log æ–‡ä»¶å‰ 20 å­—èŠ‚\n\n```shell\nhead 1.log -c 20 \n1\n```\n\nï¼ˆ3ï¼‰æ˜¾ç¤º 1.log æœ€å 10 è¡Œ\n\n```shell\nhead 1.log -n -10\n```\n\n### less å‘½ä»¤\n\nless ä¸ more ç±»ä¼¼ï¼Œä½†ä½¿ç”¨ less å¯ä»¥éšæ„æµè§ˆæ–‡ä»¶ï¼Œè€Œ more ä»…èƒ½å‘å‰ç§»åŠ¨ï¼Œå´ä¸èƒ½å‘åç§»åŠ¨ï¼Œè€Œä¸” less åœ¨æŸ¥çœ‹ä¹‹å‰ä¸ä¼šåŠ è½½æ•´ä¸ªæ–‡ä»¶ã€‚\n\n**å¸¸ç”¨å‘½ä»¤å‚æ•°**ï¼š\n\n```\n-i  å¿½ç•¥æœç´¢æ—¶çš„å¤§å°å†™\n-N  æ˜¾ç¤ºæ¯è¡Œçš„è¡Œå·\n-o  <æ–‡ä»¶å> å°†less è¾“å‡ºçš„å†…å®¹åœ¨æŒ‡å®šæ–‡ä»¶ä¸­ä¿å­˜èµ·æ¥\n-s  æ˜¾ç¤ºè¿ç»­ç©ºè¡Œä¸ºä¸€è¡Œ\n/å­—ç¬¦ä¸²ï¼šå‘ä¸‹æœç´¢â€œå­—ç¬¦ä¸²â€çš„åŠŸèƒ½\n?å­—ç¬¦ä¸²ï¼šå‘ä¸Šæœç´¢â€œå­—ç¬¦ä¸²â€çš„åŠŸèƒ½\nnï¼šé‡å¤å‰ä¸€ä¸ªæœç´¢ï¼ˆä¸ / æˆ– ? æœ‰å…³ï¼‰\nNï¼šåå‘é‡å¤å‰ä¸€ä¸ªæœç´¢ï¼ˆä¸ / æˆ– ? æœ‰å…³ï¼‰\n-x <æ•°å­—> å°†â€œtabâ€é”®æ˜¾ç¤ºä¸ºè§„å®šçš„æ•°å­—ç©ºæ ¼\nb  å‘åç¿»ä¸€é¡µ\nd  å‘åç¿»åŠé¡µ\nh  æ˜¾ç¤ºå¸®åŠ©ç•Œé¢\nQ  é€€å‡ºless å‘½ä»¤\nu  å‘å‰æ»šåŠ¨åŠé¡µ\ny  å‘å‰æ»šåŠ¨ä¸€è¡Œ\nç©ºæ ¼é”® æ»šåŠ¨ä¸€è¡Œ\nå›è½¦é”® æ»šåŠ¨ä¸€é¡µ\n[pagedown]ï¼š å‘ä¸‹ç¿»åŠ¨ä¸€é¡µ\n[pageup]ï¼š   å‘ä¸Šç¿»åŠ¨ä¸€é¡µ\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰ps æŸ¥çœ‹è¿›ç¨‹ä¿¡æ¯å¹¶é€šè¿‡ less åˆ†é¡µæ˜¾ç¤º\n\n```shell\nps -aux | less -N\n```\n\nï¼ˆ2ï¼‰æŸ¥çœ‹å¤šä¸ªæ–‡ä»¶\n\n```shell\nless 1.log 2.log\n```\n\nå¯ä»¥ä½¿ç”¨ n æŸ¥çœ‹ä¸‹ä¸€ä¸ªï¼Œä½¿ç”¨ p æŸ¥çœ‹å‰ä¸€ä¸ªã€‚\n\n### ln å‘½ä»¤\n\nåŠŸèƒ½æ˜¯ä¸ºæ–‡ä»¶åœ¨å¦å¤–ä¸€ä¸ªä½ç½®å»ºç«‹ä¸€ä¸ªåŒæ­¥çš„é“¾æ¥ï¼Œå½“åœ¨ä¸åŒç›®å½•éœ€è¦è¯¥é—®é¢˜æ—¶ï¼Œå°±ä¸éœ€è¦ä¸ºæ¯ä¸€ä¸ªç›®å½•åˆ›å»ºåŒæ ·çš„æ–‡ä»¶ï¼Œé€šè¿‡ ln åˆ›å»ºçš„é“¾æ¥ï¼ˆlinkï¼‰å‡å°‘ç£ç›˜å ç”¨é‡ã€‚\n\né“¾æ¥åˆ†ç±»ï¼šè½¯ä»¶é“¾æ¥åŠç¡¬é“¾æ¥\n\nè½¯é“¾æ¥ï¼š\n\n- 1.è½¯é“¾æ¥ï¼Œä»¥è·¯å¾„çš„å½¢å¼å­˜åœ¨ã€‚ç±»ä¼¼äº Windows æ“ä½œç³»ç»Ÿä¸­çš„å¿«æ·æ–¹å¼\n- 2.è½¯é“¾æ¥å¯ä»¥ è·¨æ–‡ä»¶ç³»ç»Ÿ ï¼Œç¡¬é“¾æ¥ä¸å¯ä»¥\n- 3.è½¯é“¾æ¥å¯ä»¥å¯¹ä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶åè¿›è¡Œé“¾æ¥\n- 4.è½¯é“¾æ¥å¯ä»¥å¯¹ç›®å½•è¿›è¡Œé“¾æ¥\n\nç¡¬é“¾æ¥:\n\n- 1.ç¡¬é“¾æ¥ï¼Œä»¥æ–‡ä»¶å‰¯æœ¬çš„å½¢å¼å­˜åœ¨ã€‚ä½†ä¸å ç”¨å®é™…ç©ºé—´ã€‚\n- 2.ä¸å…è®¸ç»™ç›®å½•åˆ›å»ºç¡¬é“¾æ¥\n- 3.ç¡¬é“¾æ¥åªæœ‰åœ¨åŒä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿä¸­æ‰èƒ½åˆ›å»º\n\n**éœ€è¦æ³¨æ„**ï¼š\n\n- ç¬¬ä¸€ï¼šln å‘½ä»¤ä¼šä¿æŒæ¯ä¸€å¤„é“¾æ¥æ–‡ä»¶çš„åŒæ­¥æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸è®ºä½ æ”¹åŠ¨äº†å“ªä¸€å¤„ï¼Œå…¶å®ƒçš„æ–‡ä»¶éƒ½ä¼šå‘ç”Ÿç›¸åŒçš„å˜åŒ–ï¼›\n- ç¬¬äºŒï¼šln çš„é“¾æ¥åˆåˆ†è½¯é“¾æ¥å’Œç¡¬é“¾æ¥ä¸¤ç§ï¼Œè½¯é“¾æ¥å°±æ˜¯ ln â€“s æºæ–‡ä»¶ ç›®æ ‡æ–‡ä»¶ï¼Œå®ƒåªä¼šåœ¨ä½ é€‰å®šçš„ä½ç½®ä¸Šç”Ÿæˆä¸€ä¸ªæ–‡ä»¶çš„é•œåƒï¼Œä¸ä¼šå ç”¨ç£ç›˜ç©ºé—´ï¼Œç¡¬é“¾æ¥ ln æºæ–‡ä»¶ ç›®æ ‡æ–‡ä»¶ï¼Œæ²¡æœ‰å‚æ•°-sï¼Œ å®ƒä¼šåœ¨ä½ é€‰å®šçš„ä½ç½®ä¸Šç”Ÿæˆä¸€ä¸ªå’Œæºæ–‡ä»¶å¤§å°ç›¸åŒçš„æ–‡ä»¶ï¼Œæ— è®ºæ˜¯è½¯é“¾æ¥è¿˜æ˜¯ç¡¬é“¾æ¥ï¼Œæ–‡ä»¶éƒ½ä¿æŒåŒæ­¥å˜åŒ–ã€‚\n- ç¬¬ä¸‰ï¼šln æŒ‡ä»¤ç”¨åœ¨é“¾æ¥æ–‡ä»¶æˆ–ç›®å½•ï¼Œå¦‚åŒæ—¶æŒ‡å®šä¸¤ä¸ªä»¥ä¸Šçš„æ–‡ä»¶æˆ–ç›®å½•ï¼Œä¸”æœ€åçš„ç›®çš„åœ°æ˜¯ä¸€ä¸ªå·²ç»å­˜åœ¨çš„ç›®å½•ï¼Œåˆ™ä¼šæŠŠå‰é¢æŒ‡å®šçš„æ‰€æœ‰æ–‡ä»¶æˆ–ç›®å½•å¤åˆ¶åˆ°è¯¥ç›®å½•ä¸­ã€‚è‹¥åŒæ—¶æŒ‡å®šå¤šä¸ªæ–‡ä»¶æˆ–ç›®å½•ï¼Œä¸”æœ€åçš„ç›®çš„åœ°å¹¶éæ˜¯ä¸€ä¸ªå·²å­˜åœ¨çš„ç›®å½•ï¼Œåˆ™ä¼šå‡ºç°é”™è¯¯ä¿¡æ¯ã€‚\n\n**å¸¸ç”¨å‚æ•°**ï¼š\n\n```\n-b åˆ é™¤ï¼Œè¦†ç›–ä»¥å‰å»ºç«‹çš„é“¾æ¥\n-s è½¯é“¾æ¥ï¼ˆç¬¦å·é“¾æ¥ï¼‰\n-v æ˜¾ç¤ºè¯¦ç»†å¤„ç†è¿‡ç¨‹\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰ç»™æ–‡ä»¶åˆ›å»ºè½¯é“¾æ¥ï¼Œå¹¶æ˜¾ç¤ºæ“ä½œä¿¡æ¯\n\n```shell\nln -sv source.log link.log\n```\n\nï¼ˆ2ï¼‰ç»™æ–‡ä»¶åˆ›å»ºç¡¬é“¾æ¥ï¼Œå¹¶æ˜¾ç¤ºæ“ä½œä¿¡æ¯\n\n```shell\nln -v source.log link1.log\n```\n\nï¼ˆ3ï¼‰ç»™ç›®å½•åˆ›å»ºè½¯é“¾æ¥\n\n```shell\nln -sv /opt/soft/test/test3 /opt/soft/test/test5\n```\n\n### locate å‘½ä»¤\n\nlocate é€šè¿‡æœå¯»ç³»ç»Ÿå†…å»ºæ–‡æ¡£æ•°æ®åº“è¾¾åˆ°å¿«é€Ÿæ‰¾åˆ°æ¡£æ¡ˆï¼Œæ•°æ®åº“ç”± updatedb ç¨‹åºæ¥æ›´æ–°ï¼Œupdatedb æ˜¯ç”± cron daemon å‘¨æœŸæ€§è°ƒç”¨çš„ã€‚é»˜è®¤æƒ…å†µä¸‹ locate å‘½ä»¤åœ¨æœå¯»æ•°æ®åº“æ—¶æ¯”ç”±æ•´ä¸ªç”±ç¡¬ç›˜èµ„æ–™æ¥æœå¯»èµ„æ–™æ¥å¾—å¿«ï¼Œä½†è¾ƒå·®åŠ²çš„æ˜¯ locate æ‰€æ‰¾åˆ°çš„æ¡£æ¡ˆè‹¥æ˜¯æœ€è¿‘æ‰å»ºç«‹æˆ– åˆšæ›´åçš„ï¼Œå¯èƒ½ä¼šæ‰¾ä¸åˆ°ï¼Œåœ¨å†…å®šå€¼ä¸­ï¼Œupdatedb æ¯å¤©ä¼šè·‘ä¸€æ¬¡ï¼Œå¯ä»¥ç”±ä¿®æ”¹ crontab æ¥æ›´æ–°è®¾å®šå€¼ (etc/crontab)ã€‚\n\nlocate ä¸ find å‘½ä»¤ç›¸ä¼¼ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ *ã€? ç­‰è¿›è¡Œæ­£åˆ™åŒ¹é…æŸ¥æ‰¾\n\n**å¸¸ç”¨å‚æ•°**ï¼š\n\n```\n-l numï¼ˆè¦æ˜¾ç¤ºçš„è¡Œæ•°ï¼‰\n-f   å°†ç‰¹å®šçš„æ¡£æ¡ˆç³»ç»Ÿæ’é™¤åœ¨å¤–ï¼Œå¦‚å°†procæ’é™¤åœ¨å¤–\n-r   ä½¿ç”¨æ­£åˆ™è¿ç®—å¼åšä¸ºå¯»æ‰¾æ¡ä»¶\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰æŸ¥æ‰¾å’Œ pwd ç›¸å…³çš„æ‰€æœ‰æ–‡ä»¶(æ–‡ä»¶åä¸­åŒ…å« pwdï¼‰\n\n```shell\nlocate pwd\n```\n\nï¼ˆ2ï¼‰æœç´¢ etc ç›®å½•ä¸‹æ‰€æœ‰ä»¥ sh å¼€å¤´çš„æ–‡ä»¶\n\n```shell\nlocate /etc/sh\n```\n\nï¼ˆ3ï¼‰æŸ¥æ‰¾ /var ç›®å½•ä¸‹ï¼Œä»¥ reason ç»“å°¾çš„æ–‡ä»¶\n\n```shell\nlocate -r '^/var.*reason$'ï¼ˆå…¶ä¸­.è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼Œ*è¡¨ç¤ºä»»åŠ¡å¤šä¸ªï¼›.*è¡¨ç¤ºä»»æ„å¤šä¸ªå­—ç¬¦ï¼‰\n```\n\n### more å‘½ä»¤\n\nåŠŸèƒ½ç±»ä¼¼äº cat, more ä¼šä»¥ä¸€é¡µä¸€é¡µçš„æ˜¾ç¤ºæ–¹ä¾¿ä½¿ç”¨è€…é€é¡µé˜…è¯»ï¼Œè€Œæœ€åŸºæœ¬çš„æŒ‡ä»¤å°±æ˜¯æŒ‰ç©ºç™½é”®ï¼ˆspaceï¼‰å°±å¾€ä¸‹ä¸€é¡µæ˜¾ç¤ºï¼ŒæŒ‰ b é”®å°±ä¼šå¾€å›ï¼ˆbackï¼‰ä¸€é¡µæ˜¾ç¤ºã€‚\n\n**å‘½ä»¤å‚æ•°**ï¼š\n\n```\n+n      ä»ç¬« n è¡Œå¼€å§‹æ˜¾ç¤º\n-n       å®šä¹‰å±å¹•å¤§å°ä¸ºnè¡Œ\n+/pattern åœ¨æ¯ä¸ªæ¡£æ¡ˆæ˜¾ç¤ºå‰æœå¯»è¯¥å­—ä¸²ï¼ˆpatternï¼‰ï¼Œç„¶åä»è¯¥å­—ä¸²å‰ä¸¤è¡Œä¹‹åå¼€å§‹æ˜¾ç¤º \n-c       ä»é¡¶éƒ¨æ¸…å±ï¼Œç„¶åæ˜¾ç¤º\n-d       æç¤ºâ€œPress space to continueï¼Œâ€™qâ€™ to quitï¼ˆæŒ‰ç©ºæ ¼é”®ç»§ç»­ï¼ŒæŒ‰qé”®é€€å‡ºï¼‰â€ï¼Œç¦ç”¨å“é“ƒåŠŸèƒ½\n-l        å¿½ç•¥Ctrl+lï¼ˆæ¢é¡µï¼‰å­—ç¬¦\n-p       é€šè¿‡æ¸…é™¤çª—å£è€Œä¸æ˜¯æ»šå±æ¥å¯¹æ–‡ä»¶è¿›è¡Œæ¢é¡µï¼Œä¸-cé€‰é¡¹ç›¸ä¼¼\n-s       æŠŠè¿ç»­çš„å¤šä¸ªç©ºè¡Œæ˜¾ç¤ºä¸ºä¸€è¡Œ\n-u       æŠŠæ–‡ä»¶å†…å®¹ä¸­çš„ä¸‹ç”»çº¿å»æ‰\n```\n\n**å¸¸ç”¨æ“ä½œå‘½ä»¤**ï¼š\n\n```\nEnter    å‘ä¸‹ n è¡Œï¼Œéœ€è¦å®šä¹‰ã€‚é»˜è®¤ä¸º 1 è¡Œ\nCtrl+F   å‘ä¸‹æ»šåŠ¨ä¸€å±\nç©ºæ ¼é”®  å‘ä¸‹æ»šåŠ¨ä¸€å±\nCtrl+B  è¿”å›ä¸Šä¸€å±\n=       è¾“å‡ºå½“å‰è¡Œçš„è¡Œå·\n:f     è¾“å‡ºæ–‡ä»¶åå’Œå½“å‰è¡Œçš„è¡Œå·\nV      è°ƒç”¨viç¼–è¾‘å™¨\n!å‘½ä»¤   è°ƒç”¨Shellï¼Œå¹¶æ‰§è¡Œå‘½ä»¤\nq       é€€å‡ºmore\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰æ˜¾ç¤ºæ–‡ä»¶ä¸­ä»ç¬¬ 3 è¡Œèµ·çš„å†…å®¹\n\n```shell\nmore +3 text.txt\n```\n\nï¼ˆ2ï¼‰åœ¨æ‰€åˆ—å‡ºæ–‡ä»¶ç›®å½•è¯¦ç»†ä¿¡æ¯ï¼Œå€ŸåŠ©ç®¡é“ä½¿æ¯æ¬¡æ˜¾ç¤º 5 è¡Œ\n\n```shell\nls -l | more -5\n```\n\næŒ‰ç©ºæ ¼æ˜¾ç¤ºä¸‹ 5 è¡Œã€‚\n\n### mv å‘½ä»¤\n\nç§»åŠ¨æ–‡ä»¶æˆ–ä¿®æ”¹æ–‡ä»¶åï¼Œæ ¹æ®ç¬¬äºŒå‚æ•°ç±»å‹ï¼ˆå¦‚ç›®å½•ï¼Œåˆ™ç§»åŠ¨æ–‡ä»¶ï¼›å¦‚ä¸ºæ–‡ä»¶åˆ™é‡å‘½ä»¤è¯¥æ–‡ä»¶ï¼‰ã€‚\n\nå½“ç¬¬äºŒä¸ªå‚æ•°ä¸ºç›®å½•æ—¶ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥æ˜¯å¤šä¸ªä»¥ç©ºæ ¼åˆ†éš”çš„æ–‡ä»¶æˆ–ç›®å½•ï¼Œç„¶åç§»åŠ¨ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šçš„å¤šä¸ªæ–‡ä»¶åˆ°ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šçš„ç›®å½•ä¸­ã€‚\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰å°†æ–‡ä»¶ test.log é‡å‘½åä¸º test1.txt\n\n```shell\nmv test.log test1.txt\n```\n\nï¼ˆ2ï¼‰å°†æ–‡ä»¶ log1.txtã€log2.txtã€log3.txt ç§»åŠ¨åˆ°æ ¹çš„ test3 ç›®å½•ä¸­\n\n```shell\nmv llog1.txt log2.txt log3.txt /test3\n```\n\nï¼ˆ3ï¼‰å°†æ–‡ä»¶ file1 æ”¹åä¸º file2ï¼Œå¦‚æœ file2 å·²ç»å­˜åœ¨ï¼Œåˆ™è¯¢é—®æ˜¯å¦è¦†ç›–\n\n```shell\nmv -i log1.txt log2.txt\n```\n\nï¼ˆ4ï¼‰ç§»åŠ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åˆ°ä¸Šä¸€çº§ç›®å½•\n\n```shell\nmv * ../\n```\n\n### rm å‘½ä»¤\n\nåˆ é™¤ä¸€ä¸ªç›®å½•ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶æˆ–ç›®å½•ï¼Œå¦‚æœæ²¡æœ‰ä½¿ç”¨ -r é€‰é¡¹ï¼Œåˆ™ rm ä¸ä¼šåˆ é™¤ç›®å½•ã€‚å¦‚æœä½¿ç”¨ rm æ¥åˆ é™¤æ–‡ä»¶ï¼Œé€šå¸¸ä»å¯ä»¥å°†è¯¥æ–‡ä»¶æ¢å¤åŸçŠ¶ã€‚\n\n```shell\nrm [é€‰é¡¹] æ–‡ä»¶â€¦\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰åˆ é™¤ä»»ä½• .log æ–‡ä»¶ï¼Œåˆ é™¤å‰é€ä¸€è¯¢é—®ç¡®è®¤ï¼š\n\n```shell\nrm -i *.log\n```\n\nï¼ˆ2ï¼‰åˆ é™¤ test å­ç›®å½•åŠå­ç›®å½•ä¸­æ‰€æœ‰æ¡£æ¡ˆåˆ é™¤ï¼Œå¹¶ä¸”ä¸ç”¨ä¸€ä¸€ç¡®è®¤ï¼š\n\n```shell\nrm -rf test\n```\n\nï¼ˆ3ï¼‰åˆ é™¤ä»¥ -f å¼€å¤´çš„æ–‡ä»¶\n\n```shell\nrm -- -f*\n```\n\n### tail å‘½ä»¤\n\nç”¨äºæ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶æœ«å°¾å†…å®¹ï¼Œä¸æŒ‡å®šæ–‡ä»¶æ—¶ï¼Œä½œä¸ºè¾“å…¥ä¿¡æ¯è¿›è¡Œå¤„ç†ã€‚å¸¸ç”¨æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ã€‚\n\n**å¸¸ç”¨å‚æ•°**ï¼š\n\n```\n-f å¾ªç¯è¯»å–ï¼ˆå¸¸ç”¨äºæŸ¥çœ‹é€’å¢çš„æ—¥å¿—æ–‡ä»¶ï¼‰\n-n<è¡Œæ•°> æ˜¾ç¤ºè¡Œæ•°ï¼ˆä»åå‘å‰ï¼‰\n```\n\nï¼ˆ1ï¼‰å¾ªç¯è¯»å–é€æ¸å¢åŠ çš„æ–‡ä»¶å†…å®¹\n\n```shell\nping 127.0.0.1 > ping.log &\n```\n\nåå°è¿è¡Œï¼šå¯ä½¿ç”¨ jobs -l æŸ¥çœ‹ï¼Œä¹Ÿå¯ä½¿ç”¨ fg å°†å…¶ç§»åˆ°å‰å°è¿è¡Œã€‚\n\n```shell\ntail -f ping.log\n```\n\nï¼ˆæŸ¥çœ‹æ—¥å¿—ï¼‰\n\n### touch å‘½ä»¤\n\nLinux touch å‘½ä»¤ç”¨äºä¿®æ”¹æ–‡ä»¶æˆ–è€…ç›®å½•çš„æ—¶é—´å±æ€§ï¼ŒåŒ…æ‹¬å­˜å–æ—¶é—´å’Œæ›´æ”¹æ—¶é—´ã€‚è‹¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œç³»ç»Ÿä¼šå»ºç«‹ä¸€ä¸ªæ–°çš„æ–‡ä»¶ã€‚\n\nls -l å¯ä»¥æ˜¾ç¤ºæ¡£æ¡ˆçš„æ—¶é—´è®°å½•ã€‚\n\n**è¯­æ³•**\n\n```\ntouch [-acfm][-d<æ—¥æœŸæ—¶é—´>][-r<å‚è€ƒæ–‡ä»¶æˆ–ç›®å½•>] [-t<æ—¥æœŸæ—¶é—´>][--help][--version][æ–‡ä»¶æˆ–ç›®å½•â€¦]\n```\n\n- **å‚æ•°è¯´æ˜**ï¼š\n- a æ”¹å˜æ¡£æ¡ˆçš„è¯»å–æ—¶é—´è®°å½•ã€‚\n- m æ”¹å˜æ¡£æ¡ˆçš„ä¿®æ”¹æ—¶é—´è®°å½•ã€‚\n- c å‡å¦‚ç›®çš„æ¡£æ¡ˆä¸å­˜åœ¨ï¼Œä¸ä¼šå»ºç«‹æ–°çš„æ¡£æ¡ˆã€‚ä¸ --no-create çš„æ•ˆæœä¸€æ ·ã€‚\n- f ä¸ä½¿ç”¨ï¼Œæ˜¯ä¸ºäº†ä¸å…¶ä»– unix ç³»ç»Ÿçš„ç›¸å®¹æ€§è€Œä¿ç•™ã€‚\n- r ä½¿ç”¨å‚è€ƒæ¡£çš„æ—¶é—´è®°å½•ï¼Œä¸ --file çš„æ•ˆæœä¸€æ ·ã€‚\n- d è®¾å®šæ—¶é—´ä¸æ—¥æœŸï¼Œå¯ä»¥ä½¿ç”¨å„ç§ä¸åŒçš„æ ¼å¼ã€‚\n- t è®¾å®šæ¡£æ¡ˆçš„æ—¶é—´è®°å½•ï¼Œæ ¼å¼ä¸ date æŒ‡ä»¤ç›¸åŒã€‚\n- â€“no-create ä¸ä¼šå»ºç«‹æ–°æ¡£æ¡ˆã€‚\n- â€“help åˆ—å‡ºæŒ‡ä»¤æ ¼å¼ã€‚\n- â€“version åˆ—å‡ºç‰ˆæœ¬è®¯æ¯ã€‚\n\n**å®ä¾‹**\n\nä½¿ç”¨æŒ‡ä»¤\"touch\"ä¿®æ”¹æ–‡ä»¶\"testfile\"çš„æ—¶é—´å±æ€§ä¸ºå½“å‰ç³»ç»Ÿæ—¶é—´ï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š\n\n```shell\n$ touch testfile                #ä¿®æ”¹æ–‡ä»¶çš„æ—¶é—´å±æ€§ \n```\n\né¦–å…ˆï¼Œä½¿ç”¨ ls å‘½ä»¤æŸ¥çœ‹ testfile æ–‡ä»¶çš„å±æ€§ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\n\n```shell\n$ ls -l testfile                #æŸ¥çœ‹æ–‡ä»¶çš„æ—¶é—´å±æ€§  \n#åŸæ¥æ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´ä¸º16:09  \n-rw-r--r-- 1 hdd hdd 55 2011-08-22 16:09 testfile  \n```\n\næ‰§è¡ŒæŒ‡ä»¤\"touch\"ä¿®æ”¹æ–‡ä»¶å±æ€§ä»¥åï¼Œå¹¶å†æ¬¡æŸ¥çœ‹è¯¥æ–‡ä»¶çš„æ—¶é—´å±æ€§ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\n\n```shell\n$ touch testfile                #ä¿®æ”¹æ–‡ä»¶æ—¶é—´å±æ€§ä¸ºå½“å‰ç³»ç»Ÿæ—¶é—´  \n$ ls -l testfile                #æŸ¥çœ‹æ–‡ä»¶çš„æ—¶é—´å±æ€§  \n#ä¿®æ”¹åæ–‡ä»¶çš„æ—¶é—´å±æ€§ä¸ºå½“å‰ç³»ç»Ÿæ—¶é—´  \n-rw-r--r-- 1 hdd hdd 55 2011-08-22 19:53 testfile  \n```\n\nä½¿ç”¨æŒ‡ä»¤\"touch\"æ—¶ï¼Œå¦‚æœæŒ‡å®šçš„æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™å°†åˆ›å»ºä¸€ä¸ªæ–°çš„ç©ºç™½æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼Œåœ¨å½“å‰ç›®å½•ä¸‹ï¼Œä½¿ç”¨è¯¥æŒ‡ä»¤åˆ›å»ºä¸€ä¸ªç©ºç™½æ–‡ä»¶\"file\"ï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š\n\n```shell\n$ touch file            #åˆ›å»ºä¸€ä¸ªåä¸ºâ€œfileâ€çš„æ–°çš„ç©ºç™½æ–‡ä»¶ \n```\n\n### vim å‘½ä»¤\n\nVim æ˜¯ä» vi å‘å±•å‡ºæ¥çš„ä¸€ä¸ªæ–‡æœ¬ç¼–è¾‘å™¨ã€‚ä»£ç è¡¥å®Œã€ç¼–è¯‘åŠé”™è¯¯è·³è½¬ç­‰æ–¹ä¾¿ç¼–ç¨‹çš„åŠŸèƒ½ç‰¹åˆ«ä¸°å¯Œï¼Œåœ¨ç¨‹åºå‘˜ä¸­è¢«å¹¿æ³›ä½¿ç”¨ã€‚\n\n- æ‰“å¼€æ–‡ä»¶å¹¶è·³åˆ°ç¬¬ 10 è¡Œï¼š`vim +10 filename.txt` ã€‚\n- æ‰“å¼€æ–‡ä»¶è·³åˆ°ç¬¬ä¸€ä¸ªåŒ¹é…çš„è¡Œï¼š`vim +/search-term filename.txt` ã€‚\n- ä»¥åªè¯»æ¨¡å¼æ‰“å¼€æ–‡ä»¶ï¼š`vim -R /etc/passwd` ã€‚\n\nåŸºæœ¬ä¸Š vi/vim å…±åˆ†ä¸ºä¸‰ç§æ¨¡å¼ï¼Œåˆ†åˆ«æ˜¯**å‘½ä»¤æ¨¡å¼ï¼ˆCommand modeï¼‰**ï¼Œ**è¾“å…¥æ¨¡å¼ï¼ˆInsert modeï¼‰\\**å’Œ\\**åº•çº¿å‘½ä»¤æ¨¡å¼ï¼ˆLast line modeï¼‰**ã€‚\n\nç®€å•çš„è¯´ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸‰ä¸ªæ¨¡å¼æƒ³æˆåº•ä¸‹çš„å›¾æ ‡æ¥è¡¨ç¤ºï¼š\n\n![vim å·¥ä½œæ¨¡å¼](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/format,png-20230125135806349.png)\n\n### whereis å‘½ä»¤\n\nwhereis å‘½ä»¤åªèƒ½ç”¨äºç¨‹åºåçš„æœç´¢ï¼Œè€Œä¸”åªæœç´¢äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆå‚æ•°-bï¼‰ã€man è¯´æ˜æ–‡ä»¶ï¼ˆå‚æ•°-mï¼‰å’Œæºä»£ç æ–‡ä»¶ï¼ˆå‚æ•°-sï¼‰ã€‚å¦‚æœçœç•¥å‚æ•°ï¼Œåˆ™è¿”å›æ‰€æœ‰ä¿¡æ¯ã€‚whereis åŠ locate éƒ½æ˜¯åŸºäºç³»ç»Ÿå†…å»ºçš„æ•°æ®åº“è¿›è¡Œæœç´¢ï¼Œå› æ­¤æ•ˆç‡å¾ˆé«˜ï¼Œè€Œ find åˆ™æ˜¯éå†ç¡¬ç›˜æŸ¥æ‰¾æ–‡ä»¶ã€‚\n\n**å¸¸ç”¨å‚æ•°**ï¼š\n\n```\n-b   å®šä½å¯æ‰§è¡Œæ–‡ä»¶ã€‚\n-m   å®šä½å¸®åŠ©æ–‡ä»¶ã€‚\n-s   å®šä½æºä»£ç æ–‡ä»¶ã€‚\n-u   æœç´¢é»˜è®¤è·¯å¾„ä¸‹é™¤å¯æ‰§è¡Œæ–‡ä»¶ã€æºä»£ç æ–‡ä»¶ã€å¸®åŠ©æ–‡ä»¶ä»¥å¤–çš„å…¶å®ƒæ–‡ä»¶ã€‚\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰æŸ¥æ‰¾ locate ç¨‹åºç›¸å…³æ–‡ä»¶\n\n```shell\nwhereis locate\n```\n\nï¼ˆ2ï¼‰æŸ¥æ‰¾ locate çš„æºç æ–‡ä»¶\n\n```shell\nwhereis -s locate\n```\n\nï¼ˆ3ï¼‰æŸ¥æ‰¾ lcoate çš„å¸®åŠ©æ–‡ä»¶\n\n```shell\nwhereis -m locate\n```\n\n### which å‘½ä»¤\n\nåœ¨ linux è¦æŸ¥æ‰¾æŸä¸ªæ–‡ä»¶ï¼Œä½†ä¸çŸ¥é“æ”¾åœ¨å“ªé‡Œäº†ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä¸€äº›å‘½ä»¤æ¥æœç´¢ï¼š\n\n```\nwhich     æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶çš„ä½ç½®ã€‚\nwhereis æŸ¥çœ‹æ–‡ä»¶çš„ä½ç½®ã€‚\nlocate  é…åˆæ•°æ®åº“æŸ¥çœ‹æ–‡ä»¶ä½ç½®ã€‚\nfind        å®é™…æœå¯»ç¡¬ç›˜æŸ¥è¯¢æ–‡ä»¶åç§°ã€‚\n```\n\nwhich æ˜¯åœ¨ PATH å°±æ˜¯æŒ‡å®šçš„è·¯å¾„ä¸­ï¼Œæœç´¢æŸä¸ªç³»ç»Ÿå‘½ä»¤çš„ä½ç½®ï¼Œå¹¶è¿”å›ç¬¬ä¸€ä¸ªæœç´¢ç»“æœã€‚ä½¿ç”¨ which å‘½ä»¤ï¼Œå°±å¯ä»¥çœ‹åˆ°æŸä¸ªç³»ç»Ÿå‘½ä»¤æ˜¯å¦å­˜åœ¨ï¼Œä»¥åŠæ‰§è¡Œçš„åˆ°åº•æ˜¯å“ªä¸€ä¸ªä½ç½®çš„å‘½ä»¤ã€‚\n\n**å¸¸ç”¨å‚æ•°**ï¼š\n\n```\n-n ã€€æŒ‡å®šæ–‡ä»¶åé•¿åº¦ï¼ŒæŒ‡å®šçš„é•¿åº¦å¿…é¡»å¤§äºæˆ–ç­‰äºæ‰€æœ‰æ–‡ä»¶ä¸­æœ€é•¿çš„æ–‡ä»¶åã€‚\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰æŸ¥çœ‹ ls å‘½ä»¤æ˜¯å¦å­˜åœ¨ï¼Œæ‰§è¡Œå“ªä¸ª\n\n```shell\nwhich ls\n```\n\nï¼ˆ2ï¼‰æŸ¥çœ‹ which\n\n```shell\nwhich which\n```\n\nï¼ˆ3ï¼‰æŸ¥çœ‹ cd\n\n```shell\nwhich cdï¼ˆæ˜¾ç¤ºä¸å­˜åœ¨ï¼Œå› ä¸º cd æ˜¯å†…å»ºå‘½ä»¤ï¼Œè€Œ which æŸ¥æ‰¾æ˜¾ç¤ºæ˜¯ PATH ä¸­çš„å‘½ä»¤ï¼‰\n```\n\næŸ¥çœ‹å½“å‰ PATH é…ç½®ï¼š\n\n```shell\necho $PATH\n```\n\næˆ–ä½¿ç”¨ env æŸ¥çœ‹æ‰€æœ‰ç¯å¢ƒå˜é‡åŠå¯¹åº”å€¼\n\n## æ–‡æ¡£ç¼–è¾‘å‘½ä»¤\n\n### grep å‘½ä»¤\n\nå¼ºå¤§çš„æ–‡æœ¬æœç´¢å‘½ä»¤ï¼Œgrep(Global Regular Expression Print) å…¨å±€æ­£åˆ™è¡¨è¾¾å¼æœç´¢ã€‚\n\ngrep çš„å·¥ä½œæ–¹å¼æ˜¯è¿™æ ·çš„ï¼Œå®ƒåœ¨ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶ä¸­æœç´¢å­—ç¬¦ä¸²æ¨¡æ¿ã€‚å¦‚æœæ¨¡æ¿åŒ…æ‹¬ç©ºæ ¼ï¼Œåˆ™å¿…é¡»è¢«å¼•ç”¨ï¼Œæ¨¡æ¿åçš„æ‰€æœ‰å­—ç¬¦ä¸²è¢«çœ‹ä½œæ–‡ä»¶åã€‚æœç´¢çš„ç»“æœè¢«é€åˆ°æ ‡å‡†è¾“å‡ºï¼Œä¸å½±å“åŸæ–‡ä»¶å†…å®¹ã€‚\n\nå‘½ä»¤æ ¼å¼ï¼š\n\n```\ngrep [option] pattern file|dir\n```\n\n**å¸¸ç”¨å‚æ•°**ï¼š\n\n```\n-A n --after-contextæ˜¾ç¤ºåŒ¹é…å­—ç¬¦ånè¡Œ\n-B n --before-contextæ˜¾ç¤ºåŒ¹é…å­—ç¬¦å‰nè¡Œ\n-C n --context æ˜¾ç¤ºåŒ¹é…å­—ç¬¦å‰ånè¡Œ\n-c --count è®¡ç®—ç¬¦åˆæ ·å¼çš„åˆ—æ•°\n-i å¿½ç•¥å¤§å°å†™\n-l åªåˆ—å‡ºæ–‡ä»¶å†…å®¹ç¬¦åˆæŒ‡å®šçš„æ ·å¼çš„æ–‡ä»¶åç§°\n-f ä»æ–‡ä»¶ä¸­è¯»å–å…³é”®è¯\n-n æ˜¾ç¤ºåŒ¹é…å†…å®¹çš„æ‰€åœ¨æ–‡ä»¶ä¸­è¡Œæ•°\n-R é€’å½’æŸ¥æ‰¾æ–‡ä»¶å¤¹\n```\n\ngrep çš„è§„åˆ™è¡¨è¾¾å¼:\n\n```\n^  #é”šå®šè¡Œçš„å¼€å§‹ å¦‚ï¼š'^grep'åŒ¹é…æ‰€æœ‰ä»¥grepå¼€å¤´çš„è¡Œã€‚ \n$  #é”šå®šè¡Œçš„ç»“æŸ å¦‚ï¼š'grep$'åŒ¹é…æ‰€æœ‰ä»¥grepç»“å°¾çš„è¡Œã€‚ \n.  #åŒ¹é…ä¸€ä¸ªéæ¢è¡Œç¬¦çš„å­—ç¬¦ å¦‚ï¼š'gr.p'åŒ¹é…gråæ¥ä¸€ä¸ªä»»æ„å­—ç¬¦ï¼Œç„¶åæ˜¯pã€‚  \n*  #åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªå…ˆå‰å­—ç¬¦ å¦‚ï¼š'*grep'åŒ¹é…æ‰€æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªç©ºæ ¼åç´§è·Ÿgrepçš„è¡Œã€‚\n.*   #ä¸€èµ·ç”¨ä»£è¡¨ä»»æ„å­—ç¬¦ã€‚  \n[]   #åŒ¹é…ä¸€ä¸ªæŒ‡å®šèŒƒå›´å†…çš„å­—ç¬¦ï¼Œå¦‚'[Gg]rep'åŒ¹é…Grepå’Œgrepã€‚ \n[^]  #åŒ¹é…ä¸€ä¸ªä¸åœ¨æŒ‡å®šèŒƒå›´å†…çš„å­—ç¬¦ï¼Œå¦‚ï¼š'[^A-FH-Z]rep'åŒ¹é…ä¸åŒ…å«A-Rå’ŒT-Zçš„ä¸€ä¸ªå­—æ¯å¼€å¤´ï¼Œç´§è·Ÿrepçš„è¡Œã€‚  \n\\(..\\)  #æ ‡è®°åŒ¹é…å­—ç¬¦ï¼Œå¦‚'\\(love\\)'ï¼Œloveè¢«æ ‡è®°ä¸º1ã€‚   \n\\<      #é”šå®šå•è¯çš„å¼€å§‹ï¼Œå¦‚:'\\<grep'åŒ¹é…åŒ…å«ä»¥grepå¼€å¤´çš„å•è¯çš„è¡Œã€‚\n\\>      #é”šå®šå•è¯çš„ç»“æŸï¼Œå¦‚'grep\\>'åŒ¹é…åŒ…å«ä»¥grepç»“å°¾çš„å•è¯çš„è¡Œã€‚\nx\\{m\\}  #é‡å¤å­—ç¬¦xï¼Œmæ¬¡ï¼Œå¦‚ï¼š'0\\{5\\}'åŒ¹é…åŒ…å«5ä¸ªoçš„è¡Œã€‚ \nx\\{m,\\}  #é‡å¤å­—ç¬¦x,è‡³å°‘mæ¬¡ï¼Œå¦‚ï¼š'o\\{5,\\}'åŒ¹é…è‡³å°‘æœ‰5ä¸ªoçš„è¡Œã€‚  \nx\\{m,n\\}  #é‡å¤å­—ç¬¦xï¼Œè‡³å°‘mæ¬¡ï¼Œä¸å¤šäºnæ¬¡ï¼Œå¦‚ï¼š'o\\{5,10\\}'åŒ¹é…5--10ä¸ªoçš„è¡Œã€‚  \n\\w    #åŒ¹é…æ–‡å­—å’Œæ•°å­—å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯[A-Za-z0-9]ï¼Œå¦‚ï¼š'G\\w*p'åŒ¹é…ä»¥Gåè·Ÿé›¶ä¸ªæˆ–å¤šä¸ªæ–‡å­—æˆ–æ•°å­—å­—ç¬¦ï¼Œç„¶åæ˜¯pã€‚  \n\\W    #\\wçš„åç½®å½¢å¼ï¼ŒåŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªéå•è¯å­—ç¬¦ï¼Œå¦‚ç‚¹å·å¥å·ç­‰ã€‚  \n\\b    #å•è¯é”å®šç¬¦ï¼Œå¦‚: '\\bgrep\\b'åªåŒ¹é…grepã€‚\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰æŸ¥æ‰¾æŒ‡å®šè¿›ç¨‹\n\n```shell\nps -ef | grep svn\n```\n\nï¼ˆ2ï¼‰æŸ¥æ‰¾æŒ‡å®šè¿›ç¨‹ä¸ªæ•°\n\n```shell\nps -ef | grep svn -c\n```\n\nï¼ˆ3ï¼‰ä»æ–‡ä»¶ä¸­è¯»å–å…³é”®è¯\n\n```shell\ncat test1.txt | grep -f key.log\n```\n\nï¼ˆ4ï¼‰ä»æ–‡ä»¶å¤¹ä¸­é€’å½’æŸ¥æ‰¾ä»¥ grep å¼€å¤´çš„è¡Œï¼Œå¹¶åªåˆ—å‡ºæ–‡ä»¶\n\n```shell\ngrep -lR '^grep' /tmp\n```\n\nï¼ˆ5ï¼‰æŸ¥æ‰¾é x å¼€å…³çš„è¡Œå†…å®¹\n\n```shell\ngrep '^[^x]' test.txt\n```\n\nï¼ˆ6ï¼‰æ˜¾ç¤ºåŒ…å« ed æˆ–è€… at å­—ç¬¦çš„å†…å®¹è¡Œ\n\n```shell\ngrep -E 'ed|at' test.txt\n```\n\n### wc å‘½ä»¤\n\nwc(word count)åŠŸèƒ½ä¸ºç»Ÿè®¡æŒ‡å®šçš„æ–‡ä»¶ä¸­å­—èŠ‚æ•°ã€å­—æ•°ã€è¡Œæ•°ï¼Œå¹¶å°†ç»Ÿè®¡ç»“æœè¾“å‡º\n\nå‘½ä»¤æ ¼å¼ï¼š\n\n```\nwc [option] file..\n```\n\n**å‘½ä»¤å‚æ•°**ï¼š\n\n```\n-c ç»Ÿè®¡å­—èŠ‚æ•°\n-l ç»Ÿè®¡è¡Œæ•°\n-m ç»Ÿè®¡å­—ç¬¦æ•°\n-w ç»Ÿè®¡è¯æ•°ï¼Œä¸€ä¸ªå­—è¢«å®šä¹‰ä¸ºç”±ç©ºç™½ã€è·³æ ¼æˆ–æ¢è¡Œå­—ç¬¦åˆ†éš”çš„å­—ç¬¦ä¸²\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰æŸ¥æ‰¾æ–‡ä»¶çš„ è¡Œæ•° å•è¯æ•° å­—èŠ‚æ•° æ–‡ä»¶å\n\n```shell\nwc text.txt\n```\n\nç»“æœï¼š\n\n```shell\n7     8     70     test.txt\n```\n\nï¼ˆ2ï¼‰ç»Ÿè®¡è¾“å‡ºç»“æœçš„è¡Œæ•°\n\n```shell\ncat test.txt | wc -l\n```\n\n## ç£ç›˜ç®¡ç†å‘½ä»¤\n\n### cd å‘½ä»¤\n\ncd(changeDirectory) å‘½ä»¤è¯­æ³•ï¼š\n\n```\ncd [ç›®å½•å]\n```\n\nè¯´æ˜ï¼šåˆ‡æ¢å½“å‰ç›®å½•è‡³ dirNameã€‚\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰è¿›å…¥è¦ç›®å½•\n\n```shell\ncd /\n```\n\nï¼ˆ2ï¼‰è¿›å…¥ â€œhomeâ€ ç›®å½•\n\n```shell\ncd ~\n```\n\nï¼ˆ3ï¼‰è¿›å…¥ä¸Šä¸€æ¬¡å·¥ä½œè·¯å¾„\n\n```shell\ncd -\n```\n\nï¼ˆ4ï¼‰æŠŠä¸Šä¸ªå‘½ä»¤çš„å‚æ•°ä½œä¸º cd å‚æ•°ä½¿ç”¨ã€‚\n\n```shell\ncd !$\n```\n\n### df å‘½ä»¤\n\næ˜¾ç¤ºç£ç›˜ç©ºé—´ä½¿ç”¨æƒ…å†µã€‚è·å–ç¡¬ç›˜è¢«å ç”¨äº†å¤šå°‘ç©ºé—´ï¼Œç›®å‰è¿˜å‰©ä¸‹å¤šå°‘ç©ºé—´ç­‰ä¿¡æ¯ï¼Œå¦‚æœæ²¡æœ‰æ–‡ä»¶åè¢«æŒ‡å®šï¼Œåˆ™æ‰€æœ‰å½“å‰è¢«æŒ‚è½½çš„æ–‡ä»¶ç³»ç»Ÿçš„å¯ç”¨ç©ºé—´å°†è¢«æ˜¾ç¤ºã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œç£ç›˜ç©ºé—´å°†ä»¥ 1KB ä¸ºå•ä½è¿›è¡Œæ˜¾ç¤ºï¼Œé™¤éç¯å¢ƒå˜é‡ POSIXLY_CORRECT è¢«æŒ‡å®šï¼Œé‚£æ ·å°†ä»¥ 512 å­—èŠ‚ä¸ºå•ä½è¿›è¡Œæ˜¾ç¤ºï¼š\n\n```\n-a å…¨éƒ¨æ–‡ä»¶ç³»ç»Ÿåˆ—è¡¨\n-h ä»¥æ–¹ä¾¿é˜…è¯»çš„æ–¹å¼æ˜¾ç¤ºä¿¡æ¯\n-i æ˜¾ç¤ºinodeä¿¡æ¯\n-k åŒºå—ä¸º1024å­—èŠ‚\n-l åªæ˜¾ç¤ºæœ¬åœ°ç£ç›˜\n-T åˆ—å‡ºæ–‡ä»¶ç³»ç»Ÿç±»å‹\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰æ˜¾ç¤ºç£ç›˜ä½¿ç”¨æƒ…å†µ\n\n```shell\ndf -l\n```\n\nï¼ˆ2ï¼‰ä»¥æ˜“è¯»æ–¹å¼åˆ—å‡ºæ‰€æœ‰æ–‡ä»¶ç³»ç»ŸåŠå…¶ç±»å‹\n\n```shell\ndf -haT\n```\n\n### du å‘½ä»¤\n\ndu å‘½ä»¤ä¹Ÿæ˜¯æŸ¥çœ‹ä½¿ç”¨ç©ºé—´çš„ï¼Œä½†æ˜¯ä¸ df å‘½ä»¤ä¸åŒçš„æ˜¯ Linux du å‘½ä»¤æ˜¯å¯¹æ–‡ä»¶å’Œç›®å½•ç£ç›˜ä½¿ç”¨çš„ç©ºé—´çš„æŸ¥çœ‹ï¼š\n\nå‘½ä»¤æ ¼å¼ï¼š\n\n```\ndu [é€‰é¡¹] [æ–‡ä»¶]\n1\n```\n\n**å¸¸ç”¨å‚æ•°**ï¼š\n\n```\n-a æ˜¾ç¤ºç›®å½•ä¸­æ‰€æœ‰æ–‡ä»¶å¤§å°\n-k ä»¥KBä¸ºå•ä½æ˜¾ç¤ºæ–‡ä»¶å¤§å°\n-m ä»¥MBä¸ºå•ä½æ˜¾ç¤ºæ–‡ä»¶å¤§å°\n-g ä»¥GBä¸ºå•ä½æ˜¾ç¤ºæ–‡ä»¶å¤§å°\n-h ä»¥æ˜“è¯»æ–¹å¼æ˜¾ç¤ºæ–‡ä»¶å¤§å°\n-s ä»…æ˜¾ç¤ºæ€»è®¡\n-cæˆ–--total  é™¤äº†æ˜¾ç¤ºä¸ªåˆ«ç›®å½•æˆ–æ–‡ä»¶çš„å¤§å°å¤–ï¼ŒåŒæ—¶ä¹Ÿæ˜¾ç¤ºæ‰€æœ‰ç›®å½•æˆ–æ–‡ä»¶çš„æ€»å’Œ\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰ä»¥æ˜“è¯»æ–¹å¼æ˜¾ç¤ºæ–‡ä»¶å¤¹å†…åŠå­æ–‡ä»¶å¤¹å¤§å°\n\n```shell\ndu -h scf/\n```\n\nï¼ˆ2ï¼‰ä»¥æ˜“è¯»æ–¹å¼æ˜¾ç¤ºæ–‡ä»¶å¤¹å†…æ‰€æœ‰æ–‡ä»¶å¤§å°\n\n```shell\ndu -ah scf/\n```\n\nï¼ˆ3ï¼‰æ˜¾ç¤ºå‡ ä¸ªæ–‡ä»¶æˆ–ç›®å½•å„è‡ªå ç”¨ç£ç›˜ç©ºé—´çš„å¤§å°ï¼Œè¿˜ç»Ÿè®¡å®ƒä»¬çš„æ€»å’Œ\n\n```shell\ndu -hc test/ scf/\n```\n\nï¼ˆ4ï¼‰è¾“å‡ºå½“å‰ç›®å½•ä¸‹å„ä¸ªå­ç›®å½•æ‰€ä½¿ç”¨çš„ç©ºé—´\n\n```shell\ndu -hc --max-depth=1 scf/\n```\n\n### lså‘½ä»¤\n\nå°±æ˜¯ list çš„ç¼©å†™ï¼Œé€šè¿‡ ls å‘½ä»¤ä¸ä»…å¯ä»¥æŸ¥çœ‹ linux æ–‡ä»¶å¤¹åŒ…å«çš„æ–‡ä»¶ï¼Œè€Œä¸”å¯ä»¥æŸ¥çœ‹æ–‡ä»¶æƒé™(åŒ…æ‹¬ç›®å½•ã€æ–‡ä»¶å¤¹ã€æ–‡ä»¶æƒé™)î€‚æŸ¥çœ‹ç›®å½•ä¿¡æ¯ç­‰ç­‰ã€‚\n\n**å¸¸ç”¨å‚æ•°æ­é…**ï¼š\n\n```\nls -a åˆ—å‡ºç›®å½•æ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…å«ä»¥.å¼€å§‹çš„éšè—æ–‡ä»¶\nls -A åˆ—å‡ºé™¤.åŠ..çš„å…¶å®ƒæ–‡ä»¶\nls -r ååºæ’åˆ—\nls -t ä»¥æ–‡ä»¶ä¿®æ”¹æ—¶é—´æ’åº\nls -S ä»¥æ–‡ä»¶å¤§å°æ’åº\nls -h ä»¥æ˜“è¯»å¤§å°æ˜¾ç¤º\nls -l é™¤äº†æ–‡ä»¶åä¹‹å¤–ï¼Œè¿˜å°†æ–‡ä»¶çš„æƒé™ã€æ‰€æœ‰è€…ã€æ–‡ä»¶å¤§å°ç­‰ä¿¡æ¯è¯¦ç»†åˆ—å‡ºæ¥\n```\n\n**å®ä¾‹**ï¼š\n\n(1) æŒ‰æ˜“è¯»æ–¹å¼æŒ‰æ—¶é—´ååºæ’åºï¼Œå¹¶æ˜¾ç¤ºæ–‡ä»¶è¯¦ç»†ä¿¡æ¯\n\n```shell\nls -lhrt\n```\n\n(2) æŒ‰å¤§å°ååºæ˜¾ç¤ºæ–‡ä»¶è¯¦ç»†ä¿¡æ¯\n\n```shell\nls -lrS\n```\n\n(3)åˆ—å‡ºå½“å‰ç›®å½•ä¸­æ‰€æœ‰ä»¥\"t\"å¼€å¤´çš„ç›®å½•çš„è¯¦ç»†å†…å®¹\n\n```shell\nls -l t*\n```\n\n(4) åˆ—å‡ºæ–‡ä»¶ç»å¯¹è·¯å¾„ï¼ˆä¸åŒ…å«éšè—æ–‡ä»¶ï¼‰\n\n```shell\nls | sed \"s:^:`pwd`/:\"\n```\n\n(5) åˆ—å‡ºæ–‡ä»¶ç»å¯¹è·¯å¾„ï¼ˆåŒ…å«éšè—æ–‡ä»¶ï¼‰\n\n```shell\nfind $pwd -maxdepth 1 | xargs ls -ld\n```\n\n### mkdir å‘½ä»¤\n\nmkdir å‘½ä»¤ç”¨äºåˆ›å»ºæ–‡ä»¶å¤¹ã€‚\n\nå¯ç”¨é€‰é¡¹ï¼š\n\n- **-m**: å¯¹æ–°å»ºç›®å½•è®¾ç½®å­˜å–æƒé™ï¼Œä¹Ÿå¯ä»¥ç”¨ chmod å‘½ä»¤è®¾ç½®;\n- **-p**: å¯ä»¥æ˜¯ä¸€ä¸ªè·¯å¾„åç§°ã€‚æ­¤æ—¶è‹¥è·¯å¾„ä¸­çš„æŸäº›ç›®å½•å°šä¸å­˜åœ¨,åŠ ä¸Šæ­¤é€‰é¡¹åï¼Œç³»ç»Ÿå°†è‡ªåŠ¨å»ºç«‹å¥½é‚£äº›å°šä¸åœ¨çš„ç›®å½•ï¼Œå³ä¸€æ¬¡å¯ä»¥å»ºç«‹å¤šä¸ªç›®å½•ã€‚\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰å½“å‰å·¥ä½œç›®å½•ä¸‹åˆ›å»ºåä¸º t çš„æ–‡ä»¶å¤¹\n\n```shell\nmkdir t\n```\n\nï¼ˆ2ï¼‰åœ¨ tmp ç›®å½•ä¸‹åˆ›å»ºè·¯å¾„ä¸º test/t1/t çš„ç›®å½•ï¼Œè‹¥ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºï¼š\n\n```shell\nmkdir -p /tmp/test/t1/t\n```\n\n### pwd å‘½ä»¤\n\npwd å‘½ä»¤ç”¨äºæŸ¥çœ‹å½“å‰å·¥ä½œç›®å½•è·¯å¾„ã€‚\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰æŸ¥çœ‹å½“å‰è·¯å¾„\n\n```shell\npwd\n```\n\nï¼ˆ2ï¼‰æŸ¥çœ‹è½¯é“¾æ¥çš„å®é™…è·¯å¾„\n\n```shell\npwd -P\n```\n\n### rmdir å‘½ä»¤\n\nä»ä¸€ä¸ªç›®å½•ä¸­åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªå­ç›®å½•é¡¹ï¼Œåˆ é™¤æŸç›®å½•æ—¶ä¹Ÿå¿…é¡»å…·æœ‰å¯¹å…¶çˆ¶ç›®å½•çš„å†™æƒé™ã€‚\n\n**æ³¨æ„**ï¼šä¸èƒ½åˆ é™¤éç©ºç›®å½•\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰å½“ parent å­ç›®å½•è¢«åˆ é™¤åä½¿å®ƒä¹Ÿæˆä¸ºç©ºç›®å½•çš„è¯ï¼Œåˆ™é¡ºä¾¿ä¸€å¹¶åˆ é™¤ï¼š\n\n```shell\nrmdir -p parent/child/child11\n```\n\n## ç½‘ç»œé€šè®¯å‘½ä»¤\n\n### ifconfig å‘½ä»¤\n\n- ifconfig ç”¨äºæŸ¥çœ‹å’Œé…ç½® Linux ç³»ç»Ÿçš„ç½‘ç»œæ¥å£ã€‚\n- æŸ¥çœ‹æ‰€æœ‰ç½‘ç»œæ¥å£åŠå…¶çŠ¶æ€ï¼š`ifconfig -a` ã€‚\n- ä½¿ç”¨ up å’Œ down å‘½ä»¤å¯åŠ¨æˆ–åœæ­¢æŸä¸ªæ¥å£ï¼š`ifconfig eth0 up` å’Œ `ifconfig eth0 down` ã€‚\n\n### iptables å‘½ä»¤\n\niptables ï¼Œæ˜¯ä¸€ä¸ªé…ç½® Linux å†…æ ¸é˜²ç«å¢™çš„å‘½ä»¤è¡Œå·¥å…·ã€‚åŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œå¯¹äºæˆ‘ä»¬å¼€å‘æ¥è¯´ï¼Œä¸»è¦æŒæ¡å¦‚ä½•å¼€æ”¾ç«¯å£å³å¯ã€‚ä¾‹å¦‚ï¼š\n\n- æŠŠæ¥æº IP ä¸º 192.168.1.101 è®¿é—®æœ¬æœº 80 ç«¯å£çš„åŒ…ç›´æ¥æ‹’ç»ï¼š`iptables -I INPUT -s 192.168.1.101 -p tcp --dport 80 -j REJECT` ã€‚\n\n- å¼€å¯ 80 ç«¯å£ï¼Œå› ä¸º web å¯¹å¤–éƒ½æ˜¯è¿™ä¸ªç«¯å£\n\n\t```shell\n\tiptables -A INPUT -p tcp --dport 80 -j ACCEP\n\t```\n\n- å¦å¤–ï¼Œè¦æ³¨æ„ä½¿ç”¨ `iptables save` å‘½ä»¤ï¼Œè¿›è¡Œä¿å­˜ã€‚å¦åˆ™ï¼ŒæœåŠ¡å™¨é‡å¯åï¼Œé…ç½®çš„è§„åˆ™å°†ä¸¢å¤±ã€‚\n\n### netstat å‘½ä»¤\n\nLinux netstat å‘½ä»¤ç”¨äºæ˜¾ç¤ºç½‘ç»œçŠ¶æ€ã€‚\n\nåˆ©ç”¨ netstat æŒ‡ä»¤å¯è®©ä½ å¾—çŸ¥æ•´ä¸ª Linux ç³»ç»Ÿçš„ç½‘ç»œæƒ…å†µã€‚\n\nè¯­æ³•\n\n```\nnetstat [-acCeFghilMnNoprstuvVwx][-A<ç½‘ç»œç±»å‹>][--ip]\n```\n\n**å‚æ•°è¯´æ˜**ï¼š\n\n- -a æˆ–â€“all æ˜¾ç¤ºæ‰€æœ‰è¿çº¿ä¸­çš„ Socketã€‚\n- -A<ç½‘ç»œç±»å‹>æˆ–â€“<ç½‘ç»œç±»å‹> åˆ—å‡ºè¯¥ç½‘ç»œç±»å‹è¿çº¿ä¸­çš„ç›¸å…³åœ°å€ã€‚\n- -c æˆ–â€“continuous æŒç»­åˆ—å‡ºç½‘ç»œçŠ¶æ€ã€‚\n- -C æˆ–â€“cache æ˜¾ç¤ºè·¯ç”±å™¨é…ç½®çš„å¿«å–ä¿¡æ¯ã€‚\n- -e æˆ–â€“extend æ˜¾ç¤ºç½‘ç»œå…¶ä»–ç›¸å…³ä¿¡æ¯ã€‚\n- -F æˆ–â€“fib æ˜¾ç¤º FIBã€‚\n- -g æˆ–â€“groups æ˜¾ç¤ºå¤šé‡å¹¿æ’­åŠŸèƒ½ç¾¤ç»„ç»„å‘˜åå•ã€‚\n- -h æˆ–â€“help åœ¨çº¿å¸®åŠ©ã€‚\n- -i æˆ–â€“interfaces æ˜¾ç¤ºç½‘ç»œç•Œé¢ä¿¡æ¯è¡¨å•ã€‚\n- -l æˆ–â€“listening æ˜¾ç¤ºç›‘æ§ä¸­çš„æœåŠ¡å™¨çš„ Socketã€‚\n- -M æˆ–â€“masquerade æ˜¾ç¤ºä¼ªè£…çš„ç½‘ç»œè¿çº¿ã€‚\n- -n æˆ–â€“numeric ç›´æ¥ä½¿ç”¨ IP åœ°å€ï¼Œè€Œä¸é€šè¿‡åŸŸåæœåŠ¡å™¨ã€‚\n- -N æˆ–â€“netlink æˆ–â€“symbolic æ˜¾ç¤ºç½‘ç»œç¡¬ä»¶å¤–å›´è®¾å¤‡çš„ç¬¦å·è¿æ¥åç§°ã€‚\n- -o æˆ–â€“timers æ˜¾ç¤ºè®¡æ—¶å™¨ã€‚\n- -p æˆ–â€“programs æ˜¾ç¤ºæ­£åœ¨ä½¿ç”¨ Socket çš„ç¨‹åºè¯†åˆ«ç å’Œç¨‹åºåç§°ã€‚\n- -r æˆ–â€“route æ˜¾ç¤º Routing Tableã€‚\n- -s æˆ–â€“statistice æ˜¾ç¤ºç½‘ç»œå·¥ä½œä¿¡æ¯ç»Ÿè®¡è¡¨ã€‚\n- -t æˆ–â€“tcp æ˜¾ç¤º TCP ä¼ è¾“åè®®çš„è¿çº¿çŠ¶å†µã€‚\n- -u æˆ–â€“udp æ˜¾ç¤º UDP ä¼ è¾“åè®®çš„è¿çº¿çŠ¶å†µã€‚\n- -v æˆ–â€“verbose æ˜¾ç¤ºæŒ‡ä»¤æ‰§è¡Œè¿‡ç¨‹ã€‚\n- -V æˆ–â€“version æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ã€‚\n- -w æˆ–â€“raw æ˜¾ç¤º RAW ä¼ è¾“åè®®çš„è¿çº¿çŠ¶å†µã€‚\n- -x æˆ–â€“unix æ­¤å‚æ•°çš„æ•ˆæœå’ŒæŒ‡å®š\"-A unix\"å‚æ•°ç›¸åŒã€‚\n- â€“ip æˆ–â€“inet æ­¤å‚æ•°çš„æ•ˆæœå’ŒæŒ‡å®š\"-A inet\"å‚æ•°ç›¸åŒã€‚\n\n**å®ä¾‹**\n\n**å¦‚ä½•æŸ¥çœ‹ç³»ç»Ÿéƒ½å¼€å¯äº†å“ªäº›ç«¯å£ï¼Ÿ**\n\n```shell\n[root@centos6 ~ 13:20 #55]# netstat -lnp\nActive Internet connections (only servers)\nProto Recv-Q Send-Q Local Address               Foreign Address             State       PID/Program name\ntcp        0      0 0.0.0.0:22                  0.0.0.0:*                   LISTEN      1035/sshd\ntcp        0      0 :::22                       :::*                        LISTEN      1035/sshd\nudp        0      0 0.0.0.0:68                  0.0.0.0:*                               931/dhclient\nActive UNIX domain sockets (only servers)\nProto RefCnt Flags       Type       State         I-Node PID/Program name    Path\nunix  2      [ ACC ]     STREAM     LISTENING     6825   1/init              @/com/ubuntu/upstart\nunix  2      [ ACC ]     STREAM     LISTENING     8429   1003/dbus-daemon    /var/run/dbus/system_bus_socket\n```\n\n**å¦‚ä½•æŸ¥çœ‹ç½‘ç»œè¿æ¥çŠ¶å†µï¼Ÿ**\n\n```shell\n[root@centos6 ~ 13:22 #58]# netstat -an\nActive Internet connections (servers and established)\nProto Recv-Q Send-Q Local Address               Foreign Address             State\ntcp        0      0 0.0.0.0:22                  0.0.0.0:*                   LISTEN\ntcp        0      0 192.168.147.130:22          192.168.147.1:23893         ESTABLISHED\ntcp        0      0 :::22                       :::*                        LISTEN\nudp        0      0 0.0.0.0:68                  0.0.0.0:*\n```\n\n**å¦‚ä½•ç»Ÿè®¡ç³»ç»Ÿå½“å‰è¿›ç¨‹è¿æ¥æ•°ï¼Ÿ**\n\n- è¾“å…¥å‘½ä»¤ `netstat -an | grep ESTABLISHED | wc -l` ã€‚\n- è¾“å‡ºç»“æœ `177` ã€‚ä¸€å…±æœ‰ 177 è¿æ¥æ•°ã€‚\n\n**ç”¨ netstat å‘½ä»¤é…åˆå…¶ä»–å‘½ä»¤ï¼ŒæŒ‰ç…§æº IP ç»Ÿè®¡æ‰€æœ‰åˆ° 80 ç«¯å£çš„ ESTABLISHED çŠ¶æ€é“¾æ¥çš„ä¸ªæ•°ï¼Ÿ**\n\n> ä¸¥æ ¼æ¥è¯´ï¼Œè¿™ä¸ªé¢˜ç›®è€ƒéªŒçš„æ˜¯å¯¹ awk çš„ä½¿ç”¨ã€‚\n\né¦–å…ˆï¼Œä½¿ç”¨ `netstat -an|grep ESTABLISHED` å‘½ä»¤ã€‚ç»“æœå¦‚ä¸‹ï¼š\n\n```shell\ntcp        0      0 120.27.146.122:80       113.65.18.33:62721      ESTABLISHED\ntcp        0      0 120.27.146.122:80       27.43.83.115:47148      ESTABLISHED\ntcp        0      0 120.27.146.122:58838    106.39.162.96:443       ESTABLISHED\ntcp        0      0 120.27.146.122:52304    203.208.40.121:443      ESTABLISHED\ntcp        0      0 120.27.146.122:33194    203.208.40.122:443      ESTABLISHED\ntcp        0      0 120.27.146.122:53758    101.37.183.144:443      ESTABLISHED\ntcp        0      0 120.27.146.122:27017    23.105.193.30:50556     ESTABLISHED\n```\n\n### ping å‘½ä»¤\n\nLinux ping å‘½ä»¤ç”¨äºæ£€æµ‹ä¸»æœºã€‚\n\næ‰§è¡Œ ping æŒ‡ä»¤ä¼šä½¿ç”¨ ICMP ä¼ è¾“åè®®ï¼Œå‘å‡ºè¦æ±‚å›åº”çš„ä¿¡æ¯ï¼Œè‹¥è¿œç«¯ä¸»æœºçš„ç½‘ç»œåŠŸèƒ½æ²¡æœ‰é—®é¢˜ï¼Œå°±ä¼šå›åº”è¯¥ä¿¡æ¯ï¼Œå› è€Œå¾—çŸ¥è¯¥ä¸»æœºè¿ä½œæ­£å¸¸ã€‚\n\næŒ‡å®šæ¥æ”¶åŒ…çš„æ¬¡æ•°\n\n```shell\nping -c 2 www.baidu.com\n```\n\n### telnet å‘½ä»¤\n\nLinux telnet å‘½ä»¤ç”¨äºè¿œç«¯ç™»å…¥ã€‚\n\næ‰§è¡Œ telnet æŒ‡ä»¤å¼€å¯ç»ˆç«¯æœºé˜¶æ®µä½œä¸šï¼Œå¹¶ç™»å…¥è¿œç«¯ä¸»æœºã€‚\n\nè¯­æ³•\n\n```\ntelnet [-8acdEfFKLrx][-b<ä¸»æœºåˆ«å>][-e<è„±ç¦»å­—ç¬¦>][-k<åŸŸå>][-l<ç”¨æˆ·åç§°>][-n<è®°å½•æ–‡ä»¶>][-S<æœåŠ¡ç±»å‹>][-X<è®¤è¯å½¢æ€>][ä¸»æœºåç§°æˆ–IPåœ°å€<é€šä¿¡ç«¯å£>]\n```\n\n**å‚æ•°è¯´æ˜**ï¼š\n\n- -8 å…è®¸ä½¿ç”¨ 8 ä½å­—ç¬¦èµ„æ–™ï¼ŒåŒ…æ‹¬è¾“å…¥ä¸è¾“å‡ºã€‚\n- -a å°è¯•è‡ªåŠ¨ç™»å…¥è¿œç«¯ç³»ç»Ÿã€‚\n- -b<ä¸»æœºåˆ«å> ä½¿ç”¨åˆ«åæŒ‡å®šè¿œç«¯ä¸»æœºåç§°ã€‚\n- -c ä¸è¯»å–ç”¨æˆ·ä¸“å±ç›®å½•é‡Œçš„.telnetrc æ–‡ä»¶ã€‚\n- -d å¯åŠ¨æ’é”™æ¨¡å¼ã€‚\n- -e<è„±ç¦»å­—ç¬¦> è®¾ç½®è„±ç¦»å­—ç¬¦ã€‚\n- -E æ»¤é™¤è„±ç¦»å­—ç¬¦ã€‚\n- -f æ­¤å‚æ•°çš„æ•ˆæœå’ŒæŒ‡å®š\"-F\"å‚æ•°ç›¸åŒã€‚\n- -F ä½¿ç”¨ Kerberos V5 è®¤è¯æ—¶ï¼ŒåŠ ä¸Šæ­¤å‚æ•°å¯æŠŠæœ¬åœ°ä¸»æœºçš„è®¤è¯æ•°æ®ä¸Šä¼ åˆ°è¿œç«¯ä¸»æœºã€‚\n- -k<åŸŸå> ä½¿ç”¨ Kerberos è®¤è¯æ—¶ï¼ŒåŠ ä¸Šæ­¤å‚æ•°è®©è¿œç«¯ä¸»æœºé‡‡ç”¨æŒ‡å®šçš„é¢†åŸŸåï¼Œè€Œéè¯¥ä¸»æœºçš„åŸŸåã€‚\n- -K ä¸è‡ªåŠ¨ç™»å…¥è¿œç«¯ä¸»æœºã€‚\n- -l<ç”¨æˆ·åç§°> æŒ‡å®šè¦ç™»å…¥è¿œç«¯ä¸»æœºçš„ç”¨æˆ·åç§°ã€‚\n- -L å…è®¸è¾“å‡º 8 ä½å­—ç¬¦èµ„æ–™ã€‚\n- -n<è®°å½•æ–‡ä»¶> æŒ‡å®šæ–‡ä»¶è®°å½•ç›¸å…³ä¿¡æ¯ã€‚\n- -r ä½¿ç”¨ç±»ä¼¼ rlogin æŒ‡ä»¤çš„ç”¨æˆ·ç•Œé¢ã€‚\n- -S<æœåŠ¡ç±»å‹> è®¾ç½® telnet è¿çº¿æ‰€éœ€çš„ IP TOS ä¿¡æ¯ã€‚\n- -x å‡è®¾ä¸»æœºæœ‰æ”¯æŒæ•°æ®åŠ å¯†çš„åŠŸèƒ½ï¼Œå°±ä½¿ç”¨å®ƒã€‚\n- -X<è®¤è¯å½¢æ€> å…³é—­æŒ‡å®šçš„è®¤è¯å½¢æ€ã€‚\n\n**å®ä¾‹**\n\nç™»å½•è¿œç¨‹ä¸»æœº\n\n```shell\n# ç™»å½•IPä¸º 192.168.0.5 çš„è¿œç¨‹ä¸»æœº\ntelnet 192.168.0.5 \n```\n\n## ç³»ç»Ÿç®¡ç†å‘½ä»¤\n\n### date å‘½ä»¤\n\næ˜¾ç¤ºæˆ–è®¾å®šç³»ç»Ÿçš„æ—¥æœŸä¸æ—¶é—´ã€‚\n\nå‘½ä»¤å‚æ•°ï¼š\n\n```\n-d<å­—ç¬¦ä¸²> ã€€æ˜¾ç¤ºå­—ç¬¦ä¸²æ‰€æŒ‡çš„æ—¥æœŸä¸æ—¶é—´ã€‚å­—ç¬¦ä¸²å‰åå¿…é¡»åŠ ä¸ŠåŒå¼•å·ã€‚\n-s<å­—ç¬¦ä¸²> ã€€æ ¹æ®å­—ç¬¦ä¸²æ¥è®¾ç½®æ—¥æœŸä¸æ—¶é—´ã€‚å­—ç¬¦ä¸²å‰åå¿…é¡»åŠ ä¸ŠåŒå¼•å·ã€‚\n-u ã€€æ˜¾ç¤ºGMTã€‚\n%H å°æ—¶(00-23)\n%I å°æ—¶(00-12)\n%M åˆ†é’Ÿ(ä»¥00-59æ¥è¡¨ç¤º)\n%s æ€»ç§’æ•°ã€‚èµ·ç®—æ—¶é—´ä¸º1970-01-01 00:00:00 UTCã€‚\n%S ç§’(ä»¥æœ¬åœ°çš„æƒ¯ç”¨æ³•æ¥è¡¨ç¤º)\n%a æ˜ŸæœŸçš„ç¼©å†™ã€‚\n%A æ˜ŸæœŸçš„å®Œæ•´åç§°ã€‚\n%d æ—¥æœŸ(ä»¥01-31æ¥è¡¨ç¤º)ã€‚\n%D æ—¥æœŸ(å«å¹´æœˆæ—¥)ã€‚\n%m æœˆä»½(ä»¥01-12æ¥è¡¨ç¤º)ã€‚\n%y å¹´ä»½(ä»¥00-99æ¥è¡¨ç¤º)ã€‚\n%Y å¹´ä»½(ä»¥å››ä½æ•°æ¥è¡¨ç¤º)ã€‚\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰æ˜¾ç¤ºä¸‹ä¸€å¤©\n\n```shell\ndate +%Y%m%d --date=\"+1 day\"  //æ˜¾ç¤ºä¸‹ä¸€å¤©çš„æ—¥æœŸ\n```\n\nï¼ˆ2ï¼‰-d å‚æ•°ä½¿ç”¨\n\n```shell\ndate -d \"nov 22\"  ä»Šå¹´çš„ 11 æœˆ 22 æ—¥æ˜¯æ˜ŸæœŸä¸‰\ndate -d '2 weeks' 2å‘¨åçš„æ—¥æœŸ\ndate -d 'next monday' (ä¸‹å‘¨ä¸€çš„æ—¥æœŸ)\ndate -d next-day +%Y%m%dï¼ˆæ˜å¤©çš„æ—¥æœŸï¼‰æˆ–è€…ï¼šdate -d tomorrow +%Y%m%d\ndate -d last-day +%Y%m%d(æ˜¨å¤©çš„æ—¥æœŸ) æˆ–è€…ï¼šdate -d yesterday +%Y%m%d\ndate -d last-month +%Y%m(ä¸Šä¸ªæœˆæ˜¯å‡ æœˆ)\ndate -d next-month +%Y%m(ä¸‹ä¸ªæœˆæ˜¯å‡ æœˆ)\n```\n\n### free å‘½ä»¤\n\næ˜¾ç¤ºç³»ç»Ÿå†…å­˜ä½¿ç”¨æƒ…å†µï¼ŒåŒ…æ‹¬ç‰©ç†å†…å­˜ã€äº¤äº’åŒºå†…å­˜(swap)å’Œå†…æ ¸ç¼“å†²åŒºå†…å­˜ã€‚\n\n**å‘½ä»¤å‚æ•°**ï¼š\n\n```\n-b ä»¥Byteæ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ\n-k ä»¥kbä¸ºå•ä½æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ\n-m ä»¥mbä¸ºå•ä½æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ\n-g ä»¥gbä¸ºå•ä½æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ\n-s<é—´éš”ç§’æ•°> æŒç»­æ˜¾ç¤ºå†…å­˜\n-t æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æ€»åˆ\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ\n\n```shell\nfree\nfree -k\nfree -m\n```\n\nï¼ˆ2ï¼‰ä»¥æ€»å’Œçš„å½¢å¼æ˜¾ç¤ºå†…å­˜çš„ä½¿ç”¨ä¿¡æ¯\n\n```shell\nfree -t\n```\n\nï¼ˆ3ï¼‰å‘¨æœŸæ€§æŸ¥è¯¢å†…å­˜ä½¿ç”¨æƒ…å†µ\n\n```shell\nfree -s 10\n```\n\n### kill å‘½ä»¤\n\nå‘é€æŒ‡å®šçš„ä¿¡å·åˆ°ç›¸åº”è¿›ç¨‹ã€‚ä¸æŒ‡å®šå‹å·å°†å‘é€ SIGTERMï¼ˆ15ï¼‰ç»ˆæ­¢æŒ‡å®šè¿›ç¨‹ã€‚å¦‚æœä»»æ— æ³•ç»ˆæ­¢è¯¥ç¨‹åºå¯ç”¨\"-KILL\" å‚æ•°ï¼Œå…¶å‘é€çš„ä¿¡å·ä¸º SIGKILL(9) ï¼Œå°†å¼ºåˆ¶ç»“æŸè¿›ç¨‹ï¼Œä½¿ç”¨ ps å‘½ä»¤æˆ–è€… jobs å‘½ä»¤å¯ä»¥æŸ¥çœ‹è¿›ç¨‹å·ã€‚root ç”¨æˆ·å°†å½±å“ç”¨æˆ·çš„è¿›ç¨‹ï¼Œé root ç”¨æˆ·åªèƒ½å½±å“è‡ªå·±çš„è¿›ç¨‹ã€‚\n\n**å¸¸ç”¨å‚æ•°**ï¼š\n\n```\n-l  ä¿¡å·ï¼Œè‹¥æœä¸åŠ ä¿¡å·çš„ç¼–å·å‚æ•°ï¼Œåˆ™ä½¿ç”¨â€œ-lâ€å‚æ•°ä¼šåˆ—å‡ºå…¨éƒ¨çš„ä¿¡å·åç§°\n-a  å½“å¤„ç†å½“å‰è¿›ç¨‹æ—¶ï¼Œä¸é™åˆ¶å‘½ä»¤åå’Œè¿›ç¨‹å·çš„å¯¹åº”å…³ç³»\n-p  æŒ‡å®škill å‘½ä»¤åªæ‰“å°ç›¸å…³è¿›ç¨‹çš„è¿›ç¨‹å·ï¼Œè€Œä¸å‘é€ä»»ä½•ä¿¡å·\n-s  æŒ‡å®šå‘é€ä¿¡å·\n-u  æŒ‡å®šç”¨æˆ·\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰å…ˆä½¿ç”¨ ps æŸ¥æ‰¾è¿›ç¨‹ pro1ï¼Œç„¶åç”¨ kill æ€æ‰\n\n```shell\nkill -9 $(ps -ef | grep pro1)\n```\n\n### ps å‘½ä»¤\n\nps(process status)ï¼Œç”¨æ¥æŸ¥çœ‹å½“å‰è¿è¡Œçš„è¿›ç¨‹çŠ¶æ€ï¼Œä¸€æ¬¡æ€§æŸ¥çœ‹ï¼Œå¦‚æœéœ€è¦åŠ¨æ€è¿ç»­ç»“æœä½¿ç”¨ top\n\nlinux ä¸Šè¿›ç¨‹æœ‰ 5 ç§çŠ¶æ€:\n\n1. è¿è¡Œ(æ­£åœ¨è¿è¡Œæˆ–åœ¨è¿è¡Œé˜Ÿåˆ—ä¸­ç­‰å¾…)\n2. ä¸­æ–­(ä¼‘çœ ä¸­, å—é˜», åœ¨ç­‰å¾…æŸä¸ªæ¡ä»¶çš„å½¢æˆæˆ–æ¥å—åˆ°ä¿¡å·)\n3. ä¸å¯ä¸­æ–­(æ”¶åˆ°ä¿¡å·ä¸å”¤é†’å’Œä¸å¯è¿è¡Œ, è¿›ç¨‹å¿…é¡»ç­‰å¾…ç›´åˆ°æœ‰ä¸­æ–­å‘ç”Ÿ)\n4. åƒµæ­»(è¿›ç¨‹å·²ç»ˆæ­¢, ä½†è¿›ç¨‹æè¿°ç¬¦å­˜åœ¨, ç›´åˆ°çˆ¶è¿›ç¨‹è°ƒç”¨ wait4()ç³»ç»Ÿè°ƒç”¨åé‡Šæ”¾)\n5. åœæ­¢(è¿›ç¨‹æ”¶åˆ° SIGSTOP, SIGSTP, SIGTIN, SIGTOU ä¿¡å·ååœæ­¢è¿è¡Œè¿è¡Œ)\n\nps å·¥å…·æ ‡è¯†è¿›ç¨‹çš„ 5 ç§çŠ¶æ€ç :\n\n```\nD ä¸å¯ä¸­æ–­ uninterruptible sleep (usually IO)\nR è¿è¡Œ runnable (on run queue)\nS ä¸­æ–­ sleeping\nT åœæ­¢ traced or stopped\nZ åƒµæ­» a defunct (â€zombieâ€) process\n```\n\n**å‘½ä»¤å‚æ•°**ï¼š\n\n```\n-A æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹\na æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹\n-a æ˜¾ç¤ºåŒä¸€ç»ˆç«¯ä¸‹æ‰€æœ‰è¿›ç¨‹\nc æ˜¾ç¤ºè¿›ç¨‹çœŸå®åç§°\ne æ˜¾ç¤ºç¯å¢ƒå˜é‡\nf æ˜¾ç¤ºè¿›ç¨‹é—´çš„å…³ç³»\nr æ˜¾ç¤ºå½“å‰ç»ˆç«¯è¿è¡Œçš„è¿›ç¨‹\n-aux æ˜¾ç¤ºæ‰€æœ‰åŒ…å«å…¶å®ƒä½¿ç”¨çš„è¿›ç¨‹\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰æ˜¾ç¤ºå½“å‰æ‰€æœ‰è¿›ç¨‹ç¯å¢ƒå˜é‡åŠè¿›ç¨‹é—´å…³ç³»\n\n```shell\nps -ef\n```\n\nï¼ˆ2ï¼‰æ˜¾ç¤ºå½“å‰æ‰€æœ‰è¿›ç¨‹\n\n```shell\nps -A\n```\n\nï¼ˆ3ï¼‰ä¸ grep è”ç”¨æŸ¥æ‰¾æŸè¿›ç¨‹\n\n```shell\nps -aux | grep apache\n```\n\nï¼ˆ4ï¼‰æ‰¾å‡ºä¸ cron ä¸ syslog è¿™ä¸¤ä¸ªæœåŠ¡æœ‰å…³çš„ PID å·ç \n\n```shell\nps aux | grep '(cron|syslog)'\n```\n\n### rpm å‘½ä»¤\n\nLinux rpm å‘½ä»¤ç”¨äºç®¡ç†å¥—ä»¶ã€‚\n\nrpm(redhat package manager) åŸæœ¬æ˜¯ Red Hat Linux å‘è¡Œç‰ˆä¸“é—¨ç”¨æ¥ç®¡ç† Linux å„é¡¹å¥—ä»¶çš„ç¨‹åºï¼Œç”±äºå®ƒéµå¾ª GPL è§„åˆ™ä¸”åŠŸèƒ½å¼ºå¤§æ–¹ä¾¿ï¼Œå› è€Œå¹¿å—æ¬¢è¿ã€‚é€æ¸å—åˆ°å…¶ä»–å‘è¡Œç‰ˆçš„é‡‡ç”¨ã€‚RPM å¥—ä»¶ç®¡ç†æ–¹å¼çš„å‡ºç°ï¼Œè®© Linux æ˜“äºå®‰è£…ï¼Œå‡çº§ï¼Œé—´æ¥æå‡äº† Linux çš„é€‚ç”¨åº¦ã€‚\n\n```shell\n# æŸ¥çœ‹ç³»ç»Ÿè‡ªå¸¦jdk\nrpm -qa | grep jdk\n# åˆ é™¤ç³»ç»Ÿè‡ªå¸¦jdk\nrpm -e --nodeps æŸ¥çœ‹jdkæ˜¾ç¤ºçš„æ•°æ®\n# å®‰è£…jdk\nrpm -ivh jdk-7u80-linux-x64.rpm\n```\n\n### top å‘½ä»¤\n\næ˜¾ç¤ºå½“å‰ç³»ç»Ÿæ­£åœ¨æ‰§è¡Œçš„è¿›ç¨‹çš„ç›¸å…³ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¿›ç¨‹ IDã€å†…å­˜å ç”¨ç‡ã€CPU å ç”¨ç‡ç­‰\n\n**å¸¸ç”¨å‚æ•°**ï¼š\n\n```\n-c æ˜¾ç¤ºå®Œæ•´çš„è¿›ç¨‹å‘½ä»¤\n-s ä¿å¯†æ¨¡å¼\n-p <è¿›ç¨‹å·> æŒ‡å®šè¿›ç¨‹æ˜¾ç¤º\n-n <æ¬¡æ•°>å¾ªç¯æ˜¾ç¤ºæ¬¡æ•°\n```\n\n**å®ä¾‹**ï¼š\n\n```shell\ntop - 14:06:23 up 70 days, 16:44,  2 users,  load average: 1.25, 1.32, 1.35\nTasks: 206 total,   1 running, 205 sleeping,   0 stopped,   0 zombie\nCpu(s):  5.9%us,  3.4%sy,  0.0%ni, 90.4%id,  0.0%wa,  0.0%hi,  0.2%si,  0.0%st\nMem:  32949016k total, 14411180k used, 18537836k free,   169884k buffers\nSwap: 32764556k total,        0k used, 32764556k free,  3612636k cached\nPID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND  \n28894 root      22   0 1501m 405m  10m S 52.2  1.3   2534:16 java  \n```\n\nå‰äº”è¡Œæ˜¯å½“å‰ç³»ç»Ÿæƒ…å†µæ•´ä½“çš„ç»Ÿè®¡ä¿¡æ¯åŒºã€‚\n\n**ç¬¬ä¸€è¡Œï¼Œä»»åŠ¡é˜Ÿåˆ—ä¿¡æ¯ï¼ŒåŒ uptime å‘½ä»¤çš„æ‰§è¡Œç»“æœï¼Œå…·ä½“å‚æ•°è¯´æ˜æƒ…å†µå¦‚ä¸‹**ï¼š\n\n14:06:23 â€” å½“å‰ç³»ç»Ÿæ—¶é—´\n\nup 70 days, 16:44 â€” ç³»ç»Ÿå·²ç»è¿è¡Œäº† 70 å¤© 16 å°æ—¶ 44 åˆ†é’Ÿï¼ˆåœ¨è¿™æœŸé—´ç³»ç»Ÿæ²¡æœ‰é‡å¯è¿‡çš„å†ï¼ï¼‰\n\n2 users â€” å½“å‰æœ‰ 2 ä¸ªç”¨æˆ·ç™»å½•ç³»ç»Ÿ\n\nload average: 1.15, 1.42, 1.44 â€” load average åé¢çš„ä¸‰ä¸ªæ•°åˆ†åˆ«æ˜¯ 1 åˆ†é’Ÿã€5 åˆ†é’Ÿã€15 åˆ†é’Ÿçš„è´Ÿè½½æƒ…å†µã€‚\n\nload average æ•°æ®æ˜¯æ¯éš” 5 ç§’é’Ÿæ£€æŸ¥ä¸€æ¬¡æ´»è·ƒçš„è¿›ç¨‹æ•°ï¼Œç„¶åæŒ‰ç‰¹å®šç®—æ³•è®¡ç®—å‡ºçš„æ•°å€¼ã€‚å¦‚æœè¿™ä¸ªæ•°é™¤ä»¥é€»è¾‘ CPU çš„æ•°é‡ï¼Œç»“æœé«˜äº 5 çš„æ—¶å€™å°±è¡¨æ˜ç³»ç»Ÿåœ¨è¶…è´Ÿè·è¿è½¬äº†ã€‚\n\n**ç¬¬äºŒè¡Œï¼ŒTasks â€” ä»»åŠ¡ï¼ˆè¿›ç¨‹ï¼‰ï¼Œå…·ä½“ä¿¡æ¯è¯´æ˜å¦‚ä¸‹**ï¼š\n\nç³»ç»Ÿç°åœ¨å…±æœ‰ 206 ä¸ªè¿›ç¨‹ï¼Œå…¶ä¸­å¤„äºè¿è¡Œä¸­çš„æœ‰ 1 ä¸ªï¼Œ205 ä¸ªåœ¨ä¼‘çœ ï¼ˆsleepï¼‰ï¼Œstoped çŠ¶æ€çš„æœ‰ 0 ä¸ªï¼Œzombie çŠ¶æ€ï¼ˆåƒµå°¸ï¼‰çš„æœ‰ 0 ä¸ªã€‚\n\n**ç¬¬ä¸‰è¡Œï¼ŒcpuçŠ¶æ€ä¿¡æ¯ï¼Œå…·ä½“å±æ€§è¯´æ˜å¦‚ä¸‹**ï¼š\n\n```\n5.9%us â€” ç”¨æˆ·ç©ºé—´å ç”¨CPUçš„ç™¾åˆ†æ¯”ã€‚\n3.4% sy â€” å†…æ ¸ç©ºé—´å ç”¨CPUçš„ç™¾åˆ†æ¯”ã€‚\n0.0% ni â€” æ”¹å˜è¿‡ä¼˜å…ˆçº§çš„è¿›ç¨‹å ç”¨CPUçš„ç™¾åˆ†æ¯”\n90.4% id â€” ç©ºé—²CPUç™¾åˆ†æ¯”\n0.0% wa â€” IOç­‰å¾…å ç”¨CPUçš„ç™¾åˆ†æ¯”\n0.0% hi â€” ç¡¬ä¸­æ–­ï¼ˆHardware IRQï¼‰å ç”¨CPUçš„ç™¾åˆ†æ¯”\n0.2% si â€” è½¯ä¸­æ–­ï¼ˆSoftware Interruptsï¼‰å ç”¨CPUçš„ç™¾åˆ†æ¯”\n```\n\n**å¤‡æ³¨**ï¼šåœ¨è¿™é‡Œ CPU çš„ä½¿ç”¨æ¯”ç‡å’Œ windows æ¦‚å¿µä¸åŒï¼Œéœ€è¦ç†è§£ linux ç³»ç»Ÿç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´çš„ç›¸å…³çŸ¥è¯†ï¼\n\nç¬¬å››è¡Œï¼Œå†…å­˜çŠ¶æ€ï¼Œå…·ä½“ä¿¡æ¯å¦‚ä¸‹ï¼š\n\n```\n32949016k total â€” ç‰©ç†å†…å­˜æ€»é‡ï¼ˆ32GBï¼‰\n14411180k used â€” ä½¿ç”¨ä¸­çš„å†…å­˜æ€»é‡ï¼ˆ14GBï¼‰\n18537836k free â€” ç©ºé—²å†…å­˜æ€»é‡ï¼ˆ18GBï¼‰\n169884k buffers â€” ç¼“å­˜çš„å†…å­˜é‡ ï¼ˆ169Mï¼‰\n```\n\n**ç¬¬äº”è¡Œï¼Œswapäº¤æ¢åˆ†åŒºä¿¡æ¯ï¼Œå…·ä½“ä¿¡æ¯è¯´æ˜å¦‚ä¸‹**ï¼š\n\n```\n32764556k total â€” äº¤æ¢åŒºæ€»é‡ï¼ˆ32GBï¼‰\n0k used â€” ä½¿ç”¨çš„äº¤æ¢åŒºæ€»é‡ï¼ˆ0Kï¼‰\n32764556k free â€” ç©ºé—²äº¤æ¢åŒºæ€»é‡ï¼ˆ32GBï¼‰\n3612636k cached â€” ç¼“å†²çš„äº¤æ¢åŒºæ€»é‡ï¼ˆ3.6GBï¼‰\n```\n\n**ç¬¬å…­è¡Œï¼Œç©ºè¡Œã€‚**\n\n**ç¬¬ä¸ƒè¡Œä»¥ä¸‹ï¼šå„è¿›ç¨‹ï¼ˆä»»åŠ¡ï¼‰çš„çŠ¶æ€ç›‘æ§ï¼Œé¡¹ç›®åˆ—ä¿¡æ¯è¯´æ˜å¦‚ä¸‹**ï¼š\n\n```\nPID â€” è¿›ç¨‹id\nUSER â€” è¿›ç¨‹æ‰€æœ‰è€…\nPR â€” è¿›ç¨‹ä¼˜å…ˆçº§\nNI â€” niceå€¼ã€‚è´Ÿå€¼è¡¨ç¤ºé«˜ä¼˜å…ˆçº§ï¼Œæ­£å€¼è¡¨ç¤ºä½ä¼˜å…ˆçº§\nVIRT â€” è¿›ç¨‹ä½¿ç”¨çš„è™šæ‹Ÿå†…å­˜æ€»é‡ï¼Œå•ä½kbã€‚VIRT=SWAP+RES\nRES â€” è¿›ç¨‹ä½¿ç”¨çš„ã€æœªè¢«æ¢å‡ºçš„ç‰©ç†å†…å­˜å¤§å°ï¼Œå•ä½kbã€‚RES=CODE+DATA\nSHR â€” å…±äº«å†…å­˜å¤§å°ï¼Œå•ä½kb\nS â€” è¿›ç¨‹çŠ¶æ€ã€‚D=ä¸å¯ä¸­æ–­çš„ç¡çœ çŠ¶æ€ R=è¿è¡Œ S=ç¡çœ  T=è·Ÿè¸ª/åœæ­¢ Z=åƒµå°¸è¿›ç¨‹\n%CPU â€” ä¸Šæ¬¡æ›´æ–°åˆ°ç°åœ¨çš„CPUæ—¶é—´å ç”¨ç™¾åˆ†æ¯”\n%MEM â€” è¿›ç¨‹ä½¿ç”¨çš„ç‰©ç†å†…å­˜ç™¾åˆ†æ¯”\nTIME+ â€” è¿›ç¨‹ä½¿ç”¨çš„CPUæ—¶é—´æ€»è®¡ï¼Œå•ä½1/100ç§’\nCOMMAND â€” è¿›ç¨‹åç§°ï¼ˆå‘½ä»¤å/å‘½ä»¤è¡Œï¼‰\n```\n\n**top äº¤äº’å‘½ä»¤**\n\n```\nh æ˜¾ç¤ºtopäº¤äº’å‘½ä»¤å¸®åŠ©ä¿¡æ¯\nc åˆ‡æ¢æ˜¾ç¤ºå‘½ä»¤åç§°å’Œå®Œæ•´å‘½ä»¤è¡Œ\nm ä»¥å†…å­˜ä½¿ç”¨ç‡æ’åº\nP æ ¹æ®CPUä½¿ç”¨ç™¾åˆ†æ¯”å¤§å°è¿›è¡Œæ’åº\nT æ ¹æ®æ—¶é—´/ç´¯è®¡æ—¶é—´è¿›è¡Œæ’åº\nW å°†å½“å‰è®¾ç½®å†™å…¥~/.toprcæ–‡ä»¶ä¸­\noæˆ–è€…O æ”¹å˜æ˜¾ç¤ºé¡¹ç›®çš„é¡ºåº\n```\n\n### yum å‘½ä»¤\n\nyumï¼ˆ Yellow dog Updater, Modifiedï¼‰æ˜¯ä¸€ä¸ªåœ¨ Fedora å’Œ RedHat ä»¥åŠ SUSE ä¸­çš„ Shell å‰ç«¯è½¯ä»¶åŒ…ç®¡ç†å™¨ã€‚\n\nåŸºæ–¼ RPM åŒ…ç®¡ç†ï¼Œèƒ½å¤Ÿä»æŒ‡å®šçš„æœåŠ¡å™¨è‡ªåŠ¨ä¸‹è½½ RPM åŒ…å¹¶ä¸”å®‰è£…ï¼Œå¯ä»¥è‡ªåŠ¨å¤„ç†ä¾èµ–æ€§å…³ç³»ï¼Œå¹¶ä¸”ä¸€æ¬¡å®‰è£…æ‰€æœ‰ä¾èµ–çš„è½¯ä½“åŒ…ï¼Œæ— é¡»ç¹çåœ°ä¸€æ¬¡æ¬¡ä¸‹è½½ã€å®‰è£…ã€‚\n\nyum æä¾›äº†æŸ¥æ‰¾ã€å®‰è£…ã€åˆ é™¤æŸä¸€ä¸ªã€ä¸€ç»„ç”šè‡³å…¨éƒ¨è½¯ä»¶åŒ…çš„å‘½ä»¤ï¼Œè€Œä¸”å‘½ä»¤ç®€æ´è€Œåˆå¥½è®°ã€‚\n\n- 1.åˆ—å‡ºæ‰€æœ‰å¯æ›´æ–°çš„è½¯ä»¶æ¸…å•å‘½ä»¤ï¼šyum check-update\n- 2.æ›´æ–°æ‰€æœ‰è½¯ä»¶å‘½ä»¤ï¼šyum update\n- 3.ä»…å®‰è£…æŒ‡å®šçš„è½¯ä»¶å‘½ä»¤ï¼šyum install <package_name>\n- 4.ä»…æ›´æ–°æŒ‡å®šçš„è½¯ä»¶å‘½ä»¤ï¼šyum update <package_name>\n- 5.åˆ—å‡ºæ‰€æœ‰å¯å®‰è£çš„è½¯ä»¶æ¸…å•å‘½ä»¤ï¼šyum list\n- 6.åˆ é™¤è½¯ä»¶åŒ…å‘½ä»¤ï¼šyum remove <package_name>\n- 7.æŸ¥æ‰¾è½¯ä»¶åŒ… å‘½ä»¤ï¼šyum search\n- 8.æ¸…é™¤ç¼“å­˜å‘½ä»¤:\n\t- yum clean packages: æ¸…é™¤ç¼“å­˜ç›®å½•ä¸‹çš„è½¯ä»¶åŒ…\n\t- yum clean headers: æ¸…é™¤ç¼“å­˜ç›®å½•ä¸‹çš„ headers\n\t- yum clean oldheaders: æ¸…é™¤ç¼“å­˜ç›®å½•ä¸‹æ—§çš„ headers\n\t- yum clean, yum clean all (= yum clean packages; yum clean oldheaders) :æ¸…é™¤ç¼“å­˜ç›®å½•ä¸‹çš„è½¯ä»¶åŒ…åŠæ—§çš„ headers\n\n**å®ä¾‹**\n\nå®‰è£… pam-devel\n\n```shell\n[root@www ~]# yum install pam-devel\n```\n\n## å¤‡ä»½å‹ç¼©å‘½ä»¤\n\n### bzip2 å‘½ä»¤\n\n- åˆ›å»º `*.bz2` å‹ç¼©æ–‡ä»¶ï¼š`bzip2 test.txt` ã€‚\n- è§£å‹ `*.bz2` æ–‡ä»¶ï¼š`bzip2 -d test.txt.bz2` ã€‚\n\n### gzip å‘½ä»¤\n\n- åˆ›å»ºä¸€ä¸ª `*.gz` çš„å‹ç¼©æ–‡ä»¶ï¼š`gzip test.txt` ã€‚\n- è§£å‹ `*.gz` æ–‡ä»¶ï¼š`gzip -d test.txt.gz` ã€‚\n- æ˜¾ç¤ºå‹ç¼©çš„æ¯”ç‡ï¼š`gzip -l *.gz` ã€‚\n\n### tar å‘½ä»¤\n\nç”¨æ¥å‹ç¼©å’Œè§£å‹æ–‡ä»¶ã€‚tar æœ¬èº«ä¸å…·æœ‰å‹ç¼©åŠŸèƒ½ï¼Œåªå…·æœ‰æ‰“åŒ…åŠŸèƒ½ï¼Œæœ‰å…³å‹ç¼©åŠè§£å‹æ˜¯è°ƒç”¨å…¶å®ƒçš„åŠŸèƒ½æ¥å®Œæˆã€‚\n\nå¼„æ¸…ä¸¤ä¸ªæ¦‚å¿µï¼šæ‰“åŒ…å’Œå‹ç¼©ã€‚æ‰“åŒ…æ˜¯æŒ‡å°†ä¸€å¤§å †æ–‡ä»¶æˆ–ç›®å½•å˜æˆä¸€ä¸ªæ€»çš„æ–‡ä»¶ï¼›å‹ç¼©åˆ™æ˜¯å°†ä¸€ä¸ªå¤§çš„æ–‡ä»¶é€šè¿‡ä¸€äº›å‹ç¼©ç®—æ³•å˜æˆä¸€ä¸ªå°æ–‡ä»¶\n\n**å¸¸ç”¨å‚æ•°**ï¼š\n\n```\n-c å»ºç«‹æ–°çš„å‹ç¼©æ–‡ä»¶\n-f æŒ‡å®šå‹ç¼©æ–‡ä»¶\n-r æ·»åŠ æ–‡ä»¶åˆ°å·²ç»å‹ç¼©æ–‡ä»¶åŒ…ä¸­\n-u æ·»åŠ æ”¹äº†å’Œç°æœ‰çš„æ–‡ä»¶åˆ°å‹ç¼©åŒ…ä¸­\n-x ä»å‹ç¼©åŒ…ä¸­æŠ½å–æ–‡ä»¶\n-t æ˜¾ç¤ºå‹ç¼©æ–‡ä»¶ä¸­çš„å†…å®¹\n-z æ”¯æŒgzipå‹ç¼©\n-j æ”¯æŒbzip2å‹ç¼©\n-Z æ”¯æŒcompressè§£å‹æ–‡ä»¶\n-v æ˜¾ç¤ºæ“ä½œè¿‡ç¨‹\n```\n\næœ‰å…³ gzip åŠ bzip2 å‹ç¼©:\n\n```\ngzip å®ä¾‹ï¼šå‹ç¼© gzip fileName .tar.gz å’Œ.tgz  è§£å‹ï¼šgunzip filename.gz æˆ– gzip -d filename.gz\n          å¯¹åº”ï¼štar zcvf filename.tar.gz     tar zxvf filename.tar.gz\n\nbz2å®ä¾‹ï¼šå‹ç¼© bzip2 -z filename .tar.bz2 è§£å‹ï¼šbunzip filename.bz2æˆ–bzip -d filename.bz2\n       å¯¹åº”ï¼štar jcvf filename.tar.gz         è§£å‹ï¼štar jxvf filename.tar.bz2\n```\n\n**å®ä¾‹**ï¼š\n\nï¼ˆ1ï¼‰å°†æ–‡ä»¶å…¨éƒ¨æ‰“åŒ…æˆ tar åŒ…\n\n```shell\ntar -cvf log.tar 1.log,2.log æˆ–tar -cvf log.*\n```\n\nï¼ˆ2ï¼‰å°† /etc ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åŠç›®å½•æ‰“åŒ…åˆ°æŒ‡å®šç›®å½•ï¼Œå¹¶ä½¿ç”¨ gz å‹ç¼©\n\n```shell\ntar -zcvf /tmp/etc.tar.gz /etc\n```\n\nï¼ˆ3ï¼‰æŸ¥çœ‹åˆšæ‰“åŒ…çš„æ–‡ä»¶å†…å®¹ï¼ˆä¸€å®šåŠ  zï¼Œå› ä¸ºæ˜¯ä½¿ç”¨ gzip å‹ç¼©çš„ï¼‰\n\n```shell\ntar -ztvf /tmp/etc.tar.gz\n```\n\nï¼ˆ4ï¼‰è¦å‹ç¼©æ‰“åŒ… /home, /etc ï¼Œä½†ä¸è¦ /home/dmtsai\n\n```shell\ntar --exclude /home/dmtsai -zcvf myfile.tar.gz /home/* /etc\n```\n\n### unzip å‘½ä»¤\n\n- è§£å‹ `*.zip` æ–‡ä»¶ï¼š`unzip test.zip` ã€‚\n- æŸ¥çœ‹ `*.zip` æ–‡ä»¶çš„å†…å®¹ï¼š`unzip -l jasper.zip` ã€‚\n\n","slug":"Javaå…«è‚¡æ–‡-Linux","published":1,"updated":"2023-01-29T11:59:41.227Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cldzfw323000kt9t80bu0aizt","content":"<blockquote>\n<p>æ•´ç†çš„ Linux ç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½\t<span id=\"more\"></span></p>\n</blockquote>\n<h2 id=\"Linux-æ¦‚è¿°\"><a href=\"#Linux-æ¦‚è¿°\" class=\"headerlink\" title=\"Linux æ¦‚è¿°\"></a>Linux æ¦‚è¿°</h2><h3 id=\"ä»€ä¹ˆæ˜¯Linux\"><a href=\"#ä»€ä¹ˆæ˜¯Linux\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯Linux\"></a>ä»€ä¹ˆæ˜¯Linux</h3><p>Linux æ˜¯ä¸€å¥—<strong>å…è´¹ä½¿ç”¨å’Œè‡ªç”±ä¼ æ’­çš„ç±» Unix æ“ä½œç³»ç»Ÿ</strong>ï¼Œæ˜¯ä¸€ä¸ªåŸºäº POSIX å’Œ Unix çš„å¤šç”¨æˆ·ã€å¤šä»»åŠ¡ã€æ”¯æŒå¤šçº¿ç¨‹å’Œå¤š CPU çš„æ“ä½œç³»ç»Ÿã€‚å®ƒèƒ½è¿è¡Œä¸»è¦çš„ Unix å·¥å…·è½¯ä»¶ã€åº”ç”¨ç¨‹åºå’Œç½‘ç»œåè®®ã€‚å®ƒæ”¯æŒ 32 ä½å’Œ 64 ä½ç¡¬ä»¶ã€‚Linux ç»§æ‰¿äº† Unix ä»¥ç½‘ç»œä¸ºæ ¸å¿ƒçš„è®¾è®¡æ€æƒ³ï¼Œæ˜¯ä¸€ä¸ªæ€§èƒ½ç¨³å®šçš„å¤šç”¨æˆ·ç½‘ç»œæ“ä½œç³»ç»Ÿã€‚</p>\n<h3 id=\"Unixå’ŒLinuxæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"><a href=\"#Unixå’ŒLinuxæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"Unixå’ŒLinuxæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"></a>Unixå’ŒLinuxæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p>Linux å’Œ Unix éƒ½æ˜¯åŠŸèƒ½å¼ºå¤§çš„æ“ä½œç³»ç»Ÿï¼Œéƒ½æ˜¯åº”ç”¨å¹¿æ³›çš„æœåŠ¡å™¨æ“ä½œç³»ç»Ÿï¼Œæœ‰å¾ˆå¤šç›¸ä¼¼ä¹‹å¤„ï¼Œç”šè‡³æœ‰ä¸€éƒ¨åˆ†äººé”™è¯¯åœ°è®¤ä¸º Unix å’Œ Linux æ“ä½œç³»ç»Ÿæ˜¯ä¸€æ ·çš„ï¼Œç„¶è€Œï¼Œäº‹å®å¹¶éå¦‚æ­¤ï¼Œä»¥ä¸‹æ˜¯ä¸¤è€…çš„åŒºåˆ«ã€‚</p>\n<ol>\n<li>å¼€æºæ€§<br> Linux æ˜¯ä¸€æ¬¾å¼€æºæ“ä½œç³»ç»Ÿï¼Œä¸éœ€è¦ä»˜è´¹ï¼Œå³å¯ä½¿ç”¨ï¼›Unix æ˜¯ä¸€æ¬¾å¯¹æºç å®è¡ŒçŸ¥è¯†äº§æƒä¿æŠ¤çš„ä¼ ç»Ÿå•†ä¸šè½¯ä»¶ï¼Œä½¿ç”¨éœ€è¦ä»˜è´¹æˆæƒä½¿ç”¨ã€‚</li>\n<li>è·¨å¹³å°æ€§<br> Linux æ“ä½œç³»ç»Ÿå…·æœ‰è‰¯å¥½çš„è·¨å¹³å°æ€§èƒ½ï¼Œå¯è¿è¡Œåœ¨å¤šç§ç¡¬ä»¶å¹³å°ä¸Šï¼›Unix æ“ä½œç³»ç»Ÿè·¨å¹³å°æ€§èƒ½è¾ƒå¼±ï¼Œå¤§å¤šéœ€ä¸ç¡¬ä»¶é…å¥—ä½¿ç”¨ã€‚</li>\n<li>å¯è§†åŒ–ç•Œé¢<br> Linux é™¤äº†è¿›è¡Œå‘½ä»¤è¡Œæ“ä½œï¼Œè¿˜æœ‰çª—ä½“ç®¡ç†ç³»ç»Ÿï¼›Unix åªæ˜¯å‘½ä»¤è¡Œä¸‹çš„ç³»ç»Ÿã€‚</li>\n<li>ç¡¬ä»¶ç¯å¢ƒ<br> Linux æ“ä½œç³»ç»Ÿå¯¹ç¡¬ä»¶çš„è¦æ±‚è¾ƒä½ï¼Œå®‰è£…æ–¹æ³•æ›´æ˜“æŒæ¡ï¼›Unix å¯¹ç¡¬ä»¶è¦æ±‚æ¯”è¾ƒè‹›åˆ»ï¼ŒæŒ‰ç…§éš¾åº¦è¾ƒå¤§ã€‚</li>\n<li>ç”¨æˆ·ç¾¤ä½“<br> Linux çš„ç”¨æˆ·ç¾¤ä½“å¾ˆå¹¿æ³›ï¼Œä¸ªäººå’Œä¼ä¸šå‡å¯ä½¿ç”¨ï¼›Unix çš„ç”¨æˆ·ç¾¤ä½“æ¯”è¾ƒçª„ï¼Œå¤šæ˜¯å®‰å…¨æ€§è¦æ±‚é«˜çš„å¤§å‹ä¼ä¸šä½¿ç”¨ï¼Œå¦‚é“¶è¡Œã€ç”µä¿¡éƒ¨é—¨ç­‰ï¼Œæˆ–è€… Unix ç¡¬ä»¶å‚å•†ä½¿ç”¨ï¼Œå¦‚ Sun ç­‰ã€‚<br> ç›¸æ¯”äº Unix æ“ä½œç³»ç»Ÿï¼ŒLinux æ“ä½œç³»ç»Ÿæ›´å—å¹¿å¤§è®¡ç®—æœºçˆ±å¥½è€…çš„å–œçˆ±ï¼Œä¸»è¦åŸå› æ˜¯ Linux æ“ä½œç³»ç»Ÿå…·æœ‰ Unix æ“ä½œç³»ç»Ÿçš„å…¨éƒ¨åŠŸèƒ½ï¼Œå¹¶ä¸”èƒ½å¤Ÿåœ¨æ™®é€š PC è®¡ç®—æœºä¸Šå®ç°å…¨éƒ¨çš„ Unix ç‰¹æ€§ï¼Œå¼€æºå…è´¹çš„ç‰¹æ€§ï¼Œæ›´å®¹æ˜“æ™®åŠä½¿ç”¨ï¼</li>\n</ol>\n<h3 id=\"ä»€ä¹ˆæ˜¯-Linux-å†…æ ¸ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯-Linux-å†…æ ¸ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ Linux å†…æ ¸ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯ Linux å†…æ ¸ï¼Ÿ</h3><p>Linux ç³»ç»Ÿçš„æ ¸å¿ƒæ˜¯å†…æ ¸ã€‚å†…æ ¸æ§åˆ¶ç€è®¡ç®—æœºç³»ç»Ÿä¸Šçš„æ‰€æœ‰ç¡¬ä»¶å’Œè½¯ä»¶ï¼Œåœ¨å¿…è¦æ—¶åˆ†é…ç¡¬ä»¶ï¼Œå¹¶æ ¹æ®éœ€è¦æ‰§è¡Œè½¯ä»¶ã€‚</p>\n<ol>\n<li>ç³»ç»Ÿå†…å­˜ç®¡ç†</li>\n<li>åº”ç”¨ç¨‹åºç®¡ç†</li>\n<li>ç¡¬ä»¶è®¾å¤‡ç®¡ç†</li>\n<li>æ–‡ä»¶ç³»ç»Ÿç®¡ç†</li>\n</ol>\n<h3 id=\"Linuxçš„åŸºæœ¬ç»„ä»¶æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#Linuxçš„åŸºæœ¬ç»„ä»¶æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"Linuxçš„åŸºæœ¬ç»„ä»¶æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>Linuxçš„åŸºæœ¬ç»„ä»¶æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>å°±åƒä»»ä½•å…¶ä»–å…¸å‹çš„æ“ä½œç³»ç»Ÿä¸€æ ·ï¼ŒLinux æ‹¥æœ‰æ‰€æœ‰è¿™äº›ç»„ä»¶ï¼šå†…æ ¸ï¼Œshell å’Œ GUIï¼Œç³»ç»Ÿå®ç”¨ç¨‹åºå’Œåº”ç”¨ç¨‹åºã€‚Linux æ¯”å…¶ä»–æ“ä½œç³»ç»Ÿæ›´å…·ä¼˜åŠ¿çš„æ˜¯æ¯ä¸ªæ–¹é¢éƒ½é™„å¸¦å…¶ä»–åŠŸèƒ½ï¼Œæ‰€æœ‰ä»£ç éƒ½å¯ä»¥å…è´¹ä¸‹è½½ã€‚</p>\n<h3 id=\"Linux-çš„ä½“ç³»ç»“æ„\"><a href=\"#Linux-çš„ä½“ç³»ç»“æ„\" class=\"headerlink\" title=\"Linux çš„ä½“ç³»ç»“æ„\"></a>Linux çš„ä½“ç³»ç»“æ„</h3><p>ä»å¤§çš„æ–¹é¢è®²ï¼ŒLinux ä½“ç³»ç»“æ„å¯ä»¥åˆ†ä¸ºä¸¤å—ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1RoaW5rV29u,size_16,color_FFFFFF,t_70.png\" alt=\"Linux ä½“ç³»ç»“æ„\"></p>\n<ul>\n<li>ç”¨æˆ·ç©ºé—´(User Space) ï¼šç”¨æˆ·ç©ºé—´åˆåŒ…æ‹¬ç”¨æˆ·çš„åº”ç”¨ç¨‹åº(User Applications)ã€C åº“(C Library) ã€‚</li>\n<li>å†…æ ¸ç©ºé—´(Kernel Space) ï¼šå†…æ ¸ç©ºé—´åˆåŒ…æ‹¬ç³»ç»Ÿè°ƒç”¨æ¥å£(System Call Interface)ã€å†…æ ¸(Kernel)ã€å¹³å°æ¶æ„ç›¸å…³çš„ä»£ç (Architecture-Dependent Kernel Code) ã€‚</li>\n</ul>\n<p><strong>ä¸ºä»€ä¹ˆ Linux ä½“ç³»ç»“æ„è¦åˆ†ä¸ºç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´çš„åŸå› ï¼Ÿ</strong></p>\n<ol>\n<li>ç°ä»£ CPU å®ç°äº†ä¸åŒçš„å·¥ä½œæ¨¡å¼ï¼Œä¸åŒæ¨¡å¼ä¸‹ CPU å¯ä»¥æ‰§è¡Œçš„æŒ‡ä»¤å’Œè®¿é—®çš„å¯„å­˜å™¨ä¸åŒã€‚</li>\n<li>Linux ä» CPU çš„è§’åº¦å‡ºå‘ï¼Œä¸ºäº†ä¿æŠ¤å†…æ ¸çš„å®‰å…¨ï¼ŒæŠŠç³»ç»Ÿåˆ†æˆäº†ä¸¤éƒ¨åˆ†ã€‚</li>\n</ol>\n<p>ç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´æ˜¯ç¨‹åºæ‰§è¡Œçš„<strong>ä¸¤ç§ä¸åŒçš„çŠ¶æ€</strong>ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼å®Œæˆç”¨æˆ·ç©ºé—´åˆ°å†…æ ¸ç©ºé—´çš„è½¬ç§»ï¼š</p>\n<p>1ï¼‰ç³»ç»Ÿè°ƒç”¨ï¼›2ï¼‰ç¡¬ä»¶ä¸­æ–­ã€‚</p>\n<h3 id=\"BASHå’ŒDOSä¹‹é—´çš„åŸºæœ¬åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#BASHå’ŒDOSä¹‹é—´çš„åŸºæœ¬åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"BASHå’ŒDOSä¹‹é—´çš„åŸºæœ¬åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>BASHå’ŒDOSä¹‹é—´çš„åŸºæœ¬åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>BASH å’Œ DOS æ§åˆ¶å°ä¹‹é—´çš„ä¸»è¦åŒºåˆ«åœ¨äº 3 ä¸ªæ–¹é¢ï¼š</p>\n<ul>\n<li>BASH å‘½ä»¤åŒºåˆ†å¤§å°å†™ï¼Œè€Œ DOS å‘½ä»¤åˆ™ä¸åŒºåˆ†ï¼›</li>\n<li>åœ¨ BASH ä¸‹ï¼Œ&#x2F; character æ˜¯ç›®å½•åˆ†éš”ç¬¦ï¼Œ\\ä½œä¸ºè½¬ä¹‰å­—ç¬¦ã€‚åœ¨ DOS ä¸‹ï¼Œ&#x2F;ç”¨ä½œå‘½ä»¤å‚æ•°åˆ†éš”ç¬¦ï¼Œ\\æ˜¯ç›®å½•åˆ†éš”ç¬¦ï¼›</li>\n<li>DOS éµå¾ªå‘½åæ–‡ä»¶ä¸­çš„çº¦å®šï¼Œå³ 8 ä¸ªå­—ç¬¦çš„æ–‡ä»¶ååè·Ÿä¸€ä¸ªç‚¹ï¼Œæ‰©å±•åä¸º 3 ä¸ªå­—ç¬¦ã€‚BASH æ²¡æœ‰éµå¾ªè¿™æ ·çš„æƒ¯ä¾‹ã€‚</li>\n</ul>\n<h3 id=\"Linux-å¼€æœºå¯åŠ¨è¿‡ç¨‹ï¼Ÿ\"><a href=\"#Linux-å¼€æœºå¯åŠ¨è¿‡ç¨‹ï¼Ÿ\" class=\"headerlink\" title=\"Linux å¼€æœºå¯åŠ¨è¿‡ç¨‹ï¼Ÿ\"></a>Linux å¼€æœºå¯åŠ¨è¿‡ç¨‹ï¼Ÿ</h3><blockquote>\n<p>äº†è§£å³å¯ã€‚</p>\n</blockquote>\n<p>1ã€ä¸»æœºåŠ ç”µè‡ªæ£€ï¼ŒåŠ è½½ BIOS ç¡¬ä»¶ä¿¡æ¯ã€‚</p>\n<p>2ã€è¯»å– MBR çš„å¼•å¯¼æ–‡ä»¶(GRUBã€LILO)ã€‚</p>\n<p>3ã€å¼•å¯¼ Linux å†…æ ¸ã€‚</p>\n<p>4ã€è¿è¡Œç¬¬ä¸€ä¸ªè¿›ç¨‹ init (è¿›ç¨‹å·æ°¸è¿œä¸º 1 )ã€‚</p>\n<p>5ã€è¿›å…¥ç›¸åº”çš„è¿è¡Œçº§åˆ«ã€‚</p>\n<p>6ã€è¿è¡Œç»ˆç«¯ï¼Œè¾“å…¥ç”¨æˆ·åå’Œå¯†ç ã€‚</p>\n<h3 id=\"Linuxç³»ç»Ÿç¼ºçœçš„è¿è¡Œçº§åˆ«ï¼Ÿ\"><a href=\"#Linuxç³»ç»Ÿç¼ºçœçš„è¿è¡Œçº§åˆ«ï¼Ÿ\" class=\"headerlink\" title=\"Linuxç³»ç»Ÿç¼ºçœçš„è¿è¡Œçº§åˆ«ï¼Ÿ\"></a>Linuxç³»ç»Ÿç¼ºçœçš„è¿è¡Œçº§åˆ«ï¼Ÿ</h3><ul>\n<li>å…³æœºã€‚</li>\n<li>å•æœºç”¨æˆ·æ¨¡å¼ã€‚</li>\n<li>å­—ç¬¦ç•Œé¢çš„å¤šç”¨æˆ·æ¨¡å¼(ä¸æ”¯æŒç½‘ç»œ)ã€‚</li>\n<li>å­—ç¬¦ç•Œé¢çš„å¤šç”¨æˆ·æ¨¡å¼ã€‚</li>\n<li>æœªåˆ†é…ä½¿ç”¨ã€‚</li>\n<li>å›¾å½¢ç•Œé¢çš„å¤šç”¨æˆ·æ¨¡å¼ã€‚</li>\n<li>é‡å¯ã€‚</li>\n</ul>\n<h3 id=\"Linux-ä½¿ç”¨çš„è¿›ç¨‹é—´é€šä¿¡æ–¹å¼ï¼Ÿ\"><a href=\"#Linux-ä½¿ç”¨çš„è¿›ç¨‹é—´é€šä¿¡æ–¹å¼ï¼Ÿ\" class=\"headerlink\" title=\"Linux ä½¿ç”¨çš„è¿›ç¨‹é—´é€šä¿¡æ–¹å¼ï¼Ÿ\"></a>Linux ä½¿ç”¨çš„è¿›ç¨‹é—´é€šä¿¡æ–¹å¼ï¼Ÿ</h3><blockquote>\n<p>äº†è§£å³å¯ï¼Œä¸éœ€è¦å¤ªæ·±å…¥ã€‚</p>\n</blockquote>\n<ul>\n<li>ç®¡é“(pipe)ã€æµç®¡é“(s_pipe)ã€æœ‰åç®¡é“(FIFO)ã€‚</li>\n<li>ä¿¡å·(signal) ã€‚</li>\n<li>æ¶ˆæ¯é˜Ÿåˆ—ã€‚</li>\n<li>å…±äº«å†…å­˜ã€‚</li>\n<li>ä¿¡å·é‡ã€‚</li>\n<li>å¥—æ¥å­—(socket) ã€‚</li>\n</ul>\n<h3 id=\"Linux-æœ‰å“ªäº›ç³»ç»Ÿæ—¥å¿—æ–‡ä»¶ï¼Ÿ\"><a href=\"#Linux-æœ‰å“ªäº›ç³»ç»Ÿæ—¥å¿—æ–‡ä»¶ï¼Ÿ\" class=\"headerlink\" title=\"Linux æœ‰å“ªäº›ç³»ç»Ÿæ—¥å¿—æ–‡ä»¶ï¼Ÿ\"></a>Linux æœ‰å“ªäº›ç³»ç»Ÿæ—¥å¿—æ–‡ä»¶ï¼Ÿ</h3><p>æ¯”è¾ƒé‡è¦çš„æ˜¯ <code>/var/log/messages</code> æ—¥å¿—æ–‡ä»¶ã€‚</p>\n<p>è¯¥æ—¥å¿—æ–‡ä»¶æ˜¯è®¸å¤šè¿›ç¨‹æ—¥å¿—æ–‡ä»¶çš„æ±‡æ€»ï¼Œä»è¯¥æ–‡ä»¶å¯ä»¥çœ‹å‡ºä»»ä½•å…¥ä¾µä¼å›¾æˆ–æˆåŠŸçš„å…¥ä¾µã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯äº¤æ¢ç©ºé—´ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯äº¤æ¢ç©ºé—´ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯äº¤æ¢ç©ºé—´ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯äº¤æ¢ç©ºé—´ï¼Ÿ</h3><p>äº¤æ¢ç©ºé—´æ˜¯ Linux ä½¿ç”¨çš„ä¸€å®šç©ºé—´ï¼Œç”¨äºä¸´æ—¶ä¿å­˜ä¸€äº›å¹¶å‘è¿è¡Œçš„ç¨‹åºã€‚å½“ RAM æ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜æ¥å®¹çº³æ­£åœ¨æ‰§è¡Œçš„æ‰€æœ‰ç¨‹åºæ—¶ï¼Œå°±ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯rootå¸æˆ·\"><a href=\"#ä»€ä¹ˆæ˜¯rootå¸æˆ·\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯rootå¸æˆ·\"></a>ä»€ä¹ˆæ˜¯rootå¸æˆ·</h3><p>root å¸æˆ·å°±åƒä¸€ä¸ªç³»ç»Ÿç®¡ç†å‘˜å¸æˆ·ï¼Œå…è®¸ä½ å®Œå…¨æ§åˆ¶ç³»ç»Ÿã€‚ä½ å¯ä»¥åœ¨æ­¤å¤„åˆ›å»ºå’Œç»´æŠ¤ç”¨æˆ·å¸æˆ·ï¼Œä¸ºæ¯ä¸ªå¸æˆ·åˆ†é…ä¸åŒçš„æƒé™ã€‚æ¯æ¬¡å®‰è£… Linux æ—¶éƒ½æ˜¯é»˜è®¤å¸æˆ·ã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯LILOï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯LILOï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯LILOï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯LILOï¼Ÿ</h3><p>LILO æ˜¯ Linux çš„å¼•å¯¼åŠ è½½ç¨‹åºã€‚å®ƒä¸»è¦ç”¨äºå°† Linux æ“ä½œç³»ç»ŸåŠ è½½åˆ°ä¸»å†…å­˜ä¸­ï¼Œä»¥ä¾¿å®ƒå¯ä»¥å¼€å§‹è¿è¡Œã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯BASHï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯BASHï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯BASHï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯BASHï¼Ÿ</h3><p>BASH æ˜¯ Bourne Again SHell çš„ç¼©å†™ã€‚å®ƒç”± Steve Bourne ç¼–å†™ï¼Œä½œä¸ºåŸå§‹ Bourne Shellï¼ˆç”±&#x2F; bin &#x2F; sh è¡¨ç¤ºï¼‰çš„æ›¿ä»£å“ã€‚å®ƒç»“åˆäº†åŸå§‹ç‰ˆæœ¬çš„ Bourne Shell çš„æ‰€æœ‰åŠŸèƒ½ï¼Œä»¥åŠå…¶ä»–åŠŸèƒ½ï¼Œä½¿å…¶æ›´å®¹æ˜“ä½¿ç”¨ã€‚ä»é‚£ä»¥åï¼Œå®ƒå·²è¢«æ”¹ç¼–ä¸ºè¿è¡Œ Linux çš„å¤§å¤šæ•°ç³»ç»Ÿçš„é»˜è®¤ shellã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯CLIï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯CLIï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯CLIï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯CLIï¼Ÿ</h3><p><strong>å‘½ä»¤è¡Œç•Œé¢</strong>ï¼ˆè‹±è¯­<strong>ï¼šcommand-line interface</strong>ï¼Œç¼©å†™]<strong>ï¼šCLI</strong>ï¼‰æ˜¯åœ¨å›¾å½¢ç”¨æˆ·ç•Œé¢å¾—åˆ°æ™®åŠä¹‹å‰ä½¿ç”¨æœ€ä¸ºå¹¿æ³›çš„ç”¨æˆ·ç•Œé¢ï¼Œå®ƒé€šå¸¸ä¸æ”¯æŒé¼ æ ‡ï¼Œç”¨æˆ·é€šè¿‡é”®ç›˜è¾“å…¥æŒ‡ä»¤ï¼Œè®¡ç®—æœºæ¥æ”¶åˆ°æŒ‡ä»¤åï¼Œäºˆä»¥æ‰§è¡Œã€‚ä¹Ÿæœ‰äººç§°ä¹‹ä¸º<strong>å­—ç¬¦ç”¨æˆ·ç•Œé¢</strong>ï¼ˆCUIï¼‰ã€‚</p>\n<p>é€šå¸¸è®¤ä¸ºï¼Œå‘½ä»¤è¡Œç•Œé¢ï¼ˆCLIï¼‰æ²¡æœ‰å›¾å½¢ç”¨æˆ·ç•Œé¢ï¼ˆGUIï¼‰é‚£ä¹ˆæ–¹ä¾¿ç”¨æˆ·æ“ä½œã€‚å› ä¸ºï¼Œå‘½ä»¤è¡Œç•Œé¢çš„è½¯ä»¶é€šå¸¸éœ€è¦ç”¨æˆ·è®°å¿†æ“ä½œçš„å‘½ä»¤ï¼Œä½†æ˜¯ï¼Œç”±äºå…¶æœ¬èº«çš„ç‰¹ç‚¹ï¼Œå‘½ä»¤è¡Œç•Œé¢è¦è¾ƒå›¾å½¢ç”¨æˆ·ç•Œé¢èŠ‚çº¦è®¡ç®—æœºç³»ç»Ÿçš„èµ„æºã€‚åœ¨ç†Ÿè®°å‘½ä»¤çš„å‰æä¸‹ï¼Œä½¿ç”¨å‘½ä»¤è¡Œç•Œé¢å¾€å¾€è¦è¾ƒä½¿ç”¨å›¾å½¢ç”¨æˆ·ç•Œé¢çš„æ“ä½œé€Ÿåº¦è¦å¿«ã€‚æ‰€ä»¥ï¼Œå›¾å½¢ç”¨æˆ·ç•Œé¢çš„æ“ä½œç³»ç»Ÿä¸­ï¼Œéƒ½ä¿ç•™ç€å¯é€‰çš„å‘½ä»¤è¡Œç•Œé¢ã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯GUIï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯GUIï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯GUIï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯GUIï¼Ÿ</h3><p>å›¾å½¢ç”¨æˆ·ç•Œé¢ï¼ˆGraphical User Interfaceï¼Œç®€ç§° GUIï¼Œåˆç§°å›¾å½¢ç”¨æˆ·æ¥å£ï¼‰æ˜¯æŒ‡é‡‡ç”¨å›¾å½¢æ–¹å¼æ˜¾ç¤ºçš„è®¡ç®—æœºæ“ä½œç”¨æˆ·ç•Œé¢ã€‚</p>\n<p>å›¾å½¢ç”¨æˆ·ç•Œé¢æ˜¯ä¸€ç§äººä¸è®¡ç®—æœºé€šä¿¡çš„ç•Œé¢æ˜¾ç¤ºæ ¼å¼ï¼Œå…è®¸ç”¨æˆ·ä½¿ç”¨é¼ æ ‡ç­‰è¾“å…¥è®¾å¤‡æ“çºµå±å¹•ä¸Šçš„å›¾æ ‡æˆ–èœå•é€‰é¡¹ï¼Œä»¥é€‰æ‹©å‘½ä»¤ã€è°ƒç”¨æ–‡ä»¶ã€å¯åŠ¨ç¨‹åºæˆ–æ‰§è¡Œå…¶å®ƒä¸€äº›æ—¥å¸¸ä»»åŠ¡ã€‚ä¸é€šè¿‡é”®ç›˜è¾“å…¥æ–‡æœ¬æˆ–å­—ç¬¦å‘½ä»¤æ¥å®Œæˆä¾‹è¡Œä»»åŠ¡çš„å­—ç¬¦ç•Œé¢ç›¸æ¯”ï¼Œå›¾å½¢ç”¨æˆ·ç•Œé¢æœ‰è®¸å¤šä¼˜ç‚¹ã€‚</p>\n<h3 id=\"å¼€æºçš„ä¼˜åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#å¼€æºçš„ä¼˜åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"å¼€æºçš„ä¼˜åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>å¼€æºçš„ä¼˜åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>å¼€æºå…è®¸ä½ å°†è½¯ä»¶ï¼ˆåŒ…æ‹¬æºä»£ç ï¼‰å…è´¹åˆ†å‘ç»™ä»»ä½•æ„Ÿå…´è¶£çš„äººã€‚ç„¶åï¼Œäººä»¬å¯ä»¥æ·»åŠ åŠŸèƒ½ï¼Œç”šè‡³å¯ä»¥è°ƒè¯•å’Œæ›´æ­£æºä»£ç ä¸­çš„é”™è¯¯ã€‚å®ƒä»¬ç”šè‡³å¯ä»¥è®©å®ƒè¿è¡Œå¾—æ›´å¥½ï¼Œç„¶åå†æ¬¡è‡ªç”±åœ°é‡æ–°åˆ†é…è¿™äº›å¢å¼ºçš„æºä»£ç ã€‚è¿™æœ€ç»ˆä½¿ç¤¾åŒºä¸­çš„æ¯ä¸ªäººå—ç›Šã€‚</p>\n<h3 id=\"GNUé¡¹ç›®çš„é‡è¦æ€§æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#GNUé¡¹ç›®çš„é‡è¦æ€§æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"GNUé¡¹ç›®çš„é‡è¦æ€§æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>GNUé¡¹ç›®çš„é‡è¦æ€§æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>è¿™ç§æ‰€è°“çš„è‡ªç”±è½¯ä»¶è¿åŠ¨å…·æœ‰å¤šç§ä¼˜åŠ¿ï¼Œä¾‹å¦‚å¯ä»¥è‡ªç”±åœ°è¿è¡Œç¨‹åºä»¥åŠæ ¹æ®ä½ çš„éœ€è¦è‡ªç”±å­¦ä¹ å’Œä¿®æ”¹ç¨‹åºã€‚å®ƒè¿˜å…è®¸ä½ å°†è½¯ä»¶å‰¯æœ¬é‡æ–°åˆ†å‘ç»™å…¶ä»–äººï¼Œä»¥åŠè‡ªç”±æ”¹è¿›è½¯ä»¶å¹¶å°†å…¶å‘å¸ƒç»™å…¬ä¼—ã€‚</p>\n<h2 id=\"ç£ç›˜ã€ç›®å½•ã€æ–‡ä»¶\"><a href=\"#ç£ç›˜ã€ç›®å½•ã€æ–‡ä»¶\" class=\"headerlink\" title=\"ç£ç›˜ã€ç›®å½•ã€æ–‡ä»¶\"></a>ç£ç›˜ã€ç›®å½•ã€æ–‡ä»¶</h2><h3 id=\"ç®€å•-Linux-æ–‡ä»¶ç³»ç»Ÿï¼Ÿ\"><a href=\"#ç®€å•-Linux-æ–‡ä»¶ç³»ç»Ÿï¼Ÿ\" class=\"headerlink\" title=\"ç®€å• Linux æ–‡ä»¶ç³»ç»Ÿï¼Ÿ\"></a>ç®€å• Linux æ–‡ä»¶ç³»ç»Ÿï¼Ÿ</h3><p><strong>åœ¨ Linux æ“ä½œç³»ç»Ÿä¸­ï¼Œæ‰€æœ‰è¢«æ“ä½œç³»ç»Ÿç®¡ç†çš„èµ„æºï¼Œä¾‹å¦‚ç½‘ç»œæ¥å£å¡ã€ç£ç›˜é©±åŠ¨å™¨ã€æ‰“å°æœºã€è¾“å…¥è¾“å‡ºè®¾å¤‡ã€æ™®é€šæ–‡ä»¶æˆ–æ˜¯ç›®å½•éƒ½è¢«çœ‹ä½œæ˜¯ä¸€ä¸ªæ–‡ä»¶ã€‚</strong></p>\n<p>ä¹Ÿå°±æ˜¯è¯´åœ¨ Linux ç³»ç»Ÿä¸­æœ‰ä¸€ä¸ªé‡è¦çš„æ¦‚å¿µ<strong>ï¼šä¸€åˆ‡éƒ½æ˜¯æ–‡ä»¶</strong>ã€‚å…¶å®è¿™æ˜¯ Unix å“²å­¦çš„ä¸€ä¸ªä½“ç°ï¼Œè€Œ Linux æ˜¯é‡å†™ Unix è€Œæ¥ï¼Œæ‰€ä»¥è¿™ä¸ªæ¦‚å¿µä¹Ÿå°±ä¼ æ‰¿äº†ä¸‹æ¥ã€‚åœ¨ Unix ç³»ç»Ÿä¸­ï¼ŒæŠŠä¸€åˆ‡èµ„æºéƒ½çœ‹ä½œæ˜¯æ–‡ä»¶ï¼ŒåŒ…æ‹¬ç¡¬ä»¶è®¾å¤‡ã€‚UNIX ç³»ç»ŸæŠŠæ¯ä¸ªç¡¬ä»¶éƒ½çœ‹æˆæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œé€šå¸¸ç§°ä¸ºè®¾å¤‡æ–‡ä»¶ï¼Œè¿™æ ·ç”¨æˆ·å°±<strong>å¯ä»¥ç”¨è¯»å†™æ–‡ä»¶çš„æ–¹å¼å®ç°å¯¹ç¡¬ä»¶çš„è®¿é—®</strong>ã€‚</p>\n<p>Linux æ”¯æŒ 5 ç§æ–‡ä»¶ç±»å‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/format,png.png\" alt=\"5 ç§æ–‡ä»¶ç±»å‹\"></p>\n<h3 id=\"Linux-çš„ç›®å½•ç»“æ„æ˜¯æ€æ ·çš„ï¼Ÿ\"><a href=\"#Linux-çš„ç›®å½•ç»“æ„æ˜¯æ€æ ·çš„ï¼Ÿ\" class=\"headerlink\" title=\"Linux çš„ç›®å½•ç»“æ„æ˜¯æ€æ ·çš„ï¼Ÿ\"></a>Linux çš„ç›®å½•ç»“æ„æ˜¯æ€æ ·çš„ï¼Ÿ</h3><blockquote>\n<p>è¿™ä¸ªé—®é¢˜ï¼Œä¸€èˆ¬ä¸ä¼šé—®ã€‚æ›´å¤šæ˜¯å®é™…ä½¿ç”¨æ—¶ï¼Œéœ€è¦çŸ¥é“ã€‚</p>\n</blockquote>\n<p>Linux æ–‡ä»¶ç³»ç»Ÿçš„ç»“æ„å±‚æ¬¡é²œæ˜ï¼Œå°±åƒä¸€æ£µå€’ç«‹çš„æ ‘ï¼Œæœ€é¡¶å±‚æ˜¯å…¶æ ¹ç›®å½•ï¼š<br><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/format,png-20230125135806288.png\" alt=\"Linux çš„ç›®å½•ç»“æ„\"></p>\n<p><strong>å¸¸è§ç›®å½•è¯´æ˜</strong>ï¼š</p>\n<ul>\n<li><strong>&#x2F;bin</strong>ï¼š å­˜æ”¾äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶(ls,cat,mkdir ç­‰)ï¼Œå¸¸ç”¨å‘½ä»¤ä¸€èˆ¬éƒ½åœ¨è¿™é‡Œï¼›</li>\n<li><strong>&#x2F;etc</strong>ï¼š å­˜æ”¾ç³»ç»Ÿç®¡ç†å’Œé…ç½®æ–‡ä»¶ï¼›</li>\n<li><strong>&#x2F;home</strong>ï¼š å­˜æ”¾æ‰€æœ‰ç”¨æˆ·æ–‡ä»¶çš„æ ¹ç›®å½•ï¼Œæ˜¯ç”¨æˆ·ä¸»ç›®å½•çš„åŸºç‚¹ï¼Œæ¯”å¦‚ç”¨æˆ· user çš„ä¸»ç›®å½•å°±æ˜¯&#x2F;home&#x2F;userï¼Œå¯ä»¥ç”¨~user è¡¨ç¤ºï¼›</li>\n<li>**&#x2F;usr **ï¼š ç”¨äºå­˜æ”¾ç³»ç»Ÿåº”ç”¨ç¨‹åºï¼›</li>\n<li><strong>&#x2F;opt</strong>ï¼š é¢å¤–å®‰è£…çš„å¯é€‰åº”ç”¨ç¨‹åºåŒ…æ‰€æ”¾ç½®çš„ä½ç½®ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ tomcat ç­‰éƒ½å®‰è£…åˆ°è¿™é‡Œï¼›</li>\n<li><strong>&#x2F;proc</strong>ï¼š è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿç›®å½•ï¼Œæ˜¯ç³»ç»Ÿå†…å­˜çš„æ˜ å°„ã€‚å¯ç›´æ¥è®¿é—®è¿™ä¸ªç›®å½•æ¥è·å–ç³»ç»Ÿä¿¡æ¯ï¼›</li>\n<li><strong>&#x2F;root</strong>ï¼š è¶…çº§ç”¨æˆ·ï¼ˆç³»ç»Ÿç®¡ç†å‘˜ï¼‰çš„ä¸»ç›®å½•ï¼ˆç‰¹æƒé˜¶çº§ oï¼‰ï¼›</li>\n<li><strong>&#x2F;sbin:</strong> å­˜æ”¾äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ï¼Œåªæœ‰ root æ‰èƒ½è®¿é—®ã€‚è¿™é‡Œå­˜æ”¾çš„æ˜¯ç³»ç»Ÿç®¡ç†å‘˜ä½¿ç”¨çš„ç³»ç»Ÿçº§åˆ«çš„ç®¡ç†å‘½ä»¤å’Œç¨‹åºã€‚å¦‚ ifconfig ç­‰ï¼›</li>\n<li><strong>&#x2F;dev</strong>ï¼š ç”¨äºå­˜æ”¾è®¾å¤‡æ–‡ä»¶ï¼›</li>\n<li><strong>&#x2F;mnt</strong>ï¼š ç³»ç»Ÿç®¡ç†å‘˜å®‰è£…ä¸´æ—¶æ–‡ä»¶ç³»ç»Ÿçš„å®‰è£…ç‚¹ï¼Œç³»ç»Ÿæä¾›è¿™ä¸ªç›®å½•æ˜¯è®©ç”¨æˆ·ä¸´æ—¶æŒ‚è½½å…¶ä»–çš„æ–‡ä»¶ç³»ç»Ÿï¼›</li>\n<li><strong>&#x2F;boot</strong>ï¼š å­˜æ”¾ç”¨äºç³»ç»Ÿå¼•å¯¼æ—¶ä½¿ç”¨çš„å„ç§æ–‡ä»¶ï¼›</li>\n<li>**&#x2F;lib **ï¼š å­˜æ”¾ç€å’Œç³»ç»Ÿè¿è¡Œç›¸å…³çš„åº“æ–‡ä»¶ ï¼›</li>\n<li><strong>&#x2F;tmp</strong>ï¼š ç”¨äºå­˜æ”¾å„ç§ä¸´æ—¶æ–‡ä»¶ï¼Œæ˜¯å…¬ç”¨çš„ä¸´æ—¶æ–‡ä»¶å­˜å‚¨ç‚¹ï¼›</li>\n<li><strong>&#x2F;var</strong>ï¼š ç”¨äºå­˜æ”¾è¿è¡Œæ—¶éœ€è¦æ”¹å˜æ•°æ®çš„æ–‡ä»¶ï¼Œä¹Ÿæ˜¯æŸäº›å¤§æ–‡ä»¶çš„æº¢å‡ºåŒºï¼Œæ¯”æ–¹è¯´å„ç§æœåŠ¡çš„æ—¥å¿—æ–‡ä»¶ï¼ˆç³»ç»Ÿå¯åŠ¨æ—¥å¿—ç­‰ã€‚ï¼‰ç­‰ï¼›</li>\n<li><strong>&#x2F;lost+found</strong>ï¼š è¿™ä¸ªç›®å½•å¹³æ—¶æ˜¯ç©ºçš„ï¼Œç³»ç»Ÿéæ­£å¸¸å…³æœºè€Œç•™ä¸‹â€œæ— å®¶å¯å½’â€çš„æ–‡ä»¶ï¼ˆwindows ä¸‹å«ä»€ä¹ˆ.chkï¼‰å°±åœ¨è¿™é‡Œã€‚</li>\n</ul>\n<h3 id=\"ä»€ä¹ˆæ˜¯-inode-ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯-inode-ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ inode ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯ inode ï¼Ÿ</h3><blockquote>\n<p>ä¸€èˆ¬æ¥è¯´ï¼Œé¢è¯•ä¸ä¼šé—® inode ã€‚ä½†æ˜¯ inode æ˜¯ä¸€ä¸ªé‡è¦æ¦‚å¿µï¼Œæ˜¯ç†è§£ Unix&#x2F;Linux æ–‡ä»¶ç³»ç»Ÿå’Œç¡¬ç›˜å‚¨å­˜çš„åŸºç¡€ã€‚</p>\n</blockquote>\n<p>ç†è§£ inodeï¼Œè¦ä»æ–‡ä»¶å‚¨å­˜è¯´èµ·ã€‚</p>\n<p>æ–‡ä»¶å‚¨å­˜åœ¨ç¡¬ç›˜ä¸Šï¼Œç¡¬ç›˜çš„æœ€å°å­˜å‚¨å•ä½å«åšâ€æ‰‡åŒºâ€ï¼ˆSectorï¼‰ã€‚æ¯ä¸ªæ‰‡åŒºå‚¨å­˜ 512 å­—èŠ‚ï¼ˆç›¸å½“äº 0.5KBï¼‰ã€‚</p>\n<p>æ“ä½œç³»ç»Ÿè¯»å–ç¡¬ç›˜çš„æ—¶å€™ï¼Œä¸ä¼šä¸€ä¸ªä¸ªæ‰‡åŒºåœ°è¯»å–ï¼Œè¿™æ ·æ•ˆç‡å¤ªä½ï¼Œè€Œæ˜¯ä¸€æ¬¡æ€§è¿ç»­è¯»å–å¤šä¸ªæ‰‡åŒºï¼Œå³ä¸€æ¬¡æ€§è¯»å–ä¸€ä¸ªâ€å—â€ï¼ˆblockï¼‰ã€‚è¿™ç§ç”±å¤šä¸ªæ‰‡åŒºç»„æˆçš„â€å—â€ï¼Œæ˜¯æ–‡ä»¶å­˜å–çš„æœ€å°å•ä½ã€‚â€å—â€çš„å¤§å°ï¼Œæœ€å¸¸è§çš„æ˜¯ 4KBï¼Œå³è¿ç»­å…«ä¸ª sector ç»„æˆä¸€ä¸ª blockã€‚</p>\n<p>æ–‡ä»¶æ•°æ®éƒ½å‚¨å­˜åœ¨â€å—â€ä¸­ï¼Œé‚£ä¹ˆå¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬è¿˜å¿…é¡»æ‰¾åˆ°ä¸€ä¸ªåœ°æ–¹å‚¨å­˜æ–‡ä»¶çš„å…ƒä¿¡æ¯ï¼Œæ¯”å¦‚æ–‡ä»¶çš„åˆ›å»ºè€…ã€æ–‡ä»¶çš„åˆ›å»ºæ—¥æœŸã€æ–‡ä»¶çš„å¤§å°ç­‰ç­‰ã€‚è¿™ç§å‚¨å­˜æ–‡ä»¶å…ƒä¿¡æ¯çš„åŒºåŸŸå°±å«åš inodeï¼Œä¸­æ–‡è¯‘åä¸ºâ€ç´¢å¼•èŠ‚ç‚¹â€ã€‚</p>\n<p>æ¯ä¸€ä¸ªæ–‡ä»¶éƒ½æœ‰å¯¹åº”çš„ inodeï¼Œé‡Œé¢åŒ…å«äº†ä¸è¯¥æ–‡ä»¶æœ‰å…³çš„ä¸€äº›ä¿¡æ¯ã€‚</p>\n<p><strong>ç®€è¿° Linux æ–‡ä»¶ç³»ç»Ÿé€šè¿‡ i èŠ‚ç‚¹æŠŠæ–‡ä»¶çš„é€»è¾‘ç»“æ„å’Œç‰©ç†ç»“æ„è½¬æ¢çš„å·¥ä½œè¿‡ç¨‹ï¼Ÿ</strong></p>\n<blockquote>\n<p>å¦‚æœçœ‹çš„ä¸€è„¸æ‡µé€¼ï¼Œä¹Ÿæ²¡å…³ç³»ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œé¢è¯•å®˜ä¸å¤ªä¼šé—®è¿™ä¸ªé¢˜ç›®ã€‚</p>\n</blockquote>\n<p>Linux é€šè¿‡ inode èŠ‚ç‚¹è¡¨å°†æ–‡ä»¶çš„é€»è¾‘ç»“æ„å’Œç‰©ç†ç»“æ„è¿›è¡Œè½¬æ¢ã€‚</p>\n<ul>\n<li>inode èŠ‚ç‚¹æ˜¯ä¸€ä¸ª 64 å­—èŠ‚é•¿çš„è¡¨ï¼Œè¡¨ä¸­åŒ…å«äº†æ–‡ä»¶çš„ç›¸å…³ä¿¡æ¯ï¼Œå…¶ä¸­æœ‰æ–‡ä»¶çš„å¤§å°ã€æ–‡ä»¶æ‰€æœ‰è€…ã€æ–‡ä»¶çš„å­˜å–è®¸å¯æ–¹å¼ä»¥åŠæ–‡ä»¶çš„ç±»å‹ç­‰é‡è¦ä¿¡æ¯ã€‚åœ¨ inode èŠ‚ç‚¹è¡¨ä¸­æœ€é‡è¦çš„å†…å®¹æ˜¯ç£ç›˜åœ°å€è¡¨ã€‚åœ¨ç£ç›˜åœ°å€è¡¨ä¸­æœ‰ 13 ä¸ªå—å·ï¼Œæ–‡ä»¶å°†ä»¥å—å·åœ¨ç£ç›˜åœ°å€è¡¨ä¸­å‡ºç°çš„é¡ºåºä¾æ¬¡è¯»å–ç›¸åº”çš„å—ã€‚</li>\n<li>Linux æ–‡ä»¶ç³»ç»Ÿé€šè¿‡æŠŠ inode èŠ‚ç‚¹å’Œæ–‡ä»¶åè¿›è¡Œè¿æ¥ï¼Œå½“éœ€è¦è¯»å–è¯¥æ–‡ä»¶æ—¶ï¼Œæ–‡ä»¶ç³»ç»Ÿåœ¨å½“å‰ç›®å½•è¡¨ä¸­æŸ¥æ‰¾è¯¥æ–‡ä»¶åå¯¹åº”çš„é¡¹ï¼Œç”±æ­¤å¾—åˆ°è¯¥æ–‡ä»¶ç›¸å¯¹åº”çš„ inode èŠ‚ç‚¹å·ï¼Œé€šè¿‡è¯¥ inode èŠ‚ç‚¹çš„ç£ç›˜åœ°å€è¡¨æŠŠåˆ†æ•£å­˜æ”¾çš„æ–‡ä»¶ç‰©ç†å—è¿æ¥æˆæ–‡ä»¶çš„é€»è¾‘ç»“æ„ã€‚</li>\n</ul>\n<h3 id=\"ä»€ä¹ˆæ˜¯ç¡¬é“¾æ¥å’Œè½¯é“¾æ¥ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯ç¡¬é“¾æ¥å’Œè½¯é“¾æ¥ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ç¡¬é“¾æ¥å’Œè½¯é“¾æ¥ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯ç¡¬é“¾æ¥å’Œè½¯é“¾æ¥ï¼Ÿ</h3><p>1ï¼‰ç¡¬é“¾æ¥</p>\n<p>ç”±äº Linux ä¸‹çš„æ–‡ä»¶æ˜¯é€šè¿‡ç´¢å¼•èŠ‚ç‚¹(inode)æ¥è¯†åˆ«æ–‡ä»¶ï¼Œç¡¬é“¾æ¥å¯ä»¥è®¤ä¸ºæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘æ–‡ä»¶ç´¢å¼•èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œç³»ç»Ÿå¹¶ä¸ä¸ºå®ƒé‡æ–°åˆ†é… inode ã€‚æ¯æ·»åŠ ä¸€ä¸ªä¸€ä¸ªç¡¬é“¾æ¥ï¼Œæ–‡ä»¶çš„é“¾æ¥æ•°å°±åŠ  1 ã€‚</p>\n<ul>\n<li>ä¸è¶³ï¼š1ï¼‰ä¸å¯ä»¥åœ¨ä¸åŒæ–‡ä»¶ç³»ç»Ÿçš„æ–‡ä»¶é—´å»ºç«‹é“¾æ¥ï¼›2ï¼‰åªæœ‰è¶…çº§ç”¨æˆ·æ‰å¯ä»¥ä¸ºç›®å½•åˆ›å»ºç¡¬é“¾æ¥ã€‚</li>\n</ul>\n<p>2ï¼‰è½¯é“¾æ¥</p>\n<p>è½¯é“¾æ¥å…‹æœäº†ç¡¬é“¾æ¥çš„ä¸è¶³ï¼Œæ²¡æœ‰ä»»ä½•æ–‡ä»¶ç³»ç»Ÿçš„é™åˆ¶ï¼Œä»»ä½•ç”¨æˆ·å¯ä»¥åˆ›å»ºæŒ‡å‘ç›®å½•çš„ç¬¦å·é“¾æ¥ã€‚å› è€Œç°åœ¨æ›´ä¸ºå¹¿æ³›ä½¿ç”¨ï¼Œå®ƒå…·æœ‰æ›´å¤§çš„çµæ´»æ€§ï¼Œç”šè‡³å¯ä»¥è·¨è¶Šä¸åŒæœºå™¨ã€ä¸åŒç½‘ç»œå¯¹æ–‡ä»¶è¿›è¡Œé“¾æ¥ã€‚</p>\n<ul>\n<li>ä¸è¶³ï¼šå› ä¸ºé“¾æ¥æ–‡ä»¶åŒ…å«æœ‰åŸæ–‡ä»¶çš„è·¯å¾„ä¿¡æ¯ï¼Œæ‰€ä»¥å½“åŸæ–‡ä»¶ä»ä¸€ä¸ªç›®å½•ä¸‹ç§»åˆ°å…¶ä»–ç›®å½•ä¸­ï¼Œå†è®¿é—®é“¾æ¥æ–‡ä»¶ï¼Œç³»ç»Ÿå°±æ‰¾ä¸åˆ°äº†ï¼Œè€Œç¡¬é“¾æ¥å°±æ²¡æœ‰è¿™ä¸ªç¼ºé™·ï¼Œä½ æƒ³æ€ä¹ˆç§»å°±æ€ä¹ˆç§»ï¼›è¿˜æœ‰å®ƒè¦ç³»ç»Ÿåˆ†é…é¢å¤–çš„ç©ºé—´ç”¨äºå»ºç«‹æ–°çš„ç´¢å¼•èŠ‚ç‚¹å’Œä¿å­˜åŸæ–‡ä»¶çš„è·¯å¾„ã€‚</li>\n</ul>\n<p><strong>å®é™…åœºæ™¯ä¸‹ï¼ŒåŸºæœ¬æ˜¯ä½¿ç”¨è½¯é“¾æ¥</strong>ã€‚æ€»ç»“åŒºåˆ«å¦‚ä¸‹ï¼š</p>\n<ul>\n<li>ç¡¬é“¾æ¥ä¸å¯ä»¥è·¨åˆ†åŒºï¼Œè½¯ä»¶é“¾å¯ä»¥è·¨åˆ†åŒºã€‚</li>\n<li>ç¡¬é“¾æ¥æŒ‡å‘ä¸€ä¸ª inode èŠ‚ç‚¹ï¼Œè€Œè½¯é“¾æ¥åˆ™æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„ inode èŠ‚ç‚¹ã€‚</li>\n<li>åˆ é™¤ç¡¬é“¾æ¥æ–‡ä»¶ï¼Œä¸ä¼šåˆ é™¤åŸæ–‡ä»¶ï¼Œåˆ é™¤è½¯é“¾æ¥æ–‡ä»¶ï¼Œä¼šæŠŠåŸæ–‡ä»¶åˆ é™¤ã€‚</li>\n</ul>\n<h3 id=\"RAID-æ˜¯ä»€ä¹ˆ\"><a href=\"#RAID-æ˜¯ä»€ä¹ˆ\" class=\"headerlink\" title=\"RAID æ˜¯ä»€ä¹ˆ?\"></a>RAID æ˜¯ä»€ä¹ˆ?</h3><blockquote>\n<p>RAID å…¨ç§°ä¸ºç‹¬ç«‹ç£ç›˜å†—ä½™é˜µåˆ—(Redundant Array of Independent Disks)ï¼ŒåŸºæœ¬æ€æƒ³å°±æ˜¯æŠŠå¤šä¸ªç›¸å¯¹ä¾¿å®œçš„ç¡¬ç›˜ç»„åˆèµ·æ¥ï¼Œæˆä¸ºä¸€ä¸ªç¡¬ç›˜é˜µåˆ—ç»„ï¼Œä½¿æ€§èƒ½è¾¾åˆ°ç”šè‡³è¶…è¿‡ä¸€ä¸ªä»·æ ¼æ˜‚è´µã€ å®¹é‡å·¨å¤§çš„ç¡¬ç›˜ã€‚RAID é€šå¸¸è¢«ç”¨åœ¨æœåŠ¡å™¨ç”µè„‘ä¸Šï¼Œä½¿ç”¨å®Œå…¨ç›¸åŒçš„ç¡¬ç›˜ç»„æˆä¸€ä¸ªé€»è¾‘æ‰‡åŒºï¼Œå› æ­¤æ“ä½œç³»ç»Ÿåªä¼šæŠŠå®ƒå½“åšä¸€ä¸ªç¡¬ç›˜ã€‚</p>\n<p>RAID åˆ†ä¸ºä¸åŒçš„ç­‰çº§ï¼Œå„ä¸ªä¸åŒçš„ç­‰çº§å‡åœ¨æ•°æ®å¯é æ€§åŠè¯»å†™æ€§èƒ½ä¸Šåšäº†ä¸åŒçš„æƒè¡¡ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¯ä»¥ä¾æ®è‡ªå·±çš„å®é™…éœ€æ±‚é€‰æ‹©ä¸åŒçš„ RAID æ–¹æ¡ˆã€‚</p>\n</blockquote>\n<p>å½“ç„¶ï¼Œå› ä¸ºå¾ˆå¤šå…¬å¸éƒ½ä½¿ç”¨äº‘æœåŠ¡ï¼Œå¤§å®¶å¾ˆéš¾æ¥è§¦åˆ° RAID è¿™ä¸ªæ¦‚å¿µï¼Œæ›´å¤šçš„å¯èƒ½æ˜¯æ™®é€šäº‘ç›˜ã€SSD äº‘ç›˜é…±ç´«çš„æ¦‚å¿µã€‚</p>\n<h2 id=\"å®‰å…¨\"><a href=\"#å®‰å…¨\" class=\"headerlink\" title=\"å®‰å…¨\"></a>å®‰å…¨</h2><h3 id=\"ä¸€å°-Linux-ç³»ç»Ÿåˆå§‹åŒ–ç¯å¢ƒåéœ€è¦åšä¸€äº›ä»€ä¹ˆå®‰å…¨å·¥ä½œï¼Ÿ\"><a href=\"#ä¸€å°-Linux-ç³»ç»Ÿåˆå§‹åŒ–ç¯å¢ƒåéœ€è¦åšä¸€äº›ä»€ä¹ˆå®‰å…¨å·¥ä½œï¼Ÿ\" class=\"headerlink\" title=\"ä¸€å° Linux ç³»ç»Ÿåˆå§‹åŒ–ç¯å¢ƒåéœ€è¦åšä¸€äº›ä»€ä¹ˆå®‰å…¨å·¥ä½œï¼Ÿ\"></a>ä¸€å° Linux ç³»ç»Ÿåˆå§‹åŒ–ç¯å¢ƒåéœ€è¦åšä¸€äº›ä»€ä¹ˆå®‰å…¨å·¥ä½œï¼Ÿ</h3><p>1ã€æ·»åŠ æ™®é€šç”¨æˆ·ç™»é™†ï¼Œç¦æ­¢ root ç”¨æˆ·ç™»é™†ï¼Œæ›´æ”¹ SSH ç«¯å£å·ã€‚</p>\n<blockquote>\n<p>ä¿®æ”¹ SSH ç«¯å£ä¸ä¸€å®šç»å¯¹å“ˆã€‚å½“ç„¶ï¼Œå¦‚æœè¦æš´éœ²åœ¨å¤–ç½‘ï¼Œå»ºè®®æ”¹ä¸‹ã€‚l</p>\n</blockquote>\n<p>2ã€æœåŠ¡å™¨ä½¿ç”¨å¯†é’¥ç™»é™†ï¼Œç¦æ­¢å¯†ç ç™»é™†ã€‚</p>\n<p>3ã€å¼€å¯é˜²ç«å¢™ï¼Œå…³é—­ SElinux ï¼Œæ ¹æ®ä¸šåŠ¡éœ€æ±‚è®¾ç½®ç›¸åº”çš„é˜²ç«å¢™è§„åˆ™ã€‚</p>\n<p>4ã€è£… fail2ban è¿™ç§é˜²æ­¢ SSH æš´åŠ›ç ´å‡»çš„è½¯ä»¶ã€‚</p>\n<p>5ã€è®¾ç½®åªå…è®¸å…¬å¸åŠå…¬ç½‘å‡ºå£ IP èƒ½ç™»é™†æœåŠ¡å™¨(çœ‹å…¬å¸å®é™…éœ€è¦)</p>\n<blockquote>\n<p>ä¹Ÿå¯ä»¥å®‰è£… VPN ç­‰è½¯ä»¶ï¼Œåªå…è®¸è¿æ¥ VPN åˆ°æœåŠ¡å™¨ä¸Šã€‚</p>\n</blockquote>\n<p>6ã€ä¿®æ”¹å†å²å‘½ä»¤è®°å½•çš„æ¡æ•°ä¸º 10 æ¡ã€‚</p>\n<p>7ã€åªå…è®¸æœ‰éœ€è¦çš„æœåŠ¡å™¨å¯ä»¥è®¿é—®å¤–ç½‘ï¼Œå…¶å®ƒå…¨éƒ¨ç¦æ­¢ã€‚</p>\n<p>8ã€åšå¥½è½¯ä»¶å±‚é¢çš„é˜²æŠ¤ã€‚</p>\n<ul>\n<li>8.1 è®¾ç½® nginx_waf æ¨¡å—é˜²æ­¢ SQL æ³¨å…¥ã€‚</li>\n<li>8.2 æŠŠ Web æœåŠ¡ä½¿ç”¨ www ç”¨æˆ·å¯åŠ¨ï¼Œæ›´æ”¹ç½‘ç«™ç›®å½•çš„æ‰€æœ‰è€…å’Œæ‰€å±ç»„ä¸º www ã€‚</li>\n</ul>\n<h3 id=\"ä»€ä¹ˆå«-CC-æ”»å‡»ï¼Ÿä»€ä¹ˆå«-DDOS-æ”»å‡»ï¼Ÿ\"><a href=\"#ä»€ä¹ˆå«-CC-æ”»å‡»ï¼Ÿä»€ä¹ˆå«-DDOS-æ”»å‡»ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆå« CC æ”»å‡»ï¼Ÿä»€ä¹ˆå« DDOS æ”»å‡»ï¼Ÿ\"></a>ä»€ä¹ˆå« CC æ”»å‡»ï¼Ÿä»€ä¹ˆå« DDOS æ”»å‡»ï¼Ÿ</h3><ul>\n<li><p>CC æ”»å‡»ï¼Œä¸»è¦æ˜¯ç”¨æ¥æ”»å‡»é¡µé¢çš„ï¼Œæ¨¡æ‹Ÿå¤šä¸ªç”¨æˆ·ä¸åœçš„å¯¹ä½ çš„é¡µé¢è¿›è¡Œè®¿é—®ï¼Œä»è€Œä½¿ä½ çš„ç³»ç»Ÿèµ„æºæ¶ˆè€—æ®†å°½ã€‚</p>\n</li>\n<li><p>DDOS æ”»å‡»ï¼Œä¸­æ–‡åå«åˆ†å¸ƒå¼æ‹’ç»æœåŠ¡æ”»å‡»ï¼ŒæŒ‡å€ŸåŠ©æœåŠ¡å™¨æŠ€æœ¯å°†å¤šä¸ªè®¡ç®—æœºè”åˆèµ·æ¥ä½œä¸ºæ”»å‡»å¹³å°ï¼Œæ¥å¯¹ä¸€ä¸ªæˆ–å¤šä¸ªç›®æ ‡å‘åŠ¨ DDOS æ”»å‡»ã€‚</p>\n<blockquote>\n<p>æ”»å‡»ï¼Œå³æ˜¯é€šè¿‡å¤§é‡åˆæ³•çš„è¯·æ±‚å ç”¨å¤§é‡ç½‘ç»œèµ„æºï¼Œä»¥è¾¾åˆ°ç˜«ç—ªç½‘ç»œçš„ç›®çš„ã€‚</p>\n</blockquote>\n</li>\n</ul>\n<p><strong>æ€ä¹ˆé¢„é˜² CC æ”»å‡»å’Œ DDOS æ”»å‡»ï¼Ÿ</strong></p>\n<p>é˜² CCã€DDOS æ”»å‡»ï¼Œè¿™äº›åªèƒ½æ˜¯ç”¨ç¡¬ä»¶é˜²ç«å¢™åšæµé‡æ¸…æ´—ï¼Œå°†æ”»å‡»æµé‡å¼•å…¥é»‘æ´ã€‚</p>\n<blockquote>\n<p>æµé‡æ¸…æ´—è¿™ä¸€å—ï¼Œä¸»è¦æ˜¯ä¹° ISP æœåŠ¡å•†çš„é˜²æ”»å‡»çš„æœåŠ¡å°±å¯ä»¥ï¼Œæœºæˆ¿ä¸€èˆ¬æœ‰ç©ºä½™æµé‡ï¼Œæˆ‘ä»¬ä¸€èˆ¬æ˜¯ä¹°æœåŠ¡ï¼Œæ¯•ç«Ÿæ”»å‡»ä¸ä¼šæ˜¯æŒç»­é•¿æ—¶é—´ã€‚</p>\n</blockquote>\n<h3 id=\"ä»€ä¹ˆæ˜¯ç½‘ç«™æ•°æ®åº“æ³¨å…¥ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯ç½‘ç«™æ•°æ®åº“æ³¨å…¥ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ç½‘ç«™æ•°æ®åº“æ³¨å…¥ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯ç½‘ç«™æ•°æ®åº“æ³¨å…¥ï¼Ÿ</h3><ul>\n<li>ç”±äºç¨‹åºå‘˜çš„æ°´å¹³åŠç»éªŒå‚å·®ä¸é½ï¼Œå¤§éƒ¨åˆ†ç¨‹åºå‘˜åœ¨ç¼–å†™ä»£ç çš„æ—¶å€™ï¼Œæ²¡æœ‰å¯¹ç”¨æˆ·è¾“å…¥æ•°æ®çš„åˆæ³•æ€§è¿›è¡Œåˆ¤æ–­ã€‚</li>\n<li>åº”ç”¨ç¨‹åºå­˜åœ¨å®‰å…¨éšæ‚£ã€‚ç”¨æˆ·å¯ä»¥æäº¤ä¸€æ®µæ•°æ®åº“æŸ¥è¯¢ä»£ç ï¼Œæ ¹æ®ç¨‹åºè¿”å›çš„ç»“æœï¼Œè·å¾—æŸäº›ä»–æƒ³å¾—çŸ¥çš„æ•°æ®ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„ SQL æ³¨å…¥ã€‚</li>\n<li>SQL æ³¨å…¥ï¼Œæ˜¯ä»æ­£å¸¸çš„ WWW ç«¯å£è®¿é—®ï¼Œè€Œä¸”è¡¨é¢çœ‹èµ·æ¥è·Ÿä¸€èˆ¬çš„ Web é¡µé¢è®¿é—®æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œå¦‚æœç®¡ç†å‘˜æ²¡æŸ¥çœ‹æ—¥å¿—çš„ä¹ æƒ¯ï¼Œå¯èƒ½è¢«å…¥ä¾µå¾ˆé•¿æ—¶é—´éƒ½ä¸ä¼šå‘è§‰ã€‚</li>\n</ul>\n<p><strong>å¦‚ä½•è¿‡æ»¤ä¸é¢„é˜²ï¼Ÿ</strong></p>\n<p>æ•°æ®åº“ç½‘é¡µç«¯æ³¨å…¥è¿™ç§ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ nginx_waf åšè¿‡æ»¤ä¸é¢„é˜²ã€‚</p>\n<h2 id=\"Shell\"><a href=\"#Shell\" class=\"headerlink\" title=\"Shell\"></a>Shell</h2><h3 id=\"Shell-è„šæœ¬æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#Shell-è„šæœ¬æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"Shell è„šæœ¬æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>Shell è„šæœ¬æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>ä¸€ä¸ª Shell è„šæœ¬æ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼ŒåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå‘½ä»¤ã€‚ä½œä¸ºç³»ç»Ÿç®¡ç†å‘˜ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦ä½¿ç”¨å¤šä¸ªå‘½ä»¤æ¥å®Œæˆä¸€é¡¹ä»»åŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ è¿™äº›æ‰€æœ‰å‘½ä»¤åœ¨ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶(Shell è„šæœ¬)æ¥å®Œæˆè¿™äº›æ—¥å¸¸å·¥ä½œä»»åŠ¡ã€‚</p>\n<p><strong>ä»€ä¹ˆæ˜¯é»˜è®¤ç™»å½• Shell ï¼Ÿ</strong></p>\n<p>åœ¨ Linux æ“ä½œç³»ç»Ÿï¼Œ<code>&quot;/bin/bash&quot;</code> æ˜¯é»˜è®¤ç™»å½• Shellï¼Œæ˜¯åœ¨åˆ›å»ºç”¨æˆ·æ—¶åˆ†é…çš„ã€‚</p>\n<p>ä½¿ç”¨ chsh å‘½ä»¤å¯ä»¥æ”¹å˜é»˜è®¤çš„ Shell ã€‚ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chsh &lt;ç”¨æˆ·å&gt; -s &lt;æ–°shell&gt;</span><br><span class=\"line\">chsh ThinkWon -s /bin/sh</span><br></pre></td></tr></table></figure>\n\n<p><strong>åœ¨ Shell è„šæœ¬ä¸­ï¼Œå¦‚ä½•å†™å…¥æ³¨é‡Šï¼Ÿ</strong></p>\n<p>æ³¨é‡Šå¯ä»¥ç”¨æ¥æè¿°ä¸€ä¸ªè„šæœ¬å¯ä»¥åšä»€ä¹ˆå’Œå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚æ¯ä¸€è¡Œæ³¨é‡Šä»¥ <code>#</code> å¼€å¤´ã€‚ä¾‹å­å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/bash</span></span><br><span class=\"line\"><span class=\"comment\"># This is a command</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> â€œI am logged <span class=\"keyword\">in</span> as <span class=\"variable\">$USER</span>â€</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"è¯­æ³•çº§\"><a href=\"#è¯­æ³•çº§\" class=\"headerlink\" title=\"è¯­æ³•çº§\"></a>è¯­æ³•çº§</h3><h4 id=\"å¯ä»¥åœ¨-Shell-è„šæœ¬ä¸­ä½¿ç”¨å“ªäº›ç±»å‹çš„å˜é‡ï¼Ÿ\"><a href=\"#å¯ä»¥åœ¨-Shell-è„šæœ¬ä¸­ä½¿ç”¨å“ªäº›ç±»å‹çš„å˜é‡ï¼Ÿ\" class=\"headerlink\" title=\"å¯ä»¥åœ¨ Shell è„šæœ¬ä¸­ä½¿ç”¨å“ªäº›ç±»å‹çš„å˜é‡ï¼Ÿ\"></a>å¯ä»¥åœ¨ Shell è„šæœ¬ä¸­ä½¿ç”¨å“ªäº›ç±»å‹çš„å˜é‡ï¼Ÿ</h4><p>åœ¨ Shell è„šæœ¬ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸¤ç§ç±»å‹çš„å˜é‡ï¼š</p>\n<ul>\n<li><p>ç³»ç»Ÿå®šä¹‰å˜é‡</p>\n<blockquote>\n<p>ç³»ç»Ÿå˜é‡æ˜¯ç”±ç³»ç»Ÿç³»ç»Ÿè‡ªå·±åˆ›å»ºçš„ã€‚è¿™äº›å˜é‡é€šå¸¸ç”±å¤§å†™å­—æ¯ç»„æˆï¼Œå¯ä»¥é€šè¿‡ <code>set</code> å‘½ä»¤æŸ¥çœ‹ã€‚</p>\n</blockquote>\n</li>\n<li><p>ç”¨æˆ·å®šä¹‰å˜é‡</p>\n<blockquote>\n<p>ç”¨æˆ·å˜é‡ç”±ç³»ç»Ÿç”¨æˆ·æ¥ç”Ÿæˆå’Œå®šä¹‰ï¼Œå˜é‡çš„å€¼å¯ä»¥é€šè¿‡å‘½ä»¤ <code>&quot;echo $&lt;å˜é‡å&gt;&quot;</code> æŸ¥çœ‹ã€‚</p>\n</blockquote>\n</li>\n</ul>\n<p><strong>Shellè„šæœ¬ä¸­ $? æ ‡è®°çš„ç”¨é€”æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>\n<p>åœ¨å†™ä¸€ä¸ª Shell è„šæœ¬æ—¶ï¼Œå¦‚æœä½ æƒ³è¦æ£€æŸ¥å‰ä¸€å‘½ä»¤æ˜¯å¦æ‰§è¡ŒæˆåŠŸï¼Œåœ¨ <code>if</code> æ¡ä»¶ä¸­ä½¿ç”¨ <code>$?</code> å¯ä»¥æ¥æ£€æŸ¥å‰ä¸€å‘½ä»¤çš„ç»“æŸçŠ¶æ€ã€‚</p>\n<ul>\n<li><p>å¦‚æœç»“æŸçŠ¶æ€æ˜¯ 0 ï¼Œè¯´æ˜å‰ä¸€ä¸ªå‘½ä»¤æ‰§è¡ŒæˆåŠŸã€‚ä¾‹å¦‚ï¼š</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">root@localhost:~<span class=\"comment\">## ls /usr/bin/shar</span></span><br><span class=\"line\">/usr/bin/shar</span><br><span class=\"line\">root@localhost:~<span class=\"comment\">## echo $?</span></span><br><span class=\"line\">0</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>å¦‚æœç»“æŸçŠ¶æ€ä¸æ˜¯ 0ï¼Œè¯´æ˜å‘½ä»¤æ‰§è¡Œå¤±è´¥ã€‚ä¾‹å¦‚ï¼š</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">root@localhost:~<span class=\"comment\">## ls /usr/bin/share</span></span><br><span class=\"line\"><span class=\"built_in\">ls</span>: cannot access /usr/bin/share: No such file or directory</span><br><span class=\"line\">root@localhost:~<span class=\"comment\">## echo $?</span></span><br><span class=\"line\">2</span><br></pre></td></tr></table></figure></li>\n</ul>\n<p><strong>Bourne Shell(bash) ä¸­æœ‰å“ªäº›ç‰¹æ®Šçš„å˜é‡ï¼Ÿ</strong></p>\n<p>ä¸‹é¢çš„è¡¨åˆ—å‡ºäº† Bourne Shell ä¸ºå‘½ä»¤è¡Œè®¾ç½®çš„ç‰¹æ®Šå˜é‡ã€‚</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">å†…å»ºå˜é‡    è§£é‡Š</span><br><span class=\"line\"><span class=\"variable\">$0</span>    å‘½ä»¤è¡Œä¸­çš„è„šæœ¬åå­—</span><br><span class=\"line\"><span class=\"variable\">$1</span>    ç¬¬ä¸€ä¸ªå‘½ä»¤è¡Œå‚æ•°</span><br><span class=\"line\"><span class=\"variable\">$2</span>    ç¬¬äºŒä¸ªå‘½ä»¤è¡Œå‚æ•°</span><br><span class=\"line\">â€¦..    â€¦â€¦.</span><br><span class=\"line\"><span class=\"variable\">$9</span>    ç¬¬ä¹ä¸ªå‘½ä»¤è¡Œå‚æ•°</span><br><span class=\"line\"><span class=\"variable\">$#</span><span class=\"comment\">#    å‘½ä»¤è¡Œå‚æ•°çš„æ•°é‡</span></span><br><span class=\"line\">$*    æ‰€æœ‰å‘½ä»¤è¡Œå‚æ•°ï¼Œä»¥ç©ºæ ¼éš”å¼€</span><br></pre></td></tr></table></figure>\n\n<p><strong>å¦‚ä½•å–æ¶ˆå˜é‡æˆ–å–æ¶ˆå˜é‡èµ‹å€¼ï¼Ÿ</strong></p>\n<p><code>unset</code> å‘½ä»¤ç”¨äºå–æ¶ˆå˜é‡æˆ–å–æ¶ˆå˜é‡èµ‹å€¼ã€‚è¯­æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">## unset &lt;å˜é‡å&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Shell-è„šæœ¬ä¸­-if-è¯­æ³•å¦‚ä½•åµŒå¥—\"><a href=\"#Shell-è„šæœ¬ä¸­-if-è¯­æ³•å¦‚ä½•åµŒå¥—\" class=\"headerlink\" title=\"Shell è„šæœ¬ä¸­ if è¯­æ³•å¦‚ä½•åµŒå¥—?\"></a>Shell è„šæœ¬ä¸­ <code>if</code> è¯­æ³•å¦‚ä½•åµŒå¥—?</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> [ æ¡ä»¶ ]</span><br><span class=\"line\"><span class=\"keyword\">then</span></span><br><span class=\"line\">å‘½ä»¤1</span><br><span class=\"line\">å‘½ä»¤2</span><br><span class=\"line\">â€¦..</span><br><span class=\"line\"><span class=\"keyword\">else</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> [ æ¡ä»¶ ]</span><br><span class=\"line\"><span class=\"keyword\">then</span></span><br><span class=\"line\">å‘½ä»¤1</span><br><span class=\"line\">å‘½ä»¤2</span><br><span class=\"line\">â€¦.</span><br><span class=\"line\"><span class=\"keyword\">else</span></span><br><span class=\"line\">å‘½ä»¤1</span><br><span class=\"line\">å‘½ä»¤2</span><br><span class=\"line\">â€¦..</span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>åœ¨ Shell è„šæœ¬ä¸­å¦‚ä½•æ¯”è¾ƒä¸¤ä¸ªæ•°å­—ï¼Ÿ</strong></p>\n<p>åœ¨ <code>if-then</code> ä¸­ä½¿ç”¨æµ‹è¯•å‘½ä»¤ï¼ˆ <code>-gt</code> ç­‰ï¼‰æ¥æ¯”è¾ƒä¸¤ä¸ªæ•°å­—ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/bash</span></span><br><span class=\"line\">x=10</span><br><span class=\"line\">y=20</span><br><span class=\"line\"><span class=\"keyword\">if</span> [ <span class=\"variable\">$x</span> -gt <span class=\"variable\">$y</span> ]</span><br><span class=\"line\"><span class=\"keyword\">then</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> â€œx is greater than yâ€</span><br><span class=\"line\"><span class=\"keyword\">else</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> â€œy is greater than xâ€</span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Shell-è„šæœ¬ä¸­-case-è¯­å¥çš„è¯­æ³•\"><a href=\"#Shell-è„šæœ¬ä¸­-case-è¯­å¥çš„è¯­æ³•\" class=\"headerlink\" title=\"Shell è„šæœ¬ä¸­ case è¯­å¥çš„è¯­æ³•?\"></a>Shell è„šæœ¬ä¸­ <code>case</code> è¯­å¥çš„è¯­æ³•?</h4><p>åŸºç¡€è¯­æ³•å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">case</span> å˜é‡ <span class=\"keyword\">in</span></span><br><span class=\"line\">å€¼1)</span><br><span class=\"line\">å‘½ä»¤1</span><br><span class=\"line\">å‘½ä»¤2</span><br><span class=\"line\">â€¦..</span><br><span class=\"line\">æœ€åå‘½ä»¤</span><br><span class=\"line\">!!</span><br><span class=\"line\">å€¼2)</span><br><span class=\"line\">å‘½ä»¤1</span><br><span class=\"line\">å‘½ä»¤2</span><br><span class=\"line\">â€¦â€¦</span><br><span class=\"line\">æœ€åå‘½ä»¤</span><br><span class=\"line\">;;</span><br><span class=\"line\"><span class=\"keyword\">esac</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Shell-è„šæœ¬ä¸­-for-å¾ªç¯è¯­æ³•ï¼Ÿ\"><a href=\"#Shell-è„šæœ¬ä¸­-for-å¾ªç¯è¯­æ³•ï¼Ÿ\" class=\"headerlink\" title=\"Shell è„šæœ¬ä¸­ for å¾ªç¯è¯­æ³•ï¼Ÿ\"></a>Shell è„šæœ¬ä¸­ <code>for</code> å¾ªç¯è¯­æ³•ï¼Ÿ</h4><p>åŸºç¡€è¯­æ³•å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> å˜é‡ <span class=\"keyword\">in</span> å¾ªç¯åˆ—è¡¨</span><br><span class=\"line\"><span class=\"keyword\">do</span></span><br><span class=\"line\">å‘½ä»¤1</span><br><span class=\"line\">å‘½ä»¤2</span><br><span class=\"line\">â€¦.</span><br><span class=\"line\">æœ€åå‘½ä»¤</span><br><span class=\"line\"><span class=\"keyword\">done</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Shell-è„šæœ¬ä¸­-while-å¾ªç¯è¯­æ³•ï¼Ÿ\"><a href=\"#Shell-è„šæœ¬ä¸­-while-å¾ªç¯è¯­æ³•ï¼Ÿ\" class=\"headerlink\" title=\"Shell è„šæœ¬ä¸­ while å¾ªç¯è¯­æ³•ï¼Ÿ\"></a>Shell è„šæœ¬ä¸­ <code>while</code> å¾ªç¯è¯­æ³•ï¼Ÿ</h4><p>å¦‚åŒ <code>for</code> å¾ªç¯ï¼Œ<code>while</code> å¾ªç¯åªè¦æ¡ä»¶æˆç«‹å°±é‡å¤å®ƒçš„å‘½ä»¤å—ã€‚<br>ä¸åŒäº <code>for</code>å¾ªç¯ï¼Œ<code>while</code> å¾ªç¯ä¼šä¸æ–­è¿­ä»£ï¼Œç›´åˆ°å®ƒçš„æ¡ä»¶ä¸ä¸ºçœŸã€‚</p>\n<p>åŸºç¡€è¯­æ³•ï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">while</span> [ æ¡ä»¶ ]</span><br><span class=\"line\"><span class=\"keyword\">do</span></span><br><span class=\"line\">å‘½ä»¤â€¦</span><br><span class=\"line\"><span class=\"keyword\">done</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>do-while è¯­å¥çš„åŸºæœ¬æ ¼å¼ï¼Ÿ</strong></p>\n<p><code>do-while</code> è¯­å¥ç±»ä¼¼äº <code>while</code> è¯­å¥ï¼Œä½†æ£€æŸ¥æ¡ä»¶è¯­å¥ä¹‹å‰å…ˆæ‰§è¡Œå‘½ä»¤ï¼ˆLCTT è¯‘æ³¨ï¼šæ„å³è‡³å°‘æ‰§è¡Œä¸€æ¬¡ã€‚ï¼‰ã€‚ä¸‹é¢æ˜¯ç”¨ <code>do-while</code> è¯­å¥çš„è¯­æ³•ï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">do</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">å‘½ä»¤</span><br><span class=\"line\">&#125; <span class=\"keyword\">while</span> (æ¡ä»¶)</span><br></pre></td></tr></table></figure>\n\n<p><strong>Shell è„šæœ¬ä¸­ break å‘½ä»¤çš„ä½œç”¨ï¼Ÿ</strong></p>\n<p><code>break</code> å‘½ä»¤ä¸€ä¸ªç®€å•çš„ç”¨é€”æ˜¯é€€å‡ºæ‰§è¡Œä¸­çš„å¾ªç¯ã€‚æˆ‘ä»¬å¯ä»¥åœ¨ <code>while</code> å’Œ <code>until</code> å¾ªç¯ä¸­ä½¿ç”¨ <code>break</code> å‘½ä»¤è·³å‡ºå¾ªç¯ã€‚</p>\n<p><strong>Shell è„šæœ¬ä¸­ continue å‘½ä»¤çš„ä½œç”¨ï¼Ÿ</strong></p>\n<p><code>continue</code> å‘½ä»¤ä¸åŒäº <code>break</code> å‘½ä»¤ï¼Œå®ƒåªè·³å‡ºå½“å‰å¾ªç¯çš„è¿­ä»£ï¼Œè€Œä¸æ˜¯æ•´ä¸ªå¾ªç¯ã€‚<code>continue</code> å‘½ä»¤å¾ˆå¤šæ—¶å€™æ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œä¾‹å¦‚é”™è¯¯å‘ç”Ÿï¼Œä½†æˆ‘ä»¬ä¾ç„¶å¸Œæœ›ç»§ç»­æ‰§è¡Œå¤§å¾ªç¯çš„æ—¶å€™ã€‚</p>\n<h4 id=\"å¦‚ä½•ä½¿è„šæœ¬å¯æ‰§è¡Œ\"><a href=\"#å¦‚ä½•ä½¿è„šæœ¬å¯æ‰§è¡Œ\" class=\"headerlink\" title=\"å¦‚ä½•ä½¿è„šæœ¬å¯æ‰§è¡Œ?\"></a>å¦‚ä½•ä½¿è„šæœ¬å¯æ‰§è¡Œ?</h4><p>ä½¿ç”¨ chmod å‘½ä»¤æ¥ä½¿è„šæœ¬å¯æ‰§è¡Œã€‚ä¾‹å­å¦‚ä¸‹ï¼š<code>chmod a+x myscript.sh</code> ã€‚</p>\n<p><strong>#!&#x2F;bin&#x2F;bash çš„ä½œç”¨ï¼Ÿ</strong></p>\n<p><code>#!/bin/bash</code> æ˜¯ Shell è„šæœ¬çš„ç¬¬ä¸€è¡Œï¼Œç§°ä¸ºé‡Šä¼´ï¼ˆshebangï¼‰è¡Œã€‚</p>\n<ul>\n<li>è¿™é‡Œ <code>#</code> ç¬¦å·å«åš hash ï¼Œè€Œ <code>!</code> å«åš bangã€‚</li>\n<li>å®ƒçš„æ„æ€æ˜¯å‘½ä»¤é€šè¿‡ <code>/bin/bash</code> æ¥æ‰§è¡Œã€‚</li>\n</ul>\n<p><strong>å¦‚ä½•è°ƒè¯• Shellè„šæœ¬ï¼Ÿ</strong></p>\n<ul>\n<li>ä½¿ç”¨ <code>-x&#39;</code> æ•°ï¼ˆ<code>sh -x myscript.sh</code>ï¼‰å¯ä»¥è°ƒè¯• Shell è„šæœ¬ã€‚</li>\n<li>å¦ä¸€ä¸ªç§æ–¹æ³•æ˜¯ä½¿ç”¨ <code>-nv</code> å‚æ•°(<code>sh -nv myscript.sh</code>)ã€‚</li>\n</ul>\n<p><strong>å¦‚ä½•å°†æ ‡å‡†è¾“å‡ºå’Œé”™è¯¯è¾“å‡ºåŒæ—¶é‡å®šå‘åˆ°åŒä¸€ä½ç½®?</strong></p>\n<ul>\n<li>æ–¹æ³•ä¸€ï¼š<code>2&gt;&amp;1 (å¦‚## ls /usr/share/doc &gt; out.txt 2&gt;&amp;1 )</code> ã€‚</li>\n<li>æ–¹æ³•äºŒï¼š<code>&amp;&gt; (å¦‚## ls /usr/share/doc &amp;&gt; out.txt )</code> ã€‚</li>\n</ul>\n<p><strong>åœ¨ Shell è„šæœ¬ä¸­ï¼Œå¦‚ä½•æµ‹è¯•æ–‡ä»¶ï¼Ÿ</strong></p>\n<p>test å‘½ä»¤å¯ä»¥ç”¨æ¥æµ‹è¯•æ–‡ä»¶ã€‚åŸºç¡€ç”¨æ³•å¦‚ä¸‹è¡¨æ ¼ï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Test         ç”¨æ³•</span><br><span class=\"line\">-d æ–‡ä»¶å    å¦‚æœæ–‡ä»¶å­˜åœ¨å¹¶ä¸”æ˜¯ç›®å½•ï¼Œè¿”å›<span class=\"literal\">true</span></span><br><span class=\"line\">-e æ–‡ä»¶å    å¦‚æœæ–‡ä»¶å­˜åœ¨ï¼Œè¿”å›<span class=\"literal\">true</span></span><br><span class=\"line\">-f æ–‡ä»¶å    å¦‚æœæ–‡ä»¶å­˜åœ¨å¹¶ä¸”æ˜¯æ™®é€šæ–‡ä»¶ï¼Œè¿”å›<span class=\"literal\">true</span></span><br><span class=\"line\">-r æ–‡ä»¶å    å¦‚æœæ–‡ä»¶å­˜åœ¨å¹¶å¯è¯»ï¼Œè¿”å›<span class=\"literal\">true</span></span><br><span class=\"line\">-s æ–‡ä»¶å    å¦‚æœæ–‡ä»¶å­˜åœ¨å¹¶ä¸”ä¸ä¸ºç©ºï¼Œè¿”å›<span class=\"literal\">true</span></span><br><span class=\"line\">-w æ–‡ä»¶å    å¦‚æœæ–‡ä»¶å­˜åœ¨å¹¶å¯å†™ï¼Œè¿”å›<span class=\"literal\">true</span></span><br><span class=\"line\">-x æ–‡ä»¶å    å¦‚æœæ–‡ä»¶å­˜åœ¨å¹¶å¯æ‰§è¡Œï¼Œè¿”å›<span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"åœ¨-Shell-è„šæœ¬å¦‚ä½•å®šä¹‰å‡½æ•°å‘¢ï¼Ÿ\"><a href=\"#åœ¨-Shell-è„šæœ¬å¦‚ä½•å®šä¹‰å‡½æ•°å‘¢ï¼Ÿ\" class=\"headerlink\" title=\"åœ¨ Shell è„šæœ¬å¦‚ä½•å®šä¹‰å‡½æ•°å‘¢ï¼Ÿ\"></a>åœ¨ Shell è„šæœ¬å¦‚ä½•å®šä¹‰å‡½æ•°å‘¢ï¼Ÿ</h4><p>å‡½æ•°æ˜¯æ‹¥æœ‰åå­—çš„ä»£ç å—ã€‚å½“æˆ‘ä»¬å®šä¹‰ä»£ç å—ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨æˆ‘ä»¬çš„è„šæœ¬è°ƒç”¨å‡½æ•°åå­—ï¼Œè¯¥å—å°±ä¼šè¢«æ‰§è¡Œã€‚ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"function\"><span class=\"title\">diskusage</span></span> () &#123; <span class=\"built_in\">df</span> -h ; &#125;</span><br><span class=\"line\">è¯‘æ³¨ï¼šä¸‹é¢æ˜¯æˆ‘ç»™çš„shellå‡½æ•°è¯­æ³•ï¼ŒåŸæ–‡æ²¡æœ‰</span><br><span class=\"line\">[ <span class=\"keyword\">function</span> ] å‡½æ•°å [()]</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">å‘½ä»¤;</span><br><span class=\"line\">[<span class=\"built_in\">return</span> int;]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>å¦‚ä½•è®© Shell å°±è„šæœ¬å¾—åˆ°æ¥è‡ªç»ˆç«¯çš„è¾“å…¥?</strong></p>\n<p>read å‘½ä»¤å¯ä»¥è¯»å–æ¥è‡ªç»ˆç«¯ï¼ˆä½¿ç”¨é”®ç›˜ï¼‰çš„æ•°æ®ã€‚read å‘½ä»¤å¾—åˆ°ç”¨æˆ·çš„è¾“å…¥å¹¶ç½®äºä½ ç»™å‡ºçš„å˜é‡ä¸­ã€‚ä¾‹å­å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">## vi /tmp/test.sh</span></span><br><span class=\"line\"><span class=\"comment\">#!/bin/bash</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> â€˜Please enter your nameâ€™</span><br><span class=\"line\"><span class=\"built_in\">read</span> name</span><br><span class=\"line\"><span class=\"built_in\">echo</span> â€œMy Name is <span class=\"variable\">$name</span>â€</span><br><span class=\"line\"><span class=\"comment\">## ./test.sh</span></span><br><span class=\"line\">Please enter your name</span><br><span class=\"line\">ThinkWon</span><br><span class=\"line\">My Name is ThinkWon</span><br></pre></td></tr></table></figure>\n\n<p><strong>å¦‚ä½•æ‰§è¡Œç®—æœ¯è¿ç®—ï¼Ÿ</strong></p>\n<p>æœ‰ä¸¤ç§æ–¹æ³•æ¥æ‰§è¡Œç®—æœ¯è¿ç®—ï¼š</p>\n<ul>\n<li>1ã€ä½¿ç”¨ expr å‘½ä»¤ï¼š<code>## expr 5 + 2</code> ã€‚</li>\n<li>2ã€ç”¨ä¸€ä¸ªç¾å…ƒç¬¦å·å’Œæ–¹æ‹¬å·ï¼ˆ<code>$[ è¡¨è¾¾å¼ ]</code>ï¼‰ï¼š<code>test=$[16 + 4] ; test=$[16 + 4]</code> ã€‚</li>\n</ul>\n<h3 id=\"ç¼–ç¨‹é¢˜\"><a href=\"#ç¼–ç¨‹é¢˜\" class=\"headerlink\" title=\"ç¼–ç¨‹é¢˜\"></a>ç¼–ç¨‹é¢˜</h3><h4 id=\"åˆ¤æ–­ä¸€æ–‡ä»¶æ˜¯ä¸æ˜¯å­—ç¬¦è®¾å¤‡æ–‡ä»¶ï¼Œå¦‚æœæ˜¯å°†å…¶æ‹·è´åˆ°-dev-ç›®å½•ä¸‹ï¼Ÿ\"><a href=\"#åˆ¤æ–­ä¸€æ–‡ä»¶æ˜¯ä¸æ˜¯å­—ç¬¦è®¾å¤‡æ–‡ä»¶ï¼Œå¦‚æœæ˜¯å°†å…¶æ‹·è´åˆ°-dev-ç›®å½•ä¸‹ï¼Ÿ\" class=\"headerlink\" title=\"åˆ¤æ–­ä¸€æ–‡ä»¶æ˜¯ä¸æ˜¯å­—ç¬¦è®¾å¤‡æ–‡ä»¶ï¼Œå¦‚æœæ˜¯å°†å…¶æ‹·è´åˆ° /dev ç›®å½•ä¸‹ï¼Ÿ\"></a>åˆ¤æ–­ä¸€æ–‡ä»¶æ˜¯ä¸æ˜¯å­—ç¬¦è®¾å¤‡æ–‡ä»¶ï¼Œå¦‚æœæ˜¯å°†å…¶æ‹·è´åˆ° <code>/dev</code> ç›®å½•ä¸‹ï¼Ÿ</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/bash</span></span><br><span class=\"line\"><span class=\"built_in\">read</span> -p <span class=\"string\">&quot;Input file name: &quot;</span> FILENAME</span><br><span class=\"line\"><span class=\"keyword\">if</span> [ -c <span class=\"string\">&quot;<span class=\"variable\">$FILENAME</span>&quot;</span> ];<span class=\"keyword\">then</span></span><br><span class=\"line\">ã€€ã€€<span class=\"built_in\">cp</span> <span class=\"variable\">$FILENAME</span> /dev</span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"æ·»åŠ ä¸€ä¸ªæ–°ç»„ä¸º-class1-ï¼Œç„¶åæ·»åŠ å±äºè¿™ä¸ªç»„çš„-30-ä¸ªç”¨æˆ·ï¼Œç”¨æˆ·åçš„å½¢å¼ä¸º-stdxx-ï¼Œå…¶ä¸­-xx-ä»-01-åˆ°-30-ï¼Ÿ\"><a href=\"#æ·»åŠ ä¸€ä¸ªæ–°ç»„ä¸º-class1-ï¼Œç„¶åæ·»åŠ å±äºè¿™ä¸ªç»„çš„-30-ä¸ªç”¨æˆ·ï¼Œç”¨æˆ·åçš„å½¢å¼ä¸º-stdxx-ï¼Œå…¶ä¸­-xx-ä»-01-åˆ°-30-ï¼Ÿ\" class=\"headerlink\" title=\"æ·»åŠ ä¸€ä¸ªæ–°ç»„ä¸º class1 ï¼Œç„¶åæ·»åŠ å±äºè¿™ä¸ªç»„çš„ 30 ä¸ªç”¨æˆ·ï¼Œç”¨æˆ·åçš„å½¢å¼ä¸º stdxx ï¼Œå…¶ä¸­ xx ä» 01 åˆ° 30 ï¼Ÿ\"></a>æ·»åŠ ä¸€ä¸ªæ–°ç»„ä¸º class1 ï¼Œç„¶åæ·»åŠ å±äºè¿™ä¸ªç»„çš„ 30 ä¸ªç”¨æˆ·ï¼Œç”¨æˆ·åçš„å½¢å¼ä¸º stdxx ï¼Œå…¶ä¸­ xx ä» 01 åˆ° 30 ï¼Ÿ</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/bash</span></span><br><span class=\"line\">groupadd class1</span><br><span class=\"line\"><span class=\"keyword\">for</span>((i=<span class=\"number\">1</span>;i&lt;<span class=\"number\">31</span>;i++))</span><br><span class=\"line\"><span class=\"keyword\">do</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> [ <span class=\"variable\">$i</span> -le 10 ];<span class=\"keyword\">then</span></span><br><span class=\"line\">                useradd -g class1 std0<span class=\"variable\">$i</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">                useradd -g class1 std<span class=\"variable\">$i</span></span><br><span class=\"line\">        <span class=\"keyword\">fi</span></span><br><span class=\"line\"><span class=\"keyword\">done</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>ç¼–å†™ Shell ç¨‹åºï¼Œå®ç°è‡ªåŠ¨åˆ é™¤ 50 ä¸ªè´¦å·çš„åŠŸèƒ½ï¼Œè´¦å·åä¸ºstud1 è‡³ stud50 ï¼Ÿ</strong></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/bash</span></span><br><span class=\"line\"><span class=\"keyword\">for</span>((i=<span class=\"number\">1</span>;i&lt;<span class=\"number\">51</span>;i++))</span><br><span class=\"line\"><span class=\"keyword\">do</span></span><br><span class=\"line\">                userdel -r stud<span class=\"variable\">$i</span></span><br><span class=\"line\"><span class=\"keyword\">done</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"å†™ä¸€ä¸ª-sed-å‘½ä»¤ï¼Œä¿®æ”¹-tmp-input-txt-æ–‡ä»¶çš„å†…å®¹ï¼Ÿ\"><a href=\"#å†™ä¸€ä¸ª-sed-å‘½ä»¤ï¼Œä¿®æ”¹-tmp-input-txt-æ–‡ä»¶çš„å†…å®¹ï¼Ÿ\" class=\"headerlink\" title=\"å†™ä¸€ä¸ª sed å‘½ä»¤ï¼Œä¿®æ”¹ /tmp/input.txt æ–‡ä»¶çš„å†…å®¹ï¼Ÿ\"></a>å†™ä¸€ä¸ª sed å‘½ä»¤ï¼Œä¿®æ”¹ <code>/tmp/input.txt</code> æ–‡ä»¶çš„å†…å®¹ï¼Ÿ</h4><p>è¦æ±‚ï¼š</p>\n<ul>\n<li>åˆ é™¤æ‰€æœ‰ç©ºè¡Œã€‚</li>\n<li>ä¸€è¡Œä¸­ï¼Œå¦‚æœåŒ…å« â€œ11111â€ï¼Œåˆ™åœ¨ â€œ11111â€ å‰é¢æ’å…¥ â€œAAAâ€ï¼Œåœ¨ â€œ11111â€ åé¢æ’å…¥ â€œBBBâ€ ã€‚æ¯”å¦‚ï¼šå°†å†…å®¹ä¸º 0000111112222 çš„ä¸€è¡Œæ”¹ä¸º 0000AAA11111BBB2222 ã€‚</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@~]<span class=\"comment\">## cat -n /tmp/input.txt</span></span><br><span class=\"line\">     1  000011111222</span><br><span class=\"line\">     2</span><br><span class=\"line\">     3  000011111222222</span><br><span class=\"line\">     4  11111000000222</span><br><span class=\"line\">     5</span><br><span class=\"line\">     6</span><br><span class=\"line\">     7  111111111111122222222222</span><br><span class=\"line\">     8  2211111111</span><br><span class=\"line\">     9  112222222</span><br><span class=\"line\">    10  1122</span><br><span class=\"line\">    11</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## åˆ é™¤æ‰€æœ‰ç©ºè¡Œå‘½ä»¤</span></span><br><span class=\"line\">[root@~]<span class=\"comment\">## sed &#x27;/^$/d&#x27; /tmp/input.txt</span></span><br><span class=\"line\">000011111222</span><br><span class=\"line\">000011111222222</span><br><span class=\"line\">11111000000222</span><br><span class=\"line\">111111111111122222222222</span><br><span class=\"line\">2211111111</span><br><span class=\"line\">112222222</span><br><span class=\"line\">1122</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## æ’å…¥æŒ‡å®šçš„å­—ç¬¦</span></span><br><span class=\"line\">[root@~]<span class=\"comment\">## sed &#x27;s#\\(11111\\)#AAA\\1BBB#g&#x27; /tmp/input.txt</span></span><br><span class=\"line\">0000AAA11111BBB222</span><br><span class=\"line\">0000AAA11111BBB222222</span><br><span class=\"line\">AAA11111BBB000000222</span><br><span class=\"line\">AAA11111BBBAAA11111BBB11122222222222</span><br><span class=\"line\">22AAA11111BBB111</span><br><span class=\"line\">112222222</span><br><span class=\"line\">1122</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"å®æˆ˜\"><a href=\"#å®æˆ˜\" class=\"headerlink\" title=\"å®æˆ˜\"></a>å®æˆ˜</h2><h3 id=\"å¦‚ä½•é€‰æ‹©-Linux-æ“ä½œç³»ç»Ÿç‰ˆæœ¬\"><a href=\"#å¦‚ä½•é€‰æ‹©-Linux-æ“ä½œç³»ç»Ÿç‰ˆæœ¬\" class=\"headerlink\" title=\"å¦‚ä½•é€‰æ‹© Linux æ“ä½œç³»ç»Ÿç‰ˆæœ¬?\"></a>å¦‚ä½•é€‰æ‹© Linux æ“ä½œç³»ç»Ÿç‰ˆæœ¬?</h3><p>ä¸€èˆ¬æ¥è®²ï¼Œæ¡Œé¢ç”¨æˆ·é¦–é€‰ Ubuntu ï¼›æœåŠ¡å™¨é¦–é€‰ RHEL æˆ– CentOS ï¼Œä¸¤è€…ä¸­é¦–é€‰ CentOS ã€‚</p>\n<p>æ ¹æ®å…·ä½“è¦æ±‚ï¼š</p>\n<ul>\n<li><p>å®‰å…¨æ€§è¦æ±‚è¾ƒé«˜ï¼Œåˆ™é€‰æ‹© Debian æˆ–è€… FreeBSD ã€‚</p>\n</li>\n<li><p>éœ€è¦ä½¿ç”¨æ•°æ®åº“é«˜çº§æœåŠ¡å’Œç”µå­é‚®ä»¶ç½‘ç»œåº”ç”¨çš„ç”¨æˆ·å¯ä»¥é€‰æ‹© SUSE ã€‚</p>\n</li>\n<li><p>æƒ³è¦æ–°æŠ€æœ¯æ–°åŠŸèƒ½å¯ä»¥é€‰æ‹© Feddora ï¼ŒFeddora æ˜¯ RHEL å’Œ CentOS çš„ä¸€ä¸ªæµ‹è¯•ç‰ˆå’Œé¢„å‘å¸ƒç‰ˆæœ¬ã€‚</p>\n</li>\n<li><p>ã€é‡ç‚¹ã€‘<strong>æ ¹æ®ç°æœ‰çŠ¶å†µï¼Œç»å¤§å¤šæ•°äº’è”ç½‘å…¬å¸é€‰æ‹© CentOS ã€‚ç°åœ¨æ¯”è¾ƒå¸¸ç”¨çš„æ˜¯ 6 ç³»åˆ—ï¼Œç°åœ¨å¸‚åœºå æœ‰å¤§æ¦‚ä¸€åŠå·¦å³ã€‚å¦å¤–çš„åŸå› æ˜¯ CentOS æ›´ä¾§é‡æœåŠ¡å™¨é¢†åŸŸï¼Œå¹¶ä¸”æ— ç‰ˆæƒçº¦æŸ</strong>ã€‚</p>\n<blockquote>\n<p>CentOS 7 ç³»åˆ—ï¼Œä¹Ÿæ…¢æ…¢ä½¿ç”¨çš„ä¼šæ¯”è¾ƒå¤šäº†ã€‚</p>\n</blockquote>\n</li>\n</ul>\n<h3 id=\"å¦‚ä½•è§„åˆ’ä¸€å°-Linux-ä¸»æœºï¼Œæ­¥éª¤æ˜¯æ€æ ·ï¼Ÿ\"><a href=\"#å¦‚ä½•è§„åˆ’ä¸€å°-Linux-ä¸»æœºï¼Œæ­¥éª¤æ˜¯æ€æ ·ï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•è§„åˆ’ä¸€å° Linux ä¸»æœºï¼Œæ­¥éª¤æ˜¯æ€æ ·ï¼Ÿ\"></a>å¦‚ä½•è§„åˆ’ä¸€å° Linux ä¸»æœºï¼Œæ­¥éª¤æ˜¯æ€æ ·ï¼Ÿ</h3><p>1ã€ç¡®å®šæœºå™¨æ˜¯åšä»€ä¹ˆç”¨çš„ï¼Œæ¯”å¦‚æ˜¯åš WEB ã€DBã€è¿˜æ˜¯æ¸¸æˆæœåŠ¡å™¨ã€‚</p>\n<blockquote>\n<p>ä¸åŒçš„ç”¨é€”ï¼Œæœºå™¨çš„é…ç½®ä¼šæœ‰æ‰€ä¸åŒã€‚</p>\n</blockquote>\n<p>2ã€ç¡®å®šå¥½ä¹‹åï¼Œå°±è¦å®šç³»ç»Ÿéœ€è¦æ€ä¹ˆå®‰è£…ï¼Œé»˜è®¤å®‰è£…å“ªäº›ç³»ç»Ÿã€åˆ†åŒºæ€ä¹ˆåšã€‚</p>\n<p>3ã€éœ€è¦ä¼˜åŒ–ç³»ç»Ÿçš„å“ªäº›å‚æ•°ï¼Œéœ€è¦åˆ›å»ºå“ªäº›ç”¨æˆ·ç­‰ç­‰çš„ã€‚</p>\n<h3 id=\"è¯·é—®å½“ç”¨æˆ·åé¦ˆç½‘ç«™è®¿é—®æ…¢ï¼Œä½ ä¼šå¦‚ä½•å¤„ç†ï¼Ÿ\"><a href=\"#è¯·é—®å½“ç”¨æˆ·åé¦ˆç½‘ç«™è®¿é—®æ…¢ï¼Œä½ ä¼šå¦‚ä½•å¤„ç†ï¼Ÿ\" class=\"headerlink\" title=\"è¯·é—®å½“ç”¨æˆ·åé¦ˆç½‘ç«™è®¿é—®æ…¢ï¼Œä½ ä¼šå¦‚ä½•å¤„ç†ï¼Ÿ\"></a>è¯·é—®å½“ç”¨æˆ·åé¦ˆç½‘ç«™è®¿é—®æ…¢ï¼Œä½ ä¼šå¦‚ä½•å¤„ç†ï¼Ÿ</h3><p><strong>æœ‰å“ªäº›æ–¹é¢çš„å› ç´ ä¼šå¯¼è‡´ç½‘ç«™ç½‘ç«™è®¿é—®æ…¢ï¼Ÿ</strong></p>\n<p>1ã€æœåŠ¡å™¨å‡ºå£å¸¦å®½ä¸å¤Ÿç”¨</p>\n<blockquote>\n<ul>\n<li>æœ¬èº«æœåŠ¡å™¨è´­ä¹°çš„å‡ºå£å¸¦å®½æ¯”è¾ƒå°ã€‚ä¸€æ—¦å¹¶å‘é‡å¤§çš„è¯ï¼Œå°±ä¼šé€ æˆåˆ†ç»™æ¯ä¸ªç”¨æˆ·çš„å‡ºå£å¸¦å®½å°±å°ï¼Œè®¿é—®é€Ÿåº¦è‡ªç„¶å°±ä¼šæ…¢ã€‚</li>\n<li>è·¨è¿è¥å•†ç½‘ç»œå¯¼è‡´å¸¦å®½ç¼©å‡ã€‚ä¾‹å¦‚ï¼Œå…¬å¸ç½‘ç«™æ”¾åœ¨ç”µä¿¡çš„ç½‘ç»œä¸Šï¼Œé‚£ä¹ˆå®¢æˆ·è¿™è¾¹å¯¹æ¥æ˜¯é•¿åŸå®½å¸¦æˆ–è”é€šï¼Œè¿™ä¹Ÿå¯èƒ½å¯¼è‡´å¸¦å®½çš„ç¼©å‡ã€‚</li>\n</ul>\n</blockquote>\n<p>2ã€æœåŠ¡å™¨è´Ÿè½½è¿‡å¤§ï¼Œå¯¼è‡´å“åº”ä¸è¿‡æ¥</p>\n<blockquote>\n<p>å¯ä»¥ä»ä¸¤ä¸ªæ–¹é¢å…¥æ‰‹åˆ†æï¼š</p>\n<ul>\n<li>åˆ†æç³»ç»Ÿè´Ÿè½½ï¼Œä½¿ç”¨ w å‘½ä»¤æˆ–è€… uptime å‘½ä»¤æŸ¥çœ‹ç³»ç»Ÿè´Ÿè½½ã€‚å¦‚æœè´Ÿè½½å¾ˆé«˜ï¼Œåˆ™ä½¿ç”¨ top å‘½ä»¤æŸ¥çœ‹ CPU ï¼ŒMEM ç­‰å ç”¨æƒ…å†µï¼Œè¦ä¹ˆæ˜¯ CPU ç¹å¿™ï¼Œè¦ä¹ˆæ˜¯å†…å­˜ä¸å¤Ÿã€‚</li>\n<li>å¦‚æœè¿™äºŒè€…éƒ½æ­£å¸¸ï¼Œå†å»ä½¿ç”¨ sar å‘½ä»¤åˆ†æç½‘å¡æµé‡ï¼Œåˆ†ææ˜¯ä¸æ˜¯é­åˆ°äº†æ”»å‡»ã€‚ä¸€æ—¦åˆ†æå‡ºé—®é¢˜çš„åŸå› ï¼Œé‡‡å–å¯¹åº”çš„æªæ–½è§£å†³ï¼Œå¦‚å†³å®šè¦ä¸è¦æ€æ­»ä¸€äº›è¿›ç¨‹ï¼Œæˆ–è€…ç¦æ­¢ä¸€äº›è®¿é—®ç­‰ã€‚</li>\n</ul>\n</blockquote>\n<p>3ã€æ•°æ®åº“ç“¶é¢ˆ</p>\n<blockquote>\n<ul>\n<li>å¦‚æœæ…¢æŸ¥è¯¢æ¯”è¾ƒå¤šã€‚é‚£ä¹ˆå°±è¦å¼€å‘äººå‘˜æˆ– DBA ååŠ©è¿›è¡Œ SQL è¯­å¥çš„ä¼˜åŒ–ã€‚</li>\n<li>å¦‚æœæ•°æ®åº“å“åº”æ…¢ï¼Œè€ƒè™‘å¯ä»¥åŠ ä¸€ä¸ªæ•°æ®åº“ç¼“å­˜ï¼Œå¦‚ Redis ç­‰ã€‚ç„¶åï¼Œä¹Ÿå¯ä»¥æ­å»º MySQL ä¸»ä»ï¼Œä¸€å° MySQL æœåŠ¡å™¨è´Ÿè´£å†™ï¼Œå…¶ä»–å‡ å°ä»æ•°æ®åº“è´Ÿè´£è¯»ã€‚</li>\n</ul>\n</blockquote>\n<p>4ã€ç½‘ç«™å¼€å‘ä»£ç æ²¡æœ‰ä¼˜åŒ–å¥½</p>\n<blockquote>\n<ul>\n<li>ä¾‹å¦‚ SQL è¯­å¥æ²¡æœ‰ä¼˜åŒ–ï¼Œå¯¼è‡´æ•°æ®åº“è¯»å†™ç›¸å½“è€—æ—¶ã€‚</li>\n</ul>\n</blockquote>\n<p><strong>é’ˆå¯¹ç½‘ç«™è®¿é—®æ…¢ï¼Œæ€ä¹ˆå»æ’æŸ¥ï¼Ÿ</strong></p>\n<p>1ã€é¦–å…ˆè¦ç¡®å®šæ˜¯ç”¨æˆ·ç«¯è¿˜æ˜¯æœåŠ¡ç«¯çš„é—®é¢˜ã€‚å½“æ¥åˆ°ç”¨æˆ·åé¦ˆè®¿é—®æ…¢ï¼Œé‚£è¾¹è‡ªå·±ç«‹å³è®¿é—®ç½‘ç«™çœ‹çœ‹ï¼Œå¦‚æœè‡ªå·±è¿™è¾¹è®¿é—®å¿«ï¼ŒåŸºæœ¬æ–­å®šæ˜¯ç”¨æˆ·ç«¯é—®é¢˜ï¼Œå°±éœ€è¦è€å¿ƒè·Ÿå®¢æˆ·è§£é‡Šï¼ŒååŠ©å®¢æˆ·è§£å†³é—®é¢˜ã€‚</p>\n<blockquote>\n<p>ä¸è¦ä¸Šæ¥å°±çœ‹æœåŠ¡ç«¯çš„é—®é¢˜ã€‚ä¸€å®šè¦ä»æºå¤´å¼€å§‹ï¼Œé€æ­¥é€æ­¥å¾€ä¸‹ã€‚</p>\n</blockquote>\n<p>2ã€å¦‚æœè®¿é—®ä¹Ÿæ…¢ï¼Œé‚£ä¹ˆå¯ä»¥åˆ©ç”¨æµè§ˆå™¨çš„è°ƒè¯•åŠŸèƒ½ï¼Œçœ‹çœ‹åŠ è½½é‚£ä¸€é¡¹æ•°æ®æ¶ˆè€—æ—¶é—´è¿‡å¤šï¼Œæ˜¯å›¾ç‰‡åŠ è½½æ…¢ï¼Œè¿˜æ˜¯æŸäº›æ•°æ®åŠ è½½æ…¢ã€‚</p>\n<p>3ã€é’ˆå¯¹æœåŠ¡å™¨è´Ÿè½½æƒ…å†µã€‚æŸ¥çœ‹æœåŠ¡å™¨ç¡¬ä»¶(ç½‘ç»œã€CPUã€å†…å­˜)çš„æ¶ˆè€—æƒ…å†µã€‚å¦‚æœæ˜¯è´­ä¹°çš„äº‘ä¸»æœºï¼Œæ¯”å¦‚é˜¿é‡Œäº‘ï¼Œå¯ä»¥ç™»å½•é˜¿é‡Œäº‘å¹³å°æä¾›å„æ–¹é¢çš„ç›‘æ§ï¼Œæ¯”å¦‚ CPUã€å†…å­˜ã€å¸¦å®½çš„ä½¿ç”¨æƒ…å†µã€‚</p>\n<p>4ã€å¦‚æœå‘ç°ç¡¬ä»¶èµ„æºæ¶ˆè€—éƒ½ä¸é«˜ï¼Œé‚£ä¹ˆå°±éœ€è¦é€šè¿‡æŸ¥æ—¥å¿—ï¼Œæ¯”å¦‚çœ‹çœ‹ MySQL æ…¢æŸ¥è¯¢çš„æ—¥å¿—ï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯æŸæ¡ SQL è¯­å¥æŸ¥è¯¢æ…¢ï¼Œå¯¼è‡´ç½‘ç«™è®¿é—®æ…¢ã€‚</p>\n<p><strong>æ€ä¹ˆå»è§£å†³ï¼Ÿ</strong></p>\n<p>1ã€å¦‚æœæ˜¯å‡ºå£å¸¦å®½é—®é¢˜ï¼Œé‚£ä¹ˆä¹…ç”³è¯·åŠ å¤§å‡ºå£å¸¦å®½ã€‚</p>\n<p>2ã€å¦‚æœæ…¢æŸ¥è¯¢æ¯”è¾ƒå¤šï¼Œé‚£ä¹ˆå°±è¦å¼€å‘äººå‘˜æˆ– DBA ååŠ©è¿›è¡Œ SQL è¯­å¥çš„ä¼˜åŒ–ã€‚</p>\n<p>3ã€å¦‚æœæ•°æ®åº“å“åº”æ…¢ï¼Œè€ƒè™‘å¯ä»¥åŠ ä¸€ä¸ªæ•°æ®åº“ç¼“å­˜ï¼Œå¦‚ Redis ç­‰ç­‰ã€‚ç„¶åä¹Ÿå¯ä»¥æ­å»º MySQL ä¸»ä»ï¼Œä¸€å° MySQL æœåŠ¡å™¨è´Ÿè´£å†™ï¼Œå…¶ä»–å‡ å°ä»æ•°æ®åº“è´Ÿè´£è¯»ã€‚</p>\n<p>4ã€ç”³è¯·è´­ä¹° CDN æœåŠ¡ï¼ŒåŠ è½½ç”¨æˆ·çš„è®¿é—®ã€‚</p>\n<p>5ã€å¦‚æœè®¿é—®è¿˜æ¯”è¾ƒæ…¢ï¼Œé‚£å°±éœ€è¦ä»æ•´ä½“æ¶æ„ä¸Šè¿›è¡Œä¼˜åŒ–å’¯ã€‚åšåˆ°ä¸“è§’è‰²ä¸“ç”¨ï¼Œå¤šå°æœåŠ¡å™¨æä¾›åŒä¸€ä¸ªæœåŠ¡ã€‚</p>\n<h3 id=\"Linux-æ€§èƒ½è°ƒä¼˜éƒ½æœ‰å“ªå‡ ç§æ–¹æ³•ï¼Ÿ\"><a href=\"#Linux-æ€§èƒ½è°ƒä¼˜éƒ½æœ‰å“ªå‡ ç§æ–¹æ³•ï¼Ÿ\" class=\"headerlink\" title=\"Linux æ€§èƒ½è°ƒä¼˜éƒ½æœ‰å“ªå‡ ç§æ–¹æ³•ï¼Ÿ\"></a>Linux æ€§èƒ½è°ƒä¼˜éƒ½æœ‰å“ªå‡ ç§æ–¹æ³•ï¼Ÿ</h3><p>1ã€Disabling daemons (å…³é—­ daemons)ã€‚</p>\n<p>2ã€Shutting down the GUI (å…³é—­ GUI)ã€‚</p>\n<p>3ã€Changing kernel parameters (æ”¹å˜å†…æ ¸å‚æ•°)ã€‚</p>\n<p>4ã€Kernel parameters (å†…æ ¸å‚æ•°)ã€‚</p>\n<p>5ã€Tuning the processor subsystem (å¤„ç†å™¨å­ç³»ç»Ÿè°ƒä¼˜)ã€‚</p>\n<p>6ã€Tuning the memory subsystem (å†…å­˜å­ç³»ç»Ÿè°ƒä¼˜)ã€‚</p>\n<p>7ã€Tuning the file system (æ–‡ä»¶ç³»ç»Ÿå­ç³»ç»Ÿè°ƒä¼˜)ã€‚</p>\n<p>8ã€Tuning the network subsystemï¼ˆç½‘ç»œå­ç³»ç»Ÿè°ƒä¼˜)ã€‚</p>\n<h2 id=\"æ–‡ä»¶ç®¡ç†å‘½ä»¤\"><a href=\"#æ–‡ä»¶ç®¡ç†å‘½ä»¤\" class=\"headerlink\" title=\"æ–‡ä»¶ç®¡ç†å‘½ä»¤\"></a>æ–‡ä»¶ç®¡ç†å‘½ä»¤</h2><h3 id=\"cat-å‘½ä»¤\"><a href=\"#cat-å‘½ä»¤\" class=\"headerlink\" title=\"cat å‘½ä»¤\"></a>cat å‘½ä»¤</h3><p>cat å‘½ä»¤ç”¨äºè¿æ¥æ–‡ä»¶å¹¶æ‰“å°åˆ°æ ‡å‡†è¾“å‡ºè®¾å¤‡ä¸Šã€‚</p>\n<p>cat ä¸»è¦æœ‰ä¸‰å¤§åŠŸèƒ½ï¼š</p>\n<p>1ã€ä¸€æ¬¡æ˜¾ç¤ºæ•´ä¸ªæ–‡ä»¶:</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cat</span> filename</span><br></pre></td></tr></table></figure>\n\n<p>2ã€ä»é”®ç›˜åˆ›å»ºä¸€ä¸ªæ–‡ä»¶:</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat &gt; filename</span><br></pre></td></tr></table></figure>\n\n<p>åªèƒ½åˆ›å»ºæ–°æ–‡ä»¶ï¼Œä¸èƒ½ç¼–è¾‘å·²æœ‰æ–‡ä»¶ã€‚</p>\n<p>3ã€å°†å‡ ä¸ªæ–‡ä»¶åˆå¹¶ä¸ºä¸€ä¸ªæ–‡ä»¶ï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat file1 file2 &gt; file</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>-b å¯¹éç©ºè¾“å‡ºè¡Œå·</li>\n<li>-n è¾“å‡ºæ‰€æœ‰è¡Œå·</li>\n</ul>\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰æŠŠ log2012.log çš„æ–‡ä»¶å†…å®¹åŠ ä¸Šè¡Œå·åè¾“å…¥ log2013.log è¿™ä¸ªæ–‡ä»¶é‡Œ</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat -n log2012.log &gt; log2013.log</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰æŠŠ log2012.log å’Œ log2013.log çš„æ–‡ä»¶å†…å®¹åŠ ä¸Šè¡Œå·ï¼ˆç©ºç™½è¡Œä¸åŠ ï¼‰ä¹‹åå°†å†…å®¹é™„åŠ åˆ° log.log é‡Œ</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat -b log2012.log log2013.log &gt; log.log</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"chmod-å‘½ä»¤\"><a href=\"#chmod-å‘½ä»¤\" class=\"headerlink\" title=\"chmod å‘½ä»¤\"></a>chmod å‘½ä»¤</h3><p>Linux&#x2F;Unix çš„æ–‡ä»¶è°ƒç”¨æƒé™åˆ†ä¸ºä¸‰çº§ : æ–‡ä»¶æ‹¥æœ‰è€…ã€ç¾¤ç»„ã€å…¶ä»–ã€‚åˆ©ç”¨ chmod å¯ä»¥æ§åˆ¶æ–‡ä»¶å¦‚ä½•è¢«ä»–äººæ‰€è°ƒç”¨ã€‚</p>\n<p>ç”¨äºæ”¹å˜ linux ç³»ç»Ÿæ–‡ä»¶æˆ–ç›®å½•çš„è®¿é—®æƒé™ã€‚ç”¨å®ƒæ§åˆ¶æ–‡ä»¶æˆ–ç›®å½•çš„è®¿é—®æƒé™ã€‚è¯¥å‘½ä»¤æœ‰ä¸¤ç§ç”¨æ³•ã€‚ä¸€ç§æ˜¯åŒ…å«å­—æ¯å’Œæ“ä½œç¬¦è¡¨è¾¾å¼çš„æ–‡å­—è®¾å®šæ³•ï¼›å¦ä¸€ç§æ˜¯åŒ…å«æ•°å­—çš„æ•°å­—è®¾å®šæ³•ã€‚</p>\n<p>æ¯ä¸€æ–‡ä»¶æˆ–ç›®å½•çš„è®¿é—®æƒé™éƒ½æœ‰ä¸‰ç»„ï¼Œæ¯ç»„ç”¨ä¸‰ä½è¡¨ç¤ºï¼Œåˆ†åˆ«ä¸ºæ–‡ä»¶<strong>å±ä¸»</strong>çš„è¯»ã€å†™å’Œæ‰§è¡Œæƒé™ï¼›ä¸å±ä¸»<strong>åŒç»„</strong>çš„ç”¨æˆ·çš„è¯»ã€å†™å’Œæ‰§è¡Œæƒé™ï¼›ç³»ç»Ÿä¸­<strong>å…¶ä»–ç”¨æˆ·</strong>çš„è¯»ã€å†™å’Œæ‰§è¡Œæƒé™ã€‚å¯ä½¿ç”¨ ls -l test.txt æŸ¥æ‰¾ã€‚</p>\n<p>ä»¥æ–‡ä»¶ log2012.log ä¸ºä¾‹ï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-rw-r--r-- 1 root root 296K 11-13 06:03 log2012.log</span><br></pre></td></tr></table></figure>\n\n<p>ç¬¬ä¸€åˆ—å…±æœ‰ 10 ä¸ªä½ç½®ï¼Œç¬¬ä¸€ä¸ªå­—ç¬¦æŒ‡å®šäº†æ–‡ä»¶ç±»å‹ã€‚åœ¨é€šå¸¸æ„ä¹‰ä¸Šï¼Œä¸€ä¸ªç›®å½•ä¹Ÿæ˜¯ä¸€ä¸ªæ–‡ä»¶ã€‚å¦‚æœç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯æ¨ªçº¿ï¼Œè¡¨ç¤ºæ˜¯ä¸€ä¸ªéç›®å½•çš„æ–‡ä»¶ã€‚å¦‚æœæ˜¯ dï¼Œè¡¨ç¤ºæ˜¯ä¸€ä¸ªç›®å½•ã€‚ä»ç¬¬äºŒä¸ªå­—ç¬¦å¼€å§‹åˆ°ç¬¬åä¸ª 9 ä¸ªå­—ç¬¦ï¼Œ3 ä¸ªå­—ç¬¦ä¸€ç»„ï¼Œåˆ†åˆ«è¡¨ç¤ºäº† 3 ç»„ç”¨æˆ·å¯¹æ–‡ä»¶æˆ–è€…ç›®å½•çš„æƒé™ã€‚æƒé™å­—ç¬¦ç”¨æ¨ªçº¿ä»£è¡¨ç©ºè®¸å¯ï¼Œr ä»£è¡¨åªè¯»(4)ï¼Œw ä»£è¡¨å†™(2)ï¼Œx ä»£è¡¨å¯æ‰§è¡Œ(1)ã€‚</p>\n<p><strong>å¸¸ç”¨å‚æ•°</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-c å½“å‘ç”Ÿæ”¹å˜æ—¶ï¼ŒæŠ¥å‘Šå¤„ç†ä¿¡æ¯</span><br><span class=\"line\">-R å¤„ç†æŒ‡å®šç›®å½•ä»¥åŠå…¶å­ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶</span><br></pre></td></tr></table></figure>\n\n<p>æƒé™èŒƒå›´ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">u ï¼šç›®å½•æˆ–è€…æ–‡ä»¶çš„å½“å‰çš„ç”¨æˆ·</span><br><span class=\"line\">g ï¼šç›®å½•æˆ–è€…æ–‡ä»¶çš„å½“å‰çš„ç¾¤ç»„</span><br><span class=\"line\">o ï¼šé™¤äº†ç›®å½•æˆ–è€…æ–‡ä»¶çš„å½“å‰ç”¨æˆ·æˆ–ç¾¤ç»„ä¹‹å¤–çš„ç”¨æˆ·æˆ–è€…ç¾¤ç»„</span><br><span class=\"line\">a ï¼šæ‰€æœ‰çš„ç”¨æˆ·åŠç¾¤ç»„</span><br></pre></td></tr></table></figure>\n\n<p>æƒé™ä»£å·ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">r ï¼šè¯»æƒé™ï¼Œç”¨æ•°å­—4è¡¨ç¤º</span><br><span class=\"line\">w ï¼šå†™æƒé™ï¼Œç”¨æ•°å­—2è¡¨ç¤º</span><br><span class=\"line\">x ï¼šæ‰§è¡Œæƒé™ï¼Œç”¨æ•°å­—1è¡¨ç¤º</span><br><span class=\"line\">- ï¼šåˆ é™¤æƒé™ï¼Œç”¨æ•°å­—0è¡¨ç¤º</span><br><span class=\"line\">s ï¼šç‰¹æ®Šæƒé™</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰å¢åŠ æ–‡ä»¶ t.log æ‰€æœ‰ç”¨æˆ·å¯æ‰§è¡Œæƒé™</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chmod a+x t.log</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰æ’¤é”€åŸæ¥æ‰€æœ‰çš„æƒé™ï¼Œç„¶åä½¿æ‹¥æœ‰è€…å…·æœ‰å¯è¯»æƒé™,å¹¶è¾“å‡ºå¤„ç†ä¿¡æ¯</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chmod u=r t.log -c</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ3ï¼‰ç»™ file çš„å±ä¸»åˆ†é…è¯»ã€å†™ã€æ‰§è¡Œ(7)çš„æƒé™ï¼Œç»™ file çš„æ‰€åœ¨ç»„åˆ†é…è¯»ã€æ‰§è¡Œ(5)çš„æƒé™ï¼Œç»™å…¶ä»–ç”¨æˆ·åˆ†é…æ‰§è¡Œ(1)çš„æƒé™</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chmod 751 t.log -cï¼ˆæˆ–è€…ï¼šchmod u=rwx,g=rx,o=x t.log -c</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ4ï¼‰å°† test ç›®å½•åŠå…¶å­ç›®å½•æ‰€æœ‰æ–‡ä»¶æ·»åŠ å¯è¯»æƒé™</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chmod u+r,g+r,o+r -R text/ -c</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"chown-å‘½ä»¤\"><a href=\"#chown-å‘½ä»¤\" class=\"headerlink\" title=\"chown å‘½ä»¤\"></a>chown å‘½ä»¤</h3><p>chown å°†æŒ‡å®šæ–‡ä»¶çš„æ‹¥æœ‰è€…æ”¹ä¸ºæŒ‡å®šçš„ç”¨æˆ·æˆ–ç»„ï¼Œç”¨æˆ·å¯ä»¥æ˜¯ç”¨æˆ·åæˆ–è€…ç”¨æˆ· IDï¼›ç»„å¯ä»¥æ˜¯ç»„åæˆ–è€…ç»„ IDï¼›æ–‡ä»¶æ˜¯ä»¥ç©ºæ ¼åˆ†å¼€çš„è¦æ”¹å˜æƒé™çš„æ–‡ä»¶åˆ—è¡¨ï¼Œæ”¯æŒé€šé…ç¬¦ã€‚</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-c æ˜¾ç¤ºæ›´æ”¹çš„éƒ¨åˆ†çš„ä¿¡æ¯</span><br><span class=\"line\">-R å¤„ç†æŒ‡å®šç›®å½•åŠå­ç›®å½•</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰æ”¹å˜æ‹¥æœ‰è€…å’Œç¾¤ç»„ å¹¶æ˜¾ç¤ºæ”¹å˜ä¿¡æ¯</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chown -c mail:mail log2012.log</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰æ”¹å˜æ–‡ä»¶ç¾¤ç»„</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chown -c :mail t.log</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ3ï¼‰æ”¹å˜æ–‡ä»¶å¤¹åŠå­æ–‡ä»¶ç›®å½•å±ä¸»åŠå±ç»„ä¸º mail</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chown -cR mail: test/</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"cp-å‘½ä»¤\"><a href=\"#cp-å‘½ä»¤\" class=\"headerlink\" title=\"cp å‘½ä»¤\"></a>cp å‘½ä»¤</h3><p>å°†æºæ–‡ä»¶å¤åˆ¶è‡³ç›®æ ‡æ–‡ä»¶ï¼Œæˆ–å°†å¤šä¸ªæºæ–‡ä»¶å¤åˆ¶è‡³ç›®æ ‡ç›®å½•ã€‚</p>\n<p>æ³¨æ„ï¼šå‘½ä»¤è¡Œå¤åˆ¶ï¼Œå¦‚æœç›®æ ‡æ–‡ä»¶å·²ç»å­˜åœ¨ä¼šæç¤ºæ˜¯å¦è¦†ç›–ï¼Œè€Œåœ¨ shell è„šæœ¬ä¸­ï¼Œå¦‚æœä¸åŠ  -i å‚æ•°ï¼Œåˆ™ä¸ä¼šæç¤ºï¼Œè€Œæ˜¯ç›´æ¥è¦†ç›–ï¼</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-i æç¤º</span><br><span class=\"line\">-r å¤åˆ¶ç›®å½•åŠç›®å½•å†…æ‰€æœ‰é¡¹ç›®</span><br><span class=\"line\">-a å¤åˆ¶çš„æ–‡ä»¶ä¸åŸæ–‡ä»¶æ—¶é—´ä¸€æ ·</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰å¤åˆ¶ a.txt åˆ° test ç›®å½•ä¸‹ï¼Œä¿æŒåŸæ–‡ä»¶æ—¶é—´ï¼Œå¦‚æœåŸæ–‡ä»¶å­˜åœ¨æç¤ºæ˜¯å¦è¦†ç›–ã€‚</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cp -ai a.txt test</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰ä¸º a.txt å»ºè®®ä¸€ä¸ªé“¾æ¥ï¼ˆå¿«æ·æ–¹å¼ï¼‰</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cp -s a.txt link_a.txt</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"find-å‘½ä»¤\"><a href=\"#find-å‘½ä»¤\" class=\"headerlink\" title=\"find å‘½ä»¤\"></a>find å‘½ä»¤</h3><p>ç”¨äºåœ¨æ–‡ä»¶æ ‘ä¸­æŸ¥æ‰¾æ–‡ä»¶ï¼Œå¹¶ä½œå‡ºç›¸åº”çš„å¤„ç†ã€‚</p>\n<p>å‘½ä»¤æ ¼å¼ï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">find pathname -options [-print -exec -ok ...]</span><br></pre></td></tr></table></figure>\n\n<p>å‘½ä»¤å‚æ•°ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pathname: findå‘½ä»¤æ‰€æŸ¥æ‰¾çš„ç›®å½•è·¯å¾„ã€‚ä¾‹å¦‚ç”¨.æ¥è¡¨ç¤ºå½“å‰ç›®å½•ï¼Œç”¨/æ¥è¡¨ç¤ºç³»ç»Ÿæ ¹ç›®å½•ã€‚</span><br><span class=\"line\">-printï¼š findå‘½ä»¤å°†åŒ¹é…çš„æ–‡ä»¶è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºã€‚</span><br><span class=\"line\">-execï¼š findå‘½ä»¤å¯¹åŒ¹é…çš„æ–‡ä»¶æ‰§è¡Œè¯¥å‚æ•°æ‰€ç»™å‡ºçš„shellå‘½ä»¤ã€‚ç›¸åº”å‘½ä»¤çš„å½¢å¼ä¸º&#x27;command&#x27; &#123;  &#125; \\;ï¼Œæ³¨æ„&#123;   &#125;å’Œ\\ï¼›ä¹‹é—´çš„ç©ºæ ¼ã€‚</span><br><span class=\"line\">-okï¼š å’Œ-execçš„ä½œç”¨ç›¸åŒï¼Œåªä¸è¿‡ä»¥ä¸€ç§æ›´ä¸ºå®‰å…¨çš„æ¨¡å¼æ¥æ‰§è¡Œè¯¥å‚æ•°æ‰€ç»™å‡ºçš„shellå‘½ä»¤ï¼Œåœ¨æ‰§è¡Œæ¯ä¸€ä¸ªå‘½ä»¤ä¹‹å‰ï¼Œéƒ½ä¼šç»™å‡ºæç¤ºï¼Œè®©ç”¨æˆ·æ¥ç¡®å®šæ˜¯å¦æ‰§è¡Œã€‚</span><br></pre></td></tr></table></figure>\n\n<p><strong>å‘½ä»¤é€‰é¡¹</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-name æŒ‰ç…§æ–‡ä»¶åæŸ¥æ‰¾æ–‡ä»¶</span><br><span class=\"line\">-perm æŒ‰æ–‡ä»¶æƒé™æŸ¥æ‰¾æ–‡ä»¶</span><br><span class=\"line\">-user æŒ‰æ–‡ä»¶å±ä¸»æŸ¥æ‰¾æ–‡ä»¶</span><br><span class=\"line\">-group  æŒ‰ç…§æ–‡ä»¶æ‰€å±çš„ç»„æ¥æŸ¥æ‰¾æ–‡ä»¶ã€‚</span><br><span class=\"line\">-type  æŸ¥æ‰¾æŸä¸€ç±»å‹çš„æ–‡ä»¶ï¼Œè¯¸å¦‚ï¼š</span><br><span class=\"line\">   b - å—è®¾å¤‡æ–‡ä»¶</span><br><span class=\"line\">   d - ç›®å½•</span><br><span class=\"line\">   c - å­—ç¬¦è®¾å¤‡æ–‡ä»¶</span><br><span class=\"line\">   l - ç¬¦å·é“¾æ¥æ–‡ä»¶</span><br><span class=\"line\">   p - ç®¡é“æ–‡ä»¶</span><br><span class=\"line\">   f - æ™®é€šæ–‡ä»¶</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰æŸ¥æ‰¾ 48 å°æ—¶å†…ä¿®æ”¹è¿‡çš„æ–‡ä»¶</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">find -atime -2</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰åœ¨å½“å‰ç›®å½•æŸ¥æ‰¾ ä»¥ .log ç»“å°¾çš„æ–‡ä»¶ã€‚ <strong>.</strong> ä»£è¡¨å½“å‰ç›®å½•</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">find ./ -name &#x27;*.log&#x27;</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ3ï¼‰æŸ¥æ‰¾ &#x2F;opt ç›®å½•ä¸‹ æƒé™ä¸º 777 çš„æ–‡ä»¶</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">find /opt -perm 777</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ4ï¼‰æŸ¥æ‰¾å¤§äº 1K çš„æ–‡ä»¶</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">find -size +1000c</span><br></pre></td></tr></table></figure>\n\n<p>æŸ¥æ‰¾ç­‰äº 1000 å­—ç¬¦çš„æ–‡ä»¶</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">find -size 1000c </span><br></pre></td></tr></table></figure>\n\n<p>-exec å‚æ•°åé¢è·Ÿçš„æ˜¯ command å‘½ä»¤ï¼Œå®ƒçš„ç»ˆæ­¢æ˜¯ä»¥ ; ä¸ºç»“æŸæ ‡å¿—çš„ï¼Œæ‰€ä»¥è¿™å¥å‘½ä»¤åé¢çš„åˆ†å·æ˜¯ä¸å¯ç¼ºå°‘çš„ï¼Œè€ƒè™‘åˆ°å„ä¸ªç³»ç»Ÿä¸­åˆ†å·ä¼šæœ‰ä¸åŒçš„æ„ä¹‰ï¼Œæ‰€ä»¥å‰é¢åŠ åæ–œæ ã€‚{} èŠ±æ‹¬å·ä»£è¡¨å‰é¢ find æŸ¥æ‰¾å‡ºæ¥çš„æ–‡ä»¶åã€‚</p>\n<h3 id=\"head-å‘½ä»¤\"><a href=\"#head-å‘½ä»¤\" class=\"headerlink\" title=\"head å‘½ä»¤\"></a>head å‘½ä»¤</h3><p>head ç”¨æ¥æ˜¾ç¤ºæ¡£æ¡ˆçš„å¼€å¤´è‡³æ ‡å‡†è¾“å‡ºä¸­ï¼Œé»˜è®¤ head å‘½ä»¤æ‰“å°å…¶ç›¸åº”æ–‡ä»¶çš„å¼€å¤´ 10 è¡Œã€‚</p>\n<p><strong>å¸¸ç”¨å‚æ•°</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-n&lt;è¡Œæ•°&gt; æ˜¾ç¤ºçš„è¡Œæ•°ï¼ˆè¡Œæ•°ä¸ºå¤æ•°è¡¨ç¤ºä»æœ€åå‘å‰æ•°ï¼‰</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰æ˜¾ç¤º 1.log æ–‡ä»¶ä¸­å‰ 20 è¡Œ</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">head 1.log -n 20</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰æ˜¾ç¤º 1.log æ–‡ä»¶å‰ 20 å­—èŠ‚</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">head 1.log -c 20 </span><br><span class=\"line\">1</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ3ï¼‰æ˜¾ç¤º 1.log æœ€å 10 è¡Œ</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">head 1.log -n -10</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"less-å‘½ä»¤\"><a href=\"#less-å‘½ä»¤\" class=\"headerlink\" title=\"less å‘½ä»¤\"></a>less å‘½ä»¤</h3><p>less ä¸ more ç±»ä¼¼ï¼Œä½†ä½¿ç”¨ less å¯ä»¥éšæ„æµè§ˆæ–‡ä»¶ï¼Œè€Œ more ä»…èƒ½å‘å‰ç§»åŠ¨ï¼Œå´ä¸èƒ½å‘åç§»åŠ¨ï¼Œè€Œä¸” less åœ¨æŸ¥çœ‹ä¹‹å‰ä¸ä¼šåŠ è½½æ•´ä¸ªæ–‡ä»¶ã€‚</p>\n<p><strong>å¸¸ç”¨å‘½ä»¤å‚æ•°</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-i  å¿½ç•¥æœç´¢æ—¶çš„å¤§å°å†™</span><br><span class=\"line\">-N  æ˜¾ç¤ºæ¯è¡Œçš„è¡Œå·</span><br><span class=\"line\">-o  &lt;æ–‡ä»¶å&gt; å°†less è¾“å‡ºçš„å†…å®¹åœ¨æŒ‡å®šæ–‡ä»¶ä¸­ä¿å­˜èµ·æ¥</span><br><span class=\"line\">-s  æ˜¾ç¤ºè¿ç»­ç©ºè¡Œä¸ºä¸€è¡Œ</span><br><span class=\"line\">/å­—ç¬¦ä¸²ï¼šå‘ä¸‹æœç´¢â€œå­—ç¬¦ä¸²â€çš„åŠŸèƒ½</span><br><span class=\"line\">?å­—ç¬¦ä¸²ï¼šå‘ä¸Šæœç´¢â€œå­—ç¬¦ä¸²â€çš„åŠŸèƒ½</span><br><span class=\"line\">nï¼šé‡å¤å‰ä¸€ä¸ªæœç´¢ï¼ˆä¸ / æˆ– ? æœ‰å…³ï¼‰</span><br><span class=\"line\">Nï¼šåå‘é‡å¤å‰ä¸€ä¸ªæœç´¢ï¼ˆä¸ / æˆ– ? æœ‰å…³ï¼‰</span><br><span class=\"line\">-x &lt;æ•°å­—&gt; å°†â€œtabâ€é”®æ˜¾ç¤ºä¸ºè§„å®šçš„æ•°å­—ç©ºæ ¼</span><br><span class=\"line\">b  å‘åç¿»ä¸€é¡µ</span><br><span class=\"line\">d  å‘åç¿»åŠé¡µ</span><br><span class=\"line\">h  æ˜¾ç¤ºå¸®åŠ©ç•Œé¢</span><br><span class=\"line\">Q  é€€å‡ºless å‘½ä»¤</span><br><span class=\"line\">u  å‘å‰æ»šåŠ¨åŠé¡µ</span><br><span class=\"line\">y  å‘å‰æ»šåŠ¨ä¸€è¡Œ</span><br><span class=\"line\">ç©ºæ ¼é”® æ»šåŠ¨ä¸€è¡Œ</span><br><span class=\"line\">å›è½¦é”® æ»šåŠ¨ä¸€é¡µ</span><br><span class=\"line\">[pagedown]ï¼š å‘ä¸‹ç¿»åŠ¨ä¸€é¡µ</span><br><span class=\"line\">[pageup]ï¼š   å‘ä¸Šç¿»åŠ¨ä¸€é¡µ</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰ps æŸ¥çœ‹è¿›ç¨‹ä¿¡æ¯å¹¶é€šè¿‡ less åˆ†é¡µæ˜¾ç¤º</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ps -aux | less -N</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰æŸ¥çœ‹å¤šä¸ªæ–‡ä»¶</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">less 1.log 2.log</span><br></pre></td></tr></table></figure>\n\n<p>å¯ä»¥ä½¿ç”¨ n æŸ¥çœ‹ä¸‹ä¸€ä¸ªï¼Œä½¿ç”¨ p æŸ¥çœ‹å‰ä¸€ä¸ªã€‚</p>\n<h3 id=\"ln-å‘½ä»¤\"><a href=\"#ln-å‘½ä»¤\" class=\"headerlink\" title=\"ln å‘½ä»¤\"></a>ln å‘½ä»¤</h3><p>åŠŸèƒ½æ˜¯ä¸ºæ–‡ä»¶åœ¨å¦å¤–ä¸€ä¸ªä½ç½®å»ºç«‹ä¸€ä¸ªåŒæ­¥çš„é“¾æ¥ï¼Œå½“åœ¨ä¸åŒç›®å½•éœ€è¦è¯¥é—®é¢˜æ—¶ï¼Œå°±ä¸éœ€è¦ä¸ºæ¯ä¸€ä¸ªç›®å½•åˆ›å»ºåŒæ ·çš„æ–‡ä»¶ï¼Œé€šè¿‡ ln åˆ›å»ºçš„é“¾æ¥ï¼ˆlinkï¼‰å‡å°‘ç£ç›˜å ç”¨é‡ã€‚</p>\n<p>é“¾æ¥åˆ†ç±»ï¼šè½¯ä»¶é“¾æ¥åŠç¡¬é“¾æ¥</p>\n<p>è½¯é“¾æ¥ï¼š</p>\n<ul>\n<li>1.è½¯é“¾æ¥ï¼Œä»¥è·¯å¾„çš„å½¢å¼å­˜åœ¨ã€‚ç±»ä¼¼äº Windows æ“ä½œç³»ç»Ÿä¸­çš„å¿«æ·æ–¹å¼</li>\n<li>2.è½¯é“¾æ¥å¯ä»¥ è·¨æ–‡ä»¶ç³»ç»Ÿ ï¼Œç¡¬é“¾æ¥ä¸å¯ä»¥</li>\n<li>3.è½¯é“¾æ¥å¯ä»¥å¯¹ä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶åè¿›è¡Œé“¾æ¥</li>\n<li>4.è½¯é“¾æ¥å¯ä»¥å¯¹ç›®å½•è¿›è¡Œé“¾æ¥</li>\n</ul>\n<p>ç¡¬é“¾æ¥:</p>\n<ul>\n<li>1.ç¡¬é“¾æ¥ï¼Œä»¥æ–‡ä»¶å‰¯æœ¬çš„å½¢å¼å­˜åœ¨ã€‚ä½†ä¸å ç”¨å®é™…ç©ºé—´ã€‚</li>\n<li>2.ä¸å…è®¸ç»™ç›®å½•åˆ›å»ºç¡¬é“¾æ¥</li>\n<li>3.ç¡¬é“¾æ¥åªæœ‰åœ¨åŒä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿä¸­æ‰èƒ½åˆ›å»º</li>\n</ul>\n<p><strong>éœ€è¦æ³¨æ„</strong>ï¼š</p>\n<ul>\n<li>ç¬¬ä¸€ï¼šln å‘½ä»¤ä¼šä¿æŒæ¯ä¸€å¤„é“¾æ¥æ–‡ä»¶çš„åŒæ­¥æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸è®ºä½ æ”¹åŠ¨äº†å“ªä¸€å¤„ï¼Œå…¶å®ƒçš„æ–‡ä»¶éƒ½ä¼šå‘ç”Ÿç›¸åŒçš„å˜åŒ–ï¼›</li>\n<li>ç¬¬äºŒï¼šln çš„é“¾æ¥åˆåˆ†è½¯é“¾æ¥å’Œç¡¬é“¾æ¥ä¸¤ç§ï¼Œè½¯é“¾æ¥å°±æ˜¯ ln â€“s æºæ–‡ä»¶ ç›®æ ‡æ–‡ä»¶ï¼Œå®ƒåªä¼šåœ¨ä½ é€‰å®šçš„ä½ç½®ä¸Šç”Ÿæˆä¸€ä¸ªæ–‡ä»¶çš„é•œåƒï¼Œä¸ä¼šå ç”¨ç£ç›˜ç©ºé—´ï¼Œç¡¬é“¾æ¥ ln æºæ–‡ä»¶ ç›®æ ‡æ–‡ä»¶ï¼Œæ²¡æœ‰å‚æ•°-sï¼Œ å®ƒä¼šåœ¨ä½ é€‰å®šçš„ä½ç½®ä¸Šç”Ÿæˆä¸€ä¸ªå’Œæºæ–‡ä»¶å¤§å°ç›¸åŒçš„æ–‡ä»¶ï¼Œæ— è®ºæ˜¯è½¯é“¾æ¥è¿˜æ˜¯ç¡¬é“¾æ¥ï¼Œæ–‡ä»¶éƒ½ä¿æŒåŒæ­¥å˜åŒ–ã€‚</li>\n<li>ç¬¬ä¸‰ï¼šln æŒ‡ä»¤ç”¨åœ¨é“¾æ¥æ–‡ä»¶æˆ–ç›®å½•ï¼Œå¦‚åŒæ—¶æŒ‡å®šä¸¤ä¸ªä»¥ä¸Šçš„æ–‡ä»¶æˆ–ç›®å½•ï¼Œä¸”æœ€åçš„ç›®çš„åœ°æ˜¯ä¸€ä¸ªå·²ç»å­˜åœ¨çš„ç›®å½•ï¼Œåˆ™ä¼šæŠŠå‰é¢æŒ‡å®šçš„æ‰€æœ‰æ–‡ä»¶æˆ–ç›®å½•å¤åˆ¶åˆ°è¯¥ç›®å½•ä¸­ã€‚è‹¥åŒæ—¶æŒ‡å®šå¤šä¸ªæ–‡ä»¶æˆ–ç›®å½•ï¼Œä¸”æœ€åçš„ç›®çš„åœ°å¹¶éæ˜¯ä¸€ä¸ªå·²å­˜åœ¨çš„ç›®å½•ï¼Œåˆ™ä¼šå‡ºç°é”™è¯¯ä¿¡æ¯ã€‚</li>\n</ul>\n<p><strong>å¸¸ç”¨å‚æ•°</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-b åˆ é™¤ï¼Œè¦†ç›–ä»¥å‰å»ºç«‹çš„é“¾æ¥</span><br><span class=\"line\">-s è½¯é“¾æ¥ï¼ˆç¬¦å·é“¾æ¥ï¼‰</span><br><span class=\"line\">-v æ˜¾ç¤ºè¯¦ç»†å¤„ç†è¿‡ç¨‹</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰ç»™æ–‡ä»¶åˆ›å»ºè½¯é“¾æ¥ï¼Œå¹¶æ˜¾ç¤ºæ“ä½œä¿¡æ¯</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ln -sv source.log link.log</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰ç»™æ–‡ä»¶åˆ›å»ºç¡¬é“¾æ¥ï¼Œå¹¶æ˜¾ç¤ºæ“ä½œä¿¡æ¯</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ln -v source.log link1.log</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ3ï¼‰ç»™ç›®å½•åˆ›å»ºè½¯é“¾æ¥</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ln -sv /opt/soft/test/test3 /opt/soft/test/test5</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"locate-å‘½ä»¤\"><a href=\"#locate-å‘½ä»¤\" class=\"headerlink\" title=\"locate å‘½ä»¤\"></a>locate å‘½ä»¤</h3><p>locate é€šè¿‡æœå¯»ç³»ç»Ÿå†…å»ºæ–‡æ¡£æ•°æ®åº“è¾¾åˆ°å¿«é€Ÿæ‰¾åˆ°æ¡£æ¡ˆï¼Œæ•°æ®åº“ç”± updatedb ç¨‹åºæ¥æ›´æ–°ï¼Œupdatedb æ˜¯ç”± cron daemon å‘¨æœŸæ€§è°ƒç”¨çš„ã€‚é»˜è®¤æƒ…å†µä¸‹ locate å‘½ä»¤åœ¨æœå¯»æ•°æ®åº“æ—¶æ¯”ç”±æ•´ä¸ªç”±ç¡¬ç›˜èµ„æ–™æ¥æœå¯»èµ„æ–™æ¥å¾—å¿«ï¼Œä½†è¾ƒå·®åŠ²çš„æ˜¯ locate æ‰€æ‰¾åˆ°çš„æ¡£æ¡ˆè‹¥æ˜¯æœ€è¿‘æ‰å»ºç«‹æˆ– åˆšæ›´åçš„ï¼Œå¯èƒ½ä¼šæ‰¾ä¸åˆ°ï¼Œåœ¨å†…å®šå€¼ä¸­ï¼Œupdatedb æ¯å¤©ä¼šè·‘ä¸€æ¬¡ï¼Œå¯ä»¥ç”±ä¿®æ”¹ crontab æ¥æ›´æ–°è®¾å®šå€¼ (etc&#x2F;crontab)ã€‚</p>\n<p>locate ä¸ find å‘½ä»¤ç›¸ä¼¼ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ *ã€? ç­‰è¿›è¡Œæ­£åˆ™åŒ¹é…æŸ¥æ‰¾</p>\n<p><strong>å¸¸ç”¨å‚æ•°</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-l numï¼ˆè¦æ˜¾ç¤ºçš„è¡Œæ•°ï¼‰</span><br><span class=\"line\">-f   å°†ç‰¹å®šçš„æ¡£æ¡ˆç³»ç»Ÿæ’é™¤åœ¨å¤–ï¼Œå¦‚å°†procæ’é™¤åœ¨å¤–</span><br><span class=\"line\">-r   ä½¿ç”¨æ­£åˆ™è¿ç®—å¼åšä¸ºå¯»æ‰¾æ¡ä»¶</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰æŸ¥æ‰¾å’Œ pwd ç›¸å…³çš„æ‰€æœ‰æ–‡ä»¶(æ–‡ä»¶åä¸­åŒ…å« pwdï¼‰</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">locate pwd</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰æœç´¢ etc ç›®å½•ä¸‹æ‰€æœ‰ä»¥ sh å¼€å¤´çš„æ–‡ä»¶</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">locate /etc/sh</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ3ï¼‰æŸ¥æ‰¾ &#x2F;var ç›®å½•ä¸‹ï¼Œä»¥ reason ç»“å°¾çš„æ–‡ä»¶</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">locate -r &#x27;^/var.*reason$&#x27;ï¼ˆå…¶ä¸­.è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼Œ*è¡¨ç¤ºä»»åŠ¡å¤šä¸ªï¼›.*è¡¨ç¤ºä»»æ„å¤šä¸ªå­—ç¬¦ï¼‰</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"more-å‘½ä»¤\"><a href=\"#more-å‘½ä»¤\" class=\"headerlink\" title=\"more å‘½ä»¤\"></a>more å‘½ä»¤</h3><p>åŠŸèƒ½ç±»ä¼¼äº cat, more ä¼šä»¥ä¸€é¡µä¸€é¡µçš„æ˜¾ç¤ºæ–¹ä¾¿ä½¿ç”¨è€…é€é¡µé˜…è¯»ï¼Œè€Œæœ€åŸºæœ¬çš„æŒ‡ä»¤å°±æ˜¯æŒ‰ç©ºç™½é”®ï¼ˆspaceï¼‰å°±å¾€ä¸‹ä¸€é¡µæ˜¾ç¤ºï¼ŒæŒ‰ b é”®å°±ä¼šå¾€å›ï¼ˆbackï¼‰ä¸€é¡µæ˜¾ç¤ºã€‚</p>\n<p><strong>å‘½ä»¤å‚æ•°</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">+n      ä»ç¬« n è¡Œå¼€å§‹æ˜¾ç¤º</span><br><span class=\"line\">-n       å®šä¹‰å±å¹•å¤§å°ä¸ºnè¡Œ</span><br><span class=\"line\">+/pattern åœ¨æ¯ä¸ªæ¡£æ¡ˆæ˜¾ç¤ºå‰æœå¯»è¯¥å­—ä¸²ï¼ˆpatternï¼‰ï¼Œç„¶åä»è¯¥å­—ä¸²å‰ä¸¤è¡Œä¹‹åå¼€å§‹æ˜¾ç¤º </span><br><span class=\"line\">-c       ä»é¡¶éƒ¨æ¸…å±ï¼Œç„¶åæ˜¾ç¤º</span><br><span class=\"line\">-d       æç¤ºâ€œPress space to continueï¼Œâ€™qâ€™ to quitï¼ˆæŒ‰ç©ºæ ¼é”®ç»§ç»­ï¼ŒæŒ‰qé”®é€€å‡ºï¼‰â€ï¼Œç¦ç”¨å“é“ƒåŠŸèƒ½</span><br><span class=\"line\">-l        å¿½ç•¥Ctrl+lï¼ˆæ¢é¡µï¼‰å­—ç¬¦</span><br><span class=\"line\">-p       é€šè¿‡æ¸…é™¤çª—å£è€Œä¸æ˜¯æ»šå±æ¥å¯¹æ–‡ä»¶è¿›è¡Œæ¢é¡µï¼Œä¸-cé€‰é¡¹ç›¸ä¼¼</span><br><span class=\"line\">-s       æŠŠè¿ç»­çš„å¤šä¸ªç©ºè¡Œæ˜¾ç¤ºä¸ºä¸€è¡Œ</span><br><span class=\"line\">-u       æŠŠæ–‡ä»¶å†…å®¹ä¸­çš„ä¸‹ç”»çº¿å»æ‰</span><br></pre></td></tr></table></figure>\n\n<p><strong>å¸¸ç”¨æ“ä½œå‘½ä»¤</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Enter    å‘ä¸‹ n è¡Œï¼Œéœ€è¦å®šä¹‰ã€‚é»˜è®¤ä¸º 1 è¡Œ</span><br><span class=\"line\">Ctrl+F   å‘ä¸‹æ»šåŠ¨ä¸€å±</span><br><span class=\"line\">ç©ºæ ¼é”®  å‘ä¸‹æ»šåŠ¨ä¸€å±</span><br><span class=\"line\">Ctrl+B  è¿”å›ä¸Šä¸€å±</span><br><span class=\"line\">=       è¾“å‡ºå½“å‰è¡Œçš„è¡Œå·</span><br><span class=\"line\">:f     è¾“å‡ºæ–‡ä»¶åå’Œå½“å‰è¡Œçš„è¡Œå·</span><br><span class=\"line\">V      è°ƒç”¨viç¼–è¾‘å™¨</span><br><span class=\"line\">!å‘½ä»¤   è°ƒç”¨Shellï¼Œå¹¶æ‰§è¡Œå‘½ä»¤</span><br><span class=\"line\">q       é€€å‡ºmore</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰æ˜¾ç¤ºæ–‡ä»¶ä¸­ä»ç¬¬ 3 è¡Œèµ·çš„å†…å®¹</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">more +3 text.txt</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰åœ¨æ‰€åˆ—å‡ºæ–‡ä»¶ç›®å½•è¯¦ç»†ä¿¡æ¯ï¼Œå€ŸåŠ©ç®¡é“ä½¿æ¯æ¬¡æ˜¾ç¤º 5 è¡Œ</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ls -l | more -5</span><br></pre></td></tr></table></figure>\n\n<p>æŒ‰ç©ºæ ¼æ˜¾ç¤ºä¸‹ 5 è¡Œã€‚</p>\n<h3 id=\"mv-å‘½ä»¤\"><a href=\"#mv-å‘½ä»¤\" class=\"headerlink\" title=\"mv å‘½ä»¤\"></a>mv å‘½ä»¤</h3><p>ç§»åŠ¨æ–‡ä»¶æˆ–ä¿®æ”¹æ–‡ä»¶åï¼Œæ ¹æ®ç¬¬äºŒå‚æ•°ç±»å‹ï¼ˆå¦‚ç›®å½•ï¼Œåˆ™ç§»åŠ¨æ–‡ä»¶ï¼›å¦‚ä¸ºæ–‡ä»¶åˆ™é‡å‘½ä»¤è¯¥æ–‡ä»¶ï¼‰ã€‚</p>\n<p>å½“ç¬¬äºŒä¸ªå‚æ•°ä¸ºç›®å½•æ—¶ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥æ˜¯å¤šä¸ªä»¥ç©ºæ ¼åˆ†éš”çš„æ–‡ä»¶æˆ–ç›®å½•ï¼Œç„¶åç§»åŠ¨ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šçš„å¤šä¸ªæ–‡ä»¶åˆ°ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šçš„ç›®å½•ä¸­ã€‚</p>\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰å°†æ–‡ä»¶ test.log é‡å‘½åä¸º test1.txt</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mv test.log test1.txt</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰å°†æ–‡ä»¶ log1.txtã€log2.txtã€log3.txt ç§»åŠ¨åˆ°æ ¹çš„ test3 ç›®å½•ä¸­</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mv llog1.txt log2.txt log3.txt /test3</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ3ï¼‰å°†æ–‡ä»¶ file1 æ”¹åä¸º file2ï¼Œå¦‚æœ file2 å·²ç»å­˜åœ¨ï¼Œåˆ™è¯¢é—®æ˜¯å¦è¦†ç›–</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mv -i log1.txt log2.txt</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ4ï¼‰ç§»åŠ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åˆ°ä¸Šä¸€çº§ç›®å½•</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mv * ../</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"rm-å‘½ä»¤\"><a href=\"#rm-å‘½ä»¤\" class=\"headerlink\" title=\"rm å‘½ä»¤\"></a>rm å‘½ä»¤</h3><p>åˆ é™¤ä¸€ä¸ªç›®å½•ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶æˆ–ç›®å½•ï¼Œå¦‚æœæ²¡æœ‰ä½¿ç”¨ -r é€‰é¡¹ï¼Œåˆ™ rm ä¸ä¼šåˆ é™¤ç›®å½•ã€‚å¦‚æœä½¿ç”¨ rm æ¥åˆ é™¤æ–‡ä»¶ï¼Œé€šå¸¸ä»å¯ä»¥å°†è¯¥æ–‡ä»¶æ¢å¤åŸçŠ¶ã€‚</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rm [é€‰é¡¹] æ–‡ä»¶â€¦</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰åˆ é™¤ä»»ä½• .log æ–‡ä»¶ï¼Œåˆ é™¤å‰é€ä¸€è¯¢é—®ç¡®è®¤ï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rm -i *.log</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰åˆ é™¤ test å­ç›®å½•åŠå­ç›®å½•ä¸­æ‰€æœ‰æ¡£æ¡ˆåˆ é™¤ï¼Œå¹¶ä¸”ä¸ç”¨ä¸€ä¸€ç¡®è®¤ï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rm -rf test</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ3ï¼‰åˆ é™¤ä»¥ -f å¼€å¤´çš„æ–‡ä»¶</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rm -- -f*</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"tail-å‘½ä»¤\"><a href=\"#tail-å‘½ä»¤\" class=\"headerlink\" title=\"tail å‘½ä»¤\"></a>tail å‘½ä»¤</h3><p>ç”¨äºæ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶æœ«å°¾å†…å®¹ï¼Œä¸æŒ‡å®šæ–‡ä»¶æ—¶ï¼Œä½œä¸ºè¾“å…¥ä¿¡æ¯è¿›è¡Œå¤„ç†ã€‚å¸¸ç”¨æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ã€‚</p>\n<p><strong>å¸¸ç”¨å‚æ•°</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-f å¾ªç¯è¯»å–ï¼ˆå¸¸ç”¨äºæŸ¥çœ‹é€’å¢çš„æ—¥å¿—æ–‡ä»¶ï¼‰</span><br><span class=\"line\">-n&lt;è¡Œæ•°&gt; æ˜¾ç¤ºè¡Œæ•°ï¼ˆä»åå‘å‰ï¼‰</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ1ï¼‰å¾ªç¯è¯»å–é€æ¸å¢åŠ çš„æ–‡ä»¶å†…å®¹</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ping 127.0.0.1 &gt; ping.log &amp;</span><br></pre></td></tr></table></figure>\n\n<p>åå°è¿è¡Œï¼šå¯ä½¿ç”¨ jobs -l æŸ¥çœ‹ï¼Œä¹Ÿå¯ä½¿ç”¨ fg å°†å…¶ç§»åˆ°å‰å°è¿è¡Œã€‚</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tail -f ping.log</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆæŸ¥çœ‹æ—¥å¿—ï¼‰</p>\n<h3 id=\"touch-å‘½ä»¤\"><a href=\"#touch-å‘½ä»¤\" class=\"headerlink\" title=\"touch å‘½ä»¤\"></a>touch å‘½ä»¤</h3><p>Linux touch å‘½ä»¤ç”¨äºä¿®æ”¹æ–‡ä»¶æˆ–è€…ç›®å½•çš„æ—¶é—´å±æ€§ï¼ŒåŒ…æ‹¬å­˜å–æ—¶é—´å’Œæ›´æ”¹æ—¶é—´ã€‚è‹¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œç³»ç»Ÿä¼šå»ºç«‹ä¸€ä¸ªæ–°çš„æ–‡ä»¶ã€‚</p>\n<p>ls -l å¯ä»¥æ˜¾ç¤ºæ¡£æ¡ˆçš„æ—¶é—´è®°å½•ã€‚</p>\n<p><strong>è¯­æ³•</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">touch [-acfm][-d&lt;æ—¥æœŸæ—¶é—´&gt;][-r&lt;å‚è€ƒæ–‡ä»¶æˆ–ç›®å½•&gt;] [-t&lt;æ—¥æœŸæ—¶é—´&gt;][--help][--version][æ–‡ä»¶æˆ–ç›®å½•â€¦]</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><strong>å‚æ•°è¯´æ˜</strong>ï¼š</li>\n<li>a æ”¹å˜æ¡£æ¡ˆçš„è¯»å–æ—¶é—´è®°å½•ã€‚</li>\n<li>m æ”¹å˜æ¡£æ¡ˆçš„ä¿®æ”¹æ—¶é—´è®°å½•ã€‚</li>\n<li>c å‡å¦‚ç›®çš„æ¡£æ¡ˆä¸å­˜åœ¨ï¼Œä¸ä¼šå»ºç«‹æ–°çš„æ¡£æ¡ˆã€‚ä¸ â€“no-create çš„æ•ˆæœä¸€æ ·ã€‚</li>\n<li>f ä¸ä½¿ç”¨ï¼Œæ˜¯ä¸ºäº†ä¸å…¶ä»– unix ç³»ç»Ÿçš„ç›¸å®¹æ€§è€Œä¿ç•™ã€‚</li>\n<li>r ä½¿ç”¨å‚è€ƒæ¡£çš„æ—¶é—´è®°å½•ï¼Œä¸ â€“file çš„æ•ˆæœä¸€æ ·ã€‚</li>\n<li>d è®¾å®šæ—¶é—´ä¸æ—¥æœŸï¼Œå¯ä»¥ä½¿ç”¨å„ç§ä¸åŒçš„æ ¼å¼ã€‚</li>\n<li>t è®¾å®šæ¡£æ¡ˆçš„æ—¶é—´è®°å½•ï¼Œæ ¼å¼ä¸ date æŒ‡ä»¤ç›¸åŒã€‚</li>\n<li>â€“no-create ä¸ä¼šå»ºç«‹æ–°æ¡£æ¡ˆã€‚</li>\n<li>â€“help åˆ—å‡ºæŒ‡ä»¤æ ¼å¼ã€‚</li>\n<li>â€“version åˆ—å‡ºç‰ˆæœ¬è®¯æ¯ã€‚</li>\n</ul>\n<p><strong>å®ä¾‹</strong></p>\n<p>ä½¿ç”¨æŒ‡ä»¤â€touchâ€ä¿®æ”¹æ–‡ä»¶â€testfileâ€çš„æ—¶é—´å±æ€§ä¸ºå½“å‰ç³»ç»Ÿæ—¶é—´ï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\">$ </span><span class=\"language-bash\"><span class=\"built_in\">touch</span> testfile                <span class=\"comment\">#ä¿®æ”¹æ–‡ä»¶çš„æ—¶é—´å±æ€§</span></span> </span><br></pre></td></tr></table></figure>\n\n<p>é¦–å…ˆï¼Œä½¿ç”¨ ls å‘½ä»¤æŸ¥çœ‹ testfile æ–‡ä»¶çš„å±æ€§ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\">$ </span><span class=\"language-bash\"><span class=\"built_in\">ls</span> -l testfile                <span class=\"comment\">#æŸ¥çœ‹æ–‡ä»¶çš„æ—¶é—´å±æ€§</span></span>  </span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">åŸæ¥æ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´ä¸º16:09</span>  </span><br><span class=\"line\">-rw-r--r-- 1 hdd hdd 55 2011-08-22 16:09 testfile  </span><br></pre></td></tr></table></figure>\n\n<p>æ‰§è¡ŒæŒ‡ä»¤â€touchâ€ä¿®æ”¹æ–‡ä»¶å±æ€§ä»¥åï¼Œå¹¶å†æ¬¡æŸ¥çœ‹è¯¥æ–‡ä»¶çš„æ—¶é—´å±æ€§ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\">$ </span><span class=\"language-bash\"><span class=\"built_in\">touch</span> testfile                <span class=\"comment\">#ä¿®æ”¹æ–‡ä»¶æ—¶é—´å±æ€§ä¸ºå½“å‰ç³»ç»Ÿæ—¶é—´</span></span>  </span><br><span class=\"line\"><span class=\"meta prompt_\">$ </span><span class=\"language-bash\"><span class=\"built_in\">ls</span> -l testfile                <span class=\"comment\">#æŸ¥çœ‹æ–‡ä»¶çš„æ—¶é—´å±æ€§</span></span>  </span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">ä¿®æ”¹åæ–‡ä»¶çš„æ—¶é—´å±æ€§ä¸ºå½“å‰ç³»ç»Ÿæ—¶é—´</span>  </span><br><span class=\"line\">-rw-r--r-- 1 hdd hdd 55 2011-08-22 19:53 testfile  </span><br></pre></td></tr></table></figure>\n\n<p>ä½¿ç”¨æŒ‡ä»¤â€touchâ€æ—¶ï¼Œå¦‚æœæŒ‡å®šçš„æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™å°†åˆ›å»ºä¸€ä¸ªæ–°çš„ç©ºç™½æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼Œåœ¨å½“å‰ç›®å½•ä¸‹ï¼Œä½¿ç”¨è¯¥æŒ‡ä»¤åˆ›å»ºä¸€ä¸ªç©ºç™½æ–‡ä»¶â€fileâ€ï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\">$ </span><span class=\"language-bash\"><span class=\"built_in\">touch</span> file            <span class=\"comment\">#åˆ›å»ºä¸€ä¸ªåä¸ºâ€œfileâ€çš„æ–°çš„ç©ºç™½æ–‡ä»¶</span></span> </span><br></pre></td></tr></table></figure>\n\n<h3 id=\"vim-å‘½ä»¤\"><a href=\"#vim-å‘½ä»¤\" class=\"headerlink\" title=\"vim å‘½ä»¤\"></a>vim å‘½ä»¤</h3><p>Vim æ˜¯ä» vi å‘å±•å‡ºæ¥çš„ä¸€ä¸ªæ–‡æœ¬ç¼–è¾‘å™¨ã€‚ä»£ç è¡¥å®Œã€ç¼–è¯‘åŠé”™è¯¯è·³è½¬ç­‰æ–¹ä¾¿ç¼–ç¨‹çš„åŠŸèƒ½ç‰¹åˆ«ä¸°å¯Œï¼Œåœ¨ç¨‹åºå‘˜ä¸­è¢«å¹¿æ³›ä½¿ç”¨ã€‚</p>\n<ul>\n<li>æ‰“å¼€æ–‡ä»¶å¹¶è·³åˆ°ç¬¬ 10 è¡Œï¼š<code>vim +10 filename.txt</code> ã€‚</li>\n<li>æ‰“å¼€æ–‡ä»¶è·³åˆ°ç¬¬ä¸€ä¸ªåŒ¹é…çš„è¡Œï¼š<code>vim +/search-term filename.txt</code> ã€‚</li>\n<li>ä»¥åªè¯»æ¨¡å¼æ‰“å¼€æ–‡ä»¶ï¼š<code>vim -R /etc/passwd</code> ã€‚</li>\n</ul>\n<p>åŸºæœ¬ä¸Š vi&#x2F;vim å…±åˆ†ä¸ºä¸‰ç§æ¨¡å¼ï¼Œåˆ†åˆ«æ˜¯<strong>å‘½ä»¤æ¨¡å¼ï¼ˆCommand modeï¼‰</strong>ï¼Œ**è¾“å…¥æ¨¡å¼ï¼ˆInsert modeï¼‰**å’Œ**åº•çº¿å‘½ä»¤æ¨¡å¼ï¼ˆLast line modeï¼‰**ã€‚</p>\n<p>ç®€å•çš„è¯´ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸‰ä¸ªæ¨¡å¼æƒ³æˆåº•ä¸‹çš„å›¾æ ‡æ¥è¡¨ç¤ºï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/format,png-20230125135806349.png\" alt=\"vim å·¥ä½œæ¨¡å¼\"></p>\n<h3 id=\"whereis-å‘½ä»¤\"><a href=\"#whereis-å‘½ä»¤\" class=\"headerlink\" title=\"whereis å‘½ä»¤\"></a>whereis å‘½ä»¤</h3><p>whereis å‘½ä»¤åªèƒ½ç”¨äºç¨‹åºåçš„æœç´¢ï¼Œè€Œä¸”åªæœç´¢äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆå‚æ•°-bï¼‰ã€man è¯´æ˜æ–‡ä»¶ï¼ˆå‚æ•°-mï¼‰å’Œæºä»£ç æ–‡ä»¶ï¼ˆå‚æ•°-sï¼‰ã€‚å¦‚æœçœç•¥å‚æ•°ï¼Œåˆ™è¿”å›æ‰€æœ‰ä¿¡æ¯ã€‚whereis åŠ locate éƒ½æ˜¯åŸºäºç³»ç»Ÿå†…å»ºçš„æ•°æ®åº“è¿›è¡Œæœç´¢ï¼Œå› æ­¤æ•ˆç‡å¾ˆé«˜ï¼Œè€Œ find åˆ™æ˜¯éå†ç¡¬ç›˜æŸ¥æ‰¾æ–‡ä»¶ã€‚</p>\n<p><strong>å¸¸ç”¨å‚æ•°</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-b   å®šä½å¯æ‰§è¡Œæ–‡ä»¶ã€‚</span><br><span class=\"line\">-m   å®šä½å¸®åŠ©æ–‡ä»¶ã€‚</span><br><span class=\"line\">-s   å®šä½æºä»£ç æ–‡ä»¶ã€‚</span><br><span class=\"line\">-u   æœç´¢é»˜è®¤è·¯å¾„ä¸‹é™¤å¯æ‰§è¡Œæ–‡ä»¶ã€æºä»£ç æ–‡ä»¶ã€å¸®åŠ©æ–‡ä»¶ä»¥å¤–çš„å…¶å®ƒæ–‡ä»¶ã€‚</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰æŸ¥æ‰¾ locate ç¨‹åºç›¸å…³æ–‡ä»¶</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">whereis locate</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰æŸ¥æ‰¾ locate çš„æºç æ–‡ä»¶</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">whereis -s locate</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ3ï¼‰æŸ¥æ‰¾ lcoate çš„å¸®åŠ©æ–‡ä»¶</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">whereis -m locate</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"which-å‘½ä»¤\"><a href=\"#which-å‘½ä»¤\" class=\"headerlink\" title=\"which å‘½ä»¤\"></a>which å‘½ä»¤</h3><p>åœ¨ linux è¦æŸ¥æ‰¾æŸä¸ªæ–‡ä»¶ï¼Œä½†ä¸çŸ¥é“æ”¾åœ¨å“ªé‡Œäº†ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä¸€äº›å‘½ä»¤æ¥æœç´¢ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">which     æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶çš„ä½ç½®ã€‚</span><br><span class=\"line\">whereis æŸ¥çœ‹æ–‡ä»¶çš„ä½ç½®ã€‚</span><br><span class=\"line\">locate  é…åˆæ•°æ®åº“æŸ¥çœ‹æ–‡ä»¶ä½ç½®ã€‚</span><br><span class=\"line\">find        å®é™…æœå¯»ç¡¬ç›˜æŸ¥è¯¢æ–‡ä»¶åç§°ã€‚</span><br></pre></td></tr></table></figure>\n\n<p>which æ˜¯åœ¨ PATH å°±æ˜¯æŒ‡å®šçš„è·¯å¾„ä¸­ï¼Œæœç´¢æŸä¸ªç³»ç»Ÿå‘½ä»¤çš„ä½ç½®ï¼Œå¹¶è¿”å›ç¬¬ä¸€ä¸ªæœç´¢ç»“æœã€‚ä½¿ç”¨ which å‘½ä»¤ï¼Œå°±å¯ä»¥çœ‹åˆ°æŸä¸ªç³»ç»Ÿå‘½ä»¤æ˜¯å¦å­˜åœ¨ï¼Œä»¥åŠæ‰§è¡Œçš„åˆ°åº•æ˜¯å“ªä¸€ä¸ªä½ç½®çš„å‘½ä»¤ã€‚</p>\n<p><strong>å¸¸ç”¨å‚æ•°</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-n ã€€æŒ‡å®šæ–‡ä»¶åé•¿åº¦ï¼ŒæŒ‡å®šçš„é•¿åº¦å¿…é¡»å¤§äºæˆ–ç­‰äºæ‰€æœ‰æ–‡ä»¶ä¸­æœ€é•¿çš„æ–‡ä»¶åã€‚</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰æŸ¥çœ‹ ls å‘½ä»¤æ˜¯å¦å­˜åœ¨ï¼Œæ‰§è¡Œå“ªä¸ª</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">which ls</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰æŸ¥çœ‹ which</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">which which</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ3ï¼‰æŸ¥çœ‹ cd</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">which cdï¼ˆæ˜¾ç¤ºä¸å­˜åœ¨ï¼Œå› ä¸º cd æ˜¯å†…å»ºå‘½ä»¤ï¼Œè€Œ which æŸ¥æ‰¾æ˜¾ç¤ºæ˜¯ PATH ä¸­çš„å‘½ä»¤ï¼‰</span><br></pre></td></tr></table></figure>\n\n<p>æŸ¥çœ‹å½“å‰ PATH é…ç½®ï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">echo $PATH</span><br></pre></td></tr></table></figure>\n\n<p>æˆ–ä½¿ç”¨ env æŸ¥çœ‹æ‰€æœ‰ç¯å¢ƒå˜é‡åŠå¯¹åº”å€¼</p>\n<h2 id=\"æ–‡æ¡£ç¼–è¾‘å‘½ä»¤\"><a href=\"#æ–‡æ¡£ç¼–è¾‘å‘½ä»¤\" class=\"headerlink\" title=\"æ–‡æ¡£ç¼–è¾‘å‘½ä»¤\"></a>æ–‡æ¡£ç¼–è¾‘å‘½ä»¤</h2><h3 id=\"grep-å‘½ä»¤\"><a href=\"#grep-å‘½ä»¤\" class=\"headerlink\" title=\"grep å‘½ä»¤\"></a>grep å‘½ä»¤</h3><p>å¼ºå¤§çš„æ–‡æœ¬æœç´¢å‘½ä»¤ï¼Œgrep(Global Regular Expression Print) å…¨å±€æ­£åˆ™è¡¨è¾¾å¼æœç´¢ã€‚</p>\n<p>grep çš„å·¥ä½œæ–¹å¼æ˜¯è¿™æ ·çš„ï¼Œå®ƒåœ¨ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶ä¸­æœç´¢å­—ç¬¦ä¸²æ¨¡æ¿ã€‚å¦‚æœæ¨¡æ¿åŒ…æ‹¬ç©ºæ ¼ï¼Œåˆ™å¿…é¡»è¢«å¼•ç”¨ï¼Œæ¨¡æ¿åçš„æ‰€æœ‰å­—ç¬¦ä¸²è¢«çœ‹ä½œæ–‡ä»¶åã€‚æœç´¢çš„ç»“æœè¢«é€åˆ°æ ‡å‡†è¾“å‡ºï¼Œä¸å½±å“åŸæ–‡ä»¶å†…å®¹ã€‚</p>\n<p>å‘½ä»¤æ ¼å¼ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">grep [option] pattern file|dir</span><br></pre></td></tr></table></figure>\n\n<p><strong>å¸¸ç”¨å‚æ•°</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-A n --after-contextæ˜¾ç¤ºåŒ¹é…å­—ç¬¦ånè¡Œ</span><br><span class=\"line\">-B n --before-contextæ˜¾ç¤ºåŒ¹é…å­—ç¬¦å‰nè¡Œ</span><br><span class=\"line\">-C n --context æ˜¾ç¤ºåŒ¹é…å­—ç¬¦å‰ånè¡Œ</span><br><span class=\"line\">-c --count è®¡ç®—ç¬¦åˆæ ·å¼çš„åˆ—æ•°</span><br><span class=\"line\">-i å¿½ç•¥å¤§å°å†™</span><br><span class=\"line\">-l åªåˆ—å‡ºæ–‡ä»¶å†…å®¹ç¬¦åˆæŒ‡å®šçš„æ ·å¼çš„æ–‡ä»¶åç§°</span><br><span class=\"line\">-f ä»æ–‡ä»¶ä¸­è¯»å–å…³é”®è¯</span><br><span class=\"line\">-n æ˜¾ç¤ºåŒ¹é…å†…å®¹çš„æ‰€åœ¨æ–‡ä»¶ä¸­è¡Œæ•°</span><br><span class=\"line\">-R é€’å½’æŸ¥æ‰¾æ–‡ä»¶å¤¹</span><br></pre></td></tr></table></figure>\n\n<p>grep çš„è§„åˆ™è¡¨è¾¾å¼:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">^  #é”šå®šè¡Œçš„å¼€å§‹ å¦‚ï¼š&#x27;^grep&#x27;åŒ¹é…æ‰€æœ‰ä»¥grepå¼€å¤´çš„è¡Œã€‚ </span><br><span class=\"line\">$  #é”šå®šè¡Œçš„ç»“æŸ å¦‚ï¼š&#x27;grep$&#x27;åŒ¹é…æ‰€æœ‰ä»¥grepç»“å°¾çš„è¡Œã€‚ </span><br><span class=\"line\">.  #åŒ¹é…ä¸€ä¸ªéæ¢è¡Œç¬¦çš„å­—ç¬¦ å¦‚ï¼š&#x27;gr.p&#x27;åŒ¹é…gråæ¥ä¸€ä¸ªä»»æ„å­—ç¬¦ï¼Œç„¶åæ˜¯pã€‚  </span><br><span class=\"line\">*  #åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªå…ˆå‰å­—ç¬¦ å¦‚ï¼š&#x27;*grep&#x27;åŒ¹é…æ‰€æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªç©ºæ ¼åç´§è·Ÿgrepçš„è¡Œã€‚</span><br><span class=\"line\">.*   #ä¸€èµ·ç”¨ä»£è¡¨ä»»æ„å­—ç¬¦ã€‚  </span><br><span class=\"line\">[]   #åŒ¹é…ä¸€ä¸ªæŒ‡å®šèŒƒå›´å†…çš„å­—ç¬¦ï¼Œå¦‚&#x27;[Gg]rep&#x27;åŒ¹é…Grepå’Œgrepã€‚ </span><br><span class=\"line\">[^]  #åŒ¹é…ä¸€ä¸ªä¸åœ¨æŒ‡å®šèŒƒå›´å†…çš„å­—ç¬¦ï¼Œå¦‚ï¼š&#x27;[^A-FH-Z]rep&#x27;åŒ¹é…ä¸åŒ…å«A-Rå’ŒT-Zçš„ä¸€ä¸ªå­—æ¯å¼€å¤´ï¼Œç´§è·Ÿrepçš„è¡Œã€‚  </span><br><span class=\"line\">\\(..\\)  #æ ‡è®°åŒ¹é…å­—ç¬¦ï¼Œå¦‚&#x27;\\(love\\)&#x27;ï¼Œloveè¢«æ ‡è®°ä¸º1ã€‚   </span><br><span class=\"line\">\\&lt;      #é”šå®šå•è¯çš„å¼€å§‹ï¼Œå¦‚:&#x27;\\&lt;grep&#x27;åŒ¹é…åŒ…å«ä»¥grepå¼€å¤´çš„å•è¯çš„è¡Œã€‚</span><br><span class=\"line\">\\&gt;      #é”šå®šå•è¯çš„ç»“æŸï¼Œå¦‚&#x27;grep\\&gt;&#x27;åŒ¹é…åŒ…å«ä»¥grepç»“å°¾çš„å•è¯çš„è¡Œã€‚</span><br><span class=\"line\">x\\&#123;m\\&#125;  #é‡å¤å­—ç¬¦xï¼Œmæ¬¡ï¼Œå¦‚ï¼š&#x27;0\\&#123;5\\&#125;&#x27;åŒ¹é…åŒ…å«5ä¸ªoçš„è¡Œã€‚ </span><br><span class=\"line\">x\\&#123;m,\\&#125;  #é‡å¤å­—ç¬¦x,è‡³å°‘mæ¬¡ï¼Œå¦‚ï¼š&#x27;o\\&#123;5,\\&#125;&#x27;åŒ¹é…è‡³å°‘æœ‰5ä¸ªoçš„è¡Œã€‚  </span><br><span class=\"line\">x\\&#123;m,n\\&#125;  #é‡å¤å­—ç¬¦xï¼Œè‡³å°‘mæ¬¡ï¼Œä¸å¤šäºnæ¬¡ï¼Œå¦‚ï¼š&#x27;o\\&#123;5,10\\&#125;&#x27;åŒ¹é…5--10ä¸ªoçš„è¡Œã€‚  </span><br><span class=\"line\">\\w    #åŒ¹é…æ–‡å­—å’Œæ•°å­—å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯[A-Za-z0-9]ï¼Œå¦‚ï¼š&#x27;G\\w*p&#x27;åŒ¹é…ä»¥Gåè·Ÿé›¶ä¸ªæˆ–å¤šä¸ªæ–‡å­—æˆ–æ•°å­—å­—ç¬¦ï¼Œç„¶åæ˜¯pã€‚  </span><br><span class=\"line\">\\W    #\\wçš„åç½®å½¢å¼ï¼ŒåŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªéå•è¯å­—ç¬¦ï¼Œå¦‚ç‚¹å·å¥å·ç­‰ã€‚  </span><br><span class=\"line\">\\b    #å•è¯é”å®šç¬¦ï¼Œå¦‚: &#x27;\\bgrep\\b&#x27;åªåŒ¹é…grepã€‚</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰æŸ¥æ‰¾æŒ‡å®šè¿›ç¨‹</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ps -ef | grep svn</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰æŸ¥æ‰¾æŒ‡å®šè¿›ç¨‹ä¸ªæ•°</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ps -ef | grep svn -c</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ3ï¼‰ä»æ–‡ä»¶ä¸­è¯»å–å…³é”®è¯</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat test1.txt | grep -f key.log</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ4ï¼‰ä»æ–‡ä»¶å¤¹ä¸­é€’å½’æŸ¥æ‰¾ä»¥ grep å¼€å¤´çš„è¡Œï¼Œå¹¶åªåˆ—å‡ºæ–‡ä»¶</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">grep -lR &#x27;^grep&#x27; /tmp</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ5ï¼‰æŸ¥æ‰¾é x å¼€å…³çš„è¡Œå†…å®¹</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">grep &#x27;^[^x]&#x27; test.txt</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ6ï¼‰æ˜¾ç¤ºåŒ…å« ed æˆ–è€… at å­—ç¬¦çš„å†…å®¹è¡Œ</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">grep -E &#x27;ed|at&#x27; test.txt</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"wc-å‘½ä»¤\"><a href=\"#wc-å‘½ä»¤\" class=\"headerlink\" title=\"wc å‘½ä»¤\"></a>wc å‘½ä»¤</h3><p>wc(word count)åŠŸèƒ½ä¸ºç»Ÿè®¡æŒ‡å®šçš„æ–‡ä»¶ä¸­å­—èŠ‚æ•°ã€å­—æ•°ã€è¡Œæ•°ï¼Œå¹¶å°†ç»Ÿè®¡ç»“æœè¾“å‡º</p>\n<p>å‘½ä»¤æ ¼å¼ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wc [option] file..</span><br></pre></td></tr></table></figure>\n\n<p><strong>å‘½ä»¤å‚æ•°</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-c ç»Ÿè®¡å­—èŠ‚æ•°</span><br><span class=\"line\">-l ç»Ÿè®¡è¡Œæ•°</span><br><span class=\"line\">-m ç»Ÿè®¡å­—ç¬¦æ•°</span><br><span class=\"line\">-w ç»Ÿè®¡è¯æ•°ï¼Œä¸€ä¸ªå­—è¢«å®šä¹‰ä¸ºç”±ç©ºç™½ã€è·³æ ¼æˆ–æ¢è¡Œå­—ç¬¦åˆ†éš”çš„å­—ç¬¦ä¸²</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰æŸ¥æ‰¾æ–‡ä»¶çš„ è¡Œæ•° å•è¯æ•° å­—èŠ‚æ•° æ–‡ä»¶å</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wc text.txt</span><br></pre></td></tr></table></figure>\n\n<p>ç»“æœï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">7     8     70     test.txt</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰ç»Ÿè®¡è¾“å‡ºç»“æœçš„è¡Œæ•°</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat test.txt | wc -l</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"ç£ç›˜ç®¡ç†å‘½ä»¤\"><a href=\"#ç£ç›˜ç®¡ç†å‘½ä»¤\" class=\"headerlink\" title=\"ç£ç›˜ç®¡ç†å‘½ä»¤\"></a>ç£ç›˜ç®¡ç†å‘½ä»¤</h2><h3 id=\"cd-å‘½ä»¤\"><a href=\"#cd-å‘½ä»¤\" class=\"headerlink\" title=\"cd å‘½ä»¤\"></a>cd å‘½ä»¤</h3><p>cd(changeDirectory) å‘½ä»¤è¯­æ³•ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd [ç›®å½•å]</span><br></pre></td></tr></table></figure>\n\n<p>è¯´æ˜ï¼šåˆ‡æ¢å½“å‰ç›®å½•è‡³ dirNameã€‚</p>\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰è¿›å…¥è¦ç›®å½•</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd /</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰è¿›å…¥ â€œhomeâ€ ç›®å½•</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd ~</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ3ï¼‰è¿›å…¥ä¸Šä¸€æ¬¡å·¥ä½œè·¯å¾„</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd -</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ4ï¼‰æŠŠä¸Šä¸ªå‘½ä»¤çš„å‚æ•°ä½œä¸º cd å‚æ•°ä½¿ç”¨ã€‚</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd !$</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"df-å‘½ä»¤\"><a href=\"#df-å‘½ä»¤\" class=\"headerlink\" title=\"df å‘½ä»¤\"></a>df å‘½ä»¤</h3><p>æ˜¾ç¤ºç£ç›˜ç©ºé—´ä½¿ç”¨æƒ…å†µã€‚è·å–ç¡¬ç›˜è¢«å ç”¨äº†å¤šå°‘ç©ºé—´ï¼Œç›®å‰è¿˜å‰©ä¸‹å¤šå°‘ç©ºé—´ç­‰ä¿¡æ¯ï¼Œå¦‚æœæ²¡æœ‰æ–‡ä»¶åè¢«æŒ‡å®šï¼Œåˆ™æ‰€æœ‰å½“å‰è¢«æŒ‚è½½çš„æ–‡ä»¶ç³»ç»Ÿçš„å¯ç”¨ç©ºé—´å°†è¢«æ˜¾ç¤ºã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œç£ç›˜ç©ºé—´å°†ä»¥ 1KB ä¸ºå•ä½è¿›è¡Œæ˜¾ç¤ºï¼Œé™¤éç¯å¢ƒå˜é‡ POSIXLY_CORRECT è¢«æŒ‡å®šï¼Œé‚£æ ·å°†ä»¥ 512 å­—èŠ‚ä¸ºå•ä½è¿›è¡Œæ˜¾ç¤ºï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-a å…¨éƒ¨æ–‡ä»¶ç³»ç»Ÿåˆ—è¡¨</span><br><span class=\"line\">-h ä»¥æ–¹ä¾¿é˜…è¯»çš„æ–¹å¼æ˜¾ç¤ºä¿¡æ¯</span><br><span class=\"line\">-i æ˜¾ç¤ºinodeä¿¡æ¯</span><br><span class=\"line\">-k åŒºå—ä¸º1024å­—èŠ‚</span><br><span class=\"line\">-l åªæ˜¾ç¤ºæœ¬åœ°ç£ç›˜</span><br><span class=\"line\">-T åˆ—å‡ºæ–‡ä»¶ç³»ç»Ÿç±»å‹</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰æ˜¾ç¤ºç£ç›˜ä½¿ç”¨æƒ…å†µ</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df -l</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰ä»¥æ˜“è¯»æ–¹å¼åˆ—å‡ºæ‰€æœ‰æ–‡ä»¶ç³»ç»ŸåŠå…¶ç±»å‹</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df -haT</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"du-å‘½ä»¤\"><a href=\"#du-å‘½ä»¤\" class=\"headerlink\" title=\"du å‘½ä»¤\"></a>du å‘½ä»¤</h3><p>du å‘½ä»¤ä¹Ÿæ˜¯æŸ¥çœ‹ä½¿ç”¨ç©ºé—´çš„ï¼Œä½†æ˜¯ä¸ df å‘½ä»¤ä¸åŒçš„æ˜¯ Linux du å‘½ä»¤æ˜¯å¯¹æ–‡ä»¶å’Œç›®å½•ç£ç›˜ä½¿ç”¨çš„ç©ºé—´çš„æŸ¥çœ‹ï¼š</p>\n<p>å‘½ä»¤æ ¼å¼ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">du [é€‰é¡¹] [æ–‡ä»¶]</span><br><span class=\"line\">1</span><br></pre></td></tr></table></figure>\n\n<p><strong>å¸¸ç”¨å‚æ•°</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-a æ˜¾ç¤ºç›®å½•ä¸­æ‰€æœ‰æ–‡ä»¶å¤§å°</span><br><span class=\"line\">-k ä»¥KBä¸ºå•ä½æ˜¾ç¤ºæ–‡ä»¶å¤§å°</span><br><span class=\"line\">-m ä»¥MBä¸ºå•ä½æ˜¾ç¤ºæ–‡ä»¶å¤§å°</span><br><span class=\"line\">-g ä»¥GBä¸ºå•ä½æ˜¾ç¤ºæ–‡ä»¶å¤§å°</span><br><span class=\"line\">-h ä»¥æ˜“è¯»æ–¹å¼æ˜¾ç¤ºæ–‡ä»¶å¤§å°</span><br><span class=\"line\">-s ä»…æ˜¾ç¤ºæ€»è®¡</span><br><span class=\"line\">-cæˆ–--total  é™¤äº†æ˜¾ç¤ºä¸ªåˆ«ç›®å½•æˆ–æ–‡ä»¶çš„å¤§å°å¤–ï¼ŒåŒæ—¶ä¹Ÿæ˜¾ç¤ºæ‰€æœ‰ç›®å½•æˆ–æ–‡ä»¶çš„æ€»å’Œ</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰ä»¥æ˜“è¯»æ–¹å¼æ˜¾ç¤ºæ–‡ä»¶å¤¹å†…åŠå­æ–‡ä»¶å¤¹å¤§å°</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">du -h scf/</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰ä»¥æ˜“è¯»æ–¹å¼æ˜¾ç¤ºæ–‡ä»¶å¤¹å†…æ‰€æœ‰æ–‡ä»¶å¤§å°</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">du -ah scf/</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ3ï¼‰æ˜¾ç¤ºå‡ ä¸ªæ–‡ä»¶æˆ–ç›®å½•å„è‡ªå ç”¨ç£ç›˜ç©ºé—´çš„å¤§å°ï¼Œè¿˜ç»Ÿè®¡å®ƒä»¬çš„æ€»å’Œ</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">du -hc test/ scf/</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ4ï¼‰è¾“å‡ºå½“å‰ç›®å½•ä¸‹å„ä¸ªå­ç›®å½•æ‰€ä½¿ç”¨çš„ç©ºé—´</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">du -hc --max-depth=1 scf/</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"lså‘½ä»¤\"><a href=\"#lså‘½ä»¤\" class=\"headerlink\" title=\"lså‘½ä»¤\"></a>lså‘½ä»¤</h3><p>å°±æ˜¯ list çš„ç¼©å†™ï¼Œé€šè¿‡ ls å‘½ä»¤ä¸ä»…å¯ä»¥æŸ¥çœ‹ linux æ–‡ä»¶å¤¹åŒ…å«çš„æ–‡ä»¶ï¼Œè€Œä¸”å¯ä»¥æŸ¥çœ‹æ–‡ä»¶æƒé™(åŒ…æ‹¬ç›®å½•ã€æ–‡ä»¶å¤¹ã€æ–‡ä»¶æƒé™)î€‚æŸ¥çœ‹ç›®å½•ä¿¡æ¯ç­‰ç­‰ã€‚</p>\n<p><strong>å¸¸ç”¨å‚æ•°æ­é…</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ls -a åˆ—å‡ºç›®å½•æ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…å«ä»¥.å¼€å§‹çš„éšè—æ–‡ä»¶</span><br><span class=\"line\">ls -A åˆ—å‡ºé™¤.åŠ..çš„å…¶å®ƒæ–‡ä»¶</span><br><span class=\"line\">ls -r ååºæ’åˆ—</span><br><span class=\"line\">ls -t ä»¥æ–‡ä»¶ä¿®æ”¹æ—¶é—´æ’åº</span><br><span class=\"line\">ls -S ä»¥æ–‡ä»¶å¤§å°æ’åº</span><br><span class=\"line\">ls -h ä»¥æ˜“è¯»å¤§å°æ˜¾ç¤º</span><br><span class=\"line\">ls -l é™¤äº†æ–‡ä»¶åä¹‹å¤–ï¼Œè¿˜å°†æ–‡ä»¶çš„æƒé™ã€æ‰€æœ‰è€…ã€æ–‡ä»¶å¤§å°ç­‰ä¿¡æ¯è¯¦ç»†åˆ—å‡ºæ¥</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>(1) æŒ‰æ˜“è¯»æ–¹å¼æŒ‰æ—¶é—´ååºæ’åºï¼Œå¹¶æ˜¾ç¤ºæ–‡ä»¶è¯¦ç»†ä¿¡æ¯</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ls -lhrt</span><br></pre></td></tr></table></figure>\n\n<p>(2) æŒ‰å¤§å°ååºæ˜¾ç¤ºæ–‡ä»¶è¯¦ç»†ä¿¡æ¯</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ls -lrS</span><br></pre></td></tr></table></figure>\n\n<p>(3)åˆ—å‡ºå½“å‰ç›®å½•ä¸­æ‰€æœ‰ä»¥â€tâ€å¼€å¤´çš„ç›®å½•çš„è¯¦ç»†å†…å®¹</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ls -l t*</span><br></pre></td></tr></table></figure>\n\n<p>(4) åˆ—å‡ºæ–‡ä»¶ç»å¯¹è·¯å¾„ï¼ˆä¸åŒ…å«éšè—æ–‡ä»¶ï¼‰</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ls | sed &quot;s:^:`pwd`/:&quot;</span><br></pre></td></tr></table></figure>\n\n<p>(5) åˆ—å‡ºæ–‡ä»¶ç»å¯¹è·¯å¾„ï¼ˆåŒ…å«éšè—æ–‡ä»¶ï¼‰</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">find $pwd -maxdepth 1 | xargs ls -ld</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"mkdir-å‘½ä»¤\"><a href=\"#mkdir-å‘½ä»¤\" class=\"headerlink\" title=\"mkdir å‘½ä»¤\"></a>mkdir å‘½ä»¤</h3><p>mkdir å‘½ä»¤ç”¨äºåˆ›å»ºæ–‡ä»¶å¤¹ã€‚</p>\n<p>å¯ç”¨é€‰é¡¹ï¼š</p>\n<ul>\n<li><strong>-m</strong>: å¯¹æ–°å»ºç›®å½•è®¾ç½®å­˜å–æƒé™ï¼Œä¹Ÿå¯ä»¥ç”¨ chmod å‘½ä»¤è®¾ç½®;</li>\n<li><strong>-p</strong>: å¯ä»¥æ˜¯ä¸€ä¸ªè·¯å¾„åç§°ã€‚æ­¤æ—¶è‹¥è·¯å¾„ä¸­çš„æŸäº›ç›®å½•å°šä¸å­˜åœ¨,åŠ ä¸Šæ­¤é€‰é¡¹åï¼Œç³»ç»Ÿå°†è‡ªåŠ¨å»ºç«‹å¥½é‚£äº›å°šä¸åœ¨çš„ç›®å½•ï¼Œå³ä¸€æ¬¡å¯ä»¥å»ºç«‹å¤šä¸ªç›®å½•ã€‚</li>\n</ul>\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰å½“å‰å·¥ä½œç›®å½•ä¸‹åˆ›å»ºåä¸º t çš„æ–‡ä»¶å¤¹</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir t</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰åœ¨ tmp ç›®å½•ä¸‹åˆ›å»ºè·¯å¾„ä¸º test&#x2F;t1&#x2F;t çš„ç›®å½•ï¼Œè‹¥ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir -p /tmp/test/t1/t</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"pwd-å‘½ä»¤\"><a href=\"#pwd-å‘½ä»¤\" class=\"headerlink\" title=\"pwd å‘½ä»¤\"></a>pwd å‘½ä»¤</h3><p>pwd å‘½ä»¤ç”¨äºæŸ¥çœ‹å½“å‰å·¥ä½œç›®å½•è·¯å¾„ã€‚</p>\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰æŸ¥çœ‹å½“å‰è·¯å¾„</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pwd</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰æŸ¥çœ‹è½¯é“¾æ¥çš„å®é™…è·¯å¾„</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pwd -P</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"rmdir-å‘½ä»¤\"><a href=\"#rmdir-å‘½ä»¤\" class=\"headerlink\" title=\"rmdir å‘½ä»¤\"></a>rmdir å‘½ä»¤</h3><p>ä»ä¸€ä¸ªç›®å½•ä¸­åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªå­ç›®å½•é¡¹ï¼Œåˆ é™¤æŸç›®å½•æ—¶ä¹Ÿå¿…é¡»å…·æœ‰å¯¹å…¶çˆ¶ç›®å½•çš„å†™æƒé™ã€‚</p>\n<p><strong>æ³¨æ„</strong>ï¼šä¸èƒ½åˆ é™¤éç©ºç›®å½•</p>\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰å½“ parent å­ç›®å½•è¢«åˆ é™¤åä½¿å®ƒä¹Ÿæˆä¸ºç©ºç›®å½•çš„è¯ï¼Œåˆ™é¡ºä¾¿ä¸€å¹¶åˆ é™¤ï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rmdir -p parent/child/child11</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"ç½‘ç»œé€šè®¯å‘½ä»¤\"><a href=\"#ç½‘ç»œé€šè®¯å‘½ä»¤\" class=\"headerlink\" title=\"ç½‘ç»œé€šè®¯å‘½ä»¤\"></a>ç½‘ç»œé€šè®¯å‘½ä»¤</h2><h3 id=\"ifconfig-å‘½ä»¤\"><a href=\"#ifconfig-å‘½ä»¤\" class=\"headerlink\" title=\"ifconfig å‘½ä»¤\"></a>ifconfig å‘½ä»¤</h3><ul>\n<li>ifconfig ç”¨äºæŸ¥çœ‹å’Œé…ç½® Linux ç³»ç»Ÿçš„ç½‘ç»œæ¥å£ã€‚</li>\n<li>æŸ¥çœ‹æ‰€æœ‰ç½‘ç»œæ¥å£åŠå…¶çŠ¶æ€ï¼š<code>ifconfig -a</code> ã€‚</li>\n<li>ä½¿ç”¨ up å’Œ down å‘½ä»¤å¯åŠ¨æˆ–åœæ­¢æŸä¸ªæ¥å£ï¼š<code>ifconfig eth0 up</code> å’Œ <code>ifconfig eth0 down</code> ã€‚</li>\n</ul>\n<h3 id=\"iptables-å‘½ä»¤\"><a href=\"#iptables-å‘½ä»¤\" class=\"headerlink\" title=\"iptables å‘½ä»¤\"></a>iptables å‘½ä»¤</h3><p>iptables ï¼Œæ˜¯ä¸€ä¸ªé…ç½® Linux å†…æ ¸é˜²ç«å¢™çš„å‘½ä»¤è¡Œå·¥å…·ã€‚åŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œå¯¹äºæˆ‘ä»¬å¼€å‘æ¥è¯´ï¼Œä¸»è¦æŒæ¡å¦‚ä½•å¼€æ”¾ç«¯å£å³å¯ã€‚ä¾‹å¦‚ï¼š</p>\n<ul>\n<li><p>æŠŠæ¥æº IP ä¸º 192.168.1.101 è®¿é—®æœ¬æœº 80 ç«¯å£çš„åŒ…ç›´æ¥æ‹’ç»ï¼š<code>iptables -I INPUT -s 192.168.1.101 -p tcp --dport 80 -j REJECT</code> ã€‚</p>\n</li>\n<li><p>å¼€å¯ 80 ç«¯å£ï¼Œå› ä¸º web å¯¹å¤–éƒ½æ˜¯è¿™ä¸ªç«¯å£</p>\n  <figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">iptables -A INPUT -p tcp --dport 80 -j ACCEP</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>å¦å¤–ï¼Œè¦æ³¨æ„ä½¿ç”¨ <code>iptables save</code> å‘½ä»¤ï¼Œè¿›è¡Œä¿å­˜ã€‚å¦åˆ™ï¼ŒæœåŠ¡å™¨é‡å¯åï¼Œé…ç½®çš„è§„åˆ™å°†ä¸¢å¤±ã€‚</p>\n</li>\n</ul>\n<h3 id=\"netstat-å‘½ä»¤\"><a href=\"#netstat-å‘½ä»¤\" class=\"headerlink\" title=\"netstat å‘½ä»¤\"></a>netstat å‘½ä»¤</h3><p>Linux netstat å‘½ä»¤ç”¨äºæ˜¾ç¤ºç½‘ç»œçŠ¶æ€ã€‚</p>\n<p>åˆ©ç”¨ netstat æŒ‡ä»¤å¯è®©ä½ å¾—çŸ¥æ•´ä¸ª Linux ç³»ç»Ÿçš„ç½‘ç»œæƒ…å†µã€‚</p>\n<p>è¯­æ³•</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">netstat [-acCeFghilMnNoprstuvVwx][-A&lt;ç½‘ç»œç±»å‹&gt;][--ip]</span><br></pre></td></tr></table></figure>\n\n<p><strong>å‚æ•°è¯´æ˜</strong>ï¼š</p>\n<ul>\n<li>-a æˆ–â€“all æ˜¾ç¤ºæ‰€æœ‰è¿çº¿ä¸­çš„ Socketã€‚</li>\n<li>-A&lt;ç½‘ç»œç±»å‹&gt;æˆ–â€“&lt;ç½‘ç»œç±»å‹&gt; åˆ—å‡ºè¯¥ç½‘ç»œç±»å‹è¿çº¿ä¸­çš„ç›¸å…³åœ°å€ã€‚</li>\n<li>-c æˆ–â€“continuous æŒç»­åˆ—å‡ºç½‘ç»œçŠ¶æ€ã€‚</li>\n<li>-C æˆ–â€“cache æ˜¾ç¤ºè·¯ç”±å™¨é…ç½®çš„å¿«å–ä¿¡æ¯ã€‚</li>\n<li>-e æˆ–â€“extend æ˜¾ç¤ºç½‘ç»œå…¶ä»–ç›¸å…³ä¿¡æ¯ã€‚</li>\n<li>-F æˆ–â€“fib æ˜¾ç¤º FIBã€‚</li>\n<li>-g æˆ–â€“groups æ˜¾ç¤ºå¤šé‡å¹¿æ’­åŠŸèƒ½ç¾¤ç»„ç»„å‘˜åå•ã€‚</li>\n<li>-h æˆ–â€“help åœ¨çº¿å¸®åŠ©ã€‚</li>\n<li>-i æˆ–â€“interfaces æ˜¾ç¤ºç½‘ç»œç•Œé¢ä¿¡æ¯è¡¨å•ã€‚</li>\n<li>-l æˆ–â€“listening æ˜¾ç¤ºç›‘æ§ä¸­çš„æœåŠ¡å™¨çš„ Socketã€‚</li>\n<li>-M æˆ–â€“masquerade æ˜¾ç¤ºä¼ªè£…çš„ç½‘ç»œè¿çº¿ã€‚</li>\n<li>-n æˆ–â€“numeric ç›´æ¥ä½¿ç”¨ IP åœ°å€ï¼Œè€Œä¸é€šè¿‡åŸŸåæœåŠ¡å™¨ã€‚</li>\n<li>-N æˆ–â€“netlink æˆ–â€“symbolic æ˜¾ç¤ºç½‘ç»œç¡¬ä»¶å¤–å›´è®¾å¤‡çš„ç¬¦å·è¿æ¥åç§°ã€‚</li>\n<li>-o æˆ–â€“timers æ˜¾ç¤ºè®¡æ—¶å™¨ã€‚</li>\n<li>-p æˆ–â€“programs æ˜¾ç¤ºæ­£åœ¨ä½¿ç”¨ Socket çš„ç¨‹åºè¯†åˆ«ç å’Œç¨‹åºåç§°ã€‚</li>\n<li>-r æˆ–â€“route æ˜¾ç¤º Routing Tableã€‚</li>\n<li>-s æˆ–â€“statistice æ˜¾ç¤ºç½‘ç»œå·¥ä½œä¿¡æ¯ç»Ÿè®¡è¡¨ã€‚</li>\n<li>-t æˆ–â€“tcp æ˜¾ç¤º TCP ä¼ è¾“åè®®çš„è¿çº¿çŠ¶å†µã€‚</li>\n<li>-u æˆ–â€“udp æ˜¾ç¤º UDP ä¼ è¾“åè®®çš„è¿çº¿çŠ¶å†µã€‚</li>\n<li>-v æˆ–â€“verbose æ˜¾ç¤ºæŒ‡ä»¤æ‰§è¡Œè¿‡ç¨‹ã€‚</li>\n<li>-V æˆ–â€“version æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ã€‚</li>\n<li>-w æˆ–â€“raw æ˜¾ç¤º RAW ä¼ è¾“åè®®çš„è¿çº¿çŠ¶å†µã€‚</li>\n<li>-x æˆ–â€“unix æ­¤å‚æ•°çš„æ•ˆæœå’ŒæŒ‡å®šâ€-A unixâ€å‚æ•°ç›¸åŒã€‚</li>\n<li>â€“ip æˆ–â€“inet æ­¤å‚æ•°çš„æ•ˆæœå’ŒæŒ‡å®šâ€-A inetâ€å‚æ•°ç›¸åŒã€‚</li>\n</ul>\n<p><strong>å®ä¾‹</strong></p>\n<p><strong>å¦‚ä½•æŸ¥çœ‹ç³»ç»Ÿéƒ½å¼€å¯äº†å“ªäº›ç«¯å£ï¼Ÿ</strong></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@centos6 ~ 13:20 #55]# netstat -lnp</span><br><span class=\"line\">Active Internet connections (only servers)</span><br><span class=\"line\">Proto Recv-Q Send-Q Local Address               Foreign Address             State       PID/Program name</span><br><span class=\"line\">tcp        0      0 0.0.0.0:22                  0.0.0.0:*                   LISTEN      1035/sshd</span><br><span class=\"line\">tcp        0      0 :::22                       :::*                        LISTEN      1035/sshd</span><br><span class=\"line\">udp        0      0 0.0.0.0:68                  0.0.0.0:*                               931/dhclient</span><br><span class=\"line\">Active UNIX domain sockets (only servers)</span><br><span class=\"line\">Proto RefCnt Flags       Type       State         I-Node PID/Program name    Path</span><br><span class=\"line\">unix  2      [ ACC ]     STREAM     LISTENING     6825   1/init              @/com/ubuntu/upstart</span><br><span class=\"line\">unix  2      [ ACC ]     STREAM     LISTENING     8429   1003/dbus-daemon    /var/run/dbus/system_bus_socket</span><br></pre></td></tr></table></figure>\n\n<p><strong>å¦‚ä½•æŸ¥çœ‹ç½‘ç»œè¿æ¥çŠ¶å†µï¼Ÿ</strong></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@centos6 ~ 13:22 #58]# netstat -an</span><br><span class=\"line\">Active Internet connections (servers and established)</span><br><span class=\"line\">Proto Recv-Q Send-Q Local Address               Foreign Address             State</span><br><span class=\"line\">tcp        0      0 0.0.0.0:22                  0.0.0.0:*                   LISTEN</span><br><span class=\"line\">tcp        0      0 192.168.147.130:22          192.168.147.1:23893         ESTABLISHED</span><br><span class=\"line\">tcp        0      0 :::22                       :::*                        LISTEN</span><br><span class=\"line\">udp        0      0 0.0.0.0:68                  0.0.0.0:*</span><br></pre></td></tr></table></figure>\n\n<p><strong>å¦‚ä½•ç»Ÿè®¡ç³»ç»Ÿå½“å‰è¿›ç¨‹è¿æ¥æ•°ï¼Ÿ</strong></p>\n<ul>\n<li>è¾“å…¥å‘½ä»¤ <code>netstat -an | grep ESTABLISHED | wc -l</code> ã€‚</li>\n<li>è¾“å‡ºç»“æœ <code>177</code> ã€‚ä¸€å…±æœ‰ 177 è¿æ¥æ•°ã€‚</li>\n</ul>\n<p><strong>ç”¨ netstat å‘½ä»¤é…åˆå…¶ä»–å‘½ä»¤ï¼ŒæŒ‰ç…§æº IP ç»Ÿè®¡æ‰€æœ‰åˆ° 80 ç«¯å£çš„ ESTABLISHED çŠ¶æ€é“¾æ¥çš„ä¸ªæ•°ï¼Ÿ</strong></p>\n<blockquote>\n<p>ä¸¥æ ¼æ¥è¯´ï¼Œè¿™ä¸ªé¢˜ç›®è€ƒéªŒçš„æ˜¯å¯¹ awk çš„ä½¿ç”¨ã€‚</p>\n</blockquote>\n<p>é¦–å…ˆï¼Œä½¿ç”¨ <code>netstat -an|grep ESTABLISHED</code> å‘½ä»¤ã€‚ç»“æœå¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tcp        0      0 120.27.146.122:80       113.65.18.33:62721      ESTABLISHED</span><br><span class=\"line\">tcp        0      0 120.27.146.122:80       27.43.83.115:47148      ESTABLISHED</span><br><span class=\"line\">tcp        0      0 120.27.146.122:58838    106.39.162.96:443       ESTABLISHED</span><br><span class=\"line\">tcp        0      0 120.27.146.122:52304    203.208.40.121:443      ESTABLISHED</span><br><span class=\"line\">tcp        0      0 120.27.146.122:33194    203.208.40.122:443      ESTABLISHED</span><br><span class=\"line\">tcp        0      0 120.27.146.122:53758    101.37.183.144:443      ESTABLISHED</span><br><span class=\"line\">tcp        0      0 120.27.146.122:27017    23.105.193.30:50556     ESTABLISHED</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"ping-å‘½ä»¤\"><a href=\"#ping-å‘½ä»¤\" class=\"headerlink\" title=\"ping å‘½ä»¤\"></a>ping å‘½ä»¤</h3><p>Linux ping å‘½ä»¤ç”¨äºæ£€æµ‹ä¸»æœºã€‚</p>\n<p>æ‰§è¡Œ ping æŒ‡ä»¤ä¼šä½¿ç”¨ ICMP ä¼ è¾“åè®®ï¼Œå‘å‡ºè¦æ±‚å›åº”çš„ä¿¡æ¯ï¼Œè‹¥è¿œç«¯ä¸»æœºçš„ç½‘ç»œåŠŸèƒ½æ²¡æœ‰é—®é¢˜ï¼Œå°±ä¼šå›åº”è¯¥ä¿¡æ¯ï¼Œå› è€Œå¾—çŸ¥è¯¥ä¸»æœºè¿ä½œæ­£å¸¸ã€‚</p>\n<p>æŒ‡å®šæ¥æ”¶åŒ…çš„æ¬¡æ•°</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ping -c 2 www.baidu.com</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"telnet-å‘½ä»¤\"><a href=\"#telnet-å‘½ä»¤\" class=\"headerlink\" title=\"telnet å‘½ä»¤\"></a>telnet å‘½ä»¤</h3><p>Linux telnet å‘½ä»¤ç”¨äºè¿œç«¯ç™»å…¥ã€‚</p>\n<p>æ‰§è¡Œ telnet æŒ‡ä»¤å¼€å¯ç»ˆç«¯æœºé˜¶æ®µä½œä¸šï¼Œå¹¶ç™»å…¥è¿œç«¯ä¸»æœºã€‚</p>\n<p>è¯­æ³•</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">telnet [-8acdEfFKLrx][-b&lt;ä¸»æœºåˆ«å&gt;][-e&lt;è„±ç¦»å­—ç¬¦&gt;][-k&lt;åŸŸå&gt;][-l&lt;ç”¨æˆ·åç§°&gt;][-n&lt;è®°å½•æ–‡ä»¶&gt;][-S&lt;æœåŠ¡ç±»å‹&gt;][-X&lt;è®¤è¯å½¢æ€&gt;][ä¸»æœºåç§°æˆ–IPåœ°å€&lt;é€šä¿¡ç«¯å£&gt;]</span><br></pre></td></tr></table></figure>\n\n<p><strong>å‚æ•°è¯´æ˜</strong>ï¼š</p>\n<ul>\n<li>-8 å…è®¸ä½¿ç”¨ 8 ä½å­—ç¬¦èµ„æ–™ï¼ŒåŒ…æ‹¬è¾“å…¥ä¸è¾“å‡ºã€‚</li>\n<li>-a å°è¯•è‡ªåŠ¨ç™»å…¥è¿œç«¯ç³»ç»Ÿã€‚</li>\n<li>-b&lt;ä¸»æœºåˆ«å&gt; ä½¿ç”¨åˆ«åæŒ‡å®šè¿œç«¯ä¸»æœºåç§°ã€‚</li>\n<li>-c ä¸è¯»å–ç”¨æˆ·ä¸“å±ç›®å½•é‡Œçš„.telnetrc æ–‡ä»¶ã€‚</li>\n<li>-d å¯åŠ¨æ’é”™æ¨¡å¼ã€‚</li>\n<li>-e&lt;è„±ç¦»å­—ç¬¦&gt; è®¾ç½®è„±ç¦»å­—ç¬¦ã€‚</li>\n<li>-E æ»¤é™¤è„±ç¦»å­—ç¬¦ã€‚</li>\n<li>-f æ­¤å‚æ•°çš„æ•ˆæœå’ŒæŒ‡å®šâ€-Fâ€å‚æ•°ç›¸åŒã€‚</li>\n<li>-F ä½¿ç”¨ Kerberos V5 è®¤è¯æ—¶ï¼ŒåŠ ä¸Šæ­¤å‚æ•°å¯æŠŠæœ¬åœ°ä¸»æœºçš„è®¤è¯æ•°æ®ä¸Šä¼ åˆ°è¿œç«¯ä¸»æœºã€‚</li>\n<li>-k&lt;åŸŸå&gt; ä½¿ç”¨ Kerberos è®¤è¯æ—¶ï¼ŒåŠ ä¸Šæ­¤å‚æ•°è®©è¿œç«¯ä¸»æœºé‡‡ç”¨æŒ‡å®šçš„é¢†åŸŸåï¼Œè€Œéè¯¥ä¸»æœºçš„åŸŸåã€‚</li>\n<li>-K ä¸è‡ªåŠ¨ç™»å…¥è¿œç«¯ä¸»æœºã€‚</li>\n<li>-l&lt;ç”¨æˆ·åç§°&gt; æŒ‡å®šè¦ç™»å…¥è¿œç«¯ä¸»æœºçš„ç”¨æˆ·åç§°ã€‚</li>\n<li>-L å…è®¸è¾“å‡º 8 ä½å­—ç¬¦èµ„æ–™ã€‚</li>\n<li>-n&lt;è®°å½•æ–‡ä»¶&gt; æŒ‡å®šæ–‡ä»¶è®°å½•ç›¸å…³ä¿¡æ¯ã€‚</li>\n<li>-r ä½¿ç”¨ç±»ä¼¼ rlogin æŒ‡ä»¤çš„ç”¨æˆ·ç•Œé¢ã€‚</li>\n<li>-S&lt;æœåŠ¡ç±»å‹&gt; è®¾ç½® telnet è¿çº¿æ‰€éœ€çš„ IP TOS ä¿¡æ¯ã€‚</li>\n<li>-x å‡è®¾ä¸»æœºæœ‰æ”¯æŒæ•°æ®åŠ å¯†çš„åŠŸèƒ½ï¼Œå°±ä½¿ç”¨å®ƒã€‚</li>\n<li>-X&lt;è®¤è¯å½¢æ€&gt; å…³é—­æŒ‡å®šçš„è®¤è¯å½¢æ€ã€‚</li>\n</ul>\n<p><strong>å®ä¾‹</strong></p>\n<p>ç™»å½•è¿œç¨‹ä¸»æœº</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">ç™»å½•IPä¸º 192.168.0.5 çš„è¿œç¨‹ä¸»æœº</span></span><br><span class=\"line\">telnet 192.168.0.5 </span><br></pre></td></tr></table></figure>\n\n<h2 id=\"ç³»ç»Ÿç®¡ç†å‘½ä»¤\"><a href=\"#ç³»ç»Ÿç®¡ç†å‘½ä»¤\" class=\"headerlink\" title=\"ç³»ç»Ÿç®¡ç†å‘½ä»¤\"></a>ç³»ç»Ÿç®¡ç†å‘½ä»¤</h2><h3 id=\"date-å‘½ä»¤\"><a href=\"#date-å‘½ä»¤\" class=\"headerlink\" title=\"date å‘½ä»¤\"></a>date å‘½ä»¤</h3><p>æ˜¾ç¤ºæˆ–è®¾å®šç³»ç»Ÿçš„æ—¥æœŸä¸æ—¶é—´ã€‚</p>\n<p>å‘½ä»¤å‚æ•°ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-d&lt;å­—ç¬¦ä¸²&gt; ã€€æ˜¾ç¤ºå­—ç¬¦ä¸²æ‰€æŒ‡çš„æ—¥æœŸä¸æ—¶é—´ã€‚å­—ç¬¦ä¸²å‰åå¿…é¡»åŠ ä¸ŠåŒå¼•å·ã€‚</span><br><span class=\"line\">-s&lt;å­—ç¬¦ä¸²&gt; ã€€æ ¹æ®å­—ç¬¦ä¸²æ¥è®¾ç½®æ—¥æœŸä¸æ—¶é—´ã€‚å­—ç¬¦ä¸²å‰åå¿…é¡»åŠ ä¸ŠåŒå¼•å·ã€‚</span><br><span class=\"line\">-u ã€€æ˜¾ç¤ºGMTã€‚</span><br><span class=\"line\">%H å°æ—¶(00-23)</span><br><span class=\"line\">%I å°æ—¶(00-12)</span><br><span class=\"line\">%M åˆ†é’Ÿ(ä»¥00-59æ¥è¡¨ç¤º)</span><br><span class=\"line\">%s æ€»ç§’æ•°ã€‚èµ·ç®—æ—¶é—´ä¸º1970-01-01 00:00:00 UTCã€‚</span><br><span class=\"line\">%S ç§’(ä»¥æœ¬åœ°çš„æƒ¯ç”¨æ³•æ¥è¡¨ç¤º)</span><br><span class=\"line\">%a æ˜ŸæœŸçš„ç¼©å†™ã€‚</span><br><span class=\"line\">%A æ˜ŸæœŸçš„å®Œæ•´åç§°ã€‚</span><br><span class=\"line\">%d æ—¥æœŸ(ä»¥01-31æ¥è¡¨ç¤º)ã€‚</span><br><span class=\"line\">%D æ—¥æœŸ(å«å¹´æœˆæ—¥)ã€‚</span><br><span class=\"line\">%m æœˆä»½(ä»¥01-12æ¥è¡¨ç¤º)ã€‚</span><br><span class=\"line\">%y å¹´ä»½(ä»¥00-99æ¥è¡¨ç¤º)ã€‚</span><br><span class=\"line\">%Y å¹´ä»½(ä»¥å››ä½æ•°æ¥è¡¨ç¤º)ã€‚</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰æ˜¾ç¤ºä¸‹ä¸€å¤©</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">date +%Y%m%d --date=&quot;+1 day&quot;  //æ˜¾ç¤ºä¸‹ä¸€å¤©çš„æ—¥æœŸ</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰-d å‚æ•°ä½¿ç”¨</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">date -d &quot;nov 22&quot;  ä»Šå¹´çš„ 11 æœˆ 22 æ—¥æ˜¯æ˜ŸæœŸä¸‰</span><br><span class=\"line\">date -d &#x27;2 weeks&#x27; 2å‘¨åçš„æ—¥æœŸ</span><br><span class=\"line\">date -d &#x27;next monday&#x27; (ä¸‹å‘¨ä¸€çš„æ—¥æœŸ)</span><br><span class=\"line\">date -d next-day +%Y%m%dï¼ˆæ˜å¤©çš„æ—¥æœŸï¼‰æˆ–è€…ï¼šdate -d tomorrow +%Y%m%d</span><br><span class=\"line\">date -d last-day +%Y%m%d(æ˜¨å¤©çš„æ—¥æœŸ) æˆ–è€…ï¼šdate -d yesterday +%Y%m%d</span><br><span class=\"line\">date -d last-month +%Y%m(ä¸Šä¸ªæœˆæ˜¯å‡ æœˆ)</span><br><span class=\"line\">date -d next-month +%Y%m(ä¸‹ä¸ªæœˆæ˜¯å‡ æœˆ)</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"free-å‘½ä»¤\"><a href=\"#free-å‘½ä»¤\" class=\"headerlink\" title=\"free å‘½ä»¤\"></a>free å‘½ä»¤</h3><p>æ˜¾ç¤ºç³»ç»Ÿå†…å­˜ä½¿ç”¨æƒ…å†µï¼ŒåŒ…æ‹¬ç‰©ç†å†…å­˜ã€äº¤äº’åŒºå†…å­˜(swap)å’Œå†…æ ¸ç¼“å†²åŒºå†…å­˜ã€‚</p>\n<p><strong>å‘½ä»¤å‚æ•°</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-b ä»¥Byteæ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ</span><br><span class=\"line\">-k ä»¥kbä¸ºå•ä½æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ</span><br><span class=\"line\">-m ä»¥mbä¸ºå•ä½æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ</span><br><span class=\"line\">-g ä»¥gbä¸ºå•ä½æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ</span><br><span class=\"line\">-s&lt;é—´éš”ç§’æ•°&gt; æŒç»­æ˜¾ç¤ºå†…å­˜</span><br><span class=\"line\">-t æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æ€»åˆ</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">free</span><br><span class=\"line\">free -k</span><br><span class=\"line\">free -m</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰ä»¥æ€»å’Œçš„å½¢å¼æ˜¾ç¤ºå†…å­˜çš„ä½¿ç”¨ä¿¡æ¯</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">free -t</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ3ï¼‰å‘¨æœŸæ€§æŸ¥è¯¢å†…å­˜ä½¿ç”¨æƒ…å†µ</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">free -s 10</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"kill-å‘½ä»¤\"><a href=\"#kill-å‘½ä»¤\" class=\"headerlink\" title=\"kill å‘½ä»¤\"></a>kill å‘½ä»¤</h3><p>å‘é€æŒ‡å®šçš„ä¿¡å·åˆ°ç›¸åº”è¿›ç¨‹ã€‚ä¸æŒ‡å®šå‹å·å°†å‘é€ SIGTERMï¼ˆ15ï¼‰ç»ˆæ­¢æŒ‡å®šè¿›ç¨‹ã€‚å¦‚æœä»»æ— æ³•ç»ˆæ­¢è¯¥ç¨‹åºå¯ç”¨â€-KILLâ€ å‚æ•°ï¼Œå…¶å‘é€çš„ä¿¡å·ä¸º SIGKILL(9) ï¼Œå°†å¼ºåˆ¶ç»“æŸè¿›ç¨‹ï¼Œä½¿ç”¨ ps å‘½ä»¤æˆ–è€… jobs å‘½ä»¤å¯ä»¥æŸ¥çœ‹è¿›ç¨‹å·ã€‚root ç”¨æˆ·å°†å½±å“ç”¨æˆ·çš„è¿›ç¨‹ï¼Œé root ç”¨æˆ·åªèƒ½å½±å“è‡ªå·±çš„è¿›ç¨‹ã€‚</p>\n<p><strong>å¸¸ç”¨å‚æ•°</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-l  ä¿¡å·ï¼Œè‹¥æœä¸åŠ ä¿¡å·çš„ç¼–å·å‚æ•°ï¼Œåˆ™ä½¿ç”¨â€œ-lâ€å‚æ•°ä¼šåˆ—å‡ºå…¨éƒ¨çš„ä¿¡å·åç§°</span><br><span class=\"line\">-a  å½“å¤„ç†å½“å‰è¿›ç¨‹æ—¶ï¼Œä¸é™åˆ¶å‘½ä»¤åå’Œè¿›ç¨‹å·çš„å¯¹åº”å…³ç³»</span><br><span class=\"line\">-p  æŒ‡å®škill å‘½ä»¤åªæ‰“å°ç›¸å…³è¿›ç¨‹çš„è¿›ç¨‹å·ï¼Œè€Œä¸å‘é€ä»»ä½•ä¿¡å·</span><br><span class=\"line\">-s  æŒ‡å®šå‘é€ä¿¡å·</span><br><span class=\"line\">-u  æŒ‡å®šç”¨æˆ·</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰å…ˆä½¿ç”¨ ps æŸ¥æ‰¾è¿›ç¨‹ pro1ï¼Œç„¶åç”¨ kill æ€æ‰</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">kill -9 $(ps -ef | grep pro1)</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"ps-å‘½ä»¤\"><a href=\"#ps-å‘½ä»¤\" class=\"headerlink\" title=\"ps å‘½ä»¤\"></a>ps å‘½ä»¤</h3><p>ps(process status)ï¼Œç”¨æ¥æŸ¥çœ‹å½“å‰è¿è¡Œçš„è¿›ç¨‹çŠ¶æ€ï¼Œä¸€æ¬¡æ€§æŸ¥çœ‹ï¼Œå¦‚æœéœ€è¦åŠ¨æ€è¿ç»­ç»“æœä½¿ç”¨ top</p>\n<p>linux ä¸Šè¿›ç¨‹æœ‰ 5 ç§çŠ¶æ€:</p>\n<ol>\n<li>è¿è¡Œ(æ­£åœ¨è¿è¡Œæˆ–åœ¨è¿è¡Œé˜Ÿåˆ—ä¸­ç­‰å¾…)</li>\n<li>ä¸­æ–­(ä¼‘çœ ä¸­, å—é˜», åœ¨ç­‰å¾…æŸä¸ªæ¡ä»¶çš„å½¢æˆæˆ–æ¥å—åˆ°ä¿¡å·)</li>\n<li>ä¸å¯ä¸­æ–­(æ”¶åˆ°ä¿¡å·ä¸å”¤é†’å’Œä¸å¯è¿è¡Œ, è¿›ç¨‹å¿…é¡»ç­‰å¾…ç›´åˆ°æœ‰ä¸­æ–­å‘ç”Ÿ)</li>\n<li>åƒµæ­»(è¿›ç¨‹å·²ç»ˆæ­¢, ä½†è¿›ç¨‹æè¿°ç¬¦å­˜åœ¨, ç›´åˆ°çˆ¶è¿›ç¨‹è°ƒç”¨ wait4()ç³»ç»Ÿè°ƒç”¨åé‡Šæ”¾)</li>\n<li>åœæ­¢(è¿›ç¨‹æ”¶åˆ° SIGSTOP, SIGSTP, SIGTIN, SIGTOU ä¿¡å·ååœæ­¢è¿è¡Œè¿è¡Œ)</li>\n</ol>\n<p>ps å·¥å…·æ ‡è¯†è¿›ç¨‹çš„ 5 ç§çŠ¶æ€ç :</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">D ä¸å¯ä¸­æ–­ uninterruptible sleep (usually IO)</span><br><span class=\"line\">R è¿è¡Œ runnable (on run queue)</span><br><span class=\"line\">S ä¸­æ–­ sleeping</span><br><span class=\"line\">T åœæ­¢ traced or stopped</span><br><span class=\"line\">Z åƒµæ­» a defunct (â€zombieâ€) process</span><br></pre></td></tr></table></figure>\n\n<p><strong>å‘½ä»¤å‚æ•°</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-A æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹</span><br><span class=\"line\">a æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹</span><br><span class=\"line\">-a æ˜¾ç¤ºåŒä¸€ç»ˆç«¯ä¸‹æ‰€æœ‰è¿›ç¨‹</span><br><span class=\"line\">c æ˜¾ç¤ºè¿›ç¨‹çœŸå®åç§°</span><br><span class=\"line\">e æ˜¾ç¤ºç¯å¢ƒå˜é‡</span><br><span class=\"line\">f æ˜¾ç¤ºè¿›ç¨‹é—´çš„å…³ç³»</span><br><span class=\"line\">r æ˜¾ç¤ºå½“å‰ç»ˆç«¯è¿è¡Œçš„è¿›ç¨‹</span><br><span class=\"line\">-aux æ˜¾ç¤ºæ‰€æœ‰åŒ…å«å…¶å®ƒä½¿ç”¨çš„è¿›ç¨‹</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰æ˜¾ç¤ºå½“å‰æ‰€æœ‰è¿›ç¨‹ç¯å¢ƒå˜é‡åŠè¿›ç¨‹é—´å…³ç³»</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ps -ef</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰æ˜¾ç¤ºå½“å‰æ‰€æœ‰è¿›ç¨‹</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ps -A</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ3ï¼‰ä¸ grep è”ç”¨æŸ¥æ‰¾æŸè¿›ç¨‹</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ps -aux | grep apache</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ4ï¼‰æ‰¾å‡ºä¸ cron ä¸ syslog è¿™ä¸¤ä¸ªæœåŠ¡æœ‰å…³çš„ PID å·ç </p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ps aux | grep &#x27;(cron|syslog)&#x27;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"rpm-å‘½ä»¤\"><a href=\"#rpm-å‘½ä»¤\" class=\"headerlink\" title=\"rpm å‘½ä»¤\"></a>rpm å‘½ä»¤</h3><p>Linux rpm å‘½ä»¤ç”¨äºç®¡ç†å¥—ä»¶ã€‚</p>\n<p>rpm(redhat package manager) åŸæœ¬æ˜¯ Red Hat Linux å‘è¡Œç‰ˆä¸“é—¨ç”¨æ¥ç®¡ç† Linux å„é¡¹å¥—ä»¶çš„ç¨‹åºï¼Œç”±äºå®ƒéµå¾ª GPL è§„åˆ™ä¸”åŠŸèƒ½å¼ºå¤§æ–¹ä¾¿ï¼Œå› è€Œå¹¿å—æ¬¢è¿ã€‚é€æ¸å—åˆ°å…¶ä»–å‘è¡Œç‰ˆçš„é‡‡ç”¨ã€‚RPM å¥—ä»¶ç®¡ç†æ–¹å¼çš„å‡ºç°ï¼Œè®© Linux æ˜“äºå®‰è£…ï¼Œå‡çº§ï¼Œé—´æ¥æå‡äº† Linux çš„é€‚ç”¨åº¦ã€‚</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">æŸ¥çœ‹ç³»ç»Ÿè‡ªå¸¦jdk</span></span><br><span class=\"line\">rpm -qa | grep jdk</span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">åˆ é™¤ç³»ç»Ÿè‡ªå¸¦jdk</span></span><br><span class=\"line\">rpm -e --nodeps æŸ¥çœ‹jdkæ˜¾ç¤ºçš„æ•°æ®</span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">å®‰è£…jdk</span></span><br><span class=\"line\">rpm -ivh jdk-7u80-linux-x64.rpm</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"top-å‘½ä»¤\"><a href=\"#top-å‘½ä»¤\" class=\"headerlink\" title=\"top å‘½ä»¤\"></a>top å‘½ä»¤</h3><p>æ˜¾ç¤ºå½“å‰ç³»ç»Ÿæ­£åœ¨æ‰§è¡Œçš„è¿›ç¨‹çš„ç›¸å…³ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¿›ç¨‹ IDã€å†…å­˜å ç”¨ç‡ã€CPU å ç”¨ç‡ç­‰</p>\n<p><strong>å¸¸ç”¨å‚æ•°</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-c æ˜¾ç¤ºå®Œæ•´çš„è¿›ç¨‹å‘½ä»¤</span><br><span class=\"line\">-s ä¿å¯†æ¨¡å¼</span><br><span class=\"line\">-p &lt;è¿›ç¨‹å·&gt; æŒ‡å®šè¿›ç¨‹æ˜¾ç¤º</span><br><span class=\"line\">-n &lt;æ¬¡æ•°&gt;å¾ªç¯æ˜¾ç¤ºæ¬¡æ•°</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">top - 14:06:23 up 70 days, 16:44,  2 users,  load average: 1.25, 1.32, 1.35</span><br><span class=\"line\">Tasks: 206 total,   1 running, 205 sleeping,   0 stopped,   0 zombie</span><br><span class=\"line\">Cpu(s):  5.9%us,  3.4%sy,  0.0%ni, 90.4%id,  0.0%wa,  0.0%hi,  0.2%si,  0.0%st</span><br><span class=\"line\">Mem:  32949016k total, 14411180k used, 18537836k free,   169884k buffers</span><br><span class=\"line\">Swap: 32764556k total,        0k used, 32764556k free,  3612636k cached</span><br><span class=\"line\">PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND  </span><br><span class=\"line\">28894 root      22   0 1501m 405m  10m S 52.2  1.3   2534:16 java  </span><br></pre></td></tr></table></figure>\n\n<p>å‰äº”è¡Œæ˜¯å½“å‰ç³»ç»Ÿæƒ…å†µæ•´ä½“çš„ç»Ÿè®¡ä¿¡æ¯åŒºã€‚</p>\n<p><strong>ç¬¬ä¸€è¡Œï¼Œä»»åŠ¡é˜Ÿåˆ—ä¿¡æ¯ï¼ŒåŒ uptime å‘½ä»¤çš„æ‰§è¡Œç»“æœï¼Œå…·ä½“å‚æ•°è¯´æ˜æƒ…å†µå¦‚ä¸‹</strong>ï¼š</p>\n<p>14:06:23 â€” å½“å‰ç³»ç»Ÿæ—¶é—´</p>\n<p>up 70 days, 16:44 â€” ç³»ç»Ÿå·²ç»è¿è¡Œäº† 70 å¤© 16 å°æ—¶ 44 åˆ†é’Ÿï¼ˆåœ¨è¿™æœŸé—´ç³»ç»Ÿæ²¡æœ‰é‡å¯è¿‡çš„å†ï¼ï¼‰</p>\n<p>2 users â€” å½“å‰æœ‰ 2 ä¸ªç”¨æˆ·ç™»å½•ç³»ç»Ÿ</p>\n<p>load average: 1.15, 1.42, 1.44 â€” load average åé¢çš„ä¸‰ä¸ªæ•°åˆ†åˆ«æ˜¯ 1 åˆ†é’Ÿã€5 åˆ†é’Ÿã€15 åˆ†é’Ÿçš„è´Ÿè½½æƒ…å†µã€‚</p>\n<p>load average æ•°æ®æ˜¯æ¯éš” 5 ç§’é’Ÿæ£€æŸ¥ä¸€æ¬¡æ´»è·ƒçš„è¿›ç¨‹æ•°ï¼Œç„¶åæŒ‰ç‰¹å®šç®—æ³•è®¡ç®—å‡ºçš„æ•°å€¼ã€‚å¦‚æœè¿™ä¸ªæ•°é™¤ä»¥é€»è¾‘ CPU çš„æ•°é‡ï¼Œç»“æœé«˜äº 5 çš„æ—¶å€™å°±è¡¨æ˜ç³»ç»Ÿåœ¨è¶…è´Ÿè·è¿è½¬äº†ã€‚</p>\n<p><strong>ç¬¬äºŒè¡Œï¼ŒTasks â€” ä»»åŠ¡ï¼ˆè¿›ç¨‹ï¼‰ï¼Œå…·ä½“ä¿¡æ¯è¯´æ˜å¦‚ä¸‹</strong>ï¼š</p>\n<p>ç³»ç»Ÿç°åœ¨å…±æœ‰ 206 ä¸ªè¿›ç¨‹ï¼Œå…¶ä¸­å¤„äºè¿è¡Œä¸­çš„æœ‰ 1 ä¸ªï¼Œ205 ä¸ªåœ¨ä¼‘çœ ï¼ˆsleepï¼‰ï¼Œstoped çŠ¶æ€çš„æœ‰ 0 ä¸ªï¼Œzombie çŠ¶æ€ï¼ˆåƒµå°¸ï¼‰çš„æœ‰ 0 ä¸ªã€‚</p>\n<p><strong>ç¬¬ä¸‰è¡Œï¼ŒcpuçŠ¶æ€ä¿¡æ¯ï¼Œå…·ä½“å±æ€§è¯´æ˜å¦‚ä¸‹</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">5.9%us â€” ç”¨æˆ·ç©ºé—´å ç”¨CPUçš„ç™¾åˆ†æ¯”ã€‚</span><br><span class=\"line\">3.4% sy â€” å†…æ ¸ç©ºé—´å ç”¨CPUçš„ç™¾åˆ†æ¯”ã€‚</span><br><span class=\"line\">0.0% ni â€” æ”¹å˜è¿‡ä¼˜å…ˆçº§çš„è¿›ç¨‹å ç”¨CPUçš„ç™¾åˆ†æ¯”</span><br><span class=\"line\">90.4% id â€” ç©ºé—²CPUç™¾åˆ†æ¯”</span><br><span class=\"line\">0.0% wa â€” IOç­‰å¾…å ç”¨CPUçš„ç™¾åˆ†æ¯”</span><br><span class=\"line\">0.0% hi â€” ç¡¬ä¸­æ–­ï¼ˆHardware IRQï¼‰å ç”¨CPUçš„ç™¾åˆ†æ¯”</span><br><span class=\"line\">0.2% si â€” è½¯ä¸­æ–­ï¼ˆSoftware Interruptsï¼‰å ç”¨CPUçš„ç™¾åˆ†æ¯”</span><br></pre></td></tr></table></figure>\n\n<p><strong>å¤‡æ³¨</strong>ï¼šåœ¨è¿™é‡Œ CPU çš„ä½¿ç”¨æ¯”ç‡å’Œ windows æ¦‚å¿µä¸åŒï¼Œéœ€è¦ç†è§£ linux ç³»ç»Ÿç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´çš„ç›¸å…³çŸ¥è¯†ï¼</p>\n<p>ç¬¬å››è¡Œï¼Œå†…å­˜çŠ¶æ€ï¼Œå…·ä½“ä¿¡æ¯å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">32949016k total â€” ç‰©ç†å†…å­˜æ€»é‡ï¼ˆ32GBï¼‰</span><br><span class=\"line\">14411180k used â€” ä½¿ç”¨ä¸­çš„å†…å­˜æ€»é‡ï¼ˆ14GBï¼‰</span><br><span class=\"line\">18537836k free â€” ç©ºé—²å†…å­˜æ€»é‡ï¼ˆ18GBï¼‰</span><br><span class=\"line\">169884k buffers â€” ç¼“å­˜çš„å†…å­˜é‡ ï¼ˆ169Mï¼‰</span><br></pre></td></tr></table></figure>\n\n<p><strong>ç¬¬äº”è¡Œï¼Œswapäº¤æ¢åˆ†åŒºä¿¡æ¯ï¼Œå…·ä½“ä¿¡æ¯è¯´æ˜å¦‚ä¸‹</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">32764556k total â€” äº¤æ¢åŒºæ€»é‡ï¼ˆ32GBï¼‰</span><br><span class=\"line\">0k used â€” ä½¿ç”¨çš„äº¤æ¢åŒºæ€»é‡ï¼ˆ0Kï¼‰</span><br><span class=\"line\">32764556k free â€” ç©ºé—²äº¤æ¢åŒºæ€»é‡ï¼ˆ32GBï¼‰</span><br><span class=\"line\">3612636k cached â€” ç¼“å†²çš„äº¤æ¢åŒºæ€»é‡ï¼ˆ3.6GBï¼‰</span><br></pre></td></tr></table></figure>\n\n<p><strong>ç¬¬å…­è¡Œï¼Œç©ºè¡Œã€‚</strong></p>\n<p><strong>ç¬¬ä¸ƒè¡Œä»¥ä¸‹ï¼šå„è¿›ç¨‹ï¼ˆä»»åŠ¡ï¼‰çš„çŠ¶æ€ç›‘æ§ï¼Œé¡¹ç›®åˆ—ä¿¡æ¯è¯´æ˜å¦‚ä¸‹</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">PID â€” è¿›ç¨‹id</span><br><span class=\"line\">USER â€” è¿›ç¨‹æ‰€æœ‰è€…</span><br><span class=\"line\">PR â€” è¿›ç¨‹ä¼˜å…ˆçº§</span><br><span class=\"line\">NI â€” niceå€¼ã€‚è´Ÿå€¼è¡¨ç¤ºé«˜ä¼˜å…ˆçº§ï¼Œæ­£å€¼è¡¨ç¤ºä½ä¼˜å…ˆçº§</span><br><span class=\"line\">VIRT â€” è¿›ç¨‹ä½¿ç”¨çš„è™šæ‹Ÿå†…å­˜æ€»é‡ï¼Œå•ä½kbã€‚VIRT=SWAP+RES</span><br><span class=\"line\">RES â€” è¿›ç¨‹ä½¿ç”¨çš„ã€æœªè¢«æ¢å‡ºçš„ç‰©ç†å†…å­˜å¤§å°ï¼Œå•ä½kbã€‚RES=CODE+DATA</span><br><span class=\"line\">SHR â€” å…±äº«å†…å­˜å¤§å°ï¼Œå•ä½kb</span><br><span class=\"line\">S â€” è¿›ç¨‹çŠ¶æ€ã€‚D=ä¸å¯ä¸­æ–­çš„ç¡çœ çŠ¶æ€ R=è¿è¡Œ S=ç¡çœ  T=è·Ÿè¸ª/åœæ­¢ Z=åƒµå°¸è¿›ç¨‹</span><br><span class=\"line\">%CPU â€” ä¸Šæ¬¡æ›´æ–°åˆ°ç°åœ¨çš„CPUæ—¶é—´å ç”¨ç™¾åˆ†æ¯”</span><br><span class=\"line\">%MEM â€” è¿›ç¨‹ä½¿ç”¨çš„ç‰©ç†å†…å­˜ç™¾åˆ†æ¯”</span><br><span class=\"line\">TIME+ â€” è¿›ç¨‹ä½¿ç”¨çš„CPUæ—¶é—´æ€»è®¡ï¼Œå•ä½1/100ç§’</span><br><span class=\"line\">COMMAND â€” è¿›ç¨‹åç§°ï¼ˆå‘½ä»¤å/å‘½ä»¤è¡Œï¼‰</span><br></pre></td></tr></table></figure>\n\n<p><strong>top äº¤äº’å‘½ä»¤</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">h æ˜¾ç¤ºtopäº¤äº’å‘½ä»¤å¸®åŠ©ä¿¡æ¯</span><br><span class=\"line\">c åˆ‡æ¢æ˜¾ç¤ºå‘½ä»¤åç§°å’Œå®Œæ•´å‘½ä»¤è¡Œ</span><br><span class=\"line\">m ä»¥å†…å­˜ä½¿ç”¨ç‡æ’åº</span><br><span class=\"line\">P æ ¹æ®CPUä½¿ç”¨ç™¾åˆ†æ¯”å¤§å°è¿›è¡Œæ’åº</span><br><span class=\"line\">T æ ¹æ®æ—¶é—´/ç´¯è®¡æ—¶é—´è¿›è¡Œæ’åº</span><br><span class=\"line\">W å°†å½“å‰è®¾ç½®å†™å…¥~/.toprcæ–‡ä»¶ä¸­</span><br><span class=\"line\">oæˆ–è€…O æ”¹å˜æ˜¾ç¤ºé¡¹ç›®çš„é¡ºåº</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"yum-å‘½ä»¤\"><a href=\"#yum-å‘½ä»¤\" class=\"headerlink\" title=\"yum å‘½ä»¤\"></a>yum å‘½ä»¤</h3><p>yumï¼ˆ Yellow dog Updater, Modifiedï¼‰æ˜¯ä¸€ä¸ªåœ¨ Fedora å’Œ RedHat ä»¥åŠ SUSE ä¸­çš„ Shell å‰ç«¯è½¯ä»¶åŒ…ç®¡ç†å™¨ã€‚</p>\n<p>åŸºæ–¼ RPM åŒ…ç®¡ç†ï¼Œèƒ½å¤Ÿä»æŒ‡å®šçš„æœåŠ¡å™¨è‡ªåŠ¨ä¸‹è½½ RPM åŒ…å¹¶ä¸”å®‰è£…ï¼Œå¯ä»¥è‡ªåŠ¨å¤„ç†ä¾èµ–æ€§å…³ç³»ï¼Œå¹¶ä¸”ä¸€æ¬¡å®‰è£…æ‰€æœ‰ä¾èµ–çš„è½¯ä½“åŒ…ï¼Œæ— é¡»ç¹çåœ°ä¸€æ¬¡æ¬¡ä¸‹è½½ã€å®‰è£…ã€‚</p>\n<p>yum æä¾›äº†æŸ¥æ‰¾ã€å®‰è£…ã€åˆ é™¤æŸä¸€ä¸ªã€ä¸€ç»„ç”šè‡³å…¨éƒ¨è½¯ä»¶åŒ…çš„å‘½ä»¤ï¼Œè€Œä¸”å‘½ä»¤ç®€æ´è€Œåˆå¥½è®°ã€‚</p>\n<ul>\n<li>1.åˆ—å‡ºæ‰€æœ‰å¯æ›´æ–°çš„è½¯ä»¶æ¸…å•å‘½ä»¤ï¼šyum check-update</li>\n<li>2.æ›´æ–°æ‰€æœ‰è½¯ä»¶å‘½ä»¤ï¼šyum update</li>\n<li>3.ä»…å®‰è£…æŒ‡å®šçš„è½¯ä»¶å‘½ä»¤ï¼šyum install <package_name></li>\n<li>4.ä»…æ›´æ–°æŒ‡å®šçš„è½¯ä»¶å‘½ä»¤ï¼šyum update <package_name></li>\n<li>5.åˆ—å‡ºæ‰€æœ‰å¯å®‰è£çš„è½¯ä»¶æ¸…å•å‘½ä»¤ï¼šyum list</li>\n<li>6.åˆ é™¤è½¯ä»¶åŒ…å‘½ä»¤ï¼šyum remove <package_name></li>\n<li>7.æŸ¥æ‰¾è½¯ä»¶åŒ… å‘½ä»¤ï¼šyum search</li>\n<li>8.æ¸…é™¤ç¼“å­˜å‘½ä»¤:<ul>\n<li>yum clean packages: æ¸…é™¤ç¼“å­˜ç›®å½•ä¸‹çš„è½¯ä»¶åŒ…</li>\n<li>yum clean headers: æ¸…é™¤ç¼“å­˜ç›®å½•ä¸‹çš„ headers</li>\n<li>yum clean oldheaders: æ¸…é™¤ç¼“å­˜ç›®å½•ä¸‹æ—§çš„ headers</li>\n<li>yum clean, yum clean all (&#x3D; yum clean packages; yum clean oldheaders) :æ¸…é™¤ç¼“å­˜ç›®å½•ä¸‹çš„è½¯ä»¶åŒ…åŠæ—§çš„ headers</li>\n</ul>\n</li>\n</ul>\n<p><strong>å®ä¾‹</strong></p>\n<p>å®‰è£… pam-devel</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@www ~]# yum install pam-devel</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"å¤‡ä»½å‹ç¼©å‘½ä»¤\"><a href=\"#å¤‡ä»½å‹ç¼©å‘½ä»¤\" class=\"headerlink\" title=\"å¤‡ä»½å‹ç¼©å‘½ä»¤\"></a>å¤‡ä»½å‹ç¼©å‘½ä»¤</h2><h3 id=\"bzip2-å‘½ä»¤\"><a href=\"#bzip2-å‘½ä»¤\" class=\"headerlink\" title=\"bzip2 å‘½ä»¤\"></a>bzip2 å‘½ä»¤</h3><ul>\n<li>åˆ›å»º <code>*.bz2</code> å‹ç¼©æ–‡ä»¶ï¼š<code>bzip2 test.txt</code> ã€‚</li>\n<li>è§£å‹ <code>*.bz2</code> æ–‡ä»¶ï¼š<code>bzip2 -d test.txt.bz2</code> ã€‚</li>\n</ul>\n<h3 id=\"gzip-å‘½ä»¤\"><a href=\"#gzip-å‘½ä»¤\" class=\"headerlink\" title=\"gzip å‘½ä»¤\"></a>gzip å‘½ä»¤</h3><ul>\n<li>åˆ›å»ºä¸€ä¸ª <code>*.gz</code> çš„å‹ç¼©æ–‡ä»¶ï¼š<code>gzip test.txt</code> ã€‚</li>\n<li>è§£å‹ <code>*.gz</code> æ–‡ä»¶ï¼š<code>gzip -d test.txt.gz</code> ã€‚</li>\n<li>æ˜¾ç¤ºå‹ç¼©çš„æ¯”ç‡ï¼š<code>gzip -l *.gz</code> ã€‚</li>\n</ul>\n<h3 id=\"tar-å‘½ä»¤\"><a href=\"#tar-å‘½ä»¤\" class=\"headerlink\" title=\"tar å‘½ä»¤\"></a>tar å‘½ä»¤</h3><p>ç”¨æ¥å‹ç¼©å’Œè§£å‹æ–‡ä»¶ã€‚tar æœ¬èº«ä¸å…·æœ‰å‹ç¼©åŠŸèƒ½ï¼Œåªå…·æœ‰æ‰“åŒ…åŠŸèƒ½ï¼Œæœ‰å…³å‹ç¼©åŠè§£å‹æ˜¯è°ƒç”¨å…¶å®ƒçš„åŠŸèƒ½æ¥å®Œæˆã€‚</p>\n<p>å¼„æ¸…ä¸¤ä¸ªæ¦‚å¿µï¼šæ‰“åŒ…å’Œå‹ç¼©ã€‚æ‰“åŒ…æ˜¯æŒ‡å°†ä¸€å¤§å †æ–‡ä»¶æˆ–ç›®å½•å˜æˆä¸€ä¸ªæ€»çš„æ–‡ä»¶ï¼›å‹ç¼©åˆ™æ˜¯å°†ä¸€ä¸ªå¤§çš„æ–‡ä»¶é€šè¿‡ä¸€äº›å‹ç¼©ç®—æ³•å˜æˆä¸€ä¸ªå°æ–‡ä»¶</p>\n<p><strong>å¸¸ç”¨å‚æ•°</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-c å»ºç«‹æ–°çš„å‹ç¼©æ–‡ä»¶</span><br><span class=\"line\">-f æŒ‡å®šå‹ç¼©æ–‡ä»¶</span><br><span class=\"line\">-r æ·»åŠ æ–‡ä»¶åˆ°å·²ç»å‹ç¼©æ–‡ä»¶åŒ…ä¸­</span><br><span class=\"line\">-u æ·»åŠ æ”¹äº†å’Œç°æœ‰çš„æ–‡ä»¶åˆ°å‹ç¼©åŒ…ä¸­</span><br><span class=\"line\">-x ä»å‹ç¼©åŒ…ä¸­æŠ½å–æ–‡ä»¶</span><br><span class=\"line\">-t æ˜¾ç¤ºå‹ç¼©æ–‡ä»¶ä¸­çš„å†…å®¹</span><br><span class=\"line\">-z æ”¯æŒgzipå‹ç¼©</span><br><span class=\"line\">-j æ”¯æŒbzip2å‹ç¼©</span><br><span class=\"line\">-Z æ”¯æŒcompressè§£å‹æ–‡ä»¶</span><br><span class=\"line\">-v æ˜¾ç¤ºæ“ä½œè¿‡ç¨‹</span><br></pre></td></tr></table></figure>\n\n<p>æœ‰å…³ gzip åŠ bzip2 å‹ç¼©:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gzip å®ä¾‹ï¼šå‹ç¼© gzip fileName .tar.gz å’Œ.tgz  è§£å‹ï¼šgunzip filename.gz æˆ– gzip -d filename.gz</span><br><span class=\"line\">          å¯¹åº”ï¼štar zcvf filename.tar.gz     tar zxvf filename.tar.gz</span><br><span class=\"line\"></span><br><span class=\"line\">bz2å®ä¾‹ï¼šå‹ç¼© bzip2 -z filename .tar.bz2 è§£å‹ï¼šbunzip filename.bz2æˆ–bzip -d filename.bz2</span><br><span class=\"line\">       å¯¹åº”ï¼štar jcvf filename.tar.gz         è§£å‹ï¼štar jxvf filename.tar.bz2</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰å°†æ–‡ä»¶å…¨éƒ¨æ‰“åŒ…æˆ tar åŒ…</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tar -cvf log.tar 1.log,2.log æˆ–tar -cvf log.*</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰å°† &#x2F;etc ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åŠç›®å½•æ‰“åŒ…åˆ°æŒ‡å®šç›®å½•ï¼Œå¹¶ä½¿ç”¨ gz å‹ç¼©</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tar -zcvf /tmp/etc.tar.gz /etc</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ3ï¼‰æŸ¥çœ‹åˆšæ‰“åŒ…çš„æ–‡ä»¶å†…å®¹ï¼ˆä¸€å®šåŠ  zï¼Œå› ä¸ºæ˜¯ä½¿ç”¨ gzip å‹ç¼©çš„ï¼‰</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tar -ztvf /tmp/etc.tar.gz</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ4ï¼‰è¦å‹ç¼©æ‰“åŒ… &#x2F;home, &#x2F;etc ï¼Œä½†ä¸è¦ &#x2F;home&#x2F;dmtsai</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tar --exclude /home/dmtsai -zcvf myfile.tar.gz /home/* /etc</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"unzip-å‘½ä»¤\"><a href=\"#unzip-å‘½ä»¤\" class=\"headerlink\" title=\"unzip å‘½ä»¤\"></a>unzip å‘½ä»¤</h3><ul>\n<li>è§£å‹ <code>*.zip</code> æ–‡ä»¶ï¼š<code>unzip test.zip</code> ã€‚</li>\n<li>æŸ¥çœ‹ <code>*.zip</code> æ–‡ä»¶çš„å†…å®¹ï¼š<code>unzip -l jasper.zip</code> ã€‚</li>\n</ul>\n","site":{"data":{}},"length":31287,"excerpt":"<blockquote>\n<p>æ•´ç†çš„ Linux ç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½","more":"</p>\n</blockquote>\n<h2 id=\"Linux-æ¦‚è¿°\"><a href=\"#Linux-æ¦‚è¿°\" class=\"headerlink\" title=\"Linux æ¦‚è¿°\"></a>Linux æ¦‚è¿°</h2><h3 id=\"ä»€ä¹ˆæ˜¯Linux\"><a href=\"#ä»€ä¹ˆæ˜¯Linux\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯Linux\"></a>ä»€ä¹ˆæ˜¯Linux</h3><p>Linux æ˜¯ä¸€å¥—<strong>å…è´¹ä½¿ç”¨å’Œè‡ªç”±ä¼ æ’­çš„ç±» Unix æ“ä½œç³»ç»Ÿ</strong>ï¼Œæ˜¯ä¸€ä¸ªåŸºäº POSIX å’Œ Unix çš„å¤šç”¨æˆ·ã€å¤šä»»åŠ¡ã€æ”¯æŒå¤šçº¿ç¨‹å’Œå¤š CPU çš„æ“ä½œç³»ç»Ÿã€‚å®ƒèƒ½è¿è¡Œä¸»è¦çš„ Unix å·¥å…·è½¯ä»¶ã€åº”ç”¨ç¨‹åºå’Œç½‘ç»œåè®®ã€‚å®ƒæ”¯æŒ 32 ä½å’Œ 64 ä½ç¡¬ä»¶ã€‚Linux ç»§æ‰¿äº† Unix ä»¥ç½‘ç»œä¸ºæ ¸å¿ƒçš„è®¾è®¡æ€æƒ³ï¼Œæ˜¯ä¸€ä¸ªæ€§èƒ½ç¨³å®šçš„å¤šç”¨æˆ·ç½‘ç»œæ“ä½œç³»ç»Ÿã€‚</p>\n<h3 id=\"Unixå’ŒLinuxæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"><a href=\"#Unixå’ŒLinuxæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"Unixå’ŒLinuxæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"></a>Unixå’ŒLinuxæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p>Linux å’Œ Unix éƒ½æ˜¯åŠŸèƒ½å¼ºå¤§çš„æ“ä½œç³»ç»Ÿï¼Œéƒ½æ˜¯åº”ç”¨å¹¿æ³›çš„æœåŠ¡å™¨æ“ä½œç³»ç»Ÿï¼Œæœ‰å¾ˆå¤šç›¸ä¼¼ä¹‹å¤„ï¼Œç”šè‡³æœ‰ä¸€éƒ¨åˆ†äººé”™è¯¯åœ°è®¤ä¸º Unix å’Œ Linux æ“ä½œç³»ç»Ÿæ˜¯ä¸€æ ·çš„ï¼Œç„¶è€Œï¼Œäº‹å®å¹¶éå¦‚æ­¤ï¼Œä»¥ä¸‹æ˜¯ä¸¤è€…çš„åŒºåˆ«ã€‚</p>\n<ol>\n<li>å¼€æºæ€§<br> Linux æ˜¯ä¸€æ¬¾å¼€æºæ“ä½œç³»ç»Ÿï¼Œä¸éœ€è¦ä»˜è´¹ï¼Œå³å¯ä½¿ç”¨ï¼›Unix æ˜¯ä¸€æ¬¾å¯¹æºç å®è¡ŒçŸ¥è¯†äº§æƒä¿æŠ¤çš„ä¼ ç»Ÿå•†ä¸šè½¯ä»¶ï¼Œä½¿ç”¨éœ€è¦ä»˜è´¹æˆæƒä½¿ç”¨ã€‚</li>\n<li>è·¨å¹³å°æ€§<br> Linux æ“ä½œç³»ç»Ÿå…·æœ‰è‰¯å¥½çš„è·¨å¹³å°æ€§èƒ½ï¼Œå¯è¿è¡Œåœ¨å¤šç§ç¡¬ä»¶å¹³å°ä¸Šï¼›Unix æ“ä½œç³»ç»Ÿè·¨å¹³å°æ€§èƒ½è¾ƒå¼±ï¼Œå¤§å¤šéœ€ä¸ç¡¬ä»¶é…å¥—ä½¿ç”¨ã€‚</li>\n<li>å¯è§†åŒ–ç•Œé¢<br> Linux é™¤äº†è¿›è¡Œå‘½ä»¤è¡Œæ“ä½œï¼Œè¿˜æœ‰çª—ä½“ç®¡ç†ç³»ç»Ÿï¼›Unix åªæ˜¯å‘½ä»¤è¡Œä¸‹çš„ç³»ç»Ÿã€‚</li>\n<li>ç¡¬ä»¶ç¯å¢ƒ<br> Linux æ“ä½œç³»ç»Ÿå¯¹ç¡¬ä»¶çš„è¦æ±‚è¾ƒä½ï¼Œå®‰è£…æ–¹æ³•æ›´æ˜“æŒæ¡ï¼›Unix å¯¹ç¡¬ä»¶è¦æ±‚æ¯”è¾ƒè‹›åˆ»ï¼ŒæŒ‰ç…§éš¾åº¦è¾ƒå¤§ã€‚</li>\n<li>ç”¨æˆ·ç¾¤ä½“<br> Linux çš„ç”¨æˆ·ç¾¤ä½“å¾ˆå¹¿æ³›ï¼Œä¸ªäººå’Œä¼ä¸šå‡å¯ä½¿ç”¨ï¼›Unix çš„ç”¨æˆ·ç¾¤ä½“æ¯”è¾ƒçª„ï¼Œå¤šæ˜¯å®‰å…¨æ€§è¦æ±‚é«˜çš„å¤§å‹ä¼ä¸šä½¿ç”¨ï¼Œå¦‚é“¶è¡Œã€ç”µä¿¡éƒ¨é—¨ç­‰ï¼Œæˆ–è€… Unix ç¡¬ä»¶å‚å•†ä½¿ç”¨ï¼Œå¦‚ Sun ç­‰ã€‚<br> ç›¸æ¯”äº Unix æ“ä½œç³»ç»Ÿï¼ŒLinux æ“ä½œç³»ç»Ÿæ›´å—å¹¿å¤§è®¡ç®—æœºçˆ±å¥½è€…çš„å–œçˆ±ï¼Œä¸»è¦åŸå› æ˜¯ Linux æ“ä½œç³»ç»Ÿå…·æœ‰ Unix æ“ä½œç³»ç»Ÿçš„å…¨éƒ¨åŠŸèƒ½ï¼Œå¹¶ä¸”èƒ½å¤Ÿåœ¨æ™®é€š PC è®¡ç®—æœºä¸Šå®ç°å…¨éƒ¨çš„ Unix ç‰¹æ€§ï¼Œå¼€æºå…è´¹çš„ç‰¹æ€§ï¼Œæ›´å®¹æ˜“æ™®åŠä½¿ç”¨ï¼</li>\n</ol>\n<h3 id=\"ä»€ä¹ˆæ˜¯-Linux-å†…æ ¸ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯-Linux-å†…æ ¸ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ Linux å†…æ ¸ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯ Linux å†…æ ¸ï¼Ÿ</h3><p>Linux ç³»ç»Ÿçš„æ ¸å¿ƒæ˜¯å†…æ ¸ã€‚å†…æ ¸æ§åˆ¶ç€è®¡ç®—æœºç³»ç»Ÿä¸Šçš„æ‰€æœ‰ç¡¬ä»¶å’Œè½¯ä»¶ï¼Œåœ¨å¿…è¦æ—¶åˆ†é…ç¡¬ä»¶ï¼Œå¹¶æ ¹æ®éœ€è¦æ‰§è¡Œè½¯ä»¶ã€‚</p>\n<ol>\n<li>ç³»ç»Ÿå†…å­˜ç®¡ç†</li>\n<li>åº”ç”¨ç¨‹åºç®¡ç†</li>\n<li>ç¡¬ä»¶è®¾å¤‡ç®¡ç†</li>\n<li>æ–‡ä»¶ç³»ç»Ÿç®¡ç†</li>\n</ol>\n<h3 id=\"Linuxçš„åŸºæœ¬ç»„ä»¶æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#Linuxçš„åŸºæœ¬ç»„ä»¶æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"Linuxçš„åŸºæœ¬ç»„ä»¶æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>Linuxçš„åŸºæœ¬ç»„ä»¶æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>å°±åƒä»»ä½•å…¶ä»–å…¸å‹çš„æ“ä½œç³»ç»Ÿä¸€æ ·ï¼ŒLinux æ‹¥æœ‰æ‰€æœ‰è¿™äº›ç»„ä»¶ï¼šå†…æ ¸ï¼Œshell å’Œ GUIï¼Œç³»ç»Ÿå®ç”¨ç¨‹åºå’Œåº”ç”¨ç¨‹åºã€‚Linux æ¯”å…¶ä»–æ“ä½œç³»ç»Ÿæ›´å…·ä¼˜åŠ¿çš„æ˜¯æ¯ä¸ªæ–¹é¢éƒ½é™„å¸¦å…¶ä»–åŠŸèƒ½ï¼Œæ‰€æœ‰ä»£ç éƒ½å¯ä»¥å…è´¹ä¸‹è½½ã€‚</p>\n<h3 id=\"Linux-çš„ä½“ç³»ç»“æ„\"><a href=\"#Linux-çš„ä½“ç³»ç»“æ„\" class=\"headerlink\" title=\"Linux çš„ä½“ç³»ç»“æ„\"></a>Linux çš„ä½“ç³»ç»“æ„</h3><p>ä»å¤§çš„æ–¹é¢è®²ï¼ŒLinux ä½“ç³»ç»“æ„å¯ä»¥åˆ†ä¸ºä¸¤å—ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1RoaW5rV29u,size_16,color_FFFFFF,t_70.png\" alt=\"Linux ä½“ç³»ç»“æ„\"></p>\n<ul>\n<li>ç”¨æˆ·ç©ºé—´(User Space) ï¼šç”¨æˆ·ç©ºé—´åˆåŒ…æ‹¬ç”¨æˆ·çš„åº”ç”¨ç¨‹åº(User Applications)ã€C åº“(C Library) ã€‚</li>\n<li>å†…æ ¸ç©ºé—´(Kernel Space) ï¼šå†…æ ¸ç©ºé—´åˆåŒ…æ‹¬ç³»ç»Ÿè°ƒç”¨æ¥å£(System Call Interface)ã€å†…æ ¸(Kernel)ã€å¹³å°æ¶æ„ç›¸å…³çš„ä»£ç (Architecture-Dependent Kernel Code) ã€‚</li>\n</ul>\n<p><strong>ä¸ºä»€ä¹ˆ Linux ä½“ç³»ç»“æ„è¦åˆ†ä¸ºç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´çš„åŸå› ï¼Ÿ</strong></p>\n<ol>\n<li>ç°ä»£ CPU å®ç°äº†ä¸åŒçš„å·¥ä½œæ¨¡å¼ï¼Œä¸åŒæ¨¡å¼ä¸‹ CPU å¯ä»¥æ‰§è¡Œçš„æŒ‡ä»¤å’Œè®¿é—®çš„å¯„å­˜å™¨ä¸åŒã€‚</li>\n<li>Linux ä» CPU çš„è§’åº¦å‡ºå‘ï¼Œä¸ºäº†ä¿æŠ¤å†…æ ¸çš„å®‰å…¨ï¼ŒæŠŠç³»ç»Ÿåˆ†æˆäº†ä¸¤éƒ¨åˆ†ã€‚</li>\n</ol>\n<p>ç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´æ˜¯ç¨‹åºæ‰§è¡Œçš„<strong>ä¸¤ç§ä¸åŒçš„çŠ¶æ€</strong>ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼å®Œæˆç”¨æˆ·ç©ºé—´åˆ°å†…æ ¸ç©ºé—´çš„è½¬ç§»ï¼š</p>\n<p>1ï¼‰ç³»ç»Ÿè°ƒç”¨ï¼›2ï¼‰ç¡¬ä»¶ä¸­æ–­ã€‚</p>\n<h3 id=\"BASHå’ŒDOSä¹‹é—´çš„åŸºæœ¬åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#BASHå’ŒDOSä¹‹é—´çš„åŸºæœ¬åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"BASHå’ŒDOSä¹‹é—´çš„åŸºæœ¬åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>BASHå’ŒDOSä¹‹é—´çš„åŸºæœ¬åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>BASH å’Œ DOS æ§åˆ¶å°ä¹‹é—´çš„ä¸»è¦åŒºåˆ«åœ¨äº 3 ä¸ªæ–¹é¢ï¼š</p>\n<ul>\n<li>BASH å‘½ä»¤åŒºåˆ†å¤§å°å†™ï¼Œè€Œ DOS å‘½ä»¤åˆ™ä¸åŒºåˆ†ï¼›</li>\n<li>åœ¨ BASH ä¸‹ï¼Œ&#x2F; character æ˜¯ç›®å½•åˆ†éš”ç¬¦ï¼Œ\\ä½œä¸ºè½¬ä¹‰å­—ç¬¦ã€‚åœ¨ DOS ä¸‹ï¼Œ&#x2F;ç”¨ä½œå‘½ä»¤å‚æ•°åˆ†éš”ç¬¦ï¼Œ\\æ˜¯ç›®å½•åˆ†éš”ç¬¦ï¼›</li>\n<li>DOS éµå¾ªå‘½åæ–‡ä»¶ä¸­çš„çº¦å®šï¼Œå³ 8 ä¸ªå­—ç¬¦çš„æ–‡ä»¶ååè·Ÿä¸€ä¸ªç‚¹ï¼Œæ‰©å±•åä¸º 3 ä¸ªå­—ç¬¦ã€‚BASH æ²¡æœ‰éµå¾ªè¿™æ ·çš„æƒ¯ä¾‹ã€‚</li>\n</ul>\n<h3 id=\"Linux-å¼€æœºå¯åŠ¨è¿‡ç¨‹ï¼Ÿ\"><a href=\"#Linux-å¼€æœºå¯åŠ¨è¿‡ç¨‹ï¼Ÿ\" class=\"headerlink\" title=\"Linux å¼€æœºå¯åŠ¨è¿‡ç¨‹ï¼Ÿ\"></a>Linux å¼€æœºå¯åŠ¨è¿‡ç¨‹ï¼Ÿ</h3><blockquote>\n<p>äº†è§£å³å¯ã€‚</p>\n</blockquote>\n<p>1ã€ä¸»æœºåŠ ç”µè‡ªæ£€ï¼ŒåŠ è½½ BIOS ç¡¬ä»¶ä¿¡æ¯ã€‚</p>\n<p>2ã€è¯»å– MBR çš„å¼•å¯¼æ–‡ä»¶(GRUBã€LILO)ã€‚</p>\n<p>3ã€å¼•å¯¼ Linux å†…æ ¸ã€‚</p>\n<p>4ã€è¿è¡Œç¬¬ä¸€ä¸ªè¿›ç¨‹ init (è¿›ç¨‹å·æ°¸è¿œä¸º 1 )ã€‚</p>\n<p>5ã€è¿›å…¥ç›¸åº”çš„è¿è¡Œçº§åˆ«ã€‚</p>\n<p>6ã€è¿è¡Œç»ˆç«¯ï¼Œè¾“å…¥ç”¨æˆ·åå’Œå¯†ç ã€‚</p>\n<h3 id=\"Linuxç³»ç»Ÿç¼ºçœçš„è¿è¡Œçº§åˆ«ï¼Ÿ\"><a href=\"#Linuxç³»ç»Ÿç¼ºçœçš„è¿è¡Œçº§åˆ«ï¼Ÿ\" class=\"headerlink\" title=\"Linuxç³»ç»Ÿç¼ºçœçš„è¿è¡Œçº§åˆ«ï¼Ÿ\"></a>Linuxç³»ç»Ÿç¼ºçœçš„è¿è¡Œçº§åˆ«ï¼Ÿ</h3><ul>\n<li>å…³æœºã€‚</li>\n<li>å•æœºç”¨æˆ·æ¨¡å¼ã€‚</li>\n<li>å­—ç¬¦ç•Œé¢çš„å¤šç”¨æˆ·æ¨¡å¼(ä¸æ”¯æŒç½‘ç»œ)ã€‚</li>\n<li>å­—ç¬¦ç•Œé¢çš„å¤šç”¨æˆ·æ¨¡å¼ã€‚</li>\n<li>æœªåˆ†é…ä½¿ç”¨ã€‚</li>\n<li>å›¾å½¢ç•Œé¢çš„å¤šç”¨æˆ·æ¨¡å¼ã€‚</li>\n<li>é‡å¯ã€‚</li>\n</ul>\n<h3 id=\"Linux-ä½¿ç”¨çš„è¿›ç¨‹é—´é€šä¿¡æ–¹å¼ï¼Ÿ\"><a href=\"#Linux-ä½¿ç”¨çš„è¿›ç¨‹é—´é€šä¿¡æ–¹å¼ï¼Ÿ\" class=\"headerlink\" title=\"Linux ä½¿ç”¨çš„è¿›ç¨‹é—´é€šä¿¡æ–¹å¼ï¼Ÿ\"></a>Linux ä½¿ç”¨çš„è¿›ç¨‹é—´é€šä¿¡æ–¹å¼ï¼Ÿ</h3><blockquote>\n<p>äº†è§£å³å¯ï¼Œä¸éœ€è¦å¤ªæ·±å…¥ã€‚</p>\n</blockquote>\n<ul>\n<li>ç®¡é“(pipe)ã€æµç®¡é“(s_pipe)ã€æœ‰åç®¡é“(FIFO)ã€‚</li>\n<li>ä¿¡å·(signal) ã€‚</li>\n<li>æ¶ˆæ¯é˜Ÿåˆ—ã€‚</li>\n<li>å…±äº«å†…å­˜ã€‚</li>\n<li>ä¿¡å·é‡ã€‚</li>\n<li>å¥—æ¥å­—(socket) ã€‚</li>\n</ul>\n<h3 id=\"Linux-æœ‰å“ªäº›ç³»ç»Ÿæ—¥å¿—æ–‡ä»¶ï¼Ÿ\"><a href=\"#Linux-æœ‰å“ªäº›ç³»ç»Ÿæ—¥å¿—æ–‡ä»¶ï¼Ÿ\" class=\"headerlink\" title=\"Linux æœ‰å“ªäº›ç³»ç»Ÿæ—¥å¿—æ–‡ä»¶ï¼Ÿ\"></a>Linux æœ‰å“ªäº›ç³»ç»Ÿæ—¥å¿—æ–‡ä»¶ï¼Ÿ</h3><p>æ¯”è¾ƒé‡è¦çš„æ˜¯ <code>/var/log/messages</code> æ—¥å¿—æ–‡ä»¶ã€‚</p>\n<p>è¯¥æ—¥å¿—æ–‡ä»¶æ˜¯è®¸å¤šè¿›ç¨‹æ—¥å¿—æ–‡ä»¶çš„æ±‡æ€»ï¼Œä»è¯¥æ–‡ä»¶å¯ä»¥çœ‹å‡ºä»»ä½•å…¥ä¾µä¼å›¾æˆ–æˆåŠŸçš„å…¥ä¾µã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯äº¤æ¢ç©ºé—´ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯äº¤æ¢ç©ºé—´ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯äº¤æ¢ç©ºé—´ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯äº¤æ¢ç©ºé—´ï¼Ÿ</h3><p>äº¤æ¢ç©ºé—´æ˜¯ Linux ä½¿ç”¨çš„ä¸€å®šç©ºé—´ï¼Œç”¨äºä¸´æ—¶ä¿å­˜ä¸€äº›å¹¶å‘è¿è¡Œçš„ç¨‹åºã€‚å½“ RAM æ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜æ¥å®¹çº³æ­£åœ¨æ‰§è¡Œçš„æ‰€æœ‰ç¨‹åºæ—¶ï¼Œå°±ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯rootå¸æˆ·\"><a href=\"#ä»€ä¹ˆæ˜¯rootå¸æˆ·\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯rootå¸æˆ·\"></a>ä»€ä¹ˆæ˜¯rootå¸æˆ·</h3><p>root å¸æˆ·å°±åƒä¸€ä¸ªç³»ç»Ÿç®¡ç†å‘˜å¸æˆ·ï¼Œå…è®¸ä½ å®Œå…¨æ§åˆ¶ç³»ç»Ÿã€‚ä½ å¯ä»¥åœ¨æ­¤å¤„åˆ›å»ºå’Œç»´æŠ¤ç”¨æˆ·å¸æˆ·ï¼Œä¸ºæ¯ä¸ªå¸æˆ·åˆ†é…ä¸åŒçš„æƒé™ã€‚æ¯æ¬¡å®‰è£… Linux æ—¶éƒ½æ˜¯é»˜è®¤å¸æˆ·ã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯LILOï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯LILOï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯LILOï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯LILOï¼Ÿ</h3><p>LILO æ˜¯ Linux çš„å¼•å¯¼åŠ è½½ç¨‹åºã€‚å®ƒä¸»è¦ç”¨äºå°† Linux æ“ä½œç³»ç»ŸåŠ è½½åˆ°ä¸»å†…å­˜ä¸­ï¼Œä»¥ä¾¿å®ƒå¯ä»¥å¼€å§‹è¿è¡Œã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯BASHï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯BASHï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯BASHï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯BASHï¼Ÿ</h3><p>BASH æ˜¯ Bourne Again SHell çš„ç¼©å†™ã€‚å®ƒç”± Steve Bourne ç¼–å†™ï¼Œä½œä¸ºåŸå§‹ Bourne Shellï¼ˆç”±&#x2F; bin &#x2F; sh è¡¨ç¤ºï¼‰çš„æ›¿ä»£å“ã€‚å®ƒç»“åˆäº†åŸå§‹ç‰ˆæœ¬çš„ Bourne Shell çš„æ‰€æœ‰åŠŸèƒ½ï¼Œä»¥åŠå…¶ä»–åŠŸèƒ½ï¼Œä½¿å…¶æ›´å®¹æ˜“ä½¿ç”¨ã€‚ä»é‚£ä»¥åï¼Œå®ƒå·²è¢«æ”¹ç¼–ä¸ºè¿è¡Œ Linux çš„å¤§å¤šæ•°ç³»ç»Ÿçš„é»˜è®¤ shellã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯CLIï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯CLIï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯CLIï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯CLIï¼Ÿ</h3><p><strong>å‘½ä»¤è¡Œç•Œé¢</strong>ï¼ˆè‹±è¯­<strong>ï¼šcommand-line interface</strong>ï¼Œç¼©å†™]<strong>ï¼šCLI</strong>ï¼‰æ˜¯åœ¨å›¾å½¢ç”¨æˆ·ç•Œé¢å¾—åˆ°æ™®åŠä¹‹å‰ä½¿ç”¨æœ€ä¸ºå¹¿æ³›çš„ç”¨æˆ·ç•Œé¢ï¼Œå®ƒé€šå¸¸ä¸æ”¯æŒé¼ æ ‡ï¼Œç”¨æˆ·é€šè¿‡é”®ç›˜è¾“å…¥æŒ‡ä»¤ï¼Œè®¡ç®—æœºæ¥æ”¶åˆ°æŒ‡ä»¤åï¼Œäºˆä»¥æ‰§è¡Œã€‚ä¹Ÿæœ‰äººç§°ä¹‹ä¸º<strong>å­—ç¬¦ç”¨æˆ·ç•Œé¢</strong>ï¼ˆCUIï¼‰ã€‚</p>\n<p>é€šå¸¸è®¤ä¸ºï¼Œå‘½ä»¤è¡Œç•Œé¢ï¼ˆCLIï¼‰æ²¡æœ‰å›¾å½¢ç”¨æˆ·ç•Œé¢ï¼ˆGUIï¼‰é‚£ä¹ˆæ–¹ä¾¿ç”¨æˆ·æ“ä½œã€‚å› ä¸ºï¼Œå‘½ä»¤è¡Œç•Œé¢çš„è½¯ä»¶é€šå¸¸éœ€è¦ç”¨æˆ·è®°å¿†æ“ä½œçš„å‘½ä»¤ï¼Œä½†æ˜¯ï¼Œç”±äºå…¶æœ¬èº«çš„ç‰¹ç‚¹ï¼Œå‘½ä»¤è¡Œç•Œé¢è¦è¾ƒå›¾å½¢ç”¨æˆ·ç•Œé¢èŠ‚çº¦è®¡ç®—æœºç³»ç»Ÿçš„èµ„æºã€‚åœ¨ç†Ÿè®°å‘½ä»¤çš„å‰æä¸‹ï¼Œä½¿ç”¨å‘½ä»¤è¡Œç•Œé¢å¾€å¾€è¦è¾ƒä½¿ç”¨å›¾å½¢ç”¨æˆ·ç•Œé¢çš„æ“ä½œé€Ÿåº¦è¦å¿«ã€‚æ‰€ä»¥ï¼Œå›¾å½¢ç”¨æˆ·ç•Œé¢çš„æ“ä½œç³»ç»Ÿä¸­ï¼Œéƒ½ä¿ç•™ç€å¯é€‰çš„å‘½ä»¤è¡Œç•Œé¢ã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯GUIï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯GUIï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯GUIï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯GUIï¼Ÿ</h3><p>å›¾å½¢ç”¨æˆ·ç•Œé¢ï¼ˆGraphical User Interfaceï¼Œç®€ç§° GUIï¼Œåˆç§°å›¾å½¢ç”¨æˆ·æ¥å£ï¼‰æ˜¯æŒ‡é‡‡ç”¨å›¾å½¢æ–¹å¼æ˜¾ç¤ºçš„è®¡ç®—æœºæ“ä½œç”¨æˆ·ç•Œé¢ã€‚</p>\n<p>å›¾å½¢ç”¨æˆ·ç•Œé¢æ˜¯ä¸€ç§äººä¸è®¡ç®—æœºé€šä¿¡çš„ç•Œé¢æ˜¾ç¤ºæ ¼å¼ï¼Œå…è®¸ç”¨æˆ·ä½¿ç”¨é¼ æ ‡ç­‰è¾“å…¥è®¾å¤‡æ“çºµå±å¹•ä¸Šçš„å›¾æ ‡æˆ–èœå•é€‰é¡¹ï¼Œä»¥é€‰æ‹©å‘½ä»¤ã€è°ƒç”¨æ–‡ä»¶ã€å¯åŠ¨ç¨‹åºæˆ–æ‰§è¡Œå…¶å®ƒä¸€äº›æ—¥å¸¸ä»»åŠ¡ã€‚ä¸é€šè¿‡é”®ç›˜è¾“å…¥æ–‡æœ¬æˆ–å­—ç¬¦å‘½ä»¤æ¥å®Œæˆä¾‹è¡Œä»»åŠ¡çš„å­—ç¬¦ç•Œé¢ç›¸æ¯”ï¼Œå›¾å½¢ç”¨æˆ·ç•Œé¢æœ‰è®¸å¤šä¼˜ç‚¹ã€‚</p>\n<h3 id=\"å¼€æºçš„ä¼˜åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#å¼€æºçš„ä¼˜åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"å¼€æºçš„ä¼˜åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>å¼€æºçš„ä¼˜åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>å¼€æºå…è®¸ä½ å°†è½¯ä»¶ï¼ˆåŒ…æ‹¬æºä»£ç ï¼‰å…è´¹åˆ†å‘ç»™ä»»ä½•æ„Ÿå…´è¶£çš„äººã€‚ç„¶åï¼Œäººä»¬å¯ä»¥æ·»åŠ åŠŸèƒ½ï¼Œç”šè‡³å¯ä»¥è°ƒè¯•å’Œæ›´æ­£æºä»£ç ä¸­çš„é”™è¯¯ã€‚å®ƒä»¬ç”šè‡³å¯ä»¥è®©å®ƒè¿è¡Œå¾—æ›´å¥½ï¼Œç„¶åå†æ¬¡è‡ªç”±åœ°é‡æ–°åˆ†é…è¿™äº›å¢å¼ºçš„æºä»£ç ã€‚è¿™æœ€ç»ˆä½¿ç¤¾åŒºä¸­çš„æ¯ä¸ªäººå—ç›Šã€‚</p>\n<h3 id=\"GNUé¡¹ç›®çš„é‡è¦æ€§æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#GNUé¡¹ç›®çš„é‡è¦æ€§æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"GNUé¡¹ç›®çš„é‡è¦æ€§æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>GNUé¡¹ç›®çš„é‡è¦æ€§æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>è¿™ç§æ‰€è°“çš„è‡ªç”±è½¯ä»¶è¿åŠ¨å…·æœ‰å¤šç§ä¼˜åŠ¿ï¼Œä¾‹å¦‚å¯ä»¥è‡ªç”±åœ°è¿è¡Œç¨‹åºä»¥åŠæ ¹æ®ä½ çš„éœ€è¦è‡ªç”±å­¦ä¹ å’Œä¿®æ”¹ç¨‹åºã€‚å®ƒè¿˜å…è®¸ä½ å°†è½¯ä»¶å‰¯æœ¬é‡æ–°åˆ†å‘ç»™å…¶ä»–äººï¼Œä»¥åŠè‡ªç”±æ”¹è¿›è½¯ä»¶å¹¶å°†å…¶å‘å¸ƒç»™å…¬ä¼—ã€‚</p>\n<h2 id=\"ç£ç›˜ã€ç›®å½•ã€æ–‡ä»¶\"><a href=\"#ç£ç›˜ã€ç›®å½•ã€æ–‡ä»¶\" class=\"headerlink\" title=\"ç£ç›˜ã€ç›®å½•ã€æ–‡ä»¶\"></a>ç£ç›˜ã€ç›®å½•ã€æ–‡ä»¶</h2><h3 id=\"ç®€å•-Linux-æ–‡ä»¶ç³»ç»Ÿï¼Ÿ\"><a href=\"#ç®€å•-Linux-æ–‡ä»¶ç³»ç»Ÿï¼Ÿ\" class=\"headerlink\" title=\"ç®€å• Linux æ–‡ä»¶ç³»ç»Ÿï¼Ÿ\"></a>ç®€å• Linux æ–‡ä»¶ç³»ç»Ÿï¼Ÿ</h3><p><strong>åœ¨ Linux æ“ä½œç³»ç»Ÿä¸­ï¼Œæ‰€æœ‰è¢«æ“ä½œç³»ç»Ÿç®¡ç†çš„èµ„æºï¼Œä¾‹å¦‚ç½‘ç»œæ¥å£å¡ã€ç£ç›˜é©±åŠ¨å™¨ã€æ‰“å°æœºã€è¾“å…¥è¾“å‡ºè®¾å¤‡ã€æ™®é€šæ–‡ä»¶æˆ–æ˜¯ç›®å½•éƒ½è¢«çœ‹ä½œæ˜¯ä¸€ä¸ªæ–‡ä»¶ã€‚</strong></p>\n<p>ä¹Ÿå°±æ˜¯è¯´åœ¨ Linux ç³»ç»Ÿä¸­æœ‰ä¸€ä¸ªé‡è¦çš„æ¦‚å¿µ<strong>ï¼šä¸€åˆ‡éƒ½æ˜¯æ–‡ä»¶</strong>ã€‚å…¶å®è¿™æ˜¯ Unix å“²å­¦çš„ä¸€ä¸ªä½“ç°ï¼Œè€Œ Linux æ˜¯é‡å†™ Unix è€Œæ¥ï¼Œæ‰€ä»¥è¿™ä¸ªæ¦‚å¿µä¹Ÿå°±ä¼ æ‰¿äº†ä¸‹æ¥ã€‚åœ¨ Unix ç³»ç»Ÿä¸­ï¼ŒæŠŠä¸€åˆ‡èµ„æºéƒ½çœ‹ä½œæ˜¯æ–‡ä»¶ï¼ŒåŒ…æ‹¬ç¡¬ä»¶è®¾å¤‡ã€‚UNIX ç³»ç»ŸæŠŠæ¯ä¸ªç¡¬ä»¶éƒ½çœ‹æˆæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œé€šå¸¸ç§°ä¸ºè®¾å¤‡æ–‡ä»¶ï¼Œè¿™æ ·ç”¨æˆ·å°±<strong>å¯ä»¥ç”¨è¯»å†™æ–‡ä»¶çš„æ–¹å¼å®ç°å¯¹ç¡¬ä»¶çš„è®¿é—®</strong>ã€‚</p>\n<p>Linux æ”¯æŒ 5 ç§æ–‡ä»¶ç±»å‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/format,png.png\" alt=\"5 ç§æ–‡ä»¶ç±»å‹\"></p>\n<h3 id=\"Linux-çš„ç›®å½•ç»“æ„æ˜¯æ€æ ·çš„ï¼Ÿ\"><a href=\"#Linux-çš„ç›®å½•ç»“æ„æ˜¯æ€æ ·çš„ï¼Ÿ\" class=\"headerlink\" title=\"Linux çš„ç›®å½•ç»“æ„æ˜¯æ€æ ·çš„ï¼Ÿ\"></a>Linux çš„ç›®å½•ç»“æ„æ˜¯æ€æ ·çš„ï¼Ÿ</h3><blockquote>\n<p>è¿™ä¸ªé—®é¢˜ï¼Œä¸€èˆ¬ä¸ä¼šé—®ã€‚æ›´å¤šæ˜¯å®é™…ä½¿ç”¨æ—¶ï¼Œéœ€è¦çŸ¥é“ã€‚</p>\n</blockquote>\n<p>Linux æ–‡ä»¶ç³»ç»Ÿçš„ç»“æ„å±‚æ¬¡é²œæ˜ï¼Œå°±åƒä¸€æ£µå€’ç«‹çš„æ ‘ï¼Œæœ€é¡¶å±‚æ˜¯å…¶æ ¹ç›®å½•ï¼š<br><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/format,png-20230125135806288.png\" alt=\"Linux çš„ç›®å½•ç»“æ„\"></p>\n<p><strong>å¸¸è§ç›®å½•è¯´æ˜</strong>ï¼š</p>\n<ul>\n<li><strong>&#x2F;bin</strong>ï¼š å­˜æ”¾äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶(ls,cat,mkdir ç­‰)ï¼Œå¸¸ç”¨å‘½ä»¤ä¸€èˆ¬éƒ½åœ¨è¿™é‡Œï¼›</li>\n<li><strong>&#x2F;etc</strong>ï¼š å­˜æ”¾ç³»ç»Ÿç®¡ç†å’Œé…ç½®æ–‡ä»¶ï¼›</li>\n<li><strong>&#x2F;home</strong>ï¼š å­˜æ”¾æ‰€æœ‰ç”¨æˆ·æ–‡ä»¶çš„æ ¹ç›®å½•ï¼Œæ˜¯ç”¨æˆ·ä¸»ç›®å½•çš„åŸºç‚¹ï¼Œæ¯”å¦‚ç”¨æˆ· user çš„ä¸»ç›®å½•å°±æ˜¯&#x2F;home&#x2F;userï¼Œå¯ä»¥ç”¨~user è¡¨ç¤ºï¼›</li>\n<li>**&#x2F;usr **ï¼š ç”¨äºå­˜æ”¾ç³»ç»Ÿåº”ç”¨ç¨‹åºï¼›</li>\n<li><strong>&#x2F;opt</strong>ï¼š é¢å¤–å®‰è£…çš„å¯é€‰åº”ç”¨ç¨‹åºåŒ…æ‰€æ”¾ç½®çš„ä½ç½®ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ tomcat ç­‰éƒ½å®‰è£…åˆ°è¿™é‡Œï¼›</li>\n<li><strong>&#x2F;proc</strong>ï¼š è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿç›®å½•ï¼Œæ˜¯ç³»ç»Ÿå†…å­˜çš„æ˜ å°„ã€‚å¯ç›´æ¥è®¿é—®è¿™ä¸ªç›®å½•æ¥è·å–ç³»ç»Ÿä¿¡æ¯ï¼›</li>\n<li><strong>&#x2F;root</strong>ï¼š è¶…çº§ç”¨æˆ·ï¼ˆç³»ç»Ÿç®¡ç†å‘˜ï¼‰çš„ä¸»ç›®å½•ï¼ˆç‰¹æƒé˜¶çº§ oï¼‰ï¼›</li>\n<li><strong>&#x2F;sbin:</strong> å­˜æ”¾äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ï¼Œåªæœ‰ root æ‰èƒ½è®¿é—®ã€‚è¿™é‡Œå­˜æ”¾çš„æ˜¯ç³»ç»Ÿç®¡ç†å‘˜ä½¿ç”¨çš„ç³»ç»Ÿçº§åˆ«çš„ç®¡ç†å‘½ä»¤å’Œç¨‹åºã€‚å¦‚ ifconfig ç­‰ï¼›</li>\n<li><strong>&#x2F;dev</strong>ï¼š ç”¨äºå­˜æ”¾è®¾å¤‡æ–‡ä»¶ï¼›</li>\n<li><strong>&#x2F;mnt</strong>ï¼š ç³»ç»Ÿç®¡ç†å‘˜å®‰è£…ä¸´æ—¶æ–‡ä»¶ç³»ç»Ÿçš„å®‰è£…ç‚¹ï¼Œç³»ç»Ÿæä¾›è¿™ä¸ªç›®å½•æ˜¯è®©ç”¨æˆ·ä¸´æ—¶æŒ‚è½½å…¶ä»–çš„æ–‡ä»¶ç³»ç»Ÿï¼›</li>\n<li><strong>&#x2F;boot</strong>ï¼š å­˜æ”¾ç”¨äºç³»ç»Ÿå¼•å¯¼æ—¶ä½¿ç”¨çš„å„ç§æ–‡ä»¶ï¼›</li>\n<li>**&#x2F;lib **ï¼š å­˜æ”¾ç€å’Œç³»ç»Ÿè¿è¡Œç›¸å…³çš„åº“æ–‡ä»¶ ï¼›</li>\n<li><strong>&#x2F;tmp</strong>ï¼š ç”¨äºå­˜æ”¾å„ç§ä¸´æ—¶æ–‡ä»¶ï¼Œæ˜¯å…¬ç”¨çš„ä¸´æ—¶æ–‡ä»¶å­˜å‚¨ç‚¹ï¼›</li>\n<li><strong>&#x2F;var</strong>ï¼š ç”¨äºå­˜æ”¾è¿è¡Œæ—¶éœ€è¦æ”¹å˜æ•°æ®çš„æ–‡ä»¶ï¼Œä¹Ÿæ˜¯æŸäº›å¤§æ–‡ä»¶çš„æº¢å‡ºåŒºï¼Œæ¯”æ–¹è¯´å„ç§æœåŠ¡çš„æ—¥å¿—æ–‡ä»¶ï¼ˆç³»ç»Ÿå¯åŠ¨æ—¥å¿—ç­‰ã€‚ï¼‰ç­‰ï¼›</li>\n<li><strong>&#x2F;lost+found</strong>ï¼š è¿™ä¸ªç›®å½•å¹³æ—¶æ˜¯ç©ºçš„ï¼Œç³»ç»Ÿéæ­£å¸¸å…³æœºè€Œç•™ä¸‹â€œæ— å®¶å¯å½’â€çš„æ–‡ä»¶ï¼ˆwindows ä¸‹å«ä»€ä¹ˆ.chkï¼‰å°±åœ¨è¿™é‡Œã€‚</li>\n</ul>\n<h3 id=\"ä»€ä¹ˆæ˜¯-inode-ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯-inode-ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ inode ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯ inode ï¼Ÿ</h3><blockquote>\n<p>ä¸€èˆ¬æ¥è¯´ï¼Œé¢è¯•ä¸ä¼šé—® inode ã€‚ä½†æ˜¯ inode æ˜¯ä¸€ä¸ªé‡è¦æ¦‚å¿µï¼Œæ˜¯ç†è§£ Unix&#x2F;Linux æ–‡ä»¶ç³»ç»Ÿå’Œç¡¬ç›˜å‚¨å­˜çš„åŸºç¡€ã€‚</p>\n</blockquote>\n<p>ç†è§£ inodeï¼Œè¦ä»æ–‡ä»¶å‚¨å­˜è¯´èµ·ã€‚</p>\n<p>æ–‡ä»¶å‚¨å­˜åœ¨ç¡¬ç›˜ä¸Šï¼Œç¡¬ç›˜çš„æœ€å°å­˜å‚¨å•ä½å«åšâ€æ‰‡åŒºâ€ï¼ˆSectorï¼‰ã€‚æ¯ä¸ªæ‰‡åŒºå‚¨å­˜ 512 å­—èŠ‚ï¼ˆç›¸å½“äº 0.5KBï¼‰ã€‚</p>\n<p>æ“ä½œç³»ç»Ÿè¯»å–ç¡¬ç›˜çš„æ—¶å€™ï¼Œä¸ä¼šä¸€ä¸ªä¸ªæ‰‡åŒºåœ°è¯»å–ï¼Œè¿™æ ·æ•ˆç‡å¤ªä½ï¼Œè€Œæ˜¯ä¸€æ¬¡æ€§è¿ç»­è¯»å–å¤šä¸ªæ‰‡åŒºï¼Œå³ä¸€æ¬¡æ€§è¯»å–ä¸€ä¸ªâ€å—â€ï¼ˆblockï¼‰ã€‚è¿™ç§ç”±å¤šä¸ªæ‰‡åŒºç»„æˆçš„â€å—â€ï¼Œæ˜¯æ–‡ä»¶å­˜å–çš„æœ€å°å•ä½ã€‚â€å—â€çš„å¤§å°ï¼Œæœ€å¸¸è§çš„æ˜¯ 4KBï¼Œå³è¿ç»­å…«ä¸ª sector ç»„æˆä¸€ä¸ª blockã€‚</p>\n<p>æ–‡ä»¶æ•°æ®éƒ½å‚¨å­˜åœ¨â€å—â€ä¸­ï¼Œé‚£ä¹ˆå¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬è¿˜å¿…é¡»æ‰¾åˆ°ä¸€ä¸ªåœ°æ–¹å‚¨å­˜æ–‡ä»¶çš„å…ƒä¿¡æ¯ï¼Œæ¯”å¦‚æ–‡ä»¶çš„åˆ›å»ºè€…ã€æ–‡ä»¶çš„åˆ›å»ºæ—¥æœŸã€æ–‡ä»¶çš„å¤§å°ç­‰ç­‰ã€‚è¿™ç§å‚¨å­˜æ–‡ä»¶å…ƒä¿¡æ¯çš„åŒºåŸŸå°±å«åš inodeï¼Œä¸­æ–‡è¯‘åä¸ºâ€ç´¢å¼•èŠ‚ç‚¹â€ã€‚</p>\n<p>æ¯ä¸€ä¸ªæ–‡ä»¶éƒ½æœ‰å¯¹åº”çš„ inodeï¼Œé‡Œé¢åŒ…å«äº†ä¸è¯¥æ–‡ä»¶æœ‰å…³çš„ä¸€äº›ä¿¡æ¯ã€‚</p>\n<p><strong>ç®€è¿° Linux æ–‡ä»¶ç³»ç»Ÿé€šè¿‡ i èŠ‚ç‚¹æŠŠæ–‡ä»¶çš„é€»è¾‘ç»“æ„å’Œç‰©ç†ç»“æ„è½¬æ¢çš„å·¥ä½œè¿‡ç¨‹ï¼Ÿ</strong></p>\n<blockquote>\n<p>å¦‚æœçœ‹çš„ä¸€è„¸æ‡µé€¼ï¼Œä¹Ÿæ²¡å…³ç³»ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œé¢è¯•å®˜ä¸å¤ªä¼šé—®è¿™ä¸ªé¢˜ç›®ã€‚</p>\n</blockquote>\n<p>Linux é€šè¿‡ inode èŠ‚ç‚¹è¡¨å°†æ–‡ä»¶çš„é€»è¾‘ç»“æ„å’Œç‰©ç†ç»“æ„è¿›è¡Œè½¬æ¢ã€‚</p>\n<ul>\n<li>inode èŠ‚ç‚¹æ˜¯ä¸€ä¸ª 64 å­—èŠ‚é•¿çš„è¡¨ï¼Œè¡¨ä¸­åŒ…å«äº†æ–‡ä»¶çš„ç›¸å…³ä¿¡æ¯ï¼Œå…¶ä¸­æœ‰æ–‡ä»¶çš„å¤§å°ã€æ–‡ä»¶æ‰€æœ‰è€…ã€æ–‡ä»¶çš„å­˜å–è®¸å¯æ–¹å¼ä»¥åŠæ–‡ä»¶çš„ç±»å‹ç­‰é‡è¦ä¿¡æ¯ã€‚åœ¨ inode èŠ‚ç‚¹è¡¨ä¸­æœ€é‡è¦çš„å†…å®¹æ˜¯ç£ç›˜åœ°å€è¡¨ã€‚åœ¨ç£ç›˜åœ°å€è¡¨ä¸­æœ‰ 13 ä¸ªå—å·ï¼Œæ–‡ä»¶å°†ä»¥å—å·åœ¨ç£ç›˜åœ°å€è¡¨ä¸­å‡ºç°çš„é¡ºåºä¾æ¬¡è¯»å–ç›¸åº”çš„å—ã€‚</li>\n<li>Linux æ–‡ä»¶ç³»ç»Ÿé€šè¿‡æŠŠ inode èŠ‚ç‚¹å’Œæ–‡ä»¶åè¿›è¡Œè¿æ¥ï¼Œå½“éœ€è¦è¯»å–è¯¥æ–‡ä»¶æ—¶ï¼Œæ–‡ä»¶ç³»ç»Ÿåœ¨å½“å‰ç›®å½•è¡¨ä¸­æŸ¥æ‰¾è¯¥æ–‡ä»¶åå¯¹åº”çš„é¡¹ï¼Œç”±æ­¤å¾—åˆ°è¯¥æ–‡ä»¶ç›¸å¯¹åº”çš„ inode èŠ‚ç‚¹å·ï¼Œé€šè¿‡è¯¥ inode èŠ‚ç‚¹çš„ç£ç›˜åœ°å€è¡¨æŠŠåˆ†æ•£å­˜æ”¾çš„æ–‡ä»¶ç‰©ç†å—è¿æ¥æˆæ–‡ä»¶çš„é€»è¾‘ç»“æ„ã€‚</li>\n</ul>\n<h3 id=\"ä»€ä¹ˆæ˜¯ç¡¬é“¾æ¥å’Œè½¯é“¾æ¥ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯ç¡¬é“¾æ¥å’Œè½¯é“¾æ¥ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ç¡¬é“¾æ¥å’Œè½¯é“¾æ¥ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯ç¡¬é“¾æ¥å’Œè½¯é“¾æ¥ï¼Ÿ</h3><p>1ï¼‰ç¡¬é“¾æ¥</p>\n<p>ç”±äº Linux ä¸‹çš„æ–‡ä»¶æ˜¯é€šè¿‡ç´¢å¼•èŠ‚ç‚¹(inode)æ¥è¯†åˆ«æ–‡ä»¶ï¼Œç¡¬é“¾æ¥å¯ä»¥è®¤ä¸ºæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘æ–‡ä»¶ç´¢å¼•èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œç³»ç»Ÿå¹¶ä¸ä¸ºå®ƒé‡æ–°åˆ†é… inode ã€‚æ¯æ·»åŠ ä¸€ä¸ªä¸€ä¸ªç¡¬é“¾æ¥ï¼Œæ–‡ä»¶çš„é“¾æ¥æ•°å°±åŠ  1 ã€‚</p>\n<ul>\n<li>ä¸è¶³ï¼š1ï¼‰ä¸å¯ä»¥åœ¨ä¸åŒæ–‡ä»¶ç³»ç»Ÿçš„æ–‡ä»¶é—´å»ºç«‹é“¾æ¥ï¼›2ï¼‰åªæœ‰è¶…çº§ç”¨æˆ·æ‰å¯ä»¥ä¸ºç›®å½•åˆ›å»ºç¡¬é“¾æ¥ã€‚</li>\n</ul>\n<p>2ï¼‰è½¯é“¾æ¥</p>\n<p>è½¯é“¾æ¥å…‹æœäº†ç¡¬é“¾æ¥çš„ä¸è¶³ï¼Œæ²¡æœ‰ä»»ä½•æ–‡ä»¶ç³»ç»Ÿçš„é™åˆ¶ï¼Œä»»ä½•ç”¨æˆ·å¯ä»¥åˆ›å»ºæŒ‡å‘ç›®å½•çš„ç¬¦å·é“¾æ¥ã€‚å› è€Œç°åœ¨æ›´ä¸ºå¹¿æ³›ä½¿ç”¨ï¼Œå®ƒå…·æœ‰æ›´å¤§çš„çµæ´»æ€§ï¼Œç”šè‡³å¯ä»¥è·¨è¶Šä¸åŒæœºå™¨ã€ä¸åŒç½‘ç»œå¯¹æ–‡ä»¶è¿›è¡Œé“¾æ¥ã€‚</p>\n<ul>\n<li>ä¸è¶³ï¼šå› ä¸ºé“¾æ¥æ–‡ä»¶åŒ…å«æœ‰åŸæ–‡ä»¶çš„è·¯å¾„ä¿¡æ¯ï¼Œæ‰€ä»¥å½“åŸæ–‡ä»¶ä»ä¸€ä¸ªç›®å½•ä¸‹ç§»åˆ°å…¶ä»–ç›®å½•ä¸­ï¼Œå†è®¿é—®é“¾æ¥æ–‡ä»¶ï¼Œç³»ç»Ÿå°±æ‰¾ä¸åˆ°äº†ï¼Œè€Œç¡¬é“¾æ¥å°±æ²¡æœ‰è¿™ä¸ªç¼ºé™·ï¼Œä½ æƒ³æ€ä¹ˆç§»å°±æ€ä¹ˆç§»ï¼›è¿˜æœ‰å®ƒè¦ç³»ç»Ÿåˆ†é…é¢å¤–çš„ç©ºé—´ç”¨äºå»ºç«‹æ–°çš„ç´¢å¼•èŠ‚ç‚¹å’Œä¿å­˜åŸæ–‡ä»¶çš„è·¯å¾„ã€‚</li>\n</ul>\n<p><strong>å®é™…åœºæ™¯ä¸‹ï¼ŒåŸºæœ¬æ˜¯ä½¿ç”¨è½¯é“¾æ¥</strong>ã€‚æ€»ç»“åŒºåˆ«å¦‚ä¸‹ï¼š</p>\n<ul>\n<li>ç¡¬é“¾æ¥ä¸å¯ä»¥è·¨åˆ†åŒºï¼Œè½¯ä»¶é“¾å¯ä»¥è·¨åˆ†åŒºã€‚</li>\n<li>ç¡¬é“¾æ¥æŒ‡å‘ä¸€ä¸ª inode èŠ‚ç‚¹ï¼Œè€Œè½¯é“¾æ¥åˆ™æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„ inode èŠ‚ç‚¹ã€‚</li>\n<li>åˆ é™¤ç¡¬é“¾æ¥æ–‡ä»¶ï¼Œä¸ä¼šåˆ é™¤åŸæ–‡ä»¶ï¼Œåˆ é™¤è½¯é“¾æ¥æ–‡ä»¶ï¼Œä¼šæŠŠåŸæ–‡ä»¶åˆ é™¤ã€‚</li>\n</ul>\n<h3 id=\"RAID-æ˜¯ä»€ä¹ˆ\"><a href=\"#RAID-æ˜¯ä»€ä¹ˆ\" class=\"headerlink\" title=\"RAID æ˜¯ä»€ä¹ˆ?\"></a>RAID æ˜¯ä»€ä¹ˆ?</h3><blockquote>\n<p>RAID å…¨ç§°ä¸ºç‹¬ç«‹ç£ç›˜å†—ä½™é˜µåˆ—(Redundant Array of Independent Disks)ï¼ŒåŸºæœ¬æ€æƒ³å°±æ˜¯æŠŠå¤šä¸ªç›¸å¯¹ä¾¿å®œçš„ç¡¬ç›˜ç»„åˆèµ·æ¥ï¼Œæˆä¸ºä¸€ä¸ªç¡¬ç›˜é˜µåˆ—ç»„ï¼Œä½¿æ€§èƒ½è¾¾åˆ°ç”šè‡³è¶…è¿‡ä¸€ä¸ªä»·æ ¼æ˜‚è´µã€ å®¹é‡å·¨å¤§çš„ç¡¬ç›˜ã€‚RAID é€šå¸¸è¢«ç”¨åœ¨æœåŠ¡å™¨ç”µè„‘ä¸Šï¼Œä½¿ç”¨å®Œå…¨ç›¸åŒçš„ç¡¬ç›˜ç»„æˆä¸€ä¸ªé€»è¾‘æ‰‡åŒºï¼Œå› æ­¤æ“ä½œç³»ç»Ÿåªä¼šæŠŠå®ƒå½“åšä¸€ä¸ªç¡¬ç›˜ã€‚</p>\n<p>RAID åˆ†ä¸ºä¸åŒçš„ç­‰çº§ï¼Œå„ä¸ªä¸åŒçš„ç­‰çº§å‡åœ¨æ•°æ®å¯é æ€§åŠè¯»å†™æ€§èƒ½ä¸Šåšäº†ä¸åŒçš„æƒè¡¡ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¯ä»¥ä¾æ®è‡ªå·±çš„å®é™…éœ€æ±‚é€‰æ‹©ä¸åŒçš„ RAID æ–¹æ¡ˆã€‚</p>\n</blockquote>\n<p>å½“ç„¶ï¼Œå› ä¸ºå¾ˆå¤šå…¬å¸éƒ½ä½¿ç”¨äº‘æœåŠ¡ï¼Œå¤§å®¶å¾ˆéš¾æ¥è§¦åˆ° RAID è¿™ä¸ªæ¦‚å¿µï¼Œæ›´å¤šçš„å¯èƒ½æ˜¯æ™®é€šäº‘ç›˜ã€SSD äº‘ç›˜é…±ç´«çš„æ¦‚å¿µã€‚</p>\n<h2 id=\"å®‰å…¨\"><a href=\"#å®‰å…¨\" class=\"headerlink\" title=\"å®‰å…¨\"></a>å®‰å…¨</h2><h3 id=\"ä¸€å°-Linux-ç³»ç»Ÿåˆå§‹åŒ–ç¯å¢ƒåéœ€è¦åšä¸€äº›ä»€ä¹ˆå®‰å…¨å·¥ä½œï¼Ÿ\"><a href=\"#ä¸€å°-Linux-ç³»ç»Ÿåˆå§‹åŒ–ç¯å¢ƒåéœ€è¦åšä¸€äº›ä»€ä¹ˆå®‰å…¨å·¥ä½œï¼Ÿ\" class=\"headerlink\" title=\"ä¸€å° Linux ç³»ç»Ÿåˆå§‹åŒ–ç¯å¢ƒåéœ€è¦åšä¸€äº›ä»€ä¹ˆå®‰å…¨å·¥ä½œï¼Ÿ\"></a>ä¸€å° Linux ç³»ç»Ÿåˆå§‹åŒ–ç¯å¢ƒåéœ€è¦åšä¸€äº›ä»€ä¹ˆå®‰å…¨å·¥ä½œï¼Ÿ</h3><p>1ã€æ·»åŠ æ™®é€šç”¨æˆ·ç™»é™†ï¼Œç¦æ­¢ root ç”¨æˆ·ç™»é™†ï¼Œæ›´æ”¹ SSH ç«¯å£å·ã€‚</p>\n<blockquote>\n<p>ä¿®æ”¹ SSH ç«¯å£ä¸ä¸€å®šç»å¯¹å“ˆã€‚å½“ç„¶ï¼Œå¦‚æœè¦æš´éœ²åœ¨å¤–ç½‘ï¼Œå»ºè®®æ”¹ä¸‹ã€‚l</p>\n</blockquote>\n<p>2ã€æœåŠ¡å™¨ä½¿ç”¨å¯†é’¥ç™»é™†ï¼Œç¦æ­¢å¯†ç ç™»é™†ã€‚</p>\n<p>3ã€å¼€å¯é˜²ç«å¢™ï¼Œå…³é—­ SElinux ï¼Œæ ¹æ®ä¸šåŠ¡éœ€æ±‚è®¾ç½®ç›¸åº”çš„é˜²ç«å¢™è§„åˆ™ã€‚</p>\n<p>4ã€è£… fail2ban è¿™ç§é˜²æ­¢ SSH æš´åŠ›ç ´å‡»çš„è½¯ä»¶ã€‚</p>\n<p>5ã€è®¾ç½®åªå…è®¸å…¬å¸åŠå…¬ç½‘å‡ºå£ IP èƒ½ç™»é™†æœåŠ¡å™¨(çœ‹å…¬å¸å®é™…éœ€è¦)</p>\n<blockquote>\n<p>ä¹Ÿå¯ä»¥å®‰è£… VPN ç­‰è½¯ä»¶ï¼Œåªå…è®¸è¿æ¥ VPN åˆ°æœåŠ¡å™¨ä¸Šã€‚</p>\n</blockquote>\n<p>6ã€ä¿®æ”¹å†å²å‘½ä»¤è®°å½•çš„æ¡æ•°ä¸º 10 æ¡ã€‚</p>\n<p>7ã€åªå…è®¸æœ‰éœ€è¦çš„æœåŠ¡å™¨å¯ä»¥è®¿é—®å¤–ç½‘ï¼Œå…¶å®ƒå…¨éƒ¨ç¦æ­¢ã€‚</p>\n<p>8ã€åšå¥½è½¯ä»¶å±‚é¢çš„é˜²æŠ¤ã€‚</p>\n<ul>\n<li>8.1 è®¾ç½® nginx_waf æ¨¡å—é˜²æ­¢ SQL æ³¨å…¥ã€‚</li>\n<li>8.2 æŠŠ Web æœåŠ¡ä½¿ç”¨ www ç”¨æˆ·å¯åŠ¨ï¼Œæ›´æ”¹ç½‘ç«™ç›®å½•çš„æ‰€æœ‰è€…å’Œæ‰€å±ç»„ä¸º www ã€‚</li>\n</ul>\n<h3 id=\"ä»€ä¹ˆå«-CC-æ”»å‡»ï¼Ÿä»€ä¹ˆå«-DDOS-æ”»å‡»ï¼Ÿ\"><a href=\"#ä»€ä¹ˆå«-CC-æ”»å‡»ï¼Ÿä»€ä¹ˆå«-DDOS-æ”»å‡»ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆå« CC æ”»å‡»ï¼Ÿä»€ä¹ˆå« DDOS æ”»å‡»ï¼Ÿ\"></a>ä»€ä¹ˆå« CC æ”»å‡»ï¼Ÿä»€ä¹ˆå« DDOS æ”»å‡»ï¼Ÿ</h3><ul>\n<li><p>CC æ”»å‡»ï¼Œä¸»è¦æ˜¯ç”¨æ¥æ”»å‡»é¡µé¢çš„ï¼Œæ¨¡æ‹Ÿå¤šä¸ªç”¨æˆ·ä¸åœçš„å¯¹ä½ çš„é¡µé¢è¿›è¡Œè®¿é—®ï¼Œä»è€Œä½¿ä½ çš„ç³»ç»Ÿèµ„æºæ¶ˆè€—æ®†å°½ã€‚</p>\n</li>\n<li><p>DDOS æ”»å‡»ï¼Œä¸­æ–‡åå«åˆ†å¸ƒå¼æ‹’ç»æœåŠ¡æ”»å‡»ï¼ŒæŒ‡å€ŸåŠ©æœåŠ¡å™¨æŠ€æœ¯å°†å¤šä¸ªè®¡ç®—æœºè”åˆèµ·æ¥ä½œä¸ºæ”»å‡»å¹³å°ï¼Œæ¥å¯¹ä¸€ä¸ªæˆ–å¤šä¸ªç›®æ ‡å‘åŠ¨ DDOS æ”»å‡»ã€‚</p>\n<blockquote>\n<p>æ”»å‡»ï¼Œå³æ˜¯é€šè¿‡å¤§é‡åˆæ³•çš„è¯·æ±‚å ç”¨å¤§é‡ç½‘ç»œèµ„æºï¼Œä»¥è¾¾åˆ°ç˜«ç—ªç½‘ç»œçš„ç›®çš„ã€‚</p>\n</blockquote>\n</li>\n</ul>\n<p><strong>æ€ä¹ˆé¢„é˜² CC æ”»å‡»å’Œ DDOS æ”»å‡»ï¼Ÿ</strong></p>\n<p>é˜² CCã€DDOS æ”»å‡»ï¼Œè¿™äº›åªèƒ½æ˜¯ç”¨ç¡¬ä»¶é˜²ç«å¢™åšæµé‡æ¸…æ´—ï¼Œå°†æ”»å‡»æµé‡å¼•å…¥é»‘æ´ã€‚</p>\n<blockquote>\n<p>æµé‡æ¸…æ´—è¿™ä¸€å—ï¼Œä¸»è¦æ˜¯ä¹° ISP æœåŠ¡å•†çš„é˜²æ”»å‡»çš„æœåŠ¡å°±å¯ä»¥ï¼Œæœºæˆ¿ä¸€èˆ¬æœ‰ç©ºä½™æµé‡ï¼Œæˆ‘ä»¬ä¸€èˆ¬æ˜¯ä¹°æœåŠ¡ï¼Œæ¯•ç«Ÿæ”»å‡»ä¸ä¼šæ˜¯æŒç»­é•¿æ—¶é—´ã€‚</p>\n</blockquote>\n<h3 id=\"ä»€ä¹ˆæ˜¯ç½‘ç«™æ•°æ®åº“æ³¨å…¥ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯ç½‘ç«™æ•°æ®åº“æ³¨å…¥ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ç½‘ç«™æ•°æ®åº“æ³¨å…¥ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯ç½‘ç«™æ•°æ®åº“æ³¨å…¥ï¼Ÿ</h3><ul>\n<li>ç”±äºç¨‹åºå‘˜çš„æ°´å¹³åŠç»éªŒå‚å·®ä¸é½ï¼Œå¤§éƒ¨åˆ†ç¨‹åºå‘˜åœ¨ç¼–å†™ä»£ç çš„æ—¶å€™ï¼Œæ²¡æœ‰å¯¹ç”¨æˆ·è¾“å…¥æ•°æ®çš„åˆæ³•æ€§è¿›è¡Œåˆ¤æ–­ã€‚</li>\n<li>åº”ç”¨ç¨‹åºå­˜åœ¨å®‰å…¨éšæ‚£ã€‚ç”¨æˆ·å¯ä»¥æäº¤ä¸€æ®µæ•°æ®åº“æŸ¥è¯¢ä»£ç ï¼Œæ ¹æ®ç¨‹åºè¿”å›çš„ç»“æœï¼Œè·å¾—æŸäº›ä»–æƒ³å¾—çŸ¥çš„æ•°æ®ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„ SQL æ³¨å…¥ã€‚</li>\n<li>SQL æ³¨å…¥ï¼Œæ˜¯ä»æ­£å¸¸çš„ WWW ç«¯å£è®¿é—®ï¼Œè€Œä¸”è¡¨é¢çœ‹èµ·æ¥è·Ÿä¸€èˆ¬çš„ Web é¡µé¢è®¿é—®æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œå¦‚æœç®¡ç†å‘˜æ²¡æŸ¥çœ‹æ—¥å¿—çš„ä¹ æƒ¯ï¼Œå¯èƒ½è¢«å…¥ä¾µå¾ˆé•¿æ—¶é—´éƒ½ä¸ä¼šå‘è§‰ã€‚</li>\n</ul>\n<p><strong>å¦‚ä½•è¿‡æ»¤ä¸é¢„é˜²ï¼Ÿ</strong></p>\n<p>æ•°æ®åº“ç½‘é¡µç«¯æ³¨å…¥è¿™ç§ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ nginx_waf åšè¿‡æ»¤ä¸é¢„é˜²ã€‚</p>\n<h2 id=\"Shell\"><a href=\"#Shell\" class=\"headerlink\" title=\"Shell\"></a>Shell</h2><h3 id=\"Shell-è„šæœ¬æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#Shell-è„šæœ¬æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"Shell è„šæœ¬æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>Shell è„šæœ¬æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>ä¸€ä¸ª Shell è„šæœ¬æ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼ŒåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå‘½ä»¤ã€‚ä½œä¸ºç³»ç»Ÿç®¡ç†å‘˜ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦ä½¿ç”¨å¤šä¸ªå‘½ä»¤æ¥å®Œæˆä¸€é¡¹ä»»åŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ è¿™äº›æ‰€æœ‰å‘½ä»¤åœ¨ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶(Shell è„šæœ¬)æ¥å®Œæˆè¿™äº›æ—¥å¸¸å·¥ä½œä»»åŠ¡ã€‚</p>\n<p><strong>ä»€ä¹ˆæ˜¯é»˜è®¤ç™»å½• Shell ï¼Ÿ</strong></p>\n<p>åœ¨ Linux æ“ä½œç³»ç»Ÿï¼Œ<code>&quot;/bin/bash&quot;</code> æ˜¯é»˜è®¤ç™»å½• Shellï¼Œæ˜¯åœ¨åˆ›å»ºç”¨æˆ·æ—¶åˆ†é…çš„ã€‚</p>\n<p>ä½¿ç”¨ chsh å‘½ä»¤å¯ä»¥æ”¹å˜é»˜è®¤çš„ Shell ã€‚ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chsh &lt;ç”¨æˆ·å&gt; -s &lt;æ–°shell&gt;</span><br><span class=\"line\">chsh ThinkWon -s /bin/sh</span><br></pre></td></tr></table></figure>\n\n<p><strong>åœ¨ Shell è„šæœ¬ä¸­ï¼Œå¦‚ä½•å†™å…¥æ³¨é‡Šï¼Ÿ</strong></p>\n<p>æ³¨é‡Šå¯ä»¥ç”¨æ¥æè¿°ä¸€ä¸ªè„šæœ¬å¯ä»¥åšä»€ä¹ˆå’Œå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚æ¯ä¸€è¡Œæ³¨é‡Šä»¥ <code>#</code> å¼€å¤´ã€‚ä¾‹å­å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/bash</span></span><br><span class=\"line\"><span class=\"comment\"># This is a command</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> â€œI am logged <span class=\"keyword\">in</span> as <span class=\"variable\">$USER</span>â€</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"è¯­æ³•çº§\"><a href=\"#è¯­æ³•çº§\" class=\"headerlink\" title=\"è¯­æ³•çº§\"></a>è¯­æ³•çº§</h3><h4 id=\"å¯ä»¥åœ¨-Shell-è„šæœ¬ä¸­ä½¿ç”¨å“ªäº›ç±»å‹çš„å˜é‡ï¼Ÿ\"><a href=\"#å¯ä»¥åœ¨-Shell-è„šæœ¬ä¸­ä½¿ç”¨å“ªäº›ç±»å‹çš„å˜é‡ï¼Ÿ\" class=\"headerlink\" title=\"å¯ä»¥åœ¨ Shell è„šæœ¬ä¸­ä½¿ç”¨å“ªäº›ç±»å‹çš„å˜é‡ï¼Ÿ\"></a>å¯ä»¥åœ¨ Shell è„šæœ¬ä¸­ä½¿ç”¨å“ªäº›ç±»å‹çš„å˜é‡ï¼Ÿ</h4><p>åœ¨ Shell è„šæœ¬ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸¤ç§ç±»å‹çš„å˜é‡ï¼š</p>\n<ul>\n<li><p>ç³»ç»Ÿå®šä¹‰å˜é‡</p>\n<blockquote>\n<p>ç³»ç»Ÿå˜é‡æ˜¯ç”±ç³»ç»Ÿç³»ç»Ÿè‡ªå·±åˆ›å»ºçš„ã€‚è¿™äº›å˜é‡é€šå¸¸ç”±å¤§å†™å­—æ¯ç»„æˆï¼Œå¯ä»¥é€šè¿‡ <code>set</code> å‘½ä»¤æŸ¥çœ‹ã€‚</p>\n</blockquote>\n</li>\n<li><p>ç”¨æˆ·å®šä¹‰å˜é‡</p>\n<blockquote>\n<p>ç”¨æˆ·å˜é‡ç”±ç³»ç»Ÿç”¨æˆ·æ¥ç”Ÿæˆå’Œå®šä¹‰ï¼Œå˜é‡çš„å€¼å¯ä»¥é€šè¿‡å‘½ä»¤ <code>&quot;echo $&lt;å˜é‡å&gt;&quot;</code> æŸ¥çœ‹ã€‚</p>\n</blockquote>\n</li>\n</ul>\n<p><strong>Shellè„šæœ¬ä¸­ $? æ ‡è®°çš„ç”¨é€”æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>\n<p>åœ¨å†™ä¸€ä¸ª Shell è„šæœ¬æ—¶ï¼Œå¦‚æœä½ æƒ³è¦æ£€æŸ¥å‰ä¸€å‘½ä»¤æ˜¯å¦æ‰§è¡ŒæˆåŠŸï¼Œåœ¨ <code>if</code> æ¡ä»¶ä¸­ä½¿ç”¨ <code>$?</code> å¯ä»¥æ¥æ£€æŸ¥å‰ä¸€å‘½ä»¤çš„ç»“æŸçŠ¶æ€ã€‚</p>\n<ul>\n<li><p>å¦‚æœç»“æŸçŠ¶æ€æ˜¯ 0 ï¼Œè¯´æ˜å‰ä¸€ä¸ªå‘½ä»¤æ‰§è¡ŒæˆåŠŸã€‚ä¾‹å¦‚ï¼š</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">root@localhost:~<span class=\"comment\">## ls /usr/bin/shar</span></span><br><span class=\"line\">/usr/bin/shar</span><br><span class=\"line\">root@localhost:~<span class=\"comment\">## echo $?</span></span><br><span class=\"line\">0</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>å¦‚æœç»“æŸçŠ¶æ€ä¸æ˜¯ 0ï¼Œè¯´æ˜å‘½ä»¤æ‰§è¡Œå¤±è´¥ã€‚ä¾‹å¦‚ï¼š</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">root@localhost:~<span class=\"comment\">## ls /usr/bin/share</span></span><br><span class=\"line\"><span class=\"built_in\">ls</span>: cannot access /usr/bin/share: No such file or directory</span><br><span class=\"line\">root@localhost:~<span class=\"comment\">## echo $?</span></span><br><span class=\"line\">2</span><br></pre></td></tr></table></figure></li>\n</ul>\n<p><strong>Bourne Shell(bash) ä¸­æœ‰å“ªäº›ç‰¹æ®Šçš„å˜é‡ï¼Ÿ</strong></p>\n<p>ä¸‹é¢çš„è¡¨åˆ—å‡ºäº† Bourne Shell ä¸ºå‘½ä»¤è¡Œè®¾ç½®çš„ç‰¹æ®Šå˜é‡ã€‚</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">å†…å»ºå˜é‡    è§£é‡Š</span><br><span class=\"line\"><span class=\"variable\">$0</span>    å‘½ä»¤è¡Œä¸­çš„è„šæœ¬åå­—</span><br><span class=\"line\"><span class=\"variable\">$1</span>    ç¬¬ä¸€ä¸ªå‘½ä»¤è¡Œå‚æ•°</span><br><span class=\"line\"><span class=\"variable\">$2</span>    ç¬¬äºŒä¸ªå‘½ä»¤è¡Œå‚æ•°</span><br><span class=\"line\">â€¦..    â€¦â€¦.</span><br><span class=\"line\"><span class=\"variable\">$9</span>    ç¬¬ä¹ä¸ªå‘½ä»¤è¡Œå‚æ•°</span><br><span class=\"line\"><span class=\"variable\">$#</span><span class=\"comment\">#    å‘½ä»¤è¡Œå‚æ•°çš„æ•°é‡</span></span><br><span class=\"line\">$*    æ‰€æœ‰å‘½ä»¤è¡Œå‚æ•°ï¼Œä»¥ç©ºæ ¼éš”å¼€</span><br></pre></td></tr></table></figure>\n\n<p><strong>å¦‚ä½•å–æ¶ˆå˜é‡æˆ–å–æ¶ˆå˜é‡èµ‹å€¼ï¼Ÿ</strong></p>\n<p><code>unset</code> å‘½ä»¤ç”¨äºå–æ¶ˆå˜é‡æˆ–å–æ¶ˆå˜é‡èµ‹å€¼ã€‚è¯­æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">## unset &lt;å˜é‡å&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Shell-è„šæœ¬ä¸­-if-è¯­æ³•å¦‚ä½•åµŒå¥—\"><a href=\"#Shell-è„šæœ¬ä¸­-if-è¯­æ³•å¦‚ä½•åµŒå¥—\" class=\"headerlink\" title=\"Shell è„šæœ¬ä¸­ if è¯­æ³•å¦‚ä½•åµŒå¥—?\"></a>Shell è„šæœ¬ä¸­ <code>if</code> è¯­æ³•å¦‚ä½•åµŒå¥—?</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> [ æ¡ä»¶ ]</span><br><span class=\"line\"><span class=\"keyword\">then</span></span><br><span class=\"line\">å‘½ä»¤1</span><br><span class=\"line\">å‘½ä»¤2</span><br><span class=\"line\">â€¦..</span><br><span class=\"line\"><span class=\"keyword\">else</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> [ æ¡ä»¶ ]</span><br><span class=\"line\"><span class=\"keyword\">then</span></span><br><span class=\"line\">å‘½ä»¤1</span><br><span class=\"line\">å‘½ä»¤2</span><br><span class=\"line\">â€¦.</span><br><span class=\"line\"><span class=\"keyword\">else</span></span><br><span class=\"line\">å‘½ä»¤1</span><br><span class=\"line\">å‘½ä»¤2</span><br><span class=\"line\">â€¦..</span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>åœ¨ Shell è„šæœ¬ä¸­å¦‚ä½•æ¯”è¾ƒä¸¤ä¸ªæ•°å­—ï¼Ÿ</strong></p>\n<p>åœ¨ <code>if-then</code> ä¸­ä½¿ç”¨æµ‹è¯•å‘½ä»¤ï¼ˆ <code>-gt</code> ç­‰ï¼‰æ¥æ¯”è¾ƒä¸¤ä¸ªæ•°å­—ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/bash</span></span><br><span class=\"line\">x=10</span><br><span class=\"line\">y=20</span><br><span class=\"line\"><span class=\"keyword\">if</span> [ <span class=\"variable\">$x</span> -gt <span class=\"variable\">$y</span> ]</span><br><span class=\"line\"><span class=\"keyword\">then</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> â€œx is greater than yâ€</span><br><span class=\"line\"><span class=\"keyword\">else</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> â€œy is greater than xâ€</span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Shell-è„šæœ¬ä¸­-case-è¯­å¥çš„è¯­æ³•\"><a href=\"#Shell-è„šæœ¬ä¸­-case-è¯­å¥çš„è¯­æ³•\" class=\"headerlink\" title=\"Shell è„šæœ¬ä¸­ case è¯­å¥çš„è¯­æ³•?\"></a>Shell è„šæœ¬ä¸­ <code>case</code> è¯­å¥çš„è¯­æ³•?</h4><p>åŸºç¡€è¯­æ³•å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">case</span> å˜é‡ <span class=\"keyword\">in</span></span><br><span class=\"line\">å€¼1)</span><br><span class=\"line\">å‘½ä»¤1</span><br><span class=\"line\">å‘½ä»¤2</span><br><span class=\"line\">â€¦..</span><br><span class=\"line\">æœ€åå‘½ä»¤</span><br><span class=\"line\">!!</span><br><span class=\"line\">å€¼2)</span><br><span class=\"line\">å‘½ä»¤1</span><br><span class=\"line\">å‘½ä»¤2</span><br><span class=\"line\">â€¦â€¦</span><br><span class=\"line\">æœ€åå‘½ä»¤</span><br><span class=\"line\">;;</span><br><span class=\"line\"><span class=\"keyword\">esac</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Shell-è„šæœ¬ä¸­-for-å¾ªç¯è¯­æ³•ï¼Ÿ\"><a href=\"#Shell-è„šæœ¬ä¸­-for-å¾ªç¯è¯­æ³•ï¼Ÿ\" class=\"headerlink\" title=\"Shell è„šæœ¬ä¸­ for å¾ªç¯è¯­æ³•ï¼Ÿ\"></a>Shell è„šæœ¬ä¸­ <code>for</code> å¾ªç¯è¯­æ³•ï¼Ÿ</h4><p>åŸºç¡€è¯­æ³•å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> å˜é‡ <span class=\"keyword\">in</span> å¾ªç¯åˆ—è¡¨</span><br><span class=\"line\"><span class=\"keyword\">do</span></span><br><span class=\"line\">å‘½ä»¤1</span><br><span class=\"line\">å‘½ä»¤2</span><br><span class=\"line\">â€¦.</span><br><span class=\"line\">æœ€åå‘½ä»¤</span><br><span class=\"line\"><span class=\"keyword\">done</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Shell-è„šæœ¬ä¸­-while-å¾ªç¯è¯­æ³•ï¼Ÿ\"><a href=\"#Shell-è„šæœ¬ä¸­-while-å¾ªç¯è¯­æ³•ï¼Ÿ\" class=\"headerlink\" title=\"Shell è„šæœ¬ä¸­ while å¾ªç¯è¯­æ³•ï¼Ÿ\"></a>Shell è„šæœ¬ä¸­ <code>while</code> å¾ªç¯è¯­æ³•ï¼Ÿ</h4><p>å¦‚åŒ <code>for</code> å¾ªç¯ï¼Œ<code>while</code> å¾ªç¯åªè¦æ¡ä»¶æˆç«‹å°±é‡å¤å®ƒçš„å‘½ä»¤å—ã€‚<br>ä¸åŒäº <code>for</code>å¾ªç¯ï¼Œ<code>while</code> å¾ªç¯ä¼šä¸æ–­è¿­ä»£ï¼Œç›´åˆ°å®ƒçš„æ¡ä»¶ä¸ä¸ºçœŸã€‚</p>\n<p>åŸºç¡€è¯­æ³•ï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">while</span> [ æ¡ä»¶ ]</span><br><span class=\"line\"><span class=\"keyword\">do</span></span><br><span class=\"line\">å‘½ä»¤â€¦</span><br><span class=\"line\"><span class=\"keyword\">done</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>do-while è¯­å¥çš„åŸºæœ¬æ ¼å¼ï¼Ÿ</strong></p>\n<p><code>do-while</code> è¯­å¥ç±»ä¼¼äº <code>while</code> è¯­å¥ï¼Œä½†æ£€æŸ¥æ¡ä»¶è¯­å¥ä¹‹å‰å…ˆæ‰§è¡Œå‘½ä»¤ï¼ˆLCTT è¯‘æ³¨ï¼šæ„å³è‡³å°‘æ‰§è¡Œä¸€æ¬¡ã€‚ï¼‰ã€‚ä¸‹é¢æ˜¯ç”¨ <code>do-while</code> è¯­å¥çš„è¯­æ³•ï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">do</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">å‘½ä»¤</span><br><span class=\"line\">&#125; <span class=\"keyword\">while</span> (æ¡ä»¶)</span><br></pre></td></tr></table></figure>\n\n<p><strong>Shell è„šæœ¬ä¸­ break å‘½ä»¤çš„ä½œç”¨ï¼Ÿ</strong></p>\n<p><code>break</code> å‘½ä»¤ä¸€ä¸ªç®€å•çš„ç”¨é€”æ˜¯é€€å‡ºæ‰§è¡Œä¸­çš„å¾ªç¯ã€‚æˆ‘ä»¬å¯ä»¥åœ¨ <code>while</code> å’Œ <code>until</code> å¾ªç¯ä¸­ä½¿ç”¨ <code>break</code> å‘½ä»¤è·³å‡ºå¾ªç¯ã€‚</p>\n<p><strong>Shell è„šæœ¬ä¸­ continue å‘½ä»¤çš„ä½œç”¨ï¼Ÿ</strong></p>\n<p><code>continue</code> å‘½ä»¤ä¸åŒäº <code>break</code> å‘½ä»¤ï¼Œå®ƒåªè·³å‡ºå½“å‰å¾ªç¯çš„è¿­ä»£ï¼Œè€Œä¸æ˜¯æ•´ä¸ªå¾ªç¯ã€‚<code>continue</code> å‘½ä»¤å¾ˆå¤šæ—¶å€™æ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œä¾‹å¦‚é”™è¯¯å‘ç”Ÿï¼Œä½†æˆ‘ä»¬ä¾ç„¶å¸Œæœ›ç»§ç»­æ‰§è¡Œå¤§å¾ªç¯çš„æ—¶å€™ã€‚</p>\n<h4 id=\"å¦‚ä½•ä½¿è„šæœ¬å¯æ‰§è¡Œ\"><a href=\"#å¦‚ä½•ä½¿è„šæœ¬å¯æ‰§è¡Œ\" class=\"headerlink\" title=\"å¦‚ä½•ä½¿è„šæœ¬å¯æ‰§è¡Œ?\"></a>å¦‚ä½•ä½¿è„šæœ¬å¯æ‰§è¡Œ?</h4><p>ä½¿ç”¨ chmod å‘½ä»¤æ¥ä½¿è„šæœ¬å¯æ‰§è¡Œã€‚ä¾‹å­å¦‚ä¸‹ï¼š<code>chmod a+x myscript.sh</code> ã€‚</p>\n<p><strong>#!&#x2F;bin&#x2F;bash çš„ä½œç”¨ï¼Ÿ</strong></p>\n<p><code>#!/bin/bash</code> æ˜¯ Shell è„šæœ¬çš„ç¬¬ä¸€è¡Œï¼Œç§°ä¸ºé‡Šä¼´ï¼ˆshebangï¼‰è¡Œã€‚</p>\n<ul>\n<li>è¿™é‡Œ <code>#</code> ç¬¦å·å«åš hash ï¼Œè€Œ <code>!</code> å«åš bangã€‚</li>\n<li>å®ƒçš„æ„æ€æ˜¯å‘½ä»¤é€šè¿‡ <code>/bin/bash</code> æ¥æ‰§è¡Œã€‚</li>\n</ul>\n<p><strong>å¦‚ä½•è°ƒè¯• Shellè„šæœ¬ï¼Ÿ</strong></p>\n<ul>\n<li>ä½¿ç”¨ <code>-x&#39;</code> æ•°ï¼ˆ<code>sh -x myscript.sh</code>ï¼‰å¯ä»¥è°ƒè¯• Shell è„šæœ¬ã€‚</li>\n<li>å¦ä¸€ä¸ªç§æ–¹æ³•æ˜¯ä½¿ç”¨ <code>-nv</code> å‚æ•°(<code>sh -nv myscript.sh</code>)ã€‚</li>\n</ul>\n<p><strong>å¦‚ä½•å°†æ ‡å‡†è¾“å‡ºå’Œé”™è¯¯è¾“å‡ºåŒæ—¶é‡å®šå‘åˆ°åŒä¸€ä½ç½®?</strong></p>\n<ul>\n<li>æ–¹æ³•ä¸€ï¼š<code>2&gt;&amp;1 (å¦‚## ls /usr/share/doc &gt; out.txt 2&gt;&amp;1 )</code> ã€‚</li>\n<li>æ–¹æ³•äºŒï¼š<code>&amp;&gt; (å¦‚## ls /usr/share/doc &amp;&gt; out.txt )</code> ã€‚</li>\n</ul>\n<p><strong>åœ¨ Shell è„šæœ¬ä¸­ï¼Œå¦‚ä½•æµ‹è¯•æ–‡ä»¶ï¼Ÿ</strong></p>\n<p>test å‘½ä»¤å¯ä»¥ç”¨æ¥æµ‹è¯•æ–‡ä»¶ã€‚åŸºç¡€ç”¨æ³•å¦‚ä¸‹è¡¨æ ¼ï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Test         ç”¨æ³•</span><br><span class=\"line\">-d æ–‡ä»¶å    å¦‚æœæ–‡ä»¶å­˜åœ¨å¹¶ä¸”æ˜¯ç›®å½•ï¼Œè¿”å›<span class=\"literal\">true</span></span><br><span class=\"line\">-e æ–‡ä»¶å    å¦‚æœæ–‡ä»¶å­˜åœ¨ï¼Œè¿”å›<span class=\"literal\">true</span></span><br><span class=\"line\">-f æ–‡ä»¶å    å¦‚æœæ–‡ä»¶å­˜åœ¨å¹¶ä¸”æ˜¯æ™®é€šæ–‡ä»¶ï¼Œè¿”å›<span class=\"literal\">true</span></span><br><span class=\"line\">-r æ–‡ä»¶å    å¦‚æœæ–‡ä»¶å­˜åœ¨å¹¶å¯è¯»ï¼Œè¿”å›<span class=\"literal\">true</span></span><br><span class=\"line\">-s æ–‡ä»¶å    å¦‚æœæ–‡ä»¶å­˜åœ¨å¹¶ä¸”ä¸ä¸ºç©ºï¼Œè¿”å›<span class=\"literal\">true</span></span><br><span class=\"line\">-w æ–‡ä»¶å    å¦‚æœæ–‡ä»¶å­˜åœ¨å¹¶å¯å†™ï¼Œè¿”å›<span class=\"literal\">true</span></span><br><span class=\"line\">-x æ–‡ä»¶å    å¦‚æœæ–‡ä»¶å­˜åœ¨å¹¶å¯æ‰§è¡Œï¼Œè¿”å›<span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"åœ¨-Shell-è„šæœ¬å¦‚ä½•å®šä¹‰å‡½æ•°å‘¢ï¼Ÿ\"><a href=\"#åœ¨-Shell-è„šæœ¬å¦‚ä½•å®šä¹‰å‡½æ•°å‘¢ï¼Ÿ\" class=\"headerlink\" title=\"åœ¨ Shell è„šæœ¬å¦‚ä½•å®šä¹‰å‡½æ•°å‘¢ï¼Ÿ\"></a>åœ¨ Shell è„šæœ¬å¦‚ä½•å®šä¹‰å‡½æ•°å‘¢ï¼Ÿ</h4><p>å‡½æ•°æ˜¯æ‹¥æœ‰åå­—çš„ä»£ç å—ã€‚å½“æˆ‘ä»¬å®šä¹‰ä»£ç å—ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨æˆ‘ä»¬çš„è„šæœ¬è°ƒç”¨å‡½æ•°åå­—ï¼Œè¯¥å—å°±ä¼šè¢«æ‰§è¡Œã€‚ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"function\"><span class=\"title\">diskusage</span></span> () &#123; <span class=\"built_in\">df</span> -h ; &#125;</span><br><span class=\"line\">è¯‘æ³¨ï¼šä¸‹é¢æ˜¯æˆ‘ç»™çš„shellå‡½æ•°è¯­æ³•ï¼ŒåŸæ–‡æ²¡æœ‰</span><br><span class=\"line\">[ <span class=\"keyword\">function</span> ] å‡½æ•°å [()]</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">å‘½ä»¤;</span><br><span class=\"line\">[<span class=\"built_in\">return</span> int;]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>å¦‚ä½•è®© Shell å°±è„šæœ¬å¾—åˆ°æ¥è‡ªç»ˆç«¯çš„è¾“å…¥?</strong></p>\n<p>read å‘½ä»¤å¯ä»¥è¯»å–æ¥è‡ªç»ˆç«¯ï¼ˆä½¿ç”¨é”®ç›˜ï¼‰çš„æ•°æ®ã€‚read å‘½ä»¤å¾—åˆ°ç”¨æˆ·çš„è¾“å…¥å¹¶ç½®äºä½ ç»™å‡ºçš„å˜é‡ä¸­ã€‚ä¾‹å­å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">## vi /tmp/test.sh</span></span><br><span class=\"line\"><span class=\"comment\">#!/bin/bash</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> â€˜Please enter your nameâ€™</span><br><span class=\"line\"><span class=\"built_in\">read</span> name</span><br><span class=\"line\"><span class=\"built_in\">echo</span> â€œMy Name is <span class=\"variable\">$name</span>â€</span><br><span class=\"line\"><span class=\"comment\">## ./test.sh</span></span><br><span class=\"line\">Please enter your name</span><br><span class=\"line\">ThinkWon</span><br><span class=\"line\">My Name is ThinkWon</span><br></pre></td></tr></table></figure>\n\n<p><strong>å¦‚ä½•æ‰§è¡Œç®—æœ¯è¿ç®—ï¼Ÿ</strong></p>\n<p>æœ‰ä¸¤ç§æ–¹æ³•æ¥æ‰§è¡Œç®—æœ¯è¿ç®—ï¼š</p>\n<ul>\n<li>1ã€ä½¿ç”¨ expr å‘½ä»¤ï¼š<code>## expr 5 + 2</code> ã€‚</li>\n<li>2ã€ç”¨ä¸€ä¸ªç¾å…ƒç¬¦å·å’Œæ–¹æ‹¬å·ï¼ˆ<code>$[ è¡¨è¾¾å¼ ]</code>ï¼‰ï¼š<code>test=$[16 + 4] ; test=$[16 + 4]</code> ã€‚</li>\n</ul>\n<h3 id=\"ç¼–ç¨‹é¢˜\"><a href=\"#ç¼–ç¨‹é¢˜\" class=\"headerlink\" title=\"ç¼–ç¨‹é¢˜\"></a>ç¼–ç¨‹é¢˜</h3><h4 id=\"åˆ¤æ–­ä¸€æ–‡ä»¶æ˜¯ä¸æ˜¯å­—ç¬¦è®¾å¤‡æ–‡ä»¶ï¼Œå¦‚æœæ˜¯å°†å…¶æ‹·è´åˆ°-dev-ç›®å½•ä¸‹ï¼Ÿ\"><a href=\"#åˆ¤æ–­ä¸€æ–‡ä»¶æ˜¯ä¸æ˜¯å­—ç¬¦è®¾å¤‡æ–‡ä»¶ï¼Œå¦‚æœæ˜¯å°†å…¶æ‹·è´åˆ°-dev-ç›®å½•ä¸‹ï¼Ÿ\" class=\"headerlink\" title=\"åˆ¤æ–­ä¸€æ–‡ä»¶æ˜¯ä¸æ˜¯å­—ç¬¦è®¾å¤‡æ–‡ä»¶ï¼Œå¦‚æœæ˜¯å°†å…¶æ‹·è´åˆ° /dev ç›®å½•ä¸‹ï¼Ÿ\"></a>åˆ¤æ–­ä¸€æ–‡ä»¶æ˜¯ä¸æ˜¯å­—ç¬¦è®¾å¤‡æ–‡ä»¶ï¼Œå¦‚æœæ˜¯å°†å…¶æ‹·è´åˆ° <code>/dev</code> ç›®å½•ä¸‹ï¼Ÿ</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/bash</span></span><br><span class=\"line\"><span class=\"built_in\">read</span> -p <span class=\"string\">&quot;Input file name: &quot;</span> FILENAME</span><br><span class=\"line\"><span class=\"keyword\">if</span> [ -c <span class=\"string\">&quot;<span class=\"variable\">$FILENAME</span>&quot;</span> ];<span class=\"keyword\">then</span></span><br><span class=\"line\">ã€€ã€€<span class=\"built_in\">cp</span> <span class=\"variable\">$FILENAME</span> /dev</span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"æ·»åŠ ä¸€ä¸ªæ–°ç»„ä¸º-class1-ï¼Œç„¶åæ·»åŠ å±äºè¿™ä¸ªç»„çš„-30-ä¸ªç”¨æˆ·ï¼Œç”¨æˆ·åçš„å½¢å¼ä¸º-stdxx-ï¼Œå…¶ä¸­-xx-ä»-01-åˆ°-30-ï¼Ÿ\"><a href=\"#æ·»åŠ ä¸€ä¸ªæ–°ç»„ä¸º-class1-ï¼Œç„¶åæ·»åŠ å±äºè¿™ä¸ªç»„çš„-30-ä¸ªç”¨æˆ·ï¼Œç”¨æˆ·åçš„å½¢å¼ä¸º-stdxx-ï¼Œå…¶ä¸­-xx-ä»-01-åˆ°-30-ï¼Ÿ\" class=\"headerlink\" title=\"æ·»åŠ ä¸€ä¸ªæ–°ç»„ä¸º class1 ï¼Œç„¶åæ·»åŠ å±äºè¿™ä¸ªç»„çš„ 30 ä¸ªç”¨æˆ·ï¼Œç”¨æˆ·åçš„å½¢å¼ä¸º stdxx ï¼Œå…¶ä¸­ xx ä» 01 åˆ° 30 ï¼Ÿ\"></a>æ·»åŠ ä¸€ä¸ªæ–°ç»„ä¸º class1 ï¼Œç„¶åæ·»åŠ å±äºè¿™ä¸ªç»„çš„ 30 ä¸ªç”¨æˆ·ï¼Œç”¨æˆ·åçš„å½¢å¼ä¸º stdxx ï¼Œå…¶ä¸­ xx ä» 01 åˆ° 30 ï¼Ÿ</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/bash</span></span><br><span class=\"line\">groupadd class1</span><br><span class=\"line\"><span class=\"keyword\">for</span>((i=<span class=\"number\">1</span>;i&lt;<span class=\"number\">31</span>;i++))</span><br><span class=\"line\"><span class=\"keyword\">do</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> [ <span class=\"variable\">$i</span> -le 10 ];<span class=\"keyword\">then</span></span><br><span class=\"line\">                useradd -g class1 std0<span class=\"variable\">$i</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">                useradd -g class1 std<span class=\"variable\">$i</span></span><br><span class=\"line\">        <span class=\"keyword\">fi</span></span><br><span class=\"line\"><span class=\"keyword\">done</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>ç¼–å†™ Shell ç¨‹åºï¼Œå®ç°è‡ªåŠ¨åˆ é™¤ 50 ä¸ªè´¦å·çš„åŠŸèƒ½ï¼Œè´¦å·åä¸ºstud1 è‡³ stud50 ï¼Ÿ</strong></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/bash</span></span><br><span class=\"line\"><span class=\"keyword\">for</span>((i=<span class=\"number\">1</span>;i&lt;<span class=\"number\">51</span>;i++))</span><br><span class=\"line\"><span class=\"keyword\">do</span></span><br><span class=\"line\">                userdel -r stud<span class=\"variable\">$i</span></span><br><span class=\"line\"><span class=\"keyword\">done</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"å†™ä¸€ä¸ª-sed-å‘½ä»¤ï¼Œä¿®æ”¹-tmp-input-txt-æ–‡ä»¶çš„å†…å®¹ï¼Ÿ\"><a href=\"#å†™ä¸€ä¸ª-sed-å‘½ä»¤ï¼Œä¿®æ”¹-tmp-input-txt-æ–‡ä»¶çš„å†…å®¹ï¼Ÿ\" class=\"headerlink\" title=\"å†™ä¸€ä¸ª sed å‘½ä»¤ï¼Œä¿®æ”¹ /tmp/input.txt æ–‡ä»¶çš„å†…å®¹ï¼Ÿ\"></a>å†™ä¸€ä¸ª sed å‘½ä»¤ï¼Œä¿®æ”¹ <code>/tmp/input.txt</code> æ–‡ä»¶çš„å†…å®¹ï¼Ÿ</h4><p>è¦æ±‚ï¼š</p>\n<ul>\n<li>åˆ é™¤æ‰€æœ‰ç©ºè¡Œã€‚</li>\n<li>ä¸€è¡Œä¸­ï¼Œå¦‚æœåŒ…å« â€œ11111â€ï¼Œåˆ™åœ¨ â€œ11111â€ å‰é¢æ’å…¥ â€œAAAâ€ï¼Œåœ¨ â€œ11111â€ åé¢æ’å…¥ â€œBBBâ€ ã€‚æ¯”å¦‚ï¼šå°†å†…å®¹ä¸º 0000111112222 çš„ä¸€è¡Œæ”¹ä¸º 0000AAA11111BBB2222 ã€‚</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@~]<span class=\"comment\">## cat -n /tmp/input.txt</span></span><br><span class=\"line\">     1  000011111222</span><br><span class=\"line\">     2</span><br><span class=\"line\">     3  000011111222222</span><br><span class=\"line\">     4  11111000000222</span><br><span class=\"line\">     5</span><br><span class=\"line\">     6</span><br><span class=\"line\">     7  111111111111122222222222</span><br><span class=\"line\">     8  2211111111</span><br><span class=\"line\">     9  112222222</span><br><span class=\"line\">    10  1122</span><br><span class=\"line\">    11</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## åˆ é™¤æ‰€æœ‰ç©ºè¡Œå‘½ä»¤</span></span><br><span class=\"line\">[root@~]<span class=\"comment\">## sed &#x27;/^$/d&#x27; /tmp/input.txt</span></span><br><span class=\"line\">000011111222</span><br><span class=\"line\">000011111222222</span><br><span class=\"line\">11111000000222</span><br><span class=\"line\">111111111111122222222222</span><br><span class=\"line\">2211111111</span><br><span class=\"line\">112222222</span><br><span class=\"line\">1122</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## æ’å…¥æŒ‡å®šçš„å­—ç¬¦</span></span><br><span class=\"line\">[root@~]<span class=\"comment\">## sed &#x27;s#\\(11111\\)#AAA\\1BBB#g&#x27; /tmp/input.txt</span></span><br><span class=\"line\">0000AAA11111BBB222</span><br><span class=\"line\">0000AAA11111BBB222222</span><br><span class=\"line\">AAA11111BBB000000222</span><br><span class=\"line\">AAA11111BBBAAA11111BBB11122222222222</span><br><span class=\"line\">22AAA11111BBB111</span><br><span class=\"line\">112222222</span><br><span class=\"line\">1122</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"å®æˆ˜\"><a href=\"#å®æˆ˜\" class=\"headerlink\" title=\"å®æˆ˜\"></a>å®æˆ˜</h2><h3 id=\"å¦‚ä½•é€‰æ‹©-Linux-æ“ä½œç³»ç»Ÿç‰ˆæœ¬\"><a href=\"#å¦‚ä½•é€‰æ‹©-Linux-æ“ä½œç³»ç»Ÿç‰ˆæœ¬\" class=\"headerlink\" title=\"å¦‚ä½•é€‰æ‹© Linux æ“ä½œç³»ç»Ÿç‰ˆæœ¬?\"></a>å¦‚ä½•é€‰æ‹© Linux æ“ä½œç³»ç»Ÿç‰ˆæœ¬?</h3><p>ä¸€èˆ¬æ¥è®²ï¼Œæ¡Œé¢ç”¨æˆ·é¦–é€‰ Ubuntu ï¼›æœåŠ¡å™¨é¦–é€‰ RHEL æˆ– CentOS ï¼Œä¸¤è€…ä¸­é¦–é€‰ CentOS ã€‚</p>\n<p>æ ¹æ®å…·ä½“è¦æ±‚ï¼š</p>\n<ul>\n<li><p>å®‰å…¨æ€§è¦æ±‚è¾ƒé«˜ï¼Œåˆ™é€‰æ‹© Debian æˆ–è€… FreeBSD ã€‚</p>\n</li>\n<li><p>éœ€è¦ä½¿ç”¨æ•°æ®åº“é«˜çº§æœåŠ¡å’Œç”µå­é‚®ä»¶ç½‘ç»œåº”ç”¨çš„ç”¨æˆ·å¯ä»¥é€‰æ‹© SUSE ã€‚</p>\n</li>\n<li><p>æƒ³è¦æ–°æŠ€æœ¯æ–°åŠŸèƒ½å¯ä»¥é€‰æ‹© Feddora ï¼ŒFeddora æ˜¯ RHEL å’Œ CentOS çš„ä¸€ä¸ªæµ‹è¯•ç‰ˆå’Œé¢„å‘å¸ƒç‰ˆæœ¬ã€‚</p>\n</li>\n<li><p>ã€é‡ç‚¹ã€‘<strong>æ ¹æ®ç°æœ‰çŠ¶å†µï¼Œç»å¤§å¤šæ•°äº’è”ç½‘å…¬å¸é€‰æ‹© CentOS ã€‚ç°åœ¨æ¯”è¾ƒå¸¸ç”¨çš„æ˜¯ 6 ç³»åˆ—ï¼Œç°åœ¨å¸‚åœºå æœ‰å¤§æ¦‚ä¸€åŠå·¦å³ã€‚å¦å¤–çš„åŸå› æ˜¯ CentOS æ›´ä¾§é‡æœåŠ¡å™¨é¢†åŸŸï¼Œå¹¶ä¸”æ— ç‰ˆæƒçº¦æŸ</strong>ã€‚</p>\n<blockquote>\n<p>CentOS 7 ç³»åˆ—ï¼Œä¹Ÿæ…¢æ…¢ä½¿ç”¨çš„ä¼šæ¯”è¾ƒå¤šäº†ã€‚</p>\n</blockquote>\n</li>\n</ul>\n<h3 id=\"å¦‚ä½•è§„åˆ’ä¸€å°-Linux-ä¸»æœºï¼Œæ­¥éª¤æ˜¯æ€æ ·ï¼Ÿ\"><a href=\"#å¦‚ä½•è§„åˆ’ä¸€å°-Linux-ä¸»æœºï¼Œæ­¥éª¤æ˜¯æ€æ ·ï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•è§„åˆ’ä¸€å° Linux ä¸»æœºï¼Œæ­¥éª¤æ˜¯æ€æ ·ï¼Ÿ\"></a>å¦‚ä½•è§„åˆ’ä¸€å° Linux ä¸»æœºï¼Œæ­¥éª¤æ˜¯æ€æ ·ï¼Ÿ</h3><p>1ã€ç¡®å®šæœºå™¨æ˜¯åšä»€ä¹ˆç”¨çš„ï¼Œæ¯”å¦‚æ˜¯åš WEB ã€DBã€è¿˜æ˜¯æ¸¸æˆæœåŠ¡å™¨ã€‚</p>\n<blockquote>\n<p>ä¸åŒçš„ç”¨é€”ï¼Œæœºå™¨çš„é…ç½®ä¼šæœ‰æ‰€ä¸åŒã€‚</p>\n</blockquote>\n<p>2ã€ç¡®å®šå¥½ä¹‹åï¼Œå°±è¦å®šç³»ç»Ÿéœ€è¦æ€ä¹ˆå®‰è£…ï¼Œé»˜è®¤å®‰è£…å“ªäº›ç³»ç»Ÿã€åˆ†åŒºæ€ä¹ˆåšã€‚</p>\n<p>3ã€éœ€è¦ä¼˜åŒ–ç³»ç»Ÿçš„å“ªäº›å‚æ•°ï¼Œéœ€è¦åˆ›å»ºå“ªäº›ç”¨æˆ·ç­‰ç­‰çš„ã€‚</p>\n<h3 id=\"è¯·é—®å½“ç”¨æˆ·åé¦ˆç½‘ç«™è®¿é—®æ…¢ï¼Œä½ ä¼šå¦‚ä½•å¤„ç†ï¼Ÿ\"><a href=\"#è¯·é—®å½“ç”¨æˆ·åé¦ˆç½‘ç«™è®¿é—®æ…¢ï¼Œä½ ä¼šå¦‚ä½•å¤„ç†ï¼Ÿ\" class=\"headerlink\" title=\"è¯·é—®å½“ç”¨æˆ·åé¦ˆç½‘ç«™è®¿é—®æ…¢ï¼Œä½ ä¼šå¦‚ä½•å¤„ç†ï¼Ÿ\"></a>è¯·é—®å½“ç”¨æˆ·åé¦ˆç½‘ç«™è®¿é—®æ…¢ï¼Œä½ ä¼šå¦‚ä½•å¤„ç†ï¼Ÿ</h3><p><strong>æœ‰å“ªäº›æ–¹é¢çš„å› ç´ ä¼šå¯¼è‡´ç½‘ç«™ç½‘ç«™è®¿é—®æ…¢ï¼Ÿ</strong></p>\n<p>1ã€æœåŠ¡å™¨å‡ºå£å¸¦å®½ä¸å¤Ÿç”¨</p>\n<blockquote>\n<ul>\n<li>æœ¬èº«æœåŠ¡å™¨è´­ä¹°çš„å‡ºå£å¸¦å®½æ¯”è¾ƒå°ã€‚ä¸€æ—¦å¹¶å‘é‡å¤§çš„è¯ï¼Œå°±ä¼šé€ æˆåˆ†ç»™æ¯ä¸ªç”¨æˆ·çš„å‡ºå£å¸¦å®½å°±å°ï¼Œè®¿é—®é€Ÿåº¦è‡ªç„¶å°±ä¼šæ…¢ã€‚</li>\n<li>è·¨è¿è¥å•†ç½‘ç»œå¯¼è‡´å¸¦å®½ç¼©å‡ã€‚ä¾‹å¦‚ï¼Œå…¬å¸ç½‘ç«™æ”¾åœ¨ç”µä¿¡çš„ç½‘ç»œä¸Šï¼Œé‚£ä¹ˆå®¢æˆ·è¿™è¾¹å¯¹æ¥æ˜¯é•¿åŸå®½å¸¦æˆ–è”é€šï¼Œè¿™ä¹Ÿå¯èƒ½å¯¼è‡´å¸¦å®½çš„ç¼©å‡ã€‚</li>\n</ul>\n</blockquote>\n<p>2ã€æœåŠ¡å™¨è´Ÿè½½è¿‡å¤§ï¼Œå¯¼è‡´å“åº”ä¸è¿‡æ¥</p>\n<blockquote>\n<p>å¯ä»¥ä»ä¸¤ä¸ªæ–¹é¢å…¥æ‰‹åˆ†æï¼š</p>\n<ul>\n<li>åˆ†æç³»ç»Ÿè´Ÿè½½ï¼Œä½¿ç”¨ w å‘½ä»¤æˆ–è€… uptime å‘½ä»¤æŸ¥çœ‹ç³»ç»Ÿè´Ÿè½½ã€‚å¦‚æœè´Ÿè½½å¾ˆé«˜ï¼Œåˆ™ä½¿ç”¨ top å‘½ä»¤æŸ¥çœ‹ CPU ï¼ŒMEM ç­‰å ç”¨æƒ…å†µï¼Œè¦ä¹ˆæ˜¯ CPU ç¹å¿™ï¼Œè¦ä¹ˆæ˜¯å†…å­˜ä¸å¤Ÿã€‚</li>\n<li>å¦‚æœè¿™äºŒè€…éƒ½æ­£å¸¸ï¼Œå†å»ä½¿ç”¨ sar å‘½ä»¤åˆ†æç½‘å¡æµé‡ï¼Œåˆ†ææ˜¯ä¸æ˜¯é­åˆ°äº†æ”»å‡»ã€‚ä¸€æ—¦åˆ†æå‡ºé—®é¢˜çš„åŸå› ï¼Œé‡‡å–å¯¹åº”çš„æªæ–½è§£å†³ï¼Œå¦‚å†³å®šè¦ä¸è¦æ€æ­»ä¸€äº›è¿›ç¨‹ï¼Œæˆ–è€…ç¦æ­¢ä¸€äº›è®¿é—®ç­‰ã€‚</li>\n</ul>\n</blockquote>\n<p>3ã€æ•°æ®åº“ç“¶é¢ˆ</p>\n<blockquote>\n<ul>\n<li>å¦‚æœæ…¢æŸ¥è¯¢æ¯”è¾ƒå¤šã€‚é‚£ä¹ˆå°±è¦å¼€å‘äººå‘˜æˆ– DBA ååŠ©è¿›è¡Œ SQL è¯­å¥çš„ä¼˜åŒ–ã€‚</li>\n<li>å¦‚æœæ•°æ®åº“å“åº”æ…¢ï¼Œè€ƒè™‘å¯ä»¥åŠ ä¸€ä¸ªæ•°æ®åº“ç¼“å­˜ï¼Œå¦‚ Redis ç­‰ã€‚ç„¶åï¼Œä¹Ÿå¯ä»¥æ­å»º MySQL ä¸»ä»ï¼Œä¸€å° MySQL æœåŠ¡å™¨è´Ÿè´£å†™ï¼Œå…¶ä»–å‡ å°ä»æ•°æ®åº“è´Ÿè´£è¯»ã€‚</li>\n</ul>\n</blockquote>\n<p>4ã€ç½‘ç«™å¼€å‘ä»£ç æ²¡æœ‰ä¼˜åŒ–å¥½</p>\n<blockquote>\n<ul>\n<li>ä¾‹å¦‚ SQL è¯­å¥æ²¡æœ‰ä¼˜åŒ–ï¼Œå¯¼è‡´æ•°æ®åº“è¯»å†™ç›¸å½“è€—æ—¶ã€‚</li>\n</ul>\n</blockquote>\n<p><strong>é’ˆå¯¹ç½‘ç«™è®¿é—®æ…¢ï¼Œæ€ä¹ˆå»æ’æŸ¥ï¼Ÿ</strong></p>\n<p>1ã€é¦–å…ˆè¦ç¡®å®šæ˜¯ç”¨æˆ·ç«¯è¿˜æ˜¯æœåŠ¡ç«¯çš„é—®é¢˜ã€‚å½“æ¥åˆ°ç”¨æˆ·åé¦ˆè®¿é—®æ…¢ï¼Œé‚£è¾¹è‡ªå·±ç«‹å³è®¿é—®ç½‘ç«™çœ‹çœ‹ï¼Œå¦‚æœè‡ªå·±è¿™è¾¹è®¿é—®å¿«ï¼ŒåŸºæœ¬æ–­å®šæ˜¯ç”¨æˆ·ç«¯é—®é¢˜ï¼Œå°±éœ€è¦è€å¿ƒè·Ÿå®¢æˆ·è§£é‡Šï¼ŒååŠ©å®¢æˆ·è§£å†³é—®é¢˜ã€‚</p>\n<blockquote>\n<p>ä¸è¦ä¸Šæ¥å°±çœ‹æœåŠ¡ç«¯çš„é—®é¢˜ã€‚ä¸€å®šè¦ä»æºå¤´å¼€å§‹ï¼Œé€æ­¥é€æ­¥å¾€ä¸‹ã€‚</p>\n</blockquote>\n<p>2ã€å¦‚æœè®¿é—®ä¹Ÿæ…¢ï¼Œé‚£ä¹ˆå¯ä»¥åˆ©ç”¨æµè§ˆå™¨çš„è°ƒè¯•åŠŸèƒ½ï¼Œçœ‹çœ‹åŠ è½½é‚£ä¸€é¡¹æ•°æ®æ¶ˆè€—æ—¶é—´è¿‡å¤šï¼Œæ˜¯å›¾ç‰‡åŠ è½½æ…¢ï¼Œè¿˜æ˜¯æŸäº›æ•°æ®åŠ è½½æ…¢ã€‚</p>\n<p>3ã€é’ˆå¯¹æœåŠ¡å™¨è´Ÿè½½æƒ…å†µã€‚æŸ¥çœ‹æœåŠ¡å™¨ç¡¬ä»¶(ç½‘ç»œã€CPUã€å†…å­˜)çš„æ¶ˆè€—æƒ…å†µã€‚å¦‚æœæ˜¯è´­ä¹°çš„äº‘ä¸»æœºï¼Œæ¯”å¦‚é˜¿é‡Œäº‘ï¼Œå¯ä»¥ç™»å½•é˜¿é‡Œäº‘å¹³å°æä¾›å„æ–¹é¢çš„ç›‘æ§ï¼Œæ¯”å¦‚ CPUã€å†…å­˜ã€å¸¦å®½çš„ä½¿ç”¨æƒ…å†µã€‚</p>\n<p>4ã€å¦‚æœå‘ç°ç¡¬ä»¶èµ„æºæ¶ˆè€—éƒ½ä¸é«˜ï¼Œé‚£ä¹ˆå°±éœ€è¦é€šè¿‡æŸ¥æ—¥å¿—ï¼Œæ¯”å¦‚çœ‹çœ‹ MySQL æ…¢æŸ¥è¯¢çš„æ—¥å¿—ï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯æŸæ¡ SQL è¯­å¥æŸ¥è¯¢æ…¢ï¼Œå¯¼è‡´ç½‘ç«™è®¿é—®æ…¢ã€‚</p>\n<p><strong>æ€ä¹ˆå»è§£å†³ï¼Ÿ</strong></p>\n<p>1ã€å¦‚æœæ˜¯å‡ºå£å¸¦å®½é—®é¢˜ï¼Œé‚£ä¹ˆä¹…ç”³è¯·åŠ å¤§å‡ºå£å¸¦å®½ã€‚</p>\n<p>2ã€å¦‚æœæ…¢æŸ¥è¯¢æ¯”è¾ƒå¤šï¼Œé‚£ä¹ˆå°±è¦å¼€å‘äººå‘˜æˆ– DBA ååŠ©è¿›è¡Œ SQL è¯­å¥çš„ä¼˜åŒ–ã€‚</p>\n<p>3ã€å¦‚æœæ•°æ®åº“å“åº”æ…¢ï¼Œè€ƒè™‘å¯ä»¥åŠ ä¸€ä¸ªæ•°æ®åº“ç¼“å­˜ï¼Œå¦‚ Redis ç­‰ç­‰ã€‚ç„¶åä¹Ÿå¯ä»¥æ­å»º MySQL ä¸»ä»ï¼Œä¸€å° MySQL æœåŠ¡å™¨è´Ÿè´£å†™ï¼Œå…¶ä»–å‡ å°ä»æ•°æ®åº“è´Ÿè´£è¯»ã€‚</p>\n<p>4ã€ç”³è¯·è´­ä¹° CDN æœåŠ¡ï¼ŒåŠ è½½ç”¨æˆ·çš„è®¿é—®ã€‚</p>\n<p>5ã€å¦‚æœè®¿é—®è¿˜æ¯”è¾ƒæ…¢ï¼Œé‚£å°±éœ€è¦ä»æ•´ä½“æ¶æ„ä¸Šè¿›è¡Œä¼˜åŒ–å’¯ã€‚åšåˆ°ä¸“è§’è‰²ä¸“ç”¨ï¼Œå¤šå°æœåŠ¡å™¨æä¾›åŒä¸€ä¸ªæœåŠ¡ã€‚</p>\n<h3 id=\"Linux-æ€§èƒ½è°ƒä¼˜éƒ½æœ‰å“ªå‡ ç§æ–¹æ³•ï¼Ÿ\"><a href=\"#Linux-æ€§èƒ½è°ƒä¼˜éƒ½æœ‰å“ªå‡ ç§æ–¹æ³•ï¼Ÿ\" class=\"headerlink\" title=\"Linux æ€§èƒ½è°ƒä¼˜éƒ½æœ‰å“ªå‡ ç§æ–¹æ³•ï¼Ÿ\"></a>Linux æ€§èƒ½è°ƒä¼˜éƒ½æœ‰å“ªå‡ ç§æ–¹æ³•ï¼Ÿ</h3><p>1ã€Disabling daemons (å…³é—­ daemons)ã€‚</p>\n<p>2ã€Shutting down the GUI (å…³é—­ GUI)ã€‚</p>\n<p>3ã€Changing kernel parameters (æ”¹å˜å†…æ ¸å‚æ•°)ã€‚</p>\n<p>4ã€Kernel parameters (å†…æ ¸å‚æ•°)ã€‚</p>\n<p>5ã€Tuning the processor subsystem (å¤„ç†å™¨å­ç³»ç»Ÿè°ƒä¼˜)ã€‚</p>\n<p>6ã€Tuning the memory subsystem (å†…å­˜å­ç³»ç»Ÿè°ƒä¼˜)ã€‚</p>\n<p>7ã€Tuning the file system (æ–‡ä»¶ç³»ç»Ÿå­ç³»ç»Ÿè°ƒä¼˜)ã€‚</p>\n<p>8ã€Tuning the network subsystemï¼ˆç½‘ç»œå­ç³»ç»Ÿè°ƒä¼˜)ã€‚</p>\n<h2 id=\"æ–‡ä»¶ç®¡ç†å‘½ä»¤\"><a href=\"#æ–‡ä»¶ç®¡ç†å‘½ä»¤\" class=\"headerlink\" title=\"æ–‡ä»¶ç®¡ç†å‘½ä»¤\"></a>æ–‡ä»¶ç®¡ç†å‘½ä»¤</h2><h3 id=\"cat-å‘½ä»¤\"><a href=\"#cat-å‘½ä»¤\" class=\"headerlink\" title=\"cat å‘½ä»¤\"></a>cat å‘½ä»¤</h3><p>cat å‘½ä»¤ç”¨äºè¿æ¥æ–‡ä»¶å¹¶æ‰“å°åˆ°æ ‡å‡†è¾“å‡ºè®¾å¤‡ä¸Šã€‚</p>\n<p>cat ä¸»è¦æœ‰ä¸‰å¤§åŠŸèƒ½ï¼š</p>\n<p>1ã€ä¸€æ¬¡æ˜¾ç¤ºæ•´ä¸ªæ–‡ä»¶:</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cat</span> filename</span><br></pre></td></tr></table></figure>\n\n<p>2ã€ä»é”®ç›˜åˆ›å»ºä¸€ä¸ªæ–‡ä»¶:</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat &gt; filename</span><br></pre></td></tr></table></figure>\n\n<p>åªèƒ½åˆ›å»ºæ–°æ–‡ä»¶ï¼Œä¸èƒ½ç¼–è¾‘å·²æœ‰æ–‡ä»¶ã€‚</p>\n<p>3ã€å°†å‡ ä¸ªæ–‡ä»¶åˆå¹¶ä¸ºä¸€ä¸ªæ–‡ä»¶ï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat file1 file2 &gt; file</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>-b å¯¹éç©ºè¾“å‡ºè¡Œå·</li>\n<li>-n è¾“å‡ºæ‰€æœ‰è¡Œå·</li>\n</ul>\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰æŠŠ log2012.log çš„æ–‡ä»¶å†…å®¹åŠ ä¸Šè¡Œå·åè¾“å…¥ log2013.log è¿™ä¸ªæ–‡ä»¶é‡Œ</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat -n log2012.log &gt; log2013.log</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰æŠŠ log2012.log å’Œ log2013.log çš„æ–‡ä»¶å†…å®¹åŠ ä¸Šè¡Œå·ï¼ˆç©ºç™½è¡Œä¸åŠ ï¼‰ä¹‹åå°†å†…å®¹é™„åŠ åˆ° log.log é‡Œ</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat -b log2012.log log2013.log &gt; log.log</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"chmod-å‘½ä»¤\"><a href=\"#chmod-å‘½ä»¤\" class=\"headerlink\" title=\"chmod å‘½ä»¤\"></a>chmod å‘½ä»¤</h3><p>Linux&#x2F;Unix çš„æ–‡ä»¶è°ƒç”¨æƒé™åˆ†ä¸ºä¸‰çº§ : æ–‡ä»¶æ‹¥æœ‰è€…ã€ç¾¤ç»„ã€å…¶ä»–ã€‚åˆ©ç”¨ chmod å¯ä»¥æ§åˆ¶æ–‡ä»¶å¦‚ä½•è¢«ä»–äººæ‰€è°ƒç”¨ã€‚</p>\n<p>ç”¨äºæ”¹å˜ linux ç³»ç»Ÿæ–‡ä»¶æˆ–ç›®å½•çš„è®¿é—®æƒé™ã€‚ç”¨å®ƒæ§åˆ¶æ–‡ä»¶æˆ–ç›®å½•çš„è®¿é—®æƒé™ã€‚è¯¥å‘½ä»¤æœ‰ä¸¤ç§ç”¨æ³•ã€‚ä¸€ç§æ˜¯åŒ…å«å­—æ¯å’Œæ“ä½œç¬¦è¡¨è¾¾å¼çš„æ–‡å­—è®¾å®šæ³•ï¼›å¦ä¸€ç§æ˜¯åŒ…å«æ•°å­—çš„æ•°å­—è®¾å®šæ³•ã€‚</p>\n<p>æ¯ä¸€æ–‡ä»¶æˆ–ç›®å½•çš„è®¿é—®æƒé™éƒ½æœ‰ä¸‰ç»„ï¼Œæ¯ç»„ç”¨ä¸‰ä½è¡¨ç¤ºï¼Œåˆ†åˆ«ä¸ºæ–‡ä»¶<strong>å±ä¸»</strong>çš„è¯»ã€å†™å’Œæ‰§è¡Œæƒé™ï¼›ä¸å±ä¸»<strong>åŒç»„</strong>çš„ç”¨æˆ·çš„è¯»ã€å†™å’Œæ‰§è¡Œæƒé™ï¼›ç³»ç»Ÿä¸­<strong>å…¶ä»–ç”¨æˆ·</strong>çš„è¯»ã€å†™å’Œæ‰§è¡Œæƒé™ã€‚å¯ä½¿ç”¨ ls -l test.txt æŸ¥æ‰¾ã€‚</p>\n<p>ä»¥æ–‡ä»¶ log2012.log ä¸ºä¾‹ï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-rw-r--r-- 1 root root 296K 11-13 06:03 log2012.log</span><br></pre></td></tr></table></figure>\n\n<p>ç¬¬ä¸€åˆ—å…±æœ‰ 10 ä¸ªä½ç½®ï¼Œç¬¬ä¸€ä¸ªå­—ç¬¦æŒ‡å®šäº†æ–‡ä»¶ç±»å‹ã€‚åœ¨é€šå¸¸æ„ä¹‰ä¸Šï¼Œä¸€ä¸ªç›®å½•ä¹Ÿæ˜¯ä¸€ä¸ªæ–‡ä»¶ã€‚å¦‚æœç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯æ¨ªçº¿ï¼Œè¡¨ç¤ºæ˜¯ä¸€ä¸ªéç›®å½•çš„æ–‡ä»¶ã€‚å¦‚æœæ˜¯ dï¼Œè¡¨ç¤ºæ˜¯ä¸€ä¸ªç›®å½•ã€‚ä»ç¬¬äºŒä¸ªå­—ç¬¦å¼€å§‹åˆ°ç¬¬åä¸ª 9 ä¸ªå­—ç¬¦ï¼Œ3 ä¸ªå­—ç¬¦ä¸€ç»„ï¼Œåˆ†åˆ«è¡¨ç¤ºäº† 3 ç»„ç”¨æˆ·å¯¹æ–‡ä»¶æˆ–è€…ç›®å½•çš„æƒé™ã€‚æƒé™å­—ç¬¦ç”¨æ¨ªçº¿ä»£è¡¨ç©ºè®¸å¯ï¼Œr ä»£è¡¨åªè¯»(4)ï¼Œw ä»£è¡¨å†™(2)ï¼Œx ä»£è¡¨å¯æ‰§è¡Œ(1)ã€‚</p>\n<p><strong>å¸¸ç”¨å‚æ•°</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-c å½“å‘ç”Ÿæ”¹å˜æ—¶ï¼ŒæŠ¥å‘Šå¤„ç†ä¿¡æ¯</span><br><span class=\"line\">-R å¤„ç†æŒ‡å®šç›®å½•ä»¥åŠå…¶å­ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶</span><br></pre></td></tr></table></figure>\n\n<p>æƒé™èŒƒå›´ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">u ï¼šç›®å½•æˆ–è€…æ–‡ä»¶çš„å½“å‰çš„ç”¨æˆ·</span><br><span class=\"line\">g ï¼šç›®å½•æˆ–è€…æ–‡ä»¶çš„å½“å‰çš„ç¾¤ç»„</span><br><span class=\"line\">o ï¼šé™¤äº†ç›®å½•æˆ–è€…æ–‡ä»¶çš„å½“å‰ç”¨æˆ·æˆ–ç¾¤ç»„ä¹‹å¤–çš„ç”¨æˆ·æˆ–è€…ç¾¤ç»„</span><br><span class=\"line\">a ï¼šæ‰€æœ‰çš„ç”¨æˆ·åŠç¾¤ç»„</span><br></pre></td></tr></table></figure>\n\n<p>æƒé™ä»£å·ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">r ï¼šè¯»æƒé™ï¼Œç”¨æ•°å­—4è¡¨ç¤º</span><br><span class=\"line\">w ï¼šå†™æƒé™ï¼Œç”¨æ•°å­—2è¡¨ç¤º</span><br><span class=\"line\">x ï¼šæ‰§è¡Œæƒé™ï¼Œç”¨æ•°å­—1è¡¨ç¤º</span><br><span class=\"line\">- ï¼šåˆ é™¤æƒé™ï¼Œç”¨æ•°å­—0è¡¨ç¤º</span><br><span class=\"line\">s ï¼šç‰¹æ®Šæƒé™</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰å¢åŠ æ–‡ä»¶ t.log æ‰€æœ‰ç”¨æˆ·å¯æ‰§è¡Œæƒé™</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chmod a+x t.log</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰æ’¤é”€åŸæ¥æ‰€æœ‰çš„æƒé™ï¼Œç„¶åä½¿æ‹¥æœ‰è€…å…·æœ‰å¯è¯»æƒé™,å¹¶è¾“å‡ºå¤„ç†ä¿¡æ¯</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chmod u=r t.log -c</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ3ï¼‰ç»™ file çš„å±ä¸»åˆ†é…è¯»ã€å†™ã€æ‰§è¡Œ(7)çš„æƒé™ï¼Œç»™ file çš„æ‰€åœ¨ç»„åˆ†é…è¯»ã€æ‰§è¡Œ(5)çš„æƒé™ï¼Œç»™å…¶ä»–ç”¨æˆ·åˆ†é…æ‰§è¡Œ(1)çš„æƒé™</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chmod 751 t.log -cï¼ˆæˆ–è€…ï¼šchmod u=rwx,g=rx,o=x t.log -c</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ4ï¼‰å°† test ç›®å½•åŠå…¶å­ç›®å½•æ‰€æœ‰æ–‡ä»¶æ·»åŠ å¯è¯»æƒé™</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chmod u+r,g+r,o+r -R text/ -c</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"chown-å‘½ä»¤\"><a href=\"#chown-å‘½ä»¤\" class=\"headerlink\" title=\"chown å‘½ä»¤\"></a>chown å‘½ä»¤</h3><p>chown å°†æŒ‡å®šæ–‡ä»¶çš„æ‹¥æœ‰è€…æ”¹ä¸ºæŒ‡å®šçš„ç”¨æˆ·æˆ–ç»„ï¼Œç”¨æˆ·å¯ä»¥æ˜¯ç”¨æˆ·åæˆ–è€…ç”¨æˆ· IDï¼›ç»„å¯ä»¥æ˜¯ç»„åæˆ–è€…ç»„ IDï¼›æ–‡ä»¶æ˜¯ä»¥ç©ºæ ¼åˆ†å¼€çš„è¦æ”¹å˜æƒé™çš„æ–‡ä»¶åˆ—è¡¨ï¼Œæ”¯æŒé€šé…ç¬¦ã€‚</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-c æ˜¾ç¤ºæ›´æ”¹çš„éƒ¨åˆ†çš„ä¿¡æ¯</span><br><span class=\"line\">-R å¤„ç†æŒ‡å®šç›®å½•åŠå­ç›®å½•</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰æ”¹å˜æ‹¥æœ‰è€…å’Œç¾¤ç»„ å¹¶æ˜¾ç¤ºæ”¹å˜ä¿¡æ¯</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chown -c mail:mail log2012.log</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰æ”¹å˜æ–‡ä»¶ç¾¤ç»„</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chown -c :mail t.log</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ3ï¼‰æ”¹å˜æ–‡ä»¶å¤¹åŠå­æ–‡ä»¶ç›®å½•å±ä¸»åŠå±ç»„ä¸º mail</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chown -cR mail: test/</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"cp-å‘½ä»¤\"><a href=\"#cp-å‘½ä»¤\" class=\"headerlink\" title=\"cp å‘½ä»¤\"></a>cp å‘½ä»¤</h3><p>å°†æºæ–‡ä»¶å¤åˆ¶è‡³ç›®æ ‡æ–‡ä»¶ï¼Œæˆ–å°†å¤šä¸ªæºæ–‡ä»¶å¤åˆ¶è‡³ç›®æ ‡ç›®å½•ã€‚</p>\n<p>æ³¨æ„ï¼šå‘½ä»¤è¡Œå¤åˆ¶ï¼Œå¦‚æœç›®æ ‡æ–‡ä»¶å·²ç»å­˜åœ¨ä¼šæç¤ºæ˜¯å¦è¦†ç›–ï¼Œè€Œåœ¨ shell è„šæœ¬ä¸­ï¼Œå¦‚æœä¸åŠ  -i å‚æ•°ï¼Œåˆ™ä¸ä¼šæç¤ºï¼Œè€Œæ˜¯ç›´æ¥è¦†ç›–ï¼</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-i æç¤º</span><br><span class=\"line\">-r å¤åˆ¶ç›®å½•åŠç›®å½•å†…æ‰€æœ‰é¡¹ç›®</span><br><span class=\"line\">-a å¤åˆ¶çš„æ–‡ä»¶ä¸åŸæ–‡ä»¶æ—¶é—´ä¸€æ ·</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰å¤åˆ¶ a.txt åˆ° test ç›®å½•ä¸‹ï¼Œä¿æŒåŸæ–‡ä»¶æ—¶é—´ï¼Œå¦‚æœåŸæ–‡ä»¶å­˜åœ¨æç¤ºæ˜¯å¦è¦†ç›–ã€‚</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cp -ai a.txt test</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰ä¸º a.txt å»ºè®®ä¸€ä¸ªé“¾æ¥ï¼ˆå¿«æ·æ–¹å¼ï¼‰</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cp -s a.txt link_a.txt</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"find-å‘½ä»¤\"><a href=\"#find-å‘½ä»¤\" class=\"headerlink\" title=\"find å‘½ä»¤\"></a>find å‘½ä»¤</h3><p>ç”¨äºåœ¨æ–‡ä»¶æ ‘ä¸­æŸ¥æ‰¾æ–‡ä»¶ï¼Œå¹¶ä½œå‡ºç›¸åº”çš„å¤„ç†ã€‚</p>\n<p>å‘½ä»¤æ ¼å¼ï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">find pathname -options [-print -exec -ok ...]</span><br></pre></td></tr></table></figure>\n\n<p>å‘½ä»¤å‚æ•°ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pathname: findå‘½ä»¤æ‰€æŸ¥æ‰¾çš„ç›®å½•è·¯å¾„ã€‚ä¾‹å¦‚ç”¨.æ¥è¡¨ç¤ºå½“å‰ç›®å½•ï¼Œç”¨/æ¥è¡¨ç¤ºç³»ç»Ÿæ ¹ç›®å½•ã€‚</span><br><span class=\"line\">-printï¼š findå‘½ä»¤å°†åŒ¹é…çš„æ–‡ä»¶è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºã€‚</span><br><span class=\"line\">-execï¼š findå‘½ä»¤å¯¹åŒ¹é…çš„æ–‡ä»¶æ‰§è¡Œè¯¥å‚æ•°æ‰€ç»™å‡ºçš„shellå‘½ä»¤ã€‚ç›¸åº”å‘½ä»¤çš„å½¢å¼ä¸º&#x27;command&#x27; &#123;  &#125; \\;ï¼Œæ³¨æ„&#123;   &#125;å’Œ\\ï¼›ä¹‹é—´çš„ç©ºæ ¼ã€‚</span><br><span class=\"line\">-okï¼š å’Œ-execçš„ä½œç”¨ç›¸åŒï¼Œåªä¸è¿‡ä»¥ä¸€ç§æ›´ä¸ºå®‰å…¨çš„æ¨¡å¼æ¥æ‰§è¡Œè¯¥å‚æ•°æ‰€ç»™å‡ºçš„shellå‘½ä»¤ï¼Œåœ¨æ‰§è¡Œæ¯ä¸€ä¸ªå‘½ä»¤ä¹‹å‰ï¼Œéƒ½ä¼šç»™å‡ºæç¤ºï¼Œè®©ç”¨æˆ·æ¥ç¡®å®šæ˜¯å¦æ‰§è¡Œã€‚</span><br></pre></td></tr></table></figure>\n\n<p><strong>å‘½ä»¤é€‰é¡¹</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-name æŒ‰ç…§æ–‡ä»¶åæŸ¥æ‰¾æ–‡ä»¶</span><br><span class=\"line\">-perm æŒ‰æ–‡ä»¶æƒé™æŸ¥æ‰¾æ–‡ä»¶</span><br><span class=\"line\">-user æŒ‰æ–‡ä»¶å±ä¸»æŸ¥æ‰¾æ–‡ä»¶</span><br><span class=\"line\">-group  æŒ‰ç…§æ–‡ä»¶æ‰€å±çš„ç»„æ¥æŸ¥æ‰¾æ–‡ä»¶ã€‚</span><br><span class=\"line\">-type  æŸ¥æ‰¾æŸä¸€ç±»å‹çš„æ–‡ä»¶ï¼Œè¯¸å¦‚ï¼š</span><br><span class=\"line\">   b - å—è®¾å¤‡æ–‡ä»¶</span><br><span class=\"line\">   d - ç›®å½•</span><br><span class=\"line\">   c - å­—ç¬¦è®¾å¤‡æ–‡ä»¶</span><br><span class=\"line\">   l - ç¬¦å·é“¾æ¥æ–‡ä»¶</span><br><span class=\"line\">   p - ç®¡é“æ–‡ä»¶</span><br><span class=\"line\">   f - æ™®é€šæ–‡ä»¶</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰æŸ¥æ‰¾ 48 å°æ—¶å†…ä¿®æ”¹è¿‡çš„æ–‡ä»¶</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">find -atime -2</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰åœ¨å½“å‰ç›®å½•æŸ¥æ‰¾ ä»¥ .log ç»“å°¾çš„æ–‡ä»¶ã€‚ <strong>.</strong> ä»£è¡¨å½“å‰ç›®å½•</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">find ./ -name &#x27;*.log&#x27;</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ3ï¼‰æŸ¥æ‰¾ &#x2F;opt ç›®å½•ä¸‹ æƒé™ä¸º 777 çš„æ–‡ä»¶</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">find /opt -perm 777</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ4ï¼‰æŸ¥æ‰¾å¤§äº 1K çš„æ–‡ä»¶</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">find -size +1000c</span><br></pre></td></tr></table></figure>\n\n<p>æŸ¥æ‰¾ç­‰äº 1000 å­—ç¬¦çš„æ–‡ä»¶</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">find -size 1000c </span><br></pre></td></tr></table></figure>\n\n<p>-exec å‚æ•°åé¢è·Ÿçš„æ˜¯ command å‘½ä»¤ï¼Œå®ƒçš„ç»ˆæ­¢æ˜¯ä»¥ ; ä¸ºç»“æŸæ ‡å¿—çš„ï¼Œæ‰€ä»¥è¿™å¥å‘½ä»¤åé¢çš„åˆ†å·æ˜¯ä¸å¯ç¼ºå°‘çš„ï¼Œè€ƒè™‘åˆ°å„ä¸ªç³»ç»Ÿä¸­åˆ†å·ä¼šæœ‰ä¸åŒçš„æ„ä¹‰ï¼Œæ‰€ä»¥å‰é¢åŠ åæ–œæ ã€‚{} èŠ±æ‹¬å·ä»£è¡¨å‰é¢ find æŸ¥æ‰¾å‡ºæ¥çš„æ–‡ä»¶åã€‚</p>\n<h3 id=\"head-å‘½ä»¤\"><a href=\"#head-å‘½ä»¤\" class=\"headerlink\" title=\"head å‘½ä»¤\"></a>head å‘½ä»¤</h3><p>head ç”¨æ¥æ˜¾ç¤ºæ¡£æ¡ˆçš„å¼€å¤´è‡³æ ‡å‡†è¾“å‡ºä¸­ï¼Œé»˜è®¤ head å‘½ä»¤æ‰“å°å…¶ç›¸åº”æ–‡ä»¶çš„å¼€å¤´ 10 è¡Œã€‚</p>\n<p><strong>å¸¸ç”¨å‚æ•°</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-n&lt;è¡Œæ•°&gt; æ˜¾ç¤ºçš„è¡Œæ•°ï¼ˆè¡Œæ•°ä¸ºå¤æ•°è¡¨ç¤ºä»æœ€åå‘å‰æ•°ï¼‰</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰æ˜¾ç¤º 1.log æ–‡ä»¶ä¸­å‰ 20 è¡Œ</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">head 1.log -n 20</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰æ˜¾ç¤º 1.log æ–‡ä»¶å‰ 20 å­—èŠ‚</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">head 1.log -c 20 </span><br><span class=\"line\">1</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ3ï¼‰æ˜¾ç¤º 1.log æœ€å 10 è¡Œ</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">head 1.log -n -10</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"less-å‘½ä»¤\"><a href=\"#less-å‘½ä»¤\" class=\"headerlink\" title=\"less å‘½ä»¤\"></a>less å‘½ä»¤</h3><p>less ä¸ more ç±»ä¼¼ï¼Œä½†ä½¿ç”¨ less å¯ä»¥éšæ„æµè§ˆæ–‡ä»¶ï¼Œè€Œ more ä»…èƒ½å‘å‰ç§»åŠ¨ï¼Œå´ä¸èƒ½å‘åç§»åŠ¨ï¼Œè€Œä¸” less åœ¨æŸ¥çœ‹ä¹‹å‰ä¸ä¼šåŠ è½½æ•´ä¸ªæ–‡ä»¶ã€‚</p>\n<p><strong>å¸¸ç”¨å‘½ä»¤å‚æ•°</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-i  å¿½ç•¥æœç´¢æ—¶çš„å¤§å°å†™</span><br><span class=\"line\">-N  æ˜¾ç¤ºæ¯è¡Œçš„è¡Œå·</span><br><span class=\"line\">-o  &lt;æ–‡ä»¶å&gt; å°†less è¾“å‡ºçš„å†…å®¹åœ¨æŒ‡å®šæ–‡ä»¶ä¸­ä¿å­˜èµ·æ¥</span><br><span class=\"line\">-s  æ˜¾ç¤ºè¿ç»­ç©ºè¡Œä¸ºä¸€è¡Œ</span><br><span class=\"line\">/å­—ç¬¦ä¸²ï¼šå‘ä¸‹æœç´¢â€œå­—ç¬¦ä¸²â€çš„åŠŸèƒ½</span><br><span class=\"line\">?å­—ç¬¦ä¸²ï¼šå‘ä¸Šæœç´¢â€œå­—ç¬¦ä¸²â€çš„åŠŸèƒ½</span><br><span class=\"line\">nï¼šé‡å¤å‰ä¸€ä¸ªæœç´¢ï¼ˆä¸ / æˆ– ? æœ‰å…³ï¼‰</span><br><span class=\"line\">Nï¼šåå‘é‡å¤å‰ä¸€ä¸ªæœç´¢ï¼ˆä¸ / æˆ– ? æœ‰å…³ï¼‰</span><br><span class=\"line\">-x &lt;æ•°å­—&gt; å°†â€œtabâ€é”®æ˜¾ç¤ºä¸ºè§„å®šçš„æ•°å­—ç©ºæ ¼</span><br><span class=\"line\">b  å‘åç¿»ä¸€é¡µ</span><br><span class=\"line\">d  å‘åç¿»åŠé¡µ</span><br><span class=\"line\">h  æ˜¾ç¤ºå¸®åŠ©ç•Œé¢</span><br><span class=\"line\">Q  é€€å‡ºless å‘½ä»¤</span><br><span class=\"line\">u  å‘å‰æ»šåŠ¨åŠé¡µ</span><br><span class=\"line\">y  å‘å‰æ»šåŠ¨ä¸€è¡Œ</span><br><span class=\"line\">ç©ºæ ¼é”® æ»šåŠ¨ä¸€è¡Œ</span><br><span class=\"line\">å›è½¦é”® æ»šåŠ¨ä¸€é¡µ</span><br><span class=\"line\">[pagedown]ï¼š å‘ä¸‹ç¿»åŠ¨ä¸€é¡µ</span><br><span class=\"line\">[pageup]ï¼š   å‘ä¸Šç¿»åŠ¨ä¸€é¡µ</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰ps æŸ¥çœ‹è¿›ç¨‹ä¿¡æ¯å¹¶é€šè¿‡ less åˆ†é¡µæ˜¾ç¤º</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ps -aux | less -N</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰æŸ¥çœ‹å¤šä¸ªæ–‡ä»¶</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">less 1.log 2.log</span><br></pre></td></tr></table></figure>\n\n<p>å¯ä»¥ä½¿ç”¨ n æŸ¥çœ‹ä¸‹ä¸€ä¸ªï¼Œä½¿ç”¨ p æŸ¥çœ‹å‰ä¸€ä¸ªã€‚</p>\n<h3 id=\"ln-å‘½ä»¤\"><a href=\"#ln-å‘½ä»¤\" class=\"headerlink\" title=\"ln å‘½ä»¤\"></a>ln å‘½ä»¤</h3><p>åŠŸèƒ½æ˜¯ä¸ºæ–‡ä»¶åœ¨å¦å¤–ä¸€ä¸ªä½ç½®å»ºç«‹ä¸€ä¸ªåŒæ­¥çš„é“¾æ¥ï¼Œå½“åœ¨ä¸åŒç›®å½•éœ€è¦è¯¥é—®é¢˜æ—¶ï¼Œå°±ä¸éœ€è¦ä¸ºæ¯ä¸€ä¸ªç›®å½•åˆ›å»ºåŒæ ·çš„æ–‡ä»¶ï¼Œé€šè¿‡ ln åˆ›å»ºçš„é“¾æ¥ï¼ˆlinkï¼‰å‡å°‘ç£ç›˜å ç”¨é‡ã€‚</p>\n<p>é“¾æ¥åˆ†ç±»ï¼šè½¯ä»¶é“¾æ¥åŠç¡¬é“¾æ¥</p>\n<p>è½¯é“¾æ¥ï¼š</p>\n<ul>\n<li>1.è½¯é“¾æ¥ï¼Œä»¥è·¯å¾„çš„å½¢å¼å­˜åœ¨ã€‚ç±»ä¼¼äº Windows æ“ä½œç³»ç»Ÿä¸­çš„å¿«æ·æ–¹å¼</li>\n<li>2.è½¯é“¾æ¥å¯ä»¥ è·¨æ–‡ä»¶ç³»ç»Ÿ ï¼Œç¡¬é“¾æ¥ä¸å¯ä»¥</li>\n<li>3.è½¯é“¾æ¥å¯ä»¥å¯¹ä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶åè¿›è¡Œé“¾æ¥</li>\n<li>4.è½¯é“¾æ¥å¯ä»¥å¯¹ç›®å½•è¿›è¡Œé“¾æ¥</li>\n</ul>\n<p>ç¡¬é“¾æ¥:</p>\n<ul>\n<li>1.ç¡¬é“¾æ¥ï¼Œä»¥æ–‡ä»¶å‰¯æœ¬çš„å½¢å¼å­˜åœ¨ã€‚ä½†ä¸å ç”¨å®é™…ç©ºé—´ã€‚</li>\n<li>2.ä¸å…è®¸ç»™ç›®å½•åˆ›å»ºç¡¬é“¾æ¥</li>\n<li>3.ç¡¬é“¾æ¥åªæœ‰åœ¨åŒä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿä¸­æ‰èƒ½åˆ›å»º</li>\n</ul>\n<p><strong>éœ€è¦æ³¨æ„</strong>ï¼š</p>\n<ul>\n<li>ç¬¬ä¸€ï¼šln å‘½ä»¤ä¼šä¿æŒæ¯ä¸€å¤„é“¾æ¥æ–‡ä»¶çš„åŒæ­¥æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸è®ºä½ æ”¹åŠ¨äº†å“ªä¸€å¤„ï¼Œå…¶å®ƒçš„æ–‡ä»¶éƒ½ä¼šå‘ç”Ÿç›¸åŒçš„å˜åŒ–ï¼›</li>\n<li>ç¬¬äºŒï¼šln çš„é“¾æ¥åˆåˆ†è½¯é“¾æ¥å’Œç¡¬é“¾æ¥ä¸¤ç§ï¼Œè½¯é“¾æ¥å°±æ˜¯ ln â€“s æºæ–‡ä»¶ ç›®æ ‡æ–‡ä»¶ï¼Œå®ƒåªä¼šåœ¨ä½ é€‰å®šçš„ä½ç½®ä¸Šç”Ÿæˆä¸€ä¸ªæ–‡ä»¶çš„é•œåƒï¼Œä¸ä¼šå ç”¨ç£ç›˜ç©ºé—´ï¼Œç¡¬é“¾æ¥ ln æºæ–‡ä»¶ ç›®æ ‡æ–‡ä»¶ï¼Œæ²¡æœ‰å‚æ•°-sï¼Œ å®ƒä¼šåœ¨ä½ é€‰å®šçš„ä½ç½®ä¸Šç”Ÿæˆä¸€ä¸ªå’Œæºæ–‡ä»¶å¤§å°ç›¸åŒçš„æ–‡ä»¶ï¼Œæ— è®ºæ˜¯è½¯é“¾æ¥è¿˜æ˜¯ç¡¬é“¾æ¥ï¼Œæ–‡ä»¶éƒ½ä¿æŒåŒæ­¥å˜åŒ–ã€‚</li>\n<li>ç¬¬ä¸‰ï¼šln æŒ‡ä»¤ç”¨åœ¨é“¾æ¥æ–‡ä»¶æˆ–ç›®å½•ï¼Œå¦‚åŒæ—¶æŒ‡å®šä¸¤ä¸ªä»¥ä¸Šçš„æ–‡ä»¶æˆ–ç›®å½•ï¼Œä¸”æœ€åçš„ç›®çš„åœ°æ˜¯ä¸€ä¸ªå·²ç»å­˜åœ¨çš„ç›®å½•ï¼Œåˆ™ä¼šæŠŠå‰é¢æŒ‡å®šçš„æ‰€æœ‰æ–‡ä»¶æˆ–ç›®å½•å¤åˆ¶åˆ°è¯¥ç›®å½•ä¸­ã€‚è‹¥åŒæ—¶æŒ‡å®šå¤šä¸ªæ–‡ä»¶æˆ–ç›®å½•ï¼Œä¸”æœ€åçš„ç›®çš„åœ°å¹¶éæ˜¯ä¸€ä¸ªå·²å­˜åœ¨çš„ç›®å½•ï¼Œåˆ™ä¼šå‡ºç°é”™è¯¯ä¿¡æ¯ã€‚</li>\n</ul>\n<p><strong>å¸¸ç”¨å‚æ•°</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-b åˆ é™¤ï¼Œè¦†ç›–ä»¥å‰å»ºç«‹çš„é“¾æ¥</span><br><span class=\"line\">-s è½¯é“¾æ¥ï¼ˆç¬¦å·é“¾æ¥ï¼‰</span><br><span class=\"line\">-v æ˜¾ç¤ºè¯¦ç»†å¤„ç†è¿‡ç¨‹</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰ç»™æ–‡ä»¶åˆ›å»ºè½¯é“¾æ¥ï¼Œå¹¶æ˜¾ç¤ºæ“ä½œä¿¡æ¯</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ln -sv source.log link.log</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰ç»™æ–‡ä»¶åˆ›å»ºç¡¬é“¾æ¥ï¼Œå¹¶æ˜¾ç¤ºæ“ä½œä¿¡æ¯</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ln -v source.log link1.log</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ3ï¼‰ç»™ç›®å½•åˆ›å»ºè½¯é“¾æ¥</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ln -sv /opt/soft/test/test3 /opt/soft/test/test5</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"locate-å‘½ä»¤\"><a href=\"#locate-å‘½ä»¤\" class=\"headerlink\" title=\"locate å‘½ä»¤\"></a>locate å‘½ä»¤</h3><p>locate é€šè¿‡æœå¯»ç³»ç»Ÿå†…å»ºæ–‡æ¡£æ•°æ®åº“è¾¾åˆ°å¿«é€Ÿæ‰¾åˆ°æ¡£æ¡ˆï¼Œæ•°æ®åº“ç”± updatedb ç¨‹åºæ¥æ›´æ–°ï¼Œupdatedb æ˜¯ç”± cron daemon å‘¨æœŸæ€§è°ƒç”¨çš„ã€‚é»˜è®¤æƒ…å†µä¸‹ locate å‘½ä»¤åœ¨æœå¯»æ•°æ®åº“æ—¶æ¯”ç”±æ•´ä¸ªç”±ç¡¬ç›˜èµ„æ–™æ¥æœå¯»èµ„æ–™æ¥å¾—å¿«ï¼Œä½†è¾ƒå·®åŠ²çš„æ˜¯ locate æ‰€æ‰¾åˆ°çš„æ¡£æ¡ˆè‹¥æ˜¯æœ€è¿‘æ‰å»ºç«‹æˆ– åˆšæ›´åçš„ï¼Œå¯èƒ½ä¼šæ‰¾ä¸åˆ°ï¼Œåœ¨å†…å®šå€¼ä¸­ï¼Œupdatedb æ¯å¤©ä¼šè·‘ä¸€æ¬¡ï¼Œå¯ä»¥ç”±ä¿®æ”¹ crontab æ¥æ›´æ–°è®¾å®šå€¼ (etc&#x2F;crontab)ã€‚</p>\n<p>locate ä¸ find å‘½ä»¤ç›¸ä¼¼ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ *ã€? ç­‰è¿›è¡Œæ­£åˆ™åŒ¹é…æŸ¥æ‰¾</p>\n<p><strong>å¸¸ç”¨å‚æ•°</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-l numï¼ˆè¦æ˜¾ç¤ºçš„è¡Œæ•°ï¼‰</span><br><span class=\"line\">-f   å°†ç‰¹å®šçš„æ¡£æ¡ˆç³»ç»Ÿæ’é™¤åœ¨å¤–ï¼Œå¦‚å°†procæ’é™¤åœ¨å¤–</span><br><span class=\"line\">-r   ä½¿ç”¨æ­£åˆ™è¿ç®—å¼åšä¸ºå¯»æ‰¾æ¡ä»¶</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰æŸ¥æ‰¾å’Œ pwd ç›¸å…³çš„æ‰€æœ‰æ–‡ä»¶(æ–‡ä»¶åä¸­åŒ…å« pwdï¼‰</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">locate pwd</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰æœç´¢ etc ç›®å½•ä¸‹æ‰€æœ‰ä»¥ sh å¼€å¤´çš„æ–‡ä»¶</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">locate /etc/sh</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ3ï¼‰æŸ¥æ‰¾ &#x2F;var ç›®å½•ä¸‹ï¼Œä»¥ reason ç»“å°¾çš„æ–‡ä»¶</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">locate -r &#x27;^/var.*reason$&#x27;ï¼ˆå…¶ä¸­.è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼Œ*è¡¨ç¤ºä»»åŠ¡å¤šä¸ªï¼›.*è¡¨ç¤ºä»»æ„å¤šä¸ªå­—ç¬¦ï¼‰</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"more-å‘½ä»¤\"><a href=\"#more-å‘½ä»¤\" class=\"headerlink\" title=\"more å‘½ä»¤\"></a>more å‘½ä»¤</h3><p>åŠŸèƒ½ç±»ä¼¼äº cat, more ä¼šä»¥ä¸€é¡µä¸€é¡µçš„æ˜¾ç¤ºæ–¹ä¾¿ä½¿ç”¨è€…é€é¡µé˜…è¯»ï¼Œè€Œæœ€åŸºæœ¬çš„æŒ‡ä»¤å°±æ˜¯æŒ‰ç©ºç™½é”®ï¼ˆspaceï¼‰å°±å¾€ä¸‹ä¸€é¡µæ˜¾ç¤ºï¼ŒæŒ‰ b é”®å°±ä¼šå¾€å›ï¼ˆbackï¼‰ä¸€é¡µæ˜¾ç¤ºã€‚</p>\n<p><strong>å‘½ä»¤å‚æ•°</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">+n      ä»ç¬« n è¡Œå¼€å§‹æ˜¾ç¤º</span><br><span class=\"line\">-n       å®šä¹‰å±å¹•å¤§å°ä¸ºnè¡Œ</span><br><span class=\"line\">+/pattern åœ¨æ¯ä¸ªæ¡£æ¡ˆæ˜¾ç¤ºå‰æœå¯»è¯¥å­—ä¸²ï¼ˆpatternï¼‰ï¼Œç„¶åä»è¯¥å­—ä¸²å‰ä¸¤è¡Œä¹‹åå¼€å§‹æ˜¾ç¤º </span><br><span class=\"line\">-c       ä»é¡¶éƒ¨æ¸…å±ï¼Œç„¶åæ˜¾ç¤º</span><br><span class=\"line\">-d       æç¤ºâ€œPress space to continueï¼Œâ€™qâ€™ to quitï¼ˆæŒ‰ç©ºæ ¼é”®ç»§ç»­ï¼ŒæŒ‰qé”®é€€å‡ºï¼‰â€ï¼Œç¦ç”¨å“é“ƒåŠŸèƒ½</span><br><span class=\"line\">-l        å¿½ç•¥Ctrl+lï¼ˆæ¢é¡µï¼‰å­—ç¬¦</span><br><span class=\"line\">-p       é€šè¿‡æ¸…é™¤çª—å£è€Œä¸æ˜¯æ»šå±æ¥å¯¹æ–‡ä»¶è¿›è¡Œæ¢é¡µï¼Œä¸-cé€‰é¡¹ç›¸ä¼¼</span><br><span class=\"line\">-s       æŠŠè¿ç»­çš„å¤šä¸ªç©ºè¡Œæ˜¾ç¤ºä¸ºä¸€è¡Œ</span><br><span class=\"line\">-u       æŠŠæ–‡ä»¶å†…å®¹ä¸­çš„ä¸‹ç”»çº¿å»æ‰</span><br></pre></td></tr></table></figure>\n\n<p><strong>å¸¸ç”¨æ“ä½œå‘½ä»¤</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Enter    å‘ä¸‹ n è¡Œï¼Œéœ€è¦å®šä¹‰ã€‚é»˜è®¤ä¸º 1 è¡Œ</span><br><span class=\"line\">Ctrl+F   å‘ä¸‹æ»šåŠ¨ä¸€å±</span><br><span class=\"line\">ç©ºæ ¼é”®  å‘ä¸‹æ»šåŠ¨ä¸€å±</span><br><span class=\"line\">Ctrl+B  è¿”å›ä¸Šä¸€å±</span><br><span class=\"line\">=       è¾“å‡ºå½“å‰è¡Œçš„è¡Œå·</span><br><span class=\"line\">:f     è¾“å‡ºæ–‡ä»¶åå’Œå½“å‰è¡Œçš„è¡Œå·</span><br><span class=\"line\">V      è°ƒç”¨viç¼–è¾‘å™¨</span><br><span class=\"line\">!å‘½ä»¤   è°ƒç”¨Shellï¼Œå¹¶æ‰§è¡Œå‘½ä»¤</span><br><span class=\"line\">q       é€€å‡ºmore</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰æ˜¾ç¤ºæ–‡ä»¶ä¸­ä»ç¬¬ 3 è¡Œèµ·çš„å†…å®¹</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">more +3 text.txt</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰åœ¨æ‰€åˆ—å‡ºæ–‡ä»¶ç›®å½•è¯¦ç»†ä¿¡æ¯ï¼Œå€ŸåŠ©ç®¡é“ä½¿æ¯æ¬¡æ˜¾ç¤º 5 è¡Œ</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ls -l | more -5</span><br></pre></td></tr></table></figure>\n\n<p>æŒ‰ç©ºæ ¼æ˜¾ç¤ºä¸‹ 5 è¡Œã€‚</p>\n<h3 id=\"mv-å‘½ä»¤\"><a href=\"#mv-å‘½ä»¤\" class=\"headerlink\" title=\"mv å‘½ä»¤\"></a>mv å‘½ä»¤</h3><p>ç§»åŠ¨æ–‡ä»¶æˆ–ä¿®æ”¹æ–‡ä»¶åï¼Œæ ¹æ®ç¬¬äºŒå‚æ•°ç±»å‹ï¼ˆå¦‚ç›®å½•ï¼Œåˆ™ç§»åŠ¨æ–‡ä»¶ï¼›å¦‚ä¸ºæ–‡ä»¶åˆ™é‡å‘½ä»¤è¯¥æ–‡ä»¶ï¼‰ã€‚</p>\n<p>å½“ç¬¬äºŒä¸ªå‚æ•°ä¸ºç›®å½•æ—¶ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥æ˜¯å¤šä¸ªä»¥ç©ºæ ¼åˆ†éš”çš„æ–‡ä»¶æˆ–ç›®å½•ï¼Œç„¶åç§»åŠ¨ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šçš„å¤šä¸ªæ–‡ä»¶åˆ°ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šçš„ç›®å½•ä¸­ã€‚</p>\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰å°†æ–‡ä»¶ test.log é‡å‘½åä¸º test1.txt</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mv test.log test1.txt</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰å°†æ–‡ä»¶ log1.txtã€log2.txtã€log3.txt ç§»åŠ¨åˆ°æ ¹çš„ test3 ç›®å½•ä¸­</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mv llog1.txt log2.txt log3.txt /test3</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ3ï¼‰å°†æ–‡ä»¶ file1 æ”¹åä¸º file2ï¼Œå¦‚æœ file2 å·²ç»å­˜åœ¨ï¼Œåˆ™è¯¢é—®æ˜¯å¦è¦†ç›–</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mv -i log1.txt log2.txt</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ4ï¼‰ç§»åŠ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åˆ°ä¸Šä¸€çº§ç›®å½•</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mv * ../</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"rm-å‘½ä»¤\"><a href=\"#rm-å‘½ä»¤\" class=\"headerlink\" title=\"rm å‘½ä»¤\"></a>rm å‘½ä»¤</h3><p>åˆ é™¤ä¸€ä¸ªç›®å½•ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶æˆ–ç›®å½•ï¼Œå¦‚æœæ²¡æœ‰ä½¿ç”¨ -r é€‰é¡¹ï¼Œåˆ™ rm ä¸ä¼šåˆ é™¤ç›®å½•ã€‚å¦‚æœä½¿ç”¨ rm æ¥åˆ é™¤æ–‡ä»¶ï¼Œé€šå¸¸ä»å¯ä»¥å°†è¯¥æ–‡ä»¶æ¢å¤åŸçŠ¶ã€‚</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rm [é€‰é¡¹] æ–‡ä»¶â€¦</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰åˆ é™¤ä»»ä½• .log æ–‡ä»¶ï¼Œåˆ é™¤å‰é€ä¸€è¯¢é—®ç¡®è®¤ï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rm -i *.log</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰åˆ é™¤ test å­ç›®å½•åŠå­ç›®å½•ä¸­æ‰€æœ‰æ¡£æ¡ˆåˆ é™¤ï¼Œå¹¶ä¸”ä¸ç”¨ä¸€ä¸€ç¡®è®¤ï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rm -rf test</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ3ï¼‰åˆ é™¤ä»¥ -f å¼€å¤´çš„æ–‡ä»¶</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rm -- -f*</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"tail-å‘½ä»¤\"><a href=\"#tail-å‘½ä»¤\" class=\"headerlink\" title=\"tail å‘½ä»¤\"></a>tail å‘½ä»¤</h3><p>ç”¨äºæ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶æœ«å°¾å†…å®¹ï¼Œä¸æŒ‡å®šæ–‡ä»¶æ—¶ï¼Œä½œä¸ºè¾“å…¥ä¿¡æ¯è¿›è¡Œå¤„ç†ã€‚å¸¸ç”¨æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ã€‚</p>\n<p><strong>å¸¸ç”¨å‚æ•°</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-f å¾ªç¯è¯»å–ï¼ˆå¸¸ç”¨äºæŸ¥çœ‹é€’å¢çš„æ—¥å¿—æ–‡ä»¶ï¼‰</span><br><span class=\"line\">-n&lt;è¡Œæ•°&gt; æ˜¾ç¤ºè¡Œæ•°ï¼ˆä»åå‘å‰ï¼‰</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ1ï¼‰å¾ªç¯è¯»å–é€æ¸å¢åŠ çš„æ–‡ä»¶å†…å®¹</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ping 127.0.0.1 &gt; ping.log &amp;</span><br></pre></td></tr></table></figure>\n\n<p>åå°è¿è¡Œï¼šå¯ä½¿ç”¨ jobs -l æŸ¥çœ‹ï¼Œä¹Ÿå¯ä½¿ç”¨ fg å°†å…¶ç§»åˆ°å‰å°è¿è¡Œã€‚</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tail -f ping.log</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆæŸ¥çœ‹æ—¥å¿—ï¼‰</p>\n<h3 id=\"touch-å‘½ä»¤\"><a href=\"#touch-å‘½ä»¤\" class=\"headerlink\" title=\"touch å‘½ä»¤\"></a>touch å‘½ä»¤</h3><p>Linux touch å‘½ä»¤ç”¨äºä¿®æ”¹æ–‡ä»¶æˆ–è€…ç›®å½•çš„æ—¶é—´å±æ€§ï¼ŒåŒ…æ‹¬å­˜å–æ—¶é—´å’Œæ›´æ”¹æ—¶é—´ã€‚è‹¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œç³»ç»Ÿä¼šå»ºç«‹ä¸€ä¸ªæ–°çš„æ–‡ä»¶ã€‚</p>\n<p>ls -l å¯ä»¥æ˜¾ç¤ºæ¡£æ¡ˆçš„æ—¶é—´è®°å½•ã€‚</p>\n<p><strong>è¯­æ³•</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">touch [-acfm][-d&lt;æ—¥æœŸæ—¶é—´&gt;][-r&lt;å‚è€ƒæ–‡ä»¶æˆ–ç›®å½•&gt;] [-t&lt;æ—¥æœŸæ—¶é—´&gt;][--help][--version][æ–‡ä»¶æˆ–ç›®å½•â€¦]</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><strong>å‚æ•°è¯´æ˜</strong>ï¼š</li>\n<li>a æ”¹å˜æ¡£æ¡ˆçš„è¯»å–æ—¶é—´è®°å½•ã€‚</li>\n<li>m æ”¹å˜æ¡£æ¡ˆçš„ä¿®æ”¹æ—¶é—´è®°å½•ã€‚</li>\n<li>c å‡å¦‚ç›®çš„æ¡£æ¡ˆä¸å­˜åœ¨ï¼Œä¸ä¼šå»ºç«‹æ–°çš„æ¡£æ¡ˆã€‚ä¸ â€“no-create çš„æ•ˆæœä¸€æ ·ã€‚</li>\n<li>f ä¸ä½¿ç”¨ï¼Œæ˜¯ä¸ºäº†ä¸å…¶ä»– unix ç³»ç»Ÿçš„ç›¸å®¹æ€§è€Œä¿ç•™ã€‚</li>\n<li>r ä½¿ç”¨å‚è€ƒæ¡£çš„æ—¶é—´è®°å½•ï¼Œä¸ â€“file çš„æ•ˆæœä¸€æ ·ã€‚</li>\n<li>d è®¾å®šæ—¶é—´ä¸æ—¥æœŸï¼Œå¯ä»¥ä½¿ç”¨å„ç§ä¸åŒçš„æ ¼å¼ã€‚</li>\n<li>t è®¾å®šæ¡£æ¡ˆçš„æ—¶é—´è®°å½•ï¼Œæ ¼å¼ä¸ date æŒ‡ä»¤ç›¸åŒã€‚</li>\n<li>â€“no-create ä¸ä¼šå»ºç«‹æ–°æ¡£æ¡ˆã€‚</li>\n<li>â€“help åˆ—å‡ºæŒ‡ä»¤æ ¼å¼ã€‚</li>\n<li>â€“version åˆ—å‡ºç‰ˆæœ¬è®¯æ¯ã€‚</li>\n</ul>\n<p><strong>å®ä¾‹</strong></p>\n<p>ä½¿ç”¨æŒ‡ä»¤â€touchâ€ä¿®æ”¹æ–‡ä»¶â€testfileâ€çš„æ—¶é—´å±æ€§ä¸ºå½“å‰ç³»ç»Ÿæ—¶é—´ï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\">$ </span><span class=\"language-bash\"><span class=\"built_in\">touch</span> testfile                <span class=\"comment\">#ä¿®æ”¹æ–‡ä»¶çš„æ—¶é—´å±æ€§</span></span> </span><br></pre></td></tr></table></figure>\n\n<p>é¦–å…ˆï¼Œä½¿ç”¨ ls å‘½ä»¤æŸ¥çœ‹ testfile æ–‡ä»¶çš„å±æ€§ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\">$ </span><span class=\"language-bash\"><span class=\"built_in\">ls</span> -l testfile                <span class=\"comment\">#æŸ¥çœ‹æ–‡ä»¶çš„æ—¶é—´å±æ€§</span></span>  </span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">åŸæ¥æ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´ä¸º16:09</span>  </span><br><span class=\"line\">-rw-r--r-- 1 hdd hdd 55 2011-08-22 16:09 testfile  </span><br></pre></td></tr></table></figure>\n\n<p>æ‰§è¡ŒæŒ‡ä»¤â€touchâ€ä¿®æ”¹æ–‡ä»¶å±æ€§ä»¥åï¼Œå¹¶å†æ¬¡æŸ¥çœ‹è¯¥æ–‡ä»¶çš„æ—¶é—´å±æ€§ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\">$ </span><span class=\"language-bash\"><span class=\"built_in\">touch</span> testfile                <span class=\"comment\">#ä¿®æ”¹æ–‡ä»¶æ—¶é—´å±æ€§ä¸ºå½“å‰ç³»ç»Ÿæ—¶é—´</span></span>  </span><br><span class=\"line\"><span class=\"meta prompt_\">$ </span><span class=\"language-bash\"><span class=\"built_in\">ls</span> -l testfile                <span class=\"comment\">#æŸ¥çœ‹æ–‡ä»¶çš„æ—¶é—´å±æ€§</span></span>  </span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">ä¿®æ”¹åæ–‡ä»¶çš„æ—¶é—´å±æ€§ä¸ºå½“å‰ç³»ç»Ÿæ—¶é—´</span>  </span><br><span class=\"line\">-rw-r--r-- 1 hdd hdd 55 2011-08-22 19:53 testfile  </span><br></pre></td></tr></table></figure>\n\n<p>ä½¿ç”¨æŒ‡ä»¤â€touchâ€æ—¶ï¼Œå¦‚æœæŒ‡å®šçš„æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™å°†åˆ›å»ºä¸€ä¸ªæ–°çš„ç©ºç™½æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼Œåœ¨å½“å‰ç›®å½•ä¸‹ï¼Œä½¿ç”¨è¯¥æŒ‡ä»¤åˆ›å»ºä¸€ä¸ªç©ºç™½æ–‡ä»¶â€fileâ€ï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\">$ </span><span class=\"language-bash\"><span class=\"built_in\">touch</span> file            <span class=\"comment\">#åˆ›å»ºä¸€ä¸ªåä¸ºâ€œfileâ€çš„æ–°çš„ç©ºç™½æ–‡ä»¶</span></span> </span><br></pre></td></tr></table></figure>\n\n<h3 id=\"vim-å‘½ä»¤\"><a href=\"#vim-å‘½ä»¤\" class=\"headerlink\" title=\"vim å‘½ä»¤\"></a>vim å‘½ä»¤</h3><p>Vim æ˜¯ä» vi å‘å±•å‡ºæ¥çš„ä¸€ä¸ªæ–‡æœ¬ç¼–è¾‘å™¨ã€‚ä»£ç è¡¥å®Œã€ç¼–è¯‘åŠé”™è¯¯è·³è½¬ç­‰æ–¹ä¾¿ç¼–ç¨‹çš„åŠŸèƒ½ç‰¹åˆ«ä¸°å¯Œï¼Œåœ¨ç¨‹åºå‘˜ä¸­è¢«å¹¿æ³›ä½¿ç”¨ã€‚</p>\n<ul>\n<li>æ‰“å¼€æ–‡ä»¶å¹¶è·³åˆ°ç¬¬ 10 è¡Œï¼š<code>vim +10 filename.txt</code> ã€‚</li>\n<li>æ‰“å¼€æ–‡ä»¶è·³åˆ°ç¬¬ä¸€ä¸ªåŒ¹é…çš„è¡Œï¼š<code>vim +/search-term filename.txt</code> ã€‚</li>\n<li>ä»¥åªè¯»æ¨¡å¼æ‰“å¼€æ–‡ä»¶ï¼š<code>vim -R /etc/passwd</code> ã€‚</li>\n</ul>\n<p>åŸºæœ¬ä¸Š vi&#x2F;vim å…±åˆ†ä¸ºä¸‰ç§æ¨¡å¼ï¼Œåˆ†åˆ«æ˜¯<strong>å‘½ä»¤æ¨¡å¼ï¼ˆCommand modeï¼‰</strong>ï¼Œ**è¾“å…¥æ¨¡å¼ï¼ˆInsert modeï¼‰**å’Œ**åº•çº¿å‘½ä»¤æ¨¡å¼ï¼ˆLast line modeï¼‰**ã€‚</p>\n<p>ç®€å•çš„è¯´ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸‰ä¸ªæ¨¡å¼æƒ³æˆåº•ä¸‹çš„å›¾æ ‡æ¥è¡¨ç¤ºï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/format,png-20230125135806349.png\" alt=\"vim å·¥ä½œæ¨¡å¼\"></p>\n<h3 id=\"whereis-å‘½ä»¤\"><a href=\"#whereis-å‘½ä»¤\" class=\"headerlink\" title=\"whereis å‘½ä»¤\"></a>whereis å‘½ä»¤</h3><p>whereis å‘½ä»¤åªèƒ½ç”¨äºç¨‹åºåçš„æœç´¢ï¼Œè€Œä¸”åªæœç´¢äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆå‚æ•°-bï¼‰ã€man è¯´æ˜æ–‡ä»¶ï¼ˆå‚æ•°-mï¼‰å’Œæºä»£ç æ–‡ä»¶ï¼ˆå‚æ•°-sï¼‰ã€‚å¦‚æœçœç•¥å‚æ•°ï¼Œåˆ™è¿”å›æ‰€æœ‰ä¿¡æ¯ã€‚whereis åŠ locate éƒ½æ˜¯åŸºäºç³»ç»Ÿå†…å»ºçš„æ•°æ®åº“è¿›è¡Œæœç´¢ï¼Œå› æ­¤æ•ˆç‡å¾ˆé«˜ï¼Œè€Œ find åˆ™æ˜¯éå†ç¡¬ç›˜æŸ¥æ‰¾æ–‡ä»¶ã€‚</p>\n<p><strong>å¸¸ç”¨å‚æ•°</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-b   å®šä½å¯æ‰§è¡Œæ–‡ä»¶ã€‚</span><br><span class=\"line\">-m   å®šä½å¸®åŠ©æ–‡ä»¶ã€‚</span><br><span class=\"line\">-s   å®šä½æºä»£ç æ–‡ä»¶ã€‚</span><br><span class=\"line\">-u   æœç´¢é»˜è®¤è·¯å¾„ä¸‹é™¤å¯æ‰§è¡Œæ–‡ä»¶ã€æºä»£ç æ–‡ä»¶ã€å¸®åŠ©æ–‡ä»¶ä»¥å¤–çš„å…¶å®ƒæ–‡ä»¶ã€‚</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰æŸ¥æ‰¾ locate ç¨‹åºç›¸å…³æ–‡ä»¶</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">whereis locate</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰æŸ¥æ‰¾ locate çš„æºç æ–‡ä»¶</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">whereis -s locate</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ3ï¼‰æŸ¥æ‰¾ lcoate çš„å¸®åŠ©æ–‡ä»¶</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">whereis -m locate</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"which-å‘½ä»¤\"><a href=\"#which-å‘½ä»¤\" class=\"headerlink\" title=\"which å‘½ä»¤\"></a>which å‘½ä»¤</h3><p>åœ¨ linux è¦æŸ¥æ‰¾æŸä¸ªæ–‡ä»¶ï¼Œä½†ä¸çŸ¥é“æ”¾åœ¨å“ªé‡Œäº†ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä¸€äº›å‘½ä»¤æ¥æœç´¢ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">which     æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶çš„ä½ç½®ã€‚</span><br><span class=\"line\">whereis æŸ¥çœ‹æ–‡ä»¶çš„ä½ç½®ã€‚</span><br><span class=\"line\">locate  é…åˆæ•°æ®åº“æŸ¥çœ‹æ–‡ä»¶ä½ç½®ã€‚</span><br><span class=\"line\">find        å®é™…æœå¯»ç¡¬ç›˜æŸ¥è¯¢æ–‡ä»¶åç§°ã€‚</span><br></pre></td></tr></table></figure>\n\n<p>which æ˜¯åœ¨ PATH å°±æ˜¯æŒ‡å®šçš„è·¯å¾„ä¸­ï¼Œæœç´¢æŸä¸ªç³»ç»Ÿå‘½ä»¤çš„ä½ç½®ï¼Œå¹¶è¿”å›ç¬¬ä¸€ä¸ªæœç´¢ç»“æœã€‚ä½¿ç”¨ which å‘½ä»¤ï¼Œå°±å¯ä»¥çœ‹åˆ°æŸä¸ªç³»ç»Ÿå‘½ä»¤æ˜¯å¦å­˜åœ¨ï¼Œä»¥åŠæ‰§è¡Œçš„åˆ°åº•æ˜¯å“ªä¸€ä¸ªä½ç½®çš„å‘½ä»¤ã€‚</p>\n<p><strong>å¸¸ç”¨å‚æ•°</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-n ã€€æŒ‡å®šæ–‡ä»¶åé•¿åº¦ï¼ŒæŒ‡å®šçš„é•¿åº¦å¿…é¡»å¤§äºæˆ–ç­‰äºæ‰€æœ‰æ–‡ä»¶ä¸­æœ€é•¿çš„æ–‡ä»¶åã€‚</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰æŸ¥çœ‹ ls å‘½ä»¤æ˜¯å¦å­˜åœ¨ï¼Œæ‰§è¡Œå“ªä¸ª</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">which ls</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰æŸ¥çœ‹ which</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">which which</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ3ï¼‰æŸ¥çœ‹ cd</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">which cdï¼ˆæ˜¾ç¤ºä¸å­˜åœ¨ï¼Œå› ä¸º cd æ˜¯å†…å»ºå‘½ä»¤ï¼Œè€Œ which æŸ¥æ‰¾æ˜¾ç¤ºæ˜¯ PATH ä¸­çš„å‘½ä»¤ï¼‰</span><br></pre></td></tr></table></figure>\n\n<p>æŸ¥çœ‹å½“å‰ PATH é…ç½®ï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">echo $PATH</span><br></pre></td></tr></table></figure>\n\n<p>æˆ–ä½¿ç”¨ env æŸ¥çœ‹æ‰€æœ‰ç¯å¢ƒå˜é‡åŠå¯¹åº”å€¼</p>\n<h2 id=\"æ–‡æ¡£ç¼–è¾‘å‘½ä»¤\"><a href=\"#æ–‡æ¡£ç¼–è¾‘å‘½ä»¤\" class=\"headerlink\" title=\"æ–‡æ¡£ç¼–è¾‘å‘½ä»¤\"></a>æ–‡æ¡£ç¼–è¾‘å‘½ä»¤</h2><h3 id=\"grep-å‘½ä»¤\"><a href=\"#grep-å‘½ä»¤\" class=\"headerlink\" title=\"grep å‘½ä»¤\"></a>grep å‘½ä»¤</h3><p>å¼ºå¤§çš„æ–‡æœ¬æœç´¢å‘½ä»¤ï¼Œgrep(Global Regular Expression Print) å…¨å±€æ­£åˆ™è¡¨è¾¾å¼æœç´¢ã€‚</p>\n<p>grep çš„å·¥ä½œæ–¹å¼æ˜¯è¿™æ ·çš„ï¼Œå®ƒåœ¨ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶ä¸­æœç´¢å­—ç¬¦ä¸²æ¨¡æ¿ã€‚å¦‚æœæ¨¡æ¿åŒ…æ‹¬ç©ºæ ¼ï¼Œåˆ™å¿…é¡»è¢«å¼•ç”¨ï¼Œæ¨¡æ¿åçš„æ‰€æœ‰å­—ç¬¦ä¸²è¢«çœ‹ä½œæ–‡ä»¶åã€‚æœç´¢çš„ç»“æœè¢«é€åˆ°æ ‡å‡†è¾“å‡ºï¼Œä¸å½±å“åŸæ–‡ä»¶å†…å®¹ã€‚</p>\n<p>å‘½ä»¤æ ¼å¼ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">grep [option] pattern file|dir</span><br></pre></td></tr></table></figure>\n\n<p><strong>å¸¸ç”¨å‚æ•°</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-A n --after-contextæ˜¾ç¤ºåŒ¹é…å­—ç¬¦ånè¡Œ</span><br><span class=\"line\">-B n --before-contextæ˜¾ç¤ºåŒ¹é…å­—ç¬¦å‰nè¡Œ</span><br><span class=\"line\">-C n --context æ˜¾ç¤ºåŒ¹é…å­—ç¬¦å‰ånè¡Œ</span><br><span class=\"line\">-c --count è®¡ç®—ç¬¦åˆæ ·å¼çš„åˆ—æ•°</span><br><span class=\"line\">-i å¿½ç•¥å¤§å°å†™</span><br><span class=\"line\">-l åªåˆ—å‡ºæ–‡ä»¶å†…å®¹ç¬¦åˆæŒ‡å®šçš„æ ·å¼çš„æ–‡ä»¶åç§°</span><br><span class=\"line\">-f ä»æ–‡ä»¶ä¸­è¯»å–å…³é”®è¯</span><br><span class=\"line\">-n æ˜¾ç¤ºåŒ¹é…å†…å®¹çš„æ‰€åœ¨æ–‡ä»¶ä¸­è¡Œæ•°</span><br><span class=\"line\">-R é€’å½’æŸ¥æ‰¾æ–‡ä»¶å¤¹</span><br></pre></td></tr></table></figure>\n\n<p>grep çš„è§„åˆ™è¡¨è¾¾å¼:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">^  #é”šå®šè¡Œçš„å¼€å§‹ å¦‚ï¼š&#x27;^grep&#x27;åŒ¹é…æ‰€æœ‰ä»¥grepå¼€å¤´çš„è¡Œã€‚ </span><br><span class=\"line\">$  #é”šå®šè¡Œçš„ç»“æŸ å¦‚ï¼š&#x27;grep$&#x27;åŒ¹é…æ‰€æœ‰ä»¥grepç»“å°¾çš„è¡Œã€‚ </span><br><span class=\"line\">.  #åŒ¹é…ä¸€ä¸ªéæ¢è¡Œç¬¦çš„å­—ç¬¦ å¦‚ï¼š&#x27;gr.p&#x27;åŒ¹é…gråæ¥ä¸€ä¸ªä»»æ„å­—ç¬¦ï¼Œç„¶åæ˜¯pã€‚  </span><br><span class=\"line\">*  #åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªå…ˆå‰å­—ç¬¦ å¦‚ï¼š&#x27;*grep&#x27;åŒ¹é…æ‰€æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªç©ºæ ¼åç´§è·Ÿgrepçš„è¡Œã€‚</span><br><span class=\"line\">.*   #ä¸€èµ·ç”¨ä»£è¡¨ä»»æ„å­—ç¬¦ã€‚  </span><br><span class=\"line\">[]   #åŒ¹é…ä¸€ä¸ªæŒ‡å®šèŒƒå›´å†…çš„å­—ç¬¦ï¼Œå¦‚&#x27;[Gg]rep&#x27;åŒ¹é…Grepå’Œgrepã€‚ </span><br><span class=\"line\">[^]  #åŒ¹é…ä¸€ä¸ªä¸åœ¨æŒ‡å®šèŒƒå›´å†…çš„å­—ç¬¦ï¼Œå¦‚ï¼š&#x27;[^A-FH-Z]rep&#x27;åŒ¹é…ä¸åŒ…å«A-Rå’ŒT-Zçš„ä¸€ä¸ªå­—æ¯å¼€å¤´ï¼Œç´§è·Ÿrepçš„è¡Œã€‚  </span><br><span class=\"line\">\\(..\\)  #æ ‡è®°åŒ¹é…å­—ç¬¦ï¼Œå¦‚&#x27;\\(love\\)&#x27;ï¼Œloveè¢«æ ‡è®°ä¸º1ã€‚   </span><br><span class=\"line\">\\&lt;      #é”šå®šå•è¯çš„å¼€å§‹ï¼Œå¦‚:&#x27;\\&lt;grep&#x27;åŒ¹é…åŒ…å«ä»¥grepå¼€å¤´çš„å•è¯çš„è¡Œã€‚</span><br><span class=\"line\">\\&gt;      #é”šå®šå•è¯çš„ç»“æŸï¼Œå¦‚&#x27;grep\\&gt;&#x27;åŒ¹é…åŒ…å«ä»¥grepç»“å°¾çš„å•è¯çš„è¡Œã€‚</span><br><span class=\"line\">x\\&#123;m\\&#125;  #é‡å¤å­—ç¬¦xï¼Œmæ¬¡ï¼Œå¦‚ï¼š&#x27;0\\&#123;5\\&#125;&#x27;åŒ¹é…åŒ…å«5ä¸ªoçš„è¡Œã€‚ </span><br><span class=\"line\">x\\&#123;m,\\&#125;  #é‡å¤å­—ç¬¦x,è‡³å°‘mæ¬¡ï¼Œå¦‚ï¼š&#x27;o\\&#123;5,\\&#125;&#x27;åŒ¹é…è‡³å°‘æœ‰5ä¸ªoçš„è¡Œã€‚  </span><br><span class=\"line\">x\\&#123;m,n\\&#125;  #é‡å¤å­—ç¬¦xï¼Œè‡³å°‘mæ¬¡ï¼Œä¸å¤šäºnæ¬¡ï¼Œå¦‚ï¼š&#x27;o\\&#123;5,10\\&#125;&#x27;åŒ¹é…5--10ä¸ªoçš„è¡Œã€‚  </span><br><span class=\"line\">\\w    #åŒ¹é…æ–‡å­—å’Œæ•°å­—å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯[A-Za-z0-9]ï¼Œå¦‚ï¼š&#x27;G\\w*p&#x27;åŒ¹é…ä»¥Gåè·Ÿé›¶ä¸ªæˆ–å¤šä¸ªæ–‡å­—æˆ–æ•°å­—å­—ç¬¦ï¼Œç„¶åæ˜¯pã€‚  </span><br><span class=\"line\">\\W    #\\wçš„åç½®å½¢å¼ï¼ŒåŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªéå•è¯å­—ç¬¦ï¼Œå¦‚ç‚¹å·å¥å·ç­‰ã€‚  </span><br><span class=\"line\">\\b    #å•è¯é”å®šç¬¦ï¼Œå¦‚: &#x27;\\bgrep\\b&#x27;åªåŒ¹é…grepã€‚</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰æŸ¥æ‰¾æŒ‡å®šè¿›ç¨‹</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ps -ef | grep svn</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰æŸ¥æ‰¾æŒ‡å®šè¿›ç¨‹ä¸ªæ•°</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ps -ef | grep svn -c</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ3ï¼‰ä»æ–‡ä»¶ä¸­è¯»å–å…³é”®è¯</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat test1.txt | grep -f key.log</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ4ï¼‰ä»æ–‡ä»¶å¤¹ä¸­é€’å½’æŸ¥æ‰¾ä»¥ grep å¼€å¤´çš„è¡Œï¼Œå¹¶åªåˆ—å‡ºæ–‡ä»¶</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">grep -lR &#x27;^grep&#x27; /tmp</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ5ï¼‰æŸ¥æ‰¾é x å¼€å…³çš„è¡Œå†…å®¹</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">grep &#x27;^[^x]&#x27; test.txt</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ6ï¼‰æ˜¾ç¤ºåŒ…å« ed æˆ–è€… at å­—ç¬¦çš„å†…å®¹è¡Œ</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">grep -E &#x27;ed|at&#x27; test.txt</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"wc-å‘½ä»¤\"><a href=\"#wc-å‘½ä»¤\" class=\"headerlink\" title=\"wc å‘½ä»¤\"></a>wc å‘½ä»¤</h3><p>wc(word count)åŠŸèƒ½ä¸ºç»Ÿè®¡æŒ‡å®šçš„æ–‡ä»¶ä¸­å­—èŠ‚æ•°ã€å­—æ•°ã€è¡Œæ•°ï¼Œå¹¶å°†ç»Ÿè®¡ç»“æœè¾“å‡º</p>\n<p>å‘½ä»¤æ ¼å¼ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wc [option] file..</span><br></pre></td></tr></table></figure>\n\n<p><strong>å‘½ä»¤å‚æ•°</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-c ç»Ÿè®¡å­—èŠ‚æ•°</span><br><span class=\"line\">-l ç»Ÿè®¡è¡Œæ•°</span><br><span class=\"line\">-m ç»Ÿè®¡å­—ç¬¦æ•°</span><br><span class=\"line\">-w ç»Ÿè®¡è¯æ•°ï¼Œä¸€ä¸ªå­—è¢«å®šä¹‰ä¸ºç”±ç©ºç™½ã€è·³æ ¼æˆ–æ¢è¡Œå­—ç¬¦åˆ†éš”çš„å­—ç¬¦ä¸²</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰æŸ¥æ‰¾æ–‡ä»¶çš„ è¡Œæ•° å•è¯æ•° å­—èŠ‚æ•° æ–‡ä»¶å</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wc text.txt</span><br></pre></td></tr></table></figure>\n\n<p>ç»“æœï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">7     8     70     test.txt</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰ç»Ÿè®¡è¾“å‡ºç»“æœçš„è¡Œæ•°</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat test.txt | wc -l</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"ç£ç›˜ç®¡ç†å‘½ä»¤\"><a href=\"#ç£ç›˜ç®¡ç†å‘½ä»¤\" class=\"headerlink\" title=\"ç£ç›˜ç®¡ç†å‘½ä»¤\"></a>ç£ç›˜ç®¡ç†å‘½ä»¤</h2><h3 id=\"cd-å‘½ä»¤\"><a href=\"#cd-å‘½ä»¤\" class=\"headerlink\" title=\"cd å‘½ä»¤\"></a>cd å‘½ä»¤</h3><p>cd(changeDirectory) å‘½ä»¤è¯­æ³•ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd [ç›®å½•å]</span><br></pre></td></tr></table></figure>\n\n<p>è¯´æ˜ï¼šåˆ‡æ¢å½“å‰ç›®å½•è‡³ dirNameã€‚</p>\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰è¿›å…¥è¦ç›®å½•</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd /</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰è¿›å…¥ â€œhomeâ€ ç›®å½•</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd ~</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ3ï¼‰è¿›å…¥ä¸Šä¸€æ¬¡å·¥ä½œè·¯å¾„</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd -</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ4ï¼‰æŠŠä¸Šä¸ªå‘½ä»¤çš„å‚æ•°ä½œä¸º cd å‚æ•°ä½¿ç”¨ã€‚</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd !$</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"df-å‘½ä»¤\"><a href=\"#df-å‘½ä»¤\" class=\"headerlink\" title=\"df å‘½ä»¤\"></a>df å‘½ä»¤</h3><p>æ˜¾ç¤ºç£ç›˜ç©ºé—´ä½¿ç”¨æƒ…å†µã€‚è·å–ç¡¬ç›˜è¢«å ç”¨äº†å¤šå°‘ç©ºé—´ï¼Œç›®å‰è¿˜å‰©ä¸‹å¤šå°‘ç©ºé—´ç­‰ä¿¡æ¯ï¼Œå¦‚æœæ²¡æœ‰æ–‡ä»¶åè¢«æŒ‡å®šï¼Œåˆ™æ‰€æœ‰å½“å‰è¢«æŒ‚è½½çš„æ–‡ä»¶ç³»ç»Ÿçš„å¯ç”¨ç©ºé—´å°†è¢«æ˜¾ç¤ºã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œç£ç›˜ç©ºé—´å°†ä»¥ 1KB ä¸ºå•ä½è¿›è¡Œæ˜¾ç¤ºï¼Œé™¤éç¯å¢ƒå˜é‡ POSIXLY_CORRECT è¢«æŒ‡å®šï¼Œé‚£æ ·å°†ä»¥ 512 å­—èŠ‚ä¸ºå•ä½è¿›è¡Œæ˜¾ç¤ºï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-a å…¨éƒ¨æ–‡ä»¶ç³»ç»Ÿåˆ—è¡¨</span><br><span class=\"line\">-h ä»¥æ–¹ä¾¿é˜…è¯»çš„æ–¹å¼æ˜¾ç¤ºä¿¡æ¯</span><br><span class=\"line\">-i æ˜¾ç¤ºinodeä¿¡æ¯</span><br><span class=\"line\">-k åŒºå—ä¸º1024å­—èŠ‚</span><br><span class=\"line\">-l åªæ˜¾ç¤ºæœ¬åœ°ç£ç›˜</span><br><span class=\"line\">-T åˆ—å‡ºæ–‡ä»¶ç³»ç»Ÿç±»å‹</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰æ˜¾ç¤ºç£ç›˜ä½¿ç”¨æƒ…å†µ</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df -l</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰ä»¥æ˜“è¯»æ–¹å¼åˆ—å‡ºæ‰€æœ‰æ–‡ä»¶ç³»ç»ŸåŠå…¶ç±»å‹</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df -haT</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"du-å‘½ä»¤\"><a href=\"#du-å‘½ä»¤\" class=\"headerlink\" title=\"du å‘½ä»¤\"></a>du å‘½ä»¤</h3><p>du å‘½ä»¤ä¹Ÿæ˜¯æŸ¥çœ‹ä½¿ç”¨ç©ºé—´çš„ï¼Œä½†æ˜¯ä¸ df å‘½ä»¤ä¸åŒçš„æ˜¯ Linux du å‘½ä»¤æ˜¯å¯¹æ–‡ä»¶å’Œç›®å½•ç£ç›˜ä½¿ç”¨çš„ç©ºé—´çš„æŸ¥çœ‹ï¼š</p>\n<p>å‘½ä»¤æ ¼å¼ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">du [é€‰é¡¹] [æ–‡ä»¶]</span><br><span class=\"line\">1</span><br></pre></td></tr></table></figure>\n\n<p><strong>å¸¸ç”¨å‚æ•°</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-a æ˜¾ç¤ºç›®å½•ä¸­æ‰€æœ‰æ–‡ä»¶å¤§å°</span><br><span class=\"line\">-k ä»¥KBä¸ºå•ä½æ˜¾ç¤ºæ–‡ä»¶å¤§å°</span><br><span class=\"line\">-m ä»¥MBä¸ºå•ä½æ˜¾ç¤ºæ–‡ä»¶å¤§å°</span><br><span class=\"line\">-g ä»¥GBä¸ºå•ä½æ˜¾ç¤ºæ–‡ä»¶å¤§å°</span><br><span class=\"line\">-h ä»¥æ˜“è¯»æ–¹å¼æ˜¾ç¤ºæ–‡ä»¶å¤§å°</span><br><span class=\"line\">-s ä»…æ˜¾ç¤ºæ€»è®¡</span><br><span class=\"line\">-cæˆ–--total  é™¤äº†æ˜¾ç¤ºä¸ªåˆ«ç›®å½•æˆ–æ–‡ä»¶çš„å¤§å°å¤–ï¼ŒåŒæ—¶ä¹Ÿæ˜¾ç¤ºæ‰€æœ‰ç›®å½•æˆ–æ–‡ä»¶çš„æ€»å’Œ</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰ä»¥æ˜“è¯»æ–¹å¼æ˜¾ç¤ºæ–‡ä»¶å¤¹å†…åŠå­æ–‡ä»¶å¤¹å¤§å°</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">du -h scf/</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰ä»¥æ˜“è¯»æ–¹å¼æ˜¾ç¤ºæ–‡ä»¶å¤¹å†…æ‰€æœ‰æ–‡ä»¶å¤§å°</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">du -ah scf/</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ3ï¼‰æ˜¾ç¤ºå‡ ä¸ªæ–‡ä»¶æˆ–ç›®å½•å„è‡ªå ç”¨ç£ç›˜ç©ºé—´çš„å¤§å°ï¼Œè¿˜ç»Ÿè®¡å®ƒä»¬çš„æ€»å’Œ</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">du -hc test/ scf/</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ4ï¼‰è¾“å‡ºå½“å‰ç›®å½•ä¸‹å„ä¸ªå­ç›®å½•æ‰€ä½¿ç”¨çš„ç©ºé—´</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">du -hc --max-depth=1 scf/</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"lså‘½ä»¤\"><a href=\"#lså‘½ä»¤\" class=\"headerlink\" title=\"lså‘½ä»¤\"></a>lså‘½ä»¤</h3><p>å°±æ˜¯ list çš„ç¼©å†™ï¼Œé€šè¿‡ ls å‘½ä»¤ä¸ä»…å¯ä»¥æŸ¥çœ‹ linux æ–‡ä»¶å¤¹åŒ…å«çš„æ–‡ä»¶ï¼Œè€Œä¸”å¯ä»¥æŸ¥çœ‹æ–‡ä»¶æƒé™(åŒ…æ‹¬ç›®å½•ã€æ–‡ä»¶å¤¹ã€æ–‡ä»¶æƒé™)î€‚æŸ¥çœ‹ç›®å½•ä¿¡æ¯ç­‰ç­‰ã€‚</p>\n<p><strong>å¸¸ç”¨å‚æ•°æ­é…</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ls -a åˆ—å‡ºç›®å½•æ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…å«ä»¥.å¼€å§‹çš„éšè—æ–‡ä»¶</span><br><span class=\"line\">ls -A åˆ—å‡ºé™¤.åŠ..çš„å…¶å®ƒæ–‡ä»¶</span><br><span class=\"line\">ls -r ååºæ’åˆ—</span><br><span class=\"line\">ls -t ä»¥æ–‡ä»¶ä¿®æ”¹æ—¶é—´æ’åº</span><br><span class=\"line\">ls -S ä»¥æ–‡ä»¶å¤§å°æ’åº</span><br><span class=\"line\">ls -h ä»¥æ˜“è¯»å¤§å°æ˜¾ç¤º</span><br><span class=\"line\">ls -l é™¤äº†æ–‡ä»¶åä¹‹å¤–ï¼Œè¿˜å°†æ–‡ä»¶çš„æƒé™ã€æ‰€æœ‰è€…ã€æ–‡ä»¶å¤§å°ç­‰ä¿¡æ¯è¯¦ç»†åˆ—å‡ºæ¥</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>(1) æŒ‰æ˜“è¯»æ–¹å¼æŒ‰æ—¶é—´ååºæ’åºï¼Œå¹¶æ˜¾ç¤ºæ–‡ä»¶è¯¦ç»†ä¿¡æ¯</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ls -lhrt</span><br></pre></td></tr></table></figure>\n\n<p>(2) æŒ‰å¤§å°ååºæ˜¾ç¤ºæ–‡ä»¶è¯¦ç»†ä¿¡æ¯</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ls -lrS</span><br></pre></td></tr></table></figure>\n\n<p>(3)åˆ—å‡ºå½“å‰ç›®å½•ä¸­æ‰€æœ‰ä»¥â€tâ€å¼€å¤´çš„ç›®å½•çš„è¯¦ç»†å†…å®¹</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ls -l t*</span><br></pre></td></tr></table></figure>\n\n<p>(4) åˆ—å‡ºæ–‡ä»¶ç»å¯¹è·¯å¾„ï¼ˆä¸åŒ…å«éšè—æ–‡ä»¶ï¼‰</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ls | sed &quot;s:^:`pwd`/:&quot;</span><br></pre></td></tr></table></figure>\n\n<p>(5) åˆ—å‡ºæ–‡ä»¶ç»å¯¹è·¯å¾„ï¼ˆåŒ…å«éšè—æ–‡ä»¶ï¼‰</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">find $pwd -maxdepth 1 | xargs ls -ld</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"mkdir-å‘½ä»¤\"><a href=\"#mkdir-å‘½ä»¤\" class=\"headerlink\" title=\"mkdir å‘½ä»¤\"></a>mkdir å‘½ä»¤</h3><p>mkdir å‘½ä»¤ç”¨äºåˆ›å»ºæ–‡ä»¶å¤¹ã€‚</p>\n<p>å¯ç”¨é€‰é¡¹ï¼š</p>\n<ul>\n<li><strong>-m</strong>: å¯¹æ–°å»ºç›®å½•è®¾ç½®å­˜å–æƒé™ï¼Œä¹Ÿå¯ä»¥ç”¨ chmod å‘½ä»¤è®¾ç½®;</li>\n<li><strong>-p</strong>: å¯ä»¥æ˜¯ä¸€ä¸ªè·¯å¾„åç§°ã€‚æ­¤æ—¶è‹¥è·¯å¾„ä¸­çš„æŸäº›ç›®å½•å°šä¸å­˜åœ¨,åŠ ä¸Šæ­¤é€‰é¡¹åï¼Œç³»ç»Ÿå°†è‡ªåŠ¨å»ºç«‹å¥½é‚£äº›å°šä¸åœ¨çš„ç›®å½•ï¼Œå³ä¸€æ¬¡å¯ä»¥å»ºç«‹å¤šä¸ªç›®å½•ã€‚</li>\n</ul>\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰å½“å‰å·¥ä½œç›®å½•ä¸‹åˆ›å»ºåä¸º t çš„æ–‡ä»¶å¤¹</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir t</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰åœ¨ tmp ç›®å½•ä¸‹åˆ›å»ºè·¯å¾„ä¸º test&#x2F;t1&#x2F;t çš„ç›®å½•ï¼Œè‹¥ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir -p /tmp/test/t1/t</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"pwd-å‘½ä»¤\"><a href=\"#pwd-å‘½ä»¤\" class=\"headerlink\" title=\"pwd å‘½ä»¤\"></a>pwd å‘½ä»¤</h3><p>pwd å‘½ä»¤ç”¨äºæŸ¥çœ‹å½“å‰å·¥ä½œç›®å½•è·¯å¾„ã€‚</p>\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰æŸ¥çœ‹å½“å‰è·¯å¾„</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pwd</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰æŸ¥çœ‹è½¯é“¾æ¥çš„å®é™…è·¯å¾„</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pwd -P</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"rmdir-å‘½ä»¤\"><a href=\"#rmdir-å‘½ä»¤\" class=\"headerlink\" title=\"rmdir å‘½ä»¤\"></a>rmdir å‘½ä»¤</h3><p>ä»ä¸€ä¸ªç›®å½•ä¸­åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªå­ç›®å½•é¡¹ï¼Œåˆ é™¤æŸç›®å½•æ—¶ä¹Ÿå¿…é¡»å…·æœ‰å¯¹å…¶çˆ¶ç›®å½•çš„å†™æƒé™ã€‚</p>\n<p><strong>æ³¨æ„</strong>ï¼šä¸èƒ½åˆ é™¤éç©ºç›®å½•</p>\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰å½“ parent å­ç›®å½•è¢«åˆ é™¤åä½¿å®ƒä¹Ÿæˆä¸ºç©ºç›®å½•çš„è¯ï¼Œåˆ™é¡ºä¾¿ä¸€å¹¶åˆ é™¤ï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rmdir -p parent/child/child11</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"ç½‘ç»œé€šè®¯å‘½ä»¤\"><a href=\"#ç½‘ç»œé€šè®¯å‘½ä»¤\" class=\"headerlink\" title=\"ç½‘ç»œé€šè®¯å‘½ä»¤\"></a>ç½‘ç»œé€šè®¯å‘½ä»¤</h2><h3 id=\"ifconfig-å‘½ä»¤\"><a href=\"#ifconfig-å‘½ä»¤\" class=\"headerlink\" title=\"ifconfig å‘½ä»¤\"></a>ifconfig å‘½ä»¤</h3><ul>\n<li>ifconfig ç”¨äºæŸ¥çœ‹å’Œé…ç½® Linux ç³»ç»Ÿçš„ç½‘ç»œæ¥å£ã€‚</li>\n<li>æŸ¥çœ‹æ‰€æœ‰ç½‘ç»œæ¥å£åŠå…¶çŠ¶æ€ï¼š<code>ifconfig -a</code> ã€‚</li>\n<li>ä½¿ç”¨ up å’Œ down å‘½ä»¤å¯åŠ¨æˆ–åœæ­¢æŸä¸ªæ¥å£ï¼š<code>ifconfig eth0 up</code> å’Œ <code>ifconfig eth0 down</code> ã€‚</li>\n</ul>\n<h3 id=\"iptables-å‘½ä»¤\"><a href=\"#iptables-å‘½ä»¤\" class=\"headerlink\" title=\"iptables å‘½ä»¤\"></a>iptables å‘½ä»¤</h3><p>iptables ï¼Œæ˜¯ä¸€ä¸ªé…ç½® Linux å†…æ ¸é˜²ç«å¢™çš„å‘½ä»¤è¡Œå·¥å…·ã€‚åŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œå¯¹äºæˆ‘ä»¬å¼€å‘æ¥è¯´ï¼Œä¸»è¦æŒæ¡å¦‚ä½•å¼€æ”¾ç«¯å£å³å¯ã€‚ä¾‹å¦‚ï¼š</p>\n<ul>\n<li><p>æŠŠæ¥æº IP ä¸º 192.168.1.101 è®¿é—®æœ¬æœº 80 ç«¯å£çš„åŒ…ç›´æ¥æ‹’ç»ï¼š<code>iptables -I INPUT -s 192.168.1.101 -p tcp --dport 80 -j REJECT</code> ã€‚</p>\n</li>\n<li><p>å¼€å¯ 80 ç«¯å£ï¼Œå› ä¸º web å¯¹å¤–éƒ½æ˜¯è¿™ä¸ªç«¯å£</p>\n  <figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">iptables -A INPUT -p tcp --dport 80 -j ACCEP</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>å¦å¤–ï¼Œè¦æ³¨æ„ä½¿ç”¨ <code>iptables save</code> å‘½ä»¤ï¼Œè¿›è¡Œä¿å­˜ã€‚å¦åˆ™ï¼ŒæœåŠ¡å™¨é‡å¯åï¼Œé…ç½®çš„è§„åˆ™å°†ä¸¢å¤±ã€‚</p>\n</li>\n</ul>\n<h3 id=\"netstat-å‘½ä»¤\"><a href=\"#netstat-å‘½ä»¤\" class=\"headerlink\" title=\"netstat å‘½ä»¤\"></a>netstat å‘½ä»¤</h3><p>Linux netstat å‘½ä»¤ç”¨äºæ˜¾ç¤ºç½‘ç»œçŠ¶æ€ã€‚</p>\n<p>åˆ©ç”¨ netstat æŒ‡ä»¤å¯è®©ä½ å¾—çŸ¥æ•´ä¸ª Linux ç³»ç»Ÿçš„ç½‘ç»œæƒ…å†µã€‚</p>\n<p>è¯­æ³•</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">netstat [-acCeFghilMnNoprstuvVwx][-A&lt;ç½‘ç»œç±»å‹&gt;][--ip]</span><br></pre></td></tr></table></figure>\n\n<p><strong>å‚æ•°è¯´æ˜</strong>ï¼š</p>\n<ul>\n<li>-a æˆ–â€“all æ˜¾ç¤ºæ‰€æœ‰è¿çº¿ä¸­çš„ Socketã€‚</li>\n<li>-A&lt;ç½‘ç»œç±»å‹&gt;æˆ–â€“&lt;ç½‘ç»œç±»å‹&gt; åˆ—å‡ºè¯¥ç½‘ç»œç±»å‹è¿çº¿ä¸­çš„ç›¸å…³åœ°å€ã€‚</li>\n<li>-c æˆ–â€“continuous æŒç»­åˆ—å‡ºç½‘ç»œçŠ¶æ€ã€‚</li>\n<li>-C æˆ–â€“cache æ˜¾ç¤ºè·¯ç”±å™¨é…ç½®çš„å¿«å–ä¿¡æ¯ã€‚</li>\n<li>-e æˆ–â€“extend æ˜¾ç¤ºç½‘ç»œå…¶ä»–ç›¸å…³ä¿¡æ¯ã€‚</li>\n<li>-F æˆ–â€“fib æ˜¾ç¤º FIBã€‚</li>\n<li>-g æˆ–â€“groups æ˜¾ç¤ºå¤šé‡å¹¿æ’­åŠŸèƒ½ç¾¤ç»„ç»„å‘˜åå•ã€‚</li>\n<li>-h æˆ–â€“help åœ¨çº¿å¸®åŠ©ã€‚</li>\n<li>-i æˆ–â€“interfaces æ˜¾ç¤ºç½‘ç»œç•Œé¢ä¿¡æ¯è¡¨å•ã€‚</li>\n<li>-l æˆ–â€“listening æ˜¾ç¤ºç›‘æ§ä¸­çš„æœåŠ¡å™¨çš„ Socketã€‚</li>\n<li>-M æˆ–â€“masquerade æ˜¾ç¤ºä¼ªè£…çš„ç½‘ç»œè¿çº¿ã€‚</li>\n<li>-n æˆ–â€“numeric ç›´æ¥ä½¿ç”¨ IP åœ°å€ï¼Œè€Œä¸é€šè¿‡åŸŸåæœåŠ¡å™¨ã€‚</li>\n<li>-N æˆ–â€“netlink æˆ–â€“symbolic æ˜¾ç¤ºç½‘ç»œç¡¬ä»¶å¤–å›´è®¾å¤‡çš„ç¬¦å·è¿æ¥åç§°ã€‚</li>\n<li>-o æˆ–â€“timers æ˜¾ç¤ºè®¡æ—¶å™¨ã€‚</li>\n<li>-p æˆ–â€“programs æ˜¾ç¤ºæ­£åœ¨ä½¿ç”¨ Socket çš„ç¨‹åºè¯†åˆ«ç å’Œç¨‹åºåç§°ã€‚</li>\n<li>-r æˆ–â€“route æ˜¾ç¤º Routing Tableã€‚</li>\n<li>-s æˆ–â€“statistice æ˜¾ç¤ºç½‘ç»œå·¥ä½œä¿¡æ¯ç»Ÿè®¡è¡¨ã€‚</li>\n<li>-t æˆ–â€“tcp æ˜¾ç¤º TCP ä¼ è¾“åè®®çš„è¿çº¿çŠ¶å†µã€‚</li>\n<li>-u æˆ–â€“udp æ˜¾ç¤º UDP ä¼ è¾“åè®®çš„è¿çº¿çŠ¶å†µã€‚</li>\n<li>-v æˆ–â€“verbose æ˜¾ç¤ºæŒ‡ä»¤æ‰§è¡Œè¿‡ç¨‹ã€‚</li>\n<li>-V æˆ–â€“version æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ã€‚</li>\n<li>-w æˆ–â€“raw æ˜¾ç¤º RAW ä¼ è¾“åè®®çš„è¿çº¿çŠ¶å†µã€‚</li>\n<li>-x æˆ–â€“unix æ­¤å‚æ•°çš„æ•ˆæœå’ŒæŒ‡å®šâ€-A unixâ€å‚æ•°ç›¸åŒã€‚</li>\n<li>â€“ip æˆ–â€“inet æ­¤å‚æ•°çš„æ•ˆæœå’ŒæŒ‡å®šâ€-A inetâ€å‚æ•°ç›¸åŒã€‚</li>\n</ul>\n<p><strong>å®ä¾‹</strong></p>\n<p><strong>å¦‚ä½•æŸ¥çœ‹ç³»ç»Ÿéƒ½å¼€å¯äº†å“ªäº›ç«¯å£ï¼Ÿ</strong></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@centos6 ~ 13:20 #55]# netstat -lnp</span><br><span class=\"line\">Active Internet connections (only servers)</span><br><span class=\"line\">Proto Recv-Q Send-Q Local Address               Foreign Address             State       PID/Program name</span><br><span class=\"line\">tcp        0      0 0.0.0.0:22                  0.0.0.0:*                   LISTEN      1035/sshd</span><br><span class=\"line\">tcp        0      0 :::22                       :::*                        LISTEN      1035/sshd</span><br><span class=\"line\">udp        0      0 0.0.0.0:68                  0.0.0.0:*                               931/dhclient</span><br><span class=\"line\">Active UNIX domain sockets (only servers)</span><br><span class=\"line\">Proto RefCnt Flags       Type       State         I-Node PID/Program name    Path</span><br><span class=\"line\">unix  2      [ ACC ]     STREAM     LISTENING     6825   1/init              @/com/ubuntu/upstart</span><br><span class=\"line\">unix  2      [ ACC ]     STREAM     LISTENING     8429   1003/dbus-daemon    /var/run/dbus/system_bus_socket</span><br></pre></td></tr></table></figure>\n\n<p><strong>å¦‚ä½•æŸ¥çœ‹ç½‘ç»œè¿æ¥çŠ¶å†µï¼Ÿ</strong></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@centos6 ~ 13:22 #58]# netstat -an</span><br><span class=\"line\">Active Internet connections (servers and established)</span><br><span class=\"line\">Proto Recv-Q Send-Q Local Address               Foreign Address             State</span><br><span class=\"line\">tcp        0      0 0.0.0.0:22                  0.0.0.0:*                   LISTEN</span><br><span class=\"line\">tcp        0      0 192.168.147.130:22          192.168.147.1:23893         ESTABLISHED</span><br><span class=\"line\">tcp        0      0 :::22                       :::*                        LISTEN</span><br><span class=\"line\">udp        0      0 0.0.0.0:68                  0.0.0.0:*</span><br></pre></td></tr></table></figure>\n\n<p><strong>å¦‚ä½•ç»Ÿè®¡ç³»ç»Ÿå½“å‰è¿›ç¨‹è¿æ¥æ•°ï¼Ÿ</strong></p>\n<ul>\n<li>è¾“å…¥å‘½ä»¤ <code>netstat -an | grep ESTABLISHED | wc -l</code> ã€‚</li>\n<li>è¾“å‡ºç»“æœ <code>177</code> ã€‚ä¸€å…±æœ‰ 177 è¿æ¥æ•°ã€‚</li>\n</ul>\n<p><strong>ç”¨ netstat å‘½ä»¤é…åˆå…¶ä»–å‘½ä»¤ï¼ŒæŒ‰ç…§æº IP ç»Ÿè®¡æ‰€æœ‰åˆ° 80 ç«¯å£çš„ ESTABLISHED çŠ¶æ€é“¾æ¥çš„ä¸ªæ•°ï¼Ÿ</strong></p>\n<blockquote>\n<p>ä¸¥æ ¼æ¥è¯´ï¼Œè¿™ä¸ªé¢˜ç›®è€ƒéªŒçš„æ˜¯å¯¹ awk çš„ä½¿ç”¨ã€‚</p>\n</blockquote>\n<p>é¦–å…ˆï¼Œä½¿ç”¨ <code>netstat -an|grep ESTABLISHED</code> å‘½ä»¤ã€‚ç»“æœå¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tcp        0      0 120.27.146.122:80       113.65.18.33:62721      ESTABLISHED</span><br><span class=\"line\">tcp        0      0 120.27.146.122:80       27.43.83.115:47148      ESTABLISHED</span><br><span class=\"line\">tcp        0      0 120.27.146.122:58838    106.39.162.96:443       ESTABLISHED</span><br><span class=\"line\">tcp        0      0 120.27.146.122:52304    203.208.40.121:443      ESTABLISHED</span><br><span class=\"line\">tcp        0      0 120.27.146.122:33194    203.208.40.122:443      ESTABLISHED</span><br><span class=\"line\">tcp        0      0 120.27.146.122:53758    101.37.183.144:443      ESTABLISHED</span><br><span class=\"line\">tcp        0      0 120.27.146.122:27017    23.105.193.30:50556     ESTABLISHED</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"ping-å‘½ä»¤\"><a href=\"#ping-å‘½ä»¤\" class=\"headerlink\" title=\"ping å‘½ä»¤\"></a>ping å‘½ä»¤</h3><p>Linux ping å‘½ä»¤ç”¨äºæ£€æµ‹ä¸»æœºã€‚</p>\n<p>æ‰§è¡Œ ping æŒ‡ä»¤ä¼šä½¿ç”¨ ICMP ä¼ è¾“åè®®ï¼Œå‘å‡ºè¦æ±‚å›åº”çš„ä¿¡æ¯ï¼Œè‹¥è¿œç«¯ä¸»æœºçš„ç½‘ç»œåŠŸèƒ½æ²¡æœ‰é—®é¢˜ï¼Œå°±ä¼šå›åº”è¯¥ä¿¡æ¯ï¼Œå› è€Œå¾—çŸ¥è¯¥ä¸»æœºè¿ä½œæ­£å¸¸ã€‚</p>\n<p>æŒ‡å®šæ¥æ”¶åŒ…çš„æ¬¡æ•°</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ping -c 2 www.baidu.com</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"telnet-å‘½ä»¤\"><a href=\"#telnet-å‘½ä»¤\" class=\"headerlink\" title=\"telnet å‘½ä»¤\"></a>telnet å‘½ä»¤</h3><p>Linux telnet å‘½ä»¤ç”¨äºè¿œç«¯ç™»å…¥ã€‚</p>\n<p>æ‰§è¡Œ telnet æŒ‡ä»¤å¼€å¯ç»ˆç«¯æœºé˜¶æ®µä½œä¸šï¼Œå¹¶ç™»å…¥è¿œç«¯ä¸»æœºã€‚</p>\n<p>è¯­æ³•</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">telnet [-8acdEfFKLrx][-b&lt;ä¸»æœºåˆ«å&gt;][-e&lt;è„±ç¦»å­—ç¬¦&gt;][-k&lt;åŸŸå&gt;][-l&lt;ç”¨æˆ·åç§°&gt;][-n&lt;è®°å½•æ–‡ä»¶&gt;][-S&lt;æœåŠ¡ç±»å‹&gt;][-X&lt;è®¤è¯å½¢æ€&gt;][ä¸»æœºåç§°æˆ–IPåœ°å€&lt;é€šä¿¡ç«¯å£&gt;]</span><br></pre></td></tr></table></figure>\n\n<p><strong>å‚æ•°è¯´æ˜</strong>ï¼š</p>\n<ul>\n<li>-8 å…è®¸ä½¿ç”¨ 8 ä½å­—ç¬¦èµ„æ–™ï¼ŒåŒ…æ‹¬è¾“å…¥ä¸è¾“å‡ºã€‚</li>\n<li>-a å°è¯•è‡ªåŠ¨ç™»å…¥è¿œç«¯ç³»ç»Ÿã€‚</li>\n<li>-b&lt;ä¸»æœºåˆ«å&gt; ä½¿ç”¨åˆ«åæŒ‡å®šè¿œç«¯ä¸»æœºåç§°ã€‚</li>\n<li>-c ä¸è¯»å–ç”¨æˆ·ä¸“å±ç›®å½•é‡Œçš„.telnetrc æ–‡ä»¶ã€‚</li>\n<li>-d å¯åŠ¨æ’é”™æ¨¡å¼ã€‚</li>\n<li>-e&lt;è„±ç¦»å­—ç¬¦&gt; è®¾ç½®è„±ç¦»å­—ç¬¦ã€‚</li>\n<li>-E æ»¤é™¤è„±ç¦»å­—ç¬¦ã€‚</li>\n<li>-f æ­¤å‚æ•°çš„æ•ˆæœå’ŒæŒ‡å®šâ€-Fâ€å‚æ•°ç›¸åŒã€‚</li>\n<li>-F ä½¿ç”¨ Kerberos V5 è®¤è¯æ—¶ï¼ŒåŠ ä¸Šæ­¤å‚æ•°å¯æŠŠæœ¬åœ°ä¸»æœºçš„è®¤è¯æ•°æ®ä¸Šä¼ åˆ°è¿œç«¯ä¸»æœºã€‚</li>\n<li>-k&lt;åŸŸå&gt; ä½¿ç”¨ Kerberos è®¤è¯æ—¶ï¼ŒåŠ ä¸Šæ­¤å‚æ•°è®©è¿œç«¯ä¸»æœºé‡‡ç”¨æŒ‡å®šçš„é¢†åŸŸåï¼Œè€Œéè¯¥ä¸»æœºçš„åŸŸåã€‚</li>\n<li>-K ä¸è‡ªåŠ¨ç™»å…¥è¿œç«¯ä¸»æœºã€‚</li>\n<li>-l&lt;ç”¨æˆ·åç§°&gt; æŒ‡å®šè¦ç™»å…¥è¿œç«¯ä¸»æœºçš„ç”¨æˆ·åç§°ã€‚</li>\n<li>-L å…è®¸è¾“å‡º 8 ä½å­—ç¬¦èµ„æ–™ã€‚</li>\n<li>-n&lt;è®°å½•æ–‡ä»¶&gt; æŒ‡å®šæ–‡ä»¶è®°å½•ç›¸å…³ä¿¡æ¯ã€‚</li>\n<li>-r ä½¿ç”¨ç±»ä¼¼ rlogin æŒ‡ä»¤çš„ç”¨æˆ·ç•Œé¢ã€‚</li>\n<li>-S&lt;æœåŠ¡ç±»å‹&gt; è®¾ç½® telnet è¿çº¿æ‰€éœ€çš„ IP TOS ä¿¡æ¯ã€‚</li>\n<li>-x å‡è®¾ä¸»æœºæœ‰æ”¯æŒæ•°æ®åŠ å¯†çš„åŠŸèƒ½ï¼Œå°±ä½¿ç”¨å®ƒã€‚</li>\n<li>-X&lt;è®¤è¯å½¢æ€&gt; å…³é—­æŒ‡å®šçš„è®¤è¯å½¢æ€ã€‚</li>\n</ul>\n<p><strong>å®ä¾‹</strong></p>\n<p>ç™»å½•è¿œç¨‹ä¸»æœº</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">ç™»å½•IPä¸º 192.168.0.5 çš„è¿œç¨‹ä¸»æœº</span></span><br><span class=\"line\">telnet 192.168.0.5 </span><br></pre></td></tr></table></figure>\n\n<h2 id=\"ç³»ç»Ÿç®¡ç†å‘½ä»¤\"><a href=\"#ç³»ç»Ÿç®¡ç†å‘½ä»¤\" class=\"headerlink\" title=\"ç³»ç»Ÿç®¡ç†å‘½ä»¤\"></a>ç³»ç»Ÿç®¡ç†å‘½ä»¤</h2><h3 id=\"date-å‘½ä»¤\"><a href=\"#date-å‘½ä»¤\" class=\"headerlink\" title=\"date å‘½ä»¤\"></a>date å‘½ä»¤</h3><p>æ˜¾ç¤ºæˆ–è®¾å®šç³»ç»Ÿçš„æ—¥æœŸä¸æ—¶é—´ã€‚</p>\n<p>å‘½ä»¤å‚æ•°ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-d&lt;å­—ç¬¦ä¸²&gt; ã€€æ˜¾ç¤ºå­—ç¬¦ä¸²æ‰€æŒ‡çš„æ—¥æœŸä¸æ—¶é—´ã€‚å­—ç¬¦ä¸²å‰åå¿…é¡»åŠ ä¸ŠåŒå¼•å·ã€‚</span><br><span class=\"line\">-s&lt;å­—ç¬¦ä¸²&gt; ã€€æ ¹æ®å­—ç¬¦ä¸²æ¥è®¾ç½®æ—¥æœŸä¸æ—¶é—´ã€‚å­—ç¬¦ä¸²å‰åå¿…é¡»åŠ ä¸ŠåŒå¼•å·ã€‚</span><br><span class=\"line\">-u ã€€æ˜¾ç¤ºGMTã€‚</span><br><span class=\"line\">%H å°æ—¶(00-23)</span><br><span class=\"line\">%I å°æ—¶(00-12)</span><br><span class=\"line\">%M åˆ†é’Ÿ(ä»¥00-59æ¥è¡¨ç¤º)</span><br><span class=\"line\">%s æ€»ç§’æ•°ã€‚èµ·ç®—æ—¶é—´ä¸º1970-01-01 00:00:00 UTCã€‚</span><br><span class=\"line\">%S ç§’(ä»¥æœ¬åœ°çš„æƒ¯ç”¨æ³•æ¥è¡¨ç¤º)</span><br><span class=\"line\">%a æ˜ŸæœŸçš„ç¼©å†™ã€‚</span><br><span class=\"line\">%A æ˜ŸæœŸçš„å®Œæ•´åç§°ã€‚</span><br><span class=\"line\">%d æ—¥æœŸ(ä»¥01-31æ¥è¡¨ç¤º)ã€‚</span><br><span class=\"line\">%D æ—¥æœŸ(å«å¹´æœˆæ—¥)ã€‚</span><br><span class=\"line\">%m æœˆä»½(ä»¥01-12æ¥è¡¨ç¤º)ã€‚</span><br><span class=\"line\">%y å¹´ä»½(ä»¥00-99æ¥è¡¨ç¤º)ã€‚</span><br><span class=\"line\">%Y å¹´ä»½(ä»¥å››ä½æ•°æ¥è¡¨ç¤º)ã€‚</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰æ˜¾ç¤ºä¸‹ä¸€å¤©</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">date +%Y%m%d --date=&quot;+1 day&quot;  //æ˜¾ç¤ºä¸‹ä¸€å¤©çš„æ—¥æœŸ</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰-d å‚æ•°ä½¿ç”¨</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">date -d &quot;nov 22&quot;  ä»Šå¹´çš„ 11 æœˆ 22 æ—¥æ˜¯æ˜ŸæœŸä¸‰</span><br><span class=\"line\">date -d &#x27;2 weeks&#x27; 2å‘¨åçš„æ—¥æœŸ</span><br><span class=\"line\">date -d &#x27;next monday&#x27; (ä¸‹å‘¨ä¸€çš„æ—¥æœŸ)</span><br><span class=\"line\">date -d next-day +%Y%m%dï¼ˆæ˜å¤©çš„æ—¥æœŸï¼‰æˆ–è€…ï¼šdate -d tomorrow +%Y%m%d</span><br><span class=\"line\">date -d last-day +%Y%m%d(æ˜¨å¤©çš„æ—¥æœŸ) æˆ–è€…ï¼šdate -d yesterday +%Y%m%d</span><br><span class=\"line\">date -d last-month +%Y%m(ä¸Šä¸ªæœˆæ˜¯å‡ æœˆ)</span><br><span class=\"line\">date -d next-month +%Y%m(ä¸‹ä¸ªæœˆæ˜¯å‡ æœˆ)</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"free-å‘½ä»¤\"><a href=\"#free-å‘½ä»¤\" class=\"headerlink\" title=\"free å‘½ä»¤\"></a>free å‘½ä»¤</h3><p>æ˜¾ç¤ºç³»ç»Ÿå†…å­˜ä½¿ç”¨æƒ…å†µï¼ŒåŒ…æ‹¬ç‰©ç†å†…å­˜ã€äº¤äº’åŒºå†…å­˜(swap)å’Œå†…æ ¸ç¼“å†²åŒºå†…å­˜ã€‚</p>\n<p><strong>å‘½ä»¤å‚æ•°</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-b ä»¥Byteæ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ</span><br><span class=\"line\">-k ä»¥kbä¸ºå•ä½æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ</span><br><span class=\"line\">-m ä»¥mbä¸ºå•ä½æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ</span><br><span class=\"line\">-g ä»¥gbä¸ºå•ä½æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ</span><br><span class=\"line\">-s&lt;é—´éš”ç§’æ•°&gt; æŒç»­æ˜¾ç¤ºå†…å­˜</span><br><span class=\"line\">-t æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æ€»åˆ</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">free</span><br><span class=\"line\">free -k</span><br><span class=\"line\">free -m</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰ä»¥æ€»å’Œçš„å½¢å¼æ˜¾ç¤ºå†…å­˜çš„ä½¿ç”¨ä¿¡æ¯</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">free -t</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ3ï¼‰å‘¨æœŸæ€§æŸ¥è¯¢å†…å­˜ä½¿ç”¨æƒ…å†µ</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">free -s 10</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"kill-å‘½ä»¤\"><a href=\"#kill-å‘½ä»¤\" class=\"headerlink\" title=\"kill å‘½ä»¤\"></a>kill å‘½ä»¤</h3><p>å‘é€æŒ‡å®šçš„ä¿¡å·åˆ°ç›¸åº”è¿›ç¨‹ã€‚ä¸æŒ‡å®šå‹å·å°†å‘é€ SIGTERMï¼ˆ15ï¼‰ç»ˆæ­¢æŒ‡å®šè¿›ç¨‹ã€‚å¦‚æœä»»æ— æ³•ç»ˆæ­¢è¯¥ç¨‹åºå¯ç”¨â€-KILLâ€ å‚æ•°ï¼Œå…¶å‘é€çš„ä¿¡å·ä¸º SIGKILL(9) ï¼Œå°†å¼ºåˆ¶ç»“æŸè¿›ç¨‹ï¼Œä½¿ç”¨ ps å‘½ä»¤æˆ–è€… jobs å‘½ä»¤å¯ä»¥æŸ¥çœ‹è¿›ç¨‹å·ã€‚root ç”¨æˆ·å°†å½±å“ç”¨æˆ·çš„è¿›ç¨‹ï¼Œé root ç”¨æˆ·åªèƒ½å½±å“è‡ªå·±çš„è¿›ç¨‹ã€‚</p>\n<p><strong>å¸¸ç”¨å‚æ•°</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-l  ä¿¡å·ï¼Œè‹¥æœä¸åŠ ä¿¡å·çš„ç¼–å·å‚æ•°ï¼Œåˆ™ä½¿ç”¨â€œ-lâ€å‚æ•°ä¼šåˆ—å‡ºå…¨éƒ¨çš„ä¿¡å·åç§°</span><br><span class=\"line\">-a  å½“å¤„ç†å½“å‰è¿›ç¨‹æ—¶ï¼Œä¸é™åˆ¶å‘½ä»¤åå’Œè¿›ç¨‹å·çš„å¯¹åº”å…³ç³»</span><br><span class=\"line\">-p  æŒ‡å®škill å‘½ä»¤åªæ‰“å°ç›¸å…³è¿›ç¨‹çš„è¿›ç¨‹å·ï¼Œè€Œä¸å‘é€ä»»ä½•ä¿¡å·</span><br><span class=\"line\">-s  æŒ‡å®šå‘é€ä¿¡å·</span><br><span class=\"line\">-u  æŒ‡å®šç”¨æˆ·</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰å…ˆä½¿ç”¨ ps æŸ¥æ‰¾è¿›ç¨‹ pro1ï¼Œç„¶åç”¨ kill æ€æ‰</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">kill -9 $(ps -ef | grep pro1)</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"ps-å‘½ä»¤\"><a href=\"#ps-å‘½ä»¤\" class=\"headerlink\" title=\"ps å‘½ä»¤\"></a>ps å‘½ä»¤</h3><p>ps(process status)ï¼Œç”¨æ¥æŸ¥çœ‹å½“å‰è¿è¡Œçš„è¿›ç¨‹çŠ¶æ€ï¼Œä¸€æ¬¡æ€§æŸ¥çœ‹ï¼Œå¦‚æœéœ€è¦åŠ¨æ€è¿ç»­ç»“æœä½¿ç”¨ top</p>\n<p>linux ä¸Šè¿›ç¨‹æœ‰ 5 ç§çŠ¶æ€:</p>\n<ol>\n<li>è¿è¡Œ(æ­£åœ¨è¿è¡Œæˆ–åœ¨è¿è¡Œé˜Ÿåˆ—ä¸­ç­‰å¾…)</li>\n<li>ä¸­æ–­(ä¼‘çœ ä¸­, å—é˜», åœ¨ç­‰å¾…æŸä¸ªæ¡ä»¶çš„å½¢æˆæˆ–æ¥å—åˆ°ä¿¡å·)</li>\n<li>ä¸å¯ä¸­æ–­(æ”¶åˆ°ä¿¡å·ä¸å”¤é†’å’Œä¸å¯è¿è¡Œ, è¿›ç¨‹å¿…é¡»ç­‰å¾…ç›´åˆ°æœ‰ä¸­æ–­å‘ç”Ÿ)</li>\n<li>åƒµæ­»(è¿›ç¨‹å·²ç»ˆæ­¢, ä½†è¿›ç¨‹æè¿°ç¬¦å­˜åœ¨, ç›´åˆ°çˆ¶è¿›ç¨‹è°ƒç”¨ wait4()ç³»ç»Ÿè°ƒç”¨åé‡Šæ”¾)</li>\n<li>åœæ­¢(è¿›ç¨‹æ”¶åˆ° SIGSTOP, SIGSTP, SIGTIN, SIGTOU ä¿¡å·ååœæ­¢è¿è¡Œè¿è¡Œ)</li>\n</ol>\n<p>ps å·¥å…·æ ‡è¯†è¿›ç¨‹çš„ 5 ç§çŠ¶æ€ç :</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">D ä¸å¯ä¸­æ–­ uninterruptible sleep (usually IO)</span><br><span class=\"line\">R è¿è¡Œ runnable (on run queue)</span><br><span class=\"line\">S ä¸­æ–­ sleeping</span><br><span class=\"line\">T åœæ­¢ traced or stopped</span><br><span class=\"line\">Z åƒµæ­» a defunct (â€zombieâ€) process</span><br></pre></td></tr></table></figure>\n\n<p><strong>å‘½ä»¤å‚æ•°</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-A æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹</span><br><span class=\"line\">a æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹</span><br><span class=\"line\">-a æ˜¾ç¤ºåŒä¸€ç»ˆç«¯ä¸‹æ‰€æœ‰è¿›ç¨‹</span><br><span class=\"line\">c æ˜¾ç¤ºè¿›ç¨‹çœŸå®åç§°</span><br><span class=\"line\">e æ˜¾ç¤ºç¯å¢ƒå˜é‡</span><br><span class=\"line\">f æ˜¾ç¤ºè¿›ç¨‹é—´çš„å…³ç³»</span><br><span class=\"line\">r æ˜¾ç¤ºå½“å‰ç»ˆç«¯è¿è¡Œçš„è¿›ç¨‹</span><br><span class=\"line\">-aux æ˜¾ç¤ºæ‰€æœ‰åŒ…å«å…¶å®ƒä½¿ç”¨çš„è¿›ç¨‹</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰æ˜¾ç¤ºå½“å‰æ‰€æœ‰è¿›ç¨‹ç¯å¢ƒå˜é‡åŠè¿›ç¨‹é—´å…³ç³»</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ps -ef</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰æ˜¾ç¤ºå½“å‰æ‰€æœ‰è¿›ç¨‹</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ps -A</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ3ï¼‰ä¸ grep è”ç”¨æŸ¥æ‰¾æŸè¿›ç¨‹</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ps -aux | grep apache</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ4ï¼‰æ‰¾å‡ºä¸ cron ä¸ syslog è¿™ä¸¤ä¸ªæœåŠ¡æœ‰å…³çš„ PID å·ç </p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ps aux | grep &#x27;(cron|syslog)&#x27;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"rpm-å‘½ä»¤\"><a href=\"#rpm-å‘½ä»¤\" class=\"headerlink\" title=\"rpm å‘½ä»¤\"></a>rpm å‘½ä»¤</h3><p>Linux rpm å‘½ä»¤ç”¨äºç®¡ç†å¥—ä»¶ã€‚</p>\n<p>rpm(redhat package manager) åŸæœ¬æ˜¯ Red Hat Linux å‘è¡Œç‰ˆä¸“é—¨ç”¨æ¥ç®¡ç† Linux å„é¡¹å¥—ä»¶çš„ç¨‹åºï¼Œç”±äºå®ƒéµå¾ª GPL è§„åˆ™ä¸”åŠŸèƒ½å¼ºå¤§æ–¹ä¾¿ï¼Œå› è€Œå¹¿å—æ¬¢è¿ã€‚é€æ¸å—åˆ°å…¶ä»–å‘è¡Œç‰ˆçš„é‡‡ç”¨ã€‚RPM å¥—ä»¶ç®¡ç†æ–¹å¼çš„å‡ºç°ï¼Œè®© Linux æ˜“äºå®‰è£…ï¼Œå‡çº§ï¼Œé—´æ¥æå‡äº† Linux çš„é€‚ç”¨åº¦ã€‚</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">æŸ¥çœ‹ç³»ç»Ÿè‡ªå¸¦jdk</span></span><br><span class=\"line\">rpm -qa | grep jdk</span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">åˆ é™¤ç³»ç»Ÿè‡ªå¸¦jdk</span></span><br><span class=\"line\">rpm -e --nodeps æŸ¥çœ‹jdkæ˜¾ç¤ºçš„æ•°æ®</span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">å®‰è£…jdk</span></span><br><span class=\"line\">rpm -ivh jdk-7u80-linux-x64.rpm</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"top-å‘½ä»¤\"><a href=\"#top-å‘½ä»¤\" class=\"headerlink\" title=\"top å‘½ä»¤\"></a>top å‘½ä»¤</h3><p>æ˜¾ç¤ºå½“å‰ç³»ç»Ÿæ­£åœ¨æ‰§è¡Œçš„è¿›ç¨‹çš„ç›¸å…³ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¿›ç¨‹ IDã€å†…å­˜å ç”¨ç‡ã€CPU å ç”¨ç‡ç­‰</p>\n<p><strong>å¸¸ç”¨å‚æ•°</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-c æ˜¾ç¤ºå®Œæ•´çš„è¿›ç¨‹å‘½ä»¤</span><br><span class=\"line\">-s ä¿å¯†æ¨¡å¼</span><br><span class=\"line\">-p &lt;è¿›ç¨‹å·&gt; æŒ‡å®šè¿›ç¨‹æ˜¾ç¤º</span><br><span class=\"line\">-n &lt;æ¬¡æ•°&gt;å¾ªç¯æ˜¾ç¤ºæ¬¡æ•°</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">top - 14:06:23 up 70 days, 16:44,  2 users,  load average: 1.25, 1.32, 1.35</span><br><span class=\"line\">Tasks: 206 total,   1 running, 205 sleeping,   0 stopped,   0 zombie</span><br><span class=\"line\">Cpu(s):  5.9%us,  3.4%sy,  0.0%ni, 90.4%id,  0.0%wa,  0.0%hi,  0.2%si,  0.0%st</span><br><span class=\"line\">Mem:  32949016k total, 14411180k used, 18537836k free,   169884k buffers</span><br><span class=\"line\">Swap: 32764556k total,        0k used, 32764556k free,  3612636k cached</span><br><span class=\"line\">PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND  </span><br><span class=\"line\">28894 root      22   0 1501m 405m  10m S 52.2  1.3   2534:16 java  </span><br></pre></td></tr></table></figure>\n\n<p>å‰äº”è¡Œæ˜¯å½“å‰ç³»ç»Ÿæƒ…å†µæ•´ä½“çš„ç»Ÿè®¡ä¿¡æ¯åŒºã€‚</p>\n<p><strong>ç¬¬ä¸€è¡Œï¼Œä»»åŠ¡é˜Ÿåˆ—ä¿¡æ¯ï¼ŒåŒ uptime å‘½ä»¤çš„æ‰§è¡Œç»“æœï¼Œå…·ä½“å‚æ•°è¯´æ˜æƒ…å†µå¦‚ä¸‹</strong>ï¼š</p>\n<p>14:06:23 â€” å½“å‰ç³»ç»Ÿæ—¶é—´</p>\n<p>up 70 days, 16:44 â€” ç³»ç»Ÿå·²ç»è¿è¡Œäº† 70 å¤© 16 å°æ—¶ 44 åˆ†é’Ÿï¼ˆåœ¨è¿™æœŸé—´ç³»ç»Ÿæ²¡æœ‰é‡å¯è¿‡çš„å†ï¼ï¼‰</p>\n<p>2 users â€” å½“å‰æœ‰ 2 ä¸ªç”¨æˆ·ç™»å½•ç³»ç»Ÿ</p>\n<p>load average: 1.15, 1.42, 1.44 â€” load average åé¢çš„ä¸‰ä¸ªæ•°åˆ†åˆ«æ˜¯ 1 åˆ†é’Ÿã€5 åˆ†é’Ÿã€15 åˆ†é’Ÿçš„è´Ÿè½½æƒ…å†µã€‚</p>\n<p>load average æ•°æ®æ˜¯æ¯éš” 5 ç§’é’Ÿæ£€æŸ¥ä¸€æ¬¡æ´»è·ƒçš„è¿›ç¨‹æ•°ï¼Œç„¶åæŒ‰ç‰¹å®šç®—æ³•è®¡ç®—å‡ºçš„æ•°å€¼ã€‚å¦‚æœè¿™ä¸ªæ•°é™¤ä»¥é€»è¾‘ CPU çš„æ•°é‡ï¼Œç»“æœé«˜äº 5 çš„æ—¶å€™å°±è¡¨æ˜ç³»ç»Ÿåœ¨è¶…è´Ÿè·è¿è½¬äº†ã€‚</p>\n<p><strong>ç¬¬äºŒè¡Œï¼ŒTasks â€” ä»»åŠ¡ï¼ˆè¿›ç¨‹ï¼‰ï¼Œå…·ä½“ä¿¡æ¯è¯´æ˜å¦‚ä¸‹</strong>ï¼š</p>\n<p>ç³»ç»Ÿç°åœ¨å…±æœ‰ 206 ä¸ªè¿›ç¨‹ï¼Œå…¶ä¸­å¤„äºè¿è¡Œä¸­çš„æœ‰ 1 ä¸ªï¼Œ205 ä¸ªåœ¨ä¼‘çœ ï¼ˆsleepï¼‰ï¼Œstoped çŠ¶æ€çš„æœ‰ 0 ä¸ªï¼Œzombie çŠ¶æ€ï¼ˆåƒµå°¸ï¼‰çš„æœ‰ 0 ä¸ªã€‚</p>\n<p><strong>ç¬¬ä¸‰è¡Œï¼ŒcpuçŠ¶æ€ä¿¡æ¯ï¼Œå…·ä½“å±æ€§è¯´æ˜å¦‚ä¸‹</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">5.9%us â€” ç”¨æˆ·ç©ºé—´å ç”¨CPUçš„ç™¾åˆ†æ¯”ã€‚</span><br><span class=\"line\">3.4% sy â€” å†…æ ¸ç©ºé—´å ç”¨CPUçš„ç™¾åˆ†æ¯”ã€‚</span><br><span class=\"line\">0.0% ni â€” æ”¹å˜è¿‡ä¼˜å…ˆçº§çš„è¿›ç¨‹å ç”¨CPUçš„ç™¾åˆ†æ¯”</span><br><span class=\"line\">90.4% id â€” ç©ºé—²CPUç™¾åˆ†æ¯”</span><br><span class=\"line\">0.0% wa â€” IOç­‰å¾…å ç”¨CPUçš„ç™¾åˆ†æ¯”</span><br><span class=\"line\">0.0% hi â€” ç¡¬ä¸­æ–­ï¼ˆHardware IRQï¼‰å ç”¨CPUçš„ç™¾åˆ†æ¯”</span><br><span class=\"line\">0.2% si â€” è½¯ä¸­æ–­ï¼ˆSoftware Interruptsï¼‰å ç”¨CPUçš„ç™¾åˆ†æ¯”</span><br></pre></td></tr></table></figure>\n\n<p><strong>å¤‡æ³¨</strong>ï¼šåœ¨è¿™é‡Œ CPU çš„ä½¿ç”¨æ¯”ç‡å’Œ windows æ¦‚å¿µä¸åŒï¼Œéœ€è¦ç†è§£ linux ç³»ç»Ÿç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´çš„ç›¸å…³çŸ¥è¯†ï¼</p>\n<p>ç¬¬å››è¡Œï¼Œå†…å­˜çŠ¶æ€ï¼Œå…·ä½“ä¿¡æ¯å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">32949016k total â€” ç‰©ç†å†…å­˜æ€»é‡ï¼ˆ32GBï¼‰</span><br><span class=\"line\">14411180k used â€” ä½¿ç”¨ä¸­çš„å†…å­˜æ€»é‡ï¼ˆ14GBï¼‰</span><br><span class=\"line\">18537836k free â€” ç©ºé—²å†…å­˜æ€»é‡ï¼ˆ18GBï¼‰</span><br><span class=\"line\">169884k buffers â€” ç¼“å­˜çš„å†…å­˜é‡ ï¼ˆ169Mï¼‰</span><br></pre></td></tr></table></figure>\n\n<p><strong>ç¬¬äº”è¡Œï¼Œswapäº¤æ¢åˆ†åŒºä¿¡æ¯ï¼Œå…·ä½“ä¿¡æ¯è¯´æ˜å¦‚ä¸‹</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">32764556k total â€” äº¤æ¢åŒºæ€»é‡ï¼ˆ32GBï¼‰</span><br><span class=\"line\">0k used â€” ä½¿ç”¨çš„äº¤æ¢åŒºæ€»é‡ï¼ˆ0Kï¼‰</span><br><span class=\"line\">32764556k free â€” ç©ºé—²äº¤æ¢åŒºæ€»é‡ï¼ˆ32GBï¼‰</span><br><span class=\"line\">3612636k cached â€” ç¼“å†²çš„äº¤æ¢åŒºæ€»é‡ï¼ˆ3.6GBï¼‰</span><br></pre></td></tr></table></figure>\n\n<p><strong>ç¬¬å…­è¡Œï¼Œç©ºè¡Œã€‚</strong></p>\n<p><strong>ç¬¬ä¸ƒè¡Œä»¥ä¸‹ï¼šå„è¿›ç¨‹ï¼ˆä»»åŠ¡ï¼‰çš„çŠ¶æ€ç›‘æ§ï¼Œé¡¹ç›®åˆ—ä¿¡æ¯è¯´æ˜å¦‚ä¸‹</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">PID â€” è¿›ç¨‹id</span><br><span class=\"line\">USER â€” è¿›ç¨‹æ‰€æœ‰è€…</span><br><span class=\"line\">PR â€” è¿›ç¨‹ä¼˜å…ˆçº§</span><br><span class=\"line\">NI â€” niceå€¼ã€‚è´Ÿå€¼è¡¨ç¤ºé«˜ä¼˜å…ˆçº§ï¼Œæ­£å€¼è¡¨ç¤ºä½ä¼˜å…ˆçº§</span><br><span class=\"line\">VIRT â€” è¿›ç¨‹ä½¿ç”¨çš„è™šæ‹Ÿå†…å­˜æ€»é‡ï¼Œå•ä½kbã€‚VIRT=SWAP+RES</span><br><span class=\"line\">RES â€” è¿›ç¨‹ä½¿ç”¨çš„ã€æœªè¢«æ¢å‡ºçš„ç‰©ç†å†…å­˜å¤§å°ï¼Œå•ä½kbã€‚RES=CODE+DATA</span><br><span class=\"line\">SHR â€” å…±äº«å†…å­˜å¤§å°ï¼Œå•ä½kb</span><br><span class=\"line\">S â€” è¿›ç¨‹çŠ¶æ€ã€‚D=ä¸å¯ä¸­æ–­çš„ç¡çœ çŠ¶æ€ R=è¿è¡Œ S=ç¡çœ  T=è·Ÿè¸ª/åœæ­¢ Z=åƒµå°¸è¿›ç¨‹</span><br><span class=\"line\">%CPU â€” ä¸Šæ¬¡æ›´æ–°åˆ°ç°åœ¨çš„CPUæ—¶é—´å ç”¨ç™¾åˆ†æ¯”</span><br><span class=\"line\">%MEM â€” è¿›ç¨‹ä½¿ç”¨çš„ç‰©ç†å†…å­˜ç™¾åˆ†æ¯”</span><br><span class=\"line\">TIME+ â€” è¿›ç¨‹ä½¿ç”¨çš„CPUæ—¶é—´æ€»è®¡ï¼Œå•ä½1/100ç§’</span><br><span class=\"line\">COMMAND â€” è¿›ç¨‹åç§°ï¼ˆå‘½ä»¤å/å‘½ä»¤è¡Œï¼‰</span><br></pre></td></tr></table></figure>\n\n<p><strong>top äº¤äº’å‘½ä»¤</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">h æ˜¾ç¤ºtopäº¤äº’å‘½ä»¤å¸®åŠ©ä¿¡æ¯</span><br><span class=\"line\">c åˆ‡æ¢æ˜¾ç¤ºå‘½ä»¤åç§°å’Œå®Œæ•´å‘½ä»¤è¡Œ</span><br><span class=\"line\">m ä»¥å†…å­˜ä½¿ç”¨ç‡æ’åº</span><br><span class=\"line\">P æ ¹æ®CPUä½¿ç”¨ç™¾åˆ†æ¯”å¤§å°è¿›è¡Œæ’åº</span><br><span class=\"line\">T æ ¹æ®æ—¶é—´/ç´¯è®¡æ—¶é—´è¿›è¡Œæ’åº</span><br><span class=\"line\">W å°†å½“å‰è®¾ç½®å†™å…¥~/.toprcæ–‡ä»¶ä¸­</span><br><span class=\"line\">oæˆ–è€…O æ”¹å˜æ˜¾ç¤ºé¡¹ç›®çš„é¡ºåº</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"yum-å‘½ä»¤\"><a href=\"#yum-å‘½ä»¤\" class=\"headerlink\" title=\"yum å‘½ä»¤\"></a>yum å‘½ä»¤</h3><p>yumï¼ˆ Yellow dog Updater, Modifiedï¼‰æ˜¯ä¸€ä¸ªåœ¨ Fedora å’Œ RedHat ä»¥åŠ SUSE ä¸­çš„ Shell å‰ç«¯è½¯ä»¶åŒ…ç®¡ç†å™¨ã€‚</p>\n<p>åŸºæ–¼ RPM åŒ…ç®¡ç†ï¼Œèƒ½å¤Ÿä»æŒ‡å®šçš„æœåŠ¡å™¨è‡ªåŠ¨ä¸‹è½½ RPM åŒ…å¹¶ä¸”å®‰è£…ï¼Œå¯ä»¥è‡ªåŠ¨å¤„ç†ä¾èµ–æ€§å…³ç³»ï¼Œå¹¶ä¸”ä¸€æ¬¡å®‰è£…æ‰€æœ‰ä¾èµ–çš„è½¯ä½“åŒ…ï¼Œæ— é¡»ç¹çåœ°ä¸€æ¬¡æ¬¡ä¸‹è½½ã€å®‰è£…ã€‚</p>\n<p>yum æä¾›äº†æŸ¥æ‰¾ã€å®‰è£…ã€åˆ é™¤æŸä¸€ä¸ªã€ä¸€ç»„ç”šè‡³å…¨éƒ¨è½¯ä»¶åŒ…çš„å‘½ä»¤ï¼Œè€Œä¸”å‘½ä»¤ç®€æ´è€Œåˆå¥½è®°ã€‚</p>\n<ul>\n<li>1.åˆ—å‡ºæ‰€æœ‰å¯æ›´æ–°çš„è½¯ä»¶æ¸…å•å‘½ä»¤ï¼šyum check-update</li>\n<li>2.æ›´æ–°æ‰€æœ‰è½¯ä»¶å‘½ä»¤ï¼šyum update</li>\n<li>3.ä»…å®‰è£…æŒ‡å®šçš„è½¯ä»¶å‘½ä»¤ï¼šyum install <package_name></li>\n<li>4.ä»…æ›´æ–°æŒ‡å®šçš„è½¯ä»¶å‘½ä»¤ï¼šyum update <package_name></li>\n<li>5.åˆ—å‡ºæ‰€æœ‰å¯å®‰è£çš„è½¯ä»¶æ¸…å•å‘½ä»¤ï¼šyum list</li>\n<li>6.åˆ é™¤è½¯ä»¶åŒ…å‘½ä»¤ï¼šyum remove <package_name></li>\n<li>7.æŸ¥æ‰¾è½¯ä»¶åŒ… å‘½ä»¤ï¼šyum search</li>\n<li>8.æ¸…é™¤ç¼“å­˜å‘½ä»¤:<ul>\n<li>yum clean packages: æ¸…é™¤ç¼“å­˜ç›®å½•ä¸‹çš„è½¯ä»¶åŒ…</li>\n<li>yum clean headers: æ¸…é™¤ç¼“å­˜ç›®å½•ä¸‹çš„ headers</li>\n<li>yum clean oldheaders: æ¸…é™¤ç¼“å­˜ç›®å½•ä¸‹æ—§çš„ headers</li>\n<li>yum clean, yum clean all (&#x3D; yum clean packages; yum clean oldheaders) :æ¸…é™¤ç¼“å­˜ç›®å½•ä¸‹çš„è½¯ä»¶åŒ…åŠæ—§çš„ headers</li>\n</ul>\n</li>\n</ul>\n<p><strong>å®ä¾‹</strong></p>\n<p>å®‰è£… pam-devel</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@www ~]# yum install pam-devel</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"å¤‡ä»½å‹ç¼©å‘½ä»¤\"><a href=\"#å¤‡ä»½å‹ç¼©å‘½ä»¤\" class=\"headerlink\" title=\"å¤‡ä»½å‹ç¼©å‘½ä»¤\"></a>å¤‡ä»½å‹ç¼©å‘½ä»¤</h2><h3 id=\"bzip2-å‘½ä»¤\"><a href=\"#bzip2-å‘½ä»¤\" class=\"headerlink\" title=\"bzip2 å‘½ä»¤\"></a>bzip2 å‘½ä»¤</h3><ul>\n<li>åˆ›å»º <code>*.bz2</code> å‹ç¼©æ–‡ä»¶ï¼š<code>bzip2 test.txt</code> ã€‚</li>\n<li>è§£å‹ <code>*.bz2</code> æ–‡ä»¶ï¼š<code>bzip2 -d test.txt.bz2</code> ã€‚</li>\n</ul>\n<h3 id=\"gzip-å‘½ä»¤\"><a href=\"#gzip-å‘½ä»¤\" class=\"headerlink\" title=\"gzip å‘½ä»¤\"></a>gzip å‘½ä»¤</h3><ul>\n<li>åˆ›å»ºä¸€ä¸ª <code>*.gz</code> çš„å‹ç¼©æ–‡ä»¶ï¼š<code>gzip test.txt</code> ã€‚</li>\n<li>è§£å‹ <code>*.gz</code> æ–‡ä»¶ï¼š<code>gzip -d test.txt.gz</code> ã€‚</li>\n<li>æ˜¾ç¤ºå‹ç¼©çš„æ¯”ç‡ï¼š<code>gzip -l *.gz</code> ã€‚</li>\n</ul>\n<h3 id=\"tar-å‘½ä»¤\"><a href=\"#tar-å‘½ä»¤\" class=\"headerlink\" title=\"tar å‘½ä»¤\"></a>tar å‘½ä»¤</h3><p>ç”¨æ¥å‹ç¼©å’Œè§£å‹æ–‡ä»¶ã€‚tar æœ¬èº«ä¸å…·æœ‰å‹ç¼©åŠŸèƒ½ï¼Œåªå…·æœ‰æ‰“åŒ…åŠŸèƒ½ï¼Œæœ‰å…³å‹ç¼©åŠè§£å‹æ˜¯è°ƒç”¨å…¶å®ƒçš„åŠŸèƒ½æ¥å®Œæˆã€‚</p>\n<p>å¼„æ¸…ä¸¤ä¸ªæ¦‚å¿µï¼šæ‰“åŒ…å’Œå‹ç¼©ã€‚æ‰“åŒ…æ˜¯æŒ‡å°†ä¸€å¤§å †æ–‡ä»¶æˆ–ç›®å½•å˜æˆä¸€ä¸ªæ€»çš„æ–‡ä»¶ï¼›å‹ç¼©åˆ™æ˜¯å°†ä¸€ä¸ªå¤§çš„æ–‡ä»¶é€šè¿‡ä¸€äº›å‹ç¼©ç®—æ³•å˜æˆä¸€ä¸ªå°æ–‡ä»¶</p>\n<p><strong>å¸¸ç”¨å‚æ•°</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-c å»ºç«‹æ–°çš„å‹ç¼©æ–‡ä»¶</span><br><span class=\"line\">-f æŒ‡å®šå‹ç¼©æ–‡ä»¶</span><br><span class=\"line\">-r æ·»åŠ æ–‡ä»¶åˆ°å·²ç»å‹ç¼©æ–‡ä»¶åŒ…ä¸­</span><br><span class=\"line\">-u æ·»åŠ æ”¹äº†å’Œç°æœ‰çš„æ–‡ä»¶åˆ°å‹ç¼©åŒ…ä¸­</span><br><span class=\"line\">-x ä»å‹ç¼©åŒ…ä¸­æŠ½å–æ–‡ä»¶</span><br><span class=\"line\">-t æ˜¾ç¤ºå‹ç¼©æ–‡ä»¶ä¸­çš„å†…å®¹</span><br><span class=\"line\">-z æ”¯æŒgzipå‹ç¼©</span><br><span class=\"line\">-j æ”¯æŒbzip2å‹ç¼©</span><br><span class=\"line\">-Z æ”¯æŒcompressè§£å‹æ–‡ä»¶</span><br><span class=\"line\">-v æ˜¾ç¤ºæ“ä½œè¿‡ç¨‹</span><br></pre></td></tr></table></figure>\n\n<p>æœ‰å…³ gzip åŠ bzip2 å‹ç¼©:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gzip å®ä¾‹ï¼šå‹ç¼© gzip fileName .tar.gz å’Œ.tgz  è§£å‹ï¼šgunzip filename.gz æˆ– gzip -d filename.gz</span><br><span class=\"line\">          å¯¹åº”ï¼štar zcvf filename.tar.gz     tar zxvf filename.tar.gz</span><br><span class=\"line\"></span><br><span class=\"line\">bz2å®ä¾‹ï¼šå‹ç¼© bzip2 -z filename .tar.bz2 è§£å‹ï¼šbunzip filename.bz2æˆ–bzip -d filename.bz2</span><br><span class=\"line\">       å¯¹åº”ï¼štar jcvf filename.tar.gz         è§£å‹ï¼štar jxvf filename.tar.bz2</span><br></pre></td></tr></table></figure>\n\n<p><strong>å®ä¾‹</strong>ï¼š</p>\n<p>ï¼ˆ1ï¼‰å°†æ–‡ä»¶å…¨éƒ¨æ‰“åŒ…æˆ tar åŒ…</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tar -cvf log.tar 1.log,2.log æˆ–tar -cvf log.*</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ2ï¼‰å°† &#x2F;etc ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åŠç›®å½•æ‰“åŒ…åˆ°æŒ‡å®šç›®å½•ï¼Œå¹¶ä½¿ç”¨ gz å‹ç¼©</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tar -zcvf /tmp/etc.tar.gz /etc</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ3ï¼‰æŸ¥çœ‹åˆšæ‰“åŒ…çš„æ–‡ä»¶å†…å®¹ï¼ˆä¸€å®šåŠ  zï¼Œå› ä¸ºæ˜¯ä½¿ç”¨ gzip å‹ç¼©çš„ï¼‰</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tar -ztvf /tmp/etc.tar.gz</span><br></pre></td></tr></table></figure>\n\n<p>ï¼ˆ4ï¼‰è¦å‹ç¼©æ‰“åŒ… &#x2F;home, &#x2F;etc ï¼Œä½†ä¸è¦ &#x2F;home&#x2F;dmtsai</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tar --exclude /home/dmtsai -zcvf myfile.tar.gz /home/* /etc</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"unzip-å‘½ä»¤\"><a href=\"#unzip-å‘½ä»¤\" class=\"headerlink\" title=\"unzip å‘½ä»¤\"></a>unzip å‘½ä»¤</h3><ul>\n<li>è§£å‹ <code>*.zip</code> æ–‡ä»¶ï¼š<code>unzip test.zip</code> ã€‚</li>\n<li>æŸ¥çœ‹ <code>*.zip</code> æ–‡ä»¶çš„å†…å®¹ï¼š<code>unzip -l jasper.zip</code> ã€‚</li>\n</ul>"},{"title":"Macå®‰è£…MySQLä»¥åŠSequel Proé…ç½®ä¸è¿æ¥","copyright":true,"mathjax":false,"toc":false,"date":"2023-02-11T02:23:54.000Z","urlname":"mysql-sequel-pro","_content":"\næœ¬æ–‡ä»‹ç»åœ¨ Mac ä¸Šå®‰è£… MySQL ä»¥åŠä½¿ç”¨ Sequel Pro ä½œä¸ºå¯è§†åŒ–å®¢æˆ·ç«¯çš„é…ç½®ä¸è¿æ¥ã€‚<!--more-->\n\n1ã€å®‰è£… MySQL\n\nå¯ä»¥åœ¨å®˜ç½‘ä¸‹è½½ .dmg æ–‡ä»¶è¿›è¡Œå®‰è£…ä¹Ÿå¯ä»¥ä½¿ç”¨ homebrew å®‰è£… MySQLï¼Œä»¥ä¸‹ä½¿ç”¨ homebrew å®‰è£…ã€‚\n\n```sh\nbrew install mysql\n```\n\næ³¨æ„ï¼šè®¾ç½®å¯†ç çš„æ—¶å€™è®¾ç½®çš„ä¸è¦å¤ªç®€å•ï¼Œè¦åŒ…å«å­—æ¯ã€æ•°å­—ã€å­—ç¬¦ï¼ˆå¤ªç®€å•çš„è¯åç»­å‡ºé—®é¢˜è¿˜è¦å†é‡æ–°æ”¹æˆä¸€ä¸ªå¤æ‚çš„ï¼‰\n\n2ã€ä¸‹è½½ Sequel Pro \n\nSequel Proä¸‹è½½åœ°å€ï¼šhttp://www.sequelpro.com/\n\nä¸‹è½½å®‰è£…åï¼Œå‡ºç°è¿æ¥ç•Œé¢ï¼Œå¡«å…¥ä¿¡æ¯ï¼Œæ­¤æ—¶å¯èƒ½æŠ¥é”™ Connection failed MySQL said: Authentication plug ... cannot be loaded ...\n\nè§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š\n\nç”¨ç»ˆç«¯è¿æ¥MySQLï¼Œç„¶åæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š\n\n```bash\nmysql> ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY 'æ­¤å¤„å¡«å†™è®¾ç½®çš„MySQLå¯†ç ';\n```\n\nå¦‚æœæŠ¥é”™æ˜¾ç¤ºå¯†ç ç®€å•ï¼Œåˆ™é€šè¿‡ä»¥ä¸‹æ–¹å¼ä¿®æ”¹å¯†ç ï¼š\n\n```sh\nmysqladmin -uç”¨æˆ·å -pæ—§å¯†ç  password æ–°å¯†ç  \n```\n\nç„¶åé‡æ–°æ‰§è¡Œç¬¬ä¸€æ¡å‘½ä»¤ï¼ŒSequel Pro å¯ä»¥æ­£å¸¸è¿æ¥ã€‚\n\nP.S. æœ¬æœº Sequel Pro å¯¼å…¥ SQL å»ºè¡¨è¯­å¥ loading è¿‡ä¹…ï¼Œä¸å¥½ç”¨ï¼Œä¸å¦‚ä½¿ç”¨ IDEA è‡ªå¸¦çš„æ•°æ®åº“å·¥å…·ï¼Œæˆ–è€…å¯ä»¥ä½¿ç”¨ Jet å®¶çš„ DataGripã€‚\n","source":"_posts/Macå®‰è£…MySQLä»¥åŠSequel-Proé…ç½®ä¸è¿æ¥.md","raw":"---\ntitle: Macå®‰è£…MySQLä»¥åŠSequel Proé…ç½®ä¸è¿æ¥\ncopyright: true\nmathjax: false\ncategories:\n  - Macå¼€å‘ç¯å¢ƒé…ç½®\ntoc: false\ndate: 2023-02-11 10:23:54\ntags:\nurlname: mysql-sequel-pro\n---\n\næœ¬æ–‡ä»‹ç»åœ¨ Mac ä¸Šå®‰è£… MySQL ä»¥åŠä½¿ç”¨ Sequel Pro ä½œä¸ºå¯è§†åŒ–å®¢æˆ·ç«¯çš„é…ç½®ä¸è¿æ¥ã€‚<!--more-->\n\n1ã€å®‰è£… MySQL\n\nå¯ä»¥åœ¨å®˜ç½‘ä¸‹è½½ .dmg æ–‡ä»¶è¿›è¡Œå®‰è£…ä¹Ÿå¯ä»¥ä½¿ç”¨ homebrew å®‰è£… MySQLï¼Œä»¥ä¸‹ä½¿ç”¨ homebrew å®‰è£…ã€‚\n\n```sh\nbrew install mysql\n```\n\næ³¨æ„ï¼šè®¾ç½®å¯†ç çš„æ—¶å€™è®¾ç½®çš„ä¸è¦å¤ªç®€å•ï¼Œè¦åŒ…å«å­—æ¯ã€æ•°å­—ã€å­—ç¬¦ï¼ˆå¤ªç®€å•çš„è¯åç»­å‡ºé—®é¢˜è¿˜è¦å†é‡æ–°æ”¹æˆä¸€ä¸ªå¤æ‚çš„ï¼‰\n\n2ã€ä¸‹è½½ Sequel Pro \n\nSequel Proä¸‹è½½åœ°å€ï¼šhttp://www.sequelpro.com/\n\nä¸‹è½½å®‰è£…åï¼Œå‡ºç°è¿æ¥ç•Œé¢ï¼Œå¡«å…¥ä¿¡æ¯ï¼Œæ­¤æ—¶å¯èƒ½æŠ¥é”™ Connection failed MySQL said: Authentication plug ... cannot be loaded ...\n\nè§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š\n\nç”¨ç»ˆç«¯è¿æ¥MySQLï¼Œç„¶åæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š\n\n```bash\nmysql> ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY 'æ­¤å¤„å¡«å†™è®¾ç½®çš„MySQLå¯†ç ';\n```\n\nå¦‚æœæŠ¥é”™æ˜¾ç¤ºå¯†ç ç®€å•ï¼Œåˆ™é€šè¿‡ä»¥ä¸‹æ–¹å¼ä¿®æ”¹å¯†ç ï¼š\n\n```sh\nmysqladmin -uç”¨æˆ·å -pæ—§å¯†ç  password æ–°å¯†ç  \n```\n\nç„¶åé‡æ–°æ‰§è¡Œç¬¬ä¸€æ¡å‘½ä»¤ï¼ŒSequel Pro å¯ä»¥æ­£å¸¸è¿æ¥ã€‚\n\nP.S. æœ¬æœº Sequel Pro å¯¼å…¥ SQL å»ºè¡¨è¯­å¥ loading è¿‡ä¹…ï¼Œä¸å¥½ç”¨ï¼Œä¸å¦‚ä½¿ç”¨ IDEA è‡ªå¸¦çš„æ•°æ®åº“å·¥å…·ï¼Œæˆ–è€…å¯ä»¥ä½¿ç”¨ Jet å®¶çš„ DataGripã€‚\n","slug":"Macå®‰è£…MySQLä»¥åŠSequel-Proé…ç½®ä¸è¿æ¥","published":1,"updated":"2023-02-11T04:10:08.942Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cldzfw324000lt9t81a19ajys","content":"<p>æœ¬æ–‡ä»‹ç»åœ¨ Mac ä¸Šå®‰è£… MySQL ä»¥åŠä½¿ç”¨ Sequel Pro ä½œä¸ºå¯è§†åŒ–å®¢æˆ·ç«¯çš„é…ç½®ä¸è¿æ¥ã€‚<span id=\"more\"></span></p>\n<p>1ã€å®‰è£… MySQL</p>\n<p>å¯ä»¥åœ¨å®˜ç½‘ä¸‹è½½ .dmg æ–‡ä»¶è¿›è¡Œå®‰è£…ä¹Ÿå¯ä»¥ä½¿ç”¨ homebrew å®‰è£… MySQLï¼Œä»¥ä¸‹ä½¿ç”¨ homebrew å®‰è£…ã€‚</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew install mysql</span><br></pre></td></tr></table></figure>\n\n<p>æ³¨æ„ï¼šè®¾ç½®å¯†ç çš„æ—¶å€™è®¾ç½®çš„ä¸è¦å¤ªç®€å•ï¼Œè¦åŒ…å«å­—æ¯ã€æ•°å­—ã€å­—ç¬¦ï¼ˆå¤ªç®€å•çš„è¯åç»­å‡ºé—®é¢˜è¿˜è¦å†é‡æ–°æ”¹æˆä¸€ä¸ªå¤æ‚çš„ï¼‰</p>\n<p>2ã€ä¸‹è½½ Sequel Pro </p>\n<p>Sequel Proä¸‹è½½åœ°å€ï¼š<a href=\"http://www.sequelpro.com/\">http://www.sequelpro.com/</a></p>\n<p>ä¸‹è½½å®‰è£…åï¼Œå‡ºç°è¿æ¥ç•Œé¢ï¼Œå¡«å…¥ä¿¡æ¯ï¼Œæ­¤æ—¶å¯èƒ½æŠ¥é”™ Connection failed MySQL said: Authentication plug â€¦ cannot be loaded â€¦</p>\n<p>è§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š</p>\n<p>ç”¨ç»ˆç«¯è¿æ¥MySQLï¼Œç„¶åæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; ALTER USER <span class=\"string\">&#x27;root&#x27;</span>@<span class=\"string\">&#x27;localhost&#x27;</span> IDENTIFIED WITH mysql_native_password BY <span class=\"string\">&#x27;æ­¤å¤„å¡«å†™è®¾ç½®çš„MySQLå¯†ç &#x27;</span>;</span><br></pre></td></tr></table></figure>\n\n<p>å¦‚æœæŠ¥é”™æ˜¾ç¤ºå¯†ç ç®€å•ï¼Œåˆ™é€šè¿‡ä»¥ä¸‹æ–¹å¼ä¿®æ”¹å¯†ç ï¼š</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysqladmin -uç”¨æˆ·å -pæ—§å¯†ç  password æ–°å¯†ç  </span><br></pre></td></tr></table></figure>\n\n<p>ç„¶åé‡æ–°æ‰§è¡Œç¬¬ä¸€æ¡å‘½ä»¤ï¼ŒSequel Pro å¯ä»¥æ­£å¸¸è¿æ¥ã€‚</p>\n<p>P.S. æœ¬æœº Sequel Pro å¯¼å…¥ SQL å»ºè¡¨è¯­å¥ loading è¿‡ä¹…ï¼Œä¸å¥½ç”¨ï¼Œä¸å¦‚ä½¿ç”¨ IDEA è‡ªå¸¦çš„æ•°æ®åº“å·¥å…·ï¼Œæˆ–è€…å¯ä»¥ä½¿ç”¨ Jet å®¶çš„ DataGripã€‚</p>\n","site":{"data":{}},"length":619,"excerpt":"<p>æœ¬æ–‡ä»‹ç»åœ¨ Mac ä¸Šå®‰è£… MySQL ä»¥åŠä½¿ç”¨ Sequel Pro ä½œä¸ºå¯è§†åŒ–å®¢æˆ·ç«¯çš„é…ç½®ä¸è¿æ¥ã€‚","more":"</p>\n<p>1ã€å®‰è£… MySQL</p>\n<p>å¯ä»¥åœ¨å®˜ç½‘ä¸‹è½½ .dmg æ–‡ä»¶è¿›è¡Œå®‰è£…ä¹Ÿå¯ä»¥ä½¿ç”¨ homebrew å®‰è£… MySQLï¼Œä»¥ä¸‹ä½¿ç”¨ homebrew å®‰è£…ã€‚</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew install mysql</span><br></pre></td></tr></table></figure>\n\n<p>æ³¨æ„ï¼šè®¾ç½®å¯†ç çš„æ—¶å€™è®¾ç½®çš„ä¸è¦å¤ªç®€å•ï¼Œè¦åŒ…å«å­—æ¯ã€æ•°å­—ã€å­—ç¬¦ï¼ˆå¤ªç®€å•çš„è¯åç»­å‡ºé—®é¢˜è¿˜è¦å†é‡æ–°æ”¹æˆä¸€ä¸ªå¤æ‚çš„ï¼‰</p>\n<p>2ã€ä¸‹è½½ Sequel Pro </p>\n<p>Sequel Proä¸‹è½½åœ°å€ï¼š<a href=\"http://www.sequelpro.com/\">http://www.sequelpro.com/</a></p>\n<p>ä¸‹è½½å®‰è£…åï¼Œå‡ºç°è¿æ¥ç•Œé¢ï¼Œå¡«å…¥ä¿¡æ¯ï¼Œæ­¤æ—¶å¯èƒ½æŠ¥é”™ Connection failed MySQL said: Authentication plug â€¦ cannot be loaded â€¦</p>\n<p>è§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š</p>\n<p>ç”¨ç»ˆç«¯è¿æ¥MySQLï¼Œç„¶åæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; ALTER USER <span class=\"string\">&#x27;root&#x27;</span>@<span class=\"string\">&#x27;localhost&#x27;</span> IDENTIFIED WITH mysql_native_password BY <span class=\"string\">&#x27;æ­¤å¤„å¡«å†™è®¾ç½®çš„MySQLå¯†ç &#x27;</span>;</span><br></pre></td></tr></table></figure>\n\n<p>å¦‚æœæŠ¥é”™æ˜¾ç¤ºå¯†ç ç®€å•ï¼Œåˆ™é€šè¿‡ä»¥ä¸‹æ–¹å¼ä¿®æ”¹å¯†ç ï¼š</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysqladmin -uç”¨æˆ·å -pæ—§å¯†ç  password æ–°å¯†ç  </span><br></pre></td></tr></table></figure>\n\n<p>ç„¶åé‡æ–°æ‰§è¡Œç¬¬ä¸€æ¡å‘½ä»¤ï¼ŒSequel Pro å¯ä»¥æ­£å¸¸è¿æ¥ã€‚</p>\n<p>P.S. æœ¬æœº Sequel Pro å¯¼å…¥ SQL å»ºè¡¨è¯­å¥ loading è¿‡ä¹…ï¼Œä¸å¥½ç”¨ï¼Œä¸å¦‚ä½¿ç”¨ IDEA è‡ªå¸¦çš„æ•°æ®åº“å·¥å…·ï¼Œæˆ–è€…å¯ä»¥ä½¿ç”¨ Jet å®¶çš„ DataGripã€‚</p>"},{"title":"Typoraé…ç½®é˜¿é‡Œäº‘OSSå›¾åºŠ","copyright":true,"mathjax":true,"date":"2022-12-12T14:11:09.000Z","urlname":"image-host","_content":"\nåœ¨æˆ‘ä»¬æ—¥å¸¸ä½¿ç”¨ Typora å†™æ–‡æ¡£æ—¶ï¼Œä¸€èˆ¬å›¾ç‰‡éƒ½æ˜¯æ”¾åœ¨æœ¬åœ°çš„ä¸€ä¸ªç›¸å¯¹è·¯å¾„ä¸‹ï¼Œå¦‚æœå°† markdown æ–‡ä»¶å‘é€ç»™åˆ«äººï¼Œé‚£ä¹ˆè¿™ä¸ªæ–‡ä»¶ä¸­çš„å›¾ç‰‡åˆ«äººè‡ªç„¶æ˜¯è®¿é—®ä¸åˆ°çš„ã€‚å›¾åºŠçš„ä½œç”¨å°±æ˜¯æŠŠå›¾ç‰‡å­˜åœ¨ç½‘ç«™ä¸Šï¼Œå¯¹åº”çš„å›¾ç‰‡ç”Ÿæˆä¸€ä¸ªé“¾æ¥ï¼Œmarkdown æ–‡ä»¶ä¸­ä½¿ç”¨è¯¥é“¾æ¥è®¿é—®å›¾ç‰‡ã€‚åœ¨æœ¬æ–‡ä¸­æˆ‘ä»¬ä½¿ç”¨ Typora + PicGo + é˜¿é‡Œäº‘ OSS å›¾åºŠå®ç°å›¾ç‰‡è‡ªåŠ¨ä¸Šä¼ å¹¶è‡ªç”±è®¿é—®ã€‚\n\n<!--more-->\n\n## ä¸‹è½½ Typora\n\n[Typoraå®˜ç½‘](https://typora.io/) å®˜ç½‘æ‹‰åˆ°æœ€ä¸‹ï¼Œç‚¹å‡» [History Releases](https://typora.io/releases/all)ï¼Œé€‰æ‹© Dev/Beta Releasesï¼Œæ‹‰åˆ°æœ€ä¸‹ More Beta,\n\né€‰æ‹©å¯¹åº”ç³»ç»Ÿçš„é“¾æ¥ [old Windows / Linux beta](https://typora.io/windows/dev_release.html)ï¼Œ[old macOS beta](https://typora.io/dev_release.html)\n\nWindows x64ï¼š[Download old version (Windows x64)](https://download.typora.io/windows/typora-update-x64-1016.exe)\n\nMac OSï¼š[Download v0.11.18](https://download.typora.io/mac/Typora-0.11.18.dmg)\n\n## å¸¸ç”¨è®¾ç½®\n\n### é€šç”¨\n\n1. æ‰“å¼€è‡ªåŠ¨ä¿å­˜\n2. å…³é—­è‡ªåŠ¨æ£€æŸ¥æ›´æ–°\n3. å…³é—­å‘é€åŒ¿åä½¿ç”¨æ•°æ®\n\n### å¤–è§‚\n\n1. è‡ªå®šä¹‰å­—ä½“\n\n2. å‹¾é€‰ä¾§è¾¹æ å¤§çº²è§†å›¾æŠ˜å å’Œå±•å¼€\n\n3. é…ç½® Next ä¸»é¢˜\n\n\t1. å®˜ç½‘ï¼šhttps://theme.typora.io/theme/NexT/\n\n\t2. ä¸‹è½½ zip å‹ç¼©åŒ…ï¼š[typora-theme-next.zip](https://github.com/BillChen2k/typora-theme-next/releases/download/1.1.1/typora-theme-next.zip)\n\n\t3. Typora å·¦ä¸Šè§’ï¼Œæ–‡ä»¶ - åå¥½è®¾ç½® - å¤–è§‚ - æ‰“å¼€ä¸»é¢˜æ–‡ä»¶å¤¹`xxx`\n\n\t4. æŠŠ typora-theme-next.zip è§£å‹ï¼Œå°†æ‰€æœ‰æ–‡ä»¶å¤åˆ¶/å‰ªåˆ‡åˆ°ä¸»é¢˜æ–‡ä»¶å¤¹`xxx`ä¸‹\n\t5. é‡å¯ Typoraï¼Œè®¾ç½®å¤–è§‚é€‰æ‹© Next å³å¯\n\t6. å¦‚æœæ„Ÿè§‰é¡µé¢å®½åº¦å¤ªå°ï¼Œå¯ä»¥æ‰“å¼€ next.cssï¼Œæœç´¢å¹¶é…ç½® max-width\n\t7. å¦‚æœæ„Ÿè§‰æ•´ä½“é¡µé¢åå°ï¼Œå¯ä»¥`Ctrl Shift +/-`å¢å¤§/å‡å°æ•´ä½“é¡µé¢\n\n### ç¼–è¾‘å™¨\n\n1. è®¾ç½®é»˜è®¤æ¢è¡Œç¬¦\n2. å–æ¶ˆæ‹¼å†™æ£€æŸ¥ï¼Œå‹¾é€‰`ä¸ä½¿ç”¨æ‹¼å†™æ£€æŸ¥`\n\n### å›¾åƒ\n\n1. æ’å…¥å›¾ç‰‡æ—¶\n\n\té€‰æ‹©ä¸Šä¼ å›¾ç‰‡ï¼Œå‹¾é€‰`å¯¹æœ¬åœ°ä½ç½®çš„å›¾ç‰‡åº”ç”¨ä¸Šè¿°è§„åˆ™`å’Œ`å¯¹ç½‘ç»œä½ç½®çš„å›¾ç‰‡åº”ç”¨ä¸Šè¿°è§„åˆ™`\n\n2. ä¸Šä¼ æœåŠ¡è®¾å®š\n\n\tæ¥ä¸‹æ¥ä¼šå…·ä½“è®²åˆ°å›¾åºŠçš„é…ç½®\n\n### Markdown\n\n1. å‹¾é€‰æ˜¾ç¤ºä»£ç å—è¡Œå·\n\n## å›¾åºŠé…ç½®\n\n### 1ã€å®‰è£…PicGo\n\nä¸‹è½½åœ°å€ï¼šhttps://github.com/Molunerfinn/PicGo/releases\n\nå®‰è£… PicGo-Setup-2.3.0-beta.7-ia32.exeï¼Œåœ¨ PicGo ä¸­æ‰“å¼€ PicGo è®¾ç½®ï¼Œæ‰¾åˆ°è®¾ç½® Serverï¼Œç‚¹å‡»è®¾ç½®ï¼Œç‚¹å‡»å¼€å¯ Serverï¼Œç‚¹å‡»ç¡®å®šå³å¯ã€‚\n\n### 2ã€é…ç½®Typora\n\næ–‡ä»¶-åå¥½è®¾ç½®-å›¾åƒ-è®¾ç½®æ’å…¥å›¾ç‰‡æ—¶ ä¸Šä¼ å›¾ç‰‡-ä¸Šä¼ æœåŠ¡é€‰æ‹© picgo.appï¼Œé€‰æ‹© picgo çš„å®‰è£…è·¯å¾„ï¼ŒéªŒè¯å›¾ç‰‡ä¸Šä¼ é€‰é¡¹\n\n### 3ã€é˜¿é‡Œäº‘OSSæ­å»ºå›¾åºŠ\n\n#### 3.1ã€å¼€é€šé˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨\n\nå¼€é€šé˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨https://www.aliyun.com/product/ossï¼Œæ³¨å†Œé˜¿é‡Œäº‘è´¦å·åï¼Œå¼€é€šå¯¹è±¡å‚¨å­˜ï¼Œè¿›å…¥å¯¹è±¡å­˜å‚¨OSSçš„æ§åˆ¶å°\n\n#### 3.2ã€åˆ›å»ºbucket\n\n- åœ¨å·¦ä¾§é€‰æ‹©æ¦‚è§ˆï¼Œç„¶ååœ¨å³ä¾§ Bucket ç®¡ç†ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„ bucket\n\n- åˆ›å»º Bucket å…·ä½“é…ç½®\n\n\t> Bucketåå­—ä¸èƒ½æœ‰å¤§å†™å­—æ¯ã€åœ°åŸŸå°±è¿‘é€‰æ‹©ã€å­˜å‚¨ç±»å‹é€‰æ‹©`æ ‡å‡†å­˜å‚¨`ï¼Œè¯»å†™æƒé™`å…¬å…±è¯»`\n\n- åˆ›å»ºæˆåŠŸåï¼Œå¯ä»¥åœ¨ Bucket åˆ—è¡¨ä¸­æŸ¥çœ‹ï¼Œè®°ä½è‡ªå·±çš„è®¿é—®åŸŸåå’Œåœ°åŸŸèŠ‚ç‚¹ï¼Œåé¢ä¼šç”¨åˆ°ã€‚\n\n#### 3.3ã€åˆ›å»ºAccessKey\n\né¡µé¢å³ä¸Šè§’ï¼Œé¼ æ ‡æ”¾åœ¨å¤´åƒå¤„ï¼Œåœ¨å¼¹å‡ºçš„æ¡†é‡Œé€‰æ‹© AccessKey ç®¡ç†ï¼Œåœ¨å¼¹å‡ºçš„é€‰é¡¹æ¡†é‡Œï¼Œé€‰æ‹©`ç»§ç»­ä½¿ç”¨AccessKey`ã€‚\n\nè¿›å…¥åï¼Œåˆ›å»ºä¸€ä¸ª`AccessKey`ã€‚\n\nåœ¨å¼¹å‡ºçš„ç•Œé¢é‡Œï¼Œè®°ä½ä½ çš„`accessKeyId`å’Œ`accessKeySecret`ã€‚\n\n#### 3.4ã€äº†è§£æ”¶è´¹æ ‡å‡†\n\nä½¿ç”¨é»˜è®¤çš„ 0.12 å…ƒ/1GB/1 ä¸ªæœˆå³å¯ã€‚\n\n### 4ã€é…ç½®PicGo\n\næˆ‘ä»¬æ‰“å¼€æ‰“å¼€ PicGo çš„ä¸»ç•Œé¢,åœ¨å›¾åºŠè®¾ç½®é‡Œé¢é€‰æ‹©é˜¿é‡Œäº‘ OSSï¼Œä¾ç…§ä¸‹é¢æ³¨æ„äº‹é¡¹å¡«å†™ä¿¡æ¯ã€‚\n\nè®¾å®š Keyldï¼šå¡«å†™æˆ‘ä»¬åœ¨ç¬¬ä¸‰æ­¥ä¸­è·å¾—çš„ AccessKeyID\n\nè®¾å®š KeySecretï¼šå¡«å†™æˆ‘ä»¬åœ¨ç¬¬ä¸‰æ­¥ä¸­è·å¾—çš„ AccessKeyIDSecret\n\nè®¾å®šå‚¨å­˜ç©ºé—´åï¼šå¡«å†™æˆ‘ä»¬åœ¨ç¬¬äºŒæ­¥ä¸­å¡«å†™çš„ bucket åç§°\n\nç¡®è®¤å­˜å‚¨åŒºåŸŸï¼šå¡«å†™æˆ‘ä»¬åœ¨ç¬¬äºŒæ­¥ä¸­æŸ¥çœ‹çš„åœ°åŸŸèŠ‚ç‚¹ï¼Œæ³¨æ„å¤åˆ¶çš„æ ¼å¼ï¼šåªéœ€è¦å¤åˆ¶ oss-cn-Xxxx å³å¯ï¼Œä¸éœ€è¦åé¢çš„.aliyuncs.com\n\n### 5ã€æµ‹è¯•ä½¿ç”¨\n\nç»è¿‡ä¸Šé¢çš„ä¸€ç³»åˆ—é…ç½®ä¹‹åï¼Œæˆ‘ä»¬å°±å®Œæˆäº† Typora çš„å›¾åºŠé…ç½®ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Markdown å¼€å§‹å†™æ–‡ç« äº†ï¼Œå›¾ç‰‡ã€æˆªå›¾ä¼šåœ¨ç²˜è´´ä¹‹åï¼Œè‡ªåŠ¨é€šè¿‡ PicGo ä¸Šä¼ åˆ°äº†è¿œç«¯å›¾åºŠã€‚åŒæ—¶ä¹Ÿå¯ä»¥æ‰‹åŠ¨å°†ä»¥å‰åœ¨æœ¬åœ°å­˜å‚¨çš„å›¾ç‰‡ä¸Šä¼ åˆ°å›¾åºŠä¸Šã€‚\n\n## å‚è€ƒ\n\nhttps://blog.csdn.net/qq_51808107/article/details/124044961\n","source":"_posts/Typoraé…ç½®é˜¿é‡Œäº‘OSSå›¾åºŠ.md","raw":"---\ntitle: Typoraé…ç½®é˜¿é‡Œäº‘OSSå›¾åºŠ\ncopyright: true\nmathjax: true\ndate: 2022-12-12 22:11:09\ncategories: æŠ€æœ¯æ€»ç»“\ntags: \nurlname: image-host\n---\n\nåœ¨æˆ‘ä»¬æ—¥å¸¸ä½¿ç”¨ Typora å†™æ–‡æ¡£æ—¶ï¼Œä¸€èˆ¬å›¾ç‰‡éƒ½æ˜¯æ”¾åœ¨æœ¬åœ°çš„ä¸€ä¸ªç›¸å¯¹è·¯å¾„ä¸‹ï¼Œå¦‚æœå°† markdown æ–‡ä»¶å‘é€ç»™åˆ«äººï¼Œé‚£ä¹ˆè¿™ä¸ªæ–‡ä»¶ä¸­çš„å›¾ç‰‡åˆ«äººè‡ªç„¶æ˜¯è®¿é—®ä¸åˆ°çš„ã€‚å›¾åºŠçš„ä½œç”¨å°±æ˜¯æŠŠå›¾ç‰‡å­˜åœ¨ç½‘ç«™ä¸Šï¼Œå¯¹åº”çš„å›¾ç‰‡ç”Ÿæˆä¸€ä¸ªé“¾æ¥ï¼Œmarkdown æ–‡ä»¶ä¸­ä½¿ç”¨è¯¥é“¾æ¥è®¿é—®å›¾ç‰‡ã€‚åœ¨æœ¬æ–‡ä¸­æˆ‘ä»¬ä½¿ç”¨ Typora + PicGo + é˜¿é‡Œäº‘ OSS å›¾åºŠå®ç°å›¾ç‰‡è‡ªåŠ¨ä¸Šä¼ å¹¶è‡ªç”±è®¿é—®ã€‚\n\n<!--more-->\n\n## ä¸‹è½½ Typora\n\n[Typoraå®˜ç½‘](https://typora.io/) å®˜ç½‘æ‹‰åˆ°æœ€ä¸‹ï¼Œç‚¹å‡» [History Releases](https://typora.io/releases/all)ï¼Œé€‰æ‹© Dev/Beta Releasesï¼Œæ‹‰åˆ°æœ€ä¸‹ More Beta,\n\né€‰æ‹©å¯¹åº”ç³»ç»Ÿçš„é“¾æ¥ [old Windows / Linux beta](https://typora.io/windows/dev_release.html)ï¼Œ[old macOS beta](https://typora.io/dev_release.html)\n\nWindows x64ï¼š[Download old version (Windows x64)](https://download.typora.io/windows/typora-update-x64-1016.exe)\n\nMac OSï¼š[Download v0.11.18](https://download.typora.io/mac/Typora-0.11.18.dmg)\n\n## å¸¸ç”¨è®¾ç½®\n\n### é€šç”¨\n\n1. æ‰“å¼€è‡ªåŠ¨ä¿å­˜\n2. å…³é—­è‡ªåŠ¨æ£€æŸ¥æ›´æ–°\n3. å…³é—­å‘é€åŒ¿åä½¿ç”¨æ•°æ®\n\n### å¤–è§‚\n\n1. è‡ªå®šä¹‰å­—ä½“\n\n2. å‹¾é€‰ä¾§è¾¹æ å¤§çº²è§†å›¾æŠ˜å å’Œå±•å¼€\n\n3. é…ç½® Next ä¸»é¢˜\n\n\t1. å®˜ç½‘ï¼šhttps://theme.typora.io/theme/NexT/\n\n\t2. ä¸‹è½½ zip å‹ç¼©åŒ…ï¼š[typora-theme-next.zip](https://github.com/BillChen2k/typora-theme-next/releases/download/1.1.1/typora-theme-next.zip)\n\n\t3. Typora å·¦ä¸Šè§’ï¼Œæ–‡ä»¶ - åå¥½è®¾ç½® - å¤–è§‚ - æ‰“å¼€ä¸»é¢˜æ–‡ä»¶å¤¹`xxx`\n\n\t4. æŠŠ typora-theme-next.zip è§£å‹ï¼Œå°†æ‰€æœ‰æ–‡ä»¶å¤åˆ¶/å‰ªåˆ‡åˆ°ä¸»é¢˜æ–‡ä»¶å¤¹`xxx`ä¸‹\n\t5. é‡å¯ Typoraï¼Œè®¾ç½®å¤–è§‚é€‰æ‹© Next å³å¯\n\t6. å¦‚æœæ„Ÿè§‰é¡µé¢å®½åº¦å¤ªå°ï¼Œå¯ä»¥æ‰“å¼€ next.cssï¼Œæœç´¢å¹¶é…ç½® max-width\n\t7. å¦‚æœæ„Ÿè§‰æ•´ä½“é¡µé¢åå°ï¼Œå¯ä»¥`Ctrl Shift +/-`å¢å¤§/å‡å°æ•´ä½“é¡µé¢\n\n### ç¼–è¾‘å™¨\n\n1. è®¾ç½®é»˜è®¤æ¢è¡Œç¬¦\n2. å–æ¶ˆæ‹¼å†™æ£€æŸ¥ï¼Œå‹¾é€‰`ä¸ä½¿ç”¨æ‹¼å†™æ£€æŸ¥`\n\n### å›¾åƒ\n\n1. æ’å…¥å›¾ç‰‡æ—¶\n\n\té€‰æ‹©ä¸Šä¼ å›¾ç‰‡ï¼Œå‹¾é€‰`å¯¹æœ¬åœ°ä½ç½®çš„å›¾ç‰‡åº”ç”¨ä¸Šè¿°è§„åˆ™`å’Œ`å¯¹ç½‘ç»œä½ç½®çš„å›¾ç‰‡åº”ç”¨ä¸Šè¿°è§„åˆ™`\n\n2. ä¸Šä¼ æœåŠ¡è®¾å®š\n\n\tæ¥ä¸‹æ¥ä¼šå…·ä½“è®²åˆ°å›¾åºŠçš„é…ç½®\n\n### Markdown\n\n1. å‹¾é€‰æ˜¾ç¤ºä»£ç å—è¡Œå·\n\n## å›¾åºŠé…ç½®\n\n### 1ã€å®‰è£…PicGo\n\nä¸‹è½½åœ°å€ï¼šhttps://github.com/Molunerfinn/PicGo/releases\n\nå®‰è£… PicGo-Setup-2.3.0-beta.7-ia32.exeï¼Œåœ¨ PicGo ä¸­æ‰“å¼€ PicGo è®¾ç½®ï¼Œæ‰¾åˆ°è®¾ç½® Serverï¼Œç‚¹å‡»è®¾ç½®ï¼Œç‚¹å‡»å¼€å¯ Serverï¼Œç‚¹å‡»ç¡®å®šå³å¯ã€‚\n\n### 2ã€é…ç½®Typora\n\næ–‡ä»¶-åå¥½è®¾ç½®-å›¾åƒ-è®¾ç½®æ’å…¥å›¾ç‰‡æ—¶ ä¸Šä¼ å›¾ç‰‡-ä¸Šä¼ æœåŠ¡é€‰æ‹© picgo.appï¼Œé€‰æ‹© picgo çš„å®‰è£…è·¯å¾„ï¼ŒéªŒè¯å›¾ç‰‡ä¸Šä¼ é€‰é¡¹\n\n### 3ã€é˜¿é‡Œäº‘OSSæ­å»ºå›¾åºŠ\n\n#### 3.1ã€å¼€é€šé˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨\n\nå¼€é€šé˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨https://www.aliyun.com/product/ossï¼Œæ³¨å†Œé˜¿é‡Œäº‘è´¦å·åï¼Œå¼€é€šå¯¹è±¡å‚¨å­˜ï¼Œè¿›å…¥å¯¹è±¡å­˜å‚¨OSSçš„æ§åˆ¶å°\n\n#### 3.2ã€åˆ›å»ºbucket\n\n- åœ¨å·¦ä¾§é€‰æ‹©æ¦‚è§ˆï¼Œç„¶ååœ¨å³ä¾§ Bucket ç®¡ç†ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„ bucket\n\n- åˆ›å»º Bucket å…·ä½“é…ç½®\n\n\t> Bucketåå­—ä¸èƒ½æœ‰å¤§å†™å­—æ¯ã€åœ°åŸŸå°±è¿‘é€‰æ‹©ã€å­˜å‚¨ç±»å‹é€‰æ‹©`æ ‡å‡†å­˜å‚¨`ï¼Œè¯»å†™æƒé™`å…¬å…±è¯»`\n\n- åˆ›å»ºæˆåŠŸåï¼Œå¯ä»¥åœ¨ Bucket åˆ—è¡¨ä¸­æŸ¥çœ‹ï¼Œè®°ä½è‡ªå·±çš„è®¿é—®åŸŸåå’Œåœ°åŸŸèŠ‚ç‚¹ï¼Œåé¢ä¼šç”¨åˆ°ã€‚\n\n#### 3.3ã€åˆ›å»ºAccessKey\n\né¡µé¢å³ä¸Šè§’ï¼Œé¼ æ ‡æ”¾åœ¨å¤´åƒå¤„ï¼Œåœ¨å¼¹å‡ºçš„æ¡†é‡Œé€‰æ‹© AccessKey ç®¡ç†ï¼Œåœ¨å¼¹å‡ºçš„é€‰é¡¹æ¡†é‡Œï¼Œé€‰æ‹©`ç»§ç»­ä½¿ç”¨AccessKey`ã€‚\n\nè¿›å…¥åï¼Œåˆ›å»ºä¸€ä¸ª`AccessKey`ã€‚\n\nåœ¨å¼¹å‡ºçš„ç•Œé¢é‡Œï¼Œè®°ä½ä½ çš„`accessKeyId`å’Œ`accessKeySecret`ã€‚\n\n#### 3.4ã€äº†è§£æ”¶è´¹æ ‡å‡†\n\nä½¿ç”¨é»˜è®¤çš„ 0.12 å…ƒ/1GB/1 ä¸ªæœˆå³å¯ã€‚\n\n### 4ã€é…ç½®PicGo\n\næˆ‘ä»¬æ‰“å¼€æ‰“å¼€ PicGo çš„ä¸»ç•Œé¢,åœ¨å›¾åºŠè®¾ç½®é‡Œé¢é€‰æ‹©é˜¿é‡Œäº‘ OSSï¼Œä¾ç…§ä¸‹é¢æ³¨æ„äº‹é¡¹å¡«å†™ä¿¡æ¯ã€‚\n\nè®¾å®š Keyldï¼šå¡«å†™æˆ‘ä»¬åœ¨ç¬¬ä¸‰æ­¥ä¸­è·å¾—çš„ AccessKeyID\n\nè®¾å®š KeySecretï¼šå¡«å†™æˆ‘ä»¬åœ¨ç¬¬ä¸‰æ­¥ä¸­è·å¾—çš„ AccessKeyIDSecret\n\nè®¾å®šå‚¨å­˜ç©ºé—´åï¼šå¡«å†™æˆ‘ä»¬åœ¨ç¬¬äºŒæ­¥ä¸­å¡«å†™çš„ bucket åç§°\n\nç¡®è®¤å­˜å‚¨åŒºåŸŸï¼šå¡«å†™æˆ‘ä»¬åœ¨ç¬¬äºŒæ­¥ä¸­æŸ¥çœ‹çš„åœ°åŸŸèŠ‚ç‚¹ï¼Œæ³¨æ„å¤åˆ¶çš„æ ¼å¼ï¼šåªéœ€è¦å¤åˆ¶ oss-cn-Xxxx å³å¯ï¼Œä¸éœ€è¦åé¢çš„.aliyuncs.com\n\n### 5ã€æµ‹è¯•ä½¿ç”¨\n\nç»è¿‡ä¸Šé¢çš„ä¸€ç³»åˆ—é…ç½®ä¹‹åï¼Œæˆ‘ä»¬å°±å®Œæˆäº† Typora çš„å›¾åºŠé…ç½®ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Markdown å¼€å§‹å†™æ–‡ç« äº†ï¼Œå›¾ç‰‡ã€æˆªå›¾ä¼šåœ¨ç²˜è´´ä¹‹åï¼Œè‡ªåŠ¨é€šè¿‡ PicGo ä¸Šä¼ åˆ°äº†è¿œç«¯å›¾åºŠã€‚åŒæ—¶ä¹Ÿå¯ä»¥æ‰‹åŠ¨å°†ä»¥å‰åœ¨æœ¬åœ°å­˜å‚¨çš„å›¾ç‰‡ä¸Šä¼ åˆ°å›¾åºŠä¸Šã€‚\n\n## å‚è€ƒ\n\nhttps://blog.csdn.net/qq_51808107/article/details/124044961\n","slug":"Typoraé…ç½®é˜¿é‡Œäº‘OSSå›¾åºŠ","published":1,"updated":"2023-01-26T12:35:58.980Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cldzfw324000ot9t8gyptfx3q","content":"<p>åœ¨æˆ‘ä»¬æ—¥å¸¸ä½¿ç”¨ Typora å†™æ–‡æ¡£æ—¶ï¼Œä¸€èˆ¬å›¾ç‰‡éƒ½æ˜¯æ”¾åœ¨æœ¬åœ°çš„ä¸€ä¸ªç›¸å¯¹è·¯å¾„ä¸‹ï¼Œå¦‚æœå°† markdown æ–‡ä»¶å‘é€ç»™åˆ«äººï¼Œé‚£ä¹ˆè¿™ä¸ªæ–‡ä»¶ä¸­çš„å›¾ç‰‡åˆ«äººè‡ªç„¶æ˜¯è®¿é—®ä¸åˆ°çš„ã€‚å›¾åºŠçš„ä½œç”¨å°±æ˜¯æŠŠå›¾ç‰‡å­˜åœ¨ç½‘ç«™ä¸Šï¼Œå¯¹åº”çš„å›¾ç‰‡ç”Ÿæˆä¸€ä¸ªé“¾æ¥ï¼Œmarkdown æ–‡ä»¶ä¸­ä½¿ç”¨è¯¥é“¾æ¥è®¿é—®å›¾ç‰‡ã€‚åœ¨æœ¬æ–‡ä¸­æˆ‘ä»¬ä½¿ç”¨ Typora + PicGo + é˜¿é‡Œäº‘ OSS å›¾åºŠå®ç°å›¾ç‰‡è‡ªåŠ¨ä¸Šä¼ å¹¶è‡ªç”±è®¿é—®ã€‚</p>\n<span id=\"more\"></span>\n\n<h2 id=\"ä¸‹è½½-Typora\"><a href=\"#ä¸‹è½½-Typora\" class=\"headerlink\" title=\"ä¸‹è½½ Typora\"></a>ä¸‹è½½ Typora</h2><p><a href=\"https://typora.io/\">Typoraå®˜ç½‘</a> å®˜ç½‘æ‹‰åˆ°æœ€ä¸‹ï¼Œç‚¹å‡» <a href=\"https://typora.io/releases/all\">History Releases</a>ï¼Œé€‰æ‹© Dev/Beta Releasesï¼Œæ‹‰åˆ°æœ€ä¸‹ More Beta,</p>\n<p>é€‰æ‹©å¯¹åº”ç³»ç»Ÿçš„é“¾æ¥ <a href=\"https://typora.io/windows/dev_release.html\">old Windows / Linux beta</a>ï¼Œ<a href=\"https://typora.io/dev_release.html\">old macOS beta</a></p>\n<p>Windows x64ï¼š<a href=\"https://download.typora.io/windows/typora-update-x64-1016.exe\">Download old version (Windows x64)</a></p>\n<p>Mac OSï¼š<a href=\"https://download.typora.io/mac/Typora-0.11.18.dmg\">Download v0.11.18</a></p>\n<h2 id=\"å¸¸ç”¨è®¾ç½®\"><a href=\"#å¸¸ç”¨è®¾ç½®\" class=\"headerlink\" title=\"å¸¸ç”¨è®¾ç½®\"></a>å¸¸ç”¨è®¾ç½®</h2><h3 id=\"é€šç”¨\"><a href=\"#é€šç”¨\" class=\"headerlink\" title=\"é€šç”¨\"></a>é€šç”¨</h3><ol>\n<li>æ‰“å¼€è‡ªåŠ¨ä¿å­˜</li>\n<li>å…³é—­è‡ªåŠ¨æ£€æŸ¥æ›´æ–°</li>\n<li>å…³é—­å‘é€åŒ¿åä½¿ç”¨æ•°æ®</li>\n</ol>\n<h3 id=\"å¤–è§‚\"><a href=\"#å¤–è§‚\" class=\"headerlink\" title=\"å¤–è§‚\"></a>å¤–è§‚</h3><ol>\n<li><p>è‡ªå®šä¹‰å­—ä½“</p>\n</li>\n<li><p>å‹¾é€‰ä¾§è¾¹æ å¤§çº²è§†å›¾æŠ˜å å’Œå±•å¼€</p>\n</li>\n<li><p>é…ç½® Next ä¸»é¢˜</p>\n<ol>\n<li><p>å®˜ç½‘ï¼š<a href=\"https://theme.typora.io/theme/NexT/\">https://theme.typora.io/theme/NexT/</a></p>\n</li>\n<li><p>ä¸‹è½½ zip å‹ç¼©åŒ…ï¼š<a href=\"https://github.com/BillChen2k/typora-theme-next/releases/download/1.1.1/typora-theme-next.zip\">typora-theme-next.zip</a></p>\n</li>\n<li><p>Typora å·¦ä¸Šè§’ï¼Œæ–‡ä»¶ - åå¥½è®¾ç½® - å¤–è§‚ - æ‰“å¼€ä¸»é¢˜æ–‡ä»¶å¤¹<code>xxx</code></p>\n</li>\n<li><p>æŠŠ typora-theme-next.zip è§£å‹ï¼Œå°†æ‰€æœ‰æ–‡ä»¶å¤åˆ¶/å‰ªåˆ‡åˆ°ä¸»é¢˜æ–‡ä»¶å¤¹<code>xxx</code>ä¸‹</p>\n</li>\n<li><p>é‡å¯ Typoraï¼Œè®¾ç½®å¤–è§‚é€‰æ‹© Next å³å¯</p>\n</li>\n<li><p>å¦‚æœæ„Ÿè§‰é¡µé¢å®½åº¦å¤ªå°ï¼Œå¯ä»¥æ‰“å¼€ next.cssï¼Œæœç´¢å¹¶é…ç½® max-width</p>\n</li>\n<li><p>å¦‚æœæ„Ÿè§‰æ•´ä½“é¡µé¢åå°ï¼Œå¯ä»¥<code>Ctrl Shift +/-</code>å¢å¤§/å‡å°æ•´ä½“é¡µé¢</p>\n</li>\n</ol>\n</li>\n</ol>\n<h3 id=\"ç¼–è¾‘å™¨\"><a href=\"#ç¼–è¾‘å™¨\" class=\"headerlink\" title=\"ç¼–è¾‘å™¨\"></a>ç¼–è¾‘å™¨</h3><ol>\n<li>è®¾ç½®é»˜è®¤æ¢è¡Œç¬¦</li>\n<li>å–æ¶ˆæ‹¼å†™æ£€æŸ¥ï¼Œå‹¾é€‰<code>ä¸ä½¿ç”¨æ‹¼å†™æ£€æŸ¥</code></li>\n</ol>\n<h3 id=\"å›¾åƒ\"><a href=\"#å›¾åƒ\" class=\"headerlink\" title=\"å›¾åƒ\"></a>å›¾åƒ</h3><ol>\n<li><p>æ’å…¥å›¾ç‰‡æ—¶</p>\n<p> é€‰æ‹©ä¸Šä¼ å›¾ç‰‡ï¼Œå‹¾é€‰<code>å¯¹æœ¬åœ°ä½ç½®çš„å›¾ç‰‡åº”ç”¨ä¸Šè¿°è§„åˆ™</code>å’Œ<code>å¯¹ç½‘ç»œä½ç½®çš„å›¾ç‰‡åº”ç”¨ä¸Šè¿°è§„åˆ™</code></p>\n</li>\n<li><p>ä¸Šä¼ æœåŠ¡è®¾å®š</p>\n<p> æ¥ä¸‹æ¥ä¼šå…·ä½“è®²åˆ°å›¾åºŠçš„é…ç½®</p>\n</li>\n</ol>\n<h3 id=\"Markdown\"><a href=\"#Markdown\" class=\"headerlink\" title=\"Markdown\"></a>Markdown</h3><ol>\n<li>å‹¾é€‰æ˜¾ç¤ºä»£ç å—è¡Œå·</li>\n</ol>\n<h2 id=\"å›¾åºŠé…ç½®\"><a href=\"#å›¾åºŠé…ç½®\" class=\"headerlink\" title=\"å›¾åºŠé…ç½®\"></a>å›¾åºŠé…ç½®</h2><h3 id=\"1ã€å®‰è£…PicGo\"><a href=\"#1ã€å®‰è£…PicGo\" class=\"headerlink\" title=\"1ã€å®‰è£…PicGo\"></a>1ã€å®‰è£…PicGo</h3><p>ä¸‹è½½åœ°å€ï¼š<a href=\"https://github.com/Molunerfinn/PicGo/releases\">https://github.com/Molunerfinn/PicGo/releases</a></p>\n<p>å®‰è£… PicGo-Setup-2.3.0-beta.7-ia32.exeï¼Œåœ¨ PicGo ä¸­æ‰“å¼€ PicGo è®¾ç½®ï¼Œæ‰¾åˆ°è®¾ç½® Serverï¼Œç‚¹å‡»è®¾ç½®ï¼Œç‚¹å‡»å¼€å¯ Serverï¼Œç‚¹å‡»ç¡®å®šå³å¯ã€‚</p>\n<h3 id=\"2ã€é…ç½®Typora\"><a href=\"#2ã€é…ç½®Typora\" class=\"headerlink\" title=\"2ã€é…ç½®Typora\"></a>2ã€é…ç½®Typora</h3><p>æ–‡ä»¶-åå¥½è®¾ç½®-å›¾åƒ-è®¾ç½®æ’å…¥å›¾ç‰‡æ—¶ ä¸Šä¼ å›¾ç‰‡-ä¸Šä¼ æœåŠ¡é€‰æ‹© picgo.appï¼Œé€‰æ‹© picgo çš„å®‰è£…è·¯å¾„ï¼ŒéªŒè¯å›¾ç‰‡ä¸Šä¼ é€‰é¡¹</p>\n<h3 id=\"3ã€é˜¿é‡Œäº‘OSSæ­å»ºå›¾åºŠ\"><a href=\"#3ã€é˜¿é‡Œäº‘OSSæ­å»ºå›¾åºŠ\" class=\"headerlink\" title=\"3ã€é˜¿é‡Œäº‘OSSæ­å»ºå›¾åºŠ\"></a>3ã€é˜¿é‡Œäº‘OSSæ­å»ºå›¾åºŠ</h3><h4 id=\"3-1ã€å¼€é€šé˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨\"><a href=\"#3-1ã€å¼€é€šé˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨\" class=\"headerlink\" title=\"3.1ã€å¼€é€šé˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨\"></a>3.1ã€å¼€é€šé˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨</h4><p>å¼€é€šé˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨<a href=\"https://www.aliyun.com/product/oss%EF%BC%8C%E6%B3%A8%E5%86%8C%E9%98%BF%E9%87%8C%E4%BA%91%E8%B4%A6%E5%8F%B7%E5%90%8E%EF%BC%8C%E5%BC%80%E9%80%9A%E5%AF%B9%E8%B1%A1%E5%82%A8%E5%AD%98%EF%BC%8C%E8%BF%9B%E5%85%A5%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8OSS%E7%9A%84%E6%8E%A7%E5%88%B6%E5%8F%B0\">https://www.aliyun.com/product/ossï¼Œæ³¨å†Œé˜¿é‡Œäº‘è´¦å·åï¼Œå¼€é€šå¯¹è±¡å‚¨å­˜ï¼Œè¿›å…¥å¯¹è±¡å­˜å‚¨OSSçš„æ§åˆ¶å°</a></p>\n<h4 id=\"3-2ã€åˆ›å»ºbucket\"><a href=\"#3-2ã€åˆ›å»ºbucket\" class=\"headerlink\" title=\"3.2ã€åˆ›å»ºbucket\"></a>3.2ã€åˆ›å»ºbucket</h4><ul>\n<li><p>åœ¨å·¦ä¾§é€‰æ‹©æ¦‚è§ˆï¼Œç„¶ååœ¨å³ä¾§ Bucket ç®¡ç†ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„ bucket</p>\n</li>\n<li><p>åˆ›å»º Bucket å…·ä½“é…ç½®</p>\n<blockquote>\n<p>Bucketåå­—ä¸èƒ½æœ‰å¤§å†™å­—æ¯ã€åœ°åŸŸå°±è¿‘é€‰æ‹©ã€å­˜å‚¨ç±»å‹é€‰æ‹©<code>æ ‡å‡†å­˜å‚¨</code>ï¼Œè¯»å†™æƒé™<code>å…¬å…±è¯»</code></p>\n</blockquote>\n</li>\n<li><p>åˆ›å»ºæˆåŠŸåï¼Œå¯ä»¥åœ¨ Bucket åˆ—è¡¨ä¸­æŸ¥çœ‹ï¼Œè®°ä½è‡ªå·±çš„è®¿é—®åŸŸåå’Œåœ°åŸŸèŠ‚ç‚¹ï¼Œåé¢ä¼šç”¨åˆ°ã€‚</p>\n</li>\n</ul>\n<h4 id=\"3-3ã€åˆ›å»ºAccessKey\"><a href=\"#3-3ã€åˆ›å»ºAccessKey\" class=\"headerlink\" title=\"3.3ã€åˆ›å»ºAccessKey\"></a>3.3ã€åˆ›å»ºAccessKey</h4><p>é¡µé¢å³ä¸Šè§’ï¼Œé¼ æ ‡æ”¾åœ¨å¤´åƒå¤„ï¼Œåœ¨å¼¹å‡ºçš„æ¡†é‡Œé€‰æ‹© AccessKey ç®¡ç†ï¼Œåœ¨å¼¹å‡ºçš„é€‰é¡¹æ¡†é‡Œï¼Œé€‰æ‹©<code>ç»§ç»­ä½¿ç”¨AccessKey</code>ã€‚</p>\n<p>è¿›å…¥åï¼Œåˆ›å»ºä¸€ä¸ª<code>AccessKey</code>ã€‚</p>\n<p>åœ¨å¼¹å‡ºçš„ç•Œé¢é‡Œï¼Œè®°ä½ä½ çš„<code>accessKeyId</code>å’Œ<code>accessKeySecret</code>ã€‚</p>\n<h4 id=\"3-4ã€äº†è§£æ”¶è´¹æ ‡å‡†\"><a href=\"#3-4ã€äº†è§£æ”¶è´¹æ ‡å‡†\" class=\"headerlink\" title=\"3.4ã€äº†è§£æ”¶è´¹æ ‡å‡†\"></a>3.4ã€äº†è§£æ”¶è´¹æ ‡å‡†</h4><p>ä½¿ç”¨é»˜è®¤çš„ 0.12 å…ƒ/1GB/1 ä¸ªæœˆå³å¯ã€‚</p>\n<h3 id=\"4ã€é…ç½®PicGo\"><a href=\"#4ã€é…ç½®PicGo\" class=\"headerlink\" title=\"4ã€é…ç½®PicGo\"></a>4ã€é…ç½®PicGo</h3><p>æˆ‘ä»¬æ‰“å¼€æ‰“å¼€ PicGo çš„ä¸»ç•Œé¢,åœ¨å›¾åºŠè®¾ç½®é‡Œé¢é€‰æ‹©é˜¿é‡Œäº‘ OSSï¼Œä¾ç…§ä¸‹é¢æ³¨æ„äº‹é¡¹å¡«å†™ä¿¡æ¯ã€‚</p>\n<p>è®¾å®š Keyldï¼šå¡«å†™æˆ‘ä»¬åœ¨ç¬¬ä¸‰æ­¥ä¸­è·å¾—çš„ AccessKeyID</p>\n<p>è®¾å®š KeySecretï¼šå¡«å†™æˆ‘ä»¬åœ¨ç¬¬ä¸‰æ­¥ä¸­è·å¾—çš„ AccessKeyIDSecret</p>\n<p>è®¾å®šå‚¨å­˜ç©ºé—´åï¼šå¡«å†™æˆ‘ä»¬åœ¨ç¬¬äºŒæ­¥ä¸­å¡«å†™çš„ bucket åç§°</p>\n<p>ç¡®è®¤å­˜å‚¨åŒºåŸŸï¼šå¡«å†™æˆ‘ä»¬åœ¨ç¬¬äºŒæ­¥ä¸­æŸ¥çœ‹çš„åœ°åŸŸèŠ‚ç‚¹ï¼Œæ³¨æ„å¤åˆ¶çš„æ ¼å¼ï¼šåªéœ€è¦å¤åˆ¶ oss-cn-Xxxx å³å¯ï¼Œä¸éœ€è¦åé¢çš„.aliyuncs.com</p>\n<h3 id=\"5ã€æµ‹è¯•ä½¿ç”¨\"><a href=\"#5ã€æµ‹è¯•ä½¿ç”¨\" class=\"headerlink\" title=\"5ã€æµ‹è¯•ä½¿ç”¨\"></a>5ã€æµ‹è¯•ä½¿ç”¨</h3><p>ç»è¿‡ä¸Šé¢çš„ä¸€ç³»åˆ—é…ç½®ä¹‹åï¼Œæˆ‘ä»¬å°±å®Œæˆäº† Typora çš„å›¾åºŠé…ç½®ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Markdown å¼€å§‹å†™æ–‡ç« äº†ï¼Œå›¾ç‰‡ã€æˆªå›¾ä¼šåœ¨ç²˜è´´ä¹‹åï¼Œè‡ªåŠ¨é€šè¿‡ PicGo ä¸Šä¼ åˆ°äº†è¿œç«¯å›¾åºŠã€‚åŒæ—¶ä¹Ÿå¯ä»¥æ‰‹åŠ¨å°†ä»¥å‰åœ¨æœ¬åœ°å­˜å‚¨çš„å›¾ç‰‡ä¸Šä¼ åˆ°å›¾åºŠä¸Šã€‚</p>\n<h2 id=\"å‚è€ƒ\"><a href=\"#å‚è€ƒ\" class=\"headerlink\" title=\"å‚è€ƒ\"></a>å‚è€ƒ</h2><p><a href=\"https://blog.csdn.net/qq_51808107/article/details/124044961\">https://blog.csdn.net/qq_51808107/article/details/124044961</a></p>\n","site":{"data":{}},"length":1802,"excerpt":"<p>åœ¨æˆ‘ä»¬æ—¥å¸¸ä½¿ç”¨ Typora å†™æ–‡æ¡£æ—¶ï¼Œä¸€èˆ¬å›¾ç‰‡éƒ½æ˜¯æ”¾åœ¨æœ¬åœ°çš„ä¸€ä¸ªç›¸å¯¹è·¯å¾„ä¸‹ï¼Œå¦‚æœå°† markdown æ–‡ä»¶å‘é€ç»™åˆ«äººï¼Œé‚£ä¹ˆè¿™ä¸ªæ–‡ä»¶ä¸­çš„å›¾ç‰‡åˆ«äººè‡ªç„¶æ˜¯è®¿é—®ä¸åˆ°çš„ã€‚å›¾åºŠçš„ä½œç”¨å°±æ˜¯æŠŠå›¾ç‰‡å­˜åœ¨ç½‘ç«™ä¸Šï¼Œå¯¹åº”çš„å›¾ç‰‡ç”Ÿæˆä¸€ä¸ªé“¾æ¥ï¼Œmarkdown æ–‡ä»¶ä¸­ä½¿ç”¨è¯¥é“¾æ¥è®¿é—®å›¾ç‰‡ã€‚åœ¨æœ¬æ–‡ä¸­æˆ‘ä»¬ä½¿ç”¨ Typora + PicGo + é˜¿é‡Œäº‘ OSS å›¾åºŠå®ç°å›¾ç‰‡è‡ªåŠ¨ä¸Šä¼ å¹¶è‡ªç”±è®¿é—®ã€‚</p>","more":"<h2 id=\"ä¸‹è½½-Typora\"><a href=\"#ä¸‹è½½-Typora\" class=\"headerlink\" title=\"ä¸‹è½½ Typora\"></a>ä¸‹è½½ Typora</h2><p><a href=\"https://typora.io/\">Typoraå®˜ç½‘</a> å®˜ç½‘æ‹‰åˆ°æœ€ä¸‹ï¼Œç‚¹å‡» <a href=\"https://typora.io/releases/all\">History Releases</a>ï¼Œé€‰æ‹© Dev/Beta Releasesï¼Œæ‹‰åˆ°æœ€ä¸‹ More Beta,</p>\n<p>é€‰æ‹©å¯¹åº”ç³»ç»Ÿçš„é“¾æ¥ <a href=\"https://typora.io/windows/dev_release.html\">old Windows / Linux beta</a>ï¼Œ<a href=\"https://typora.io/dev_release.html\">old macOS beta</a></p>\n<p>Windows x64ï¼š<a href=\"https://download.typora.io/windows/typora-update-x64-1016.exe\">Download old version (Windows x64)</a></p>\n<p>Mac OSï¼š<a href=\"https://download.typora.io/mac/Typora-0.11.18.dmg\">Download v0.11.18</a></p>\n<h2 id=\"å¸¸ç”¨è®¾ç½®\"><a href=\"#å¸¸ç”¨è®¾ç½®\" class=\"headerlink\" title=\"å¸¸ç”¨è®¾ç½®\"></a>å¸¸ç”¨è®¾ç½®</h2><h3 id=\"é€šç”¨\"><a href=\"#é€šç”¨\" class=\"headerlink\" title=\"é€šç”¨\"></a>é€šç”¨</h3><ol>\n<li>æ‰“å¼€è‡ªåŠ¨ä¿å­˜</li>\n<li>å…³é—­è‡ªåŠ¨æ£€æŸ¥æ›´æ–°</li>\n<li>å…³é—­å‘é€åŒ¿åä½¿ç”¨æ•°æ®</li>\n</ol>\n<h3 id=\"å¤–è§‚\"><a href=\"#å¤–è§‚\" class=\"headerlink\" title=\"å¤–è§‚\"></a>å¤–è§‚</h3><ol>\n<li><p>è‡ªå®šä¹‰å­—ä½“</p>\n</li>\n<li><p>å‹¾é€‰ä¾§è¾¹æ å¤§çº²è§†å›¾æŠ˜å å’Œå±•å¼€</p>\n</li>\n<li><p>é…ç½® Next ä¸»é¢˜</p>\n<ol>\n<li><p>å®˜ç½‘ï¼š<a href=\"https://theme.typora.io/theme/NexT/\">https://theme.typora.io/theme/NexT/</a></p>\n</li>\n<li><p>ä¸‹è½½ zip å‹ç¼©åŒ…ï¼š<a href=\"https://github.com/BillChen2k/typora-theme-next/releases/download/1.1.1/typora-theme-next.zip\">typora-theme-next.zip</a></p>\n</li>\n<li><p>Typora å·¦ä¸Šè§’ï¼Œæ–‡ä»¶ - åå¥½è®¾ç½® - å¤–è§‚ - æ‰“å¼€ä¸»é¢˜æ–‡ä»¶å¤¹<code>xxx</code></p>\n</li>\n<li><p>æŠŠ typora-theme-next.zip è§£å‹ï¼Œå°†æ‰€æœ‰æ–‡ä»¶å¤åˆ¶/å‰ªåˆ‡åˆ°ä¸»é¢˜æ–‡ä»¶å¤¹<code>xxx</code>ä¸‹</p>\n</li>\n<li><p>é‡å¯ Typoraï¼Œè®¾ç½®å¤–è§‚é€‰æ‹© Next å³å¯</p>\n</li>\n<li><p>å¦‚æœæ„Ÿè§‰é¡µé¢å®½åº¦å¤ªå°ï¼Œå¯ä»¥æ‰“å¼€ next.cssï¼Œæœç´¢å¹¶é…ç½® max-width</p>\n</li>\n<li><p>å¦‚æœæ„Ÿè§‰æ•´ä½“é¡µé¢åå°ï¼Œå¯ä»¥<code>Ctrl Shift +/-</code>å¢å¤§/å‡å°æ•´ä½“é¡µé¢</p>\n</li>\n</ol>\n</li>\n</ol>\n<h3 id=\"ç¼–è¾‘å™¨\"><a href=\"#ç¼–è¾‘å™¨\" class=\"headerlink\" title=\"ç¼–è¾‘å™¨\"></a>ç¼–è¾‘å™¨</h3><ol>\n<li>è®¾ç½®é»˜è®¤æ¢è¡Œç¬¦</li>\n<li>å–æ¶ˆæ‹¼å†™æ£€æŸ¥ï¼Œå‹¾é€‰<code>ä¸ä½¿ç”¨æ‹¼å†™æ£€æŸ¥</code></li>\n</ol>\n<h3 id=\"å›¾åƒ\"><a href=\"#å›¾åƒ\" class=\"headerlink\" title=\"å›¾åƒ\"></a>å›¾åƒ</h3><ol>\n<li><p>æ’å…¥å›¾ç‰‡æ—¶</p>\n<p> é€‰æ‹©ä¸Šä¼ å›¾ç‰‡ï¼Œå‹¾é€‰<code>å¯¹æœ¬åœ°ä½ç½®çš„å›¾ç‰‡åº”ç”¨ä¸Šè¿°è§„åˆ™</code>å’Œ<code>å¯¹ç½‘ç»œä½ç½®çš„å›¾ç‰‡åº”ç”¨ä¸Šè¿°è§„åˆ™</code></p>\n</li>\n<li><p>ä¸Šä¼ æœåŠ¡è®¾å®š</p>\n<p> æ¥ä¸‹æ¥ä¼šå…·ä½“è®²åˆ°å›¾åºŠçš„é…ç½®</p>\n</li>\n</ol>\n<h3 id=\"Markdown\"><a href=\"#Markdown\" class=\"headerlink\" title=\"Markdown\"></a>Markdown</h3><ol>\n<li>å‹¾é€‰æ˜¾ç¤ºä»£ç å—è¡Œå·</li>\n</ol>\n<h2 id=\"å›¾åºŠé…ç½®\"><a href=\"#å›¾åºŠé…ç½®\" class=\"headerlink\" title=\"å›¾åºŠé…ç½®\"></a>å›¾åºŠé…ç½®</h2><h3 id=\"1ã€å®‰è£…PicGo\"><a href=\"#1ã€å®‰è£…PicGo\" class=\"headerlink\" title=\"1ã€å®‰è£…PicGo\"></a>1ã€å®‰è£…PicGo</h3><p>ä¸‹è½½åœ°å€ï¼š<a href=\"https://github.com/Molunerfinn/PicGo/releases\">https://github.com/Molunerfinn/PicGo/releases</a></p>\n<p>å®‰è£… PicGo-Setup-2.3.0-beta.7-ia32.exeï¼Œåœ¨ PicGo ä¸­æ‰“å¼€ PicGo è®¾ç½®ï¼Œæ‰¾åˆ°è®¾ç½® Serverï¼Œç‚¹å‡»è®¾ç½®ï¼Œç‚¹å‡»å¼€å¯ Serverï¼Œç‚¹å‡»ç¡®å®šå³å¯ã€‚</p>\n<h3 id=\"2ã€é…ç½®Typora\"><a href=\"#2ã€é…ç½®Typora\" class=\"headerlink\" title=\"2ã€é…ç½®Typora\"></a>2ã€é…ç½®Typora</h3><p>æ–‡ä»¶-åå¥½è®¾ç½®-å›¾åƒ-è®¾ç½®æ’å…¥å›¾ç‰‡æ—¶ ä¸Šä¼ å›¾ç‰‡-ä¸Šä¼ æœåŠ¡é€‰æ‹© picgo.appï¼Œé€‰æ‹© picgo çš„å®‰è£…è·¯å¾„ï¼ŒéªŒè¯å›¾ç‰‡ä¸Šä¼ é€‰é¡¹</p>\n<h3 id=\"3ã€é˜¿é‡Œäº‘OSSæ­å»ºå›¾åºŠ\"><a href=\"#3ã€é˜¿é‡Œäº‘OSSæ­å»ºå›¾åºŠ\" class=\"headerlink\" title=\"3ã€é˜¿é‡Œäº‘OSSæ­å»ºå›¾åºŠ\"></a>3ã€é˜¿é‡Œäº‘OSSæ­å»ºå›¾åºŠ</h3><h4 id=\"3-1ã€å¼€é€šé˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨\"><a href=\"#3-1ã€å¼€é€šé˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨\" class=\"headerlink\" title=\"3.1ã€å¼€é€šé˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨\"></a>3.1ã€å¼€é€šé˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨</h4><p>å¼€é€šé˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨<a href=\"https://www.aliyun.com/product/oss%EF%BC%8C%E6%B3%A8%E5%86%8C%E9%98%BF%E9%87%8C%E4%BA%91%E8%B4%A6%E5%8F%B7%E5%90%8E%EF%BC%8C%E5%BC%80%E9%80%9A%E5%AF%B9%E8%B1%A1%E5%82%A8%E5%AD%98%EF%BC%8C%E8%BF%9B%E5%85%A5%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8OSS%E7%9A%84%E6%8E%A7%E5%88%B6%E5%8F%B0\">https://www.aliyun.com/product/ossï¼Œæ³¨å†Œé˜¿é‡Œäº‘è´¦å·åï¼Œå¼€é€šå¯¹è±¡å‚¨å­˜ï¼Œè¿›å…¥å¯¹è±¡å­˜å‚¨OSSçš„æ§åˆ¶å°</a></p>\n<h4 id=\"3-2ã€åˆ›å»ºbucket\"><a href=\"#3-2ã€åˆ›å»ºbucket\" class=\"headerlink\" title=\"3.2ã€åˆ›å»ºbucket\"></a>3.2ã€åˆ›å»ºbucket</h4><ul>\n<li><p>åœ¨å·¦ä¾§é€‰æ‹©æ¦‚è§ˆï¼Œç„¶ååœ¨å³ä¾§ Bucket ç®¡ç†ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„ bucket</p>\n</li>\n<li><p>åˆ›å»º Bucket å…·ä½“é…ç½®</p>\n<blockquote>\n<p>Bucketåå­—ä¸èƒ½æœ‰å¤§å†™å­—æ¯ã€åœ°åŸŸå°±è¿‘é€‰æ‹©ã€å­˜å‚¨ç±»å‹é€‰æ‹©<code>æ ‡å‡†å­˜å‚¨</code>ï¼Œè¯»å†™æƒé™<code>å…¬å…±è¯»</code></p>\n</blockquote>\n</li>\n<li><p>åˆ›å»ºæˆåŠŸåï¼Œå¯ä»¥åœ¨ Bucket åˆ—è¡¨ä¸­æŸ¥çœ‹ï¼Œè®°ä½è‡ªå·±çš„è®¿é—®åŸŸåå’Œåœ°åŸŸèŠ‚ç‚¹ï¼Œåé¢ä¼šç”¨åˆ°ã€‚</p>\n</li>\n</ul>\n<h4 id=\"3-3ã€åˆ›å»ºAccessKey\"><a href=\"#3-3ã€åˆ›å»ºAccessKey\" class=\"headerlink\" title=\"3.3ã€åˆ›å»ºAccessKey\"></a>3.3ã€åˆ›å»ºAccessKey</h4><p>é¡µé¢å³ä¸Šè§’ï¼Œé¼ æ ‡æ”¾åœ¨å¤´åƒå¤„ï¼Œåœ¨å¼¹å‡ºçš„æ¡†é‡Œé€‰æ‹© AccessKey ç®¡ç†ï¼Œåœ¨å¼¹å‡ºçš„é€‰é¡¹æ¡†é‡Œï¼Œé€‰æ‹©<code>ç»§ç»­ä½¿ç”¨AccessKey</code>ã€‚</p>\n<p>è¿›å…¥åï¼Œåˆ›å»ºä¸€ä¸ª<code>AccessKey</code>ã€‚</p>\n<p>åœ¨å¼¹å‡ºçš„ç•Œé¢é‡Œï¼Œè®°ä½ä½ çš„<code>accessKeyId</code>å’Œ<code>accessKeySecret</code>ã€‚</p>\n<h4 id=\"3-4ã€äº†è§£æ”¶è´¹æ ‡å‡†\"><a href=\"#3-4ã€äº†è§£æ”¶è´¹æ ‡å‡†\" class=\"headerlink\" title=\"3.4ã€äº†è§£æ”¶è´¹æ ‡å‡†\"></a>3.4ã€äº†è§£æ”¶è´¹æ ‡å‡†</h4><p>ä½¿ç”¨é»˜è®¤çš„ 0.12 å…ƒ/1GB/1 ä¸ªæœˆå³å¯ã€‚</p>\n<h3 id=\"4ã€é…ç½®PicGo\"><a href=\"#4ã€é…ç½®PicGo\" class=\"headerlink\" title=\"4ã€é…ç½®PicGo\"></a>4ã€é…ç½®PicGo</h3><p>æˆ‘ä»¬æ‰“å¼€æ‰“å¼€ PicGo çš„ä¸»ç•Œé¢,åœ¨å›¾åºŠè®¾ç½®é‡Œé¢é€‰æ‹©é˜¿é‡Œäº‘ OSSï¼Œä¾ç…§ä¸‹é¢æ³¨æ„äº‹é¡¹å¡«å†™ä¿¡æ¯ã€‚</p>\n<p>è®¾å®š Keyldï¼šå¡«å†™æˆ‘ä»¬åœ¨ç¬¬ä¸‰æ­¥ä¸­è·å¾—çš„ AccessKeyID</p>\n<p>è®¾å®š KeySecretï¼šå¡«å†™æˆ‘ä»¬åœ¨ç¬¬ä¸‰æ­¥ä¸­è·å¾—çš„ AccessKeyIDSecret</p>\n<p>è®¾å®šå‚¨å­˜ç©ºé—´åï¼šå¡«å†™æˆ‘ä»¬åœ¨ç¬¬äºŒæ­¥ä¸­å¡«å†™çš„ bucket åç§°</p>\n<p>ç¡®è®¤å­˜å‚¨åŒºåŸŸï¼šå¡«å†™æˆ‘ä»¬åœ¨ç¬¬äºŒæ­¥ä¸­æŸ¥çœ‹çš„åœ°åŸŸèŠ‚ç‚¹ï¼Œæ³¨æ„å¤åˆ¶çš„æ ¼å¼ï¼šåªéœ€è¦å¤åˆ¶ oss-cn-Xxxx å³å¯ï¼Œä¸éœ€è¦åé¢çš„.aliyuncs.com</p>\n<h3 id=\"5ã€æµ‹è¯•ä½¿ç”¨\"><a href=\"#5ã€æµ‹è¯•ä½¿ç”¨\" class=\"headerlink\" title=\"5ã€æµ‹è¯•ä½¿ç”¨\"></a>5ã€æµ‹è¯•ä½¿ç”¨</h3><p>ç»è¿‡ä¸Šé¢çš„ä¸€ç³»åˆ—é…ç½®ä¹‹åï¼Œæˆ‘ä»¬å°±å®Œæˆäº† Typora çš„å›¾åºŠé…ç½®ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Markdown å¼€å§‹å†™æ–‡ç« äº†ï¼Œå›¾ç‰‡ã€æˆªå›¾ä¼šåœ¨ç²˜è´´ä¹‹åï¼Œè‡ªåŠ¨é€šè¿‡ PicGo ä¸Šä¼ åˆ°äº†è¿œç«¯å›¾åºŠã€‚åŒæ—¶ä¹Ÿå¯ä»¥æ‰‹åŠ¨å°†ä»¥å‰åœ¨æœ¬åœ°å­˜å‚¨çš„å›¾ç‰‡ä¸Šä¼ åˆ°å›¾åºŠä¸Šã€‚</p>\n<h2 id=\"å‚è€ƒ\"><a href=\"#å‚è€ƒ\" class=\"headerlink\" title=\"å‚è€ƒ\"></a>å‚è€ƒ</h2><p><a href=\"https://blog.csdn.net/qq_51808107/article/details/124044961\">https://blog.csdn.net/qq_51808107/article/details/124044961</a></p>"},{"title":"å…³äºä½“åˆ¶å†…çš„ä¸€äº›æ€è€ƒ","copyright":true,"mathjax":false,"toc":false,"date":"2023-02-05T02:35:33.000Z","urlname":"about-within-the-system","_content":"\né¢ä¸´ç§‹æ‹›æ¯•ä¸šå­£ï¼Œè¿›ä½“åˆ¶å†…è¿˜æ˜¯ä½“åˆ¶å¤–æ— ç–‘æ˜¯æ‘†åœ¨æ¯•ä¸šç”Ÿé¢å‰çš„ä¸¤ä¸ªå¤§æ–¹å‘é€‰æ‹©ã€‚æœ¬äººç§‹æ‹›ä»¥æ¥ä¹Ÿç»å†äº†ç±»ä¼¼é€‰æ‹©ï¼Œä¹Ÿè°ˆè°ˆæˆ‘ä¸ªäººçš„ä¸€äº›æ€è€ƒã€‚<!--more-->\n\n## ä½“åˆ¶å†…/å¤–çš„å¯¹æ¯”\n\n### å·¥ä½œå•ä½\n\nä½“åˆ¶å†…ç‹­ä¹‰ä¸ŠæŒ‡å…¬åŠ¡å‘˜å’Œäº‹ä¸šç¼–ï¼Œå¹¿ä¹‰ä¸Šçš„ä½“åˆ¶å†…è¿˜åŒ…å«ä¸€äº›æ³›ä½“åˆ¶å†…çš„å•ä½ï¼Œæ¯”å¦‚çƒŸè‰ã€ç”µç½‘ã€é“¶è¡Œç­‰å›½å¤®ä¼ã€‚\n\nä½“åˆ¶å¤–å°±æ˜¯æŒ‡ç§ä¼äº†ï¼Œäº’è”ç½‘è¡Œä¸šçš„è¯æ¯”å¦‚ \"BAT\"ã€\"TMD\"ï¼Œå¤–ä¼å¦‚å¾®è½¯ã€ZOOMã€SAP ç­‰ã€‚\n\n### å·¥ä½œå†…å®¹ã€æ—¶é—´ã€å‹åŠ›\n\nä½“åˆ¶å†…çš„å·¥ä½œä¸€èˆ¬éƒ½ä¸ä¼šå¾ˆéš¾ã€‚å…¬åŠ¡å‘˜ä¸€èˆ¬æ˜¯å†™ææ–™ã€æ•´ç†ææ–™ï¼Œäº‹ä¸šç¼–æ ¹æ®å²—ä½ä¸åŒå…·ä½“å·¥ä½œå†…å®¹ä¹Ÿä¸åŒï¼Œæ¯”å¦‚æ•™å¸ˆç¼–ä¹Ÿå±äºäº‹ä¸šç¼–ï¼Œæ•™å¸ˆä¸€èˆ¬é™¤äº†æ‰¿æ‹…æ•™å­¦ä»»åŠ¡ä»¥å¤–ï¼Œè¿˜è¦è¢«å®‰æ’ä¸€äº›æ‚æ´»ï¼›åŠ ç­ä¸€èˆ¬éƒ½ä¸ä¼šå¾ˆå¤šï¼Œä¸è¿‡ç–«æƒ…æœŸé—´å¾ˆå¤šå…¬åŠ¡å‘˜æ‰¿æ‹…é˜²ç–«è§’è‰²ï¼ŒåŠ ç­æƒ…å†µååˆ†ä¸¥é‡ï¼Œç”šè‡³åŠå¤œè¢«å«é†’å»å•ä½æé˜²ç–«å·¥ä½œï¼›å·¥ä½œå‹åŠ›ä¸€èˆ¬ä¸ä¼šå¾ˆå¤§ï¼Œå°±ç®—å®Œæˆä¸äº†ä¹Ÿå¯ä»¥èººå¹³æ‘†çƒ‚ï¼Œæ¯•ç«Ÿè¾é€€ä¸€åä½“åˆ¶å†…äººå‘˜å‡ ä¹ä¸å¯èƒ½ã€‚\n\nä½“åˆ¶å¤–çš„å·¥ä½œä¸€èˆ¬è€Œè¨€éƒ½æ˜¯å’Œ OKRã€KPI ç›¸å…³ï¼Œå®Œæˆ ldã€mt æ´¾å‘çš„ä»»åŠ¡ï¼›åŠ ç­ä¸€èˆ¬æ¯”è¾ƒå¤šï¼Œèµ„æœ¬ä¸»ä¹‰å¸è¡€ï¼Œ996ã€995ã€10105ã€12126ï¼Œäº’è”ç½‘è¡Œä¸šåŠ ç­æƒ…å†µå°±æ›´ä¸¥é‡äº†ï¼›å·¥ä½œå‹åŠ›ä¸€èˆ¬è€Œè¨€æ¯”è¾ƒå¤§ï¼Œå¦‚æœéƒ¨é—¨æ•ˆç›Šä¸å¥½ï¼Œæœ‰è£å‘˜æŒ‡æ ‡ï¼Œå¾ˆå®¹æ˜“è¢«è£å‘˜ï¼Œå› æ­¤å¾—ä¸åœçš„å·ã€‚\n\n### è–ªèµ„å¾…é‡\n\nä½“åˆ¶å†…çš„è–ªèµ„å¾…é‡æ¯”è¾ƒä¸€èˆ¬ï¼Œåœ¨å½“åœ°åŸå¸‚ä¸€èˆ¬å±äºä¸­ç­‰åä¸Šçš„æ”¶å…¥ï¼Œåƒå¾—é¥±ä½†ä¹Ÿåƒä¸å¥½ã€‚å…¬åŠ¡å‘˜å·¥èµ„ä¸€èˆ¬é«˜äºäº‹ä¸šç¼–ï¼Œå¥½çš„å›½å¤®ä¼çš„è–ªèµ„å¾…é‡ä¹Ÿè¿˜ä¸é”™ã€‚è–ªèµ„å¾…é‡è¾ƒå¥½çš„åœ°åŒºæ¯”å¦‚è‹å—ã€æµ™åŒ—ä¸€äº›åŸå¸‚ã€‚ä½“åˆ¶å†…æœ€è¿‘ç«çƒ­è·Ÿæˆ¿åœ°äº§å‘å±•æ¯æ¯ç›¸å…³ï¼ŒåœŸåœ°è´¢æ”¿å¤§å¤§å¢åŠ äº†ä½“åˆ¶å†…çš„æ”¶å…¥ã€‚å¦‚ä»Šæˆ¿åœ°äº§ä¸šèé¡çš„æƒ…å†µä¸‹ï¼Œä½“åˆ¶å†…é™è–ªé¢‘ç¹ï¼Œæœªæ¥ä½“åˆ¶å†…çš„è–ªèµ„å¾…é‡è¿˜ä¼šæ€æ ·ï¼Œæˆ‘ä»¬ä¸å¾—è€ŒçŸ¥ã€‚\n\nä½“åˆ¶å¤–çš„è–ªèµ„å¾…é‡æ— éå°±æ˜¯çœ‹ä¸ªäººèƒ½åŠ›å’Œä¸ªäººæœºé‡äº†ï¼Œè®¡ç®—æœºåº”å±Šç”Ÿè¿›å…¥äº’è”ç½‘å¤§å‚è–ªèµ„å¥½ç‚¹çš„éƒ½æœ‰35+wå¹´è–ªï¼Œä¸€èˆ¬çš„ä¹Ÿèƒ½æ‹¿åˆ°20+wï¼Œåœ¨ç§ä¼å¹²å‡ å¹´è·³æ§½è¿˜èƒ½æ”¶è·ä¸é”™çš„è–ªèµ„æ¶¨å¹…ã€‚è™½ç„¶äº’è”ç½‘å‘å±•åœæ»ï¼Œä½†æ˜¯æœªæ¥ä»ç„¶æœ‰å¤§é‡çš„æ•°å­—åŒ–äººæ‰éœ€æ±‚ã€‚\n\n## é€‰æ‹©ä½“åˆ¶å†…è¿˜æ˜¯ä½“åˆ¶å¤–\n\nè¿‘å¹´æ¥ï¼Œç”±äºå…¨çƒç»æµå‘å±•åœæ»ã€è¡Œä¸šå‘¨æœŸã€ç–«æƒ…ç­‰å„ç§åŸå› ï¼Œå¾ˆå¤šäººåœ¨ç§ä¼å†…æ··çš„ä¸æ˜¯å¾ˆå¦‚æ„ï¼Œpuaã€å‹è¿«ã€è£å‘˜ã€‚è¿‘å‡ å¹´ä½“åˆ¶å†…çš„è–ªèµ„ä¹Ÿå¢åŠ å¾ˆå¤šï¼Œ20 å¹´çš„æ·±åœ³é«˜ä¸­ 40w æ‹›é«˜ä¸­è€å¸ˆã€ä½™æ­åŒºè¡—é“åŠåŠäº‹å‘˜å½•å–çš„å­¦ç”Ÿéƒ½æ˜¯æ¸…åŒ—ç­‰é¡¶å°–é«˜æ ¡çš„ç¡•å£«ç”Ÿç”šè‡³åšå£«ç”Ÿã€‚æ¸…åçš„æ¯•ä¸šç”Ÿå°±ä¸šå»å‘ä¹Ÿæ˜¾ç¤º 70% çš„å­¦ç”Ÿè¿›å…¥äº†ä½“åˆ¶å†…ã€‚\n\né‚£ä¹ˆï¼Œä½“åˆ¶å†…çœŸçš„å°±æ— æ•Œå˜›ï¼Œå®‡å®™çš„å°½å¤´çœŸçš„æ˜¯ä½“åˆ¶å†…å˜›ï¼Œè¿˜æ˜¯é€‰æ‹©ä½“åˆ¶å¤–æ‰“æ‹¼æ‰“æ‹¼é—¯å‡ºè‡ªå·±çš„ä¸€ç‰‡å¤©å‘¢ï¼Ÿ\n\nåº”å±Šç”Ÿåœ¨å°±ä¸šé€‰æ‹©æ—¶ä¸€èˆ¬éƒ½ä¼šè·Ÿå®¶é‡Œäººå•†é‡ï¼Œå¬å¬çˆ¶æ¯çš„çœ‹æ³•ã€‚äºçˆ¶æ¯è€Œè¨€ï¼Œçˆ¶æ¯ä¸€èˆ¬éƒ½æ¯”è¾ƒæƒ³è®©å­©å­è¿›å…¥ä½“åˆ¶å†…ï¼Œæˆ‘ä»¬ä½œä¸ºå­å¥³åº”å½“å°Šé‡çˆ¶æ¯ï¼Œä½†æ˜¯ä¸æ˜¯å®Œå…¨å¬ä»çˆ¶æ¯ï¼Œå› ä¸ºä»–ä»¬æ˜¯é‚£ä¸ªæ—¶ä»£çš„é‚£äº›ç»éªŒï¼Œåœ¨å½“ä»Šè¿™ä¸ªæ—¶ä»£ï¼Œè¦æœ‰è‡ªå·±çš„æ€æƒ³ã€‚æŠŠè‡ªå·±çš„ç”Ÿå‘½è¿‡å¥½äº†ï¼Œè¿‡å‡ºç²¾å½©æ¥ï¼Œæ‰æ˜¯å¯¹çˆ¶æ¯æœ€å¤§çš„å°Šé‡ï¼Œä¹Ÿæ˜¯çˆ¶æ¯æœ€å¤§çš„å¹¸ç¦ã€‚\n\nå¾ˆå¤šäººæ¯•ä¸šæ—¶ä¸çŸ¥é“é€‰æ‹©ä»€ä¹ˆï¼Œç›²ç›®ä»ä¼—ï¼Œéšå¤§æµè¿›å…¥ä½“åˆ¶å†…ï¼Œè¿›å»ä¹‹åè§‰å¾—ä¸æ˜¯è‡ªå·±æƒ³è¦çš„ã€‚è¿™ç§æƒ…å†µæ— éæ˜¯æ— æ³•åœ¨ä½“åˆ¶å†…è·å¾—è‡ªå·±æƒ³è¦å–å¾—çš„ä»·å€¼æ„Ÿã€æˆå°±æ„Ÿã€‚æŠ•å…¥è¿‡çš„ç”Ÿå‘½æ‰ä¼šæœ‰æ¸©åº¦ï¼Œä¸ç®¡æ˜¯ä½“åˆ¶å†…è¿˜æ˜¯ä½“åˆ¶å¤–ï¼Œè¿™æ ·æ‰ä¼šè·å¾—å·¨å¤§çš„ä»·å€¼æ„Ÿã€‚\n\næˆ‘ä»¬çš„ç¤¾ä¼šã€ç”Ÿæ´»ä¸€ç›´åœ¨å‘å±•å˜åŒ–ï¼Œè¿™ä¸ªæ‰æ˜¯ä¸€ç›´ä¸å˜çš„ã€‚åšé€‰æ‹©ä¸€å®šè¦çœ‹æ¸…æ¥šè‡ªå·±æƒ³è¦ä»€ä¹ˆï¼Œå¯ä»¥æƒ³æƒ³è‡ªå·±æ­»å»çš„æ—¶å€™ï¼Œé‚£æ—¶å€™æ˜¯ä¸€ä¸ªä»€ä¹ˆæ ·çš„èº«ä»½ã€ä»€ä¹ˆæ ·çš„èŒä½ï¼Œå› ä¸ºè¿™å…¶å®å°±æ˜¯æˆ‘ä»¬å¿ƒåº•çš„è¿½æ±‚ï¼Œæ˜ç¡®è‡ªå·±çš„è¿½æ±‚ï¼Œä½“åˆ¶å†…è¿˜æ˜¯ä½“åˆ¶å¤–ï¼Œå¾€è‡ªå·±çš„è¿½æ±‚ä¸Šé è¿‘å°±å¯ä»¥äº†ã€‚ä½“åˆ¶å†…è¿˜æ˜¯ä½“åˆ¶å¤–æ²¡æœ‰å¯¹é”™ï¼Œåªæœ‰é€‚åˆï¼Œé€‚åˆè‡ªå·±ã€é€‚åˆè‡ªå·±çš„æœªæ¥å‘å±•ã€é€‚åˆè‡ªå·±çš„äººç”Ÿè¿½æ±‚ã€‚\n\n## å‚è€ƒ\n\nä»¥ä¸‹æ˜¯ä¸€äº›æˆ‘è§‰å¾—è®²çš„å¾ˆåœ¨ç†çš„è§†é¢‘ï¼ŒéåŠé€€æ€§è´¨ï¼Œçœ‹å®Œä¹‹åæ„Ÿæ‚Ÿå¾ˆå¤šã€‚\n\n[ä¸é€‚åˆå°±åˆ«è€ƒå…¬åŠ¡å‘˜äº†](https://www.bilibili.com/video/BV1JT41117Lx/?share_source=copy_web&vd_source=0ee37b99b6275b36190f1dd4aff8f80a)\n\n[â€œåˆ«çæ··äº†ï¼Œå…¬åŠ¡å‘˜æ‰æ˜¯æ­£ç»å·¥ä½œâ€è¿›ä½“åˆ¶çœŸçš„é¦™å—ï¼Ÿã€å¤æ—¦æ¢æ°¸å®‰ã€‘](https://www.bilibili.com/video/BV1Ga4y1p7Tw/?share_source=copy_web&vd_source=0ee37b99b6275b36190f1dd4aff8f80a)\n\n[60ä¸‡å¹´è–ªæ¯”ä¸ä¸Šå…¬åŠ¡å‘˜æœˆè–ª4000ï¼ŸåŒå¿—ä»¬ï¼Œåƒä¸‡åˆ«å†é«˜ä¼°â€œä½“åˆ¶å†…â€çš„æ€§ä»·æ¯”äº†ï¼ã€æ¯¯å”ç›˜é’±ã€‘](https://www.bilibili.com/video/BV1RS4y1d7R9/?share_source=copy_web&vd_source=0ee37b99b6275b36190f1dd4aff8f80a)\n\n[ã€è€ƒç¼–ï¼Ÿçœ‹è¿™ä¸€æ¡å°±å¤Ÿäº†ã€‘8å¹´ï¼ï¼å®‡å®™å°½å¤´çœŸä¸æ˜¯ç¼–åˆ¶ï¼ï¼](https://www.bilibili.com/video/BV1CM4y1F7PN/?share_source=copy_web&vd_source=0ee37b99b6275b36190f1dd4aff8f80a)\n\n[537ä¸‡äººè€ƒå…¬ï¼Œ500ä¸‡äººå¤±ä¸šï¼Œå®‡å®™çš„å°½å¤´æ˜¯è€ƒç¼–å—ï¼Ÿ](https://www.bilibili.com/video/BV1VY4y1A7XM/?share_source=copy_web&vd_source=0ee37b99b6275b36190f1dd4aff8f80a) \n","source":"_posts/å…³äºä½“åˆ¶å†…çš„ä¸€äº›æ€è€ƒ.md","raw":"---\ntitle: å…³äºä½“åˆ¶å†…çš„ä¸€äº›æ€è€ƒ\ncopyright: true\nmathjax: false\ncategories:\n  - ä¸ªäººæ€è€ƒ\ntoc: false\ndate: 2023-02-05 10:35:33\ntags:\nurlname: about-within-the-system\n---\n\né¢ä¸´ç§‹æ‹›æ¯•ä¸šå­£ï¼Œè¿›ä½“åˆ¶å†…è¿˜æ˜¯ä½“åˆ¶å¤–æ— ç–‘æ˜¯æ‘†åœ¨æ¯•ä¸šç”Ÿé¢å‰çš„ä¸¤ä¸ªå¤§æ–¹å‘é€‰æ‹©ã€‚æœ¬äººç§‹æ‹›ä»¥æ¥ä¹Ÿç»å†äº†ç±»ä¼¼é€‰æ‹©ï¼Œä¹Ÿè°ˆè°ˆæˆ‘ä¸ªäººçš„ä¸€äº›æ€è€ƒã€‚<!--more-->\n\n## ä½“åˆ¶å†…/å¤–çš„å¯¹æ¯”\n\n### å·¥ä½œå•ä½\n\nä½“åˆ¶å†…ç‹­ä¹‰ä¸ŠæŒ‡å…¬åŠ¡å‘˜å’Œäº‹ä¸šç¼–ï¼Œå¹¿ä¹‰ä¸Šçš„ä½“åˆ¶å†…è¿˜åŒ…å«ä¸€äº›æ³›ä½“åˆ¶å†…çš„å•ä½ï¼Œæ¯”å¦‚çƒŸè‰ã€ç”µç½‘ã€é“¶è¡Œç­‰å›½å¤®ä¼ã€‚\n\nä½“åˆ¶å¤–å°±æ˜¯æŒ‡ç§ä¼äº†ï¼Œäº’è”ç½‘è¡Œä¸šçš„è¯æ¯”å¦‚ \"BAT\"ã€\"TMD\"ï¼Œå¤–ä¼å¦‚å¾®è½¯ã€ZOOMã€SAP ç­‰ã€‚\n\n### å·¥ä½œå†…å®¹ã€æ—¶é—´ã€å‹åŠ›\n\nä½“åˆ¶å†…çš„å·¥ä½œä¸€èˆ¬éƒ½ä¸ä¼šå¾ˆéš¾ã€‚å…¬åŠ¡å‘˜ä¸€èˆ¬æ˜¯å†™ææ–™ã€æ•´ç†ææ–™ï¼Œäº‹ä¸šç¼–æ ¹æ®å²—ä½ä¸åŒå…·ä½“å·¥ä½œå†…å®¹ä¹Ÿä¸åŒï¼Œæ¯”å¦‚æ•™å¸ˆç¼–ä¹Ÿå±äºäº‹ä¸šç¼–ï¼Œæ•™å¸ˆä¸€èˆ¬é™¤äº†æ‰¿æ‹…æ•™å­¦ä»»åŠ¡ä»¥å¤–ï¼Œè¿˜è¦è¢«å®‰æ’ä¸€äº›æ‚æ´»ï¼›åŠ ç­ä¸€èˆ¬éƒ½ä¸ä¼šå¾ˆå¤šï¼Œä¸è¿‡ç–«æƒ…æœŸé—´å¾ˆå¤šå…¬åŠ¡å‘˜æ‰¿æ‹…é˜²ç–«è§’è‰²ï¼ŒåŠ ç­æƒ…å†µååˆ†ä¸¥é‡ï¼Œç”šè‡³åŠå¤œè¢«å«é†’å»å•ä½æé˜²ç–«å·¥ä½œï¼›å·¥ä½œå‹åŠ›ä¸€èˆ¬ä¸ä¼šå¾ˆå¤§ï¼Œå°±ç®—å®Œæˆä¸äº†ä¹Ÿå¯ä»¥èººå¹³æ‘†çƒ‚ï¼Œæ¯•ç«Ÿè¾é€€ä¸€åä½“åˆ¶å†…äººå‘˜å‡ ä¹ä¸å¯èƒ½ã€‚\n\nä½“åˆ¶å¤–çš„å·¥ä½œä¸€èˆ¬è€Œè¨€éƒ½æ˜¯å’Œ OKRã€KPI ç›¸å…³ï¼Œå®Œæˆ ldã€mt æ´¾å‘çš„ä»»åŠ¡ï¼›åŠ ç­ä¸€èˆ¬æ¯”è¾ƒå¤šï¼Œèµ„æœ¬ä¸»ä¹‰å¸è¡€ï¼Œ996ã€995ã€10105ã€12126ï¼Œäº’è”ç½‘è¡Œä¸šåŠ ç­æƒ…å†µå°±æ›´ä¸¥é‡äº†ï¼›å·¥ä½œå‹åŠ›ä¸€èˆ¬è€Œè¨€æ¯”è¾ƒå¤§ï¼Œå¦‚æœéƒ¨é—¨æ•ˆç›Šä¸å¥½ï¼Œæœ‰è£å‘˜æŒ‡æ ‡ï¼Œå¾ˆå®¹æ˜“è¢«è£å‘˜ï¼Œå› æ­¤å¾—ä¸åœçš„å·ã€‚\n\n### è–ªèµ„å¾…é‡\n\nä½“åˆ¶å†…çš„è–ªèµ„å¾…é‡æ¯”è¾ƒä¸€èˆ¬ï¼Œåœ¨å½“åœ°åŸå¸‚ä¸€èˆ¬å±äºä¸­ç­‰åä¸Šçš„æ”¶å…¥ï¼Œåƒå¾—é¥±ä½†ä¹Ÿåƒä¸å¥½ã€‚å…¬åŠ¡å‘˜å·¥èµ„ä¸€èˆ¬é«˜äºäº‹ä¸šç¼–ï¼Œå¥½çš„å›½å¤®ä¼çš„è–ªèµ„å¾…é‡ä¹Ÿè¿˜ä¸é”™ã€‚è–ªèµ„å¾…é‡è¾ƒå¥½çš„åœ°åŒºæ¯”å¦‚è‹å—ã€æµ™åŒ—ä¸€äº›åŸå¸‚ã€‚ä½“åˆ¶å†…æœ€è¿‘ç«çƒ­è·Ÿæˆ¿åœ°äº§å‘å±•æ¯æ¯ç›¸å…³ï¼ŒåœŸåœ°è´¢æ”¿å¤§å¤§å¢åŠ äº†ä½“åˆ¶å†…çš„æ”¶å…¥ã€‚å¦‚ä»Šæˆ¿åœ°äº§ä¸šèé¡çš„æƒ…å†µä¸‹ï¼Œä½“åˆ¶å†…é™è–ªé¢‘ç¹ï¼Œæœªæ¥ä½“åˆ¶å†…çš„è–ªèµ„å¾…é‡è¿˜ä¼šæ€æ ·ï¼Œæˆ‘ä»¬ä¸å¾—è€ŒçŸ¥ã€‚\n\nä½“åˆ¶å¤–çš„è–ªèµ„å¾…é‡æ— éå°±æ˜¯çœ‹ä¸ªäººèƒ½åŠ›å’Œä¸ªäººæœºé‡äº†ï¼Œè®¡ç®—æœºåº”å±Šç”Ÿè¿›å…¥äº’è”ç½‘å¤§å‚è–ªèµ„å¥½ç‚¹çš„éƒ½æœ‰35+wå¹´è–ªï¼Œä¸€èˆ¬çš„ä¹Ÿèƒ½æ‹¿åˆ°20+wï¼Œåœ¨ç§ä¼å¹²å‡ å¹´è·³æ§½è¿˜èƒ½æ”¶è·ä¸é”™çš„è–ªèµ„æ¶¨å¹…ã€‚è™½ç„¶äº’è”ç½‘å‘å±•åœæ»ï¼Œä½†æ˜¯æœªæ¥ä»ç„¶æœ‰å¤§é‡çš„æ•°å­—åŒ–äººæ‰éœ€æ±‚ã€‚\n\n## é€‰æ‹©ä½“åˆ¶å†…è¿˜æ˜¯ä½“åˆ¶å¤–\n\nè¿‘å¹´æ¥ï¼Œç”±äºå…¨çƒç»æµå‘å±•åœæ»ã€è¡Œä¸šå‘¨æœŸã€ç–«æƒ…ç­‰å„ç§åŸå› ï¼Œå¾ˆå¤šäººåœ¨ç§ä¼å†…æ··çš„ä¸æ˜¯å¾ˆå¦‚æ„ï¼Œpuaã€å‹è¿«ã€è£å‘˜ã€‚è¿‘å‡ å¹´ä½“åˆ¶å†…çš„è–ªèµ„ä¹Ÿå¢åŠ å¾ˆå¤šï¼Œ20 å¹´çš„æ·±åœ³é«˜ä¸­ 40w æ‹›é«˜ä¸­è€å¸ˆã€ä½™æ­åŒºè¡—é“åŠåŠäº‹å‘˜å½•å–çš„å­¦ç”Ÿéƒ½æ˜¯æ¸…åŒ—ç­‰é¡¶å°–é«˜æ ¡çš„ç¡•å£«ç”Ÿç”šè‡³åšå£«ç”Ÿã€‚æ¸…åçš„æ¯•ä¸šç”Ÿå°±ä¸šå»å‘ä¹Ÿæ˜¾ç¤º 70% çš„å­¦ç”Ÿè¿›å…¥äº†ä½“åˆ¶å†…ã€‚\n\né‚£ä¹ˆï¼Œä½“åˆ¶å†…çœŸçš„å°±æ— æ•Œå˜›ï¼Œå®‡å®™çš„å°½å¤´çœŸçš„æ˜¯ä½“åˆ¶å†…å˜›ï¼Œè¿˜æ˜¯é€‰æ‹©ä½“åˆ¶å¤–æ‰“æ‹¼æ‰“æ‹¼é—¯å‡ºè‡ªå·±çš„ä¸€ç‰‡å¤©å‘¢ï¼Ÿ\n\nåº”å±Šç”Ÿåœ¨å°±ä¸šé€‰æ‹©æ—¶ä¸€èˆ¬éƒ½ä¼šè·Ÿå®¶é‡Œäººå•†é‡ï¼Œå¬å¬çˆ¶æ¯çš„çœ‹æ³•ã€‚äºçˆ¶æ¯è€Œè¨€ï¼Œçˆ¶æ¯ä¸€èˆ¬éƒ½æ¯”è¾ƒæƒ³è®©å­©å­è¿›å…¥ä½“åˆ¶å†…ï¼Œæˆ‘ä»¬ä½œä¸ºå­å¥³åº”å½“å°Šé‡çˆ¶æ¯ï¼Œä½†æ˜¯ä¸æ˜¯å®Œå…¨å¬ä»çˆ¶æ¯ï¼Œå› ä¸ºä»–ä»¬æ˜¯é‚£ä¸ªæ—¶ä»£çš„é‚£äº›ç»éªŒï¼Œåœ¨å½“ä»Šè¿™ä¸ªæ—¶ä»£ï¼Œè¦æœ‰è‡ªå·±çš„æ€æƒ³ã€‚æŠŠè‡ªå·±çš„ç”Ÿå‘½è¿‡å¥½äº†ï¼Œè¿‡å‡ºç²¾å½©æ¥ï¼Œæ‰æ˜¯å¯¹çˆ¶æ¯æœ€å¤§çš„å°Šé‡ï¼Œä¹Ÿæ˜¯çˆ¶æ¯æœ€å¤§çš„å¹¸ç¦ã€‚\n\nå¾ˆå¤šäººæ¯•ä¸šæ—¶ä¸çŸ¥é“é€‰æ‹©ä»€ä¹ˆï¼Œç›²ç›®ä»ä¼—ï¼Œéšå¤§æµè¿›å…¥ä½“åˆ¶å†…ï¼Œè¿›å»ä¹‹åè§‰å¾—ä¸æ˜¯è‡ªå·±æƒ³è¦çš„ã€‚è¿™ç§æƒ…å†µæ— éæ˜¯æ— æ³•åœ¨ä½“åˆ¶å†…è·å¾—è‡ªå·±æƒ³è¦å–å¾—çš„ä»·å€¼æ„Ÿã€æˆå°±æ„Ÿã€‚æŠ•å…¥è¿‡çš„ç”Ÿå‘½æ‰ä¼šæœ‰æ¸©åº¦ï¼Œä¸ç®¡æ˜¯ä½“åˆ¶å†…è¿˜æ˜¯ä½“åˆ¶å¤–ï¼Œè¿™æ ·æ‰ä¼šè·å¾—å·¨å¤§çš„ä»·å€¼æ„Ÿã€‚\n\næˆ‘ä»¬çš„ç¤¾ä¼šã€ç”Ÿæ´»ä¸€ç›´åœ¨å‘å±•å˜åŒ–ï¼Œè¿™ä¸ªæ‰æ˜¯ä¸€ç›´ä¸å˜çš„ã€‚åšé€‰æ‹©ä¸€å®šè¦çœ‹æ¸…æ¥šè‡ªå·±æƒ³è¦ä»€ä¹ˆï¼Œå¯ä»¥æƒ³æƒ³è‡ªå·±æ­»å»çš„æ—¶å€™ï¼Œé‚£æ—¶å€™æ˜¯ä¸€ä¸ªä»€ä¹ˆæ ·çš„èº«ä»½ã€ä»€ä¹ˆæ ·çš„èŒä½ï¼Œå› ä¸ºè¿™å…¶å®å°±æ˜¯æˆ‘ä»¬å¿ƒåº•çš„è¿½æ±‚ï¼Œæ˜ç¡®è‡ªå·±çš„è¿½æ±‚ï¼Œä½“åˆ¶å†…è¿˜æ˜¯ä½“åˆ¶å¤–ï¼Œå¾€è‡ªå·±çš„è¿½æ±‚ä¸Šé è¿‘å°±å¯ä»¥äº†ã€‚ä½“åˆ¶å†…è¿˜æ˜¯ä½“åˆ¶å¤–æ²¡æœ‰å¯¹é”™ï¼Œåªæœ‰é€‚åˆï¼Œé€‚åˆè‡ªå·±ã€é€‚åˆè‡ªå·±çš„æœªæ¥å‘å±•ã€é€‚åˆè‡ªå·±çš„äººç”Ÿè¿½æ±‚ã€‚\n\n## å‚è€ƒ\n\nä»¥ä¸‹æ˜¯ä¸€äº›æˆ‘è§‰å¾—è®²çš„å¾ˆåœ¨ç†çš„è§†é¢‘ï¼ŒéåŠé€€æ€§è´¨ï¼Œçœ‹å®Œä¹‹åæ„Ÿæ‚Ÿå¾ˆå¤šã€‚\n\n[ä¸é€‚åˆå°±åˆ«è€ƒå…¬åŠ¡å‘˜äº†](https://www.bilibili.com/video/BV1JT41117Lx/?share_source=copy_web&vd_source=0ee37b99b6275b36190f1dd4aff8f80a)\n\n[â€œåˆ«çæ··äº†ï¼Œå…¬åŠ¡å‘˜æ‰æ˜¯æ­£ç»å·¥ä½œâ€è¿›ä½“åˆ¶çœŸçš„é¦™å—ï¼Ÿã€å¤æ—¦æ¢æ°¸å®‰ã€‘](https://www.bilibili.com/video/BV1Ga4y1p7Tw/?share_source=copy_web&vd_source=0ee37b99b6275b36190f1dd4aff8f80a)\n\n[60ä¸‡å¹´è–ªæ¯”ä¸ä¸Šå…¬åŠ¡å‘˜æœˆè–ª4000ï¼ŸåŒå¿—ä»¬ï¼Œåƒä¸‡åˆ«å†é«˜ä¼°â€œä½“åˆ¶å†…â€çš„æ€§ä»·æ¯”äº†ï¼ã€æ¯¯å”ç›˜é’±ã€‘](https://www.bilibili.com/video/BV1RS4y1d7R9/?share_source=copy_web&vd_source=0ee37b99b6275b36190f1dd4aff8f80a)\n\n[ã€è€ƒç¼–ï¼Ÿçœ‹è¿™ä¸€æ¡å°±å¤Ÿäº†ã€‘8å¹´ï¼ï¼å®‡å®™å°½å¤´çœŸä¸æ˜¯ç¼–åˆ¶ï¼ï¼](https://www.bilibili.com/video/BV1CM4y1F7PN/?share_source=copy_web&vd_source=0ee37b99b6275b36190f1dd4aff8f80a)\n\n[537ä¸‡äººè€ƒå…¬ï¼Œ500ä¸‡äººå¤±ä¸šï¼Œå®‡å®™çš„å°½å¤´æ˜¯è€ƒç¼–å—ï¼Ÿ](https://www.bilibili.com/video/BV1VY4y1A7XM/?share_source=copy_web&vd_source=0ee37b99b6275b36190f1dd4aff8f80a) \n","slug":"å…³äºä½“åˆ¶å†…çš„ä¸€äº›æ€è€ƒ","published":1,"updated":"2023-02-08T07:13:07.642Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cldzfw325000qt9t8fhuraug6","content":"<p>é¢ä¸´ç§‹æ‹›æ¯•ä¸šå­£ï¼Œè¿›ä½“åˆ¶å†…è¿˜æ˜¯ä½“åˆ¶å¤–æ— ç–‘æ˜¯æ‘†åœ¨æ¯•ä¸šç”Ÿé¢å‰çš„ä¸¤ä¸ªå¤§æ–¹å‘é€‰æ‹©ã€‚æœ¬äººç§‹æ‹›ä»¥æ¥ä¹Ÿç»å†äº†ç±»ä¼¼é€‰æ‹©ï¼Œä¹Ÿè°ˆè°ˆæˆ‘ä¸ªäººçš„ä¸€äº›æ€è€ƒã€‚<span id=\"more\"></span></p>\n<h2 id=\"ä½“åˆ¶å†…-x2F-å¤–çš„å¯¹æ¯”\"><a href=\"#ä½“åˆ¶å†…-x2F-å¤–çš„å¯¹æ¯”\" class=\"headerlink\" title=\"ä½“åˆ¶å†…&#x2F;å¤–çš„å¯¹æ¯”\"></a>ä½“åˆ¶å†…&#x2F;å¤–çš„å¯¹æ¯”</h2><h3 id=\"å·¥ä½œå•ä½\"><a href=\"#å·¥ä½œå•ä½\" class=\"headerlink\" title=\"å·¥ä½œå•ä½\"></a>å·¥ä½œå•ä½</h3><p>ä½“åˆ¶å†…ç‹­ä¹‰ä¸ŠæŒ‡å…¬åŠ¡å‘˜å’Œäº‹ä¸šç¼–ï¼Œå¹¿ä¹‰ä¸Šçš„ä½“åˆ¶å†…è¿˜åŒ…å«ä¸€äº›æ³›ä½“åˆ¶å†…çš„å•ä½ï¼Œæ¯”å¦‚çƒŸè‰ã€ç”µç½‘ã€é“¶è¡Œç­‰å›½å¤®ä¼ã€‚</p>\n<p>ä½“åˆ¶å¤–å°±æ˜¯æŒ‡ç§ä¼äº†ï¼Œäº’è”ç½‘è¡Œä¸šçš„è¯æ¯”å¦‚ â€œBATâ€ã€â€TMDâ€ï¼Œå¤–ä¼å¦‚å¾®è½¯ã€ZOOMã€SAP ç­‰ã€‚</p>\n<h3 id=\"å·¥ä½œå†…å®¹ã€æ—¶é—´ã€å‹åŠ›\"><a href=\"#å·¥ä½œå†…å®¹ã€æ—¶é—´ã€å‹åŠ›\" class=\"headerlink\" title=\"å·¥ä½œå†…å®¹ã€æ—¶é—´ã€å‹åŠ›\"></a>å·¥ä½œå†…å®¹ã€æ—¶é—´ã€å‹åŠ›</h3><p>ä½“åˆ¶å†…çš„å·¥ä½œä¸€èˆ¬éƒ½ä¸ä¼šå¾ˆéš¾ã€‚å…¬åŠ¡å‘˜ä¸€èˆ¬æ˜¯å†™ææ–™ã€æ•´ç†ææ–™ï¼Œäº‹ä¸šç¼–æ ¹æ®å²—ä½ä¸åŒå…·ä½“å·¥ä½œå†…å®¹ä¹Ÿä¸åŒï¼Œæ¯”å¦‚æ•™å¸ˆç¼–ä¹Ÿå±äºäº‹ä¸šç¼–ï¼Œæ•™å¸ˆä¸€èˆ¬é™¤äº†æ‰¿æ‹…æ•™å­¦ä»»åŠ¡ä»¥å¤–ï¼Œè¿˜è¦è¢«å®‰æ’ä¸€äº›æ‚æ´»ï¼›åŠ ç­ä¸€èˆ¬éƒ½ä¸ä¼šå¾ˆå¤šï¼Œä¸è¿‡ç–«æƒ…æœŸé—´å¾ˆå¤šå…¬åŠ¡å‘˜æ‰¿æ‹…é˜²ç–«è§’è‰²ï¼ŒåŠ ç­æƒ…å†µååˆ†ä¸¥é‡ï¼Œç”šè‡³åŠå¤œè¢«å«é†’å»å•ä½æé˜²ç–«å·¥ä½œï¼›å·¥ä½œå‹åŠ›ä¸€èˆ¬ä¸ä¼šå¾ˆå¤§ï¼Œå°±ç®—å®Œæˆä¸äº†ä¹Ÿå¯ä»¥èººå¹³æ‘†çƒ‚ï¼Œæ¯•ç«Ÿè¾é€€ä¸€åä½“åˆ¶å†…äººå‘˜å‡ ä¹ä¸å¯èƒ½ã€‚</p>\n<p>ä½“åˆ¶å¤–çš„å·¥ä½œä¸€èˆ¬è€Œè¨€éƒ½æ˜¯å’Œ OKRã€KPI ç›¸å…³ï¼Œå®Œæˆ ldã€mt æ´¾å‘çš„ä»»åŠ¡ï¼›åŠ ç­ä¸€èˆ¬æ¯”è¾ƒå¤šï¼Œèµ„æœ¬ä¸»ä¹‰å¸è¡€ï¼Œ996ã€995ã€10105ã€12126ï¼Œäº’è”ç½‘è¡Œä¸šåŠ ç­æƒ…å†µå°±æ›´ä¸¥é‡äº†ï¼›å·¥ä½œå‹åŠ›ä¸€èˆ¬è€Œè¨€æ¯”è¾ƒå¤§ï¼Œå¦‚æœéƒ¨é—¨æ•ˆç›Šä¸å¥½ï¼Œæœ‰è£å‘˜æŒ‡æ ‡ï¼Œå¾ˆå®¹æ˜“è¢«è£å‘˜ï¼Œå› æ­¤å¾—ä¸åœçš„å·ã€‚</p>\n<h3 id=\"è–ªèµ„å¾…é‡\"><a href=\"#è–ªèµ„å¾…é‡\" class=\"headerlink\" title=\"è–ªèµ„å¾…é‡\"></a>è–ªèµ„å¾…é‡</h3><p>ä½“åˆ¶å†…çš„è–ªèµ„å¾…é‡æ¯”è¾ƒä¸€èˆ¬ï¼Œåœ¨å½“åœ°åŸå¸‚ä¸€èˆ¬å±äºä¸­ç­‰åä¸Šçš„æ”¶å…¥ï¼Œåƒå¾—é¥±ä½†ä¹Ÿåƒä¸å¥½ã€‚å…¬åŠ¡å‘˜å·¥èµ„ä¸€èˆ¬é«˜äºäº‹ä¸šç¼–ï¼Œå¥½çš„å›½å¤®ä¼çš„è–ªèµ„å¾…é‡ä¹Ÿè¿˜ä¸é”™ã€‚è–ªèµ„å¾…é‡è¾ƒå¥½çš„åœ°åŒºæ¯”å¦‚è‹å—ã€æµ™åŒ—ä¸€äº›åŸå¸‚ã€‚ä½“åˆ¶å†…æœ€è¿‘ç«çƒ­è·Ÿæˆ¿åœ°äº§å‘å±•æ¯æ¯ç›¸å…³ï¼ŒåœŸåœ°è´¢æ”¿å¤§å¤§å¢åŠ äº†ä½“åˆ¶å†…çš„æ”¶å…¥ã€‚å¦‚ä»Šæˆ¿åœ°äº§ä¸šèé¡çš„æƒ…å†µä¸‹ï¼Œä½“åˆ¶å†…é™è–ªé¢‘ç¹ï¼Œæœªæ¥ä½“åˆ¶å†…çš„è–ªèµ„å¾…é‡è¿˜ä¼šæ€æ ·ï¼Œæˆ‘ä»¬ä¸å¾—è€ŒçŸ¥ã€‚</p>\n<p>ä½“åˆ¶å¤–çš„è–ªèµ„å¾…é‡æ— éå°±æ˜¯çœ‹ä¸ªäººèƒ½åŠ›å’Œä¸ªäººæœºé‡äº†ï¼Œè®¡ç®—æœºåº”å±Šç”Ÿè¿›å…¥äº’è”ç½‘å¤§å‚è–ªèµ„å¥½ç‚¹çš„éƒ½æœ‰35+wå¹´è–ªï¼Œä¸€èˆ¬çš„ä¹Ÿèƒ½æ‹¿åˆ°20+wï¼Œåœ¨ç§ä¼å¹²å‡ å¹´è·³æ§½è¿˜èƒ½æ”¶è·ä¸é”™çš„è–ªèµ„æ¶¨å¹…ã€‚è™½ç„¶äº’è”ç½‘å‘å±•åœæ»ï¼Œä½†æ˜¯æœªæ¥ä»ç„¶æœ‰å¤§é‡çš„æ•°å­—åŒ–äººæ‰éœ€æ±‚ã€‚</p>\n<h2 id=\"é€‰æ‹©ä½“åˆ¶å†…è¿˜æ˜¯ä½“åˆ¶å¤–\"><a href=\"#é€‰æ‹©ä½“åˆ¶å†…è¿˜æ˜¯ä½“åˆ¶å¤–\" class=\"headerlink\" title=\"é€‰æ‹©ä½“åˆ¶å†…è¿˜æ˜¯ä½“åˆ¶å¤–\"></a>é€‰æ‹©ä½“åˆ¶å†…è¿˜æ˜¯ä½“åˆ¶å¤–</h2><p>è¿‘å¹´æ¥ï¼Œç”±äºå…¨çƒç»æµå‘å±•åœæ»ã€è¡Œä¸šå‘¨æœŸã€ç–«æƒ…ç­‰å„ç§åŸå› ï¼Œå¾ˆå¤šäººåœ¨ç§ä¼å†…æ··çš„ä¸æ˜¯å¾ˆå¦‚æ„ï¼Œpuaã€å‹è¿«ã€è£å‘˜ã€‚è¿‘å‡ å¹´ä½“åˆ¶å†…çš„è–ªèµ„ä¹Ÿå¢åŠ å¾ˆå¤šï¼Œ20 å¹´çš„æ·±åœ³é«˜ä¸­ 40w æ‹›é«˜ä¸­è€å¸ˆã€ä½™æ­åŒºè¡—é“åŠåŠäº‹å‘˜å½•å–çš„å­¦ç”Ÿéƒ½æ˜¯æ¸…åŒ—ç­‰é¡¶å°–é«˜æ ¡çš„ç¡•å£«ç”Ÿç”šè‡³åšå£«ç”Ÿã€‚æ¸…åçš„æ¯•ä¸šç”Ÿå°±ä¸šå»å‘ä¹Ÿæ˜¾ç¤º 70% çš„å­¦ç”Ÿè¿›å…¥äº†ä½“åˆ¶å†…ã€‚</p>\n<p>é‚£ä¹ˆï¼Œä½“åˆ¶å†…çœŸçš„å°±æ— æ•Œå˜›ï¼Œå®‡å®™çš„å°½å¤´çœŸçš„æ˜¯ä½“åˆ¶å†…å˜›ï¼Œè¿˜æ˜¯é€‰æ‹©ä½“åˆ¶å¤–æ‰“æ‹¼æ‰“æ‹¼é—¯å‡ºè‡ªå·±çš„ä¸€ç‰‡å¤©å‘¢ï¼Ÿ</p>\n<p>åº”å±Šç”Ÿåœ¨å°±ä¸šé€‰æ‹©æ—¶ä¸€èˆ¬éƒ½ä¼šè·Ÿå®¶é‡Œäººå•†é‡ï¼Œå¬å¬çˆ¶æ¯çš„çœ‹æ³•ã€‚äºçˆ¶æ¯è€Œè¨€ï¼Œçˆ¶æ¯ä¸€èˆ¬éƒ½æ¯”è¾ƒæƒ³è®©å­©å­è¿›å…¥ä½“åˆ¶å†…ï¼Œæˆ‘ä»¬ä½œä¸ºå­å¥³åº”å½“å°Šé‡çˆ¶æ¯ï¼Œä½†æ˜¯ä¸æ˜¯å®Œå…¨å¬ä»çˆ¶æ¯ï¼Œå› ä¸ºä»–ä»¬æ˜¯é‚£ä¸ªæ—¶ä»£çš„é‚£äº›ç»éªŒï¼Œåœ¨å½“ä»Šè¿™ä¸ªæ—¶ä»£ï¼Œè¦æœ‰è‡ªå·±çš„æ€æƒ³ã€‚æŠŠè‡ªå·±çš„ç”Ÿå‘½è¿‡å¥½äº†ï¼Œè¿‡å‡ºç²¾å½©æ¥ï¼Œæ‰æ˜¯å¯¹çˆ¶æ¯æœ€å¤§çš„å°Šé‡ï¼Œä¹Ÿæ˜¯çˆ¶æ¯æœ€å¤§çš„å¹¸ç¦ã€‚</p>\n<p>å¾ˆå¤šäººæ¯•ä¸šæ—¶ä¸çŸ¥é“é€‰æ‹©ä»€ä¹ˆï¼Œç›²ç›®ä»ä¼—ï¼Œéšå¤§æµè¿›å…¥ä½“åˆ¶å†…ï¼Œè¿›å»ä¹‹åè§‰å¾—ä¸æ˜¯è‡ªå·±æƒ³è¦çš„ã€‚è¿™ç§æƒ…å†µæ— éæ˜¯æ— æ³•åœ¨ä½“åˆ¶å†…è·å¾—è‡ªå·±æƒ³è¦å–å¾—çš„ä»·å€¼æ„Ÿã€æˆå°±æ„Ÿã€‚æŠ•å…¥è¿‡çš„ç”Ÿå‘½æ‰ä¼šæœ‰æ¸©åº¦ï¼Œä¸ç®¡æ˜¯ä½“åˆ¶å†…è¿˜æ˜¯ä½“åˆ¶å¤–ï¼Œè¿™æ ·æ‰ä¼šè·å¾—å·¨å¤§çš„ä»·å€¼æ„Ÿã€‚</p>\n<p>æˆ‘ä»¬çš„ç¤¾ä¼šã€ç”Ÿæ´»ä¸€ç›´åœ¨å‘å±•å˜åŒ–ï¼Œè¿™ä¸ªæ‰æ˜¯ä¸€ç›´ä¸å˜çš„ã€‚åšé€‰æ‹©ä¸€å®šè¦çœ‹æ¸…æ¥šè‡ªå·±æƒ³è¦ä»€ä¹ˆï¼Œå¯ä»¥æƒ³æƒ³è‡ªå·±æ­»å»çš„æ—¶å€™ï¼Œé‚£æ—¶å€™æ˜¯ä¸€ä¸ªä»€ä¹ˆæ ·çš„èº«ä»½ã€ä»€ä¹ˆæ ·çš„èŒä½ï¼Œå› ä¸ºè¿™å…¶å®å°±æ˜¯æˆ‘ä»¬å¿ƒåº•çš„è¿½æ±‚ï¼Œæ˜ç¡®è‡ªå·±çš„è¿½æ±‚ï¼Œä½“åˆ¶å†…è¿˜æ˜¯ä½“åˆ¶å¤–ï¼Œå¾€è‡ªå·±çš„è¿½æ±‚ä¸Šé è¿‘å°±å¯ä»¥äº†ã€‚ä½“åˆ¶å†…è¿˜æ˜¯ä½“åˆ¶å¤–æ²¡æœ‰å¯¹é”™ï¼Œåªæœ‰é€‚åˆï¼Œé€‚åˆè‡ªå·±ã€é€‚åˆè‡ªå·±çš„æœªæ¥å‘å±•ã€é€‚åˆè‡ªå·±çš„äººç”Ÿè¿½æ±‚ã€‚</p>\n<h2 id=\"å‚è€ƒ\"><a href=\"#å‚è€ƒ\" class=\"headerlink\" title=\"å‚è€ƒ\"></a>å‚è€ƒ</h2><p>ä»¥ä¸‹æ˜¯ä¸€äº›æˆ‘è§‰å¾—è®²çš„å¾ˆåœ¨ç†çš„è§†é¢‘ï¼ŒéåŠé€€æ€§è´¨ï¼Œçœ‹å®Œä¹‹åæ„Ÿæ‚Ÿå¾ˆå¤šã€‚</p>\n<p><a href=\"https://www.bilibili.com/video/BV1JT41117Lx/?share_source=copy_web&vd_source=0ee37b99b6275b36190f1dd4aff8f80a\">ä¸é€‚åˆå°±åˆ«è€ƒå…¬åŠ¡å‘˜äº†</a></p>\n<p><a href=\"https://www.bilibili.com/video/BV1Ga4y1p7Tw/?share_source=copy_web&vd_source=0ee37b99b6275b36190f1dd4aff8f80a\">â€œåˆ«çæ··äº†ï¼Œå…¬åŠ¡å‘˜æ‰æ˜¯æ­£ç»å·¥ä½œâ€è¿›ä½“åˆ¶çœŸçš„é¦™å—ï¼Ÿã€å¤æ—¦æ¢æ°¸å®‰ã€‘</a></p>\n<p><a href=\"https://www.bilibili.com/video/BV1RS4y1d7R9/?share_source=copy_web&vd_source=0ee37b99b6275b36190f1dd4aff8f80a\">60ä¸‡å¹´è–ªæ¯”ä¸ä¸Šå…¬åŠ¡å‘˜æœˆè–ª4000ï¼ŸåŒå¿—ä»¬ï¼Œåƒä¸‡åˆ«å†é«˜ä¼°â€œä½“åˆ¶å†…â€çš„æ€§ä»·æ¯”äº†ï¼ã€æ¯¯å”ç›˜é’±ã€‘</a></p>\n<p><a href=\"https://www.bilibili.com/video/BV1CM4y1F7PN/?share_source=copy_web&vd_source=0ee37b99b6275b36190f1dd4aff8f80a\">ã€è€ƒç¼–ï¼Ÿçœ‹è¿™ä¸€æ¡å°±å¤Ÿäº†ã€‘8å¹´ï¼ï¼å®‡å®™å°½å¤´çœŸä¸æ˜¯ç¼–åˆ¶ï¼ï¼</a></p>\n<p><a href=\"https://www.bilibili.com/video/BV1VY4y1A7XM/?share_source=copy_web&vd_source=0ee37b99b6275b36190f1dd4aff8f80a\">537ä¸‡äººè€ƒå…¬ï¼Œ500ä¸‡äººå¤±ä¸šï¼Œå®‡å®™çš„å°½å¤´æ˜¯è€ƒç¼–å—ï¼Ÿ</a> </p>\n","site":{"data":{}},"length":1564,"excerpt":"<p>é¢ä¸´ç§‹æ‹›æ¯•ä¸šå­£ï¼Œè¿›ä½“åˆ¶å†…è¿˜æ˜¯ä½“åˆ¶å¤–æ— ç–‘æ˜¯æ‘†åœ¨æ¯•ä¸šç”Ÿé¢å‰çš„ä¸¤ä¸ªå¤§æ–¹å‘é€‰æ‹©ã€‚æœ¬äººç§‹æ‹›ä»¥æ¥ä¹Ÿç»å†äº†ç±»ä¼¼é€‰æ‹©ï¼Œä¹Ÿè°ˆè°ˆæˆ‘ä¸ªäººçš„ä¸€äº›æ€è€ƒã€‚","more":"</p>\n<h2 id=\"ä½“åˆ¶å†…-x2F-å¤–çš„å¯¹æ¯”\"><a href=\"#ä½“åˆ¶å†…-x2F-å¤–çš„å¯¹æ¯”\" class=\"headerlink\" title=\"ä½“åˆ¶å†…&#x2F;å¤–çš„å¯¹æ¯”\"></a>ä½“åˆ¶å†…&#x2F;å¤–çš„å¯¹æ¯”</h2><h3 id=\"å·¥ä½œå•ä½\"><a href=\"#å·¥ä½œå•ä½\" class=\"headerlink\" title=\"å·¥ä½œå•ä½\"></a>å·¥ä½œå•ä½</h3><p>ä½“åˆ¶å†…ç‹­ä¹‰ä¸ŠæŒ‡å…¬åŠ¡å‘˜å’Œäº‹ä¸šç¼–ï¼Œå¹¿ä¹‰ä¸Šçš„ä½“åˆ¶å†…è¿˜åŒ…å«ä¸€äº›æ³›ä½“åˆ¶å†…çš„å•ä½ï¼Œæ¯”å¦‚çƒŸè‰ã€ç”µç½‘ã€é“¶è¡Œç­‰å›½å¤®ä¼ã€‚</p>\n<p>ä½“åˆ¶å¤–å°±æ˜¯æŒ‡ç§ä¼äº†ï¼Œäº’è”ç½‘è¡Œä¸šçš„è¯æ¯”å¦‚ â€œBATâ€ã€â€TMDâ€ï¼Œå¤–ä¼å¦‚å¾®è½¯ã€ZOOMã€SAP ç­‰ã€‚</p>\n<h3 id=\"å·¥ä½œå†…å®¹ã€æ—¶é—´ã€å‹åŠ›\"><a href=\"#å·¥ä½œå†…å®¹ã€æ—¶é—´ã€å‹åŠ›\" class=\"headerlink\" title=\"å·¥ä½œå†…å®¹ã€æ—¶é—´ã€å‹åŠ›\"></a>å·¥ä½œå†…å®¹ã€æ—¶é—´ã€å‹åŠ›</h3><p>ä½“åˆ¶å†…çš„å·¥ä½œä¸€èˆ¬éƒ½ä¸ä¼šå¾ˆéš¾ã€‚å…¬åŠ¡å‘˜ä¸€èˆ¬æ˜¯å†™ææ–™ã€æ•´ç†ææ–™ï¼Œäº‹ä¸šç¼–æ ¹æ®å²—ä½ä¸åŒå…·ä½“å·¥ä½œå†…å®¹ä¹Ÿä¸åŒï¼Œæ¯”å¦‚æ•™å¸ˆç¼–ä¹Ÿå±äºäº‹ä¸šç¼–ï¼Œæ•™å¸ˆä¸€èˆ¬é™¤äº†æ‰¿æ‹…æ•™å­¦ä»»åŠ¡ä»¥å¤–ï¼Œè¿˜è¦è¢«å®‰æ’ä¸€äº›æ‚æ´»ï¼›åŠ ç­ä¸€èˆ¬éƒ½ä¸ä¼šå¾ˆå¤šï¼Œä¸è¿‡ç–«æƒ…æœŸé—´å¾ˆå¤šå…¬åŠ¡å‘˜æ‰¿æ‹…é˜²ç–«è§’è‰²ï¼ŒåŠ ç­æƒ…å†µååˆ†ä¸¥é‡ï¼Œç”šè‡³åŠå¤œè¢«å«é†’å»å•ä½æé˜²ç–«å·¥ä½œï¼›å·¥ä½œå‹åŠ›ä¸€èˆ¬ä¸ä¼šå¾ˆå¤§ï¼Œå°±ç®—å®Œæˆä¸äº†ä¹Ÿå¯ä»¥èººå¹³æ‘†çƒ‚ï¼Œæ¯•ç«Ÿè¾é€€ä¸€åä½“åˆ¶å†…äººå‘˜å‡ ä¹ä¸å¯èƒ½ã€‚</p>\n<p>ä½“åˆ¶å¤–çš„å·¥ä½œä¸€èˆ¬è€Œè¨€éƒ½æ˜¯å’Œ OKRã€KPI ç›¸å…³ï¼Œå®Œæˆ ldã€mt æ´¾å‘çš„ä»»åŠ¡ï¼›åŠ ç­ä¸€èˆ¬æ¯”è¾ƒå¤šï¼Œèµ„æœ¬ä¸»ä¹‰å¸è¡€ï¼Œ996ã€995ã€10105ã€12126ï¼Œäº’è”ç½‘è¡Œä¸šåŠ ç­æƒ…å†µå°±æ›´ä¸¥é‡äº†ï¼›å·¥ä½œå‹åŠ›ä¸€èˆ¬è€Œè¨€æ¯”è¾ƒå¤§ï¼Œå¦‚æœéƒ¨é—¨æ•ˆç›Šä¸å¥½ï¼Œæœ‰è£å‘˜æŒ‡æ ‡ï¼Œå¾ˆå®¹æ˜“è¢«è£å‘˜ï¼Œå› æ­¤å¾—ä¸åœçš„å·ã€‚</p>\n<h3 id=\"è–ªèµ„å¾…é‡\"><a href=\"#è–ªèµ„å¾…é‡\" class=\"headerlink\" title=\"è–ªèµ„å¾…é‡\"></a>è–ªèµ„å¾…é‡</h3><p>ä½“åˆ¶å†…çš„è–ªèµ„å¾…é‡æ¯”è¾ƒä¸€èˆ¬ï¼Œåœ¨å½“åœ°åŸå¸‚ä¸€èˆ¬å±äºä¸­ç­‰åä¸Šçš„æ”¶å…¥ï¼Œåƒå¾—é¥±ä½†ä¹Ÿåƒä¸å¥½ã€‚å…¬åŠ¡å‘˜å·¥èµ„ä¸€èˆ¬é«˜äºäº‹ä¸šç¼–ï¼Œå¥½çš„å›½å¤®ä¼çš„è–ªèµ„å¾…é‡ä¹Ÿè¿˜ä¸é”™ã€‚è–ªèµ„å¾…é‡è¾ƒå¥½çš„åœ°åŒºæ¯”å¦‚è‹å—ã€æµ™åŒ—ä¸€äº›åŸå¸‚ã€‚ä½“åˆ¶å†…æœ€è¿‘ç«çƒ­è·Ÿæˆ¿åœ°äº§å‘å±•æ¯æ¯ç›¸å…³ï¼ŒåœŸåœ°è´¢æ”¿å¤§å¤§å¢åŠ äº†ä½“åˆ¶å†…çš„æ”¶å…¥ã€‚å¦‚ä»Šæˆ¿åœ°äº§ä¸šèé¡çš„æƒ…å†µä¸‹ï¼Œä½“åˆ¶å†…é™è–ªé¢‘ç¹ï¼Œæœªæ¥ä½“åˆ¶å†…çš„è–ªèµ„å¾…é‡è¿˜ä¼šæ€æ ·ï¼Œæˆ‘ä»¬ä¸å¾—è€ŒçŸ¥ã€‚</p>\n<p>ä½“åˆ¶å¤–çš„è–ªèµ„å¾…é‡æ— éå°±æ˜¯çœ‹ä¸ªäººèƒ½åŠ›å’Œä¸ªäººæœºé‡äº†ï¼Œè®¡ç®—æœºåº”å±Šç”Ÿè¿›å…¥äº’è”ç½‘å¤§å‚è–ªèµ„å¥½ç‚¹çš„éƒ½æœ‰35+wå¹´è–ªï¼Œä¸€èˆ¬çš„ä¹Ÿèƒ½æ‹¿åˆ°20+wï¼Œåœ¨ç§ä¼å¹²å‡ å¹´è·³æ§½è¿˜èƒ½æ”¶è·ä¸é”™çš„è–ªèµ„æ¶¨å¹…ã€‚è™½ç„¶äº’è”ç½‘å‘å±•åœæ»ï¼Œä½†æ˜¯æœªæ¥ä»ç„¶æœ‰å¤§é‡çš„æ•°å­—åŒ–äººæ‰éœ€æ±‚ã€‚</p>\n<h2 id=\"é€‰æ‹©ä½“åˆ¶å†…è¿˜æ˜¯ä½“åˆ¶å¤–\"><a href=\"#é€‰æ‹©ä½“åˆ¶å†…è¿˜æ˜¯ä½“åˆ¶å¤–\" class=\"headerlink\" title=\"é€‰æ‹©ä½“åˆ¶å†…è¿˜æ˜¯ä½“åˆ¶å¤–\"></a>é€‰æ‹©ä½“åˆ¶å†…è¿˜æ˜¯ä½“åˆ¶å¤–</h2><p>è¿‘å¹´æ¥ï¼Œç”±äºå…¨çƒç»æµå‘å±•åœæ»ã€è¡Œä¸šå‘¨æœŸã€ç–«æƒ…ç­‰å„ç§åŸå› ï¼Œå¾ˆå¤šäººåœ¨ç§ä¼å†…æ··çš„ä¸æ˜¯å¾ˆå¦‚æ„ï¼Œpuaã€å‹è¿«ã€è£å‘˜ã€‚è¿‘å‡ å¹´ä½“åˆ¶å†…çš„è–ªèµ„ä¹Ÿå¢åŠ å¾ˆå¤šï¼Œ20 å¹´çš„æ·±åœ³é«˜ä¸­ 40w æ‹›é«˜ä¸­è€å¸ˆã€ä½™æ­åŒºè¡—é“åŠåŠäº‹å‘˜å½•å–çš„å­¦ç”Ÿéƒ½æ˜¯æ¸…åŒ—ç­‰é¡¶å°–é«˜æ ¡çš„ç¡•å£«ç”Ÿç”šè‡³åšå£«ç”Ÿã€‚æ¸…åçš„æ¯•ä¸šç”Ÿå°±ä¸šå»å‘ä¹Ÿæ˜¾ç¤º 70% çš„å­¦ç”Ÿè¿›å…¥äº†ä½“åˆ¶å†…ã€‚</p>\n<p>é‚£ä¹ˆï¼Œä½“åˆ¶å†…çœŸçš„å°±æ— æ•Œå˜›ï¼Œå®‡å®™çš„å°½å¤´çœŸçš„æ˜¯ä½“åˆ¶å†…å˜›ï¼Œè¿˜æ˜¯é€‰æ‹©ä½“åˆ¶å¤–æ‰“æ‹¼æ‰“æ‹¼é—¯å‡ºè‡ªå·±çš„ä¸€ç‰‡å¤©å‘¢ï¼Ÿ</p>\n<p>åº”å±Šç”Ÿåœ¨å°±ä¸šé€‰æ‹©æ—¶ä¸€èˆ¬éƒ½ä¼šè·Ÿå®¶é‡Œäººå•†é‡ï¼Œå¬å¬çˆ¶æ¯çš„çœ‹æ³•ã€‚äºçˆ¶æ¯è€Œè¨€ï¼Œçˆ¶æ¯ä¸€èˆ¬éƒ½æ¯”è¾ƒæƒ³è®©å­©å­è¿›å…¥ä½“åˆ¶å†…ï¼Œæˆ‘ä»¬ä½œä¸ºå­å¥³åº”å½“å°Šé‡çˆ¶æ¯ï¼Œä½†æ˜¯ä¸æ˜¯å®Œå…¨å¬ä»çˆ¶æ¯ï¼Œå› ä¸ºä»–ä»¬æ˜¯é‚£ä¸ªæ—¶ä»£çš„é‚£äº›ç»éªŒï¼Œåœ¨å½“ä»Šè¿™ä¸ªæ—¶ä»£ï¼Œè¦æœ‰è‡ªå·±çš„æ€æƒ³ã€‚æŠŠè‡ªå·±çš„ç”Ÿå‘½è¿‡å¥½äº†ï¼Œè¿‡å‡ºç²¾å½©æ¥ï¼Œæ‰æ˜¯å¯¹çˆ¶æ¯æœ€å¤§çš„å°Šé‡ï¼Œä¹Ÿæ˜¯çˆ¶æ¯æœ€å¤§çš„å¹¸ç¦ã€‚</p>\n<p>å¾ˆå¤šäººæ¯•ä¸šæ—¶ä¸çŸ¥é“é€‰æ‹©ä»€ä¹ˆï¼Œç›²ç›®ä»ä¼—ï¼Œéšå¤§æµè¿›å…¥ä½“åˆ¶å†…ï¼Œè¿›å»ä¹‹åè§‰å¾—ä¸æ˜¯è‡ªå·±æƒ³è¦çš„ã€‚è¿™ç§æƒ…å†µæ— éæ˜¯æ— æ³•åœ¨ä½“åˆ¶å†…è·å¾—è‡ªå·±æƒ³è¦å–å¾—çš„ä»·å€¼æ„Ÿã€æˆå°±æ„Ÿã€‚æŠ•å…¥è¿‡çš„ç”Ÿå‘½æ‰ä¼šæœ‰æ¸©åº¦ï¼Œä¸ç®¡æ˜¯ä½“åˆ¶å†…è¿˜æ˜¯ä½“åˆ¶å¤–ï¼Œè¿™æ ·æ‰ä¼šè·å¾—å·¨å¤§çš„ä»·å€¼æ„Ÿã€‚</p>\n<p>æˆ‘ä»¬çš„ç¤¾ä¼šã€ç”Ÿæ´»ä¸€ç›´åœ¨å‘å±•å˜åŒ–ï¼Œè¿™ä¸ªæ‰æ˜¯ä¸€ç›´ä¸å˜çš„ã€‚åšé€‰æ‹©ä¸€å®šè¦çœ‹æ¸…æ¥šè‡ªå·±æƒ³è¦ä»€ä¹ˆï¼Œå¯ä»¥æƒ³æƒ³è‡ªå·±æ­»å»çš„æ—¶å€™ï¼Œé‚£æ—¶å€™æ˜¯ä¸€ä¸ªä»€ä¹ˆæ ·çš„èº«ä»½ã€ä»€ä¹ˆæ ·çš„èŒä½ï¼Œå› ä¸ºè¿™å…¶å®å°±æ˜¯æˆ‘ä»¬å¿ƒåº•çš„è¿½æ±‚ï¼Œæ˜ç¡®è‡ªå·±çš„è¿½æ±‚ï¼Œä½“åˆ¶å†…è¿˜æ˜¯ä½“åˆ¶å¤–ï¼Œå¾€è‡ªå·±çš„è¿½æ±‚ä¸Šé è¿‘å°±å¯ä»¥äº†ã€‚ä½“åˆ¶å†…è¿˜æ˜¯ä½“åˆ¶å¤–æ²¡æœ‰å¯¹é”™ï¼Œåªæœ‰é€‚åˆï¼Œé€‚åˆè‡ªå·±ã€é€‚åˆè‡ªå·±çš„æœªæ¥å‘å±•ã€é€‚åˆè‡ªå·±çš„äººç”Ÿè¿½æ±‚ã€‚</p>\n<h2 id=\"å‚è€ƒ\"><a href=\"#å‚è€ƒ\" class=\"headerlink\" title=\"å‚è€ƒ\"></a>å‚è€ƒ</h2><p>ä»¥ä¸‹æ˜¯ä¸€äº›æˆ‘è§‰å¾—è®²çš„å¾ˆåœ¨ç†çš„è§†é¢‘ï¼ŒéåŠé€€æ€§è´¨ï¼Œçœ‹å®Œä¹‹åæ„Ÿæ‚Ÿå¾ˆå¤šã€‚</p>\n<p><a href=\"https://www.bilibili.com/video/BV1JT41117Lx/?share_source=copy_web&vd_source=0ee37b99b6275b36190f1dd4aff8f80a\">ä¸é€‚åˆå°±åˆ«è€ƒå…¬åŠ¡å‘˜äº†</a></p>\n<p><a href=\"https://www.bilibili.com/video/BV1Ga4y1p7Tw/?share_source=copy_web&vd_source=0ee37b99b6275b36190f1dd4aff8f80a\">â€œåˆ«çæ··äº†ï¼Œå…¬åŠ¡å‘˜æ‰æ˜¯æ­£ç»å·¥ä½œâ€è¿›ä½“åˆ¶çœŸçš„é¦™å—ï¼Ÿã€å¤æ—¦æ¢æ°¸å®‰ã€‘</a></p>\n<p><a href=\"https://www.bilibili.com/video/BV1RS4y1d7R9/?share_source=copy_web&vd_source=0ee37b99b6275b36190f1dd4aff8f80a\">60ä¸‡å¹´è–ªæ¯”ä¸ä¸Šå…¬åŠ¡å‘˜æœˆè–ª4000ï¼ŸåŒå¿—ä»¬ï¼Œåƒä¸‡åˆ«å†é«˜ä¼°â€œä½“åˆ¶å†…â€çš„æ€§ä»·æ¯”äº†ï¼ã€æ¯¯å”ç›˜é’±ã€‘</a></p>\n<p><a href=\"https://www.bilibili.com/video/BV1CM4y1F7PN/?share_source=copy_web&vd_source=0ee37b99b6275b36190f1dd4aff8f80a\">ã€è€ƒç¼–ï¼Ÿçœ‹è¿™ä¸€æ¡å°±å¤Ÿäº†ã€‘8å¹´ï¼ï¼å®‡å®™å°½å¤´çœŸä¸æ˜¯ç¼–åˆ¶ï¼ï¼</a></p>\n<p><a href=\"https://www.bilibili.com/video/BV1VY4y1A7XM/?share_source=copy_web&vd_source=0ee37b99b6275b36190f1dd4aff8f80a\">537ä¸‡äººè€ƒå…¬ï¼Œ500ä¸‡äººå¤±ä¸šï¼Œå®‡å®™çš„å°½å¤´æ˜¯è€ƒç¼–å—ï¼Ÿ</a> </p>"},{"title":"å›è€å®¶çš„ä¸€å‘¨","copyright":true,"mathjax":true,"date":"2022-12-23T10:46:02.000Z","urlname":"week-back-home","_content":"\nä¸Šå‘¨ä»å¸¸å·çœè€ƒå›æ¥ï¼Œå½“å¤©æ™šä¸Šæ­£å¥½æ˜¯ä¸–ç•Œæ¯å†³èµ›ï¼Œçœ‹åˆ°äº†å‡Œæ™¨ä¸¤ç‚¹ï¼Œç¬¬äºŒå¤©ä¸€å¤§æ—©èµ·åºŠï¼Œå’Œçˆ¸å¦ˆä¸€èµ·å¼€è½¦å›è€å®¶ï¼Œç„¶åå°±å¼€å§‹äº†åœ¨è€å®¶çš„ä¸€å‘¨ç”Ÿæ´»ã€‚\n\n<!--more-->\n\nåœ¨è€å®¶çš„ä¸€å‘¨é™¤äº†åƒé¥­å°±æ˜¯å–é…’ï¼Œæ— èŠçš„å¾ˆã€‚ç¬¬ä¸€å¤©æ™šä¸Šæœ‰ç‚¹å¤´ç—›ï¼Œè¿˜ä»¥ä¸ºæ˜¯é˜³äº†ï¼Œåé¢ä¸€ç›´æ²¡ä»€ä¹ˆå¤§çš„ç—‡çŠ¶ï¼Œä¸è¿‡æ¯å¤©éƒ½æ˜¯å¤´æ˜è„‘èƒ€çš„ï¼Œæ„Ÿè§‰åº”è¯¥åªæ˜¯æ™®é€šæµæ„Ÿï¼ˆåˆ°ç°åœ¨è¿˜æ²¡å¥½ï¼‰ã€‚è€å®¶å¥½å¤šäººéƒ½æœ‰ç‚¹å‘çƒ§ï¼Œè¯Šæ‰€é‡Œéƒ½æ˜¯è€äººåœ¨æŒ‚æ°´ï¼Œä¹Ÿä¸çŸ¥é“æŒ‚çš„æ˜¯ä»€ä¹ˆæ°´ï¼Œè€å¹´äººæŒ‚æ°´å¥½åƒä¼šèˆ’æœå¾ˆå¤šã€‚\n\nåœ¨è€å®¶è¿˜ç®€å•è¿‡äº†ä¸ªå°ç”Ÿæ—¥ï¼Œè€çˆ¸è€å¦ˆåœ¨é•‡ä¸Šé…’åº—åŠäº†ä¸¤æ¡Œé…’å¸­æ¥å®¢ï¼Œå§¨å¦ˆç»™ä¹°äº†ä¸ªå¤§è›‹ç³•ï¼Œè¡¨å¼Ÿä»å¸‚é‡Œå›æ¥è¿˜ä¹°äº†ä¸€æŸèŠ±ï¼Œæœ‰ç‚¹å°æ¸©é¦¨ã€‚\n\nè¡¨ä¾„ä»Šå¹´å…­å²äº†ï¼Œå¾ˆå¯çˆ±ï¼Œæ´»è¹¦ä¹±è·³çš„ã€‚\n\nçˆ·çˆ·ã€å¥¶å¥¶é‚£ä¸€è¾ˆçš„å¥½å¤šäººå¹´çºªéƒ½å¾ˆå¤§äº†ï¼Œå¸Œæœ›ä»–ä»¬å¥å¥åº·åº·ã€‚\n\nä»Šå¤©ä¸‹åˆå›åˆ°å¸¸å·äº†ï¼Œå‡†å¤‡æœ€è¿‘æææ¯•ä¸šè®ºæ–‡çš„äº‹äº†ã€‚\n\n","source":"_posts/å›è€å®¶çš„ä¸€å‘¨.md","raw":"---\ntitle: å›è€å®¶çš„ä¸€å‘¨\ncopyright: true\nmathjax: true\ncategories: æ—¥å¸¸å°è®°\ntags: \ndate: 2022-12-23 18:46:02\nurlname: week-back-home\n---\n\nä¸Šå‘¨ä»å¸¸å·çœè€ƒå›æ¥ï¼Œå½“å¤©æ™šä¸Šæ­£å¥½æ˜¯ä¸–ç•Œæ¯å†³èµ›ï¼Œçœ‹åˆ°äº†å‡Œæ™¨ä¸¤ç‚¹ï¼Œç¬¬äºŒå¤©ä¸€å¤§æ—©èµ·åºŠï¼Œå’Œçˆ¸å¦ˆä¸€èµ·å¼€è½¦å›è€å®¶ï¼Œç„¶åå°±å¼€å§‹äº†åœ¨è€å®¶çš„ä¸€å‘¨ç”Ÿæ´»ã€‚\n\n<!--more-->\n\nåœ¨è€å®¶çš„ä¸€å‘¨é™¤äº†åƒé¥­å°±æ˜¯å–é…’ï¼Œæ— èŠçš„å¾ˆã€‚ç¬¬ä¸€å¤©æ™šä¸Šæœ‰ç‚¹å¤´ç—›ï¼Œè¿˜ä»¥ä¸ºæ˜¯é˜³äº†ï¼Œåé¢ä¸€ç›´æ²¡ä»€ä¹ˆå¤§çš„ç—‡çŠ¶ï¼Œä¸è¿‡æ¯å¤©éƒ½æ˜¯å¤´æ˜è„‘èƒ€çš„ï¼Œæ„Ÿè§‰åº”è¯¥åªæ˜¯æ™®é€šæµæ„Ÿï¼ˆåˆ°ç°åœ¨è¿˜æ²¡å¥½ï¼‰ã€‚è€å®¶å¥½å¤šäººéƒ½æœ‰ç‚¹å‘çƒ§ï¼Œè¯Šæ‰€é‡Œéƒ½æ˜¯è€äººåœ¨æŒ‚æ°´ï¼Œä¹Ÿä¸çŸ¥é“æŒ‚çš„æ˜¯ä»€ä¹ˆæ°´ï¼Œè€å¹´äººæŒ‚æ°´å¥½åƒä¼šèˆ’æœå¾ˆå¤šã€‚\n\nåœ¨è€å®¶è¿˜ç®€å•è¿‡äº†ä¸ªå°ç”Ÿæ—¥ï¼Œè€çˆ¸è€å¦ˆåœ¨é•‡ä¸Šé…’åº—åŠäº†ä¸¤æ¡Œé…’å¸­æ¥å®¢ï¼Œå§¨å¦ˆç»™ä¹°äº†ä¸ªå¤§è›‹ç³•ï¼Œè¡¨å¼Ÿä»å¸‚é‡Œå›æ¥è¿˜ä¹°äº†ä¸€æŸèŠ±ï¼Œæœ‰ç‚¹å°æ¸©é¦¨ã€‚\n\nè¡¨ä¾„ä»Šå¹´å…­å²äº†ï¼Œå¾ˆå¯çˆ±ï¼Œæ´»è¹¦ä¹±è·³çš„ã€‚\n\nçˆ·çˆ·ã€å¥¶å¥¶é‚£ä¸€è¾ˆçš„å¥½å¤šäººå¹´çºªéƒ½å¾ˆå¤§äº†ï¼Œå¸Œæœ›ä»–ä»¬å¥å¥åº·åº·ã€‚\n\nä»Šå¤©ä¸‹åˆå›åˆ°å¸¸å·äº†ï¼Œå‡†å¤‡æœ€è¿‘æææ¯•ä¸šè®ºæ–‡çš„äº‹äº†ã€‚\n\n","slug":"å›è€å®¶çš„ä¸€å‘¨","published":1,"updated":"2023-01-26T12:07:10.270Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cldzfw326000tt9t8h9aa10ku","content":"<p>ä¸Šå‘¨ä»å¸¸å·çœè€ƒå›æ¥ï¼Œå½“å¤©æ™šä¸Šæ­£å¥½æ˜¯ä¸–ç•Œæ¯å†³èµ›ï¼Œçœ‹åˆ°äº†å‡Œæ™¨ä¸¤ç‚¹ï¼Œç¬¬äºŒå¤©ä¸€å¤§æ—©èµ·åºŠï¼Œå’Œçˆ¸å¦ˆä¸€èµ·å¼€è½¦å›è€å®¶ï¼Œç„¶åå°±å¼€å§‹äº†åœ¨è€å®¶çš„ä¸€å‘¨ç”Ÿæ´»ã€‚</p>\n<span id=\"more\"></span>\n\n<p>åœ¨è€å®¶çš„ä¸€å‘¨é™¤äº†åƒé¥­å°±æ˜¯å–é…’ï¼Œæ— èŠçš„å¾ˆã€‚ç¬¬ä¸€å¤©æ™šä¸Šæœ‰ç‚¹å¤´ç—›ï¼Œè¿˜ä»¥ä¸ºæ˜¯é˜³äº†ï¼Œåé¢ä¸€ç›´æ²¡ä»€ä¹ˆå¤§çš„ç—‡çŠ¶ï¼Œä¸è¿‡æ¯å¤©éƒ½æ˜¯å¤´æ˜è„‘èƒ€çš„ï¼Œæ„Ÿè§‰åº”è¯¥åªæ˜¯æ™®é€šæµæ„Ÿï¼ˆåˆ°ç°åœ¨è¿˜æ²¡å¥½ï¼‰ã€‚è€å®¶å¥½å¤šäººéƒ½æœ‰ç‚¹å‘çƒ§ï¼Œè¯Šæ‰€é‡Œéƒ½æ˜¯è€äººåœ¨æŒ‚æ°´ï¼Œä¹Ÿä¸çŸ¥é“æŒ‚çš„æ˜¯ä»€ä¹ˆæ°´ï¼Œè€å¹´äººæŒ‚æ°´å¥½åƒä¼šèˆ’æœå¾ˆå¤šã€‚</p>\n<p>åœ¨è€å®¶è¿˜ç®€å•è¿‡äº†ä¸ªå°ç”Ÿæ—¥ï¼Œè€çˆ¸è€å¦ˆåœ¨é•‡ä¸Šé…’åº—åŠäº†ä¸¤æ¡Œé…’å¸­æ¥å®¢ï¼Œå§¨å¦ˆç»™ä¹°äº†ä¸ªå¤§è›‹ç³•ï¼Œè¡¨å¼Ÿä»å¸‚é‡Œå›æ¥è¿˜ä¹°äº†ä¸€æŸèŠ±ï¼Œæœ‰ç‚¹å°æ¸©é¦¨ã€‚</p>\n<p>è¡¨ä¾„ä»Šå¹´å…­å²äº†ï¼Œå¾ˆå¯çˆ±ï¼Œæ´»è¹¦ä¹±è·³çš„ã€‚</p>\n<p>çˆ·çˆ·ã€å¥¶å¥¶é‚£ä¸€è¾ˆçš„å¥½å¤šäººå¹´çºªéƒ½å¾ˆå¤§äº†ï¼Œå¸Œæœ›ä»–ä»¬å¥å¥åº·åº·ã€‚</p>\n<p>ä»Šå¤©ä¸‹åˆå›åˆ°å¸¸å·äº†ï¼Œå‡†å¤‡æœ€è¿‘æææ¯•ä¸šè®ºæ–‡çš„äº‹äº†ã€‚</p>\n","site":{"data":{}},"length":323,"excerpt":"<p>ä¸Šå‘¨ä»å¸¸å·çœè€ƒå›æ¥ï¼Œå½“å¤©æ™šä¸Šæ­£å¥½æ˜¯ä¸–ç•Œæ¯å†³èµ›ï¼Œçœ‹åˆ°äº†å‡Œæ™¨ä¸¤ç‚¹ï¼Œç¬¬äºŒå¤©ä¸€å¤§æ—©èµ·åºŠï¼Œå’Œçˆ¸å¦ˆä¸€èµ·å¼€è½¦å›è€å®¶ï¼Œç„¶åå°±å¼€å§‹äº†åœ¨è€å®¶çš„ä¸€å‘¨ç”Ÿæ´»ã€‚</p>","more":"<p>åœ¨è€å®¶çš„ä¸€å‘¨é™¤äº†åƒé¥­å°±æ˜¯å–é…’ï¼Œæ— èŠçš„å¾ˆã€‚ç¬¬ä¸€å¤©æ™šä¸Šæœ‰ç‚¹å¤´ç—›ï¼Œè¿˜ä»¥ä¸ºæ˜¯é˜³äº†ï¼Œåé¢ä¸€ç›´æ²¡ä»€ä¹ˆå¤§çš„ç—‡çŠ¶ï¼Œä¸è¿‡æ¯å¤©éƒ½æ˜¯å¤´æ˜è„‘èƒ€çš„ï¼Œæ„Ÿè§‰åº”è¯¥åªæ˜¯æ™®é€šæµæ„Ÿï¼ˆåˆ°ç°åœ¨è¿˜æ²¡å¥½ï¼‰ã€‚è€å®¶å¥½å¤šäººéƒ½æœ‰ç‚¹å‘çƒ§ï¼Œè¯Šæ‰€é‡Œéƒ½æ˜¯è€äººåœ¨æŒ‚æ°´ï¼Œä¹Ÿä¸çŸ¥é“æŒ‚çš„æ˜¯ä»€ä¹ˆæ°´ï¼Œè€å¹´äººæŒ‚æ°´å¥½åƒä¼šèˆ’æœå¾ˆå¤šã€‚</p>\n<p>åœ¨è€å®¶è¿˜ç®€å•è¿‡äº†ä¸ªå°ç”Ÿæ—¥ï¼Œè€çˆ¸è€å¦ˆåœ¨é•‡ä¸Šé…’åº—åŠäº†ä¸¤æ¡Œé…’å¸­æ¥å®¢ï¼Œå§¨å¦ˆç»™ä¹°äº†ä¸ªå¤§è›‹ç³•ï¼Œè¡¨å¼Ÿä»å¸‚é‡Œå›æ¥è¿˜ä¹°äº†ä¸€æŸèŠ±ï¼Œæœ‰ç‚¹å°æ¸©é¦¨ã€‚</p>\n<p>è¡¨ä¾„ä»Šå¹´å…­å²äº†ï¼Œå¾ˆå¯çˆ±ï¼Œæ´»è¹¦ä¹±è·³çš„ã€‚</p>\n<p>çˆ·çˆ·ã€å¥¶å¥¶é‚£ä¸€è¾ˆçš„å¥½å¤šäººå¹´çºªéƒ½å¾ˆå¤§äº†ï¼Œå¸Œæœ›ä»–ä»¬å¥å¥åº·åº·ã€‚</p>\n<p>ä»Šå¤©ä¸‹åˆå›åˆ°å¸¸å·äº†ï¼Œå‡†å¤‡æœ€è¿‘æææ¯•ä¸šè®ºæ–‡çš„äº‹äº†ã€‚</p>"},{"title":"å­—èŠ‚æš‘æœŸå®ä¹ åŒç»„å®ä¹ ç”Ÿç§‹æ‹›æƒ…å†µåˆ†äº«","copyright":true,"mathjax":true,"date":"2022-12-13T12:02:14.000Z","urlname":"my-bytedance-internship-friends-offer","_content":"\nçªç„¶æƒ³èµ·æ¥åšè¿™ä¸ªåˆ†äº«ï¼Œæ˜¯å› ä¸ºåˆšå¥½ä¸‹åˆæœ‰ä¸ªå­—èŠ‚è·³åŠ¨æš‘æœŸå®ä¹ æ—¶åŒç»„çš„æœ‹å‹åˆšç­¾çº¦ä¸‰æ–¹ï¼Œå’Œçˆ¶æ¯ä¹Ÿé¡ºä¾¿åˆ†äº«äº†å…¶ä»–åŒç»„å®ä¹ ç”Ÿçš„ç­¾çº¦æƒ…å†µã€‚è¿™è¾¹ä¹Ÿç»™å¤§å®¶åˆ†äº«ä¸‹ã€‚\n\n<!--more-->\n\nåœ¨å­—èŠ‚è·³åŠ¨æš‘æœŸå®ä¹ æœŸé—´ï¼Œå‰å‰åååŠ ä¸Šæˆ‘ä¸€å…±æœ‰ 5 åå®ä¹ ç”Ÿã€‚\n\nå®ä¹ ç”Ÿ Aï¼šæµ™å¤§ç¡•ï¼Œåœ¨æˆ‘ä»¬ç»„ä» 4 æœˆä¸­å¹²åˆ° 7 æœˆä¸­ï¼Œèµ°å­—èŠ‚çš„æ´»æ°´å¹³å°æ´»æ°´åˆ°å…¶ä»–éƒ¨é—¨ç»§ç»­æš‘æœŸå®ä¹ äº†ï¼Œæœªèƒ½è½¬æ­£æˆåŠŸï¼Œåç»­æƒ…å†µä¸æ¸…æ¥šã€‚\n\nå®ä¹ ç”Ÿ Bï¼šå±±å¤§ç¡•ï¼Œå¤šæ®µå®ä¹ ï¼ˆåŒ…æ‹¬é‡åŒ–ï¼Œå­—èŠ‚å¤šæ®µå®ä¹ ï¼‰å¤§ä½¬ï¼Œ7 æœˆç¦»èŒï¼Œæœªå‚åŠ å®ä¹ è½¬æ­£ï¼ŒæŠ•é€’å­—èŠ‚å¦ä¸€ä¸ªéƒ¨é—¨çš„ç§‹æ‹›æå‰æ‰¹ï¼Œæœ€ç»ˆæ–©è·å¤§ sp offer å¹¶é¡ºåˆ©ç­¾çº¦ã€‚\n\nå®ä¹ ç”Ÿ Cï¼šé‡é‚®æœ¬ï¼Œå‚åŠ æœ¬éƒ¨é—¨å®ä¹ è½¬æ­£ï¼Œé¡ºåˆ©æ”¶åˆ°å° sp offer å¹¶ç­¾çº¦ã€‚\n\nå®ä¹ ç”Ÿ Dï¼šå—å¼€ç¡•ï¼Œç”±äºå®ä¹ æ—¶é—´çŸ­äº§å‡ºä¸è¶³æœªèƒ½è½¬æ­£æˆåŠŸï¼Œç§‹æ‹›æ”¶åˆ°åä¸ºå’Œå†œè¡Œç­‰ offerï¼Œé€‰æ‹© wlb çš„å†œè¡Œã€‚\n\nå®ä¹ ç”Ÿ Eï¼ˆæœ¬äººï¼‰ï¼Œå…·ä½“æƒ…å†µå¯è§æˆ‘çš„[2022ç§‹æ‹›æ€»ç»“](https://yaxing97.com/2022-autumn-recruitment-summary.html) ã€‚\n\nè¿™ä¸¤å¤©çœ‹äº†å¾ˆå¤šè„‰è„‰ï¼Œæœ‰ä¸€ä¸ªè¯„è®ºæˆ‘è§‰å¾—è¯´çš„å¾ˆå¯¹ï¼šâ€œå¾ˆå¤šæš‘æœŸå®ä¹ è¿‡çš„äººï¼Œéƒ½ä¸æƒ³å†å»å¤§å‚äº†ï¼Œé€‰æ‹©å»å›½ä¼ã€‚â€\n\næˆ‘è§‰å¾—è¯´çš„çœŸçš„å¾ˆå¯¹ï¼Œå®ä¹ è¿‡ä½“ä¼šäº†å¤§å‚çš„å·ï¼Œå†µä¸”è¿˜æ˜¯å®ä¹ ç”Ÿï¼Œå½“æ—¶æˆ‘çš„ mentor æ¯”æˆ‘ç´¯å¤šäº†ï¼Œæ¯å¤©æ™šä¸Šå›å»è¿˜è¦å¹²æ´»ã€‚æˆ‘æ¯å¤©å›åˆ°å®¶æ„Ÿè§‰æ•´ä¸ªäººéƒ½è¢«æŠ½ç©ºäº†ï¼Œè™½è¯´æˆ‘å›å®¶çš„ä¹Ÿå¾ˆæ—©ï¼Œä¸€èˆ¬ 8 ç‚¹å·¦å³å°±æ¶¦äº†ã€‚åˆ°å®¶ä»€ä¹ˆéƒ½ä¸æƒ³åšï¼Œæ›´åˆ«æå­¦ä¹ äº†ã€‚å¹¸å¥½ 618 å…¥æ‰‹äº† ps5ï¼Œé æˆ˜ç¥ 4ã€ç‘å¥‡ä¸å®å½“ã€åªç‹¼ç­‰æ¸¸æˆåº¦è¿‡ä¸€ä¸ªåˆä¸€ä¸ªå¤œæ™šï¼Œä¸ç„¶æˆ‘è§‰å¾—æˆ‘å¯èƒ½ä¼šæŠ‘éƒã€‚è¯´å®è¯ï¼Œå¦‚æœæ²¡æœ‰è¿™æ®µæš‘æœŸå®ä¹ ï¼Œæˆ‘æ‹¿åˆ°å­—èŠ‚ç­‰å¤§å‚ offer å¯èƒ½æ— è„‘å»äº†ï¼Œç»å†è¿‡æ‰çŸ¥é“è‡ªå·±æ‰€èƒ½æ‰¿å—çš„èº«å¿ƒå‹åŠ›ã€‚\n\nå› æ­¤ï¼Œæš‘æœŸå®ä¹ è¿˜æ˜¯æ¨èå»å¤§å‚çš„ï¼Œä¸€æ–¹é¢ç»™ç§‹æ‹›ç®€å†æ¶¦è‰²ï¼Œå¦ä¸€æ–¹é¢çœ‹çœ‹è‡ªå·±æ˜¯å¦èƒ½é€‚åº”å¤§å‚å·¥ä½œç”Ÿæ´»èŠ‚å¥ã€‚\n\nä»¥ä¸Šã€‚\n","source":"_posts/å­—èŠ‚æš‘æœŸå®ä¹ åŒç»„å®ä¹ ç”Ÿç§‹æ‹›æƒ…å†µåˆ†äº«.md","raw":"---\ntitle: å­—èŠ‚æš‘æœŸå®ä¹ åŒç»„å®ä¹ ç”Ÿç§‹æ‹›æƒ…å†µåˆ†äº«\ncopyright: true\nmathjax: true\ndate: 2022-12-13 20:02:14\ncategories: \n  - å®ä¹ ç§‹æ‹›\n  - å®ä¹ \ntags: \nurlname: my-bytedance-internship-friends-offer\n---\n\nçªç„¶æƒ³èµ·æ¥åšè¿™ä¸ªåˆ†äº«ï¼Œæ˜¯å› ä¸ºåˆšå¥½ä¸‹åˆæœ‰ä¸ªå­—èŠ‚è·³åŠ¨æš‘æœŸå®ä¹ æ—¶åŒç»„çš„æœ‹å‹åˆšç­¾çº¦ä¸‰æ–¹ï¼Œå’Œçˆ¶æ¯ä¹Ÿé¡ºä¾¿åˆ†äº«äº†å…¶ä»–åŒç»„å®ä¹ ç”Ÿçš„ç­¾çº¦æƒ…å†µã€‚è¿™è¾¹ä¹Ÿç»™å¤§å®¶åˆ†äº«ä¸‹ã€‚\n\n<!--more-->\n\nåœ¨å­—èŠ‚è·³åŠ¨æš‘æœŸå®ä¹ æœŸé—´ï¼Œå‰å‰åååŠ ä¸Šæˆ‘ä¸€å…±æœ‰ 5 åå®ä¹ ç”Ÿã€‚\n\nå®ä¹ ç”Ÿ Aï¼šæµ™å¤§ç¡•ï¼Œåœ¨æˆ‘ä»¬ç»„ä» 4 æœˆä¸­å¹²åˆ° 7 æœˆä¸­ï¼Œèµ°å­—èŠ‚çš„æ´»æ°´å¹³å°æ´»æ°´åˆ°å…¶ä»–éƒ¨é—¨ç»§ç»­æš‘æœŸå®ä¹ äº†ï¼Œæœªèƒ½è½¬æ­£æˆåŠŸï¼Œåç»­æƒ…å†µä¸æ¸…æ¥šã€‚\n\nå®ä¹ ç”Ÿ Bï¼šå±±å¤§ç¡•ï¼Œå¤šæ®µå®ä¹ ï¼ˆåŒ…æ‹¬é‡åŒ–ï¼Œå­—èŠ‚å¤šæ®µå®ä¹ ï¼‰å¤§ä½¬ï¼Œ7 æœˆç¦»èŒï¼Œæœªå‚åŠ å®ä¹ è½¬æ­£ï¼ŒæŠ•é€’å­—èŠ‚å¦ä¸€ä¸ªéƒ¨é—¨çš„ç§‹æ‹›æå‰æ‰¹ï¼Œæœ€ç»ˆæ–©è·å¤§ sp offer å¹¶é¡ºåˆ©ç­¾çº¦ã€‚\n\nå®ä¹ ç”Ÿ Cï¼šé‡é‚®æœ¬ï¼Œå‚åŠ æœ¬éƒ¨é—¨å®ä¹ è½¬æ­£ï¼Œé¡ºåˆ©æ”¶åˆ°å° sp offer å¹¶ç­¾çº¦ã€‚\n\nå®ä¹ ç”Ÿ Dï¼šå—å¼€ç¡•ï¼Œç”±äºå®ä¹ æ—¶é—´çŸ­äº§å‡ºä¸è¶³æœªèƒ½è½¬æ­£æˆåŠŸï¼Œç§‹æ‹›æ”¶åˆ°åä¸ºå’Œå†œè¡Œç­‰ offerï¼Œé€‰æ‹© wlb çš„å†œè¡Œã€‚\n\nå®ä¹ ç”Ÿ Eï¼ˆæœ¬äººï¼‰ï¼Œå…·ä½“æƒ…å†µå¯è§æˆ‘çš„[2022ç§‹æ‹›æ€»ç»“](https://yaxing97.com/2022-autumn-recruitment-summary.html) ã€‚\n\nè¿™ä¸¤å¤©çœ‹äº†å¾ˆå¤šè„‰è„‰ï¼Œæœ‰ä¸€ä¸ªè¯„è®ºæˆ‘è§‰å¾—è¯´çš„å¾ˆå¯¹ï¼šâ€œå¾ˆå¤šæš‘æœŸå®ä¹ è¿‡çš„äººï¼Œéƒ½ä¸æƒ³å†å»å¤§å‚äº†ï¼Œé€‰æ‹©å»å›½ä¼ã€‚â€\n\næˆ‘è§‰å¾—è¯´çš„çœŸçš„å¾ˆå¯¹ï¼Œå®ä¹ è¿‡ä½“ä¼šäº†å¤§å‚çš„å·ï¼Œå†µä¸”è¿˜æ˜¯å®ä¹ ç”Ÿï¼Œå½“æ—¶æˆ‘çš„ mentor æ¯”æˆ‘ç´¯å¤šäº†ï¼Œæ¯å¤©æ™šä¸Šå›å»è¿˜è¦å¹²æ´»ã€‚æˆ‘æ¯å¤©å›åˆ°å®¶æ„Ÿè§‰æ•´ä¸ªäººéƒ½è¢«æŠ½ç©ºäº†ï¼Œè™½è¯´æˆ‘å›å®¶çš„ä¹Ÿå¾ˆæ—©ï¼Œä¸€èˆ¬ 8 ç‚¹å·¦å³å°±æ¶¦äº†ã€‚åˆ°å®¶ä»€ä¹ˆéƒ½ä¸æƒ³åšï¼Œæ›´åˆ«æå­¦ä¹ äº†ã€‚å¹¸å¥½ 618 å…¥æ‰‹äº† ps5ï¼Œé æˆ˜ç¥ 4ã€ç‘å¥‡ä¸å®å½“ã€åªç‹¼ç­‰æ¸¸æˆåº¦è¿‡ä¸€ä¸ªåˆä¸€ä¸ªå¤œæ™šï¼Œä¸ç„¶æˆ‘è§‰å¾—æˆ‘å¯èƒ½ä¼šæŠ‘éƒã€‚è¯´å®è¯ï¼Œå¦‚æœæ²¡æœ‰è¿™æ®µæš‘æœŸå®ä¹ ï¼Œæˆ‘æ‹¿åˆ°å­—èŠ‚ç­‰å¤§å‚ offer å¯èƒ½æ— è„‘å»äº†ï¼Œç»å†è¿‡æ‰çŸ¥é“è‡ªå·±æ‰€èƒ½æ‰¿å—çš„èº«å¿ƒå‹åŠ›ã€‚\n\nå› æ­¤ï¼Œæš‘æœŸå®ä¹ è¿˜æ˜¯æ¨èå»å¤§å‚çš„ï¼Œä¸€æ–¹é¢ç»™ç§‹æ‹›ç®€å†æ¶¦è‰²ï¼Œå¦ä¸€æ–¹é¢çœ‹çœ‹è‡ªå·±æ˜¯å¦èƒ½é€‚åº”å¤§å‚å·¥ä½œç”Ÿæ´»èŠ‚å¥ã€‚\n\nä»¥ä¸Šã€‚\n","slug":"å­—èŠ‚æš‘æœŸå®ä¹ åŒç»„å®ä¹ ç”Ÿç§‹æ‹›æƒ…å†µåˆ†äº«","published":1,"updated":"2023-01-26T12:35:58.981Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cldzfw326000vt9t81ihgaxuw","content":"<p>çªç„¶æƒ³èµ·æ¥åšè¿™ä¸ªåˆ†äº«ï¼Œæ˜¯å› ä¸ºåˆšå¥½ä¸‹åˆæœ‰ä¸ªå­—èŠ‚è·³åŠ¨æš‘æœŸå®ä¹ æ—¶åŒç»„çš„æœ‹å‹åˆšç­¾çº¦ä¸‰æ–¹ï¼Œå’Œçˆ¶æ¯ä¹Ÿé¡ºä¾¿åˆ†äº«äº†å…¶ä»–åŒç»„å®ä¹ ç”Ÿçš„ç­¾çº¦æƒ…å†µã€‚è¿™è¾¹ä¹Ÿç»™å¤§å®¶åˆ†äº«ä¸‹ã€‚</p>\n<span id=\"more\"></span>\n\n<p>åœ¨å­—èŠ‚è·³åŠ¨æš‘æœŸå®ä¹ æœŸé—´ï¼Œå‰å‰åååŠ ä¸Šæˆ‘ä¸€å…±æœ‰ 5 åå®ä¹ ç”Ÿã€‚</p>\n<p>å®ä¹ ç”Ÿ Aï¼šæµ™å¤§ç¡•ï¼Œåœ¨æˆ‘ä»¬ç»„ä» 4 æœˆä¸­å¹²åˆ° 7 æœˆä¸­ï¼Œèµ°å­—èŠ‚çš„æ´»æ°´å¹³å°æ´»æ°´åˆ°å…¶ä»–éƒ¨é—¨ç»§ç»­æš‘æœŸå®ä¹ äº†ï¼Œæœªèƒ½è½¬æ­£æˆåŠŸï¼Œåç»­æƒ…å†µä¸æ¸…æ¥šã€‚</p>\n<p>å®ä¹ ç”Ÿ Bï¼šå±±å¤§ç¡•ï¼Œå¤šæ®µå®ä¹ ï¼ˆåŒ…æ‹¬é‡åŒ–ï¼Œå­—èŠ‚å¤šæ®µå®ä¹ ï¼‰å¤§ä½¬ï¼Œ7 æœˆç¦»èŒï¼Œæœªå‚åŠ å®ä¹ è½¬æ­£ï¼ŒæŠ•é€’å­—èŠ‚å¦ä¸€ä¸ªéƒ¨é—¨çš„ç§‹æ‹›æå‰æ‰¹ï¼Œæœ€ç»ˆæ–©è·å¤§ sp offer å¹¶é¡ºåˆ©ç­¾çº¦ã€‚</p>\n<p>å®ä¹ ç”Ÿ Cï¼šé‡é‚®æœ¬ï¼Œå‚åŠ æœ¬éƒ¨é—¨å®ä¹ è½¬æ­£ï¼Œé¡ºåˆ©æ”¶åˆ°å° sp offer å¹¶ç­¾çº¦ã€‚</p>\n<p>å®ä¹ ç”Ÿ Dï¼šå—å¼€ç¡•ï¼Œç”±äºå®ä¹ æ—¶é—´çŸ­äº§å‡ºä¸è¶³æœªèƒ½è½¬æ­£æˆåŠŸï¼Œç§‹æ‹›æ”¶åˆ°åä¸ºå’Œå†œè¡Œç­‰ offerï¼Œé€‰æ‹© wlb çš„å†œè¡Œã€‚</p>\n<p>å®ä¹ ç”Ÿ Eï¼ˆæœ¬äººï¼‰ï¼Œå…·ä½“æƒ…å†µå¯è§æˆ‘çš„<a href=\"https://yaxing97.com/2022-autumn-recruitment-summary.html\">2022ç§‹æ‹›æ€»ç»“</a> ã€‚</p>\n<p>è¿™ä¸¤å¤©çœ‹äº†å¾ˆå¤šè„‰è„‰ï¼Œæœ‰ä¸€ä¸ªè¯„è®ºæˆ‘è§‰å¾—è¯´çš„å¾ˆå¯¹ï¼šâ€œå¾ˆå¤šæš‘æœŸå®ä¹ è¿‡çš„äººï¼Œéƒ½ä¸æƒ³å†å»å¤§å‚äº†ï¼Œé€‰æ‹©å»å›½ä¼ã€‚â€</p>\n<p>æˆ‘è§‰å¾—è¯´çš„çœŸçš„å¾ˆå¯¹ï¼Œå®ä¹ è¿‡ä½“ä¼šäº†å¤§å‚çš„å·ï¼Œå†µä¸”è¿˜æ˜¯å®ä¹ ç”Ÿï¼Œå½“æ—¶æˆ‘çš„ mentor æ¯”æˆ‘ç´¯å¤šäº†ï¼Œæ¯å¤©æ™šä¸Šå›å»è¿˜è¦å¹²æ´»ã€‚æˆ‘æ¯å¤©å›åˆ°å®¶æ„Ÿè§‰æ•´ä¸ªäººéƒ½è¢«æŠ½ç©ºäº†ï¼Œè™½è¯´æˆ‘å›å®¶çš„ä¹Ÿå¾ˆæ—©ï¼Œä¸€èˆ¬ 8 ç‚¹å·¦å³å°±æ¶¦äº†ã€‚åˆ°å®¶ä»€ä¹ˆéƒ½ä¸æƒ³åšï¼Œæ›´åˆ«æå­¦ä¹ äº†ã€‚å¹¸å¥½ 618 å…¥æ‰‹äº† ps5ï¼Œé æˆ˜ç¥ 4ã€ç‘å¥‡ä¸å®å½“ã€åªç‹¼ç­‰æ¸¸æˆåº¦è¿‡ä¸€ä¸ªåˆä¸€ä¸ªå¤œæ™šï¼Œä¸ç„¶æˆ‘è§‰å¾—æˆ‘å¯èƒ½ä¼šæŠ‘éƒã€‚è¯´å®è¯ï¼Œå¦‚æœæ²¡æœ‰è¿™æ®µæš‘æœŸå®ä¹ ï¼Œæˆ‘æ‹¿åˆ°å­—èŠ‚ç­‰å¤§å‚ offer å¯èƒ½æ— è„‘å»äº†ï¼Œç»å†è¿‡æ‰çŸ¥é“è‡ªå·±æ‰€èƒ½æ‰¿å—çš„èº«å¿ƒå‹åŠ›ã€‚</p>\n<p>å› æ­¤ï¼Œæš‘æœŸå®ä¹ è¿˜æ˜¯æ¨èå»å¤§å‚çš„ï¼Œä¸€æ–¹é¢ç»™ç§‹æ‹›ç®€å†æ¶¦è‰²ï¼Œå¦ä¸€æ–¹é¢çœ‹çœ‹è‡ªå·±æ˜¯å¦èƒ½é€‚åº”å¤§å‚å·¥ä½œç”Ÿæ´»èŠ‚å¥ã€‚</p>\n<p>ä»¥ä¸Šã€‚</p>\n","site":{"data":{}},"length":664,"excerpt":"<p>çªç„¶æƒ³èµ·æ¥åšè¿™ä¸ªåˆ†äº«ï¼Œæ˜¯å› ä¸ºåˆšå¥½ä¸‹åˆæœ‰ä¸ªå­—èŠ‚è·³åŠ¨æš‘æœŸå®ä¹ æ—¶åŒç»„çš„æœ‹å‹åˆšç­¾çº¦ä¸‰æ–¹ï¼Œå’Œçˆ¶æ¯ä¹Ÿé¡ºä¾¿åˆ†äº«äº†å…¶ä»–åŒç»„å®ä¹ ç”Ÿçš„ç­¾çº¦æƒ…å†µã€‚è¿™è¾¹ä¹Ÿç»™å¤§å®¶åˆ†äº«ä¸‹ã€‚</p>","more":"<p>åœ¨å­—èŠ‚è·³åŠ¨æš‘æœŸå®ä¹ æœŸé—´ï¼Œå‰å‰åååŠ ä¸Šæˆ‘ä¸€å…±æœ‰ 5 åå®ä¹ ç”Ÿã€‚</p>\n<p>å®ä¹ ç”Ÿ Aï¼šæµ™å¤§ç¡•ï¼Œåœ¨æˆ‘ä»¬ç»„ä» 4 æœˆä¸­å¹²åˆ° 7 æœˆä¸­ï¼Œèµ°å­—èŠ‚çš„æ´»æ°´å¹³å°æ´»æ°´åˆ°å…¶ä»–éƒ¨é—¨ç»§ç»­æš‘æœŸå®ä¹ äº†ï¼Œæœªèƒ½è½¬æ­£æˆåŠŸï¼Œåç»­æƒ…å†µä¸æ¸…æ¥šã€‚</p>\n<p>å®ä¹ ç”Ÿ Bï¼šå±±å¤§ç¡•ï¼Œå¤šæ®µå®ä¹ ï¼ˆåŒ…æ‹¬é‡åŒ–ï¼Œå­—èŠ‚å¤šæ®µå®ä¹ ï¼‰å¤§ä½¬ï¼Œ7 æœˆç¦»èŒï¼Œæœªå‚åŠ å®ä¹ è½¬æ­£ï¼ŒæŠ•é€’å­—èŠ‚å¦ä¸€ä¸ªéƒ¨é—¨çš„ç§‹æ‹›æå‰æ‰¹ï¼Œæœ€ç»ˆæ–©è·å¤§ sp offer å¹¶é¡ºåˆ©ç­¾çº¦ã€‚</p>\n<p>å®ä¹ ç”Ÿ Cï¼šé‡é‚®æœ¬ï¼Œå‚åŠ æœ¬éƒ¨é—¨å®ä¹ è½¬æ­£ï¼Œé¡ºåˆ©æ”¶åˆ°å° sp offer å¹¶ç­¾çº¦ã€‚</p>\n<p>å®ä¹ ç”Ÿ Dï¼šå—å¼€ç¡•ï¼Œç”±äºå®ä¹ æ—¶é—´çŸ­äº§å‡ºä¸è¶³æœªèƒ½è½¬æ­£æˆåŠŸï¼Œç§‹æ‹›æ”¶åˆ°åä¸ºå’Œå†œè¡Œç­‰ offerï¼Œé€‰æ‹© wlb çš„å†œè¡Œã€‚</p>\n<p>å®ä¹ ç”Ÿ Eï¼ˆæœ¬äººï¼‰ï¼Œå…·ä½“æƒ…å†µå¯è§æˆ‘çš„<a href=\"https://yaxing97.com/2022-autumn-recruitment-summary.html\">2022ç§‹æ‹›æ€»ç»“</a> ã€‚</p>\n<p>è¿™ä¸¤å¤©çœ‹äº†å¾ˆå¤šè„‰è„‰ï¼Œæœ‰ä¸€ä¸ªè¯„è®ºæˆ‘è§‰å¾—è¯´çš„å¾ˆå¯¹ï¼šâ€œå¾ˆå¤šæš‘æœŸå®ä¹ è¿‡çš„äººï¼Œéƒ½ä¸æƒ³å†å»å¤§å‚äº†ï¼Œé€‰æ‹©å»å›½ä¼ã€‚â€</p>\n<p>æˆ‘è§‰å¾—è¯´çš„çœŸçš„å¾ˆå¯¹ï¼Œå®ä¹ è¿‡ä½“ä¼šäº†å¤§å‚çš„å·ï¼Œå†µä¸”è¿˜æ˜¯å®ä¹ ç”Ÿï¼Œå½“æ—¶æˆ‘çš„ mentor æ¯”æˆ‘ç´¯å¤šäº†ï¼Œæ¯å¤©æ™šä¸Šå›å»è¿˜è¦å¹²æ´»ã€‚æˆ‘æ¯å¤©å›åˆ°å®¶æ„Ÿè§‰æ•´ä¸ªäººéƒ½è¢«æŠ½ç©ºäº†ï¼Œè™½è¯´æˆ‘å›å®¶çš„ä¹Ÿå¾ˆæ—©ï¼Œä¸€èˆ¬ 8 ç‚¹å·¦å³å°±æ¶¦äº†ã€‚åˆ°å®¶ä»€ä¹ˆéƒ½ä¸æƒ³åšï¼Œæ›´åˆ«æå­¦ä¹ äº†ã€‚å¹¸å¥½ 618 å…¥æ‰‹äº† ps5ï¼Œé æˆ˜ç¥ 4ã€ç‘å¥‡ä¸å®å½“ã€åªç‹¼ç­‰æ¸¸æˆåº¦è¿‡ä¸€ä¸ªåˆä¸€ä¸ªå¤œæ™šï¼Œä¸ç„¶æˆ‘è§‰å¾—æˆ‘å¯èƒ½ä¼šæŠ‘éƒã€‚è¯´å®è¯ï¼Œå¦‚æœæ²¡æœ‰è¿™æ®µæš‘æœŸå®ä¹ ï¼Œæˆ‘æ‹¿åˆ°å­—èŠ‚ç­‰å¤§å‚ offer å¯èƒ½æ— è„‘å»äº†ï¼Œç»å†è¿‡æ‰çŸ¥é“è‡ªå·±æ‰€èƒ½æ‰¿å—çš„èº«å¿ƒå‹åŠ›ã€‚</p>\n<p>å› æ­¤ï¼Œæš‘æœŸå®ä¹ è¿˜æ˜¯æ¨èå»å¤§å‚çš„ï¼Œä¸€æ–¹é¢ç»™ç§‹æ‹›ç®€å†æ¶¦è‰²ï¼Œå¦ä¸€æ–¹é¢çœ‹çœ‹è‡ªå·±æ˜¯å¦èƒ½é€‚åº”å¤§å‚å·¥ä½œç”Ÿæ´»èŠ‚å¥ã€‚</p>\n<p>ä»¥ä¸Šã€‚</p>"},{"title":"Javaå…«è‚¡æ–‡ - è®¡ç®—æœºç½‘ç»œ","copyright":true,"mathjax":false,"date":"2023-01-25T05:44:16.000Z","toc":true,"urlname":"computer-network","_content":"\n> æ•´ç†çš„è®¡ç®—æœºç½‘ç»œç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½\t<!--more-->\n\n## æ·±å…¥ç†è§£HTTPSå·¥ä½œåŸç†\n\n> https://juejin.cn/post/6844903830916694030\n\n### å‰è¨€\n\nè¿‘å‡ å¹´ï¼Œäº’è”ç½‘å‘ç”Ÿç€ç¿»å¤©è¦†åœ°çš„å˜åŒ–ï¼Œå°¤å…¶æ˜¯æˆ‘ä»¬ä¸€ç›´ä¹ ä»¥ä¸ºå¸¸çš„ HTTP åè®®ï¼Œåœ¨é€æ¸çš„è¢« HTTPS åè®®æ‰€å–ä»£ï¼Œåœ¨æµè§ˆå™¨ã€æœç´¢å¼•æ“ã€CA æœºæ„ã€å¤§å‹äº’è”ç½‘ä¼ä¸šçš„å…±åŒä¿ƒè¿›ä¸‹ï¼Œäº’è”ç½‘è¿æ¥äº†â€œHTTPS åŠ å¯†æ—¶ä»£â€ï¼ŒHTTPS å°†åœ¨æœªæ¥çš„å‡ å¹´å†…å…¨é¢å–ä»£ HTTP æˆä¸ºä¼ è¾“åè®®çš„ä¸»æµã€‚\n\nè¯»å®Œæœ¬æ–‡ï¼Œå¸Œæœ›ä½ èƒ½æ˜ç™½ï¼š\n\n- HTTP é€šä¿¡å­˜åœ¨ä»€ä¹ˆé—®é¢˜\n- HTTPS å¦‚ä½•æ”¹è¿› HTTP å­˜åœ¨é‚£äº›é—®é¢˜\n- HTTPS å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆ\n\n### ä¸€ã€ä»€ä¹ˆæ˜¯HTTPS\n\nHTTPS æ˜¯åœ¨ HTTP ä¸Šå»ºç«‹ SSL åŠ å¯†å±‚ï¼Œå¹¶å¯¹ä¼ è¾“æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œæ˜¯ HTTP åè®®çš„å®‰å…¨ç‰ˆã€‚ç°åœ¨å®ƒè¢«å¹¿æ³›ç”¨äºä¸‡ç»´ç½‘ä¸Šå®‰å…¨æ•æ„Ÿçš„é€šè®¯ï¼Œä¾‹å¦‚äº¤æ˜“æ”¯ä»˜æ–¹é¢ã€‚\n\nHTTPS ä¸»è¦ä½œç”¨æ˜¯ï¼š\n\nï¼ˆ1ï¼‰å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œå¹¶å»ºç«‹ä¸€ä¸ªä¿¡æ¯å®‰å…¨é€šé“ï¼Œæ¥ä¿è¯ä¼ è¾“è¿‡ç¨‹ä¸­çš„æ•°æ®å®‰å…¨;\n\nï¼ˆ2ï¼‰å¯¹ç½‘ç«™æœåŠ¡å™¨è¿›è¡ŒçœŸå®èº«ä»½è®¤è¯ã€‚\n\næˆ‘ä»¬ç»å¸¸ä¼šåœ¨ Web çš„ç™»å½•é¡µé¢å’Œè´­ç‰©ç»“ç®—ç•Œé¢ç­‰ä½¿ç”¨ HTTPS é€šä¿¡ã€‚ä½¿ç”¨ HTTPS é€šä¿¡æ—¶ï¼Œä¸å†ç”¨`http://`ï¼Œè€Œæ˜¯æ”¹ç”¨`https://`ã€‚å¦å¤–ï¼Œå½“æµè§ˆå™¨è®¿é—® HTTPS é€šä¿¡æœ‰æ•ˆçš„ Web ç½‘ç«™æ—¶ï¼Œæµè§ˆå™¨çš„åœ°å€æ å†…ä¼šå‡ºç°ä¸€ä¸ªå¸¦é”çš„æ ‡è®°ã€‚å¯¹ HTTPS çš„æ˜¾ç¤ºæ–¹å¼ä¼šå› æµè§ˆå™¨çš„ä¸åŒè€Œæœ‰æ‰€æ”¹å˜ã€‚\n\n### äºŒã€ä¸ºä»€ä¹ˆéœ€è¦HTTPS\n\nåœ¨ HTTP åè®®ä¸­æœ‰å¯èƒ½å­˜åœ¨ä¿¡æ¯çªƒå–æˆ–èº«ä»½ä¼ªè£…ç­‰å®‰å…¨é—®é¢˜ã€‚ä½¿ç”¨ HTTPS é€šä¿¡æœºåˆ¶å¯ä»¥æœ‰æ•ˆåœ°é˜²æ­¢è¿™äº›é—®é¢˜ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£ä¸‹ HTTP åè®®å­˜åœ¨çš„å“ªäº›é—®é¢˜ï¼š\n\n- é€šä¿¡ä½¿ç”¨æ˜æ–‡ï¼ˆä¸åŠ å¯†ï¼‰ï¼Œå†…å®¹å¯èƒ½è¢«**çªƒå¬** \n\n\tä¿¡æ¯åŠ å¯†ï¼šä½¿ç”¨éå¯¹ç§°åŠ å¯†ï¼ˆRSAï¼‰äº¤æ¢å¯†é’¥ï¼Œä½¿ç”¨å¯¹ç§°åŠ å¯†ï¼ˆAESï¼‰ä¼ è¾“æŠ¥æ–‡ï¼Œå…¼å¤‡å®‰å…¨ä¸æ•ˆç‡\n\n- æ— æ³•è¯æ˜æŠ¥æ–‡çš„å®Œæ•´æ€§ï¼Œæ‰€ä»¥å¯èƒ½é­**ç¯¡æ”¹** \n\n\tå®Œæ•´æ€§æ ¡éªŒï¼šæ•°å­—ç­¾å\n\n- ä¸éªŒè¯é€šä¿¡æ–¹çš„èº«ä»½ï¼Œå› æ­¤æœ‰å¯èƒ½é­é‡**ä¼ªè£…** \n\n\tèº«ä»½éªŒè¯ï¼šæ•°å­—è¯ä¹¦\n\n### ä¸‰ã€HTTPSå¦‚ä½•è§£å†³HTTPä¸Šè¿°é—®é¢˜?\n\n**æ‰€è°“HTTPSï¼Œå…¶å®å°±æ˜¯èº«æŠ«SSLåè®®è¿™å±‚å¤–å£³çš„HTTP**ã€‚\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422132445345.png\" alt=\"image-20220422132445345\" style=\"zoom:33%;\" />\n\n\n\nåœ¨é‡‡ç”¨ SSL åï¼ŒHTTP å°±æ‹¥æœ‰äº† HTTPS çš„åŠ å¯†ã€å®Œæ•´æ€§æ ¡éªŒã€èº«ä»½éªŒè¯è¿™äº›åŠŸèƒ½ã€‚ä¹Ÿå°±æ˜¯è¯´**HTTPåŠ ä¸ŠåŠ å¯†å¤„ç†å’Œè®¤è¯ä»¥åŠå®Œæ•´æ€§ä¿æŠ¤åå³æ˜¯HTTPS**ã€‚\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422132508534.png\" alt=\"image-20220422132508534\" style=\"zoom:33%;\" />\n\nHTTPS åè®®çš„ä¸»è¦åŠŸèƒ½åŸºæœ¬éƒ½ä¾èµ–äº TLS/SSL åè®®ï¼ŒTLS/SSL çš„åŠŸèƒ½å®ç°ä¸»è¦ä¾èµ–äºä¸‰ç±»åŸºæœ¬ç®—æ³•ï¼šæ•£åˆ—å‡½æ•° ã€å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†ï¼Œ**å…¶åˆ©ç”¨éå¯¹ç§°åŠ å¯†å®ç°èº«ä»½è®¤è¯å’Œå¯†é’¥åå•†ï¼Œå¯¹ç§°åŠ å¯†ç®—æ³•é‡‡ç”¨åå•†çš„å¯†é’¥å¯¹æ•°æ®åŠ å¯†ï¼ŒåŸºäºæ•£åˆ—å‡½æ•°éªŒè¯ä¿¡æ¯çš„å®Œæ•´æ€§**ã€‚\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422132525551.png\" alt=\"image-20220422132525551\" style=\"zoom:33%;\" />\n\n\n\n#### 1.è§£å†³å†…å®¹å¯èƒ½è¢«çªƒå¬çš„é—®é¢˜â€”â€”åŠ å¯†\n\n#### æ–¹æ³•1.å¯¹ç§°åŠ å¯†\n\nè¿™ç§æ–¹å¼åŠ å¯†å’Œè§£å¯†åŒç”¨ä¸€ä¸ªå¯†é’¥ã€‚åŠ å¯†å’Œè§£å¯†éƒ½ä¼šç”¨åˆ°å¯†é’¥ã€‚**æ²¡æœ‰å¯†é’¥å°±æ— æ³•å¯¹å¯†ç è§£å¯†ï¼Œåè¿‡æ¥è¯´ï¼Œä»»ä½•äººåªè¦æŒæœ‰å¯†é’¥å°±èƒ½è§£å¯†äº†**ã€‚\n\nä»¥å¯¹ç§°åŠ å¯†æ–¹å¼åŠ å¯†æ—¶å¿…é¡»å°†å¯†é’¥ä¹Ÿå‘ç»™å¯¹æ–¹ã€‚å¯ç©¶ç«Ÿæ€æ ·æ‰èƒ½å®‰å…¨åœ°è½¬äº¤ï¼Ÿåœ¨äº’è”ç½‘ä¸Šè½¬å‘å¯†é’¥æ—¶ï¼Œå¦‚æœé€šä¿¡è¢«ç›‘å¬é‚£ä¹ˆå¯†é’¥å°±å¯ä¼šè½äººæ”»å‡»è€…ä¹‹æ‰‹ï¼ŒåŒæ—¶ä¹Ÿå°±å¤±å»äº†åŠ å¯†çš„æ„ä¹‰ã€‚å¦å¤–è¿˜å¾—è®¾æ³•å®‰å…¨åœ°ä¿ç®¡æ¥æ”¶åˆ°çš„å¯†é’¥ã€‚\n\n#### æ–¹æ³•2.éå¯¹ç§°åŠ å¯†\n\nå…¬å¼€å¯†é’¥åŠ å¯†ä½¿ç”¨ä¸€å¯¹éå¯¹ç§°çš„å¯†é’¥ã€‚ä¸€æŠŠå«åšç§æœ‰å¯†é’¥ï¼Œå¦ä¸€æŠŠå«åšå…¬å¼€å¯†é’¥ã€‚é¡¾åæ€ä¹‰ï¼Œ**ç§æœ‰å¯†é’¥ä¸èƒ½è®©å…¶ä»–ä»»ä½•äººçŸ¥é“ï¼Œè€Œå…¬å¼€å¯†é’¥åˆ™å¯ä»¥éšæ„å‘å¸ƒï¼Œä»»ä½•äººéƒ½å¯ä»¥è·å¾—**ã€‚\n\nä½¿ç”¨å…¬å¼€å¯†é’¥åŠ å¯†æ–¹å¼ï¼Œå‘é€å¯†æ–‡çš„ä¸€æ–¹ä½¿ç”¨**å¯¹æ–¹çš„å…¬å¼€å¯†é’¥**è¿›è¡ŒåŠ å¯†å¤„ç†ï¼Œå¯¹æ–¹æ”¶åˆ°è¢«åŠ å¯†çš„ä¿¡æ¯åï¼Œå†ä½¿ç”¨è‡ªå·±çš„ç§æœ‰å¯†é’¥è¿›è¡Œè§£å¯†ã€‚åˆ©ç”¨è¿™ç§æ–¹å¼ï¼Œä¸éœ€è¦å‘é€ç”¨æ¥è§£å¯†çš„ç§æœ‰å¯†é’¥ï¼Œä¹Ÿä¸å¿…æ‹…å¿ƒå¯†é’¥è¢«æ”»å‡»è€…çªƒå¬è€Œç›—èµ°ã€‚\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422132541737.png\" alt=\"image-20220422132541737\" style=\"zoom:33%;\" />\n\néå¯¹ç§°åŠ å¯†çš„ç‰¹ç‚¹æ˜¯ä¿¡æ¯ä¼ è¾“ä¸€å¯¹å¤šï¼ŒæœåŠ¡å™¨åªéœ€è¦ç»´æŒä¸€ä¸ªç§é’¥å°±èƒ½å¤Ÿå’Œå¤šä¸ªå®¢æˆ·ç«¯è¿›è¡ŒåŠ å¯†é€šä¿¡ã€‚\n\nè¿™ç§æ–¹å¼æœ‰ä»¥ä¸‹ç¼ºç‚¹ï¼š\n\n- å…¬é’¥æ˜¯å…¬å¼€çš„ï¼Œæ‰€ä»¥é’ˆå¯¹ç§é’¥åŠ å¯†çš„ä¿¡æ¯ï¼Œé»‘å®¢æˆªè·åå¯ä»¥ä½¿ç”¨å…¬é’¥è¿›è¡Œè§£å¯†ï¼Œè·å–å…¶ä¸­çš„å†…å®¹ï¼›\n- å…¬é’¥å¹¶ä¸åŒ…å«æœåŠ¡å™¨çš„ä¿¡æ¯ï¼Œä½¿ç”¨éå¯¹ç§°åŠ å¯†ç®—æ³•æ— æ³•ç¡®ä¿æœåŠ¡å™¨èº«ä»½çš„åˆæ³•æ€§ï¼Œå­˜åœ¨ä¸­é—´äººæ”»å‡»çš„é£é™©ï¼ŒæœåŠ¡å™¨å‘é€ç»™å®¢æˆ·ç«¯çš„å…¬é’¥å¯èƒ½åœ¨ä¼ é€è¿‡ç¨‹ä¸­è¢«ä¸­é—´äººæˆªè·å¹¶ç¯¡æ”¹ï¼›\n- ä½¿ç”¨éå¯¹ç§°åŠ å¯†**åœ¨æ•°æ®åŠ å¯†è§£å¯†è¿‡ç¨‹éœ€è¦æ¶ˆè€—ä¸€å®šæ—¶é—´**ï¼Œé™ä½äº†æ•°æ®ä¼ è¾“æ•ˆç‡ï¼›\n\n#### æ–¹æ³•3.å¯¹ç§°åŠ å¯†+éå¯¹ç§°åŠ å¯†(HTTPSé‡‡ç”¨è¿™ç§æ–¹å¼)\n\nä½¿ç”¨å¯¹ç§°å¯†é’¥çš„å¥½å¤„æ˜¯è§£å¯†çš„æ•ˆç‡æ¯”è¾ƒå¿«ï¼Œä½¿ç”¨éå¯¹ç§°å¯†é’¥çš„å¥½å¤„æ˜¯å¯ä»¥ä½¿å¾—ä¼ è¾“çš„å†…å®¹ä¸èƒ½è¢«ç ´è§£ï¼Œå› ä¸ºå°±ç®—ä½ æ‹¦æˆªåˆ°äº†æ•°æ®ï¼Œä½†æ˜¯æ²¡æœ‰å¯¹åº”çš„ç§é’¥ï¼Œä¹Ÿæ˜¯ä¸èƒ½ç ´è§£å†…å®¹çš„ã€‚å°±æ¯”å¦‚è¯´ä½ æŠ¢åˆ°äº†ä¸€ä¸ªä¿é™©æŸœï¼Œä½†æ˜¯æ²¡æœ‰ä¿é™©æŸœçš„é’¥åŒ™ä¹Ÿä¸èƒ½æ‰“å¼€ä¿é™©æŸœã€‚é‚£æˆ‘ä»¬å°±å°†å¯¹ç§°åŠ å¯†ä¸éå¯¹ç§°åŠ å¯†ç»“åˆèµ·æ¥,å……åˆ†åˆ©ç”¨ä¸¤è€…å„è‡ªçš„ä¼˜åŠ¿ï¼Œ**åœ¨äº¤æ¢å¯†é’¥ç¯èŠ‚ä½¿ç”¨éå¯¹ç§°åŠ å¯†æ–¹å¼ï¼Œä¹‹åçš„å»ºç«‹é€šä¿¡äº¤æ¢æŠ¥æ–‡é˜¶æ®µåˆ™ä½¿ç”¨å¯¹ç§°åŠ å¯†æ–¹å¼**ã€‚\n\nå…·ä½“åšæ³•æ˜¯ï¼š**å‘é€å¯†æ–‡çš„ä¸€æ–¹ä½¿ç”¨å¯¹æ–¹çš„å…¬é’¥è¿›è¡ŒåŠ å¯†å¤„ç†â€œå¯¹ç§°çš„å¯†é’¥â€ï¼Œç„¶åå¯¹æ–¹ç”¨è‡ªå·±çš„ç§é’¥è§£å¯†æ‹¿åˆ°â€œå¯¹ç§°çš„å¯†é’¥â€ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿äº¤æ¢çš„å¯†é’¥æ˜¯å®‰å…¨çš„å‰æä¸‹ï¼Œä½¿ç”¨å¯¹ç§°åŠ å¯†æ–¹å¼è¿›è¡Œé€šä¿¡**ã€‚æ‰€ä»¥ï¼ŒHTTPS é‡‡ç”¨å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†ä¸¤è€…å¹¶ç”¨çš„æ··åˆåŠ å¯†æœºåˆ¶ã€‚\n\n#### 2.è§£å†³æŠ¥æ–‡å¯èƒ½é­ç¯¡æ”¹é—®é¢˜â€”â€”æ•°å­—ç­¾å\n\nç½‘ç»œä¼ è¾“è¿‡ç¨‹ä¸­éœ€è¦ç»è¿‡å¾ˆå¤šä¸­é—´èŠ‚ç‚¹ï¼Œè™½ç„¶æ•°æ®æ— æ³•è¢«è§£å¯†ï¼Œä½†å¯èƒ½è¢«ç¯¡æ”¹ï¼Œé‚£å¦‚ä½•æ ¡éªŒæ•°æ®çš„å®Œæ•´æ€§å‘¢ï¼Ÿ----æ ¡éªŒæ•°å­—ç­¾åã€‚\n\n**æ•°å­—ç­¾åæœ‰ä¸¤ç§åŠŸæ•ˆ**ï¼š\n\n- èƒ½ç¡®å®šæ¶ˆæ¯ç¡®å®æ˜¯ç”±å‘é€æ–¹ç­¾åå¹¶å‘å‡ºæ¥çš„ï¼Œå› ä¸ºåˆ«äººå‡å†’ä¸äº†å‘é€æ–¹çš„ç­¾åã€‚\n- æ•°å­—ç­¾åèƒ½ç¡®å®šæ¶ˆæ¯çš„å®Œæ•´æ€§,è¯æ˜æ•°æ®æ˜¯å¦æœªè¢«ç¯¡æ”¹è¿‡ã€‚\n\n**æ•°å­—ç­¾åå¦‚ä½•ç”Ÿæˆ:**\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422132605229.png\" alt=\"image-20220422132605229\" style=\"zoom:33%;\" />\n\nå°†ä¸€æ®µæ–‡æœ¬å…ˆç”¨ Hash å‡½æ•°ç”Ÿæˆæ¶ˆæ¯æ‘˜è¦ï¼Œç„¶åç”¨å‘é€è€…çš„ç§é’¥åŠ å¯†ç”Ÿæˆæ•°å­—ç­¾åï¼Œä¸åŸæ–‡æ–‡ä¸€èµ·ä¼ é€ç»™æ¥æ”¶è€…ã€‚æ¥ä¸‹æ¥å°±æ˜¯æ¥æ”¶è€…æ ¡éªŒæ•°å­—ç­¾åçš„æµç¨‹äº†ã€‚\n\n**æ ¡éªŒæ•°å­—ç­¾åæµç¨‹**ï¼š\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422132617982.png\" alt=\"image-20220422132617982\" style=\"zoom:33%;\" />\n\næ¥æ”¶è€…åªæœ‰ç”¨å‘é€è€…çš„å…¬é’¥æ‰èƒ½è§£å¯†è¢«åŠ å¯†çš„æ‘˜è¦ä¿¡æ¯ï¼Œç„¶åç”¨ HASH å‡½æ•°å¯¹æ”¶åˆ°çš„åŸæ–‡äº§ç”Ÿä¸€ä¸ªæ‘˜è¦ä¿¡æ¯ï¼Œä¸ä¸Šä¸€æ­¥å¾—åˆ°çš„æ‘˜è¦ä¿¡æ¯å¯¹æ¯”ã€‚å¦‚æœç›¸åŒï¼Œåˆ™è¯´æ˜æ”¶åˆ°çš„ä¿¡æ¯æ˜¯å®Œæ•´çš„ï¼Œåœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ²¡æœ‰è¢«ä¿®æ”¹ï¼Œå¦åˆ™è¯´æ˜ä¿¡æ¯è¢«ä¿®æ”¹è¿‡ï¼Œå› æ­¤æ•°å­—ç­¾åèƒ½å¤ŸéªŒè¯ä¿¡æ¯çš„å®Œæ•´æ€§ã€‚\n\nå‡è®¾æ¶ˆæ¯ä¼ é€’åœ¨ Kobeï¼ŒJames ä¸¤äººä¹‹é—´å‘ç”Ÿã€‚James å°†æ¶ˆæ¯è¿åŒæ•°å­—ç­¾åä¸€èµ·å‘é€ç»™ Kobeï¼ŒKobe æ¥æ”¶åˆ°æ¶ˆæ¯åï¼Œé€šè¿‡æ ¡éªŒæ•°å­—ç­¾åï¼Œå°±å¯ä»¥éªŒè¯æ¥æ”¶åˆ°çš„æ¶ˆæ¯å°±æ˜¯ James å‘é€çš„ã€‚å½“ç„¶ï¼Œè¿™ä¸ªè¿‡ç¨‹çš„å‰ææ˜¯ Kobe çŸ¥é“ James çš„å…¬é’¥ã€‚é—®é¢˜çš„å…³é”®çš„æ˜¯ï¼Œå’Œæ¶ˆæ¯æœ¬èº«ä¸€æ ·ï¼Œå…¬é’¥ä¸èƒ½åœ¨ä¸å®‰å…¨çš„ç½‘ç»œä¸­ç›´æ¥å‘é€ç»™ Kobe,æˆ–è€…è¯´æ‹¿åˆ°çš„å…¬é’¥å¦‚ä½•è¯æ˜æ˜¯ James çš„ã€‚\n\næ­¤æ—¶å°±éœ€è¦å¼•å…¥äº†**è¯ä¹¦é¢å‘æœºæ„**ï¼ˆCertificate Authorityï¼Œç®€ç§° CAï¼‰ï¼ŒCA æ•°é‡å¹¶ä¸å¤šï¼ŒKobe å®¢æˆ·ç«¯å†…ç½®äº†æ‰€æœ‰å—ä¿¡ä»» CA çš„è¯ä¹¦ã€‚CA å¯¹ James çš„å…¬é’¥ï¼ˆå’Œå…¶ä»–ä¿¡æ¯ï¼‰æ•°å­—ç­¾ååç”Ÿæˆè¯ä¹¦ã€‚\n\n#### 3.è§£å†³é€šä¿¡æ–¹èº«ä»½å¯èƒ½è¢«ä¼ªè£…çš„é—®é¢˜â€”â€”æ•°å­—è¯ä¹¦\n\næ•°å­—è¯ä¹¦è®¤è¯æœºæ„å¤„äºå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨åŒæ–¹éƒ½å¯ä¿¡èµ–çš„ç¬¬ä¸‰æ–¹æœºæ„çš„ç«‹åœºä¸Šã€‚\n\næˆ‘ä»¬æ¥ä»‹ç»ä¸€ä¸‹æ•°å­—è¯ä¹¦è®¤è¯æœºæ„çš„ä¸šåŠ¡æµç¨‹ï¼š\n\n- æœåŠ¡å™¨çš„è¿è¥äººå‘˜å‘ç¬¬ä¸‰æ–¹æœºæ„ CA æäº¤å…¬é’¥ã€ç»„ç»‡ä¿¡æ¯ã€ä¸ªäººä¿¡æ¯(åŸŸå)ç­‰ä¿¡æ¯å¹¶ç”³è¯·è®¤è¯;\n- CA é€šè¿‡çº¿ä¸Šã€çº¿ä¸‹ç­‰å¤šç§æ‰‹æ®µéªŒè¯ç”³è¯·è€…æä¾›ä¿¡æ¯çš„çœŸå®æ€§ï¼Œå¦‚ç»„ç»‡æ˜¯å¦å­˜åœ¨ã€ä¼ä¸šæ˜¯å¦åˆæ³•ï¼Œæ˜¯å¦æ‹¥æœ‰åŸŸåçš„æ‰€æœ‰æƒç­‰;\n- å¦‚ä¿¡æ¯å®¡æ ¸é€šè¿‡ï¼ŒCA ä¼šå‘ç”³è¯·è€…ç­¾å‘è®¤è¯æ–‡ä»¶-è¯ä¹¦ã€‚è¯ä¹¦åŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼šç”³è¯·è€…å…¬é’¥ã€ç”³è¯·è€…çš„ç»„ç»‡ä¿¡æ¯å’Œä¸ªäººä¿¡æ¯ã€ç­¾å‘æœºæ„ CA çš„ä¿¡æ¯ã€æœ‰æ•ˆæ—¶é—´ã€è¯ä¹¦åºåˆ—å·ç­‰ä¿¡æ¯çš„æ˜æ–‡ï¼ŒåŒæ—¶åŒ…å«ä¸€ä¸ªç­¾åã€‚ å…¶ä¸­ç­¾åçš„äº§ç”Ÿç®—æ³•ï¼šé¦–å…ˆï¼Œä½¿ç”¨æ•£åˆ—å‡½æ•°è®¡ç®—å…¬å¼€çš„æ˜æ–‡ä¿¡æ¯çš„ä¿¡æ¯æ‘˜è¦ï¼Œç„¶åï¼Œé‡‡ç”¨ CA çš„ç§é’¥å¯¹ä¿¡æ¯æ‘˜è¦è¿›è¡ŒåŠ å¯†ï¼Œå¯†æ–‡å³ç­¾å;\n- å®¢æˆ·ç«¯ Client å‘æœåŠ¡å™¨ Server å‘å‡ºè¯·æ±‚æ—¶ï¼ŒServer è¿”å›è¯ä¹¦æ–‡ä»¶;\n- å®¢æˆ·ç«¯ Client è¯»å–è¯ä¹¦ä¸­çš„ç›¸å…³çš„æ˜æ–‡ä¿¡æ¯ï¼Œé‡‡ç”¨ç›¸åŒçš„æ•£åˆ—å‡½æ•°è®¡ç®—å¾—åˆ°ä¿¡æ¯æ‘˜è¦ï¼Œç„¶åï¼Œåˆ©ç”¨å¯¹åº” CA çš„å…¬é’¥è§£å¯†ç­¾åæ•°æ®ï¼Œå¯¹æ¯”è¯ä¹¦çš„ä¿¡æ¯æ‘˜è¦ï¼Œå¦‚æœä¸€è‡´ï¼Œåˆ™å¯ä»¥ç¡®è®¤è¯ä¹¦çš„åˆæ³•æ€§ï¼Œå³æœåŠ¡å™¨çš„å…¬å¼€å¯†é’¥æ˜¯å€¼å¾—ä¿¡èµ–çš„ã€‚\n- å®¢æˆ·ç«¯è¿˜ä¼šéªŒè¯è¯ä¹¦ç›¸å…³çš„åŸŸåä¿¡æ¯ã€æœ‰æ•ˆæ—¶é—´ç­‰ä¿¡æ¯; å®¢æˆ·ç«¯ä¼šå†…ç½®ä¿¡ä»» CA çš„è¯ä¹¦ä¿¡æ¯(åŒ…å«å…¬é’¥)ï¼Œå¦‚æœ CA ä¸è¢«ä¿¡ä»»ï¼Œåˆ™æ‰¾ä¸åˆ°å¯¹åº” CA çš„è¯ä¹¦ï¼Œè¯ä¹¦ä¹Ÿä¼šè¢«åˆ¤å®šéæ³•ã€‚\n\n### å››ã€ HTTPSå·¥ä½œæµç¨‹\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422132710862.png\" alt=\"image-20220422132710862\" style=\"zoom:80%;\" />\n\n1.Client å‘èµ·ä¸€ä¸ª HTTPSï¼ˆæ¯”å¦‚`https://juejin.cn/user/4283353031252967`ï¼‰çš„è¯·æ±‚ï¼Œæ ¹æ® RFC2818 çš„è§„å®šï¼ŒClient çŸ¥é“éœ€è¦è¿æ¥ Server çš„ 443ï¼ˆé»˜è®¤ï¼‰ç«¯å£ã€‚\n\n2.Server æŠŠäº‹å…ˆé…ç½®å¥½çš„å…¬é’¥è¯ä¹¦ï¼ˆpublic key certificateï¼‰è¿”å›ç»™å®¢æˆ·ç«¯ã€‚\n\n3.Client éªŒè¯å…¬é’¥è¯ä¹¦ï¼šæ¯”å¦‚æ˜¯å¦åœ¨æœ‰æ•ˆæœŸå†…ï¼Œè¯ä¹¦çš„ç”¨é€”æ˜¯ä¸æ˜¯åŒ¹é… Client è¯·æ±‚çš„ç«™ç‚¹ï¼Œæ˜¯ä¸æ˜¯åœ¨ CRL åŠé”€åˆ—è¡¨é‡Œé¢ï¼Œå®ƒçš„ä¸Šä¸€çº§è¯ä¹¦æ˜¯å¦æœ‰æ•ˆï¼Œè¿™æ˜¯ä¸€ä¸ªé€’å½’çš„è¿‡ç¨‹ï¼Œç›´åˆ°éªŒè¯åˆ°æ ¹è¯ä¹¦ï¼ˆæ“ä½œç³»ç»Ÿå†…ç½®çš„ Root è¯ä¹¦æˆ–è€… Client å†…ç½®çš„ Root è¯ä¹¦ï¼‰ã€‚å¦‚æœéªŒè¯é€šè¿‡åˆ™ç»§ç»­ï¼Œä¸é€šè¿‡åˆ™æ˜¾ç¤ºè­¦å‘Šä¿¡æ¯ã€‚\n\n4.Client ä½¿ç”¨ä¼ªéšæœºæ•°ç”Ÿæˆå™¨ç”ŸæˆåŠ å¯†æ‰€ä½¿ç”¨çš„å¯¹ç§°å¯†é’¥ï¼Œç„¶åç”¨è¯ä¹¦çš„å…¬é’¥åŠ å¯†è¿™ä¸ªå¯¹ç§°å¯†é’¥ï¼Œå‘ç»™ Serverã€‚\n\n5.Server ä½¿ç”¨è‡ªå·±çš„ç§é’¥ï¼ˆprivate keyï¼‰è§£å¯†è¿™ä¸ªæ¶ˆæ¯ï¼Œå¾—åˆ°å¯¹ç§°å¯†é’¥ã€‚è‡³æ­¤ï¼ŒClient å’Œ Server åŒæ–¹éƒ½æŒæœ‰äº†ç›¸åŒçš„å¯¹ç§°å¯†é’¥ã€‚\n\n6.Server ä½¿ç”¨å¯¹ç§°å¯†é’¥åŠ å¯†â€œæ˜æ–‡å†…å®¹ Aâ€ï¼Œå‘é€ç»™ Clientã€‚\n\n7.Client ä½¿ç”¨å¯¹ç§°å¯†é’¥è§£å¯†å“åº”çš„å¯†æ–‡ï¼Œå¾—åˆ°â€œæ˜æ–‡å†…å®¹ Aâ€ã€‚\n\n8.Client å†æ¬¡å‘èµ· HTTPS çš„è¯·æ±‚ï¼Œä½¿ç”¨å¯¹ç§°å¯†é’¥åŠ å¯†è¯·æ±‚çš„â€œæ˜æ–‡å†…å®¹ Bâ€ï¼Œç„¶å Server ä½¿ç”¨å¯¹ç§°å¯†é’¥è§£å¯†å¯†æ–‡ï¼Œå¾—åˆ°â€œæ˜æ–‡å†…å®¹ Bâ€ã€‚\n\n### äº”ã€HTTP ä¸ HTTPS çš„åŒºåˆ«\n\n- HTTP æ˜¯æ˜æ–‡ä¼ è¾“åè®®ï¼ŒHTTPS åè®®æ˜¯ç”± SSL+HTTP åè®®æ„å»ºçš„å¯è¿›è¡ŒåŠ å¯†ä¼ è¾“ã€èº«ä»½è®¤è¯çš„ç½‘ç»œåè®®ï¼Œæ¯” HTTP åè®®å®‰å…¨ã€‚\n\n- HTTPS æ¯” HTTP æ›´åŠ å®‰å…¨;\n- HTTPS éœ€è¦ç”¨åˆ° SSL è¯ä¹¦ï¼Œè€Œ HTTP ä¸ç”¨;\n- HTTPS æ ‡å‡†ç«¯å£ 443ï¼ŒHTTP æ ‡å‡†ç«¯å£ 80;\n- HTTPS åŸºäºä¼ è¾“å±‚ï¼ŒHTTP åŸºäºåº”ç”¨å±‚;\n- HTTPS åœ¨æµè§ˆå™¨æ˜¾ç¤ºç»¿è‰²å®‰å…¨é”ï¼ŒHTTP æ²¡æœ‰æ˜¾ç¤º;\n\n### å…­ã€ä¸ºä½•ä¸æ‰€æœ‰çš„ç½‘ç«™éƒ½ä½¿ç”¨HTTPS\n\næ—¢ç„¶ HTTPS é‚£ä¹ˆå®‰å…¨å¯é ï¼Œé‚£ä¸ºä½•ä¸æ‰€æœ‰çš„ Web ç½‘ç«™éƒ½ä½¿ç”¨ HTTPSï¼Ÿ\n\né¦–å…ˆï¼Œå¾ˆå¤šäººè¿˜æ˜¯ä¼šè§‰å¾— HTTPS å®æ–½æœ‰é—¨æ§›ï¼Œè¿™ä¸ªé—¨æ§›åœ¨äºéœ€è¦æƒå¨ CA é¢å‘çš„ SSL è¯ä¹¦ã€‚ä»è¯ä¹¦çš„é€‰æ‹©ã€è´­ä¹°åˆ°éƒ¨ç½²ï¼Œä¼ ç»Ÿçš„æ¨¡å¼ä¸‹éƒ½ä¼šæ¯”è¾ƒè€—æ—¶è€—åŠ›ã€‚\n\nå…¶æ¬¡ï¼ŒHTTPS æ™®éè®¤ä¸ºæ€§èƒ½æ¶ˆè€—è¦å¤§äº HTTPï¼Œå› ä¸º**ä¸çº¯æ–‡æœ¬é€šä¿¡ç›¸æ¯”ï¼ŒåŠ å¯†é€šä¿¡ä¼šæ¶ˆè€—æ›´å¤šçš„CPUåŠå†…å­˜èµ„æº**ã€‚å¦‚æœæ¯æ¬¡é€šä¿¡éƒ½åŠ å¯†ï¼Œä¼šæ¶ˆè€—ç›¸å½“å¤šçš„èµ„æºï¼Œå¹³æ‘Šåˆ°ä¸€å°è®¡ç®—æœºä¸Šæ—¶ï¼Œèƒ½å¤Ÿå¤„ç†çš„è¯·æ±‚æ•°é‡å¿…å®šä¹Ÿä¼šéšä¹‹å‡å°‘ã€‚ä½†äº‹å®å¹¶éå¦‚æ­¤ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡æ€§èƒ½ä¼˜åŒ–ã€æŠŠè¯ä¹¦éƒ¨ç½²åœ¨ SLB æˆ– CDNï¼Œæ¥è§£å†³æ­¤é—®é¢˜ã€‚ä¸¾ä¸ªå®é™…çš„ä¾‹å­ï¼Œâ€œåŒåä¸€â€æœŸé—´ï¼Œå…¨ç«™ HTTPS çš„æ·˜å®ã€å¤©çŒ«ä¾ç„¶ä¿è¯äº†ç½‘ç«™å’Œç§»åŠ¨ç«¯çš„è®¿é—®ã€æµè§ˆã€äº¤æ˜“ç­‰æ“ä½œçš„é¡ºç•…ã€å¹³æ»‘ã€‚é€šè¿‡æµ‹è¯•å‘ç°ï¼Œç»è¿‡ä¼˜åŒ–åçš„è®¸å¤šé¡µé¢æ€§èƒ½ä¸ HTTP æŒå¹³ç”šè‡³è¿˜æœ‰å°å¹…æå‡ï¼Œå› æ­¤ HTTPS ç»è¿‡ä¼˜åŒ–ä¹‹åå…¶å®å¹¶ä¸æ…¢ã€‚\n\né™¤æ­¤ä¹‹å¤–ï¼Œ**æƒ³è¦èŠ‚çº¦è´­ä¹°è¯ä¹¦çš„å¼€é”€ä¹Ÿæ˜¯åŸå› ä¹‹ä¸€**ã€‚è¦è¿›è¡Œ HTTPS é€šä¿¡ï¼Œè¯ä¹¦æ˜¯å¿…ä¸å¯å°‘çš„ã€‚è€Œä½¿ç”¨çš„è¯ä¹¦å¿…é¡»å‘è®¤è¯æœºæ„ï¼ˆCAï¼‰è´­ä¹°ã€‚\n\næœ€åæ˜¯å®‰å…¨æ„è¯†ã€‚ç›¸æ¯”å›½å†…ï¼Œå›½å¤–äº’è”ç½‘è¡Œä¸šçš„å®‰å…¨æ„è¯†å’ŒæŠ€æœ¯åº”ç”¨ç›¸å¯¹æˆç†Ÿï¼ŒHTTPS éƒ¨ç½²è¶‹åŠ¿æ˜¯ç”±ç¤¾ä¼šã€ä¼ä¸šã€æ”¿åºœå…±åŒå»æ¨åŠ¨çš„ã€‚\n\n## è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„\n\n### ä»€ä¹ˆæ˜¯ç½‘ç»œç¼–ç¨‹\n\nç½‘ç»œç¼–ç¨‹çš„æœ¬è´¨æ˜¯å¤šå°è®¡ç®—æœºä¹‹é—´çš„æ•°æ®äº¤æ¢ã€‚ç°åœ¨çš„ç½‘ç»œç¼–ç¨‹åŸºæœ¬ä¸Šéƒ½æ˜¯åŸºäºè¯·æ±‚/å“åº”æ–¹å¼çš„ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªè®¾å¤‡å‘é€è¯·æ±‚æ•°æ®ç»™å¦å¤–ä¸€ä¸ªï¼Œç„¶åæ¥æ”¶å¦ä¸€ä¸ªè®¾å¤‡çš„åé¦ˆã€‚åœ¨ç½‘ç»œç¼–ç¨‹ä¸­ï¼Œå‘èµ·è¿æ¥ç¨‹åºï¼Œä¹Ÿå°±æ˜¯å‘é€ç¬¬ä¸€æ¬¡è¯·æ±‚çš„ç¨‹åºï¼Œè¢«ç§°ä½œå®¢æˆ·ç«¯(Client)ï¼Œç­‰å¾…å…¶ä»–ç¨‹åºè¿æ¥çš„ç¨‹åºè¢«ç§°ä½œæœåŠ¡å™¨(Server)ã€‚å®¢æˆ·ç«¯ç¨‹åºå¯ä»¥åœ¨éœ€è¦çš„æ—¶å€™å¯åŠ¨ï¼Œè€ŒæœåŠ¡å™¨ä¸ºäº†èƒ½å¤Ÿæ—¶åˆ»å“åº”è¿æ¥ï¼Œåˆ™éœ€è¦ä¸€ç›´å¯åŠ¨ã€‚\n\n### ç½‘ç»œç¼–ç¨‹ä¸­ä¸¤ä¸ªä¸»è¦çš„é—®é¢˜\n\n**1ã€**ä¸€ä¸ªæ˜¯å¦‚ä½•å‡†ç¡®çš„å®šä½ç½‘ç»œä¸Šä¸€å°æˆ–å¤šå°ä¸»æœºï¼Œ\n\n**2ã€**å¦ä¸€ä¸ªå°±æ˜¯æ‰¾åˆ°ä¸»æœºåå¦‚ä½•å¯é é«˜æ•ˆçš„è¿›è¡Œæ•°æ®ä¼ è¾“ã€‚\n\n- åœ¨ TCP/IP åè®®ä¸­ IP å±‚ç½‘é™…å±‚ä¸»è¦è´Ÿè´£ç½‘ç»œä¸»æœºçš„å®šä½ï¼Œæ•°æ®ä¼ è¾“çš„è·¯ç”±ï¼Œç”± IP åœ°å€å¯ä»¥å”¯ä¸€åœ°ç¡®å®š Internet ä¸Šçš„ä¸€å°ä¸»æœºã€‚\n- è€Œ TCP å±‚ä¼ è¾“å±‚åˆ™æä¾›é¢å‘åº”ç”¨çš„å¯é ï¼ˆTCPï¼‰çš„æˆ–éå¯é ï¼ˆUDPï¼‰çš„æ•°æ®ä¼ è¾“æœºåˆ¶ï¼Œè¿™æ˜¯ç½‘ç»œç¼–ç¨‹çš„ä¸»è¦å¯¹è±¡ï¼Œä¸€èˆ¬ä¸éœ€è¦å…³å¿ƒ IP å±‚æ˜¯å¦‚ä½•å¤„ç†æ•°æ®çš„ã€‚\n\n### ç½‘ç»œåè®®æ˜¯ä»€ä¹ˆ\n\nåœ¨è®¡ç®—æœºç½‘ç»œè¦åšåˆ°äº•äº•æœ‰æ¡çš„äº¤æ¢æ•°æ®ï¼Œå°±å¿…é¡»éµå®ˆä¸€äº›äº‹å…ˆçº¦å®šå¥½çš„è§„åˆ™ï¼Œæ¯”å¦‚äº¤æ¢æ•°æ®çš„æ ¼å¼ã€æ˜¯å¦éœ€è¦å‘é€ä¸€ä¸ªåº”ç­”ä¿¡æ¯ã€‚è¿™äº›è§„åˆ™è¢«ç§°ä¸ºç½‘ç»œåè®®ã€‚\n\n### ä¸ºä»€ä¹ˆè¦å¯¹ç½‘ç»œåè®®åˆ†å±‚\n\n**1ã€**ç®€åŒ–é—®é¢˜éš¾åº¦å’Œå¤æ‚åº¦ã€‚ç”±äºå„å±‚ä¹‹é—´ç‹¬ç«‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†å‰²å¤§é—®é¢˜ä¸ºå°é—®é¢˜ã€‚\n\n**2ã€**çµæ´»æ€§å¥½ã€‚å½“å…¶ä¸­ä¸€å±‚çš„æŠ€æœ¯å˜åŒ–æ—¶ï¼Œåªè¦å±‚é—´æ¥å£å…³ç³»ä¿æŒä¸å˜ï¼Œå…¶ä»–å±‚ä¸å—å½±å“ã€‚\n\n**3ã€**æ˜“äºå®ç°å’Œç»´æŠ¤ã€‚\n\n**4ã€**ä¿ƒè¿›æ ‡å‡†åŒ–å·¥ä½œã€‚åˆ†å¼€åï¼Œæ¯å±‚åŠŸèƒ½å¯ä»¥ç›¸å¯¹ç®€å•åœ°è¢«æè¿°\n\n### ä½“ç³»ç»“æ„\n\n**TCP/IPå‚è€ƒæ¨¡å‹**\n\nOSI ä¸ƒå±‚åè®®ï¼šåº”ç”¨ï¼ˆHTTPï¼‰ã€è¡¨ç¤ºï¼ˆSSL/TLSï¼‰ã€ä¼šè¯ï¼ˆRPCï¼‰ã€ä¼ è¾“ï¼ˆTCPï¼‰ã€ç½‘ç»œï¼ˆIPï¼‰ã€é“¾è·¯ï¼ˆARPï¼‰ã€ç‰©ç†\n\nTCP/IP å››å±‚åè®®ï¼ˆæ•°æ®é“¾è·¯å±‚ã€ç½‘ç»œå±‚ã€ä¼ è¾“å±‚ã€åº”ç”¨å±‚ï¼‰\n\n**1ã€**åº”ç”¨å±‚ **ä¸ºç”¨æˆ·æä¾›å„ç§ç½‘ç»œæœåŠ¡**ã€‚æˆ‘ä»¬å¸¸è§åº”ç”¨å±‚çš„ç½‘ç»œæœåŠ¡åè®®æœ‰ï¼šHTTPï¼ŒHTTPSï¼ŒFTPï¼ŒTELNET ç­‰ã€‚ï¼ˆHTTP åè®®å…¨ç§° Hyper Text Transfer Protocol è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œåœ¨æµè§ˆå™¨ä¸æœåŠ¡å™¨é—´ä¼ é€æ–‡æ¡£ï¼‰\n\n**2ã€**ä¼ è¾“å±‚ **å»ºç«‹äº†ä¸»æœºç«¯åˆ°ç«¯çš„è¿æ¥**ï¼Œä¼ è¾“å±‚çš„ä½œç”¨æ˜¯**ä¸ºä¸Šå±‚åè®®æä¾›ç«¯åˆ°ç«¯çš„å¯é å’Œé€æ˜çš„æ•°æ®ä¼ è¾“æœåŠ¡**ï¼ŒåŒ…æ‹¬å¤„ç†å·®é”™æ§åˆ¶å’Œæµé‡æ§åˆ¶ç­‰é—®é¢˜ã€‚ï¼ˆTCPã€UDPï¼‰\n\n**3ã€**ç½‘ç»œå±‚ **é€šè¿‡IPå¯»å€æ¥å»ºç«‹ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„è¿æ¥**ï¼Œä¸ºæºç«¯çš„è¿è¾“å±‚é€æ¥çš„åˆ†ç»„ï¼Œé€‰æ‹©åˆé€‚çš„è·¯ç”±å’Œäº¤æ¢èŠ‚ç‚¹ï¼Œæ­£ç¡®æ— è¯¯åœ°æŒ‰ç…§åœ°å€ä¼ é€ç»™ç›®çš„ç«¯çš„è¿è¾“å±‚ã€‚ï¼ˆIPï¼‰\n\n**4ã€**æ•°æ®é“¾è·¯å±‚ **é€šè¿‡ä¸€äº›è§„åˆ™æ¥æ§åˆ¶è¿™äº›æ•°æ®çš„ä¼ è¾“**ï¼Œä»¥ä¿è¯è¢«ä¼ è¾“æ•°æ®çš„æ­£ç¡®æ€§ã€‚å®ç°è¿™äº›è§„ç¨‹æˆ–åè®®çš„ç¡¬ä»¶å’Œè½¯ä»¶åŠ åˆ°ç‰©ç†çº¿è·¯ï¼Œè¿™æ ·å°±æ„æˆäº†æ•°æ®é“¾è·¯ã€‚\n\n### ä»€ä¹ˆæ˜¯TCPå’ŒUDP\n\n|          | TCP                              | UDP                                    |\n| -------- | -------------------------------- | -------------------------------------- |\n| é¢å‘è¿æ¥ | é¢å‘è¿æ¥                         | æ— è¿æ¥                                 |\n| å¯é æ€§   | å¯é ä¼ è¾“ï¼Œä½¿ç”¨æ‹¥å¡æ§åˆ¶å’Œæµé‡æ§åˆ¶ | å¯é ä¼ è¾“                               |\n| è¿æ¥ä¸ªæ•° | åªèƒ½ä¸€å¯¹ä¸€é€šä¿¡                   | æ”¯æŒä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šã€å¤šå¯¹ä¸€ã€å¤šå¯¹å¤šé€šä¿¡ |\n| ä½¿ç”¨åœºæ™¯ | è¦æ±‚å¯é ä¼ è¾“çš„åº”ç”¨ï¼ˆæ–‡ä»¶ä¼ è¾“ï¼‰   | å®æ—¶åº”ç”¨ï¼ˆè§†é¢‘ä¼šè®®ã€ç½‘ç»œç›´æ’­ï¼‰         |\n\n### æµè§ˆå™¨ä¸­è¾“å…¥ï¼šç½‘å€åéƒ½å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿè¯·è¯¦ç»†é˜è¿°ã€‚\n\n**1ã€**åŸŸåè§£æï¼ŒåŸŸåâ†’IP åœ°å€ï¼Œè§£æè¿‡ç¨‹ä¾æ¬¡ç»è¿‡äº†æµè§ˆå™¨æœ¬åœ°ç¼“å­˜ã€ç³»ç»Ÿç¼“å­˜ã€hosts æ–‡ä»¶ã€è·¯ç”±å™¨ç¼“å­˜ã€ é€’å½’æœç´¢æ ¹åŸŸåæœåŠ¡å™¨ã€‚\n\n**2ã€**å»ºç«‹ TCP/IP è¿æ¥ï¼ˆä¸‰æ¬¡æ¡æ‰‹å…·ä½“è¿‡ç¨‹ï¼‰\n\n**3ã€**ç”±æµè§ˆå™¨å‘é€ä¸€ä¸ª HTTP è¯·æ±‚\n\n**4ã€**ç»è¿‡è·¯ç”±å™¨çš„è½¬å‘ï¼Œé€šè¿‡æœåŠ¡å™¨çš„é˜²ç«å¢™ï¼Œè¯¥ HTTP è¯·æ±‚åˆ°è¾¾äº†æœåŠ¡å™¨\n\n**5ã€**æœåŠ¡å™¨å¤„ç†è¯¥ HTTP è¯·æ±‚ï¼Œè¿”å›ä¸€ä¸ª HTML æ–‡ä»¶\n\n**6ã€**æµè§ˆå™¨è§£æè¯¥ HTML æ–‡ä»¶ï¼Œå¹¶ä¸”æ˜¾ç¤ºåœ¨æµè§ˆå™¨ç«¯\n\n![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640.webp)\n\n### TCP åè®®å¦‚ä½•æ¥ä¿è¯ä¼ è¾“çš„å¯é æ€§\n\n**å¯¹äºå¯é æ€§ï¼ŒTCPé€šè¿‡ä»¥ä¸‹æ–¹å¼è¿›è¡Œä¿è¯ï¼š**\n\n> æ¥æ”¶æ–¹å¯¹æ•°æ®åŒ…è¿›è¡Œæ£€æŸ¥ï¼Œæ˜¯å¦**å¤±åº**ï¼Œå¤±åºçš„è¯è¦é‡æ’åºï¼Œæ˜¯å¦**é‡å¤**ï¼Œé‡å¤çš„è¯å°†é‡å¤çš„æ•°æ®ä¸¢å¼ƒï¼Œæ˜¯å¦**å‡ºé”™**ï¼Œå‡ºé”™çš„è¯å°†è¯¥æŠ¥æ–‡æ®µä¸¢å¼ƒã€‚å¦åˆ™çš„è¯ï¼Œæ¥æ”¶æ–¹ä¼šç»™å‘é€æ–¹ä¸€ä¸ªå‘é€ä¸€ä¸ªç¡®è®¤ã€‚å‘é€æ–¹å‘é€ä¹‹åå¦‚æœæ²¡æœ‰æ”¶åˆ°è¿™ä¸ªç¡®è®¤åœ¨ä¸€å®šæ—¶é—´åä¼šé‡å‘è¿™ä¸ªæŠ¥æ–‡æ®µã€‚\n\n- **æ•°æ®åŒ…æ ¡éªŒ**ï¼šç›®çš„æ˜¯æ£€æµ‹æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­çš„ä»»ä½•å˜åŒ–ï¼Œè‹¥æ ¡éªŒå‡ºåŒ…æœ‰é”™ï¼Œåˆ™ä¸¢å¼ƒæŠ¥æ–‡æ®µå¹¶ä¸”ä¸ç»™å‡ºå“åº”ï¼Œè¿™æ—¶ TCP å‘é€æ•°æ®ç«¯è¶…æ—¶åä¼šé‡å‘æ•°æ®ï¼›\n- **å¯¹å¤±åºæ•°æ®åŒ…é‡æ’åº**ï¼šæ—¢ç„¶ TCP æŠ¥æ–‡æ®µä½œä¸º IP æ•°æ®æŠ¥æ¥ä¼ è¾“ï¼Œè€Œ IP æ•°æ®æŠ¥çš„åˆ°è¾¾å¯èƒ½ä¼šå¤±åºï¼Œå› æ­¤ TCP æŠ¥æ–‡æ®µçš„åˆ°è¾¾ä¹Ÿå¯èƒ½ä¼šå¤±åºã€‚TCP å°†å¯¹å¤±åºæ•°æ®è¿›è¡Œé‡æ–°æ’åºï¼Œç„¶åæ‰äº¤ç»™åº”ç”¨å±‚ï¼›\n- **ä¸¢å¼ƒé‡å¤æ•°æ®**ï¼šå¯¹äºé‡å¤æ•°æ®ï¼Œèƒ½å¤Ÿä¸¢å¼ƒé‡å¤æ•°æ®ï¼›\n- **åº”ç­”æœºåˆ¶**ï¼šå½“ TCP æ”¶åˆ°å‘è‡ª TCP è¿æ¥å¦ä¸€ç«¯çš„æ•°æ®ï¼Œå®ƒå°†å‘é€ä¸€ä¸ªç¡®è®¤ã€‚è¿™ä¸ªç¡®è®¤ä¸æ˜¯ç«‹å³å‘é€ï¼Œé€šå¸¸å°†æ¨è¿Ÿå‡ åˆ†ä¹‹ä¸€ç§’ï¼›\n- **è¶…æ—¶é‡å‘**ï¼šå½“ TCP å‘å‡ºä¸€ä¸ªæ®µåï¼Œå®ƒå¯åŠ¨ä¸€ä¸ªå®šæ—¶å™¨ï¼Œç­‰å¾…ç›®çš„ç«¯ç¡®è®¤æ”¶åˆ°è¿™ä¸ªæŠ¥æ–‡æ®µã€‚å¦‚æœä¸èƒ½åŠæ—¶æ”¶åˆ°ä¸€ä¸ªç¡®è®¤ï¼Œå°†é‡å‘è¿™ä¸ªæŠ¥æ–‡æ®µï¼›\n- **æµé‡æ§åˆ¶**ï¼šTCP è¿æ¥çš„æ¯ä¸€æ–¹éƒ½æœ‰å›ºå®šå¤§å°çš„ç¼“å†²ç©ºé—´ã€‚TCP çš„æ¥æ”¶ç«¯åªå…è®¸å¦ä¸€ç«¯å‘é€æ¥æ”¶ç«¯ç¼“å†²åŒºæ‰€èƒ½æ¥çº³çš„æ•°æ®ï¼Œè¿™å¯ä»¥é˜²æ­¢è¾ƒå¿«ä¸»æœºè‡´ä½¿è¾ƒæ…¢ä¸»æœºçš„ç¼“å†²åŒºæº¢å‡ºï¼Œè¿™å°±æ˜¯æµé‡æ§åˆ¶ã€‚\n\tTCP ä½¿ç”¨çš„æµé‡æ§åˆ¶åè®®æ˜¯**å¯å˜å¤§å°çš„æ»‘åŠ¨çª—å£åè®®**ã€‚\n\n### TCP çš„æ‹¥å¡é¿å…æœºåˆ¶\n\nhttps://www.cnblogs.com/hongdada/p/11206679.html\n\næ‹¥å¡ï¼šå¯¹èµ„æºçš„éœ€æ±‚è¶…è¿‡äº†å¯ç”¨çš„èµ„æºã€‚è‹¥ç½‘ç»œä¸­è®¸å¤šèµ„æºåŒæ—¶ä¾›åº”ä¸è¶³ï¼Œç½‘ç»œçš„æ€§èƒ½å°±è¦æ˜æ˜¾å˜åï¼Œæ•´ä¸ªç½‘ç»œçš„ååé‡éšç€è´Ÿè·çš„å¢å¤§è€Œä¸‹é™ã€‚\n\næ‹¥å¡æ§åˆ¶ï¼šé˜²æ­¢è¿‡å¤šçš„æ•°æ®æ³¨å…¥åˆ°ç½‘ç»œä¸­ï¼Œä½¿å¾—ç½‘ç»œä¸­çš„è·¯ç”±å™¨æˆ–é“¾è·¯ä¸è‡´è¿‡è½½ã€‚\n\næ‹¥å¡æ§åˆ¶çš„æ–¹æ³•ï¼š\n\n**1ã€ æ…¢å¼€å§‹ + æ‹¥å¡é¿å…ï¼š**\n\n![img](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes443934-20190718131944933-703202720.png)\n\n**æ…¢å¼€å§‹**ï¼šæ‹¥å¡çª—å£ä» 1ã€2ã€4 ä»¥æŒ‡æ•°è§„å¾‹å¢é•¿ï¼›\n\n**æ‹¥å¡é¿å…**ï¼šåˆ°è¾¾æ…¢å¼€å§‹é˜ˆå€¼åï¼Œå¼€å§‹æ‹¥å¡é¿å…â€œåŠ æ³•å¢å¤§â€\n\n**2ã€å¿«é‡ä¼  + å¿«æ¢å¤ï¼š**\n![img](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes443934-20190718132020300-1269239957.png)\n\n**å¿«é‡ä¼ **ï¼š **å¿«é‡ä¼ è¦æ±‚æ¥æ”¶æ–¹åœ¨æ”¶åˆ°ä¸€ä¸ªå¤±åºçš„æŠ¥æ–‡æ®µåå°±ç«‹å³å‘å‡º é‡å¤ç¡®è®¤ **ï¼ˆä¸ºçš„æ˜¯ä½¿å‘é€æ–¹åŠæ—©çŸ¥é“æœ‰æŠ¥æ–‡æ®µæ²¡æœ‰åˆ°è¾¾å¯¹æ–¹ï¼‰è€Œä¸è¦ç­‰åˆ°è‡ªå·±å‘é€æ•°æ®æ—¶æå¸¦ç¡®è®¤ã€‚å¿«é‡ä¼ ç®—æ³•è§„å®šï¼Œ **å‘é€æ–¹åªè¦ä¸€è¿æ”¶åˆ°ä¸‰ä¸ªé‡å¤ç¡®è®¤å°±åº”å½“ç«‹å³é‡ä¼ å¯¹æ–¹å°šæœªæ”¶åˆ°çš„æŠ¥æ–‡æ®µ**ï¼Œè€Œä¸å¿…ç»§ç»­ç­‰å¾…è®¾ç½®çš„é‡ä¼ è®¡æ—¶å™¨æ—¶é—´åˆ°æœŸã€‚\n\n**å¿«æ¢å¤**ï¼šå¿«é‡ä¼ é…åˆä½¿ç”¨çš„è¿˜æœ‰å¿«æ¢å¤ç®—æ³•ï¼Œå½“å‘é€æ–¹è¿ç»­æ”¶åˆ°ä¸‰ä¸ªé‡å¤ç¡®è®¤æ—¶ï¼Œå°±æ‰§è¡Œ**â€œä¹˜æ³•å‡å°â€ç®—æ³•ï¼ŒæŠŠ ssthresh é—¨é™å‡åŠ**ï¼Œä½†æ˜¯æ¥ä¸‹å»å¹¶ä¸æ‰§è¡Œæ…¢å¼€å§‹ç®—æ³•ï¼šå› ä¸ºå¦‚æœç½‘ç»œå‡ºç°æ‹¥å¡çš„è¯å°±ä¸ä¼šæ”¶åˆ°å¥½å‡ ä¸ªé‡å¤çš„ç¡®è®¤ï¼Œæ‰€ä»¥å‘é€æ–¹ç°åœ¨è®¤ä¸ºç½‘ç»œå¯èƒ½æ²¡æœ‰å‡ºç°æ‹¥å¡ã€‚æ‰€ä»¥æ­¤æ—¶ä¸æ‰§è¡Œæ…¢å¼€å§‹ç®—æ³•ï¼Œè€Œæ˜¯å°†æ‹¥å¡çª—å£è®¾ç½®ä¸ºæ…¢å¼€å§‹é˜ˆå€¼çš„å¤§å°ï¼Œ**ç„¶åæ‰§è¡Œæ‹¥å¡é¿å…ç®—æ³•è®©æ‹¥å¡çª—å£çº¿æ€§åŠ 1**ã€‚\n\n### ä»€ä¹ˆæ˜¯Httpåè®®ï¼Ÿ\n\n- Http åè®®å±äºåº”ç”¨å±‚ï¼Œæ˜¯åœ¨æµè§ˆå™¨ä¸æœåŠ¡å™¨é—´ä¼ é€æ–‡æ¡£çš„è§„èŒƒï¼Œç®€ç§°ä¸ºâ€œè¶…æ–‡æœ¬ä¼ è¾“åè®®â€\n\n![](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes20210326001352.png)\n\n### è¯´è¯´HTTPå¸¸ç”¨çš„çŠ¶æ€ç åŠå…¶å«ä¹‰ï¼Ÿ\n\n![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650518889206.webp)\n\nä¸ç®¡æ˜¯ä¸æ˜¯é¢è¯•éœ€è¦ï¼Œæˆ‘ä»¬éƒ½è¦çŸ¥é“ï¼Œæ—¥å¸¸å¼€å‘ä¸­çš„è¿™å‡ ä¸ªçŠ¶æ€ç çš„å«ä¹‰ï¼š\n\n![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650518894201.webp)\n\n\n\n### Httpå’ŒHttpsçš„åŒºåˆ«ï¼Ÿ\n\nHttp åè®®è¿è¡Œåœ¨ TCP ä¹‹ä¸Šï¼Œæ˜æ–‡ä¼ è¾“ï¼Œå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ç«¯éƒ½æ— æ³•éªŒè¯å¯¹æ–¹çš„èº«ä»½ï¼›Https æ˜¯èº«æŠ« SSL(Secure Socket Layer)å¤–å£³çš„ Httpï¼Œè¿è¡Œäº SSL ä¸Šï¼ŒSSL è¿è¡Œäº TCP ä¹‹ä¸Šï¼Œæ˜¯æ·»åŠ äº†åŠ å¯†å’Œè®¤è¯æœºåˆ¶çš„ HTTPã€‚äºŒè€…ä¹‹é—´å­˜åœ¨å¦‚ä¸‹ä¸åŒï¼š\n\n- ç«¯å£ä¸åŒï¼šHttp ä¸ Https ä½¿ç”¨ä¸åŒçš„è¿æ¥æ–¹å¼ï¼Œç”¨çš„ç«¯å£ä¹Ÿä¸ä¸€æ ·ï¼Œå‰è€…æ˜¯ 80ï¼Œåè€…æ˜¯ 443ï¼›\n- èµ„æºæ¶ˆè€—ï¼šå’Œ HTTP é€šä¿¡ç›¸æ¯”ï¼ŒHttps é€šä¿¡ä¼šç”±äºåŠ å¯†è§£å¯†å¤„ç†æ¶ˆè€—æ›´å¤šçš„ CPU å’Œå†…å­˜èµ„æºï¼›\n- å¼€é”€ï¼šHttps é€šä¿¡éœ€è¦è¯ä¹¦ï¼Œè€Œè¯ä¹¦ä¸€èˆ¬éœ€è¦å‘è®¤è¯æœºæ„è´­ä¹°ï¼›\n\nHttps çš„åŠ å¯†æœºåˆ¶æ˜¯ä¸€ç§å…±äº«å¯†é’¥åŠ å¯†å’Œå…¬å¼€å¯†é’¥åŠ å¯†å¹¶ç”¨çš„æ··åˆåŠ å¯†æœºåˆ¶ã€‚\n\n### ä»€ä¹ˆæ˜¯httpçš„è¯·æ±‚ä½“ï¼Ÿ\n\n**1ã€**HTTP è¯·æ±‚ä½“æ˜¯æˆ‘ä»¬è¯·æ±‚æ•°æ®æ—¶å…ˆå‘é€ç»™æœåŠ¡å™¨çš„æ•°æ®ï¼Œæ¯•ç«Ÿæˆ‘å‘æœåŠ¡å™¨æ‹¿æ•°æ®ï¼Œå…ˆè¦è¡¨æ˜æˆ‘è¦ä»€ä¹ˆå§\n\n**2ã€**HTTP è¯·æ±‚ä½“ç”±ï¼š**è¯·æ±‚è¡Œã€è¯·æ±‚å¤´ã€è¯·æ±‚ä½“** ç»„æˆçš„\n\n> è¯·æ±‚è¡Œï¼šè¯·æ±‚æ–¹æ³•ï¼ˆPOSTï¼‰ã€URLï¼ˆcharacter/use.htmlï¼‰ å’Œ HTTP åè®®ç‰ˆæœ¬ï¼ˆHTTP/1.1ï¼‰\n>\n> è¯·æ±‚å¤´ï¼š\n>\n> * User-Agentï¼šå‘é€è¯·æ±‚çš„æµè§ˆå™¨ç±»å‹;\n> * Acceptï¼šå®¢æˆ·ç«¯å¯è¯†åˆ«çš„å“åº”å†…å®¹ç±»å‹åˆ—è¡¨;æ˜Ÿå· â€œ * â€ ç”¨äºæŒ‰èŒƒå›´å°†ç±»å‹åˆ†ç»„ï¼Œç”¨ â€œ */* â€ æŒ‡ç¤ºå¯æ¥å—å…¨éƒ¨ç±»å‹ï¼Œç”¨â€œ type/* â€æŒ‡ç¤ºå¯æ¥å— type ç±»å‹çš„æ‰€æœ‰å­ç±»å‹;\n> * Accept-Languageï¼šå®¢æˆ·ç«¯å¯æ¥å—çš„è‡ªç„¶è¯­è¨€;\n> * Accept-Encodingï¼šå®¢æˆ·ç«¯å¯æ¥å—çš„ç¼–ç æ ¼å¼;\n> * Accept-Charsetï¼šå¯æ¥å—çš„åº”ç­”çš„å­—ç¬¦é›†;\n> * Hostï¼šè¯·æ±‚çš„ä¸»æœºåï¼Œå…è®¸å¤šä¸ªåŸŸååŒå¤„ä¸€ä¸ªIP åœ°å€ï¼Œå³è™šæ‹Ÿä¸»æœº;\n> * Connectionï¼šè¿æ¥æ–¹å¼(close æˆ– keepalive);\n> * Cookieï¼šå­˜å‚¨äºå®¢æˆ·ç«¯æ‰©å±•å­—æ®µï¼Œå‘åŒä¸€åŸŸåçš„æœåŠ¡ç«¯å‘é€å±äºè¯¥åŸŸçš„cookie;\n\n**3ã€**æ³¨æ„ï¼šGET è¯·æ±‚æ˜¯æ²¡æœ‰è¯·æ±‚ä½“çš„\n\n### HTTPçš„å“åº”æŠ¥æ–‡æœ‰å“ªäº›ï¼Ÿ\n\n**1ã€**http çš„å“åº”æŠ¥æ˜¯æœåŠ¡å™¨è¿”å›ç»™æˆ‘ä»¬çš„æ•°æ®ï¼Œå¿…é¡»å…ˆæœ‰è¯·æ±‚ä½“å†æœ‰å“åº”æŠ¥æ–‡\n\n**2ã€**å“åº”æŠ¥æ–‡åŒ…å«ä¸‰éƒ¨åˆ† **çŠ¶æ€è¡Œã€å“åº”å¤´ã€å“åº”ä½“**\n\n### Httpä¸­å¸¸è§çš„headerå­—æ®µæœ‰å“ªäº›ï¼Ÿ\n\ncookieï¼Œè¯·æ±‚æ—¶ä¼ é€’ç»™æœåŠ¡ç«¯çš„ cookie ä¿¡æ¯ \nset-cookieï¼Œå“åº”æŠ¥æ–‡é¦–éƒ¨è®¾ç½®è¦ä¼ é€’ç»™å®¢æˆ·ç«¯çš„ cookie ä¿¡æ¯ \nallowï¼Œæ”¯æŒä»€ä¹ˆ HTTP æ–¹æ³• \nlast-modifiedï¼Œèµ„æºçš„æœ€åä¿®æ”¹æ—¶é—´ \nexpires,è®¾ç½®èµ„æºç¼“å­˜çš„å¤±è´¥æ—¥æœŸ \ncontent-languageï¼Œå®ä½“çš„èµ„æºè¯­è¨€ \ncontent-encodingï¼Œå®ä½“çš„ç¼–ç æ ¼å¼ \ncontent-lengthï¼Œå®ä½“ä¸»ä½“éƒ¨åˆ†çš„å¤§å°å•ä½æ˜¯å­—èŠ‚ \ncontent-rangeï¼Œè¿”å›çš„å®ä½“çš„å“ªäº›èŒƒå›´ \ncontent-typeï¼Œå“ªäº›ç±»å‹ \naccept-rangesï¼Œå¤„ç†çš„èŒƒå›´è¯·æ±‚ \nageï¼Œå‘Šè¯‰å®¢æˆ·ç«¯æœåŠ¡å™¨åœ¨å¤šä¹…å‰åˆ›å»ºäº†å“åº” \nvaryï¼Œä»£ç†æœåŠ¡å™¨çš„ç¼“å­˜ä¿¡æ¯ \nlocationï¼Œç”¨äºæŒ‡å®šé‡å®šå‘åçš„ URI \nIf-Matchï¼Œå€¼æ˜¯èµ„æºçš„å”¯ä¸€æ ‡è¯† \nUser-Agentï¼Œå°†åˆ›å»ºè¯·æ±‚çš„æµè§ˆå™¨å’Œç”¨æˆ·ä»£ç†åç§°ç­‰ä¿¡æ¯ä¼ é€’ç»™æœåŠ¡å™¨ \nTransfer-Encodingï¼Œä¼ è¾“æŠ¥æ–‡çš„ä¸»ä½“ç¼–ç æ–¹å¼ \nconnectionï¼Œç®¡ç†æŒä¹…è¿æ¥ keep-alive , close Cache-Controlï¼Œæ§åˆ¶æµè§ˆå™¨çš„å¼ºç¼“å­˜\n\n### HTTPSå·¥ä½œåŸç†\n\nï¼ˆAESï¼šéå¯¹ç§°åŠ å¯†ï¼›RSAï¼šå¯¹ç§°åŠ å¯†ï¼‰\n\n**1ã€**é¦–å…ˆ HTTP è¯·æ±‚æœåŠ¡ç«¯ç”Ÿæˆè¯ä¹¦ï¼Œå®¢æˆ·ç«¯å¯¹è¯ä¹¦çš„æœ‰æ•ˆæœŸã€åˆæ³•æ€§ã€åŸŸåæ˜¯å¦ä¸è¯·æ±‚çš„åŸŸåä¸€è‡´ã€è¯ä¹¦çš„å…¬é’¥ï¼ˆRSA åŠ å¯†ï¼‰ç­‰è¿›è¡Œæ ¡éªŒï¼›\n\n**2ã€**å®¢æˆ·ç«¯å¦‚æœæ ¡éªŒé€šè¿‡åï¼Œå°±æ ¹æ®è¯ä¹¦çš„å…¬é’¥çš„æœ‰æ•ˆï¼Œ ç”Ÿæˆéšæœºæ•°ï¼Œéšæœºæ•°ä½¿ç”¨å…¬é’¥è¿›è¡ŒåŠ å¯†ï¼ˆRSA åŠ å¯†ï¼‰ï¼›\n\n**3ã€**æ¶ˆæ¯ä½“äº§ç”Ÿä¹‹åï¼Œå¯¹å®ƒçš„æ‘˜è¦è¿›è¡Œ MD5ï¼ˆæˆ–è€… SHA1ï¼‰ç®—æ³•åŠ å¯†ï¼Œæ­¤æ—¶å°±å¾—åˆ°äº† RSA ç­¾åï¼›\n\n**4ã€**å‘é€ç»™æœåŠ¡ç«¯ï¼Œæ­¤æ—¶åªæœ‰æœåŠ¡ç«¯ï¼ˆRSA ç§é’¥ï¼‰èƒ½è§£å¯†ã€‚\n\n**5ã€**è§£å¯†å¾—åˆ°çš„éšæœºæ•°ï¼Œå†ç”¨ AES åŠ å¯†ï¼Œä½œä¸ºå¯†é’¥ï¼ˆæ­¤æ—¶çš„å¯†é’¥åªæœ‰å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çŸ¥é“ï¼‰ã€‚\n\n### â­ä¸ºä»€ä¹ˆ TCP é“¾æ¥éœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Œä¸¤æ¬¡ä¸å¯ä»¥ä¹ˆï¼Ÿ\n\nâ€œä¸‰æ¬¡æ¡æ‰‹â€ çš„ç›®çš„æ˜¯ä¸ºäº†é˜²æ­¢**å·²å¤±æ•ˆçš„é“¾æ¥è¯·æ±‚æŠ¥æ–‡çªç„¶åˆä¼ é€åˆ°äº†æœåŠ¡ç«¯**ï¼Œå› è€Œäº§ç”Ÿé”™è¯¯ã€‚\n\n- æ­£å¸¸çš„æƒ…å†µï¼šA å‘å‡ºè¿æ¥è¯·æ±‚ï¼Œä½†å› è¿æ¥è¯·æ±‚æŠ¥æ–‡ä¸¢å¤±è€Œæœªæ”¶åˆ°ç¡®è®¤ï¼Œäºæ˜¯ A å†é‡ä¼ ä¸€æ¬¡è¿æ¥è¯·æ±‚ã€‚åæ¥æ”¶åˆ°äº†ç¡®è®¤ï¼Œå»ºç«‹äº†è¿æ¥ã€‚æ•°æ®ä¼ è¾“å®Œæ¯•åï¼Œå°±é‡Šæ”¾äº†è¿æ¥ã€‚A å…±å‘é€äº†ä¸¤ä¸ªè¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªä¸¢å¤±ï¼Œç¬¬äºŒä¸ªåˆ°è¾¾äº† Bã€‚æ²¡æœ‰ â€œå·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µâ€ã€‚\n- å‡å®šå‡ºç°äº†ä¸€ç§å¼‚å¸¸æƒ…å†µï¼šå³ A å‘å‡ºçš„ç¬¬ä¸€ä¸ªè¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µå¹¶æ²¡æœ‰ä¸¢å¤±ï¼Œè€Œæ˜¯åœ¨æŸä¸ªç½‘ç»œç»“ç‚¹é•¿æ—¶é—´çš„æ»ç•™äº†ï¼Œä»¥è‡´å»¶è¯¯åˆ°è¿æ¥é‡Šæ”¾ä»¥åçš„æŸä¸ªæ—¶é—´æ‰åˆ°è¾¾ Bã€‚æœ¬æ¥è¿™æ˜¯ä¸€ä¸ªæ—©å·²å¤±æ•ˆçš„æŠ¥æ–‡æ®µã€‚ä½† B æ”¶åˆ°æ­¤å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µåï¼Œå°±è¯¯è®¤ä¸ºæ˜¯ A å†æ¬¡å‘å‡ºçš„ä¸€ä¸ªæ–°çš„è¿æ¥è¯·æ±‚ã€‚äºæ˜¯å°±å‘ A å‘å‡ºç¡®è®¤æŠ¥æ–‡æ®µï¼ŒåŒæ„å»ºç«‹è¿æ¥ã€‚\n\nå‡è®¾ä¸é‡‡ç”¨â€œä¸‰æ¬¡æ¡æ‰‹â€ï¼Œé‚£ä¹ˆåªè¦ B å‘å‡ºç¡®è®¤ï¼Œæ–°çš„è¿æ¥å°±å»ºç«‹äº†ã€‚ç”±äºç°åœ¨ A å¹¶æ²¡æœ‰å‘å‡ºå»ºç«‹è¿æ¥çš„è¯·æ±‚ï¼ˆå› ä¸ºé‚£ä¸ªæ˜¯å·²ç»å¤±æ•ˆçš„è¯·æ±‚ï¼‰ï¼Œå› æ­¤ä¸ä¼šç†ç¬ B çš„ç¡®è®¤ï¼Œä¹Ÿä¸ä¼šå‘ B å‘é€æ•°æ®ã€‚ä½† B å´ä»¥ä¸ºæ–°çš„è¿è¾“è¿æ¥å·²ç»å»ºç«‹ï¼Œå¹¶ä¸€ç›´ç­‰å¾… A å‘æ¥æ•°æ®ã€‚è¿™æ ·ï¼ŒB çš„å¾ˆå¤šèµ„æºå°±ç™½ç™½æµªè´¹æ‰äº†ã€‚é‡‡ç”¨â€œä¸‰æ¬¡æ¡æ‰‹â€çš„åŠæ³•å¯ä»¥é˜²æ­¢ä¸Šè¿°ç°è±¡å‘ç”Ÿã€‚\n\n### â­ä¸ºä»€ä¹ˆè¦å››æ¬¡æŒ¥æ‰‹ï¼Ÿ\n\nTCP æ˜¯å…¨åŒå·¥æ¨¡å¼ï¼Œè¿™å°±æ„å‘³ç€ï¼Œ\nå½“ A å‘ B å‘å‡º FIN æŠ¥æ–‡æ®µæ—¶ï¼Œåªæ˜¯è¡¨ç¤º A å·²ç»æ²¡æœ‰æ•°æ®è¦å‘é€äº†ï¼Œè€Œæ­¤æ—¶ A è¿˜æ˜¯èƒ½å¤Ÿæ¥å—åˆ°æ¥è‡ª B å‘å‡ºçš„æ•°æ®ï¼›å½“ B å‘ A å‘å‡º ACK æŠ¥æ–‡æ®µä¹Ÿåªæ˜¯å‘Šè¯‰ A ï¼Œå®ƒè‡ªå·±çŸ¥é“ A æ²¡æœ‰æ•°æ®è¦å‘äº†ï¼Œä½† B è¿˜æ˜¯èƒ½å¤Ÿå‘ A å‘é€æ•°æ®ã€‚\n\næ‰€ä»¥æƒ³è¦æ„‰å¿«çš„ç»“æŸè¿™æ¬¡å¯¹è¯å°±éœ€è¦å››æ¬¡æŒ¥æ‰‹ã€‚\n\n### â­ä¸ºä»€ä¹ˆå®¢æˆ·ç«¯å‘å‡ºç¬¬å››æ¬¡æŒ¥æ‰‹çš„ç¡®è®¤æŠ¥æ–‡åè¦ç­‰2MSLçš„æ—¶é—´æ‰èƒ½é‡Šæ”¾TCPè¿æ¥ï¼Ÿ\n\nMSLï¼ˆMaximum Segment Lifetimeï¼‰**æŠ¥æ–‡æœ€å¤§å¯¿å‘½**ï¼ŒTCP å…è®¸ä¸åŒçš„å®ç°å¯ä»¥è®¾ç½®ä¸åŒçš„ MSL å€¼ã€‚\n\nç¬¬ä¸€ï¼Œä¿è¯å®¢æˆ·ç«¯å‘é€çš„æœ€åä¸€ä¸ª ACK æŠ¥æ–‡èƒ½å¤Ÿåˆ°è¾¾æœåŠ¡å™¨ï¼Œå› ä¸ºè¿™ä¸ª ACK æŠ¥æ–‡å¯èƒ½ä¸¢å¤±ï¼Œç«™åœ¨æœåŠ¡å™¨çš„è§’åº¦çœ‹æ¥ï¼Œæˆ‘å·²ç»å‘é€äº† FIN+ACK æŠ¥æ–‡è¯·æ±‚æ–­å¼€äº†ï¼Œå®¢æˆ·ç«¯è¿˜æ²¡æœ‰ç»™æˆ‘å›åº”ï¼Œåº”è¯¥æ˜¯æˆ‘å‘é€çš„è¯·æ±‚æ–­å¼€æŠ¥æ–‡å®ƒæ²¡æœ‰æ”¶åˆ°ï¼Œäºæ˜¯æœåŠ¡å™¨åˆä¼šé‡æ–°å‘é€ä¸€æ¬¡ï¼Œè€Œå®¢æˆ·ç«¯å°±èƒ½åœ¨è¿™ä¸ª 2MSL æ—¶é—´æ®µå†…æ”¶åˆ°è¿™ä¸ªé‡ä¼ çš„æŠ¥æ–‡ï¼Œæ¥ç€ç»™å‡ºå›åº”æŠ¥æ–‡ï¼Œå¹¶ä¸”ä¼šé‡å¯ 2MSL è®¡æ—¶å™¨ã€‚\n\nç¬¬äºŒï¼Œé˜²æ­¢ç±»ä¼¼ä¸â€œä¸‰æ¬¡æ¡æ‰‹â€ä¸­æåˆ°äº†çš„â€œå·²ç»å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µâ€å‡ºç°åœ¨æœ¬è¿æ¥ä¸­ã€‚å®¢æˆ·ç«¯å‘é€å®Œæœ€åä¸€ä¸ªç¡®è®¤æŠ¥æ–‡åï¼Œåœ¨è¿™ä¸ª 2MSL æ—¶é—´ä¸­ï¼Œå°±å¯ä»¥ä½¿æœ¬è¿æ¥æŒç»­çš„æ—¶é—´å†…æ‰€äº§ç”Ÿçš„æ‰€æœ‰æŠ¥æ–‡æ®µéƒ½ä»ç½‘ç»œä¸­æ¶ˆå¤±ã€‚è¿™æ ·æ–°çš„è¿æ¥ä¸­ä¸ä¼šå‡ºç°æ—§è¿æ¥çš„è¯·æ±‚æŠ¥æ–‡ã€‚\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\nåŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/qzcsu/article/details/72861891\n\n### â­å¦‚æœå·²ç»å»ºç«‹äº†è¿æ¥ï¼Œä½†æ˜¯å®¢æˆ·ç«¯çªç„¶å‡ºç°æ•…éšœäº†æ€ä¹ˆåŠï¼Ÿ\n\nTCP è¿˜è®¾æœ‰ä¸€ä¸ª**ä¿æ´»è®¡æ—¶å™¨**ï¼Œæ˜¾ç„¶ï¼Œå®¢æˆ·ç«¯å¦‚æœå‡ºç°æ•…éšœï¼ŒæœåŠ¡å™¨ä¸èƒ½ä¸€ç›´ç­‰ä¸‹å»ï¼Œç™½ç™½æµªè´¹èµ„æºã€‚æœåŠ¡å™¨æ¯æ”¶åˆ°ä¸€æ¬¡å®¢æˆ·ç«¯çš„è¯·æ±‚åéƒ½ä¼šé‡æ–°å¤ä½è¿™ä¸ªè®¡æ—¶å™¨ï¼Œæ—¶é—´é€šå¸¸æ˜¯è®¾ç½®ä¸º 2 å°æ—¶ï¼Œè‹¥ä¸¤å°æ—¶è¿˜æ²¡æœ‰æ”¶åˆ°å®¢æˆ·ç«¯çš„ä»»ä½•æ•°æ®ï¼ŒæœåŠ¡å™¨å°±ä¼šå‘é€ä¸€ä¸ª**æ¢æµ‹æŠ¥æ–‡æ®µ**ï¼Œä»¥åæ¯éš” 75 ç§’å‘é€ä¸€æ¬¡ã€‚è‹¥**ä¸€è¿å‘é€10ä¸ªæ¢æµ‹æŠ¥æ–‡ä»ç„¶æ²¡ååº”**ï¼ŒæœåŠ¡å™¨å°±è®¤ä¸ºå®¢æˆ·ç«¯å‡ºäº†æ•…éšœï¼Œæ¥ç€å°±**å…³é—­è¿æ¥**ã€‚\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\nåŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/qzcsu/article/details/72861891\n\n### IPåœ°å€æ˜¯æ€æ ·åˆ†ç±»çš„ï¼Œä½ çŸ¥é“å—ï¼Ÿ\n\nå…ˆè¯´ä¸€ä¸‹ IP çš„åŸºæœ¬ç‰¹ç‚¹ï¼š\n\n- IP åœ°å€ç”±å››æ®µç»„æˆï¼Œæ¯ä¸ªå­—æ®µæ˜¯ä¸€ä¸ªå­—èŠ‚ï¼Œ8 ä½ï¼Œæœ€å¤§å€¼æ˜¯ 255ã€‚\n- IP åœ°å€ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œå³**ç½‘ç»œåœ°å€**å’Œ**ä¸»æœºåœ°å€**ã€‚\n\tç½‘ç»œåœ°å€è¡¨ç¤ºå…¶å±äºäº’è”ç½‘çš„å“ªä¸€ä¸ªç½‘ç»œï¼Œä¸»æœºåœ°å€è¡¨ç¤ºå…¶å±äºè¯¥ç½‘ç»œä¸­çš„å“ªä¸€å°ä¸»æœºã€‚\n\nIP åœ°å€æ ¹æ®ç½‘ç»œåœ°å€è¿›è¡Œåˆ†ç±»ï¼Œä¸»è¦åˆ†ä¸º Aã€Bã€C ä¸‰ç±»åŠç‰¹æ®Šåœ°å€ Dã€E è¿™äº”ç±»\n\n**Aç±»ï¼š** (1.0.0.0-126.0.0.0)ä¸€èˆ¬ç”¨äºå¤§å‹ç½‘ç»œã€‚\n\n**Bç±»ï¼š** (128.0.0.0-191.255.0.0)ä¸€èˆ¬ç”¨äºä¸­ç­‰è§„æ¨¡ç½‘ç»œã€‚\n\n**Cç±»ï¼š** (192.0.0.0-223.255.255.0)ä¸€èˆ¬ç”¨äºå°å‹ç½‘ç»œã€‚\n\n**Dç±»ï¼š** æ˜¯å¤šæ’­åœ°å€ï¼Œåœ°å€çš„ç½‘ç»œå·å–å€¼äº 224~239 ä¹‹é—´ï¼Œä¸€èˆ¬ç”¨äºå¤šè·¯å¹¿æ’­ç”¨æˆ·ã€‚\n\n**Eç±»ï¼š** æ˜¯ä¿ç•™åœ°å€ã€‚åœ°å€çš„ç½‘ç»œå·å–å€¼äº 240~255 ä¹‹é—´ã€‚\n\n### å®¢æˆ·ç«¯ä¸æ–­è¿›è¡Œè¯·æ±‚é“¾æ¥ä¼šæ€æ ·ï¼ŸDDos(Distributed Denial of Service)æ”»å‡»ï¼Ÿ\n\næœåŠ¡å™¨ç«¯ä¼šä¸ºæ¯ä¸ªè¯·æ±‚åˆ›å»ºä¸€ä¸ªé“¾æ¥ï¼Œå¹¶å‘å…¶å‘é€ç¡®è®¤æŠ¥æ–‡ï¼Œç„¶åç­‰å¾…å®¢æˆ·ç«¯è¿›è¡Œç¡®è®¤\n\n**(1) DDos æ”»å‡»ï¼š**\n\n- å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€è¯·æ±‚é“¾æ¥æ•°æ®åŒ…\n- æœåŠ¡ç«¯å‘å®¢æˆ·ç«¯å‘é€ç¡®è®¤æ•°æ®åŒ…\n- å®¢æˆ·ç«¯å´ä¸å‘æœåŠ¡ç«¯å‘é€ç¡®è®¤æ•°æ®åŒ…ï¼ŒæœåŠ¡å™¨**ä¸€ç›´ç­‰å¾…**æ¥è‡ªå®¢æˆ·ç«¯çš„ç¡®è®¤\n\n**(2) DDos é¢„é˜²ï¼šï¼ˆæ²¡æœ‰å½»åº•æ ¹æ²»çš„åŠæ³•ï¼Œé™¤éä¸ä½¿ç”¨TCPï¼‰**\n\n- é™åˆ¶åŒæ—¶æ‰“å¼€ SYN åŠé“¾æ¥çš„æ•°ç›®\n- ç¼©çŸ­ SYN åŠé“¾æ¥çš„ Time out æ—¶é—´\n- å…³é—­ä¸å¿…è¦çš„æœåŠ¡\n\n### GET ä¸ POST çš„åŒºåˆ«ï¼Ÿ\n\nGET ä¸ POST æ˜¯æˆ‘ä»¬å¸¸ç”¨çš„ä¸¤ç§ HTTP Methodï¼ŒäºŒè€…ä¹‹é—´çš„åŒºåˆ«ä¸»è¦åŒ…æ‹¬å¦‚ä¸‹äº”ä¸ªæ–¹é¢ï¼š\n\n**1ã€** ä»åŠŸèƒ½ä¸Šè®²ï¼ŒGET ä¸€èˆ¬ç”¨æ¥**ä»æœåŠ¡å™¨ä¸Šè·å–èµ„æº**ï¼ŒPOST ä¸€èˆ¬ç”¨æ¥**æ›´æ–°æœåŠ¡å™¨ä¸Šçš„èµ„æº**ï¼›\n\n**2ã€**ä»è¯·æ±‚å‚æ•°å½¢å¼ä¸Šçœ‹ï¼ŒGETè¯·æ±‚çš„æ•°æ®ä¼š**é™„åœ¨URLä¸Š**ï¼Œä»¥?åˆ†å‰² URL å’Œä¼ è¾“æ•°æ®ï¼Œå‚æ•°ä¹‹é—´ä»¥&ç›¸è¿ï¼›è€Œ POST è¯·æ±‚ä¼šæŠŠæäº¤çš„æ•°æ®åˆ™æ”¾ç½®åœ¨ HTTP è¯·æ±‚æŠ¥æ–‡çš„ **è¯·æ±‚ä½“** ä¸­ã€‚\n\n**3ã€**å°±å®‰å…¨æ€§è€Œè¨€ï¼ŒPOSTçš„**å®‰å…¨æ€§**è¦æ¯” GET çš„å®‰å…¨æ€§é«˜ï¼Œå› ä¸º GET è¯·æ±‚æäº¤çš„æ•°æ®å°†æ˜æ–‡å‡ºç°åœ¨ URL ä¸Šï¼Œè€Œä¸” POST è¯·æ±‚å‚æ•°åˆ™è¢«åŒ…è£…åˆ°è¯·æ±‚ä½“ä¸­ï¼Œç›¸å¯¹æ›´å®‰å…¨ã€‚\n\n**4ã€**ä»è¯·æ±‚çš„å¤§å°çœ‹ï¼ŒGETè¯·æ±‚çš„**é•¿åº¦**å—é™äºæµè§ˆå™¨æˆ–æœåŠ¡å™¨å¯¹ URL é•¿åº¦çš„é™åˆ¶ï¼Œå…è®¸å‘é€çš„æ•°æ®é‡æ¯”è¾ƒå°ï¼Œè€Œ POST è¯·æ±‚åˆ™æ˜¯æ²¡æœ‰å¤§å°é™åˆ¶çš„ã€‚\n\n### DNSçš„å¯»å€è¿‡ç¨‹ä½ çŸ¥é“å—ï¼Ÿ\n\næµè§ˆå™¨ç¼“å­˜ã€ç³»ç»Ÿç¼“å­˜ã€hosts æ–‡ä»¶ã€è·¯ç”±å™¨ç¼“å­˜ã€ é€’å½’æœç´¢æ ¹åŸŸåæœåŠ¡å™¨ã€‚\n\n### ä»€ä¹ˆæ˜¯Socket\n\n**1ã€**ç½‘ç»œä¸Šçš„ä¸¤ä¸ªç¨‹åºé€šè¿‡ä¸€ä¸ªåŒå‘çš„é€šè®¯è¿æ¥å®ç°æ•°æ®çš„äº¤æ¢ï¼Œè¿™ä¸ªåŒå‘é“¾è·¯çš„ä¸€ç«¯ç§°ä¸ºä¸€ä¸ª Socketã€‚Socket é€šå¸¸ç”¨æ¥å®ç°å®¢æˆ·æ–¹å’ŒæœåŠ¡æ–¹çš„è¿æ¥ã€‚Socket æ˜¯ TCP/IP åè®®çš„ä¸€ä¸ªååˆ†æµè¡Œçš„ç¼–ç¨‹ç•Œé¢ï¼Œä¸€ä¸ª Socket ç”±ä¸€ä¸ª IP åœ°å€å’Œä¸€ä¸ªç«¯å£å·å”¯ä¸€ç¡®å®šã€‚\n\n**2ã€**ä½†æ˜¯ï¼ŒSocket æ‰€æ”¯æŒçš„åè®®ç§ç±»ä¹Ÿä¸å…‰ TCP/IPã€UDPï¼Œå› æ­¤ä¸¤è€…ä¹‹é—´æ˜¯æ²¡æœ‰å¿…ç„¶è”ç³»çš„ã€‚åœ¨ Java ç¯å¢ƒä¸‹ï¼ŒSocket ç¼–ç¨‹ä¸»è¦æ˜¯æŒ‡åŸºäº TCP/IP åè®®çš„ç½‘ç»œç¼–ç¨‹ã€‚\n\n**3ã€**socket è¿æ¥å°±æ˜¯æ‰€è°“çš„é•¿è¿æ¥ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨éœ€è¦äº’ç›¸è¿æ¥ï¼Œç†è®ºä¸Šå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ä¸€æ—¦å»ºç«‹èµ·è¿æ¥å°†ä¸ä¼šä¸»åŠ¨æ–­æ‰çš„ï¼Œä½†æ˜¯æœ‰æ—¶å€™ç½‘ç»œæ³¢åŠ¨è¿˜æ˜¯æœ‰å¯èƒ½çš„\n\n**4ã€**Socket åå‘äºåº•å±‚ã€‚ä¸€èˆ¬å¾ˆå°‘ç›´æ¥ä½¿ç”¨ Socket æ¥ç¼–ç¨‹ï¼Œæ¡†æ¶åº•å±‚ä½¿ç”¨ Socket æ¯”è¾ƒå¤šï¼Œ\n\n### Socketå±äºç½‘ç»œçš„é‚£ä¸ªå±‚é¢\n\n![](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes20210325212441.png)\n\nSocket æ˜¯åº”ç”¨å±‚ä¸ TCP/IP åè®®æ—é€šä¿¡çš„ä¸­é—´è½¯ä»¶æŠ½è±¡å±‚ï¼Œå®ƒæ˜¯ä¸€ç»„æ¥å£ã€‚åœ¨è®¾è®¡æ¨¡å¼ä¸­ï¼ŒSocket å…¶å®å°±æ˜¯ä¸€ä¸ªå¤–è§‚æ¨¡å¼ï¼Œå®ƒæŠŠå¤æ‚çš„ TCP/IP åè®®æ—éšè—åœ¨ Socket æ¥å£åé¢ï¼Œå¯¹ç”¨æˆ·æ¥è¯´ï¼Œä¸€ç»„ç®€å•çš„æ¥å£å°±æ˜¯å…¨éƒ¨ï¼Œè®© Socket å»ç»„ç»‡æ•°æ®ï¼Œä»¥ç¬¦åˆæŒ‡å®šçš„åè®®ã€‚\n\n### Socketé€šè®¯çš„è¿‡ç¨‹\n\n**åŸºäºTCPï¼š**\n\næœåŠ¡å™¨ç«¯å…ˆåˆå§‹åŒ– Socketï¼Œç„¶åä¸ç«¯å£ç»‘å®š(bind)ï¼Œå¯¹ç«¯å£è¿›è¡Œç›‘å¬(listen)ï¼Œè°ƒç”¨ accept é˜»å¡ï¼Œç­‰å¾…å®¢æˆ·ç«¯è¿æ¥ã€‚åœ¨è¿™æ—¶å¦‚æœæœ‰ä¸ªå®¢æˆ·ç«¯åˆå§‹åŒ–ä¸€ä¸ª Socketï¼Œç„¶åè¿æ¥æœåŠ¡å™¨(connect)ï¼Œå¦‚æœè¿æ¥æˆåŠŸï¼Œè¿™æ—¶å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ç«¯çš„è¿æ¥å°±å»ºç«‹äº†ã€‚å®¢æˆ·ç«¯å‘é€æ•°æ®è¯·æ±‚ï¼ŒæœåŠ¡å™¨ç«¯æ¥æ”¶è¯·æ±‚å¹¶å¤„ç†è¯·æ±‚ï¼Œç„¶åæŠŠå›åº”æ•°æ®å‘é€ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯è¯»å–æ•°æ®ï¼Œæœ€åå…³é—­è¿æ¥ï¼Œä¸€æ¬¡äº¤äº’ç»“æŸã€‚\n\n**åŸºäºUDPï¼š**\n\nUDP åè®®æ˜¯ç”¨æˆ·æ•°æ®æŠ¥åè®®çš„ç®€ç§°ï¼Œä¹Ÿç”¨äºç½‘ç»œæ•°æ®çš„ä¼ è¾“ã€‚è™½ç„¶ UDP åè®®æ˜¯ä¸€ç§ä¸å¤ªå¯é çš„åè®®ï¼Œä½†æœ‰æ—¶åœ¨éœ€è¦è¾ƒå¿«åœ°æ¥æ”¶æ•°æ®å¹¶ä¸”å¯ä»¥å¿å—è¾ƒå°é”™è¯¯çš„æƒ…å†µä¸‹ï¼ŒUDP å°±ä¼šè¡¨ç°å‡ºæ›´å¤§çš„ä¼˜åŠ¿ã€‚æˆ‘å®¢æˆ·ç«¯åªéœ€è¦å‘é€ï¼ŒæœåŠ¡ç«¯èƒ½ä¸èƒ½æ¥æ”¶çš„åˆ°æˆ‘ä¸ç®¡\n\n### Socketå’Œhttpçš„åŒºåˆ«å’Œåº”ç”¨åœºæ™¯\n\n**1ã€**Socket è¿æ¥å°±æ˜¯æ‰€è°“çš„é•¿è¿æ¥ï¼Œç†è®ºä¸Šå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ä¸€æ—¦å»ºç«‹èµ·è¿æ¥å°†ä¸ä¼šä¸»åŠ¨æ–­æ‰ï¼›\n\n**2ã€**Socket é€‚ç”¨åœºæ™¯ï¼šç½‘ç»œæ¸¸æˆï¼Œé“¶è¡ŒæŒç»­äº¤äº’ï¼Œç›´æ’­ï¼Œåœ¨çº¿è§†å±ç­‰ã€‚\n\n**3ã€**http è¿æ¥å°±æ˜¯æ‰€è°“çš„çŸ­è¿æ¥ï¼Œå³å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯å‘é€ä¸€æ¬¡è¯·æ±‚ï¼ŒæœåŠ¡å™¨ç«¯å“åº”åè¿æ¥å³ä¼šæ–­å¼€ç­‰å¾…ä¸‹æ¬¡è¿æ¥\n\n**4ã€**http é€‚ç”¨åœºæ™¯ï¼šå…¬å¸ OA æœåŠ¡ï¼Œäº’è”ç½‘æœåŠ¡ï¼Œç”µå•†ï¼ŒåŠå…¬ï¼Œç½‘ç«™ç­‰ç­‰ç­‰ç­‰\n\n### ä»€ä¹ˆæ˜¯ HTTP åè®®æ— çŠ¶æ€åè®®ï¼Ÿæ€ä¹ˆè§£å†³Httpåè®®æ— çŠ¶æ€åè®®?\n\nHTTP æ˜¯ä¸€ä¸ªæ— çŠ¶æ€çš„åè®®ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰è®°å¿†åŠ›ï¼Œè¿™æ„å‘³ç€æ¯ä¸€æ¬¡çš„è¯·æ±‚éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œç¼ºå°‘çŠ¶æ€æ„å‘³ç€å¦‚æœåç»­å¤„ç†éœ€è¦å‰é¢çš„ä¿¡æ¯ï¼Œåˆ™å®ƒå¿…é¡»è¦é‡ä¼ ï¼Œè¿™æ ·å¯èƒ½å¯¼è‡´æ¯æ¬¡è¿æ¥ä¼ é€çš„æ•°æ®é‡å¢å¤§ã€‚æœåŠ¡å™¨æ— æ³•åˆ¤æ–­ç”¨æˆ·èº«ä»½ã€‚\n\nHTTP çš„è¿™ç§ç‰¹æ€§æœ‰ä¼˜ç‚¹ä¹Ÿæœ‰ç¼ºç‚¹ï¼š\n\n- **ä¼˜ç‚¹**ï¼šè§£æ”¾äº†æœåŠ¡å™¨ï¼Œæ¯ä¸€æ¬¡çš„è¯·æ±‚â€œç‚¹åˆ°ä¸ºæ­¢â€ï¼Œä¸ä¼šé€ æˆä¸å¿…è¦çš„è¿æ¥å ç”¨\n- **ç¼ºç‚¹**ï¼šæ¯æ¬¡è¯·æ±‚ä¼šä¼ è¾“å¤§é‡é‡å¤çš„å†…å®¹ä¿¡æ¯ï¼Œå¹¶ä¸”ï¼Œåœ¨è¯·æ±‚ä¹‹é—´æ— æ³•å®ç°æ•°æ®çš„å…±äº«\n\nè§£å†³æ–¹æ¡ˆï¼š\n\n1. ä½¿ç”¨å‚æ•°ä¼ é€’æœºåˆ¶ï¼š\n\tå°†å‚æ•°æ‹¼æ¥åœ¨è¯·æ±‚çš„ URL åé¢ï¼Œå®ç°æ•°æ®çš„ä¼ é€’ï¼ˆGET æ–¹å¼ï¼‰ï¼Œä¾‹å¦‚ï¼š`/param/list?username=wmyskxz`\n\t**é—®é¢˜**ï¼šå¯ä»¥è§£å†³æ•°æ®å…±äº«çš„é—®é¢˜ï¼Œä½†æ˜¯è¿™ç§æ–¹å¼ä¸€ä¸å®‰å…¨ï¼ŒäºŒæ•°æ®å…è®¸ä¼ è¾“é‡åªæœ‰ 1kb\n2. ä½¿ç”¨ Cookie æŠ€æœ¯\n3. ä½¿ç”¨ Session æŠ€æœ¯\n\nCookie å’Œ Session éƒ½æ˜¯å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´ä¿æŒçŠ¶æ€çš„è§£å†³æ–¹æ¡ˆï¼Œå…·ä½“æ¥è¯´ï¼Œcookie æœºåˆ¶é‡‡ç”¨çš„æ˜¯åœ¨å®¢æˆ·ç«¯ä¿æŒçŠ¶æ€çš„æ–¹æ¡ˆï¼Œè€Œ session æœºåˆ¶é‡‡ç”¨çš„æ˜¯åœ¨æœåŠ¡å™¨ç«¯ä¿æŒçŠ¶æ€çš„æ–¹æ¡ˆã€‚\n\n### ä»€ä¹ˆæ˜¯Cookie\n\nCookie å®é™…ä¸Šæ˜¯ä¸€å°æ®µçš„æ–‡æœ¬ä¿¡æ¯ã€‚å®¢æˆ·ç«¯è¯·æ±‚æœåŠ¡å™¨ï¼Œå¦‚æœæœåŠ¡å™¨éœ€è¦è®°å½•è¯¥ç”¨æˆ·çŠ¶æ€ï¼Œå°±ä½¿ç”¨ response å‘å®¢æˆ·ç«¯æµè§ˆå™¨é¢å‘ä¸€ä¸ª Cookieï¼Œè€Œå®¢æˆ·ç«¯æµè§ˆå™¨ä¼šæŠŠ Cookie ä¿å­˜èµ·æ¥ã€‚å½“æµè§ˆå™¨å†è¯·æ±‚è¯¥ç½‘ç«™æ—¶ï¼Œæµè§ˆå™¨æŠŠè¯·æ±‚çš„ç½‘å€è¿åŒè¯¥ Cookie ä¸€åŒæäº¤ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨æ£€æŸ¥è¯¥ Cookieï¼Œä»¥æ­¤æ¥è¾¨è®¤ç”¨æˆ·çŠ¶æ€ã€‚æœåŠ¡å™¨è¿˜å¯ä»¥æ ¹æ®éœ€è¦ä¿®æ”¹ Cookie çš„å†…å®¹ã€‚ \n\n### ä»€ä¹ˆæ˜¯Session\n\nsession æ˜¯æµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¼šè¯è¿‡ç¨‹ä¸­ï¼ŒæœåŠ¡å™¨ä¼šåˆ†é…çš„ä¸€å—å‚¨å­˜ç©ºé—´ç»™ sessionã€‚\n\næœåŠ¡å™¨é»˜è®¤ä¸ºå®¢æˆ·æµè§ˆå™¨çš„ cookie ä¸­è®¾ç½® sessionidï¼Œè¿™ä¸ª sessionid å°±å’Œ cookie å¯¹åº”ï¼Œæµè§ˆå™¨åœ¨å‘æœåŠ¡å™¨è¯·æ±‚è¿‡ç¨‹ä¸­ä¼ è¾“çš„ cookie åŒ…å« sessionid ï¼ŒæœåŠ¡å™¨æ ¹æ®ä¼ è¾“ cookie ä¸­çš„ sessionid è·å–å‡ºä¼šè¯ä¸­å­˜å‚¨çš„ä¿¡æ¯ï¼Œç„¶åç¡®å®šä¼šè¯çš„èº«ä»½ä¿¡æ¯ã€‚\n\n### Cookieå’ŒSessionå¯¹äºHTTPæœ‰ä»€ä¹ˆç”¨ï¼Ÿ\n\n HTTP åè®®æœ¬èº«æ˜¯æ— æ³•åˆ¤æ–­ç”¨æˆ·èº«ä»½ã€‚æ‰€ä»¥éœ€è¦ cookie æˆ–è€… session\n\n### Cookieä¸SessionåŒºåˆ«\n\n- **å®ç°æœºåˆ¶**ï¼šSession çš„å®ç°å¸¸å¸¸ä¾èµ–äº Cookie æœºåˆ¶ï¼Œé€šè¿‡ Cookie æœºåˆ¶å›ä¼  SessionIDï¼›\n- **å¤§å°é™åˆ¶**ï¼šCookie æœ‰å¤§å°é™åˆ¶å¹¶ä¸”æµè§ˆå™¨å¯¹æ¯ä¸ªç«™ç‚¹ä¹Ÿæœ‰ cookie çš„ä¸ªæ•°é™åˆ¶ï¼ŒSession æ²¡æœ‰å¤§å°é™åˆ¶ï¼Œç†è®ºä¸Šåªä¸æœåŠ¡å™¨çš„å†…å­˜å¤§å°æœ‰å…³ï¼›\n- **å®‰å…¨æ€§**ï¼šCookie å­˜åœ¨å®‰å…¨éšæ‚£ï¼Œé€šè¿‡æ‹¦æˆªæˆ–æœ¬åœ°æ–‡ä»¶æ‰¾å¾—åˆ° cookie åå¯ä»¥è¿›è¡Œæ”»å‡»ï¼Œè€Œ Session ç”±äºä¿å­˜åœ¨æœåŠ¡å™¨ç«¯ï¼Œç›¸å¯¹æ›´åŠ å®‰å…¨ï¼›\n- **æœåŠ¡å™¨èµ„æºæ¶ˆè€—**ï¼šSession æ˜¯ä¸€å®šæ—¶é—´å†…ä¿å­˜åœ¨æœåŠ¡å™¨ç«¯ä¸Šï¼Œå¦‚æœ session è¿‡å¤šä¼šå¢åŠ æœåŠ¡å™¨çš„å‹åŠ›ã€‚\n\n### ä»€ä¹ˆæ˜¯Token\n\nToken çš„å¼•å…¥ï¼šToken æ˜¯åœ¨å®¢æˆ·ç«¯é¢‘ç¹å‘æœåŠ¡ç«¯è¯·æ±‚æ•°æ®ï¼ŒæœåŠ¡ç«¯é¢‘ç¹çš„å»æ•°æ®åº“æŸ¥è¯¢ç”¨æˆ·åå’Œå¯†ç å¹¶è¿›è¡Œå¯¹æ¯”ï¼Œåˆ¤æ–­ç”¨æˆ·åå’Œå¯†ç æ­£ç¡®ä¸å¦ï¼Œå¹¶ä½œå‡ºç›¸åº”æç¤ºï¼Œåœ¨è¿™æ ·çš„èƒŒæ™¯ä¸‹ï¼ŒToken ä¾¿åº”è¿è€Œç”Ÿã€‚\n\nToken çš„å®šä¹‰ï¼šToken æ˜¯æœåŠ¡ç«¯ç”Ÿæˆçš„ä¸€ä¸²å­—ç¬¦ä¸²ï¼Œä»¥ä½œå®¢æˆ·ç«¯è¿›è¡Œè¯·æ±‚çš„ä¸€ä¸ªä»¤ç‰Œï¼Œå½“ç¬¬ä¸€æ¬¡ç™»å½•åï¼ŒæœåŠ¡å™¨ç”Ÿæˆä¸€ä¸ª Token ä¾¿å°†æ­¤ Token è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œä»¥åå®¢æˆ·ç«¯åªéœ€å¸¦ä¸Šè¿™ä¸ª Token å‰æ¥è¯·æ±‚æ•°æ®å³å¯ï¼Œæ— éœ€å†æ¬¡å¸¦ä¸Šç”¨æˆ·åå’Œå¯†ç ã€‚\n\nä½¿ç”¨ Token çš„ç›®çš„ï¼šToken çš„ç›®çš„æ˜¯ä¸ºäº†å‡è½»æœåŠ¡å™¨çš„å‹åŠ›ï¼Œå‡å°‘é¢‘ç¹çš„æŸ¥è¯¢æ•°æ®åº“ï¼Œä½¿æœåŠ¡å™¨æ›´åŠ å¥å£®ã€‚\n\nToken æ˜¯åœ¨æœåŠ¡ç«¯äº§ç”Ÿçš„ã€‚å¦‚æœå‰ç«¯ä½¿ç”¨ç”¨æˆ·å/å¯†ç å‘æœåŠ¡ç«¯è¯·æ±‚è®¤è¯ï¼ŒæœåŠ¡ç«¯è®¤è¯æˆåŠŸï¼Œé‚£ä¹ˆåœ¨æœåŠ¡ç«¯ä¼šè¿”å› Token ç»™å‰ç«¯ã€‚å‰ç«¯å¯ä»¥åœ¨æ¯æ¬¡è¯·æ±‚çš„æ—¶å€™å¸¦ä¸Š Token **è¯æ˜è‡ªå·±çš„åˆæ³•åœ°ä½**\n\n### sessionä¸tokenåŒºåˆ«\n\n- session å­˜å‚¨åœ¨æœåŠ¡å™¨ç«¯ï¼Œtoken å­˜å‚¨åœ¨å®¢æˆ·ç«¯\n- token æä¾›è®¤è¯å’ŒæˆæƒåŠŸèƒ½ï¼Œä½œä¸ºèº«ä»½è®¤è¯ï¼Œtoken å®‰å…¨æ€§æ¯” session å¥½ï¼›\n- â­session è¿™ç§ä¼šè¯å­˜å‚¨æ–¹å¼æ–¹å¼åªé€‚ç”¨äºå®¢æˆ·ç«¯ä»£ç å’ŒæœåŠ¡ç«¯ä»£ç è¿è¡Œåœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šï¼Œtoken é€‚ç”¨äºé¡¹ç›®çº§çš„å‰åç«¯åˆ†ç¦»ï¼ˆå‰åç«¯ä»£ç è¿è¡Œåœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸‹ï¼‰\n\n### å¸¸ç”¨çš„HTTPæ–¹æ³•æœ‰å“ªäº›ï¼Ÿ\n\n- **GETï¼š**ç”¨äºè¯·æ±‚è®¿é—®å·²ç»è¢« URIï¼ˆç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼‰è¯†åˆ«çš„èµ„æºï¼Œå¯ä»¥é€šè¿‡ URL ä¼ å‚ç»™æœåŠ¡å™¨\n- **POSTï¼š**ç”¨äºä¼ è¾“ä¿¡æ¯ç»™æœåŠ¡å™¨ï¼Œä¸»è¦åŠŸèƒ½ä¸ GET æ–¹æ³•ç±»ä¼¼ï¼Œä½†ä¸€èˆ¬æ¨èä½¿ç”¨ POST æ–¹å¼ã€‚\n- **PUTï¼š**ä¼ è¾“æ–‡ä»¶ï¼ŒæŠ¥æ–‡ä¸»ä½“ä¸­åŒ…å«æ–‡ä»¶å†…å®¹ï¼Œä¿å­˜åˆ°å¯¹åº” URI ä½ç½®ã€‚\n- **HEADï¼š**è·å¾—æŠ¥æ–‡é¦–éƒ¨ï¼Œä¸ GET æ–¹æ³•ç±»ä¼¼ï¼Œåªæ˜¯ä¸è¿”å›æŠ¥æ–‡ä¸»ä½“ï¼Œä¸€èˆ¬ç”¨äºéªŒè¯ URI æ˜¯å¦æœ‰æ•ˆã€‚\n- **DELETEï¼š**åˆ é™¤æ–‡ä»¶ï¼Œä¸ PUT æ–¹æ³•ç›¸åï¼Œåˆ é™¤å¯¹åº” URI ä½ç½®çš„æ–‡ä»¶ã€‚\n- **OPTIONSï¼š**æŸ¥è¯¢ç›¸åº” URI æ”¯æŒçš„ HTTP æ–¹æ³•ã€‚\n\n### ç½‘ç»œå±‚çš„ ARP åè®®å·¥ä½œåŸç†ï¼Ÿ\n\nç½‘ç»œå±‚çš„ ARP åè®®å®Œæˆäº† IP åœ°å€ä¸ç‰©ç†åœ°å€çš„æ˜ å°„\n\n### IPåœ°å€ä¸ç‰©ç†åœ°å€\n\nç‰©ç†åœ°å€æ˜¯æ•°æ®é“¾è·¯å±‚å’Œç‰©ç†å±‚ä½¿ç”¨çš„åœ°å€ï¼ŒIP åœ°å€æ˜¯ç½‘ç»œå±‚å’Œä»¥ä¸Šå„å±‚ä½¿ç”¨çš„åœ°å€ï¼Œæ˜¯ä¸€ç§é€»è¾‘åœ°å€ï¼Œå…¶ä¸­ ARP åè®®ç”¨äº IP åœ°å€ä¸ç‰©ç†åœ°å€çš„å¯¹åº”ã€‚\n\n### å½±å“ç½‘ç»œä¼ è¾“çš„å› ç´ æœ‰å“ªäº›ï¼Ÿ\n\nå°†ä¸€ä»½æ•°æ®ä»ä¸€ä¸ªåœ°æ–¹æ­£ç¡®åœ°ä¼ è¾“åˆ°å¦ä¸€ä¸ªåœ°æ–¹æ‰€éœ€è¦çš„æ—¶é—´æˆ‘ä»¬ç§°ä¹‹ä¸ºå“åº”æ—¶é—´ã€‚å½±å“è¿™ä¸ªå“åº”æ—¶é—´çš„å› ç´ æœ‰å¾ˆå¤šã€‚\n\n1ã€ç½‘ç»œå¸¦å®½\n2ã€ä¼ è¾“è·ç¦»\n3ã€TCP æ‹¥å¡æ§åˆ¶\n\n### ä»€æ˜¯å¯¹ç§°åŠ å¯†ä¸éå¯¹ç§°åŠ å¯†\n\nå¯¹ç§°å¯†é’¥åŠ å¯†æ˜¯æŒ‡**åŠ å¯†å’Œè§£å¯†ä½¿ç”¨åŒä¸€ä¸ªå¯†é’¥**çš„æ–¹å¼ï¼Œè¿™ç§æ–¹å¼å­˜åœ¨çš„æœ€å¤§é—®é¢˜å°±æ˜¯å¯†é’¥å‘é€é—®é¢˜ï¼Œå³å¦‚ä½•å®‰å…¨åœ°å°†å¯†é’¥å‘ç»™å¯¹æ–¹ï¼›\n\nè€Œéå¯¹ç§°åŠ å¯†æ˜¯æŒ‡ä½¿ç”¨**ä¸€å¯¹éå¯¹ç§°å¯†é’¥ï¼Œå³å…¬é’¥å’Œç§é’¥**ï¼Œå…¬é’¥å¯ä»¥éšæ„å‘å¸ƒï¼Œä½†ç§é’¥åªæœ‰è‡ªå·±çŸ¥é“ã€‚å‘é€å¯†æ–‡çš„ä¸€æ–¹ä½¿ç”¨å¯¹æ–¹çš„å…¬é’¥è¿›è¡ŒåŠ å¯†å¤„ç†ï¼Œå¯¹æ–¹æ¥æ”¶åˆ°åŠ å¯†ä¿¡æ¯åï¼Œä½¿ç”¨è‡ªå·±çš„ç§é’¥è¿›è¡Œè§£å¯†ã€‚ ç”±äºéå¯¹ç§°åŠ å¯†çš„æ–¹å¼ä¸éœ€è¦å‘é€ç”¨æ¥è§£å¯†çš„ç§é’¥ï¼Œæ‰€ä»¥å¯ä»¥ä¿è¯å®‰å…¨æ€§ï¼›ä½†æ˜¯å’Œå¯¹ç§°åŠ å¯†æ¯”èµ·æ¥ï¼Œéå¸¸çš„æ…¢\n\n### HTTPSé‡‡ç”¨å¯¹ç§°åŠ å¯†+éå¯¹ç§°åŠ å¯†\n\nä½¿ç”¨å¯¹ç§°åŠ å¯†ï¼Œä¼˜ç‚¹æ˜¯åŠ å¯†è§£å¯†é€Ÿåº¦å¿«ï¼Œç¼ºç‚¹æ˜¯ä¸å®‰å…¨ï¼›\nä½¿ç”¨éå¯¹ç§°åŠ å¯†ï¼Œä¼˜ç‚¹æ˜¯ä¿è¯å®‰å…¨æ€§ï¼Œç¼ºç‚¹æ˜¯é€Ÿåº¦æ…¢ï¼›\n\nHttps ç»“åˆä¸¤ç§åŠ å¯†æ–¹å¼çš„ä¼˜ç‚¹ï¼Œ\nåœ¨**äº¤æ¢å¯†é’¥ç¯èŠ‚**ä½¿ç”¨éå¯¹ç§°åŠ å¯†æ–¹å¼ï¼Œä¹‹åçš„**å»ºç«‹é€šä¿¡äº¤æ¢æŠ¥æ–‡**é˜¶æ®µåˆ™ä½¿ç”¨å¯¹ç§°åŠ å¯†æ–¹å¼ã€‚\n\n## TCP/IP åè®®æ—\n\n### åº”ç”¨å±‚\n\nåº”ç”¨å±‚( application-layer ï¼‰çš„ä»»åŠ¡æ˜¯é€šè¿‡åº”ç”¨è¿›ç¨‹é—´çš„äº¤äº’æ¥å®Œæˆç‰¹å®šç½‘ç»œåº”ç”¨ã€‚åº”ç”¨å±‚åè®®å®šä¹‰çš„æ˜¯åº”ç”¨è¿›ç¨‹ï¼ˆè¿›ç¨‹ï¼šä¸»æœºä¸­æ­£åœ¨è¿è¡Œçš„ç¨‹åºï¼‰é—´çš„é€šä¿¡å’Œäº¤äº’çš„è§„åˆ™ã€‚\n\nå¯¹äºä¸åŒçš„ç½‘ç»œåº”ç”¨éœ€è¦ä¸åŒçš„åº”ç”¨å±‚åè®®ã€‚åœ¨äº’è”ç½‘ä¸­åº”ç”¨å±‚åè®®å¾ˆå¤šï¼Œå¦‚åŸŸåç³»ç»Ÿ DNSï¼Œæ”¯æŒä¸‡ç»´ç½‘åº”ç”¨çš„ HTTP åè®®ï¼Œæ”¯æŒç”µå­é‚®ä»¶çš„ SMTP åè®®ç­‰ç­‰ã€‚\n\n### ä¼ è¾“å±‚\n\nä¼ è¾“å±‚(transport layer)çš„ä¸»è¦ä»»åŠ¡å°±æ˜¯è´Ÿè´£å‘ä¸¤å°ä¸»æœºè¿›ç¨‹ä¹‹é—´çš„é€šä¿¡æä¾›é€šç”¨çš„**æ•°æ®ä¼ è¾“æœåŠ¡**ã€‚åº”ç”¨è¿›ç¨‹åˆ©ç”¨è¯¥æœåŠ¡ä¼ é€åº”ç”¨å±‚æŠ¥æ–‡ã€‚\n\nè¿è¾“å±‚ä¸»è¦ä½¿ç”¨ä¸€ä¸‹ä¸¤ç§åè®®\n\n1. ä¼ è¾“æ§åˆ¶åè®®-TCPï¼šæä¾›é¢å‘è¿æ¥çš„ï¼Œå¯é çš„æ•°æ®ä¼ è¾“æœåŠ¡ã€‚\n2. ç”¨æˆ·æ•°æ®åè®®-UDPï¼šæä¾›æ— è¿æ¥çš„ï¼Œå°½æœ€å¤§åŠªåŠ›çš„æ•°æ®ä¼ è¾“æœåŠ¡ï¼ˆä¸ä¿è¯æ•°æ®ä¼ è¾“çš„å¯é æ€§ï¼‰ã€‚\n\n|              | UDP                                        | TCP                                    |\n| ------------ | ------------------------------------------ | -------------------------------------- |\n| æ˜¯å¦è¿æ¥     | æ— è¿æ¥                                     | é¢å‘è¿æ¥                               |\n| æ˜¯å¦å¯é      | ä¸å¯é ä¼ è¾“ï¼Œä¸ä½¿ç”¨æµé‡æ§åˆ¶å’Œæ‹¥å¡æ§åˆ¶       | å¯é ä¼ è¾“ï¼Œä½¿ç”¨æµé‡æ§åˆ¶å’Œæ‹¥å¡æ§åˆ¶       |\n| è¿æ¥å¯¹è±¡ä¸ªæ•° | æ”¯æŒä¸€å¯¹ä¸€ï¼Œä¸€å¯¹å¤šï¼Œå¤šå¯¹ä¸€å’Œå¤šå¯¹å¤šäº¤äº’é€šä¿¡ | åªèƒ½æ˜¯ä¸€å¯¹ä¸€é€šä¿¡                       |\n| ä¼ è¾“æ–¹å¼     | é¢å‘æŠ¥æ–‡                                   | é¢å‘å­—èŠ‚æµ                             |\n| é¦–éƒ¨å¼€é”€     | é¦–éƒ¨å¼€é”€å°ï¼Œä»…8å­—èŠ‚                        | é¦–éƒ¨æœ€å°20å­—èŠ‚ï¼Œæœ€å¤§60å­—èŠ‚             |\n| åœºæ™¯         | é€‚ç”¨äºå®æ—¶åº”ç”¨ï¼ˆIPç”µè¯ã€è§†é¢‘ä¼šè®®ã€ç›´æ’­ç­‰ï¼‰ | é€‚ç”¨äºè¦æ±‚å¯é ä¼ è¾“çš„åº”ç”¨ï¼Œä¾‹å¦‚æ–‡ä»¶ä¼ è¾“ |\n\n**æ¯ä¸€ä¸ªåº”ç”¨å±‚ï¼ˆTCP/IPå‚è€ƒæ¨¡å‹çš„æœ€é«˜å±‚ï¼‰åè®®ä¸€èˆ¬éƒ½ä¼šä½¿ç”¨åˆ°ä¸¤ä¸ªä¼ è¾“å±‚åè®®ä¹‹ä¸€ï¼š**\n\nè¿è¡Œåœ¨`TCPåè®®`ä¸Šçš„åè®®ï¼š\n\n- `HTTPï¼ˆHypertext Transfer Protocolï¼Œè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰`ï¼Œä¸»è¦ç”¨äºæ™®é€šæµè§ˆã€‚\n- `HTTPSï¼ˆHTTP over SSLï¼Œå®‰å…¨è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰`,`HTTP`åè®®çš„å®‰å…¨ç‰ˆæœ¬ã€‚\n- `FTPï¼ˆFile Transfer Protocolï¼Œæ–‡ä»¶ä¼ è¾“åè®®ï¼‰`ï¼Œç”¨äºæ–‡ä»¶ä¼ è¾“ã€‚\n- `POP3ï¼ˆPost Office Protocol, version 3ï¼Œé‚®å±€åè®®ï¼‰`ï¼Œæ”¶é‚®ä»¶ç”¨ã€‚\n- `SMTPï¼ˆSimple Mail Transfer Protocolï¼Œç®€å•é‚®ä»¶ä¼ è¾“åè®®ï¼‰`ï¼Œç”¨æ¥å‘é€ç”µå­é‚®ä»¶ã€‚\n- `TELNETï¼ˆTeletype over the Networkï¼Œç½‘ç»œç”µä¼ ï¼‰`ï¼Œé€šè¿‡ä¸€ä¸ª`ç»ˆç«¯ï¼ˆterminalï¼‰`ç™»é™†åˆ°ç½‘ç»œã€‚\n- `SSHï¼ˆSecure Shellï¼Œç”¨äºæ›¿ä»£å®‰å…¨æ€§å·®çš„TELNETï¼‰`ï¼Œç”¨äºåŠ å¯†å®‰å…¨ç™»é™†ç”¨ã€‚\n\nè¿è¡Œåœ¨`UDPåè®®`ä¸Šçš„åè®®ï¼š\n\n- `DHCPï¼ˆDynamic Host Configuration Protocolï¼ŒåŠ¨æ€ä¸»æœºé…ç½®åè®®ï¼‰`ï¼ŒåŠ¨æ€é…ç½® IP åœ°å€ã€‚\n\nè¿è¡Œåœ¨`TCP`å’Œ`UDP`åè®®ä¸Šï¼š\n\n- `DNSï¼ˆDomain Name Serviceï¼ŒåŸŸåæœåŠ¡ï¼‰`ï¼Œç”¨äºå®Œæˆåœ°å€æŸ¥æ‰¾ï¼Œé‚®ä»¶è½¬å‘ç­‰å·¥ä½œã€‚\n\n### ç½‘ç»œå±‚\n\nç½‘ç»œå±‚çš„ä»»åŠ¡å°±æ˜¯**é€‰æ‹©åˆé€‚çš„ç½‘é—´è·¯ç”±å’Œäº¤æ¢ç»“ç‚¹ï¼Œç¡®ä¿è®¡ç®—æœºé€šä¿¡çš„æ•°æ®åŠæ—¶ä¼ é€**ã€‚åœ¨å‘é€æ•°æ®æ—¶ï¼Œç½‘ç»œå±‚æŠŠè¿è¾“å±‚äº§ç”Ÿçš„æŠ¥æ–‡æ®µæˆ–ç”¨æˆ·æ•°æ®æŠ¥å°è£…æˆåˆ†ç»„å’ŒåŒ…è¿›è¡Œä¼ é€ã€‚åœ¨ TCP/IP ä½“ç³»ç»“æ„ä¸­ï¼Œç”±äºç½‘ç»œå±‚ä½¿ç”¨ IP åè®®ï¼Œå› æ­¤åˆ†ç»„ä¹Ÿå« IP æ•°æ®æŠ¥ ï¼Œç®€ç§°æ•°æ®æŠ¥ã€‚\n\näº’è”ç½‘æ˜¯ç”±å¤§é‡çš„å¼‚æ„ï¼ˆheterogeneousï¼‰ç½‘ç»œé€šè¿‡è·¯ç”±å™¨ï¼ˆrouterï¼‰ç›¸äº’è¿æ¥èµ·æ¥çš„ã€‚äº’è”ç½‘ä½¿ç”¨çš„ç½‘ç»œå±‚åè®®æ˜¯æ— è¿æ¥çš„ç½‘é™…åè®®ï¼ˆIntert Prococolï¼‰å’Œè®¸å¤šè·¯ç”±é€‰æ‹©åè®®ï¼Œå› æ­¤äº’è”ç½‘çš„ç½‘ç»œå±‚ä¹Ÿå«åšç½‘é™…å±‚æˆ– IP å±‚ã€‚\n\n### æ•°æ®é“¾è·¯å±‚\n\næ•°æ®é“¾è·¯å±‚(data link layer)é€šå¸¸ç®€ç§°ä¸ºé“¾è·¯å±‚ã€‚ä¸¤å°ä¸»æœºä¹‹é—´çš„æ•°æ®ä¼ è¾“ï¼Œæ€»æ˜¯åœ¨ä¸€æ®µä¸€æ®µçš„é“¾è·¯ä¸Šä¼ é€çš„ï¼Œè¿™å°±éœ€è¦ä½¿ç”¨ä¸“é—¨çš„é“¾è·¯å±‚çš„åè®®ã€‚\n\nåœ¨ä¸¤ä¸ªç›¸é‚»èŠ‚ç‚¹ä¹‹é—´ä¼ é€æ•°æ®æ—¶ï¼Œæ•°æ®é“¾è·¯å±‚å°†ç½‘ç»œå±‚äº¤ä¸‹æ¥çš„ IP æ•°æ®æŠ¥ç»„è£…æˆå¸§ï¼Œåœ¨ä¸¤ä¸ªç›¸é‚»èŠ‚ç‚¹é—´çš„é“¾è·¯ä¸Šä¼ é€å¸§ã€‚æ¯ä¸€å¸§åŒ…æ‹¬æ•°æ®å’Œå¿…è¦çš„æ§åˆ¶ä¿¡æ¯ï¼ˆå¦‚åŒæ­¥ä¿¡æ¯ï¼Œåœ°å€ä¿¡æ¯ï¼Œå·®é”™æ§åˆ¶ç­‰ï¼‰ã€‚\n\nåœ¨æ¥æ”¶æ•°æ®æ—¶ï¼Œæ§åˆ¶ä¿¡æ¯ä½¿æ¥æ”¶ç«¯èƒ½å¤ŸçŸ¥é“ä¸€ä¸ªå¸§ä»å“ªä¸ªæ¯”ç‰¹å¼€å§‹å’Œåˆ°å“ªä¸ªæ¯”ç‰¹ç»“æŸã€‚\n\nä¸€èˆ¬çš„ web åº”ç”¨çš„é€šä¿¡ä¼ è¾“æµæ˜¯è¿™æ ·çš„ï¼š\n\n![img](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOS81LzkvMTZhOWM5Y2Q1MjNlMDU5OQ.png)\n\nå‘é€ç«¯åœ¨å±‚ä¸å±‚ä¹‹é—´ä¼ è¾“æ•°æ®æ—¶ï¼Œæ¯ç»è¿‡ä¸€å±‚æ—¶ä¼šè¢«æ‰“ä¸Šä¸€ä¸ªè¯¥å±‚æ‰€å±çš„é¦–éƒ¨ä¿¡æ¯ã€‚åä¹‹ï¼Œæ¥æ”¶ç«¯åœ¨å±‚ä¸å±‚ä¹‹é—´ä¼ è¾“æ•°æ®æ—¶ï¼Œæ¯ç»è¿‡ä¸€å±‚æ—¶ä¼šæŠŠå¯¹åº”çš„é¦–éƒ¨ä¿¡æ¯å»é™¤ã€‚\n\n### ç‰©ç†å±‚\n\nåœ¨ç‰©ç†å±‚ä¸Šæ‰€ä¼ é€çš„æ•°æ®å•ä½æ˜¯æ¯”ç‰¹ã€‚ ç‰©ç†å±‚(physical layer)çš„ä½œç”¨æ˜¯å®ç°ç›¸é‚»è®¡ç®—æœºèŠ‚ç‚¹ä¹‹é—´æ¯”ç‰¹æµçš„é€æ˜ä¼ é€ï¼Œå°½å¯èƒ½å±è”½æ‰å…·ä½“ä¼ è¾“ä»‹è´¨å’Œç‰©ç†è®¾å¤‡çš„å·®å¼‚ã€‚ä½¿å…¶ä¸Šé¢çš„æ•°æ®é“¾è·¯å±‚ä¸å¿…è€ƒè™‘ç½‘ç»œçš„å…·ä½“ä¼ è¾“ä»‹è´¨æ˜¯ä»€ä¹ˆã€‚â€œé€æ˜ä¼ é€æ¯”ç‰¹æµâ€è¡¨ç¤ºç»å®é™…ç”µè·¯ä¼ é€åçš„æ¯”ç‰¹æµæ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œå¯¹ä¼ é€çš„æ¯”ç‰¹æµæ¥è¯´ï¼Œè¿™ä¸ªç”µè·¯å¥½åƒæ˜¯çœ‹ä¸è§çš„ã€‚\n\n### TCP/IP åè®®æ—\n\nåœ¨äº’è”ç½‘ä½¿ç”¨çš„å„ç§åè®®ä¸­æœ€é‡è¦å’Œæœ€è‘—åçš„å°±æ˜¯ TCP/IP ä¸¤ä¸ªåè®®ã€‚ç°åœ¨äººä»¬ç»å¸¸æåˆ°çš„ TCP/IP å¹¶ä¸ä¸€å®šæ˜¯å•æŒ‡ TCP å’Œ IP è¿™ä¸¤ä¸ªå…·ä½“çš„åè®®ï¼Œè€Œå¾€å¾€æ˜¯è¡¨ç¤ºäº’è”ç½‘æ‰€ä½¿ç”¨çš„æ•´ä¸ª TCP/IP åè®®æ—ã€‚\n\n![img](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOS80LzcvMTY5ZjY5NjZjMjRhZjM0NQ.png)\n\n\n\nTCPï¼ˆä¼ è¾“æ§åˆ¶åè®®ï¼‰å’Œ IPï¼ˆç½‘é™…åè®®ï¼‰æ˜¯**æœ€å…ˆå®šä¹‰çš„ä¸¤ä¸ªæ ¸å¿ƒåè®®**ï¼Œæ‰€ä»¥æ‰ç»Ÿç§°ä¸º TCP/IP åè®®æ—\n\n## TCPçš„ä¸‰æ¬¡æ¡æ‰‹å››æ¬¡æŒ¥æ‰‹\n\nTCP æ˜¯ä¸€ç§é¢å‘è¿æ¥çš„ã€å¯é çš„ã€åŸºäºå­—èŠ‚æµçš„ä¼ è¾“å±‚é€šä¿¡åè®®ï¼Œåœ¨å‘é€æ•°æ®å‰ï¼Œé€šä¿¡åŒæ–¹å¿…é¡»åœ¨å½¼æ­¤é—´å»ºç«‹ä¸€æ¡è¿æ¥ã€‚æ‰€è°“çš„â€œè¿æ¥â€ï¼Œå…¶å®æ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¿å­˜çš„ä¸€ä»½å…³äºå¯¹æ–¹çš„ä¿¡æ¯ï¼Œå¦‚ ip åœ°å€ã€ç«¯å£å·ç­‰ã€‚\n\nä¸€ä¸ª TCP è¿æ¥ç”±ä¸€ä¸ª 4 å…ƒç»„æ„æˆï¼Œåˆ†åˆ«æ˜¯ä¸¤ä¸ª IP åœ°å€å’Œä¸¤ä¸ªç«¯å£å·ã€‚ä¸€ä¸ª TCP è¿æ¥é€šå¸¸åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼šè¿æ¥ã€æ•°æ®ä¼ è¾“ã€é€€å‡ºï¼ˆå…³é—­ï¼‰ã€‚**é€šè¿‡ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹ä¸€ä¸ªé“¾æ¥ï¼Œé€šè¿‡å››æ¬¡æŒ¥æ‰‹æ¥å…³é—­ä¸€ä¸ªè¿æ¥**ã€‚\n\n**å½“ä¸€ä¸ªè¿æ¥è¢«å»ºç«‹æˆ–è¢«ç»ˆæ­¢æ—¶ï¼Œäº¤æ¢çš„æŠ¥æ–‡æ®µåªåŒ…å«TCPå¤´éƒ¨ï¼Œè€Œæ²¡æœ‰æ•°æ®**ã€‚\n\n### TCPæŠ¥æ–‡çš„å¤´éƒ¨ç»“æ„\n\næœ‰å‡ ä¸ªå­—æ®µéœ€è¦é‡ç‚¹ä»‹ç»ä¸‹ï¼š\n\nï¼ˆ1ï¼‰åºå·ï¼šseq åºå·ï¼Œå  32 ä½ï¼Œç”¨æ¥æ ‡è¯†ä» TCP æºç«¯å‘ç›®çš„ç«¯å‘é€çš„å­—èŠ‚æµï¼Œå‘èµ·æ–¹å‘é€æ•°æ®æ—¶å¯¹æ­¤è¿›è¡Œæ ‡è®°ã€‚\n\nï¼ˆ2ï¼‰ç¡®è®¤åºå·ï¼šack åºå·ï¼Œå  32 ä½ï¼Œåªæœ‰ ACK æ ‡å¿—ä½ä¸º 1 æ—¶ï¼Œç¡®è®¤åºå·å­—æ®µæ‰æœ‰æ•ˆï¼Œack=seq+1ã€‚\n\nï¼ˆ3ï¼‰æ ‡å¿—ä½ï¼šå…± 6 ä¸ªï¼Œå³ URGã€ACKã€PSHã€RSTã€SYNã€FIN ç­‰ï¼Œå…·ä½“å«ä¹‰å¦‚ä¸‹ï¼š\n\n- ACKï¼šç¡®è®¤åºå·æœ‰æ•ˆã€‚\n- FINï¼šé‡Šæ”¾ä¸€ä¸ªè¿æ¥ã€‚\n- PSHï¼šæ¥æ”¶æ–¹åº”è¯¥å°½å¿«å°†è¿™ä¸ªæŠ¥æ–‡äº¤ç»™åº”ç”¨å±‚ã€‚\n- RSTï¼šé‡ç½®è¿æ¥ã€‚\n- SYNï¼šå‘èµ·ä¸€ä¸ªæ–°è¿æ¥ã€‚\n- URGï¼šç´§æ€¥æŒ‡é’ˆï¼ˆurgent pointerï¼‰æœ‰æ•ˆã€‚\n\néœ€è¦æ³¨æ„çš„æ˜¯ï¼š\n\n- ä¸è¦å°†ç¡®è®¤åºå· ack ä¸æ ‡å¿—ä½ä¸­çš„ ACK ææ··äº†ã€‚\n- ç¡®è®¤æ–¹ ack=å‘èµ·æ–¹ seq+1ï¼Œä¸¤ç«¯é…å¯¹ã€‚\n\n### ä¸‰æ¬¡æ¡æ‰‹\n\n> ä¸‰æ¬¡æ¡æ‰‹çš„æœ¬è´¨æ˜¯ç¡®è®¤é€šä¿¡åŒæ–¹æ”¶å‘æ•°æ®çš„èƒ½åŠ›\n\nA->B\n\nA å‘é€ç»™ Bï¼ŒB è‹¥æ”¶åˆ°\n\n> è¯´æ˜BçŸ¥é“ï¼šAå¯ä»¥å‘ï¼ŒBå¯ä»¥æ”¶\n\nB è¿”å›ç»™ Aï¼ŒA è‹¥æ”¶åˆ°ï¼šè¯´æ˜ A ä¹‹å‰å‘ç»™ B çš„ B æ”¶åˆ°äº†ï¼ŒåŒæ—¶ B ä¹Ÿèƒ½ç»™è‡ªå·±å›ä¿¡ï¼Œè‡ªå·±èƒ½æ”¶åˆ°è¿™ä¸ªå›ä¿¡ã€‚\n\n> è¯´æ˜ï¼šAçŸ¥é“ï¼šAèƒ½å‘èƒ½æ”¶ï¼ŒBèƒ½æ”¶èƒ½å‘\n\nä½†æ˜¯æ­¤æ—¶ B ä¸çŸ¥é“ A æ˜¯å¦å¯ä»¥æ”¶ï¼ŒB æ˜¯å¦å‘é€æ­£å¸¸\n\näºæ˜¯ A å‘é€ç»™ Bï¼ŒB è‹¥æ”¶åˆ°ï¼šè¯´æ˜ B çš„å‘é€å›ä¿¡ A èƒ½æ”¶åˆ°\n\n> è¯´æ˜ï¼šB çŸ¥é“ A å¯ä»¥æ”¶ï¼ŒB å¯ä»¥å‘ï¼Œç»“åˆç¬¬ä¸€æ­¥ï¼Œå¾—åˆ° B ä¹ŸçŸ¥é“ A èƒ½å‘èƒ½æ”¶ï¼ŒB èƒ½æ”¶èƒ½å‘\n\n![ä¸‰æ¬¡æ¡æ‰‹](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAyMC8xLzcvMTZmN2UwM2IxZWE1MDdlOA.png)\n\n### å››æ¬¡æŒ¥æ‰‹\n\n> å››æ¬¡æŒ¥æ‰‹çš„ç›®çš„æ˜¯å…³é—­ä¸€ä¸ªè¿æ¥\n\n![å››æ¬¡æŒ¥æ‰‹](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAyMC8xLzcvMTZmN2UwM2IyMWEwN2YwYw.png)\n\nA å’Œ B æ‰“ç”µè¯ï¼Œé€šè¯å³å°†ç»“æŸåï¼Œ\nA è¯´â€œæˆ‘æ²¡å•¥è¦è¯´çš„äº†â€ï¼Œ\nB å›ç­”â€œæˆ‘çŸ¥é“äº†â€ï¼Œ\nä½†æ˜¯ B å¯èƒ½è¿˜ä¼šæœ‰è¦è¯´çš„è¯ï¼ŒA ä¸èƒ½è¦æ±‚ B è·Ÿç€è‡ªå·±çš„èŠ‚å¥ç»“æŸé€šè¯ï¼Œäºæ˜¯ B å¯èƒ½åˆå·´æ‹‰å·´æ‹‰è¯´äº†ä¸€é€šï¼Œæœ€å B è¯´â€œæˆ‘è¯´å®Œäº†â€ï¼Œ\nA å›ç­”â€œçŸ¥é“äº†â€ï¼Œè¿™æ ·é€šè¯æ‰ç®—ç»“æŸã€‚\n","source":"_posts/Javaå…«è‚¡æ–‡-è®¡ç®—æœºç½‘ç»œ.md","raw":"---\ntitle: Javaå…«è‚¡æ–‡ - è®¡ç®—æœºç½‘ç»œ\ncopyright: true\nmathjax: false\ncategories:\n  - Javaå…«è‚¡æ–‡\ndate: 2023-01-25 13:44:16\ntags:\ntoc: true\nurlname: computer-network\n---\n\n> æ•´ç†çš„è®¡ç®—æœºç½‘ç»œç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½\t<!--more-->\n\n## æ·±å…¥ç†è§£HTTPSå·¥ä½œåŸç†\n\n> https://juejin.cn/post/6844903830916694030\n\n### å‰è¨€\n\nè¿‘å‡ å¹´ï¼Œäº’è”ç½‘å‘ç”Ÿç€ç¿»å¤©è¦†åœ°çš„å˜åŒ–ï¼Œå°¤å…¶æ˜¯æˆ‘ä»¬ä¸€ç›´ä¹ ä»¥ä¸ºå¸¸çš„ HTTP åè®®ï¼Œåœ¨é€æ¸çš„è¢« HTTPS åè®®æ‰€å–ä»£ï¼Œåœ¨æµè§ˆå™¨ã€æœç´¢å¼•æ“ã€CA æœºæ„ã€å¤§å‹äº’è”ç½‘ä¼ä¸šçš„å…±åŒä¿ƒè¿›ä¸‹ï¼Œäº’è”ç½‘è¿æ¥äº†â€œHTTPS åŠ å¯†æ—¶ä»£â€ï¼ŒHTTPS å°†åœ¨æœªæ¥çš„å‡ å¹´å†…å…¨é¢å–ä»£ HTTP æˆä¸ºä¼ è¾“åè®®çš„ä¸»æµã€‚\n\nè¯»å®Œæœ¬æ–‡ï¼Œå¸Œæœ›ä½ èƒ½æ˜ç™½ï¼š\n\n- HTTP é€šä¿¡å­˜åœ¨ä»€ä¹ˆé—®é¢˜\n- HTTPS å¦‚ä½•æ”¹è¿› HTTP å­˜åœ¨é‚£äº›é—®é¢˜\n- HTTPS å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆ\n\n### ä¸€ã€ä»€ä¹ˆæ˜¯HTTPS\n\nHTTPS æ˜¯åœ¨ HTTP ä¸Šå»ºç«‹ SSL åŠ å¯†å±‚ï¼Œå¹¶å¯¹ä¼ è¾“æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œæ˜¯ HTTP åè®®çš„å®‰å…¨ç‰ˆã€‚ç°åœ¨å®ƒè¢«å¹¿æ³›ç”¨äºä¸‡ç»´ç½‘ä¸Šå®‰å…¨æ•æ„Ÿçš„é€šè®¯ï¼Œä¾‹å¦‚äº¤æ˜“æ”¯ä»˜æ–¹é¢ã€‚\n\nHTTPS ä¸»è¦ä½œç”¨æ˜¯ï¼š\n\nï¼ˆ1ï¼‰å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œå¹¶å»ºç«‹ä¸€ä¸ªä¿¡æ¯å®‰å…¨é€šé“ï¼Œæ¥ä¿è¯ä¼ è¾“è¿‡ç¨‹ä¸­çš„æ•°æ®å®‰å…¨;\n\nï¼ˆ2ï¼‰å¯¹ç½‘ç«™æœåŠ¡å™¨è¿›è¡ŒçœŸå®èº«ä»½è®¤è¯ã€‚\n\næˆ‘ä»¬ç»å¸¸ä¼šåœ¨ Web çš„ç™»å½•é¡µé¢å’Œè´­ç‰©ç»“ç®—ç•Œé¢ç­‰ä½¿ç”¨ HTTPS é€šä¿¡ã€‚ä½¿ç”¨ HTTPS é€šä¿¡æ—¶ï¼Œä¸å†ç”¨`http://`ï¼Œè€Œæ˜¯æ”¹ç”¨`https://`ã€‚å¦å¤–ï¼Œå½“æµè§ˆå™¨è®¿é—® HTTPS é€šä¿¡æœ‰æ•ˆçš„ Web ç½‘ç«™æ—¶ï¼Œæµè§ˆå™¨çš„åœ°å€æ å†…ä¼šå‡ºç°ä¸€ä¸ªå¸¦é”çš„æ ‡è®°ã€‚å¯¹ HTTPS çš„æ˜¾ç¤ºæ–¹å¼ä¼šå› æµè§ˆå™¨çš„ä¸åŒè€Œæœ‰æ‰€æ”¹å˜ã€‚\n\n### äºŒã€ä¸ºä»€ä¹ˆéœ€è¦HTTPS\n\nåœ¨ HTTP åè®®ä¸­æœ‰å¯èƒ½å­˜åœ¨ä¿¡æ¯çªƒå–æˆ–èº«ä»½ä¼ªè£…ç­‰å®‰å…¨é—®é¢˜ã€‚ä½¿ç”¨ HTTPS é€šä¿¡æœºåˆ¶å¯ä»¥æœ‰æ•ˆåœ°é˜²æ­¢è¿™äº›é—®é¢˜ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£ä¸‹ HTTP åè®®å­˜åœ¨çš„å“ªäº›é—®é¢˜ï¼š\n\n- é€šä¿¡ä½¿ç”¨æ˜æ–‡ï¼ˆä¸åŠ å¯†ï¼‰ï¼Œå†…å®¹å¯èƒ½è¢«**çªƒå¬** \n\n\tä¿¡æ¯åŠ å¯†ï¼šä½¿ç”¨éå¯¹ç§°åŠ å¯†ï¼ˆRSAï¼‰äº¤æ¢å¯†é’¥ï¼Œä½¿ç”¨å¯¹ç§°åŠ å¯†ï¼ˆAESï¼‰ä¼ è¾“æŠ¥æ–‡ï¼Œå…¼å¤‡å®‰å…¨ä¸æ•ˆç‡\n\n- æ— æ³•è¯æ˜æŠ¥æ–‡çš„å®Œæ•´æ€§ï¼Œæ‰€ä»¥å¯èƒ½é­**ç¯¡æ”¹** \n\n\tå®Œæ•´æ€§æ ¡éªŒï¼šæ•°å­—ç­¾å\n\n- ä¸éªŒè¯é€šä¿¡æ–¹çš„èº«ä»½ï¼Œå› æ­¤æœ‰å¯èƒ½é­é‡**ä¼ªè£…** \n\n\tèº«ä»½éªŒè¯ï¼šæ•°å­—è¯ä¹¦\n\n### ä¸‰ã€HTTPSå¦‚ä½•è§£å†³HTTPä¸Šè¿°é—®é¢˜?\n\n**æ‰€è°“HTTPSï¼Œå…¶å®å°±æ˜¯èº«æŠ«SSLåè®®è¿™å±‚å¤–å£³çš„HTTP**ã€‚\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422132445345.png\" alt=\"image-20220422132445345\" style=\"zoom:33%;\" />\n\n\n\nåœ¨é‡‡ç”¨ SSL åï¼ŒHTTP å°±æ‹¥æœ‰äº† HTTPS çš„åŠ å¯†ã€å®Œæ•´æ€§æ ¡éªŒã€èº«ä»½éªŒè¯è¿™äº›åŠŸèƒ½ã€‚ä¹Ÿå°±æ˜¯è¯´**HTTPåŠ ä¸ŠåŠ å¯†å¤„ç†å’Œè®¤è¯ä»¥åŠå®Œæ•´æ€§ä¿æŠ¤åå³æ˜¯HTTPS**ã€‚\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422132508534.png\" alt=\"image-20220422132508534\" style=\"zoom:33%;\" />\n\nHTTPS åè®®çš„ä¸»è¦åŠŸèƒ½åŸºæœ¬éƒ½ä¾èµ–äº TLS/SSL åè®®ï¼ŒTLS/SSL çš„åŠŸèƒ½å®ç°ä¸»è¦ä¾èµ–äºä¸‰ç±»åŸºæœ¬ç®—æ³•ï¼šæ•£åˆ—å‡½æ•° ã€å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†ï¼Œ**å…¶åˆ©ç”¨éå¯¹ç§°åŠ å¯†å®ç°èº«ä»½è®¤è¯å’Œå¯†é’¥åå•†ï¼Œå¯¹ç§°åŠ å¯†ç®—æ³•é‡‡ç”¨åå•†çš„å¯†é’¥å¯¹æ•°æ®åŠ å¯†ï¼ŒåŸºäºæ•£åˆ—å‡½æ•°éªŒè¯ä¿¡æ¯çš„å®Œæ•´æ€§**ã€‚\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422132525551.png\" alt=\"image-20220422132525551\" style=\"zoom:33%;\" />\n\n\n\n#### 1.è§£å†³å†…å®¹å¯èƒ½è¢«çªƒå¬çš„é—®é¢˜â€”â€”åŠ å¯†\n\n#### æ–¹æ³•1.å¯¹ç§°åŠ å¯†\n\nè¿™ç§æ–¹å¼åŠ å¯†å’Œè§£å¯†åŒç”¨ä¸€ä¸ªå¯†é’¥ã€‚åŠ å¯†å’Œè§£å¯†éƒ½ä¼šç”¨åˆ°å¯†é’¥ã€‚**æ²¡æœ‰å¯†é’¥å°±æ— æ³•å¯¹å¯†ç è§£å¯†ï¼Œåè¿‡æ¥è¯´ï¼Œä»»ä½•äººåªè¦æŒæœ‰å¯†é’¥å°±èƒ½è§£å¯†äº†**ã€‚\n\nä»¥å¯¹ç§°åŠ å¯†æ–¹å¼åŠ å¯†æ—¶å¿…é¡»å°†å¯†é’¥ä¹Ÿå‘ç»™å¯¹æ–¹ã€‚å¯ç©¶ç«Ÿæ€æ ·æ‰èƒ½å®‰å…¨åœ°è½¬äº¤ï¼Ÿåœ¨äº’è”ç½‘ä¸Šè½¬å‘å¯†é’¥æ—¶ï¼Œå¦‚æœé€šä¿¡è¢«ç›‘å¬é‚£ä¹ˆå¯†é’¥å°±å¯ä¼šè½äººæ”»å‡»è€…ä¹‹æ‰‹ï¼ŒåŒæ—¶ä¹Ÿå°±å¤±å»äº†åŠ å¯†çš„æ„ä¹‰ã€‚å¦å¤–è¿˜å¾—è®¾æ³•å®‰å…¨åœ°ä¿ç®¡æ¥æ”¶åˆ°çš„å¯†é’¥ã€‚\n\n#### æ–¹æ³•2.éå¯¹ç§°åŠ å¯†\n\nå…¬å¼€å¯†é’¥åŠ å¯†ä½¿ç”¨ä¸€å¯¹éå¯¹ç§°çš„å¯†é’¥ã€‚ä¸€æŠŠå«åšç§æœ‰å¯†é’¥ï¼Œå¦ä¸€æŠŠå«åšå…¬å¼€å¯†é’¥ã€‚é¡¾åæ€ä¹‰ï¼Œ**ç§æœ‰å¯†é’¥ä¸èƒ½è®©å…¶ä»–ä»»ä½•äººçŸ¥é“ï¼Œè€Œå…¬å¼€å¯†é’¥åˆ™å¯ä»¥éšæ„å‘å¸ƒï¼Œä»»ä½•äººéƒ½å¯ä»¥è·å¾—**ã€‚\n\nä½¿ç”¨å…¬å¼€å¯†é’¥åŠ å¯†æ–¹å¼ï¼Œå‘é€å¯†æ–‡çš„ä¸€æ–¹ä½¿ç”¨**å¯¹æ–¹çš„å…¬å¼€å¯†é’¥**è¿›è¡ŒåŠ å¯†å¤„ç†ï¼Œå¯¹æ–¹æ”¶åˆ°è¢«åŠ å¯†çš„ä¿¡æ¯åï¼Œå†ä½¿ç”¨è‡ªå·±çš„ç§æœ‰å¯†é’¥è¿›è¡Œè§£å¯†ã€‚åˆ©ç”¨è¿™ç§æ–¹å¼ï¼Œä¸éœ€è¦å‘é€ç”¨æ¥è§£å¯†çš„ç§æœ‰å¯†é’¥ï¼Œä¹Ÿä¸å¿…æ‹…å¿ƒå¯†é’¥è¢«æ”»å‡»è€…çªƒå¬è€Œç›—èµ°ã€‚\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422132541737.png\" alt=\"image-20220422132541737\" style=\"zoom:33%;\" />\n\néå¯¹ç§°åŠ å¯†çš„ç‰¹ç‚¹æ˜¯ä¿¡æ¯ä¼ è¾“ä¸€å¯¹å¤šï¼ŒæœåŠ¡å™¨åªéœ€è¦ç»´æŒä¸€ä¸ªç§é’¥å°±èƒ½å¤Ÿå’Œå¤šä¸ªå®¢æˆ·ç«¯è¿›è¡ŒåŠ å¯†é€šä¿¡ã€‚\n\nè¿™ç§æ–¹å¼æœ‰ä»¥ä¸‹ç¼ºç‚¹ï¼š\n\n- å…¬é’¥æ˜¯å…¬å¼€çš„ï¼Œæ‰€ä»¥é’ˆå¯¹ç§é’¥åŠ å¯†çš„ä¿¡æ¯ï¼Œé»‘å®¢æˆªè·åå¯ä»¥ä½¿ç”¨å…¬é’¥è¿›è¡Œè§£å¯†ï¼Œè·å–å…¶ä¸­çš„å†…å®¹ï¼›\n- å…¬é’¥å¹¶ä¸åŒ…å«æœåŠ¡å™¨çš„ä¿¡æ¯ï¼Œä½¿ç”¨éå¯¹ç§°åŠ å¯†ç®—æ³•æ— æ³•ç¡®ä¿æœåŠ¡å™¨èº«ä»½çš„åˆæ³•æ€§ï¼Œå­˜åœ¨ä¸­é—´äººæ”»å‡»çš„é£é™©ï¼ŒæœåŠ¡å™¨å‘é€ç»™å®¢æˆ·ç«¯çš„å…¬é’¥å¯èƒ½åœ¨ä¼ é€è¿‡ç¨‹ä¸­è¢«ä¸­é—´äººæˆªè·å¹¶ç¯¡æ”¹ï¼›\n- ä½¿ç”¨éå¯¹ç§°åŠ å¯†**åœ¨æ•°æ®åŠ å¯†è§£å¯†è¿‡ç¨‹éœ€è¦æ¶ˆè€—ä¸€å®šæ—¶é—´**ï¼Œé™ä½äº†æ•°æ®ä¼ è¾“æ•ˆç‡ï¼›\n\n#### æ–¹æ³•3.å¯¹ç§°åŠ å¯†+éå¯¹ç§°åŠ å¯†(HTTPSé‡‡ç”¨è¿™ç§æ–¹å¼)\n\nä½¿ç”¨å¯¹ç§°å¯†é’¥çš„å¥½å¤„æ˜¯è§£å¯†çš„æ•ˆç‡æ¯”è¾ƒå¿«ï¼Œä½¿ç”¨éå¯¹ç§°å¯†é’¥çš„å¥½å¤„æ˜¯å¯ä»¥ä½¿å¾—ä¼ è¾“çš„å†…å®¹ä¸èƒ½è¢«ç ´è§£ï¼Œå› ä¸ºå°±ç®—ä½ æ‹¦æˆªåˆ°äº†æ•°æ®ï¼Œä½†æ˜¯æ²¡æœ‰å¯¹åº”çš„ç§é’¥ï¼Œä¹Ÿæ˜¯ä¸èƒ½ç ´è§£å†…å®¹çš„ã€‚å°±æ¯”å¦‚è¯´ä½ æŠ¢åˆ°äº†ä¸€ä¸ªä¿é™©æŸœï¼Œä½†æ˜¯æ²¡æœ‰ä¿é™©æŸœçš„é’¥åŒ™ä¹Ÿä¸èƒ½æ‰“å¼€ä¿é™©æŸœã€‚é‚£æˆ‘ä»¬å°±å°†å¯¹ç§°åŠ å¯†ä¸éå¯¹ç§°åŠ å¯†ç»“åˆèµ·æ¥,å……åˆ†åˆ©ç”¨ä¸¤è€…å„è‡ªçš„ä¼˜åŠ¿ï¼Œ**åœ¨äº¤æ¢å¯†é’¥ç¯èŠ‚ä½¿ç”¨éå¯¹ç§°åŠ å¯†æ–¹å¼ï¼Œä¹‹åçš„å»ºç«‹é€šä¿¡äº¤æ¢æŠ¥æ–‡é˜¶æ®µåˆ™ä½¿ç”¨å¯¹ç§°åŠ å¯†æ–¹å¼**ã€‚\n\nå…·ä½“åšæ³•æ˜¯ï¼š**å‘é€å¯†æ–‡çš„ä¸€æ–¹ä½¿ç”¨å¯¹æ–¹çš„å…¬é’¥è¿›è¡ŒåŠ å¯†å¤„ç†â€œå¯¹ç§°çš„å¯†é’¥â€ï¼Œç„¶åå¯¹æ–¹ç”¨è‡ªå·±çš„ç§é’¥è§£å¯†æ‹¿åˆ°â€œå¯¹ç§°çš„å¯†é’¥â€ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿äº¤æ¢çš„å¯†é’¥æ˜¯å®‰å…¨çš„å‰æä¸‹ï¼Œä½¿ç”¨å¯¹ç§°åŠ å¯†æ–¹å¼è¿›è¡Œé€šä¿¡**ã€‚æ‰€ä»¥ï¼ŒHTTPS é‡‡ç”¨å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†ä¸¤è€…å¹¶ç”¨çš„æ··åˆåŠ å¯†æœºåˆ¶ã€‚\n\n#### 2.è§£å†³æŠ¥æ–‡å¯èƒ½é­ç¯¡æ”¹é—®é¢˜â€”â€”æ•°å­—ç­¾å\n\nç½‘ç»œä¼ è¾“è¿‡ç¨‹ä¸­éœ€è¦ç»è¿‡å¾ˆå¤šä¸­é—´èŠ‚ç‚¹ï¼Œè™½ç„¶æ•°æ®æ— æ³•è¢«è§£å¯†ï¼Œä½†å¯èƒ½è¢«ç¯¡æ”¹ï¼Œé‚£å¦‚ä½•æ ¡éªŒæ•°æ®çš„å®Œæ•´æ€§å‘¢ï¼Ÿ----æ ¡éªŒæ•°å­—ç­¾åã€‚\n\n**æ•°å­—ç­¾åæœ‰ä¸¤ç§åŠŸæ•ˆ**ï¼š\n\n- èƒ½ç¡®å®šæ¶ˆæ¯ç¡®å®æ˜¯ç”±å‘é€æ–¹ç­¾åå¹¶å‘å‡ºæ¥çš„ï¼Œå› ä¸ºåˆ«äººå‡å†’ä¸äº†å‘é€æ–¹çš„ç­¾åã€‚\n- æ•°å­—ç­¾åèƒ½ç¡®å®šæ¶ˆæ¯çš„å®Œæ•´æ€§,è¯æ˜æ•°æ®æ˜¯å¦æœªè¢«ç¯¡æ”¹è¿‡ã€‚\n\n**æ•°å­—ç­¾åå¦‚ä½•ç”Ÿæˆ:**\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422132605229.png\" alt=\"image-20220422132605229\" style=\"zoom:33%;\" />\n\nå°†ä¸€æ®µæ–‡æœ¬å…ˆç”¨ Hash å‡½æ•°ç”Ÿæˆæ¶ˆæ¯æ‘˜è¦ï¼Œç„¶åç”¨å‘é€è€…çš„ç§é’¥åŠ å¯†ç”Ÿæˆæ•°å­—ç­¾åï¼Œä¸åŸæ–‡æ–‡ä¸€èµ·ä¼ é€ç»™æ¥æ”¶è€…ã€‚æ¥ä¸‹æ¥å°±æ˜¯æ¥æ”¶è€…æ ¡éªŒæ•°å­—ç­¾åçš„æµç¨‹äº†ã€‚\n\n**æ ¡éªŒæ•°å­—ç­¾åæµç¨‹**ï¼š\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422132617982.png\" alt=\"image-20220422132617982\" style=\"zoom:33%;\" />\n\næ¥æ”¶è€…åªæœ‰ç”¨å‘é€è€…çš„å…¬é’¥æ‰èƒ½è§£å¯†è¢«åŠ å¯†çš„æ‘˜è¦ä¿¡æ¯ï¼Œç„¶åç”¨ HASH å‡½æ•°å¯¹æ”¶åˆ°çš„åŸæ–‡äº§ç”Ÿä¸€ä¸ªæ‘˜è¦ä¿¡æ¯ï¼Œä¸ä¸Šä¸€æ­¥å¾—åˆ°çš„æ‘˜è¦ä¿¡æ¯å¯¹æ¯”ã€‚å¦‚æœç›¸åŒï¼Œåˆ™è¯´æ˜æ”¶åˆ°çš„ä¿¡æ¯æ˜¯å®Œæ•´çš„ï¼Œåœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ²¡æœ‰è¢«ä¿®æ”¹ï¼Œå¦åˆ™è¯´æ˜ä¿¡æ¯è¢«ä¿®æ”¹è¿‡ï¼Œå› æ­¤æ•°å­—ç­¾åèƒ½å¤ŸéªŒè¯ä¿¡æ¯çš„å®Œæ•´æ€§ã€‚\n\nå‡è®¾æ¶ˆæ¯ä¼ é€’åœ¨ Kobeï¼ŒJames ä¸¤äººä¹‹é—´å‘ç”Ÿã€‚James å°†æ¶ˆæ¯è¿åŒæ•°å­—ç­¾åä¸€èµ·å‘é€ç»™ Kobeï¼ŒKobe æ¥æ”¶åˆ°æ¶ˆæ¯åï¼Œé€šè¿‡æ ¡éªŒæ•°å­—ç­¾åï¼Œå°±å¯ä»¥éªŒè¯æ¥æ”¶åˆ°çš„æ¶ˆæ¯å°±æ˜¯ James å‘é€çš„ã€‚å½“ç„¶ï¼Œè¿™ä¸ªè¿‡ç¨‹çš„å‰ææ˜¯ Kobe çŸ¥é“ James çš„å…¬é’¥ã€‚é—®é¢˜çš„å…³é”®çš„æ˜¯ï¼Œå’Œæ¶ˆæ¯æœ¬èº«ä¸€æ ·ï¼Œå…¬é’¥ä¸èƒ½åœ¨ä¸å®‰å…¨çš„ç½‘ç»œä¸­ç›´æ¥å‘é€ç»™ Kobe,æˆ–è€…è¯´æ‹¿åˆ°çš„å…¬é’¥å¦‚ä½•è¯æ˜æ˜¯ James çš„ã€‚\n\næ­¤æ—¶å°±éœ€è¦å¼•å…¥äº†**è¯ä¹¦é¢å‘æœºæ„**ï¼ˆCertificate Authorityï¼Œç®€ç§° CAï¼‰ï¼ŒCA æ•°é‡å¹¶ä¸å¤šï¼ŒKobe å®¢æˆ·ç«¯å†…ç½®äº†æ‰€æœ‰å—ä¿¡ä»» CA çš„è¯ä¹¦ã€‚CA å¯¹ James çš„å…¬é’¥ï¼ˆå’Œå…¶ä»–ä¿¡æ¯ï¼‰æ•°å­—ç­¾ååç”Ÿæˆè¯ä¹¦ã€‚\n\n#### 3.è§£å†³é€šä¿¡æ–¹èº«ä»½å¯èƒ½è¢«ä¼ªè£…çš„é—®é¢˜â€”â€”æ•°å­—è¯ä¹¦\n\næ•°å­—è¯ä¹¦è®¤è¯æœºæ„å¤„äºå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨åŒæ–¹éƒ½å¯ä¿¡èµ–çš„ç¬¬ä¸‰æ–¹æœºæ„çš„ç«‹åœºä¸Šã€‚\n\næˆ‘ä»¬æ¥ä»‹ç»ä¸€ä¸‹æ•°å­—è¯ä¹¦è®¤è¯æœºæ„çš„ä¸šåŠ¡æµç¨‹ï¼š\n\n- æœåŠ¡å™¨çš„è¿è¥äººå‘˜å‘ç¬¬ä¸‰æ–¹æœºæ„ CA æäº¤å…¬é’¥ã€ç»„ç»‡ä¿¡æ¯ã€ä¸ªäººä¿¡æ¯(åŸŸå)ç­‰ä¿¡æ¯å¹¶ç”³è¯·è®¤è¯;\n- CA é€šè¿‡çº¿ä¸Šã€çº¿ä¸‹ç­‰å¤šç§æ‰‹æ®µéªŒè¯ç”³è¯·è€…æä¾›ä¿¡æ¯çš„çœŸå®æ€§ï¼Œå¦‚ç»„ç»‡æ˜¯å¦å­˜åœ¨ã€ä¼ä¸šæ˜¯å¦åˆæ³•ï¼Œæ˜¯å¦æ‹¥æœ‰åŸŸåçš„æ‰€æœ‰æƒç­‰;\n- å¦‚ä¿¡æ¯å®¡æ ¸é€šè¿‡ï¼ŒCA ä¼šå‘ç”³è¯·è€…ç­¾å‘è®¤è¯æ–‡ä»¶-è¯ä¹¦ã€‚è¯ä¹¦åŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼šç”³è¯·è€…å…¬é’¥ã€ç”³è¯·è€…çš„ç»„ç»‡ä¿¡æ¯å’Œä¸ªäººä¿¡æ¯ã€ç­¾å‘æœºæ„ CA çš„ä¿¡æ¯ã€æœ‰æ•ˆæ—¶é—´ã€è¯ä¹¦åºåˆ—å·ç­‰ä¿¡æ¯çš„æ˜æ–‡ï¼ŒåŒæ—¶åŒ…å«ä¸€ä¸ªç­¾åã€‚ å…¶ä¸­ç­¾åçš„äº§ç”Ÿç®—æ³•ï¼šé¦–å…ˆï¼Œä½¿ç”¨æ•£åˆ—å‡½æ•°è®¡ç®—å…¬å¼€çš„æ˜æ–‡ä¿¡æ¯çš„ä¿¡æ¯æ‘˜è¦ï¼Œç„¶åï¼Œé‡‡ç”¨ CA çš„ç§é’¥å¯¹ä¿¡æ¯æ‘˜è¦è¿›è¡ŒåŠ å¯†ï¼Œå¯†æ–‡å³ç­¾å;\n- å®¢æˆ·ç«¯ Client å‘æœåŠ¡å™¨ Server å‘å‡ºè¯·æ±‚æ—¶ï¼ŒServer è¿”å›è¯ä¹¦æ–‡ä»¶;\n- å®¢æˆ·ç«¯ Client è¯»å–è¯ä¹¦ä¸­çš„ç›¸å…³çš„æ˜æ–‡ä¿¡æ¯ï¼Œé‡‡ç”¨ç›¸åŒçš„æ•£åˆ—å‡½æ•°è®¡ç®—å¾—åˆ°ä¿¡æ¯æ‘˜è¦ï¼Œç„¶åï¼Œåˆ©ç”¨å¯¹åº” CA çš„å…¬é’¥è§£å¯†ç­¾åæ•°æ®ï¼Œå¯¹æ¯”è¯ä¹¦çš„ä¿¡æ¯æ‘˜è¦ï¼Œå¦‚æœä¸€è‡´ï¼Œåˆ™å¯ä»¥ç¡®è®¤è¯ä¹¦çš„åˆæ³•æ€§ï¼Œå³æœåŠ¡å™¨çš„å…¬å¼€å¯†é’¥æ˜¯å€¼å¾—ä¿¡èµ–çš„ã€‚\n- å®¢æˆ·ç«¯è¿˜ä¼šéªŒè¯è¯ä¹¦ç›¸å…³çš„åŸŸåä¿¡æ¯ã€æœ‰æ•ˆæ—¶é—´ç­‰ä¿¡æ¯; å®¢æˆ·ç«¯ä¼šå†…ç½®ä¿¡ä»» CA çš„è¯ä¹¦ä¿¡æ¯(åŒ…å«å…¬é’¥)ï¼Œå¦‚æœ CA ä¸è¢«ä¿¡ä»»ï¼Œåˆ™æ‰¾ä¸åˆ°å¯¹åº” CA çš„è¯ä¹¦ï¼Œè¯ä¹¦ä¹Ÿä¼šè¢«åˆ¤å®šéæ³•ã€‚\n\n### å››ã€ HTTPSå·¥ä½œæµç¨‹\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422132710862.png\" alt=\"image-20220422132710862\" style=\"zoom:80%;\" />\n\n1.Client å‘èµ·ä¸€ä¸ª HTTPSï¼ˆæ¯”å¦‚`https://juejin.cn/user/4283353031252967`ï¼‰çš„è¯·æ±‚ï¼Œæ ¹æ® RFC2818 çš„è§„å®šï¼ŒClient çŸ¥é“éœ€è¦è¿æ¥ Server çš„ 443ï¼ˆé»˜è®¤ï¼‰ç«¯å£ã€‚\n\n2.Server æŠŠäº‹å…ˆé…ç½®å¥½çš„å…¬é’¥è¯ä¹¦ï¼ˆpublic key certificateï¼‰è¿”å›ç»™å®¢æˆ·ç«¯ã€‚\n\n3.Client éªŒè¯å…¬é’¥è¯ä¹¦ï¼šæ¯”å¦‚æ˜¯å¦åœ¨æœ‰æ•ˆæœŸå†…ï¼Œè¯ä¹¦çš„ç”¨é€”æ˜¯ä¸æ˜¯åŒ¹é… Client è¯·æ±‚çš„ç«™ç‚¹ï¼Œæ˜¯ä¸æ˜¯åœ¨ CRL åŠé”€åˆ—è¡¨é‡Œé¢ï¼Œå®ƒçš„ä¸Šä¸€çº§è¯ä¹¦æ˜¯å¦æœ‰æ•ˆï¼Œè¿™æ˜¯ä¸€ä¸ªé€’å½’çš„è¿‡ç¨‹ï¼Œç›´åˆ°éªŒè¯åˆ°æ ¹è¯ä¹¦ï¼ˆæ“ä½œç³»ç»Ÿå†…ç½®çš„ Root è¯ä¹¦æˆ–è€… Client å†…ç½®çš„ Root è¯ä¹¦ï¼‰ã€‚å¦‚æœéªŒè¯é€šè¿‡åˆ™ç»§ç»­ï¼Œä¸é€šè¿‡åˆ™æ˜¾ç¤ºè­¦å‘Šä¿¡æ¯ã€‚\n\n4.Client ä½¿ç”¨ä¼ªéšæœºæ•°ç”Ÿæˆå™¨ç”ŸæˆåŠ å¯†æ‰€ä½¿ç”¨çš„å¯¹ç§°å¯†é’¥ï¼Œç„¶åç”¨è¯ä¹¦çš„å…¬é’¥åŠ å¯†è¿™ä¸ªå¯¹ç§°å¯†é’¥ï¼Œå‘ç»™ Serverã€‚\n\n5.Server ä½¿ç”¨è‡ªå·±çš„ç§é’¥ï¼ˆprivate keyï¼‰è§£å¯†è¿™ä¸ªæ¶ˆæ¯ï¼Œå¾—åˆ°å¯¹ç§°å¯†é’¥ã€‚è‡³æ­¤ï¼ŒClient å’Œ Server åŒæ–¹éƒ½æŒæœ‰äº†ç›¸åŒçš„å¯¹ç§°å¯†é’¥ã€‚\n\n6.Server ä½¿ç”¨å¯¹ç§°å¯†é’¥åŠ å¯†â€œæ˜æ–‡å†…å®¹ Aâ€ï¼Œå‘é€ç»™ Clientã€‚\n\n7.Client ä½¿ç”¨å¯¹ç§°å¯†é’¥è§£å¯†å“åº”çš„å¯†æ–‡ï¼Œå¾—åˆ°â€œæ˜æ–‡å†…å®¹ Aâ€ã€‚\n\n8.Client å†æ¬¡å‘èµ· HTTPS çš„è¯·æ±‚ï¼Œä½¿ç”¨å¯¹ç§°å¯†é’¥åŠ å¯†è¯·æ±‚çš„â€œæ˜æ–‡å†…å®¹ Bâ€ï¼Œç„¶å Server ä½¿ç”¨å¯¹ç§°å¯†é’¥è§£å¯†å¯†æ–‡ï¼Œå¾—åˆ°â€œæ˜æ–‡å†…å®¹ Bâ€ã€‚\n\n### äº”ã€HTTP ä¸ HTTPS çš„åŒºåˆ«\n\n- HTTP æ˜¯æ˜æ–‡ä¼ è¾“åè®®ï¼ŒHTTPS åè®®æ˜¯ç”± SSL+HTTP åè®®æ„å»ºçš„å¯è¿›è¡ŒåŠ å¯†ä¼ è¾“ã€èº«ä»½è®¤è¯çš„ç½‘ç»œåè®®ï¼Œæ¯” HTTP åè®®å®‰å…¨ã€‚\n\n- HTTPS æ¯” HTTP æ›´åŠ å®‰å…¨;\n- HTTPS éœ€è¦ç”¨åˆ° SSL è¯ä¹¦ï¼Œè€Œ HTTP ä¸ç”¨;\n- HTTPS æ ‡å‡†ç«¯å£ 443ï¼ŒHTTP æ ‡å‡†ç«¯å£ 80;\n- HTTPS åŸºäºä¼ è¾“å±‚ï¼ŒHTTP åŸºäºåº”ç”¨å±‚;\n- HTTPS åœ¨æµè§ˆå™¨æ˜¾ç¤ºç»¿è‰²å®‰å…¨é”ï¼ŒHTTP æ²¡æœ‰æ˜¾ç¤º;\n\n### å…­ã€ä¸ºä½•ä¸æ‰€æœ‰çš„ç½‘ç«™éƒ½ä½¿ç”¨HTTPS\n\næ—¢ç„¶ HTTPS é‚£ä¹ˆå®‰å…¨å¯é ï¼Œé‚£ä¸ºä½•ä¸æ‰€æœ‰çš„ Web ç½‘ç«™éƒ½ä½¿ç”¨ HTTPSï¼Ÿ\n\né¦–å…ˆï¼Œå¾ˆå¤šäººè¿˜æ˜¯ä¼šè§‰å¾— HTTPS å®æ–½æœ‰é—¨æ§›ï¼Œè¿™ä¸ªé—¨æ§›åœ¨äºéœ€è¦æƒå¨ CA é¢å‘çš„ SSL è¯ä¹¦ã€‚ä»è¯ä¹¦çš„é€‰æ‹©ã€è´­ä¹°åˆ°éƒ¨ç½²ï¼Œä¼ ç»Ÿçš„æ¨¡å¼ä¸‹éƒ½ä¼šæ¯”è¾ƒè€—æ—¶è€—åŠ›ã€‚\n\nå…¶æ¬¡ï¼ŒHTTPS æ™®éè®¤ä¸ºæ€§èƒ½æ¶ˆè€—è¦å¤§äº HTTPï¼Œå› ä¸º**ä¸çº¯æ–‡æœ¬é€šä¿¡ç›¸æ¯”ï¼ŒåŠ å¯†é€šä¿¡ä¼šæ¶ˆè€—æ›´å¤šçš„CPUåŠå†…å­˜èµ„æº**ã€‚å¦‚æœæ¯æ¬¡é€šä¿¡éƒ½åŠ å¯†ï¼Œä¼šæ¶ˆè€—ç›¸å½“å¤šçš„èµ„æºï¼Œå¹³æ‘Šåˆ°ä¸€å°è®¡ç®—æœºä¸Šæ—¶ï¼Œèƒ½å¤Ÿå¤„ç†çš„è¯·æ±‚æ•°é‡å¿…å®šä¹Ÿä¼šéšä¹‹å‡å°‘ã€‚ä½†äº‹å®å¹¶éå¦‚æ­¤ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡æ€§èƒ½ä¼˜åŒ–ã€æŠŠè¯ä¹¦éƒ¨ç½²åœ¨ SLB æˆ– CDNï¼Œæ¥è§£å†³æ­¤é—®é¢˜ã€‚ä¸¾ä¸ªå®é™…çš„ä¾‹å­ï¼Œâ€œåŒåä¸€â€æœŸé—´ï¼Œå…¨ç«™ HTTPS çš„æ·˜å®ã€å¤©çŒ«ä¾ç„¶ä¿è¯äº†ç½‘ç«™å’Œç§»åŠ¨ç«¯çš„è®¿é—®ã€æµè§ˆã€äº¤æ˜“ç­‰æ“ä½œçš„é¡ºç•…ã€å¹³æ»‘ã€‚é€šè¿‡æµ‹è¯•å‘ç°ï¼Œç»è¿‡ä¼˜åŒ–åçš„è®¸å¤šé¡µé¢æ€§èƒ½ä¸ HTTP æŒå¹³ç”šè‡³è¿˜æœ‰å°å¹…æå‡ï¼Œå› æ­¤ HTTPS ç»è¿‡ä¼˜åŒ–ä¹‹åå…¶å®å¹¶ä¸æ…¢ã€‚\n\né™¤æ­¤ä¹‹å¤–ï¼Œ**æƒ³è¦èŠ‚çº¦è´­ä¹°è¯ä¹¦çš„å¼€é”€ä¹Ÿæ˜¯åŸå› ä¹‹ä¸€**ã€‚è¦è¿›è¡Œ HTTPS é€šä¿¡ï¼Œè¯ä¹¦æ˜¯å¿…ä¸å¯å°‘çš„ã€‚è€Œä½¿ç”¨çš„è¯ä¹¦å¿…é¡»å‘è®¤è¯æœºæ„ï¼ˆCAï¼‰è´­ä¹°ã€‚\n\næœ€åæ˜¯å®‰å…¨æ„è¯†ã€‚ç›¸æ¯”å›½å†…ï¼Œå›½å¤–äº’è”ç½‘è¡Œä¸šçš„å®‰å…¨æ„è¯†å’ŒæŠ€æœ¯åº”ç”¨ç›¸å¯¹æˆç†Ÿï¼ŒHTTPS éƒ¨ç½²è¶‹åŠ¿æ˜¯ç”±ç¤¾ä¼šã€ä¼ä¸šã€æ”¿åºœå…±åŒå»æ¨åŠ¨çš„ã€‚\n\n## è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„\n\n### ä»€ä¹ˆæ˜¯ç½‘ç»œç¼–ç¨‹\n\nç½‘ç»œç¼–ç¨‹çš„æœ¬è´¨æ˜¯å¤šå°è®¡ç®—æœºä¹‹é—´çš„æ•°æ®äº¤æ¢ã€‚ç°åœ¨çš„ç½‘ç»œç¼–ç¨‹åŸºæœ¬ä¸Šéƒ½æ˜¯åŸºäºè¯·æ±‚/å“åº”æ–¹å¼çš„ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªè®¾å¤‡å‘é€è¯·æ±‚æ•°æ®ç»™å¦å¤–ä¸€ä¸ªï¼Œç„¶åæ¥æ”¶å¦ä¸€ä¸ªè®¾å¤‡çš„åé¦ˆã€‚åœ¨ç½‘ç»œç¼–ç¨‹ä¸­ï¼Œå‘èµ·è¿æ¥ç¨‹åºï¼Œä¹Ÿå°±æ˜¯å‘é€ç¬¬ä¸€æ¬¡è¯·æ±‚çš„ç¨‹åºï¼Œè¢«ç§°ä½œå®¢æˆ·ç«¯(Client)ï¼Œç­‰å¾…å…¶ä»–ç¨‹åºè¿æ¥çš„ç¨‹åºè¢«ç§°ä½œæœåŠ¡å™¨(Server)ã€‚å®¢æˆ·ç«¯ç¨‹åºå¯ä»¥åœ¨éœ€è¦çš„æ—¶å€™å¯åŠ¨ï¼Œè€ŒæœåŠ¡å™¨ä¸ºäº†èƒ½å¤Ÿæ—¶åˆ»å“åº”è¿æ¥ï¼Œåˆ™éœ€è¦ä¸€ç›´å¯åŠ¨ã€‚\n\n### ç½‘ç»œç¼–ç¨‹ä¸­ä¸¤ä¸ªä¸»è¦çš„é—®é¢˜\n\n**1ã€**ä¸€ä¸ªæ˜¯å¦‚ä½•å‡†ç¡®çš„å®šä½ç½‘ç»œä¸Šä¸€å°æˆ–å¤šå°ä¸»æœºï¼Œ\n\n**2ã€**å¦ä¸€ä¸ªå°±æ˜¯æ‰¾åˆ°ä¸»æœºåå¦‚ä½•å¯é é«˜æ•ˆçš„è¿›è¡Œæ•°æ®ä¼ è¾“ã€‚\n\n- åœ¨ TCP/IP åè®®ä¸­ IP å±‚ç½‘é™…å±‚ä¸»è¦è´Ÿè´£ç½‘ç»œä¸»æœºçš„å®šä½ï¼Œæ•°æ®ä¼ è¾“çš„è·¯ç”±ï¼Œç”± IP åœ°å€å¯ä»¥å”¯ä¸€åœ°ç¡®å®š Internet ä¸Šçš„ä¸€å°ä¸»æœºã€‚\n- è€Œ TCP å±‚ä¼ è¾“å±‚åˆ™æä¾›é¢å‘åº”ç”¨çš„å¯é ï¼ˆTCPï¼‰çš„æˆ–éå¯é ï¼ˆUDPï¼‰çš„æ•°æ®ä¼ è¾“æœºåˆ¶ï¼Œè¿™æ˜¯ç½‘ç»œç¼–ç¨‹çš„ä¸»è¦å¯¹è±¡ï¼Œä¸€èˆ¬ä¸éœ€è¦å…³å¿ƒ IP å±‚æ˜¯å¦‚ä½•å¤„ç†æ•°æ®çš„ã€‚\n\n### ç½‘ç»œåè®®æ˜¯ä»€ä¹ˆ\n\nåœ¨è®¡ç®—æœºç½‘ç»œè¦åšåˆ°äº•äº•æœ‰æ¡çš„äº¤æ¢æ•°æ®ï¼Œå°±å¿…é¡»éµå®ˆä¸€äº›äº‹å…ˆçº¦å®šå¥½çš„è§„åˆ™ï¼Œæ¯”å¦‚äº¤æ¢æ•°æ®çš„æ ¼å¼ã€æ˜¯å¦éœ€è¦å‘é€ä¸€ä¸ªåº”ç­”ä¿¡æ¯ã€‚è¿™äº›è§„åˆ™è¢«ç§°ä¸ºç½‘ç»œåè®®ã€‚\n\n### ä¸ºä»€ä¹ˆè¦å¯¹ç½‘ç»œåè®®åˆ†å±‚\n\n**1ã€**ç®€åŒ–é—®é¢˜éš¾åº¦å’Œå¤æ‚åº¦ã€‚ç”±äºå„å±‚ä¹‹é—´ç‹¬ç«‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†å‰²å¤§é—®é¢˜ä¸ºå°é—®é¢˜ã€‚\n\n**2ã€**çµæ´»æ€§å¥½ã€‚å½“å…¶ä¸­ä¸€å±‚çš„æŠ€æœ¯å˜åŒ–æ—¶ï¼Œåªè¦å±‚é—´æ¥å£å…³ç³»ä¿æŒä¸å˜ï¼Œå…¶ä»–å±‚ä¸å—å½±å“ã€‚\n\n**3ã€**æ˜“äºå®ç°å’Œç»´æŠ¤ã€‚\n\n**4ã€**ä¿ƒè¿›æ ‡å‡†åŒ–å·¥ä½œã€‚åˆ†å¼€åï¼Œæ¯å±‚åŠŸèƒ½å¯ä»¥ç›¸å¯¹ç®€å•åœ°è¢«æè¿°\n\n### ä½“ç³»ç»“æ„\n\n**TCP/IPå‚è€ƒæ¨¡å‹**\n\nOSI ä¸ƒå±‚åè®®ï¼šåº”ç”¨ï¼ˆHTTPï¼‰ã€è¡¨ç¤ºï¼ˆSSL/TLSï¼‰ã€ä¼šè¯ï¼ˆRPCï¼‰ã€ä¼ è¾“ï¼ˆTCPï¼‰ã€ç½‘ç»œï¼ˆIPï¼‰ã€é“¾è·¯ï¼ˆARPï¼‰ã€ç‰©ç†\n\nTCP/IP å››å±‚åè®®ï¼ˆæ•°æ®é“¾è·¯å±‚ã€ç½‘ç»œå±‚ã€ä¼ è¾“å±‚ã€åº”ç”¨å±‚ï¼‰\n\n**1ã€**åº”ç”¨å±‚ **ä¸ºç”¨æˆ·æä¾›å„ç§ç½‘ç»œæœåŠ¡**ã€‚æˆ‘ä»¬å¸¸è§åº”ç”¨å±‚çš„ç½‘ç»œæœåŠ¡åè®®æœ‰ï¼šHTTPï¼ŒHTTPSï¼ŒFTPï¼ŒTELNET ç­‰ã€‚ï¼ˆHTTP åè®®å…¨ç§° Hyper Text Transfer Protocol è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œåœ¨æµè§ˆå™¨ä¸æœåŠ¡å™¨é—´ä¼ é€æ–‡æ¡£ï¼‰\n\n**2ã€**ä¼ è¾“å±‚ **å»ºç«‹äº†ä¸»æœºç«¯åˆ°ç«¯çš„è¿æ¥**ï¼Œä¼ è¾“å±‚çš„ä½œç”¨æ˜¯**ä¸ºä¸Šå±‚åè®®æä¾›ç«¯åˆ°ç«¯çš„å¯é å’Œé€æ˜çš„æ•°æ®ä¼ è¾“æœåŠ¡**ï¼ŒåŒ…æ‹¬å¤„ç†å·®é”™æ§åˆ¶å’Œæµé‡æ§åˆ¶ç­‰é—®é¢˜ã€‚ï¼ˆTCPã€UDPï¼‰\n\n**3ã€**ç½‘ç»œå±‚ **é€šè¿‡IPå¯»å€æ¥å»ºç«‹ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„è¿æ¥**ï¼Œä¸ºæºç«¯çš„è¿è¾“å±‚é€æ¥çš„åˆ†ç»„ï¼Œé€‰æ‹©åˆé€‚çš„è·¯ç”±å’Œäº¤æ¢èŠ‚ç‚¹ï¼Œæ­£ç¡®æ— è¯¯åœ°æŒ‰ç…§åœ°å€ä¼ é€ç»™ç›®çš„ç«¯çš„è¿è¾“å±‚ã€‚ï¼ˆIPï¼‰\n\n**4ã€**æ•°æ®é“¾è·¯å±‚ **é€šè¿‡ä¸€äº›è§„åˆ™æ¥æ§åˆ¶è¿™äº›æ•°æ®çš„ä¼ è¾“**ï¼Œä»¥ä¿è¯è¢«ä¼ è¾“æ•°æ®çš„æ­£ç¡®æ€§ã€‚å®ç°è¿™äº›è§„ç¨‹æˆ–åè®®çš„ç¡¬ä»¶å’Œè½¯ä»¶åŠ åˆ°ç‰©ç†çº¿è·¯ï¼Œè¿™æ ·å°±æ„æˆäº†æ•°æ®é“¾è·¯ã€‚\n\n### ä»€ä¹ˆæ˜¯TCPå’ŒUDP\n\n|          | TCP                              | UDP                                    |\n| -------- | -------------------------------- | -------------------------------------- |\n| é¢å‘è¿æ¥ | é¢å‘è¿æ¥                         | æ— è¿æ¥                                 |\n| å¯é æ€§   | å¯é ä¼ è¾“ï¼Œä½¿ç”¨æ‹¥å¡æ§åˆ¶å’Œæµé‡æ§åˆ¶ | å¯é ä¼ è¾“                               |\n| è¿æ¥ä¸ªæ•° | åªèƒ½ä¸€å¯¹ä¸€é€šä¿¡                   | æ”¯æŒä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šã€å¤šå¯¹ä¸€ã€å¤šå¯¹å¤šé€šä¿¡ |\n| ä½¿ç”¨åœºæ™¯ | è¦æ±‚å¯é ä¼ è¾“çš„åº”ç”¨ï¼ˆæ–‡ä»¶ä¼ è¾“ï¼‰   | å®æ—¶åº”ç”¨ï¼ˆè§†é¢‘ä¼šè®®ã€ç½‘ç»œç›´æ’­ï¼‰         |\n\n### æµè§ˆå™¨ä¸­è¾“å…¥ï¼šç½‘å€åéƒ½å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿè¯·è¯¦ç»†é˜è¿°ã€‚\n\n**1ã€**åŸŸåè§£æï¼ŒåŸŸåâ†’IP åœ°å€ï¼Œè§£æè¿‡ç¨‹ä¾æ¬¡ç»è¿‡äº†æµè§ˆå™¨æœ¬åœ°ç¼“å­˜ã€ç³»ç»Ÿç¼“å­˜ã€hosts æ–‡ä»¶ã€è·¯ç”±å™¨ç¼“å­˜ã€ é€’å½’æœç´¢æ ¹åŸŸåæœåŠ¡å™¨ã€‚\n\n**2ã€**å»ºç«‹ TCP/IP è¿æ¥ï¼ˆä¸‰æ¬¡æ¡æ‰‹å…·ä½“è¿‡ç¨‹ï¼‰\n\n**3ã€**ç”±æµè§ˆå™¨å‘é€ä¸€ä¸ª HTTP è¯·æ±‚\n\n**4ã€**ç»è¿‡è·¯ç”±å™¨çš„è½¬å‘ï¼Œé€šè¿‡æœåŠ¡å™¨çš„é˜²ç«å¢™ï¼Œè¯¥ HTTP è¯·æ±‚åˆ°è¾¾äº†æœåŠ¡å™¨\n\n**5ã€**æœåŠ¡å™¨å¤„ç†è¯¥ HTTP è¯·æ±‚ï¼Œè¿”å›ä¸€ä¸ª HTML æ–‡ä»¶\n\n**6ã€**æµè§ˆå™¨è§£æè¯¥ HTML æ–‡ä»¶ï¼Œå¹¶ä¸”æ˜¾ç¤ºåœ¨æµè§ˆå™¨ç«¯\n\n![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640.webp)\n\n### TCP åè®®å¦‚ä½•æ¥ä¿è¯ä¼ è¾“çš„å¯é æ€§\n\n**å¯¹äºå¯é æ€§ï¼ŒTCPé€šè¿‡ä»¥ä¸‹æ–¹å¼è¿›è¡Œä¿è¯ï¼š**\n\n> æ¥æ”¶æ–¹å¯¹æ•°æ®åŒ…è¿›è¡Œæ£€æŸ¥ï¼Œæ˜¯å¦**å¤±åº**ï¼Œå¤±åºçš„è¯è¦é‡æ’åºï¼Œæ˜¯å¦**é‡å¤**ï¼Œé‡å¤çš„è¯å°†é‡å¤çš„æ•°æ®ä¸¢å¼ƒï¼Œæ˜¯å¦**å‡ºé”™**ï¼Œå‡ºé”™çš„è¯å°†è¯¥æŠ¥æ–‡æ®µä¸¢å¼ƒã€‚å¦åˆ™çš„è¯ï¼Œæ¥æ”¶æ–¹ä¼šç»™å‘é€æ–¹ä¸€ä¸ªå‘é€ä¸€ä¸ªç¡®è®¤ã€‚å‘é€æ–¹å‘é€ä¹‹åå¦‚æœæ²¡æœ‰æ”¶åˆ°è¿™ä¸ªç¡®è®¤åœ¨ä¸€å®šæ—¶é—´åä¼šé‡å‘è¿™ä¸ªæŠ¥æ–‡æ®µã€‚\n\n- **æ•°æ®åŒ…æ ¡éªŒ**ï¼šç›®çš„æ˜¯æ£€æµ‹æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­çš„ä»»ä½•å˜åŒ–ï¼Œè‹¥æ ¡éªŒå‡ºåŒ…æœ‰é”™ï¼Œåˆ™ä¸¢å¼ƒæŠ¥æ–‡æ®µå¹¶ä¸”ä¸ç»™å‡ºå“åº”ï¼Œè¿™æ—¶ TCP å‘é€æ•°æ®ç«¯è¶…æ—¶åä¼šé‡å‘æ•°æ®ï¼›\n- **å¯¹å¤±åºæ•°æ®åŒ…é‡æ’åº**ï¼šæ—¢ç„¶ TCP æŠ¥æ–‡æ®µä½œä¸º IP æ•°æ®æŠ¥æ¥ä¼ è¾“ï¼Œè€Œ IP æ•°æ®æŠ¥çš„åˆ°è¾¾å¯èƒ½ä¼šå¤±åºï¼Œå› æ­¤ TCP æŠ¥æ–‡æ®µçš„åˆ°è¾¾ä¹Ÿå¯èƒ½ä¼šå¤±åºã€‚TCP å°†å¯¹å¤±åºæ•°æ®è¿›è¡Œé‡æ–°æ’åºï¼Œç„¶åæ‰äº¤ç»™åº”ç”¨å±‚ï¼›\n- **ä¸¢å¼ƒé‡å¤æ•°æ®**ï¼šå¯¹äºé‡å¤æ•°æ®ï¼Œèƒ½å¤Ÿä¸¢å¼ƒé‡å¤æ•°æ®ï¼›\n- **åº”ç­”æœºåˆ¶**ï¼šå½“ TCP æ”¶åˆ°å‘è‡ª TCP è¿æ¥å¦ä¸€ç«¯çš„æ•°æ®ï¼Œå®ƒå°†å‘é€ä¸€ä¸ªç¡®è®¤ã€‚è¿™ä¸ªç¡®è®¤ä¸æ˜¯ç«‹å³å‘é€ï¼Œé€šå¸¸å°†æ¨è¿Ÿå‡ åˆ†ä¹‹ä¸€ç§’ï¼›\n- **è¶…æ—¶é‡å‘**ï¼šå½“ TCP å‘å‡ºä¸€ä¸ªæ®µåï¼Œå®ƒå¯åŠ¨ä¸€ä¸ªå®šæ—¶å™¨ï¼Œç­‰å¾…ç›®çš„ç«¯ç¡®è®¤æ”¶åˆ°è¿™ä¸ªæŠ¥æ–‡æ®µã€‚å¦‚æœä¸èƒ½åŠæ—¶æ”¶åˆ°ä¸€ä¸ªç¡®è®¤ï¼Œå°†é‡å‘è¿™ä¸ªæŠ¥æ–‡æ®µï¼›\n- **æµé‡æ§åˆ¶**ï¼šTCP è¿æ¥çš„æ¯ä¸€æ–¹éƒ½æœ‰å›ºå®šå¤§å°çš„ç¼“å†²ç©ºé—´ã€‚TCP çš„æ¥æ”¶ç«¯åªå…è®¸å¦ä¸€ç«¯å‘é€æ¥æ”¶ç«¯ç¼“å†²åŒºæ‰€èƒ½æ¥çº³çš„æ•°æ®ï¼Œè¿™å¯ä»¥é˜²æ­¢è¾ƒå¿«ä¸»æœºè‡´ä½¿è¾ƒæ…¢ä¸»æœºçš„ç¼“å†²åŒºæº¢å‡ºï¼Œè¿™å°±æ˜¯æµé‡æ§åˆ¶ã€‚\n\tTCP ä½¿ç”¨çš„æµé‡æ§åˆ¶åè®®æ˜¯**å¯å˜å¤§å°çš„æ»‘åŠ¨çª—å£åè®®**ã€‚\n\n### TCP çš„æ‹¥å¡é¿å…æœºåˆ¶\n\nhttps://www.cnblogs.com/hongdada/p/11206679.html\n\næ‹¥å¡ï¼šå¯¹èµ„æºçš„éœ€æ±‚è¶…è¿‡äº†å¯ç”¨çš„èµ„æºã€‚è‹¥ç½‘ç»œä¸­è®¸å¤šèµ„æºåŒæ—¶ä¾›åº”ä¸è¶³ï¼Œç½‘ç»œçš„æ€§èƒ½å°±è¦æ˜æ˜¾å˜åï¼Œæ•´ä¸ªç½‘ç»œçš„ååé‡éšç€è´Ÿè·çš„å¢å¤§è€Œä¸‹é™ã€‚\n\næ‹¥å¡æ§åˆ¶ï¼šé˜²æ­¢è¿‡å¤šçš„æ•°æ®æ³¨å…¥åˆ°ç½‘ç»œä¸­ï¼Œä½¿å¾—ç½‘ç»œä¸­çš„è·¯ç”±å™¨æˆ–é“¾è·¯ä¸è‡´è¿‡è½½ã€‚\n\næ‹¥å¡æ§åˆ¶çš„æ–¹æ³•ï¼š\n\n**1ã€ æ…¢å¼€å§‹ + æ‹¥å¡é¿å…ï¼š**\n\n![img](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes443934-20190718131944933-703202720.png)\n\n**æ…¢å¼€å§‹**ï¼šæ‹¥å¡çª—å£ä» 1ã€2ã€4 ä»¥æŒ‡æ•°è§„å¾‹å¢é•¿ï¼›\n\n**æ‹¥å¡é¿å…**ï¼šåˆ°è¾¾æ…¢å¼€å§‹é˜ˆå€¼åï¼Œå¼€å§‹æ‹¥å¡é¿å…â€œåŠ æ³•å¢å¤§â€\n\n**2ã€å¿«é‡ä¼  + å¿«æ¢å¤ï¼š**\n![img](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes443934-20190718132020300-1269239957.png)\n\n**å¿«é‡ä¼ **ï¼š **å¿«é‡ä¼ è¦æ±‚æ¥æ”¶æ–¹åœ¨æ”¶åˆ°ä¸€ä¸ªå¤±åºçš„æŠ¥æ–‡æ®µåå°±ç«‹å³å‘å‡º é‡å¤ç¡®è®¤ **ï¼ˆä¸ºçš„æ˜¯ä½¿å‘é€æ–¹åŠæ—©çŸ¥é“æœ‰æŠ¥æ–‡æ®µæ²¡æœ‰åˆ°è¾¾å¯¹æ–¹ï¼‰è€Œä¸è¦ç­‰åˆ°è‡ªå·±å‘é€æ•°æ®æ—¶æå¸¦ç¡®è®¤ã€‚å¿«é‡ä¼ ç®—æ³•è§„å®šï¼Œ **å‘é€æ–¹åªè¦ä¸€è¿æ”¶åˆ°ä¸‰ä¸ªé‡å¤ç¡®è®¤å°±åº”å½“ç«‹å³é‡ä¼ å¯¹æ–¹å°šæœªæ”¶åˆ°çš„æŠ¥æ–‡æ®µ**ï¼Œè€Œä¸å¿…ç»§ç»­ç­‰å¾…è®¾ç½®çš„é‡ä¼ è®¡æ—¶å™¨æ—¶é—´åˆ°æœŸã€‚\n\n**å¿«æ¢å¤**ï¼šå¿«é‡ä¼ é…åˆä½¿ç”¨çš„è¿˜æœ‰å¿«æ¢å¤ç®—æ³•ï¼Œå½“å‘é€æ–¹è¿ç»­æ”¶åˆ°ä¸‰ä¸ªé‡å¤ç¡®è®¤æ—¶ï¼Œå°±æ‰§è¡Œ**â€œä¹˜æ³•å‡å°â€ç®—æ³•ï¼ŒæŠŠ ssthresh é—¨é™å‡åŠ**ï¼Œä½†æ˜¯æ¥ä¸‹å»å¹¶ä¸æ‰§è¡Œæ…¢å¼€å§‹ç®—æ³•ï¼šå› ä¸ºå¦‚æœç½‘ç»œå‡ºç°æ‹¥å¡çš„è¯å°±ä¸ä¼šæ”¶åˆ°å¥½å‡ ä¸ªé‡å¤çš„ç¡®è®¤ï¼Œæ‰€ä»¥å‘é€æ–¹ç°åœ¨è®¤ä¸ºç½‘ç»œå¯èƒ½æ²¡æœ‰å‡ºç°æ‹¥å¡ã€‚æ‰€ä»¥æ­¤æ—¶ä¸æ‰§è¡Œæ…¢å¼€å§‹ç®—æ³•ï¼Œè€Œæ˜¯å°†æ‹¥å¡çª—å£è®¾ç½®ä¸ºæ…¢å¼€å§‹é˜ˆå€¼çš„å¤§å°ï¼Œ**ç„¶åæ‰§è¡Œæ‹¥å¡é¿å…ç®—æ³•è®©æ‹¥å¡çª—å£çº¿æ€§åŠ 1**ã€‚\n\n### ä»€ä¹ˆæ˜¯Httpåè®®ï¼Ÿ\n\n- Http åè®®å±äºåº”ç”¨å±‚ï¼Œæ˜¯åœ¨æµè§ˆå™¨ä¸æœåŠ¡å™¨é—´ä¼ é€æ–‡æ¡£çš„è§„èŒƒï¼Œç®€ç§°ä¸ºâ€œè¶…æ–‡æœ¬ä¼ è¾“åè®®â€\n\n![](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes20210326001352.png)\n\n### è¯´è¯´HTTPå¸¸ç”¨çš„çŠ¶æ€ç åŠå…¶å«ä¹‰ï¼Ÿ\n\n![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650518889206.webp)\n\nä¸ç®¡æ˜¯ä¸æ˜¯é¢è¯•éœ€è¦ï¼Œæˆ‘ä»¬éƒ½è¦çŸ¥é“ï¼Œæ—¥å¸¸å¼€å‘ä¸­çš„è¿™å‡ ä¸ªçŠ¶æ€ç çš„å«ä¹‰ï¼š\n\n![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650518894201.webp)\n\n\n\n### Httpå’ŒHttpsçš„åŒºåˆ«ï¼Ÿ\n\nHttp åè®®è¿è¡Œåœ¨ TCP ä¹‹ä¸Šï¼Œæ˜æ–‡ä¼ è¾“ï¼Œå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ç«¯éƒ½æ— æ³•éªŒè¯å¯¹æ–¹çš„èº«ä»½ï¼›Https æ˜¯èº«æŠ« SSL(Secure Socket Layer)å¤–å£³çš„ Httpï¼Œè¿è¡Œäº SSL ä¸Šï¼ŒSSL è¿è¡Œäº TCP ä¹‹ä¸Šï¼Œæ˜¯æ·»åŠ äº†åŠ å¯†å’Œè®¤è¯æœºåˆ¶çš„ HTTPã€‚äºŒè€…ä¹‹é—´å­˜åœ¨å¦‚ä¸‹ä¸åŒï¼š\n\n- ç«¯å£ä¸åŒï¼šHttp ä¸ Https ä½¿ç”¨ä¸åŒçš„è¿æ¥æ–¹å¼ï¼Œç”¨çš„ç«¯å£ä¹Ÿä¸ä¸€æ ·ï¼Œå‰è€…æ˜¯ 80ï¼Œåè€…æ˜¯ 443ï¼›\n- èµ„æºæ¶ˆè€—ï¼šå’Œ HTTP é€šä¿¡ç›¸æ¯”ï¼ŒHttps é€šä¿¡ä¼šç”±äºåŠ å¯†è§£å¯†å¤„ç†æ¶ˆè€—æ›´å¤šçš„ CPU å’Œå†…å­˜èµ„æºï¼›\n- å¼€é”€ï¼šHttps é€šä¿¡éœ€è¦è¯ä¹¦ï¼Œè€Œè¯ä¹¦ä¸€èˆ¬éœ€è¦å‘è®¤è¯æœºæ„è´­ä¹°ï¼›\n\nHttps çš„åŠ å¯†æœºåˆ¶æ˜¯ä¸€ç§å…±äº«å¯†é’¥åŠ å¯†å’Œå…¬å¼€å¯†é’¥åŠ å¯†å¹¶ç”¨çš„æ··åˆåŠ å¯†æœºåˆ¶ã€‚\n\n### ä»€ä¹ˆæ˜¯httpçš„è¯·æ±‚ä½“ï¼Ÿ\n\n**1ã€**HTTP è¯·æ±‚ä½“æ˜¯æˆ‘ä»¬è¯·æ±‚æ•°æ®æ—¶å…ˆå‘é€ç»™æœåŠ¡å™¨çš„æ•°æ®ï¼Œæ¯•ç«Ÿæˆ‘å‘æœåŠ¡å™¨æ‹¿æ•°æ®ï¼Œå…ˆè¦è¡¨æ˜æˆ‘è¦ä»€ä¹ˆå§\n\n**2ã€**HTTP è¯·æ±‚ä½“ç”±ï¼š**è¯·æ±‚è¡Œã€è¯·æ±‚å¤´ã€è¯·æ±‚ä½“** ç»„æˆçš„\n\n> è¯·æ±‚è¡Œï¼šè¯·æ±‚æ–¹æ³•ï¼ˆPOSTï¼‰ã€URLï¼ˆcharacter/use.htmlï¼‰ å’Œ HTTP åè®®ç‰ˆæœ¬ï¼ˆHTTP/1.1ï¼‰\n>\n> è¯·æ±‚å¤´ï¼š\n>\n> * User-Agentï¼šå‘é€è¯·æ±‚çš„æµè§ˆå™¨ç±»å‹;\n> * Acceptï¼šå®¢æˆ·ç«¯å¯è¯†åˆ«çš„å“åº”å†…å®¹ç±»å‹åˆ—è¡¨;æ˜Ÿå· â€œ * â€ ç”¨äºæŒ‰èŒƒå›´å°†ç±»å‹åˆ†ç»„ï¼Œç”¨ â€œ */* â€ æŒ‡ç¤ºå¯æ¥å—å…¨éƒ¨ç±»å‹ï¼Œç”¨â€œ type/* â€æŒ‡ç¤ºå¯æ¥å— type ç±»å‹çš„æ‰€æœ‰å­ç±»å‹;\n> * Accept-Languageï¼šå®¢æˆ·ç«¯å¯æ¥å—çš„è‡ªç„¶è¯­è¨€;\n> * Accept-Encodingï¼šå®¢æˆ·ç«¯å¯æ¥å—çš„ç¼–ç æ ¼å¼;\n> * Accept-Charsetï¼šå¯æ¥å—çš„åº”ç­”çš„å­—ç¬¦é›†;\n> * Hostï¼šè¯·æ±‚çš„ä¸»æœºåï¼Œå…è®¸å¤šä¸ªåŸŸååŒå¤„ä¸€ä¸ªIP åœ°å€ï¼Œå³è™šæ‹Ÿä¸»æœº;\n> * Connectionï¼šè¿æ¥æ–¹å¼(close æˆ– keepalive);\n> * Cookieï¼šå­˜å‚¨äºå®¢æˆ·ç«¯æ‰©å±•å­—æ®µï¼Œå‘åŒä¸€åŸŸåçš„æœåŠ¡ç«¯å‘é€å±äºè¯¥åŸŸçš„cookie;\n\n**3ã€**æ³¨æ„ï¼šGET è¯·æ±‚æ˜¯æ²¡æœ‰è¯·æ±‚ä½“çš„\n\n### HTTPçš„å“åº”æŠ¥æ–‡æœ‰å“ªäº›ï¼Ÿ\n\n**1ã€**http çš„å“åº”æŠ¥æ˜¯æœåŠ¡å™¨è¿”å›ç»™æˆ‘ä»¬çš„æ•°æ®ï¼Œå¿…é¡»å…ˆæœ‰è¯·æ±‚ä½“å†æœ‰å“åº”æŠ¥æ–‡\n\n**2ã€**å“åº”æŠ¥æ–‡åŒ…å«ä¸‰éƒ¨åˆ† **çŠ¶æ€è¡Œã€å“åº”å¤´ã€å“åº”ä½“**\n\n### Httpä¸­å¸¸è§çš„headerå­—æ®µæœ‰å“ªäº›ï¼Ÿ\n\ncookieï¼Œè¯·æ±‚æ—¶ä¼ é€’ç»™æœåŠ¡ç«¯çš„ cookie ä¿¡æ¯ \nset-cookieï¼Œå“åº”æŠ¥æ–‡é¦–éƒ¨è®¾ç½®è¦ä¼ é€’ç»™å®¢æˆ·ç«¯çš„ cookie ä¿¡æ¯ \nallowï¼Œæ”¯æŒä»€ä¹ˆ HTTP æ–¹æ³• \nlast-modifiedï¼Œèµ„æºçš„æœ€åä¿®æ”¹æ—¶é—´ \nexpires,è®¾ç½®èµ„æºç¼“å­˜çš„å¤±è´¥æ—¥æœŸ \ncontent-languageï¼Œå®ä½“çš„èµ„æºè¯­è¨€ \ncontent-encodingï¼Œå®ä½“çš„ç¼–ç æ ¼å¼ \ncontent-lengthï¼Œå®ä½“ä¸»ä½“éƒ¨åˆ†çš„å¤§å°å•ä½æ˜¯å­—èŠ‚ \ncontent-rangeï¼Œè¿”å›çš„å®ä½“çš„å“ªäº›èŒƒå›´ \ncontent-typeï¼Œå“ªäº›ç±»å‹ \naccept-rangesï¼Œå¤„ç†çš„èŒƒå›´è¯·æ±‚ \nageï¼Œå‘Šè¯‰å®¢æˆ·ç«¯æœåŠ¡å™¨åœ¨å¤šä¹…å‰åˆ›å»ºäº†å“åº” \nvaryï¼Œä»£ç†æœåŠ¡å™¨çš„ç¼“å­˜ä¿¡æ¯ \nlocationï¼Œç”¨äºæŒ‡å®šé‡å®šå‘åçš„ URI \nIf-Matchï¼Œå€¼æ˜¯èµ„æºçš„å”¯ä¸€æ ‡è¯† \nUser-Agentï¼Œå°†åˆ›å»ºè¯·æ±‚çš„æµè§ˆå™¨å’Œç”¨æˆ·ä»£ç†åç§°ç­‰ä¿¡æ¯ä¼ é€’ç»™æœåŠ¡å™¨ \nTransfer-Encodingï¼Œä¼ è¾“æŠ¥æ–‡çš„ä¸»ä½“ç¼–ç æ–¹å¼ \nconnectionï¼Œç®¡ç†æŒä¹…è¿æ¥ keep-alive , close Cache-Controlï¼Œæ§åˆ¶æµè§ˆå™¨çš„å¼ºç¼“å­˜\n\n### HTTPSå·¥ä½œåŸç†\n\nï¼ˆAESï¼šéå¯¹ç§°åŠ å¯†ï¼›RSAï¼šå¯¹ç§°åŠ å¯†ï¼‰\n\n**1ã€**é¦–å…ˆ HTTP è¯·æ±‚æœåŠ¡ç«¯ç”Ÿæˆè¯ä¹¦ï¼Œå®¢æˆ·ç«¯å¯¹è¯ä¹¦çš„æœ‰æ•ˆæœŸã€åˆæ³•æ€§ã€åŸŸåæ˜¯å¦ä¸è¯·æ±‚çš„åŸŸåä¸€è‡´ã€è¯ä¹¦çš„å…¬é’¥ï¼ˆRSA åŠ å¯†ï¼‰ç­‰è¿›è¡Œæ ¡éªŒï¼›\n\n**2ã€**å®¢æˆ·ç«¯å¦‚æœæ ¡éªŒé€šè¿‡åï¼Œå°±æ ¹æ®è¯ä¹¦çš„å…¬é’¥çš„æœ‰æ•ˆï¼Œ ç”Ÿæˆéšæœºæ•°ï¼Œéšæœºæ•°ä½¿ç”¨å…¬é’¥è¿›è¡ŒåŠ å¯†ï¼ˆRSA åŠ å¯†ï¼‰ï¼›\n\n**3ã€**æ¶ˆæ¯ä½“äº§ç”Ÿä¹‹åï¼Œå¯¹å®ƒçš„æ‘˜è¦è¿›è¡Œ MD5ï¼ˆæˆ–è€… SHA1ï¼‰ç®—æ³•åŠ å¯†ï¼Œæ­¤æ—¶å°±å¾—åˆ°äº† RSA ç­¾åï¼›\n\n**4ã€**å‘é€ç»™æœåŠ¡ç«¯ï¼Œæ­¤æ—¶åªæœ‰æœåŠ¡ç«¯ï¼ˆRSA ç§é’¥ï¼‰èƒ½è§£å¯†ã€‚\n\n**5ã€**è§£å¯†å¾—åˆ°çš„éšæœºæ•°ï¼Œå†ç”¨ AES åŠ å¯†ï¼Œä½œä¸ºå¯†é’¥ï¼ˆæ­¤æ—¶çš„å¯†é’¥åªæœ‰å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çŸ¥é“ï¼‰ã€‚\n\n### â­ä¸ºä»€ä¹ˆ TCP é“¾æ¥éœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Œä¸¤æ¬¡ä¸å¯ä»¥ä¹ˆï¼Ÿ\n\nâ€œä¸‰æ¬¡æ¡æ‰‹â€ çš„ç›®çš„æ˜¯ä¸ºäº†é˜²æ­¢**å·²å¤±æ•ˆçš„é“¾æ¥è¯·æ±‚æŠ¥æ–‡çªç„¶åˆä¼ é€åˆ°äº†æœåŠ¡ç«¯**ï¼Œå› è€Œäº§ç”Ÿé”™è¯¯ã€‚\n\n- æ­£å¸¸çš„æƒ…å†µï¼šA å‘å‡ºè¿æ¥è¯·æ±‚ï¼Œä½†å› è¿æ¥è¯·æ±‚æŠ¥æ–‡ä¸¢å¤±è€Œæœªæ”¶åˆ°ç¡®è®¤ï¼Œäºæ˜¯ A å†é‡ä¼ ä¸€æ¬¡è¿æ¥è¯·æ±‚ã€‚åæ¥æ”¶åˆ°äº†ç¡®è®¤ï¼Œå»ºç«‹äº†è¿æ¥ã€‚æ•°æ®ä¼ è¾“å®Œæ¯•åï¼Œå°±é‡Šæ”¾äº†è¿æ¥ã€‚A å…±å‘é€äº†ä¸¤ä¸ªè¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªä¸¢å¤±ï¼Œç¬¬äºŒä¸ªåˆ°è¾¾äº† Bã€‚æ²¡æœ‰ â€œå·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µâ€ã€‚\n- å‡å®šå‡ºç°äº†ä¸€ç§å¼‚å¸¸æƒ…å†µï¼šå³ A å‘å‡ºçš„ç¬¬ä¸€ä¸ªè¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µå¹¶æ²¡æœ‰ä¸¢å¤±ï¼Œè€Œæ˜¯åœ¨æŸä¸ªç½‘ç»œç»“ç‚¹é•¿æ—¶é—´çš„æ»ç•™äº†ï¼Œä»¥è‡´å»¶è¯¯åˆ°è¿æ¥é‡Šæ”¾ä»¥åçš„æŸä¸ªæ—¶é—´æ‰åˆ°è¾¾ Bã€‚æœ¬æ¥è¿™æ˜¯ä¸€ä¸ªæ—©å·²å¤±æ•ˆçš„æŠ¥æ–‡æ®µã€‚ä½† B æ”¶åˆ°æ­¤å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µåï¼Œå°±è¯¯è®¤ä¸ºæ˜¯ A å†æ¬¡å‘å‡ºçš„ä¸€ä¸ªæ–°çš„è¿æ¥è¯·æ±‚ã€‚äºæ˜¯å°±å‘ A å‘å‡ºç¡®è®¤æŠ¥æ–‡æ®µï¼ŒåŒæ„å»ºç«‹è¿æ¥ã€‚\n\nå‡è®¾ä¸é‡‡ç”¨â€œä¸‰æ¬¡æ¡æ‰‹â€ï¼Œé‚£ä¹ˆåªè¦ B å‘å‡ºç¡®è®¤ï¼Œæ–°çš„è¿æ¥å°±å»ºç«‹äº†ã€‚ç”±äºç°åœ¨ A å¹¶æ²¡æœ‰å‘å‡ºå»ºç«‹è¿æ¥çš„è¯·æ±‚ï¼ˆå› ä¸ºé‚£ä¸ªæ˜¯å·²ç»å¤±æ•ˆçš„è¯·æ±‚ï¼‰ï¼Œå› æ­¤ä¸ä¼šç†ç¬ B çš„ç¡®è®¤ï¼Œä¹Ÿä¸ä¼šå‘ B å‘é€æ•°æ®ã€‚ä½† B å´ä»¥ä¸ºæ–°çš„è¿è¾“è¿æ¥å·²ç»å»ºç«‹ï¼Œå¹¶ä¸€ç›´ç­‰å¾… A å‘æ¥æ•°æ®ã€‚è¿™æ ·ï¼ŒB çš„å¾ˆå¤šèµ„æºå°±ç™½ç™½æµªè´¹æ‰äº†ã€‚é‡‡ç”¨â€œä¸‰æ¬¡æ¡æ‰‹â€çš„åŠæ³•å¯ä»¥é˜²æ­¢ä¸Šè¿°ç°è±¡å‘ç”Ÿã€‚\n\n### â­ä¸ºä»€ä¹ˆè¦å››æ¬¡æŒ¥æ‰‹ï¼Ÿ\n\nTCP æ˜¯å…¨åŒå·¥æ¨¡å¼ï¼Œè¿™å°±æ„å‘³ç€ï¼Œ\nå½“ A å‘ B å‘å‡º FIN æŠ¥æ–‡æ®µæ—¶ï¼Œåªæ˜¯è¡¨ç¤º A å·²ç»æ²¡æœ‰æ•°æ®è¦å‘é€äº†ï¼Œè€Œæ­¤æ—¶ A è¿˜æ˜¯èƒ½å¤Ÿæ¥å—åˆ°æ¥è‡ª B å‘å‡ºçš„æ•°æ®ï¼›å½“ B å‘ A å‘å‡º ACK æŠ¥æ–‡æ®µä¹Ÿåªæ˜¯å‘Šè¯‰ A ï¼Œå®ƒè‡ªå·±çŸ¥é“ A æ²¡æœ‰æ•°æ®è¦å‘äº†ï¼Œä½† B è¿˜æ˜¯èƒ½å¤Ÿå‘ A å‘é€æ•°æ®ã€‚\n\næ‰€ä»¥æƒ³è¦æ„‰å¿«çš„ç»“æŸè¿™æ¬¡å¯¹è¯å°±éœ€è¦å››æ¬¡æŒ¥æ‰‹ã€‚\n\n### â­ä¸ºä»€ä¹ˆå®¢æˆ·ç«¯å‘å‡ºç¬¬å››æ¬¡æŒ¥æ‰‹çš„ç¡®è®¤æŠ¥æ–‡åè¦ç­‰2MSLçš„æ—¶é—´æ‰èƒ½é‡Šæ”¾TCPè¿æ¥ï¼Ÿ\n\nMSLï¼ˆMaximum Segment Lifetimeï¼‰**æŠ¥æ–‡æœ€å¤§å¯¿å‘½**ï¼ŒTCP å…è®¸ä¸åŒçš„å®ç°å¯ä»¥è®¾ç½®ä¸åŒçš„ MSL å€¼ã€‚\n\nç¬¬ä¸€ï¼Œä¿è¯å®¢æˆ·ç«¯å‘é€çš„æœ€åä¸€ä¸ª ACK æŠ¥æ–‡èƒ½å¤Ÿåˆ°è¾¾æœåŠ¡å™¨ï¼Œå› ä¸ºè¿™ä¸ª ACK æŠ¥æ–‡å¯èƒ½ä¸¢å¤±ï¼Œç«™åœ¨æœåŠ¡å™¨çš„è§’åº¦çœ‹æ¥ï¼Œæˆ‘å·²ç»å‘é€äº† FIN+ACK æŠ¥æ–‡è¯·æ±‚æ–­å¼€äº†ï¼Œå®¢æˆ·ç«¯è¿˜æ²¡æœ‰ç»™æˆ‘å›åº”ï¼Œåº”è¯¥æ˜¯æˆ‘å‘é€çš„è¯·æ±‚æ–­å¼€æŠ¥æ–‡å®ƒæ²¡æœ‰æ”¶åˆ°ï¼Œäºæ˜¯æœåŠ¡å™¨åˆä¼šé‡æ–°å‘é€ä¸€æ¬¡ï¼Œè€Œå®¢æˆ·ç«¯å°±èƒ½åœ¨è¿™ä¸ª 2MSL æ—¶é—´æ®µå†…æ”¶åˆ°è¿™ä¸ªé‡ä¼ çš„æŠ¥æ–‡ï¼Œæ¥ç€ç»™å‡ºå›åº”æŠ¥æ–‡ï¼Œå¹¶ä¸”ä¼šé‡å¯ 2MSL è®¡æ—¶å™¨ã€‚\n\nç¬¬äºŒï¼Œé˜²æ­¢ç±»ä¼¼ä¸â€œä¸‰æ¬¡æ¡æ‰‹â€ä¸­æåˆ°äº†çš„â€œå·²ç»å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µâ€å‡ºç°åœ¨æœ¬è¿æ¥ä¸­ã€‚å®¢æˆ·ç«¯å‘é€å®Œæœ€åä¸€ä¸ªç¡®è®¤æŠ¥æ–‡åï¼Œåœ¨è¿™ä¸ª 2MSL æ—¶é—´ä¸­ï¼Œå°±å¯ä»¥ä½¿æœ¬è¿æ¥æŒç»­çš„æ—¶é—´å†…æ‰€äº§ç”Ÿçš„æ‰€æœ‰æŠ¥æ–‡æ®µéƒ½ä»ç½‘ç»œä¸­æ¶ˆå¤±ã€‚è¿™æ ·æ–°çš„è¿æ¥ä¸­ä¸ä¼šå‡ºç°æ—§è¿æ¥çš„è¯·æ±‚æŠ¥æ–‡ã€‚\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\nåŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/qzcsu/article/details/72861891\n\n### â­å¦‚æœå·²ç»å»ºç«‹äº†è¿æ¥ï¼Œä½†æ˜¯å®¢æˆ·ç«¯çªç„¶å‡ºç°æ•…éšœäº†æ€ä¹ˆåŠï¼Ÿ\n\nTCP è¿˜è®¾æœ‰ä¸€ä¸ª**ä¿æ´»è®¡æ—¶å™¨**ï¼Œæ˜¾ç„¶ï¼Œå®¢æˆ·ç«¯å¦‚æœå‡ºç°æ•…éšœï¼ŒæœåŠ¡å™¨ä¸èƒ½ä¸€ç›´ç­‰ä¸‹å»ï¼Œç™½ç™½æµªè´¹èµ„æºã€‚æœåŠ¡å™¨æ¯æ”¶åˆ°ä¸€æ¬¡å®¢æˆ·ç«¯çš„è¯·æ±‚åéƒ½ä¼šé‡æ–°å¤ä½è¿™ä¸ªè®¡æ—¶å™¨ï¼Œæ—¶é—´é€šå¸¸æ˜¯è®¾ç½®ä¸º 2 å°æ—¶ï¼Œè‹¥ä¸¤å°æ—¶è¿˜æ²¡æœ‰æ”¶åˆ°å®¢æˆ·ç«¯çš„ä»»ä½•æ•°æ®ï¼ŒæœåŠ¡å™¨å°±ä¼šå‘é€ä¸€ä¸ª**æ¢æµ‹æŠ¥æ–‡æ®µ**ï¼Œä»¥åæ¯éš” 75 ç§’å‘é€ä¸€æ¬¡ã€‚è‹¥**ä¸€è¿å‘é€10ä¸ªæ¢æµ‹æŠ¥æ–‡ä»ç„¶æ²¡ååº”**ï¼ŒæœåŠ¡å™¨å°±è®¤ä¸ºå®¢æˆ·ç«¯å‡ºäº†æ•…éšœï¼Œæ¥ç€å°±**å…³é—­è¿æ¥**ã€‚\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\nåŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/qzcsu/article/details/72861891\n\n### IPåœ°å€æ˜¯æ€æ ·åˆ†ç±»çš„ï¼Œä½ çŸ¥é“å—ï¼Ÿ\n\nå…ˆè¯´ä¸€ä¸‹ IP çš„åŸºæœ¬ç‰¹ç‚¹ï¼š\n\n- IP åœ°å€ç”±å››æ®µç»„æˆï¼Œæ¯ä¸ªå­—æ®µæ˜¯ä¸€ä¸ªå­—èŠ‚ï¼Œ8 ä½ï¼Œæœ€å¤§å€¼æ˜¯ 255ã€‚\n- IP åœ°å€ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œå³**ç½‘ç»œåœ°å€**å’Œ**ä¸»æœºåœ°å€**ã€‚\n\tç½‘ç»œåœ°å€è¡¨ç¤ºå…¶å±äºäº’è”ç½‘çš„å“ªä¸€ä¸ªç½‘ç»œï¼Œä¸»æœºåœ°å€è¡¨ç¤ºå…¶å±äºè¯¥ç½‘ç»œä¸­çš„å“ªä¸€å°ä¸»æœºã€‚\n\nIP åœ°å€æ ¹æ®ç½‘ç»œåœ°å€è¿›è¡Œåˆ†ç±»ï¼Œä¸»è¦åˆ†ä¸º Aã€Bã€C ä¸‰ç±»åŠç‰¹æ®Šåœ°å€ Dã€E è¿™äº”ç±»\n\n**Aç±»ï¼š** (1.0.0.0-126.0.0.0)ä¸€èˆ¬ç”¨äºå¤§å‹ç½‘ç»œã€‚\n\n**Bç±»ï¼š** (128.0.0.0-191.255.0.0)ä¸€èˆ¬ç”¨äºä¸­ç­‰è§„æ¨¡ç½‘ç»œã€‚\n\n**Cç±»ï¼š** (192.0.0.0-223.255.255.0)ä¸€èˆ¬ç”¨äºå°å‹ç½‘ç»œã€‚\n\n**Dç±»ï¼š** æ˜¯å¤šæ’­åœ°å€ï¼Œåœ°å€çš„ç½‘ç»œå·å–å€¼äº 224~239 ä¹‹é—´ï¼Œä¸€èˆ¬ç”¨äºå¤šè·¯å¹¿æ’­ç”¨æˆ·ã€‚\n\n**Eç±»ï¼š** æ˜¯ä¿ç•™åœ°å€ã€‚åœ°å€çš„ç½‘ç»œå·å–å€¼äº 240~255 ä¹‹é—´ã€‚\n\n### å®¢æˆ·ç«¯ä¸æ–­è¿›è¡Œè¯·æ±‚é“¾æ¥ä¼šæ€æ ·ï¼ŸDDos(Distributed Denial of Service)æ”»å‡»ï¼Ÿ\n\næœåŠ¡å™¨ç«¯ä¼šä¸ºæ¯ä¸ªè¯·æ±‚åˆ›å»ºä¸€ä¸ªé“¾æ¥ï¼Œå¹¶å‘å…¶å‘é€ç¡®è®¤æŠ¥æ–‡ï¼Œç„¶åç­‰å¾…å®¢æˆ·ç«¯è¿›è¡Œç¡®è®¤\n\n**(1) DDos æ”»å‡»ï¼š**\n\n- å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€è¯·æ±‚é“¾æ¥æ•°æ®åŒ…\n- æœåŠ¡ç«¯å‘å®¢æˆ·ç«¯å‘é€ç¡®è®¤æ•°æ®åŒ…\n- å®¢æˆ·ç«¯å´ä¸å‘æœåŠ¡ç«¯å‘é€ç¡®è®¤æ•°æ®åŒ…ï¼ŒæœåŠ¡å™¨**ä¸€ç›´ç­‰å¾…**æ¥è‡ªå®¢æˆ·ç«¯çš„ç¡®è®¤\n\n**(2) DDos é¢„é˜²ï¼šï¼ˆæ²¡æœ‰å½»åº•æ ¹æ²»çš„åŠæ³•ï¼Œé™¤éä¸ä½¿ç”¨TCPï¼‰**\n\n- é™åˆ¶åŒæ—¶æ‰“å¼€ SYN åŠé“¾æ¥çš„æ•°ç›®\n- ç¼©çŸ­ SYN åŠé“¾æ¥çš„ Time out æ—¶é—´\n- å…³é—­ä¸å¿…è¦çš„æœåŠ¡\n\n### GET ä¸ POST çš„åŒºåˆ«ï¼Ÿ\n\nGET ä¸ POST æ˜¯æˆ‘ä»¬å¸¸ç”¨çš„ä¸¤ç§ HTTP Methodï¼ŒäºŒè€…ä¹‹é—´çš„åŒºåˆ«ä¸»è¦åŒ…æ‹¬å¦‚ä¸‹äº”ä¸ªæ–¹é¢ï¼š\n\n**1ã€** ä»åŠŸèƒ½ä¸Šè®²ï¼ŒGET ä¸€èˆ¬ç”¨æ¥**ä»æœåŠ¡å™¨ä¸Šè·å–èµ„æº**ï¼ŒPOST ä¸€èˆ¬ç”¨æ¥**æ›´æ–°æœåŠ¡å™¨ä¸Šçš„èµ„æº**ï¼›\n\n**2ã€**ä»è¯·æ±‚å‚æ•°å½¢å¼ä¸Šçœ‹ï¼ŒGETè¯·æ±‚çš„æ•°æ®ä¼š**é™„åœ¨URLä¸Š**ï¼Œä»¥?åˆ†å‰² URL å’Œä¼ è¾“æ•°æ®ï¼Œå‚æ•°ä¹‹é—´ä»¥&ç›¸è¿ï¼›è€Œ POST è¯·æ±‚ä¼šæŠŠæäº¤çš„æ•°æ®åˆ™æ”¾ç½®åœ¨ HTTP è¯·æ±‚æŠ¥æ–‡çš„ **è¯·æ±‚ä½“** ä¸­ã€‚\n\n**3ã€**å°±å®‰å…¨æ€§è€Œè¨€ï¼ŒPOSTçš„**å®‰å…¨æ€§**è¦æ¯” GET çš„å®‰å…¨æ€§é«˜ï¼Œå› ä¸º GET è¯·æ±‚æäº¤çš„æ•°æ®å°†æ˜æ–‡å‡ºç°åœ¨ URL ä¸Šï¼Œè€Œä¸” POST è¯·æ±‚å‚æ•°åˆ™è¢«åŒ…è£…åˆ°è¯·æ±‚ä½“ä¸­ï¼Œç›¸å¯¹æ›´å®‰å…¨ã€‚\n\n**4ã€**ä»è¯·æ±‚çš„å¤§å°çœ‹ï¼ŒGETè¯·æ±‚çš„**é•¿åº¦**å—é™äºæµè§ˆå™¨æˆ–æœåŠ¡å™¨å¯¹ URL é•¿åº¦çš„é™åˆ¶ï¼Œå…è®¸å‘é€çš„æ•°æ®é‡æ¯”è¾ƒå°ï¼Œè€Œ POST è¯·æ±‚åˆ™æ˜¯æ²¡æœ‰å¤§å°é™åˆ¶çš„ã€‚\n\n### DNSçš„å¯»å€è¿‡ç¨‹ä½ çŸ¥é“å—ï¼Ÿ\n\næµè§ˆå™¨ç¼“å­˜ã€ç³»ç»Ÿç¼“å­˜ã€hosts æ–‡ä»¶ã€è·¯ç”±å™¨ç¼“å­˜ã€ é€’å½’æœç´¢æ ¹åŸŸåæœåŠ¡å™¨ã€‚\n\n### ä»€ä¹ˆæ˜¯Socket\n\n**1ã€**ç½‘ç»œä¸Šçš„ä¸¤ä¸ªç¨‹åºé€šè¿‡ä¸€ä¸ªåŒå‘çš„é€šè®¯è¿æ¥å®ç°æ•°æ®çš„äº¤æ¢ï¼Œè¿™ä¸ªåŒå‘é“¾è·¯çš„ä¸€ç«¯ç§°ä¸ºä¸€ä¸ª Socketã€‚Socket é€šå¸¸ç”¨æ¥å®ç°å®¢æˆ·æ–¹å’ŒæœåŠ¡æ–¹çš„è¿æ¥ã€‚Socket æ˜¯ TCP/IP åè®®çš„ä¸€ä¸ªååˆ†æµè¡Œçš„ç¼–ç¨‹ç•Œé¢ï¼Œä¸€ä¸ª Socket ç”±ä¸€ä¸ª IP åœ°å€å’Œä¸€ä¸ªç«¯å£å·å”¯ä¸€ç¡®å®šã€‚\n\n**2ã€**ä½†æ˜¯ï¼ŒSocket æ‰€æ”¯æŒçš„åè®®ç§ç±»ä¹Ÿä¸å…‰ TCP/IPã€UDPï¼Œå› æ­¤ä¸¤è€…ä¹‹é—´æ˜¯æ²¡æœ‰å¿…ç„¶è”ç³»çš„ã€‚åœ¨ Java ç¯å¢ƒä¸‹ï¼ŒSocket ç¼–ç¨‹ä¸»è¦æ˜¯æŒ‡åŸºäº TCP/IP åè®®çš„ç½‘ç»œç¼–ç¨‹ã€‚\n\n**3ã€**socket è¿æ¥å°±æ˜¯æ‰€è°“çš„é•¿è¿æ¥ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨éœ€è¦äº’ç›¸è¿æ¥ï¼Œç†è®ºä¸Šå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ä¸€æ—¦å»ºç«‹èµ·è¿æ¥å°†ä¸ä¼šä¸»åŠ¨æ–­æ‰çš„ï¼Œä½†æ˜¯æœ‰æ—¶å€™ç½‘ç»œæ³¢åŠ¨è¿˜æ˜¯æœ‰å¯èƒ½çš„\n\n**4ã€**Socket åå‘äºåº•å±‚ã€‚ä¸€èˆ¬å¾ˆå°‘ç›´æ¥ä½¿ç”¨ Socket æ¥ç¼–ç¨‹ï¼Œæ¡†æ¶åº•å±‚ä½¿ç”¨ Socket æ¯”è¾ƒå¤šï¼Œ\n\n### Socketå±äºç½‘ç»œçš„é‚£ä¸ªå±‚é¢\n\n![](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes20210325212441.png)\n\nSocket æ˜¯åº”ç”¨å±‚ä¸ TCP/IP åè®®æ—é€šä¿¡çš„ä¸­é—´è½¯ä»¶æŠ½è±¡å±‚ï¼Œå®ƒæ˜¯ä¸€ç»„æ¥å£ã€‚åœ¨è®¾è®¡æ¨¡å¼ä¸­ï¼ŒSocket å…¶å®å°±æ˜¯ä¸€ä¸ªå¤–è§‚æ¨¡å¼ï¼Œå®ƒæŠŠå¤æ‚çš„ TCP/IP åè®®æ—éšè—åœ¨ Socket æ¥å£åé¢ï¼Œå¯¹ç”¨æˆ·æ¥è¯´ï¼Œä¸€ç»„ç®€å•çš„æ¥å£å°±æ˜¯å…¨éƒ¨ï¼Œè®© Socket å»ç»„ç»‡æ•°æ®ï¼Œä»¥ç¬¦åˆæŒ‡å®šçš„åè®®ã€‚\n\n### Socketé€šè®¯çš„è¿‡ç¨‹\n\n**åŸºäºTCPï¼š**\n\næœåŠ¡å™¨ç«¯å…ˆåˆå§‹åŒ– Socketï¼Œç„¶åä¸ç«¯å£ç»‘å®š(bind)ï¼Œå¯¹ç«¯å£è¿›è¡Œç›‘å¬(listen)ï¼Œè°ƒç”¨ accept é˜»å¡ï¼Œç­‰å¾…å®¢æˆ·ç«¯è¿æ¥ã€‚åœ¨è¿™æ—¶å¦‚æœæœ‰ä¸ªå®¢æˆ·ç«¯åˆå§‹åŒ–ä¸€ä¸ª Socketï¼Œç„¶åè¿æ¥æœåŠ¡å™¨(connect)ï¼Œå¦‚æœè¿æ¥æˆåŠŸï¼Œè¿™æ—¶å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ç«¯çš„è¿æ¥å°±å»ºç«‹äº†ã€‚å®¢æˆ·ç«¯å‘é€æ•°æ®è¯·æ±‚ï¼ŒæœåŠ¡å™¨ç«¯æ¥æ”¶è¯·æ±‚å¹¶å¤„ç†è¯·æ±‚ï¼Œç„¶åæŠŠå›åº”æ•°æ®å‘é€ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯è¯»å–æ•°æ®ï¼Œæœ€åå…³é—­è¿æ¥ï¼Œä¸€æ¬¡äº¤äº’ç»“æŸã€‚\n\n**åŸºäºUDPï¼š**\n\nUDP åè®®æ˜¯ç”¨æˆ·æ•°æ®æŠ¥åè®®çš„ç®€ç§°ï¼Œä¹Ÿç”¨äºç½‘ç»œæ•°æ®çš„ä¼ è¾“ã€‚è™½ç„¶ UDP åè®®æ˜¯ä¸€ç§ä¸å¤ªå¯é çš„åè®®ï¼Œä½†æœ‰æ—¶åœ¨éœ€è¦è¾ƒå¿«åœ°æ¥æ”¶æ•°æ®å¹¶ä¸”å¯ä»¥å¿å—è¾ƒå°é”™è¯¯çš„æƒ…å†µä¸‹ï¼ŒUDP å°±ä¼šè¡¨ç°å‡ºæ›´å¤§çš„ä¼˜åŠ¿ã€‚æˆ‘å®¢æˆ·ç«¯åªéœ€è¦å‘é€ï¼ŒæœåŠ¡ç«¯èƒ½ä¸èƒ½æ¥æ”¶çš„åˆ°æˆ‘ä¸ç®¡\n\n### Socketå’Œhttpçš„åŒºåˆ«å’Œåº”ç”¨åœºæ™¯\n\n**1ã€**Socket è¿æ¥å°±æ˜¯æ‰€è°“çš„é•¿è¿æ¥ï¼Œç†è®ºä¸Šå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ä¸€æ—¦å»ºç«‹èµ·è¿æ¥å°†ä¸ä¼šä¸»åŠ¨æ–­æ‰ï¼›\n\n**2ã€**Socket é€‚ç”¨åœºæ™¯ï¼šç½‘ç»œæ¸¸æˆï¼Œé“¶è¡ŒæŒç»­äº¤äº’ï¼Œç›´æ’­ï¼Œåœ¨çº¿è§†å±ç­‰ã€‚\n\n**3ã€**http è¿æ¥å°±æ˜¯æ‰€è°“çš„çŸ­è¿æ¥ï¼Œå³å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯å‘é€ä¸€æ¬¡è¯·æ±‚ï¼ŒæœåŠ¡å™¨ç«¯å“åº”åè¿æ¥å³ä¼šæ–­å¼€ç­‰å¾…ä¸‹æ¬¡è¿æ¥\n\n**4ã€**http é€‚ç”¨åœºæ™¯ï¼šå…¬å¸ OA æœåŠ¡ï¼Œäº’è”ç½‘æœåŠ¡ï¼Œç”µå•†ï¼ŒåŠå…¬ï¼Œç½‘ç«™ç­‰ç­‰ç­‰ç­‰\n\n### ä»€ä¹ˆæ˜¯ HTTP åè®®æ— çŠ¶æ€åè®®ï¼Ÿæ€ä¹ˆè§£å†³Httpåè®®æ— çŠ¶æ€åè®®?\n\nHTTP æ˜¯ä¸€ä¸ªæ— çŠ¶æ€çš„åè®®ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰è®°å¿†åŠ›ï¼Œè¿™æ„å‘³ç€æ¯ä¸€æ¬¡çš„è¯·æ±‚éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œç¼ºå°‘çŠ¶æ€æ„å‘³ç€å¦‚æœåç»­å¤„ç†éœ€è¦å‰é¢çš„ä¿¡æ¯ï¼Œåˆ™å®ƒå¿…é¡»è¦é‡ä¼ ï¼Œè¿™æ ·å¯èƒ½å¯¼è‡´æ¯æ¬¡è¿æ¥ä¼ é€çš„æ•°æ®é‡å¢å¤§ã€‚æœåŠ¡å™¨æ— æ³•åˆ¤æ–­ç”¨æˆ·èº«ä»½ã€‚\n\nHTTP çš„è¿™ç§ç‰¹æ€§æœ‰ä¼˜ç‚¹ä¹Ÿæœ‰ç¼ºç‚¹ï¼š\n\n- **ä¼˜ç‚¹**ï¼šè§£æ”¾äº†æœåŠ¡å™¨ï¼Œæ¯ä¸€æ¬¡çš„è¯·æ±‚â€œç‚¹åˆ°ä¸ºæ­¢â€ï¼Œä¸ä¼šé€ æˆä¸å¿…è¦çš„è¿æ¥å ç”¨\n- **ç¼ºç‚¹**ï¼šæ¯æ¬¡è¯·æ±‚ä¼šä¼ è¾“å¤§é‡é‡å¤çš„å†…å®¹ä¿¡æ¯ï¼Œå¹¶ä¸”ï¼Œåœ¨è¯·æ±‚ä¹‹é—´æ— æ³•å®ç°æ•°æ®çš„å…±äº«\n\nè§£å†³æ–¹æ¡ˆï¼š\n\n1. ä½¿ç”¨å‚æ•°ä¼ é€’æœºåˆ¶ï¼š\n\tå°†å‚æ•°æ‹¼æ¥åœ¨è¯·æ±‚çš„ URL åé¢ï¼Œå®ç°æ•°æ®çš„ä¼ é€’ï¼ˆGET æ–¹å¼ï¼‰ï¼Œä¾‹å¦‚ï¼š`/param/list?username=wmyskxz`\n\t**é—®é¢˜**ï¼šå¯ä»¥è§£å†³æ•°æ®å…±äº«çš„é—®é¢˜ï¼Œä½†æ˜¯è¿™ç§æ–¹å¼ä¸€ä¸å®‰å…¨ï¼ŒäºŒæ•°æ®å…è®¸ä¼ è¾“é‡åªæœ‰ 1kb\n2. ä½¿ç”¨ Cookie æŠ€æœ¯\n3. ä½¿ç”¨ Session æŠ€æœ¯\n\nCookie å’Œ Session éƒ½æ˜¯å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´ä¿æŒçŠ¶æ€çš„è§£å†³æ–¹æ¡ˆï¼Œå…·ä½“æ¥è¯´ï¼Œcookie æœºåˆ¶é‡‡ç”¨çš„æ˜¯åœ¨å®¢æˆ·ç«¯ä¿æŒçŠ¶æ€çš„æ–¹æ¡ˆï¼Œè€Œ session æœºåˆ¶é‡‡ç”¨çš„æ˜¯åœ¨æœåŠ¡å™¨ç«¯ä¿æŒçŠ¶æ€çš„æ–¹æ¡ˆã€‚\n\n### ä»€ä¹ˆæ˜¯Cookie\n\nCookie å®é™…ä¸Šæ˜¯ä¸€å°æ®µçš„æ–‡æœ¬ä¿¡æ¯ã€‚å®¢æˆ·ç«¯è¯·æ±‚æœåŠ¡å™¨ï¼Œå¦‚æœæœåŠ¡å™¨éœ€è¦è®°å½•è¯¥ç”¨æˆ·çŠ¶æ€ï¼Œå°±ä½¿ç”¨ response å‘å®¢æˆ·ç«¯æµè§ˆå™¨é¢å‘ä¸€ä¸ª Cookieï¼Œè€Œå®¢æˆ·ç«¯æµè§ˆå™¨ä¼šæŠŠ Cookie ä¿å­˜èµ·æ¥ã€‚å½“æµè§ˆå™¨å†è¯·æ±‚è¯¥ç½‘ç«™æ—¶ï¼Œæµè§ˆå™¨æŠŠè¯·æ±‚çš„ç½‘å€è¿åŒè¯¥ Cookie ä¸€åŒæäº¤ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨æ£€æŸ¥è¯¥ Cookieï¼Œä»¥æ­¤æ¥è¾¨è®¤ç”¨æˆ·çŠ¶æ€ã€‚æœåŠ¡å™¨è¿˜å¯ä»¥æ ¹æ®éœ€è¦ä¿®æ”¹ Cookie çš„å†…å®¹ã€‚ \n\n### ä»€ä¹ˆæ˜¯Session\n\nsession æ˜¯æµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¼šè¯è¿‡ç¨‹ä¸­ï¼ŒæœåŠ¡å™¨ä¼šåˆ†é…çš„ä¸€å—å‚¨å­˜ç©ºé—´ç»™ sessionã€‚\n\næœåŠ¡å™¨é»˜è®¤ä¸ºå®¢æˆ·æµè§ˆå™¨çš„ cookie ä¸­è®¾ç½® sessionidï¼Œè¿™ä¸ª sessionid å°±å’Œ cookie å¯¹åº”ï¼Œæµè§ˆå™¨åœ¨å‘æœåŠ¡å™¨è¯·æ±‚è¿‡ç¨‹ä¸­ä¼ è¾“çš„ cookie åŒ…å« sessionid ï¼ŒæœåŠ¡å™¨æ ¹æ®ä¼ è¾“ cookie ä¸­çš„ sessionid è·å–å‡ºä¼šè¯ä¸­å­˜å‚¨çš„ä¿¡æ¯ï¼Œç„¶åç¡®å®šä¼šè¯çš„èº«ä»½ä¿¡æ¯ã€‚\n\n### Cookieå’ŒSessionå¯¹äºHTTPæœ‰ä»€ä¹ˆç”¨ï¼Ÿ\n\n HTTP åè®®æœ¬èº«æ˜¯æ— æ³•åˆ¤æ–­ç”¨æˆ·èº«ä»½ã€‚æ‰€ä»¥éœ€è¦ cookie æˆ–è€… session\n\n### Cookieä¸SessionåŒºåˆ«\n\n- **å®ç°æœºåˆ¶**ï¼šSession çš„å®ç°å¸¸å¸¸ä¾èµ–äº Cookie æœºåˆ¶ï¼Œé€šè¿‡ Cookie æœºåˆ¶å›ä¼  SessionIDï¼›\n- **å¤§å°é™åˆ¶**ï¼šCookie æœ‰å¤§å°é™åˆ¶å¹¶ä¸”æµè§ˆå™¨å¯¹æ¯ä¸ªç«™ç‚¹ä¹Ÿæœ‰ cookie çš„ä¸ªæ•°é™åˆ¶ï¼ŒSession æ²¡æœ‰å¤§å°é™åˆ¶ï¼Œç†è®ºä¸Šåªä¸æœåŠ¡å™¨çš„å†…å­˜å¤§å°æœ‰å…³ï¼›\n- **å®‰å…¨æ€§**ï¼šCookie å­˜åœ¨å®‰å…¨éšæ‚£ï¼Œé€šè¿‡æ‹¦æˆªæˆ–æœ¬åœ°æ–‡ä»¶æ‰¾å¾—åˆ° cookie åå¯ä»¥è¿›è¡Œæ”»å‡»ï¼Œè€Œ Session ç”±äºä¿å­˜åœ¨æœåŠ¡å™¨ç«¯ï¼Œç›¸å¯¹æ›´åŠ å®‰å…¨ï¼›\n- **æœåŠ¡å™¨èµ„æºæ¶ˆè€—**ï¼šSession æ˜¯ä¸€å®šæ—¶é—´å†…ä¿å­˜åœ¨æœåŠ¡å™¨ç«¯ä¸Šï¼Œå¦‚æœ session è¿‡å¤šä¼šå¢åŠ æœåŠ¡å™¨çš„å‹åŠ›ã€‚\n\n### ä»€ä¹ˆæ˜¯Token\n\nToken çš„å¼•å…¥ï¼šToken æ˜¯åœ¨å®¢æˆ·ç«¯é¢‘ç¹å‘æœåŠ¡ç«¯è¯·æ±‚æ•°æ®ï¼ŒæœåŠ¡ç«¯é¢‘ç¹çš„å»æ•°æ®åº“æŸ¥è¯¢ç”¨æˆ·åå’Œå¯†ç å¹¶è¿›è¡Œå¯¹æ¯”ï¼Œåˆ¤æ–­ç”¨æˆ·åå’Œå¯†ç æ­£ç¡®ä¸å¦ï¼Œå¹¶ä½œå‡ºç›¸åº”æç¤ºï¼Œåœ¨è¿™æ ·çš„èƒŒæ™¯ä¸‹ï¼ŒToken ä¾¿åº”è¿è€Œç”Ÿã€‚\n\nToken çš„å®šä¹‰ï¼šToken æ˜¯æœåŠ¡ç«¯ç”Ÿæˆçš„ä¸€ä¸²å­—ç¬¦ä¸²ï¼Œä»¥ä½œå®¢æˆ·ç«¯è¿›è¡Œè¯·æ±‚çš„ä¸€ä¸ªä»¤ç‰Œï¼Œå½“ç¬¬ä¸€æ¬¡ç™»å½•åï¼ŒæœåŠ¡å™¨ç”Ÿæˆä¸€ä¸ª Token ä¾¿å°†æ­¤ Token è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œä»¥åå®¢æˆ·ç«¯åªéœ€å¸¦ä¸Šè¿™ä¸ª Token å‰æ¥è¯·æ±‚æ•°æ®å³å¯ï¼Œæ— éœ€å†æ¬¡å¸¦ä¸Šç”¨æˆ·åå’Œå¯†ç ã€‚\n\nä½¿ç”¨ Token çš„ç›®çš„ï¼šToken çš„ç›®çš„æ˜¯ä¸ºäº†å‡è½»æœåŠ¡å™¨çš„å‹åŠ›ï¼Œå‡å°‘é¢‘ç¹çš„æŸ¥è¯¢æ•°æ®åº“ï¼Œä½¿æœåŠ¡å™¨æ›´åŠ å¥å£®ã€‚\n\nToken æ˜¯åœ¨æœåŠ¡ç«¯äº§ç”Ÿçš„ã€‚å¦‚æœå‰ç«¯ä½¿ç”¨ç”¨æˆ·å/å¯†ç å‘æœåŠ¡ç«¯è¯·æ±‚è®¤è¯ï¼ŒæœåŠ¡ç«¯è®¤è¯æˆåŠŸï¼Œé‚£ä¹ˆåœ¨æœåŠ¡ç«¯ä¼šè¿”å› Token ç»™å‰ç«¯ã€‚å‰ç«¯å¯ä»¥åœ¨æ¯æ¬¡è¯·æ±‚çš„æ—¶å€™å¸¦ä¸Š Token **è¯æ˜è‡ªå·±çš„åˆæ³•åœ°ä½**\n\n### sessionä¸tokenåŒºåˆ«\n\n- session å­˜å‚¨åœ¨æœåŠ¡å™¨ç«¯ï¼Œtoken å­˜å‚¨åœ¨å®¢æˆ·ç«¯\n- token æä¾›è®¤è¯å’ŒæˆæƒåŠŸèƒ½ï¼Œä½œä¸ºèº«ä»½è®¤è¯ï¼Œtoken å®‰å…¨æ€§æ¯” session å¥½ï¼›\n- â­session è¿™ç§ä¼šè¯å­˜å‚¨æ–¹å¼æ–¹å¼åªé€‚ç”¨äºå®¢æˆ·ç«¯ä»£ç å’ŒæœåŠ¡ç«¯ä»£ç è¿è¡Œåœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šï¼Œtoken é€‚ç”¨äºé¡¹ç›®çº§çš„å‰åç«¯åˆ†ç¦»ï¼ˆå‰åç«¯ä»£ç è¿è¡Œåœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸‹ï¼‰\n\n### å¸¸ç”¨çš„HTTPæ–¹æ³•æœ‰å“ªäº›ï¼Ÿ\n\n- **GETï¼š**ç”¨äºè¯·æ±‚è®¿é—®å·²ç»è¢« URIï¼ˆç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼‰è¯†åˆ«çš„èµ„æºï¼Œå¯ä»¥é€šè¿‡ URL ä¼ å‚ç»™æœåŠ¡å™¨\n- **POSTï¼š**ç”¨äºä¼ è¾“ä¿¡æ¯ç»™æœåŠ¡å™¨ï¼Œä¸»è¦åŠŸèƒ½ä¸ GET æ–¹æ³•ç±»ä¼¼ï¼Œä½†ä¸€èˆ¬æ¨èä½¿ç”¨ POST æ–¹å¼ã€‚\n- **PUTï¼š**ä¼ è¾“æ–‡ä»¶ï¼ŒæŠ¥æ–‡ä¸»ä½“ä¸­åŒ…å«æ–‡ä»¶å†…å®¹ï¼Œä¿å­˜åˆ°å¯¹åº” URI ä½ç½®ã€‚\n- **HEADï¼š**è·å¾—æŠ¥æ–‡é¦–éƒ¨ï¼Œä¸ GET æ–¹æ³•ç±»ä¼¼ï¼Œåªæ˜¯ä¸è¿”å›æŠ¥æ–‡ä¸»ä½“ï¼Œä¸€èˆ¬ç”¨äºéªŒè¯ URI æ˜¯å¦æœ‰æ•ˆã€‚\n- **DELETEï¼š**åˆ é™¤æ–‡ä»¶ï¼Œä¸ PUT æ–¹æ³•ç›¸åï¼Œåˆ é™¤å¯¹åº” URI ä½ç½®çš„æ–‡ä»¶ã€‚\n- **OPTIONSï¼š**æŸ¥è¯¢ç›¸åº” URI æ”¯æŒçš„ HTTP æ–¹æ³•ã€‚\n\n### ç½‘ç»œå±‚çš„ ARP åè®®å·¥ä½œåŸç†ï¼Ÿ\n\nç½‘ç»œå±‚çš„ ARP åè®®å®Œæˆäº† IP åœ°å€ä¸ç‰©ç†åœ°å€çš„æ˜ å°„\n\n### IPåœ°å€ä¸ç‰©ç†åœ°å€\n\nç‰©ç†åœ°å€æ˜¯æ•°æ®é“¾è·¯å±‚å’Œç‰©ç†å±‚ä½¿ç”¨çš„åœ°å€ï¼ŒIP åœ°å€æ˜¯ç½‘ç»œå±‚å’Œä»¥ä¸Šå„å±‚ä½¿ç”¨çš„åœ°å€ï¼Œæ˜¯ä¸€ç§é€»è¾‘åœ°å€ï¼Œå…¶ä¸­ ARP åè®®ç”¨äº IP åœ°å€ä¸ç‰©ç†åœ°å€çš„å¯¹åº”ã€‚\n\n### å½±å“ç½‘ç»œä¼ è¾“çš„å› ç´ æœ‰å“ªäº›ï¼Ÿ\n\nå°†ä¸€ä»½æ•°æ®ä»ä¸€ä¸ªåœ°æ–¹æ­£ç¡®åœ°ä¼ è¾“åˆ°å¦ä¸€ä¸ªåœ°æ–¹æ‰€éœ€è¦çš„æ—¶é—´æˆ‘ä»¬ç§°ä¹‹ä¸ºå“åº”æ—¶é—´ã€‚å½±å“è¿™ä¸ªå“åº”æ—¶é—´çš„å› ç´ æœ‰å¾ˆå¤šã€‚\n\n1ã€ç½‘ç»œå¸¦å®½\n2ã€ä¼ è¾“è·ç¦»\n3ã€TCP æ‹¥å¡æ§åˆ¶\n\n### ä»€æ˜¯å¯¹ç§°åŠ å¯†ä¸éå¯¹ç§°åŠ å¯†\n\nå¯¹ç§°å¯†é’¥åŠ å¯†æ˜¯æŒ‡**åŠ å¯†å’Œè§£å¯†ä½¿ç”¨åŒä¸€ä¸ªå¯†é’¥**çš„æ–¹å¼ï¼Œè¿™ç§æ–¹å¼å­˜åœ¨çš„æœ€å¤§é—®é¢˜å°±æ˜¯å¯†é’¥å‘é€é—®é¢˜ï¼Œå³å¦‚ä½•å®‰å…¨åœ°å°†å¯†é’¥å‘ç»™å¯¹æ–¹ï¼›\n\nè€Œéå¯¹ç§°åŠ å¯†æ˜¯æŒ‡ä½¿ç”¨**ä¸€å¯¹éå¯¹ç§°å¯†é’¥ï¼Œå³å…¬é’¥å’Œç§é’¥**ï¼Œå…¬é’¥å¯ä»¥éšæ„å‘å¸ƒï¼Œä½†ç§é’¥åªæœ‰è‡ªå·±çŸ¥é“ã€‚å‘é€å¯†æ–‡çš„ä¸€æ–¹ä½¿ç”¨å¯¹æ–¹çš„å…¬é’¥è¿›è¡ŒåŠ å¯†å¤„ç†ï¼Œå¯¹æ–¹æ¥æ”¶åˆ°åŠ å¯†ä¿¡æ¯åï¼Œä½¿ç”¨è‡ªå·±çš„ç§é’¥è¿›è¡Œè§£å¯†ã€‚ ç”±äºéå¯¹ç§°åŠ å¯†çš„æ–¹å¼ä¸éœ€è¦å‘é€ç”¨æ¥è§£å¯†çš„ç§é’¥ï¼Œæ‰€ä»¥å¯ä»¥ä¿è¯å®‰å…¨æ€§ï¼›ä½†æ˜¯å’Œå¯¹ç§°åŠ å¯†æ¯”èµ·æ¥ï¼Œéå¸¸çš„æ…¢\n\n### HTTPSé‡‡ç”¨å¯¹ç§°åŠ å¯†+éå¯¹ç§°åŠ å¯†\n\nä½¿ç”¨å¯¹ç§°åŠ å¯†ï¼Œä¼˜ç‚¹æ˜¯åŠ å¯†è§£å¯†é€Ÿåº¦å¿«ï¼Œç¼ºç‚¹æ˜¯ä¸å®‰å…¨ï¼›\nä½¿ç”¨éå¯¹ç§°åŠ å¯†ï¼Œä¼˜ç‚¹æ˜¯ä¿è¯å®‰å…¨æ€§ï¼Œç¼ºç‚¹æ˜¯é€Ÿåº¦æ…¢ï¼›\n\nHttps ç»“åˆä¸¤ç§åŠ å¯†æ–¹å¼çš„ä¼˜ç‚¹ï¼Œ\nåœ¨**äº¤æ¢å¯†é’¥ç¯èŠ‚**ä½¿ç”¨éå¯¹ç§°åŠ å¯†æ–¹å¼ï¼Œä¹‹åçš„**å»ºç«‹é€šä¿¡äº¤æ¢æŠ¥æ–‡**é˜¶æ®µåˆ™ä½¿ç”¨å¯¹ç§°åŠ å¯†æ–¹å¼ã€‚\n\n## TCP/IP åè®®æ—\n\n### åº”ç”¨å±‚\n\nåº”ç”¨å±‚( application-layer ï¼‰çš„ä»»åŠ¡æ˜¯é€šè¿‡åº”ç”¨è¿›ç¨‹é—´çš„äº¤äº’æ¥å®Œæˆç‰¹å®šç½‘ç»œåº”ç”¨ã€‚åº”ç”¨å±‚åè®®å®šä¹‰çš„æ˜¯åº”ç”¨è¿›ç¨‹ï¼ˆè¿›ç¨‹ï¼šä¸»æœºä¸­æ­£åœ¨è¿è¡Œçš„ç¨‹åºï¼‰é—´çš„é€šä¿¡å’Œäº¤äº’çš„è§„åˆ™ã€‚\n\nå¯¹äºä¸åŒçš„ç½‘ç»œåº”ç”¨éœ€è¦ä¸åŒçš„åº”ç”¨å±‚åè®®ã€‚åœ¨äº’è”ç½‘ä¸­åº”ç”¨å±‚åè®®å¾ˆå¤šï¼Œå¦‚åŸŸåç³»ç»Ÿ DNSï¼Œæ”¯æŒä¸‡ç»´ç½‘åº”ç”¨çš„ HTTP åè®®ï¼Œæ”¯æŒç”µå­é‚®ä»¶çš„ SMTP åè®®ç­‰ç­‰ã€‚\n\n### ä¼ è¾“å±‚\n\nä¼ è¾“å±‚(transport layer)çš„ä¸»è¦ä»»åŠ¡å°±æ˜¯è´Ÿè´£å‘ä¸¤å°ä¸»æœºè¿›ç¨‹ä¹‹é—´çš„é€šä¿¡æä¾›é€šç”¨çš„**æ•°æ®ä¼ è¾“æœåŠ¡**ã€‚åº”ç”¨è¿›ç¨‹åˆ©ç”¨è¯¥æœåŠ¡ä¼ é€åº”ç”¨å±‚æŠ¥æ–‡ã€‚\n\nè¿è¾“å±‚ä¸»è¦ä½¿ç”¨ä¸€ä¸‹ä¸¤ç§åè®®\n\n1. ä¼ è¾“æ§åˆ¶åè®®-TCPï¼šæä¾›é¢å‘è¿æ¥çš„ï¼Œå¯é çš„æ•°æ®ä¼ è¾“æœåŠ¡ã€‚\n2. ç”¨æˆ·æ•°æ®åè®®-UDPï¼šæä¾›æ— è¿æ¥çš„ï¼Œå°½æœ€å¤§åŠªåŠ›çš„æ•°æ®ä¼ è¾“æœåŠ¡ï¼ˆä¸ä¿è¯æ•°æ®ä¼ è¾“çš„å¯é æ€§ï¼‰ã€‚\n\n|              | UDP                                        | TCP                                    |\n| ------------ | ------------------------------------------ | -------------------------------------- |\n| æ˜¯å¦è¿æ¥     | æ— è¿æ¥                                     | é¢å‘è¿æ¥                               |\n| æ˜¯å¦å¯é      | ä¸å¯é ä¼ è¾“ï¼Œä¸ä½¿ç”¨æµé‡æ§åˆ¶å’Œæ‹¥å¡æ§åˆ¶       | å¯é ä¼ è¾“ï¼Œä½¿ç”¨æµé‡æ§åˆ¶å’Œæ‹¥å¡æ§åˆ¶       |\n| è¿æ¥å¯¹è±¡ä¸ªæ•° | æ”¯æŒä¸€å¯¹ä¸€ï¼Œä¸€å¯¹å¤šï¼Œå¤šå¯¹ä¸€å’Œå¤šå¯¹å¤šäº¤äº’é€šä¿¡ | åªèƒ½æ˜¯ä¸€å¯¹ä¸€é€šä¿¡                       |\n| ä¼ è¾“æ–¹å¼     | é¢å‘æŠ¥æ–‡                                   | é¢å‘å­—èŠ‚æµ                             |\n| é¦–éƒ¨å¼€é”€     | é¦–éƒ¨å¼€é”€å°ï¼Œä»…8å­—èŠ‚                        | é¦–éƒ¨æœ€å°20å­—èŠ‚ï¼Œæœ€å¤§60å­—èŠ‚             |\n| åœºæ™¯         | é€‚ç”¨äºå®æ—¶åº”ç”¨ï¼ˆIPç”µè¯ã€è§†é¢‘ä¼šè®®ã€ç›´æ’­ç­‰ï¼‰ | é€‚ç”¨äºè¦æ±‚å¯é ä¼ è¾“çš„åº”ç”¨ï¼Œä¾‹å¦‚æ–‡ä»¶ä¼ è¾“ |\n\n**æ¯ä¸€ä¸ªåº”ç”¨å±‚ï¼ˆTCP/IPå‚è€ƒæ¨¡å‹çš„æœ€é«˜å±‚ï¼‰åè®®ä¸€èˆ¬éƒ½ä¼šä½¿ç”¨åˆ°ä¸¤ä¸ªä¼ è¾“å±‚åè®®ä¹‹ä¸€ï¼š**\n\nè¿è¡Œåœ¨`TCPåè®®`ä¸Šçš„åè®®ï¼š\n\n- `HTTPï¼ˆHypertext Transfer Protocolï¼Œè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰`ï¼Œä¸»è¦ç”¨äºæ™®é€šæµè§ˆã€‚\n- `HTTPSï¼ˆHTTP over SSLï¼Œå®‰å…¨è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰`,`HTTP`åè®®çš„å®‰å…¨ç‰ˆæœ¬ã€‚\n- `FTPï¼ˆFile Transfer Protocolï¼Œæ–‡ä»¶ä¼ è¾“åè®®ï¼‰`ï¼Œç”¨äºæ–‡ä»¶ä¼ è¾“ã€‚\n- `POP3ï¼ˆPost Office Protocol, version 3ï¼Œé‚®å±€åè®®ï¼‰`ï¼Œæ”¶é‚®ä»¶ç”¨ã€‚\n- `SMTPï¼ˆSimple Mail Transfer Protocolï¼Œç®€å•é‚®ä»¶ä¼ è¾“åè®®ï¼‰`ï¼Œç”¨æ¥å‘é€ç”µå­é‚®ä»¶ã€‚\n- `TELNETï¼ˆTeletype over the Networkï¼Œç½‘ç»œç”µä¼ ï¼‰`ï¼Œé€šè¿‡ä¸€ä¸ª`ç»ˆç«¯ï¼ˆterminalï¼‰`ç™»é™†åˆ°ç½‘ç»œã€‚\n- `SSHï¼ˆSecure Shellï¼Œç”¨äºæ›¿ä»£å®‰å…¨æ€§å·®çš„TELNETï¼‰`ï¼Œç”¨äºåŠ å¯†å®‰å…¨ç™»é™†ç”¨ã€‚\n\nè¿è¡Œåœ¨`UDPåè®®`ä¸Šçš„åè®®ï¼š\n\n- `DHCPï¼ˆDynamic Host Configuration Protocolï¼ŒåŠ¨æ€ä¸»æœºé…ç½®åè®®ï¼‰`ï¼ŒåŠ¨æ€é…ç½® IP åœ°å€ã€‚\n\nè¿è¡Œåœ¨`TCP`å’Œ`UDP`åè®®ä¸Šï¼š\n\n- `DNSï¼ˆDomain Name Serviceï¼ŒåŸŸåæœåŠ¡ï¼‰`ï¼Œç”¨äºå®Œæˆåœ°å€æŸ¥æ‰¾ï¼Œé‚®ä»¶è½¬å‘ç­‰å·¥ä½œã€‚\n\n### ç½‘ç»œå±‚\n\nç½‘ç»œå±‚çš„ä»»åŠ¡å°±æ˜¯**é€‰æ‹©åˆé€‚çš„ç½‘é—´è·¯ç”±å’Œäº¤æ¢ç»“ç‚¹ï¼Œç¡®ä¿è®¡ç®—æœºé€šä¿¡çš„æ•°æ®åŠæ—¶ä¼ é€**ã€‚åœ¨å‘é€æ•°æ®æ—¶ï¼Œç½‘ç»œå±‚æŠŠè¿è¾“å±‚äº§ç”Ÿçš„æŠ¥æ–‡æ®µæˆ–ç”¨æˆ·æ•°æ®æŠ¥å°è£…æˆåˆ†ç»„å’ŒåŒ…è¿›è¡Œä¼ é€ã€‚åœ¨ TCP/IP ä½“ç³»ç»“æ„ä¸­ï¼Œç”±äºç½‘ç»œå±‚ä½¿ç”¨ IP åè®®ï¼Œå› æ­¤åˆ†ç»„ä¹Ÿå« IP æ•°æ®æŠ¥ ï¼Œç®€ç§°æ•°æ®æŠ¥ã€‚\n\näº’è”ç½‘æ˜¯ç”±å¤§é‡çš„å¼‚æ„ï¼ˆheterogeneousï¼‰ç½‘ç»œé€šè¿‡è·¯ç”±å™¨ï¼ˆrouterï¼‰ç›¸äº’è¿æ¥èµ·æ¥çš„ã€‚äº’è”ç½‘ä½¿ç”¨çš„ç½‘ç»œå±‚åè®®æ˜¯æ— è¿æ¥çš„ç½‘é™…åè®®ï¼ˆIntert Prococolï¼‰å’Œè®¸å¤šè·¯ç”±é€‰æ‹©åè®®ï¼Œå› æ­¤äº’è”ç½‘çš„ç½‘ç»œå±‚ä¹Ÿå«åšç½‘é™…å±‚æˆ– IP å±‚ã€‚\n\n### æ•°æ®é“¾è·¯å±‚\n\næ•°æ®é“¾è·¯å±‚(data link layer)é€šå¸¸ç®€ç§°ä¸ºé“¾è·¯å±‚ã€‚ä¸¤å°ä¸»æœºä¹‹é—´çš„æ•°æ®ä¼ è¾“ï¼Œæ€»æ˜¯åœ¨ä¸€æ®µä¸€æ®µçš„é“¾è·¯ä¸Šä¼ é€çš„ï¼Œè¿™å°±éœ€è¦ä½¿ç”¨ä¸“é—¨çš„é“¾è·¯å±‚çš„åè®®ã€‚\n\nåœ¨ä¸¤ä¸ªç›¸é‚»èŠ‚ç‚¹ä¹‹é—´ä¼ é€æ•°æ®æ—¶ï¼Œæ•°æ®é“¾è·¯å±‚å°†ç½‘ç»œå±‚äº¤ä¸‹æ¥çš„ IP æ•°æ®æŠ¥ç»„è£…æˆå¸§ï¼Œåœ¨ä¸¤ä¸ªç›¸é‚»èŠ‚ç‚¹é—´çš„é“¾è·¯ä¸Šä¼ é€å¸§ã€‚æ¯ä¸€å¸§åŒ…æ‹¬æ•°æ®å’Œå¿…è¦çš„æ§åˆ¶ä¿¡æ¯ï¼ˆå¦‚åŒæ­¥ä¿¡æ¯ï¼Œåœ°å€ä¿¡æ¯ï¼Œå·®é”™æ§åˆ¶ç­‰ï¼‰ã€‚\n\nåœ¨æ¥æ”¶æ•°æ®æ—¶ï¼Œæ§åˆ¶ä¿¡æ¯ä½¿æ¥æ”¶ç«¯èƒ½å¤ŸçŸ¥é“ä¸€ä¸ªå¸§ä»å“ªä¸ªæ¯”ç‰¹å¼€å§‹å’Œåˆ°å“ªä¸ªæ¯”ç‰¹ç»“æŸã€‚\n\nä¸€èˆ¬çš„ web åº”ç”¨çš„é€šä¿¡ä¼ è¾“æµæ˜¯è¿™æ ·çš„ï¼š\n\n![img](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOS81LzkvMTZhOWM5Y2Q1MjNlMDU5OQ.png)\n\nå‘é€ç«¯åœ¨å±‚ä¸å±‚ä¹‹é—´ä¼ è¾“æ•°æ®æ—¶ï¼Œæ¯ç»è¿‡ä¸€å±‚æ—¶ä¼šè¢«æ‰“ä¸Šä¸€ä¸ªè¯¥å±‚æ‰€å±çš„é¦–éƒ¨ä¿¡æ¯ã€‚åä¹‹ï¼Œæ¥æ”¶ç«¯åœ¨å±‚ä¸å±‚ä¹‹é—´ä¼ è¾“æ•°æ®æ—¶ï¼Œæ¯ç»è¿‡ä¸€å±‚æ—¶ä¼šæŠŠå¯¹åº”çš„é¦–éƒ¨ä¿¡æ¯å»é™¤ã€‚\n\n### ç‰©ç†å±‚\n\nåœ¨ç‰©ç†å±‚ä¸Šæ‰€ä¼ é€çš„æ•°æ®å•ä½æ˜¯æ¯”ç‰¹ã€‚ ç‰©ç†å±‚(physical layer)çš„ä½œç”¨æ˜¯å®ç°ç›¸é‚»è®¡ç®—æœºèŠ‚ç‚¹ä¹‹é—´æ¯”ç‰¹æµçš„é€æ˜ä¼ é€ï¼Œå°½å¯èƒ½å±è”½æ‰å…·ä½“ä¼ è¾“ä»‹è´¨å’Œç‰©ç†è®¾å¤‡çš„å·®å¼‚ã€‚ä½¿å…¶ä¸Šé¢çš„æ•°æ®é“¾è·¯å±‚ä¸å¿…è€ƒè™‘ç½‘ç»œçš„å…·ä½“ä¼ è¾“ä»‹è´¨æ˜¯ä»€ä¹ˆã€‚â€œé€æ˜ä¼ é€æ¯”ç‰¹æµâ€è¡¨ç¤ºç»å®é™…ç”µè·¯ä¼ é€åçš„æ¯”ç‰¹æµæ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œå¯¹ä¼ é€çš„æ¯”ç‰¹æµæ¥è¯´ï¼Œè¿™ä¸ªç”µè·¯å¥½åƒæ˜¯çœ‹ä¸è§çš„ã€‚\n\n### TCP/IP åè®®æ—\n\nåœ¨äº’è”ç½‘ä½¿ç”¨çš„å„ç§åè®®ä¸­æœ€é‡è¦å’Œæœ€è‘—åçš„å°±æ˜¯ TCP/IP ä¸¤ä¸ªåè®®ã€‚ç°åœ¨äººä»¬ç»å¸¸æåˆ°çš„ TCP/IP å¹¶ä¸ä¸€å®šæ˜¯å•æŒ‡ TCP å’Œ IP è¿™ä¸¤ä¸ªå…·ä½“çš„åè®®ï¼Œè€Œå¾€å¾€æ˜¯è¡¨ç¤ºäº’è”ç½‘æ‰€ä½¿ç”¨çš„æ•´ä¸ª TCP/IP åè®®æ—ã€‚\n\n![img](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOS80LzcvMTY5ZjY5NjZjMjRhZjM0NQ.png)\n\n\n\nTCPï¼ˆä¼ è¾“æ§åˆ¶åè®®ï¼‰å’Œ IPï¼ˆç½‘é™…åè®®ï¼‰æ˜¯**æœ€å…ˆå®šä¹‰çš„ä¸¤ä¸ªæ ¸å¿ƒåè®®**ï¼Œæ‰€ä»¥æ‰ç»Ÿç§°ä¸º TCP/IP åè®®æ—\n\n## TCPçš„ä¸‰æ¬¡æ¡æ‰‹å››æ¬¡æŒ¥æ‰‹\n\nTCP æ˜¯ä¸€ç§é¢å‘è¿æ¥çš„ã€å¯é çš„ã€åŸºäºå­—èŠ‚æµçš„ä¼ è¾“å±‚é€šä¿¡åè®®ï¼Œåœ¨å‘é€æ•°æ®å‰ï¼Œé€šä¿¡åŒæ–¹å¿…é¡»åœ¨å½¼æ­¤é—´å»ºç«‹ä¸€æ¡è¿æ¥ã€‚æ‰€è°“çš„â€œè¿æ¥â€ï¼Œå…¶å®æ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¿å­˜çš„ä¸€ä»½å…³äºå¯¹æ–¹çš„ä¿¡æ¯ï¼Œå¦‚ ip åœ°å€ã€ç«¯å£å·ç­‰ã€‚\n\nä¸€ä¸ª TCP è¿æ¥ç”±ä¸€ä¸ª 4 å…ƒç»„æ„æˆï¼Œåˆ†åˆ«æ˜¯ä¸¤ä¸ª IP åœ°å€å’Œä¸¤ä¸ªç«¯å£å·ã€‚ä¸€ä¸ª TCP è¿æ¥é€šå¸¸åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼šè¿æ¥ã€æ•°æ®ä¼ è¾“ã€é€€å‡ºï¼ˆå…³é—­ï¼‰ã€‚**é€šè¿‡ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹ä¸€ä¸ªé“¾æ¥ï¼Œé€šè¿‡å››æ¬¡æŒ¥æ‰‹æ¥å…³é—­ä¸€ä¸ªè¿æ¥**ã€‚\n\n**å½“ä¸€ä¸ªè¿æ¥è¢«å»ºç«‹æˆ–è¢«ç»ˆæ­¢æ—¶ï¼Œäº¤æ¢çš„æŠ¥æ–‡æ®µåªåŒ…å«TCPå¤´éƒ¨ï¼Œè€Œæ²¡æœ‰æ•°æ®**ã€‚\n\n### TCPæŠ¥æ–‡çš„å¤´éƒ¨ç»“æ„\n\næœ‰å‡ ä¸ªå­—æ®µéœ€è¦é‡ç‚¹ä»‹ç»ä¸‹ï¼š\n\nï¼ˆ1ï¼‰åºå·ï¼šseq åºå·ï¼Œå  32 ä½ï¼Œç”¨æ¥æ ‡è¯†ä» TCP æºç«¯å‘ç›®çš„ç«¯å‘é€çš„å­—èŠ‚æµï¼Œå‘èµ·æ–¹å‘é€æ•°æ®æ—¶å¯¹æ­¤è¿›è¡Œæ ‡è®°ã€‚\n\nï¼ˆ2ï¼‰ç¡®è®¤åºå·ï¼šack åºå·ï¼Œå  32 ä½ï¼Œåªæœ‰ ACK æ ‡å¿—ä½ä¸º 1 æ—¶ï¼Œç¡®è®¤åºå·å­—æ®µæ‰æœ‰æ•ˆï¼Œack=seq+1ã€‚\n\nï¼ˆ3ï¼‰æ ‡å¿—ä½ï¼šå…± 6 ä¸ªï¼Œå³ URGã€ACKã€PSHã€RSTã€SYNã€FIN ç­‰ï¼Œå…·ä½“å«ä¹‰å¦‚ä¸‹ï¼š\n\n- ACKï¼šç¡®è®¤åºå·æœ‰æ•ˆã€‚\n- FINï¼šé‡Šæ”¾ä¸€ä¸ªè¿æ¥ã€‚\n- PSHï¼šæ¥æ”¶æ–¹åº”è¯¥å°½å¿«å°†è¿™ä¸ªæŠ¥æ–‡äº¤ç»™åº”ç”¨å±‚ã€‚\n- RSTï¼šé‡ç½®è¿æ¥ã€‚\n- SYNï¼šå‘èµ·ä¸€ä¸ªæ–°è¿æ¥ã€‚\n- URGï¼šç´§æ€¥æŒ‡é’ˆï¼ˆurgent pointerï¼‰æœ‰æ•ˆã€‚\n\néœ€è¦æ³¨æ„çš„æ˜¯ï¼š\n\n- ä¸è¦å°†ç¡®è®¤åºå· ack ä¸æ ‡å¿—ä½ä¸­çš„ ACK ææ··äº†ã€‚\n- ç¡®è®¤æ–¹ ack=å‘èµ·æ–¹ seq+1ï¼Œä¸¤ç«¯é…å¯¹ã€‚\n\n### ä¸‰æ¬¡æ¡æ‰‹\n\n> ä¸‰æ¬¡æ¡æ‰‹çš„æœ¬è´¨æ˜¯ç¡®è®¤é€šä¿¡åŒæ–¹æ”¶å‘æ•°æ®çš„èƒ½åŠ›\n\nA->B\n\nA å‘é€ç»™ Bï¼ŒB è‹¥æ”¶åˆ°\n\n> è¯´æ˜BçŸ¥é“ï¼šAå¯ä»¥å‘ï¼ŒBå¯ä»¥æ”¶\n\nB è¿”å›ç»™ Aï¼ŒA è‹¥æ”¶åˆ°ï¼šè¯´æ˜ A ä¹‹å‰å‘ç»™ B çš„ B æ”¶åˆ°äº†ï¼ŒåŒæ—¶ B ä¹Ÿèƒ½ç»™è‡ªå·±å›ä¿¡ï¼Œè‡ªå·±èƒ½æ”¶åˆ°è¿™ä¸ªå›ä¿¡ã€‚\n\n> è¯´æ˜ï¼šAçŸ¥é“ï¼šAèƒ½å‘èƒ½æ”¶ï¼ŒBèƒ½æ”¶èƒ½å‘\n\nä½†æ˜¯æ­¤æ—¶ B ä¸çŸ¥é“ A æ˜¯å¦å¯ä»¥æ”¶ï¼ŒB æ˜¯å¦å‘é€æ­£å¸¸\n\näºæ˜¯ A å‘é€ç»™ Bï¼ŒB è‹¥æ”¶åˆ°ï¼šè¯´æ˜ B çš„å‘é€å›ä¿¡ A èƒ½æ”¶åˆ°\n\n> è¯´æ˜ï¼šB çŸ¥é“ A å¯ä»¥æ”¶ï¼ŒB å¯ä»¥å‘ï¼Œç»“åˆç¬¬ä¸€æ­¥ï¼Œå¾—åˆ° B ä¹ŸçŸ¥é“ A èƒ½å‘èƒ½æ”¶ï¼ŒB èƒ½æ”¶èƒ½å‘\n\n![ä¸‰æ¬¡æ¡æ‰‹](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAyMC8xLzcvMTZmN2UwM2IxZWE1MDdlOA.png)\n\n### å››æ¬¡æŒ¥æ‰‹\n\n> å››æ¬¡æŒ¥æ‰‹çš„ç›®çš„æ˜¯å…³é—­ä¸€ä¸ªè¿æ¥\n\n![å››æ¬¡æŒ¥æ‰‹](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAyMC8xLzcvMTZmN2UwM2IyMWEwN2YwYw.png)\n\nA å’Œ B æ‰“ç”µè¯ï¼Œé€šè¯å³å°†ç»“æŸåï¼Œ\nA è¯´â€œæˆ‘æ²¡å•¥è¦è¯´çš„äº†â€ï¼Œ\nB å›ç­”â€œæˆ‘çŸ¥é“äº†â€ï¼Œ\nä½†æ˜¯ B å¯èƒ½è¿˜ä¼šæœ‰è¦è¯´çš„è¯ï¼ŒA ä¸èƒ½è¦æ±‚ B è·Ÿç€è‡ªå·±çš„èŠ‚å¥ç»“æŸé€šè¯ï¼Œäºæ˜¯ B å¯èƒ½åˆå·´æ‹‰å·´æ‹‰è¯´äº†ä¸€é€šï¼Œæœ€å B è¯´â€œæˆ‘è¯´å®Œäº†â€ï¼Œ\nA å›ç­”â€œçŸ¥é“äº†â€ï¼Œè¿™æ ·é€šè¯æ‰ç®—ç»“æŸã€‚\n","slug":"Javaå…«è‚¡æ–‡-è®¡ç®—æœºç½‘ç»œ","published":1,"updated":"2023-01-29T12:00:24.422Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cldzfw327000yt9t857gt6vr3","content":"<blockquote>\n<p>æ•´ç†çš„è®¡ç®—æœºç½‘ç»œç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½\t<span id=\"more\"></span></p>\n</blockquote>\n<h2 id=\"æ·±å…¥ç†è§£HTTPSå·¥ä½œåŸç†\"><a href=\"#æ·±å…¥ç†è§£HTTPSå·¥ä½œåŸç†\" class=\"headerlink\" title=\"æ·±å…¥ç†è§£HTTPSå·¥ä½œåŸç†\"></a>æ·±å…¥ç†è§£HTTPSå·¥ä½œåŸç†</h2><blockquote>\n<p><a href=\"https://juejin.cn/post/6844903830916694030\">https://juejin.cn/post/6844903830916694030</a></p>\n</blockquote>\n<h3 id=\"å‰è¨€\"><a href=\"#å‰è¨€\" class=\"headerlink\" title=\"å‰è¨€\"></a>å‰è¨€</h3><p>è¿‘å‡ å¹´ï¼Œäº’è”ç½‘å‘ç”Ÿç€ç¿»å¤©è¦†åœ°çš„å˜åŒ–ï¼Œå°¤å…¶æ˜¯æˆ‘ä»¬ä¸€ç›´ä¹ ä»¥ä¸ºå¸¸çš„ HTTP åè®®ï¼Œåœ¨é€æ¸çš„è¢« HTTPS åè®®æ‰€å–ä»£ï¼Œåœ¨æµè§ˆå™¨ã€æœç´¢å¼•æ“ã€CA æœºæ„ã€å¤§å‹äº’è”ç½‘ä¼ä¸šçš„å…±åŒä¿ƒè¿›ä¸‹ï¼Œäº’è”ç½‘è¿æ¥äº†â€œHTTPS åŠ å¯†æ—¶ä»£â€ï¼ŒHTTPS å°†åœ¨æœªæ¥çš„å‡ å¹´å†…å…¨é¢å–ä»£ HTTP æˆä¸ºä¼ è¾“åè®®çš„ä¸»æµã€‚</p>\n<p>è¯»å®Œæœ¬æ–‡ï¼Œå¸Œæœ›ä½ èƒ½æ˜ç™½ï¼š</p>\n<ul>\n<li>HTTP é€šä¿¡å­˜åœ¨ä»€ä¹ˆé—®é¢˜</li>\n<li>HTTPS å¦‚ä½•æ”¹è¿› HTTP å­˜åœ¨é‚£äº›é—®é¢˜</li>\n<li>HTTPS å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆ</li>\n</ul>\n<h3 id=\"ä¸€ã€ä»€ä¹ˆæ˜¯HTTPS\"><a href=\"#ä¸€ã€ä»€ä¹ˆæ˜¯HTTPS\" class=\"headerlink\" title=\"ä¸€ã€ä»€ä¹ˆæ˜¯HTTPS\"></a>ä¸€ã€ä»€ä¹ˆæ˜¯HTTPS</h3><p>HTTPS æ˜¯åœ¨ HTTP ä¸Šå»ºç«‹ SSL åŠ å¯†å±‚ï¼Œå¹¶å¯¹ä¼ è¾“æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œæ˜¯ HTTP åè®®çš„å®‰å…¨ç‰ˆã€‚ç°åœ¨å®ƒè¢«å¹¿æ³›ç”¨äºä¸‡ç»´ç½‘ä¸Šå®‰å…¨æ•æ„Ÿçš„é€šè®¯ï¼Œä¾‹å¦‚äº¤æ˜“æ”¯ä»˜æ–¹é¢ã€‚</p>\n<p>HTTPS ä¸»è¦ä½œç”¨æ˜¯ï¼š</p>\n<p>ï¼ˆ1ï¼‰å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œå¹¶å»ºç«‹ä¸€ä¸ªä¿¡æ¯å®‰å…¨é€šé“ï¼Œæ¥ä¿è¯ä¼ è¾“è¿‡ç¨‹ä¸­çš„æ•°æ®å®‰å…¨;</p>\n<p>ï¼ˆ2ï¼‰å¯¹ç½‘ç«™æœåŠ¡å™¨è¿›è¡ŒçœŸå®èº«ä»½è®¤è¯ã€‚</p>\n<p>æˆ‘ä»¬ç»å¸¸ä¼šåœ¨ Web çš„ç™»å½•é¡µé¢å’Œè´­ç‰©ç»“ç®—ç•Œé¢ç­‰ä½¿ç”¨ HTTPS é€šä¿¡ã€‚ä½¿ç”¨ HTTPS é€šä¿¡æ—¶ï¼Œä¸å†ç”¨<code>http://</code>ï¼Œè€Œæ˜¯æ”¹ç”¨<code>https://</code>ã€‚å¦å¤–ï¼Œå½“æµè§ˆå™¨è®¿é—® HTTPS é€šä¿¡æœ‰æ•ˆçš„ Web ç½‘ç«™æ—¶ï¼Œæµè§ˆå™¨çš„åœ°å€æ å†…ä¼šå‡ºç°ä¸€ä¸ªå¸¦é”çš„æ ‡è®°ã€‚å¯¹ HTTPS çš„æ˜¾ç¤ºæ–¹å¼ä¼šå› æµè§ˆå™¨çš„ä¸åŒè€Œæœ‰æ‰€æ”¹å˜ã€‚</p>\n<h3 id=\"äºŒã€ä¸ºä»€ä¹ˆéœ€è¦HTTPS\"><a href=\"#äºŒã€ä¸ºä»€ä¹ˆéœ€è¦HTTPS\" class=\"headerlink\" title=\"äºŒã€ä¸ºä»€ä¹ˆéœ€è¦HTTPS\"></a>äºŒã€ä¸ºä»€ä¹ˆéœ€è¦HTTPS</h3><p>åœ¨ HTTP åè®®ä¸­æœ‰å¯èƒ½å­˜åœ¨ä¿¡æ¯çªƒå–æˆ–èº«ä»½ä¼ªè£…ç­‰å®‰å…¨é—®é¢˜ã€‚ä½¿ç”¨ HTTPS é€šä¿¡æœºåˆ¶å¯ä»¥æœ‰æ•ˆåœ°é˜²æ­¢è¿™äº›é—®é¢˜ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£ä¸‹ HTTP åè®®å­˜åœ¨çš„å“ªäº›é—®é¢˜ï¼š</p>\n<ul>\n<li><p>é€šä¿¡ä½¿ç”¨æ˜æ–‡ï¼ˆä¸åŠ å¯†ï¼‰ï¼Œå†…å®¹å¯èƒ½è¢«<strong>çªƒå¬</strong> </p>\n<p>  ä¿¡æ¯åŠ å¯†ï¼šä½¿ç”¨éå¯¹ç§°åŠ å¯†ï¼ˆRSAï¼‰äº¤æ¢å¯†é’¥ï¼Œä½¿ç”¨å¯¹ç§°åŠ å¯†ï¼ˆAESï¼‰ä¼ è¾“æŠ¥æ–‡ï¼Œå…¼å¤‡å®‰å…¨ä¸æ•ˆç‡</p>\n</li>\n<li><p>æ— æ³•è¯æ˜æŠ¥æ–‡çš„å®Œæ•´æ€§ï¼Œæ‰€ä»¥å¯èƒ½é­<strong>ç¯¡æ”¹</strong> </p>\n<p>  å®Œæ•´æ€§æ ¡éªŒï¼šæ•°å­—ç­¾å</p>\n</li>\n<li><p>ä¸éªŒè¯é€šä¿¡æ–¹çš„èº«ä»½ï¼Œå› æ­¤æœ‰å¯èƒ½é­é‡<strong>ä¼ªè£…</strong> </p>\n<p>  èº«ä»½éªŒè¯ï¼šæ•°å­—è¯ä¹¦</p>\n</li>\n</ul>\n<h3 id=\"ä¸‰ã€HTTPSå¦‚ä½•è§£å†³HTTPä¸Šè¿°é—®é¢˜\"><a href=\"#ä¸‰ã€HTTPSå¦‚ä½•è§£å†³HTTPä¸Šè¿°é—®é¢˜\" class=\"headerlink\" title=\"ä¸‰ã€HTTPSå¦‚ä½•è§£å†³HTTPä¸Šè¿°é—®é¢˜?\"></a>ä¸‰ã€HTTPSå¦‚ä½•è§£å†³HTTPä¸Šè¿°é—®é¢˜?</h3><p><strong>æ‰€è°“HTTPSï¼Œå…¶å®å°±æ˜¯èº«æŠ«SSLåè®®è¿™å±‚å¤–å£³çš„HTTP</strong>ã€‚</p>\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422132445345.png\" alt=\"image-20220422132445345\" style=\"zoom:33%;\" />\n\n\n\n<p>åœ¨é‡‡ç”¨ SSL åï¼ŒHTTP å°±æ‹¥æœ‰äº† HTTPS çš„åŠ å¯†ã€å®Œæ•´æ€§æ ¡éªŒã€èº«ä»½éªŒè¯è¿™äº›åŠŸèƒ½ã€‚ä¹Ÿå°±æ˜¯è¯´<strong>HTTPåŠ ä¸ŠåŠ å¯†å¤„ç†å’Œè®¤è¯ä»¥åŠå®Œæ•´æ€§ä¿æŠ¤åå³æ˜¯HTTPS</strong>ã€‚</p>\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422132508534.png\" alt=\"image-20220422132508534\" style=\"zoom:33%;\" />\n\n<p>HTTPS åè®®çš„ä¸»è¦åŠŸèƒ½åŸºæœ¬éƒ½ä¾èµ–äº TLS&#x2F;SSL åè®®ï¼ŒTLS&#x2F;SSL çš„åŠŸèƒ½å®ç°ä¸»è¦ä¾èµ–äºä¸‰ç±»åŸºæœ¬ç®—æ³•ï¼šæ•£åˆ—å‡½æ•° ã€å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†ï¼Œ<strong>å…¶åˆ©ç”¨éå¯¹ç§°åŠ å¯†å®ç°èº«ä»½è®¤è¯å’Œå¯†é’¥åå•†ï¼Œå¯¹ç§°åŠ å¯†ç®—æ³•é‡‡ç”¨åå•†çš„å¯†é’¥å¯¹æ•°æ®åŠ å¯†ï¼ŒåŸºäºæ•£åˆ—å‡½æ•°éªŒè¯ä¿¡æ¯çš„å®Œæ•´æ€§</strong>ã€‚</p>\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422132525551.png\" alt=\"image-20220422132525551\" style=\"zoom:33%;\" />\n\n\n\n<h4 id=\"1-è§£å†³å†…å®¹å¯èƒ½è¢«çªƒå¬çš„é—®é¢˜â€”â€”åŠ å¯†\"><a href=\"#1-è§£å†³å†…å®¹å¯èƒ½è¢«çªƒå¬çš„é—®é¢˜â€”â€”åŠ å¯†\" class=\"headerlink\" title=\"1.è§£å†³å†…å®¹å¯èƒ½è¢«çªƒå¬çš„é—®é¢˜â€”â€”åŠ å¯†\"></a>1.è§£å†³å†…å®¹å¯èƒ½è¢«çªƒå¬çš„é—®é¢˜â€”â€”åŠ å¯†</h4><h4 id=\"æ–¹æ³•1-å¯¹ç§°åŠ å¯†\"><a href=\"#æ–¹æ³•1-å¯¹ç§°åŠ å¯†\" class=\"headerlink\" title=\"æ–¹æ³•1.å¯¹ç§°åŠ å¯†\"></a>æ–¹æ³•1.å¯¹ç§°åŠ å¯†</h4><p>è¿™ç§æ–¹å¼åŠ å¯†å’Œè§£å¯†åŒç”¨ä¸€ä¸ªå¯†é’¥ã€‚åŠ å¯†å’Œè§£å¯†éƒ½ä¼šç”¨åˆ°å¯†é’¥ã€‚<strong>æ²¡æœ‰å¯†é’¥å°±æ— æ³•å¯¹å¯†ç è§£å¯†ï¼Œåè¿‡æ¥è¯´ï¼Œä»»ä½•äººåªè¦æŒæœ‰å¯†é’¥å°±èƒ½è§£å¯†äº†</strong>ã€‚</p>\n<p>ä»¥å¯¹ç§°åŠ å¯†æ–¹å¼åŠ å¯†æ—¶å¿…é¡»å°†å¯†é’¥ä¹Ÿå‘ç»™å¯¹æ–¹ã€‚å¯ç©¶ç«Ÿæ€æ ·æ‰èƒ½å®‰å…¨åœ°è½¬äº¤ï¼Ÿåœ¨äº’è”ç½‘ä¸Šè½¬å‘å¯†é’¥æ—¶ï¼Œå¦‚æœé€šä¿¡è¢«ç›‘å¬é‚£ä¹ˆå¯†é’¥å°±å¯ä¼šè½äººæ”»å‡»è€…ä¹‹æ‰‹ï¼ŒåŒæ—¶ä¹Ÿå°±å¤±å»äº†åŠ å¯†çš„æ„ä¹‰ã€‚å¦å¤–è¿˜å¾—è®¾æ³•å®‰å…¨åœ°ä¿ç®¡æ¥æ”¶åˆ°çš„å¯†é’¥ã€‚</p>\n<h4 id=\"æ–¹æ³•2-éå¯¹ç§°åŠ å¯†\"><a href=\"#æ–¹æ³•2-éå¯¹ç§°åŠ å¯†\" class=\"headerlink\" title=\"æ–¹æ³•2.éå¯¹ç§°åŠ å¯†\"></a>æ–¹æ³•2.éå¯¹ç§°åŠ å¯†</h4><p>å…¬å¼€å¯†é’¥åŠ å¯†ä½¿ç”¨ä¸€å¯¹éå¯¹ç§°çš„å¯†é’¥ã€‚ä¸€æŠŠå«åšç§æœ‰å¯†é’¥ï¼Œå¦ä¸€æŠŠå«åšå…¬å¼€å¯†é’¥ã€‚é¡¾åæ€ä¹‰ï¼Œ<strong>ç§æœ‰å¯†é’¥ä¸èƒ½è®©å…¶ä»–ä»»ä½•äººçŸ¥é“ï¼Œè€Œå…¬å¼€å¯†é’¥åˆ™å¯ä»¥éšæ„å‘å¸ƒï¼Œä»»ä½•äººéƒ½å¯ä»¥è·å¾—</strong>ã€‚</p>\n<p>ä½¿ç”¨å…¬å¼€å¯†é’¥åŠ å¯†æ–¹å¼ï¼Œå‘é€å¯†æ–‡çš„ä¸€æ–¹ä½¿ç”¨<strong>å¯¹æ–¹çš„å…¬å¼€å¯†é’¥</strong>è¿›è¡ŒåŠ å¯†å¤„ç†ï¼Œå¯¹æ–¹æ”¶åˆ°è¢«åŠ å¯†çš„ä¿¡æ¯åï¼Œå†ä½¿ç”¨è‡ªå·±çš„ç§æœ‰å¯†é’¥è¿›è¡Œè§£å¯†ã€‚åˆ©ç”¨è¿™ç§æ–¹å¼ï¼Œä¸éœ€è¦å‘é€ç”¨æ¥è§£å¯†çš„ç§æœ‰å¯†é’¥ï¼Œä¹Ÿä¸å¿…æ‹…å¿ƒå¯†é’¥è¢«æ”»å‡»è€…çªƒå¬è€Œç›—èµ°ã€‚</p>\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422132541737.png\" alt=\"image-20220422132541737\" style=\"zoom:33%;\" />\n\n<p>éå¯¹ç§°åŠ å¯†çš„ç‰¹ç‚¹æ˜¯ä¿¡æ¯ä¼ è¾“ä¸€å¯¹å¤šï¼ŒæœåŠ¡å™¨åªéœ€è¦ç»´æŒä¸€ä¸ªç§é’¥å°±èƒ½å¤Ÿå’Œå¤šä¸ªå®¢æˆ·ç«¯è¿›è¡ŒåŠ å¯†é€šä¿¡ã€‚</p>\n<p>è¿™ç§æ–¹å¼æœ‰ä»¥ä¸‹ç¼ºç‚¹ï¼š</p>\n<ul>\n<li>å…¬é’¥æ˜¯å…¬å¼€çš„ï¼Œæ‰€ä»¥é’ˆå¯¹ç§é’¥åŠ å¯†çš„ä¿¡æ¯ï¼Œé»‘å®¢æˆªè·åå¯ä»¥ä½¿ç”¨å…¬é’¥è¿›è¡Œè§£å¯†ï¼Œè·å–å…¶ä¸­çš„å†…å®¹ï¼›</li>\n<li>å…¬é’¥å¹¶ä¸åŒ…å«æœåŠ¡å™¨çš„ä¿¡æ¯ï¼Œä½¿ç”¨éå¯¹ç§°åŠ å¯†ç®—æ³•æ— æ³•ç¡®ä¿æœåŠ¡å™¨èº«ä»½çš„åˆæ³•æ€§ï¼Œå­˜åœ¨ä¸­é—´äººæ”»å‡»çš„é£é™©ï¼ŒæœåŠ¡å™¨å‘é€ç»™å®¢æˆ·ç«¯çš„å…¬é’¥å¯èƒ½åœ¨ä¼ é€è¿‡ç¨‹ä¸­è¢«ä¸­é—´äººæˆªè·å¹¶ç¯¡æ”¹ï¼›</li>\n<li>ä½¿ç”¨éå¯¹ç§°åŠ å¯†<strong>åœ¨æ•°æ®åŠ å¯†è§£å¯†è¿‡ç¨‹éœ€è¦æ¶ˆè€—ä¸€å®šæ—¶é—´</strong>ï¼Œé™ä½äº†æ•°æ®ä¼ è¾“æ•ˆç‡ï¼›</li>\n</ul>\n<h4 id=\"æ–¹æ³•3-å¯¹ç§°åŠ å¯†-éå¯¹ç§°åŠ å¯†-HTTPSé‡‡ç”¨è¿™ç§æ–¹å¼\"><a href=\"#æ–¹æ³•3-å¯¹ç§°åŠ å¯†-éå¯¹ç§°åŠ å¯†-HTTPSé‡‡ç”¨è¿™ç§æ–¹å¼\" class=\"headerlink\" title=\"æ–¹æ³•3.å¯¹ç§°åŠ å¯†+éå¯¹ç§°åŠ å¯†(HTTPSé‡‡ç”¨è¿™ç§æ–¹å¼)\"></a>æ–¹æ³•3.å¯¹ç§°åŠ å¯†+éå¯¹ç§°åŠ å¯†(HTTPSé‡‡ç”¨è¿™ç§æ–¹å¼)</h4><p>ä½¿ç”¨å¯¹ç§°å¯†é’¥çš„å¥½å¤„æ˜¯è§£å¯†çš„æ•ˆç‡æ¯”è¾ƒå¿«ï¼Œä½¿ç”¨éå¯¹ç§°å¯†é’¥çš„å¥½å¤„æ˜¯å¯ä»¥ä½¿å¾—ä¼ è¾“çš„å†…å®¹ä¸èƒ½è¢«ç ´è§£ï¼Œå› ä¸ºå°±ç®—ä½ æ‹¦æˆªåˆ°äº†æ•°æ®ï¼Œä½†æ˜¯æ²¡æœ‰å¯¹åº”çš„ç§é’¥ï¼Œä¹Ÿæ˜¯ä¸èƒ½ç ´è§£å†…å®¹çš„ã€‚å°±æ¯”å¦‚è¯´ä½ æŠ¢åˆ°äº†ä¸€ä¸ªä¿é™©æŸœï¼Œä½†æ˜¯æ²¡æœ‰ä¿é™©æŸœçš„é’¥åŒ™ä¹Ÿä¸èƒ½æ‰“å¼€ä¿é™©æŸœã€‚é‚£æˆ‘ä»¬å°±å°†å¯¹ç§°åŠ å¯†ä¸éå¯¹ç§°åŠ å¯†ç»“åˆèµ·æ¥,å……åˆ†åˆ©ç”¨ä¸¤è€…å„è‡ªçš„ä¼˜åŠ¿ï¼Œ<strong>åœ¨äº¤æ¢å¯†é’¥ç¯èŠ‚ä½¿ç”¨éå¯¹ç§°åŠ å¯†æ–¹å¼ï¼Œä¹‹åçš„å»ºç«‹é€šä¿¡äº¤æ¢æŠ¥æ–‡é˜¶æ®µåˆ™ä½¿ç”¨å¯¹ç§°åŠ å¯†æ–¹å¼</strong>ã€‚</p>\n<p>å…·ä½“åšæ³•æ˜¯ï¼š<strong>å‘é€å¯†æ–‡çš„ä¸€æ–¹ä½¿ç”¨å¯¹æ–¹çš„å…¬é’¥è¿›è¡ŒåŠ å¯†å¤„ç†â€œå¯¹ç§°çš„å¯†é’¥â€ï¼Œç„¶åå¯¹æ–¹ç”¨è‡ªå·±çš„ç§é’¥è§£å¯†æ‹¿åˆ°â€œå¯¹ç§°çš„å¯†é’¥â€ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿äº¤æ¢çš„å¯†é’¥æ˜¯å®‰å…¨çš„å‰æä¸‹ï¼Œä½¿ç”¨å¯¹ç§°åŠ å¯†æ–¹å¼è¿›è¡Œé€šä¿¡</strong>ã€‚æ‰€ä»¥ï¼ŒHTTPS é‡‡ç”¨å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†ä¸¤è€…å¹¶ç”¨çš„æ··åˆåŠ å¯†æœºåˆ¶ã€‚</p>\n<h4 id=\"2-è§£å†³æŠ¥æ–‡å¯èƒ½é­ç¯¡æ”¹é—®é¢˜â€”â€”æ•°å­—ç­¾å\"><a href=\"#2-è§£å†³æŠ¥æ–‡å¯èƒ½é­ç¯¡æ”¹é—®é¢˜â€”â€”æ•°å­—ç­¾å\" class=\"headerlink\" title=\"2.è§£å†³æŠ¥æ–‡å¯èƒ½é­ç¯¡æ”¹é—®é¢˜â€”â€”æ•°å­—ç­¾å\"></a>2.è§£å†³æŠ¥æ–‡å¯èƒ½é­ç¯¡æ”¹é—®é¢˜â€”â€”æ•°å­—ç­¾å</h4><p>ç½‘ç»œä¼ è¾“è¿‡ç¨‹ä¸­éœ€è¦ç»è¿‡å¾ˆå¤šä¸­é—´èŠ‚ç‚¹ï¼Œè™½ç„¶æ•°æ®æ— æ³•è¢«è§£å¯†ï¼Œä½†å¯èƒ½è¢«ç¯¡æ”¹ï¼Œé‚£å¦‚ä½•æ ¡éªŒæ•°æ®çš„å®Œæ•´æ€§å‘¢ï¼Ÿâ€”-æ ¡éªŒæ•°å­—ç­¾åã€‚</p>\n<p><strong>æ•°å­—ç­¾åæœ‰ä¸¤ç§åŠŸæ•ˆ</strong>ï¼š</p>\n<ul>\n<li>èƒ½ç¡®å®šæ¶ˆæ¯ç¡®å®æ˜¯ç”±å‘é€æ–¹ç­¾åå¹¶å‘å‡ºæ¥çš„ï¼Œå› ä¸ºåˆ«äººå‡å†’ä¸äº†å‘é€æ–¹çš„ç­¾åã€‚</li>\n<li>æ•°å­—ç­¾åèƒ½ç¡®å®šæ¶ˆæ¯çš„å®Œæ•´æ€§,è¯æ˜æ•°æ®æ˜¯å¦æœªè¢«ç¯¡æ”¹è¿‡ã€‚</li>\n</ul>\n<p><strong>æ•°å­—ç­¾åå¦‚ä½•ç”Ÿæˆ:</strong></p>\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422132605229.png\" alt=\"image-20220422132605229\" style=\"zoom:33%;\" />\n\n<p>å°†ä¸€æ®µæ–‡æœ¬å…ˆç”¨ Hash å‡½æ•°ç”Ÿæˆæ¶ˆæ¯æ‘˜è¦ï¼Œç„¶åç”¨å‘é€è€…çš„ç§é’¥åŠ å¯†ç”Ÿæˆæ•°å­—ç­¾åï¼Œä¸åŸæ–‡æ–‡ä¸€èµ·ä¼ é€ç»™æ¥æ”¶è€…ã€‚æ¥ä¸‹æ¥å°±æ˜¯æ¥æ”¶è€…æ ¡éªŒæ•°å­—ç­¾åçš„æµç¨‹äº†ã€‚</p>\n<p><strong>æ ¡éªŒæ•°å­—ç­¾åæµç¨‹</strong>ï¼š</p>\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422132617982.png\" alt=\"image-20220422132617982\" style=\"zoom:33%;\" />\n\n<p>æ¥æ”¶è€…åªæœ‰ç”¨å‘é€è€…çš„å…¬é’¥æ‰èƒ½è§£å¯†è¢«åŠ å¯†çš„æ‘˜è¦ä¿¡æ¯ï¼Œç„¶åç”¨ HASH å‡½æ•°å¯¹æ”¶åˆ°çš„åŸæ–‡äº§ç”Ÿä¸€ä¸ªæ‘˜è¦ä¿¡æ¯ï¼Œä¸ä¸Šä¸€æ­¥å¾—åˆ°çš„æ‘˜è¦ä¿¡æ¯å¯¹æ¯”ã€‚å¦‚æœç›¸åŒï¼Œåˆ™è¯´æ˜æ”¶åˆ°çš„ä¿¡æ¯æ˜¯å®Œæ•´çš„ï¼Œåœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ²¡æœ‰è¢«ä¿®æ”¹ï¼Œå¦åˆ™è¯´æ˜ä¿¡æ¯è¢«ä¿®æ”¹è¿‡ï¼Œå› æ­¤æ•°å­—ç­¾åèƒ½å¤ŸéªŒè¯ä¿¡æ¯çš„å®Œæ•´æ€§ã€‚</p>\n<p>å‡è®¾æ¶ˆæ¯ä¼ é€’åœ¨ Kobeï¼ŒJames ä¸¤äººä¹‹é—´å‘ç”Ÿã€‚James å°†æ¶ˆæ¯è¿åŒæ•°å­—ç­¾åä¸€èµ·å‘é€ç»™ Kobeï¼ŒKobe æ¥æ”¶åˆ°æ¶ˆæ¯åï¼Œé€šè¿‡æ ¡éªŒæ•°å­—ç­¾åï¼Œå°±å¯ä»¥éªŒè¯æ¥æ”¶åˆ°çš„æ¶ˆæ¯å°±æ˜¯ James å‘é€çš„ã€‚å½“ç„¶ï¼Œè¿™ä¸ªè¿‡ç¨‹çš„å‰ææ˜¯ Kobe çŸ¥é“ James çš„å…¬é’¥ã€‚é—®é¢˜çš„å…³é”®çš„æ˜¯ï¼Œå’Œæ¶ˆæ¯æœ¬èº«ä¸€æ ·ï¼Œå…¬é’¥ä¸èƒ½åœ¨ä¸å®‰å…¨çš„ç½‘ç»œä¸­ç›´æ¥å‘é€ç»™ Kobe,æˆ–è€…è¯´æ‹¿åˆ°çš„å…¬é’¥å¦‚ä½•è¯æ˜æ˜¯ James çš„ã€‚</p>\n<p>æ­¤æ—¶å°±éœ€è¦å¼•å…¥äº†<strong>è¯ä¹¦é¢å‘æœºæ„</strong>ï¼ˆCertificate Authorityï¼Œç®€ç§° CAï¼‰ï¼ŒCA æ•°é‡å¹¶ä¸å¤šï¼ŒKobe å®¢æˆ·ç«¯å†…ç½®äº†æ‰€æœ‰å—ä¿¡ä»» CA çš„è¯ä¹¦ã€‚CA å¯¹ James çš„å…¬é’¥ï¼ˆå’Œå…¶ä»–ä¿¡æ¯ï¼‰æ•°å­—ç­¾ååç”Ÿæˆè¯ä¹¦ã€‚</p>\n<h4 id=\"3-è§£å†³é€šä¿¡æ–¹èº«ä»½å¯èƒ½è¢«ä¼ªè£…çš„é—®é¢˜â€”â€”æ•°å­—è¯ä¹¦\"><a href=\"#3-è§£å†³é€šä¿¡æ–¹èº«ä»½å¯èƒ½è¢«ä¼ªè£…çš„é—®é¢˜â€”â€”æ•°å­—è¯ä¹¦\" class=\"headerlink\" title=\"3.è§£å†³é€šä¿¡æ–¹èº«ä»½å¯èƒ½è¢«ä¼ªè£…çš„é—®é¢˜â€”â€”æ•°å­—è¯ä¹¦\"></a>3.è§£å†³é€šä¿¡æ–¹èº«ä»½å¯èƒ½è¢«ä¼ªè£…çš„é—®é¢˜â€”â€”æ•°å­—è¯ä¹¦</h4><p>æ•°å­—è¯ä¹¦è®¤è¯æœºæ„å¤„äºå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨åŒæ–¹éƒ½å¯ä¿¡èµ–çš„ç¬¬ä¸‰æ–¹æœºæ„çš„ç«‹åœºä¸Šã€‚</p>\n<p>æˆ‘ä»¬æ¥ä»‹ç»ä¸€ä¸‹æ•°å­—è¯ä¹¦è®¤è¯æœºæ„çš„ä¸šåŠ¡æµç¨‹ï¼š</p>\n<ul>\n<li>æœåŠ¡å™¨çš„è¿è¥äººå‘˜å‘ç¬¬ä¸‰æ–¹æœºæ„ CA æäº¤å…¬é’¥ã€ç»„ç»‡ä¿¡æ¯ã€ä¸ªäººä¿¡æ¯(åŸŸå)ç­‰ä¿¡æ¯å¹¶ç”³è¯·è®¤è¯;</li>\n<li>CA é€šè¿‡çº¿ä¸Šã€çº¿ä¸‹ç­‰å¤šç§æ‰‹æ®µéªŒè¯ç”³è¯·è€…æä¾›ä¿¡æ¯çš„çœŸå®æ€§ï¼Œå¦‚ç»„ç»‡æ˜¯å¦å­˜åœ¨ã€ä¼ä¸šæ˜¯å¦åˆæ³•ï¼Œæ˜¯å¦æ‹¥æœ‰åŸŸåçš„æ‰€æœ‰æƒç­‰;</li>\n<li>å¦‚ä¿¡æ¯å®¡æ ¸é€šè¿‡ï¼ŒCA ä¼šå‘ç”³è¯·è€…ç­¾å‘è®¤è¯æ–‡ä»¶-è¯ä¹¦ã€‚è¯ä¹¦åŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼šç”³è¯·è€…å…¬é’¥ã€ç”³è¯·è€…çš„ç»„ç»‡ä¿¡æ¯å’Œä¸ªäººä¿¡æ¯ã€ç­¾å‘æœºæ„ CA çš„ä¿¡æ¯ã€æœ‰æ•ˆæ—¶é—´ã€è¯ä¹¦åºåˆ—å·ç­‰ä¿¡æ¯çš„æ˜æ–‡ï¼ŒåŒæ—¶åŒ…å«ä¸€ä¸ªç­¾åã€‚ å…¶ä¸­ç­¾åçš„äº§ç”Ÿç®—æ³•ï¼šé¦–å…ˆï¼Œä½¿ç”¨æ•£åˆ—å‡½æ•°è®¡ç®—å…¬å¼€çš„æ˜æ–‡ä¿¡æ¯çš„ä¿¡æ¯æ‘˜è¦ï¼Œç„¶åï¼Œé‡‡ç”¨ CA çš„ç§é’¥å¯¹ä¿¡æ¯æ‘˜è¦è¿›è¡ŒåŠ å¯†ï¼Œå¯†æ–‡å³ç­¾å;</li>\n<li>å®¢æˆ·ç«¯ Client å‘æœåŠ¡å™¨ Server å‘å‡ºè¯·æ±‚æ—¶ï¼ŒServer è¿”å›è¯ä¹¦æ–‡ä»¶;</li>\n<li>å®¢æˆ·ç«¯ Client è¯»å–è¯ä¹¦ä¸­çš„ç›¸å…³çš„æ˜æ–‡ä¿¡æ¯ï¼Œé‡‡ç”¨ç›¸åŒçš„æ•£åˆ—å‡½æ•°è®¡ç®—å¾—åˆ°ä¿¡æ¯æ‘˜è¦ï¼Œç„¶åï¼Œåˆ©ç”¨å¯¹åº” CA çš„å…¬é’¥è§£å¯†ç­¾åæ•°æ®ï¼Œå¯¹æ¯”è¯ä¹¦çš„ä¿¡æ¯æ‘˜è¦ï¼Œå¦‚æœä¸€è‡´ï¼Œåˆ™å¯ä»¥ç¡®è®¤è¯ä¹¦çš„åˆæ³•æ€§ï¼Œå³æœåŠ¡å™¨çš„å…¬å¼€å¯†é’¥æ˜¯å€¼å¾—ä¿¡èµ–çš„ã€‚</li>\n<li>å®¢æˆ·ç«¯è¿˜ä¼šéªŒè¯è¯ä¹¦ç›¸å…³çš„åŸŸåä¿¡æ¯ã€æœ‰æ•ˆæ—¶é—´ç­‰ä¿¡æ¯; å®¢æˆ·ç«¯ä¼šå†…ç½®ä¿¡ä»» CA çš„è¯ä¹¦ä¿¡æ¯(åŒ…å«å…¬é’¥)ï¼Œå¦‚æœ CA ä¸è¢«ä¿¡ä»»ï¼Œåˆ™æ‰¾ä¸åˆ°å¯¹åº” CA çš„è¯ä¹¦ï¼Œè¯ä¹¦ä¹Ÿä¼šè¢«åˆ¤å®šéæ³•ã€‚</li>\n</ul>\n<h3 id=\"å››ã€-HTTPSå·¥ä½œæµç¨‹\"><a href=\"#å››ã€-HTTPSå·¥ä½œæµç¨‹\" class=\"headerlink\" title=\"å››ã€ HTTPSå·¥ä½œæµç¨‹\"></a>å››ã€ HTTPSå·¥ä½œæµç¨‹</h3><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422132710862.png\" alt=\"image-20220422132710862\" style=\"zoom:80%;\" />\n\n<p>1.Client å‘èµ·ä¸€ä¸ª HTTPSï¼ˆæ¯”å¦‚<code>https://juejin.cn/user/4283353031252967</code>ï¼‰çš„è¯·æ±‚ï¼Œæ ¹æ® RFC2818 çš„è§„å®šï¼ŒClient çŸ¥é“éœ€è¦è¿æ¥ Server çš„ 443ï¼ˆé»˜è®¤ï¼‰ç«¯å£ã€‚</p>\n<p>2.Server æŠŠäº‹å…ˆé…ç½®å¥½çš„å…¬é’¥è¯ä¹¦ï¼ˆpublic key certificateï¼‰è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</p>\n<p>3.Client éªŒè¯å…¬é’¥è¯ä¹¦ï¼šæ¯”å¦‚æ˜¯å¦åœ¨æœ‰æ•ˆæœŸå†…ï¼Œè¯ä¹¦çš„ç”¨é€”æ˜¯ä¸æ˜¯åŒ¹é… Client è¯·æ±‚çš„ç«™ç‚¹ï¼Œæ˜¯ä¸æ˜¯åœ¨ CRL åŠé”€åˆ—è¡¨é‡Œé¢ï¼Œå®ƒçš„ä¸Šä¸€çº§è¯ä¹¦æ˜¯å¦æœ‰æ•ˆï¼Œè¿™æ˜¯ä¸€ä¸ªé€’å½’çš„è¿‡ç¨‹ï¼Œç›´åˆ°éªŒè¯åˆ°æ ¹è¯ä¹¦ï¼ˆæ“ä½œç³»ç»Ÿå†…ç½®çš„ Root è¯ä¹¦æˆ–è€… Client å†…ç½®çš„ Root è¯ä¹¦ï¼‰ã€‚å¦‚æœéªŒè¯é€šè¿‡åˆ™ç»§ç»­ï¼Œä¸é€šè¿‡åˆ™æ˜¾ç¤ºè­¦å‘Šä¿¡æ¯ã€‚</p>\n<p>4.Client ä½¿ç”¨ä¼ªéšæœºæ•°ç”Ÿæˆå™¨ç”ŸæˆåŠ å¯†æ‰€ä½¿ç”¨çš„å¯¹ç§°å¯†é’¥ï¼Œç„¶åç”¨è¯ä¹¦çš„å…¬é’¥åŠ å¯†è¿™ä¸ªå¯¹ç§°å¯†é’¥ï¼Œå‘ç»™ Serverã€‚</p>\n<p>5.Server ä½¿ç”¨è‡ªå·±çš„ç§é’¥ï¼ˆprivate keyï¼‰è§£å¯†è¿™ä¸ªæ¶ˆæ¯ï¼Œå¾—åˆ°å¯¹ç§°å¯†é’¥ã€‚è‡³æ­¤ï¼ŒClient å’Œ Server åŒæ–¹éƒ½æŒæœ‰äº†ç›¸åŒçš„å¯¹ç§°å¯†é’¥ã€‚</p>\n<p>6.Server ä½¿ç”¨å¯¹ç§°å¯†é’¥åŠ å¯†â€œæ˜æ–‡å†…å®¹ Aâ€ï¼Œå‘é€ç»™ Clientã€‚</p>\n<p>7.Client ä½¿ç”¨å¯¹ç§°å¯†é’¥è§£å¯†å“åº”çš„å¯†æ–‡ï¼Œå¾—åˆ°â€œæ˜æ–‡å†…å®¹ Aâ€ã€‚</p>\n<p>8.Client å†æ¬¡å‘èµ· HTTPS çš„è¯·æ±‚ï¼Œä½¿ç”¨å¯¹ç§°å¯†é’¥åŠ å¯†è¯·æ±‚çš„â€œæ˜æ–‡å†…å®¹ Bâ€ï¼Œç„¶å Server ä½¿ç”¨å¯¹ç§°å¯†é’¥è§£å¯†å¯†æ–‡ï¼Œå¾—åˆ°â€œæ˜æ–‡å†…å®¹ Bâ€ã€‚</p>\n<h3 id=\"äº”ã€HTTP-ä¸-HTTPS-çš„åŒºåˆ«\"><a href=\"#äº”ã€HTTP-ä¸-HTTPS-çš„åŒºåˆ«\" class=\"headerlink\" title=\"äº”ã€HTTP ä¸ HTTPS çš„åŒºåˆ«\"></a>äº”ã€HTTP ä¸ HTTPS çš„åŒºåˆ«</h3><ul>\n<li><p>HTTP æ˜¯æ˜æ–‡ä¼ è¾“åè®®ï¼ŒHTTPS åè®®æ˜¯ç”± SSL+HTTP åè®®æ„å»ºçš„å¯è¿›è¡ŒåŠ å¯†ä¼ è¾“ã€èº«ä»½è®¤è¯çš„ç½‘ç»œåè®®ï¼Œæ¯” HTTP åè®®å®‰å…¨ã€‚</p>\n</li>\n<li><p>HTTPS æ¯” HTTP æ›´åŠ å®‰å…¨;</p>\n</li>\n<li><p>HTTPS éœ€è¦ç”¨åˆ° SSL è¯ä¹¦ï¼Œè€Œ HTTP ä¸ç”¨;</p>\n</li>\n<li><p>HTTPS æ ‡å‡†ç«¯å£ 443ï¼ŒHTTP æ ‡å‡†ç«¯å£ 80;</p>\n</li>\n<li><p>HTTPS åŸºäºä¼ è¾“å±‚ï¼ŒHTTP åŸºäºåº”ç”¨å±‚;</p>\n</li>\n<li><p>HTTPS åœ¨æµè§ˆå™¨æ˜¾ç¤ºç»¿è‰²å®‰å…¨é”ï¼ŒHTTP æ²¡æœ‰æ˜¾ç¤º;</p>\n</li>\n</ul>\n<h3 id=\"å…­ã€ä¸ºä½•ä¸æ‰€æœ‰çš„ç½‘ç«™éƒ½ä½¿ç”¨HTTPS\"><a href=\"#å…­ã€ä¸ºä½•ä¸æ‰€æœ‰çš„ç½‘ç«™éƒ½ä½¿ç”¨HTTPS\" class=\"headerlink\" title=\"å…­ã€ä¸ºä½•ä¸æ‰€æœ‰çš„ç½‘ç«™éƒ½ä½¿ç”¨HTTPS\"></a>å…­ã€ä¸ºä½•ä¸æ‰€æœ‰çš„ç½‘ç«™éƒ½ä½¿ç”¨HTTPS</h3><p>æ—¢ç„¶ HTTPS é‚£ä¹ˆå®‰å…¨å¯é ï¼Œé‚£ä¸ºä½•ä¸æ‰€æœ‰çš„ Web ç½‘ç«™éƒ½ä½¿ç”¨ HTTPSï¼Ÿ</p>\n<p>é¦–å…ˆï¼Œå¾ˆå¤šäººè¿˜æ˜¯ä¼šè§‰å¾— HTTPS å®æ–½æœ‰é—¨æ§›ï¼Œè¿™ä¸ªé—¨æ§›åœ¨äºéœ€è¦æƒå¨ CA é¢å‘çš„ SSL è¯ä¹¦ã€‚ä»è¯ä¹¦çš„é€‰æ‹©ã€è´­ä¹°åˆ°éƒ¨ç½²ï¼Œä¼ ç»Ÿçš„æ¨¡å¼ä¸‹éƒ½ä¼šæ¯”è¾ƒè€—æ—¶è€—åŠ›ã€‚</p>\n<p>å…¶æ¬¡ï¼ŒHTTPS æ™®éè®¤ä¸ºæ€§èƒ½æ¶ˆè€—è¦å¤§äº HTTPï¼Œå› ä¸º<strong>ä¸çº¯æ–‡æœ¬é€šä¿¡ç›¸æ¯”ï¼ŒåŠ å¯†é€šä¿¡ä¼šæ¶ˆè€—æ›´å¤šçš„CPUåŠå†…å­˜èµ„æº</strong>ã€‚å¦‚æœæ¯æ¬¡é€šä¿¡éƒ½åŠ å¯†ï¼Œä¼šæ¶ˆè€—ç›¸å½“å¤šçš„èµ„æºï¼Œå¹³æ‘Šåˆ°ä¸€å°è®¡ç®—æœºä¸Šæ—¶ï¼Œèƒ½å¤Ÿå¤„ç†çš„è¯·æ±‚æ•°é‡å¿…å®šä¹Ÿä¼šéšä¹‹å‡å°‘ã€‚ä½†äº‹å®å¹¶éå¦‚æ­¤ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡æ€§èƒ½ä¼˜åŒ–ã€æŠŠè¯ä¹¦éƒ¨ç½²åœ¨ SLB æˆ– CDNï¼Œæ¥è§£å†³æ­¤é—®é¢˜ã€‚ä¸¾ä¸ªå®é™…çš„ä¾‹å­ï¼Œâ€œåŒåä¸€â€æœŸé—´ï¼Œå…¨ç«™ HTTPS çš„æ·˜å®ã€å¤©çŒ«ä¾ç„¶ä¿è¯äº†ç½‘ç«™å’Œç§»åŠ¨ç«¯çš„è®¿é—®ã€æµè§ˆã€äº¤æ˜“ç­‰æ“ä½œçš„é¡ºç•…ã€å¹³æ»‘ã€‚é€šè¿‡æµ‹è¯•å‘ç°ï¼Œç»è¿‡ä¼˜åŒ–åçš„è®¸å¤šé¡µé¢æ€§èƒ½ä¸ HTTP æŒå¹³ç”šè‡³è¿˜æœ‰å°å¹…æå‡ï¼Œå› æ­¤ HTTPS ç»è¿‡ä¼˜åŒ–ä¹‹åå…¶å®å¹¶ä¸æ…¢ã€‚</p>\n<p>é™¤æ­¤ä¹‹å¤–ï¼Œ<strong>æƒ³è¦èŠ‚çº¦è´­ä¹°è¯ä¹¦çš„å¼€é”€ä¹Ÿæ˜¯åŸå› ä¹‹ä¸€</strong>ã€‚è¦è¿›è¡Œ HTTPS é€šä¿¡ï¼Œè¯ä¹¦æ˜¯å¿…ä¸å¯å°‘çš„ã€‚è€Œä½¿ç”¨çš„è¯ä¹¦å¿…é¡»å‘è®¤è¯æœºæ„ï¼ˆCAï¼‰è´­ä¹°ã€‚</p>\n<p>æœ€åæ˜¯å®‰å…¨æ„è¯†ã€‚ç›¸æ¯”å›½å†…ï¼Œå›½å¤–äº’è”ç½‘è¡Œä¸šçš„å®‰å…¨æ„è¯†å’ŒæŠ€æœ¯åº”ç”¨ç›¸å¯¹æˆç†Ÿï¼ŒHTTPS éƒ¨ç½²è¶‹åŠ¿æ˜¯ç”±ç¤¾ä¼šã€ä¼ä¸šã€æ”¿åºœå…±åŒå»æ¨åŠ¨çš„ã€‚</p>\n<h2 id=\"è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„\"><a href=\"#è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„\" class=\"headerlink\" title=\"è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„\"></a>è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„</h2><h3 id=\"ä»€ä¹ˆæ˜¯ç½‘ç»œç¼–ç¨‹\"><a href=\"#ä»€ä¹ˆæ˜¯ç½‘ç»œç¼–ç¨‹\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ç½‘ç»œç¼–ç¨‹\"></a>ä»€ä¹ˆæ˜¯ç½‘ç»œç¼–ç¨‹</h3><p>ç½‘ç»œç¼–ç¨‹çš„æœ¬è´¨æ˜¯å¤šå°è®¡ç®—æœºä¹‹é—´çš„æ•°æ®äº¤æ¢ã€‚ç°åœ¨çš„ç½‘ç»œç¼–ç¨‹åŸºæœ¬ä¸Šéƒ½æ˜¯åŸºäºè¯·æ±‚&#x2F;å“åº”æ–¹å¼çš„ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªè®¾å¤‡å‘é€è¯·æ±‚æ•°æ®ç»™å¦å¤–ä¸€ä¸ªï¼Œç„¶åæ¥æ”¶å¦ä¸€ä¸ªè®¾å¤‡çš„åé¦ˆã€‚åœ¨ç½‘ç»œç¼–ç¨‹ä¸­ï¼Œå‘èµ·è¿æ¥ç¨‹åºï¼Œä¹Ÿå°±æ˜¯å‘é€ç¬¬ä¸€æ¬¡è¯·æ±‚çš„ç¨‹åºï¼Œè¢«ç§°ä½œå®¢æˆ·ç«¯(Client)ï¼Œç­‰å¾…å…¶ä»–ç¨‹åºè¿æ¥çš„ç¨‹åºè¢«ç§°ä½œæœåŠ¡å™¨(Server)ã€‚å®¢æˆ·ç«¯ç¨‹åºå¯ä»¥åœ¨éœ€è¦çš„æ—¶å€™å¯åŠ¨ï¼Œè€ŒæœåŠ¡å™¨ä¸ºäº†èƒ½å¤Ÿæ—¶åˆ»å“åº”è¿æ¥ï¼Œåˆ™éœ€è¦ä¸€ç›´å¯åŠ¨ã€‚</p>\n<h3 id=\"ç½‘ç»œç¼–ç¨‹ä¸­ä¸¤ä¸ªä¸»è¦çš„é—®é¢˜\"><a href=\"#ç½‘ç»œç¼–ç¨‹ä¸­ä¸¤ä¸ªä¸»è¦çš„é—®é¢˜\" class=\"headerlink\" title=\"ç½‘ç»œç¼–ç¨‹ä¸­ä¸¤ä¸ªä¸»è¦çš„é—®é¢˜\"></a>ç½‘ç»œç¼–ç¨‹ä¸­ä¸¤ä¸ªä¸»è¦çš„é—®é¢˜</h3><p><strong>1ã€</strong>ä¸€ä¸ªæ˜¯å¦‚ä½•å‡†ç¡®çš„å®šä½ç½‘ç»œä¸Šä¸€å°æˆ–å¤šå°ä¸»æœºï¼Œ</p>\n<p><strong>2ã€</strong>å¦ä¸€ä¸ªå°±æ˜¯æ‰¾åˆ°ä¸»æœºåå¦‚ä½•å¯é é«˜æ•ˆçš„è¿›è¡Œæ•°æ®ä¼ è¾“ã€‚</p>\n<ul>\n<li>åœ¨ TCP&#x2F;IP åè®®ä¸­ IP å±‚ç½‘é™…å±‚ä¸»è¦è´Ÿè´£ç½‘ç»œä¸»æœºçš„å®šä½ï¼Œæ•°æ®ä¼ è¾“çš„è·¯ç”±ï¼Œç”± IP åœ°å€å¯ä»¥å”¯ä¸€åœ°ç¡®å®š Internet ä¸Šçš„ä¸€å°ä¸»æœºã€‚</li>\n<li>è€Œ TCP å±‚ä¼ è¾“å±‚åˆ™æä¾›é¢å‘åº”ç”¨çš„å¯é ï¼ˆTCPï¼‰çš„æˆ–éå¯é ï¼ˆUDPï¼‰çš„æ•°æ®ä¼ è¾“æœºåˆ¶ï¼Œè¿™æ˜¯ç½‘ç»œç¼–ç¨‹çš„ä¸»è¦å¯¹è±¡ï¼Œä¸€èˆ¬ä¸éœ€è¦å…³å¿ƒ IP å±‚æ˜¯å¦‚ä½•å¤„ç†æ•°æ®çš„ã€‚</li>\n</ul>\n<h3 id=\"ç½‘ç»œåè®®æ˜¯ä»€ä¹ˆ\"><a href=\"#ç½‘ç»œåè®®æ˜¯ä»€ä¹ˆ\" class=\"headerlink\" title=\"ç½‘ç»œåè®®æ˜¯ä»€ä¹ˆ\"></a>ç½‘ç»œåè®®æ˜¯ä»€ä¹ˆ</h3><p>åœ¨è®¡ç®—æœºç½‘ç»œè¦åšåˆ°äº•äº•æœ‰æ¡çš„äº¤æ¢æ•°æ®ï¼Œå°±å¿…é¡»éµå®ˆä¸€äº›äº‹å…ˆçº¦å®šå¥½çš„è§„åˆ™ï¼Œæ¯”å¦‚äº¤æ¢æ•°æ®çš„æ ¼å¼ã€æ˜¯å¦éœ€è¦å‘é€ä¸€ä¸ªåº”ç­”ä¿¡æ¯ã€‚è¿™äº›è§„åˆ™è¢«ç§°ä¸ºç½‘ç»œåè®®ã€‚</p>\n<h3 id=\"ä¸ºä»€ä¹ˆè¦å¯¹ç½‘ç»œåè®®åˆ†å±‚\"><a href=\"#ä¸ºä»€ä¹ˆè¦å¯¹ç½‘ç»œåè®®åˆ†å±‚\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆè¦å¯¹ç½‘ç»œåè®®åˆ†å±‚\"></a>ä¸ºä»€ä¹ˆè¦å¯¹ç½‘ç»œåè®®åˆ†å±‚</h3><p><strong>1ã€</strong>ç®€åŒ–é—®é¢˜éš¾åº¦å’Œå¤æ‚åº¦ã€‚ç”±äºå„å±‚ä¹‹é—´ç‹¬ç«‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†å‰²å¤§é—®é¢˜ä¸ºå°é—®é¢˜ã€‚</p>\n<p><strong>2ã€</strong>çµæ´»æ€§å¥½ã€‚å½“å…¶ä¸­ä¸€å±‚çš„æŠ€æœ¯å˜åŒ–æ—¶ï¼Œåªè¦å±‚é—´æ¥å£å…³ç³»ä¿æŒä¸å˜ï¼Œå…¶ä»–å±‚ä¸å—å½±å“ã€‚</p>\n<p><strong>3ã€</strong>æ˜“äºå®ç°å’Œç»´æŠ¤ã€‚</p>\n<p><strong>4ã€</strong>ä¿ƒè¿›æ ‡å‡†åŒ–å·¥ä½œã€‚åˆ†å¼€åï¼Œæ¯å±‚åŠŸèƒ½å¯ä»¥ç›¸å¯¹ç®€å•åœ°è¢«æè¿°</p>\n<h3 id=\"ä½“ç³»ç»“æ„\"><a href=\"#ä½“ç³»ç»“æ„\" class=\"headerlink\" title=\"ä½“ç³»ç»“æ„\"></a>ä½“ç³»ç»“æ„</h3><p><strong>TCP&#x2F;IPå‚è€ƒæ¨¡å‹</strong></p>\n<p>OSI ä¸ƒå±‚åè®®ï¼šåº”ç”¨ï¼ˆHTTPï¼‰ã€è¡¨ç¤ºï¼ˆSSL&#x2F;TLSï¼‰ã€ä¼šè¯ï¼ˆRPCï¼‰ã€ä¼ è¾“ï¼ˆTCPï¼‰ã€ç½‘ç»œï¼ˆIPï¼‰ã€é“¾è·¯ï¼ˆARPï¼‰ã€ç‰©ç†</p>\n<p>TCP&#x2F;IP å››å±‚åè®®ï¼ˆæ•°æ®é“¾è·¯å±‚ã€ç½‘ç»œå±‚ã€ä¼ è¾“å±‚ã€åº”ç”¨å±‚ï¼‰</p>\n<p><strong>1ã€</strong>åº”ç”¨å±‚ <strong>ä¸ºç”¨æˆ·æä¾›å„ç§ç½‘ç»œæœåŠ¡</strong>ã€‚æˆ‘ä»¬å¸¸è§åº”ç”¨å±‚çš„ç½‘ç»œæœåŠ¡åè®®æœ‰ï¼šHTTPï¼ŒHTTPSï¼ŒFTPï¼ŒTELNET ç­‰ã€‚ï¼ˆHTTP åè®®å…¨ç§° Hyper Text Transfer Protocol è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œåœ¨æµè§ˆå™¨ä¸æœåŠ¡å™¨é—´ä¼ é€æ–‡æ¡£ï¼‰</p>\n<p><strong>2ã€</strong>ä¼ è¾“å±‚ <strong>å»ºç«‹äº†ä¸»æœºç«¯åˆ°ç«¯çš„è¿æ¥</strong>ï¼Œä¼ è¾“å±‚çš„ä½œç”¨æ˜¯<strong>ä¸ºä¸Šå±‚åè®®æä¾›ç«¯åˆ°ç«¯çš„å¯é å’Œé€æ˜çš„æ•°æ®ä¼ è¾“æœåŠ¡</strong>ï¼ŒåŒ…æ‹¬å¤„ç†å·®é”™æ§åˆ¶å’Œæµé‡æ§åˆ¶ç­‰é—®é¢˜ã€‚ï¼ˆTCPã€UDPï¼‰</p>\n<p><strong>3ã€</strong>ç½‘ç»œå±‚ <strong>é€šè¿‡IPå¯»å€æ¥å»ºç«‹ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„è¿æ¥</strong>ï¼Œä¸ºæºç«¯çš„è¿è¾“å±‚é€æ¥çš„åˆ†ç»„ï¼Œé€‰æ‹©åˆé€‚çš„è·¯ç”±å’Œäº¤æ¢èŠ‚ç‚¹ï¼Œæ­£ç¡®æ— è¯¯åœ°æŒ‰ç…§åœ°å€ä¼ é€ç»™ç›®çš„ç«¯çš„è¿è¾“å±‚ã€‚ï¼ˆIPï¼‰</p>\n<p><strong>4ã€</strong>æ•°æ®é“¾è·¯å±‚ <strong>é€šè¿‡ä¸€äº›è§„åˆ™æ¥æ§åˆ¶è¿™äº›æ•°æ®çš„ä¼ è¾“</strong>ï¼Œä»¥ä¿è¯è¢«ä¼ è¾“æ•°æ®çš„æ­£ç¡®æ€§ã€‚å®ç°è¿™äº›è§„ç¨‹æˆ–åè®®çš„ç¡¬ä»¶å’Œè½¯ä»¶åŠ åˆ°ç‰©ç†çº¿è·¯ï¼Œè¿™æ ·å°±æ„æˆäº†æ•°æ®é“¾è·¯ã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯TCPå’ŒUDP\"><a href=\"#ä»€ä¹ˆæ˜¯TCPå’ŒUDP\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯TCPå’ŒUDP\"></a>ä»€ä¹ˆæ˜¯TCPå’ŒUDP</h3><table>\n<thead>\n<tr>\n<th></th>\n<th>TCP</th>\n<th>UDP</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>é¢å‘è¿æ¥</td>\n<td>é¢å‘è¿æ¥</td>\n<td>æ— è¿æ¥</td>\n</tr>\n<tr>\n<td>å¯é æ€§</td>\n<td>å¯é ä¼ è¾“ï¼Œä½¿ç”¨æ‹¥å¡æ§åˆ¶å’Œæµé‡æ§åˆ¶</td>\n<td>å¯é ä¼ è¾“</td>\n</tr>\n<tr>\n<td>è¿æ¥ä¸ªæ•°</td>\n<td>åªèƒ½ä¸€å¯¹ä¸€é€šä¿¡</td>\n<td>æ”¯æŒä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šã€å¤šå¯¹ä¸€ã€å¤šå¯¹å¤šé€šä¿¡</td>\n</tr>\n<tr>\n<td>ä½¿ç”¨åœºæ™¯</td>\n<td>è¦æ±‚å¯é ä¼ è¾“çš„åº”ç”¨ï¼ˆæ–‡ä»¶ä¼ è¾“ï¼‰</td>\n<td>å®æ—¶åº”ç”¨ï¼ˆè§†é¢‘ä¼šè®®ã€ç½‘ç»œç›´æ’­ï¼‰</td>\n</tr>\n</tbody></table>\n<h3 id=\"æµè§ˆå™¨ä¸­è¾“å…¥ï¼šç½‘å€åéƒ½å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿè¯·è¯¦ç»†é˜è¿°ã€‚\"><a href=\"#æµè§ˆå™¨ä¸­è¾“å…¥ï¼šç½‘å€åéƒ½å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿè¯·è¯¦ç»†é˜è¿°ã€‚\" class=\"headerlink\" title=\"æµè§ˆå™¨ä¸­è¾“å…¥ï¼šç½‘å€åéƒ½å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿè¯·è¯¦ç»†é˜è¿°ã€‚\"></a>æµè§ˆå™¨ä¸­è¾“å…¥ï¼šç½‘å€åéƒ½å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿè¯·è¯¦ç»†é˜è¿°ã€‚</h3><p><strong>1ã€</strong>åŸŸåè§£æï¼ŒåŸŸåâ†’IP åœ°å€ï¼Œè§£æè¿‡ç¨‹ä¾æ¬¡ç»è¿‡äº†æµè§ˆå™¨æœ¬åœ°ç¼“å­˜ã€ç³»ç»Ÿç¼“å­˜ã€hosts æ–‡ä»¶ã€è·¯ç”±å™¨ç¼“å­˜ã€ é€’å½’æœç´¢æ ¹åŸŸåæœåŠ¡å™¨ã€‚</p>\n<p><strong>2ã€</strong>å»ºç«‹ TCP&#x2F;IP è¿æ¥ï¼ˆä¸‰æ¬¡æ¡æ‰‹å…·ä½“è¿‡ç¨‹ï¼‰</p>\n<p><strong>3ã€</strong>ç”±æµè§ˆå™¨å‘é€ä¸€ä¸ª HTTP è¯·æ±‚</p>\n<p><strong>4ã€</strong>ç»è¿‡è·¯ç”±å™¨çš„è½¬å‘ï¼Œé€šè¿‡æœåŠ¡å™¨çš„é˜²ç«å¢™ï¼Œè¯¥ HTTP è¯·æ±‚åˆ°è¾¾äº†æœåŠ¡å™¨</p>\n<p><strong>5ã€</strong>æœåŠ¡å™¨å¤„ç†è¯¥ HTTP è¯·æ±‚ï¼Œè¿”å›ä¸€ä¸ª HTML æ–‡ä»¶</p>\n<p><strong>6ã€</strong>æµè§ˆå™¨è§£æè¯¥ HTML æ–‡ä»¶ï¼Œå¹¶ä¸”æ˜¾ç¤ºåœ¨æµè§ˆå™¨ç«¯</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640.webp\" alt=\"å›¾ç‰‡\"></p>\n<h3 id=\"TCP-åè®®å¦‚ä½•æ¥ä¿è¯ä¼ è¾“çš„å¯é æ€§\"><a href=\"#TCP-åè®®å¦‚ä½•æ¥ä¿è¯ä¼ è¾“çš„å¯é æ€§\" class=\"headerlink\" title=\"TCP åè®®å¦‚ä½•æ¥ä¿è¯ä¼ è¾“çš„å¯é æ€§\"></a>TCP åè®®å¦‚ä½•æ¥ä¿è¯ä¼ è¾“çš„å¯é æ€§</h3><p><strong>å¯¹äºå¯é æ€§ï¼ŒTCPé€šè¿‡ä»¥ä¸‹æ–¹å¼è¿›è¡Œä¿è¯ï¼š</strong></p>\n<blockquote>\n<p>æ¥æ”¶æ–¹å¯¹æ•°æ®åŒ…è¿›è¡Œæ£€æŸ¥ï¼Œæ˜¯å¦<strong>å¤±åº</strong>ï¼Œå¤±åºçš„è¯è¦é‡æ’åºï¼Œæ˜¯å¦<strong>é‡å¤</strong>ï¼Œé‡å¤çš„è¯å°†é‡å¤çš„æ•°æ®ä¸¢å¼ƒï¼Œæ˜¯å¦<strong>å‡ºé”™</strong>ï¼Œå‡ºé”™çš„è¯å°†è¯¥æŠ¥æ–‡æ®µä¸¢å¼ƒã€‚å¦åˆ™çš„è¯ï¼Œæ¥æ”¶æ–¹ä¼šç»™å‘é€æ–¹ä¸€ä¸ªå‘é€ä¸€ä¸ªç¡®è®¤ã€‚å‘é€æ–¹å‘é€ä¹‹åå¦‚æœæ²¡æœ‰æ”¶åˆ°è¿™ä¸ªç¡®è®¤åœ¨ä¸€å®šæ—¶é—´åä¼šé‡å‘è¿™ä¸ªæŠ¥æ–‡æ®µã€‚</p>\n</blockquote>\n<ul>\n<li><strong>æ•°æ®åŒ…æ ¡éªŒ</strong>ï¼šç›®çš„æ˜¯æ£€æµ‹æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­çš„ä»»ä½•å˜åŒ–ï¼Œè‹¥æ ¡éªŒå‡ºåŒ…æœ‰é”™ï¼Œåˆ™ä¸¢å¼ƒæŠ¥æ–‡æ®µå¹¶ä¸”ä¸ç»™å‡ºå“åº”ï¼Œè¿™æ—¶ TCP å‘é€æ•°æ®ç«¯è¶…æ—¶åä¼šé‡å‘æ•°æ®ï¼›</li>\n<li><strong>å¯¹å¤±åºæ•°æ®åŒ…é‡æ’åº</strong>ï¼šæ—¢ç„¶ TCP æŠ¥æ–‡æ®µä½œä¸º IP æ•°æ®æŠ¥æ¥ä¼ è¾“ï¼Œè€Œ IP æ•°æ®æŠ¥çš„åˆ°è¾¾å¯èƒ½ä¼šå¤±åºï¼Œå› æ­¤ TCP æŠ¥æ–‡æ®µçš„åˆ°è¾¾ä¹Ÿå¯èƒ½ä¼šå¤±åºã€‚TCP å°†å¯¹å¤±åºæ•°æ®è¿›è¡Œé‡æ–°æ’åºï¼Œç„¶åæ‰äº¤ç»™åº”ç”¨å±‚ï¼›</li>\n<li><strong>ä¸¢å¼ƒé‡å¤æ•°æ®</strong>ï¼šå¯¹äºé‡å¤æ•°æ®ï¼Œèƒ½å¤Ÿä¸¢å¼ƒé‡å¤æ•°æ®ï¼›</li>\n<li><strong>åº”ç­”æœºåˆ¶</strong>ï¼šå½“ TCP æ”¶åˆ°å‘è‡ª TCP è¿æ¥å¦ä¸€ç«¯çš„æ•°æ®ï¼Œå®ƒå°†å‘é€ä¸€ä¸ªç¡®è®¤ã€‚è¿™ä¸ªç¡®è®¤ä¸æ˜¯ç«‹å³å‘é€ï¼Œé€šå¸¸å°†æ¨è¿Ÿå‡ åˆ†ä¹‹ä¸€ç§’ï¼›</li>\n<li><strong>è¶…æ—¶é‡å‘</strong>ï¼šå½“ TCP å‘å‡ºä¸€ä¸ªæ®µåï¼Œå®ƒå¯åŠ¨ä¸€ä¸ªå®šæ—¶å™¨ï¼Œç­‰å¾…ç›®çš„ç«¯ç¡®è®¤æ”¶åˆ°è¿™ä¸ªæŠ¥æ–‡æ®µã€‚å¦‚æœä¸èƒ½åŠæ—¶æ”¶åˆ°ä¸€ä¸ªç¡®è®¤ï¼Œå°†é‡å‘è¿™ä¸ªæŠ¥æ–‡æ®µï¼›</li>\n<li><strong>æµé‡æ§åˆ¶</strong>ï¼šTCP è¿æ¥çš„æ¯ä¸€æ–¹éƒ½æœ‰å›ºå®šå¤§å°çš„ç¼“å†²ç©ºé—´ã€‚TCP çš„æ¥æ”¶ç«¯åªå…è®¸å¦ä¸€ç«¯å‘é€æ¥æ”¶ç«¯ç¼“å†²åŒºæ‰€èƒ½æ¥çº³çš„æ•°æ®ï¼Œè¿™å¯ä»¥é˜²æ­¢è¾ƒå¿«ä¸»æœºè‡´ä½¿è¾ƒæ…¢ä¸»æœºçš„ç¼“å†²åŒºæº¢å‡ºï¼Œè¿™å°±æ˜¯æµé‡æ§åˆ¶ã€‚<br>  TCP ä½¿ç”¨çš„æµé‡æ§åˆ¶åè®®æ˜¯<strong>å¯å˜å¤§å°çš„æ»‘åŠ¨çª—å£åè®®</strong>ã€‚</li>\n</ul>\n<h3 id=\"TCP-çš„æ‹¥å¡é¿å…æœºåˆ¶\"><a href=\"#TCP-çš„æ‹¥å¡é¿å…æœºåˆ¶\" class=\"headerlink\" title=\"TCP çš„æ‹¥å¡é¿å…æœºåˆ¶\"></a>TCP çš„æ‹¥å¡é¿å…æœºåˆ¶</h3><p><a href=\"https://www.cnblogs.com/hongdada/p/11206679.html\">https://www.cnblogs.com/hongdada/p/11206679.html</a></p>\n<p>æ‹¥å¡ï¼šå¯¹èµ„æºçš„éœ€æ±‚è¶…è¿‡äº†å¯ç”¨çš„èµ„æºã€‚è‹¥ç½‘ç»œä¸­è®¸å¤šèµ„æºåŒæ—¶ä¾›åº”ä¸è¶³ï¼Œç½‘ç»œçš„æ€§èƒ½å°±è¦æ˜æ˜¾å˜åï¼Œæ•´ä¸ªç½‘ç»œçš„ååé‡éšç€è´Ÿè·çš„å¢å¤§è€Œä¸‹é™ã€‚</p>\n<p>æ‹¥å¡æ§åˆ¶ï¼šé˜²æ­¢è¿‡å¤šçš„æ•°æ®æ³¨å…¥åˆ°ç½‘ç»œä¸­ï¼Œä½¿å¾—ç½‘ç»œä¸­çš„è·¯ç”±å™¨æˆ–é“¾è·¯ä¸è‡´è¿‡è½½ã€‚</p>\n<p>æ‹¥å¡æ§åˆ¶çš„æ–¹æ³•ï¼š</p>\n<p><strong>1ã€ æ…¢å¼€å§‹ + æ‹¥å¡é¿å…ï¼š</strong></p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes443934-20190718131944933-703202720.png\" alt=\"img\"></p>\n<p><strong>æ…¢å¼€å§‹</strong>ï¼šæ‹¥å¡çª—å£ä» 1ã€2ã€4 ä»¥æŒ‡æ•°è§„å¾‹å¢é•¿ï¼›</p>\n<p><strong>æ‹¥å¡é¿å…</strong>ï¼šåˆ°è¾¾æ…¢å¼€å§‹é˜ˆå€¼åï¼Œå¼€å§‹æ‹¥å¡é¿å…â€œåŠ æ³•å¢å¤§â€</p>\n<p><strong>2ã€å¿«é‡ä¼  + å¿«æ¢å¤ï¼š</strong><br><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes443934-20190718132020300-1269239957.png\" alt=\"img\"></p>\n<p><strong>å¿«é‡ä¼ </strong>ï¼š **å¿«é‡ä¼ è¦æ±‚æ¥æ”¶æ–¹åœ¨æ”¶åˆ°ä¸€ä¸ªå¤±åºçš„æŠ¥æ–‡æ®µåå°±ç«‹å³å‘å‡º é‡å¤ç¡®è®¤ **ï¼ˆä¸ºçš„æ˜¯ä½¿å‘é€æ–¹åŠæ—©çŸ¥é“æœ‰æŠ¥æ–‡æ®µæ²¡æœ‰åˆ°è¾¾å¯¹æ–¹ï¼‰è€Œä¸è¦ç­‰åˆ°è‡ªå·±å‘é€æ•°æ®æ—¶æå¸¦ç¡®è®¤ã€‚å¿«é‡ä¼ ç®—æ³•è§„å®šï¼Œ <strong>å‘é€æ–¹åªè¦ä¸€è¿æ”¶åˆ°ä¸‰ä¸ªé‡å¤ç¡®è®¤å°±åº”å½“ç«‹å³é‡ä¼ å¯¹æ–¹å°šæœªæ”¶åˆ°çš„æŠ¥æ–‡æ®µ</strong>ï¼Œè€Œä¸å¿…ç»§ç»­ç­‰å¾…è®¾ç½®çš„é‡ä¼ è®¡æ—¶å™¨æ—¶é—´åˆ°æœŸã€‚</p>\n<p><strong>å¿«æ¢å¤</strong>ï¼šå¿«é‡ä¼ é…åˆä½¿ç”¨çš„è¿˜æœ‰å¿«æ¢å¤ç®—æ³•ï¼Œå½“å‘é€æ–¹è¿ç»­æ”¶åˆ°ä¸‰ä¸ªé‡å¤ç¡®è®¤æ—¶ï¼Œå°±æ‰§è¡Œ<strong>â€œä¹˜æ³•å‡å°â€ç®—æ³•ï¼ŒæŠŠ ssthresh é—¨é™å‡åŠ</strong>ï¼Œä½†æ˜¯æ¥ä¸‹å»å¹¶ä¸æ‰§è¡Œæ…¢å¼€å§‹ç®—æ³•ï¼šå› ä¸ºå¦‚æœç½‘ç»œå‡ºç°æ‹¥å¡çš„è¯å°±ä¸ä¼šæ”¶åˆ°å¥½å‡ ä¸ªé‡å¤çš„ç¡®è®¤ï¼Œæ‰€ä»¥å‘é€æ–¹ç°åœ¨è®¤ä¸ºç½‘ç»œå¯èƒ½æ²¡æœ‰å‡ºç°æ‹¥å¡ã€‚æ‰€ä»¥æ­¤æ—¶ä¸æ‰§è¡Œæ…¢å¼€å§‹ç®—æ³•ï¼Œè€Œæ˜¯å°†æ‹¥å¡çª—å£è®¾ç½®ä¸ºæ…¢å¼€å§‹é˜ˆå€¼çš„å¤§å°ï¼Œ<strong>ç„¶åæ‰§è¡Œæ‹¥å¡é¿å…ç®—æ³•è®©æ‹¥å¡çª—å£çº¿æ€§åŠ 1</strong>ã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯Httpåè®®ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯Httpåè®®ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯Httpåè®®ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯Httpåè®®ï¼Ÿ</h3><ul>\n<li>Http åè®®å±äºåº”ç”¨å±‚ï¼Œæ˜¯åœ¨æµè§ˆå™¨ä¸æœåŠ¡å™¨é—´ä¼ é€æ–‡æ¡£çš„è§„èŒƒï¼Œç®€ç§°ä¸ºâ€œè¶…æ–‡æœ¬ä¼ è¾“åè®®â€</li>\n</ul>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes20210326001352.png\"></p>\n<h3 id=\"è¯´è¯´HTTPå¸¸ç”¨çš„çŠ¶æ€ç åŠå…¶å«ä¹‰ï¼Ÿ\"><a href=\"#è¯´è¯´HTTPå¸¸ç”¨çš„çŠ¶æ€ç åŠå…¶å«ä¹‰ï¼Ÿ\" class=\"headerlink\" title=\"è¯´è¯´HTTPå¸¸ç”¨çš„çŠ¶æ€ç åŠå…¶å«ä¹‰ï¼Ÿ\"></a>è¯´è¯´HTTPå¸¸ç”¨çš„çŠ¶æ€ç åŠå…¶å«ä¹‰ï¼Ÿ</h3><p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650518889206.webp\" alt=\"å›¾ç‰‡\"></p>\n<p>ä¸ç®¡æ˜¯ä¸æ˜¯é¢è¯•éœ€è¦ï¼Œæˆ‘ä»¬éƒ½è¦çŸ¥é“ï¼Œæ—¥å¸¸å¼€å‘ä¸­çš„è¿™å‡ ä¸ªçŠ¶æ€ç çš„å«ä¹‰ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650518894201.webp\" alt=\"å›¾ç‰‡\"></p>\n<h3 id=\"Httpå’ŒHttpsçš„åŒºåˆ«ï¼Ÿ\"><a href=\"#Httpå’ŒHttpsçš„åŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"Httpå’ŒHttpsçš„åŒºåˆ«ï¼Ÿ\"></a>Httpå’ŒHttpsçš„åŒºåˆ«ï¼Ÿ</h3><p>Http åè®®è¿è¡Œåœ¨ TCP ä¹‹ä¸Šï¼Œæ˜æ–‡ä¼ è¾“ï¼Œå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ç«¯éƒ½æ— æ³•éªŒè¯å¯¹æ–¹çš„èº«ä»½ï¼›Https æ˜¯èº«æŠ« SSL(Secure Socket Layer)å¤–å£³çš„ Httpï¼Œè¿è¡Œäº SSL ä¸Šï¼ŒSSL è¿è¡Œäº TCP ä¹‹ä¸Šï¼Œæ˜¯æ·»åŠ äº†åŠ å¯†å’Œè®¤è¯æœºåˆ¶çš„ HTTPã€‚äºŒè€…ä¹‹é—´å­˜åœ¨å¦‚ä¸‹ä¸åŒï¼š</p>\n<ul>\n<li>ç«¯å£ä¸åŒï¼šHttp ä¸ Https ä½¿ç”¨ä¸åŒçš„è¿æ¥æ–¹å¼ï¼Œç”¨çš„ç«¯å£ä¹Ÿä¸ä¸€æ ·ï¼Œå‰è€…æ˜¯ 80ï¼Œåè€…æ˜¯ 443ï¼›</li>\n<li>èµ„æºæ¶ˆè€—ï¼šå’Œ HTTP é€šä¿¡ç›¸æ¯”ï¼ŒHttps é€šä¿¡ä¼šç”±äºåŠ å¯†è§£å¯†å¤„ç†æ¶ˆè€—æ›´å¤šçš„ CPU å’Œå†…å­˜èµ„æºï¼›</li>\n<li>å¼€é”€ï¼šHttps é€šä¿¡éœ€è¦è¯ä¹¦ï¼Œè€Œè¯ä¹¦ä¸€èˆ¬éœ€è¦å‘è®¤è¯æœºæ„è´­ä¹°ï¼›</li>\n</ul>\n<p>Https çš„åŠ å¯†æœºåˆ¶æ˜¯ä¸€ç§å…±äº«å¯†é’¥åŠ å¯†å’Œå…¬å¼€å¯†é’¥åŠ å¯†å¹¶ç”¨çš„æ··åˆåŠ å¯†æœºåˆ¶ã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯httpçš„è¯·æ±‚ä½“ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯httpçš„è¯·æ±‚ä½“ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯httpçš„è¯·æ±‚ä½“ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯httpçš„è¯·æ±‚ä½“ï¼Ÿ</h3><p><strong>1ã€</strong>HTTP è¯·æ±‚ä½“æ˜¯æˆ‘ä»¬è¯·æ±‚æ•°æ®æ—¶å…ˆå‘é€ç»™æœåŠ¡å™¨çš„æ•°æ®ï¼Œæ¯•ç«Ÿæˆ‘å‘æœåŠ¡å™¨æ‹¿æ•°æ®ï¼Œå…ˆè¦è¡¨æ˜æˆ‘è¦ä»€ä¹ˆå§</p>\n<p><strong>2ã€</strong>HTTP è¯·æ±‚ä½“ç”±ï¼š<strong>è¯·æ±‚è¡Œã€è¯·æ±‚å¤´ã€è¯·æ±‚ä½“</strong> ç»„æˆçš„</p>\n<blockquote>\n<p>è¯·æ±‚è¡Œï¼šè¯·æ±‚æ–¹æ³•ï¼ˆPOSTï¼‰ã€URLï¼ˆcharacter&#x2F;use.htmlï¼‰ å’Œ HTTP åè®®ç‰ˆæœ¬ï¼ˆHTTP&#x2F;1.1ï¼‰</p>\n<p>è¯·æ±‚å¤´ï¼š</p>\n<ul>\n<li>User-Agentï¼šå‘é€è¯·æ±‚çš„æµè§ˆå™¨ç±»å‹;</li>\n<li>Acceptï¼šå®¢æˆ·ç«¯å¯è¯†åˆ«çš„å“åº”å†…å®¹ç±»å‹åˆ—è¡¨;æ˜Ÿå· â€œ * â€ ç”¨äºæŒ‰èŒƒå›´å°†ç±»å‹åˆ†ç»„ï¼Œç”¨ â€œ <em>&#x2F;</em> â€ æŒ‡ç¤ºå¯æ¥å—å…¨éƒ¨ç±»å‹ï¼Œç”¨â€œ type&#x2F;* â€æŒ‡ç¤ºå¯æ¥å— type ç±»å‹çš„æ‰€æœ‰å­ç±»å‹;</li>\n<li>Accept-Languageï¼šå®¢æˆ·ç«¯å¯æ¥å—çš„è‡ªç„¶è¯­è¨€;</li>\n<li>Accept-Encodingï¼šå®¢æˆ·ç«¯å¯æ¥å—çš„ç¼–ç æ ¼å¼;</li>\n<li>Accept-Charsetï¼šå¯æ¥å—çš„åº”ç­”çš„å­—ç¬¦é›†;</li>\n<li>Hostï¼šè¯·æ±‚çš„ä¸»æœºåï¼Œå…è®¸å¤šä¸ªåŸŸååŒå¤„ä¸€ä¸ªIP åœ°å€ï¼Œå³è™šæ‹Ÿä¸»æœº;</li>\n<li>Connectionï¼šè¿æ¥æ–¹å¼(close æˆ– keepalive);</li>\n<li>Cookieï¼šå­˜å‚¨äºå®¢æˆ·ç«¯æ‰©å±•å­—æ®µï¼Œå‘åŒä¸€åŸŸåçš„æœåŠ¡ç«¯å‘é€å±äºè¯¥åŸŸçš„cookie;</li>\n</ul>\n</blockquote>\n<p><strong>3ã€</strong>æ³¨æ„ï¼šGET è¯·æ±‚æ˜¯æ²¡æœ‰è¯·æ±‚ä½“çš„</p>\n<h3 id=\"HTTPçš„å“åº”æŠ¥æ–‡æœ‰å“ªäº›ï¼Ÿ\"><a href=\"#HTTPçš„å“åº”æŠ¥æ–‡æœ‰å“ªäº›ï¼Ÿ\" class=\"headerlink\" title=\"HTTPçš„å“åº”æŠ¥æ–‡æœ‰å“ªäº›ï¼Ÿ\"></a>HTTPçš„å“åº”æŠ¥æ–‡æœ‰å“ªäº›ï¼Ÿ</h3><p><strong>1ã€</strong>http çš„å“åº”æŠ¥æ˜¯æœåŠ¡å™¨è¿”å›ç»™æˆ‘ä»¬çš„æ•°æ®ï¼Œå¿…é¡»å…ˆæœ‰è¯·æ±‚ä½“å†æœ‰å“åº”æŠ¥æ–‡</p>\n<p><strong>2ã€</strong>å“åº”æŠ¥æ–‡åŒ…å«ä¸‰éƒ¨åˆ† <strong>çŠ¶æ€è¡Œã€å“åº”å¤´ã€å“åº”ä½“</strong></p>\n<h3 id=\"Httpä¸­å¸¸è§çš„headerå­—æ®µæœ‰å“ªäº›ï¼Ÿ\"><a href=\"#Httpä¸­å¸¸è§çš„headerå­—æ®µæœ‰å“ªäº›ï¼Ÿ\" class=\"headerlink\" title=\"Httpä¸­å¸¸è§çš„headerå­—æ®µæœ‰å“ªäº›ï¼Ÿ\"></a>Httpä¸­å¸¸è§çš„headerå­—æ®µæœ‰å“ªäº›ï¼Ÿ</h3><p>cookieï¼Œè¯·æ±‚æ—¶ä¼ é€’ç»™æœåŠ¡ç«¯çš„ cookie ä¿¡æ¯<br>set-cookieï¼Œå“åº”æŠ¥æ–‡é¦–éƒ¨è®¾ç½®è¦ä¼ é€’ç»™å®¢æˆ·ç«¯çš„ cookie ä¿¡æ¯<br>allowï¼Œæ”¯æŒä»€ä¹ˆ HTTP æ–¹æ³•<br>last-modifiedï¼Œèµ„æºçš„æœ€åä¿®æ”¹æ—¶é—´<br>expires,è®¾ç½®èµ„æºç¼“å­˜çš„å¤±è´¥æ—¥æœŸ<br>content-languageï¼Œå®ä½“çš„èµ„æºè¯­è¨€<br>content-encodingï¼Œå®ä½“çš„ç¼–ç æ ¼å¼<br>content-lengthï¼Œå®ä½“ä¸»ä½“éƒ¨åˆ†çš„å¤§å°å•ä½æ˜¯å­—èŠ‚<br>content-rangeï¼Œè¿”å›çš„å®ä½“çš„å“ªäº›èŒƒå›´<br>content-typeï¼Œå“ªäº›ç±»å‹<br>accept-rangesï¼Œå¤„ç†çš„èŒƒå›´è¯·æ±‚<br>ageï¼Œå‘Šè¯‰å®¢æˆ·ç«¯æœåŠ¡å™¨åœ¨å¤šä¹…å‰åˆ›å»ºäº†å“åº”<br>varyï¼Œä»£ç†æœåŠ¡å™¨çš„ç¼“å­˜ä¿¡æ¯<br>locationï¼Œç”¨äºæŒ‡å®šé‡å®šå‘åçš„ URI<br>If-Matchï¼Œå€¼æ˜¯èµ„æºçš„å”¯ä¸€æ ‡è¯†<br>User-Agentï¼Œå°†åˆ›å»ºè¯·æ±‚çš„æµè§ˆå™¨å’Œç”¨æˆ·ä»£ç†åç§°ç­‰ä¿¡æ¯ä¼ é€’ç»™æœåŠ¡å™¨<br>Transfer-Encodingï¼Œä¼ è¾“æŠ¥æ–‡çš„ä¸»ä½“ç¼–ç æ–¹å¼<br>connectionï¼Œç®¡ç†æŒä¹…è¿æ¥ keep-alive , close Cache-Controlï¼Œæ§åˆ¶æµè§ˆå™¨çš„å¼ºç¼“å­˜</p>\n<h3 id=\"HTTPSå·¥ä½œåŸç†\"><a href=\"#HTTPSå·¥ä½œåŸç†\" class=\"headerlink\" title=\"HTTPSå·¥ä½œåŸç†\"></a>HTTPSå·¥ä½œåŸç†</h3><p>ï¼ˆAESï¼šéå¯¹ç§°åŠ å¯†ï¼›RSAï¼šå¯¹ç§°åŠ å¯†ï¼‰</p>\n<p><strong>1ã€</strong>é¦–å…ˆ HTTP è¯·æ±‚æœåŠ¡ç«¯ç”Ÿæˆè¯ä¹¦ï¼Œå®¢æˆ·ç«¯å¯¹è¯ä¹¦çš„æœ‰æ•ˆæœŸã€åˆæ³•æ€§ã€åŸŸåæ˜¯å¦ä¸è¯·æ±‚çš„åŸŸåä¸€è‡´ã€è¯ä¹¦çš„å…¬é’¥ï¼ˆRSA åŠ å¯†ï¼‰ç­‰è¿›è¡Œæ ¡éªŒï¼›</p>\n<p><strong>2ã€</strong>å®¢æˆ·ç«¯å¦‚æœæ ¡éªŒé€šè¿‡åï¼Œå°±æ ¹æ®è¯ä¹¦çš„å…¬é’¥çš„æœ‰æ•ˆï¼Œ ç”Ÿæˆéšæœºæ•°ï¼Œéšæœºæ•°ä½¿ç”¨å…¬é’¥è¿›è¡ŒåŠ å¯†ï¼ˆRSA åŠ å¯†ï¼‰ï¼›</p>\n<p><strong>3ã€</strong>æ¶ˆæ¯ä½“äº§ç”Ÿä¹‹åï¼Œå¯¹å®ƒçš„æ‘˜è¦è¿›è¡Œ MD5ï¼ˆæˆ–è€… SHA1ï¼‰ç®—æ³•åŠ å¯†ï¼Œæ­¤æ—¶å°±å¾—åˆ°äº† RSA ç­¾åï¼›</p>\n<p><strong>4ã€</strong>å‘é€ç»™æœåŠ¡ç«¯ï¼Œæ­¤æ—¶åªæœ‰æœåŠ¡ç«¯ï¼ˆRSA ç§é’¥ï¼‰èƒ½è§£å¯†ã€‚</p>\n<p><strong>5ã€</strong>è§£å¯†å¾—åˆ°çš„éšæœºæ•°ï¼Œå†ç”¨ AES åŠ å¯†ï¼Œä½œä¸ºå¯†é’¥ï¼ˆæ­¤æ—¶çš„å¯†é’¥åªæœ‰å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çŸ¥é“ï¼‰ã€‚</p>\n<h3 id=\"â­ä¸ºä»€ä¹ˆ-TCP-é“¾æ¥éœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Œä¸¤æ¬¡ä¸å¯ä»¥ä¹ˆï¼Ÿ\"><a href=\"#â­ä¸ºä»€ä¹ˆ-TCP-é“¾æ¥éœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Œä¸¤æ¬¡ä¸å¯ä»¥ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"â­ä¸ºä»€ä¹ˆ TCP é“¾æ¥éœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Œä¸¤æ¬¡ä¸å¯ä»¥ä¹ˆï¼Ÿ\"></a>â­ä¸ºä»€ä¹ˆ TCP é“¾æ¥éœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Œä¸¤æ¬¡ä¸å¯ä»¥ä¹ˆï¼Ÿ</h3><p>â€œä¸‰æ¬¡æ¡æ‰‹â€ çš„ç›®çš„æ˜¯ä¸ºäº†é˜²æ­¢<strong>å·²å¤±æ•ˆçš„é“¾æ¥è¯·æ±‚æŠ¥æ–‡çªç„¶åˆä¼ é€åˆ°äº†æœåŠ¡ç«¯</strong>ï¼Œå› è€Œäº§ç”Ÿé”™è¯¯ã€‚</p>\n<ul>\n<li>æ­£å¸¸çš„æƒ…å†µï¼šA å‘å‡ºè¿æ¥è¯·æ±‚ï¼Œä½†å› è¿æ¥è¯·æ±‚æŠ¥æ–‡ä¸¢å¤±è€Œæœªæ”¶åˆ°ç¡®è®¤ï¼Œäºæ˜¯ A å†é‡ä¼ ä¸€æ¬¡è¿æ¥è¯·æ±‚ã€‚åæ¥æ”¶åˆ°äº†ç¡®è®¤ï¼Œå»ºç«‹äº†è¿æ¥ã€‚æ•°æ®ä¼ è¾“å®Œæ¯•åï¼Œå°±é‡Šæ”¾äº†è¿æ¥ã€‚A å…±å‘é€äº†ä¸¤ä¸ªè¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªä¸¢å¤±ï¼Œç¬¬äºŒä¸ªåˆ°è¾¾äº† Bã€‚æ²¡æœ‰ â€œå·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µâ€ã€‚</li>\n<li>å‡å®šå‡ºç°äº†ä¸€ç§å¼‚å¸¸æƒ…å†µï¼šå³ A å‘å‡ºçš„ç¬¬ä¸€ä¸ªè¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µå¹¶æ²¡æœ‰ä¸¢å¤±ï¼Œè€Œæ˜¯åœ¨æŸä¸ªç½‘ç»œç»“ç‚¹é•¿æ—¶é—´çš„æ»ç•™äº†ï¼Œä»¥è‡´å»¶è¯¯åˆ°è¿æ¥é‡Šæ”¾ä»¥åçš„æŸä¸ªæ—¶é—´æ‰åˆ°è¾¾ Bã€‚æœ¬æ¥è¿™æ˜¯ä¸€ä¸ªæ—©å·²å¤±æ•ˆçš„æŠ¥æ–‡æ®µã€‚ä½† B æ”¶åˆ°æ­¤å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µåï¼Œå°±è¯¯è®¤ä¸ºæ˜¯ A å†æ¬¡å‘å‡ºçš„ä¸€ä¸ªæ–°çš„è¿æ¥è¯·æ±‚ã€‚äºæ˜¯å°±å‘ A å‘å‡ºç¡®è®¤æŠ¥æ–‡æ®µï¼ŒåŒæ„å»ºç«‹è¿æ¥ã€‚</li>\n</ul>\n<p>å‡è®¾ä¸é‡‡ç”¨â€œä¸‰æ¬¡æ¡æ‰‹â€ï¼Œé‚£ä¹ˆåªè¦ B å‘å‡ºç¡®è®¤ï¼Œæ–°çš„è¿æ¥å°±å»ºç«‹äº†ã€‚ç”±äºç°åœ¨ A å¹¶æ²¡æœ‰å‘å‡ºå»ºç«‹è¿æ¥çš„è¯·æ±‚ï¼ˆå› ä¸ºé‚£ä¸ªæ˜¯å·²ç»å¤±æ•ˆçš„è¯·æ±‚ï¼‰ï¼Œå› æ­¤ä¸ä¼šç†ç¬ B çš„ç¡®è®¤ï¼Œä¹Ÿä¸ä¼šå‘ B å‘é€æ•°æ®ã€‚ä½† B å´ä»¥ä¸ºæ–°çš„è¿è¾“è¿æ¥å·²ç»å»ºç«‹ï¼Œå¹¶ä¸€ç›´ç­‰å¾… A å‘æ¥æ•°æ®ã€‚è¿™æ ·ï¼ŒB çš„å¾ˆå¤šèµ„æºå°±ç™½ç™½æµªè´¹æ‰äº†ã€‚é‡‡ç”¨â€œä¸‰æ¬¡æ¡æ‰‹â€çš„åŠæ³•å¯ä»¥é˜²æ­¢ä¸Šè¿°ç°è±¡å‘ç”Ÿã€‚</p>\n<h3 id=\"â­ä¸ºä»€ä¹ˆè¦å››æ¬¡æŒ¥æ‰‹ï¼Ÿ\"><a href=\"#â­ä¸ºä»€ä¹ˆè¦å››æ¬¡æŒ¥æ‰‹ï¼Ÿ\" class=\"headerlink\" title=\"â­ä¸ºä»€ä¹ˆè¦å››æ¬¡æŒ¥æ‰‹ï¼Ÿ\"></a>â­ä¸ºä»€ä¹ˆè¦å››æ¬¡æŒ¥æ‰‹ï¼Ÿ</h3><p>TCP æ˜¯å…¨åŒå·¥æ¨¡å¼ï¼Œè¿™å°±æ„å‘³ç€ï¼Œ<br>å½“ A å‘ B å‘å‡º FIN æŠ¥æ–‡æ®µæ—¶ï¼Œåªæ˜¯è¡¨ç¤º A å·²ç»æ²¡æœ‰æ•°æ®è¦å‘é€äº†ï¼Œè€Œæ­¤æ—¶ A è¿˜æ˜¯èƒ½å¤Ÿæ¥å—åˆ°æ¥è‡ª B å‘å‡ºçš„æ•°æ®ï¼›å½“ B å‘ A å‘å‡º ACK æŠ¥æ–‡æ®µä¹Ÿåªæ˜¯å‘Šè¯‰ A ï¼Œå®ƒè‡ªå·±çŸ¥é“ A æ²¡æœ‰æ•°æ®è¦å‘äº†ï¼Œä½† B è¿˜æ˜¯èƒ½å¤Ÿå‘ A å‘é€æ•°æ®ã€‚</p>\n<p>æ‰€ä»¥æƒ³è¦æ„‰å¿«çš„ç»“æŸè¿™æ¬¡å¯¹è¯å°±éœ€è¦å››æ¬¡æŒ¥æ‰‹ã€‚</p>\n<h3 id=\"â­ä¸ºä»€ä¹ˆå®¢æˆ·ç«¯å‘å‡ºç¬¬å››æ¬¡æŒ¥æ‰‹çš„ç¡®è®¤æŠ¥æ–‡åè¦ç­‰2MSLçš„æ—¶é—´æ‰èƒ½é‡Šæ”¾TCPè¿æ¥ï¼Ÿ\"><a href=\"#â­ä¸ºä»€ä¹ˆå®¢æˆ·ç«¯å‘å‡ºç¬¬å››æ¬¡æŒ¥æ‰‹çš„ç¡®è®¤æŠ¥æ–‡åè¦ç­‰2MSLçš„æ—¶é—´æ‰èƒ½é‡Šæ”¾TCPè¿æ¥ï¼Ÿ\" class=\"headerlink\" title=\"â­ä¸ºä»€ä¹ˆå®¢æˆ·ç«¯å‘å‡ºç¬¬å››æ¬¡æŒ¥æ‰‹çš„ç¡®è®¤æŠ¥æ–‡åè¦ç­‰2MSLçš„æ—¶é—´æ‰èƒ½é‡Šæ”¾TCPè¿æ¥ï¼Ÿ\"></a>â­ä¸ºä»€ä¹ˆå®¢æˆ·ç«¯å‘å‡ºç¬¬å››æ¬¡æŒ¥æ‰‹çš„ç¡®è®¤æŠ¥æ–‡åè¦ç­‰2MSLçš„æ—¶é—´æ‰èƒ½é‡Šæ”¾TCPè¿æ¥ï¼Ÿ</h3><p>MSLï¼ˆMaximum Segment Lifetimeï¼‰<strong>æŠ¥æ–‡æœ€å¤§å¯¿å‘½</strong>ï¼ŒTCP å…è®¸ä¸åŒçš„å®ç°å¯ä»¥è®¾ç½®ä¸åŒçš„ MSL å€¼ã€‚</p>\n<p>ç¬¬ä¸€ï¼Œä¿è¯å®¢æˆ·ç«¯å‘é€çš„æœ€åä¸€ä¸ª ACK æŠ¥æ–‡èƒ½å¤Ÿåˆ°è¾¾æœåŠ¡å™¨ï¼Œå› ä¸ºè¿™ä¸ª ACK æŠ¥æ–‡å¯èƒ½ä¸¢å¤±ï¼Œç«™åœ¨æœåŠ¡å™¨çš„è§’åº¦çœ‹æ¥ï¼Œæˆ‘å·²ç»å‘é€äº† FIN+ACK æŠ¥æ–‡è¯·æ±‚æ–­å¼€äº†ï¼Œå®¢æˆ·ç«¯è¿˜æ²¡æœ‰ç»™æˆ‘å›åº”ï¼Œåº”è¯¥æ˜¯æˆ‘å‘é€çš„è¯·æ±‚æ–­å¼€æŠ¥æ–‡å®ƒæ²¡æœ‰æ”¶åˆ°ï¼Œäºæ˜¯æœåŠ¡å™¨åˆä¼šé‡æ–°å‘é€ä¸€æ¬¡ï¼Œè€Œå®¢æˆ·ç«¯å°±èƒ½åœ¨è¿™ä¸ª 2MSL æ—¶é—´æ®µå†…æ”¶åˆ°è¿™ä¸ªé‡ä¼ çš„æŠ¥æ–‡ï¼Œæ¥ç€ç»™å‡ºå›åº”æŠ¥æ–‡ï¼Œå¹¶ä¸”ä¼šé‡å¯ 2MSL è®¡æ—¶å™¨ã€‚</p>\n<p>ç¬¬äºŒï¼Œé˜²æ­¢ç±»ä¼¼ä¸â€œä¸‰æ¬¡æ¡æ‰‹â€ä¸­æåˆ°äº†çš„â€œå·²ç»å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µâ€å‡ºç°åœ¨æœ¬è¿æ¥ä¸­ã€‚å®¢æˆ·ç«¯å‘é€å®Œæœ€åä¸€ä¸ªç¡®è®¤æŠ¥æ–‡åï¼Œåœ¨è¿™ä¸ª 2MSL æ—¶é—´ä¸­ï¼Œå°±å¯ä»¥ä½¿æœ¬è¿æ¥æŒç»­çš„æ—¶é—´å†…æ‰€äº§ç”Ÿçš„æ‰€æœ‰æŠ¥æ–‡æ®µéƒ½ä»ç½‘ç»œä¸­æ¶ˆå¤±ã€‚è¿™æ ·æ–°çš„è¿æ¥ä¸­ä¸ä¼šå‡ºç°æ—§è¿æ¥çš„è¯·æ±‚æŠ¥æ–‡ã€‚<br>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”<br>åŸæ–‡é“¾æ¥ï¼š<a href=\"https://blog.csdn.net/qzcsu/article/details/72861891\">https://blog.csdn.net/qzcsu/article/details/72861891</a></p>\n<h3 id=\"â­å¦‚æœå·²ç»å»ºç«‹äº†è¿æ¥ï¼Œä½†æ˜¯å®¢æˆ·ç«¯çªç„¶å‡ºç°æ•…éšœäº†æ€ä¹ˆåŠï¼Ÿ\"><a href=\"#â­å¦‚æœå·²ç»å»ºç«‹äº†è¿æ¥ï¼Œä½†æ˜¯å®¢æˆ·ç«¯çªç„¶å‡ºç°æ•…éšœäº†æ€ä¹ˆåŠï¼Ÿ\" class=\"headerlink\" title=\"â­å¦‚æœå·²ç»å»ºç«‹äº†è¿æ¥ï¼Œä½†æ˜¯å®¢æˆ·ç«¯çªç„¶å‡ºç°æ•…éšœäº†æ€ä¹ˆåŠï¼Ÿ\"></a>â­å¦‚æœå·²ç»å»ºç«‹äº†è¿æ¥ï¼Œä½†æ˜¯å®¢æˆ·ç«¯çªç„¶å‡ºç°æ•…éšœäº†æ€ä¹ˆåŠï¼Ÿ</h3><p>TCP è¿˜è®¾æœ‰ä¸€ä¸ª<strong>ä¿æ´»è®¡æ—¶å™¨</strong>ï¼Œæ˜¾ç„¶ï¼Œå®¢æˆ·ç«¯å¦‚æœå‡ºç°æ•…éšœï¼ŒæœåŠ¡å™¨ä¸èƒ½ä¸€ç›´ç­‰ä¸‹å»ï¼Œç™½ç™½æµªè´¹èµ„æºã€‚æœåŠ¡å™¨æ¯æ”¶åˆ°ä¸€æ¬¡å®¢æˆ·ç«¯çš„è¯·æ±‚åéƒ½ä¼šé‡æ–°å¤ä½è¿™ä¸ªè®¡æ—¶å™¨ï¼Œæ—¶é—´é€šå¸¸æ˜¯è®¾ç½®ä¸º 2 å°æ—¶ï¼Œè‹¥ä¸¤å°æ—¶è¿˜æ²¡æœ‰æ”¶åˆ°å®¢æˆ·ç«¯çš„ä»»ä½•æ•°æ®ï¼ŒæœåŠ¡å™¨å°±ä¼šå‘é€ä¸€ä¸ª<strong>æ¢æµ‹æŠ¥æ–‡æ®µ</strong>ï¼Œä»¥åæ¯éš” 75 ç§’å‘é€ä¸€æ¬¡ã€‚è‹¥<strong>ä¸€è¿å‘é€10ä¸ªæ¢æµ‹æŠ¥æ–‡ä»ç„¶æ²¡ååº”</strong>ï¼ŒæœåŠ¡å™¨å°±è®¤ä¸ºå®¢æˆ·ç«¯å‡ºäº†æ•…éšœï¼Œæ¥ç€å°±<strong>å…³é—­è¿æ¥</strong>ã€‚<br>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”<br>åŸæ–‡é“¾æ¥ï¼š<a href=\"https://blog.csdn.net/qzcsu/article/details/72861891\">https://blog.csdn.net/qzcsu/article/details/72861891</a></p>\n<h3 id=\"IPåœ°å€æ˜¯æ€æ ·åˆ†ç±»çš„ï¼Œä½ çŸ¥é“å—ï¼Ÿ\"><a href=\"#IPåœ°å€æ˜¯æ€æ ·åˆ†ç±»çš„ï¼Œä½ çŸ¥é“å—ï¼Ÿ\" class=\"headerlink\" title=\"IPåœ°å€æ˜¯æ€æ ·åˆ†ç±»çš„ï¼Œä½ çŸ¥é“å—ï¼Ÿ\"></a>IPåœ°å€æ˜¯æ€æ ·åˆ†ç±»çš„ï¼Œä½ çŸ¥é“å—ï¼Ÿ</h3><p>å…ˆè¯´ä¸€ä¸‹ IP çš„åŸºæœ¬ç‰¹ç‚¹ï¼š</p>\n<ul>\n<li>IP åœ°å€ç”±å››æ®µç»„æˆï¼Œæ¯ä¸ªå­—æ®µæ˜¯ä¸€ä¸ªå­—èŠ‚ï¼Œ8 ä½ï¼Œæœ€å¤§å€¼æ˜¯ 255ã€‚</li>\n<li>IP åœ°å€ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œå³<strong>ç½‘ç»œåœ°å€</strong>å’Œ<strong>ä¸»æœºåœ°å€</strong>ã€‚<br>  ç½‘ç»œåœ°å€è¡¨ç¤ºå…¶å±äºäº’è”ç½‘çš„å“ªä¸€ä¸ªç½‘ç»œï¼Œä¸»æœºåœ°å€è¡¨ç¤ºå…¶å±äºè¯¥ç½‘ç»œä¸­çš„å“ªä¸€å°ä¸»æœºã€‚</li>\n</ul>\n<p>IP åœ°å€æ ¹æ®ç½‘ç»œåœ°å€è¿›è¡Œåˆ†ç±»ï¼Œä¸»è¦åˆ†ä¸º Aã€Bã€C ä¸‰ç±»åŠç‰¹æ®Šåœ°å€ Dã€E è¿™äº”ç±»</p>\n<p><strong>Aç±»ï¼š</strong> (1.0.0.0-126.0.0.0)ä¸€èˆ¬ç”¨äºå¤§å‹ç½‘ç»œã€‚</p>\n<p><strong>Bç±»ï¼š</strong> (128.0.0.0-191.255.0.0)ä¸€èˆ¬ç”¨äºä¸­ç­‰è§„æ¨¡ç½‘ç»œã€‚</p>\n<p><strong>Cç±»ï¼š</strong> (192.0.0.0-223.255.255.0)ä¸€èˆ¬ç”¨äºå°å‹ç½‘ç»œã€‚</p>\n<p><strong>Dç±»ï¼š</strong> æ˜¯å¤šæ’­åœ°å€ï¼Œåœ°å€çš„ç½‘ç»œå·å–å€¼äº 224~239 ä¹‹é—´ï¼Œä¸€èˆ¬ç”¨äºå¤šè·¯å¹¿æ’­ç”¨æˆ·ã€‚</p>\n<p><strong>Eç±»ï¼š</strong> æ˜¯ä¿ç•™åœ°å€ã€‚åœ°å€çš„ç½‘ç»œå·å–å€¼äº 240~255 ä¹‹é—´ã€‚</p>\n<h3 id=\"å®¢æˆ·ç«¯ä¸æ–­è¿›è¡Œè¯·æ±‚é“¾æ¥ä¼šæ€æ ·ï¼ŸDDos-Distributed-Denial-of-Service-æ”»å‡»ï¼Ÿ\"><a href=\"#å®¢æˆ·ç«¯ä¸æ–­è¿›è¡Œè¯·æ±‚é“¾æ¥ä¼šæ€æ ·ï¼ŸDDos-Distributed-Denial-of-Service-æ”»å‡»ï¼Ÿ\" class=\"headerlink\" title=\"å®¢æˆ·ç«¯ä¸æ–­è¿›è¡Œè¯·æ±‚é“¾æ¥ä¼šæ€æ ·ï¼ŸDDos(Distributed Denial of Service)æ”»å‡»ï¼Ÿ\"></a>å®¢æˆ·ç«¯ä¸æ–­è¿›è¡Œè¯·æ±‚é“¾æ¥ä¼šæ€æ ·ï¼ŸDDos(Distributed Denial of Service)æ”»å‡»ï¼Ÿ</h3><p>æœåŠ¡å™¨ç«¯ä¼šä¸ºæ¯ä¸ªè¯·æ±‚åˆ›å»ºä¸€ä¸ªé“¾æ¥ï¼Œå¹¶å‘å…¶å‘é€ç¡®è®¤æŠ¥æ–‡ï¼Œç„¶åç­‰å¾…å®¢æˆ·ç«¯è¿›è¡Œç¡®è®¤</p>\n<p><strong>(1) DDos æ”»å‡»ï¼š</strong></p>\n<ul>\n<li>å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€è¯·æ±‚é“¾æ¥æ•°æ®åŒ…</li>\n<li>æœåŠ¡ç«¯å‘å®¢æˆ·ç«¯å‘é€ç¡®è®¤æ•°æ®åŒ…</li>\n<li>å®¢æˆ·ç«¯å´ä¸å‘æœåŠ¡ç«¯å‘é€ç¡®è®¤æ•°æ®åŒ…ï¼ŒæœåŠ¡å™¨<strong>ä¸€ç›´ç­‰å¾…</strong>æ¥è‡ªå®¢æˆ·ç«¯çš„ç¡®è®¤</li>\n</ul>\n<p><strong>(2) DDos é¢„é˜²ï¼šï¼ˆæ²¡æœ‰å½»åº•æ ¹æ²»çš„åŠæ³•ï¼Œé™¤éä¸ä½¿ç”¨TCPï¼‰</strong></p>\n<ul>\n<li>é™åˆ¶åŒæ—¶æ‰“å¼€ SYN åŠé“¾æ¥çš„æ•°ç›®</li>\n<li>ç¼©çŸ­ SYN åŠé“¾æ¥çš„ Time out æ—¶é—´</li>\n<li>å…³é—­ä¸å¿…è¦çš„æœåŠ¡</li>\n</ul>\n<h3 id=\"GET-ä¸-POST-çš„åŒºåˆ«ï¼Ÿ\"><a href=\"#GET-ä¸-POST-çš„åŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"GET ä¸ POST çš„åŒºåˆ«ï¼Ÿ\"></a>GET ä¸ POST çš„åŒºåˆ«ï¼Ÿ</h3><p>GET ä¸ POST æ˜¯æˆ‘ä»¬å¸¸ç”¨çš„ä¸¤ç§ HTTP Methodï¼ŒäºŒè€…ä¹‹é—´çš„åŒºåˆ«ä¸»è¦åŒ…æ‹¬å¦‚ä¸‹äº”ä¸ªæ–¹é¢ï¼š</p>\n<p><strong>1ã€</strong> ä»åŠŸèƒ½ä¸Šè®²ï¼ŒGET ä¸€èˆ¬ç”¨æ¥<strong>ä»æœåŠ¡å™¨ä¸Šè·å–èµ„æº</strong>ï¼ŒPOST ä¸€èˆ¬ç”¨æ¥<strong>æ›´æ–°æœåŠ¡å™¨ä¸Šçš„èµ„æº</strong>ï¼›</p>\n<p><strong>2ã€</strong>ä»è¯·æ±‚å‚æ•°å½¢å¼ä¸Šçœ‹ï¼ŒGETè¯·æ±‚çš„æ•°æ®ä¼š<strong>é™„åœ¨URLä¸Š</strong>ï¼Œä»¥?åˆ†å‰² URL å’Œä¼ è¾“æ•°æ®ï¼Œå‚æ•°ä¹‹é—´ä»¥&amp;ç›¸è¿ï¼›è€Œ POST è¯·æ±‚ä¼šæŠŠæäº¤çš„æ•°æ®åˆ™æ”¾ç½®åœ¨ HTTP è¯·æ±‚æŠ¥æ–‡çš„ <strong>è¯·æ±‚ä½“</strong> ä¸­ã€‚</p>\n<p><strong>3ã€</strong>å°±å®‰å…¨æ€§è€Œè¨€ï¼ŒPOSTçš„<strong>å®‰å…¨æ€§</strong>è¦æ¯” GET çš„å®‰å…¨æ€§é«˜ï¼Œå› ä¸º GET è¯·æ±‚æäº¤çš„æ•°æ®å°†æ˜æ–‡å‡ºç°åœ¨ URL ä¸Šï¼Œè€Œä¸” POST è¯·æ±‚å‚æ•°åˆ™è¢«åŒ…è£…åˆ°è¯·æ±‚ä½“ä¸­ï¼Œç›¸å¯¹æ›´å®‰å…¨ã€‚</p>\n<p><strong>4ã€</strong>ä»è¯·æ±‚çš„å¤§å°çœ‹ï¼ŒGETè¯·æ±‚çš„<strong>é•¿åº¦</strong>å—é™äºæµè§ˆå™¨æˆ–æœåŠ¡å™¨å¯¹ URL é•¿åº¦çš„é™åˆ¶ï¼Œå…è®¸å‘é€çš„æ•°æ®é‡æ¯”è¾ƒå°ï¼Œè€Œ POST è¯·æ±‚åˆ™æ˜¯æ²¡æœ‰å¤§å°é™åˆ¶çš„ã€‚</p>\n<h3 id=\"DNSçš„å¯»å€è¿‡ç¨‹ä½ çŸ¥é“å—ï¼Ÿ\"><a href=\"#DNSçš„å¯»å€è¿‡ç¨‹ä½ çŸ¥é“å—ï¼Ÿ\" class=\"headerlink\" title=\"DNSçš„å¯»å€è¿‡ç¨‹ä½ çŸ¥é“å—ï¼Ÿ\"></a>DNSçš„å¯»å€è¿‡ç¨‹ä½ çŸ¥é“å—ï¼Ÿ</h3><p>æµè§ˆå™¨ç¼“å­˜ã€ç³»ç»Ÿç¼“å­˜ã€hosts æ–‡ä»¶ã€è·¯ç”±å™¨ç¼“å­˜ã€ é€’å½’æœç´¢æ ¹åŸŸåæœåŠ¡å™¨ã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯Socket\"><a href=\"#ä»€ä¹ˆæ˜¯Socket\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯Socket\"></a>ä»€ä¹ˆæ˜¯Socket</h3><p><strong>1ã€</strong>ç½‘ç»œä¸Šçš„ä¸¤ä¸ªç¨‹åºé€šè¿‡ä¸€ä¸ªåŒå‘çš„é€šè®¯è¿æ¥å®ç°æ•°æ®çš„äº¤æ¢ï¼Œè¿™ä¸ªåŒå‘é“¾è·¯çš„ä¸€ç«¯ç§°ä¸ºä¸€ä¸ª Socketã€‚Socket é€šå¸¸ç”¨æ¥å®ç°å®¢æˆ·æ–¹å’ŒæœåŠ¡æ–¹çš„è¿æ¥ã€‚Socket æ˜¯ TCP&#x2F;IP åè®®çš„ä¸€ä¸ªååˆ†æµè¡Œçš„ç¼–ç¨‹ç•Œé¢ï¼Œä¸€ä¸ª Socket ç”±ä¸€ä¸ª IP åœ°å€å’Œä¸€ä¸ªç«¯å£å·å”¯ä¸€ç¡®å®šã€‚</p>\n<p><strong>2ã€</strong>ä½†æ˜¯ï¼ŒSocket æ‰€æ”¯æŒçš„åè®®ç§ç±»ä¹Ÿä¸å…‰ TCP&#x2F;IPã€UDPï¼Œå› æ­¤ä¸¤è€…ä¹‹é—´æ˜¯æ²¡æœ‰å¿…ç„¶è”ç³»çš„ã€‚åœ¨ Java ç¯å¢ƒä¸‹ï¼ŒSocket ç¼–ç¨‹ä¸»è¦æ˜¯æŒ‡åŸºäº TCP&#x2F;IP åè®®çš„ç½‘ç»œç¼–ç¨‹ã€‚</p>\n<p><strong>3ã€</strong>socket è¿æ¥å°±æ˜¯æ‰€è°“çš„é•¿è¿æ¥ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨éœ€è¦äº’ç›¸è¿æ¥ï¼Œç†è®ºä¸Šå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ä¸€æ—¦å»ºç«‹èµ·è¿æ¥å°†ä¸ä¼šä¸»åŠ¨æ–­æ‰çš„ï¼Œä½†æ˜¯æœ‰æ—¶å€™ç½‘ç»œæ³¢åŠ¨è¿˜æ˜¯æœ‰å¯èƒ½çš„</p>\n<p><strong>4ã€</strong>Socket åå‘äºåº•å±‚ã€‚ä¸€èˆ¬å¾ˆå°‘ç›´æ¥ä½¿ç”¨ Socket æ¥ç¼–ç¨‹ï¼Œæ¡†æ¶åº•å±‚ä½¿ç”¨ Socket æ¯”è¾ƒå¤šï¼Œ</p>\n<h3 id=\"Socketå±äºç½‘ç»œçš„é‚£ä¸ªå±‚é¢\"><a href=\"#Socketå±äºç½‘ç»œçš„é‚£ä¸ªå±‚é¢\" class=\"headerlink\" title=\"Socketå±äºç½‘ç»œçš„é‚£ä¸ªå±‚é¢\"></a>Socketå±äºç½‘ç»œçš„é‚£ä¸ªå±‚é¢</h3><p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes20210325212441.png\"></p>\n<p>Socket æ˜¯åº”ç”¨å±‚ä¸ TCP&#x2F;IP åè®®æ—é€šä¿¡çš„ä¸­é—´è½¯ä»¶æŠ½è±¡å±‚ï¼Œå®ƒæ˜¯ä¸€ç»„æ¥å£ã€‚åœ¨è®¾è®¡æ¨¡å¼ä¸­ï¼ŒSocket å…¶å®å°±æ˜¯ä¸€ä¸ªå¤–è§‚æ¨¡å¼ï¼Œå®ƒæŠŠå¤æ‚çš„ TCP&#x2F;IP åè®®æ—éšè—åœ¨ Socket æ¥å£åé¢ï¼Œå¯¹ç”¨æˆ·æ¥è¯´ï¼Œä¸€ç»„ç®€å•çš„æ¥å£å°±æ˜¯å…¨éƒ¨ï¼Œè®© Socket å»ç»„ç»‡æ•°æ®ï¼Œä»¥ç¬¦åˆæŒ‡å®šçš„åè®®ã€‚</p>\n<h3 id=\"Socketé€šè®¯çš„è¿‡ç¨‹\"><a href=\"#Socketé€šè®¯çš„è¿‡ç¨‹\" class=\"headerlink\" title=\"Socketé€šè®¯çš„è¿‡ç¨‹\"></a>Socketé€šè®¯çš„è¿‡ç¨‹</h3><p><strong>åŸºäºTCPï¼š</strong></p>\n<p>æœåŠ¡å™¨ç«¯å…ˆåˆå§‹åŒ– Socketï¼Œç„¶åä¸ç«¯å£ç»‘å®š(bind)ï¼Œå¯¹ç«¯å£è¿›è¡Œç›‘å¬(listen)ï¼Œè°ƒç”¨ accept é˜»å¡ï¼Œç­‰å¾…å®¢æˆ·ç«¯è¿æ¥ã€‚åœ¨è¿™æ—¶å¦‚æœæœ‰ä¸ªå®¢æˆ·ç«¯åˆå§‹åŒ–ä¸€ä¸ª Socketï¼Œç„¶åè¿æ¥æœåŠ¡å™¨(connect)ï¼Œå¦‚æœè¿æ¥æˆåŠŸï¼Œè¿™æ—¶å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ç«¯çš„è¿æ¥å°±å»ºç«‹äº†ã€‚å®¢æˆ·ç«¯å‘é€æ•°æ®è¯·æ±‚ï¼ŒæœåŠ¡å™¨ç«¯æ¥æ”¶è¯·æ±‚å¹¶å¤„ç†è¯·æ±‚ï¼Œç„¶åæŠŠå›åº”æ•°æ®å‘é€ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯è¯»å–æ•°æ®ï¼Œæœ€åå…³é—­è¿æ¥ï¼Œä¸€æ¬¡äº¤äº’ç»“æŸã€‚</p>\n<p><strong>åŸºäºUDPï¼š</strong></p>\n<p>UDP åè®®æ˜¯ç”¨æˆ·æ•°æ®æŠ¥åè®®çš„ç®€ç§°ï¼Œä¹Ÿç”¨äºç½‘ç»œæ•°æ®çš„ä¼ è¾“ã€‚è™½ç„¶ UDP åè®®æ˜¯ä¸€ç§ä¸å¤ªå¯é çš„åè®®ï¼Œä½†æœ‰æ—¶åœ¨éœ€è¦è¾ƒå¿«åœ°æ¥æ”¶æ•°æ®å¹¶ä¸”å¯ä»¥å¿å—è¾ƒå°é”™è¯¯çš„æƒ…å†µä¸‹ï¼ŒUDP å°±ä¼šè¡¨ç°å‡ºæ›´å¤§çš„ä¼˜åŠ¿ã€‚æˆ‘å®¢æˆ·ç«¯åªéœ€è¦å‘é€ï¼ŒæœåŠ¡ç«¯èƒ½ä¸èƒ½æ¥æ”¶çš„åˆ°æˆ‘ä¸ç®¡</p>\n<h3 id=\"Socketå’Œhttpçš„åŒºåˆ«å’Œåº”ç”¨åœºæ™¯\"><a href=\"#Socketå’Œhttpçš„åŒºåˆ«å’Œåº”ç”¨åœºæ™¯\" class=\"headerlink\" title=\"Socketå’Œhttpçš„åŒºåˆ«å’Œåº”ç”¨åœºæ™¯\"></a>Socketå’Œhttpçš„åŒºåˆ«å’Œåº”ç”¨åœºæ™¯</h3><p><strong>1ã€</strong>Socket è¿æ¥å°±æ˜¯æ‰€è°“çš„é•¿è¿æ¥ï¼Œç†è®ºä¸Šå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ä¸€æ—¦å»ºç«‹èµ·è¿æ¥å°†ä¸ä¼šä¸»åŠ¨æ–­æ‰ï¼›</p>\n<p><strong>2ã€</strong>Socket é€‚ç”¨åœºæ™¯ï¼šç½‘ç»œæ¸¸æˆï¼Œé“¶è¡ŒæŒç»­äº¤äº’ï¼Œç›´æ’­ï¼Œåœ¨çº¿è§†å±ç­‰ã€‚</p>\n<p><strong>3ã€</strong>http è¿æ¥å°±æ˜¯æ‰€è°“çš„çŸ­è¿æ¥ï¼Œå³å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯å‘é€ä¸€æ¬¡è¯·æ±‚ï¼ŒæœåŠ¡å™¨ç«¯å“åº”åè¿æ¥å³ä¼šæ–­å¼€ç­‰å¾…ä¸‹æ¬¡è¿æ¥</p>\n<p><strong>4ã€</strong>http é€‚ç”¨åœºæ™¯ï¼šå…¬å¸ OA æœåŠ¡ï¼Œäº’è”ç½‘æœåŠ¡ï¼Œç”µå•†ï¼ŒåŠå…¬ï¼Œç½‘ç«™ç­‰ç­‰ç­‰ç­‰</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯-HTTP-åè®®æ— çŠ¶æ€åè®®ï¼Ÿæ€ä¹ˆè§£å†³Httpåè®®æ— çŠ¶æ€åè®®\"><a href=\"#ä»€ä¹ˆæ˜¯-HTTP-åè®®æ— çŠ¶æ€åè®®ï¼Ÿæ€ä¹ˆè§£å†³Httpåè®®æ— çŠ¶æ€åè®®\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ HTTP åè®®æ— çŠ¶æ€åè®®ï¼Ÿæ€ä¹ˆè§£å†³Httpåè®®æ— çŠ¶æ€åè®®?\"></a>ä»€ä¹ˆæ˜¯ HTTP åè®®æ— çŠ¶æ€åè®®ï¼Ÿæ€ä¹ˆè§£å†³Httpåè®®æ— çŠ¶æ€åè®®?</h3><p>HTTP æ˜¯ä¸€ä¸ªæ— çŠ¶æ€çš„åè®®ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰è®°å¿†åŠ›ï¼Œè¿™æ„å‘³ç€æ¯ä¸€æ¬¡çš„è¯·æ±‚éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œç¼ºå°‘çŠ¶æ€æ„å‘³ç€å¦‚æœåç»­å¤„ç†éœ€è¦å‰é¢çš„ä¿¡æ¯ï¼Œåˆ™å®ƒå¿…é¡»è¦é‡ä¼ ï¼Œè¿™æ ·å¯èƒ½å¯¼è‡´æ¯æ¬¡è¿æ¥ä¼ é€çš„æ•°æ®é‡å¢å¤§ã€‚æœåŠ¡å™¨æ— æ³•åˆ¤æ–­ç”¨æˆ·èº«ä»½ã€‚</p>\n<p>HTTP çš„è¿™ç§ç‰¹æ€§æœ‰ä¼˜ç‚¹ä¹Ÿæœ‰ç¼ºç‚¹ï¼š</p>\n<ul>\n<li><strong>ä¼˜ç‚¹</strong>ï¼šè§£æ”¾äº†æœåŠ¡å™¨ï¼Œæ¯ä¸€æ¬¡çš„è¯·æ±‚â€œç‚¹åˆ°ä¸ºæ­¢â€ï¼Œä¸ä¼šé€ æˆä¸å¿…è¦çš„è¿æ¥å ç”¨</li>\n<li><strong>ç¼ºç‚¹</strong>ï¼šæ¯æ¬¡è¯·æ±‚ä¼šä¼ è¾“å¤§é‡é‡å¤çš„å†…å®¹ä¿¡æ¯ï¼Œå¹¶ä¸”ï¼Œåœ¨è¯·æ±‚ä¹‹é—´æ— æ³•å®ç°æ•°æ®çš„å…±äº«</li>\n</ul>\n<p>è§£å†³æ–¹æ¡ˆï¼š</p>\n<ol>\n<li>ä½¿ç”¨å‚æ•°ä¼ é€’æœºåˆ¶ï¼š<br> å°†å‚æ•°æ‹¼æ¥åœ¨è¯·æ±‚çš„ URL åé¢ï¼Œå®ç°æ•°æ®çš„ä¼ é€’ï¼ˆGET æ–¹å¼ï¼‰ï¼Œä¾‹å¦‚ï¼š<code>/param/list?username=wmyskxz</code><br> <strong>é—®é¢˜</strong>ï¼šå¯ä»¥è§£å†³æ•°æ®å…±äº«çš„é—®é¢˜ï¼Œä½†æ˜¯è¿™ç§æ–¹å¼ä¸€ä¸å®‰å…¨ï¼ŒäºŒæ•°æ®å…è®¸ä¼ è¾“é‡åªæœ‰ 1kb</li>\n<li>ä½¿ç”¨ Cookie æŠ€æœ¯</li>\n<li>ä½¿ç”¨ Session æŠ€æœ¯</li>\n</ol>\n<p>Cookie å’Œ Session éƒ½æ˜¯å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´ä¿æŒçŠ¶æ€çš„è§£å†³æ–¹æ¡ˆï¼Œå…·ä½“æ¥è¯´ï¼Œcookie æœºåˆ¶é‡‡ç”¨çš„æ˜¯åœ¨å®¢æˆ·ç«¯ä¿æŒçŠ¶æ€çš„æ–¹æ¡ˆï¼Œè€Œ session æœºåˆ¶é‡‡ç”¨çš„æ˜¯åœ¨æœåŠ¡å™¨ç«¯ä¿æŒçŠ¶æ€çš„æ–¹æ¡ˆã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯Cookie\"><a href=\"#ä»€ä¹ˆæ˜¯Cookie\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯Cookie\"></a>ä»€ä¹ˆæ˜¯Cookie</h3><p>Cookie å®é™…ä¸Šæ˜¯ä¸€å°æ®µçš„æ–‡æœ¬ä¿¡æ¯ã€‚å®¢æˆ·ç«¯è¯·æ±‚æœåŠ¡å™¨ï¼Œå¦‚æœæœåŠ¡å™¨éœ€è¦è®°å½•è¯¥ç”¨æˆ·çŠ¶æ€ï¼Œå°±ä½¿ç”¨ response å‘å®¢æˆ·ç«¯æµè§ˆå™¨é¢å‘ä¸€ä¸ª Cookieï¼Œè€Œå®¢æˆ·ç«¯æµè§ˆå™¨ä¼šæŠŠ Cookie ä¿å­˜èµ·æ¥ã€‚å½“æµè§ˆå™¨å†è¯·æ±‚è¯¥ç½‘ç«™æ—¶ï¼Œæµè§ˆå™¨æŠŠè¯·æ±‚çš„ç½‘å€è¿åŒè¯¥ Cookie ä¸€åŒæäº¤ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨æ£€æŸ¥è¯¥ Cookieï¼Œä»¥æ­¤æ¥è¾¨è®¤ç”¨æˆ·çŠ¶æ€ã€‚æœåŠ¡å™¨è¿˜å¯ä»¥æ ¹æ®éœ€è¦ä¿®æ”¹ Cookie çš„å†…å®¹ã€‚ </p>\n<h3 id=\"ä»€ä¹ˆæ˜¯Session\"><a href=\"#ä»€ä¹ˆæ˜¯Session\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯Session\"></a>ä»€ä¹ˆæ˜¯Session</h3><p>session æ˜¯æµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¼šè¯è¿‡ç¨‹ä¸­ï¼ŒæœåŠ¡å™¨ä¼šåˆ†é…çš„ä¸€å—å‚¨å­˜ç©ºé—´ç»™ sessionã€‚</p>\n<p>æœåŠ¡å™¨é»˜è®¤ä¸ºå®¢æˆ·æµè§ˆå™¨çš„ cookie ä¸­è®¾ç½® sessionidï¼Œè¿™ä¸ª sessionid å°±å’Œ cookie å¯¹åº”ï¼Œæµè§ˆå™¨åœ¨å‘æœåŠ¡å™¨è¯·æ±‚è¿‡ç¨‹ä¸­ä¼ è¾“çš„ cookie åŒ…å« sessionid ï¼ŒæœåŠ¡å™¨æ ¹æ®ä¼ è¾“ cookie ä¸­çš„ sessionid è·å–å‡ºä¼šè¯ä¸­å­˜å‚¨çš„ä¿¡æ¯ï¼Œç„¶åç¡®å®šä¼šè¯çš„èº«ä»½ä¿¡æ¯ã€‚</p>\n<h3 id=\"Cookieå’ŒSessionå¯¹äºHTTPæœ‰ä»€ä¹ˆç”¨ï¼Ÿ\"><a href=\"#Cookieå’ŒSessionå¯¹äºHTTPæœ‰ä»€ä¹ˆç”¨ï¼Ÿ\" class=\"headerlink\" title=\"Cookieå’ŒSessionå¯¹äºHTTPæœ‰ä»€ä¹ˆç”¨ï¼Ÿ\"></a>Cookieå’ŒSessionå¯¹äºHTTPæœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h3><p> HTTP åè®®æœ¬èº«æ˜¯æ— æ³•åˆ¤æ–­ç”¨æˆ·èº«ä»½ã€‚æ‰€ä»¥éœ€è¦ cookie æˆ–è€… session</p>\n<h3 id=\"Cookieä¸SessionåŒºåˆ«\"><a href=\"#Cookieä¸SessionåŒºåˆ«\" class=\"headerlink\" title=\"Cookieä¸SessionåŒºåˆ«\"></a>Cookieä¸SessionåŒºåˆ«</h3><ul>\n<li><strong>å®ç°æœºåˆ¶</strong>ï¼šSession çš„å®ç°å¸¸å¸¸ä¾èµ–äº Cookie æœºåˆ¶ï¼Œé€šè¿‡ Cookie æœºåˆ¶å›ä¼  SessionIDï¼›</li>\n<li><strong>å¤§å°é™åˆ¶</strong>ï¼šCookie æœ‰å¤§å°é™åˆ¶å¹¶ä¸”æµè§ˆå™¨å¯¹æ¯ä¸ªç«™ç‚¹ä¹Ÿæœ‰ cookie çš„ä¸ªæ•°é™åˆ¶ï¼ŒSession æ²¡æœ‰å¤§å°é™åˆ¶ï¼Œç†è®ºä¸Šåªä¸æœåŠ¡å™¨çš„å†…å­˜å¤§å°æœ‰å…³ï¼›</li>\n<li><strong>å®‰å…¨æ€§</strong>ï¼šCookie å­˜åœ¨å®‰å…¨éšæ‚£ï¼Œé€šè¿‡æ‹¦æˆªæˆ–æœ¬åœ°æ–‡ä»¶æ‰¾å¾—åˆ° cookie åå¯ä»¥è¿›è¡Œæ”»å‡»ï¼Œè€Œ Session ç”±äºä¿å­˜åœ¨æœåŠ¡å™¨ç«¯ï¼Œç›¸å¯¹æ›´åŠ å®‰å…¨ï¼›</li>\n<li><strong>æœåŠ¡å™¨èµ„æºæ¶ˆè€—</strong>ï¼šSession æ˜¯ä¸€å®šæ—¶é—´å†…ä¿å­˜åœ¨æœåŠ¡å™¨ç«¯ä¸Šï¼Œå¦‚æœ session è¿‡å¤šä¼šå¢åŠ æœåŠ¡å™¨çš„å‹åŠ›ã€‚</li>\n</ul>\n<h3 id=\"ä»€ä¹ˆæ˜¯Token\"><a href=\"#ä»€ä¹ˆæ˜¯Token\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯Token\"></a>ä»€ä¹ˆæ˜¯Token</h3><p>Token çš„å¼•å…¥ï¼šToken æ˜¯åœ¨å®¢æˆ·ç«¯é¢‘ç¹å‘æœåŠ¡ç«¯è¯·æ±‚æ•°æ®ï¼ŒæœåŠ¡ç«¯é¢‘ç¹çš„å»æ•°æ®åº“æŸ¥è¯¢ç”¨æˆ·åå’Œå¯†ç å¹¶è¿›è¡Œå¯¹æ¯”ï¼Œåˆ¤æ–­ç”¨æˆ·åå’Œå¯†ç æ­£ç¡®ä¸å¦ï¼Œå¹¶ä½œå‡ºç›¸åº”æç¤ºï¼Œåœ¨è¿™æ ·çš„èƒŒæ™¯ä¸‹ï¼ŒToken ä¾¿åº”è¿è€Œç”Ÿã€‚</p>\n<p>Token çš„å®šä¹‰ï¼šToken æ˜¯æœåŠ¡ç«¯ç”Ÿæˆçš„ä¸€ä¸²å­—ç¬¦ä¸²ï¼Œä»¥ä½œå®¢æˆ·ç«¯è¿›è¡Œè¯·æ±‚çš„ä¸€ä¸ªä»¤ç‰Œï¼Œå½“ç¬¬ä¸€æ¬¡ç™»å½•åï¼ŒæœåŠ¡å™¨ç”Ÿæˆä¸€ä¸ª Token ä¾¿å°†æ­¤ Token è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œä»¥åå®¢æˆ·ç«¯åªéœ€å¸¦ä¸Šè¿™ä¸ª Token å‰æ¥è¯·æ±‚æ•°æ®å³å¯ï¼Œæ— éœ€å†æ¬¡å¸¦ä¸Šç”¨æˆ·åå’Œå¯†ç ã€‚</p>\n<p>ä½¿ç”¨ Token çš„ç›®çš„ï¼šToken çš„ç›®çš„æ˜¯ä¸ºäº†å‡è½»æœåŠ¡å™¨çš„å‹åŠ›ï¼Œå‡å°‘é¢‘ç¹çš„æŸ¥è¯¢æ•°æ®åº“ï¼Œä½¿æœåŠ¡å™¨æ›´åŠ å¥å£®ã€‚</p>\n<p>Token æ˜¯åœ¨æœåŠ¡ç«¯äº§ç”Ÿçš„ã€‚å¦‚æœå‰ç«¯ä½¿ç”¨ç”¨æˆ·å&#x2F;å¯†ç å‘æœåŠ¡ç«¯è¯·æ±‚è®¤è¯ï¼ŒæœåŠ¡ç«¯è®¤è¯æˆåŠŸï¼Œé‚£ä¹ˆåœ¨æœåŠ¡ç«¯ä¼šè¿”å› Token ç»™å‰ç«¯ã€‚å‰ç«¯å¯ä»¥åœ¨æ¯æ¬¡è¯·æ±‚çš„æ—¶å€™å¸¦ä¸Š Token <strong>è¯æ˜è‡ªå·±çš„åˆæ³•åœ°ä½</strong></p>\n<h3 id=\"sessionä¸tokenåŒºåˆ«\"><a href=\"#sessionä¸tokenåŒºåˆ«\" class=\"headerlink\" title=\"sessionä¸tokenåŒºåˆ«\"></a>sessionä¸tokenåŒºåˆ«</h3><ul>\n<li>session å­˜å‚¨åœ¨æœåŠ¡å™¨ç«¯ï¼Œtoken å­˜å‚¨åœ¨å®¢æˆ·ç«¯</li>\n<li>token æä¾›è®¤è¯å’ŒæˆæƒåŠŸèƒ½ï¼Œä½œä¸ºèº«ä»½è®¤è¯ï¼Œtoken å®‰å…¨æ€§æ¯” session å¥½ï¼›</li>\n<li>â­session è¿™ç§ä¼šè¯å­˜å‚¨æ–¹å¼æ–¹å¼åªé€‚ç”¨äºå®¢æˆ·ç«¯ä»£ç å’ŒæœåŠ¡ç«¯ä»£ç è¿è¡Œåœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šï¼Œtoken é€‚ç”¨äºé¡¹ç›®çº§çš„å‰åç«¯åˆ†ç¦»ï¼ˆå‰åç«¯ä»£ç è¿è¡Œåœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸‹ï¼‰</li>\n</ul>\n<h3 id=\"å¸¸ç”¨çš„HTTPæ–¹æ³•æœ‰å“ªäº›ï¼Ÿ\"><a href=\"#å¸¸ç”¨çš„HTTPæ–¹æ³•æœ‰å“ªäº›ï¼Ÿ\" class=\"headerlink\" title=\"å¸¸ç”¨çš„HTTPæ–¹æ³•æœ‰å“ªäº›ï¼Ÿ\"></a>å¸¸ç”¨çš„HTTPæ–¹æ³•æœ‰å“ªäº›ï¼Ÿ</h3><ul>\n<li><strong>GETï¼š</strong>ç”¨äºè¯·æ±‚è®¿é—®å·²ç»è¢« URIï¼ˆç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼‰è¯†åˆ«çš„èµ„æºï¼Œå¯ä»¥é€šè¿‡ URL ä¼ å‚ç»™æœåŠ¡å™¨</li>\n<li><strong>POSTï¼š</strong>ç”¨äºä¼ è¾“ä¿¡æ¯ç»™æœåŠ¡å™¨ï¼Œä¸»è¦åŠŸèƒ½ä¸ GET æ–¹æ³•ç±»ä¼¼ï¼Œä½†ä¸€èˆ¬æ¨èä½¿ç”¨ POST æ–¹å¼ã€‚</li>\n<li><strong>PUTï¼š</strong>ä¼ è¾“æ–‡ä»¶ï¼ŒæŠ¥æ–‡ä¸»ä½“ä¸­åŒ…å«æ–‡ä»¶å†…å®¹ï¼Œä¿å­˜åˆ°å¯¹åº” URI ä½ç½®ã€‚</li>\n<li><strong>HEADï¼š</strong>è·å¾—æŠ¥æ–‡é¦–éƒ¨ï¼Œä¸ GET æ–¹æ³•ç±»ä¼¼ï¼Œåªæ˜¯ä¸è¿”å›æŠ¥æ–‡ä¸»ä½“ï¼Œä¸€èˆ¬ç”¨äºéªŒè¯ URI æ˜¯å¦æœ‰æ•ˆã€‚</li>\n<li><strong>DELETEï¼š</strong>åˆ é™¤æ–‡ä»¶ï¼Œä¸ PUT æ–¹æ³•ç›¸åï¼Œåˆ é™¤å¯¹åº” URI ä½ç½®çš„æ–‡ä»¶ã€‚</li>\n<li><strong>OPTIONSï¼š</strong>æŸ¥è¯¢ç›¸åº” URI æ”¯æŒçš„ HTTP æ–¹æ³•ã€‚</li>\n</ul>\n<h3 id=\"ç½‘ç»œå±‚çš„-ARP-åè®®å·¥ä½œåŸç†ï¼Ÿ\"><a href=\"#ç½‘ç»œå±‚çš„-ARP-åè®®å·¥ä½œåŸç†ï¼Ÿ\" class=\"headerlink\" title=\"ç½‘ç»œå±‚çš„ ARP åè®®å·¥ä½œåŸç†ï¼Ÿ\"></a>ç½‘ç»œå±‚çš„ ARP åè®®å·¥ä½œåŸç†ï¼Ÿ</h3><p>ç½‘ç»œå±‚çš„ ARP åè®®å®Œæˆäº† IP åœ°å€ä¸ç‰©ç†åœ°å€çš„æ˜ å°„</p>\n<h3 id=\"IPåœ°å€ä¸ç‰©ç†åœ°å€\"><a href=\"#IPåœ°å€ä¸ç‰©ç†åœ°å€\" class=\"headerlink\" title=\"IPåœ°å€ä¸ç‰©ç†åœ°å€\"></a>IPåœ°å€ä¸ç‰©ç†åœ°å€</h3><p>ç‰©ç†åœ°å€æ˜¯æ•°æ®é“¾è·¯å±‚å’Œç‰©ç†å±‚ä½¿ç”¨çš„åœ°å€ï¼ŒIP åœ°å€æ˜¯ç½‘ç»œå±‚å’Œä»¥ä¸Šå„å±‚ä½¿ç”¨çš„åœ°å€ï¼Œæ˜¯ä¸€ç§é€»è¾‘åœ°å€ï¼Œå…¶ä¸­ ARP åè®®ç”¨äº IP åœ°å€ä¸ç‰©ç†åœ°å€çš„å¯¹åº”ã€‚</p>\n<h3 id=\"å½±å“ç½‘ç»œä¼ è¾“çš„å› ç´ æœ‰å“ªäº›ï¼Ÿ\"><a href=\"#å½±å“ç½‘ç»œä¼ è¾“çš„å› ç´ æœ‰å“ªäº›ï¼Ÿ\" class=\"headerlink\" title=\"å½±å“ç½‘ç»œä¼ è¾“çš„å› ç´ æœ‰å“ªäº›ï¼Ÿ\"></a>å½±å“ç½‘ç»œä¼ è¾“çš„å› ç´ æœ‰å“ªäº›ï¼Ÿ</h3><p>å°†ä¸€ä»½æ•°æ®ä»ä¸€ä¸ªåœ°æ–¹æ­£ç¡®åœ°ä¼ è¾“åˆ°å¦ä¸€ä¸ªåœ°æ–¹æ‰€éœ€è¦çš„æ—¶é—´æˆ‘ä»¬ç§°ä¹‹ä¸ºå“åº”æ—¶é—´ã€‚å½±å“è¿™ä¸ªå“åº”æ—¶é—´çš„å› ç´ æœ‰å¾ˆå¤šã€‚</p>\n<p>1ã€ç½‘ç»œå¸¦å®½<br>2ã€ä¼ è¾“è·ç¦»<br>3ã€TCP æ‹¥å¡æ§åˆ¶</p>\n<h3 id=\"ä»€æ˜¯å¯¹ç§°åŠ å¯†ä¸éå¯¹ç§°åŠ å¯†\"><a href=\"#ä»€æ˜¯å¯¹ç§°åŠ å¯†ä¸éå¯¹ç§°åŠ å¯†\" class=\"headerlink\" title=\"ä»€æ˜¯å¯¹ç§°åŠ å¯†ä¸éå¯¹ç§°åŠ å¯†\"></a>ä»€æ˜¯å¯¹ç§°åŠ å¯†ä¸éå¯¹ç§°åŠ å¯†</h3><p>å¯¹ç§°å¯†é’¥åŠ å¯†æ˜¯æŒ‡<strong>åŠ å¯†å’Œè§£å¯†ä½¿ç”¨åŒä¸€ä¸ªå¯†é’¥</strong>çš„æ–¹å¼ï¼Œè¿™ç§æ–¹å¼å­˜åœ¨çš„æœ€å¤§é—®é¢˜å°±æ˜¯å¯†é’¥å‘é€é—®é¢˜ï¼Œå³å¦‚ä½•å®‰å…¨åœ°å°†å¯†é’¥å‘ç»™å¯¹æ–¹ï¼›</p>\n<p>è€Œéå¯¹ç§°åŠ å¯†æ˜¯æŒ‡ä½¿ç”¨<strong>ä¸€å¯¹éå¯¹ç§°å¯†é’¥ï¼Œå³å…¬é’¥å’Œç§é’¥</strong>ï¼Œå…¬é’¥å¯ä»¥éšæ„å‘å¸ƒï¼Œä½†ç§é’¥åªæœ‰è‡ªå·±çŸ¥é“ã€‚å‘é€å¯†æ–‡çš„ä¸€æ–¹ä½¿ç”¨å¯¹æ–¹çš„å…¬é’¥è¿›è¡ŒåŠ å¯†å¤„ç†ï¼Œå¯¹æ–¹æ¥æ”¶åˆ°åŠ å¯†ä¿¡æ¯åï¼Œä½¿ç”¨è‡ªå·±çš„ç§é’¥è¿›è¡Œè§£å¯†ã€‚ ç”±äºéå¯¹ç§°åŠ å¯†çš„æ–¹å¼ä¸éœ€è¦å‘é€ç”¨æ¥è§£å¯†çš„ç§é’¥ï¼Œæ‰€ä»¥å¯ä»¥ä¿è¯å®‰å…¨æ€§ï¼›ä½†æ˜¯å’Œå¯¹ç§°åŠ å¯†æ¯”èµ·æ¥ï¼Œéå¸¸çš„æ…¢</p>\n<h3 id=\"HTTPSé‡‡ç”¨å¯¹ç§°åŠ å¯†-éå¯¹ç§°åŠ å¯†\"><a href=\"#HTTPSé‡‡ç”¨å¯¹ç§°åŠ å¯†-éå¯¹ç§°åŠ å¯†\" class=\"headerlink\" title=\"HTTPSé‡‡ç”¨å¯¹ç§°åŠ å¯†+éå¯¹ç§°åŠ å¯†\"></a>HTTPSé‡‡ç”¨å¯¹ç§°åŠ å¯†+éå¯¹ç§°åŠ å¯†</h3><p>ä½¿ç”¨å¯¹ç§°åŠ å¯†ï¼Œä¼˜ç‚¹æ˜¯åŠ å¯†è§£å¯†é€Ÿåº¦å¿«ï¼Œç¼ºç‚¹æ˜¯ä¸å®‰å…¨ï¼›<br>ä½¿ç”¨éå¯¹ç§°åŠ å¯†ï¼Œä¼˜ç‚¹æ˜¯ä¿è¯å®‰å…¨æ€§ï¼Œç¼ºç‚¹æ˜¯é€Ÿåº¦æ…¢ï¼›</p>\n<p>Https ç»“åˆä¸¤ç§åŠ å¯†æ–¹å¼çš„ä¼˜ç‚¹ï¼Œ<br>åœ¨<strong>äº¤æ¢å¯†é’¥ç¯èŠ‚</strong>ä½¿ç”¨éå¯¹ç§°åŠ å¯†æ–¹å¼ï¼Œä¹‹åçš„<strong>å»ºç«‹é€šä¿¡äº¤æ¢æŠ¥æ–‡</strong>é˜¶æ®µåˆ™ä½¿ç”¨å¯¹ç§°åŠ å¯†æ–¹å¼ã€‚</p>\n<h2 id=\"TCP-x2F-IP-åè®®æ—\"><a href=\"#TCP-x2F-IP-åè®®æ—\" class=\"headerlink\" title=\"TCP&#x2F;IP åè®®æ—\"></a>TCP&#x2F;IP åè®®æ—</h2><h3 id=\"åº”ç”¨å±‚\"><a href=\"#åº”ç”¨å±‚\" class=\"headerlink\" title=\"åº”ç”¨å±‚\"></a>åº”ç”¨å±‚</h3><p>åº”ç”¨å±‚( application-layer ï¼‰çš„ä»»åŠ¡æ˜¯é€šè¿‡åº”ç”¨è¿›ç¨‹é—´çš„äº¤äº’æ¥å®Œæˆç‰¹å®šç½‘ç»œåº”ç”¨ã€‚åº”ç”¨å±‚åè®®å®šä¹‰çš„æ˜¯åº”ç”¨è¿›ç¨‹ï¼ˆè¿›ç¨‹ï¼šä¸»æœºä¸­æ­£åœ¨è¿è¡Œçš„ç¨‹åºï¼‰é—´çš„é€šä¿¡å’Œäº¤äº’çš„è§„åˆ™ã€‚</p>\n<p>å¯¹äºä¸åŒçš„ç½‘ç»œåº”ç”¨éœ€è¦ä¸åŒçš„åº”ç”¨å±‚åè®®ã€‚åœ¨äº’è”ç½‘ä¸­åº”ç”¨å±‚åè®®å¾ˆå¤šï¼Œå¦‚åŸŸåç³»ç»Ÿ DNSï¼Œæ”¯æŒä¸‡ç»´ç½‘åº”ç”¨çš„ HTTP åè®®ï¼Œæ”¯æŒç”µå­é‚®ä»¶çš„ SMTP åè®®ç­‰ç­‰ã€‚</p>\n<h3 id=\"ä¼ è¾“å±‚\"><a href=\"#ä¼ è¾“å±‚\" class=\"headerlink\" title=\"ä¼ è¾“å±‚\"></a>ä¼ è¾“å±‚</h3><p>ä¼ è¾“å±‚(transport layer)çš„ä¸»è¦ä»»åŠ¡å°±æ˜¯è´Ÿè´£å‘ä¸¤å°ä¸»æœºè¿›ç¨‹ä¹‹é—´çš„é€šä¿¡æä¾›é€šç”¨çš„<strong>æ•°æ®ä¼ è¾“æœåŠ¡</strong>ã€‚åº”ç”¨è¿›ç¨‹åˆ©ç”¨è¯¥æœåŠ¡ä¼ é€åº”ç”¨å±‚æŠ¥æ–‡ã€‚</p>\n<p>è¿è¾“å±‚ä¸»è¦ä½¿ç”¨ä¸€ä¸‹ä¸¤ç§åè®®</p>\n<ol>\n<li>ä¼ è¾“æ§åˆ¶åè®®-TCPï¼šæä¾›é¢å‘è¿æ¥çš„ï¼Œå¯é çš„æ•°æ®ä¼ è¾“æœåŠ¡ã€‚</li>\n<li>ç”¨æˆ·æ•°æ®åè®®-UDPï¼šæä¾›æ— è¿æ¥çš„ï¼Œå°½æœ€å¤§åŠªåŠ›çš„æ•°æ®ä¼ è¾“æœåŠ¡ï¼ˆä¸ä¿è¯æ•°æ®ä¼ è¾“çš„å¯é æ€§ï¼‰ã€‚</li>\n</ol>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>UDP</th>\n<th>TCP</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>æ˜¯å¦è¿æ¥</td>\n<td>æ— è¿æ¥</td>\n<td>é¢å‘è¿æ¥</td>\n</tr>\n<tr>\n<td>æ˜¯å¦å¯é </td>\n<td>ä¸å¯é ä¼ è¾“ï¼Œä¸ä½¿ç”¨æµé‡æ§åˆ¶å’Œæ‹¥å¡æ§åˆ¶</td>\n<td>å¯é ä¼ è¾“ï¼Œä½¿ç”¨æµé‡æ§åˆ¶å’Œæ‹¥å¡æ§åˆ¶</td>\n</tr>\n<tr>\n<td>è¿æ¥å¯¹è±¡ä¸ªæ•°</td>\n<td>æ”¯æŒä¸€å¯¹ä¸€ï¼Œä¸€å¯¹å¤šï¼Œå¤šå¯¹ä¸€å’Œå¤šå¯¹å¤šäº¤äº’é€šä¿¡</td>\n<td>åªèƒ½æ˜¯ä¸€å¯¹ä¸€é€šä¿¡</td>\n</tr>\n<tr>\n<td>ä¼ è¾“æ–¹å¼</td>\n<td>é¢å‘æŠ¥æ–‡</td>\n<td>é¢å‘å­—èŠ‚æµ</td>\n</tr>\n<tr>\n<td>é¦–éƒ¨å¼€é”€</td>\n<td>é¦–éƒ¨å¼€é”€å°ï¼Œä»…8å­—èŠ‚</td>\n<td>é¦–éƒ¨æœ€å°20å­—èŠ‚ï¼Œæœ€å¤§60å­—èŠ‚</td>\n</tr>\n<tr>\n<td>åœºæ™¯</td>\n<td>é€‚ç”¨äºå®æ—¶åº”ç”¨ï¼ˆIPç”µè¯ã€è§†é¢‘ä¼šè®®ã€ç›´æ’­ç­‰ï¼‰</td>\n<td>é€‚ç”¨äºè¦æ±‚å¯é ä¼ è¾“çš„åº”ç”¨ï¼Œä¾‹å¦‚æ–‡ä»¶ä¼ è¾“</td>\n</tr>\n</tbody></table>\n<p><strong>æ¯ä¸€ä¸ªåº”ç”¨å±‚ï¼ˆTCP&#x2F;IPå‚è€ƒæ¨¡å‹çš„æœ€é«˜å±‚ï¼‰åè®®ä¸€èˆ¬éƒ½ä¼šä½¿ç”¨åˆ°ä¸¤ä¸ªä¼ è¾“å±‚åè®®ä¹‹ä¸€ï¼š</strong></p>\n<p>è¿è¡Œåœ¨<code>TCPåè®®</code>ä¸Šçš„åè®®ï¼š</p>\n<ul>\n<li><code>HTTPï¼ˆHypertext Transfer Protocolï¼Œè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰</code>ï¼Œä¸»è¦ç”¨äºæ™®é€šæµè§ˆã€‚</li>\n<li><code>HTTPSï¼ˆHTTP over SSLï¼Œå®‰å…¨è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰</code>,<code>HTTP</code>åè®®çš„å®‰å…¨ç‰ˆæœ¬ã€‚</li>\n<li><code>FTPï¼ˆFile Transfer Protocolï¼Œæ–‡ä»¶ä¼ è¾“åè®®ï¼‰</code>ï¼Œç”¨äºæ–‡ä»¶ä¼ è¾“ã€‚</li>\n<li><code>POP3ï¼ˆPost Office Protocol, version 3ï¼Œé‚®å±€åè®®ï¼‰</code>ï¼Œæ”¶é‚®ä»¶ç”¨ã€‚</li>\n<li><code>SMTPï¼ˆSimple Mail Transfer Protocolï¼Œç®€å•é‚®ä»¶ä¼ è¾“åè®®ï¼‰</code>ï¼Œç”¨æ¥å‘é€ç”µå­é‚®ä»¶ã€‚</li>\n<li><code>TELNETï¼ˆTeletype over the Networkï¼Œç½‘ç»œç”µä¼ ï¼‰</code>ï¼Œé€šè¿‡ä¸€ä¸ª<code>ç»ˆç«¯ï¼ˆterminalï¼‰</code>ç™»é™†åˆ°ç½‘ç»œã€‚</li>\n<li><code>SSHï¼ˆSecure Shellï¼Œç”¨äºæ›¿ä»£å®‰å…¨æ€§å·®çš„TELNETï¼‰</code>ï¼Œç”¨äºåŠ å¯†å®‰å…¨ç™»é™†ç”¨ã€‚</li>\n</ul>\n<p>è¿è¡Œåœ¨<code>UDPåè®®</code>ä¸Šçš„åè®®ï¼š</p>\n<ul>\n<li><code>DHCPï¼ˆDynamic Host Configuration Protocolï¼ŒåŠ¨æ€ä¸»æœºé…ç½®åè®®ï¼‰</code>ï¼ŒåŠ¨æ€é…ç½® IP åœ°å€ã€‚</li>\n</ul>\n<p>è¿è¡Œåœ¨<code>TCP</code>å’Œ<code>UDP</code>åè®®ä¸Šï¼š</p>\n<ul>\n<li><code>DNSï¼ˆDomain Name Serviceï¼ŒåŸŸåæœåŠ¡ï¼‰</code>ï¼Œç”¨äºå®Œæˆåœ°å€æŸ¥æ‰¾ï¼Œé‚®ä»¶è½¬å‘ç­‰å·¥ä½œã€‚</li>\n</ul>\n<h3 id=\"ç½‘ç»œå±‚\"><a href=\"#ç½‘ç»œå±‚\" class=\"headerlink\" title=\"ç½‘ç»œå±‚\"></a>ç½‘ç»œå±‚</h3><p>ç½‘ç»œå±‚çš„ä»»åŠ¡å°±æ˜¯<strong>é€‰æ‹©åˆé€‚çš„ç½‘é—´è·¯ç”±å’Œäº¤æ¢ç»“ç‚¹ï¼Œç¡®ä¿è®¡ç®—æœºé€šä¿¡çš„æ•°æ®åŠæ—¶ä¼ é€</strong>ã€‚åœ¨å‘é€æ•°æ®æ—¶ï¼Œç½‘ç»œå±‚æŠŠè¿è¾“å±‚äº§ç”Ÿçš„æŠ¥æ–‡æ®µæˆ–ç”¨æˆ·æ•°æ®æŠ¥å°è£…æˆåˆ†ç»„å’ŒåŒ…è¿›è¡Œä¼ é€ã€‚åœ¨ TCP&#x2F;IP ä½“ç³»ç»“æ„ä¸­ï¼Œç”±äºç½‘ç»œå±‚ä½¿ç”¨ IP åè®®ï¼Œå› æ­¤åˆ†ç»„ä¹Ÿå« IP æ•°æ®æŠ¥ ï¼Œç®€ç§°æ•°æ®æŠ¥ã€‚</p>\n<p>äº’è”ç½‘æ˜¯ç”±å¤§é‡çš„å¼‚æ„ï¼ˆheterogeneousï¼‰ç½‘ç»œé€šè¿‡è·¯ç”±å™¨ï¼ˆrouterï¼‰ç›¸äº’è¿æ¥èµ·æ¥çš„ã€‚äº’è”ç½‘ä½¿ç”¨çš„ç½‘ç»œå±‚åè®®æ˜¯æ— è¿æ¥çš„ç½‘é™…åè®®ï¼ˆIntert Prococolï¼‰å’Œè®¸å¤šè·¯ç”±é€‰æ‹©åè®®ï¼Œå› æ­¤äº’è”ç½‘çš„ç½‘ç»œå±‚ä¹Ÿå«åšç½‘é™…å±‚æˆ– IP å±‚ã€‚</p>\n<h3 id=\"æ•°æ®é“¾è·¯å±‚\"><a href=\"#æ•°æ®é“¾è·¯å±‚\" class=\"headerlink\" title=\"æ•°æ®é“¾è·¯å±‚\"></a>æ•°æ®é“¾è·¯å±‚</h3><p>æ•°æ®é“¾è·¯å±‚(data link layer)é€šå¸¸ç®€ç§°ä¸ºé“¾è·¯å±‚ã€‚ä¸¤å°ä¸»æœºä¹‹é—´çš„æ•°æ®ä¼ è¾“ï¼Œæ€»æ˜¯åœ¨ä¸€æ®µä¸€æ®µçš„é“¾è·¯ä¸Šä¼ é€çš„ï¼Œè¿™å°±éœ€è¦ä½¿ç”¨ä¸“é—¨çš„é“¾è·¯å±‚çš„åè®®ã€‚</p>\n<p>åœ¨ä¸¤ä¸ªç›¸é‚»èŠ‚ç‚¹ä¹‹é—´ä¼ é€æ•°æ®æ—¶ï¼Œæ•°æ®é“¾è·¯å±‚å°†ç½‘ç»œå±‚äº¤ä¸‹æ¥çš„ IP æ•°æ®æŠ¥ç»„è£…æˆå¸§ï¼Œåœ¨ä¸¤ä¸ªç›¸é‚»èŠ‚ç‚¹é—´çš„é“¾è·¯ä¸Šä¼ é€å¸§ã€‚æ¯ä¸€å¸§åŒ…æ‹¬æ•°æ®å’Œå¿…è¦çš„æ§åˆ¶ä¿¡æ¯ï¼ˆå¦‚åŒæ­¥ä¿¡æ¯ï¼Œåœ°å€ä¿¡æ¯ï¼Œå·®é”™æ§åˆ¶ç­‰ï¼‰ã€‚</p>\n<p>åœ¨æ¥æ”¶æ•°æ®æ—¶ï¼Œæ§åˆ¶ä¿¡æ¯ä½¿æ¥æ”¶ç«¯èƒ½å¤ŸçŸ¥é“ä¸€ä¸ªå¸§ä»å“ªä¸ªæ¯”ç‰¹å¼€å§‹å’Œåˆ°å“ªä¸ªæ¯”ç‰¹ç»“æŸã€‚</p>\n<p>ä¸€èˆ¬çš„ web åº”ç”¨çš„é€šä¿¡ä¼ è¾“æµæ˜¯è¿™æ ·çš„ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOS81LzkvMTZhOWM5Y2Q1MjNlMDU5OQ.png\" alt=\"img\"></p>\n<p>å‘é€ç«¯åœ¨å±‚ä¸å±‚ä¹‹é—´ä¼ è¾“æ•°æ®æ—¶ï¼Œæ¯ç»è¿‡ä¸€å±‚æ—¶ä¼šè¢«æ‰“ä¸Šä¸€ä¸ªè¯¥å±‚æ‰€å±çš„é¦–éƒ¨ä¿¡æ¯ã€‚åä¹‹ï¼Œæ¥æ”¶ç«¯åœ¨å±‚ä¸å±‚ä¹‹é—´ä¼ è¾“æ•°æ®æ—¶ï¼Œæ¯ç»è¿‡ä¸€å±‚æ—¶ä¼šæŠŠå¯¹åº”çš„é¦–éƒ¨ä¿¡æ¯å»é™¤ã€‚</p>\n<h3 id=\"ç‰©ç†å±‚\"><a href=\"#ç‰©ç†å±‚\" class=\"headerlink\" title=\"ç‰©ç†å±‚\"></a>ç‰©ç†å±‚</h3><p>åœ¨ç‰©ç†å±‚ä¸Šæ‰€ä¼ é€çš„æ•°æ®å•ä½æ˜¯æ¯”ç‰¹ã€‚ ç‰©ç†å±‚(physical layer)çš„ä½œç”¨æ˜¯å®ç°ç›¸é‚»è®¡ç®—æœºèŠ‚ç‚¹ä¹‹é—´æ¯”ç‰¹æµçš„é€æ˜ä¼ é€ï¼Œå°½å¯èƒ½å±è”½æ‰å…·ä½“ä¼ è¾“ä»‹è´¨å’Œç‰©ç†è®¾å¤‡çš„å·®å¼‚ã€‚ä½¿å…¶ä¸Šé¢çš„æ•°æ®é“¾è·¯å±‚ä¸å¿…è€ƒè™‘ç½‘ç»œçš„å…·ä½“ä¼ è¾“ä»‹è´¨æ˜¯ä»€ä¹ˆã€‚â€œé€æ˜ä¼ é€æ¯”ç‰¹æµâ€è¡¨ç¤ºç»å®é™…ç”µè·¯ä¼ é€åçš„æ¯”ç‰¹æµæ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œå¯¹ä¼ é€çš„æ¯”ç‰¹æµæ¥è¯´ï¼Œè¿™ä¸ªç”µè·¯å¥½åƒæ˜¯çœ‹ä¸è§çš„ã€‚</p>\n<h3 id=\"TCP-x2F-IP-åè®®æ—-1\"><a href=\"#TCP-x2F-IP-åè®®æ—-1\" class=\"headerlink\" title=\"TCP&#x2F;IP åè®®æ—\"></a>TCP&#x2F;IP åè®®æ—</h3><p>åœ¨äº’è”ç½‘ä½¿ç”¨çš„å„ç§åè®®ä¸­æœ€é‡è¦å’Œæœ€è‘—åçš„å°±æ˜¯ TCP&#x2F;IP ä¸¤ä¸ªåè®®ã€‚ç°åœ¨äººä»¬ç»å¸¸æåˆ°çš„ TCP&#x2F;IP å¹¶ä¸ä¸€å®šæ˜¯å•æŒ‡ TCP å’Œ IP è¿™ä¸¤ä¸ªå…·ä½“çš„åè®®ï¼Œè€Œå¾€å¾€æ˜¯è¡¨ç¤ºäº’è”ç½‘æ‰€ä½¿ç”¨çš„æ•´ä¸ª TCP&#x2F;IP åè®®æ—ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOS80LzcvMTY5ZjY5NjZjMjRhZjM0NQ.png\" alt=\"img\"></p>\n<p>TCPï¼ˆä¼ è¾“æ§åˆ¶åè®®ï¼‰å’Œ IPï¼ˆç½‘é™…åè®®ï¼‰æ˜¯<strong>æœ€å…ˆå®šä¹‰çš„ä¸¤ä¸ªæ ¸å¿ƒåè®®</strong>ï¼Œæ‰€ä»¥æ‰ç»Ÿç§°ä¸º TCP&#x2F;IP åè®®æ—</p>\n<h2 id=\"TCPçš„ä¸‰æ¬¡æ¡æ‰‹å››æ¬¡æŒ¥æ‰‹\"><a href=\"#TCPçš„ä¸‰æ¬¡æ¡æ‰‹å››æ¬¡æŒ¥æ‰‹\" class=\"headerlink\" title=\"TCPçš„ä¸‰æ¬¡æ¡æ‰‹å››æ¬¡æŒ¥æ‰‹\"></a>TCPçš„ä¸‰æ¬¡æ¡æ‰‹å››æ¬¡æŒ¥æ‰‹</h2><p>TCP æ˜¯ä¸€ç§é¢å‘è¿æ¥çš„ã€å¯é çš„ã€åŸºäºå­—èŠ‚æµçš„ä¼ è¾“å±‚é€šä¿¡åè®®ï¼Œåœ¨å‘é€æ•°æ®å‰ï¼Œé€šä¿¡åŒæ–¹å¿…é¡»åœ¨å½¼æ­¤é—´å»ºç«‹ä¸€æ¡è¿æ¥ã€‚æ‰€è°“çš„â€œè¿æ¥â€ï¼Œå…¶å®æ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¿å­˜çš„ä¸€ä»½å…³äºå¯¹æ–¹çš„ä¿¡æ¯ï¼Œå¦‚ ip åœ°å€ã€ç«¯å£å·ç­‰ã€‚</p>\n<p>ä¸€ä¸ª TCP è¿æ¥ç”±ä¸€ä¸ª 4 å…ƒç»„æ„æˆï¼Œåˆ†åˆ«æ˜¯ä¸¤ä¸ª IP åœ°å€å’Œä¸¤ä¸ªç«¯å£å·ã€‚ä¸€ä¸ª TCP è¿æ¥é€šå¸¸åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼šè¿æ¥ã€æ•°æ®ä¼ è¾“ã€é€€å‡ºï¼ˆå…³é—­ï¼‰ã€‚<strong>é€šè¿‡ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹ä¸€ä¸ªé“¾æ¥ï¼Œé€šè¿‡å››æ¬¡æŒ¥æ‰‹æ¥å…³é—­ä¸€ä¸ªè¿æ¥</strong>ã€‚</p>\n<p><strong>å½“ä¸€ä¸ªè¿æ¥è¢«å»ºç«‹æˆ–è¢«ç»ˆæ­¢æ—¶ï¼Œäº¤æ¢çš„æŠ¥æ–‡æ®µåªåŒ…å«TCPå¤´éƒ¨ï¼Œè€Œæ²¡æœ‰æ•°æ®</strong>ã€‚</p>\n<h3 id=\"TCPæŠ¥æ–‡çš„å¤´éƒ¨ç»“æ„\"><a href=\"#TCPæŠ¥æ–‡çš„å¤´éƒ¨ç»“æ„\" class=\"headerlink\" title=\"TCPæŠ¥æ–‡çš„å¤´éƒ¨ç»“æ„\"></a>TCPæŠ¥æ–‡çš„å¤´éƒ¨ç»“æ„</h3><p>æœ‰å‡ ä¸ªå­—æ®µéœ€è¦é‡ç‚¹ä»‹ç»ä¸‹ï¼š</p>\n<p>ï¼ˆ1ï¼‰åºå·ï¼šseq åºå·ï¼Œå  32 ä½ï¼Œç”¨æ¥æ ‡è¯†ä» TCP æºç«¯å‘ç›®çš„ç«¯å‘é€çš„å­—èŠ‚æµï¼Œå‘èµ·æ–¹å‘é€æ•°æ®æ—¶å¯¹æ­¤è¿›è¡Œæ ‡è®°ã€‚</p>\n<p>ï¼ˆ2ï¼‰ç¡®è®¤åºå·ï¼šack åºå·ï¼Œå  32 ä½ï¼Œåªæœ‰ ACK æ ‡å¿—ä½ä¸º 1 æ—¶ï¼Œç¡®è®¤åºå·å­—æ®µæ‰æœ‰æ•ˆï¼Œack&#x3D;seq+1ã€‚</p>\n<p>ï¼ˆ3ï¼‰æ ‡å¿—ä½ï¼šå…± 6 ä¸ªï¼Œå³ URGã€ACKã€PSHã€RSTã€SYNã€FIN ç­‰ï¼Œå…·ä½“å«ä¹‰å¦‚ä¸‹ï¼š</p>\n<ul>\n<li>ACKï¼šç¡®è®¤åºå·æœ‰æ•ˆã€‚</li>\n<li>FINï¼šé‡Šæ”¾ä¸€ä¸ªè¿æ¥ã€‚</li>\n<li>PSHï¼šæ¥æ”¶æ–¹åº”è¯¥å°½å¿«å°†è¿™ä¸ªæŠ¥æ–‡äº¤ç»™åº”ç”¨å±‚ã€‚</li>\n<li>RSTï¼šé‡ç½®è¿æ¥ã€‚</li>\n<li>SYNï¼šå‘èµ·ä¸€ä¸ªæ–°è¿æ¥ã€‚</li>\n<li>URGï¼šç´§æ€¥æŒ‡é’ˆï¼ˆurgent pointerï¼‰æœ‰æ•ˆã€‚</li>\n</ul>\n<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</p>\n<ul>\n<li>ä¸è¦å°†ç¡®è®¤åºå· ack ä¸æ ‡å¿—ä½ä¸­çš„ ACK ææ··äº†ã€‚</li>\n<li>ç¡®è®¤æ–¹ ack&#x3D;å‘èµ·æ–¹ seq+1ï¼Œä¸¤ç«¯é…å¯¹ã€‚</li>\n</ul>\n<h3 id=\"ä¸‰æ¬¡æ¡æ‰‹\"><a href=\"#ä¸‰æ¬¡æ¡æ‰‹\" class=\"headerlink\" title=\"ä¸‰æ¬¡æ¡æ‰‹\"></a>ä¸‰æ¬¡æ¡æ‰‹</h3><blockquote>\n<p>ä¸‰æ¬¡æ¡æ‰‹çš„æœ¬è´¨æ˜¯ç¡®è®¤é€šä¿¡åŒæ–¹æ”¶å‘æ•°æ®çš„èƒ½åŠ›</p>\n</blockquote>\n<p>A-&gt;B</p>\n<p>A å‘é€ç»™ Bï¼ŒB è‹¥æ”¶åˆ°</p>\n<blockquote>\n<p>è¯´æ˜BçŸ¥é“ï¼šAå¯ä»¥å‘ï¼ŒBå¯ä»¥æ”¶</p>\n</blockquote>\n<p>B è¿”å›ç»™ Aï¼ŒA è‹¥æ”¶åˆ°ï¼šè¯´æ˜ A ä¹‹å‰å‘ç»™ B çš„ B æ”¶åˆ°äº†ï¼ŒåŒæ—¶ B ä¹Ÿèƒ½ç»™è‡ªå·±å›ä¿¡ï¼Œè‡ªå·±èƒ½æ”¶åˆ°è¿™ä¸ªå›ä¿¡ã€‚</p>\n<blockquote>\n<p>è¯´æ˜ï¼šAçŸ¥é“ï¼šAèƒ½å‘èƒ½æ”¶ï¼ŒBèƒ½æ”¶èƒ½å‘</p>\n</blockquote>\n<p>ä½†æ˜¯æ­¤æ—¶ B ä¸çŸ¥é“ A æ˜¯å¦å¯ä»¥æ”¶ï¼ŒB æ˜¯å¦å‘é€æ­£å¸¸</p>\n<p>äºæ˜¯ A å‘é€ç»™ Bï¼ŒB è‹¥æ”¶åˆ°ï¼šè¯´æ˜ B çš„å‘é€å›ä¿¡ A èƒ½æ”¶åˆ°</p>\n<blockquote>\n<p>è¯´æ˜ï¼šB çŸ¥é“ A å¯ä»¥æ”¶ï¼ŒB å¯ä»¥å‘ï¼Œç»“åˆç¬¬ä¸€æ­¥ï¼Œå¾—åˆ° B ä¹ŸçŸ¥é“ A èƒ½å‘èƒ½æ”¶ï¼ŒB èƒ½æ”¶èƒ½å‘</p>\n</blockquote>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAyMC8xLzcvMTZmN2UwM2IxZWE1MDdlOA.png\" alt=\"ä¸‰æ¬¡æ¡æ‰‹\"></p>\n<h3 id=\"å››æ¬¡æŒ¥æ‰‹\"><a href=\"#å››æ¬¡æŒ¥æ‰‹\" class=\"headerlink\" title=\"å››æ¬¡æŒ¥æ‰‹\"></a>å››æ¬¡æŒ¥æ‰‹</h3><blockquote>\n<p>å››æ¬¡æŒ¥æ‰‹çš„ç›®çš„æ˜¯å…³é—­ä¸€ä¸ªè¿æ¥</p>\n</blockquote>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAyMC8xLzcvMTZmN2UwM2IyMWEwN2YwYw.png\" alt=\"å››æ¬¡æŒ¥æ‰‹\"></p>\n<p>A å’Œ B æ‰“ç”µè¯ï¼Œé€šè¯å³å°†ç»“æŸåï¼Œ<br>A è¯´â€œæˆ‘æ²¡å•¥è¦è¯´çš„äº†â€ï¼Œ<br>B å›ç­”â€œæˆ‘çŸ¥é“äº†â€ï¼Œ<br>ä½†æ˜¯ B å¯èƒ½è¿˜ä¼šæœ‰è¦è¯´çš„è¯ï¼ŒA ä¸èƒ½è¦æ±‚ B è·Ÿç€è‡ªå·±çš„èŠ‚å¥ç»“æŸé€šè¯ï¼Œäºæ˜¯ B å¯èƒ½åˆå·´æ‹‰å·´æ‹‰è¯´äº†ä¸€é€šï¼Œæœ€å B è¯´â€œæˆ‘è¯´å®Œäº†â€ï¼Œ<br>A å›ç­”â€œçŸ¥é“äº†â€ï¼Œè¿™æ ·é€šè¯æ‰ç®—ç»“æŸã€‚</p>\n","site":{"data":{}},"length":17051,"excerpt":"<blockquote>\n<p>æ•´ç†çš„è®¡ç®—æœºç½‘ç»œç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½","more":"</p>\n</blockquote>\n<h2 id=\"æ·±å…¥ç†è§£HTTPSå·¥ä½œåŸç†\"><a href=\"#æ·±å…¥ç†è§£HTTPSå·¥ä½œåŸç†\" class=\"headerlink\" title=\"æ·±å…¥ç†è§£HTTPSå·¥ä½œåŸç†\"></a>æ·±å…¥ç†è§£HTTPSå·¥ä½œåŸç†</h2><blockquote>\n<p><a href=\"https://juejin.cn/post/6844903830916694030\">https://juejin.cn/post/6844903830916694030</a></p>\n</blockquote>\n<h3 id=\"å‰è¨€\"><a href=\"#å‰è¨€\" class=\"headerlink\" title=\"å‰è¨€\"></a>å‰è¨€</h3><p>è¿‘å‡ å¹´ï¼Œäº’è”ç½‘å‘ç”Ÿç€ç¿»å¤©è¦†åœ°çš„å˜åŒ–ï¼Œå°¤å…¶æ˜¯æˆ‘ä»¬ä¸€ç›´ä¹ ä»¥ä¸ºå¸¸çš„ HTTP åè®®ï¼Œåœ¨é€æ¸çš„è¢« HTTPS åè®®æ‰€å–ä»£ï¼Œåœ¨æµè§ˆå™¨ã€æœç´¢å¼•æ“ã€CA æœºæ„ã€å¤§å‹äº’è”ç½‘ä¼ä¸šçš„å…±åŒä¿ƒè¿›ä¸‹ï¼Œäº’è”ç½‘è¿æ¥äº†â€œHTTPS åŠ å¯†æ—¶ä»£â€ï¼ŒHTTPS å°†åœ¨æœªæ¥çš„å‡ å¹´å†…å…¨é¢å–ä»£ HTTP æˆä¸ºä¼ è¾“åè®®çš„ä¸»æµã€‚</p>\n<p>è¯»å®Œæœ¬æ–‡ï¼Œå¸Œæœ›ä½ èƒ½æ˜ç™½ï¼š</p>\n<ul>\n<li>HTTP é€šä¿¡å­˜åœ¨ä»€ä¹ˆé—®é¢˜</li>\n<li>HTTPS å¦‚ä½•æ”¹è¿› HTTP å­˜åœ¨é‚£äº›é—®é¢˜</li>\n<li>HTTPS å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆ</li>\n</ul>\n<h3 id=\"ä¸€ã€ä»€ä¹ˆæ˜¯HTTPS\"><a href=\"#ä¸€ã€ä»€ä¹ˆæ˜¯HTTPS\" class=\"headerlink\" title=\"ä¸€ã€ä»€ä¹ˆæ˜¯HTTPS\"></a>ä¸€ã€ä»€ä¹ˆæ˜¯HTTPS</h3><p>HTTPS æ˜¯åœ¨ HTTP ä¸Šå»ºç«‹ SSL åŠ å¯†å±‚ï¼Œå¹¶å¯¹ä¼ è¾“æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œæ˜¯ HTTP åè®®çš„å®‰å…¨ç‰ˆã€‚ç°åœ¨å®ƒè¢«å¹¿æ³›ç”¨äºä¸‡ç»´ç½‘ä¸Šå®‰å…¨æ•æ„Ÿçš„é€šè®¯ï¼Œä¾‹å¦‚äº¤æ˜“æ”¯ä»˜æ–¹é¢ã€‚</p>\n<p>HTTPS ä¸»è¦ä½œç”¨æ˜¯ï¼š</p>\n<p>ï¼ˆ1ï¼‰å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œå¹¶å»ºç«‹ä¸€ä¸ªä¿¡æ¯å®‰å…¨é€šé“ï¼Œæ¥ä¿è¯ä¼ è¾“è¿‡ç¨‹ä¸­çš„æ•°æ®å®‰å…¨;</p>\n<p>ï¼ˆ2ï¼‰å¯¹ç½‘ç«™æœåŠ¡å™¨è¿›è¡ŒçœŸå®èº«ä»½è®¤è¯ã€‚</p>\n<p>æˆ‘ä»¬ç»å¸¸ä¼šåœ¨ Web çš„ç™»å½•é¡µé¢å’Œè´­ç‰©ç»“ç®—ç•Œé¢ç­‰ä½¿ç”¨ HTTPS é€šä¿¡ã€‚ä½¿ç”¨ HTTPS é€šä¿¡æ—¶ï¼Œä¸å†ç”¨<code>http://</code>ï¼Œè€Œæ˜¯æ”¹ç”¨<code>https://</code>ã€‚å¦å¤–ï¼Œå½“æµè§ˆå™¨è®¿é—® HTTPS é€šä¿¡æœ‰æ•ˆçš„ Web ç½‘ç«™æ—¶ï¼Œæµè§ˆå™¨çš„åœ°å€æ å†…ä¼šå‡ºç°ä¸€ä¸ªå¸¦é”çš„æ ‡è®°ã€‚å¯¹ HTTPS çš„æ˜¾ç¤ºæ–¹å¼ä¼šå› æµè§ˆå™¨çš„ä¸åŒè€Œæœ‰æ‰€æ”¹å˜ã€‚</p>\n<h3 id=\"äºŒã€ä¸ºä»€ä¹ˆéœ€è¦HTTPS\"><a href=\"#äºŒã€ä¸ºä»€ä¹ˆéœ€è¦HTTPS\" class=\"headerlink\" title=\"äºŒã€ä¸ºä»€ä¹ˆéœ€è¦HTTPS\"></a>äºŒã€ä¸ºä»€ä¹ˆéœ€è¦HTTPS</h3><p>åœ¨ HTTP åè®®ä¸­æœ‰å¯èƒ½å­˜åœ¨ä¿¡æ¯çªƒå–æˆ–èº«ä»½ä¼ªè£…ç­‰å®‰å…¨é—®é¢˜ã€‚ä½¿ç”¨ HTTPS é€šä¿¡æœºåˆ¶å¯ä»¥æœ‰æ•ˆåœ°é˜²æ­¢è¿™äº›é—®é¢˜ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£ä¸‹ HTTP åè®®å­˜åœ¨çš„å“ªäº›é—®é¢˜ï¼š</p>\n<ul>\n<li><p>é€šä¿¡ä½¿ç”¨æ˜æ–‡ï¼ˆä¸åŠ å¯†ï¼‰ï¼Œå†…å®¹å¯èƒ½è¢«<strong>çªƒå¬</strong> </p>\n<p>  ä¿¡æ¯åŠ å¯†ï¼šä½¿ç”¨éå¯¹ç§°åŠ å¯†ï¼ˆRSAï¼‰äº¤æ¢å¯†é’¥ï¼Œä½¿ç”¨å¯¹ç§°åŠ å¯†ï¼ˆAESï¼‰ä¼ è¾“æŠ¥æ–‡ï¼Œå…¼å¤‡å®‰å…¨ä¸æ•ˆç‡</p>\n</li>\n<li><p>æ— æ³•è¯æ˜æŠ¥æ–‡çš„å®Œæ•´æ€§ï¼Œæ‰€ä»¥å¯èƒ½é­<strong>ç¯¡æ”¹</strong> </p>\n<p>  å®Œæ•´æ€§æ ¡éªŒï¼šæ•°å­—ç­¾å</p>\n</li>\n<li><p>ä¸éªŒè¯é€šä¿¡æ–¹çš„èº«ä»½ï¼Œå› æ­¤æœ‰å¯èƒ½é­é‡<strong>ä¼ªè£…</strong> </p>\n<p>  èº«ä»½éªŒè¯ï¼šæ•°å­—è¯ä¹¦</p>\n</li>\n</ul>\n<h3 id=\"ä¸‰ã€HTTPSå¦‚ä½•è§£å†³HTTPä¸Šè¿°é—®é¢˜\"><a href=\"#ä¸‰ã€HTTPSå¦‚ä½•è§£å†³HTTPä¸Šè¿°é—®é¢˜\" class=\"headerlink\" title=\"ä¸‰ã€HTTPSå¦‚ä½•è§£å†³HTTPä¸Šè¿°é—®é¢˜?\"></a>ä¸‰ã€HTTPSå¦‚ä½•è§£å†³HTTPä¸Šè¿°é—®é¢˜?</h3><p><strong>æ‰€è°“HTTPSï¼Œå…¶å®å°±æ˜¯èº«æŠ«SSLåè®®è¿™å±‚å¤–å£³çš„HTTP</strong>ã€‚</p>\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422132445345.png\" alt=\"image-20220422132445345\" style=\"zoom:33%;\" />\n\n\n\n<p>åœ¨é‡‡ç”¨ SSL åï¼ŒHTTP å°±æ‹¥æœ‰äº† HTTPS çš„åŠ å¯†ã€å®Œæ•´æ€§æ ¡éªŒã€èº«ä»½éªŒè¯è¿™äº›åŠŸèƒ½ã€‚ä¹Ÿå°±æ˜¯è¯´<strong>HTTPåŠ ä¸ŠåŠ å¯†å¤„ç†å’Œè®¤è¯ä»¥åŠå®Œæ•´æ€§ä¿æŠ¤åå³æ˜¯HTTPS</strong>ã€‚</p>\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422132508534.png\" alt=\"image-20220422132508534\" style=\"zoom:33%;\" />\n\n<p>HTTPS åè®®çš„ä¸»è¦åŠŸèƒ½åŸºæœ¬éƒ½ä¾èµ–äº TLS&#x2F;SSL åè®®ï¼ŒTLS&#x2F;SSL çš„åŠŸèƒ½å®ç°ä¸»è¦ä¾èµ–äºä¸‰ç±»åŸºæœ¬ç®—æ³•ï¼šæ•£åˆ—å‡½æ•° ã€å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†ï¼Œ<strong>å…¶åˆ©ç”¨éå¯¹ç§°åŠ å¯†å®ç°èº«ä»½è®¤è¯å’Œå¯†é’¥åå•†ï¼Œå¯¹ç§°åŠ å¯†ç®—æ³•é‡‡ç”¨åå•†çš„å¯†é’¥å¯¹æ•°æ®åŠ å¯†ï¼ŒåŸºäºæ•£åˆ—å‡½æ•°éªŒè¯ä¿¡æ¯çš„å®Œæ•´æ€§</strong>ã€‚</p>\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422132525551.png\" alt=\"image-20220422132525551\" style=\"zoom:33%;\" />\n\n\n\n<h4 id=\"1-è§£å†³å†…å®¹å¯èƒ½è¢«çªƒå¬çš„é—®é¢˜â€”â€”åŠ å¯†\"><a href=\"#1-è§£å†³å†…å®¹å¯èƒ½è¢«çªƒå¬çš„é—®é¢˜â€”â€”åŠ å¯†\" class=\"headerlink\" title=\"1.è§£å†³å†…å®¹å¯èƒ½è¢«çªƒå¬çš„é—®é¢˜â€”â€”åŠ å¯†\"></a>1.è§£å†³å†…å®¹å¯èƒ½è¢«çªƒå¬çš„é—®é¢˜â€”â€”åŠ å¯†</h4><h4 id=\"æ–¹æ³•1-å¯¹ç§°åŠ å¯†\"><a href=\"#æ–¹æ³•1-å¯¹ç§°åŠ å¯†\" class=\"headerlink\" title=\"æ–¹æ³•1.å¯¹ç§°åŠ å¯†\"></a>æ–¹æ³•1.å¯¹ç§°åŠ å¯†</h4><p>è¿™ç§æ–¹å¼åŠ å¯†å’Œè§£å¯†åŒç”¨ä¸€ä¸ªå¯†é’¥ã€‚åŠ å¯†å’Œè§£å¯†éƒ½ä¼šç”¨åˆ°å¯†é’¥ã€‚<strong>æ²¡æœ‰å¯†é’¥å°±æ— æ³•å¯¹å¯†ç è§£å¯†ï¼Œåè¿‡æ¥è¯´ï¼Œä»»ä½•äººåªè¦æŒæœ‰å¯†é’¥å°±èƒ½è§£å¯†äº†</strong>ã€‚</p>\n<p>ä»¥å¯¹ç§°åŠ å¯†æ–¹å¼åŠ å¯†æ—¶å¿…é¡»å°†å¯†é’¥ä¹Ÿå‘ç»™å¯¹æ–¹ã€‚å¯ç©¶ç«Ÿæ€æ ·æ‰èƒ½å®‰å…¨åœ°è½¬äº¤ï¼Ÿåœ¨äº’è”ç½‘ä¸Šè½¬å‘å¯†é’¥æ—¶ï¼Œå¦‚æœé€šä¿¡è¢«ç›‘å¬é‚£ä¹ˆå¯†é’¥å°±å¯ä¼šè½äººæ”»å‡»è€…ä¹‹æ‰‹ï¼ŒåŒæ—¶ä¹Ÿå°±å¤±å»äº†åŠ å¯†çš„æ„ä¹‰ã€‚å¦å¤–è¿˜å¾—è®¾æ³•å®‰å…¨åœ°ä¿ç®¡æ¥æ”¶åˆ°çš„å¯†é’¥ã€‚</p>\n<h4 id=\"æ–¹æ³•2-éå¯¹ç§°åŠ å¯†\"><a href=\"#æ–¹æ³•2-éå¯¹ç§°åŠ å¯†\" class=\"headerlink\" title=\"æ–¹æ³•2.éå¯¹ç§°åŠ å¯†\"></a>æ–¹æ³•2.éå¯¹ç§°åŠ å¯†</h4><p>å…¬å¼€å¯†é’¥åŠ å¯†ä½¿ç”¨ä¸€å¯¹éå¯¹ç§°çš„å¯†é’¥ã€‚ä¸€æŠŠå«åšç§æœ‰å¯†é’¥ï¼Œå¦ä¸€æŠŠå«åšå…¬å¼€å¯†é’¥ã€‚é¡¾åæ€ä¹‰ï¼Œ<strong>ç§æœ‰å¯†é’¥ä¸èƒ½è®©å…¶ä»–ä»»ä½•äººçŸ¥é“ï¼Œè€Œå…¬å¼€å¯†é’¥åˆ™å¯ä»¥éšæ„å‘å¸ƒï¼Œä»»ä½•äººéƒ½å¯ä»¥è·å¾—</strong>ã€‚</p>\n<p>ä½¿ç”¨å…¬å¼€å¯†é’¥åŠ å¯†æ–¹å¼ï¼Œå‘é€å¯†æ–‡çš„ä¸€æ–¹ä½¿ç”¨<strong>å¯¹æ–¹çš„å…¬å¼€å¯†é’¥</strong>è¿›è¡ŒåŠ å¯†å¤„ç†ï¼Œå¯¹æ–¹æ”¶åˆ°è¢«åŠ å¯†çš„ä¿¡æ¯åï¼Œå†ä½¿ç”¨è‡ªå·±çš„ç§æœ‰å¯†é’¥è¿›è¡Œè§£å¯†ã€‚åˆ©ç”¨è¿™ç§æ–¹å¼ï¼Œä¸éœ€è¦å‘é€ç”¨æ¥è§£å¯†çš„ç§æœ‰å¯†é’¥ï¼Œä¹Ÿä¸å¿…æ‹…å¿ƒå¯†é’¥è¢«æ”»å‡»è€…çªƒå¬è€Œç›—èµ°ã€‚</p>\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422132541737.png\" alt=\"image-20220422132541737\" style=\"zoom:33%;\" />\n\n<p>éå¯¹ç§°åŠ å¯†çš„ç‰¹ç‚¹æ˜¯ä¿¡æ¯ä¼ è¾“ä¸€å¯¹å¤šï¼ŒæœåŠ¡å™¨åªéœ€è¦ç»´æŒä¸€ä¸ªç§é’¥å°±èƒ½å¤Ÿå’Œå¤šä¸ªå®¢æˆ·ç«¯è¿›è¡ŒåŠ å¯†é€šä¿¡ã€‚</p>\n<p>è¿™ç§æ–¹å¼æœ‰ä»¥ä¸‹ç¼ºç‚¹ï¼š</p>\n<ul>\n<li>å…¬é’¥æ˜¯å…¬å¼€çš„ï¼Œæ‰€ä»¥é’ˆå¯¹ç§é’¥åŠ å¯†çš„ä¿¡æ¯ï¼Œé»‘å®¢æˆªè·åå¯ä»¥ä½¿ç”¨å…¬é’¥è¿›è¡Œè§£å¯†ï¼Œè·å–å…¶ä¸­çš„å†…å®¹ï¼›</li>\n<li>å…¬é’¥å¹¶ä¸åŒ…å«æœåŠ¡å™¨çš„ä¿¡æ¯ï¼Œä½¿ç”¨éå¯¹ç§°åŠ å¯†ç®—æ³•æ— æ³•ç¡®ä¿æœåŠ¡å™¨èº«ä»½çš„åˆæ³•æ€§ï¼Œå­˜åœ¨ä¸­é—´äººæ”»å‡»çš„é£é™©ï¼ŒæœåŠ¡å™¨å‘é€ç»™å®¢æˆ·ç«¯çš„å…¬é’¥å¯èƒ½åœ¨ä¼ é€è¿‡ç¨‹ä¸­è¢«ä¸­é—´äººæˆªè·å¹¶ç¯¡æ”¹ï¼›</li>\n<li>ä½¿ç”¨éå¯¹ç§°åŠ å¯†<strong>åœ¨æ•°æ®åŠ å¯†è§£å¯†è¿‡ç¨‹éœ€è¦æ¶ˆè€—ä¸€å®šæ—¶é—´</strong>ï¼Œé™ä½äº†æ•°æ®ä¼ è¾“æ•ˆç‡ï¼›</li>\n</ul>\n<h4 id=\"æ–¹æ³•3-å¯¹ç§°åŠ å¯†-éå¯¹ç§°åŠ å¯†-HTTPSé‡‡ç”¨è¿™ç§æ–¹å¼\"><a href=\"#æ–¹æ³•3-å¯¹ç§°åŠ å¯†-éå¯¹ç§°åŠ å¯†-HTTPSé‡‡ç”¨è¿™ç§æ–¹å¼\" class=\"headerlink\" title=\"æ–¹æ³•3.å¯¹ç§°åŠ å¯†+éå¯¹ç§°åŠ å¯†(HTTPSé‡‡ç”¨è¿™ç§æ–¹å¼)\"></a>æ–¹æ³•3.å¯¹ç§°åŠ å¯†+éå¯¹ç§°åŠ å¯†(HTTPSé‡‡ç”¨è¿™ç§æ–¹å¼)</h4><p>ä½¿ç”¨å¯¹ç§°å¯†é’¥çš„å¥½å¤„æ˜¯è§£å¯†çš„æ•ˆç‡æ¯”è¾ƒå¿«ï¼Œä½¿ç”¨éå¯¹ç§°å¯†é’¥çš„å¥½å¤„æ˜¯å¯ä»¥ä½¿å¾—ä¼ è¾“çš„å†…å®¹ä¸èƒ½è¢«ç ´è§£ï¼Œå› ä¸ºå°±ç®—ä½ æ‹¦æˆªåˆ°äº†æ•°æ®ï¼Œä½†æ˜¯æ²¡æœ‰å¯¹åº”çš„ç§é’¥ï¼Œä¹Ÿæ˜¯ä¸èƒ½ç ´è§£å†…å®¹çš„ã€‚å°±æ¯”å¦‚è¯´ä½ æŠ¢åˆ°äº†ä¸€ä¸ªä¿é™©æŸœï¼Œä½†æ˜¯æ²¡æœ‰ä¿é™©æŸœçš„é’¥åŒ™ä¹Ÿä¸èƒ½æ‰“å¼€ä¿é™©æŸœã€‚é‚£æˆ‘ä»¬å°±å°†å¯¹ç§°åŠ å¯†ä¸éå¯¹ç§°åŠ å¯†ç»“åˆèµ·æ¥,å……åˆ†åˆ©ç”¨ä¸¤è€…å„è‡ªçš„ä¼˜åŠ¿ï¼Œ<strong>åœ¨äº¤æ¢å¯†é’¥ç¯èŠ‚ä½¿ç”¨éå¯¹ç§°åŠ å¯†æ–¹å¼ï¼Œä¹‹åçš„å»ºç«‹é€šä¿¡äº¤æ¢æŠ¥æ–‡é˜¶æ®µåˆ™ä½¿ç”¨å¯¹ç§°åŠ å¯†æ–¹å¼</strong>ã€‚</p>\n<p>å…·ä½“åšæ³•æ˜¯ï¼š<strong>å‘é€å¯†æ–‡çš„ä¸€æ–¹ä½¿ç”¨å¯¹æ–¹çš„å…¬é’¥è¿›è¡ŒåŠ å¯†å¤„ç†â€œå¯¹ç§°çš„å¯†é’¥â€ï¼Œç„¶åå¯¹æ–¹ç”¨è‡ªå·±çš„ç§é’¥è§£å¯†æ‹¿åˆ°â€œå¯¹ç§°çš„å¯†é’¥â€ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿äº¤æ¢çš„å¯†é’¥æ˜¯å®‰å…¨çš„å‰æä¸‹ï¼Œä½¿ç”¨å¯¹ç§°åŠ å¯†æ–¹å¼è¿›è¡Œé€šä¿¡</strong>ã€‚æ‰€ä»¥ï¼ŒHTTPS é‡‡ç”¨å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†ä¸¤è€…å¹¶ç”¨çš„æ··åˆåŠ å¯†æœºåˆ¶ã€‚</p>\n<h4 id=\"2-è§£å†³æŠ¥æ–‡å¯èƒ½é­ç¯¡æ”¹é—®é¢˜â€”â€”æ•°å­—ç­¾å\"><a href=\"#2-è§£å†³æŠ¥æ–‡å¯èƒ½é­ç¯¡æ”¹é—®é¢˜â€”â€”æ•°å­—ç­¾å\" class=\"headerlink\" title=\"2.è§£å†³æŠ¥æ–‡å¯èƒ½é­ç¯¡æ”¹é—®é¢˜â€”â€”æ•°å­—ç­¾å\"></a>2.è§£å†³æŠ¥æ–‡å¯èƒ½é­ç¯¡æ”¹é—®é¢˜â€”â€”æ•°å­—ç­¾å</h4><p>ç½‘ç»œä¼ è¾“è¿‡ç¨‹ä¸­éœ€è¦ç»è¿‡å¾ˆå¤šä¸­é—´èŠ‚ç‚¹ï¼Œè™½ç„¶æ•°æ®æ— æ³•è¢«è§£å¯†ï¼Œä½†å¯èƒ½è¢«ç¯¡æ”¹ï¼Œé‚£å¦‚ä½•æ ¡éªŒæ•°æ®çš„å®Œæ•´æ€§å‘¢ï¼Ÿâ€”-æ ¡éªŒæ•°å­—ç­¾åã€‚</p>\n<p><strong>æ•°å­—ç­¾åæœ‰ä¸¤ç§åŠŸæ•ˆ</strong>ï¼š</p>\n<ul>\n<li>èƒ½ç¡®å®šæ¶ˆæ¯ç¡®å®æ˜¯ç”±å‘é€æ–¹ç­¾åå¹¶å‘å‡ºæ¥çš„ï¼Œå› ä¸ºåˆ«äººå‡å†’ä¸äº†å‘é€æ–¹çš„ç­¾åã€‚</li>\n<li>æ•°å­—ç­¾åèƒ½ç¡®å®šæ¶ˆæ¯çš„å®Œæ•´æ€§,è¯æ˜æ•°æ®æ˜¯å¦æœªè¢«ç¯¡æ”¹è¿‡ã€‚</li>\n</ul>\n<p><strong>æ•°å­—ç­¾åå¦‚ä½•ç”Ÿæˆ:</strong></p>\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422132605229.png\" alt=\"image-20220422132605229\" style=\"zoom:33%;\" />\n\n<p>å°†ä¸€æ®µæ–‡æœ¬å…ˆç”¨ Hash å‡½æ•°ç”Ÿæˆæ¶ˆæ¯æ‘˜è¦ï¼Œç„¶åç”¨å‘é€è€…çš„ç§é’¥åŠ å¯†ç”Ÿæˆæ•°å­—ç­¾åï¼Œä¸åŸæ–‡æ–‡ä¸€èµ·ä¼ é€ç»™æ¥æ”¶è€…ã€‚æ¥ä¸‹æ¥å°±æ˜¯æ¥æ”¶è€…æ ¡éªŒæ•°å­—ç­¾åçš„æµç¨‹äº†ã€‚</p>\n<p><strong>æ ¡éªŒæ•°å­—ç­¾åæµç¨‹</strong>ï¼š</p>\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422132617982.png\" alt=\"image-20220422132617982\" style=\"zoom:33%;\" />\n\n<p>æ¥æ”¶è€…åªæœ‰ç”¨å‘é€è€…çš„å…¬é’¥æ‰èƒ½è§£å¯†è¢«åŠ å¯†çš„æ‘˜è¦ä¿¡æ¯ï¼Œç„¶åç”¨ HASH å‡½æ•°å¯¹æ”¶åˆ°çš„åŸæ–‡äº§ç”Ÿä¸€ä¸ªæ‘˜è¦ä¿¡æ¯ï¼Œä¸ä¸Šä¸€æ­¥å¾—åˆ°çš„æ‘˜è¦ä¿¡æ¯å¯¹æ¯”ã€‚å¦‚æœç›¸åŒï¼Œåˆ™è¯´æ˜æ”¶åˆ°çš„ä¿¡æ¯æ˜¯å®Œæ•´çš„ï¼Œåœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ²¡æœ‰è¢«ä¿®æ”¹ï¼Œå¦åˆ™è¯´æ˜ä¿¡æ¯è¢«ä¿®æ”¹è¿‡ï¼Œå› æ­¤æ•°å­—ç­¾åèƒ½å¤ŸéªŒè¯ä¿¡æ¯çš„å®Œæ•´æ€§ã€‚</p>\n<p>å‡è®¾æ¶ˆæ¯ä¼ é€’åœ¨ Kobeï¼ŒJames ä¸¤äººä¹‹é—´å‘ç”Ÿã€‚James å°†æ¶ˆæ¯è¿åŒæ•°å­—ç­¾åä¸€èµ·å‘é€ç»™ Kobeï¼ŒKobe æ¥æ”¶åˆ°æ¶ˆæ¯åï¼Œé€šè¿‡æ ¡éªŒæ•°å­—ç­¾åï¼Œå°±å¯ä»¥éªŒè¯æ¥æ”¶åˆ°çš„æ¶ˆæ¯å°±æ˜¯ James å‘é€çš„ã€‚å½“ç„¶ï¼Œè¿™ä¸ªè¿‡ç¨‹çš„å‰ææ˜¯ Kobe çŸ¥é“ James çš„å…¬é’¥ã€‚é—®é¢˜çš„å…³é”®çš„æ˜¯ï¼Œå’Œæ¶ˆæ¯æœ¬èº«ä¸€æ ·ï¼Œå…¬é’¥ä¸èƒ½åœ¨ä¸å®‰å…¨çš„ç½‘ç»œä¸­ç›´æ¥å‘é€ç»™ Kobe,æˆ–è€…è¯´æ‹¿åˆ°çš„å…¬é’¥å¦‚ä½•è¯æ˜æ˜¯ James çš„ã€‚</p>\n<p>æ­¤æ—¶å°±éœ€è¦å¼•å…¥äº†<strong>è¯ä¹¦é¢å‘æœºæ„</strong>ï¼ˆCertificate Authorityï¼Œç®€ç§° CAï¼‰ï¼ŒCA æ•°é‡å¹¶ä¸å¤šï¼ŒKobe å®¢æˆ·ç«¯å†…ç½®äº†æ‰€æœ‰å—ä¿¡ä»» CA çš„è¯ä¹¦ã€‚CA å¯¹ James çš„å…¬é’¥ï¼ˆå’Œå…¶ä»–ä¿¡æ¯ï¼‰æ•°å­—ç­¾ååç”Ÿæˆè¯ä¹¦ã€‚</p>\n<h4 id=\"3-è§£å†³é€šä¿¡æ–¹èº«ä»½å¯èƒ½è¢«ä¼ªè£…çš„é—®é¢˜â€”â€”æ•°å­—è¯ä¹¦\"><a href=\"#3-è§£å†³é€šä¿¡æ–¹èº«ä»½å¯èƒ½è¢«ä¼ªè£…çš„é—®é¢˜â€”â€”æ•°å­—è¯ä¹¦\" class=\"headerlink\" title=\"3.è§£å†³é€šä¿¡æ–¹èº«ä»½å¯èƒ½è¢«ä¼ªè£…çš„é—®é¢˜â€”â€”æ•°å­—è¯ä¹¦\"></a>3.è§£å†³é€šä¿¡æ–¹èº«ä»½å¯èƒ½è¢«ä¼ªè£…çš„é—®é¢˜â€”â€”æ•°å­—è¯ä¹¦</h4><p>æ•°å­—è¯ä¹¦è®¤è¯æœºæ„å¤„äºå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨åŒæ–¹éƒ½å¯ä¿¡èµ–çš„ç¬¬ä¸‰æ–¹æœºæ„çš„ç«‹åœºä¸Šã€‚</p>\n<p>æˆ‘ä»¬æ¥ä»‹ç»ä¸€ä¸‹æ•°å­—è¯ä¹¦è®¤è¯æœºæ„çš„ä¸šåŠ¡æµç¨‹ï¼š</p>\n<ul>\n<li>æœåŠ¡å™¨çš„è¿è¥äººå‘˜å‘ç¬¬ä¸‰æ–¹æœºæ„ CA æäº¤å…¬é’¥ã€ç»„ç»‡ä¿¡æ¯ã€ä¸ªäººä¿¡æ¯(åŸŸå)ç­‰ä¿¡æ¯å¹¶ç”³è¯·è®¤è¯;</li>\n<li>CA é€šè¿‡çº¿ä¸Šã€çº¿ä¸‹ç­‰å¤šç§æ‰‹æ®µéªŒè¯ç”³è¯·è€…æä¾›ä¿¡æ¯çš„çœŸå®æ€§ï¼Œå¦‚ç»„ç»‡æ˜¯å¦å­˜åœ¨ã€ä¼ä¸šæ˜¯å¦åˆæ³•ï¼Œæ˜¯å¦æ‹¥æœ‰åŸŸåçš„æ‰€æœ‰æƒç­‰;</li>\n<li>å¦‚ä¿¡æ¯å®¡æ ¸é€šè¿‡ï¼ŒCA ä¼šå‘ç”³è¯·è€…ç­¾å‘è®¤è¯æ–‡ä»¶-è¯ä¹¦ã€‚è¯ä¹¦åŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼šç”³è¯·è€…å…¬é’¥ã€ç”³è¯·è€…çš„ç»„ç»‡ä¿¡æ¯å’Œä¸ªäººä¿¡æ¯ã€ç­¾å‘æœºæ„ CA çš„ä¿¡æ¯ã€æœ‰æ•ˆæ—¶é—´ã€è¯ä¹¦åºåˆ—å·ç­‰ä¿¡æ¯çš„æ˜æ–‡ï¼ŒåŒæ—¶åŒ…å«ä¸€ä¸ªç­¾åã€‚ å…¶ä¸­ç­¾åçš„äº§ç”Ÿç®—æ³•ï¼šé¦–å…ˆï¼Œä½¿ç”¨æ•£åˆ—å‡½æ•°è®¡ç®—å…¬å¼€çš„æ˜æ–‡ä¿¡æ¯çš„ä¿¡æ¯æ‘˜è¦ï¼Œç„¶åï¼Œé‡‡ç”¨ CA çš„ç§é’¥å¯¹ä¿¡æ¯æ‘˜è¦è¿›è¡ŒåŠ å¯†ï¼Œå¯†æ–‡å³ç­¾å;</li>\n<li>å®¢æˆ·ç«¯ Client å‘æœåŠ¡å™¨ Server å‘å‡ºè¯·æ±‚æ—¶ï¼ŒServer è¿”å›è¯ä¹¦æ–‡ä»¶;</li>\n<li>å®¢æˆ·ç«¯ Client è¯»å–è¯ä¹¦ä¸­çš„ç›¸å…³çš„æ˜æ–‡ä¿¡æ¯ï¼Œé‡‡ç”¨ç›¸åŒçš„æ•£åˆ—å‡½æ•°è®¡ç®—å¾—åˆ°ä¿¡æ¯æ‘˜è¦ï¼Œç„¶åï¼Œåˆ©ç”¨å¯¹åº” CA çš„å…¬é’¥è§£å¯†ç­¾åæ•°æ®ï¼Œå¯¹æ¯”è¯ä¹¦çš„ä¿¡æ¯æ‘˜è¦ï¼Œå¦‚æœä¸€è‡´ï¼Œåˆ™å¯ä»¥ç¡®è®¤è¯ä¹¦çš„åˆæ³•æ€§ï¼Œå³æœåŠ¡å™¨çš„å…¬å¼€å¯†é’¥æ˜¯å€¼å¾—ä¿¡èµ–çš„ã€‚</li>\n<li>å®¢æˆ·ç«¯è¿˜ä¼šéªŒè¯è¯ä¹¦ç›¸å…³çš„åŸŸåä¿¡æ¯ã€æœ‰æ•ˆæ—¶é—´ç­‰ä¿¡æ¯; å®¢æˆ·ç«¯ä¼šå†…ç½®ä¿¡ä»» CA çš„è¯ä¹¦ä¿¡æ¯(åŒ…å«å…¬é’¥)ï¼Œå¦‚æœ CA ä¸è¢«ä¿¡ä»»ï¼Œåˆ™æ‰¾ä¸åˆ°å¯¹åº” CA çš„è¯ä¹¦ï¼Œè¯ä¹¦ä¹Ÿä¼šè¢«åˆ¤å®šéæ³•ã€‚</li>\n</ul>\n<h3 id=\"å››ã€-HTTPSå·¥ä½œæµç¨‹\"><a href=\"#å››ã€-HTTPSå·¥ä½œæµç¨‹\" class=\"headerlink\" title=\"å››ã€ HTTPSå·¥ä½œæµç¨‹\"></a>å››ã€ HTTPSå·¥ä½œæµç¨‹</h3><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesimage-20220422132710862.png\" alt=\"image-20220422132710862\" style=\"zoom:80%;\" />\n\n<p>1.Client å‘èµ·ä¸€ä¸ª HTTPSï¼ˆæ¯”å¦‚<code>https://juejin.cn/user/4283353031252967</code>ï¼‰çš„è¯·æ±‚ï¼Œæ ¹æ® RFC2818 çš„è§„å®šï¼ŒClient çŸ¥é“éœ€è¦è¿æ¥ Server çš„ 443ï¼ˆé»˜è®¤ï¼‰ç«¯å£ã€‚</p>\n<p>2.Server æŠŠäº‹å…ˆé…ç½®å¥½çš„å…¬é’¥è¯ä¹¦ï¼ˆpublic key certificateï¼‰è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</p>\n<p>3.Client éªŒè¯å…¬é’¥è¯ä¹¦ï¼šæ¯”å¦‚æ˜¯å¦åœ¨æœ‰æ•ˆæœŸå†…ï¼Œè¯ä¹¦çš„ç”¨é€”æ˜¯ä¸æ˜¯åŒ¹é… Client è¯·æ±‚çš„ç«™ç‚¹ï¼Œæ˜¯ä¸æ˜¯åœ¨ CRL åŠé”€åˆ—è¡¨é‡Œé¢ï¼Œå®ƒçš„ä¸Šä¸€çº§è¯ä¹¦æ˜¯å¦æœ‰æ•ˆï¼Œè¿™æ˜¯ä¸€ä¸ªé€’å½’çš„è¿‡ç¨‹ï¼Œç›´åˆ°éªŒè¯åˆ°æ ¹è¯ä¹¦ï¼ˆæ“ä½œç³»ç»Ÿå†…ç½®çš„ Root è¯ä¹¦æˆ–è€… Client å†…ç½®çš„ Root è¯ä¹¦ï¼‰ã€‚å¦‚æœéªŒè¯é€šè¿‡åˆ™ç»§ç»­ï¼Œä¸é€šè¿‡åˆ™æ˜¾ç¤ºè­¦å‘Šä¿¡æ¯ã€‚</p>\n<p>4.Client ä½¿ç”¨ä¼ªéšæœºæ•°ç”Ÿæˆå™¨ç”ŸæˆåŠ å¯†æ‰€ä½¿ç”¨çš„å¯¹ç§°å¯†é’¥ï¼Œç„¶åç”¨è¯ä¹¦çš„å…¬é’¥åŠ å¯†è¿™ä¸ªå¯¹ç§°å¯†é’¥ï¼Œå‘ç»™ Serverã€‚</p>\n<p>5.Server ä½¿ç”¨è‡ªå·±çš„ç§é’¥ï¼ˆprivate keyï¼‰è§£å¯†è¿™ä¸ªæ¶ˆæ¯ï¼Œå¾—åˆ°å¯¹ç§°å¯†é’¥ã€‚è‡³æ­¤ï¼ŒClient å’Œ Server åŒæ–¹éƒ½æŒæœ‰äº†ç›¸åŒçš„å¯¹ç§°å¯†é’¥ã€‚</p>\n<p>6.Server ä½¿ç”¨å¯¹ç§°å¯†é’¥åŠ å¯†â€œæ˜æ–‡å†…å®¹ Aâ€ï¼Œå‘é€ç»™ Clientã€‚</p>\n<p>7.Client ä½¿ç”¨å¯¹ç§°å¯†é’¥è§£å¯†å“åº”çš„å¯†æ–‡ï¼Œå¾—åˆ°â€œæ˜æ–‡å†…å®¹ Aâ€ã€‚</p>\n<p>8.Client å†æ¬¡å‘èµ· HTTPS çš„è¯·æ±‚ï¼Œä½¿ç”¨å¯¹ç§°å¯†é’¥åŠ å¯†è¯·æ±‚çš„â€œæ˜æ–‡å†…å®¹ Bâ€ï¼Œç„¶å Server ä½¿ç”¨å¯¹ç§°å¯†é’¥è§£å¯†å¯†æ–‡ï¼Œå¾—åˆ°â€œæ˜æ–‡å†…å®¹ Bâ€ã€‚</p>\n<h3 id=\"äº”ã€HTTP-ä¸-HTTPS-çš„åŒºåˆ«\"><a href=\"#äº”ã€HTTP-ä¸-HTTPS-çš„åŒºåˆ«\" class=\"headerlink\" title=\"äº”ã€HTTP ä¸ HTTPS çš„åŒºåˆ«\"></a>äº”ã€HTTP ä¸ HTTPS çš„åŒºåˆ«</h3><ul>\n<li><p>HTTP æ˜¯æ˜æ–‡ä¼ è¾“åè®®ï¼ŒHTTPS åè®®æ˜¯ç”± SSL+HTTP åè®®æ„å»ºçš„å¯è¿›è¡ŒåŠ å¯†ä¼ è¾“ã€èº«ä»½è®¤è¯çš„ç½‘ç»œåè®®ï¼Œæ¯” HTTP åè®®å®‰å…¨ã€‚</p>\n</li>\n<li><p>HTTPS æ¯” HTTP æ›´åŠ å®‰å…¨;</p>\n</li>\n<li><p>HTTPS éœ€è¦ç”¨åˆ° SSL è¯ä¹¦ï¼Œè€Œ HTTP ä¸ç”¨;</p>\n</li>\n<li><p>HTTPS æ ‡å‡†ç«¯å£ 443ï¼ŒHTTP æ ‡å‡†ç«¯å£ 80;</p>\n</li>\n<li><p>HTTPS åŸºäºä¼ è¾“å±‚ï¼ŒHTTP åŸºäºåº”ç”¨å±‚;</p>\n</li>\n<li><p>HTTPS åœ¨æµè§ˆå™¨æ˜¾ç¤ºç»¿è‰²å®‰å…¨é”ï¼ŒHTTP æ²¡æœ‰æ˜¾ç¤º;</p>\n</li>\n</ul>\n<h3 id=\"å…­ã€ä¸ºä½•ä¸æ‰€æœ‰çš„ç½‘ç«™éƒ½ä½¿ç”¨HTTPS\"><a href=\"#å…­ã€ä¸ºä½•ä¸æ‰€æœ‰çš„ç½‘ç«™éƒ½ä½¿ç”¨HTTPS\" class=\"headerlink\" title=\"å…­ã€ä¸ºä½•ä¸æ‰€æœ‰çš„ç½‘ç«™éƒ½ä½¿ç”¨HTTPS\"></a>å…­ã€ä¸ºä½•ä¸æ‰€æœ‰çš„ç½‘ç«™éƒ½ä½¿ç”¨HTTPS</h3><p>æ—¢ç„¶ HTTPS é‚£ä¹ˆå®‰å…¨å¯é ï¼Œé‚£ä¸ºä½•ä¸æ‰€æœ‰çš„ Web ç½‘ç«™éƒ½ä½¿ç”¨ HTTPSï¼Ÿ</p>\n<p>é¦–å…ˆï¼Œå¾ˆå¤šäººè¿˜æ˜¯ä¼šè§‰å¾— HTTPS å®æ–½æœ‰é—¨æ§›ï¼Œè¿™ä¸ªé—¨æ§›åœ¨äºéœ€è¦æƒå¨ CA é¢å‘çš„ SSL è¯ä¹¦ã€‚ä»è¯ä¹¦çš„é€‰æ‹©ã€è´­ä¹°åˆ°éƒ¨ç½²ï¼Œä¼ ç»Ÿçš„æ¨¡å¼ä¸‹éƒ½ä¼šæ¯”è¾ƒè€—æ—¶è€—åŠ›ã€‚</p>\n<p>å…¶æ¬¡ï¼ŒHTTPS æ™®éè®¤ä¸ºæ€§èƒ½æ¶ˆè€—è¦å¤§äº HTTPï¼Œå› ä¸º<strong>ä¸çº¯æ–‡æœ¬é€šä¿¡ç›¸æ¯”ï¼ŒåŠ å¯†é€šä¿¡ä¼šæ¶ˆè€—æ›´å¤šçš„CPUåŠå†…å­˜èµ„æº</strong>ã€‚å¦‚æœæ¯æ¬¡é€šä¿¡éƒ½åŠ å¯†ï¼Œä¼šæ¶ˆè€—ç›¸å½“å¤šçš„èµ„æºï¼Œå¹³æ‘Šåˆ°ä¸€å°è®¡ç®—æœºä¸Šæ—¶ï¼Œèƒ½å¤Ÿå¤„ç†çš„è¯·æ±‚æ•°é‡å¿…å®šä¹Ÿä¼šéšä¹‹å‡å°‘ã€‚ä½†äº‹å®å¹¶éå¦‚æ­¤ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡æ€§èƒ½ä¼˜åŒ–ã€æŠŠè¯ä¹¦éƒ¨ç½²åœ¨ SLB æˆ– CDNï¼Œæ¥è§£å†³æ­¤é—®é¢˜ã€‚ä¸¾ä¸ªå®é™…çš„ä¾‹å­ï¼Œâ€œåŒåä¸€â€æœŸé—´ï¼Œå…¨ç«™ HTTPS çš„æ·˜å®ã€å¤©çŒ«ä¾ç„¶ä¿è¯äº†ç½‘ç«™å’Œç§»åŠ¨ç«¯çš„è®¿é—®ã€æµè§ˆã€äº¤æ˜“ç­‰æ“ä½œçš„é¡ºç•…ã€å¹³æ»‘ã€‚é€šè¿‡æµ‹è¯•å‘ç°ï¼Œç»è¿‡ä¼˜åŒ–åçš„è®¸å¤šé¡µé¢æ€§èƒ½ä¸ HTTP æŒå¹³ç”šè‡³è¿˜æœ‰å°å¹…æå‡ï¼Œå› æ­¤ HTTPS ç»è¿‡ä¼˜åŒ–ä¹‹åå…¶å®å¹¶ä¸æ…¢ã€‚</p>\n<p>é™¤æ­¤ä¹‹å¤–ï¼Œ<strong>æƒ³è¦èŠ‚çº¦è´­ä¹°è¯ä¹¦çš„å¼€é”€ä¹Ÿæ˜¯åŸå› ä¹‹ä¸€</strong>ã€‚è¦è¿›è¡Œ HTTPS é€šä¿¡ï¼Œè¯ä¹¦æ˜¯å¿…ä¸å¯å°‘çš„ã€‚è€Œä½¿ç”¨çš„è¯ä¹¦å¿…é¡»å‘è®¤è¯æœºæ„ï¼ˆCAï¼‰è´­ä¹°ã€‚</p>\n<p>æœ€åæ˜¯å®‰å…¨æ„è¯†ã€‚ç›¸æ¯”å›½å†…ï¼Œå›½å¤–äº’è”ç½‘è¡Œä¸šçš„å®‰å…¨æ„è¯†å’ŒæŠ€æœ¯åº”ç”¨ç›¸å¯¹æˆç†Ÿï¼ŒHTTPS éƒ¨ç½²è¶‹åŠ¿æ˜¯ç”±ç¤¾ä¼šã€ä¼ä¸šã€æ”¿åºœå…±åŒå»æ¨åŠ¨çš„ã€‚</p>\n<h2 id=\"è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„\"><a href=\"#è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„\" class=\"headerlink\" title=\"è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„\"></a>è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„</h2><h3 id=\"ä»€ä¹ˆæ˜¯ç½‘ç»œç¼–ç¨‹\"><a href=\"#ä»€ä¹ˆæ˜¯ç½‘ç»œç¼–ç¨‹\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ç½‘ç»œç¼–ç¨‹\"></a>ä»€ä¹ˆæ˜¯ç½‘ç»œç¼–ç¨‹</h3><p>ç½‘ç»œç¼–ç¨‹çš„æœ¬è´¨æ˜¯å¤šå°è®¡ç®—æœºä¹‹é—´çš„æ•°æ®äº¤æ¢ã€‚ç°åœ¨çš„ç½‘ç»œç¼–ç¨‹åŸºæœ¬ä¸Šéƒ½æ˜¯åŸºäºè¯·æ±‚&#x2F;å“åº”æ–¹å¼çš„ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªè®¾å¤‡å‘é€è¯·æ±‚æ•°æ®ç»™å¦å¤–ä¸€ä¸ªï¼Œç„¶åæ¥æ”¶å¦ä¸€ä¸ªè®¾å¤‡çš„åé¦ˆã€‚åœ¨ç½‘ç»œç¼–ç¨‹ä¸­ï¼Œå‘èµ·è¿æ¥ç¨‹åºï¼Œä¹Ÿå°±æ˜¯å‘é€ç¬¬ä¸€æ¬¡è¯·æ±‚çš„ç¨‹åºï¼Œè¢«ç§°ä½œå®¢æˆ·ç«¯(Client)ï¼Œç­‰å¾…å…¶ä»–ç¨‹åºè¿æ¥çš„ç¨‹åºè¢«ç§°ä½œæœåŠ¡å™¨(Server)ã€‚å®¢æˆ·ç«¯ç¨‹åºå¯ä»¥åœ¨éœ€è¦çš„æ—¶å€™å¯åŠ¨ï¼Œè€ŒæœåŠ¡å™¨ä¸ºäº†èƒ½å¤Ÿæ—¶åˆ»å“åº”è¿æ¥ï¼Œåˆ™éœ€è¦ä¸€ç›´å¯åŠ¨ã€‚</p>\n<h3 id=\"ç½‘ç»œç¼–ç¨‹ä¸­ä¸¤ä¸ªä¸»è¦çš„é—®é¢˜\"><a href=\"#ç½‘ç»œç¼–ç¨‹ä¸­ä¸¤ä¸ªä¸»è¦çš„é—®é¢˜\" class=\"headerlink\" title=\"ç½‘ç»œç¼–ç¨‹ä¸­ä¸¤ä¸ªä¸»è¦çš„é—®é¢˜\"></a>ç½‘ç»œç¼–ç¨‹ä¸­ä¸¤ä¸ªä¸»è¦çš„é—®é¢˜</h3><p><strong>1ã€</strong>ä¸€ä¸ªæ˜¯å¦‚ä½•å‡†ç¡®çš„å®šä½ç½‘ç»œä¸Šä¸€å°æˆ–å¤šå°ä¸»æœºï¼Œ</p>\n<p><strong>2ã€</strong>å¦ä¸€ä¸ªå°±æ˜¯æ‰¾åˆ°ä¸»æœºåå¦‚ä½•å¯é é«˜æ•ˆçš„è¿›è¡Œæ•°æ®ä¼ è¾“ã€‚</p>\n<ul>\n<li>åœ¨ TCP&#x2F;IP åè®®ä¸­ IP å±‚ç½‘é™…å±‚ä¸»è¦è´Ÿè´£ç½‘ç»œä¸»æœºçš„å®šä½ï¼Œæ•°æ®ä¼ è¾“çš„è·¯ç”±ï¼Œç”± IP åœ°å€å¯ä»¥å”¯ä¸€åœ°ç¡®å®š Internet ä¸Šçš„ä¸€å°ä¸»æœºã€‚</li>\n<li>è€Œ TCP å±‚ä¼ è¾“å±‚åˆ™æä¾›é¢å‘åº”ç”¨çš„å¯é ï¼ˆTCPï¼‰çš„æˆ–éå¯é ï¼ˆUDPï¼‰çš„æ•°æ®ä¼ è¾“æœºåˆ¶ï¼Œè¿™æ˜¯ç½‘ç»œç¼–ç¨‹çš„ä¸»è¦å¯¹è±¡ï¼Œä¸€èˆ¬ä¸éœ€è¦å…³å¿ƒ IP å±‚æ˜¯å¦‚ä½•å¤„ç†æ•°æ®çš„ã€‚</li>\n</ul>\n<h3 id=\"ç½‘ç»œåè®®æ˜¯ä»€ä¹ˆ\"><a href=\"#ç½‘ç»œåè®®æ˜¯ä»€ä¹ˆ\" class=\"headerlink\" title=\"ç½‘ç»œåè®®æ˜¯ä»€ä¹ˆ\"></a>ç½‘ç»œåè®®æ˜¯ä»€ä¹ˆ</h3><p>åœ¨è®¡ç®—æœºç½‘ç»œè¦åšåˆ°äº•äº•æœ‰æ¡çš„äº¤æ¢æ•°æ®ï¼Œå°±å¿…é¡»éµå®ˆä¸€äº›äº‹å…ˆçº¦å®šå¥½çš„è§„åˆ™ï¼Œæ¯”å¦‚äº¤æ¢æ•°æ®çš„æ ¼å¼ã€æ˜¯å¦éœ€è¦å‘é€ä¸€ä¸ªåº”ç­”ä¿¡æ¯ã€‚è¿™äº›è§„åˆ™è¢«ç§°ä¸ºç½‘ç»œåè®®ã€‚</p>\n<h3 id=\"ä¸ºä»€ä¹ˆè¦å¯¹ç½‘ç»œåè®®åˆ†å±‚\"><a href=\"#ä¸ºä»€ä¹ˆè¦å¯¹ç½‘ç»œåè®®åˆ†å±‚\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆè¦å¯¹ç½‘ç»œåè®®åˆ†å±‚\"></a>ä¸ºä»€ä¹ˆè¦å¯¹ç½‘ç»œåè®®åˆ†å±‚</h3><p><strong>1ã€</strong>ç®€åŒ–é—®é¢˜éš¾åº¦å’Œå¤æ‚åº¦ã€‚ç”±äºå„å±‚ä¹‹é—´ç‹¬ç«‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†å‰²å¤§é—®é¢˜ä¸ºå°é—®é¢˜ã€‚</p>\n<p><strong>2ã€</strong>çµæ´»æ€§å¥½ã€‚å½“å…¶ä¸­ä¸€å±‚çš„æŠ€æœ¯å˜åŒ–æ—¶ï¼Œåªè¦å±‚é—´æ¥å£å…³ç³»ä¿æŒä¸å˜ï¼Œå…¶ä»–å±‚ä¸å—å½±å“ã€‚</p>\n<p><strong>3ã€</strong>æ˜“äºå®ç°å’Œç»´æŠ¤ã€‚</p>\n<p><strong>4ã€</strong>ä¿ƒè¿›æ ‡å‡†åŒ–å·¥ä½œã€‚åˆ†å¼€åï¼Œæ¯å±‚åŠŸèƒ½å¯ä»¥ç›¸å¯¹ç®€å•åœ°è¢«æè¿°</p>\n<h3 id=\"ä½“ç³»ç»“æ„\"><a href=\"#ä½“ç³»ç»“æ„\" class=\"headerlink\" title=\"ä½“ç³»ç»“æ„\"></a>ä½“ç³»ç»“æ„</h3><p><strong>TCP&#x2F;IPå‚è€ƒæ¨¡å‹</strong></p>\n<p>OSI ä¸ƒå±‚åè®®ï¼šåº”ç”¨ï¼ˆHTTPï¼‰ã€è¡¨ç¤ºï¼ˆSSL&#x2F;TLSï¼‰ã€ä¼šè¯ï¼ˆRPCï¼‰ã€ä¼ è¾“ï¼ˆTCPï¼‰ã€ç½‘ç»œï¼ˆIPï¼‰ã€é“¾è·¯ï¼ˆARPï¼‰ã€ç‰©ç†</p>\n<p>TCP&#x2F;IP å››å±‚åè®®ï¼ˆæ•°æ®é“¾è·¯å±‚ã€ç½‘ç»œå±‚ã€ä¼ è¾“å±‚ã€åº”ç”¨å±‚ï¼‰</p>\n<p><strong>1ã€</strong>åº”ç”¨å±‚ <strong>ä¸ºç”¨æˆ·æä¾›å„ç§ç½‘ç»œæœåŠ¡</strong>ã€‚æˆ‘ä»¬å¸¸è§åº”ç”¨å±‚çš„ç½‘ç»œæœåŠ¡åè®®æœ‰ï¼šHTTPï¼ŒHTTPSï¼ŒFTPï¼ŒTELNET ç­‰ã€‚ï¼ˆHTTP åè®®å…¨ç§° Hyper Text Transfer Protocol è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œåœ¨æµè§ˆå™¨ä¸æœåŠ¡å™¨é—´ä¼ é€æ–‡æ¡£ï¼‰</p>\n<p><strong>2ã€</strong>ä¼ è¾“å±‚ <strong>å»ºç«‹äº†ä¸»æœºç«¯åˆ°ç«¯çš„è¿æ¥</strong>ï¼Œä¼ è¾“å±‚çš„ä½œç”¨æ˜¯<strong>ä¸ºä¸Šå±‚åè®®æä¾›ç«¯åˆ°ç«¯çš„å¯é å’Œé€æ˜çš„æ•°æ®ä¼ è¾“æœåŠ¡</strong>ï¼ŒåŒ…æ‹¬å¤„ç†å·®é”™æ§åˆ¶å’Œæµé‡æ§åˆ¶ç­‰é—®é¢˜ã€‚ï¼ˆTCPã€UDPï¼‰</p>\n<p><strong>3ã€</strong>ç½‘ç»œå±‚ <strong>é€šè¿‡IPå¯»å€æ¥å»ºç«‹ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„è¿æ¥</strong>ï¼Œä¸ºæºç«¯çš„è¿è¾“å±‚é€æ¥çš„åˆ†ç»„ï¼Œé€‰æ‹©åˆé€‚çš„è·¯ç”±å’Œäº¤æ¢èŠ‚ç‚¹ï¼Œæ­£ç¡®æ— è¯¯åœ°æŒ‰ç…§åœ°å€ä¼ é€ç»™ç›®çš„ç«¯çš„è¿è¾“å±‚ã€‚ï¼ˆIPï¼‰</p>\n<p><strong>4ã€</strong>æ•°æ®é“¾è·¯å±‚ <strong>é€šè¿‡ä¸€äº›è§„åˆ™æ¥æ§åˆ¶è¿™äº›æ•°æ®çš„ä¼ è¾“</strong>ï¼Œä»¥ä¿è¯è¢«ä¼ è¾“æ•°æ®çš„æ­£ç¡®æ€§ã€‚å®ç°è¿™äº›è§„ç¨‹æˆ–åè®®çš„ç¡¬ä»¶å’Œè½¯ä»¶åŠ åˆ°ç‰©ç†çº¿è·¯ï¼Œè¿™æ ·å°±æ„æˆäº†æ•°æ®é“¾è·¯ã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯TCPå’ŒUDP\"><a href=\"#ä»€ä¹ˆæ˜¯TCPå’ŒUDP\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯TCPå’ŒUDP\"></a>ä»€ä¹ˆæ˜¯TCPå’ŒUDP</h3><table>\n<thead>\n<tr>\n<th></th>\n<th>TCP</th>\n<th>UDP</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>é¢å‘è¿æ¥</td>\n<td>é¢å‘è¿æ¥</td>\n<td>æ— è¿æ¥</td>\n</tr>\n<tr>\n<td>å¯é æ€§</td>\n<td>å¯é ä¼ è¾“ï¼Œä½¿ç”¨æ‹¥å¡æ§åˆ¶å’Œæµé‡æ§åˆ¶</td>\n<td>å¯é ä¼ è¾“</td>\n</tr>\n<tr>\n<td>è¿æ¥ä¸ªæ•°</td>\n<td>åªèƒ½ä¸€å¯¹ä¸€é€šä¿¡</td>\n<td>æ”¯æŒä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šã€å¤šå¯¹ä¸€ã€å¤šå¯¹å¤šé€šä¿¡</td>\n</tr>\n<tr>\n<td>ä½¿ç”¨åœºæ™¯</td>\n<td>è¦æ±‚å¯é ä¼ è¾“çš„åº”ç”¨ï¼ˆæ–‡ä»¶ä¼ è¾“ï¼‰</td>\n<td>å®æ—¶åº”ç”¨ï¼ˆè§†é¢‘ä¼šè®®ã€ç½‘ç»œç›´æ’­ï¼‰</td>\n</tr>\n</tbody></table>\n<h3 id=\"æµè§ˆå™¨ä¸­è¾“å…¥ï¼šç½‘å€åéƒ½å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿè¯·è¯¦ç»†é˜è¿°ã€‚\"><a href=\"#æµè§ˆå™¨ä¸­è¾“å…¥ï¼šç½‘å€åéƒ½å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿè¯·è¯¦ç»†é˜è¿°ã€‚\" class=\"headerlink\" title=\"æµè§ˆå™¨ä¸­è¾“å…¥ï¼šç½‘å€åéƒ½å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿè¯·è¯¦ç»†é˜è¿°ã€‚\"></a>æµè§ˆå™¨ä¸­è¾“å…¥ï¼šç½‘å€åéƒ½å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿè¯·è¯¦ç»†é˜è¿°ã€‚</h3><p><strong>1ã€</strong>åŸŸåè§£æï¼ŒåŸŸåâ†’IP åœ°å€ï¼Œè§£æè¿‡ç¨‹ä¾æ¬¡ç»è¿‡äº†æµè§ˆå™¨æœ¬åœ°ç¼“å­˜ã€ç³»ç»Ÿç¼“å­˜ã€hosts æ–‡ä»¶ã€è·¯ç”±å™¨ç¼“å­˜ã€ é€’å½’æœç´¢æ ¹åŸŸåæœåŠ¡å™¨ã€‚</p>\n<p><strong>2ã€</strong>å»ºç«‹ TCP&#x2F;IP è¿æ¥ï¼ˆä¸‰æ¬¡æ¡æ‰‹å…·ä½“è¿‡ç¨‹ï¼‰</p>\n<p><strong>3ã€</strong>ç”±æµè§ˆå™¨å‘é€ä¸€ä¸ª HTTP è¯·æ±‚</p>\n<p><strong>4ã€</strong>ç»è¿‡è·¯ç”±å™¨çš„è½¬å‘ï¼Œé€šè¿‡æœåŠ¡å™¨çš„é˜²ç«å¢™ï¼Œè¯¥ HTTP è¯·æ±‚åˆ°è¾¾äº†æœåŠ¡å™¨</p>\n<p><strong>5ã€</strong>æœåŠ¡å™¨å¤„ç†è¯¥ HTTP è¯·æ±‚ï¼Œè¿”å›ä¸€ä¸ª HTML æ–‡ä»¶</p>\n<p><strong>6ã€</strong>æµè§ˆå™¨è§£æè¯¥ HTML æ–‡ä»¶ï¼Œå¹¶ä¸”æ˜¾ç¤ºåœ¨æµè§ˆå™¨ç«¯</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640.webp\" alt=\"å›¾ç‰‡\"></p>\n<h3 id=\"TCP-åè®®å¦‚ä½•æ¥ä¿è¯ä¼ è¾“çš„å¯é æ€§\"><a href=\"#TCP-åè®®å¦‚ä½•æ¥ä¿è¯ä¼ è¾“çš„å¯é æ€§\" class=\"headerlink\" title=\"TCP åè®®å¦‚ä½•æ¥ä¿è¯ä¼ è¾“çš„å¯é æ€§\"></a>TCP åè®®å¦‚ä½•æ¥ä¿è¯ä¼ è¾“çš„å¯é æ€§</h3><p><strong>å¯¹äºå¯é æ€§ï¼ŒTCPé€šè¿‡ä»¥ä¸‹æ–¹å¼è¿›è¡Œä¿è¯ï¼š</strong></p>\n<blockquote>\n<p>æ¥æ”¶æ–¹å¯¹æ•°æ®åŒ…è¿›è¡Œæ£€æŸ¥ï¼Œæ˜¯å¦<strong>å¤±åº</strong>ï¼Œå¤±åºçš„è¯è¦é‡æ’åºï¼Œæ˜¯å¦<strong>é‡å¤</strong>ï¼Œé‡å¤çš„è¯å°†é‡å¤çš„æ•°æ®ä¸¢å¼ƒï¼Œæ˜¯å¦<strong>å‡ºé”™</strong>ï¼Œå‡ºé”™çš„è¯å°†è¯¥æŠ¥æ–‡æ®µä¸¢å¼ƒã€‚å¦åˆ™çš„è¯ï¼Œæ¥æ”¶æ–¹ä¼šç»™å‘é€æ–¹ä¸€ä¸ªå‘é€ä¸€ä¸ªç¡®è®¤ã€‚å‘é€æ–¹å‘é€ä¹‹åå¦‚æœæ²¡æœ‰æ”¶åˆ°è¿™ä¸ªç¡®è®¤åœ¨ä¸€å®šæ—¶é—´åä¼šé‡å‘è¿™ä¸ªæŠ¥æ–‡æ®µã€‚</p>\n</blockquote>\n<ul>\n<li><strong>æ•°æ®åŒ…æ ¡éªŒ</strong>ï¼šç›®çš„æ˜¯æ£€æµ‹æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­çš„ä»»ä½•å˜åŒ–ï¼Œè‹¥æ ¡éªŒå‡ºåŒ…æœ‰é”™ï¼Œåˆ™ä¸¢å¼ƒæŠ¥æ–‡æ®µå¹¶ä¸”ä¸ç»™å‡ºå“åº”ï¼Œè¿™æ—¶ TCP å‘é€æ•°æ®ç«¯è¶…æ—¶åä¼šé‡å‘æ•°æ®ï¼›</li>\n<li><strong>å¯¹å¤±åºæ•°æ®åŒ…é‡æ’åº</strong>ï¼šæ—¢ç„¶ TCP æŠ¥æ–‡æ®µä½œä¸º IP æ•°æ®æŠ¥æ¥ä¼ è¾“ï¼Œè€Œ IP æ•°æ®æŠ¥çš„åˆ°è¾¾å¯èƒ½ä¼šå¤±åºï¼Œå› æ­¤ TCP æŠ¥æ–‡æ®µçš„åˆ°è¾¾ä¹Ÿå¯èƒ½ä¼šå¤±åºã€‚TCP å°†å¯¹å¤±åºæ•°æ®è¿›è¡Œé‡æ–°æ’åºï¼Œç„¶åæ‰äº¤ç»™åº”ç”¨å±‚ï¼›</li>\n<li><strong>ä¸¢å¼ƒé‡å¤æ•°æ®</strong>ï¼šå¯¹äºé‡å¤æ•°æ®ï¼Œèƒ½å¤Ÿä¸¢å¼ƒé‡å¤æ•°æ®ï¼›</li>\n<li><strong>åº”ç­”æœºåˆ¶</strong>ï¼šå½“ TCP æ”¶åˆ°å‘è‡ª TCP è¿æ¥å¦ä¸€ç«¯çš„æ•°æ®ï¼Œå®ƒå°†å‘é€ä¸€ä¸ªç¡®è®¤ã€‚è¿™ä¸ªç¡®è®¤ä¸æ˜¯ç«‹å³å‘é€ï¼Œé€šå¸¸å°†æ¨è¿Ÿå‡ åˆ†ä¹‹ä¸€ç§’ï¼›</li>\n<li><strong>è¶…æ—¶é‡å‘</strong>ï¼šå½“ TCP å‘å‡ºä¸€ä¸ªæ®µåï¼Œå®ƒå¯åŠ¨ä¸€ä¸ªå®šæ—¶å™¨ï¼Œç­‰å¾…ç›®çš„ç«¯ç¡®è®¤æ”¶åˆ°è¿™ä¸ªæŠ¥æ–‡æ®µã€‚å¦‚æœä¸èƒ½åŠæ—¶æ”¶åˆ°ä¸€ä¸ªç¡®è®¤ï¼Œå°†é‡å‘è¿™ä¸ªæŠ¥æ–‡æ®µï¼›</li>\n<li><strong>æµé‡æ§åˆ¶</strong>ï¼šTCP è¿æ¥çš„æ¯ä¸€æ–¹éƒ½æœ‰å›ºå®šå¤§å°çš„ç¼“å†²ç©ºé—´ã€‚TCP çš„æ¥æ”¶ç«¯åªå…è®¸å¦ä¸€ç«¯å‘é€æ¥æ”¶ç«¯ç¼“å†²åŒºæ‰€èƒ½æ¥çº³çš„æ•°æ®ï¼Œè¿™å¯ä»¥é˜²æ­¢è¾ƒå¿«ä¸»æœºè‡´ä½¿è¾ƒæ…¢ä¸»æœºçš„ç¼“å†²åŒºæº¢å‡ºï¼Œè¿™å°±æ˜¯æµé‡æ§åˆ¶ã€‚<br>  TCP ä½¿ç”¨çš„æµé‡æ§åˆ¶åè®®æ˜¯<strong>å¯å˜å¤§å°çš„æ»‘åŠ¨çª—å£åè®®</strong>ã€‚</li>\n</ul>\n<h3 id=\"TCP-çš„æ‹¥å¡é¿å…æœºåˆ¶\"><a href=\"#TCP-çš„æ‹¥å¡é¿å…æœºåˆ¶\" class=\"headerlink\" title=\"TCP çš„æ‹¥å¡é¿å…æœºåˆ¶\"></a>TCP çš„æ‹¥å¡é¿å…æœºåˆ¶</h3><p><a href=\"https://www.cnblogs.com/hongdada/p/11206679.html\">https://www.cnblogs.com/hongdada/p/11206679.html</a></p>\n<p>æ‹¥å¡ï¼šå¯¹èµ„æºçš„éœ€æ±‚è¶…è¿‡äº†å¯ç”¨çš„èµ„æºã€‚è‹¥ç½‘ç»œä¸­è®¸å¤šèµ„æºåŒæ—¶ä¾›åº”ä¸è¶³ï¼Œç½‘ç»œçš„æ€§èƒ½å°±è¦æ˜æ˜¾å˜åï¼Œæ•´ä¸ªç½‘ç»œçš„ååé‡éšç€è´Ÿè·çš„å¢å¤§è€Œä¸‹é™ã€‚</p>\n<p>æ‹¥å¡æ§åˆ¶ï¼šé˜²æ­¢è¿‡å¤šçš„æ•°æ®æ³¨å…¥åˆ°ç½‘ç»œä¸­ï¼Œä½¿å¾—ç½‘ç»œä¸­çš„è·¯ç”±å™¨æˆ–é“¾è·¯ä¸è‡´è¿‡è½½ã€‚</p>\n<p>æ‹¥å¡æ§åˆ¶çš„æ–¹æ³•ï¼š</p>\n<p><strong>1ã€ æ…¢å¼€å§‹ + æ‹¥å¡é¿å…ï¼š</strong></p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes443934-20190718131944933-703202720.png\" alt=\"img\"></p>\n<p><strong>æ…¢å¼€å§‹</strong>ï¼šæ‹¥å¡çª—å£ä» 1ã€2ã€4 ä»¥æŒ‡æ•°è§„å¾‹å¢é•¿ï¼›</p>\n<p><strong>æ‹¥å¡é¿å…</strong>ï¼šåˆ°è¾¾æ…¢å¼€å§‹é˜ˆå€¼åï¼Œå¼€å§‹æ‹¥å¡é¿å…â€œåŠ æ³•å¢å¤§â€</p>\n<p><strong>2ã€å¿«é‡ä¼  + å¿«æ¢å¤ï¼š</strong><br><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes443934-20190718132020300-1269239957.png\" alt=\"img\"></p>\n<p><strong>å¿«é‡ä¼ </strong>ï¼š **å¿«é‡ä¼ è¦æ±‚æ¥æ”¶æ–¹åœ¨æ”¶åˆ°ä¸€ä¸ªå¤±åºçš„æŠ¥æ–‡æ®µåå°±ç«‹å³å‘å‡º é‡å¤ç¡®è®¤ **ï¼ˆä¸ºçš„æ˜¯ä½¿å‘é€æ–¹åŠæ—©çŸ¥é“æœ‰æŠ¥æ–‡æ®µæ²¡æœ‰åˆ°è¾¾å¯¹æ–¹ï¼‰è€Œä¸è¦ç­‰åˆ°è‡ªå·±å‘é€æ•°æ®æ—¶æå¸¦ç¡®è®¤ã€‚å¿«é‡ä¼ ç®—æ³•è§„å®šï¼Œ <strong>å‘é€æ–¹åªè¦ä¸€è¿æ”¶åˆ°ä¸‰ä¸ªé‡å¤ç¡®è®¤å°±åº”å½“ç«‹å³é‡ä¼ å¯¹æ–¹å°šæœªæ”¶åˆ°çš„æŠ¥æ–‡æ®µ</strong>ï¼Œè€Œä¸å¿…ç»§ç»­ç­‰å¾…è®¾ç½®çš„é‡ä¼ è®¡æ—¶å™¨æ—¶é—´åˆ°æœŸã€‚</p>\n<p><strong>å¿«æ¢å¤</strong>ï¼šå¿«é‡ä¼ é…åˆä½¿ç”¨çš„è¿˜æœ‰å¿«æ¢å¤ç®—æ³•ï¼Œå½“å‘é€æ–¹è¿ç»­æ”¶åˆ°ä¸‰ä¸ªé‡å¤ç¡®è®¤æ—¶ï¼Œå°±æ‰§è¡Œ<strong>â€œä¹˜æ³•å‡å°â€ç®—æ³•ï¼ŒæŠŠ ssthresh é—¨é™å‡åŠ</strong>ï¼Œä½†æ˜¯æ¥ä¸‹å»å¹¶ä¸æ‰§è¡Œæ…¢å¼€å§‹ç®—æ³•ï¼šå› ä¸ºå¦‚æœç½‘ç»œå‡ºç°æ‹¥å¡çš„è¯å°±ä¸ä¼šæ”¶åˆ°å¥½å‡ ä¸ªé‡å¤çš„ç¡®è®¤ï¼Œæ‰€ä»¥å‘é€æ–¹ç°åœ¨è®¤ä¸ºç½‘ç»œå¯èƒ½æ²¡æœ‰å‡ºç°æ‹¥å¡ã€‚æ‰€ä»¥æ­¤æ—¶ä¸æ‰§è¡Œæ…¢å¼€å§‹ç®—æ³•ï¼Œè€Œæ˜¯å°†æ‹¥å¡çª—å£è®¾ç½®ä¸ºæ…¢å¼€å§‹é˜ˆå€¼çš„å¤§å°ï¼Œ<strong>ç„¶åæ‰§è¡Œæ‹¥å¡é¿å…ç®—æ³•è®©æ‹¥å¡çª—å£çº¿æ€§åŠ 1</strong>ã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯Httpåè®®ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯Httpåè®®ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯Httpåè®®ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯Httpåè®®ï¼Ÿ</h3><ul>\n<li>Http åè®®å±äºåº”ç”¨å±‚ï¼Œæ˜¯åœ¨æµè§ˆå™¨ä¸æœåŠ¡å™¨é—´ä¼ é€æ–‡æ¡£çš„è§„èŒƒï¼Œç®€ç§°ä¸ºâ€œè¶…æ–‡æœ¬ä¼ è¾“åè®®â€</li>\n</ul>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes20210326001352.png\"></p>\n<h3 id=\"è¯´è¯´HTTPå¸¸ç”¨çš„çŠ¶æ€ç åŠå…¶å«ä¹‰ï¼Ÿ\"><a href=\"#è¯´è¯´HTTPå¸¸ç”¨çš„çŠ¶æ€ç åŠå…¶å«ä¹‰ï¼Ÿ\" class=\"headerlink\" title=\"è¯´è¯´HTTPå¸¸ç”¨çš„çŠ¶æ€ç åŠå…¶å«ä¹‰ï¼Ÿ\"></a>è¯´è¯´HTTPå¸¸ç”¨çš„çŠ¶æ€ç åŠå…¶å«ä¹‰ï¼Ÿ</h3><p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650518889206.webp\" alt=\"å›¾ç‰‡\"></p>\n<p>ä¸ç®¡æ˜¯ä¸æ˜¯é¢è¯•éœ€è¦ï¼Œæˆ‘ä»¬éƒ½è¦çŸ¥é“ï¼Œæ—¥å¸¸å¼€å‘ä¸­çš„è¿™å‡ ä¸ªçŠ¶æ€ç çš„å«ä¹‰ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650518894201.webp\" alt=\"å›¾ç‰‡\"></p>\n<h3 id=\"Httpå’ŒHttpsçš„åŒºåˆ«ï¼Ÿ\"><a href=\"#Httpå’ŒHttpsçš„åŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"Httpå’ŒHttpsçš„åŒºåˆ«ï¼Ÿ\"></a>Httpå’ŒHttpsçš„åŒºåˆ«ï¼Ÿ</h3><p>Http åè®®è¿è¡Œåœ¨ TCP ä¹‹ä¸Šï¼Œæ˜æ–‡ä¼ è¾“ï¼Œå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ç«¯éƒ½æ— æ³•éªŒè¯å¯¹æ–¹çš„èº«ä»½ï¼›Https æ˜¯èº«æŠ« SSL(Secure Socket Layer)å¤–å£³çš„ Httpï¼Œè¿è¡Œäº SSL ä¸Šï¼ŒSSL è¿è¡Œäº TCP ä¹‹ä¸Šï¼Œæ˜¯æ·»åŠ äº†åŠ å¯†å’Œè®¤è¯æœºåˆ¶çš„ HTTPã€‚äºŒè€…ä¹‹é—´å­˜åœ¨å¦‚ä¸‹ä¸åŒï¼š</p>\n<ul>\n<li>ç«¯å£ä¸åŒï¼šHttp ä¸ Https ä½¿ç”¨ä¸åŒçš„è¿æ¥æ–¹å¼ï¼Œç”¨çš„ç«¯å£ä¹Ÿä¸ä¸€æ ·ï¼Œå‰è€…æ˜¯ 80ï¼Œåè€…æ˜¯ 443ï¼›</li>\n<li>èµ„æºæ¶ˆè€—ï¼šå’Œ HTTP é€šä¿¡ç›¸æ¯”ï¼ŒHttps é€šä¿¡ä¼šç”±äºåŠ å¯†è§£å¯†å¤„ç†æ¶ˆè€—æ›´å¤šçš„ CPU å’Œå†…å­˜èµ„æºï¼›</li>\n<li>å¼€é”€ï¼šHttps é€šä¿¡éœ€è¦è¯ä¹¦ï¼Œè€Œè¯ä¹¦ä¸€èˆ¬éœ€è¦å‘è®¤è¯æœºæ„è´­ä¹°ï¼›</li>\n</ul>\n<p>Https çš„åŠ å¯†æœºåˆ¶æ˜¯ä¸€ç§å…±äº«å¯†é’¥åŠ å¯†å’Œå…¬å¼€å¯†é’¥åŠ å¯†å¹¶ç”¨çš„æ··åˆåŠ å¯†æœºåˆ¶ã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯httpçš„è¯·æ±‚ä½“ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯httpçš„è¯·æ±‚ä½“ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯httpçš„è¯·æ±‚ä½“ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯httpçš„è¯·æ±‚ä½“ï¼Ÿ</h3><p><strong>1ã€</strong>HTTP è¯·æ±‚ä½“æ˜¯æˆ‘ä»¬è¯·æ±‚æ•°æ®æ—¶å…ˆå‘é€ç»™æœåŠ¡å™¨çš„æ•°æ®ï¼Œæ¯•ç«Ÿæˆ‘å‘æœåŠ¡å™¨æ‹¿æ•°æ®ï¼Œå…ˆè¦è¡¨æ˜æˆ‘è¦ä»€ä¹ˆå§</p>\n<p><strong>2ã€</strong>HTTP è¯·æ±‚ä½“ç”±ï¼š<strong>è¯·æ±‚è¡Œã€è¯·æ±‚å¤´ã€è¯·æ±‚ä½“</strong> ç»„æˆçš„</p>\n<blockquote>\n<p>è¯·æ±‚è¡Œï¼šè¯·æ±‚æ–¹æ³•ï¼ˆPOSTï¼‰ã€URLï¼ˆcharacter&#x2F;use.htmlï¼‰ å’Œ HTTP åè®®ç‰ˆæœ¬ï¼ˆHTTP&#x2F;1.1ï¼‰</p>\n<p>è¯·æ±‚å¤´ï¼š</p>\n<ul>\n<li>User-Agentï¼šå‘é€è¯·æ±‚çš„æµè§ˆå™¨ç±»å‹;</li>\n<li>Acceptï¼šå®¢æˆ·ç«¯å¯è¯†åˆ«çš„å“åº”å†…å®¹ç±»å‹åˆ—è¡¨;æ˜Ÿå· â€œ * â€ ç”¨äºæŒ‰èŒƒå›´å°†ç±»å‹åˆ†ç»„ï¼Œç”¨ â€œ <em>&#x2F;</em> â€ æŒ‡ç¤ºå¯æ¥å—å…¨éƒ¨ç±»å‹ï¼Œç”¨â€œ type&#x2F;* â€æŒ‡ç¤ºå¯æ¥å— type ç±»å‹çš„æ‰€æœ‰å­ç±»å‹;</li>\n<li>Accept-Languageï¼šå®¢æˆ·ç«¯å¯æ¥å—çš„è‡ªç„¶è¯­è¨€;</li>\n<li>Accept-Encodingï¼šå®¢æˆ·ç«¯å¯æ¥å—çš„ç¼–ç æ ¼å¼;</li>\n<li>Accept-Charsetï¼šå¯æ¥å—çš„åº”ç­”çš„å­—ç¬¦é›†;</li>\n<li>Hostï¼šè¯·æ±‚çš„ä¸»æœºåï¼Œå…è®¸å¤šä¸ªåŸŸååŒå¤„ä¸€ä¸ªIP åœ°å€ï¼Œå³è™šæ‹Ÿä¸»æœº;</li>\n<li>Connectionï¼šè¿æ¥æ–¹å¼(close æˆ– keepalive);</li>\n<li>Cookieï¼šå­˜å‚¨äºå®¢æˆ·ç«¯æ‰©å±•å­—æ®µï¼Œå‘åŒä¸€åŸŸåçš„æœåŠ¡ç«¯å‘é€å±äºè¯¥åŸŸçš„cookie;</li>\n</ul>\n</blockquote>\n<p><strong>3ã€</strong>æ³¨æ„ï¼šGET è¯·æ±‚æ˜¯æ²¡æœ‰è¯·æ±‚ä½“çš„</p>\n<h3 id=\"HTTPçš„å“åº”æŠ¥æ–‡æœ‰å“ªäº›ï¼Ÿ\"><a href=\"#HTTPçš„å“åº”æŠ¥æ–‡æœ‰å“ªäº›ï¼Ÿ\" class=\"headerlink\" title=\"HTTPçš„å“åº”æŠ¥æ–‡æœ‰å“ªäº›ï¼Ÿ\"></a>HTTPçš„å“åº”æŠ¥æ–‡æœ‰å“ªäº›ï¼Ÿ</h3><p><strong>1ã€</strong>http çš„å“åº”æŠ¥æ˜¯æœåŠ¡å™¨è¿”å›ç»™æˆ‘ä»¬çš„æ•°æ®ï¼Œå¿…é¡»å…ˆæœ‰è¯·æ±‚ä½“å†æœ‰å“åº”æŠ¥æ–‡</p>\n<p><strong>2ã€</strong>å“åº”æŠ¥æ–‡åŒ…å«ä¸‰éƒ¨åˆ† <strong>çŠ¶æ€è¡Œã€å“åº”å¤´ã€å“åº”ä½“</strong></p>\n<h3 id=\"Httpä¸­å¸¸è§çš„headerå­—æ®µæœ‰å“ªäº›ï¼Ÿ\"><a href=\"#Httpä¸­å¸¸è§çš„headerå­—æ®µæœ‰å“ªäº›ï¼Ÿ\" class=\"headerlink\" title=\"Httpä¸­å¸¸è§çš„headerå­—æ®µæœ‰å“ªäº›ï¼Ÿ\"></a>Httpä¸­å¸¸è§çš„headerå­—æ®µæœ‰å“ªäº›ï¼Ÿ</h3><p>cookieï¼Œè¯·æ±‚æ—¶ä¼ é€’ç»™æœåŠ¡ç«¯çš„ cookie ä¿¡æ¯<br>set-cookieï¼Œå“åº”æŠ¥æ–‡é¦–éƒ¨è®¾ç½®è¦ä¼ é€’ç»™å®¢æˆ·ç«¯çš„ cookie ä¿¡æ¯<br>allowï¼Œæ”¯æŒä»€ä¹ˆ HTTP æ–¹æ³•<br>last-modifiedï¼Œèµ„æºçš„æœ€åä¿®æ”¹æ—¶é—´<br>expires,è®¾ç½®èµ„æºç¼“å­˜çš„å¤±è´¥æ—¥æœŸ<br>content-languageï¼Œå®ä½“çš„èµ„æºè¯­è¨€<br>content-encodingï¼Œå®ä½“çš„ç¼–ç æ ¼å¼<br>content-lengthï¼Œå®ä½“ä¸»ä½“éƒ¨åˆ†çš„å¤§å°å•ä½æ˜¯å­—èŠ‚<br>content-rangeï¼Œè¿”å›çš„å®ä½“çš„å“ªäº›èŒƒå›´<br>content-typeï¼Œå“ªäº›ç±»å‹<br>accept-rangesï¼Œå¤„ç†çš„èŒƒå›´è¯·æ±‚<br>ageï¼Œå‘Šè¯‰å®¢æˆ·ç«¯æœåŠ¡å™¨åœ¨å¤šä¹…å‰åˆ›å»ºäº†å“åº”<br>varyï¼Œä»£ç†æœåŠ¡å™¨çš„ç¼“å­˜ä¿¡æ¯<br>locationï¼Œç”¨äºæŒ‡å®šé‡å®šå‘åçš„ URI<br>If-Matchï¼Œå€¼æ˜¯èµ„æºçš„å”¯ä¸€æ ‡è¯†<br>User-Agentï¼Œå°†åˆ›å»ºè¯·æ±‚çš„æµè§ˆå™¨å’Œç”¨æˆ·ä»£ç†åç§°ç­‰ä¿¡æ¯ä¼ é€’ç»™æœåŠ¡å™¨<br>Transfer-Encodingï¼Œä¼ è¾“æŠ¥æ–‡çš„ä¸»ä½“ç¼–ç æ–¹å¼<br>connectionï¼Œç®¡ç†æŒä¹…è¿æ¥ keep-alive , close Cache-Controlï¼Œæ§åˆ¶æµè§ˆå™¨çš„å¼ºç¼“å­˜</p>\n<h3 id=\"HTTPSå·¥ä½œåŸç†\"><a href=\"#HTTPSå·¥ä½œåŸç†\" class=\"headerlink\" title=\"HTTPSå·¥ä½œåŸç†\"></a>HTTPSå·¥ä½œåŸç†</h3><p>ï¼ˆAESï¼šéå¯¹ç§°åŠ å¯†ï¼›RSAï¼šå¯¹ç§°åŠ å¯†ï¼‰</p>\n<p><strong>1ã€</strong>é¦–å…ˆ HTTP è¯·æ±‚æœåŠ¡ç«¯ç”Ÿæˆè¯ä¹¦ï¼Œå®¢æˆ·ç«¯å¯¹è¯ä¹¦çš„æœ‰æ•ˆæœŸã€åˆæ³•æ€§ã€åŸŸåæ˜¯å¦ä¸è¯·æ±‚çš„åŸŸåä¸€è‡´ã€è¯ä¹¦çš„å…¬é’¥ï¼ˆRSA åŠ å¯†ï¼‰ç­‰è¿›è¡Œæ ¡éªŒï¼›</p>\n<p><strong>2ã€</strong>å®¢æˆ·ç«¯å¦‚æœæ ¡éªŒé€šè¿‡åï¼Œå°±æ ¹æ®è¯ä¹¦çš„å…¬é’¥çš„æœ‰æ•ˆï¼Œ ç”Ÿæˆéšæœºæ•°ï¼Œéšæœºæ•°ä½¿ç”¨å…¬é’¥è¿›è¡ŒåŠ å¯†ï¼ˆRSA åŠ å¯†ï¼‰ï¼›</p>\n<p><strong>3ã€</strong>æ¶ˆæ¯ä½“äº§ç”Ÿä¹‹åï¼Œå¯¹å®ƒçš„æ‘˜è¦è¿›è¡Œ MD5ï¼ˆæˆ–è€… SHA1ï¼‰ç®—æ³•åŠ å¯†ï¼Œæ­¤æ—¶å°±å¾—åˆ°äº† RSA ç­¾åï¼›</p>\n<p><strong>4ã€</strong>å‘é€ç»™æœåŠ¡ç«¯ï¼Œæ­¤æ—¶åªæœ‰æœåŠ¡ç«¯ï¼ˆRSA ç§é’¥ï¼‰èƒ½è§£å¯†ã€‚</p>\n<p><strong>5ã€</strong>è§£å¯†å¾—åˆ°çš„éšæœºæ•°ï¼Œå†ç”¨ AES åŠ å¯†ï¼Œä½œä¸ºå¯†é’¥ï¼ˆæ­¤æ—¶çš„å¯†é’¥åªæœ‰å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çŸ¥é“ï¼‰ã€‚</p>\n<h3 id=\"â­ä¸ºä»€ä¹ˆ-TCP-é“¾æ¥éœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Œä¸¤æ¬¡ä¸å¯ä»¥ä¹ˆï¼Ÿ\"><a href=\"#â­ä¸ºä»€ä¹ˆ-TCP-é“¾æ¥éœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Œä¸¤æ¬¡ä¸å¯ä»¥ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"â­ä¸ºä»€ä¹ˆ TCP é“¾æ¥éœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Œä¸¤æ¬¡ä¸å¯ä»¥ä¹ˆï¼Ÿ\"></a>â­ä¸ºä»€ä¹ˆ TCP é“¾æ¥éœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Œä¸¤æ¬¡ä¸å¯ä»¥ä¹ˆï¼Ÿ</h3><p>â€œä¸‰æ¬¡æ¡æ‰‹â€ çš„ç›®çš„æ˜¯ä¸ºäº†é˜²æ­¢<strong>å·²å¤±æ•ˆçš„é“¾æ¥è¯·æ±‚æŠ¥æ–‡çªç„¶åˆä¼ é€åˆ°äº†æœåŠ¡ç«¯</strong>ï¼Œå› è€Œäº§ç”Ÿé”™è¯¯ã€‚</p>\n<ul>\n<li>æ­£å¸¸çš„æƒ…å†µï¼šA å‘å‡ºè¿æ¥è¯·æ±‚ï¼Œä½†å› è¿æ¥è¯·æ±‚æŠ¥æ–‡ä¸¢å¤±è€Œæœªæ”¶åˆ°ç¡®è®¤ï¼Œäºæ˜¯ A å†é‡ä¼ ä¸€æ¬¡è¿æ¥è¯·æ±‚ã€‚åæ¥æ”¶åˆ°äº†ç¡®è®¤ï¼Œå»ºç«‹äº†è¿æ¥ã€‚æ•°æ®ä¼ è¾“å®Œæ¯•åï¼Œå°±é‡Šæ”¾äº†è¿æ¥ã€‚A å…±å‘é€äº†ä¸¤ä¸ªè¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªä¸¢å¤±ï¼Œç¬¬äºŒä¸ªåˆ°è¾¾äº† Bã€‚æ²¡æœ‰ â€œå·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µâ€ã€‚</li>\n<li>å‡å®šå‡ºç°äº†ä¸€ç§å¼‚å¸¸æƒ…å†µï¼šå³ A å‘å‡ºçš„ç¬¬ä¸€ä¸ªè¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µå¹¶æ²¡æœ‰ä¸¢å¤±ï¼Œè€Œæ˜¯åœ¨æŸä¸ªç½‘ç»œç»“ç‚¹é•¿æ—¶é—´çš„æ»ç•™äº†ï¼Œä»¥è‡´å»¶è¯¯åˆ°è¿æ¥é‡Šæ”¾ä»¥åçš„æŸä¸ªæ—¶é—´æ‰åˆ°è¾¾ Bã€‚æœ¬æ¥è¿™æ˜¯ä¸€ä¸ªæ—©å·²å¤±æ•ˆçš„æŠ¥æ–‡æ®µã€‚ä½† B æ”¶åˆ°æ­¤å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µåï¼Œå°±è¯¯è®¤ä¸ºæ˜¯ A å†æ¬¡å‘å‡ºçš„ä¸€ä¸ªæ–°çš„è¿æ¥è¯·æ±‚ã€‚äºæ˜¯å°±å‘ A å‘å‡ºç¡®è®¤æŠ¥æ–‡æ®µï¼ŒåŒæ„å»ºç«‹è¿æ¥ã€‚</li>\n</ul>\n<p>å‡è®¾ä¸é‡‡ç”¨â€œä¸‰æ¬¡æ¡æ‰‹â€ï¼Œé‚£ä¹ˆåªè¦ B å‘å‡ºç¡®è®¤ï¼Œæ–°çš„è¿æ¥å°±å»ºç«‹äº†ã€‚ç”±äºç°åœ¨ A å¹¶æ²¡æœ‰å‘å‡ºå»ºç«‹è¿æ¥çš„è¯·æ±‚ï¼ˆå› ä¸ºé‚£ä¸ªæ˜¯å·²ç»å¤±æ•ˆçš„è¯·æ±‚ï¼‰ï¼Œå› æ­¤ä¸ä¼šç†ç¬ B çš„ç¡®è®¤ï¼Œä¹Ÿä¸ä¼šå‘ B å‘é€æ•°æ®ã€‚ä½† B å´ä»¥ä¸ºæ–°çš„è¿è¾“è¿æ¥å·²ç»å»ºç«‹ï¼Œå¹¶ä¸€ç›´ç­‰å¾… A å‘æ¥æ•°æ®ã€‚è¿™æ ·ï¼ŒB çš„å¾ˆå¤šèµ„æºå°±ç™½ç™½æµªè´¹æ‰äº†ã€‚é‡‡ç”¨â€œä¸‰æ¬¡æ¡æ‰‹â€çš„åŠæ³•å¯ä»¥é˜²æ­¢ä¸Šè¿°ç°è±¡å‘ç”Ÿã€‚</p>\n<h3 id=\"â­ä¸ºä»€ä¹ˆè¦å››æ¬¡æŒ¥æ‰‹ï¼Ÿ\"><a href=\"#â­ä¸ºä»€ä¹ˆè¦å››æ¬¡æŒ¥æ‰‹ï¼Ÿ\" class=\"headerlink\" title=\"â­ä¸ºä»€ä¹ˆè¦å››æ¬¡æŒ¥æ‰‹ï¼Ÿ\"></a>â­ä¸ºä»€ä¹ˆè¦å››æ¬¡æŒ¥æ‰‹ï¼Ÿ</h3><p>TCP æ˜¯å…¨åŒå·¥æ¨¡å¼ï¼Œè¿™å°±æ„å‘³ç€ï¼Œ<br>å½“ A å‘ B å‘å‡º FIN æŠ¥æ–‡æ®µæ—¶ï¼Œåªæ˜¯è¡¨ç¤º A å·²ç»æ²¡æœ‰æ•°æ®è¦å‘é€äº†ï¼Œè€Œæ­¤æ—¶ A è¿˜æ˜¯èƒ½å¤Ÿæ¥å—åˆ°æ¥è‡ª B å‘å‡ºçš„æ•°æ®ï¼›å½“ B å‘ A å‘å‡º ACK æŠ¥æ–‡æ®µä¹Ÿåªæ˜¯å‘Šè¯‰ A ï¼Œå®ƒè‡ªå·±çŸ¥é“ A æ²¡æœ‰æ•°æ®è¦å‘äº†ï¼Œä½† B è¿˜æ˜¯èƒ½å¤Ÿå‘ A å‘é€æ•°æ®ã€‚</p>\n<p>æ‰€ä»¥æƒ³è¦æ„‰å¿«çš„ç»“æŸè¿™æ¬¡å¯¹è¯å°±éœ€è¦å››æ¬¡æŒ¥æ‰‹ã€‚</p>\n<h3 id=\"â­ä¸ºä»€ä¹ˆå®¢æˆ·ç«¯å‘å‡ºç¬¬å››æ¬¡æŒ¥æ‰‹çš„ç¡®è®¤æŠ¥æ–‡åè¦ç­‰2MSLçš„æ—¶é—´æ‰èƒ½é‡Šæ”¾TCPè¿æ¥ï¼Ÿ\"><a href=\"#â­ä¸ºä»€ä¹ˆå®¢æˆ·ç«¯å‘å‡ºç¬¬å››æ¬¡æŒ¥æ‰‹çš„ç¡®è®¤æŠ¥æ–‡åè¦ç­‰2MSLçš„æ—¶é—´æ‰èƒ½é‡Šæ”¾TCPè¿æ¥ï¼Ÿ\" class=\"headerlink\" title=\"â­ä¸ºä»€ä¹ˆå®¢æˆ·ç«¯å‘å‡ºç¬¬å››æ¬¡æŒ¥æ‰‹çš„ç¡®è®¤æŠ¥æ–‡åè¦ç­‰2MSLçš„æ—¶é—´æ‰èƒ½é‡Šæ”¾TCPè¿æ¥ï¼Ÿ\"></a>â­ä¸ºä»€ä¹ˆå®¢æˆ·ç«¯å‘å‡ºç¬¬å››æ¬¡æŒ¥æ‰‹çš„ç¡®è®¤æŠ¥æ–‡åè¦ç­‰2MSLçš„æ—¶é—´æ‰èƒ½é‡Šæ”¾TCPè¿æ¥ï¼Ÿ</h3><p>MSLï¼ˆMaximum Segment Lifetimeï¼‰<strong>æŠ¥æ–‡æœ€å¤§å¯¿å‘½</strong>ï¼ŒTCP å…è®¸ä¸åŒçš„å®ç°å¯ä»¥è®¾ç½®ä¸åŒçš„ MSL å€¼ã€‚</p>\n<p>ç¬¬ä¸€ï¼Œä¿è¯å®¢æˆ·ç«¯å‘é€çš„æœ€åä¸€ä¸ª ACK æŠ¥æ–‡èƒ½å¤Ÿåˆ°è¾¾æœåŠ¡å™¨ï¼Œå› ä¸ºè¿™ä¸ª ACK æŠ¥æ–‡å¯èƒ½ä¸¢å¤±ï¼Œç«™åœ¨æœåŠ¡å™¨çš„è§’åº¦çœ‹æ¥ï¼Œæˆ‘å·²ç»å‘é€äº† FIN+ACK æŠ¥æ–‡è¯·æ±‚æ–­å¼€äº†ï¼Œå®¢æˆ·ç«¯è¿˜æ²¡æœ‰ç»™æˆ‘å›åº”ï¼Œåº”è¯¥æ˜¯æˆ‘å‘é€çš„è¯·æ±‚æ–­å¼€æŠ¥æ–‡å®ƒæ²¡æœ‰æ”¶åˆ°ï¼Œäºæ˜¯æœåŠ¡å™¨åˆä¼šé‡æ–°å‘é€ä¸€æ¬¡ï¼Œè€Œå®¢æˆ·ç«¯å°±èƒ½åœ¨è¿™ä¸ª 2MSL æ—¶é—´æ®µå†…æ”¶åˆ°è¿™ä¸ªé‡ä¼ çš„æŠ¥æ–‡ï¼Œæ¥ç€ç»™å‡ºå›åº”æŠ¥æ–‡ï¼Œå¹¶ä¸”ä¼šé‡å¯ 2MSL è®¡æ—¶å™¨ã€‚</p>\n<p>ç¬¬äºŒï¼Œé˜²æ­¢ç±»ä¼¼ä¸â€œä¸‰æ¬¡æ¡æ‰‹â€ä¸­æåˆ°äº†çš„â€œå·²ç»å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µâ€å‡ºç°åœ¨æœ¬è¿æ¥ä¸­ã€‚å®¢æˆ·ç«¯å‘é€å®Œæœ€åä¸€ä¸ªç¡®è®¤æŠ¥æ–‡åï¼Œåœ¨è¿™ä¸ª 2MSL æ—¶é—´ä¸­ï¼Œå°±å¯ä»¥ä½¿æœ¬è¿æ¥æŒç»­çš„æ—¶é—´å†…æ‰€äº§ç”Ÿçš„æ‰€æœ‰æŠ¥æ–‡æ®µéƒ½ä»ç½‘ç»œä¸­æ¶ˆå¤±ã€‚è¿™æ ·æ–°çš„è¿æ¥ä¸­ä¸ä¼šå‡ºç°æ—§è¿æ¥çš„è¯·æ±‚æŠ¥æ–‡ã€‚<br>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”<br>åŸæ–‡é“¾æ¥ï¼š<a href=\"https://blog.csdn.net/qzcsu/article/details/72861891\">https://blog.csdn.net/qzcsu/article/details/72861891</a></p>\n<h3 id=\"â­å¦‚æœå·²ç»å»ºç«‹äº†è¿æ¥ï¼Œä½†æ˜¯å®¢æˆ·ç«¯çªç„¶å‡ºç°æ•…éšœäº†æ€ä¹ˆåŠï¼Ÿ\"><a href=\"#â­å¦‚æœå·²ç»å»ºç«‹äº†è¿æ¥ï¼Œä½†æ˜¯å®¢æˆ·ç«¯çªç„¶å‡ºç°æ•…éšœäº†æ€ä¹ˆåŠï¼Ÿ\" class=\"headerlink\" title=\"â­å¦‚æœå·²ç»å»ºç«‹äº†è¿æ¥ï¼Œä½†æ˜¯å®¢æˆ·ç«¯çªç„¶å‡ºç°æ•…éšœäº†æ€ä¹ˆåŠï¼Ÿ\"></a>â­å¦‚æœå·²ç»å»ºç«‹äº†è¿æ¥ï¼Œä½†æ˜¯å®¢æˆ·ç«¯çªç„¶å‡ºç°æ•…éšœäº†æ€ä¹ˆåŠï¼Ÿ</h3><p>TCP è¿˜è®¾æœ‰ä¸€ä¸ª<strong>ä¿æ´»è®¡æ—¶å™¨</strong>ï¼Œæ˜¾ç„¶ï¼Œå®¢æˆ·ç«¯å¦‚æœå‡ºç°æ•…éšœï¼ŒæœåŠ¡å™¨ä¸èƒ½ä¸€ç›´ç­‰ä¸‹å»ï¼Œç™½ç™½æµªè´¹èµ„æºã€‚æœåŠ¡å™¨æ¯æ”¶åˆ°ä¸€æ¬¡å®¢æˆ·ç«¯çš„è¯·æ±‚åéƒ½ä¼šé‡æ–°å¤ä½è¿™ä¸ªè®¡æ—¶å™¨ï¼Œæ—¶é—´é€šå¸¸æ˜¯è®¾ç½®ä¸º 2 å°æ—¶ï¼Œè‹¥ä¸¤å°æ—¶è¿˜æ²¡æœ‰æ”¶åˆ°å®¢æˆ·ç«¯çš„ä»»ä½•æ•°æ®ï¼ŒæœåŠ¡å™¨å°±ä¼šå‘é€ä¸€ä¸ª<strong>æ¢æµ‹æŠ¥æ–‡æ®µ</strong>ï¼Œä»¥åæ¯éš” 75 ç§’å‘é€ä¸€æ¬¡ã€‚è‹¥<strong>ä¸€è¿å‘é€10ä¸ªæ¢æµ‹æŠ¥æ–‡ä»ç„¶æ²¡ååº”</strong>ï¼ŒæœåŠ¡å™¨å°±è®¤ä¸ºå®¢æˆ·ç«¯å‡ºäº†æ•…éšœï¼Œæ¥ç€å°±<strong>å…³é—­è¿æ¥</strong>ã€‚<br>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”<br>åŸæ–‡é“¾æ¥ï¼š<a href=\"https://blog.csdn.net/qzcsu/article/details/72861891\">https://blog.csdn.net/qzcsu/article/details/72861891</a></p>\n<h3 id=\"IPåœ°å€æ˜¯æ€æ ·åˆ†ç±»çš„ï¼Œä½ çŸ¥é“å—ï¼Ÿ\"><a href=\"#IPåœ°å€æ˜¯æ€æ ·åˆ†ç±»çš„ï¼Œä½ çŸ¥é“å—ï¼Ÿ\" class=\"headerlink\" title=\"IPåœ°å€æ˜¯æ€æ ·åˆ†ç±»çš„ï¼Œä½ çŸ¥é“å—ï¼Ÿ\"></a>IPåœ°å€æ˜¯æ€æ ·åˆ†ç±»çš„ï¼Œä½ çŸ¥é“å—ï¼Ÿ</h3><p>å…ˆè¯´ä¸€ä¸‹ IP çš„åŸºæœ¬ç‰¹ç‚¹ï¼š</p>\n<ul>\n<li>IP åœ°å€ç”±å››æ®µç»„æˆï¼Œæ¯ä¸ªå­—æ®µæ˜¯ä¸€ä¸ªå­—èŠ‚ï¼Œ8 ä½ï¼Œæœ€å¤§å€¼æ˜¯ 255ã€‚</li>\n<li>IP åœ°å€ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œå³<strong>ç½‘ç»œåœ°å€</strong>å’Œ<strong>ä¸»æœºåœ°å€</strong>ã€‚<br>  ç½‘ç»œåœ°å€è¡¨ç¤ºå…¶å±äºäº’è”ç½‘çš„å“ªä¸€ä¸ªç½‘ç»œï¼Œä¸»æœºåœ°å€è¡¨ç¤ºå…¶å±äºè¯¥ç½‘ç»œä¸­çš„å“ªä¸€å°ä¸»æœºã€‚</li>\n</ul>\n<p>IP åœ°å€æ ¹æ®ç½‘ç»œåœ°å€è¿›è¡Œåˆ†ç±»ï¼Œä¸»è¦åˆ†ä¸º Aã€Bã€C ä¸‰ç±»åŠç‰¹æ®Šåœ°å€ Dã€E è¿™äº”ç±»</p>\n<p><strong>Aç±»ï¼š</strong> (1.0.0.0-126.0.0.0)ä¸€èˆ¬ç”¨äºå¤§å‹ç½‘ç»œã€‚</p>\n<p><strong>Bç±»ï¼š</strong> (128.0.0.0-191.255.0.0)ä¸€èˆ¬ç”¨äºä¸­ç­‰è§„æ¨¡ç½‘ç»œã€‚</p>\n<p><strong>Cç±»ï¼š</strong> (192.0.0.0-223.255.255.0)ä¸€èˆ¬ç”¨äºå°å‹ç½‘ç»œã€‚</p>\n<p><strong>Dç±»ï¼š</strong> æ˜¯å¤šæ’­åœ°å€ï¼Œåœ°å€çš„ç½‘ç»œå·å–å€¼äº 224~239 ä¹‹é—´ï¼Œä¸€èˆ¬ç”¨äºå¤šè·¯å¹¿æ’­ç”¨æˆ·ã€‚</p>\n<p><strong>Eç±»ï¼š</strong> æ˜¯ä¿ç•™åœ°å€ã€‚åœ°å€çš„ç½‘ç»œå·å–å€¼äº 240~255 ä¹‹é—´ã€‚</p>\n<h3 id=\"å®¢æˆ·ç«¯ä¸æ–­è¿›è¡Œè¯·æ±‚é“¾æ¥ä¼šæ€æ ·ï¼ŸDDos-Distributed-Denial-of-Service-æ”»å‡»ï¼Ÿ\"><a href=\"#å®¢æˆ·ç«¯ä¸æ–­è¿›è¡Œè¯·æ±‚é“¾æ¥ä¼šæ€æ ·ï¼ŸDDos-Distributed-Denial-of-Service-æ”»å‡»ï¼Ÿ\" class=\"headerlink\" title=\"å®¢æˆ·ç«¯ä¸æ–­è¿›è¡Œè¯·æ±‚é“¾æ¥ä¼šæ€æ ·ï¼ŸDDos(Distributed Denial of Service)æ”»å‡»ï¼Ÿ\"></a>å®¢æˆ·ç«¯ä¸æ–­è¿›è¡Œè¯·æ±‚é“¾æ¥ä¼šæ€æ ·ï¼ŸDDos(Distributed Denial of Service)æ”»å‡»ï¼Ÿ</h3><p>æœåŠ¡å™¨ç«¯ä¼šä¸ºæ¯ä¸ªè¯·æ±‚åˆ›å»ºä¸€ä¸ªé“¾æ¥ï¼Œå¹¶å‘å…¶å‘é€ç¡®è®¤æŠ¥æ–‡ï¼Œç„¶åç­‰å¾…å®¢æˆ·ç«¯è¿›è¡Œç¡®è®¤</p>\n<p><strong>(1) DDos æ”»å‡»ï¼š</strong></p>\n<ul>\n<li>å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€è¯·æ±‚é“¾æ¥æ•°æ®åŒ…</li>\n<li>æœåŠ¡ç«¯å‘å®¢æˆ·ç«¯å‘é€ç¡®è®¤æ•°æ®åŒ…</li>\n<li>å®¢æˆ·ç«¯å´ä¸å‘æœåŠ¡ç«¯å‘é€ç¡®è®¤æ•°æ®åŒ…ï¼ŒæœåŠ¡å™¨<strong>ä¸€ç›´ç­‰å¾…</strong>æ¥è‡ªå®¢æˆ·ç«¯çš„ç¡®è®¤</li>\n</ul>\n<p><strong>(2) DDos é¢„é˜²ï¼šï¼ˆæ²¡æœ‰å½»åº•æ ¹æ²»çš„åŠæ³•ï¼Œé™¤éä¸ä½¿ç”¨TCPï¼‰</strong></p>\n<ul>\n<li>é™åˆ¶åŒæ—¶æ‰“å¼€ SYN åŠé“¾æ¥çš„æ•°ç›®</li>\n<li>ç¼©çŸ­ SYN åŠé“¾æ¥çš„ Time out æ—¶é—´</li>\n<li>å…³é—­ä¸å¿…è¦çš„æœåŠ¡</li>\n</ul>\n<h3 id=\"GET-ä¸-POST-çš„åŒºåˆ«ï¼Ÿ\"><a href=\"#GET-ä¸-POST-çš„åŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"GET ä¸ POST çš„åŒºåˆ«ï¼Ÿ\"></a>GET ä¸ POST çš„åŒºåˆ«ï¼Ÿ</h3><p>GET ä¸ POST æ˜¯æˆ‘ä»¬å¸¸ç”¨çš„ä¸¤ç§ HTTP Methodï¼ŒäºŒè€…ä¹‹é—´çš„åŒºåˆ«ä¸»è¦åŒ…æ‹¬å¦‚ä¸‹äº”ä¸ªæ–¹é¢ï¼š</p>\n<p><strong>1ã€</strong> ä»åŠŸèƒ½ä¸Šè®²ï¼ŒGET ä¸€èˆ¬ç”¨æ¥<strong>ä»æœåŠ¡å™¨ä¸Šè·å–èµ„æº</strong>ï¼ŒPOST ä¸€èˆ¬ç”¨æ¥<strong>æ›´æ–°æœåŠ¡å™¨ä¸Šçš„èµ„æº</strong>ï¼›</p>\n<p><strong>2ã€</strong>ä»è¯·æ±‚å‚æ•°å½¢å¼ä¸Šçœ‹ï¼ŒGETè¯·æ±‚çš„æ•°æ®ä¼š<strong>é™„åœ¨URLä¸Š</strong>ï¼Œä»¥?åˆ†å‰² URL å’Œä¼ è¾“æ•°æ®ï¼Œå‚æ•°ä¹‹é—´ä»¥&amp;ç›¸è¿ï¼›è€Œ POST è¯·æ±‚ä¼šæŠŠæäº¤çš„æ•°æ®åˆ™æ”¾ç½®åœ¨ HTTP è¯·æ±‚æŠ¥æ–‡çš„ <strong>è¯·æ±‚ä½“</strong> ä¸­ã€‚</p>\n<p><strong>3ã€</strong>å°±å®‰å…¨æ€§è€Œè¨€ï¼ŒPOSTçš„<strong>å®‰å…¨æ€§</strong>è¦æ¯” GET çš„å®‰å…¨æ€§é«˜ï¼Œå› ä¸º GET è¯·æ±‚æäº¤çš„æ•°æ®å°†æ˜æ–‡å‡ºç°åœ¨ URL ä¸Šï¼Œè€Œä¸” POST è¯·æ±‚å‚æ•°åˆ™è¢«åŒ…è£…åˆ°è¯·æ±‚ä½“ä¸­ï¼Œç›¸å¯¹æ›´å®‰å…¨ã€‚</p>\n<p><strong>4ã€</strong>ä»è¯·æ±‚çš„å¤§å°çœ‹ï¼ŒGETè¯·æ±‚çš„<strong>é•¿åº¦</strong>å—é™äºæµè§ˆå™¨æˆ–æœåŠ¡å™¨å¯¹ URL é•¿åº¦çš„é™åˆ¶ï¼Œå…è®¸å‘é€çš„æ•°æ®é‡æ¯”è¾ƒå°ï¼Œè€Œ POST è¯·æ±‚åˆ™æ˜¯æ²¡æœ‰å¤§å°é™åˆ¶çš„ã€‚</p>\n<h3 id=\"DNSçš„å¯»å€è¿‡ç¨‹ä½ çŸ¥é“å—ï¼Ÿ\"><a href=\"#DNSçš„å¯»å€è¿‡ç¨‹ä½ çŸ¥é“å—ï¼Ÿ\" class=\"headerlink\" title=\"DNSçš„å¯»å€è¿‡ç¨‹ä½ çŸ¥é“å—ï¼Ÿ\"></a>DNSçš„å¯»å€è¿‡ç¨‹ä½ çŸ¥é“å—ï¼Ÿ</h3><p>æµè§ˆå™¨ç¼“å­˜ã€ç³»ç»Ÿç¼“å­˜ã€hosts æ–‡ä»¶ã€è·¯ç”±å™¨ç¼“å­˜ã€ é€’å½’æœç´¢æ ¹åŸŸåæœåŠ¡å™¨ã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯Socket\"><a href=\"#ä»€ä¹ˆæ˜¯Socket\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯Socket\"></a>ä»€ä¹ˆæ˜¯Socket</h3><p><strong>1ã€</strong>ç½‘ç»œä¸Šçš„ä¸¤ä¸ªç¨‹åºé€šè¿‡ä¸€ä¸ªåŒå‘çš„é€šè®¯è¿æ¥å®ç°æ•°æ®çš„äº¤æ¢ï¼Œè¿™ä¸ªåŒå‘é“¾è·¯çš„ä¸€ç«¯ç§°ä¸ºä¸€ä¸ª Socketã€‚Socket é€šå¸¸ç”¨æ¥å®ç°å®¢æˆ·æ–¹å’ŒæœåŠ¡æ–¹çš„è¿æ¥ã€‚Socket æ˜¯ TCP&#x2F;IP åè®®çš„ä¸€ä¸ªååˆ†æµè¡Œçš„ç¼–ç¨‹ç•Œé¢ï¼Œä¸€ä¸ª Socket ç”±ä¸€ä¸ª IP åœ°å€å’Œä¸€ä¸ªç«¯å£å·å”¯ä¸€ç¡®å®šã€‚</p>\n<p><strong>2ã€</strong>ä½†æ˜¯ï¼ŒSocket æ‰€æ”¯æŒçš„åè®®ç§ç±»ä¹Ÿä¸å…‰ TCP&#x2F;IPã€UDPï¼Œå› æ­¤ä¸¤è€…ä¹‹é—´æ˜¯æ²¡æœ‰å¿…ç„¶è”ç³»çš„ã€‚åœ¨ Java ç¯å¢ƒä¸‹ï¼ŒSocket ç¼–ç¨‹ä¸»è¦æ˜¯æŒ‡åŸºäº TCP&#x2F;IP åè®®çš„ç½‘ç»œç¼–ç¨‹ã€‚</p>\n<p><strong>3ã€</strong>socket è¿æ¥å°±æ˜¯æ‰€è°“çš„é•¿è¿æ¥ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨éœ€è¦äº’ç›¸è¿æ¥ï¼Œç†è®ºä¸Šå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ä¸€æ—¦å»ºç«‹èµ·è¿æ¥å°†ä¸ä¼šä¸»åŠ¨æ–­æ‰çš„ï¼Œä½†æ˜¯æœ‰æ—¶å€™ç½‘ç»œæ³¢åŠ¨è¿˜æ˜¯æœ‰å¯èƒ½çš„</p>\n<p><strong>4ã€</strong>Socket åå‘äºåº•å±‚ã€‚ä¸€èˆ¬å¾ˆå°‘ç›´æ¥ä½¿ç”¨ Socket æ¥ç¼–ç¨‹ï¼Œæ¡†æ¶åº•å±‚ä½¿ç”¨ Socket æ¯”è¾ƒå¤šï¼Œ</p>\n<h3 id=\"Socketå±äºç½‘ç»œçš„é‚£ä¸ªå±‚é¢\"><a href=\"#Socketå±äºç½‘ç»œçš„é‚£ä¸ªå±‚é¢\" class=\"headerlink\" title=\"Socketå±äºç½‘ç»œçš„é‚£ä¸ªå±‚é¢\"></a>Socketå±äºç½‘ç»œçš„é‚£ä¸ªå±‚é¢</h3><p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes20210325212441.png\"></p>\n<p>Socket æ˜¯åº”ç”¨å±‚ä¸ TCP&#x2F;IP åè®®æ—é€šä¿¡çš„ä¸­é—´è½¯ä»¶æŠ½è±¡å±‚ï¼Œå®ƒæ˜¯ä¸€ç»„æ¥å£ã€‚åœ¨è®¾è®¡æ¨¡å¼ä¸­ï¼ŒSocket å…¶å®å°±æ˜¯ä¸€ä¸ªå¤–è§‚æ¨¡å¼ï¼Œå®ƒæŠŠå¤æ‚çš„ TCP&#x2F;IP åè®®æ—éšè—åœ¨ Socket æ¥å£åé¢ï¼Œå¯¹ç”¨æˆ·æ¥è¯´ï¼Œä¸€ç»„ç®€å•çš„æ¥å£å°±æ˜¯å…¨éƒ¨ï¼Œè®© Socket å»ç»„ç»‡æ•°æ®ï¼Œä»¥ç¬¦åˆæŒ‡å®šçš„åè®®ã€‚</p>\n<h3 id=\"Socketé€šè®¯çš„è¿‡ç¨‹\"><a href=\"#Socketé€šè®¯çš„è¿‡ç¨‹\" class=\"headerlink\" title=\"Socketé€šè®¯çš„è¿‡ç¨‹\"></a>Socketé€šè®¯çš„è¿‡ç¨‹</h3><p><strong>åŸºäºTCPï¼š</strong></p>\n<p>æœåŠ¡å™¨ç«¯å…ˆåˆå§‹åŒ– Socketï¼Œç„¶åä¸ç«¯å£ç»‘å®š(bind)ï¼Œå¯¹ç«¯å£è¿›è¡Œç›‘å¬(listen)ï¼Œè°ƒç”¨ accept é˜»å¡ï¼Œç­‰å¾…å®¢æˆ·ç«¯è¿æ¥ã€‚åœ¨è¿™æ—¶å¦‚æœæœ‰ä¸ªå®¢æˆ·ç«¯åˆå§‹åŒ–ä¸€ä¸ª Socketï¼Œç„¶åè¿æ¥æœåŠ¡å™¨(connect)ï¼Œå¦‚æœè¿æ¥æˆåŠŸï¼Œè¿™æ—¶å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ç«¯çš„è¿æ¥å°±å»ºç«‹äº†ã€‚å®¢æˆ·ç«¯å‘é€æ•°æ®è¯·æ±‚ï¼ŒæœåŠ¡å™¨ç«¯æ¥æ”¶è¯·æ±‚å¹¶å¤„ç†è¯·æ±‚ï¼Œç„¶åæŠŠå›åº”æ•°æ®å‘é€ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯è¯»å–æ•°æ®ï¼Œæœ€åå…³é—­è¿æ¥ï¼Œä¸€æ¬¡äº¤äº’ç»“æŸã€‚</p>\n<p><strong>åŸºäºUDPï¼š</strong></p>\n<p>UDP åè®®æ˜¯ç”¨æˆ·æ•°æ®æŠ¥åè®®çš„ç®€ç§°ï¼Œä¹Ÿç”¨äºç½‘ç»œæ•°æ®çš„ä¼ è¾“ã€‚è™½ç„¶ UDP åè®®æ˜¯ä¸€ç§ä¸å¤ªå¯é çš„åè®®ï¼Œä½†æœ‰æ—¶åœ¨éœ€è¦è¾ƒå¿«åœ°æ¥æ”¶æ•°æ®å¹¶ä¸”å¯ä»¥å¿å—è¾ƒå°é”™è¯¯çš„æƒ…å†µä¸‹ï¼ŒUDP å°±ä¼šè¡¨ç°å‡ºæ›´å¤§çš„ä¼˜åŠ¿ã€‚æˆ‘å®¢æˆ·ç«¯åªéœ€è¦å‘é€ï¼ŒæœåŠ¡ç«¯èƒ½ä¸èƒ½æ¥æ”¶çš„åˆ°æˆ‘ä¸ç®¡</p>\n<h3 id=\"Socketå’Œhttpçš„åŒºåˆ«å’Œåº”ç”¨åœºæ™¯\"><a href=\"#Socketå’Œhttpçš„åŒºåˆ«å’Œåº”ç”¨åœºæ™¯\" class=\"headerlink\" title=\"Socketå’Œhttpçš„åŒºåˆ«å’Œåº”ç”¨åœºæ™¯\"></a>Socketå’Œhttpçš„åŒºåˆ«å’Œåº”ç”¨åœºæ™¯</h3><p><strong>1ã€</strong>Socket è¿æ¥å°±æ˜¯æ‰€è°“çš„é•¿è¿æ¥ï¼Œç†è®ºä¸Šå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ä¸€æ—¦å»ºç«‹èµ·è¿æ¥å°†ä¸ä¼šä¸»åŠ¨æ–­æ‰ï¼›</p>\n<p><strong>2ã€</strong>Socket é€‚ç”¨åœºæ™¯ï¼šç½‘ç»œæ¸¸æˆï¼Œé“¶è¡ŒæŒç»­äº¤äº’ï¼Œç›´æ’­ï¼Œåœ¨çº¿è§†å±ç­‰ã€‚</p>\n<p><strong>3ã€</strong>http è¿æ¥å°±æ˜¯æ‰€è°“çš„çŸ­è¿æ¥ï¼Œå³å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯å‘é€ä¸€æ¬¡è¯·æ±‚ï¼ŒæœåŠ¡å™¨ç«¯å“åº”åè¿æ¥å³ä¼šæ–­å¼€ç­‰å¾…ä¸‹æ¬¡è¿æ¥</p>\n<p><strong>4ã€</strong>http é€‚ç”¨åœºæ™¯ï¼šå…¬å¸ OA æœåŠ¡ï¼Œäº’è”ç½‘æœåŠ¡ï¼Œç”µå•†ï¼ŒåŠå…¬ï¼Œç½‘ç«™ç­‰ç­‰ç­‰ç­‰</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯-HTTP-åè®®æ— çŠ¶æ€åè®®ï¼Ÿæ€ä¹ˆè§£å†³Httpåè®®æ— çŠ¶æ€åè®®\"><a href=\"#ä»€ä¹ˆæ˜¯-HTTP-åè®®æ— çŠ¶æ€åè®®ï¼Ÿæ€ä¹ˆè§£å†³Httpåè®®æ— çŠ¶æ€åè®®\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ HTTP åè®®æ— çŠ¶æ€åè®®ï¼Ÿæ€ä¹ˆè§£å†³Httpåè®®æ— çŠ¶æ€åè®®?\"></a>ä»€ä¹ˆæ˜¯ HTTP åè®®æ— çŠ¶æ€åè®®ï¼Ÿæ€ä¹ˆè§£å†³Httpåè®®æ— çŠ¶æ€åè®®?</h3><p>HTTP æ˜¯ä¸€ä¸ªæ— çŠ¶æ€çš„åè®®ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰è®°å¿†åŠ›ï¼Œè¿™æ„å‘³ç€æ¯ä¸€æ¬¡çš„è¯·æ±‚éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œç¼ºå°‘çŠ¶æ€æ„å‘³ç€å¦‚æœåç»­å¤„ç†éœ€è¦å‰é¢çš„ä¿¡æ¯ï¼Œåˆ™å®ƒå¿…é¡»è¦é‡ä¼ ï¼Œè¿™æ ·å¯èƒ½å¯¼è‡´æ¯æ¬¡è¿æ¥ä¼ é€çš„æ•°æ®é‡å¢å¤§ã€‚æœåŠ¡å™¨æ— æ³•åˆ¤æ–­ç”¨æˆ·èº«ä»½ã€‚</p>\n<p>HTTP çš„è¿™ç§ç‰¹æ€§æœ‰ä¼˜ç‚¹ä¹Ÿæœ‰ç¼ºç‚¹ï¼š</p>\n<ul>\n<li><strong>ä¼˜ç‚¹</strong>ï¼šè§£æ”¾äº†æœåŠ¡å™¨ï¼Œæ¯ä¸€æ¬¡çš„è¯·æ±‚â€œç‚¹åˆ°ä¸ºæ­¢â€ï¼Œä¸ä¼šé€ æˆä¸å¿…è¦çš„è¿æ¥å ç”¨</li>\n<li><strong>ç¼ºç‚¹</strong>ï¼šæ¯æ¬¡è¯·æ±‚ä¼šä¼ è¾“å¤§é‡é‡å¤çš„å†…å®¹ä¿¡æ¯ï¼Œå¹¶ä¸”ï¼Œåœ¨è¯·æ±‚ä¹‹é—´æ— æ³•å®ç°æ•°æ®çš„å…±äº«</li>\n</ul>\n<p>è§£å†³æ–¹æ¡ˆï¼š</p>\n<ol>\n<li>ä½¿ç”¨å‚æ•°ä¼ é€’æœºåˆ¶ï¼š<br> å°†å‚æ•°æ‹¼æ¥åœ¨è¯·æ±‚çš„ URL åé¢ï¼Œå®ç°æ•°æ®çš„ä¼ é€’ï¼ˆGET æ–¹å¼ï¼‰ï¼Œä¾‹å¦‚ï¼š<code>/param/list?username=wmyskxz</code><br> <strong>é—®é¢˜</strong>ï¼šå¯ä»¥è§£å†³æ•°æ®å…±äº«çš„é—®é¢˜ï¼Œä½†æ˜¯è¿™ç§æ–¹å¼ä¸€ä¸å®‰å…¨ï¼ŒäºŒæ•°æ®å…è®¸ä¼ è¾“é‡åªæœ‰ 1kb</li>\n<li>ä½¿ç”¨ Cookie æŠ€æœ¯</li>\n<li>ä½¿ç”¨ Session æŠ€æœ¯</li>\n</ol>\n<p>Cookie å’Œ Session éƒ½æ˜¯å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´ä¿æŒçŠ¶æ€çš„è§£å†³æ–¹æ¡ˆï¼Œå…·ä½“æ¥è¯´ï¼Œcookie æœºåˆ¶é‡‡ç”¨çš„æ˜¯åœ¨å®¢æˆ·ç«¯ä¿æŒçŠ¶æ€çš„æ–¹æ¡ˆï¼Œè€Œ session æœºåˆ¶é‡‡ç”¨çš„æ˜¯åœ¨æœåŠ¡å™¨ç«¯ä¿æŒçŠ¶æ€çš„æ–¹æ¡ˆã€‚</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯Cookie\"><a href=\"#ä»€ä¹ˆæ˜¯Cookie\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯Cookie\"></a>ä»€ä¹ˆæ˜¯Cookie</h3><p>Cookie å®é™…ä¸Šæ˜¯ä¸€å°æ®µçš„æ–‡æœ¬ä¿¡æ¯ã€‚å®¢æˆ·ç«¯è¯·æ±‚æœåŠ¡å™¨ï¼Œå¦‚æœæœåŠ¡å™¨éœ€è¦è®°å½•è¯¥ç”¨æˆ·çŠ¶æ€ï¼Œå°±ä½¿ç”¨ response å‘å®¢æˆ·ç«¯æµè§ˆå™¨é¢å‘ä¸€ä¸ª Cookieï¼Œè€Œå®¢æˆ·ç«¯æµè§ˆå™¨ä¼šæŠŠ Cookie ä¿å­˜èµ·æ¥ã€‚å½“æµè§ˆå™¨å†è¯·æ±‚è¯¥ç½‘ç«™æ—¶ï¼Œæµè§ˆå™¨æŠŠè¯·æ±‚çš„ç½‘å€è¿åŒè¯¥ Cookie ä¸€åŒæäº¤ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨æ£€æŸ¥è¯¥ Cookieï¼Œä»¥æ­¤æ¥è¾¨è®¤ç”¨æˆ·çŠ¶æ€ã€‚æœåŠ¡å™¨è¿˜å¯ä»¥æ ¹æ®éœ€è¦ä¿®æ”¹ Cookie çš„å†…å®¹ã€‚ </p>\n<h3 id=\"ä»€ä¹ˆæ˜¯Session\"><a href=\"#ä»€ä¹ˆæ˜¯Session\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯Session\"></a>ä»€ä¹ˆæ˜¯Session</h3><p>session æ˜¯æµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¼šè¯è¿‡ç¨‹ä¸­ï¼ŒæœåŠ¡å™¨ä¼šåˆ†é…çš„ä¸€å—å‚¨å­˜ç©ºé—´ç»™ sessionã€‚</p>\n<p>æœåŠ¡å™¨é»˜è®¤ä¸ºå®¢æˆ·æµè§ˆå™¨çš„ cookie ä¸­è®¾ç½® sessionidï¼Œè¿™ä¸ª sessionid å°±å’Œ cookie å¯¹åº”ï¼Œæµè§ˆå™¨åœ¨å‘æœåŠ¡å™¨è¯·æ±‚è¿‡ç¨‹ä¸­ä¼ è¾“çš„ cookie åŒ…å« sessionid ï¼ŒæœåŠ¡å™¨æ ¹æ®ä¼ è¾“ cookie ä¸­çš„ sessionid è·å–å‡ºä¼šè¯ä¸­å­˜å‚¨çš„ä¿¡æ¯ï¼Œç„¶åç¡®å®šä¼šè¯çš„èº«ä»½ä¿¡æ¯ã€‚</p>\n<h3 id=\"Cookieå’ŒSessionå¯¹äºHTTPæœ‰ä»€ä¹ˆç”¨ï¼Ÿ\"><a href=\"#Cookieå’ŒSessionå¯¹äºHTTPæœ‰ä»€ä¹ˆç”¨ï¼Ÿ\" class=\"headerlink\" title=\"Cookieå’ŒSessionå¯¹äºHTTPæœ‰ä»€ä¹ˆç”¨ï¼Ÿ\"></a>Cookieå’ŒSessionå¯¹äºHTTPæœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h3><p> HTTP åè®®æœ¬èº«æ˜¯æ— æ³•åˆ¤æ–­ç”¨æˆ·èº«ä»½ã€‚æ‰€ä»¥éœ€è¦ cookie æˆ–è€… session</p>\n<h3 id=\"Cookieä¸SessionåŒºåˆ«\"><a href=\"#Cookieä¸SessionåŒºåˆ«\" class=\"headerlink\" title=\"Cookieä¸SessionåŒºåˆ«\"></a>Cookieä¸SessionåŒºåˆ«</h3><ul>\n<li><strong>å®ç°æœºåˆ¶</strong>ï¼šSession çš„å®ç°å¸¸å¸¸ä¾èµ–äº Cookie æœºåˆ¶ï¼Œé€šè¿‡ Cookie æœºåˆ¶å›ä¼  SessionIDï¼›</li>\n<li><strong>å¤§å°é™åˆ¶</strong>ï¼šCookie æœ‰å¤§å°é™åˆ¶å¹¶ä¸”æµè§ˆå™¨å¯¹æ¯ä¸ªç«™ç‚¹ä¹Ÿæœ‰ cookie çš„ä¸ªæ•°é™åˆ¶ï¼ŒSession æ²¡æœ‰å¤§å°é™åˆ¶ï¼Œç†è®ºä¸Šåªä¸æœåŠ¡å™¨çš„å†…å­˜å¤§å°æœ‰å…³ï¼›</li>\n<li><strong>å®‰å…¨æ€§</strong>ï¼šCookie å­˜åœ¨å®‰å…¨éšæ‚£ï¼Œé€šè¿‡æ‹¦æˆªæˆ–æœ¬åœ°æ–‡ä»¶æ‰¾å¾—åˆ° cookie åå¯ä»¥è¿›è¡Œæ”»å‡»ï¼Œè€Œ Session ç”±äºä¿å­˜åœ¨æœåŠ¡å™¨ç«¯ï¼Œç›¸å¯¹æ›´åŠ å®‰å…¨ï¼›</li>\n<li><strong>æœåŠ¡å™¨èµ„æºæ¶ˆè€—</strong>ï¼šSession æ˜¯ä¸€å®šæ—¶é—´å†…ä¿å­˜åœ¨æœåŠ¡å™¨ç«¯ä¸Šï¼Œå¦‚æœ session è¿‡å¤šä¼šå¢åŠ æœåŠ¡å™¨çš„å‹åŠ›ã€‚</li>\n</ul>\n<h3 id=\"ä»€ä¹ˆæ˜¯Token\"><a href=\"#ä»€ä¹ˆæ˜¯Token\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯Token\"></a>ä»€ä¹ˆæ˜¯Token</h3><p>Token çš„å¼•å…¥ï¼šToken æ˜¯åœ¨å®¢æˆ·ç«¯é¢‘ç¹å‘æœåŠ¡ç«¯è¯·æ±‚æ•°æ®ï¼ŒæœåŠ¡ç«¯é¢‘ç¹çš„å»æ•°æ®åº“æŸ¥è¯¢ç”¨æˆ·åå’Œå¯†ç å¹¶è¿›è¡Œå¯¹æ¯”ï¼Œåˆ¤æ–­ç”¨æˆ·åå’Œå¯†ç æ­£ç¡®ä¸å¦ï¼Œå¹¶ä½œå‡ºç›¸åº”æç¤ºï¼Œåœ¨è¿™æ ·çš„èƒŒæ™¯ä¸‹ï¼ŒToken ä¾¿åº”è¿è€Œç”Ÿã€‚</p>\n<p>Token çš„å®šä¹‰ï¼šToken æ˜¯æœåŠ¡ç«¯ç”Ÿæˆçš„ä¸€ä¸²å­—ç¬¦ä¸²ï¼Œä»¥ä½œå®¢æˆ·ç«¯è¿›è¡Œè¯·æ±‚çš„ä¸€ä¸ªä»¤ç‰Œï¼Œå½“ç¬¬ä¸€æ¬¡ç™»å½•åï¼ŒæœåŠ¡å™¨ç”Ÿæˆä¸€ä¸ª Token ä¾¿å°†æ­¤ Token è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œä»¥åå®¢æˆ·ç«¯åªéœ€å¸¦ä¸Šè¿™ä¸ª Token å‰æ¥è¯·æ±‚æ•°æ®å³å¯ï¼Œæ— éœ€å†æ¬¡å¸¦ä¸Šç”¨æˆ·åå’Œå¯†ç ã€‚</p>\n<p>ä½¿ç”¨ Token çš„ç›®çš„ï¼šToken çš„ç›®çš„æ˜¯ä¸ºäº†å‡è½»æœåŠ¡å™¨çš„å‹åŠ›ï¼Œå‡å°‘é¢‘ç¹çš„æŸ¥è¯¢æ•°æ®åº“ï¼Œä½¿æœåŠ¡å™¨æ›´åŠ å¥å£®ã€‚</p>\n<p>Token æ˜¯åœ¨æœåŠ¡ç«¯äº§ç”Ÿçš„ã€‚å¦‚æœå‰ç«¯ä½¿ç”¨ç”¨æˆ·å&#x2F;å¯†ç å‘æœåŠ¡ç«¯è¯·æ±‚è®¤è¯ï¼ŒæœåŠ¡ç«¯è®¤è¯æˆåŠŸï¼Œé‚£ä¹ˆåœ¨æœåŠ¡ç«¯ä¼šè¿”å› Token ç»™å‰ç«¯ã€‚å‰ç«¯å¯ä»¥åœ¨æ¯æ¬¡è¯·æ±‚çš„æ—¶å€™å¸¦ä¸Š Token <strong>è¯æ˜è‡ªå·±çš„åˆæ³•åœ°ä½</strong></p>\n<h3 id=\"sessionä¸tokenåŒºåˆ«\"><a href=\"#sessionä¸tokenåŒºåˆ«\" class=\"headerlink\" title=\"sessionä¸tokenåŒºåˆ«\"></a>sessionä¸tokenåŒºåˆ«</h3><ul>\n<li>session å­˜å‚¨åœ¨æœåŠ¡å™¨ç«¯ï¼Œtoken å­˜å‚¨åœ¨å®¢æˆ·ç«¯</li>\n<li>token æä¾›è®¤è¯å’ŒæˆæƒåŠŸèƒ½ï¼Œä½œä¸ºèº«ä»½è®¤è¯ï¼Œtoken å®‰å…¨æ€§æ¯” session å¥½ï¼›</li>\n<li>â­session è¿™ç§ä¼šè¯å­˜å‚¨æ–¹å¼æ–¹å¼åªé€‚ç”¨äºå®¢æˆ·ç«¯ä»£ç å’ŒæœåŠ¡ç«¯ä»£ç è¿è¡Œåœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šï¼Œtoken é€‚ç”¨äºé¡¹ç›®çº§çš„å‰åç«¯åˆ†ç¦»ï¼ˆå‰åç«¯ä»£ç è¿è¡Œåœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸‹ï¼‰</li>\n</ul>\n<h3 id=\"å¸¸ç”¨çš„HTTPæ–¹æ³•æœ‰å“ªäº›ï¼Ÿ\"><a href=\"#å¸¸ç”¨çš„HTTPæ–¹æ³•æœ‰å“ªäº›ï¼Ÿ\" class=\"headerlink\" title=\"å¸¸ç”¨çš„HTTPæ–¹æ³•æœ‰å“ªäº›ï¼Ÿ\"></a>å¸¸ç”¨çš„HTTPæ–¹æ³•æœ‰å“ªäº›ï¼Ÿ</h3><ul>\n<li><strong>GETï¼š</strong>ç”¨äºè¯·æ±‚è®¿é—®å·²ç»è¢« URIï¼ˆç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼‰è¯†åˆ«çš„èµ„æºï¼Œå¯ä»¥é€šè¿‡ URL ä¼ å‚ç»™æœåŠ¡å™¨</li>\n<li><strong>POSTï¼š</strong>ç”¨äºä¼ è¾“ä¿¡æ¯ç»™æœåŠ¡å™¨ï¼Œä¸»è¦åŠŸèƒ½ä¸ GET æ–¹æ³•ç±»ä¼¼ï¼Œä½†ä¸€èˆ¬æ¨èä½¿ç”¨ POST æ–¹å¼ã€‚</li>\n<li><strong>PUTï¼š</strong>ä¼ è¾“æ–‡ä»¶ï¼ŒæŠ¥æ–‡ä¸»ä½“ä¸­åŒ…å«æ–‡ä»¶å†…å®¹ï¼Œä¿å­˜åˆ°å¯¹åº” URI ä½ç½®ã€‚</li>\n<li><strong>HEADï¼š</strong>è·å¾—æŠ¥æ–‡é¦–éƒ¨ï¼Œä¸ GET æ–¹æ³•ç±»ä¼¼ï¼Œåªæ˜¯ä¸è¿”å›æŠ¥æ–‡ä¸»ä½“ï¼Œä¸€èˆ¬ç”¨äºéªŒè¯ URI æ˜¯å¦æœ‰æ•ˆã€‚</li>\n<li><strong>DELETEï¼š</strong>åˆ é™¤æ–‡ä»¶ï¼Œä¸ PUT æ–¹æ³•ç›¸åï¼Œåˆ é™¤å¯¹åº” URI ä½ç½®çš„æ–‡ä»¶ã€‚</li>\n<li><strong>OPTIONSï¼š</strong>æŸ¥è¯¢ç›¸åº” URI æ”¯æŒçš„ HTTP æ–¹æ³•ã€‚</li>\n</ul>\n<h3 id=\"ç½‘ç»œå±‚çš„-ARP-åè®®å·¥ä½œåŸç†ï¼Ÿ\"><a href=\"#ç½‘ç»œå±‚çš„-ARP-åè®®å·¥ä½œåŸç†ï¼Ÿ\" class=\"headerlink\" title=\"ç½‘ç»œå±‚çš„ ARP åè®®å·¥ä½œåŸç†ï¼Ÿ\"></a>ç½‘ç»œå±‚çš„ ARP åè®®å·¥ä½œåŸç†ï¼Ÿ</h3><p>ç½‘ç»œå±‚çš„ ARP åè®®å®Œæˆäº† IP åœ°å€ä¸ç‰©ç†åœ°å€çš„æ˜ å°„</p>\n<h3 id=\"IPåœ°å€ä¸ç‰©ç†åœ°å€\"><a href=\"#IPåœ°å€ä¸ç‰©ç†åœ°å€\" class=\"headerlink\" title=\"IPåœ°å€ä¸ç‰©ç†åœ°å€\"></a>IPåœ°å€ä¸ç‰©ç†åœ°å€</h3><p>ç‰©ç†åœ°å€æ˜¯æ•°æ®é“¾è·¯å±‚å’Œç‰©ç†å±‚ä½¿ç”¨çš„åœ°å€ï¼ŒIP åœ°å€æ˜¯ç½‘ç»œå±‚å’Œä»¥ä¸Šå„å±‚ä½¿ç”¨çš„åœ°å€ï¼Œæ˜¯ä¸€ç§é€»è¾‘åœ°å€ï¼Œå…¶ä¸­ ARP åè®®ç”¨äº IP åœ°å€ä¸ç‰©ç†åœ°å€çš„å¯¹åº”ã€‚</p>\n<h3 id=\"å½±å“ç½‘ç»œä¼ è¾“çš„å› ç´ æœ‰å“ªäº›ï¼Ÿ\"><a href=\"#å½±å“ç½‘ç»œä¼ è¾“çš„å› ç´ æœ‰å“ªäº›ï¼Ÿ\" class=\"headerlink\" title=\"å½±å“ç½‘ç»œä¼ è¾“çš„å› ç´ æœ‰å“ªäº›ï¼Ÿ\"></a>å½±å“ç½‘ç»œä¼ è¾“çš„å› ç´ æœ‰å“ªäº›ï¼Ÿ</h3><p>å°†ä¸€ä»½æ•°æ®ä»ä¸€ä¸ªåœ°æ–¹æ­£ç¡®åœ°ä¼ è¾“åˆ°å¦ä¸€ä¸ªåœ°æ–¹æ‰€éœ€è¦çš„æ—¶é—´æˆ‘ä»¬ç§°ä¹‹ä¸ºå“åº”æ—¶é—´ã€‚å½±å“è¿™ä¸ªå“åº”æ—¶é—´çš„å› ç´ æœ‰å¾ˆå¤šã€‚</p>\n<p>1ã€ç½‘ç»œå¸¦å®½<br>2ã€ä¼ è¾“è·ç¦»<br>3ã€TCP æ‹¥å¡æ§åˆ¶</p>\n<h3 id=\"ä»€æ˜¯å¯¹ç§°åŠ å¯†ä¸éå¯¹ç§°åŠ å¯†\"><a href=\"#ä»€æ˜¯å¯¹ç§°åŠ å¯†ä¸éå¯¹ç§°åŠ å¯†\" class=\"headerlink\" title=\"ä»€æ˜¯å¯¹ç§°åŠ å¯†ä¸éå¯¹ç§°åŠ å¯†\"></a>ä»€æ˜¯å¯¹ç§°åŠ å¯†ä¸éå¯¹ç§°åŠ å¯†</h3><p>å¯¹ç§°å¯†é’¥åŠ å¯†æ˜¯æŒ‡<strong>åŠ å¯†å’Œè§£å¯†ä½¿ç”¨åŒä¸€ä¸ªå¯†é’¥</strong>çš„æ–¹å¼ï¼Œè¿™ç§æ–¹å¼å­˜åœ¨çš„æœ€å¤§é—®é¢˜å°±æ˜¯å¯†é’¥å‘é€é—®é¢˜ï¼Œå³å¦‚ä½•å®‰å…¨åœ°å°†å¯†é’¥å‘ç»™å¯¹æ–¹ï¼›</p>\n<p>è€Œéå¯¹ç§°åŠ å¯†æ˜¯æŒ‡ä½¿ç”¨<strong>ä¸€å¯¹éå¯¹ç§°å¯†é’¥ï¼Œå³å…¬é’¥å’Œç§é’¥</strong>ï¼Œå…¬é’¥å¯ä»¥éšæ„å‘å¸ƒï¼Œä½†ç§é’¥åªæœ‰è‡ªå·±çŸ¥é“ã€‚å‘é€å¯†æ–‡çš„ä¸€æ–¹ä½¿ç”¨å¯¹æ–¹çš„å…¬é’¥è¿›è¡ŒåŠ å¯†å¤„ç†ï¼Œå¯¹æ–¹æ¥æ”¶åˆ°åŠ å¯†ä¿¡æ¯åï¼Œä½¿ç”¨è‡ªå·±çš„ç§é’¥è¿›è¡Œè§£å¯†ã€‚ ç”±äºéå¯¹ç§°åŠ å¯†çš„æ–¹å¼ä¸éœ€è¦å‘é€ç”¨æ¥è§£å¯†çš„ç§é’¥ï¼Œæ‰€ä»¥å¯ä»¥ä¿è¯å®‰å…¨æ€§ï¼›ä½†æ˜¯å’Œå¯¹ç§°åŠ å¯†æ¯”èµ·æ¥ï¼Œéå¸¸çš„æ…¢</p>\n<h3 id=\"HTTPSé‡‡ç”¨å¯¹ç§°åŠ å¯†-éå¯¹ç§°åŠ å¯†\"><a href=\"#HTTPSé‡‡ç”¨å¯¹ç§°åŠ å¯†-éå¯¹ç§°åŠ å¯†\" class=\"headerlink\" title=\"HTTPSé‡‡ç”¨å¯¹ç§°åŠ å¯†+éå¯¹ç§°åŠ å¯†\"></a>HTTPSé‡‡ç”¨å¯¹ç§°åŠ å¯†+éå¯¹ç§°åŠ å¯†</h3><p>ä½¿ç”¨å¯¹ç§°åŠ å¯†ï¼Œä¼˜ç‚¹æ˜¯åŠ å¯†è§£å¯†é€Ÿåº¦å¿«ï¼Œç¼ºç‚¹æ˜¯ä¸å®‰å…¨ï¼›<br>ä½¿ç”¨éå¯¹ç§°åŠ å¯†ï¼Œä¼˜ç‚¹æ˜¯ä¿è¯å®‰å…¨æ€§ï¼Œç¼ºç‚¹æ˜¯é€Ÿåº¦æ…¢ï¼›</p>\n<p>Https ç»“åˆä¸¤ç§åŠ å¯†æ–¹å¼çš„ä¼˜ç‚¹ï¼Œ<br>åœ¨<strong>äº¤æ¢å¯†é’¥ç¯èŠ‚</strong>ä½¿ç”¨éå¯¹ç§°åŠ å¯†æ–¹å¼ï¼Œä¹‹åçš„<strong>å»ºç«‹é€šä¿¡äº¤æ¢æŠ¥æ–‡</strong>é˜¶æ®µåˆ™ä½¿ç”¨å¯¹ç§°åŠ å¯†æ–¹å¼ã€‚</p>\n<h2 id=\"TCP-x2F-IP-åè®®æ—\"><a href=\"#TCP-x2F-IP-åè®®æ—\" class=\"headerlink\" title=\"TCP&#x2F;IP åè®®æ—\"></a>TCP&#x2F;IP åè®®æ—</h2><h3 id=\"åº”ç”¨å±‚\"><a href=\"#åº”ç”¨å±‚\" class=\"headerlink\" title=\"åº”ç”¨å±‚\"></a>åº”ç”¨å±‚</h3><p>åº”ç”¨å±‚( application-layer ï¼‰çš„ä»»åŠ¡æ˜¯é€šè¿‡åº”ç”¨è¿›ç¨‹é—´çš„äº¤äº’æ¥å®Œæˆç‰¹å®šç½‘ç»œåº”ç”¨ã€‚åº”ç”¨å±‚åè®®å®šä¹‰çš„æ˜¯åº”ç”¨è¿›ç¨‹ï¼ˆè¿›ç¨‹ï¼šä¸»æœºä¸­æ­£åœ¨è¿è¡Œçš„ç¨‹åºï¼‰é—´çš„é€šä¿¡å’Œäº¤äº’çš„è§„åˆ™ã€‚</p>\n<p>å¯¹äºä¸åŒçš„ç½‘ç»œåº”ç”¨éœ€è¦ä¸åŒçš„åº”ç”¨å±‚åè®®ã€‚åœ¨äº’è”ç½‘ä¸­åº”ç”¨å±‚åè®®å¾ˆå¤šï¼Œå¦‚åŸŸåç³»ç»Ÿ DNSï¼Œæ”¯æŒä¸‡ç»´ç½‘åº”ç”¨çš„ HTTP åè®®ï¼Œæ”¯æŒç”µå­é‚®ä»¶çš„ SMTP åè®®ç­‰ç­‰ã€‚</p>\n<h3 id=\"ä¼ è¾“å±‚\"><a href=\"#ä¼ è¾“å±‚\" class=\"headerlink\" title=\"ä¼ è¾“å±‚\"></a>ä¼ è¾“å±‚</h3><p>ä¼ è¾“å±‚(transport layer)çš„ä¸»è¦ä»»åŠ¡å°±æ˜¯è´Ÿè´£å‘ä¸¤å°ä¸»æœºè¿›ç¨‹ä¹‹é—´çš„é€šä¿¡æä¾›é€šç”¨çš„<strong>æ•°æ®ä¼ è¾“æœåŠ¡</strong>ã€‚åº”ç”¨è¿›ç¨‹åˆ©ç”¨è¯¥æœåŠ¡ä¼ é€åº”ç”¨å±‚æŠ¥æ–‡ã€‚</p>\n<p>è¿è¾“å±‚ä¸»è¦ä½¿ç”¨ä¸€ä¸‹ä¸¤ç§åè®®</p>\n<ol>\n<li>ä¼ è¾“æ§åˆ¶åè®®-TCPï¼šæä¾›é¢å‘è¿æ¥çš„ï¼Œå¯é çš„æ•°æ®ä¼ è¾“æœåŠ¡ã€‚</li>\n<li>ç”¨æˆ·æ•°æ®åè®®-UDPï¼šæä¾›æ— è¿æ¥çš„ï¼Œå°½æœ€å¤§åŠªåŠ›çš„æ•°æ®ä¼ è¾“æœåŠ¡ï¼ˆä¸ä¿è¯æ•°æ®ä¼ è¾“çš„å¯é æ€§ï¼‰ã€‚</li>\n</ol>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>UDP</th>\n<th>TCP</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>æ˜¯å¦è¿æ¥</td>\n<td>æ— è¿æ¥</td>\n<td>é¢å‘è¿æ¥</td>\n</tr>\n<tr>\n<td>æ˜¯å¦å¯é </td>\n<td>ä¸å¯é ä¼ è¾“ï¼Œä¸ä½¿ç”¨æµé‡æ§åˆ¶å’Œæ‹¥å¡æ§åˆ¶</td>\n<td>å¯é ä¼ è¾“ï¼Œä½¿ç”¨æµé‡æ§åˆ¶å’Œæ‹¥å¡æ§åˆ¶</td>\n</tr>\n<tr>\n<td>è¿æ¥å¯¹è±¡ä¸ªæ•°</td>\n<td>æ”¯æŒä¸€å¯¹ä¸€ï¼Œä¸€å¯¹å¤šï¼Œå¤šå¯¹ä¸€å’Œå¤šå¯¹å¤šäº¤äº’é€šä¿¡</td>\n<td>åªèƒ½æ˜¯ä¸€å¯¹ä¸€é€šä¿¡</td>\n</tr>\n<tr>\n<td>ä¼ è¾“æ–¹å¼</td>\n<td>é¢å‘æŠ¥æ–‡</td>\n<td>é¢å‘å­—èŠ‚æµ</td>\n</tr>\n<tr>\n<td>é¦–éƒ¨å¼€é”€</td>\n<td>é¦–éƒ¨å¼€é”€å°ï¼Œä»…8å­—èŠ‚</td>\n<td>é¦–éƒ¨æœ€å°20å­—èŠ‚ï¼Œæœ€å¤§60å­—èŠ‚</td>\n</tr>\n<tr>\n<td>åœºæ™¯</td>\n<td>é€‚ç”¨äºå®æ—¶åº”ç”¨ï¼ˆIPç”µè¯ã€è§†é¢‘ä¼šè®®ã€ç›´æ’­ç­‰ï¼‰</td>\n<td>é€‚ç”¨äºè¦æ±‚å¯é ä¼ è¾“çš„åº”ç”¨ï¼Œä¾‹å¦‚æ–‡ä»¶ä¼ è¾“</td>\n</tr>\n</tbody></table>\n<p><strong>æ¯ä¸€ä¸ªåº”ç”¨å±‚ï¼ˆTCP&#x2F;IPå‚è€ƒæ¨¡å‹çš„æœ€é«˜å±‚ï¼‰åè®®ä¸€èˆ¬éƒ½ä¼šä½¿ç”¨åˆ°ä¸¤ä¸ªä¼ è¾“å±‚åè®®ä¹‹ä¸€ï¼š</strong></p>\n<p>è¿è¡Œåœ¨<code>TCPåè®®</code>ä¸Šçš„åè®®ï¼š</p>\n<ul>\n<li><code>HTTPï¼ˆHypertext Transfer Protocolï¼Œè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰</code>ï¼Œä¸»è¦ç”¨äºæ™®é€šæµè§ˆã€‚</li>\n<li><code>HTTPSï¼ˆHTTP over SSLï¼Œå®‰å…¨è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰</code>,<code>HTTP</code>åè®®çš„å®‰å…¨ç‰ˆæœ¬ã€‚</li>\n<li><code>FTPï¼ˆFile Transfer Protocolï¼Œæ–‡ä»¶ä¼ è¾“åè®®ï¼‰</code>ï¼Œç”¨äºæ–‡ä»¶ä¼ è¾“ã€‚</li>\n<li><code>POP3ï¼ˆPost Office Protocol, version 3ï¼Œé‚®å±€åè®®ï¼‰</code>ï¼Œæ”¶é‚®ä»¶ç”¨ã€‚</li>\n<li><code>SMTPï¼ˆSimple Mail Transfer Protocolï¼Œç®€å•é‚®ä»¶ä¼ è¾“åè®®ï¼‰</code>ï¼Œç”¨æ¥å‘é€ç”µå­é‚®ä»¶ã€‚</li>\n<li><code>TELNETï¼ˆTeletype over the Networkï¼Œç½‘ç»œç”µä¼ ï¼‰</code>ï¼Œé€šè¿‡ä¸€ä¸ª<code>ç»ˆç«¯ï¼ˆterminalï¼‰</code>ç™»é™†åˆ°ç½‘ç»œã€‚</li>\n<li><code>SSHï¼ˆSecure Shellï¼Œç”¨äºæ›¿ä»£å®‰å…¨æ€§å·®çš„TELNETï¼‰</code>ï¼Œç”¨äºåŠ å¯†å®‰å…¨ç™»é™†ç”¨ã€‚</li>\n</ul>\n<p>è¿è¡Œåœ¨<code>UDPåè®®</code>ä¸Šçš„åè®®ï¼š</p>\n<ul>\n<li><code>DHCPï¼ˆDynamic Host Configuration Protocolï¼ŒåŠ¨æ€ä¸»æœºé…ç½®åè®®ï¼‰</code>ï¼ŒåŠ¨æ€é…ç½® IP åœ°å€ã€‚</li>\n</ul>\n<p>è¿è¡Œåœ¨<code>TCP</code>å’Œ<code>UDP</code>åè®®ä¸Šï¼š</p>\n<ul>\n<li><code>DNSï¼ˆDomain Name Serviceï¼ŒåŸŸåæœåŠ¡ï¼‰</code>ï¼Œç”¨äºå®Œæˆåœ°å€æŸ¥æ‰¾ï¼Œé‚®ä»¶è½¬å‘ç­‰å·¥ä½œã€‚</li>\n</ul>\n<h3 id=\"ç½‘ç»œå±‚\"><a href=\"#ç½‘ç»œå±‚\" class=\"headerlink\" title=\"ç½‘ç»œå±‚\"></a>ç½‘ç»œå±‚</h3><p>ç½‘ç»œå±‚çš„ä»»åŠ¡å°±æ˜¯<strong>é€‰æ‹©åˆé€‚çš„ç½‘é—´è·¯ç”±å’Œäº¤æ¢ç»“ç‚¹ï¼Œç¡®ä¿è®¡ç®—æœºé€šä¿¡çš„æ•°æ®åŠæ—¶ä¼ é€</strong>ã€‚åœ¨å‘é€æ•°æ®æ—¶ï¼Œç½‘ç»œå±‚æŠŠè¿è¾“å±‚äº§ç”Ÿçš„æŠ¥æ–‡æ®µæˆ–ç”¨æˆ·æ•°æ®æŠ¥å°è£…æˆåˆ†ç»„å’ŒåŒ…è¿›è¡Œä¼ é€ã€‚åœ¨ TCP&#x2F;IP ä½“ç³»ç»“æ„ä¸­ï¼Œç”±äºç½‘ç»œå±‚ä½¿ç”¨ IP åè®®ï¼Œå› æ­¤åˆ†ç»„ä¹Ÿå« IP æ•°æ®æŠ¥ ï¼Œç®€ç§°æ•°æ®æŠ¥ã€‚</p>\n<p>äº’è”ç½‘æ˜¯ç”±å¤§é‡çš„å¼‚æ„ï¼ˆheterogeneousï¼‰ç½‘ç»œé€šè¿‡è·¯ç”±å™¨ï¼ˆrouterï¼‰ç›¸äº’è¿æ¥èµ·æ¥çš„ã€‚äº’è”ç½‘ä½¿ç”¨çš„ç½‘ç»œå±‚åè®®æ˜¯æ— è¿æ¥çš„ç½‘é™…åè®®ï¼ˆIntert Prococolï¼‰å’Œè®¸å¤šè·¯ç”±é€‰æ‹©åè®®ï¼Œå› æ­¤äº’è”ç½‘çš„ç½‘ç»œå±‚ä¹Ÿå«åšç½‘é™…å±‚æˆ– IP å±‚ã€‚</p>\n<h3 id=\"æ•°æ®é“¾è·¯å±‚\"><a href=\"#æ•°æ®é“¾è·¯å±‚\" class=\"headerlink\" title=\"æ•°æ®é“¾è·¯å±‚\"></a>æ•°æ®é“¾è·¯å±‚</h3><p>æ•°æ®é“¾è·¯å±‚(data link layer)é€šå¸¸ç®€ç§°ä¸ºé“¾è·¯å±‚ã€‚ä¸¤å°ä¸»æœºä¹‹é—´çš„æ•°æ®ä¼ è¾“ï¼Œæ€»æ˜¯åœ¨ä¸€æ®µä¸€æ®µçš„é“¾è·¯ä¸Šä¼ é€çš„ï¼Œè¿™å°±éœ€è¦ä½¿ç”¨ä¸“é—¨çš„é“¾è·¯å±‚çš„åè®®ã€‚</p>\n<p>åœ¨ä¸¤ä¸ªç›¸é‚»èŠ‚ç‚¹ä¹‹é—´ä¼ é€æ•°æ®æ—¶ï¼Œæ•°æ®é“¾è·¯å±‚å°†ç½‘ç»œå±‚äº¤ä¸‹æ¥çš„ IP æ•°æ®æŠ¥ç»„è£…æˆå¸§ï¼Œåœ¨ä¸¤ä¸ªç›¸é‚»èŠ‚ç‚¹é—´çš„é“¾è·¯ä¸Šä¼ é€å¸§ã€‚æ¯ä¸€å¸§åŒ…æ‹¬æ•°æ®å’Œå¿…è¦çš„æ§åˆ¶ä¿¡æ¯ï¼ˆå¦‚åŒæ­¥ä¿¡æ¯ï¼Œåœ°å€ä¿¡æ¯ï¼Œå·®é”™æ§åˆ¶ç­‰ï¼‰ã€‚</p>\n<p>åœ¨æ¥æ”¶æ•°æ®æ—¶ï¼Œæ§åˆ¶ä¿¡æ¯ä½¿æ¥æ”¶ç«¯èƒ½å¤ŸçŸ¥é“ä¸€ä¸ªå¸§ä»å“ªä¸ªæ¯”ç‰¹å¼€å§‹å’Œåˆ°å“ªä¸ªæ¯”ç‰¹ç»“æŸã€‚</p>\n<p>ä¸€èˆ¬çš„ web åº”ç”¨çš„é€šä¿¡ä¼ è¾“æµæ˜¯è¿™æ ·çš„ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOS81LzkvMTZhOWM5Y2Q1MjNlMDU5OQ.png\" alt=\"img\"></p>\n<p>å‘é€ç«¯åœ¨å±‚ä¸å±‚ä¹‹é—´ä¼ è¾“æ•°æ®æ—¶ï¼Œæ¯ç»è¿‡ä¸€å±‚æ—¶ä¼šè¢«æ‰“ä¸Šä¸€ä¸ªè¯¥å±‚æ‰€å±çš„é¦–éƒ¨ä¿¡æ¯ã€‚åä¹‹ï¼Œæ¥æ”¶ç«¯åœ¨å±‚ä¸å±‚ä¹‹é—´ä¼ è¾“æ•°æ®æ—¶ï¼Œæ¯ç»è¿‡ä¸€å±‚æ—¶ä¼šæŠŠå¯¹åº”çš„é¦–éƒ¨ä¿¡æ¯å»é™¤ã€‚</p>\n<h3 id=\"ç‰©ç†å±‚\"><a href=\"#ç‰©ç†å±‚\" class=\"headerlink\" title=\"ç‰©ç†å±‚\"></a>ç‰©ç†å±‚</h3><p>åœ¨ç‰©ç†å±‚ä¸Šæ‰€ä¼ é€çš„æ•°æ®å•ä½æ˜¯æ¯”ç‰¹ã€‚ ç‰©ç†å±‚(physical layer)çš„ä½œç”¨æ˜¯å®ç°ç›¸é‚»è®¡ç®—æœºèŠ‚ç‚¹ä¹‹é—´æ¯”ç‰¹æµçš„é€æ˜ä¼ é€ï¼Œå°½å¯èƒ½å±è”½æ‰å…·ä½“ä¼ è¾“ä»‹è´¨å’Œç‰©ç†è®¾å¤‡çš„å·®å¼‚ã€‚ä½¿å…¶ä¸Šé¢çš„æ•°æ®é“¾è·¯å±‚ä¸å¿…è€ƒè™‘ç½‘ç»œçš„å…·ä½“ä¼ è¾“ä»‹è´¨æ˜¯ä»€ä¹ˆã€‚â€œé€æ˜ä¼ é€æ¯”ç‰¹æµâ€è¡¨ç¤ºç»å®é™…ç”µè·¯ä¼ é€åçš„æ¯”ç‰¹æµæ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œå¯¹ä¼ é€çš„æ¯”ç‰¹æµæ¥è¯´ï¼Œè¿™ä¸ªç”µè·¯å¥½åƒæ˜¯çœ‹ä¸è§çš„ã€‚</p>\n<h3 id=\"TCP-x2F-IP-åè®®æ—-1\"><a href=\"#TCP-x2F-IP-åè®®æ—-1\" class=\"headerlink\" title=\"TCP&#x2F;IP åè®®æ—\"></a>TCP&#x2F;IP åè®®æ—</h3><p>åœ¨äº’è”ç½‘ä½¿ç”¨çš„å„ç§åè®®ä¸­æœ€é‡è¦å’Œæœ€è‘—åçš„å°±æ˜¯ TCP&#x2F;IP ä¸¤ä¸ªåè®®ã€‚ç°åœ¨äººä»¬ç»å¸¸æåˆ°çš„ TCP&#x2F;IP å¹¶ä¸ä¸€å®šæ˜¯å•æŒ‡ TCP å’Œ IP è¿™ä¸¤ä¸ªå…·ä½“çš„åè®®ï¼Œè€Œå¾€å¾€æ˜¯è¡¨ç¤ºäº’è”ç½‘æ‰€ä½¿ç”¨çš„æ•´ä¸ª TCP&#x2F;IP åè®®æ—ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOS80LzcvMTY5ZjY5NjZjMjRhZjM0NQ.png\" alt=\"img\"></p>\n<p>TCPï¼ˆä¼ è¾“æ§åˆ¶åè®®ï¼‰å’Œ IPï¼ˆç½‘é™…åè®®ï¼‰æ˜¯<strong>æœ€å…ˆå®šä¹‰çš„ä¸¤ä¸ªæ ¸å¿ƒåè®®</strong>ï¼Œæ‰€ä»¥æ‰ç»Ÿç§°ä¸º TCP&#x2F;IP åè®®æ—</p>\n<h2 id=\"TCPçš„ä¸‰æ¬¡æ¡æ‰‹å››æ¬¡æŒ¥æ‰‹\"><a href=\"#TCPçš„ä¸‰æ¬¡æ¡æ‰‹å››æ¬¡æŒ¥æ‰‹\" class=\"headerlink\" title=\"TCPçš„ä¸‰æ¬¡æ¡æ‰‹å››æ¬¡æŒ¥æ‰‹\"></a>TCPçš„ä¸‰æ¬¡æ¡æ‰‹å››æ¬¡æŒ¥æ‰‹</h2><p>TCP æ˜¯ä¸€ç§é¢å‘è¿æ¥çš„ã€å¯é çš„ã€åŸºäºå­—èŠ‚æµçš„ä¼ è¾“å±‚é€šä¿¡åè®®ï¼Œåœ¨å‘é€æ•°æ®å‰ï¼Œé€šä¿¡åŒæ–¹å¿…é¡»åœ¨å½¼æ­¤é—´å»ºç«‹ä¸€æ¡è¿æ¥ã€‚æ‰€è°“çš„â€œè¿æ¥â€ï¼Œå…¶å®æ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¿å­˜çš„ä¸€ä»½å…³äºå¯¹æ–¹çš„ä¿¡æ¯ï¼Œå¦‚ ip åœ°å€ã€ç«¯å£å·ç­‰ã€‚</p>\n<p>ä¸€ä¸ª TCP è¿æ¥ç”±ä¸€ä¸ª 4 å…ƒç»„æ„æˆï¼Œåˆ†åˆ«æ˜¯ä¸¤ä¸ª IP åœ°å€å’Œä¸¤ä¸ªç«¯å£å·ã€‚ä¸€ä¸ª TCP è¿æ¥é€šå¸¸åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼šè¿æ¥ã€æ•°æ®ä¼ è¾“ã€é€€å‡ºï¼ˆå…³é—­ï¼‰ã€‚<strong>é€šè¿‡ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹ä¸€ä¸ªé“¾æ¥ï¼Œé€šè¿‡å››æ¬¡æŒ¥æ‰‹æ¥å…³é—­ä¸€ä¸ªè¿æ¥</strong>ã€‚</p>\n<p><strong>å½“ä¸€ä¸ªè¿æ¥è¢«å»ºç«‹æˆ–è¢«ç»ˆæ­¢æ—¶ï¼Œäº¤æ¢çš„æŠ¥æ–‡æ®µåªåŒ…å«TCPå¤´éƒ¨ï¼Œè€Œæ²¡æœ‰æ•°æ®</strong>ã€‚</p>\n<h3 id=\"TCPæŠ¥æ–‡çš„å¤´éƒ¨ç»“æ„\"><a href=\"#TCPæŠ¥æ–‡çš„å¤´éƒ¨ç»“æ„\" class=\"headerlink\" title=\"TCPæŠ¥æ–‡çš„å¤´éƒ¨ç»“æ„\"></a>TCPæŠ¥æ–‡çš„å¤´éƒ¨ç»“æ„</h3><p>æœ‰å‡ ä¸ªå­—æ®µéœ€è¦é‡ç‚¹ä»‹ç»ä¸‹ï¼š</p>\n<p>ï¼ˆ1ï¼‰åºå·ï¼šseq åºå·ï¼Œå  32 ä½ï¼Œç”¨æ¥æ ‡è¯†ä» TCP æºç«¯å‘ç›®çš„ç«¯å‘é€çš„å­—èŠ‚æµï¼Œå‘èµ·æ–¹å‘é€æ•°æ®æ—¶å¯¹æ­¤è¿›è¡Œæ ‡è®°ã€‚</p>\n<p>ï¼ˆ2ï¼‰ç¡®è®¤åºå·ï¼šack åºå·ï¼Œå  32 ä½ï¼Œåªæœ‰ ACK æ ‡å¿—ä½ä¸º 1 æ—¶ï¼Œç¡®è®¤åºå·å­—æ®µæ‰æœ‰æ•ˆï¼Œack&#x3D;seq+1ã€‚</p>\n<p>ï¼ˆ3ï¼‰æ ‡å¿—ä½ï¼šå…± 6 ä¸ªï¼Œå³ URGã€ACKã€PSHã€RSTã€SYNã€FIN ç­‰ï¼Œå…·ä½“å«ä¹‰å¦‚ä¸‹ï¼š</p>\n<ul>\n<li>ACKï¼šç¡®è®¤åºå·æœ‰æ•ˆã€‚</li>\n<li>FINï¼šé‡Šæ”¾ä¸€ä¸ªè¿æ¥ã€‚</li>\n<li>PSHï¼šæ¥æ”¶æ–¹åº”è¯¥å°½å¿«å°†è¿™ä¸ªæŠ¥æ–‡äº¤ç»™åº”ç”¨å±‚ã€‚</li>\n<li>RSTï¼šé‡ç½®è¿æ¥ã€‚</li>\n<li>SYNï¼šå‘èµ·ä¸€ä¸ªæ–°è¿æ¥ã€‚</li>\n<li>URGï¼šç´§æ€¥æŒ‡é’ˆï¼ˆurgent pointerï¼‰æœ‰æ•ˆã€‚</li>\n</ul>\n<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</p>\n<ul>\n<li>ä¸è¦å°†ç¡®è®¤åºå· ack ä¸æ ‡å¿—ä½ä¸­çš„ ACK ææ··äº†ã€‚</li>\n<li>ç¡®è®¤æ–¹ ack&#x3D;å‘èµ·æ–¹ seq+1ï¼Œä¸¤ç«¯é…å¯¹ã€‚</li>\n</ul>\n<h3 id=\"ä¸‰æ¬¡æ¡æ‰‹\"><a href=\"#ä¸‰æ¬¡æ¡æ‰‹\" class=\"headerlink\" title=\"ä¸‰æ¬¡æ¡æ‰‹\"></a>ä¸‰æ¬¡æ¡æ‰‹</h3><blockquote>\n<p>ä¸‰æ¬¡æ¡æ‰‹çš„æœ¬è´¨æ˜¯ç¡®è®¤é€šä¿¡åŒæ–¹æ”¶å‘æ•°æ®çš„èƒ½åŠ›</p>\n</blockquote>\n<p>A-&gt;B</p>\n<p>A å‘é€ç»™ Bï¼ŒB è‹¥æ”¶åˆ°</p>\n<blockquote>\n<p>è¯´æ˜BçŸ¥é“ï¼šAå¯ä»¥å‘ï¼ŒBå¯ä»¥æ”¶</p>\n</blockquote>\n<p>B è¿”å›ç»™ Aï¼ŒA è‹¥æ”¶åˆ°ï¼šè¯´æ˜ A ä¹‹å‰å‘ç»™ B çš„ B æ”¶åˆ°äº†ï¼ŒåŒæ—¶ B ä¹Ÿèƒ½ç»™è‡ªå·±å›ä¿¡ï¼Œè‡ªå·±èƒ½æ”¶åˆ°è¿™ä¸ªå›ä¿¡ã€‚</p>\n<blockquote>\n<p>è¯´æ˜ï¼šAçŸ¥é“ï¼šAèƒ½å‘èƒ½æ”¶ï¼ŒBèƒ½æ”¶èƒ½å‘</p>\n</blockquote>\n<p>ä½†æ˜¯æ­¤æ—¶ B ä¸çŸ¥é“ A æ˜¯å¦å¯ä»¥æ”¶ï¼ŒB æ˜¯å¦å‘é€æ­£å¸¸</p>\n<p>äºæ˜¯ A å‘é€ç»™ Bï¼ŒB è‹¥æ”¶åˆ°ï¼šè¯´æ˜ B çš„å‘é€å›ä¿¡ A èƒ½æ”¶åˆ°</p>\n<blockquote>\n<p>è¯´æ˜ï¼šB çŸ¥é“ A å¯ä»¥æ”¶ï¼ŒB å¯ä»¥å‘ï¼Œç»“åˆç¬¬ä¸€æ­¥ï¼Œå¾—åˆ° B ä¹ŸçŸ¥é“ A èƒ½å‘èƒ½æ”¶ï¼ŒB èƒ½æ”¶èƒ½å‘</p>\n</blockquote>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAyMC8xLzcvMTZmN2UwM2IxZWE1MDdlOA.png\" alt=\"ä¸‰æ¬¡æ¡æ‰‹\"></p>\n<h3 id=\"å››æ¬¡æŒ¥æ‰‹\"><a href=\"#å››æ¬¡æŒ¥æ‰‹\" class=\"headerlink\" title=\"å››æ¬¡æŒ¥æ‰‹\"></a>å››æ¬¡æŒ¥æ‰‹</h3><blockquote>\n<p>å››æ¬¡æŒ¥æ‰‹çš„ç›®çš„æ˜¯å…³é—­ä¸€ä¸ªè¿æ¥</p>\n</blockquote>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesaHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAyMC8xLzcvMTZmN2UwM2IyMWEwN2YwYw.png\" alt=\"å››æ¬¡æŒ¥æ‰‹\"></p>\n<p>A å’Œ B æ‰“ç”µè¯ï¼Œé€šè¯å³å°†ç»“æŸåï¼Œ<br>A è¯´â€œæˆ‘æ²¡å•¥è¦è¯´çš„äº†â€ï¼Œ<br>B å›ç­”â€œæˆ‘çŸ¥é“äº†â€ï¼Œ<br>ä½†æ˜¯ B å¯èƒ½è¿˜ä¼šæœ‰è¦è¯´çš„è¯ï¼ŒA ä¸èƒ½è¦æ±‚ B è·Ÿç€è‡ªå·±çš„èŠ‚å¥ç»“æŸé€šè¯ï¼Œäºæ˜¯ B å¯èƒ½åˆå·´æ‹‰å·´æ‹‰è¯´äº†ä¸€é€šï¼Œæœ€å B è¯´â€œæˆ‘è¯´å®Œäº†â€ï¼Œ<br>A å›ç­”â€œçŸ¥é“äº†â€ï¼Œè¿™æ ·é€šè¯æ‰ç®—ç»“æŸã€‚</p>"},{"title":"å¼€äº†ä¸ªBç«™å¤§ä¼šå‘˜","copyright":true,"mathjax":true,"date":"2022-12-15T13:39:46.000Z","urlname":"bilibili-vip","_content":"\næœ€è¿‘å·«å¸ˆ 3 æ›´æ–°äº†æ¬¡ä¸–ä»£ç‰ˆæœ¬ï¼ˆç”»è´¨ä¼˜åŒ–+ä¸­æ–‡é…éŸ³ï¼‰ï¼Œç”±äº PS5 æ”¾åœ¨äº†å­¦æ ¡é‡Œï¼Œç¬”è®°æœ¬ä¹Ÿå¸¦ä¸å¤ªåŠ¨ï¼Œåªèƒ½çœ‹è€æˆ´çš„è§†é¢‘äº‘ç©å®¶äºŒå‘¨ç›®äº†ï¼ˆ[é“¾æ¥](https://www.bilibili.com/video/BV1L14y1N7b3)ï¼‰ã€‚\n\n<!--more-->\n\nçœ‹äº†ä¸€ä¼šï¼Œè¯¶ï¼Œå’‹æ›´æ–°äº†è¿˜è¿™ä¹ˆç³Šï¼Œä¸€çœ‹åŸæ¥æ˜¯åªå¼€äº† 1080P ç”»è´¨ï¼Œä¸€å†²åŠ¨ä¸ŠæŸå¤šå¤šä¹°äº†ä¸‰ä¸ªæœˆçš„å¤§ä¼šå‘˜ï¼Œç‚¹å¼€ 4K ç”»è´¨é€‰é¡¹ï¼Œå¥½å®¶ä¼™ï¼Œç›´æ¥æ„Ÿå—åˆ°äº†æ¬¡ä¸–ä»£çš„é­…åŠ›ã€‚é…éŸ³é…çš„ä¹Ÿå¾ˆå‡ºè‰²ï¼Œæ²¡ä»€ä¹ˆæ§½ç‚¹ã€‚å›å¤´ PS5 ä¸Šå†ä¸‰å‘¨ç›®å§ï¼Œå¹¶ä¸”æœŸå¾…ä¸€æ‰‹å·«å¸ˆ 4ã€‚\n\nå……äº†å¤§ä¼šå‘˜ï¼Œæ¥ä¸‹æ¥é—²çš„æ—¶å€™å†æŠŠ B ç«™ä¸Šçš„ç”µå½±å†çœ‹çœ‹ï¼Œæ€»ä¸èƒ½æµªè´¹äº†ä¸æ˜¯ hhhã€‚\n\næœ€è¿‘å¤šä¸ªå¹³å°éƒ½åœ¨æå¹´ç»ˆæ€»ç»“äº†ï¼Œæ¯”å¦‚ Apple Music å’Œ PlayStationï¼Œå‡†å¤‡ç­‰å…¶ä»–å¹³å°éƒ½æ¨å‡ºå¹´ç»ˆæ€»ç»“ä¹‹åææ³¢åˆ†äº«ï½\n\n","source":"_posts/å¼€äº†ä¸ªBç«™å¤§ä¼šå‘˜.md","raw":"---\ntitle: å¼€äº†ä¸ªBç«™å¤§ä¼šå‘˜\ncopyright: true\nmathjax: true\ndate: 2022-12-15 21:39:46\ncategories: æ—¥å¸¸å°è®°\ntags: \nurlname: bilibili-vip\n---\n\næœ€è¿‘å·«å¸ˆ 3 æ›´æ–°äº†æ¬¡ä¸–ä»£ç‰ˆæœ¬ï¼ˆç”»è´¨ä¼˜åŒ–+ä¸­æ–‡é…éŸ³ï¼‰ï¼Œç”±äº PS5 æ”¾åœ¨äº†å­¦æ ¡é‡Œï¼Œç¬”è®°æœ¬ä¹Ÿå¸¦ä¸å¤ªåŠ¨ï¼Œåªèƒ½çœ‹è€æˆ´çš„è§†é¢‘äº‘ç©å®¶äºŒå‘¨ç›®äº†ï¼ˆ[é“¾æ¥](https://www.bilibili.com/video/BV1L14y1N7b3)ï¼‰ã€‚\n\n<!--more-->\n\nçœ‹äº†ä¸€ä¼šï¼Œè¯¶ï¼Œå’‹æ›´æ–°äº†è¿˜è¿™ä¹ˆç³Šï¼Œä¸€çœ‹åŸæ¥æ˜¯åªå¼€äº† 1080P ç”»è´¨ï¼Œä¸€å†²åŠ¨ä¸ŠæŸå¤šå¤šä¹°äº†ä¸‰ä¸ªæœˆçš„å¤§ä¼šå‘˜ï¼Œç‚¹å¼€ 4K ç”»è´¨é€‰é¡¹ï¼Œå¥½å®¶ä¼™ï¼Œç›´æ¥æ„Ÿå—åˆ°äº†æ¬¡ä¸–ä»£çš„é­…åŠ›ã€‚é…éŸ³é…çš„ä¹Ÿå¾ˆå‡ºè‰²ï¼Œæ²¡ä»€ä¹ˆæ§½ç‚¹ã€‚å›å¤´ PS5 ä¸Šå†ä¸‰å‘¨ç›®å§ï¼Œå¹¶ä¸”æœŸå¾…ä¸€æ‰‹å·«å¸ˆ 4ã€‚\n\nå……äº†å¤§ä¼šå‘˜ï¼Œæ¥ä¸‹æ¥é—²çš„æ—¶å€™å†æŠŠ B ç«™ä¸Šçš„ç”µå½±å†çœ‹çœ‹ï¼Œæ€»ä¸èƒ½æµªè´¹äº†ä¸æ˜¯ hhhã€‚\n\næœ€è¿‘å¤šä¸ªå¹³å°éƒ½åœ¨æå¹´ç»ˆæ€»ç»“äº†ï¼Œæ¯”å¦‚ Apple Music å’Œ PlayStationï¼Œå‡†å¤‡ç­‰å…¶ä»–å¹³å°éƒ½æ¨å‡ºå¹´ç»ˆæ€»ç»“ä¹‹åææ³¢åˆ†äº«ï½\n\n","slug":"å¼€äº†ä¸ªBç«™å¤§ä¼šå‘˜","published":1,"updated":"2023-01-26T12:35:58.981Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cldzfw3280010t9t80132hzi0","content":"<p>æœ€è¿‘å·«å¸ˆ 3 æ›´æ–°äº†æ¬¡ä¸–ä»£ç‰ˆæœ¬ï¼ˆç”»è´¨ä¼˜åŒ–+ä¸­æ–‡é…éŸ³ï¼‰ï¼Œç”±äº PS5 æ”¾åœ¨äº†å­¦æ ¡é‡Œï¼Œç¬”è®°æœ¬ä¹Ÿå¸¦ä¸å¤ªåŠ¨ï¼Œåªèƒ½çœ‹è€æˆ´çš„è§†é¢‘äº‘ç©å®¶äºŒå‘¨ç›®äº†ï¼ˆ<a href=\"https://www.bilibili.com/video/BV1L14y1N7b3\">é“¾æ¥</a>ï¼‰ã€‚</p>\n<span id=\"more\"></span>\n\n<p>çœ‹äº†ä¸€ä¼šï¼Œè¯¶ï¼Œå’‹æ›´æ–°äº†è¿˜è¿™ä¹ˆç³Šï¼Œä¸€çœ‹åŸæ¥æ˜¯åªå¼€äº† 1080P ç”»è´¨ï¼Œä¸€å†²åŠ¨ä¸ŠæŸå¤šå¤šä¹°äº†ä¸‰ä¸ªæœˆçš„å¤§ä¼šå‘˜ï¼Œç‚¹å¼€ 4K ç”»è´¨é€‰é¡¹ï¼Œå¥½å®¶ä¼™ï¼Œç›´æ¥æ„Ÿå—åˆ°äº†æ¬¡ä¸–ä»£çš„é­…åŠ›ã€‚é…éŸ³é…çš„ä¹Ÿå¾ˆå‡ºè‰²ï¼Œæ²¡ä»€ä¹ˆæ§½ç‚¹ã€‚å›å¤´ PS5 ä¸Šå†ä¸‰å‘¨ç›®å§ï¼Œå¹¶ä¸”æœŸå¾…ä¸€æ‰‹å·«å¸ˆ 4ã€‚</p>\n<p>å……äº†å¤§ä¼šå‘˜ï¼Œæ¥ä¸‹æ¥é—²çš„æ—¶å€™å†æŠŠ B ç«™ä¸Šçš„ç”µå½±å†çœ‹çœ‹ï¼Œæ€»ä¸èƒ½æµªè´¹äº†ä¸æ˜¯ hhhã€‚</p>\n<p>æœ€è¿‘å¤šä¸ªå¹³å°éƒ½åœ¨æå¹´ç»ˆæ€»ç»“äº†ï¼Œæ¯”å¦‚ Apple Music å’Œ PlayStationï¼Œå‡†å¤‡ç­‰å…¶ä»–å¹³å°éƒ½æ¨å‡ºå¹´ç»ˆæ€»ç»“ä¹‹åææ³¢åˆ†äº«ï½</p>\n","site":{"data":{}},"length":276,"excerpt":"<p>æœ€è¿‘å·«å¸ˆ 3 æ›´æ–°äº†æ¬¡ä¸–ä»£ç‰ˆæœ¬ï¼ˆç”»è´¨ä¼˜åŒ–+ä¸­æ–‡é…éŸ³ï¼‰ï¼Œç”±äº PS5 æ”¾åœ¨äº†å­¦æ ¡é‡Œï¼Œç¬”è®°æœ¬ä¹Ÿå¸¦ä¸å¤ªåŠ¨ï¼Œåªèƒ½çœ‹è€æˆ´çš„è§†é¢‘äº‘ç©å®¶äºŒå‘¨ç›®äº†ï¼ˆ<a href=\"https://www.bilibili.com/video/BV1L14y1N7b3\">é“¾æ¥</a>ï¼‰ã€‚</p>","more":"<p>çœ‹äº†ä¸€ä¼šï¼Œè¯¶ï¼Œå’‹æ›´æ–°äº†è¿˜è¿™ä¹ˆç³Šï¼Œä¸€çœ‹åŸæ¥æ˜¯åªå¼€äº† 1080P ç”»è´¨ï¼Œä¸€å†²åŠ¨ä¸ŠæŸå¤šå¤šä¹°äº†ä¸‰ä¸ªæœˆçš„å¤§ä¼šå‘˜ï¼Œç‚¹å¼€ 4K ç”»è´¨é€‰é¡¹ï¼Œå¥½å®¶ä¼™ï¼Œç›´æ¥æ„Ÿå—åˆ°äº†æ¬¡ä¸–ä»£çš„é­…åŠ›ã€‚é…éŸ³é…çš„ä¹Ÿå¾ˆå‡ºè‰²ï¼Œæ²¡ä»€ä¹ˆæ§½ç‚¹ã€‚å›å¤´ PS5 ä¸Šå†ä¸‰å‘¨ç›®å§ï¼Œå¹¶ä¸”æœŸå¾…ä¸€æ‰‹å·«å¸ˆ 4ã€‚</p>\n<p>å……äº†å¤§ä¼šå‘˜ï¼Œæ¥ä¸‹æ¥é—²çš„æ—¶å€™å†æŠŠ B ç«™ä¸Šçš„ç”µå½±å†çœ‹çœ‹ï¼Œæ€»ä¸èƒ½æµªè´¹äº†ä¸æ˜¯ hhhã€‚</p>\n<p>æœ€è¿‘å¤šä¸ªå¹³å°éƒ½åœ¨æå¹´ç»ˆæ€»ç»“äº†ï¼Œæ¯”å¦‚ Apple Music å’Œ PlayStationï¼Œå‡†å¤‡ç­‰å…¶ä»–å¹³å°éƒ½æ¨å‡ºå¹´ç»ˆæ€»ç»“ä¹‹åææ³¢åˆ†äº«ï½</p>"},{"title":"Javaå…«è‚¡æ–‡ - Redis","copyright":true,"mathjax":false,"date":"2023-01-25T05:43:59.000Z","toc":true,"urlname":"Redis","_content":"\n> æ•´ç†çš„ Redis ç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½\t<!--more-->\n\n## ä»€ä¹ˆæ˜¯NoSQLï¼Ÿ\n\nNoSQL = not only sqlï¼ˆä¸ä»…ä»…æ˜¯ SQLï¼‰\n\nå…³ç³»å‹æ•°æ®åº“ï¼šåˆ—+è¡Œï¼ŒåŒä¸€ä¸ªè¡¨ä¸‹æ•°æ®çš„ç»“æ„æ˜¯ä¸€æ ·çš„ã€‚\n\néå…³ç³»å‹æ•°æ®åº“ï¼šæ•°æ®å­˜å‚¨æ²¡æœ‰å›ºå®šçš„æ ¼å¼ï¼Œå¹¶ä¸”å¯ä»¥è¿›è¡Œæ¨ªå‘æ‰©å±•ã€‚\n\nNoSQL æ³›æŒ‡éå…³ç³»å‹æ•°æ®åº“ï¼Œéšç€ web2.0 äº’è”ç½‘çš„è¯ç”Ÿï¼Œä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“å¾ˆéš¾å¯¹ä»˜ web2.0 å¤§æ•°æ®æ—¶ä»£ã€‚å°¤å…¶æ˜¯è¶…å¤§è§„æ¨¡çš„é«˜å¹¶å‘çš„ç¤¾åŒºï¼Œæš´éœ²å‡ºæ¥å¾ˆå¤šéš¾ä»¥å…‹æœçš„é—®é¢˜ï¼ŒNoSQL åœ¨å½“ä»Šå¤§æ•°æ®ç¯å¢ƒä¸‹å‘å±•çš„ååˆ†è¿…é€Ÿï¼ŒRedis æ˜¯å‘å±•æœ€å¿«çš„ã€‚\n\nä¼ ç»Ÿ RDBMSï¼ˆå…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼‰å’Œ NoSQLï¼ˆéå…³ç³»å‹æ•°æ®åº“ï¼‰æ¯”è¾ƒï¼š\n\nRDBMSï¼š\n - ç»„ç»‡åŒ–ç»“æ„\n - å›ºå®š SQL\n - æ•°æ®å’Œå…³ç³»éƒ½å­˜åœ¨å•ç‹¬çš„è¡¨ä¸­ï¼ˆè¡Œåˆ—ï¼‰\n - DMLï¼ˆæ•°æ®æ“ä½œè¯­è¨€ï¼‰ã€DDLï¼ˆæ•°æ®å®šä¹‰è¯­è¨€ï¼‰ç­‰\n - ä¸¥æ ¼çš„ä¸€è‡´æ€§ï¼ˆACIDï¼‰ï¼šåŸå­æ€§ã€ä¸€è‡´æ€§ã€éš”ç¦»æ€§ã€æŒä¹…æ€§\n - åŸºç¡€çš„äº‹åŠ¡\n\nNoSQLï¼š\n - ä¸ä»…ä»…æ˜¯æ•°æ®\n - æ²¡æœ‰å›ºå®šæŸ¥è¯¢è¯­è¨€\n - é”®å€¼å¯¹å­˜å‚¨ï¼ˆRedisï¼‰ã€åˆ—å­˜å‚¨ï¼ˆHBaseï¼‰ã€æ–‡æ¡£å­˜å‚¨ï¼ˆMongoDBï¼‰ã€å›¾å½¢æ•°æ®åº“ï¼ˆä¸æ˜¯å­˜å›¾å½¢ï¼Œæ”¾çš„æ˜¯å…³ç³»ï¼‰ï¼ˆNeo4jï¼‰\n - æœ€ç»ˆä¸€è‡´æ€§ï¼ˆBASEï¼‰ï¼šåŸºæœ¬å¯ç”¨ã€è½¯çŠ¶æ€/æŸ”æ€§äº‹åŠ¡ã€æœ€ç»ˆä¸€è‡´æ€§\n\n***\n\n## Redisæ˜¯ä»€ä¹ˆï¼Ÿ\n\n### å®šä¹‰\n\nRedis = Remote Dictionary Serverï¼Œå³è¿œç¨‹å­—å…¸æœåŠ¡ã€‚\n\nRedis æ˜¯ä¸€ä¸ªç”¨ C è¯­è¨€å¼€å‘çš„ã€åŸºäºå†…å­˜ç»“æ„è¿›è¡Œ**é”®å€¼å¯¹**æ•°æ®å­˜å‚¨çš„ã€é«˜æ€§èƒ½çš„ã€éå…³ç³»å‹ NoSQL æ•°æ®åº“\n\n### ä¼˜ç¼ºç‚¹\n\n**çº¯å†…å­˜æ“ä½œï¼Œæ€§èƒ½éå¸¸å‡ºè‰²**ï¼Œæ¯ç§’å¯ä»¥å¤„ç†è¶…è¿‡ 10 ä¸‡æ¬¡è¯»å†™æ“ä½œï¼Œæ˜¯å·²çŸ¥æ€§èƒ½æœ€å¿«çš„ Key-Value DBã€‚æ”¯æŒä¿å­˜å¤šç§æ•°æ®ç»“æ„ï¼Œå¯ä»¥ç”¨æ¥å®ç°å¾ˆå¤šæœ‰ç”¨çš„åŠŸèƒ½ã€‚\n\nRedis çš„ä¸»è¦ç¼ºç‚¹æ˜¯**æ•°æ®åº“å®¹é‡å—åˆ°ç‰©ç†å†…å­˜çš„é™åˆ¶ï¼Œä¸èƒ½ç”¨ä½œæµ·é‡æ•°æ®çš„é«˜æ€§èƒ½è¯»å†™**ï¼Œå› æ­¤ Redis é€‚åˆçš„åœºæ™¯ä¸»è¦å±€é™åœ¨è¾ƒå°æ•°æ®é‡çš„é«˜æ€§èƒ½æ“ä½œå’Œè¿ç®—ä¸Šã€‚\n\n### ä¸ºä»€ä¹ˆè¦ç”¨ç¼“å­˜\n\n**1ã€ é«˜æ€§èƒ½ï¼š**\n\nå‡å¦‚ç”¨æˆ·ç¬¬ä¸€æ¬¡è®¿é—®æ•°æ®åº“ä¸­çš„æŸäº›æ•°æ®ã€‚è¿™ä¸ªè¿‡ç¨‹ä¼šæ¯”è¾ƒæ…¢ï¼Œå› ä¸ºæ˜¯ä»ç¡¬ç›˜ä¸Šè¯»å–çš„ã€‚å°†è¯¥ç”¨æˆ·è®¿é—®çš„æ•°æ®å­˜åœ¨æ•°ç¼“å­˜ä¸­ï¼Œè¿™æ ·ä¸‹ä¸€æ¬¡å†è®¿é—®è¿™äº›æ•°æ®çš„æ—¶å€™å°±å¯ä»¥ç›´æ¥ä»ç¼“å­˜ä¸­è·å–äº†ã€‚æ“ä½œç¼“å­˜å°±æ˜¯ç›´æ¥æ“ä½œå†…å­˜ï¼Œæ‰€ä»¥é€Ÿåº¦ç›¸å½“å¿«ã€‚å¦‚æœæ•°æ®åº“ä¸­çš„å¯¹åº”æ•°æ®æ”¹å˜çš„ä¹‹åï¼ŒåŒæ­¥æ”¹å˜ç¼“å­˜ä¸­ç›¸åº”çš„æ•°æ®å³å¯ã€‚\n\n**2ã€é«˜å¹¶å‘ï¼š**\n\nç›´æ¥æ“ä½œç¼“å­˜èƒ½å¤Ÿæ‰¿å—çš„è¯·æ±‚æ˜¯è¿œè¿œå¤§äºç›´æ¥è®¿é—®æ•°æ®åº“çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è€ƒè™‘æŠŠæ•°æ®åº“ä¸­çš„éƒ¨åˆ†æ•°æ®è½¬ç§»åˆ°ç¼“å­˜ä¸­å»ï¼Œè¿™æ ·ç”¨æˆ·çš„ä¸€éƒ¨åˆ†è¯·æ±‚ä¼šç›´æ¥åˆ°ç¼“å­˜è¿™é‡Œè€Œä¸ç”¨ç»è¿‡æ•°æ®åº“ï¼Œç¼“è§£æ•°æ®åº“å‹åŠ›ã€‚\n\n### Redis ä¸ Memcached ç›¸æ¯”æœ‰å“ªäº›ä¼˜åŠ¿\n\nRedis æ”¯æŒæ›´ä¸°å¯Œçš„æ•°æ®ç±»å‹ï¼ˆæ”¯æŒæ›´å¤æ‚çš„åº”ç”¨åœºæ™¯ï¼‰\n\nRedis æ”¯æŒæ•°æ®çš„æŒä¹…åŒ–ï¼Œå¯ä»¥å°†å†…å­˜ä¸­çš„æ•°æ®ä¿æŒåœ¨ç£ç›˜ä¸­ï¼Œé‡å¯çš„æ—¶å€™å¯ä»¥å†æ¬¡åŠ è½½è¿›è¡Œä½¿ç”¨ï¼Œè€Œ Memecache æŠŠæ•°æ®å…¨éƒ¨å­˜åœ¨å†…å­˜ä¹‹ä¸­ã€‚\n\nRedis ä½¿ç”¨å•çº¿ç¨‹çš„å¤šè·¯ IO å¤ç”¨æ¨¡å‹ï¼›Memcached æ˜¯å¤šçº¿ç¨‹ï¼Œéé˜»å¡ IO å¤ç”¨çš„ç½‘ç»œæ¨¡å‹ã€‚\n\n***\n\n## Redisäº”å¤§åŸºæœ¬ç±»å‹\n\n[Redis å‘½ä»¤å¤§å…¨](https://www.Redis.net.cn/order/)\n\n[Redis åº”ç”¨åœºæ™¯](https://juejin.cn/post/6857667542652190728)\n\n### Stringï¼ˆå­—ç¬¦ä¸²ï¼‰\n\n> 1. String ç±»å‹æ˜¯ Redis çš„æœ€åŸºç¡€çš„æ•°æ®ç»“æ„ï¼Œä¹Ÿæ˜¯æœ€ç»å¸¸ä½¿ç”¨åˆ°çš„ç±»å‹ã€‚è€Œä¸”å…¶ä»–çš„å››ç§ç±»å‹å¤šå¤šå°‘å°‘éƒ½æ˜¯åœ¨å­—ç¬¦ä¸²ç±»å‹çš„åŸºç¡€ä¸Šæ„å»ºçš„ï¼Œæ‰€ä»¥ String ç±»å‹æ˜¯ Redis çš„åŸºç¡€ã€‚\n>\n> 2. String ç±»å‹çš„å€¼æœ€å¤§èƒ½å­˜å‚¨ 512MBï¼Œè¿™é‡Œçš„ String ç±»å‹å¯ä»¥æ˜¯ç®€å•å­—ç¬¦ä¸²ã€  å¤æ‚çš„ xml/json çš„å­—ç¬¦ä¸²ã€äºŒè¿›åˆ¶å›¾åƒæˆ–è€…éŸ³é¢‘çš„å­—ç¬¦ä¸²ã€ä»¥åŠå¯ä»¥æ˜¯æ•°å­—çš„å­—ç¬¦ä¸²ã€‚\n\n**åº”ç”¨åœºæ™¯**\n\n1ã€ç¼“å­˜åŠŸèƒ½ï¼šString å­—ç¬¦ä¸²æ˜¯æœ€å¸¸ç”¨çš„æ•°æ®ç±»å‹ï¼Œä¸ä»…ä»…æ˜¯ Redisï¼Œå„ä¸ªè¯­è¨€éƒ½æ˜¯æœ€åŸºæœ¬ç±»å‹ï¼Œå› æ­¤ï¼Œåˆ©ç”¨ Redis ä½œä¸ºç¼“å­˜ï¼Œé…åˆå…¶å®ƒæ•°æ®åº“ä½œä¸ºå­˜å‚¨å±‚ï¼Œåˆ©ç”¨ Redis æ”¯æŒé«˜å¹¶å‘çš„ç‰¹ç‚¹ï¼Œå¯ä»¥å¤§å¤§åŠ å¿«ç³»ç»Ÿçš„è¯»å†™é€Ÿåº¦ã€ä»¥åŠé™ä½åç«¯æ•°æ®åº“çš„å‹åŠ›ã€‚\n\n2ã€è®¡æ•°å™¨ï¼šè®¸å¤šç³»ç»Ÿéƒ½ä¼šä½¿ç”¨ Redis ä½œä¸ºç³»ç»Ÿçš„å®æ—¶è®¡æ•°å™¨ï¼Œå¯ä»¥å¿«é€Ÿå®ç°è®¡æ•°å’ŒæŸ¥è¯¢çš„åŠŸèƒ½ã€‚è€Œä¸”æœ€ç»ˆçš„æ•°æ®ç»“æœå¯ä»¥æŒ‰ç…§ç‰¹å®šçš„æ—¶é—´è½åœ°åˆ°æ•°æ®åº“æˆ–è€…å…¶å®ƒå­˜å‚¨ä»‹è´¨å½“ä¸­è¿›è¡Œæ°¸ä¹…ä¿å­˜ã€‚\n\n3ã€å…±äº«ç”¨æˆ· sessionï¼šç”¨æˆ·é‡æ–°åˆ·æ–°ä¸€æ¬¡ç•Œé¢ï¼Œå¯èƒ½éœ€è¦è®¿é—®ä¸€ä¸‹æ•°æ®è¿›è¡Œé‡æ–°ç™»å½•ï¼Œæˆ–è€…è®¿é—®é¡µé¢ç¼“å­˜ cookieï¼Œè¿™ä¸¤ç§æ–¹å¼åšæœ‰ä¸€å®šå¼Šç«¯ï¼Œ1ï¼‰æ¯æ¬¡éƒ½é‡æ–°ç™»å½•æ•ˆç‡ä½ä¸‹ 2ï¼‰cookie ä¿å­˜åœ¨å®¢æˆ·ç«¯ï¼Œæœ‰å®‰å…¨éšæ‚£ã€‚è¿™æ—¶å¯ä»¥åˆ©ç”¨ Redis å°†ç”¨æˆ·çš„ session é›†ä¸­ç®¡ç†ï¼Œåœ¨è¿™ç§æ¨¡å¼åªéœ€è¦ä¿è¯ Redis çš„é«˜å¯ç”¨ï¼Œæ¯æ¬¡ç”¨æˆ· session çš„æ›´æ–°å’Œè·å–éƒ½å¯ä»¥å¿«é€Ÿå®Œæˆã€‚å¤§å¤§æé«˜æ•ˆç‡ã€‚ï¼ˆåˆ†å¸ƒå¼ä¼šè¯ï¼‰\n\n### Listï¼ˆåˆ—è¡¨ï¼‰\n\n> 1. List æ˜¯ç®€å•çš„å­—ç¬¦ä¸²åˆ—è¡¨\n> 2. Redis å¯ä»¥ä»åˆ—è¡¨çš„ä¸¤ç«¯è¿›è¡Œæ’å…¥ï¼ˆpubshï¼‰å’Œå¼¹å‡ºï¼ˆpopï¼‰å…ƒç´ ï¼Œæ”¯æŒè¯»å–æŒ‡å®šèŒƒå›´çš„å…ƒç´ é›†ï¼Œæˆ–è€…è¯»å–æŒ‡å®šä¸‹æ ‡çš„å…ƒç´ ç­‰æ“ä½œã€‚Redisåˆ—è¡¨æ˜¯ä¸€ç§æ¯”è¾ƒçµæ´»çš„é“¾è¡¨æ•°æ®ç»“æ„ï¼Œå®ƒå¯ä»¥å……å½“é˜Ÿåˆ—æˆ–è€…æ ˆçš„è§’è‰²ã€‚\n\n**åº”ç”¨åœºæ™¯**\n\n1ã€æ¶ˆæ¯é˜Ÿåˆ—ï¼šRedis çš„é“¾è¡¨ç»“æ„ï¼Œå¯ä»¥è½»æ¾å®ç°é˜»å¡é˜Ÿåˆ—ï¼Œå¯ä»¥ä½¿ç”¨å·¦è¿›å³å‡ºçš„å‘½ä»¤ç»„æˆæ¥å®Œæˆé˜Ÿåˆ—çš„è®¾è®¡ã€‚æ¯”å¦‚ï¼šæ•°æ®çš„ç”Ÿäº§è€…å¯ä»¥é€šè¿‡ lpush å‘½ä»¤ä»å·¦è¾¹æ’å…¥æ•°æ®ï¼Œå¤šä¸ªæ•°æ®æ¶ˆè´¹è€…ï¼Œå¯ä»¥ä½¿ç”¨ rpop å‘½ä»¤é˜»å¡çš„â€œæŠ¢â€åˆ—è¡¨å°¾éƒ¨çš„æ•°æ®ã€‚\n\n2ã€æ–‡ç« åˆ—è¡¨æˆ–è€…æ•°æ®åˆ†é¡µå±•ç¤ºçš„åº”ç”¨ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å¸¸ç”¨çš„åšå®¢ç½‘ç«™çš„æ–‡ç« åˆ—è¡¨ï¼Œå½“ç”¨æˆ·é‡è¶Šæ¥è¶Šå¤šæ—¶ï¼Œè€Œä¸”æ¯ä¸€ä¸ªç”¨æˆ·éƒ½æœ‰è‡ªå·±çš„æ–‡ç« åˆ—è¡¨ï¼Œè€Œä¸”å½“æ–‡ç« å¤šæ—¶ï¼Œéƒ½éœ€è¦åˆ†é¡µå±•ç¤ºï¼Œè¿™æ—¶å¯ä»¥è€ƒè™‘ä½¿ç”¨ Redis çš„åˆ—è¡¨ï¼Œåˆ—è¡¨ä¸ä½†æœ‰åºåŒæ—¶è¿˜æ”¯æŒæŒ‰ç…§èŒƒå›´å†…è·å–å…ƒç´ ï¼Œå¯ä»¥å®Œç¾è§£å†³åˆ†é¡µæŸ¥è¯¢åŠŸèƒ½ã€‚å¤§å¤§æé«˜æŸ¥è¯¢æ•ˆç‡ã€‚\n\n### Setï¼ˆé›†åˆï¼‰\n\n> 1. Redis é›†åˆ set ç±»å‹å’Œ list åˆ—è¡¨ç±»å‹ç±»ä¼¼ï¼Œéƒ½å¯ä»¥ç”¨æ¥å­˜å‚¨å¤šä¸ªå­—ç¬¦ä¸²å…ƒç´ çš„é›†åˆã€‚\n> 2. ä½†æ˜¯å’Œ list ä¸åŒçš„æ˜¯ set é›†åˆå½“ä¸­ä¸å…è®¸é‡å¤çš„å…ƒç´ ã€‚è€Œä¸” set é›†åˆå½“ä¸­å…ƒç´ æ˜¯æ²¡æœ‰é¡ºåºçš„ï¼Œä¸å­˜åœ¨å…ƒç´ ä¸‹æ ‡ã€‚\n> 3. Redis çš„ set ç±»å‹æ˜¯ä½¿ç”¨å“ˆå¸Œè¡¨æ„é€ çš„ï¼Œå› æ­¤å¤æ‚åº¦æ˜¯ O(1)ï¼Œå®ƒæ”¯æŒé›†åˆå†…çš„å¢åˆ æ”¹æŸ¥ï¼Œå¹¶ä¸”æ”¯æŒå¤šä¸ªé›†åˆé—´çš„äº¤é›†ã€å¹¶é›†ã€å·®é›†æ“ä½œã€‚å¯ä»¥åˆ©ç”¨è¿™äº›é›†åˆæ“ä½œï¼Œè§£å†³ç¨‹åºå¼€å‘è¿‡ç¨‹å½“ä¸­å¾ˆå¤šæ•°æ®é›†åˆé—´çš„é—®é¢˜ã€‚\n\n**åº”ç”¨åœºæ™¯**\n\n1ã€æ ‡ç­¾ï¼šæ¯”å¦‚æˆ‘ä»¬åšå®¢ç½‘ç«™å¸¸å¸¸ä½¿ç”¨åˆ°çš„å…´è¶£æ ‡ç­¾ï¼ŒæŠŠä¸€ä¸ªä¸ªæœ‰ç€ç›¸åŒçˆ±å¥½ï¼Œå…³æ³¨ç±»ä¼¼å†…å®¹çš„ç”¨æˆ·åˆ©ç”¨ä¸€ä¸ªæ ‡ç­¾æŠŠä»–ä»¬è¿›è¡Œå½’å¹¶ã€‚\n\n2ã€å…±åŒå¥½å‹åŠŸèƒ½ï¼Œå…±åŒå–œå¥½ï¼Œæˆ–è€…å¯ä»¥å¼•ç”³åˆ°äºŒåº¦å¥½å‹ä¹‹ç±»çš„æ‰©å±•åº”ç”¨ã€‚\n\n3ã€ç»Ÿè®¡ç½‘ç«™çš„ç‹¬ç«‹ IPã€‚åˆ©ç”¨ set é›†åˆå½“ä¸­å…ƒç´ ä¸å”¯ä¸€æ€§ï¼Œå¯ä»¥å¿«é€Ÿå®æ—¶ç»Ÿè®¡è®¿é—®ç½‘ç«™çš„ç‹¬ç«‹ IPã€‚\n\n### sorted setï¼ˆæœ‰åºé›†åˆï¼‰\n\n> Redis æœ‰åºé›†åˆä¹Ÿæ˜¯é›†åˆç±»å‹çš„ä¸€éƒ¨åˆ†ï¼Œæ‰€ä»¥å®ƒä¿ç•™äº†é›†åˆä¸­å…ƒç´ ä¸èƒ½é‡å¤çš„ç‰¹æ€§ï¼Œä½†æ˜¯ä¸åŒçš„æ˜¯ï¼Œæœ‰åºé›†åˆç»™æ¯ä¸ªå…ƒç´ å¤šè®¾ç½®äº†ä¸€ä¸ªåˆ†æ•°ï¼Œåˆ©ç”¨è¯¥åˆ†æ•°ä½œä¸ºæ’åºçš„ä¾æ®ã€‚\n\n#### åº”ç”¨åœºæ™¯\n\n1ã€æ’è¡Œæ¦œï¼šæœ‰åºé›†åˆç»å…¸ä½¿ç”¨åœºæ™¯ã€‚ä¾‹å¦‚è§†é¢‘ç½‘ç«™éœ€è¦å¯¹ç”¨æˆ·ä¸Šä¼ çš„è§†é¢‘åšæ’è¡Œæ¦œï¼Œæ¦œå•ç»´æŠ¤å¯èƒ½æ˜¯å¤šæ–¹é¢ï¼šæŒ‰ç…§æ—¶é—´ã€æŒ‰ç…§æ’­æ”¾é‡ã€æŒ‰ç…§è·å¾—çš„èµæ•°ç­‰ã€‚\n\n2ã€ç”¨ Sorted Sets æ¥åšå¸¦æƒé‡çš„é˜Ÿåˆ—ï¼Œæ¯”å¦‚æ™®é€šæ¶ˆæ¯çš„ score ä¸º 1ï¼Œé‡è¦æ¶ˆæ¯çš„ score ä¸º 2ï¼Œç„¶åå·¥ä½œçº¿ç¨‹å¯ä»¥é€‰æ‹©æŒ‰ score çš„å€’åºæ¥è·å–å·¥ä½œä»»åŠ¡ã€‚è®©é‡è¦çš„ä»»åŠ¡ä¼˜å…ˆæ‰§è¡Œã€‚\n\n### hashï¼ˆå“ˆå¸Œï¼‰\n\nRedis hash æ•°æ®ç»“æ„ æ˜¯ä¸€ä¸ªé”®å€¼å¯¹ï¼ˆkey-valueï¼‰é›†åˆï¼Œå®ƒæ˜¯ä¸€ä¸ª string ç±»å‹çš„ field å’Œ value çš„æ˜ å°„è¡¨ï¼ŒRedis æœ¬èº«å°±æ˜¯ä¸€ä¸ª key-value å‹æ•°æ®åº“ï¼Œå› æ­¤ hash æ•°æ®ç»“æ„ç›¸å½“äºåœ¨ value ä¸­åˆå¥—äº†ä¸€å±‚ key-value å‹æ•°æ®ã€‚æ‰€ä»¥ Redis ä¸­ hash æ•°æ®ç»“æ„ç‰¹åˆ«é€‚åˆå­˜å‚¨å…³ç³»å‹å¯¹è±¡ã€‚\n\n> ç”¨æˆ· ID ä¸ºæŸ¥æ‰¾çš„keyï¼Œå­˜å‚¨çš„ value ç”¨æˆ·å¯¹è±¡åŒ…å«å§“åï¼Œå¹´é¾„ï¼Œç”Ÿæ—¥ç­‰ä¿¡æ¯ï¼Œå¦‚æœç”¨æ™®é€šçš„ key/value ç»“æ„æ¥å­˜å‚¨\n>\n> 1. å°†ç”¨æˆ· ID ä½œä¸º keyï¼Œå§“åå±æ€§+å§“åæ•°æ®æ•´ä½“ä½œä¸º valueã€‚ç¼ºç‚¹æ˜¯æ¯æ¬¡ä¿®æ”¹ç”¨æˆ·çš„æŸä¸ªå±æ€§ï¼Œéƒ½éœ€è¦å…ˆååºåˆ—åŒ– å±æ€§+æ•°æ®ï¼Œä¿®æ”¹å¥½ï¼Œç„¶åå°† å±æ€§+æ•°æ® åºåˆ—åŒ–ä¹‹ååœ¨ä¿®æ”¹å›å»ï¼Œå¼€é”€è¾ƒå¤§ã€‚\n>\n> ![ID -> å±æ€§+æ•°æ®](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650356860189.png)\n>\n> 2. å°†ç”¨æˆ· ID+å§“åå±æ€§ä½œä¸º keyï¼Œå§“åæ•°æ®ä½œä¸º valueã€‚ç¼ºç‚¹æ˜¯ç”¨æˆ· ID ä½¿ç”¨å¤šæ¬¡ï¼Œæ•°æ®å†—ä½™\n>\n> ![ID+å±æ€§ -> æ•°æ®](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650356955204.png)\n>\n> \n>\n> 3. å› æ­¤é€šè¿‡ key(ç”¨æˆ· ID) + field(å±æ€§æ ‡ç­¾) å°±å¯ä»¥æ“ä½œå¯¹åº”å±æ€§æ•°æ®äº†ï¼Œæ—¢ä¸éœ€è¦é‡å¤å­˜å‚¨æ•°æ®ï¼Œä¹Ÿä¸ä¼šå¸¦æ¥åºåˆ—åŒ–å’Œå¹¶å‘ä¿®æ”¹æ§åˆ¶çš„é—®é¢˜ã€‚\n>\n> ![ID -> å±æ€§ -> æ•°æ®](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650356950290.png)\n\n#### åº”ç”¨åœºæ™¯\n\n1ã€ç”±äº hash æ•°æ®ç±»å‹çš„ key-value çš„ç‰¹æ€§ï¼Œç”¨æ¥å­˜å‚¨å…³ç³»å‹æ•°æ®åº“ä¸­è¡¨è®°å½•ï¼Œæ˜¯ Redis ä¸­å“ˆå¸Œç±»å‹æœ€å¸¸ç”¨çš„åœºæ™¯ã€‚ä¸€æ¡è®°å½•ä½œä¸ºä¸€ä¸ª key-valueï¼ŒæŠŠæ¯åˆ—å±æ€§å€¼å¯¹åº”æˆ field-value å­˜å‚¨åœ¨å“ˆå¸Œè¡¨å½“ä¸­ï¼Œç„¶åé€šè¿‡ key å€¼æ¥åŒºåˆ†è¡¨å½“ä¸­çš„ä¸»é”®ã€‚\n\n2ã€ç»å¸¸è¢«ç”¨æ¥å­˜å‚¨ç”¨æˆ·ç›¸å…³ä¿¡æ¯ã€‚ä¼˜åŒ–ç”¨æˆ·ä¿¡æ¯çš„è·å–ï¼Œä¸éœ€è¦é‡å¤ä»æ•°æ®åº“å½“ä¸­è¯»å–ï¼Œæé«˜ç³»ç»Ÿæ€§èƒ½ã€‚\n\n***\n\n## äº”å¤§åŸºæœ¬ç±»å‹åº•å±‚æ•°æ®ç»“æ„\n\nRedis æ•´ä½“çš„å­˜å‚¨ç»“æ„ï¼š\n\nRedis å†…éƒ¨æ•´ä½“çš„å­˜å‚¨ç»“æ„æ˜¯ä¸€ä¸ªå¤§çš„ hashmapï¼Œå†…éƒ¨æ˜¯æ•°ç»„å®ç°çš„ hashï¼Œkey å†²çªé€šè¿‡æŒ‚é“¾è¡¨å»å®ç°ï¼Œæ¯ä¸ª dictEntry ä¸ºä¸€ä¸ª key/value å¯¹è±¡ï¼Œvalue ä¸ºå®šä¹‰çš„ redisObjectã€‚\n\nç»“æ„å›¾å¦‚ä¸‹ï¼š\n\n![Redis æ•´ä½“çš„å­˜å‚¨ç»“æ„](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650433179786.png)\n\ndictEntry æ˜¯å­˜å‚¨ key->value çš„åœ°æ–¹ï¼Œå…¶ä¸­åŒ…å«æŒ‡å‘å…·ä½“çš„ redisObject çš„æŒ‡é’ˆã€‚\n\nredisObject ä¸­*ptr æŒ‡å‘å…·ä½“çš„æ•°æ®ç»“æ„çš„åœ°å€ï¼›type è¡¨ç¤ºè¯¥å¯¹è±¡çš„ç±»å‹ï¼Œå³ Stringã€Listã€Hashã€Setã€Zset ä¸­çš„ä¸€ä¸ª\n\n### String (arrayList)\n\nString çš„æ•°æ®ç»“æ„ä¸ºç®€å•åŠ¨æ€å­—ç¬¦ä¸²(Simple Dynamic Stringï¼Œç¼©å†™ SDS)ã€‚æ˜¯å¯ä»¥ä¿®æ”¹çš„å­—ç¬¦ä¸²ï¼Œå†…éƒ¨ç»“æ„å®ç°ä¸Šç±»ä¼¼äº Java çš„ ArrayListï¼Œé‡‡ç”¨é¢„åˆ†é…å†—ä½™ç©ºé—´çš„æ–¹å¼æ¥å‡å°‘å†…å­˜çš„é¢‘ç¹åˆ†é…ã€‚\n\n![String çš„æ•°æ®ç»“æ„](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650356547555.png)\n\nå¦‚å›¾ä¸­æ‰€ç¤ºï¼Œå†…éƒ¨ä¸ºå½“å‰å­—ç¬¦ä¸²å®é™…åˆ†é…çš„ç©ºé—´ capacity ä¸€èˆ¬è¦é«˜äºå®é™…å­—ç¬¦ä¸²é•¿åº¦ lenã€‚å½“å­—ç¬¦ä¸²é•¿åº¦å°äº 1M æ—¶ï¼Œæ‰©å®¹éƒ½æ˜¯åŠ å€ç°æœ‰çš„ç©ºé—´ï¼Œå¦‚æœè¶…è¿‡ 1Mï¼Œæ‰©å®¹æ—¶ä¸€æ¬¡åªä¼šå¤šæ‰© 1M çš„ç©ºé—´ã€‚éœ€è¦æ³¨æ„çš„æ˜¯å­—ç¬¦ä¸²æœ€å¤§é•¿åº¦ä¸º 512Mã€‚\n\n### List (ziplist - quickList)\n\n1ã€Redis 3.2 ä¹‹å‰çš„åº•å±‚å®ç°æ–¹å¼ï¼šå‹ç¼©åˆ—è¡¨ ziplist æˆ–è€… åŒå‘å¾ªç¯é“¾è¡¨ linkedlist\n\nå½“ list å­˜å‚¨çš„æ•°æ®é‡æ¯”è¾ƒå°‘ä¸”åŒæ—¶æ»¡è¶³ä¸‹é¢ä¸¤ä¸ªæ¡ä»¶æ—¶ï¼Œlist å°±ä½¿ç”¨ ziplist å­˜å‚¨æ•°æ®ï¼š\n\n- list ä¸­ä¿å­˜çš„æ¯ä¸ªå…ƒç´ çš„é•¿åº¦å°äº 64 å­—èŠ‚ï¼›\n- åˆ—è¡¨ä¸­æ•°æ®ä¸ªæ•°å°‘äº 512 ä¸ªã€‚\n\n2ã€Redis 3.2 åŠä¹‹åçš„åº•å±‚å®ç°æ–¹å¼ï¼šquicklist\n\nquicklist æ˜¯ä¸€ä¸ªåŸºäº ziplist çš„åŒå‘é“¾è¡¨ï¼Œquicklist çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸€ä¸ª ziplistï¼Œç»“åˆäº†åŒå‘é“¾è¡¨å’Œ ziplist çš„ä¼˜ç‚¹ã€‚\n\n#### **ziplist**\n\nziplist æ˜¯å‹ç¼©åˆ—è¡¨ï¼Œå®ƒçš„å¥½å¤„æ˜¯èƒ½èŠ‚çœå†…å­˜ç©ºé—´ï¼Œå› ä¸ºå®ƒæ‰€å­˜å‚¨çš„å†…å®¹éƒ½æ˜¯åœ¨è¿ç»­çš„å†…å­˜åŒºåŸŸå½“ä¸­çš„ã€‚å½“åˆ—è¡¨å¯¹è±¡å…ƒç´ ä¸å¤§ï¼Œæ¯ä¸ªå…ƒç´ ä¹Ÿä¸å¤§çš„æ—¶å€™ï¼Œå°±é‡‡ç”¨ ziplist å­˜å‚¨ã€‚ä½†å½“æ•°æ®é‡è¿‡å¤§æ—¶å°± ziplist å°±ä¸æ˜¯é‚£ä¹ˆå¥½ç”¨äº†ã€‚å› ä¸ºä¸ºäº†ä¿è¯ä»–å­˜å‚¨å†…å®¹åœ¨å†…å­˜ä¸­çš„è¿ç»­æ€§ï¼Œæ’å…¥çš„å¤æ‚åº¦æ˜¯ O(N)ï¼Œå³æ¯æ¬¡æ’å…¥éƒ½ä¼šé‡æ–°è¿›è¡Œ realloc é‡æ–°åˆ†é…å†…å­˜ç©ºé—´ã€‚\n\nziplist ç»“æ„å¦‚ä¸‹ï¼š\n\n![ziplist ç»“æ„å›¾](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650419709341.png)\n\n1ã€zlbytesï¼šç”¨äºè®°å½•æ•´ä¸ªå‹ç¼©åˆ—è¡¨å ç”¨å­—èŠ‚æ•°\n\n2ã€zltailï¼šè®°å½•è¦åˆ—è¡¨å°¾èŠ‚ç‚¹è·ç¦»å‹ç¼©åˆ—è¡¨çš„èµ·å§‹åœ°å€æœ‰å¤šå°‘å­—èŠ‚ï¼Œç”¨äºå¿«é€Ÿå®šä½åˆ°æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œä»è€Œå¯ä»¥åœ¨ ziplist å°¾éƒ¨å¿«é€Ÿçš„æ‰§è¡Œ pushï¼Œpop æ“ä½œ\n\n3ã€zllenï¼šè®°å½•äº†å‹ç¼©åˆ—è¡¨åŒ…å«çš„èŠ‚ç‚¹æ•°é‡ã€‚\n\n4ã€entryXï¼šå‹ç¼©åˆ—è¡¨åŒ…å«çš„å„ä¸ªèŠ‚ç‚¹\n\n5ã€zlendï¼šç”¨äºæ ‡è®°å‹ç¼©åˆ—è¡¨çš„æœ«ç«¯ï¼Œç”¨æ¥å¿«é€Ÿå®šä½åˆ°æœ€åä¸€ä¸ªå…ƒç´ ï¼Œç„¶åå€’ç€éå†ã€‚ï¼ˆentry å—çš„ prevlen å­—æ®µè¡¨ç¤ºå‰ä¸€ä¸ª entry çš„å­—èŠ‚é•¿åº¦ï¼Œå½“å‹ç¼©åˆ—è¡¨å€’ç€éå†æ—¶ï¼Œéœ€è¦é€šè¿‡è¿™ä¸ªå­—æ®µæ¥å¿«é€Ÿå®šä½åˆ°ä¸‹ä¸€ä¸ªå…ƒç´ çš„ä½ç½®ã€‚ï¼‰\n\n**ä¸ºä»€ä¹ˆæ•°æ®é‡å¤§æ—¶ä¸ç”¨ ziplistï¼Ÿ**\n\nå› ä¸º ziplist æ˜¯ä¸€æ®µè¿ç»­çš„å†…å­˜ï¼Œæ’å…¥çš„æ—¶é—´å¤æ‚åŒ–åº¦ä¸º O(n)ï¼Œè€Œä¸”æ¯å½“æ’å…¥æ–°çš„å…ƒç´ éœ€è¦ realloc åšå†…å­˜æ‰©å±•ï¼›è€Œä¸”å¦‚æœè¶…å‡º ziplist å†…å­˜å¤§å°ï¼Œè¿˜ä¼šåšé‡æ–°åˆ†é…çš„å†…å­˜ç©ºé—´ï¼Œå¹¶å°†å†…å®¹å¤åˆ¶åˆ°æ–°çš„åœ°å€ã€‚å¦‚æœæ•°é‡å¤§çš„è¯ï¼Œé‡æ–°åˆ†é…å†…å­˜å’Œæ‹·è´å†…å­˜ä¼šæ¶ˆè€—å¤§é‡æ—¶é—´ã€‚æ‰€ä»¥ä¸é€‚åˆå¤§å‹å­—ç¬¦ä¸²ï¼Œä¹Ÿä¸é€‚åˆå­˜å‚¨é‡å¤šçš„å…ƒç´ ã€‚\n\n#### quickList\n\nå¿«é€Ÿåˆ—è¡¨æ˜¯ ziplist å’Œ linkedlist çš„æ··åˆä½“ï¼Œæ˜¯å°† linkedlist æŒ‰æ®µåˆ‡åˆ†ï¼Œæ¯ä¸€æ®µç”¨ ziplist æ¥ç´§å‡‘å­˜å‚¨ï¼Œå¤šä¸ª ziplist ä¹‹é—´ä½¿ç”¨åŒå‘æŒ‡é’ˆé“¾æ¥ã€‚\n\n**ä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨ linkedlistï¼Ÿ**\n\nlinkedlist çš„é™„åŠ ç©ºé—´ç›¸å¯¹å¤ªé«˜ï¼Œprev å’Œ next æŒ‡é’ˆå°±è¦å å» 16 ä¸ªå­—èŠ‚ï¼Œè€Œä¸”æ¯ä¸€ä¸ªç»“ç‚¹éƒ½æ˜¯å•ç‹¬åˆ†é…ï¼Œä¼šåŠ å‰§å†…å­˜çš„ç¢ç‰‡åŒ–ï¼Œå½±å“å†…å­˜ç®¡ç†æ•ˆç‡ã€‚\n\nquicklist ç»“æ„å›¾å¦‚ä¸‹ï¼š\n\n![quicklist ç»“æ„å›¾](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650419719663.png)\n\n**ziplistçš„é•¿åº¦**\n\nquicklist å†…éƒ¨é»˜è®¤å•ä¸ª ziplist é•¿åº¦ä¸º 8k å­—èŠ‚ï¼Œè¶…å‡ºäº†è¿™ä¸ªå­—èŠ‚æ•°ï¼Œå°±ä¼šæ–°èµ·ä¸€ä¸ª ziplistã€‚å…³äºé•¿åº¦å¯ä»¥ä½¿ç”¨ list-max-ziplist-size å†³å®šã€‚\n\n**å‹ç¼©æ·±åº¦**\n\næˆ‘ä»¬ä¸Šé¢è¯´åˆ°äº† quicklist ä¸‹æ˜¯ç”¨å¤šä¸ª ziplist ç»„æˆçš„ï¼ŒåŒæ—¶ä¸ºäº†è¿›ä¸€æ­¥èŠ‚çº¦ç©ºé—´ï¼ŒRedis è¿˜ä¼šå¯¹ ziplist è¿›è¡Œå‹ç¼©å­˜å‚¨ï¼Œä½¿ç”¨ LZF ç®—æ³•å‹ç¼©ï¼Œå¯ä»¥é€‰æ‹©å‹ç¼©æ·±åº¦ã€‚quicklist é»˜è®¤çš„å‹ç¼©æ·±åº¦æ˜¯ 0ï¼Œä¹Ÿå°±æ˜¯ä¸å‹ç¼©ã€‚å‹ç¼©çš„å®é™…æ·±åº¦ç”±é…ç½®å‚æ•° list-compress-depth å†³å®šã€‚ä¸ºäº†æ”¯æŒå¿«é€Ÿ push/pop æ“ä½œï¼Œquicklist çš„é¦–å°¾ä¸¤ä¸ª ziplist ä¸å‹ç¼©ï¼Œæ­¤æ—¶æ·±åº¦å°±æ˜¯ 1ã€‚å¦‚æœæ·±åº¦ä¸º 2ï¼Œå°±è¡¨ç¤º quicklist çš„é¦–å°¾ç¬¬ä¸€ä¸ª ziplist ä»¥åŠé¦–å°¾ç¬¬äºŒä¸ª ziplist éƒ½ä¸å‹ç¼©ã€‚\n\n### Hash (ziplist - dict)\n\n#### ziplist\n\nå½“ Hash ä¸­æ•°æ®é¡¹æ¯”è¾ƒå°‘çš„æƒ…å†µä¸‹ï¼ŒHash åº•å±‚æ‰ç”¨å‹ç¼©åˆ—è¡¨ ziplist è¿›è¡Œå­˜å‚¨æ•°æ®ï¼Œéšç€æ•°æ®çš„å¢åŠ ï¼Œåº•å±‚çš„ ziplist å°±å¯èƒ½ä¼šè½¬æˆ dictï¼Œå…·ä½“é…ç½®å¦‚ä¸‹\n\n> hash-max-ziplist-entries 512\n> hash-max-ziplist-value 64\n\nåœ¨å¦‚ä¸‹ä¸¤ä¸ªæ¡ä»¶ä¹‹ä¸€æ»¡è¶³çš„æ—¶å€™ï¼Œziplist ä¼šè½¬æˆ dictï¼š\n\n- å½“ hash ä¸­çš„æ•°æ®é¡¹çš„æ•°ç›®è¶…è¿‡ 512 çš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯ ziplist æ•°æ®é¡¹è¶…è¿‡ 1024 çš„æ—¶å€™ï¼›\n- å½“ hash ä¸­æ’å…¥çš„ä»»æ„ä¸€ä¸ª value çš„é•¿åº¦è¶…è¿‡äº† 64 çš„æ—¶å€™ã€‚\n\næ¯å½“æœ‰æ–°çš„é”®å€¼å¯¹åŠ å…¥åˆ°å“ˆå¸Œå¯¹è±¡æ—¶ï¼Œå…ˆå‹å…¥é”®ï¼Œå†å‹å…¥å€¼ï¼Œå¦‚å›¾ï¼š\n\n![ziplistå®ç°çš„hash](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/20190703171927309.png)\n\nå½“éå†æ—¶ï¼Œä»å¤´åˆ°å°¾çš„éå†ï¼Œä¸”è·³è¿‡å€¼èŠ‚ç‚¹ã€‚\n\n#### dict\n\nå­—å…¸çš„å“ˆå¸Œè¡¨ç»“æ„å’Œ Java çš„ HashMap ç»“æ„å‡ ä¹æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯é€šè¿‡æŸä¸ªå“ˆå¸Œå‡½æ•°ä» key è®¡ç®—å¾—åˆ°åœ¨å“ˆå¸Œè¡¨ä¸­çš„ä½ç½®ï¼Œé‡‡ç”¨é“¾è¡¨æ³•è§£å†³å†²çªã€‚Redis è¿™é‡Œä½¿ç”¨çš„æ˜¯å•é“¾è¡¨ï¼Œä¸ºäº†æŸ¥è¯¢æ•ˆç‡æ¯æ¬¡æŠŠæ–°æ•°æ®æ’å…¥åˆ°é“¾è¡¨å¤´ä½ç½®ï¼ˆä½¿ç”¨å¤´æ’æ³•æ˜¯å› ä¸ºæ–°æ’å…¥çš„æ•°æ®è¢«è®¿é—®çš„æ¦‚ç‡å¤§ï¼Œå¯ä»¥æ›´å¿«è®¿é—®åˆ°ï¼‰ã€‚\n\næˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¯ä¸ª dict ä¸­éƒ½æœ‰ä¸¤ä¸ª hashtableï¼Œç»“æ„å›¾å¦‚ä¸‹ï¼š\n\n![dictå®ç°çš„hash](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650420119549.png)\n\nè™½ç„¶ dict ç»“æ„æœ‰ä¸¤ä¸ª hashtableï¼Œä½†æ˜¯é€šå¸¸æƒ…å†µä¸‹åªæœ‰ä¸€ä¸ª hashtable æ˜¯æœ‰å€¼çš„ã€‚ä½†æ˜¯åœ¨ dict æ‰©å®¹ç¼©å®¹çš„æ—¶å€™ï¼Œéœ€è¦åˆ†é…æ–°çš„ hashtableï¼Œç„¶åè¿›è¡Œæ¸è¿‘å¼æ¬è¿ï¼Œè¿™æ—¶å€™ä¸¤ä¸ª hashtable å­˜å‚¨çš„æ—§çš„ hashtable å’Œæ–°çš„ hashtableã€‚æ¬è¿ç»“æŸåï¼Œæ—§ hashtable åˆ é™¤ï¼Œæ–°çš„å–è€Œä»£ä¹‹ã€‚\n\n**æ¸è¿›å¼ rehash**\n\næ‰€è°“æ¸è¿›å¼ rehash æ˜¯æŒ‡æˆ‘ä»¬çš„å¤§å­—å…¸çš„æ‰©å®¹æ˜¯æ¯”è¾ƒæ¶ˆè€—æ—¶é—´çš„ï¼Œéœ€è¦é‡æ–°ç”³è¯·æ–°çš„æ•°ç»„ï¼Œç„¶åå°†æ—§å­—å…¸æ‰€æœ‰é“¾è¡¨çš„å…ƒç´ é‡æ–°æŒ‚æ¥åˆ°æ–°çš„æ•°ç»„ä¸‹é¢ï¼Œæ˜¯ä¸€ä¸ª O(n)çš„æ“ä½œã€‚ä½†æ˜¯å› ä¸ºæˆ‘ä»¬çš„ Redis æ˜¯å•çº¿ç¨‹çš„ï¼Œæ— æ³•æ‰¿å—è¿™æ ·çš„è€—æ—¶è¿‡ç¨‹ï¼Œæ‰€ä»¥é‡‡ç”¨äº†æ¸è¿›å¼ rehash å°æ­¥æ¬è¿ï¼Œè™½ç„¶æ…¢ä¸€ç‚¹ï¼Œä½†æ˜¯å¯ä»¥æ¬è¿å®Œæ¯•ã€‚\n\n**æ‰©å®¹æ¡ä»¶**\n\næˆ‘ä»¬çš„æ‰©å®¹ä¸€èˆ¬ä¼šåœ¨ Hash è¡¨ä¸­çš„å…ƒç´ ä¸ªæ•°ç­‰äºç¬¬ä¸€ç»´æ•°ç»„çš„é•¿åº¦çš„æ—¶å€™ï¼Œå°±ä¼šå¼€å§‹æ‰©å®¹ã€‚æ‰©å®¹çš„å¤§å°æ˜¯åŸæ•°ç»„çš„ä¸¤å€ã€‚ä¸è¿‡åœ¨ Redis åœ¨åš bgsaveï¼ˆRDB æŒä¹…åŒ–æ“ä½œçš„è¿‡ç¨‹ï¼‰ï¼Œä¸ºäº†å‡å°‘å†…å­˜é¡µçš„è¿‡å¤šåˆ†ç¦»ï¼ˆCopy On Writeï¼‰ï¼ŒRedis ä¸ä¼šå»æ‰©å®¹ã€‚ä½†æ˜¯å¦‚æœ hash è¡¨çš„å…ƒç´ ä¸ªæ•°å·²ç»åˆ°è¾¾äº†ç¬¬ä¸€ç»´æ•°ç»„é•¿åº¦çš„ 5 å€çš„æ—¶å€™ï¼Œå°±ä¼šå¼ºåˆ¶æ‰©å®¹ï¼Œä¸ç®¡ä½ æ˜¯å¦åœ¨æŒä¹…åŒ–ã€‚\n\nä¸æ‰©å®¹ä¸»è¦æ˜¯ä¸ºäº†å°½å¯èƒ½å‡å°‘å†…å­˜é¡µè¿‡å¤šåˆ†ç¦»ï¼Œç³»ç»Ÿéœ€è¦æ›´å¤šçš„å¼€é”€å»å›æ”¶å†…å­˜ã€‚\n\n**ç¼©å®¹æ¡ä»¶**\n\nå½“æˆ‘ä»¬çš„ hash è¡¨å…ƒç´ é€æ¸åˆ é™¤çš„è¶Šæ¥è¶Šå°‘çš„æ—¶å€™ã€‚Redis äºæ˜¯å°±ä¼šå¯¹ hash è¡¨è¿›è¡Œç¼©å®¹æ¥å‡å°‘ç¬¬ä¸€ç»´æ•°ç»„é•¿åº¦çš„ç©ºé—´å ç”¨ã€‚ç¼©å®¹çš„æ¡ä»¶æ˜¯å…ƒç´ ä¸ªæ•°ä½äºæ•°ç»„é•¿åº¦çš„ 10%ï¼Œå¹¶ä¸”ç¼©å®¹ä¸è€ƒè™‘æ˜¯å¦åœ¨åš Redis æŒä¹…åŒ–ã€‚\n\nä¸ç”¨è€ƒè™‘ bgsave ä¸»è¦æ˜¯å› ä¸ºæˆ‘ä»¬çš„ç¼©å®¹çš„å†…å­˜éƒ½æ˜¯å·²ç»ä½¿ç”¨è¿‡çš„ï¼Œç¼©å®¹çš„æ—¶å€™å¯ä»¥ç›´æ¥ç½®ç©ºï¼Œè€Œä¸”ç”±äºç”³è¯·çš„å†…å­˜æ¯”è¾ƒå°ï¼ŒåŒæ—¶ä¼šé‡Šæ”¾æ‰ä¸€äº›å·²ç»ä½¿ç”¨çš„å†…å­˜ï¼Œä¸ä¼šå¢å¤§ç³»ç»Ÿçš„å‹åŠ›ã€‚\n\n**rehash æ­¥éª¤**\n\n![rehash æ­¥éª¤](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650420130964.png)\n\n### Set (intset - hashSet)\n\nRedis çš„é›†åˆç›¸å½“äº Java ä¸­çš„ HashSetï¼Œå®ƒå†…éƒ¨çš„é”®å€¼å¯¹æ˜¯æ— åºã€å”¯ä¸€çš„ã€‚å®ƒçš„å†…éƒ¨å®ç°ç›¸å½“äºä¸€ä¸ªç‰¹æ®Šçš„å­—å…¸ï¼Œå­—å…¸ä¸­æ‰€æœ‰çš„ value éƒ½æ˜¯ä¸€ä¸ªå€¼ NULLã€‚é›†åˆ Set ç±»å‹åº•å±‚ç¼–ç åŒ…æ‹¬ inset å’Œ hashtableã€‚\n\nå½“å­˜å‚¨çš„æ•°æ®åŒæ—¶æ»¡è¶³ä¸‹é¢è¿™æ ·ä¸¤ä¸ªæ¡ä»¶çš„æ—¶å€™ï¼ŒRedis å°±é‡‡ç”¨æ•´æ•°é›†åˆ intset æ¥å®ç° set è¿™ç§æ•°æ®ç±»å‹ï¼š\n\n> å­˜å‚¨çš„æ•°æ®éƒ½æ˜¯æ•´æ•°\n> å­˜å‚¨çš„æ•°æ®å…ƒç´ ä¸ªæ•°å°äº512ä¸ª\n\nå½“ä¸èƒ½åŒæ—¶æ»¡è¶³è¿™ä¸¤ä¸ªæ¡ä»¶çš„æ—¶å€™ï¼ŒRedis å°±ä½¿ç”¨ dict æ¥å­˜å‚¨é›†åˆä¸­çš„æ•°æ®\n\n**intset**\n\nintset æ˜¯ä¸€ä¸ªæœ‰åºé›†åˆï¼ŒæŸ¥æ‰¾å…ƒç´ çš„å¤æ‚åº¦ä¸º O(logN)ï¼ˆé‡‡ç”¨äºŒåˆ†æ³•ï¼‰ï¼Œä½†æ’å…¥æ—¶ä¸ä¸€å®šä¸º O(logN)ï¼Œå› ä¸ºæœ‰å¯èƒ½æ¶‰åŠåˆ°å‡çº§æ“ä½œã€‚æ¯”å¦‚å½“é›†åˆé‡Œå…¨æ˜¯ int16_t å‹çš„æ•´æ•°ï¼Œè¿™æ—¶è¦æ’å…¥ä¸€ä¸ª int32_tï¼Œé‚£ä¹ˆä¸ºäº†ç»´æŒé›†åˆä¸­æ•°æ®ç±»å‹çš„ä¸€è‡´ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„æ•°æ®éƒ½ä¼šè¢«è½¬æ¢æˆ int32_t ç±»å‹ï¼Œæ¶‰åŠåˆ°å†…å­˜çš„é‡æ–°åˆ†é…ï¼Œè¿™æ—¶æ’å…¥çš„å¤æ‚åº¦å°±ä¸º O(N)äº†ã€‚æ˜¯ intset ä¸æ”¯æŒé™çº§æ“ä½œã€‚\n\n**intset æ˜¯æœ‰åºä¸è¦å’Œ zset ææ··ï¼Œzset æ˜¯è®¾ç½®ä¸€ä¸ª score æ¥è¿›è¡Œæ’åºï¼Œè€Œ intset è¿™é‡Œåªæ˜¯å•çº¯çš„å¯¹æ•´æ•°è¿›è¡Œå‡åºè€Œå·²**\n\n### Sorted Set (ziplist - zset(dict + skipList))\n\nZset æœ‰åºé›†åˆå’Œ set é›†åˆæœ‰ç€å¿…ç„¶çš„è”ç³»ï¼Œä»–ä¿ç•™äº†é›†åˆä¸èƒ½æœ‰é‡å¤æˆå‘˜çš„ç‰¹æ€§ï¼Œä½†ä¸åŒçš„æ˜¯ï¼Œæœ‰åºé›†åˆä¸­çš„å…ƒç´ æ˜¯å¯ä»¥æ’åºçš„ï¼Œä½†æ˜¯å®ƒå’Œåˆ—è¡¨çš„ä½¿ç”¨ç´¢å¼•ä¸‹æ ‡ä½œä¸ºæ’åºä¾æ®ä¸åŒçš„æ˜¯ï¼Œå®ƒç»™æ¯ä¸ªå…ƒç´ è®¾ç½®ä¸€ä¸ªåˆ†æ•° scoreï¼Œä½œä¸ºæ’åºçš„ä¾æ®ã€‚\n\nå½“æ•°æ®è¾ƒå°‘æ—¶ï¼Œsorted set æ˜¯ç”± ziplist æ¥å®ç°çš„ã€‚\nå½“æ•°æ®å¤šçš„æ—¶å€™ï¼Œsorted set æ˜¯ç”± zset çš„æ•°æ®ç»“æ„æ¥å®ç°çš„ï¼Œè¿™ä¸ª zset åŒ…å«ä¸€ä¸ª dict + ä¸€ä¸ª skiplistã€‚dict ç”¨æ¥æŸ¥è¯¢æ•°æ®åˆ°åˆ†æ•°(score)çš„å¯¹åº”å…³ç³»ï¼Œè€Œ skiplist ç”¨æ¥æ ¹æ®æŒ‡å®šåˆ†æ•° score çš„èŒƒå›´æ¥è·å– value åˆ—è¡¨ã€‚\n\n**sorted set ziplist å®ç°**\n\nåœ¨è¿™é‡Œæˆ‘ä»¬å…ˆæ¥è®¨è®ºä¸€ä¸‹å‰ä¸€ç§æƒ…å†µâ€”â€”åŸºäº ziplist å®ç°çš„ sorted setã€‚ziplist å°±æ˜¯ç”±å¾ˆå¤šæ•°æ®é¡¹ç»„æˆçš„ä¸€å¤§å—è¿ç»­å†…å­˜ã€‚ç”±äº sorted set çš„æ¯ä¸€é¡¹å…ƒç´ éƒ½ç”±æ•°æ®å’Œ score ç»„æˆï¼Œå› æ­¤ï¼Œå½“ä½¿ç”¨ zadd å‘½ä»¤æ’å…¥ä¸€ä¸ª(æ•°æ®, score)å¯¹çš„æ—¶å€™ï¼Œåº•å±‚åœ¨ç›¸åº”çš„ ziplist ä¸Šå°±æ’å…¥ä¸¤ä¸ªæ•°æ®é¡¹ï¼šæ•°æ®åœ¨å‰ï¼Œscore åœ¨åã€‚\n\n![åŸºäº ziplist å®ç°çš„ sorted set](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650431975904.png)\n\nziplist çš„ä¸»è¦ä¼˜ç‚¹æ˜¯èŠ‚çœå†…å­˜ï¼Œä½†å®ƒä¸Šé¢çš„æŸ¥æ‰¾æ“ä½œåªèƒ½æŒ‰é¡ºåºæŸ¥æ‰¾ï¼ˆå¯ä»¥æ­£åºä¹Ÿå¯ä»¥å€’åºï¼‰ã€‚å› æ­¤ï¼Œsorted set çš„å„ä¸ªæŸ¥è¯¢æ“ä½œï¼Œå°±æ˜¯åœ¨ ziplist ä¸Šä»å‰å‘åï¼ˆæˆ–ä»åå‘å‰ï¼‰ä¸€æ­¥æ­¥æŸ¥æ‰¾ï¼Œæ¯ä¸€æ­¥å‰è¿›ä¸¤ä¸ªæ•°æ®é¡¹ï¼Œè·¨åŸŸä¸€ä¸ª(æ•°æ®, score)å¯¹ã€‚\n\néšç€æ•°æ®çš„æ’å…¥ï¼Œsorted set åº•å±‚çš„è¿™ä¸ª ziplist å°±å¯èƒ½ä¼šè½¬æˆ zset çš„å®ç°ã€‚é‚£ä¹ˆåˆ°åº•æ’å…¥å¤šå°‘æ‰ä¼šè½¬å‘¢ï¼Ÿ\n\n> zset-max-ziplist-entries 128\t# å½“sorted setä¸­çš„å…ƒç´ ä¸ªæ•°ï¼Œå³(æ•°æ®ï¼Œ score)å¯¹çš„æ•°ç›®è¶…è¿‡128çš„æ—¶å€™\n> zset-max-ziplist-value 64\t# å½“sorted setä¸­æ’å…¥çš„ä»»æ„ä¸€ä¸ªæ•°æ®çš„é•¿åº¦è¶…è¿‡äº†64çš„æ—¶å€™ã€‚\n\n**sorted set ziplistå®ç°**\nRedis çš„ zset æ˜¯ä¸€ä¸ªå¤åˆç»“æ„ï¼Œä¸€æ–¹é¢å®ƒéœ€è¦ä¸€ä¸ª hash ç»“æ„æ¥å­˜å‚¨ value å’Œ score çš„å¯¹åº”å…³ç³»ï¼Œå¦ä¸€æ–¹é¢éœ€è¦æä¾›æŒ‰ç…§ score æ¥æ’åºçš„åŠŸèƒ½ï¼Œè¿˜éœ€è¦èƒ½å¤ŸæŒ‡å®š score çš„èŒƒå›´æ¥è·å– value åˆ—è¡¨çš„åŠŸèƒ½ï¼Œè¿™å°±éœ€è¦å¦å¤–ä¸€ä¸ªç»“æ„ã€Œè·³è·ƒè¡¨ã€ã€‚\n\n```c\ntypedef struct zset {\n    dict *dict;\n    zskiplist *zsl;\n} zset;\n```\n\nè·³è¡¨ï¼šé“¾è¡¨+å¤šçº§ç´¢å¼•ï¼ˆç©ºé—´æ¢æ—¶é—´ï¼‰\n\nå’Œå…¶ä»–ç»“æ„çš„æ¯”è¾ƒï¼š\n\nå¯¹äºæœ‰åºé›†åˆçš„åº•å±‚å®ç°ï¼Œå¯ä»¥ç”¨æ•°ç»„ã€å¹³è¡¡æ ‘ã€é“¾è¡¨ç­‰ã€‚æ•°ç»„ä¸ä¾¿å…ƒç´ çš„æ’å…¥ã€åˆ é™¤ï¼›å¹³è¡¡æ ‘æˆ–çº¢é»‘æ ‘è™½ç„¶æ•ˆç‡é«˜ä½†ç»“æ„å¤æ‚ï¼›é“¾è¡¨æŸ¥è¯¢éœ€è¦éå†æ‰€æœ‰æ•ˆç‡ä½ã€‚Redis é‡‡ç”¨çš„æ˜¯è·³è·ƒè¡¨ã€‚è·³è·ƒè¡¨æ•ˆç‡å ªæ¯”çº¢é»‘æ ‘ï¼Œå®ç°è¿œæ¯”çº¢é»‘æ ‘ç®€å•ã€‚\n\n***\n\n## ä¸‰å¤§ç‰¹æ®Šæ•°æ®ç±»å‹\n\n### geospatialï¼ˆåœ°ç†ä½ç½®ï¼‰\n\n1. æŸ¥çœ‹é™„è¿‘çš„äºº\n2. å¾®ä¿¡ä½ç½®å…±äº«\n3. åœ°å›¾ä¸Šç›´çº¿è·ç¦»çš„å±•ç¤º\n\n### Hyperloglogï¼ˆåŸºæ•°ï¼‰\n\nåŸºæ•°ï¼šä¸é‡å¤çš„å…ƒç´ \n\nç½‘é¡µç»Ÿè®¡ UV ï¼ˆæµè§ˆç”¨æˆ·æ•°é‡ï¼ŒåŒä¸€å¤©åŒä¸€ä¸ª ip å¤šæ¬¡è®¿é—®ç®—ä¸€æ¬¡è®¿é—®ï¼Œç›®çš„æ˜¯è®¡æ•°ï¼Œè€Œä¸æ˜¯ä¿å­˜ç”¨æˆ·ï¼‰\n\nä¼ ç»Ÿçš„æ–¹å¼ï¼Œset ä¿å­˜ç”¨æˆ·çš„ idï¼Œå¯ä»¥ç»Ÿè®¡ set ä¸­å…ƒç´ æ•°é‡ä½œä¸ºæ ‡å‡†åˆ¤æ–­ã€‚\n\nä½†å¦‚æœè¿™ç§æ–¹å¼ä¿å­˜å¤§é‡ç”¨æˆ· idï¼Œä¼šå ç”¨å¤§é‡å†…å­˜ï¼Œæˆ‘ä»¬çš„ç›®çš„æ˜¯ä¸ºäº†è®¡æ•°ï¼Œè€Œä¸æ˜¯å»ä¿å­˜ idã€‚\n\n### Bitmapsï¼ˆä½å­˜å‚¨ï¼‰\n\nRedis æä¾›äº† Bitmaps è¿™ä¸ªâ€œæ•°æ®ç±»å‹â€å¯ä»¥å®ç°å¯¹ä½çš„æ“ä½œï¼š\n\n1. Bitmaps æœ¬èº«ä¸æ˜¯ä¸€ç§æ•°æ®ç±»å‹ï¼Œ å®é™…ä¸Šå®ƒå°±æ˜¯å­—ç¬¦ä¸²ï¼ˆkey-valueï¼‰ ï¼Œ ä½†æ˜¯å®ƒå¯ä»¥å¯¹å­—ç¬¦ä¸²çš„ä½è¿›è¡Œæ“ä½œã€‚\n2. Bitmaps å•ç‹¬æä¾›äº†ä¸€å¥—å‘½ä»¤ï¼Œ æ‰€ä»¥åœ¨ Redis ä¸­ä½¿ç”¨ Bitmaps å’Œä½¿ç”¨å­—ç¬¦ä¸²çš„æ–¹æ³•ä¸å¤ªç›¸åŒã€‚ å¯ä»¥æŠŠ Bitmaps æƒ³è±¡æˆä¸€ä¸ªä»¥ä½ä¸ºå•ä½çš„æ•°ç»„ï¼Œ æ•°ç»„çš„æ¯ä¸ªå•å…ƒåªèƒ½å­˜å‚¨ 0 å’Œ 1ï¼Œ æ•°ç»„çš„ä¸‹æ ‡åœ¨ Bitmaps ä¸­å«åšåç§»é‡ã€‚\n\n#### å‘½ä»¤\n\n1. setbit\n\n\t`setbit<key><offset><value>` è®¾ç½® Bitmaps ä¸­æŸä¸ªåç§»é‡çš„å€¼ï¼ˆ0 æˆ– 1ï¼‰\n\n\tå¯ä»¥å°† idx ä½ç½®ä¸º 1 è¡¨ç¤º idx ç”¨æˆ·è®¿é—®è¿‡\n\n2. getbit\n\n\t`getbit<key><offset>` è·å– Bitmaps ä¸­æŸä¸ªåç§»é‡çš„å€¼\n\n\té€šè¿‡ idx ä½æ˜¯å¦ä¸º 1 åˆ¤æ–­ idx ç”¨æˆ·æ˜¯å¦è®¿é—®è¿‡\n\n3. bitcount\n\n\t`bitcount<key>[start end]` ç»Ÿè®¡å­—ç¬¦ä¸²ä» start å­—èŠ‚åˆ° end å­—èŠ‚æ¯”ç‰¹å€¼ä¸º 1 çš„æ•°é‡\n\n4. bitop\n\n\t`bitop and(or/not/xor) <destkey> [keyâ€¦]` bitop æ˜¯ä¸€ä¸ªå¤åˆæ“ä½œï¼Œ å®ƒå¯ä»¥åšå¤šä¸ª Bitmaps çš„ andï¼ˆäº¤é›†ï¼‰ ã€ orï¼ˆå¹¶é›†ï¼‰ ã€ notï¼ˆéï¼‰ ã€ xorï¼ˆå¼‚æˆ–ï¼‰ æ“ä½œå¹¶å°†ç»“æœä¿å­˜åœ¨ destkey ä¸­ã€‚\n\n#### **åº”ç”¨åœºæ™¯**\n\n**ä¸¤ç§çŠ¶æ€çš„ç»Ÿè®¡**éƒ½å¯ä»¥ä½¿ç”¨ bitmapsï¼Œä¾‹å¦‚ï¼šç»Ÿè®¡ç”¨æˆ·æ´»è·ƒä¸éæ´»è·ƒæ•°é‡ã€ç™»å½•ä¸éç™»å½•ã€ä¸Šç­æ‰“å¡ç­‰ç­‰ã€‚\n\n***\n\n## Redisäº‹åŠ¡ä¸é”æœºåˆ¶\n\n### äº‹åŠ¡\n\näº‹åŠ¡æœ¬è´¨ï¼šä¸€ç»„å‘½ä»¤çš„é›†åˆ\n\n#### **æ•°æ®åº“çš„äº‹åŠ¡**\n\næ•°æ®åº“äº‹åŠ¡é€šè¿‡ ACIDï¼ˆåŸå­æ€§ã€ä¸€è‡´æ€§ã€éš”ç¦»æ€§ã€æŒä¹…æ€§ï¼‰æ¥ä¿è¯ã€‚\n\næ•°æ®åº“ä¸­é™¤æŸ¥è¯¢æ“ä½œä»¥å¤–ï¼Œæ’å…¥(Insert)ã€åˆ é™¤(Delete)å’Œæ›´æ–°(Update)è¿™ä¸‰ç§æ“ä½œéƒ½ä¼šå¯¹æ•°æ®é€ æˆå½±å“ï¼Œå› ä¸ºäº‹åŠ¡å¤„ç†èƒ½å¤Ÿä¿è¯ä¸€ç³»åˆ—æ“ä½œå¯ä»¥å®Œå…¨åœ°æ‰§è¡Œæˆ–è€…å®Œå…¨ä¸æ‰§è¡Œï¼Œå› æ­¤åœ¨ä¸€ä¸ªäº‹åŠ¡è¢«æäº¤ä»¥åï¼Œè¯¥äº‹åŠ¡ä¸­çš„ä»»ä½•ä¸€æ¡ SQL è¯­å¥åœ¨è¢«æ‰§è¡Œçš„æ—¶å€™ï¼Œéƒ½ä¼šç”Ÿæˆä¸€æ¡æ’¤é”€æ—¥å¿—(Undo Log)ã€‚\n\n#### Redis äº‹åŠ¡\n\nRedis äº‹åŠ¡æä¾›äº†ä¸€ç§â€œå°†å¤šä¸ªå‘½ä»¤æ‰“åŒ…ï¼Œ ç„¶åä¸€æ¬¡æ€§ã€æŒ‰é¡ºåºåœ°æ‰§è¡Œâ€çš„æœºåˆ¶ï¼Œ å¹¶ä¸”äº‹åŠ¡åœ¨æ‰§è¡Œçš„æœŸé—´ä¸ä¼šä¸»åŠ¨ä¸­æ–­ â€”â€” æœåŠ¡å™¨åœ¨æ‰§è¡Œå®Œäº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤ä¹‹åï¼Œ æ‰ä¼šç»§ç»­å¤„ç†å…¶ä»–å®¢æˆ·ç«¯çš„å…¶ä»–å‘½ä»¤ã€‚äº‹åŠ¡ä¸­å¦‚æœæœ‰ä¸€æ¡å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œå…¶åçš„å‘½ä»¤ä»ç„¶ä¼šè¢«æ‰§è¡Œï¼Œæ²¡æœ‰å›æ»šã€‚\n\nRedis ä¸­ä¸€ä¸ªäº‹åŠ¡ä»å¼€å§‹åˆ°æ‰§è¡Œä¼šç»å†**å¼€å§‹**äº‹åŠ¡ï¼ˆMuitiï¼‰ã€å‘½ä»¤**ç»„é˜Ÿ**å’Œ**æ‰§è¡Œ**äº‹åŠ¡(Exec)ä¸‰ä¸ªé˜¶æ®µï¼Œäº‹åŠ¡ä¸­çš„å‘½ä»¤åœ¨åŠ å…¥æ—¶éƒ½æ²¡æœ‰è¢«æ‰§è¡Œï¼Œç›´åˆ°æäº¤æ—¶æ‰ä¼šå¼€å§‹æ‰§è¡Œ(Exec)ä¸€æ¬¡æ€§å®Œæˆã€‚\n\nç»„é˜Ÿçš„è¿‡ç¨‹ä¸­å¯ä»¥é€šè¿‡ discard æ¥æ”¾å¼ƒç»„é˜Ÿã€‚\n\n**äº‹åŠ¡çš„é”™è¯¯å¤„ç†**\n\nç»„é˜Ÿé˜¶æ®µæŸä¸ªå‘½ä»¤æŠ¥é”™ï¼Œæ‰§è¡Œæ—¶æ•´ä¸ªé˜Ÿåˆ—éƒ½ä¼šè¢«å–æ¶ˆã€‚\n\n![ç»„é˜Ÿé˜¶æ®µæŸä¸ªå‘½ä»¤æŠ¥é”™](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650372301056.png)\n\nå¦‚æœæ‰§è¡Œé˜¶æ®µæŸä¸ªå‘½ä»¤æŠ¥é”™ï¼Œåˆ™åªæœ‰æŠ¥é”™çš„å‘½ä»¤ä¸ä¼šè¢«æ‰§è¡Œï¼Œè€Œå…¶ä»–çš„å‘½ä»¤éƒ½ä¼šæ‰§è¡Œï¼Œä¸ä¼šå›æ»šã€‚ï¼ˆä¸ä¿è¯äº‹åŠ¡çš„åŸå­æ€§ï¼‰\n\n![æ‰§è¡Œé˜¶æ®µæŸä¸ªå‘½ä»¤æŠ¥é”™](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650372359361.png)\n\n**ä¸ºä»€ä¹ˆ Redis ä¸æ”¯æŒå›æ»šæ¥ä¿è¯åŸå­æ€§**\n\nRedis å‘½ä»¤åªä¼šå› ä¸ºé”™è¯¯çš„è¯­æ³•è€Œå¤±è´¥ï¼Œç„¶è€Œæ²¡æœ‰ä»»ä½•æœºåˆ¶èƒ½é¿å…ç¨‹åºå‘˜è‡ªå·±é€ æˆçš„é”™è¯¯ï¼Œ å¹¶ä¸”è¿™ç±»é”™è¯¯é€šå¸¸ä¸ä¼šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­å‡ºç°ï¼Œ æ‰€ä»¥ Redis é€‰æ‹©äº†æ›´ç®€å•ã€æ›´å¿«é€Ÿçš„æ— å›æ»šæ–¹å¼æ¥å¤„ç†äº‹åŠ¡ã€‚\n\n### Redis é”\n\n#### æ‚²è§‚é”\n\n**æ‚²è§‚é”(Pessimistic Lock)**ï¼Œ é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¾ˆæ‚²è§‚ï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¼šä¿®æ”¹ï¼Œæ‰€ä»¥æ¯æ¬¡åœ¨æ‹¿æ•°æ®çš„æ—¶å€™éƒ½ä¼šä¸Šé”ï¼Œè¿™æ ·åˆ«äººæƒ³æ‹¿è¿™ä¸ªæ•°æ®å°±ä¼šé˜»å¡ç›´åˆ°å®ƒæ‹¿åˆ°é”ã€‚**ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“é‡Œè¾¹å°±ç”¨åˆ°äº†å¾ˆå¤šè¿™ç§é”æœºåˆ¶**ï¼Œæ¯”å¦‚**è¡Œé”**ï¼Œ**è¡¨é”**ç­‰ï¼Œ**è¯»é”**ï¼Œ**å†™é”**ç­‰ï¼Œéƒ½æ˜¯åœ¨åšæ“ä½œä¹‹å‰å…ˆä¸Šé”ã€‚\n\n![æ‚²è§‚é”](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650417157625.png)\n\n> çº¿ç¨‹ 1 æ‹¿åˆ°è´¦æˆ·åæŠŠè´¦æˆ·é”ä½ï¼Œç„¶åæ“ä½œï¼Œè¿™æ—¶å€™çº¿ç¨‹ 2 ä¹Ÿæƒ³æ‹¿è´¦æˆ·ï¼Œå‘ç°åŠ äº†é”æ‹¿ä¸åˆ°ï¼Œåªèƒ½é˜»å¡ç­‰åˆ°é”é‡Šæ”¾ã€‚\n\n#### ä¹è§‚é”\n\n**ä¹è§‚é”(Optimistic Lock)ï¼Œ** é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¾ˆä¹è§‚ï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¸ä¼šä¿®æ”¹ï¼Œæ‰€ä»¥ä¸ä¼šä¸Šé”ï¼Œä½†æ˜¯åœ¨**æ›´æ–°çš„æ—¶å€™åˆ¤æ–­**ä¸€ä¸‹åœ¨æ­¤æœŸé—´åˆ«äººæœ‰æ²¡æœ‰å»æ›´æ–°è¿™ä¸ªæ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ç‰ˆæœ¬å·ç­‰æœºåˆ¶ã€‚**ä¹è§‚é”é€‚ç”¨äºå¤šè¯»çš„åº”ç”¨ç±»å‹ï¼Œè¿™æ ·å¯ä»¥æé«˜ååé‡**ã€‚Redis å°±æ˜¯åˆ©ç”¨è¿™ç§æœºåˆ¶å®ç°äº‹åŠ¡çš„ã€‚\n\n![ä¹è§‚é”](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650417222072.png)\n\n> ç»™è´¦æˆ·æ•°æ®åŠ ä¸€ä¸ªç‰ˆæœ¬å·ï¼Œå‡å¦‚çº¿ç¨‹ 1ã€2 éƒ½æ‹¿åˆ°è´¦æˆ·ï¼Œçº¿ç¨‹ 1 ä½¿ç”¨è´¦æˆ·å‰å…ˆè¿›è¡Œç‰ˆæœ¬å·æ¯”è¾ƒï¼Œv1.0 = v1.0ï¼Œåˆ™æ‰£å‡è´¦æˆ·ä½™é¢ï¼Œè´¦æˆ·ç‰ˆæœ¬å·å˜æ›´ä¸º v1.1ï¼Œçº¿ç¨‹ 2 å‡†å¤‡æ“ä½œæ•°æ®åº“ï¼Œå‘ç°è‡ªå·±é¢„æœŸçš„è´¦æˆ·ç‰ˆæœ¬å· v1.0 å’Œå½“å‰è´¦æˆ·ç‰ˆæœ¬å· v1.1 ä¸åŒï¼ˆCASï¼‰ï¼Œåˆ™ä¸èƒ½æ“ä½œã€‚ \n\n***\n\n## RedisæŒä¹…åŒ–\n\nRedis æ˜¯ä¸€ç§å†…å­˜å‹æ•°æ®åº“ï¼Œä¸€æ—¦æœåŠ¡å™¨è¿›ç¨‹é€€å‡ºï¼Œæ•°æ®åº“çš„æ•°æ®å°±ä¼šä¸¢å¤±ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ Redis ä¾›äº†ä¸¤ç§æŒä¹…åŒ–çš„æ–¹æ¡ˆï¼Œå°†å†…å­˜ä¸­çš„æ•°æ®ä¿å­˜åˆ°ç£ç›˜ä¸­ï¼Œé¿å…æ•°æ®çš„ä¸¢å¤±ã€‚\n\nä¸¤ç§æŒä¹…åŒ–æ–¹å¼ï¼šå¿«ç…§ï¼ˆRDB æ–‡ä»¶ï¼‰å’Œè¿½åŠ å¼æ–‡ä»¶ï¼ˆAOF æ–‡ä»¶ï¼‰ï¼Œä¸‹é¢åˆ†åˆ«ä¸ºå¤§å®¶ä»‹ç»ä¸¤ç§æ–¹å¼çš„åŸç†ã€‚\n\n- RDB æŒä¹…åŒ–æ–¹å¼ä¼šåœ¨ä¸€ä¸ªç‰¹å®šçš„é—´éš”ä¿å­˜é‚£ä¸ªæ—¶é—´ç‚¹çš„æ•°æ®å¿«ç…§ã€‚\n\n- AOF æŒä¹…åŒ–æ–¹å¼åˆ™ä¼šè®°å½•æ¯ä¸€ä¸ªæœåŠ¡å™¨æ”¶åˆ°çš„å†™æ“ä½œã€‚åœ¨æœåŠ¡å¯åŠ¨æ—¶ï¼Œè¿™äº›è®°å½•çš„æ“ä½œä¼šé€æ¡æ‰§è¡Œä»è€Œé‡å»ºå‡ºåŸæ¥çš„æ•°æ®ã€‚å†™æ“ä½œå‘½ä»¤è®°å½•çš„æ ¼å¼è·Ÿ Redis åè®®ä¸€è‡´ï¼Œä»¥è¿½åŠ çš„æ–¹å¼è¿›è¡Œä¿å­˜ã€‚\n\n- ä¸¤ç§æ–¹å¼çš„æŒä¹…åŒ–æ˜¯å¯ä»¥åŒæ—¶å­˜åœ¨çš„ï¼Œä½†æ˜¯å½“ Redis é‡å¯æ—¶ï¼ŒAOF æ–‡ä»¶ä¼šè¢«ä¼˜å…ˆç”¨äºé‡å»ºæ•°æ®ã€‚\n\n### RDB(Redis Database)\n\n> åœ¨æ»¡è¶³ç‰¹å®šçš„  Redis æ“ä½œæ¡ä»¶ï¼ˆæ—¶é—´å‘¨æœŸã€å†™æ“ä½œæ¬¡æ•°ï¼‰æ—¶ï¼Œå°†å†…å­˜ä¸­çš„æ•°æ®ä»¥ **æ•°æ®å¿«ç…§** çš„å½¢å¼å­˜å‚¨åˆ° db æ–‡ä»¶ä¸­\n\n#### **å·¥ä½œåŸç†**\n\n> [Redis_RDBæŒä¹…åŒ–ä¹‹å†™æ—¶å¤åˆ¶æŠ€æœ¯çš„åº”ç”¨](https://www.cnblogs.com/zyf98/p/15934058.html)\n\nRDB æ˜¯ä¸€æ¬¡çš„å…¨é‡å¤‡ä»½ï¼Œå³å‘¨æœŸæ€§çš„æŠŠ Redis å½“å‰å†…å­˜ä¸­çš„å…¨é‡æ•°æ®å†™å…¥åˆ°ä¸€ä¸ªå¿«ç…§æ–‡ä»¶ä¸­ã€‚Redis æ˜¯å•çº¿ç¨‹ç¨‹åºï¼Œè¿™ä¸ªçº¿ç¨‹è¦åŒæ—¶è´Ÿè´£å¤šä¸ªå®¢æˆ·ç«¯çš„è¯»å†™è¯·æ±‚ï¼Œè¿˜è¦è´Ÿè´£å‘¨æœŸæ€§çš„æŠŠå½“å‰å†…å­˜ä¸­çš„æ•°æ®å†™åˆ°å¿«ç…§æ–‡ä»¶ä¸­ RDB ä¸­ï¼Œé‚£ä¹ˆå°±ä¼šå¸¦æ¥ä»¥ä¸‹ä¸¤ä¸ªé—®é¢˜ï¼š\n\n1. æ•°æ®å†™åˆ° RDB æ–‡ä»¶æ˜¯ IO æ“ä½œï¼ŒIO æ“ä½œä¼šä¸¥é‡å½±å“ Redis çš„æ€§èƒ½ï¼Œç”šè‡³åœ¨æŒä¹…åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œè¯»å†™è¯·æ±‚ä¼šé˜»å¡\n2. å‡å¦‚ Redis æ­£åœ¨è¿›è¡ŒæŒä¹…åŒ–ä¸€ä¸ªå¤§çš„æ•°æ®ç»“æ„ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªåˆ é™¤è¯·æ±‚ï¼ŒæŠŠè¿™ä¸ªå¤§çš„æ•°æ®ç»“æ„åˆ æ‰äº†ï¼Œè¿™æ—¶å€™æŒä¹…åŒ–çš„åŠ¨ä½œè¿˜æ²¡æœ‰å®Œæˆã€‚\n\näºæ˜¯ Redis ä½¿ç”¨æ“ä½œç³»ç»Ÿçš„å¤šè¿›ç¨‹ **å†™æ—¶å¤åˆ¶(Copy On Write)æœºåˆ¶** æ¥å®ç°å¿«ç…§çš„æŒä¹…åŒ–ï¼Œåœ¨æŒä¹…åŒ–è¿‡ç¨‹ä¸­è°ƒç”¨**glibc**(Linux ä¸‹çš„ C å‡½æ•°åº“)çš„å‡½æ•° **fork()** äº§ç”Ÿä¸€ä¸ªå­è¿›ç¨‹ï¼Œè¯¥å­è¿›ç¨‹å’Œçˆ¶è¿›ç¨‹å…±äº«å†…å­˜é‡Œé¢çš„ä»£ç æ®µå’Œæ•°æ®æ®µï¼Œå¿«ç…§æŒä¹…åŒ–å®Œå…¨äº¤ç»™å­è¿›ç¨‹æ¥å¤„ç†ï¼Œçˆ¶è¿›ç¨‹ç»§ç»­å¤„ç†å®¢æˆ·ç«¯çš„è¯»å†™è¯·æ±‚ã€‚\n\n> å­è¿›ç¨‹å°†æ•°æ®å†™å…¥åˆ°ä¸€ä¸ªä¸´æ—¶ RDB æ–‡ä»¶ä¸­ã€‚å½“å­è¿›ç¨‹å®ŒæˆæŒä¹…åŒ–æ—¶ï¼ŒRedis ç”¨æ–° RDB æ–‡ä»¶æ›¿æ¢åŸæ¥çš„ RDB æ–‡ä»¶ï¼Œå¹¶åˆ é™¤æ—§çš„ RDB æ–‡ä»¶ã€‚\n\nåœ¨å­è¿›ç¨‹æŒä¹…åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœä¸»è¿›ç¨‹æ”¶åˆ°çš„å®¢æˆ·ç«¯çš„è¯»å†™è¯·æ±‚ï¼Œéœ€è¦ä¿®æ”¹æŸå—æ•°æ®ï¼Œé‚£ä¹ˆè¿™å—æ•°æ®å°±ä¼šè¢«å¤åˆ¶ä¸€ä»½åˆ°å†…å­˜ï¼Œç”Ÿæˆè¯¥æ•°æ®çš„å‰¯æœ¬ï¼Œä¸»è¿›ç¨‹åœ¨è¯¥å‰¯æœ¬ä¸Šè¿›è¡Œä¿®æ”¹æ“ä½œã€‚æ‰€ä»¥å³ä½¿å¯¹æŸä¸ªæ•°æ®è¿›è¡Œäº†ä¿®æ”¹ï¼ŒRedis æŒä¹…åŒ–åˆ° RDB ä¸­çš„æ•°æ®ä¹Ÿæ˜¯æœªä¿®æ”¹çš„æ•°æ®ï¼Œè¿™ä¹Ÿæ˜¯æŠŠ RDB æ–‡ä»¶ç§°ä¸º\"å¿«ç…§\"æ–‡ä»¶çš„åŸå› ï¼Œå­è¿›ç¨‹æ‰€çœ‹åˆ°çš„æ•°æ®åœ¨å®ƒè¢«åˆ›å»ºçš„ä¸€ç¬é—´å°±å›ºå®šä¸‹æ¥äº†ï¼Œçˆ¶è¿›ç¨‹ä¿®æ”¹çš„æŸä¸ªæ•°æ®åªæ˜¯è¯¥æ•°æ®çš„å¤åˆ¶å“ã€‚è¿™é‡Œå†æ·±å…¥ä¸€ç‚¹ï¼ŒRedis å†…å­˜ä¸­çš„å…¨é‡æ•°æ®ç”±ä¸€ä¸ªä¸ªçš„\"æ•°æ®æ®µé¡µé¢\"ç»„æˆï¼Œæ¯ä¸ªæ•°æ®æ®µé¡µé¢çš„å¤§å°ä¸º 4Kï¼Œå®¢æˆ·ç«¯è¦ä¿®æ”¹çš„æ•°æ®åœ¨å“ªä¸ªé¡µé¢ä¸­ï¼Œå°±ä¼šå¤åˆ¶ä¸€ä»½è¿™ä¸ªé¡µé¢åˆ°å†…å­˜ä¸­ï¼Œè¿™ä¸ªå¤åˆ¶çš„è¿‡ç¨‹ç§°ä¸º\"é¡µé¢åˆ†ç¦»\"ï¼Œåœ¨æŒä¹…åŒ–è¿‡ç¨‹ä¸­ï¼Œéšç€åˆ†ç¦»å‡ºçš„é¡µé¢è¶Šæ¥è¶Šå¤šï¼Œå†…å­˜å°±ä¼šæŒç»­å¢é•¿ï¼Œä½†æ˜¯ä¸ä¼šè¶…è¿‡åŸå†…å­˜çš„ 2 å€ï¼Œå› ä¸ºåœ¨ä¸€æ¬¡æŒä¹…åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œå‡ ä¹ä¸ä¼šå‡ºç°æ‰€æœ‰çš„é¡µé¢éƒ½ä¼šåˆ†ç¦»çš„æƒ…å†µï¼Œè¯»å†™è¯·æ±‚é’ˆå¯¹çš„åªæ˜¯åŸæ•°æ®ä¸­çš„å°éƒ¨åˆ†ï¼Œå¤§éƒ¨åˆ† Redis æ•°æ®è¿˜æ˜¯\"å†·æ•°æ®\"ã€‚\n\næ­£å› ä¸ºä¿®æ”¹çš„éƒ¨åˆ†æ•°æ®ä¼šè¢«é¢å¤–çš„å¤åˆ¶ä¸€ä»½ï¼Œæ‰€ä»¥ä¼šå ç”¨é¢å¤–çš„å†…å­˜ï¼Œå½“åœ¨è¿›è¡Œ RDB æŒä¹…åŒ–æ“ä½œçš„è¿‡ç¨‹ä¸­ï¼Œä¸æ­¤åŒæ—¶å¦‚æœæŒç»­å¾€ Redis ä¸­å†™å…¥çš„æ•°æ®é‡è¶Šå¤šï¼Œå°±ä¼šå¯¼è‡´å ç”¨çš„é¢å¤–å†…å­˜æ¶ˆè€—è¶Šå¤§ã€‚\n\n![RDB æŒä¹…åŒ–](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes2093494-20220226233822789-2067752089.png)\n\n**ä¼˜ç‚¹**ï¼š\n\n1. RDB çš„å†…å®¹ä¸ºäºŒè¿›åˆ¶çš„æ•°æ®ï¼Œå ç”¨å†…å­˜æ›´å°ï¼Œæ›´ç´§å‡‘ï¼Œæ›´é€‚åˆåšä¸ºå¤‡ä»½æ–‡ä»¶ï¼›\n2. RDB å¯¹ç¾éš¾æ¢å¤éå¸¸æœ‰ç”¨ï¼Œå®ƒæ˜¯ä¸€ä¸ªç´§å‡‘çš„æ–‡ä»¶ï¼Œå¯ä»¥æ›´å¿«çš„ä¼ è¾“åˆ°è¿œç¨‹æœåŠ¡å™¨è¿›è¡Œ Redis æœåŠ¡æ¢å¤ï¼›\n3. RDB å¯ä»¥æ›´å¤§ç¨‹åº¦çš„æé«˜ Redis çš„è¿è¡Œé€Ÿåº¦ï¼Œå› ä¸ºæ¯æ¬¡æŒä¹…åŒ–æ—¶ Redis ä¸»è¿›ç¨‹éƒ½ä¼š fork() ä¸€ä¸ªå­è¿›ç¨‹ï¼Œè¿›è¡Œæ•°æ®æŒä¹…åŒ–åˆ°ç£ç›˜ï¼ŒRedis ä¸»è¿›ç¨‹å¹¶ä¸ä¼šæ‰§è¡Œç£ç›˜ I/O ç­‰æ“ä½œï¼›\n4. ä¸ AOF æ ¼å¼çš„æ–‡ä»¶ç›¸æ¯”ï¼ŒRDB æ–‡ä»¶å¯ä»¥æ›´å¿«çš„é‡å¯ã€‚\n\n**ç¼ºç‚¹**ï¼š\n\n1. å› ä¸º RDB åªèƒ½ä¿å­˜æŸä¸ªæ—¶é—´é—´éš”çš„æ•°æ®ï¼Œå¦‚æœä¸­é€” Redis æœåŠ¡è¢«æ„å¤–ç»ˆæ­¢äº†ï¼Œåˆ™ä¼šä¸¢å¤±ä¸€æ®µæ—¶é—´å†…çš„ Redis æ•°æ®ã€‚\n2. RDB éœ€è¦ç»å¸¸ fork() æ‰èƒ½ä½¿ç”¨å­è¿›ç¨‹å°†å…¶æŒä¹…åŒ–åœ¨ç£ç›˜ä¸Šã€‚å¦‚æœæ•°æ®é›†å¾ˆå¤§ï¼Œfork() å¯èƒ½å¾ˆè€—æ—¶ï¼Œå¹¶ä¸”å¦‚æœæ•°æ®é›†å¾ˆå¤§ä¸” CPU æ€§èƒ½ä¸ä½³ï¼Œåˆ™å¯èƒ½å¯¼è‡´ Redis åœæ­¢ä¸ºå®¢æˆ·ç«¯æœåŠ¡å‡ æ¯«ç§’ç”šè‡³ä¸€ç§’é’Ÿã€‚\n\n### AOF(Append Only File)\n\nä»¥æ—¥å¿—çš„å½¢å¼æ¥è®°å½•æ¯ä¸ªå†™çš„æ“ä½œï¼Œå°† Redis æ‰§è¡Œè¿‡çš„æ‰€æœ‰æŒ‡ä»¤è®°å½•ä¸‹æ¥ï¼ˆè¯»æ“ä½œä¸è®°å½•ï¼‰ï¼Œåªè®¸è¿½åŠ æ–‡ä»¶ä½†ä¸å¯ä»¥æ”¹å†™æ–‡ä»¶ï¼ŒRedis å¯åŠ¨ä¹‹åˆä¼šè¯»å–è¯¥æ–‡ä»¶é‡æ–°æ„å»ºæ•°æ®ï¼Œæ¢è¨€ä¹‹ï¼ŒRedis é‡å¯çš„è¯å°±æ ¹æ®æ—¥å¿—æ–‡ä»¶çš„å†…å®¹å°†å†™æŒ‡ä»¤ä»å‰åˆ°åæ‰§è¡Œä¸€æ¬¡ä»¥å®Œæˆæ•°æ®çš„æ¢å¤å·¥ä½œã€‚\n\n#### **AOFé…ç½®é¡¹**\n\n```\n# é»˜è®¤ä¸å¼€å¯aof  è€Œæ˜¯ä½¿ç”¨rdbçš„æ–¹å¼\nappendonly no\n\n# é»˜è®¤æ–‡ä»¶å\nappendfilename \"appendonly.aof\"\n\n# æ¯æ¬¡ä¿®æ”¹éƒ½ä¼šsync æ¶ˆè€—æ€§èƒ½\n# appendfsync always\n# æ¯ç§’æ‰§è¡Œä¸€æ¬¡ sync å¯èƒ½ä¼šä¸¢å¤±è¿™ä¸€ç§’çš„æ•°æ®\nappendfsync everysec\n# ä¸æ‰§è¡Œ sync ï¼Œè¿™æ—¶å€™æ“ä½œç³»ç»Ÿè‡ªå·±åŒæ­¥æ•°æ®ï¼Œé€Ÿåº¦æœ€å¿«\n# appendfsync no \n```\n\nAOF çš„æ•´ä¸ªæµç¨‹å¤§ä½“æ¥çœ‹å¯ä»¥åˆ†ä¸ºä¸¤æ­¥ï¼Œç¬¬ä¸€æ­¥æ˜¯å‘½ä»¤çš„å®æ—¶å†™å…¥ï¼ˆå¦‚æœæ˜¯ appendfsync everysec é…ç½®ï¼Œä¼šæœ‰ 1s æŸè€—ï¼‰ï¼Œç¬¬äºŒæ­¥æ˜¯å¯¹ aof æ–‡ä»¶çš„é‡å†™ã€‚\n\n#### **AOF é‡å†™æœºåˆ¶**\n\néšç€ Redis çš„è¿è¡Œï¼ŒAOF çš„æ—¥å¿—ä¼šè¶Šæ¥è¶Šé•¿ï¼Œå¦‚æœå®ä¾‹å®•æœºé‡å¯ï¼Œé‚£ä¹ˆé‡æ”¾æ•´ä¸ª AOF å°†ä¼šå˜å¾—ååˆ†è€—æ—¶ï¼Œè€Œåœ¨æ—¥å¿—è®°å½•ä¸­ï¼Œåˆæœ‰å¾ˆå¤šæ— æ„ä¹‰çš„è®°å½•ï¼Œæ¯”å¦‚æˆ‘ç°åœ¨å°†ä¸€ä¸ªæ•°æ® incr ä¸€åƒæ¬¡ï¼Œé‚£ä¹ˆå°±ä¸éœ€è¦å»è®°å½•è¿™ 1000 æ¬¡ä¿®æ”¹ï¼Œåªéœ€è¦è®°å½•æœ€åçš„å€¼å³å¯ã€‚æ‰€ä»¥å°±éœ€è¦è¿›è¡Œ AOF é‡å†™ã€‚\n\nRedis æä¾›äº† bgrewriteaof æŒ‡ä»¤ç”¨äºå¯¹ AOF æ—¥å¿—è¿›è¡Œé‡å†™ï¼Œè¯¥æŒ‡ä»¤è¿è¡Œæ—¶ä¼šå¼€è¾Ÿä¸€ä¸ªå­è¿›ç¨‹å¯¹å†…å­˜è¿›è¡Œéå†ï¼Œç„¶åå°†å…¶è½¬æ¢ä¸ºä¸€ç³»åˆ—çš„ Redis çš„æ“ä½œæŒ‡ä»¤ï¼Œå†åºåˆ—åŒ–åˆ°ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ä¸­ã€‚å®Œæˆåå†æ›¿æ¢åŸæœ‰çš„ AOF æ–‡ä»¶ï¼Œè‡³æ­¤å®Œæˆã€‚\n\nåŒæ ·çš„ä¹Ÿå¯ä»¥åœ¨ Redis.config ä¸­å¯¹é‡å†™æœºåˆ¶çš„è§¦å‘è¿›è¡Œé…ç½®ï¼š\n\né€šè¿‡å°† no-appendfsync-on-rewrite è®¾ç½®ä¸º yesï¼Œå¼€å¯é‡å†™æœºåˆ¶ï¼›auto-aof-rewrite-percentage 100 æ„ä¸ºæ¯”ä¸Šæ¬¡ä»å†™åæ–‡ä»¶å¤§å°å¢é•¿äº† 100%å†æ¬¡è§¦å‘é‡å†™ï¼›\n\nauto-aof-rewrite-min-size 64mb æ„ä¸ºå½“æ–‡ä»¶è‡³å°‘è¦è¾¾åˆ° 64mb æ‰ä¼šè§¦å‘åˆ¶åŠ¨é‡å†™ã€‚\n\n**ä¼˜ç‚¹**ï¼š\n\n1ã€æ•°æ®å®‰å…¨ï¼ŒAOF æ˜¯å¯¹æŒ‡ä»¤æ–‡ä»¶è¿›è¡Œ **å¢é‡æ›´æ–°**ï¼Œæ›´é€‚åˆå®æ—¶æ€§æŒä¹…åŒ–ã€‚\n\n2ã€é€šè¿‡ append æ¨¡å¼å†™æ–‡ä»¶ï¼Œå³ä½¿ä¸­é€”æœåŠ¡å™¨å®•æœºï¼Œå¯ä»¥é€šè¿‡ Redis-check-aof å·¥å…·è§£å†³æ•°æ®ä¸€è‡´æ€§é—®é¢˜ã€‚\n\n3ã€AOF æœºåˆ¶çš„ rewrite æ¨¡å¼ã€‚AOF æ–‡ä»¶æ²¡è¢« rewrite ä¹‹å‰ï¼ˆæ–‡ä»¶è¿‡å¤§æ—¶ä¼šå¯¹å‘½ä»¤ è¿›è¡Œåˆå¹¶é‡å†™ï¼‰ï¼Œå¯ä»¥åˆ é™¤å…¶ä¸­çš„æŸäº›å‘½ä»¤ï¼ˆæ¯”å¦‚è¯¯æ“ä½œçš„ flushallï¼‰)\n\n**ç¼ºç‚¹**ï¼š\n\n1ã€AOF æ–‡ä»¶æ¯” RDB æ–‡ä»¶å¤§ï¼Œä¸”æ¢å¤é€Ÿåº¦æ…¢ã€‚\n\n2ã€æ•°æ®é›†å¤§çš„æ—¶å€™ï¼Œæ¯” RDB å¯åŠ¨æ•ˆç‡ä½ã€‚\n\n### RDBä¸AOFå¯¹æ¯”\n\nRedis å®˜æ–¹å»ºè®®åŒæ—¶å¼€å¯ä¸¤ç§æŒä¹…åŒ–ç­–ç•¥ï¼ŒAOF å’Œ RDB åŒæ—¶å¼€å¯ï¼Œç³»ç»Ÿé»˜è®¤å– AOF çš„æ•°æ®ï¼ˆæ•°æ®ä¸ä¼šå­˜åœ¨ä¸¢å¤±ï¼‰\n\n| æ¯”è¾ƒé¡¹     | RDB    | AOF          |\n| ---------- | ------ | ------------ |\n| å¯åŠ¨ä¼˜å…ˆçº§ | ä½     | é«˜           |\n| ä½“ç§¯       | å°     | å¤§           |\n| æ¢å¤é€Ÿåº¦   | å¿«     | æ…¢           |\n| æ•°æ®å®‰å…¨æ€§ | ä¸¢æ•°æ® | æ ¹æ®ç­–ç•¥å†³å®š |\n\n***\n\n## å‘å¸ƒä¸è®¢é˜…\n\nRedis å‘å¸ƒä¸è®¢é˜…æ˜¯ä¸€ç§æ¶ˆæ¯é€šä¿¡çš„æ¨¡å¼ï¼šå‘é€è€…ï¼ˆpubï¼‰å‘é€æ¶ˆæ¯ï¼Œè®¢é˜…è€…ï¼ˆsubï¼‰æ¥æ”¶æ¶ˆæ¯ã€‚\n\nRedis é€šè¿‡ PUBLISH å’Œ SUBSCRIBE ç­‰å‘½ä»¤å®ç°äº†è®¢é˜…ä¸å‘å¸ƒæ¨¡å¼ï¼Œè¿™ä¸ªåŠŸèƒ½æä¾›ä¸¤ç§ä¿¡æ¯æœºåˆ¶ï¼Œåˆ†åˆ«æ˜¯è®¢é˜…/å‘å¸ƒåˆ°é¢‘é“ã€è®¢é˜…/å‘å¸ƒåˆ°æ¨¡å¼çš„å®¢æˆ·ç«¯ã€‚\n\n### é¢‘é“ï¼ˆchannelï¼‰\n\n**è®¢é˜…**\n\n![é¢‘é“è®¢é˜…](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650436261125.png)\n\n**å‘å¸ƒ**\n\n![é¢‘é“å‘å¸ƒ](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650436267143.png)\n\n#### **å®Œæ•´æµç¨‹**\n\nå‘å¸ƒè€…å‘é¢‘é“ channel:1 å‘å¸ƒæ¶ˆæ¯ hi\n\n```\n127.0.0.1:6379> publish channel:1 hi(integer) 1\n```\n\nè®¢é˜…è€…è®¢é˜…æ¶ˆæ¯\n\n```\n127.0.0.1:6379> subscribe channel:1\nReading messages... (press Ctrl-C to quit)\n1) \"subscribe\" // æ¶ˆæ¯ç±»å‹\n2) \"channel:1\" // é¢‘é“\n3) \"hi\" // æ¶ˆæ¯å†…å®¹\n```\n\næ‰§è¡Œ subscribe åå®¢æˆ·ç«¯ä¼šè¿›å…¥è®¢é˜…çŠ¶æ€ï¼Œä»…å¯ä»¥ä½¿ subscribeã€unsubscribeã€psubscribe å’Œ punsubscribe è¿™å››ä¸ªå±äº\"å‘å¸ƒ/è®¢é˜…\"ä¹‹å¤–çš„å‘½ä»¤\n\nè®¢é˜…é¢‘é“åçš„å®¢æˆ·ç«¯å¯èƒ½ä¼šæ”¶åˆ°ä¸‰ç§æ¶ˆæ¯ç±»å‹\n\n- subscribeï¼šè¡¨ç¤ºè®¢é˜…æˆåŠŸçš„åé¦ˆä¿¡æ¯ã€‚ç¬¬äºŒä¸ªå€¼æ˜¯è®¢é˜…æˆåŠŸçš„é¢‘é“åç§°ï¼Œç¬¬ä¸‰ä¸ªæ˜¯å½“å‰å®¢æˆ·ç«¯è®¢é˜…çš„é¢‘é“æ•°é‡ã€‚\n\n- messageï¼šè¡¨ç¤ºæ¥æ”¶åˆ°çš„æ¶ˆæ¯ï¼Œç¬¬äºŒä¸ªå€¼è¡¨ç¤ºäº§ç”Ÿæ¶ˆæ¯çš„é¢‘é“åç§°ï¼Œç¬¬ä¸‰ä¸ªå€¼æ˜¯æ¶ˆæ¯çš„å†…å®¹ã€‚\n\n- unsubscribeï¼šè¡¨ç¤ºæˆåŠŸå–æ¶ˆè®¢é˜…æŸä¸ªé¢‘é“ã€‚ç¬¬äºŒä¸ªå€¼æ˜¯å¯¹åº”çš„é¢‘é“åç§°ï¼Œç¬¬ä¸‰ä¸ªå€¼æ˜¯å½“å‰å®¢æˆ·ç«¯è®¢é˜…çš„é¢‘é“æ•°é‡ï¼Œå½“æ­¤å€¼ä¸º 0 æ—¶å®¢æˆ·ç«¯ä¼šé€€å‡ºè®¢é˜…çŠ¶æ€ï¼Œä¹‹åå°±å¯ä»¥æ‰§è¡Œå…¶ä»–é\"å‘å¸ƒ/è®¢é˜…\"æ¨¡å¼çš„å‘½ä»¤äº†ã€‚\n\n\n\n#### **æ•°æ®ç»“æ„**\n\nåŸºäº channel çš„å‘å¸ƒè®¢é˜…æ¨¡å¼æ˜¯é€šè¿‡å­—å…¸æ•°æ®ç±»å‹å®ç°çš„\n\n> ç±»ä¼¼hashmapï¼Œé”®ä¸ºchannelï¼Œå€¼ä¸ºè®¢é˜…äº†è¯¥channelçš„clientï¼Œç”¨é“¾è¡¨é“¾æ¥èµ·æ¥\n\nå…¶ä¸­ï¼Œå­—å…¸çš„é”®ä¸ºæ­£åœ¨è¢«è®¢é˜…çš„é¢‘é“ï¼Œ è€Œå­—å…¸çš„å€¼åˆ™æ˜¯ä¸€ä¸ªé“¾è¡¨ï¼Œ é“¾è¡¨ä¸­ä¿å­˜äº†æ‰€æœ‰è®¢é˜…è¿™ä¸ªé¢‘é“çš„å®¢æˆ·ç«¯ã€‚\n\n![é¢‘é“æ¨¡å¼æ•°æ®ç»“æ„æ¨¡å‹](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650420774862.png)\n\n**è®¢é˜…**\n\nå½“ä½¿ç”¨ subscribe è®¢é˜…æ—¶ï¼Œåœ¨å­—å…¸ä¸­æ‰¾åˆ°é¢‘é“ keyï¼ˆå¦‚æ²¡æœ‰åˆ™åˆ›å»ºï¼‰ï¼Œå¹¶å°†è®¢é˜…çš„ client å…³è”åœ¨é“¾è¡¨åé¢ã€‚\n\nå½“ client 10 æ‰§è¡Œ `subscribe channel1 channel2 channel3` æ—¶ï¼Œä¼šå°† client 10 åˆ†åˆ«åŠ åˆ° channel1 channel2 channel3 å…³è”çš„é“¾è¡¨å°¾éƒ¨ã€‚\n\n![é¢‘é“è®¢é˜…](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650420784179.png)\n\n**å‘å¸ƒ**\n\nå‘å¸ƒæ—¶ï¼Œæ ¹æ® keyï¼Œæ‰¾åˆ°å­—å…¸æ±‡æ€» key çš„åœ°å€ï¼Œç„¶åå°† msg å‘é€åˆ°å…³è”çš„é“¾è¡¨æ¯ä¸€å°æœºå™¨ã€‚\n\n**é€€è®¢**\n\néå†å…³è”çš„é“¾è¡¨ï¼Œå°†æŒ‡å®šçš„åœ°å€åˆ é™¤å³å¯ã€‚\n\n\n\n### æ¨¡å¼ï¼ˆpatternï¼‰\n\npattern ä½¿ç”¨äº†é€šé…ç¬¦çš„æ–¹å¼æ¥è®¢é˜…\n\né€šé…ç¬¦ä¸­ ? è¡¨ç¤º 1 ä¸ªå ä½ç¬¦ï¼Œ\\* è¡¨ç¤ºä»»æ„ä¸ªå ä½ç¬¦(åŒ…æ‹¬ 0)ï¼Œ?* è¡¨ç¤º 1 ä¸ªä»¥ä¸Šå ä½ç¬¦ã€‚\n\næ‰€ä»¥å½“ä½¿ç”¨ publish å‘½ä»¤å‘é€ä¿¡æ¯åˆ°æŸä¸ªé¢‘é“æ—¶ï¼Œ ä¸ä»…æ‰€æœ‰è®¢é˜…è¯¥é¢‘é“çš„å®¢æˆ·ç«¯ä¼šæ”¶åˆ°ä¿¡æ¯ï¼Œ å¦‚æœæœ‰æŸä¸ª/æŸäº›æ¨¡å¼å’Œè¿™ä¸ªé¢‘é“åŒ¹é…çš„è¯ï¼Œ é‚£ä¹ˆæ‰€æœ‰è®¢é˜…è¿™ä¸ª/è¿™äº›é¢‘é“çš„å®¢æˆ·ç«¯ä¹ŸåŒæ ·ä¼šæ”¶åˆ°ä¿¡æ¯ã€‚\n\n![æ¨¡å¼](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650420803487.png)\n\n#### **è®¢é˜…å‘å¸ƒå®Œæ•´æµç¨‹**\n\nå‘å¸ƒè€…å‘å¸ƒæ¶ˆæ¯\n\n```\n127.0.0.1:6379> publish b m1\n(integer) 1\n127.0.0.1:6379> publish b1 m1\n(integer) 1\n127.0.0.1:6379> publish b11 m1\n(integer) 1\n```\n\nè®¢é˜…è€…è®¢é˜…æ¶ˆæ¯\n\n```\n127.0.0.1:6379> psubscribe b*\nReading messages... (press Ctrl-C to quit)\n1) \"psubscribe\"\n2) \"b*\"\n3) (integer) 3\n1) \"pmessage\"\n2) \"b*\"\n3) \"b\"\n4) \"m1\"\n1) \"pmessage\"\n2) \"b*\"\n3) \"b1\"\n4) \"m1\"\n1) \"pmessage\"\n2) \"b*\"\n3) \"b11\"\n4) \"m1\"\n```\n\n#### **æ•°æ®ç»“æ„**\n\npattern å±æ€§æ˜¯ä¸€ä¸ªé“¾è¡¨ï¼Œé“¾è¡¨ä¸­ä¿å­˜ç€æ‰€æœ‰å’Œæ¨¡å¼ç›¸å…³çš„ä¿¡æ¯ã€‚\n\n> ç±»ä¼¼é“¾è¡¨ï¼Œæ¯ä¸ªpatternèŠ‚ç‚¹ï¼ŒåŒ…å«patternä»¥åŠè®¢é˜…è¯¥patternçš„client\n\næ•°æ®ç»“æ„å›¾å¦‚ä¸‹ï¼š\n\n![æ¨¡å¼æ•°æ®ç»“æ„](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650420905733.png)\n\n**è®¢é˜…**\n\nå½“æœ‰ä¿¡çš„è®¢é˜…æ—¶ï¼Œä¼šå°†è®¢é˜…çš„å®¢æˆ·ç«¯å’Œæ¨¡å¼ä¿¡æ¯æ·»åŠ åˆ°é“¾è¡¨åé¢ã€‚\n\n![æ¨¡å¼è®¢é˜…](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650420913717.png)\n\n**å‘å¸ƒ**\n\nå½“å‘å¸ƒè€…å‘å¸ƒæ¶ˆæ¯æ—¶ï¼Œé¦–å…ˆä¼šå‘é€åˆ°å¯¹åº”çš„é¢‘é“ä¸Šï¼Œåœ¨éå†æ¨¡å¼åˆ—è¡¨ï¼Œæ ¹æ® key åŒ¹é…æ¨¡å¼ï¼ŒåŒ¹é…æˆåŠŸå°†æ¶ˆæ¯å‘ç»™å¯¹åº”çš„è®¢é˜…è€…ã€‚\n\n**é€€è®¢**\n\nä½¿ç”¨ punsubscribeï¼Œå¯ä»¥å°†è®¢é˜…è€…é€€è®¢ï¼Œå°†æ”¹å®¢æˆ·ç«¯ç§»é™¤å‡ºé“¾è¡¨ã€‚\n\n***\n\n## ä¸»ä»å¤åˆ¶\n\n**ä»€ä¹ˆæ˜¯ä¸»ä»å¤åˆ¶**\n\nåœ¨å¤šä¸ª Redis å®ä¾‹å»ºç«‹èµ·ä¸»ä»å…³ç³»ï¼Œå½“ ä¸» Redis ä¸­çš„æ•°æ®å‘ç”Ÿå˜åŒ–ï¼Œä» Redis ä¸­çš„æ•°æ®ä¹Ÿä¼šåŒæ­¥å˜åŒ–\n\n- é€šè¿‡ä¸»ä»é…ç½®å¯ä»¥å®ç° Redis æ•°æ®çš„å¤‡ä»½ï¼ˆä» Redis å°±æ˜¯å¯¹ ä¸» Redis çš„å¤‡ä»½ï¼‰ï¼Œä¿è¯æ•°æ®å®‰å…¨æ€§\n- ä¸»ä»åº“ä¹‹é—´é‡‡ç”¨çš„æ˜¯è¯»å†™åˆ†ç¦»çš„æ–¹å¼ï¼Œè¯»æ“ä½œï¼šä¸»åº“ã€ä»åº“éƒ½å¯ä»¥æ¥æ”¶ï¼›å†™æ“ä½œï¼šé¦–å…ˆåˆ°ä¸»åº“æ‰§è¡Œï¼Œç„¶åä¸»åº“å°†å†™æ“ä½œåŒæ­¥ç»™ä»åº“\n\n**ä¸»ä»å¤åˆ¶çš„ä½œç”¨**\n\n- æ•°æ®å†—ä½™ï¼šä¸»ä»å¤åˆ¶å®ç°äº†æ•°æ®çš„çƒ­å¤‡ä»½ï¼Œæ˜¯æŒä¹…åŒ–ä¹‹å¤–çš„ä¸€ç§æ•°æ®å†—ä½™æ–¹å¼ã€‚\n\n- æ•…éšœæ¢å¤ï¼šå½“ä¸»èŠ‚ç‚¹å‡ºç°é—®é¢˜æ—¶ï¼Œå¯ä»¥ç”±ä»èŠ‚ç‚¹æä¾›æœåŠ¡ï¼Œå®ç°å¿«é€Ÿçš„æ•…éšœæ¢å¤ï¼›å®é™…ä¸Šæ˜¯ä¸€ç§æœåŠ¡çš„å†—ä½™ã€‚\n\n- è´Ÿè½½å‡è¡¡ï¼šåœ¨ä¸»ä»å¤åˆ¶çš„åŸºç¡€ä¸Šï¼Œé…åˆè¯»å†™åˆ†ç¦»ï¼Œå¯ä»¥ç”±ä¸»èŠ‚ç‚¹æä¾›å†™æœåŠ¡ï¼Œç”±ä»èŠ‚ç‚¹æä¾›è¯»æœåŠ¡ï¼ˆå³å†™ Redis æ•°æ®æ—¶åº”ç”¨è¿æ¥ä¸»èŠ‚ç‚¹ï¼Œè¯» Redis æ•°æ®æ—¶åº”ç”¨è¿æ¥ä»èŠ‚ç‚¹ï¼‰ï¼Œåˆ†æ‹…æœåŠ¡å™¨è´Ÿè½½ï¼›å°¤å…¶æ˜¯åœ¨å†™å°‘è¯»å¤šçš„åœºæ™¯ä¸‹ï¼Œé€šè¿‡å¤šä¸ªä»èŠ‚ç‚¹åˆ†æ‹…è¯»è´Ÿè½½ï¼Œå¯ä»¥å¤§å¤§æé«˜ Redis æœåŠ¡å™¨çš„å¹¶å‘é‡ã€‚\n\n- é«˜å¯ç”¨åŸºçŸ³ï¼šé™¤äº†ä¸Šè¿°ä½œç”¨ä»¥å¤–ï¼Œä¸»ä»å¤åˆ¶è¿˜æ˜¯å“¨å…µå’Œé›†ç¾¤èƒ½å¤Ÿå®æ–½çš„åŸºç¡€ï¼Œå› æ­¤è¯´ä¸»ä»å¤åˆ¶æ˜¯ Redis é«˜å¯ç”¨çš„åŸºç¡€ã€‚\n\nä¸»ä»åº“é‡‡ç”¨çš„æ˜¯è¯»å†™åˆ†ç¦»çš„æ–¹å¼ï¼š\n\n![ä¸»ä»åº“è¯»å†™åˆ†ç¦»](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650420963646.png) \n\n### åŸç†\n\nåˆ†ä¸ºå…¨é‡å¤åˆ¶ä¸å¢é‡å¤åˆ¶\n\nå…¨é‡å¤åˆ¶ï¼šå‘ç”Ÿåœ¨ç¬¬ä¸€æ¬¡å¤åˆ¶æ—¶\n\nå¢é‡å¤åˆ¶ï¼šåªä¼šæŠŠä¸»ä»åº“ç½‘ç»œæ–­è¿æœŸé—´ä¸»åº“æ”¶åˆ°çš„å‘½ä»¤ï¼ŒåŒæ­¥ç»™ä»åº“\n\n### å…¨é‡å¤åˆ¶çš„ä¸‰ä¸ªé˜¶æ®µ\n\n![å…¨é‡å¤åˆ¶](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNoteskjk7gr48ft.jpeg)\n\nç¬¬ä¸€é˜¶æ®µæ˜¯ä¸»ä»åº“é—´å»ºç«‹è¿æ¥ã€åå•†åŒæ­¥çš„è¿‡ç¨‹ã€‚\n\n> ä¸»è¦æ˜¯ä¸ºå…¨é‡å¤åˆ¶åšå‡†å¤‡ã€‚ä»åº“å’Œä¸»åº“å»ºç«‹èµ·è¿æ¥ï¼Œå¹¶å‘Šè¯‰ä¸»åº“å³å°†è¿›è¡ŒåŒæ­¥ï¼Œä¸»åº“ç¡®è®¤å›å¤åï¼Œä¸»ä»åº“é—´å°±å¯ä»¥å¼€å§‹åŒæ­¥äº†ã€‚\n>\n> å…·ä½“æ¥è¯´ï¼Œä»åº“ç»™ä¸»åº“å‘é€ psync å‘½ä»¤ï¼Œè¡¨ç¤ºè¦è¿›è¡Œæ•°æ®åŒæ­¥ï¼Œä¸»åº“æ ¹æ®è¿™ä¸ªå‘½ä»¤çš„å‚æ•°æ¥å¯åŠ¨å¤åˆ¶ã€‚psync å‘½ä»¤åŒ…å«äº†ä¸»åº“çš„ runID å’Œå¤åˆ¶è¿›åº¦ offset ä¸¤ä¸ªå‚æ•°ã€‚runIDï¼Œæ˜¯æ¯ä¸ª Redis å®ä¾‹å¯åŠ¨æ—¶éƒ½ä¼šè‡ªåŠ¨ç”Ÿæˆçš„ä¸€ä¸ªéšæœº IDï¼Œç”¨æ¥å”¯ä¸€æ ‡è®°è¿™ä¸ªå®ä¾‹ã€‚å½“ä»åº“å’Œä¸»åº“ç¬¬ä¸€æ¬¡å¤åˆ¶æ—¶ï¼Œå› ä¸ºä¸çŸ¥é“ä¸»åº“çš„ runIDï¼Œæ‰€ä»¥å°† runID è®¾ä¸ºâ€œï¼Ÿâ€ã€‚offsetï¼Œæ­¤æ—¶è®¾ä¸º -1ï¼Œè¡¨ç¤ºç¬¬ä¸€æ¬¡å¤åˆ¶ã€‚ä¸»åº“æ”¶åˆ° psync å‘½ä»¤åï¼Œä¼šç”¨ FULLRESYNC å“åº”å‘½ä»¤å¸¦ä¸Šä¸¤ä¸ªå‚æ•°ï¼šä¸»åº“ runID å’Œä¸»åº“ç›®å‰çš„å¤åˆ¶è¿›åº¦ offsetï¼Œè¿”å›ç»™ä»åº“ã€‚ä»åº“æ”¶åˆ°å“åº”åï¼Œä¼šè®°å½•ä¸‹è¿™ä¸¤ä¸ªå‚æ•°ã€‚è¿™é‡Œæœ‰ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ï¼ŒFULLRESYNC å“åº”è¡¨ç¤ºç¬¬ä¸€æ¬¡å¤åˆ¶é‡‡ç”¨çš„å…¨é‡å¤åˆ¶ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸»åº“ä¼šæŠŠå½“å‰æ‰€æœ‰çš„æ•°æ®éƒ½å¤åˆ¶ç»™ä»åº“ã€‚\n\nç¬¬äºŒé˜¶æ®µï¼Œä¸»åº“å°†æ‰€æœ‰æ•°æ®åŒæ­¥ç»™ä»åº“ã€‚ä»åº“æ”¶åˆ°æ•°æ®åï¼Œåœ¨æœ¬åœ°å®Œæˆæ•°æ®åŠ è½½ã€‚è¿™ä¸ªè¿‡ç¨‹ä¾èµ–äºå†…å­˜å¿«ç…§ç”Ÿæˆçš„ RDB æ–‡ä»¶ã€‚\n\n> å…·ä½“æ¥è¯´ï¼Œä¸»åº“æ‰§è¡Œ bgsave å‘½ä»¤ï¼Œç”Ÿæˆ RDB æ–‡ä»¶ï¼Œæ¥ç€å°†æ–‡ä»¶å‘ç»™ä»åº“ã€‚ä»åº“æ¥æ”¶åˆ° RDB æ–‡ä»¶åï¼Œä¼šå…ˆæ¸…ç©ºå½“å‰æ•°æ®åº“ï¼Œç„¶ååŠ è½½ RDB æ–‡ä»¶ã€‚è¿™æ˜¯å› ä¸ºä»åº“åœ¨é€šè¿‡ replicaof å‘½ä»¤å¼€å§‹å’Œä¸»åº“åŒæ­¥å‰ï¼Œå¯èƒ½ä¿å­˜äº†å…¶ä»–æ•°æ®ã€‚ä¸ºäº†é¿å…ä¹‹å‰æ•°æ®çš„å½±å“ï¼Œä»åº“éœ€è¦å…ˆæŠŠå½“å‰æ•°æ®åº“æ¸…ç©ºã€‚åœ¨ä¸»åº“å°†æ•°æ®åŒæ­¥ç»™ä»åº“çš„è¿‡ç¨‹ä¸­ï¼Œä¸»åº“ä¸ä¼šè¢«é˜»å¡ï¼Œä»ç„¶å¯ä»¥æ­£å¸¸æ¥æ”¶è¯·æ±‚ã€‚å¦åˆ™ï¼ŒRedis çš„æœåŠ¡å°±è¢«ä¸­æ–­äº†ã€‚ä½†æ˜¯ï¼Œè¿™äº›è¯·æ±‚ä¸­çš„å†™æ“ä½œå¹¶æ²¡æœ‰è®°å½•åˆ°åˆšåˆšç”Ÿæˆçš„ RDB æ–‡ä»¶ä¸­ã€‚ä¸ºäº†ä¿è¯ä¸»ä»åº“çš„æ•°æ®ä¸€è‡´æ€§ï¼Œä¸»åº“ä¼šåœ¨å†…å­˜ä¸­ç”¨ä¸“é—¨çš„ replication bufferï¼Œè®°å½• RDB æ–‡ä»¶ç”Ÿæˆåæ”¶åˆ°çš„æ‰€æœ‰å†™æ“ä½œã€‚\n\nç¬¬ä¸‰ä¸ªé˜¶æ®µï¼Œä¸»åº“ä¼šæŠŠç¬¬äºŒé˜¶æ®µæ‰§è¡Œè¿‡ç¨‹ä¸­æ–°æ”¶åˆ°çš„å†™å‘½ä»¤ï¼Œå†å‘é€ç»™ä»åº“ã€‚\n\n> å…·ä½“çš„æ“ä½œæ˜¯ï¼Œå½“ä¸»åº“å®Œæˆ RDB æ–‡ä»¶å‘é€åï¼Œå°±ä¼šæŠŠæ­¤æ—¶ replication buffer ä¸­çš„ä¿®æ”¹æ“ä½œå‘ç»™ä»åº“ï¼Œä»åº“å†é‡æ–°æ‰§è¡Œè¿™äº›æ“ä½œã€‚è¿™æ ·ä¸€æ¥ï¼Œä¸»ä»åº“å°±å®ç°åŒæ­¥äº†ã€‚\n\n### æ–­ç½‘å¢é‡æ›´æ–°\n\nå½“ä¸»ä»åº“æ–­è¿åï¼Œä¸»åº“ä¼šæŠŠæ–­è¿æœŸé—´æ”¶åˆ°çš„å†™æ“ä½œå‘½ä»¤ï¼Œå†™å…¥ replication bufferï¼ŒåŒæ—¶ä¹Ÿä¼šæŠŠè¿™äº›æ“ä½œå‘½ä»¤ä¹Ÿå†™å…¥ repl_backlog_buffer è¿™ä¸ªç¼“å†²åŒºã€‚\n\n![æ–­ç½‘å¢é‡æ›´æ–°](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesg0eezljwqy.jpeg)\n\n## å“¨å…µæœºåˆ¶\n\n> å“¨å…µçš„æ ¸å¿ƒåŠŸèƒ½æ˜¯ä¸»èŠ‚ç‚¹çš„è‡ªåŠ¨æ•…éšœè½¬ç§»\n>\n> 1. ç›‘æ§ ä¸»åº“ï¼Œåˆ¤æ–­ ä¸»åº“ æ˜¯å¦å®•æœº\n> 2. ä¸»åº“ å¦‚æœå®•æœºï¼Œåˆ™ä» ä»åº“ ä¸­ é€‰ä¸¾æˆä¸º ä¸»åº“ï¼ˆå› æ­¤éœ€è¦å¥‡æ•°ä¸ªå“¨å…µï¼‰\n> 3. æ›´æ”¹ä¸»ä»é…ç½®\n\nä¸‹å›¾æ˜¯ä¸€ä¸ªå…¸å‹çš„å“¨å…µé›†ç¾¤ç›‘æ§çš„é€»è¾‘å›¾ï¼š\n\n![å“¨å…µæœºåˆ¶](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650420977306.png)\n\n![å›¾ç‰‡](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)\n\n \n\nRedis Sentinel åŒ…å«äº†è‹¥ä¸ª Sentinel èŠ‚ç‚¹ï¼Œè¿™æ ·åšä¹Ÿå¸¦æ¥äº†ä¸¤ä¸ªå¥½å¤„ï¼š\n\n1. å¯¹äºèŠ‚ç‚¹çš„æ•…éšœåˆ¤æ–­æ˜¯ç”±å¤šä¸ª Sentinel èŠ‚ç‚¹å…±åŒå®Œæˆï¼Œè¿™æ ·å¯ä»¥æœ‰æ•ˆåœ°é˜²æ­¢è¯¯åˆ¤\n2. å³ä½¿ä¸ªåˆ« Sentinel èŠ‚ç‚¹ä¸å¯ç”¨ï¼Œæ•´ä¸ª Sentinel é›†ç¾¤ä¾ç„¶æ˜¯å¯ç”¨çš„ã€‚\n\nå“¨å…µå®ç°äº†ä»¥ä¸‹åŠŸèƒ½\n\n1. ç›‘æ§ï¼šæ¯ä¸ª Sentinel èŠ‚ç‚¹ä¼šå¯¹æ•°æ®èŠ‚ç‚¹ï¼ˆRedis master/slave èŠ‚ç‚¹ï¼‰å’Œå…¶ä½™ Sentinel èŠ‚ç‚¹è¿›è¡Œç›‘æ§\n2. é€šçŸ¥ï¼šSentinel èŠ‚ç‚¹ä¼šå°†æ•…éšœè½¬ç§»çš„ç»“æœé€šçŸ¥ç»™åº”ç”¨æ–¹\n3. æ•…éšœè½¬ç§»ï¼šå®ç° slave æ™‹å‡ä¸º masterï¼Œå¹¶ç»´æŠ¤åç»­æ­£ç¡®çš„ä¸»ä»å…³ç³»\n4. é…ç½®ä¸­å¿ƒï¼šåœ¨ Redis Sentinel æ¨¡å¼ä¸­ï¼Œå®¢æˆ·ç«¯åœ¨åˆå§‹åŒ–çš„æ—¶å€™è¿æ¥çš„æ˜¯ Sentinel èŠ‚ç‚¹é›†åˆï¼Œä»ä¸­è·å–ä¸»èŠ‚ç‚¹ä¿¡æ¯\n\nå…¶ä¸­ï¼Œç›‘æ§å’Œè‡ªåŠ¨æ•…éšœè½¬ç§»åŠŸèƒ½ï¼Œä½¿å¾—å“¨å…µå¯ä»¥åŠæ—¶å‘ç°ä¸»èŠ‚ç‚¹æ•…éšœå¹¶å®Œæˆè½¬ç§»ï¼›è€Œé…ç½®ä¸­å¿ƒå’Œé€šçŸ¥åŠŸèƒ½ï¼Œåˆ™éœ€è¦åœ¨ä¸å®¢æˆ·ç«¯çš„äº¤äº’ä¸­æ‰èƒ½ä½“ç°ã€‚\n\n### ç›‘æ§\n\nSentinel èŠ‚ç‚¹éœ€è¦ç›‘æ§ masterã€slave ä»¥åŠå…¶å®ƒ Sentinel èŠ‚ç‚¹çš„çŠ¶æ€ã€‚è¿™ä¸€è¿‡ç¨‹æ˜¯é€šè¿‡ Redis çš„ pub/sub ç³»ç»Ÿå®ç°çš„ã€‚Redis Sentinel ä¸€å…±æœ‰ä¸‰ä¸ªå®šæ—¶ç›‘æ§ä»»åŠ¡ï¼Œå®Œæˆå¯¹å„ä¸ªèŠ‚ç‚¹å‘ç°å’Œç›‘æ§ï¼š\n\n1. ç›‘æ§ä¸»ä»æ‹“æ‰‘ä¿¡æ¯ï¼šæ¯éš” 10 ç§’ï¼Œæ¯ä¸ª Sentinel èŠ‚ç‚¹ï¼Œä¼šå‘ master å’Œ slave å‘é€ INFO å‘½ä»¤è·å–æœ€æ–°çš„æ‹“æ‰‘ç»“æ„\n2. Sentinel èŠ‚ç‚¹ä¿¡æ¯äº¤æ¢ï¼šæ¯éš” 2 ç§’ï¼Œæ¯ä¸ª Sentinel èŠ‚ç‚¹ï¼Œä¼šå‘ Redis æ•°æ®èŠ‚ç‚¹çš„`sentinel:hello` é¢‘é“ä¸Šï¼Œå‘é€è‡ªèº«çš„ä¿¡æ¯ï¼Œä»¥åŠå¯¹ä¸»èŠ‚ç‚¹çš„åˆ¤æ–­ä¿¡æ¯ã€‚è¿™æ ·ï¼ŒSentinel èŠ‚ç‚¹ä¹‹é—´å°±å¯ä»¥äº¤æ¢ä¿¡æ¯\n3. èŠ‚ç‚¹çŠ¶æ€ç›‘æ§ï¼šæ¯éš” 1 ç§’ï¼Œæ¯ä¸ª Sentinel èŠ‚ç‚¹ï¼Œä¼šå‘ masterã€slaveã€å…¶ä½™ Sentinel èŠ‚ç‚¹å‘é€ PING å‘½ä»¤åšå¿ƒè·³æ£€æµ‹ï¼Œæ¥ç¡®è®¤è¿™äº›èŠ‚ç‚¹å½“å‰æ˜¯å¦å¯è¾¾\n\n### ä¸»è§‚/å®¢è§‚ä¸‹çº¿\n\n#### ä¸»è§‚ä¸‹çº¿\n\næ¯ä¸ª Sentinel èŠ‚ç‚¹ï¼Œæ¯éš” 1 ç§’ä¼šå¯¹æ•°æ®èŠ‚ç‚¹å‘é€ ping å‘½ä»¤åšå¿ƒè·³æ£€æµ‹ï¼Œå½“è¿™äº›èŠ‚ç‚¹è¶…è¿‡ down-after-milliseconds æ²¡æœ‰è¿›è¡Œæœ‰æ•ˆå›å¤æ—¶ï¼ŒSentinel èŠ‚ç‚¹ä¼šå¯¹è¯¥èŠ‚ç‚¹åšå¤±è´¥åˆ¤å®šï¼Œè¿™ä¸ªè¡Œä¸ºå«åšä¸»è§‚ä¸‹çº¿ã€‚\n\n#### å®¢è§‚ä¸‹çº¿\n\nå®¢è§‚ä¸‹çº¿ï¼Œæ˜¯æŒ‡å½“å¤§å¤šæ•° Sentinel èŠ‚ç‚¹ï¼Œéƒ½è®¤ä¸º master èŠ‚ç‚¹å®•æœºäº†ï¼Œé‚£ä¹ˆè¿™ä¸ªåˆ¤å®šå°±æ˜¯å®¢è§‚çš„ï¼Œå«åšå®¢è§‚ä¸‹çº¿ã€‚\n\né‚£ä¹ˆè¿™ä¸ªå¤§å¤šæ•°æ˜¯æŒ‡å¤šå°‘å‘¢ï¼Ÿè¿™å…¶å®å°±æ˜¯åˆ†å¸ƒå¼åè°ƒä¸­çš„ quorum åˆ¤å®šäº†ï¼Œå¤§å¤šæ•°å°±æ˜¯è¿‡åŠæ•°ï¼Œæ¯”å¦‚å“¨å…µæ•°é‡æ˜¯ 5ï¼Œé‚£ä¹ˆå¤§å¤šæ•°å°±æ˜¯ 5/2+1=3 ä¸ªï¼Œå“¨å…µæ•°é‡æ˜¯ 10 å¤§å¤šæ•°å°±æ˜¯ 10/2+1=6 ä¸ªã€‚\n\næ³¨ï¼šSentinel èŠ‚ç‚¹çš„æ•°é‡è‡³å°‘ä¸º 3 ä¸ªï¼Œå¦åˆ™ä¸æ»¡è¶³ quorum åˆ¤å®šæ¡ä»¶ã€‚\n\n### å“¨å…µé€‰ä¸¾\n\nå¦‚æœå‘ç”Ÿäº†å®¢è§‚ä¸‹çº¿ï¼Œé‚£ä¹ˆå“¨å…µèŠ‚ç‚¹ä¼šé€‰ä¸¾å‡ºä¸€ä¸ª Leader æ¥è¿›è¡Œå®é™…çš„æ•…éšœè½¬ç§»å·¥ä½œã€‚Redis ä½¿ç”¨äº† Raft ç®—æ³•æ¥å®ç°å“¨å…µé¢†å¯¼è€…é€‰ä¸¾ï¼Œå¤§è‡´æ€è·¯å¦‚ä¸‹ï¼š\n\n1. æ¯ä¸ª Sentinel èŠ‚ç‚¹éƒ½æœ‰èµ„æ ¼æˆä¸ºé¢†å¯¼è€…ï¼Œå½“å®ƒä¸»è§‚è®¤ä¸ºæŸä¸ªæ•°æ®èŠ‚ç‚¹å®•æœºåï¼Œä¼šå‘å…¶ä»– Sentinel èŠ‚ç‚¹å‘é€ sentinel is-master-down-by-addr å‘½ä»¤ï¼Œè¦æ±‚è‡ªå·±æˆä¸ºé¢†å¯¼è€…ï¼›\n2. æ”¶åˆ°å‘½ä»¤çš„ Sentinel èŠ‚ç‚¹ï¼Œå¦‚æœæ²¡æœ‰åŒæ„è¿‡å…¶ä»– Sentinel èŠ‚ç‚¹çš„ sentinelis-master-down-by-addr å‘½ä»¤ï¼Œå°†åŒæ„è¯¥è¯·æ±‚ï¼Œå¦åˆ™æ‹’ç»ï¼ˆæ¯ä¸ª Sentinel èŠ‚ç‚¹åªæœ‰ 1 ç¥¨ï¼‰ï¼›\n3. å¦‚æœè¯¥ Sentinel èŠ‚ç‚¹å‘ç°è‡ªå·±çš„ç¥¨æ•°å·²ç»å¤§äºç­‰äº MAX(quorum, num(sentinels)/2+1)ï¼Œé‚£ä¹ˆå®ƒå°†æˆä¸ºé¢†å¯¼è€…ï¼›\n4. å¦‚æœæ­¤è¿‡ç¨‹æ²¡æœ‰é€‰ä¸¾å‡ºé¢†å¯¼è€…ï¼Œå°†è¿›å…¥ä¸‹ä¸€æ¬¡é€‰ä¸¾ã€‚\n\n### **æ•…éšœè½¬ç§»**\n\né€‰ä¸¾å‡ºçš„ Leader Sentinel èŠ‚ç‚¹å°†è´Ÿè´£æ•…éšœè½¬ç§»ï¼Œä¹Ÿå°±æ˜¯è¿›è¡Œ master/slave èŠ‚ç‚¹çš„ä¸»ä»åˆ‡æ¢ã€‚æ•…éšœè½¬ç§»ï¼Œé¦–å…ˆè¦ä» slave èŠ‚ç‚¹ä¸­ç­›é€‰å‡ºä¸€ä¸ªä½œä¸ºæ–°çš„ masterï¼Œä¸»è¦è€ƒè™‘ä»¥ä¸‹ slave ä¿¡æ¯ï¼š\n\n1. è·Ÿ master æ–­å¼€è¿æ¥çš„æ—¶é•¿ï¼šå¦‚æœä¸€ä¸ª slave è·Ÿ master çš„æ–­å¼€è¿æ¥æ—¶é•¿å·²ç»è¶…è¿‡äº† down-after-milliseconds çš„ 10 å€ï¼Œå¤–åŠ  master å®•æœºçš„æ—¶é•¿ï¼Œé‚£ä¹ˆè¯¥ slave å°±è¢«è®¤ä¸ºä¸é€‚åˆé€‰ä¸¾ä¸º masterï¼›\n2. slave çš„ä¼˜å…ˆçº§é…ç½®ï¼šslave priority å‚æ•°å€¼è¶Šå°ï¼Œä¼˜å…ˆçº§å°±è¶Šé«˜ï¼›\n3. å¤åˆ¶ offsetï¼šå½“ä¼˜å…ˆçº§ç›¸åŒæ—¶ï¼Œå“ªä¸ª slave å¤åˆ¶äº†è¶Šå¤šçš„æ•°æ®ï¼ˆoffset è¶Šé åï¼‰ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼›\n4. run idï¼šå¦‚æœ offset å’Œä¼˜å…ˆçº§éƒ½ç›¸åŒï¼Œåˆ™å“ªä¸ª slave çš„ run id è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜ã€‚\n\næ¥ç€ï¼Œç­›é€‰å®Œ slave åï¼Œ ä¼šå¯¹å®ƒæ‰§è¡Œ slaveof no one å‘½ä»¤ï¼Œè®©å…¶æˆä¸ºä¸»èŠ‚ç‚¹ã€‚\n\næœ€åï¼ŒSentinel é¢†å¯¼è€…èŠ‚ç‚¹ä¼šå‘å‰©ä½™çš„ slave èŠ‚ç‚¹å‘é€å‘½ä»¤ï¼Œè®©å®ƒä»¬æˆä¸ºæ–°çš„ master èŠ‚ç‚¹çš„ä»èŠ‚ç‚¹ï¼Œå¤åˆ¶è§„åˆ™ä¸ parallel-syncs å‚æ•°æœ‰å…³ã€‚\n\nSentinel èŠ‚ç‚¹é›†åˆä¼šå°†åŸæ¥çš„ master èŠ‚ç‚¹æ›´æ–°ä¸º slave èŠ‚ç‚¹ï¼Œå¹¶ä¿æŒç€å¯¹å…¶å…³æ³¨ï¼Œå½“å…¶æ¢å¤åå‘½ä»¤å®ƒå»å¤åˆ¶æ–°çš„ä¸»èŠ‚ç‚¹ã€‚\n\næ³¨ï¼šLeader Sentinel èŠ‚ç‚¹ï¼Œä¼šä»æ–°çš„ master èŠ‚ç‚¹é‚£é‡Œå¾—åˆ°ä¸€ä¸ª configuration epochï¼Œæœ¬è´¨æ˜¯ä¸ª version ç‰ˆæœ¬å·ï¼Œæ¯æ¬¡ä¸»ä»åˆ‡æ¢çš„ version å·éƒ½å¿…é¡»æ˜¯å”¯ä¸€çš„ã€‚å…¶ä»–çš„å“¨å…µéƒ½æ˜¯æ ¹æ® version æ¥æ›´æ–°è‡ªå·±çš„ master é…ç½®ã€‚\n\n## é›†ç¾¤é…ç½®\n\n> é«˜å¯ç”¨ï¼šä¿è¯ Redis ä¸€ç›´å¤„äºå¯ç”¨çŠ¶æ€ï¼Œå³ä½¿å‡ºç°äº†æ•…éšœä¹Ÿæœ‰å¤‡ç”¨æ–¹æ¡ˆä¿è¯å¯ç”¨æ€§\n>\n> é«˜å¹¶å‘ï¼šä¸€ä¸ª Redis å®ä¾‹å·²ç»å¯ä»¥æ”¯æŒå¤šè¾¾ 11wå¹¶å‘è¯»æ“ä½œæˆ– 8.1wå¹¶å‘å†™æ“ä½œï¼›ä½†æ˜¯å¦‚æœæœ‰æ›´é«˜å¹¶å‘éœ€æ±‚çš„åº”ç”¨æ¥è¯´ï¼Œå¯ä»¥é€šè¿‡ è¯»å†™åˆ†ç¦»ã€é›†ç¾¤é…ç½® æ¥è§£å†³é«˜å¹¶å‘é—®é¢˜\n\n- Redis é›†ç¾¤ä¸­æ¯ä¸ªèŠ‚ç‚¹æ˜¯å¯¹ç­‰çš„ï¼Œæ— ä¸­å¿ƒç»“æ„\n- æ•°æ®æŒ‰ç…§ slots åˆ†å¸ƒå¼å­˜å‚¨åœ¨ä¸åŒçš„ Redis èŠ‚ç‚¹ä¸Šï¼ŒèŠ‚ç‚¹ä¸­çš„æ•°æ®å¯å…±äº«ï¼Œå¯ä»¥åŠ¨æ€è°ƒæ•´æ•°æ®åˆ†å¸ƒ\n- å¯æ‰©å±•æ€§å¼ºï¼Œå¯ä»¥åŠ¨æ€å¢åˆ èŠ‚ç‚¹ï¼Œæœ€å¤šå¯æ‰©å±•è‡³ 1000+ èŠ‚ç‚¹\n- é›†ç¾¤çš„æ¯ä¸ªèŠ‚ç‚¹é€šè¿‡ `ä¸»ä»ï¼ˆå“¨å…µæ¨¡å¼ï¼‰`ä¿è¯å…¶é«˜å¯ç”¨æ€§\n- Redis å¹¶ä¸èƒ½ä¿è¯æ•°æ®çš„å¼ºä¸€è‡´æ€§ï¼Œè¿™æ„å‘³è¿™åœ¨å®é™…ä¸­é›†ç¾¤åœ¨ç‰¹å®šçš„æ¡ä»¶ä¸‹å¯èƒ½ä¼šä¸¢å¤±å†™æ“ä½œ\n- Redis é›†ç¾¤ä¹‹é—´æ˜¯å¦‚ä½•å¤åˆ¶çš„ï¼Ÿå¼‚æ­¥å¤åˆ¶\n\n> [Redis_æ•°æ®åˆ†å¸ƒç®—æ³•ï¼šä¼ ç»Ÿå“ˆå¸Œ-ä¸€è‡´æ€§å“ˆå¸Œ-å“ˆå¸Œslot](https://blog.csdn.net/qq_43846090/article/details/123721066)\n\n### ä¼ ç»Ÿå“ˆå¸Œ\n\næœ€ç®€å•çš„æ•°æ®åˆ†å¸ƒç®—æ³•ï¼Œå¯¹è¿›æ¥çš„ key è¿›è¡Œ hashï¼Œç„¶åå¯¹èŠ‚ç‚¹æ•°æ®è¿›è¡Œå–æ¨¡ï¼Œå°±çŸ¥é“åˆ†å¸ƒåˆ°å“ªä¸ªèŠ‚ç‚¹ä¸Šäº†ï¼›\nç¼ºç‚¹å°±æ˜¯: å¦‚æœä¸€ä¸ªèŠ‚ç‚¹å®•æœºï¼Œæ‰€æœ‰ç¼“å­˜çš„ä½ç½®éƒ½è¦å‘ç”Ÿæ”¹å˜ï¼Œå½“æœåŠ¡å™¨æ•°é‡å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰ç¼“å­˜åœ¨ä¸€å®šæ—¶é—´å†…æ˜¯å¤±æ•ˆçš„ï¼Œä¼šå¼•èµ·ç¼“å­˜çš„é›ªå´©ï¼Œå¯èƒ½ä¼šå¼•èµ·æ•´ä½“ç³»ç»Ÿå‹åŠ›è¿‡å¤§è€Œå´©æºƒï¼ˆå¤§é‡ç¼“å­˜åŒä¸€æ—¶é—´å¤±æ•ˆï¼‰\n\n### ä¸€è‡´æ€§å“ˆå¸Œ\n\nå®é™…ä¸Šå°±æ˜¯å¼•å…¥äº†ä¸€ä¸ªåœ†ç¯çš„æ¦‚å¿µï¼Œ è®©æ¯ä¸ªæ•°æ®çš„ hash åˆ†å¸ƒåˆ°æ•´ä¸ªåœ†ç¯ï¼Œç„¶åé¡ºæ—¶é’ˆå»æ‰¾ç¦»ä»–æœ€è¿‘çš„èŠ‚ç‚¹å­˜å‚¨\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650525022243.png\" alt=\"ä¸€è‡´æ€§å“ˆå¸Œ\" style=\"zoom: 50%;\" />\n\nhash ç®—æ³•çš„å–æ¨¡æ³•æ˜¯å¯¹æœåŠ¡å™¨çš„æ•°é‡è¿›è¡Œå–æ¨¡ï¼Œè€Œä¸€è‡´æ€§å“ˆå¸Œç®—æ³•æ˜¯å¯¹ 2^32 å–æ¨¡ï¼Œ\ndubbo çš„å¤æ‚å‡è¡¡æœ‰ç”¨åˆ°è¯¥ç®—æ³•ï¼›\n\nå¥½å¤„:\n\nä½¿ç”¨ hash ç®—æ³•ï¼ŒæœåŠ¡å™¨æ•°é‡å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰æœåŠ¡å™¨çš„æ‰€æœ‰ç¼“å­˜åœ¨åŒä¸€æ—¶é—´å¤±æ•ˆäº†ï¼›\nè€Œä½¿ç”¨ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•æ—¶ï¼ŒæœåŠ¡å™¨çš„æ•°é‡å¦‚æœå‘ç”Ÿæ”¹å˜ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰ç¼“å­˜éƒ½ä¼šå¤±æ•ˆï¼Œè€Œæ˜¯åªæœ‰éƒ¨åˆ†ç¼“å­˜ä¼šå¤±æ•ˆã€‚ä¸Šå›¾ä¸­å¦‚æœèŠ‚ç‚¹ A å¤±æ•ˆï¼Œåˆ™ C â†’ A ä¹‹é—´çš„æ•°æ®ä¼šé‡æ–°ç¼“å­˜åˆ°èŠ‚ç‚¹ B ä¸Šã€‚\n\nhash ç¯åæ–œï¼š\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650525154544.png\" alt=\"hash ç¯åæ–œ\" style=\"zoom: 50%;\" />\n\n1 å·ã€2 å·ã€3 å·ã€4 å·ã€6 å·æ•°æ®å‡è¢«ç¼“å­˜åœ¨äº†æœåŠ¡å™¨ A ä¸Šï¼›åªæœ‰ 5 å·è¢«ç¼“å­˜åœ¨äº†æœåŠ¡å™¨ B ä¸Šï¼›æœåŠ¡å™¨ C ä¸Šç”šè‡³æ²¡æœ‰ç¼“å­˜ä»»ä½•å›¾ç‰‡\nå¦‚æœå‡ºç°ä¸Šå›¾ä¸­çš„æƒ…å†µï¼ŒAã€Bã€C ä¸‰å°æœåŠ¡å™¨å¹¶æ²¡æœ‰è¢«åˆç†çš„å¹³å‡çš„å……åˆ†åˆ©ç”¨ï¼Œç¼“å­˜åˆ†å¸ƒçš„æåº¦ä¸å‡åŒ€ï¼Œè€Œä¸”ï¼Œå¦‚æœæ­¤æ—¶æœåŠ¡å™¨ A å‡ºç°æ•…éšœï¼Œé‚£ä¹ˆå¤±æ•ˆç¼“å­˜çš„æ•°é‡ä¹Ÿå°†è¾¾åˆ°æœ€å¤§å€¼ï¼Œåœ¨æç«¯æƒ…å†µä¸‹ï¼Œä»ç„¶æœ‰å¯èƒ½å¼•èµ·ç³»ç»Ÿçš„å´©æºƒï¼›\n\nä¸Šå›¾ä¸­çš„æƒ…å†µåˆ™è¢«ç§°ä¹‹ä¸º hash ç¯çš„åæ–œ ï¼›\næˆ‘ä»¬åº”è¯¥æ€æ ·é˜²æ­¢ hash ç¯çš„åæ–œï¼Ÿ\nå¢åŠ è™šæ‹ŸèŠ‚ç‚¹ï¼š\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650525203417.png\" alt=\"å¢åŠ è™šæ‹ŸèŠ‚ç‚¹é˜²æ­¢ hash ç¯çš„åæ–œ\" style=\"zoom:50%;\" />\n\nä¸ºäº†è§£å†³è¿™ä¸ªæ•°æ®è´Ÿè½½å‡è¡¡çš„é—®é¢˜ï¼Œæå‡ºæ¥è™šæ‹ŸèŠ‚ç‚¹ï¼ŒæŠŠçœŸå®èŠ‚ç‚¹æä¸€å †è™šæ‹ŸèŠ‚ç‚¹åˆ†å¸ƒåˆ°ç¯ï¼Œé‚£ä¹ˆæ•´ä¸ªåŒºé—´çš„æ•°æ®ä¼šè½åˆ°è¿™äº›è™šæ‹ŸèŠ‚ç‚¹ä¸Šï¼›\n\nè™šæ‹ŸèŠ‚ç‚¹è¶Šå¤šï¼Œhash ç¯ä¸Šçš„èŠ‚ç‚¹å°±è¶Šå¤šï¼Œç¼“å­˜è¢«å‡åŒ€åˆ†å¸ƒçš„æ¦‚ç‡å°±è¶Šå¤§ã€‚\n\n### å“ˆå¸Œæ§½\n\nRedis é›†ç¾¤ï¼ˆclusterï¼‰å¹¶æ²¡æœ‰é€‰ç”¨ä¸Šé¢ä¸€è‡´æ€§å“ˆå¸Œï¼Œè€Œæ˜¯é‡‡ç”¨äº†å“ˆå¸Œæ§½ï¼ˆslotï¼‰çš„è¿™ç§æ¦‚å¿µã€‚ä¸»è¦çš„åŸå› å°±æ˜¯ä¸Šé¢æ‰€è¯´çš„ï¼Œä¸€è‡´æ€§å“ˆå¸Œç®—æ³•å¯¹äºæ•°æ®åˆ†å¸ƒã€èŠ‚ç‚¹ä½ç½®çš„æ§åˆ¶å¹¶ä¸æ˜¯å¾ˆå‹å¥½ã€‚\n\né¦–å…ˆå“ˆå¸Œæ§½å…¶å®æ˜¯ä¸¤ä¸ªæ¦‚å¿µï¼Œç¬¬ä¸€ä¸ªæ˜¯å“ˆå¸Œç®—æ³•ã€‚Redis cluster çš„ hash ç®—æ³•ä¸æ˜¯ç®€å•çš„ hash()ï¼Œè€Œæ˜¯ crc16 ç®—æ³•ï¼Œä¸€ç§æ ¡éªŒç®—æ³•ã€‚å¦å¤–ä¸€ä¸ªå°±æ˜¯æ§½ä½çš„æ¦‚å¿µï¼Œç©ºé—´åˆ†é…çš„è§„åˆ™ã€‚å…¶å®å“ˆå¸Œæ§½çš„æœ¬è´¨å’Œä¸€è‡´æ€§å“ˆå¸Œç®—æ³•éå¸¸ç›¸ä¼¼ï¼Œä¸åŒç‚¹å°±æ˜¯å¯¹äºå“ˆå¸Œç©ºé—´çš„å®šä¹‰ã€‚ä¸€è‡´æ€§å“ˆå¸Œçš„ç©ºé—´æ˜¯ä¸€ä¸ªåœ†ç¯ï¼ŒèŠ‚ç‚¹åˆ†å¸ƒæ˜¯åŸºäºåœ†ç¯çš„ï¼Œæ— æ³•å¾ˆå¥½çš„æ§åˆ¶æ•°æ®åˆ†å¸ƒã€‚è€Œ Redis cluster çš„æ§½ä½ç©ºé—´æ˜¯è‡ªå®šä¹‰åˆ†é…çš„ï¼Œç±»ä¼¼äº windows ç›˜åˆ†åŒºçš„æ¦‚å¿µã€‚è¿™ç§åˆ†åŒºæ˜¯å¯ä»¥è‡ªå®šä¹‰å¤§å°ï¼Œè‡ªå®šä¹‰ä½ç½®çš„ã€‚\n\nRedis cluster åŒ…å«äº† 16384 ä¸ªå“ˆå¸Œæ§½ï¼Œæ¯ä¸ª key é€šè¿‡è®¡ç®—åéƒ½ä¼šè½åœ¨å…·ä½“ä¸€ä¸ªæ§½ä½ä¸Šï¼Œè€Œè¿™ä¸ªæ§½ä½æ˜¯å±äºå“ªä¸ªå­˜å‚¨èŠ‚ç‚¹çš„ï¼Œåˆ™ç”±ç”¨æˆ·è‡ªå·±å®šä¹‰åˆ†é…ã€‚ä¾‹å¦‚æœºå™¨ç¡¬ç›˜å°çš„ï¼Œå¯ä»¥åˆ†é…å°‘ä¸€ç‚¹æ§½ä½ï¼Œç¡¬ç›˜å¤§çš„å¯ä»¥åˆ†é…å¤šä¸€ç‚¹ã€‚å¦‚æœèŠ‚ç‚¹ç¡¬ç›˜éƒ½å·®ä¸å¤šåˆ™å¯ä»¥å¹³å‡åˆ†é…ã€‚æ‰€ä»¥å“ˆå¸Œæ§½è¿™ç§æ¦‚å¿µå¾ˆå¥½åœ°è§£å†³äº†ä¸€è‡´æ€§å“ˆå¸Œçš„å¼Šç«¯ã€‚\n\n**ä¸ºä»€ä¹ˆå“ˆå¸Œæ§½çš„å¤§å°æ˜¯å›ºå®šçš„16384ï¼Ÿ**\n\n> `CRC16`ç®—æ³•äº§ç”Ÿçš„hashå€¼æœ‰16bitï¼Œè¯¥ç®—æ³•å¯ä»¥äº§ç”Ÿ2^16-=65536ä¸ªå€¼ã€‚æ¢å¥è¯è¯´ï¼Œå€¼æ˜¯åˆ†å¸ƒåœ¨0~65535ä¹‹é—´ã€‚é‚£ä½œè€…åœ¨åš`mod`è¿ç®—çš„æ—¶å€™ï¼Œä¸ºä»€ä¹ˆä¸`mod`65536ï¼Œè€Œé€‰æ‹©`mod`16384ï¼Ÿ\n\n**ä¸èƒ½å¤ªå¤§ï¼Œä¸»è¦ä»èŠ‚ç‚¹é—´çš„é€šä¿¡æ€§èƒ½æ–¹é¢è€ƒè™‘ï¼š**\n\næ¯ä¸ªèŠ‚ç‚¹ä¹‹é—´æ˜¯éœ€è¦è¿›è¡Œä¸€ä¸ªé€šä¿¡çš„ï¼Œä¹Ÿå°±æ˜¯ä¸æ–­åœ° pingpong æœºåˆ¶ï¼Œè®©æ¯ä¸ªèŠ‚ç‚¹è¿æ¥å¯¹æ–¹çš„ä¿¡æ¯ï¼›å‘é€çš„æ¶ˆæ¯å¤´ä¸­æœ‰ä¸€ä¸ª bitmapï¼Œå…¶ä¸­æ¯ä¸€ä½ä»£è¡¨ä¸€ä¸ªæ§½ï¼Œå¦‚æœè¯¥ä½ä¸º 1ï¼Œè¡¨ç¤ºè¿™ä¸ªæ§½æ˜¯å±äºå½“å‰èŠ‚ç‚¹ï¼Œå¦‚æœæ§½ä½è¿‡å¤§ï¼Œé‚£ä¹ˆè¿™ä¸ª bitmap å°±ä¼šå¤ªå¤§ï¼Œå¿ƒè·³åŒ…è¿‡äºåºå¤§ï¼Œæµªè´¹å¸¦å®½ã€‚\n\n**ä¸èƒ½å¤ªå°ï¼Œä¸»è¦ä»å‹ç¼©ç‡æ–¹é¢è€ƒè™‘ï¼š**\n\nç”±äº bitmap åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ä¼šè¿›è¡Œå‹ç¼©ï¼Œbitmap çš„å¡«å……ç‡ç”¨ slots/N è¡¨ç¤ºï¼ˆN å³èŠ‚ç‚¹æ•°ï¼‰ï¼Œå¯¹äºåŒæ ·çš„ slotsï¼Œå¦‚æœ N å¤ªå°ï¼Œå¯¼è‡´å…¶å¡«å……ç‡è¿‡é«˜ï¼Œå‹ç¼©ç‡å°±å¾ˆä½ã€‚\n\n***\n\n## ç¼“å­˜ç©¿é€ã€å‡»ç©¿ã€é›ªå´©\n\n### ç¼“å­˜ç©¿é€\n\n**é—®é¢˜æ¥æº**\n\nç¼“å­˜ç©¿é€æ˜¯æŒ‡ç¼“å­˜å’Œæ•°æ®åº“ä¸­éƒ½æ²¡æœ‰çš„æ•°æ®ï¼Œè€Œç”¨æˆ·ä¸æ–­å‘èµ·è¯·æ±‚ã€‚ç”±äºç¼“å­˜æ˜¯ä¸å‘½ä¸­æ—¶è¢«åŠ¨å†™çš„ï¼Œå¹¶ä¸”å‡ºäºå®¹é”™è€ƒè™‘ï¼Œå¦‚æœä»å­˜å‚¨å±‚æŸ¥ä¸åˆ°æ•°æ®åˆ™ä¸å†™å…¥ç¼“å­˜ï¼Œè¿™å°†å¯¼è‡´è¿™ä¸ªä¸å­˜åœ¨çš„æ•°æ®æ¯æ¬¡è¯·æ±‚éƒ½è¦åˆ°å­˜å‚¨å±‚å»æŸ¥è¯¢ï¼Œå¤±å»äº†ç¼“å­˜çš„æ„ä¹‰ã€‚åœ¨æµé‡å¤§æ—¶ï¼Œå¯èƒ½ DB å°±æŒ‚æ‰äº†ï¼Œè¦æ˜¯æœ‰äººåˆ©ç”¨ä¸å­˜åœ¨çš„ key é¢‘ç¹æ”»å‡»æˆ‘ä»¬çš„åº”ç”¨ï¼Œæ¯æ¬¡éƒ½å» DB åˆ¤æ–­ç„¶è€Œåˆä¸èƒ½å¤åˆ¶åˆ° Redis ä¸­ï¼Œè¿™å°±æ˜¯æ¼æ´ã€‚\n\nä¾‹å¦‚å‘èµ·ä¸º id ä¸ºâ€œ-1â€çš„æ•°æ®æˆ– id ä¸ºç‰¹åˆ«å¤§ä¸å­˜åœ¨çš„æ•°æ®ã€‚è¿™æ—¶çš„ç”¨æˆ·å¾ˆå¯èƒ½æ˜¯æ”»å‡»è€…ï¼Œæ”»å‡»ä¼šå¯¼è‡´æ•°æ®åº“å‹åŠ›è¿‡å¤§ã€‚\n\n**è§£å†³æ–¹æ¡ˆ**\n\n1. **æ¥å£æ ¡éªŒ**ï¼šæ¥å£å±‚å¢åŠ æ ¡éªŒï¼Œä¾‹å¦‚å¯¹ id<=0 çš„ç›´æ¥æ‹¦æˆªã€‚\n\n2. **ç¼“å­˜ç©ºå€¼**ï¼šä»ç¼“å­˜å–ä¸åˆ°çš„æ•°æ®ï¼Œåœ¨æ•°æ®åº“ä¸­ä¹Ÿæ²¡æœ‰å–åˆ°ï¼Œè¿™æ—¶ä¹Ÿå¯ä»¥å°† key-value å¯¹å†™ä¸º key-nullï¼Œç¼“å­˜æœ‰æ•ˆæ—¶é—´å¯ä»¥è®¾ç½®çŸ­ç‚¹ï¼Œå¦‚ 10 ç§’ï¼ˆè®¾ç½®å¤ªé•¿ä¼šå¯¼è‡´æ­£å¸¸æƒ…å†µä¹Ÿæ²¡æ³•ä½¿ç”¨ï¼‰ã€‚\n\n3. **å¸ƒéš†è¿‡æ»¤å™¨**ï¼šå¸ƒéš†è¿‡æ»¤å™¨ç”¨äºå¿«é€Ÿåˆ¤æŸä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨äºé›†åˆä¸­ï¼Œç”±ä¸€ä¸ªå¾ˆé•¿çš„äºŒè¿›åˆ¶å‘é‡ï¼ˆä½å›¾ï¼‰å’Œä¸€ç³»åˆ—å“ˆå¸Œå‡½æ•°ä¸¤éƒ¨åˆ†ç»„æˆã€‚å¸ƒéš†è¿‡æ»¤å™¨å¯ä»¥ç”¨äºæ£€ç´¢ä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨ä¸€ä¸ªé›†åˆä¸­ã€‚å®ƒçš„ä¼˜ç‚¹æ˜¯ç©ºé—´æ•ˆç‡å’ŒæŸ¥è¯¢æ—¶é—´éƒ½è¿œè¿œè¶…è¿‡ä¸€èˆ¬çš„ç®—æ³•ï¼Œç¼ºç‚¹æ˜¯æœ‰ä¸€å®šçš„é”™è¯¯è¯†åˆ«ç‡ï¼Œæ·»åŠ åˆ°é›†åˆä¸­çš„å…ƒç´ è¶Šå¤šï¼Œè¯¯æŠ¥çš„å¯èƒ½æ€§å°±è¶Šå¤§ã€‚\n\n\tä½æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½åªå ç”¨ 1 bit ï¼Œå¹¶ä¸”æ¯ä¸ªå…ƒç´ åªèƒ½æ˜¯ 0 æˆ–è€… 1ã€‚è¿™æ ·ç”³è¯·ä¸€ä¸ª 100w ä¸ªå…ƒç´ çš„ä½æ•°ç»„åªå ç”¨ 1000000Bit / 8 = 125000 Byte = 125000/1024 kb â‰ˆ 122kb çš„ç©ºé—´ã€‚\n\n\t> [å¸ƒéš†è¿‡æ»¤å™¨](https://javaguide.cn/cs-basics/data-structure/bloom-filter.html)\n\t>\n\t> [ç¼“å­˜ç©¿é€-å¸ƒéš†è¿‡æ»¤å™¨](https://javaguide.cn/database/Redis/Redis-questions-01.html#%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F)\n\n\tå…·ä½“è€Œè¨€ï¼š\n\n\tæŠŠ **æ‰€æœ‰å¯èƒ½å­˜åœ¨çš„è¯·æ±‚çš„å€¼** éƒ½å­˜æ”¾åœ¨å¸ƒéš†è¿‡æ»¤å™¨ä¸­ï¼Œå½“ç”¨æˆ·è¯·æ±‚è¿‡æ¥ï¼Œå…ˆåˆ¤æ–­ç”¨æˆ·å‘æ¥çš„è¯·æ±‚çš„å€¼æ˜¯å¦å­˜åœ¨äºå¸ƒéš†è¿‡æ»¤å™¨ä¸­ã€‚å¸ƒéš†è¿‡æ»¤å™¨åˆ¤æ–­ä¸å­˜åœ¨çš„è¯ï¼Œåˆ™è‚¯å®šä¸å­˜åœ¨ï¼Œå¸ƒéš†è¿‡æ»¤å™¨åˆ¤æ–­å­˜åœ¨ï¼Œåˆ™è¿›ä¸€æ­¥æŸ¥ Redisï¼ŒRedis ä¸­å­˜åœ¨åˆ™è¿”å›ï¼ŒRedis ä¸­ä¸å­˜åœ¨åˆ™æŸ¥æ•°æ®åº“ã€‚\n\n\tä¸ºä»€ä¹ˆå¸ƒéš†è¿‡æ»¤å™¨ä¼šå‡ºç°è¯¯åˆ¤çš„æƒ…å†µå‘¢? \n\n\t**å½“ä¸€ä¸ªå…ƒç´ åŠ å…¥å¸ƒéš†è¿‡æ»¤å™¨ä¸­çš„æ—¶å€™ï¼Œä¼šè¿›è¡Œä»¥ä¸‹æ“ä½œï¼š**\n\n\t1. ä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨ä¸­çš„å“ˆå¸Œå‡½æ•°å¯¹å…ƒç´ å€¼è¿›è¡Œè®¡ç®—ï¼Œå¾—åˆ°å“ˆå¸Œå€¼ï¼ˆæœ‰å‡ ä¸ªå“ˆå¸Œå‡½æ•°å¾—åˆ°å‡ ä¸ªå“ˆå¸Œå€¼ï¼‰ã€‚\n\n\t\t> hashVal1 = hashMethod1(key)ï¼Œ hashVal2= hashMethod2(key)...\n\n\t2. æ ¹æ®å¾—åˆ°çš„å“ˆå¸Œå€¼ï¼Œåœ¨ä½æ•°ç»„ä¸­æŠŠå¯¹åº”ä¸‹æ ‡çš„å€¼ç½®ä¸º 1ã€‚\n\n\t\t> æŠŠä½æ•°ç»„ä¸­çš„ hashVal1 å’Œ hashVal2 å¤„ç½®ä¸º 1\n\n\t**å½“æˆ‘ä»¬éœ€è¦åˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨äºå¸ƒéš†è¿‡æ»¤å™¨çš„æ—¶å€™ï¼Œä¼šè¿›è¡Œä»¥ä¸‹æ“ä½œï¼š**\n\n\t1. å¯¹ç»™å®šå…ƒç´ å†æ¬¡è¿›è¡Œç›¸åŒçš„å“ˆå¸Œè®¡ç®—ï¼›\n\n\t\t> hashVal1 = hashMethod1(key)ï¼Œ hashVal2= hashMethod2(key)...\n\n\t2. å¾—åˆ°å€¼ä¹‹ååˆ¤æ–­ä½æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ æ˜¯å¦éƒ½ä¸º 1ï¼Œå¦‚æœå€¼éƒ½ä¸º 1ï¼Œé‚£ä¹ˆè¯´æ˜è¿™ä¸ªå€¼åœ¨å¸ƒéš†è¿‡æ»¤å™¨ä¸­ï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ªå€¼ä¸ä¸º 1ï¼Œè¯´æ˜è¯¥å…ƒç´ ä¸åœ¨å¸ƒéš†è¿‡æ»¤å™¨ä¸­ã€‚\n\n\t\t> åˆ¤æ–­ä½æ•°ç»„ä¸­çš„ hashVal1 å’Œ hashVal2 å¤„æ˜¯å¦å…¨éƒ¨ä¸º 1ï¼Œå…¨éƒ¨ä¸º 1è¯´æ˜å½“å‰å…ƒç´ å­˜åœ¨äºä½æ•°ç»„ä¸­ã€‚\n\n\tç„¶è€Œä¼šå‡ºç°è¿™æ ·ä¸€ç§æƒ…å†µï¼š**ä¸åŒçš„å­—ç¬¦ä¸²å¯èƒ½å“ˆå¸Œå‡ºæ¥çš„ä½ç½®ç›¸åŒã€‚** ï¼ˆå¯ä»¥é€‚å½“å¢åŠ ä½æ•°ç»„å¤§å°æˆ–è€…è°ƒæ•´æˆ‘ä»¬çš„å“ˆå¸Œå‡½æ•°æ¥é™ä½æ¦‚ç‡ï¼‰\n\n\t> **â­ä¾‹å¦‚**ï¼šval1 ç»è¿‡ä¸¤æ¬¡hashå¾—åˆ°ä¸‹æ ‡ 1ï¼Œ 3ï¼Œå°†1ã€3å¤„ç½®ä¸º1ï¼Œval2ç»è¿‡ä¸¤æ¬¡hashå¾—åˆ°ä¸‹æ ‡2ã€4ï¼Œå°†2ã€4å¤„ç½®ä¸º1ï¼Œå¯¹äºæ–°å…ƒç´ val3ç»è¿‡ä¸¤æ¬¡hashå¾—åˆ°ä¸‹æ ‡1ã€2ï¼Œåˆ¤æ–­è¿™ä¸¤ä¸ªä½ç½®éƒ½ä¸º1ï¼Œè¯¯åˆ¤ä»¥ä¸ºval3å­˜åœ¨ï¼Œå®é™…ä¸Šä¸å­˜åœ¨ã€‚\n\n\n### ç¼“å­˜å‡»ç©¿\n\n**é—®é¢˜æ¥æº**\n\nç¼“å­˜å‡»ç©¿æ˜¯æŒ‡ä¸€ä¸ªçƒ­ç‚¹çš„ keyï¼Œæœ‰å¤§å¹¶å‘é›†ä¸­å¯¹å…¶è¿›è¡Œè®¿é—®ï¼Œçªç„¶é—´è¿™ä¸ª key å¤±æ•ˆäº†ï¼Œå¯¼è‡´å¤§å¹¶å‘å…¨éƒ¨æ‰“åœ¨æ•°æ®åº“ä¸Šï¼Œå¯¼è‡´æ•°æ®åº“å‹åŠ›å‰§å¢ã€‚è¿™ç§ç°è±¡å°±å«åšç¼“å­˜å‡»ç©¿ã€‚\n\n**è§£å†³æ–¹æ¡ˆ**\n\n> çƒ­ç‚¹keyå¤±æ•ˆ â†’ æ‰“åˆ°æ•°æ®åº“ä¸Šï¼Œå› æ­¤å¯ä»¥ä»è¿™ä¸¤æ–¹é¢è¿›è¡Œè§£å†³\n\n1ã€è®¾ç½®çƒ­ç‚¹æ•°æ®æ°¸è¿œä¸è¿‡æœŸã€‚\n\n2ã€æ¥å£é™æµã€é™çº§ä¸ç†”æ–­ã€‚é‡è¦çš„æ¥å£ä¸€å®šè¦åšå¥½é™æµç­–ç•¥ï¼Œé˜²æ­¢ç”¨æˆ·æ¶æ„åˆ·æ¥å£ï¼ŒåŒæ—¶è¦é™çº§å‡†å¤‡ï¼Œå½“æ¥å£ä¸­çš„æŸäº›æœåŠ¡ä¸å¯ç”¨æ—¶å€™ï¼Œè¿›è¡Œç†”æ–­ï¼Œå¤±è´¥å¿«é€Ÿè¿”å›æœºåˆ¶ã€‚\n\n3ã€åŠ äº’æ–¥é”ï¼šå¦‚æœç¼“å­˜å¤±æ•ˆçš„æƒ…å†µï¼Œåªæœ‰æ‹¿åˆ°é”æ‰å¯ä»¥æŸ¥è¯¢æ•°æ®åº“ï¼Œåˆ†å¸ƒå¼åœºæ™¯ä¸‹å¯ä»¥ä½¿ç”¨åˆ†å¸ƒå¼é”ã€‚\n\n### ç¼“å­˜é›ªå´©\n\n**é—®é¢˜æ¥æº**\n\nç¼“å­˜é›ªå´©æ˜¯æŒ‡ç¼“å­˜ä¸­æ•°æ®å¤§æ‰¹é‡åˆ°è¿‡æœŸæ—¶é—´ï¼Œè€ŒæŸ¥è¯¢æ•°æ®é‡å·¨å¤§ï¼Œå¼•èµ·æ•°æ®åº“å‹åŠ›è¿‡å¤§ç”šè‡³ down æœºã€‚å’Œç¼“å­˜å‡»ç©¿ä¸åŒçš„æ˜¯ï¼Œç¼“å­˜å‡»ç©¿æŒ‡å¹¶å‘æŸ¥åŒä¸€æ¡æ•°æ®ï¼Œç¼“å­˜é›ªå´©æ˜¯æŒ‡å¾ˆå¤šä¸åŒçš„æ•°æ®éƒ½è¿‡æœŸäº†ï¼Œéƒ½æŸ¥ä¸åˆ°ä»è€ŒæŸ¥æ•°æ®åº“ã€‚\n\n**è§£å†³æ–¹æ¡ˆ**\n\n1. **ç¼“å­˜æ•°æ®çš„è¿‡æœŸæ—¶é—´è®¾ç½®éšæœº**ï¼Œé˜²æ­¢åŒä¸€æ—¶é—´å¤§é‡æ•°æ®è¿‡æœŸç°è±¡å‘ç”Ÿã€‚\n2. è®¾ç½®çƒ­ç‚¹æ•°æ®æ°¸è¿œä¸è¿‡æœŸã€‚\n3. åœ¨å³å°†å‘ç”Ÿå¤§å¹¶å‘è®¿é—®ä¹‹å‰ï¼Œè¿›è¡Œ**ç¼“å­˜é¢„çƒ­**å°†å¯èƒ½å¤§é‡è®¿é—®çš„æ•°æ®åŠ è½½åˆ°ç¼“å­˜ã€‚\n4. æ¥å£é™æµã€é™çº§ä¸ç†”æ–­ã€‚é‡è¦çš„æ¥å£ä¸€å®šè¦åšå¥½é™æµç­–ç•¥ï¼Œé˜²æ­¢ç”¨æˆ·æ¶æ„åˆ·æ¥å£ï¼ŒåŒæ—¶è¦é™çº§å‡†å¤‡ï¼Œå½“æ¥å£ä¸­çš„æŸäº›æœåŠ¡ä¸å¯ç”¨æ—¶å€™ï¼Œè¿›è¡Œç†”æ–­ï¼Œå¤±è´¥å¿«é€Ÿè¿”å›æœºåˆ¶ã€‚\n5. ä¸ºäº†é˜²æ­¢ Redis å®•æœºå¯¼è‡´ç¼“å­˜é›ªå´©çš„é—®é¢˜ï¼Œå¯ä»¥**æ­å»ºRedisé›†ç¾¤**ï¼Œæé«˜ Redis çš„å®¹ç¾æ€§ã€‚\n6. æé«˜æ•°æ®åº“çš„å®¹ç¾èƒ½åŠ›ï¼Œå¯ä»¥ä½¿ç”¨**æ•°æ®åº“åˆ†åº“åˆ†è¡¨**ï¼Œè¯»å†™åˆ†ç¦»çš„ç­–ç•¥ã€‚\n\n## Redis æ·˜æ±°ç­–ç•¥\n\n### Redis å†…å­˜æ·˜æ±°ç­–ç•¥\n\n> Redis æ˜¯åŸºäºå†…å­˜ç»“æ„è¿›è¡Œæ•°æ®ç¼“å­˜çš„ï¼Œå½“å†…å­˜èµ„æºæ¶ˆè€—å®Œæ¯•ï¼Œå½“å°†è¦æœ‰æ–°çš„æ•°æ®ç¼“å­˜è¿›æ¥æ—¶ï¼Œä¸ºäº†è…¾å‡ºç©ºé—´æ”¾æ–°çš„æ•°æ®ï¼Œéœ€è¦å°†å†…å­˜ä¸­çš„ä¸€äº›æ•°æ®é‡Šæ”¾æ‰ï¼Œè¿™ç§é‡Šæ”¾æ•°æ®çš„ç­–ç•¥ç§°ä¸º Redis çš„æ·˜æ±°ç­–ç•¥ã€‚\n\nLRUï¼šLeast Recently Used\n\nLFUï¼šLeast Frequently Used\n\nLRU æ·˜æ±°çš„æ˜¯æœ€ä¹…æœªè®¿é—®åˆ°çš„æ•°æ®ï¼Œè€Œ LFU æ˜¯æ·˜æ±°çš„æ˜¯æœ€ä¸ç»å¸¸ä½¿ç”¨çš„æ•°æ®ï¼ˆè‹¥ä¸¤ä¸ªæˆ–å¤šä¸ªæ•°æ®çš„ä½¿ç”¨é¢‘ç‡ç›¸åŒæ—¶ï¼ŒLFU ä¼šå†é€‰æ‹©æœ€ä¹…æœªè®¿é—®åˆ°çš„æ•°æ®æ·˜æ±°ï¼‰ã€‚\n\n```conf\n# volatile-lru -> åœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„æ•°æ®ä¸­ä½¿ç”¨ LRU\n# allkeys-lru -> åœ¨æ‰€æœ‰æ•°æ®ä¸­ä½¿ç”¨ LRU\n# volatile-lfu -> åœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„æ•°æ®ä¸­ä½¿ç”¨ LFU\n# allkeys-lfu -> åœ¨æ‰€æœ‰æ•°æ®ä¸­ä½¿ç”¨ LFU\n# volatile-random -> åœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„æ•°æ®ä¸­éšæœºæ·˜æ±°\n# allkeys-random -> åœ¨æ‰€æœ‰æ•°æ®ä¸­éšæœºæ·˜æ±°\n# volatile-ttl -> è¶Šæ—©è¿‡æœŸçš„æ•°æ® è¶Šå…ˆè¢«æ·˜æ±°\n# noeviction -> ä¸æ·˜æ±°ä»»ä½•æ•°æ®ï¼Œå½“å†…å­˜ä¸å¤Ÿæ—¶ç›´æ¥æŠ›å‡ºå¼‚å¸¸\n```\n\n### Redis ç¼“å­˜å¤±æ•ˆç­–ç•¥\n\n**å®šæ—¶è¿‡æœŸç­–ç•¥**\n\næ¯ä¸ªè®¾ç½®è¿‡æœŸæ—¶é—´çš„ key éƒ½éœ€è¦åˆ›å»ºä¸€ä¸ªå®šæ—¶å™¨ï¼Œåˆ°è¿‡æœŸæ—¶é—´å°±ä¼šç«‹å³æ¸…é™¤ã€‚è¯¥ç­–ç•¥å¯ä»¥ç«‹å³æ¸…é™¤è¿‡æœŸçš„æ•°æ®ï¼Œå¯¹å†…å­˜å¾ˆå‹å¥½ï¼Œæœ‰æ•ˆåœ°å‡å°‘äº†å› ä¸ºè¿‡æœŸé”®å¸¦æ¥çš„å†…å­˜æµªè´¹ï¼›ä½†æ˜¯ä¼šå ç”¨å¤§é‡çš„ CPU èµ„æºå»å¤„ç†è¿‡æœŸçš„æ•°æ®ï¼Œä»è€Œå½±å“ç¼“å­˜çš„å“åº”æ—¶é—´å’Œååé‡ã€‚\n\n**æƒ°æ€§è¿‡æœŸç­–ç•¥**\n\nåªæœ‰å½“è®¿é—®ä¸€ä¸ª key æ—¶ï¼Œæ‰ä¼šåˆ¤æ–­è¯¥ key æ˜¯å¦å·²è¿‡æœŸï¼Œè¿‡æœŸåˆ™æ¸…é™¤ã€‚è¯¥ç­–ç•¥å¯ä»¥æœ€å¤§åŒ–åœ°èŠ‚çœ CPU èµ„æºï¼Œå´å¯¹å†…å­˜éå¸¸ä¸å‹å¥½ã€‚æç«¯æƒ…å†µå¯èƒ½å‡ºç°å¤§é‡çš„è¿‡æœŸ key æ²¡æœ‰å†æ¬¡è¢«è®¿é—®ï¼Œä»è€Œä¸ä¼šè¢«æ¸…é™¤ï¼Œå ç”¨å¤§é‡å†…å­˜ã€‚\n\n**å®šæœŸè¿‡æœŸç­–ç•¥**\n\næ¯éš”ä¸€å®šçš„æ—¶é—´ï¼Œä¼šæ‰«æä¸€å®šæ•°é‡çš„æ•°æ®åº“çš„ expires å­—å…¸ä¸­ä¸€å®šæ•°é‡çš„ keyï¼Œå¹¶æ¸…é™¤å…¶ä¸­å·²è¿‡æœŸçš„ keyã€‚è¯¥ç­–ç•¥æ˜¯å‰ä¸¤è€…çš„ä¸€ä¸ªæŠ˜ä¸­æ–¹æ¡ˆã€‚é€šè¿‡è°ƒæ•´å®šæ—¶æ‰«æçš„æ—¶é—´é—´éš”å’Œæ¯æ¬¡æ‰«æçš„é™å®šè€—æ—¶ï¼Œå¯ä»¥åœ¨ä¸åŒæƒ…å†µä¸‹ä½¿å¾— CPU å’Œå†…å­˜èµ„æºè¾¾åˆ°æœ€ä¼˜çš„å¹³è¡¡æ•ˆæœã€‚\n\n**Redisä¸­åŒæ—¶ä½¿ç”¨äº†å®šæœŸè¿‡æœŸå’Œæƒ°æ€§è¿‡æœŸä¸¤ç§è¿‡æœŸç­–ç•¥ã€‚**\n\næ‰€è°“å®šæœŸåˆ é™¤ï¼ŒæŒ‡çš„æ˜¯ Redis é»˜è®¤æ˜¯æ¯éš” 100ms å°±éšæœºæŠ½å–ä¸€äº›è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„ keyï¼Œæ£€æŸ¥å…¶æ˜¯å¦è¿‡æœŸï¼Œå¦‚æœè¿‡æœŸå°±åˆ é™¤ã€‚\n\n**å‡è®¾ Redis é‡Œæ”¾äº† 10w ä¸ª keyï¼Œéƒ½è®¾ç½®äº†è¿‡æœŸæ—¶é—´ï¼Œ**ä½ æ¯éš”å‡ ç™¾æ¯«ç§’ï¼Œå°±æ£€æŸ¥ 10w ä¸ª keyï¼Œé‚£ Redis åŸºæœ¬ä¸Šå°±æ­»äº†ï¼Œcpu è´Ÿè½½ä¼šå¾ˆé«˜çš„ï¼Œæ¶ˆè€—åœ¨ä½ çš„æ£€æŸ¥è¿‡æœŸ key ä¸Šäº†ã€‚**æ³¨æ„ï¼Œ**è¿™é‡Œå¯ä¸æ˜¯æ¯éš” 100ms å°±éå†æ‰€æœ‰çš„è®¾ç½®è¿‡æœŸæ—¶é—´çš„ keyï¼Œé‚£æ ·å°±æ˜¯ä¸€åœºæ€§èƒ½ä¸Šçš„ç¾éš¾ã€‚å®é™…ä¸Š Redis æ˜¯æ¯éš” 100ms éšæœºæŠ½å–ä¸€äº› key æ¥æ£€æŸ¥å’Œåˆ é™¤çš„ã€‚\n\n**ä½†æ˜¯é—®é¢˜æ˜¯ï¼Œå®šæœŸåˆ é™¤å¯èƒ½ä¼šå¯¼è‡´å¾ˆå¤šè¿‡æœŸ key åˆ°äº†æ—¶é—´å¹¶æ²¡æœ‰è¢«åˆ é™¤æ‰ï¼Œé‚£å’‹æ•´å‘¢ï¼Ÿ**æ‰€ä»¥å°±æ˜¯æƒ°æ€§åˆ é™¤äº†ã€‚è¿™å°±æ˜¯è¯´ï¼Œåœ¨ä½ è·å–æŸä¸ª key çš„æ—¶å€™ï¼ŒRedis ä¼šæ£€æŸ¥ä¸€ä¸‹ ï¼Œè¿™ä¸ª key å¦‚æœè®¾ç½®äº†è¿‡æœŸæ—¶é—´é‚£ä¹ˆæ˜¯å¦è¿‡æœŸäº†ï¼Ÿå¦‚æœè¿‡æœŸäº†æ­¤æ—¶å°±ä¼šåˆ é™¤ï¼Œä¸ä¼šç»™ä½ è¿”å›ä»»ä½•ä¸œè¥¿ã€‚\n\n**è·å– key çš„æ—¶å€™ï¼Œå¦‚æœæ­¤æ—¶ key å·²ç»è¿‡æœŸï¼Œå°±åˆ é™¤ï¼Œä¸ä¼šè¿”å›ä»»ä½•ä¸œè¥¿ã€‚**ä½†æ˜¯å®é™…ä¸Šè¿™è¿˜æ˜¯æœ‰é—®é¢˜çš„ï¼Œå¦‚æœå®šæœŸåˆ é™¤æ¼æ‰äº†å¾ˆå¤šè¿‡æœŸ keyï¼Œç„¶åä½ ä¹Ÿæ²¡åŠæ—¶å»æŸ¥ï¼Œä¹Ÿå°±æ²¡èµ°æƒ°æ€§åˆ é™¤ï¼Œæ­¤æ—¶ä¼šæ€ä¹ˆæ ·ï¼Ÿå¦‚æœå¤§é‡è¿‡æœŸ key å †ç§¯åœ¨å†…å­˜é‡Œï¼Œå¯¼è‡´ Redis å†…å­˜å¿«è€—å°½äº†ï¼Œå’‹æ•´ï¼Ÿ**ç­”æ¡ˆæ˜¯ï¼šèµ°å†…å­˜æ·˜æ±°æœºåˆ¶ã€‚**\n\n***\n\n## Redisåˆ†å¸ƒå¼å¹¶å‘é—®é¢˜\n\n> å•ä½“é¡¹ç›®ä¸­ï¼Œè´­ç‰©è½¦ä¸‹å•å¯ä»¥ä½¿ç”¨ synchronized å…³é”®å­—é”ä½å®ä¾‹å¯¹è±¡ï¼Œåªè®©ä¸€ä¸ªçº¿ç¨‹ä¸‹å•å¹¶æ‰£å‡åº“å­˜\n>\n> è€Œå¯¹äºé›†ç¾¤è€Œè¨€ï¼Œåœ¨æ¯å°æœåŠ¡å™¨ä¸Šé”ä½å®ä¾‹å¯¹è±¡ï¼Œä½†æ˜¯æ¯å°ä¹‹é—´æ˜¯æ— æ³•æ„ŸçŸ¥çš„ï¼Œä»ç„¶å¯èƒ½å­˜åœ¨å•†å“è¶…å–é—®é¢˜\n\n### ä½¿ç”¨ Redis å®ç°åˆ†å¸ƒå¼é”\n\n```java\n@Transactional\n@Override\npublic Map<String, String> addOrder(String cids, Orders orders) {\n    log.info(\"add order begin...\");\n\n    Map<String, String> map = new HashMap<>();\n\n    // 1ã€æ ¹æ®cidsæŸ¥è¯¢å½“å‰è®¢å•ä¸­å…³è”çš„è´­ç‰©è½¦è®°å½•è¯¦æƒ…ï¼ˆåŒ…æ‹¬åº“å­˜ï¼‰\n    String[] arr = cids.split(\"ï¼Œ\");\n    List<Integer> cidsList = new ArrayList<>();\n    for (String s : arr) {\n        cidsList.add(Integer.parseInt(s));\n    }\n    // è·å–æ‰€æœ‰skuId\n    List<ShoppingCartVO> list1 = shoppingCartMapper.selectShopCartByCids(cidsList);\n\n    boolean allLocked = true;\n    List<String> lockedSkuIds = new ArrayList<>();\n    Map<String, String> values = new HashMap<>();\n    for (ShoppingCartVO sc : list1) {\n        String skuId = sc.getSkuId()ï¼Œ value = UUID.randomUUID().toString();\n        Boolean thisLocked = srt.boundValueOps(sc.getSkuId()).setIfAbsent(value, 10, TimeUnit.SECONDS);\n        if (!thisLocked) {   // è¿”å› false è¯´æ˜ä¹‹å‰æœ‰è¯¥æ•°æ®ï¼Œå³æœ‰çº¿ç¨‹åœ¨æ“ä½œè¿™ä¸ª å•†å“åº“å­˜\n            allLocked = false;  // å› æ­¤è¿™ä¸ªskuå°±æ²¡æœ‰é”ä½ï¼Œä¸èƒ½ç»§ç»­æ“ä½œ\n            break;\n        } else {\n            lockedSkuIds.add(skuId);\n            values.put(skuId, value);\n        }\n    }\n    if (allLocked) {\n        // 2ã€æ ¡éªŒåº“å­˜\n        List<ShoppingCartVO> list = shoppingCartMapper.selectShopCartByCids(cidsList);\n        boolean f = true;\n        StringBuilder sb = new StringBuilder();\n        for (ShoppingCartVO sc : list) {\n            if (Integer.parseInt(sc.getCartNum()) > sc.getSkuStock()) {\n                f = false;\n            }\n            //è·å–æ‰€æœ‰å•†å“çš„åç§°ï¼Œä»¥é€—å·æ‹¼æ¥æˆå­—ç¬¦ä¸²\n            sb.append(sc.getProductName()).append(\"ï¼Œ\");\n        }\n        String untitled = sb.toString();\n\n        if (f) {\n            log.info(\"product stock is ok ... \");\n            // 3ã€è¡¨ç¤ºåº“å­˜å……è¶³----ä¿å­˜è®¢å•\n            // a.userId   b.untitled  c.æ”¶è´§äººä¿¡æ¯ï¼šå§“åã€ç”µè¯ã€åœ°å€\n            // d.æ€»ä»·æ ¼   e.æ”¯ä»˜æ–¹å¼   f.è®¢å•çš„åˆ›å»ºæ—¶é—´  g.è®¢å•åˆå§‹çŠ¶æ€\n            orders.setUntitled(untitled);\n            orders.setCreateTime(new Date());\n            orders.setStatus(\"1\");\n\n            // ç”Ÿæˆè®¢å•ç¼–å·\n            String orderId = UUID.randomUUID().toString().replace(\"-\"ï¼Œ \"\");\n            orders.setOrderId(orderId);\n\n            // ä¿å­˜è®¢å•\n            ordersMapper.insert(orders);\n            // 4ã€ç”Ÿæˆå•†å“å¿«ç…§\n            for (ShoppingCartVO sc : list) {\n                int cnum = Integer.parseInt(sc.getCartNum());\n                String itemId = System.currentTimeMillis() + \"\" + (new Random().nextInt(89999) + 10000);\n                OrderItem orderItem = new OrderItem(itemId, orderId, sc.getProductId()ï¼Œ sc.getProductName()ï¼Œ sc.getProductImg()ï¼Œ sc.getSkuId()ï¼Œ\n                                                    sc.getSkuName()ï¼Œ BigDecimal.valueOf(sc.getSellPrice())ï¼Œ cnum, new BigDecimal(sc.getSellPrice() * cnum)ï¼Œ new Date()ï¼Œ new Date()ï¼Œ 0);\n                orderItemMapper.insert(orderItem);\n            }\n\n            // 5ã€æ‰£å‡åº“å­˜ï¼šæ ¹æ®å¥—é¤Idä¿®æ”¹å¥—é¤åº“å­˜é‡\n            for (ShoppingCartVO sc : list) {\n                String skuId = sc.getSkuId();\n                int newStock = sc.getSkuStock() - Integer.parseInt(sc.getCartNum());\n\n                ProductSku productSku = new ProductSku();\n                productSku.setSkuId(skuId);\n                productSku.setStock(newStock);\n                //æ ¹æ®ä¸»é”®æ¥ä¿®æ”¹å±æ€§å€¼\n                productSkuMapper.updateByPrimaryKeySelective(productSku);\n            }\n\n            // 6ã€åˆ é™¤è´­ç‰©è½¦ï¼šå½“è´­ç‰©è½¦ä¸­çš„è®°å½•è´­ä¹°æˆåŠŸä¹‹åï¼Œè´­ç‰©è½¦ä¸­å¯¹åº”åšåˆ é™¤æ“ä½œ\n            for (int cid : cidsList) {\n                shoppingCartMapper.deleteByPrimaryKey(cid);\n            }\n\n            // é‡Šæ”¾é”\n            for (String lockedSkuId : lockedSkuIds) {\n                String value = srt.boundValueOps(lockedSkuId).get();\n                if (value != null && value.equals(values.get(lockedSkuId))) {\n                    srt.delete(lockedSkuId);\n                }\n            }\n\n            log.info(\"add order finished... \");\n\n            map.put(\"orderId\"ï¼Œ orderId);\n            map.put(\"productNames\"ï¼Œ untitled);\n            return map;\n        } else {\n            // è¡¨ç¤ºåº“å­˜ä¸è¶³\n            return null;\n        }\n    } else {    // åŠ é”å¤±è´¥\n        // è¦å°†éƒ¨åˆ†é”å®šçš„skué‡Šæ”¾é”ï¼Œå³ä»Redisä¸­ç§»é™¤é”ä½çš„skuId\n        for (String lockedSkuId : lockedSkuIds) {\n            srt.delete(lockedSkuId);\n        }\n        return null;\n    }\n}\n```\n\n1. å¦‚æœè®¢å•ä¸­éƒ¨åˆ†å•†å“åŠ é”æˆåŠŸï¼Œä½†æ˜¯ç”±äºä¸€äº›å•†å“åŠ é”å¤±è´¥å¯¼è‡´æ— æ³•æäº¤è®¢å•ï¼Œæ­¤æ—¶è¦æ³¨æ„å°†åŠ é”çš„å•†å“æ¢å¤ï¼Œå³ä» Redis ä¸­ç§»é™¤è¯¥å•†å“\n\n\t> åœ¨ allLocked == false ä¸­ï¼Œé‡Šæ”¾åŠ é”çš„å•†å“\n\n2. ç¬¬ä¸€æ¬¡æ ¹æ® è´­ç‰©è½¦ Id æŸ¥åˆ°çš„è´­ç‰©è½¦è®°å½•ï¼ˆåŒ…å«å•†å“åº“å­˜ï¼‰åˆ°åŠ é”æäº¤è®¢å•ä¹‹å‰ï¼Œå¯èƒ½æœ‰åˆ«çš„çº¿ç¨‹ æ“ä½œäº†å…¶ä¸­æŸä¸ªå•†å“çš„åº“å­˜å¹¶æ“ä½œå®Œäº†ï¼Œä¸ºäº†é˜²æ­¢å½“å‰çº¿ç¨‹è¿˜å¯¹ä¹‹å‰åº“å­˜è¿›è¡Œä¿®æ”¹ï¼Œåº”å½“åœ¨åŠ é”åæ“ä½œå‰é‡æ–°æŸ¥è¯¢åº“å­˜ã€‚\n\n3. å½“å‰çº¿ç¨‹åŠ é”æˆåŠŸä¹‹åï¼Œåœ¨æ‰§è¡Œæ·»åŠ è®¢å•çš„è¿‡ç¨‹ä¸­å¦‚æœå‡ºç°äº†å¼‚å¸¸å¯¼è‡´æ— æ³•é‡Šæ”¾é”\n\n\t> å¯ä»¥åœ¨å¯¹å•†å“åŠ é”æ—¶è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œåˆ™åˆ°æœŸè‡ªåŠ¨é‡Šæ”¾é”\n\n4. æ¡£ç»™é”è®¾ç½®äº†è¿‡æœŸæ—¶é—´ä¹‹åï¼Œå¦‚æœå½“å‰çº¿ç¨‹ t1 å› ä¸ºç‰¹æ®ŠåŸå› ï¼Œåœ¨é”è¿‡æœŸä¹‹å‰æ²¡æœ‰å®Œæˆä¸šåŠ¡æ‰§è¡Œï¼Œé‡Šæ”¾æ‰äº†é”ï¼Œæ­¤æ—¶çº¿ç¨‹ t2 åŠ é”æˆåŠŸï¼Œå¦‚æœçº¿ç¨‹ t1 æ‰§è¡Œç»“æŸï¼Œå°†ä¼šé‡Šæ”¾ çº¿ç¨‹ t2 çš„é”ï¼Œå¯¼è‡´ çº¿ç¨‹ t2 åœ¨æ— é”çŠ¶æ€\n\n\t> å¯¹äºåŠ æˆåŠŸå¹¶æäº¤å®Œè®¢å•ä¹‹åï¼Œå¯¹å½“å‰å•†å“çš„é”é‡Šæ”¾ï¼Œè¦åˆ¤æ–­ Redis ä¸­çš„valueæ˜¯å¦å’Œè‡ªå·±è®°å½•çš„ç›¸åŒï¼Œå³æ˜¯å¦æ˜¯è‡ªå·±åŠ çš„é”\n\t>\n\t> ```java\n\t> // é‡Šæ”¾é”\n\t> for (String lockedSkuId : lockedSkuIds) {\n\t>    String value = srt.boundValueOps(lockedSkuId).get();\n\t>    if (values.get(lockedSkuId).equals(value)) {\n\t>      \tsrt.delete(lockedSkuId);\n\t>    }\n\t> }\n\t> ```\n\n5. å½“å‰çº¿ç¨‹ t1 åˆ¤æ–­æ˜¯è‡ªå·±åŠ çš„é”ï¼Œåœ¨å‡†å¤‡åˆ é™¤ä¹‹å‰ï¼Œé”è¿‡æœŸäº†å¹¶ä¸”è¢«å…¶ä»–çº¿ç¨‹ t2 æ‹¿åˆ°äº†æˆåŠŸåŠ é”ï¼Œè¿™æ—¶å€™çº¿ç¨‹ t1 ä¼šé‡Šæ”¾æ‰çº¿ç¨‹ t2 çš„é”ï¼ˆå¹¶å‘é‡å¾ˆå¤§ä»ç„¶éœ€è¦è€ƒè™‘ï¼‰\n\n\t> ä¿è¯ æŸ¥è¯¢é”æ˜¯å¦æ˜¯è‡ªå·±åŠ çš„å’Œåˆ é™¤è‡ªå·±åŠ çš„é” çš„åŸå­æ€§ï¼ˆä½¿ç”¨ lua è„šæœ¬ï¼Œè®©å¤šä¸ª Redis æ“ä½œå…·æœ‰åŸå­æ€§ï¼ŒæŸ¥è¯¢+åˆ é™¤ï¼‰\n\n6. ä½¿ç”¨çœ‹é—¨ç‹—çº¿ç¨‹è§£å†³çº¿ç¨‹ t1 é‡Šæ”¾ç›¸ä¹˜ t2 çš„é”çš„é—®é¢˜\n\n\t> çº¿ç¨‹t1 åŠ é”å¹¶è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œæ­¤æ—¶å¯åŠ¨ çœ‹é—¨ç‹—çº¿ç¨‹ï¼ˆå®ˆæŠ¤çº¿ç¨‹ï¼‰ç›‘æ§çº¿ç¨‹ t1è¿‡æœŸæ—¶é—´ï¼Œè¿‡æœŸæ—¶é—´è¦åˆ°äº†ä½†æ˜¯çº¿ç¨‹t1 ä¸šåŠ¡è¿˜åœ¨æ‰§è¡Œï¼Œåˆ™é‡ç½®è¿‡æœŸæ—¶é—´ï¼Œè¿™æ ·å¯ä»¥ä¿è¯ä¸šåŠ¡æ‰§è¡Œå®Œä¹‹å‰ä¸ä¼šé‡Šæ”¾é”\n\n### åˆ†å¸ƒå¼é”æ¡†æ¶ Resisson\n\n- æ·»åŠ ä¾èµ–\n\n\t```xml\n\t<!-- https://mvnrepository.com/artifact/org.redisson/redisson -->\n\t<dependency>\n\t    <groupId>org.redisson</groupId>\n\t    <artifactId>redisson</artifactId>\n\t    <version>3.16.7</version>\n\t</dependency>\n\t```\n\n- é…ç½® yaml æ–‡ä»¶\n\n\t```yaml\n\tredisson:\n\t  addr:\n\t    singleAddr:\n\t      host: Redis://47.110.247.63:6389\n\t      password: FYX123fyx.\n\t      database: 0\n\t```\n\n- é…ç½® RedissonClientï¼ˆä¹Ÿå¯ä»¥é…ç½®æˆé›†ç¾¤æ¨¡å¼ã€ä¸»ä»æ¨¡å¼ï¼‰\n\n\t```java\n\t@Configuration\n\tpublic class RedissonConfig {\n\t    @Value(\"${redisson.addr.singleAddr.host}\")\n\t    private String host;\n\t\n\t    @Value(\"${redisson.addr.singleAddr.password}\")\n\t    private String password;\n\t\n\t    @Value(\"${redisson.addr.singleAddr.database}\")\n\t    private int database;\n\t\n\t    @Bean\n\t    public RedissonClient redissonClient() {\n\t        Config config = new Config();\n\t        config.useSingleServer().setAddress(host)\n\t                .setPassword(password)\n\t                .setDatabase(database);\n\t        return Redisson.create(config);\n\t    }\n\t}\n\t```\n\n- æ“ä½œ\n\n\t```java\n\t@Transactional\n\t@Override\n\tpublic Map<String, String> addOrder(String cids, Orders orders) {\n\t    log.info(\"add order begin...\");\n\t\n\t    // 1ã€æ ¹æ®cidsæŸ¥è¯¢å½“å‰è®¢å•ä¸­å…³è”çš„è´­ç‰©è½¦è®°å½•è¯¦æƒ…ï¼ˆåŒ…æ‹¬åº“å­˜ï¼‰\n\t    String[] arr = cids.split(\"ï¼Œ\");\n\t    List<Integer> cidsList = new ArrayList<>();\n\t    for (String s : arr) {\n\t        cidsList.add(Integer.parseInt(s));\n\t    }\n\t    // è·å–æ‰€æœ‰skuId\n\t    List<ShoppingCartVO> list = shoppingCartMapper.selectShopCartByCids(cidsList);\n\t    List<String> lockedSkuIds = new ArrayList<>();\n\t    Map<String, RLock> locks = new HashMap<>(); // {\"1\":lock1, \"2\":lock2}\n\t    boolean allLocked = true;\n\t    for (ShoppingCartVO sc : list) {\n\t        String skuId = sc.getSkuId();\n\t        boolean b = false;\n\t        RLock lock = redissonClient.getLock(skuId);\n\t        try {\n\t            b = lock.tryLock(10, 3, TimeUnit.SECONDS);\n\t        } catch (InterruptedException e) {\n\t            e.printStackTrace();\n\t        }\n\t        if (!b) {\n\t            allLocked = false;\n\t            break;\n\t        } else {\n\t            lockedSkuIds.add(skuId);\n\t            locks.put(skuId, lock);\n\t        }\n\t    }\n\t\n\t    Map<String, String> map = null;\n\t    try {\n\t        if (allLocked) {\n\t            // 2ã€æ ¡éªŒåº“å­˜\n\t            list = shoppingCartMapper.selectShopCartByCids(cidsList);\n\t            boolean f = true;\n\t            StringBuilder sb = new StringBuilder();\n\t            for (ShoppingCartVO sc : list) {\n\t                if (Integer.parseInt(sc.getCartNum()) > sc.getSkuStock()) {\n\t                    f = false;\n\t                }\n\t                //è·å–æ‰€æœ‰å•†å“çš„åç§°ï¼Œä»¥é€—å·æ‹¼æ¥æˆå­—ç¬¦ä¸²\n\t                sb.append(sc.getProductName()).append(\"ï¼Œ\");\n\t            }\n\t            String untitled = sb.toString();\n\t\n\t            if (f) {\n\t                log.info(\"product stock is ok ... \");\n\t                // 3ã€è¡¨ç¤ºåº“å­˜å……è¶³----ä¿å­˜è®¢å•\n\t                // a.userId   b.untitled  c.æ”¶è´§äººä¿¡æ¯ï¼šå§“åã€ç”µè¯ã€åœ°å€\n\t                // d.æ€»ä»·æ ¼   e.æ”¯ä»˜æ–¹å¼   f.è®¢å•çš„åˆ›å»ºæ—¶é—´  g.è®¢å•åˆå§‹çŠ¶æ€\n\t                orders.setUntitled(untitled);\n\t                orders.setCreateTime(new Date());\n\t                orders.setStatus(\"1\");\n\t\n\t                // ç”Ÿæˆè®¢å•ç¼–å·\n\t                String orderId = UUID.randomUUID().toString().replace(\"-\"ï¼Œ \"\");\n\t                orders.setOrderId(orderId);\n\t\n\t                // ä¿å­˜è®¢å•\n\t                ordersMapper.insert(orders);\n\t                // 4ã€ç”Ÿæˆå•†å“å¿«ç…§\n\t                for (ShoppingCartVO sc : list) {\n\t                    int cnum = Integer.parseInt(sc.getCartNum());\n\t                    String itemId = System.currentTimeMillis() + \"\" + (new Random().nextInt(89999) + 10000);\n\t                    OrderItem orderItem = new OrderItem(itemId, orderId, sc.getProductId()ï¼Œ sc.getProductName()ï¼Œ sc.getProductImg()ï¼Œ sc.getSkuId()ï¼Œ\n\t                                                        sc.getSkuName()ï¼Œ BigDecimal.valueOf(sc.getSellPrice())ï¼Œ cnum, new BigDecimal(sc.getSellPrice() * cnum)ï¼Œ new Date()ï¼Œ new Date()ï¼Œ 0);\n\t                    orderItemMapper.insert(orderItem);\n\t                }\n\t\n\t                // 5ã€æ‰£å‡åº“å­˜ï¼šæ ¹æ®å¥—é¤Idä¿®æ”¹å¥—é¤åº“å­˜é‡\n\t                for (ShoppingCartVO sc : list) {\n\t                    String skuId = sc.getSkuId();\n\t                    int newStock = sc.getSkuStock() - Integer.parseInt(sc.getCartNum());\n\t\n\t                    ProductSku productSku = new ProductSku();\n\t                    productSku.setSkuId(skuId);\n\t                    productSku.setStock(newStock);\n\t                    //æ ¹æ®ä¸»é”®æ¥ä¿®æ”¹å±æ€§å€¼\n\t                    productSkuMapper.updateByPrimaryKeySelective(productSku);\n\t                }\n\t\n\t                // 6ã€åˆ é™¤è´­ç‰©è½¦ï¼šå½“è´­ç‰©è½¦ä¸­çš„è®°å½•è´­ä¹°æˆåŠŸä¹‹åï¼Œè´­ç‰©è½¦ä¸­å¯¹åº”åšåˆ é™¤æ“ä½œ\n\t                for (int cid : cidsList) {\n\t                    shoppingCartMapper.deleteByPrimaryKey(cid);\n\t                }\n\t\n\t                log.info(\"add order finished... \");\n\t\n\t                map = new HashMap<>();\n\t                map.put(\"orderId\"ï¼Œ orderId);\n\t                map.put(\"productNames\"ï¼Œ untitled);\n\t\n\t            }\n\t\n\t        }\n\t    } catch (Exception e) {\n\t        e.printStackTrace();\n\t    } finally {\n\t        // é‡Šæ”¾é”\n\t        for (String lockedSkuId : lockedSkuIds) {\n\t            locks.get(lockedSkuId).unlock();\n\t        }\n\t    }\n\t    return map;\n\t}\n\t```\n\n### åˆ†å¸ƒå¼é”ç‰¹ç‚¹\n\n1. äº’æ–¥æ€§\n\n\tä¿è¯åœ¨ä¸åŒèŠ‚ç‚¹é—´ä¸åŒçº¿ç¨‹çš„äº’æ–¥ï¼ˆåªæœ‰ä¸€ä¸ªèŠ‚ç‚¹å½“ç„¶å¯ä»¥ï¼‰\n\n2. å¯é‡å…¥æ€§\n\n\tåŒä¸€ä¸ªèŠ‚ç‚¹ä¸Šçš„åŒä¸€ä¸ªçº¿ç¨‹å¦‚æœè·å–é”ä¹‹åå¯ä»¥å†æ¬¡è·å–åˆ°è¿™ä¸ªé”\n\n3. é”è¶…æ—¶\n\n\tåŠ é”æˆåŠŸä¹‹åè®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œä»¥é˜²æ­¢çº¿ç¨‹æ•…éšœå¯¼è‡´ä¸é‡Šæ”¾é”è€Œå¼•èµ·æ­»é”\n\n4. é«˜æ•ˆã€é«˜å¯ç”¨\n\n\tæ”¯æŒå•èŠ‚ç‚¹ Redisã€ä¸»ä» Redisã€é›†ç¾¤ Redis\n\n5. æ”¯æŒé˜»å¡å’Œéé˜»å¡\n\n\ttryLock éé˜»å¡ å’Œ tryLock(long timeOut) é˜»å¡\n\n### Redisson çš„ä½¿ç”¨\n\n1. è·å–é”ï¼ˆå…¬å¹³é” / éå…¬å¹³é”ï¼‰\n\n\t```java\n\t// å…¬å¹³é”\n\tRLock lock = redissonClient.getFairLock(skuId);\n\t\n\t// éå…¬å¹³é”\n\tRLock lock = redissonClient.getLock(skuId);\n\t```\n\n2. åŠ é”ï¼ˆé˜»å¡é” / éé˜»å¡é”ï¼‰\n\n\t```java\n\t// é˜»å¡é”ï¼Œè®¾ç½®åŠ é”æˆåŠŸåçš„è¶…æ—¶æ—¶é—´ 20sï¼Œä¸åŠ æ—¶é—´é»˜è®¤ 30s\n\tlock.lock(20, TimeUnit.SECONDS);\n\t\n\t// éé˜»å¡é”ï¼ˆè®¾ç½®ç­‰å¾…æ—¶é—´ 3sï¼ŒåŠ é”æˆåŠŸåçš„è¶…æ—¶æ—¶é—´ 10sï¼Œä¸åŠ åˆ™é»˜è®¤ 30sï¼‰\n\tlock.tryLock(10, 3, TimeUnit.SECONDS);\n\t```\n\n3. é‡Šæ”¾é”\n\n\t```java\n\tlock.unlock();\n\t```\n\n4. å®ä¾‹\n\n\t```java\n\t// å…¬å¹³éé˜»å¡é”\n\tRLock lock = redissonClient.getLock(skuId);\n\tlock.tryLock(10, 3, TimeUnit.SECONDS);\n\t```\n\n***\n\n## ç¼“å­˜ä¸æ•°æ®åº“åŒå†™ä¸€è‡´æ€§\n\næ€»ç»“ï¼š\n\nè¯»æ•°æ®ï¼šå…ˆè¯»ç¼“å­˜ï¼Œå¦‚æœæœ‰ç›´æ¥è¿”å›ï¼Œå¦‚æœæ²¡æœ‰æŸ¥æ•°æ®åº“æŸ¥åˆ°æ•°æ®å­˜åˆ°ç¼“å­˜ä¸­å¹¶è¿”å›\n\nå†™æ•°æ®ï¼šå…ˆå†™æ•°æ®åº“ï¼Œå†åˆ ç¼“å­˜ï¼Œè¿™ä¸ªé˜¶æ®µå¯èƒ½åˆ ç¼“å­˜å¤±è´¥ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ä¸€ä¸‹ä¸‰ç§æ–¹æ¡ˆï¼š\n\n1. å¦‚æœåˆ é™¤ç¼“å­˜å¤±è´¥ï¼Œéœ€è¦å°†æ•°æ®å†™å…¥é‡è¯•è¡¨ï¼Œç„¶åä½¿ç”¨ elastic-job ç­‰å®šæ—¶ä»»åŠ¡è¿›è¡Œé‡è¯•ã€‚\n2. å¦‚æœåˆ é™¤ç¼“å­˜å¤±è´¥ï¼Œéœ€è¦å°†æ•°æ®å‘é€ mq æ¶ˆæ¯åˆ° mq æœåŠ¡å™¨ï¼Œåœ¨ mq çš„ consumer ä¸­å¤„ç†ã€‚\n3. è®¢é˜… mysql çš„ binlogï¼Œåœ¨è®¢é˜…è€…ä¸­ï¼Œå¦‚æœå‘ç°äº†æ›´æ–°æ•°æ®è¯·æ±‚ï¼Œåˆ™åˆ é™¤ç›¸åº”çš„ç¼“å­˜ã€‚\n\n> [å¦‚ä½•ä¿è¯æ•°æ®åº“å’Œç¼“å­˜åŒå†™ä¸€è‡´æ€§ï¼Ÿ-è‹ä¸‰è¯´æŠ€æœ¯](https://www.zhihu.com/question/319817091/answer/2432904728)\n\n### é—®é¢˜å¼•å…¥\n\né€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨ç¼“å­˜çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æå‡æŸ¥è¯¢çš„æ€§èƒ½ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ˜¯è¿™æ ·ä½¿ç”¨ç¼“å­˜çš„ï¼š\n\n![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650526232523.png)\n\n1. ç”¨æˆ·è¯·æ±‚è¿‡æ¥ä¹‹åï¼Œå…ˆæŸ¥ç¼“å­˜æœ‰æ²¡æœ‰æ•°æ®ï¼Œå¦‚æœæœ‰åˆ™ç›´æ¥è¿”å›ã€‚\n2. å¦‚æœç¼“å­˜æ²¡æ•°æ®ï¼Œå†ç»§ç»­æŸ¥æ•°æ®åº“ã€‚\n3. å¦‚æœæ•°æ®åº“æœ‰æ•°æ®ï¼Œåˆ™å°†æŸ¥è¯¢å‡ºæ¥çš„æ•°æ®ï¼Œæ”¾å…¥ç¼“å­˜ä¸­ï¼Œç„¶åè¿”å›è¯¥æ•°æ®ã€‚\n4. å¦‚æœæ•°æ®åº“ä¹Ÿæ²¡æ•°æ®ï¼Œåˆ™ç›´æ¥è¿”å›ç©ºã€‚\n\nè¿™æ˜¯ç¼“å­˜éå¸¸å¸¸è§çš„ç”¨æ³•ã€‚ä¸€çœ¼çœ‹ä¸Šå»ï¼Œå¥½åƒæ²¡æœ‰å•¥é—®é¢˜ã€‚\n\nä½†ä½ å¿½ç•¥äº†ä¸€ä¸ªéå¸¸é‡è¦çš„ç»†èŠ‚ï¼š**å¦‚æœæ•°æ®åº“ä¸­çš„æŸæ¡æ•°æ®ï¼Œæ”¾å…¥ç¼“å­˜ä¹‹åï¼Œåˆç«‹é©¬è¢«æ›´æ–°äº†ï¼Œé‚£ä¹ˆè¯¥å¦‚ä½•æ›´æ–°ç¼“å­˜å‘¢ï¼Ÿ**\n\nä¸æ›´æ–°ç¼“å­˜è¡Œä¸è¡Œï¼Ÿ\n\nç­”ï¼šå½“ç„¶ä¸è¡Œï¼Œå¦‚æœä¸æ›´æ–°ç¼“å­˜ï¼Œåœ¨å¾ˆé•¿çš„ä¸€æ®µæ—¶é—´å†…ï¼ˆå†³å®šäºç¼“å­˜çš„è¿‡æœŸæ—¶é—´ï¼‰ï¼Œç”¨æˆ·è¯·æ±‚ä»ç¼“å­˜ä¸­è·å–åˆ°çš„éƒ½å¯èƒ½æ˜¯æ—§å€¼ï¼Œè€Œéæ•°æ®åº“çš„æœ€æ–°å€¼ã€‚è¿™ä¸æ˜¯æœ‰æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ï¼Ÿ\n\né‚£ä¹ˆï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•æ›´æ–°ç¼“å­˜å‘¢ï¼Ÿ\n\nç›®å‰æœ‰ä»¥ä¸‹ 4 ç§æ–¹æ¡ˆï¼š\n\n1. å…ˆå†™ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“\n2. å…ˆå†™æ•°æ®åº“ï¼Œå†å†™ç¼“å­˜\n3. å…ˆåˆ ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“\n4. å…ˆå†™æ•°æ®åº“ï¼Œå†åˆ ç¼“å­˜\n\næ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¯¦ç»†è¯´è¯´è¿™ 4 ç§æ–¹æ¡ˆã€‚\n\n### å…ˆå†™ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“\n\nå¯¹äºæ›´æ–°ç¼“å­˜çš„æ–¹æ¡ˆï¼Œå¾ˆå¤šäººç¬¬ä¸€ä¸ªæƒ³åˆ°çš„å¯èƒ½æ˜¯åœ¨å†™æ“ä½œä¸­ç›´æ¥æ›´æ–°ç¼“å­˜ï¼ˆå†™ç¼“å­˜ï¼‰ï¼Œæ›´ç›´æ¥æ˜äº†ã€‚\n\né‚£ä¹ˆï¼Œé—®é¢˜æ¥äº†ï¼šåœ¨å†™æ“ä½œä¸­ï¼Œåˆ°åº•æ˜¯å…ˆå†™ç¼“å­˜ï¼Œè¿˜æ˜¯å…ˆå†™æ•°æ®åº“å‘¢ï¼Ÿ\n\næˆ‘ä»¬åœ¨è¿™é‡Œå…ˆèŠèŠå…ˆå†™ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“çš„æƒ…å†µï¼Œå› ä¸ºå®ƒçš„é—®é¢˜æœ€ä¸¥é‡ã€‚\n\n![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650526427819.png)\n\næŸä¸€ä¸ªç”¨æˆ·çš„æ¯ä¸€æ¬¡å†™æ“ä½œï¼Œå¦‚æœåˆšå†™å®Œç¼“å­˜ï¼Œçªç„¶ç½‘ç»œå‡ºç°äº†å¼‚å¸¸ï¼Œå¯¼è‡´å†™æ•°æ®åº“å¤±è´¥äº†ã€‚\n\n![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650526436447.png)\n\nå…¶ç»“æœæ˜¯ç¼“å­˜æ›´æ–°æˆäº†æœ€æ–°æ•°æ®ï¼Œä½†æ•°æ®åº“æ²¡æœ‰ï¼Œè¿™æ ·ç¼“å­˜ä¸­çš„æ•°æ®ä¸å°±å˜æˆè„æ•°æ®äº†ï¼Ÿå¦‚æœæ­¤æ—¶è¯¥ç”¨æˆ·çš„æŸ¥è¯¢è¯·æ±‚ï¼Œæ­£å¥½è¯»å–åˆ°è¯¥æ•°æ®ï¼Œå°±ä¼šå‡ºç°é—®é¢˜ï¼Œå› ä¸ºè¯¥æ•°æ®åœ¨æ•°æ®åº“ä¸­æ ¹æœ¬ä¸å­˜åœ¨ï¼Œè¿™ä¸ªé—®é¢˜éå¸¸ä¸¥é‡ã€‚\n\næˆ‘ä»¬éƒ½çŸ¥é“ï¼Œç¼“å­˜çš„ä¸»è¦ç›®çš„æ˜¯æŠŠæ•°æ®åº“çš„æ•°æ®ä¸´æ—¶ä¿å­˜åœ¨å†…å­˜ï¼Œä¾¿äºåç»­çš„æŸ¥è¯¢ï¼Œæå‡æŸ¥è¯¢é€Ÿåº¦ã€‚\n\nä½†å¦‚æœæŸæ¡æ•°æ®ï¼Œåœ¨æ•°æ®åº“ä¸­éƒ½ä¸å­˜åœ¨ï¼Œä½ ç¼“å­˜è¿™ç§â€œ`å‡æ•°æ®`â€åˆæœ‰å•¥æ„ä¹‰å‘¢ï¼Ÿ\n\nå› æ­¤ï¼Œå…ˆå†™ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“çš„æ–¹æ¡ˆæ˜¯ä¸å¯å–çš„ï¼Œåœ¨å®é™…å·¥ä½œä¸­ç”¨å¾—ä¸å¤šã€‚\n\n### å…ˆå†™æ•°æ®åº“ï¼Œå†å†™ç¼“å­˜\n\n![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650526499487.png)\n\nç”¨æˆ·çš„å†™æ“ä½œï¼Œå…ˆå†™æ•°æ®åº“ï¼Œå†å†™ç¼“å­˜ï¼Œå¯ä»¥é¿å…ä¹‹å‰â€œå‡æ•°æ®â€çš„é—®é¢˜ã€‚ä½†å®ƒå´å¸¦æ¥äº†æ–°çš„é—®é¢˜ã€‚\n\n#### å†™ç¼“å­˜å¤±è´¥äº†\n\nå¦‚æœæŠŠå†™æ•°æ®åº“å’Œå†™ç¼“å­˜æ“ä½œï¼Œæ”¾åœ¨åŒä¸€ä¸ªäº‹åŠ¡å½“ä¸­ï¼Œå½“å†™ç¼“å­˜å¤±è´¥äº†ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå†™å…¥æ•°æ®åº“çš„æ•°æ®è¿›è¡Œå›æ»šã€‚\n\n![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650526558901.png)\n\nå¦‚æœæ˜¯å¹¶å‘é‡æ¯”è¾ƒå°ï¼Œå¯¹æ¥å£æ€§èƒ½è¦æ±‚ä¸å¤ªé«˜çš„ç³»ç»Ÿï¼Œå¯ä»¥è¿™ä¹ˆç©ã€‚\n\nä½†å¦‚æœåœ¨é«˜å¹¶å‘çš„ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œå†™æ•°æ®åº“å’Œå†™ç¼“å­˜ï¼Œéƒ½å±äºè¿œç¨‹æ“ä½œã€‚ä¸ºäº†é˜²æ­¢å‡ºç°å¤§äº‹åŠ¡ï¼Œé€ æˆçš„æ­»é”é—®é¢˜ï¼Œé€šå¸¸å»ºè®®å†™æ•°æ®åº“å’Œå†™ç¼“å­˜ä¸è¦æ”¾åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ã€‚\n\nä¹Ÿå°±æ˜¯è¯´åœ¨è¯¥æ–¹æ¡ˆä¸­ï¼Œå¦‚æœå†™æ•°æ®åº“æˆåŠŸäº†ï¼Œä½†å†™ç¼“å­˜å¤±è´¥äº†ï¼Œæ•°æ®åº“ä¸­å·²å†™å…¥çš„æ•°æ®ä¸ä¼šå›æ»šã€‚\n\nè¿™å°±ä¼šå‡ºç°ï¼šæ•°æ®åº“æ˜¯`æ–°æ•°æ®`ï¼Œè€Œç¼“å­˜æ˜¯`æ—§æ•°æ®`ï¼Œä¸¤è¾¹`æ•°æ®ä¸ä¸€è‡´`çš„æƒ…å†µã€‚\n\n#### é«˜å¹¶å‘ä¸‹çš„é—®é¢˜\n\nå‡è®¾åœ¨é«˜å¹¶å‘çš„åœºæ™¯ä¸­ï¼Œé’ˆå¯¹åŒä¸€ä¸ªç”¨æˆ·çš„åŒä¸€æ¡æ•°æ®ï¼Œæœ‰ä¸¤ä¸ªå†™æ•°æ®è¯·æ±‚ï¼ša å’Œ bï¼Œå®ƒä»¬åŒæ—¶è¯·æ±‚åˆ°ä¸šåŠ¡ç³»ç»Ÿã€‚\n\nå…¶ä¸­è¯·æ±‚ a è·å–çš„æ˜¯æ—§æ•°æ®ï¼Œè€Œè¯·æ±‚ b è·å–çš„æ˜¯æ–°æ•°æ®ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n\n![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650526645914.png)\n\n1. è¯·æ±‚ a å…ˆè¿‡æ¥ï¼Œåˆšå†™å®Œäº†æ•°æ®åº“ã€‚ä½†ç”±äºç½‘ç»œåŸå› ï¼Œå¡é¡¿äº†ä¸€ä¸‹ï¼Œè¿˜æ²¡æ¥å¾—åŠå†™ç¼“å­˜ã€‚\n2. è¿™æ—¶å€™è¯·æ±‚ b è¿‡æ¥äº†ï¼Œå…ˆå†™äº†æ•°æ®åº“ã€‚\n3. æ¥ä¸‹æ¥ï¼Œè¯·æ±‚ b é¡ºåˆ©å†™äº†ç¼“å­˜ã€‚\n4. æ­¤æ—¶ï¼Œè¯·æ±‚ a å¡é¡¿ç»“æŸï¼Œä¹Ÿå†™äº†ç¼“å­˜ã€‚\n\nå¾ˆæ˜¾ç„¶ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹å½“ä¸­ï¼Œè¯·æ±‚ b åœ¨ç¼“å­˜ä¸­çš„`æ–°æ•°æ®`ï¼Œè¢«è¯·æ±‚ a çš„`æ—§æ•°æ®`è¦†ç›–äº†ã€‚\n\nä¹Ÿå°±æ˜¯è¯´ï¼šåœ¨é«˜å¹¶å‘åœºæ™¯ä¸­ï¼Œå¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶æ‰§è¡Œå…ˆå†™æ•°æ®åº“ï¼Œå†å†™ç¼“å­˜çš„æ“ä½œï¼Œå¯èƒ½ä¼šå‡ºç°æ•°æ®åº“æ˜¯æ–°å€¼ï¼Œè€Œç¼“å­˜ä¸­æ˜¯æ—§å€¼ï¼Œä¸¤è¾¹æ•°æ®ä¸ä¸€è‡´çš„æƒ…å†µã€‚\n\n#### æµªè´¹ç³»ç»Ÿèµ„æº\n\næœ‰äº›ä¸šåŠ¡åœºæ™¯æ¯”è¾ƒç‰¹æ®Šï¼š`å†™å¤šè¯»å°‘`ã€‚\n\nå¦‚æœåœ¨è¿™ç±»ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œæ¯ä¸ªç”¨çš„å†™æ“ä½œï¼Œéƒ½éœ€è¦å†™ä¸€æ¬¡ç¼“å­˜ï¼Œæœ‰ç‚¹å¾—ä¸å¿å¤±ã€‚\n\nè¿˜ä¸å¦‚ä¸ç”¨ Redisï¼Œåæ­£å†™æ•°æ®åº“éƒ½è¦å†™ï¼Œæˆ‘è¯»æ•°æ®åˆæ¯”è¾ƒå°‘ï¼ŒRedis ä½¿ç”¨é¢‘ç‡ä½ï¼Œå´è¿˜è¦ä¸€ç›´æ›´æ–° Redis ä¸­æ•°æ®ã€‚\n\n### å…ˆåˆ ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“\n\nä¸ç„¶æ˜¯å…ˆå†™ç¼“å­˜è¿˜æ˜¯å…ˆå†™æ•°æ®åº“éƒ½æœ‰å¾ˆå¤šé—®é¢˜ï¼Œé‚£ä¹ˆè€ƒè™‘ä¸æ˜¯ `æ›´æ–°ç¼“å­˜` è€Œæ˜¯ `åˆ é™¤ç¼“å­˜`ã€‚\n\n![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650526855730.png)\n\nåœ¨ç”¨æˆ·çš„å†™æ“ä½œä¸­ï¼Œå…ˆæ‰§è¡Œåˆ é™¤ç¼“å­˜æ“ä½œï¼Œå†å»å†™æ•°æ®åº“\n\n#### é«˜å¹¶å‘ä¸‹çš„é—®é¢˜\n\nå‡è®¾åœ¨é«˜å¹¶å‘çš„åœºæ™¯ä¸­ï¼ŒåŒä¸€ä¸ªç”¨æˆ·çš„åŒä¸€æ¡æ•°æ®ï¼Œæœ‰ä¸€ä¸ªè¯»æ•°æ®è¯·æ±‚ cï¼Œè¿˜æœ‰å¦ä¸€ä¸ªå†™æ•°æ®è¯·æ±‚ dï¼ˆä¸€ä¸ªæ›´æ–°æ“ä½œï¼‰ï¼ŒåŒæ—¶è¯·æ±‚åˆ°ä¸šåŠ¡ç³»ç»Ÿã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n\n![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650527043982.png)\n\n1. è¯·æ±‚ d å…ˆè¿‡æ¥ï¼ŒæŠŠç¼“å­˜åˆ é™¤äº†ã€‚ä½†ç”±äºç½‘ç»œåŸå› ï¼Œå¡é¡¿äº†ä¸€ä¸‹ï¼Œè¿˜æ²¡æ¥å¾—åŠå†™æ•°æ®åº“ã€‚\n2. è¿™æ—¶è¯·æ±‚ c è¿‡æ¥äº†ï¼Œå…ˆæŸ¥ç¼“å­˜å‘ç°æ²¡æ•°æ®ï¼Œå†æŸ¥æ•°æ®åº“ï¼Œæœ‰æ•°æ®ï¼Œä½†æ˜¯æ—§å€¼ã€‚\n3. è¯·æ±‚ c å°†æ•°æ®åº“ä¸­çš„æ—§å€¼ï¼Œæ›´æ–°åˆ°ç¼“å­˜ä¸­ã€‚\n4. æ­¤æ—¶ï¼Œè¯·æ±‚ d å¡é¡¿ç»“æŸï¼ŒæŠŠæ–°å€¼å†™å…¥æ•°æ®åº“ã€‚\n\nåœ¨è¿™ä¸ªè¿‡ç¨‹å½“ä¸­ï¼Œè¯·æ±‚ d çš„æ–°å€¼å¹¶æ²¡æœ‰è¢«è¯·æ±‚ c å†™å…¥ç¼“å­˜ï¼ŒåŒæ ·ä¼šå¯¼è‡´ç¼“å­˜å’Œæ•°æ®åº“çš„æ•°æ®ä¸ä¸€è‡´çš„æƒ…å†µã€‚\n\n#### ç¼“å­˜åŒåˆ \n\nåœ¨ä¸Šé¢çš„ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œä¸€ä¸ªè¯»æ•°æ®è¯·æ±‚ï¼Œä¸€ä¸ªå†™æ•°æ®è¯·æ±‚ã€‚å½“å†™æ•°æ®è¯·æ±‚æŠŠç¼“å­˜åˆ äº†ä¹‹åï¼Œè¯»æ•°æ®è¯·æ±‚ï¼Œå¯èƒ½æŠŠå½“æ—¶ä»æ•°æ®åº“æŸ¥è¯¢å‡ºæ¥çš„æ—§å€¼ï¼Œå†™å…¥ç¼“å­˜å½“ä¸­ã€‚\n\næœ‰äººè¯´è¿˜ä¸å¥½åŠï¼Œè¯·æ±‚ d åœ¨å†™å®Œæ•°æ®åº“ä¹‹åï¼ŒæŠŠç¼“å­˜é‡æ–°åˆ ä¸€æ¬¡ä¸å°±è¡Œäº†ï¼Ÿ\n\n![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650528097218.png)\n\nè¿™å°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„`ç¼“å­˜åŒåˆ `ï¼Œå³åœ¨å†™æ•°æ®åº“ä¹‹å‰åˆ é™¤ä¸€æ¬¡ï¼Œå†™å®Œæ•°æ®åº“åï¼Œå†åˆ é™¤ä¸€æ¬¡ã€‚\n\nè¯¥æ–¹æ¡ˆæœ‰ä¸ªéå¸¸å…³é”®çš„åœ°æ–¹æ˜¯ï¼šç¬¬äºŒæ¬¡åˆ é™¤ç¼“å­˜ï¼Œå¹¶éç«‹é©¬å°±åˆ ï¼Œè€Œæ˜¯è¦åœ¨ä¸€å®šçš„`æ—¶é—´é—´éš”`ä¹‹åã€‚\n\næˆ‘ä»¬å†é‡æ–°å›é¡¾ä¸€ä¸‹ï¼Œé«˜å¹¶å‘ä¸‹ä¸€ä¸ªè¯»æ•°æ®è¯·æ±‚ï¼Œä¸€ä¸ªå†™æ•°æ®è¯·æ±‚å¯¼è‡´æ•°æ®ä¸ä¸€è‡´çš„äº§ç”Ÿè¿‡ç¨‹ï¼š\n\n1. è¯·æ±‚ d å…ˆè¿‡æ¥ï¼ŒæŠŠç¼“å­˜åˆ é™¤äº†ã€‚ä½†ç”±äºç½‘ç»œåŸå› ï¼Œå¡é¡¿äº†ä¸€ä¸‹ï¼Œè¿˜æ²¡æ¥å¾—åŠå†™æ•°æ®åº“ã€‚\n2. è¿™æ—¶è¯·æ±‚ c è¿‡æ¥äº†ï¼Œå…ˆæŸ¥ç¼“å­˜å‘ç°æ²¡æ•°æ®ï¼Œå†æŸ¥æ•°æ®åº“ï¼Œæœ‰æ•°æ®ï¼Œä½†æ˜¯æ—§å€¼ã€‚\n3. è¯·æ±‚ c å°†æ•°æ®åº“ä¸­çš„æ—§å€¼ï¼Œæ›´æ–°åˆ°ç¼“å­˜ä¸­ã€‚\n4. æ­¤æ—¶ï¼Œè¯·æ±‚ d å¡é¡¿ç»“æŸï¼ŒæŠŠæ–°å€¼å†™å…¥æ•°æ®åº“ã€‚\n5. ä¸€æ®µæ—¶é—´ä¹‹åï¼Œæ¯”å¦‚ï¼š500msï¼Œè¯·æ±‚ d å°†ç¼“å­˜åˆ é™¤ã€‚\n\nè¿™æ ·æ¥çœ‹ç¡®å®å¯ä»¥è§£å†³ç¼“å­˜ä¸ä¸€è‡´é—®é¢˜ã€‚\n\né‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆä¸€å®šè¦é—´éš”ä¸€æ®µæ—¶é—´ä¹‹åï¼Œæ‰èƒ½åˆ é™¤ç¼“å­˜å‘¢ï¼Ÿ\n\nè¯·æ±‚ d å¡é¡¿ç»“æŸï¼ŒæŠŠæ–°å€¼å†™å…¥æ•°æ®åº“åï¼Œè¯·æ±‚ c å°†æ•°æ®åº“ä¸­çš„æ—§å€¼ï¼Œæ›´æ–°åˆ°ç¼“å­˜ä¸­ã€‚\n\næ­¤æ—¶ï¼Œå¦‚æœè¯·æ±‚ d åˆ é™¤å¤ªå¿«ï¼Œåœ¨è¯·æ±‚ c å°†æ•°æ®åº“ä¸­çš„æ—§å€¼æ›´æ–°åˆ°ç¼“å­˜ä¹‹å‰ï¼Œå°±å·²ç»æŠŠç¼“å­˜åˆ é™¤äº†ï¼Œè¿™æ¬¡åˆ é™¤å°±æ²¡ä»»ä½•æ„ä¹‰ã€‚å¿…é¡»è¦åœ¨è¯·æ±‚ c æ›´æ–°ç¼“å­˜ä¹‹åï¼Œå†åˆ é™¤ç¼“å­˜ï¼Œæ‰èƒ½æŠŠæ—§å€¼åŠæ—¶åˆ é™¤äº†ã€‚\n\næ‰€ä»¥éœ€è¦åœ¨è¯·æ±‚ d ä¸­åŠ ä¸€ä¸ªæ—¶é—´é—´éš”ï¼Œç¡®ä¿è¯·æ±‚ cï¼Œæˆ–è€…ç±»ä¼¼äºè¯·æ±‚ c çš„å…¶ä»–è¯·æ±‚ï¼Œå¦‚æœåœ¨ç¼“å­˜ä¸­è®¾ç½®äº†æ—§å€¼ï¼Œæœ€ç»ˆéƒ½èƒ½å¤Ÿè¢«è¯·æ±‚ d åˆ é™¤æ‰ã€‚\n\næ¥ä¸‹æ¥ï¼Œè¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœç¬¬äºŒæ¬¡åˆ é™¤ç¼“å­˜æ—¶ï¼Œåˆ é™¤å¤±è´¥äº†è¯¥æ€ä¹ˆåŠï¼Ÿ\n\n### å…ˆå†™æ•°æ®åº“ï¼Œå†åˆ ç¼“å­˜\n\n![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650528137396.png)\n\nåœ¨é«˜å¹¶å‘çš„åœºæ™¯ä¸­ï¼Œæœ‰ä¸€ä¸ªè¯»æ•°æ®è¯·æ±‚ï¼Œæœ‰ä¸€ä¸ªå†™æ•°æ®è¯·æ±‚ï¼Œæ›´æ–°è¿‡ç¨‹å¦‚ä¸‹ï¼š\n\n1. è¯·æ±‚ e å…ˆå†™æ•°æ®åº“ï¼Œç”±äºç½‘ç»œåŸå› å¡é¡¿äº†ä¸€ä¸‹ï¼Œæ²¡æœ‰æ¥å¾—åŠåˆ é™¤ç¼“å­˜ã€‚\n2. è¯·æ±‚ f æŸ¥è¯¢ç¼“å­˜ï¼Œå‘ç°ç¼“å­˜ä¸­æœ‰æ•°æ®ï¼Œç›´æ¥è¿”å›è¯¥æ•°æ®ã€‚\n3. è¯·æ±‚ e åˆ é™¤ç¼“å­˜ã€‚\n\nåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œåªæœ‰è¯·æ±‚ f è¯»äº†ä¸€æ¬¡æ—§æ•°æ®ï¼Œåæ¥æ—§æ•°æ®è¢«è¯·æ±‚ e åŠæ—¶åˆ é™¤äº†ï¼Œçœ‹èµ·æ¥é—®é¢˜ä¸å¤§ã€‚\n\nä½†å¦‚æœæ˜¯è¯»æ•°æ®è¯·æ±‚å…ˆè¿‡æ¥å‘¢ï¼Ÿ\n\n1. è¯·æ±‚ f æŸ¥è¯¢ç¼“å­˜ï¼Œå‘ç°ç¼“å­˜ä¸­æœ‰æ•°æ®ï¼Œç›´æ¥è¿”å›è¯¥æ•°æ®ã€‚\n2. è¯·æ±‚ e å…ˆå†™æ•°æ®åº“ã€‚\n3. è¯·æ±‚ e åˆ é™¤ç¼“å­˜ã€‚\n\nè¿™ç§æƒ…å†µçœ‹èµ·æ¥ä¹Ÿæ²¡é—®é¢˜å‘€ï¼Ÿ\n\nç­”ï¼šå¯¹çš„ã€‚\n\nä½†å°±æ€•å‡ºç°ä¸‹é¢è¿™ç§æƒ…å†µï¼Œå³ç¼“å­˜è‡ªå·±å¤±æ•ˆäº†ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n\n![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650528267733.png)\n\n1. ç¼“å­˜è¿‡æœŸæ—¶é—´åˆ°äº†ï¼Œè‡ªåŠ¨å¤±æ•ˆã€‚\n2. è¯·æ±‚ f æŸ¥è¯¢ç¼“å­˜ï¼Œå‘ç¼“å­˜ä¸­æ²¡æœ‰æ•°æ®ï¼ŒæŸ¥è¯¢æ•°æ®åº“çš„æ—§å€¼ï¼Œä½†ç”±äºç½‘ç»œåŸå› å¡é¡¿äº†ï¼Œæ²¡æœ‰æ¥å¾—åŠæ›´æ–°ç¼“å­˜ã€‚\n3. è¯·æ±‚ e å…ˆå†™æ•°æ®åº“ï¼Œæ¥ç€åˆ é™¤äº†ç¼“å­˜ã€‚\n4. è¯·æ±‚ f æ›´æ–°æ—§å€¼åˆ°ç¼“å­˜ä¸­ã€‚\n\nè¿™æ—¶ï¼Œç¼“å­˜å’Œæ•°æ®åº“çš„æ•°æ®åŒæ ·å‡ºç°ä¸ä¸€è‡´çš„æƒ…å†µäº†ã€‚\n\nä½†è¿™ç§æƒ…å†µè¿˜æ˜¯æ¯”è¾ƒå°‘çš„ï¼Œéœ€è¦åŒæ—¶æ»¡è¶³ä»¥ä¸‹æ¡ä»¶æ‰å¯ä»¥ï¼š\n\n1. ç¼“å­˜åˆšå¥½è‡ªåŠ¨å¤±æ•ˆã€‚\n2. è¯·æ±‚ f ä»æ•°æ®åº“æŸ¥å‡ºæ—§å€¼ï¼Œæ›´æ–°ç¼“å­˜çš„è€—æ—¶ï¼Œæ¯”è¯·æ±‚ e å†™æ•°æ®åº“ï¼Œå¹¶ä¸”åˆ é™¤ç¼“å­˜çš„è¿˜é•¿ã€‚\n\næˆ‘ä»¬éƒ½çŸ¥é“æŸ¥è¯¢æ•°æ®åº“çš„é€Ÿåº¦ï¼Œä¸€èˆ¬æ¯”å†™æ•°æ®åº“è¦å¿«ï¼Œæ›´ä½•å†µå†™å®Œæ•°æ®åº“ï¼Œè¿˜è¦åˆ é™¤ç¼“å­˜ã€‚æ‰€ä»¥ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå†™æ•°æ®è¯·æ±‚æ¯”è¯»æ•°æ®æƒ…å†µè€—æ—¶æ›´é•¿ã€‚\n\nç”±æ­¤å¯è§ï¼Œç³»ç»ŸåŒæ—¶æ»¡è¶³ä¸Šè¿°ä¸¤ä¸ªæ¡ä»¶çš„æ¦‚ç‡éå¸¸å°ã€‚\n\n> æ¨èå¤§å®¶ä½¿ç”¨å…ˆå†™æ•°æ®åº“ï¼Œå†åˆ ç¼“å­˜çš„æ–¹æ¡ˆï¼Œè™½è¯´ä¸èƒ½100%é¿å…æ•°æ®ä¸ä¸€è‡´é—®é¢˜ï¼Œä½†å‡ºç°è¯¥é—®é¢˜çš„æ¦‚ç‡ï¼Œç›¸å¯¹äºå…¶ä»–æ–¹æ¡ˆæ¥è¯´æ˜¯æœ€å°çš„ã€‚\n\nä½†åœ¨è¯¥æ–¹æ¡ˆä¸­ï¼Œå¦‚æœåˆ é™¤ç¼“å­˜å¤±è´¥äº†è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ\n\n### åˆ ç¼“å­˜å¤±è´¥æ€ä¹ˆåŠï¼Ÿ\n\nå…¶å®å…ˆå†™æ•°æ®åº“ï¼Œå†åˆ ç¼“å­˜çš„æ–¹æ¡ˆï¼Œè·Ÿç¼“å­˜åŒåˆ çš„æ–¹æ¡ˆä¸€æ ·ï¼Œæœ‰ä¸€ä¸ªå…±åŒçš„é£é™©ç‚¹ï¼Œå³ï¼šå¦‚æœç¼“å­˜åˆ é™¤å¤±è´¥äº†ï¼Œä¹Ÿä¼šå¯¼è‡´ç¼“å­˜å’Œæ•°æ®åº“çš„æ•°æ®ä¸ä¸€è‡´ã€‚\n\né‚£ä¹ˆï¼Œåˆ é™¤ç¼“å­˜å¤±è´¥æ€ä¹ˆåŠå‘¢ï¼Ÿ\n\nç­”ï¼šéœ€è¦åŠ `é‡è¯•æœºåˆ¶`ã€‚\n\nåœ¨æ¥å£ä¸­å¦‚æœæ›´æ–°äº†æ•°æ®åº“æˆåŠŸäº†ï¼Œä½†æ›´æ–°ç¼“å­˜å¤±è´¥äº†ï¼Œå¯ä»¥ç«‹åˆ»é‡è¯• 3 æ¬¡ã€‚å¦‚æœå…¶ä¸­æœ‰ä»»ä½•ä¸€æ¬¡æˆåŠŸï¼Œåˆ™ç›´æ¥è¿”å›æˆåŠŸã€‚å¦‚æœ 3 æ¬¡éƒ½å¤±è´¥äº†ï¼Œåˆ™å†™å…¥æ•°æ®åº“ï¼Œå‡†å¤‡åç»­å†å¤„ç†ã€‚\n\nå½“ç„¶ï¼Œå¦‚æœä½ åœ¨æ¥å£ä¸­ç›´æ¥`åŒæ­¥é‡è¯•`ï¼Œè¯¥æ¥å£å¹¶å‘é‡æ¯”è¾ƒé«˜çš„æ—¶å€™ï¼Œå¯èƒ½æœ‰ç‚¹å½±å“æ¥å£æ€§èƒ½ã€‚\n\nè¿™æ—¶ï¼Œå°±éœ€è¦æ”¹æˆ`å¼‚æ­¥é‡è¯•`äº†ã€‚\n\nå¼‚æ­¥é‡è¯•æ–¹å¼æœ‰å¾ˆå¤šç§ï¼Œæ¯”å¦‚ï¼š\n\n1. æ¯æ¬¡éƒ½å•ç‹¬èµ·ä¸€ä¸ªçº¿ç¨‹ï¼Œè¯¥çº¿ç¨‹ä¸“é—¨åšé‡è¯•çš„å·¥ä½œã€‚ä½†å¦‚æœåœ¨é«˜å¹¶å‘çš„åœºæ™¯ä¸‹ï¼Œå¯èƒ½ä¼šåˆ›å»ºå¤ªå¤šçš„çº¿ç¨‹ï¼Œå¯¼è‡´ç³»ç»Ÿ OOM é—®é¢˜ï¼Œä¸å¤ªå»ºè®®ä½¿ç”¨ã€‚\n2. å°†é‡è¯•çš„ä»»åŠ¡äº¤ç»™çº¿ç¨‹æ± å¤„ç†ï¼Œä½†å¦‚æœæœåŠ¡å™¨é‡å¯ï¼Œéƒ¨åˆ†æ•°æ®å¯èƒ½ä¼šä¸¢å¤±ã€‚\n3. å°†é‡è¯•æ•°æ®å†™è¡¨ï¼Œç„¶åä½¿ç”¨ elastic-job ç­‰å®šæ—¶ä»»åŠ¡è¿›è¡Œé‡è¯•ã€‚\n4. å°†é‡è¯•çš„è¯·æ±‚å†™å…¥ mq ç­‰æ¶ˆæ¯ä¸­é—´ä»¶ä¸­ï¼Œåœ¨ mq çš„ consumer ä¸­å¤„ç†ã€‚\n5. è®¢é˜… mysql çš„ binlogï¼Œåœ¨è®¢é˜…è€…ä¸­ï¼Œå¦‚æœå‘ç°äº†æ›´æ–°æ•°æ®è¯·æ±‚ï¼Œåˆ™åˆ é™¤ç›¸åº”çš„ç¼“å­˜ã€‚\n\n#### å®šæ—¶ä»»åŠ¡\n\nä½¿ç”¨`å®šæ—¶ä»»åŠ¡é‡è¯•`çš„å…·ä½“æ–¹æ¡ˆå¦‚ä¸‹ï¼š\n\n1. å½“ç”¨æˆ·æ“ä½œå†™å®Œæ•°æ®åº“ï¼Œä½†åˆ é™¤ç¼“å­˜å¤±è´¥äº†ï¼Œéœ€è¦å°†ç”¨æˆ·æ•°æ®å†™å…¥é‡è¯•è¡¨ä¸­ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n\n\t![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650528474531.png)\n\n2. åœ¨å®šæ—¶ä»»åŠ¡ä¸­ï¼Œå¼‚æ­¥è¯»å–é‡è¯•è¡¨ä¸­çš„ç”¨æˆ·æ•°æ®ã€‚é‡è¯•è¡¨éœ€è¦è®°å½•ä¸€ä¸ªé‡è¯•æ¬¡æ•°å­—æ®µï¼Œåˆå§‹å€¼ä¸º 0ã€‚ç„¶åé‡è¯• 5 æ¬¡ï¼Œä¸æ–­åˆ é™¤ç¼“å­˜ï¼Œæ¯é‡è¯•ä¸€æ¬¡è¯¥å­—æ®µå€¼+1ã€‚å¦‚æœå…¶ä¸­æœ‰ä»»æ„ä¸€æ¬¡æˆåŠŸäº†ï¼Œåˆ™è¿”å›æˆåŠŸã€‚å¦‚æœé‡è¯•äº† 5 æ¬¡ï¼Œè¿˜æ˜¯å¤±è´¥ï¼Œåˆ™æˆ‘ä»¬éœ€è¦åœ¨é‡è¯•è¡¨ä¸­è®°å½•ä¸€ä¸ªå¤±è´¥çš„çŠ¶æ€ï¼Œç­‰å¾…åç»­è¿›ä¸€æ­¥å¤„ç†ã€‚\n\n\t![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650528480542.png)\n\n3. åœ¨é«˜å¹¶å‘åœºæ™¯ä¸­ï¼Œå®šæ—¶ä»»åŠ¡æ¨èä½¿ç”¨`elastic-job`ã€‚ç›¸å¯¹äº xxl-job ç­‰å®šæ—¶ä»»åŠ¡ï¼Œå®ƒå¯ä»¥åˆ†ç‰‡å¤„ç†ï¼Œæå‡å¤„ç†é€Ÿåº¦ã€‚åŒæ—¶æ¯ç‰‡çš„é—´éš”å¯ä»¥è®¾ç½®æˆï¼š1,2,3,5,7 ç§’ç­‰ã€‚\n\nä½¿ç”¨å®šæ—¶ä»»åŠ¡é‡è¯•çš„è¯ï¼Œæœ‰ä¸ªç¼ºç‚¹å°±æ˜¯å®æ—¶æ€§æ²¡é‚£ä¹ˆé«˜ï¼Œå¯¹äºå®æ—¶æ€§è¦æ±‚ç‰¹åˆ«é«˜çš„ä¸šåŠ¡åœºæ™¯ï¼Œè¯¥æ–¹æ¡ˆä¸å¤ªé€‚ç”¨ã€‚ä½†æ˜¯å¯¹äºä¸€èˆ¬åœºæ™¯ï¼Œè¿˜æ˜¯å¯ä»¥ç”¨ä¸€ç”¨çš„ã€‚\n\nä½†å®ƒæœ‰ä¸€ä¸ªå¾ˆå¤§çš„ä¼˜ç‚¹ï¼Œå³æ•°æ®æ˜¯è½åº“çš„ï¼Œä¸ä¼šä¸¢æ•°æ®ã€‚\n\n#### mq\n\nåœ¨é«˜å¹¶å‘çš„ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œmqï¼ˆæ¶ˆæ¯é˜Ÿåˆ—ï¼‰æ˜¯å¿…ä¸å¯å°‘çš„æŠ€æœ¯ä¹‹ä¸€ã€‚å®ƒä¸ä»…å¯ä»¥å¼‚æ­¥è§£è€¦ï¼Œè¿˜èƒ½å‰Šå³°å¡«è°·ã€‚å¯¹ä¿è¯ç³»ç»Ÿçš„ç¨³å®šæ€§æ˜¯éå¸¸æœ‰æ„ä¹‰çš„ã€‚\n\nmq çš„ç”Ÿäº§è€…ï¼Œç”Ÿäº§äº†æ¶ˆæ¯ä¹‹åï¼Œé€šè¿‡æŒ‡å®šçš„ topic å‘é€åˆ° mq æœåŠ¡å™¨ã€‚ç„¶å mq çš„æ¶ˆè´¹è€…ï¼Œè®¢é˜…è¯¥ topic çš„æ¶ˆæ¯ï¼Œè¯»å–æ¶ˆæ¯æ•°æ®ä¹‹åï¼Œåšä¸šåŠ¡é€»è¾‘å¤„ç†ã€‚\n\nä½¿ç”¨`mqé‡è¯•`çš„å…·ä½“æ–¹æ¡ˆå¦‚ä¸‹ï¼š\n\n![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650528506474.png)\n\n1. å½“ç”¨æˆ·æ“ä½œå†™å®Œæ•°æ®åº“ï¼Œä½†åˆ é™¤ç¼“å­˜å¤±è´¥äº†ï¼Œäº§ç”Ÿä¸€æ¡ mq æ¶ˆæ¯ï¼Œå‘é€ç»™ mq æœåŠ¡å™¨ã€‚\n2. mq æ¶ˆè´¹è€…è¯»å– mq æ¶ˆæ¯ï¼Œé‡è¯• 5 æ¬¡åˆ é™¤ç¼“å­˜ã€‚å¦‚æœå…¶ä¸­æœ‰ä»»æ„ä¸€æ¬¡æˆåŠŸäº†ï¼Œåˆ™è¿”å›æˆåŠŸã€‚å¦‚æœé‡è¯•äº† 5 æ¬¡ï¼Œè¿˜æ˜¯å¤±è´¥ï¼Œåˆ™å†™å…¥`æ­»ä¿¡é˜Ÿåˆ—`ä¸­ã€‚\n3. æ¨è mq ä½¿ç”¨`rocketmq`ï¼Œé‡è¯•æœºåˆ¶å’Œæ­»ä¿¡é˜Ÿåˆ—é»˜è®¤æ˜¯æ”¯æŒçš„ã€‚ä½¿ç”¨èµ·æ¥éå¸¸æ–¹ä¾¿ï¼Œè€Œä¸”è¿˜æ”¯æŒé¡ºåºæ¶ˆæ¯ï¼Œå»¶è¿Ÿæ¶ˆæ¯å’Œäº‹åŠ¡æ¶ˆæ¯ç­‰å¤šç§ä¸šåŠ¡åœºæ™¯ã€‚\n\nå½“ç„¶åœ¨è¯¥æ–¹æ¡ˆä¸­ï¼Œåˆ é™¤ç¼“å­˜å¯ä»¥å®Œå…¨èµ°å¼‚æ­¥ã€‚å³ç”¨æˆ·çš„å†™æ“ä½œï¼Œåœ¨å†™å®Œæ•°æ®åº“ä¹‹åï¼Œä¸ç”¨ç«‹åˆ»åˆ é™¤ä¸€æ¬¡ç¼“å­˜ã€‚è€Œç›´æ¥å‘é€ mq æ¶ˆæ¯ï¼Œåˆ° mq æœåŠ¡å™¨ï¼Œç„¶åæœ‰ mq æ¶ˆè´¹è€…å…¨æƒè´Ÿè´£åˆ é™¤ç¼“å­˜çš„ä»»åŠ¡ã€‚\n\nå› ä¸º mq çš„å®æ—¶æ€§è¿˜æ˜¯æ¯”è¾ƒé«˜çš„ï¼Œå› æ­¤æ”¹è‰¯åçš„æ–¹æ¡ˆä¹Ÿæ˜¯ä¸€ç§ä¸é”™çš„é€‰æ‹©ã€‚\n\n#### binlog\n\nå‰é¢æˆ‘ä»¬èŠè¿‡çš„ï¼Œæ— è®ºæ˜¯å®šæ—¶ä»»åŠ¡ï¼Œè¿˜æ˜¯ mqï¼ˆæ¶ˆæ¯é˜Ÿåˆ—ï¼‰ï¼Œåšé‡è¯•æœºåˆ¶ï¼Œå¯¹ä¸šåŠ¡éƒ½æœ‰ä¸€å®šçš„ä¾µå…¥æ€§ã€‚\n\nåœ¨ä½¿ç”¨å®šæ—¶ä»»åŠ¡çš„æ–¹æ¡ˆä¸­ï¼Œéœ€è¦åœ¨ä¸šåŠ¡ä»£ç ä¸­å¢åŠ é¢å¤–é€»è¾‘ï¼Œå¦‚æœåˆ é™¤ç¼“å­˜å¤±è´¥ï¼Œéœ€è¦å°†æ•°æ®å†™å…¥é‡è¯•è¡¨ã€‚\n\nè€Œä½¿ç”¨ mq çš„æ–¹æ¡ˆä¸­ï¼Œå¦‚æœåˆ é™¤ç¼“å­˜å¤±è´¥äº†ï¼Œéœ€è¦åœ¨ä¸šåŠ¡ä»£ç ä¸­å‘é€ mq æ¶ˆæ¯åˆ° mq æœåŠ¡å™¨ã€‚\n\nå…¶å®ï¼Œè¿˜æœ‰ä¸€ç§æ›´ä¼˜é›…çš„å®ç°ï¼Œå³`ç›‘å¬binlog`ï¼Œæ¯”å¦‚ä½¿ç”¨ï¼š`canal`ç­‰ä¸­é—´ä»¶ã€‚\n\nå…·ä½“æ–¹æ¡ˆå¦‚ä¸‹ï¼š\n\n![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650528533430.png)\n\n1. åœ¨ä¸šåŠ¡æ¥å£ä¸­å†™æ•°æ®åº“ä¹‹åï¼Œå°±ä¸ç®¡äº†ï¼Œç›´æ¥è¿”å›æˆåŠŸã€‚\n2. mysql æœåŠ¡å™¨ä¼šè‡ªåŠ¨æŠŠå˜æ›´çš„æ•°æ®å†™å…¥ binlog ä¸­ã€‚\n3. binlog è®¢é˜…è€…è·å–å˜æ›´çš„æ•°æ®ï¼Œç„¶ååˆ é™¤ç¼“å­˜ã€‚\n\nè¿™å¥—æ–¹æ¡ˆä¸­ä¸šåŠ¡æ¥å£ç¡®å®ç®€åŒ–äº†ä¸€äº›æµç¨‹ï¼Œåªç”¨å…³å¿ƒæ•°æ®åº“æ“ä½œå³å¯ï¼Œè€Œåœ¨ binlog è®¢é˜…è€…ä¸­åšç¼“å­˜åˆ é™¤å·¥ä½œã€‚\n\nä½†å¦‚æœåªæ˜¯æŒ‰ç…§å›¾ä¸­çš„æ–¹æ¡ˆè¿›è¡Œåˆ é™¤ç¼“å­˜ï¼Œåªåˆ é™¤äº†ä¸€æ¬¡ï¼Œä¹Ÿå¯èƒ½ä¼šå¤±è´¥ã€‚\n\nå¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ\n\nç­”ï¼šè¿™å°±éœ€è¦åŠ ä¸Šå‰é¢èŠè¿‡çš„`é‡è¯•æœºåˆ¶`äº†ã€‚å¦‚æœåˆ é™¤ç¼“å­˜å¤±è´¥ï¼Œå†™å…¥é‡è¯•è¡¨ï¼Œä½¿ç”¨å®šæ—¶ä»»åŠ¡é‡è¯•ã€‚æˆ–è€…å†™å…¥ mqï¼Œè®© mq è‡ªåŠ¨é‡è¯•ã€‚\n\nåœ¨è¿™é‡Œæ¨èä½¿ç”¨`mqè‡ªåŠ¨é‡è¯•æœºåˆ¶`ã€‚\n\n![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650528538202.png)\n\nåœ¨ binlog è®¢é˜…è€…ä¸­å¦‚æœåˆ é™¤ç¼“å­˜å¤±è´¥ï¼Œåˆ™å‘é€ä¸€æ¡ mq æ¶ˆæ¯åˆ° mq æœåŠ¡å™¨ï¼Œåœ¨ mq æ¶ˆè´¹è€…ä¸­è‡ªåŠ¨é‡è¯• 5 æ¬¡ã€‚å¦‚æœæœ‰ä»»æ„ä¸€æ¬¡æˆåŠŸï¼Œåˆ™ç›´æ¥è¿”å›æˆåŠŸã€‚å¦‚æœé‡è¯• 5 æ¬¡åè¿˜æ˜¯å¤±è´¥ï¼Œåˆ™è¯¥æ¶ˆæ¯è‡ªåŠ¨è¢«æ”¾å…¥æ­»ä¿¡é˜Ÿåˆ—ï¼Œåé¢å¯èƒ½éœ€è¦äººå·¥ä»‹å…¥ã€‚\n\n***\n\n## Redis çº¿ç¨‹æ¨¡å‹\n\n### å•çº¿ç¨‹çš„Redisä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«\n\n1. çº¯å†…å­˜æ“ä½œ\n\n2. å•çº¿ç¨‹æ“ä½œï¼Œé¿å…äº†é¢‘ç¹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢\n\n3. é‡‡ç”¨äº†éé˜»å¡ I/O å¤šè·¯å¤ç”¨æœºåˆ¶\n\n### Redis ä¸ºä»€ä¹ˆæ˜¯å•çº¿ç¨‹çš„\n\nå®˜æ–¹ FAQ è¡¨ç¤ºï¼Œå› ä¸º Redis æ˜¯åŸºäºå†…å­˜çš„æ“ä½œï¼ŒCPU ä¸æ˜¯ Redis çš„ç“¶é¢ˆï¼ŒRedis çš„ç“¶é¢ˆæœ€æœ‰å¯èƒ½æ˜¯æœºå™¨å†…å­˜çš„å¤§å°æˆ–è€…ç½‘ç»œå¸¦å®½ã€‚\n\næ—¢ç„¶å•çº¿ç¨‹å®¹æ˜“å®ç°ï¼Œè€Œä¸” CPU ä¸ä¼šæˆä¸ºç“¶é¢ˆï¼Œé‚£å°±é¡ºç†æˆç« åœ°é‡‡ç”¨å•çº¿ç¨‹çš„æ–¹æ¡ˆäº†ï¼ˆæ¯•ç«Ÿé‡‡ç”¨å¤šçº¿ç¨‹ä¼šæœ‰å¾ˆå¤šéº»çƒ¦ï¼‰ã€‚Redis åˆ©ç”¨é˜Ÿåˆ—å°†å¹¶å‘è®¿é—®å˜ä¸ºä¸²è¡Œè®¿é—®\n\n1ã€ç»å¤§éƒ¨åˆ†è¯·æ±‚æ˜¯çº¯ç²¹çš„å†…å­˜æ“ä½œï¼ˆéå¸¸å¿«é€Ÿï¼‰\n\n2ã€é‡‡ç”¨å•çº¿ç¨‹ï¼Œé¿å…äº†ä¸å¿…è¦çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œç«äº‰æ¡ä»¶\n\n3ã€éé˜»å¡ IO ä¼˜ç‚¹ï¼š\n\n- é€Ÿåº¦å¿«ï¼Œå› ä¸ºæ•°æ®å­˜åœ¨å†…å­˜ä¸­ï¼Œç±»ä¼¼äº HashMapï¼ŒHashMap çš„ä¼˜åŠ¿å°±æ˜¯æŸ¥æ‰¾å’Œæ“ä½œçš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ O(1)\n- æ”¯æŒä¸°å¯Œæ•°æ®ç±»å‹ï¼Œæ”¯æŒ stringï¼Œlistï¼Œsetï¼Œsorted setï¼Œhash\n- æ”¯æŒäº‹åŠ¡ï¼Œæ“ä½œéƒ½æ˜¯åŸå­æ€§ï¼Œæ‰€è°“çš„åŸå­æ€§å°±æ˜¯å¯¹æ•°æ®çš„æ›´æ”¹è¦ä¹ˆå…¨éƒ¨æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ¨ä¸æ‰§è¡Œ\n- ä¸°å¯Œçš„ç‰¹æ€§ï¼šå¯ç”¨äºç¼“å­˜ï¼Œæ¶ˆæ¯ï¼ŒæŒ‰ key è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œè¿‡æœŸåå°†ä¼šè‡ªåŠ¨åˆ é™¤å¦‚ä½•è§£å†³ Redis çš„å¹¶å‘ç«äº‰ key é—®é¢˜\n\n**åŒæ—¶æœ‰å¤šä¸ªå­ç³»ç»Ÿå»setä¸€ä¸ªkeyã€‚è¿™ä¸ªæ—¶å€™è¦æ³¨æ„ä»€ä¹ˆå‘¢ï¼Ÿ**\n\nä¸æ¨èä½¿ç”¨ Redis çš„äº‹åŠ¡æœºåˆ¶ã€‚å› ä¸ºæˆ‘ä»¬çš„ç”Ÿäº§ç¯å¢ƒï¼ŒåŸºæœ¬éƒ½æ˜¯ Redis é›†ç¾¤ç¯å¢ƒï¼Œåšäº†æ•°æ®åˆ†ç‰‡æ“ä½œã€‚ä½ ä¸€ä¸ªäº‹åŠ¡ä¸­æœ‰æ¶‰åŠåˆ°å¤šä¸ª key æ“ä½œçš„æ—¶å€™ï¼Œè¿™å¤šä¸ª key ä¸ä¸€å®šéƒ½å­˜å‚¨åœ¨åŒä¸€ä¸ª Redis-server ä¸Šã€‚å› æ­¤ï¼ŒRedis çš„äº‹åŠ¡æœºåˆ¶ï¼Œååˆ†é¸¡è‚‹ã€‚\n\n- å¦‚æœå¯¹è¿™ä¸ª key æ“ä½œï¼Œä¸è¦æ±‚é¡ºåºï¼šå‡†å¤‡ä¸€ä¸ªåˆ†å¸ƒå¼é”ï¼Œå¤§å®¶å»æŠ¢é”ï¼ŒæŠ¢åˆ°é”å°±åš set æ“ä½œå³å¯\n- å¦‚æœå¯¹è¿™ä¸ª key æ“ä½œï¼Œè¦æ±‚é¡ºåºï¼šåˆ†å¸ƒå¼é”+æ—¶é—´æˆ³ã€‚å‡è®¾è¿™ä¼šç³»ç»Ÿ B å…ˆæŠ¢åˆ°é”ï¼Œå°† key1 è®¾ç½®ä¸º{valueB 3:05}ã€‚æ¥ä¸‹æ¥ç³»ç»Ÿ A æŠ¢åˆ°é”ï¼Œå‘ç°è‡ªå·±çš„ valueA çš„æ—¶é—´æˆ³æ—©äºç¼“å­˜ä¸­çš„æ—¶é—´æˆ³ï¼Œé‚£å°±ä¸åš set æ“ä½œäº†ã€‚ä»¥æ­¤ç±»æ¨ã€‚\n- åˆ©ç”¨é˜Ÿåˆ—ï¼Œå°† set æ–¹æ³•å˜æˆä¸²è¡Œè®¿é—®ä¹Ÿå¯ä»¥ Redis é‡åˆ°é«˜å¹¶å‘ï¼Œå¦‚æœä¿è¯è¯»å†™ key çš„ä¸€è‡´æ€§\n\nå¯¹ Redis çš„æ“ä½œéƒ½æ˜¯å…·æœ‰åŸå­æ€§çš„ï¼Œæ˜¯çº¿ç¨‹å®‰å…¨çš„æ“ä½œï¼Œä½ ä¸ç”¨è€ƒè™‘å¹¶å‘é—®é¢˜,Redis å†…éƒ¨å·²ç»å¸®ä½ å¤„ç†å¥½å¹¶å‘çš„é—®é¢˜äº†ã€‚\n\n### ä¸ºä»€ä¹ˆRedisçš„æ“ä½œæ˜¯åŸå­æ€§çš„ï¼Œæ€ä¹ˆä¿è¯åŸå­æ€§çš„ï¼Ÿ\n\nå¯¹äº Redis è€Œè¨€ï¼Œå‘½ä»¤çš„åŸå­æ€§æŒ‡çš„æ˜¯ï¼šä¸€ä¸ªæ“ä½œçš„ä¸å¯ä»¥å†åˆ†ï¼Œæ“ä½œè¦ä¹ˆæ‰§è¡Œï¼Œè¦ä¹ˆä¸æ‰§è¡Œã€‚\n\nRedis çš„æ“ä½œä¹‹æ‰€ä»¥æ˜¯åŸå­æ€§çš„ï¼Œæ˜¯å› ä¸º Redis æ˜¯å•çº¿ç¨‹çš„ã€‚ï¼ˆRedis æ–°ç‰ˆæœ¬å·²ç»å¼•å…¥å¤šçº¿ç¨‹ï¼Œè¿™é‡ŒåŸºäºæ—§ç‰ˆæœ¬çš„ Redisï¼‰\n\nRedis æœ¬èº«æä¾›çš„æ‰€æœ‰ API éƒ½æ˜¯åŸå­æ“ä½œï¼ŒRedis ä¸­çš„äº‹åŠ¡å…¶å®æ˜¯è¦ä¿è¯æ‰¹é‡æ“ä½œçš„åŸå­æ€§ã€‚\n\nå¤šä¸ªå‘½ä»¤åœ¨å¹¶å‘ä¸­ä¹Ÿæ˜¯åŸå­æ€§çš„å—ï¼Ÿ\n\nä¸ä¸€å®šï¼Œ å°† get å’Œ set æ”¹æˆå•å‘½ä»¤æ“ä½œï¼Œincr ã€‚ä½¿ç”¨ Redis çš„äº‹åŠ¡ï¼Œæˆ–è€…ä½¿ç”¨ Redis+Lua çš„æ–¹å¼å®ç°.\n\n### è®²è§£ä¸‹Redisçº¿ç¨‹æ¨¡å‹\n\næ–‡ä»¶äº‹ä»¶å¤„ç†å™¨åŒ…æ‹¬åˆ†åˆ«æ˜¯å¥—æ¥å­—ã€ I/O å¤šè·¯å¤ç”¨ç¨‹åºã€ æ–‡ä»¶äº‹ä»¶åˆ†æ´¾å™¨ï¼ˆdispatcherï¼‰ã€ ä»¥åŠäº‹ä»¶å¤„ç†å™¨ã€‚ä½¿ç”¨ I/O å¤šè·¯å¤ç”¨ç¨‹åºæ¥åŒæ—¶ç›‘å¬å¤šä¸ªå¥—æ¥å­—ï¼Œ å¹¶æ ¹æ®å¥—æ¥å­—ç›®å‰æ‰§è¡Œçš„ä»»åŠ¡æ¥ä¸ºå¥—æ¥å­—å…³è”ä¸åŒçš„äº‹ä»¶å¤„ç†å™¨ã€‚\n\nå½“è¢«ç›‘å¬çš„å¥—æ¥å­—å‡†å¤‡å¥½æ‰§è¡Œè¿æ¥åº”ç­”ï¼ˆacceptï¼‰ã€è¯»å–ï¼ˆreadï¼‰ã€å†™å…¥ï¼ˆwriteï¼‰ã€å…³é—­ï¼ˆcloseï¼‰ç­‰æ“ä½œæ—¶ï¼Œ ä¸æ“ä½œç›¸å¯¹åº”çš„æ–‡ä»¶äº‹ä»¶å°±ä¼šäº§ç”Ÿï¼Œ è¿™æ—¶æ–‡ä»¶äº‹ä»¶å¤„ç†å™¨å°±ä¼šè°ƒç”¨å¥—æ¥å­—ä¹‹å‰å…³è”å¥½çš„äº‹ä»¶å¤„ç†å™¨æ¥å¤„ç†è¿™äº›äº‹ä»¶ã€‚\n\nI/O å¤šè·¯å¤ç”¨ç¨‹åºè´Ÿè´£ç›‘å¬å¤šä¸ªå¥—æ¥å­—ï¼Œ å¹¶å‘æ–‡ä»¶äº‹ä»¶åˆ†æ´¾å™¨ä¼ é€é‚£äº›äº§ç”Ÿäº†äº‹ä»¶çš„å¥—æ¥å­—ã€‚\n\n**å·¥ä½œåŸç†ï¼š**\n\nI/O å¤šè·¯å¤ç”¨ç¨‹åºè´Ÿè´£ç›‘å¬å¤šä¸ªå¥—æ¥å­—ï¼Œ å¹¶å‘æ–‡ä»¶äº‹ä»¶åˆ†æ´¾å™¨ä¼ é€é‚£äº›äº§ç”Ÿäº†äº‹ä»¶çš„å¥—æ¥å­—ã€‚\n\nå°½ç®¡å¤šä¸ªæ–‡ä»¶äº‹ä»¶å¯èƒ½ä¼šå¹¶å‘åœ°å‡ºç°ï¼Œ ä½† I/O å¤šè·¯å¤ç”¨ç¨‹åºæ€»æ˜¯ä¼šå°†æ‰€æœ‰äº§ç”Ÿäº‹ä»¶çš„å¥—æ¥å­—éƒ½å…¥é˜Ÿåˆ°ä¸€ä¸ªé˜Ÿåˆ—é‡Œé¢ï¼Œ ç„¶åé€šè¿‡è¿™ä¸ªé˜Ÿåˆ—ï¼Œ ä»¥æœ‰åºï¼ˆsequentiallyï¼‰ã€åŒæ­¥ï¼ˆsynchronouslyï¼‰ã€æ¯æ¬¡ä¸€ä¸ªå¥—æ¥å­—çš„æ–¹å¼å‘æ–‡ä»¶äº‹ä»¶åˆ†æ´¾å™¨ä¼ é€å¥—æ¥å­—ï¼š\n\nå½“ä¸Šä¸€ä¸ªå¥—æ¥å­—äº§ç”Ÿçš„äº‹ä»¶è¢«å¤„ç†å®Œæ¯•ä¹‹åï¼ˆè¯¥å¥—æ¥å­—ä¸ºäº‹ä»¶æ‰€å…³è”çš„äº‹ä»¶å¤„ç†å™¨æ‰§è¡Œå®Œæ¯•ï¼‰ï¼Œ I/O å¤šè·¯å¤ç”¨ç¨‹åºæ‰ä¼šç»§ç»­å‘æ–‡ä»¶äº‹ä»¶åˆ†æ´¾å™¨ä¼ é€ä¸‹ä¸€ä¸ªå¥—æ¥å­—ã€‚å¦‚æœä¸€ä¸ªå¥—æ¥å­—åˆå¯è¯»åˆå¯å†™çš„è¯ï¼Œ é‚£ä¹ˆæœåŠ¡å™¨å°†å…ˆè¯»å¥—æ¥å­—ï¼Œ åå†™å¥—æ¥å­—ã€‚\n\n## å…¶ä»–å‚è€ƒ\n\n[åŸåˆ› ä¸€æ´º [é˜¿é‡Œå¼€å‘è€…](javascript:void(0);) 2022-03-24 08:00](https://mp.weixin.qq.com/s?__biz=MzIzOTU0NTQ0MA==&mid=2247507942&idx=1&sn=e00fd16ec56d0e10cc830678ee25c417&chksm=e92ae2e9de5d6bff6d227646c12685a5c45a4c3322e2186954555a14ebcd9510e8ae579a4941&mpshare=1&scene=24&srcid=0324gng7YtX5XX0z9bf7aObR&sharer_sharetime=1648080975816&sharer_shareid=ebfad4e5798246e3d3928c1f4ee9048e#rd)\n\nhttps://blog.csdn.net/qq_31387317/category_7391502.html\n","source":"_posts/Javaå…«è‚¡æ–‡-Redis.md","raw":"---\ntitle: Javaå…«è‚¡æ–‡ - Redis\ncopyright: true\nmathjax: false\ncategories:\n  - Javaå…«è‚¡æ–‡\ndate: 2023-01-25 13:43:59\ntags:\ntoc: true\nurlname: Redis\n---\n\n> æ•´ç†çš„ Redis ç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½\t<!--more-->\n\n## ä»€ä¹ˆæ˜¯NoSQLï¼Ÿ\n\nNoSQL = not only sqlï¼ˆä¸ä»…ä»…æ˜¯ SQLï¼‰\n\nå…³ç³»å‹æ•°æ®åº“ï¼šåˆ—+è¡Œï¼ŒåŒä¸€ä¸ªè¡¨ä¸‹æ•°æ®çš„ç»“æ„æ˜¯ä¸€æ ·çš„ã€‚\n\néå…³ç³»å‹æ•°æ®åº“ï¼šæ•°æ®å­˜å‚¨æ²¡æœ‰å›ºå®šçš„æ ¼å¼ï¼Œå¹¶ä¸”å¯ä»¥è¿›è¡Œæ¨ªå‘æ‰©å±•ã€‚\n\nNoSQL æ³›æŒ‡éå…³ç³»å‹æ•°æ®åº“ï¼Œéšç€ web2.0 äº’è”ç½‘çš„è¯ç”Ÿï¼Œä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“å¾ˆéš¾å¯¹ä»˜ web2.0 å¤§æ•°æ®æ—¶ä»£ã€‚å°¤å…¶æ˜¯è¶…å¤§è§„æ¨¡çš„é«˜å¹¶å‘çš„ç¤¾åŒºï¼Œæš´éœ²å‡ºæ¥å¾ˆå¤šéš¾ä»¥å…‹æœçš„é—®é¢˜ï¼ŒNoSQL åœ¨å½“ä»Šå¤§æ•°æ®ç¯å¢ƒä¸‹å‘å±•çš„ååˆ†è¿…é€Ÿï¼ŒRedis æ˜¯å‘å±•æœ€å¿«çš„ã€‚\n\nä¼ ç»Ÿ RDBMSï¼ˆå…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼‰å’Œ NoSQLï¼ˆéå…³ç³»å‹æ•°æ®åº“ï¼‰æ¯”è¾ƒï¼š\n\nRDBMSï¼š\n - ç»„ç»‡åŒ–ç»“æ„\n - å›ºå®š SQL\n - æ•°æ®å’Œå…³ç³»éƒ½å­˜åœ¨å•ç‹¬çš„è¡¨ä¸­ï¼ˆè¡Œåˆ—ï¼‰\n - DMLï¼ˆæ•°æ®æ“ä½œè¯­è¨€ï¼‰ã€DDLï¼ˆæ•°æ®å®šä¹‰è¯­è¨€ï¼‰ç­‰\n - ä¸¥æ ¼çš„ä¸€è‡´æ€§ï¼ˆACIDï¼‰ï¼šåŸå­æ€§ã€ä¸€è‡´æ€§ã€éš”ç¦»æ€§ã€æŒä¹…æ€§\n - åŸºç¡€çš„äº‹åŠ¡\n\nNoSQLï¼š\n - ä¸ä»…ä»…æ˜¯æ•°æ®\n - æ²¡æœ‰å›ºå®šæŸ¥è¯¢è¯­è¨€\n - é”®å€¼å¯¹å­˜å‚¨ï¼ˆRedisï¼‰ã€åˆ—å­˜å‚¨ï¼ˆHBaseï¼‰ã€æ–‡æ¡£å­˜å‚¨ï¼ˆMongoDBï¼‰ã€å›¾å½¢æ•°æ®åº“ï¼ˆä¸æ˜¯å­˜å›¾å½¢ï¼Œæ”¾çš„æ˜¯å…³ç³»ï¼‰ï¼ˆNeo4jï¼‰\n - æœ€ç»ˆä¸€è‡´æ€§ï¼ˆBASEï¼‰ï¼šåŸºæœ¬å¯ç”¨ã€è½¯çŠ¶æ€/æŸ”æ€§äº‹åŠ¡ã€æœ€ç»ˆä¸€è‡´æ€§\n\n***\n\n## Redisæ˜¯ä»€ä¹ˆï¼Ÿ\n\n### å®šä¹‰\n\nRedis = Remote Dictionary Serverï¼Œå³è¿œç¨‹å­—å…¸æœåŠ¡ã€‚\n\nRedis æ˜¯ä¸€ä¸ªç”¨ C è¯­è¨€å¼€å‘çš„ã€åŸºäºå†…å­˜ç»“æ„è¿›è¡Œ**é”®å€¼å¯¹**æ•°æ®å­˜å‚¨çš„ã€é«˜æ€§èƒ½çš„ã€éå…³ç³»å‹ NoSQL æ•°æ®åº“\n\n### ä¼˜ç¼ºç‚¹\n\n**çº¯å†…å­˜æ“ä½œï¼Œæ€§èƒ½éå¸¸å‡ºè‰²**ï¼Œæ¯ç§’å¯ä»¥å¤„ç†è¶…è¿‡ 10 ä¸‡æ¬¡è¯»å†™æ“ä½œï¼Œæ˜¯å·²çŸ¥æ€§èƒ½æœ€å¿«çš„ Key-Value DBã€‚æ”¯æŒä¿å­˜å¤šç§æ•°æ®ç»“æ„ï¼Œå¯ä»¥ç”¨æ¥å®ç°å¾ˆå¤šæœ‰ç”¨çš„åŠŸèƒ½ã€‚\n\nRedis çš„ä¸»è¦ç¼ºç‚¹æ˜¯**æ•°æ®åº“å®¹é‡å—åˆ°ç‰©ç†å†…å­˜çš„é™åˆ¶ï¼Œä¸èƒ½ç”¨ä½œæµ·é‡æ•°æ®çš„é«˜æ€§èƒ½è¯»å†™**ï¼Œå› æ­¤ Redis é€‚åˆçš„åœºæ™¯ä¸»è¦å±€é™åœ¨è¾ƒå°æ•°æ®é‡çš„é«˜æ€§èƒ½æ“ä½œå’Œè¿ç®—ä¸Šã€‚\n\n### ä¸ºä»€ä¹ˆè¦ç”¨ç¼“å­˜\n\n**1ã€ é«˜æ€§èƒ½ï¼š**\n\nå‡å¦‚ç”¨æˆ·ç¬¬ä¸€æ¬¡è®¿é—®æ•°æ®åº“ä¸­çš„æŸäº›æ•°æ®ã€‚è¿™ä¸ªè¿‡ç¨‹ä¼šæ¯”è¾ƒæ…¢ï¼Œå› ä¸ºæ˜¯ä»ç¡¬ç›˜ä¸Šè¯»å–çš„ã€‚å°†è¯¥ç”¨æˆ·è®¿é—®çš„æ•°æ®å­˜åœ¨æ•°ç¼“å­˜ä¸­ï¼Œè¿™æ ·ä¸‹ä¸€æ¬¡å†è®¿é—®è¿™äº›æ•°æ®çš„æ—¶å€™å°±å¯ä»¥ç›´æ¥ä»ç¼“å­˜ä¸­è·å–äº†ã€‚æ“ä½œç¼“å­˜å°±æ˜¯ç›´æ¥æ“ä½œå†…å­˜ï¼Œæ‰€ä»¥é€Ÿåº¦ç›¸å½“å¿«ã€‚å¦‚æœæ•°æ®åº“ä¸­çš„å¯¹åº”æ•°æ®æ”¹å˜çš„ä¹‹åï¼ŒåŒæ­¥æ”¹å˜ç¼“å­˜ä¸­ç›¸åº”çš„æ•°æ®å³å¯ã€‚\n\n**2ã€é«˜å¹¶å‘ï¼š**\n\nç›´æ¥æ“ä½œç¼“å­˜èƒ½å¤Ÿæ‰¿å—çš„è¯·æ±‚æ˜¯è¿œè¿œå¤§äºç›´æ¥è®¿é—®æ•°æ®åº“çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è€ƒè™‘æŠŠæ•°æ®åº“ä¸­çš„éƒ¨åˆ†æ•°æ®è½¬ç§»åˆ°ç¼“å­˜ä¸­å»ï¼Œè¿™æ ·ç”¨æˆ·çš„ä¸€éƒ¨åˆ†è¯·æ±‚ä¼šç›´æ¥åˆ°ç¼“å­˜è¿™é‡Œè€Œä¸ç”¨ç»è¿‡æ•°æ®åº“ï¼Œç¼“è§£æ•°æ®åº“å‹åŠ›ã€‚\n\n### Redis ä¸ Memcached ç›¸æ¯”æœ‰å“ªäº›ä¼˜åŠ¿\n\nRedis æ”¯æŒæ›´ä¸°å¯Œçš„æ•°æ®ç±»å‹ï¼ˆæ”¯æŒæ›´å¤æ‚çš„åº”ç”¨åœºæ™¯ï¼‰\n\nRedis æ”¯æŒæ•°æ®çš„æŒä¹…åŒ–ï¼Œå¯ä»¥å°†å†…å­˜ä¸­çš„æ•°æ®ä¿æŒåœ¨ç£ç›˜ä¸­ï¼Œé‡å¯çš„æ—¶å€™å¯ä»¥å†æ¬¡åŠ è½½è¿›è¡Œä½¿ç”¨ï¼Œè€Œ Memecache æŠŠæ•°æ®å…¨éƒ¨å­˜åœ¨å†…å­˜ä¹‹ä¸­ã€‚\n\nRedis ä½¿ç”¨å•çº¿ç¨‹çš„å¤šè·¯ IO å¤ç”¨æ¨¡å‹ï¼›Memcached æ˜¯å¤šçº¿ç¨‹ï¼Œéé˜»å¡ IO å¤ç”¨çš„ç½‘ç»œæ¨¡å‹ã€‚\n\n***\n\n## Redisäº”å¤§åŸºæœ¬ç±»å‹\n\n[Redis å‘½ä»¤å¤§å…¨](https://www.Redis.net.cn/order/)\n\n[Redis åº”ç”¨åœºæ™¯](https://juejin.cn/post/6857667542652190728)\n\n### Stringï¼ˆå­—ç¬¦ä¸²ï¼‰\n\n> 1. String ç±»å‹æ˜¯ Redis çš„æœ€åŸºç¡€çš„æ•°æ®ç»“æ„ï¼Œä¹Ÿæ˜¯æœ€ç»å¸¸ä½¿ç”¨åˆ°çš„ç±»å‹ã€‚è€Œä¸”å…¶ä»–çš„å››ç§ç±»å‹å¤šå¤šå°‘å°‘éƒ½æ˜¯åœ¨å­—ç¬¦ä¸²ç±»å‹çš„åŸºç¡€ä¸Šæ„å»ºçš„ï¼Œæ‰€ä»¥ String ç±»å‹æ˜¯ Redis çš„åŸºç¡€ã€‚\n>\n> 2. String ç±»å‹çš„å€¼æœ€å¤§èƒ½å­˜å‚¨ 512MBï¼Œè¿™é‡Œçš„ String ç±»å‹å¯ä»¥æ˜¯ç®€å•å­—ç¬¦ä¸²ã€  å¤æ‚çš„ xml/json çš„å­—ç¬¦ä¸²ã€äºŒè¿›åˆ¶å›¾åƒæˆ–è€…éŸ³é¢‘çš„å­—ç¬¦ä¸²ã€ä»¥åŠå¯ä»¥æ˜¯æ•°å­—çš„å­—ç¬¦ä¸²ã€‚\n\n**åº”ç”¨åœºæ™¯**\n\n1ã€ç¼“å­˜åŠŸèƒ½ï¼šString å­—ç¬¦ä¸²æ˜¯æœ€å¸¸ç”¨çš„æ•°æ®ç±»å‹ï¼Œä¸ä»…ä»…æ˜¯ Redisï¼Œå„ä¸ªè¯­è¨€éƒ½æ˜¯æœ€åŸºæœ¬ç±»å‹ï¼Œå› æ­¤ï¼Œåˆ©ç”¨ Redis ä½œä¸ºç¼“å­˜ï¼Œé…åˆå…¶å®ƒæ•°æ®åº“ä½œä¸ºå­˜å‚¨å±‚ï¼Œåˆ©ç”¨ Redis æ”¯æŒé«˜å¹¶å‘çš„ç‰¹ç‚¹ï¼Œå¯ä»¥å¤§å¤§åŠ å¿«ç³»ç»Ÿçš„è¯»å†™é€Ÿåº¦ã€ä»¥åŠé™ä½åç«¯æ•°æ®åº“çš„å‹åŠ›ã€‚\n\n2ã€è®¡æ•°å™¨ï¼šè®¸å¤šç³»ç»Ÿéƒ½ä¼šä½¿ç”¨ Redis ä½œä¸ºç³»ç»Ÿçš„å®æ—¶è®¡æ•°å™¨ï¼Œå¯ä»¥å¿«é€Ÿå®ç°è®¡æ•°å’ŒæŸ¥è¯¢çš„åŠŸèƒ½ã€‚è€Œä¸”æœ€ç»ˆçš„æ•°æ®ç»“æœå¯ä»¥æŒ‰ç…§ç‰¹å®šçš„æ—¶é—´è½åœ°åˆ°æ•°æ®åº“æˆ–è€…å…¶å®ƒå­˜å‚¨ä»‹è´¨å½“ä¸­è¿›è¡Œæ°¸ä¹…ä¿å­˜ã€‚\n\n3ã€å…±äº«ç”¨æˆ· sessionï¼šç”¨æˆ·é‡æ–°åˆ·æ–°ä¸€æ¬¡ç•Œé¢ï¼Œå¯èƒ½éœ€è¦è®¿é—®ä¸€ä¸‹æ•°æ®è¿›è¡Œé‡æ–°ç™»å½•ï¼Œæˆ–è€…è®¿é—®é¡µé¢ç¼“å­˜ cookieï¼Œè¿™ä¸¤ç§æ–¹å¼åšæœ‰ä¸€å®šå¼Šç«¯ï¼Œ1ï¼‰æ¯æ¬¡éƒ½é‡æ–°ç™»å½•æ•ˆç‡ä½ä¸‹ 2ï¼‰cookie ä¿å­˜åœ¨å®¢æˆ·ç«¯ï¼Œæœ‰å®‰å…¨éšæ‚£ã€‚è¿™æ—¶å¯ä»¥åˆ©ç”¨ Redis å°†ç”¨æˆ·çš„ session é›†ä¸­ç®¡ç†ï¼Œåœ¨è¿™ç§æ¨¡å¼åªéœ€è¦ä¿è¯ Redis çš„é«˜å¯ç”¨ï¼Œæ¯æ¬¡ç”¨æˆ· session çš„æ›´æ–°å’Œè·å–éƒ½å¯ä»¥å¿«é€Ÿå®Œæˆã€‚å¤§å¤§æé«˜æ•ˆç‡ã€‚ï¼ˆåˆ†å¸ƒå¼ä¼šè¯ï¼‰\n\n### Listï¼ˆåˆ—è¡¨ï¼‰\n\n> 1. List æ˜¯ç®€å•çš„å­—ç¬¦ä¸²åˆ—è¡¨\n> 2. Redis å¯ä»¥ä»åˆ—è¡¨çš„ä¸¤ç«¯è¿›è¡Œæ’å…¥ï¼ˆpubshï¼‰å’Œå¼¹å‡ºï¼ˆpopï¼‰å…ƒç´ ï¼Œæ”¯æŒè¯»å–æŒ‡å®šèŒƒå›´çš„å…ƒç´ é›†ï¼Œæˆ–è€…è¯»å–æŒ‡å®šä¸‹æ ‡çš„å…ƒç´ ç­‰æ“ä½œã€‚Redisåˆ—è¡¨æ˜¯ä¸€ç§æ¯”è¾ƒçµæ´»çš„é“¾è¡¨æ•°æ®ç»“æ„ï¼Œå®ƒå¯ä»¥å……å½“é˜Ÿåˆ—æˆ–è€…æ ˆçš„è§’è‰²ã€‚\n\n**åº”ç”¨åœºæ™¯**\n\n1ã€æ¶ˆæ¯é˜Ÿåˆ—ï¼šRedis çš„é“¾è¡¨ç»“æ„ï¼Œå¯ä»¥è½»æ¾å®ç°é˜»å¡é˜Ÿåˆ—ï¼Œå¯ä»¥ä½¿ç”¨å·¦è¿›å³å‡ºçš„å‘½ä»¤ç»„æˆæ¥å®Œæˆé˜Ÿåˆ—çš„è®¾è®¡ã€‚æ¯”å¦‚ï¼šæ•°æ®çš„ç”Ÿäº§è€…å¯ä»¥é€šè¿‡ lpush å‘½ä»¤ä»å·¦è¾¹æ’å…¥æ•°æ®ï¼Œå¤šä¸ªæ•°æ®æ¶ˆè´¹è€…ï¼Œå¯ä»¥ä½¿ç”¨ rpop å‘½ä»¤é˜»å¡çš„â€œæŠ¢â€åˆ—è¡¨å°¾éƒ¨çš„æ•°æ®ã€‚\n\n2ã€æ–‡ç« åˆ—è¡¨æˆ–è€…æ•°æ®åˆ†é¡µå±•ç¤ºçš„åº”ç”¨ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å¸¸ç”¨çš„åšå®¢ç½‘ç«™çš„æ–‡ç« åˆ—è¡¨ï¼Œå½“ç”¨æˆ·é‡è¶Šæ¥è¶Šå¤šæ—¶ï¼Œè€Œä¸”æ¯ä¸€ä¸ªç”¨æˆ·éƒ½æœ‰è‡ªå·±çš„æ–‡ç« åˆ—è¡¨ï¼Œè€Œä¸”å½“æ–‡ç« å¤šæ—¶ï¼Œéƒ½éœ€è¦åˆ†é¡µå±•ç¤ºï¼Œè¿™æ—¶å¯ä»¥è€ƒè™‘ä½¿ç”¨ Redis çš„åˆ—è¡¨ï¼Œåˆ—è¡¨ä¸ä½†æœ‰åºåŒæ—¶è¿˜æ”¯æŒæŒ‰ç…§èŒƒå›´å†…è·å–å…ƒç´ ï¼Œå¯ä»¥å®Œç¾è§£å†³åˆ†é¡µæŸ¥è¯¢åŠŸèƒ½ã€‚å¤§å¤§æé«˜æŸ¥è¯¢æ•ˆç‡ã€‚\n\n### Setï¼ˆé›†åˆï¼‰\n\n> 1. Redis é›†åˆ set ç±»å‹å’Œ list åˆ—è¡¨ç±»å‹ç±»ä¼¼ï¼Œéƒ½å¯ä»¥ç”¨æ¥å­˜å‚¨å¤šä¸ªå­—ç¬¦ä¸²å…ƒç´ çš„é›†åˆã€‚\n> 2. ä½†æ˜¯å’Œ list ä¸åŒçš„æ˜¯ set é›†åˆå½“ä¸­ä¸å…è®¸é‡å¤çš„å…ƒç´ ã€‚è€Œä¸” set é›†åˆå½“ä¸­å…ƒç´ æ˜¯æ²¡æœ‰é¡ºåºçš„ï¼Œä¸å­˜åœ¨å…ƒç´ ä¸‹æ ‡ã€‚\n> 3. Redis çš„ set ç±»å‹æ˜¯ä½¿ç”¨å“ˆå¸Œè¡¨æ„é€ çš„ï¼Œå› æ­¤å¤æ‚åº¦æ˜¯ O(1)ï¼Œå®ƒæ”¯æŒé›†åˆå†…çš„å¢åˆ æ”¹æŸ¥ï¼Œå¹¶ä¸”æ”¯æŒå¤šä¸ªé›†åˆé—´çš„äº¤é›†ã€å¹¶é›†ã€å·®é›†æ“ä½œã€‚å¯ä»¥åˆ©ç”¨è¿™äº›é›†åˆæ“ä½œï¼Œè§£å†³ç¨‹åºå¼€å‘è¿‡ç¨‹å½“ä¸­å¾ˆå¤šæ•°æ®é›†åˆé—´çš„é—®é¢˜ã€‚\n\n**åº”ç”¨åœºæ™¯**\n\n1ã€æ ‡ç­¾ï¼šæ¯”å¦‚æˆ‘ä»¬åšå®¢ç½‘ç«™å¸¸å¸¸ä½¿ç”¨åˆ°çš„å…´è¶£æ ‡ç­¾ï¼ŒæŠŠä¸€ä¸ªä¸ªæœ‰ç€ç›¸åŒçˆ±å¥½ï¼Œå…³æ³¨ç±»ä¼¼å†…å®¹çš„ç”¨æˆ·åˆ©ç”¨ä¸€ä¸ªæ ‡ç­¾æŠŠä»–ä»¬è¿›è¡Œå½’å¹¶ã€‚\n\n2ã€å…±åŒå¥½å‹åŠŸèƒ½ï¼Œå…±åŒå–œå¥½ï¼Œæˆ–è€…å¯ä»¥å¼•ç”³åˆ°äºŒåº¦å¥½å‹ä¹‹ç±»çš„æ‰©å±•åº”ç”¨ã€‚\n\n3ã€ç»Ÿè®¡ç½‘ç«™çš„ç‹¬ç«‹ IPã€‚åˆ©ç”¨ set é›†åˆå½“ä¸­å…ƒç´ ä¸å”¯ä¸€æ€§ï¼Œå¯ä»¥å¿«é€Ÿå®æ—¶ç»Ÿè®¡è®¿é—®ç½‘ç«™çš„ç‹¬ç«‹ IPã€‚\n\n### sorted setï¼ˆæœ‰åºé›†åˆï¼‰\n\n> Redis æœ‰åºé›†åˆä¹Ÿæ˜¯é›†åˆç±»å‹çš„ä¸€éƒ¨åˆ†ï¼Œæ‰€ä»¥å®ƒä¿ç•™äº†é›†åˆä¸­å…ƒç´ ä¸èƒ½é‡å¤çš„ç‰¹æ€§ï¼Œä½†æ˜¯ä¸åŒçš„æ˜¯ï¼Œæœ‰åºé›†åˆç»™æ¯ä¸ªå…ƒç´ å¤šè®¾ç½®äº†ä¸€ä¸ªåˆ†æ•°ï¼Œåˆ©ç”¨è¯¥åˆ†æ•°ä½œä¸ºæ’åºçš„ä¾æ®ã€‚\n\n#### åº”ç”¨åœºæ™¯\n\n1ã€æ’è¡Œæ¦œï¼šæœ‰åºé›†åˆç»å…¸ä½¿ç”¨åœºæ™¯ã€‚ä¾‹å¦‚è§†é¢‘ç½‘ç«™éœ€è¦å¯¹ç”¨æˆ·ä¸Šä¼ çš„è§†é¢‘åšæ’è¡Œæ¦œï¼Œæ¦œå•ç»´æŠ¤å¯èƒ½æ˜¯å¤šæ–¹é¢ï¼šæŒ‰ç…§æ—¶é—´ã€æŒ‰ç…§æ’­æ”¾é‡ã€æŒ‰ç…§è·å¾—çš„èµæ•°ç­‰ã€‚\n\n2ã€ç”¨ Sorted Sets æ¥åšå¸¦æƒé‡çš„é˜Ÿåˆ—ï¼Œæ¯”å¦‚æ™®é€šæ¶ˆæ¯çš„ score ä¸º 1ï¼Œé‡è¦æ¶ˆæ¯çš„ score ä¸º 2ï¼Œç„¶åå·¥ä½œçº¿ç¨‹å¯ä»¥é€‰æ‹©æŒ‰ score çš„å€’åºæ¥è·å–å·¥ä½œä»»åŠ¡ã€‚è®©é‡è¦çš„ä»»åŠ¡ä¼˜å…ˆæ‰§è¡Œã€‚\n\n### hashï¼ˆå“ˆå¸Œï¼‰\n\nRedis hash æ•°æ®ç»“æ„ æ˜¯ä¸€ä¸ªé”®å€¼å¯¹ï¼ˆkey-valueï¼‰é›†åˆï¼Œå®ƒæ˜¯ä¸€ä¸ª string ç±»å‹çš„ field å’Œ value çš„æ˜ å°„è¡¨ï¼ŒRedis æœ¬èº«å°±æ˜¯ä¸€ä¸ª key-value å‹æ•°æ®åº“ï¼Œå› æ­¤ hash æ•°æ®ç»“æ„ç›¸å½“äºåœ¨ value ä¸­åˆå¥—äº†ä¸€å±‚ key-value å‹æ•°æ®ã€‚æ‰€ä»¥ Redis ä¸­ hash æ•°æ®ç»“æ„ç‰¹åˆ«é€‚åˆå­˜å‚¨å…³ç³»å‹å¯¹è±¡ã€‚\n\n> ç”¨æˆ· ID ä¸ºæŸ¥æ‰¾çš„keyï¼Œå­˜å‚¨çš„ value ç”¨æˆ·å¯¹è±¡åŒ…å«å§“åï¼Œå¹´é¾„ï¼Œç”Ÿæ—¥ç­‰ä¿¡æ¯ï¼Œå¦‚æœç”¨æ™®é€šçš„ key/value ç»“æ„æ¥å­˜å‚¨\n>\n> 1. å°†ç”¨æˆ· ID ä½œä¸º keyï¼Œå§“åå±æ€§+å§“åæ•°æ®æ•´ä½“ä½œä¸º valueã€‚ç¼ºç‚¹æ˜¯æ¯æ¬¡ä¿®æ”¹ç”¨æˆ·çš„æŸä¸ªå±æ€§ï¼Œéƒ½éœ€è¦å…ˆååºåˆ—åŒ– å±æ€§+æ•°æ®ï¼Œä¿®æ”¹å¥½ï¼Œç„¶åå°† å±æ€§+æ•°æ® åºåˆ—åŒ–ä¹‹ååœ¨ä¿®æ”¹å›å»ï¼Œå¼€é”€è¾ƒå¤§ã€‚\n>\n> ![ID -> å±æ€§+æ•°æ®](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650356860189.png)\n>\n> 2. å°†ç”¨æˆ· ID+å§“åå±æ€§ä½œä¸º keyï¼Œå§“åæ•°æ®ä½œä¸º valueã€‚ç¼ºç‚¹æ˜¯ç”¨æˆ· ID ä½¿ç”¨å¤šæ¬¡ï¼Œæ•°æ®å†—ä½™\n>\n> ![ID+å±æ€§ -> æ•°æ®](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650356955204.png)\n>\n> \n>\n> 3. å› æ­¤é€šè¿‡ key(ç”¨æˆ· ID) + field(å±æ€§æ ‡ç­¾) å°±å¯ä»¥æ“ä½œå¯¹åº”å±æ€§æ•°æ®äº†ï¼Œæ—¢ä¸éœ€è¦é‡å¤å­˜å‚¨æ•°æ®ï¼Œä¹Ÿä¸ä¼šå¸¦æ¥åºåˆ—åŒ–å’Œå¹¶å‘ä¿®æ”¹æ§åˆ¶çš„é—®é¢˜ã€‚\n>\n> ![ID -> å±æ€§ -> æ•°æ®](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650356950290.png)\n\n#### åº”ç”¨åœºæ™¯\n\n1ã€ç”±äº hash æ•°æ®ç±»å‹çš„ key-value çš„ç‰¹æ€§ï¼Œç”¨æ¥å­˜å‚¨å…³ç³»å‹æ•°æ®åº“ä¸­è¡¨è®°å½•ï¼Œæ˜¯ Redis ä¸­å“ˆå¸Œç±»å‹æœ€å¸¸ç”¨çš„åœºæ™¯ã€‚ä¸€æ¡è®°å½•ä½œä¸ºä¸€ä¸ª key-valueï¼ŒæŠŠæ¯åˆ—å±æ€§å€¼å¯¹åº”æˆ field-value å­˜å‚¨åœ¨å“ˆå¸Œè¡¨å½“ä¸­ï¼Œç„¶åé€šè¿‡ key å€¼æ¥åŒºåˆ†è¡¨å½“ä¸­çš„ä¸»é”®ã€‚\n\n2ã€ç»å¸¸è¢«ç”¨æ¥å­˜å‚¨ç”¨æˆ·ç›¸å…³ä¿¡æ¯ã€‚ä¼˜åŒ–ç”¨æˆ·ä¿¡æ¯çš„è·å–ï¼Œä¸éœ€è¦é‡å¤ä»æ•°æ®åº“å½“ä¸­è¯»å–ï¼Œæé«˜ç³»ç»Ÿæ€§èƒ½ã€‚\n\n***\n\n## äº”å¤§åŸºæœ¬ç±»å‹åº•å±‚æ•°æ®ç»“æ„\n\nRedis æ•´ä½“çš„å­˜å‚¨ç»“æ„ï¼š\n\nRedis å†…éƒ¨æ•´ä½“çš„å­˜å‚¨ç»“æ„æ˜¯ä¸€ä¸ªå¤§çš„ hashmapï¼Œå†…éƒ¨æ˜¯æ•°ç»„å®ç°çš„ hashï¼Œkey å†²çªé€šè¿‡æŒ‚é“¾è¡¨å»å®ç°ï¼Œæ¯ä¸ª dictEntry ä¸ºä¸€ä¸ª key/value å¯¹è±¡ï¼Œvalue ä¸ºå®šä¹‰çš„ redisObjectã€‚\n\nç»“æ„å›¾å¦‚ä¸‹ï¼š\n\n![Redis æ•´ä½“çš„å­˜å‚¨ç»“æ„](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650433179786.png)\n\ndictEntry æ˜¯å­˜å‚¨ key->value çš„åœ°æ–¹ï¼Œå…¶ä¸­åŒ…å«æŒ‡å‘å…·ä½“çš„ redisObject çš„æŒ‡é’ˆã€‚\n\nredisObject ä¸­*ptr æŒ‡å‘å…·ä½“çš„æ•°æ®ç»“æ„çš„åœ°å€ï¼›type è¡¨ç¤ºè¯¥å¯¹è±¡çš„ç±»å‹ï¼Œå³ Stringã€Listã€Hashã€Setã€Zset ä¸­çš„ä¸€ä¸ª\n\n### String (arrayList)\n\nString çš„æ•°æ®ç»“æ„ä¸ºç®€å•åŠ¨æ€å­—ç¬¦ä¸²(Simple Dynamic Stringï¼Œç¼©å†™ SDS)ã€‚æ˜¯å¯ä»¥ä¿®æ”¹çš„å­—ç¬¦ä¸²ï¼Œå†…éƒ¨ç»“æ„å®ç°ä¸Šç±»ä¼¼äº Java çš„ ArrayListï¼Œé‡‡ç”¨é¢„åˆ†é…å†—ä½™ç©ºé—´çš„æ–¹å¼æ¥å‡å°‘å†…å­˜çš„é¢‘ç¹åˆ†é…ã€‚\n\n![String çš„æ•°æ®ç»“æ„](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650356547555.png)\n\nå¦‚å›¾ä¸­æ‰€ç¤ºï¼Œå†…éƒ¨ä¸ºå½“å‰å­—ç¬¦ä¸²å®é™…åˆ†é…çš„ç©ºé—´ capacity ä¸€èˆ¬è¦é«˜äºå®é™…å­—ç¬¦ä¸²é•¿åº¦ lenã€‚å½“å­—ç¬¦ä¸²é•¿åº¦å°äº 1M æ—¶ï¼Œæ‰©å®¹éƒ½æ˜¯åŠ å€ç°æœ‰çš„ç©ºé—´ï¼Œå¦‚æœè¶…è¿‡ 1Mï¼Œæ‰©å®¹æ—¶ä¸€æ¬¡åªä¼šå¤šæ‰© 1M çš„ç©ºé—´ã€‚éœ€è¦æ³¨æ„çš„æ˜¯å­—ç¬¦ä¸²æœ€å¤§é•¿åº¦ä¸º 512Mã€‚\n\n### List (ziplist - quickList)\n\n1ã€Redis 3.2 ä¹‹å‰çš„åº•å±‚å®ç°æ–¹å¼ï¼šå‹ç¼©åˆ—è¡¨ ziplist æˆ–è€… åŒå‘å¾ªç¯é“¾è¡¨ linkedlist\n\nå½“ list å­˜å‚¨çš„æ•°æ®é‡æ¯”è¾ƒå°‘ä¸”åŒæ—¶æ»¡è¶³ä¸‹é¢ä¸¤ä¸ªæ¡ä»¶æ—¶ï¼Œlist å°±ä½¿ç”¨ ziplist å­˜å‚¨æ•°æ®ï¼š\n\n- list ä¸­ä¿å­˜çš„æ¯ä¸ªå…ƒç´ çš„é•¿åº¦å°äº 64 å­—èŠ‚ï¼›\n- åˆ—è¡¨ä¸­æ•°æ®ä¸ªæ•°å°‘äº 512 ä¸ªã€‚\n\n2ã€Redis 3.2 åŠä¹‹åçš„åº•å±‚å®ç°æ–¹å¼ï¼šquicklist\n\nquicklist æ˜¯ä¸€ä¸ªåŸºäº ziplist çš„åŒå‘é“¾è¡¨ï¼Œquicklist çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸€ä¸ª ziplistï¼Œç»“åˆäº†åŒå‘é“¾è¡¨å’Œ ziplist çš„ä¼˜ç‚¹ã€‚\n\n#### **ziplist**\n\nziplist æ˜¯å‹ç¼©åˆ—è¡¨ï¼Œå®ƒçš„å¥½å¤„æ˜¯èƒ½èŠ‚çœå†…å­˜ç©ºé—´ï¼Œå› ä¸ºå®ƒæ‰€å­˜å‚¨çš„å†…å®¹éƒ½æ˜¯åœ¨è¿ç»­çš„å†…å­˜åŒºåŸŸå½“ä¸­çš„ã€‚å½“åˆ—è¡¨å¯¹è±¡å…ƒç´ ä¸å¤§ï¼Œæ¯ä¸ªå…ƒç´ ä¹Ÿä¸å¤§çš„æ—¶å€™ï¼Œå°±é‡‡ç”¨ ziplist å­˜å‚¨ã€‚ä½†å½“æ•°æ®é‡è¿‡å¤§æ—¶å°± ziplist å°±ä¸æ˜¯é‚£ä¹ˆå¥½ç”¨äº†ã€‚å› ä¸ºä¸ºäº†ä¿è¯ä»–å­˜å‚¨å†…å®¹åœ¨å†…å­˜ä¸­çš„è¿ç»­æ€§ï¼Œæ’å…¥çš„å¤æ‚åº¦æ˜¯ O(N)ï¼Œå³æ¯æ¬¡æ’å…¥éƒ½ä¼šé‡æ–°è¿›è¡Œ realloc é‡æ–°åˆ†é…å†…å­˜ç©ºé—´ã€‚\n\nziplist ç»“æ„å¦‚ä¸‹ï¼š\n\n![ziplist ç»“æ„å›¾](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650419709341.png)\n\n1ã€zlbytesï¼šç”¨äºè®°å½•æ•´ä¸ªå‹ç¼©åˆ—è¡¨å ç”¨å­—èŠ‚æ•°\n\n2ã€zltailï¼šè®°å½•è¦åˆ—è¡¨å°¾èŠ‚ç‚¹è·ç¦»å‹ç¼©åˆ—è¡¨çš„èµ·å§‹åœ°å€æœ‰å¤šå°‘å­—èŠ‚ï¼Œç”¨äºå¿«é€Ÿå®šä½åˆ°æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œä»è€Œå¯ä»¥åœ¨ ziplist å°¾éƒ¨å¿«é€Ÿçš„æ‰§è¡Œ pushï¼Œpop æ“ä½œ\n\n3ã€zllenï¼šè®°å½•äº†å‹ç¼©åˆ—è¡¨åŒ…å«çš„èŠ‚ç‚¹æ•°é‡ã€‚\n\n4ã€entryXï¼šå‹ç¼©åˆ—è¡¨åŒ…å«çš„å„ä¸ªèŠ‚ç‚¹\n\n5ã€zlendï¼šç”¨äºæ ‡è®°å‹ç¼©åˆ—è¡¨çš„æœ«ç«¯ï¼Œç”¨æ¥å¿«é€Ÿå®šä½åˆ°æœ€åä¸€ä¸ªå…ƒç´ ï¼Œç„¶åå€’ç€éå†ã€‚ï¼ˆentry å—çš„ prevlen å­—æ®µè¡¨ç¤ºå‰ä¸€ä¸ª entry çš„å­—èŠ‚é•¿åº¦ï¼Œå½“å‹ç¼©åˆ—è¡¨å€’ç€éå†æ—¶ï¼Œéœ€è¦é€šè¿‡è¿™ä¸ªå­—æ®µæ¥å¿«é€Ÿå®šä½åˆ°ä¸‹ä¸€ä¸ªå…ƒç´ çš„ä½ç½®ã€‚ï¼‰\n\n**ä¸ºä»€ä¹ˆæ•°æ®é‡å¤§æ—¶ä¸ç”¨ ziplistï¼Ÿ**\n\nå› ä¸º ziplist æ˜¯ä¸€æ®µè¿ç»­çš„å†…å­˜ï¼Œæ’å…¥çš„æ—¶é—´å¤æ‚åŒ–åº¦ä¸º O(n)ï¼Œè€Œä¸”æ¯å½“æ’å…¥æ–°çš„å…ƒç´ éœ€è¦ realloc åšå†…å­˜æ‰©å±•ï¼›è€Œä¸”å¦‚æœè¶…å‡º ziplist å†…å­˜å¤§å°ï¼Œè¿˜ä¼šåšé‡æ–°åˆ†é…çš„å†…å­˜ç©ºé—´ï¼Œå¹¶å°†å†…å®¹å¤åˆ¶åˆ°æ–°çš„åœ°å€ã€‚å¦‚æœæ•°é‡å¤§çš„è¯ï¼Œé‡æ–°åˆ†é…å†…å­˜å’Œæ‹·è´å†…å­˜ä¼šæ¶ˆè€—å¤§é‡æ—¶é—´ã€‚æ‰€ä»¥ä¸é€‚åˆå¤§å‹å­—ç¬¦ä¸²ï¼Œä¹Ÿä¸é€‚åˆå­˜å‚¨é‡å¤šçš„å…ƒç´ ã€‚\n\n#### quickList\n\nå¿«é€Ÿåˆ—è¡¨æ˜¯ ziplist å’Œ linkedlist çš„æ··åˆä½“ï¼Œæ˜¯å°† linkedlist æŒ‰æ®µåˆ‡åˆ†ï¼Œæ¯ä¸€æ®µç”¨ ziplist æ¥ç´§å‡‘å­˜å‚¨ï¼Œå¤šä¸ª ziplist ä¹‹é—´ä½¿ç”¨åŒå‘æŒ‡é’ˆé“¾æ¥ã€‚\n\n**ä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨ linkedlistï¼Ÿ**\n\nlinkedlist çš„é™„åŠ ç©ºé—´ç›¸å¯¹å¤ªé«˜ï¼Œprev å’Œ next æŒ‡é’ˆå°±è¦å å» 16 ä¸ªå­—èŠ‚ï¼Œè€Œä¸”æ¯ä¸€ä¸ªç»“ç‚¹éƒ½æ˜¯å•ç‹¬åˆ†é…ï¼Œä¼šåŠ å‰§å†…å­˜çš„ç¢ç‰‡åŒ–ï¼Œå½±å“å†…å­˜ç®¡ç†æ•ˆç‡ã€‚\n\nquicklist ç»“æ„å›¾å¦‚ä¸‹ï¼š\n\n![quicklist ç»“æ„å›¾](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650419719663.png)\n\n**ziplistçš„é•¿åº¦**\n\nquicklist å†…éƒ¨é»˜è®¤å•ä¸ª ziplist é•¿åº¦ä¸º 8k å­—èŠ‚ï¼Œè¶…å‡ºäº†è¿™ä¸ªå­—èŠ‚æ•°ï¼Œå°±ä¼šæ–°èµ·ä¸€ä¸ª ziplistã€‚å…³äºé•¿åº¦å¯ä»¥ä½¿ç”¨ list-max-ziplist-size å†³å®šã€‚\n\n**å‹ç¼©æ·±åº¦**\n\næˆ‘ä»¬ä¸Šé¢è¯´åˆ°äº† quicklist ä¸‹æ˜¯ç”¨å¤šä¸ª ziplist ç»„æˆçš„ï¼ŒåŒæ—¶ä¸ºäº†è¿›ä¸€æ­¥èŠ‚çº¦ç©ºé—´ï¼ŒRedis è¿˜ä¼šå¯¹ ziplist è¿›è¡Œå‹ç¼©å­˜å‚¨ï¼Œä½¿ç”¨ LZF ç®—æ³•å‹ç¼©ï¼Œå¯ä»¥é€‰æ‹©å‹ç¼©æ·±åº¦ã€‚quicklist é»˜è®¤çš„å‹ç¼©æ·±åº¦æ˜¯ 0ï¼Œä¹Ÿå°±æ˜¯ä¸å‹ç¼©ã€‚å‹ç¼©çš„å®é™…æ·±åº¦ç”±é…ç½®å‚æ•° list-compress-depth å†³å®šã€‚ä¸ºäº†æ”¯æŒå¿«é€Ÿ push/pop æ“ä½œï¼Œquicklist çš„é¦–å°¾ä¸¤ä¸ª ziplist ä¸å‹ç¼©ï¼Œæ­¤æ—¶æ·±åº¦å°±æ˜¯ 1ã€‚å¦‚æœæ·±åº¦ä¸º 2ï¼Œå°±è¡¨ç¤º quicklist çš„é¦–å°¾ç¬¬ä¸€ä¸ª ziplist ä»¥åŠé¦–å°¾ç¬¬äºŒä¸ª ziplist éƒ½ä¸å‹ç¼©ã€‚\n\n### Hash (ziplist - dict)\n\n#### ziplist\n\nå½“ Hash ä¸­æ•°æ®é¡¹æ¯”è¾ƒå°‘çš„æƒ…å†µä¸‹ï¼ŒHash åº•å±‚æ‰ç”¨å‹ç¼©åˆ—è¡¨ ziplist è¿›è¡Œå­˜å‚¨æ•°æ®ï¼Œéšç€æ•°æ®çš„å¢åŠ ï¼Œåº•å±‚çš„ ziplist å°±å¯èƒ½ä¼šè½¬æˆ dictï¼Œå…·ä½“é…ç½®å¦‚ä¸‹\n\n> hash-max-ziplist-entries 512\n> hash-max-ziplist-value 64\n\nåœ¨å¦‚ä¸‹ä¸¤ä¸ªæ¡ä»¶ä¹‹ä¸€æ»¡è¶³çš„æ—¶å€™ï¼Œziplist ä¼šè½¬æˆ dictï¼š\n\n- å½“ hash ä¸­çš„æ•°æ®é¡¹çš„æ•°ç›®è¶…è¿‡ 512 çš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯ ziplist æ•°æ®é¡¹è¶…è¿‡ 1024 çš„æ—¶å€™ï¼›\n- å½“ hash ä¸­æ’å…¥çš„ä»»æ„ä¸€ä¸ª value çš„é•¿åº¦è¶…è¿‡äº† 64 çš„æ—¶å€™ã€‚\n\næ¯å½“æœ‰æ–°çš„é”®å€¼å¯¹åŠ å…¥åˆ°å“ˆå¸Œå¯¹è±¡æ—¶ï¼Œå…ˆå‹å…¥é”®ï¼Œå†å‹å…¥å€¼ï¼Œå¦‚å›¾ï¼š\n\n![ziplistå®ç°çš„hash](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/20190703171927309.png)\n\nå½“éå†æ—¶ï¼Œä»å¤´åˆ°å°¾çš„éå†ï¼Œä¸”è·³è¿‡å€¼èŠ‚ç‚¹ã€‚\n\n#### dict\n\nå­—å…¸çš„å“ˆå¸Œè¡¨ç»“æ„å’Œ Java çš„ HashMap ç»“æ„å‡ ä¹æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯é€šè¿‡æŸä¸ªå“ˆå¸Œå‡½æ•°ä» key è®¡ç®—å¾—åˆ°åœ¨å“ˆå¸Œè¡¨ä¸­çš„ä½ç½®ï¼Œé‡‡ç”¨é“¾è¡¨æ³•è§£å†³å†²çªã€‚Redis è¿™é‡Œä½¿ç”¨çš„æ˜¯å•é“¾è¡¨ï¼Œä¸ºäº†æŸ¥è¯¢æ•ˆç‡æ¯æ¬¡æŠŠæ–°æ•°æ®æ’å…¥åˆ°é“¾è¡¨å¤´ä½ç½®ï¼ˆä½¿ç”¨å¤´æ’æ³•æ˜¯å› ä¸ºæ–°æ’å…¥çš„æ•°æ®è¢«è®¿é—®çš„æ¦‚ç‡å¤§ï¼Œå¯ä»¥æ›´å¿«è®¿é—®åˆ°ï¼‰ã€‚\n\næˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¯ä¸ª dict ä¸­éƒ½æœ‰ä¸¤ä¸ª hashtableï¼Œç»“æ„å›¾å¦‚ä¸‹ï¼š\n\n![dictå®ç°çš„hash](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650420119549.png)\n\nè™½ç„¶ dict ç»“æ„æœ‰ä¸¤ä¸ª hashtableï¼Œä½†æ˜¯é€šå¸¸æƒ…å†µä¸‹åªæœ‰ä¸€ä¸ª hashtable æ˜¯æœ‰å€¼çš„ã€‚ä½†æ˜¯åœ¨ dict æ‰©å®¹ç¼©å®¹çš„æ—¶å€™ï¼Œéœ€è¦åˆ†é…æ–°çš„ hashtableï¼Œç„¶åè¿›è¡Œæ¸è¿‘å¼æ¬è¿ï¼Œè¿™æ—¶å€™ä¸¤ä¸ª hashtable å­˜å‚¨çš„æ—§çš„ hashtable å’Œæ–°çš„ hashtableã€‚æ¬è¿ç»“æŸåï¼Œæ—§ hashtable åˆ é™¤ï¼Œæ–°çš„å–è€Œä»£ä¹‹ã€‚\n\n**æ¸è¿›å¼ rehash**\n\næ‰€è°“æ¸è¿›å¼ rehash æ˜¯æŒ‡æˆ‘ä»¬çš„å¤§å­—å…¸çš„æ‰©å®¹æ˜¯æ¯”è¾ƒæ¶ˆè€—æ—¶é—´çš„ï¼Œéœ€è¦é‡æ–°ç”³è¯·æ–°çš„æ•°ç»„ï¼Œç„¶åå°†æ—§å­—å…¸æ‰€æœ‰é“¾è¡¨çš„å…ƒç´ é‡æ–°æŒ‚æ¥åˆ°æ–°çš„æ•°ç»„ä¸‹é¢ï¼Œæ˜¯ä¸€ä¸ª O(n)çš„æ“ä½œã€‚ä½†æ˜¯å› ä¸ºæˆ‘ä»¬çš„ Redis æ˜¯å•çº¿ç¨‹çš„ï¼Œæ— æ³•æ‰¿å—è¿™æ ·çš„è€—æ—¶è¿‡ç¨‹ï¼Œæ‰€ä»¥é‡‡ç”¨äº†æ¸è¿›å¼ rehash å°æ­¥æ¬è¿ï¼Œè™½ç„¶æ…¢ä¸€ç‚¹ï¼Œä½†æ˜¯å¯ä»¥æ¬è¿å®Œæ¯•ã€‚\n\n**æ‰©å®¹æ¡ä»¶**\n\næˆ‘ä»¬çš„æ‰©å®¹ä¸€èˆ¬ä¼šåœ¨ Hash è¡¨ä¸­çš„å…ƒç´ ä¸ªæ•°ç­‰äºç¬¬ä¸€ç»´æ•°ç»„çš„é•¿åº¦çš„æ—¶å€™ï¼Œå°±ä¼šå¼€å§‹æ‰©å®¹ã€‚æ‰©å®¹çš„å¤§å°æ˜¯åŸæ•°ç»„çš„ä¸¤å€ã€‚ä¸è¿‡åœ¨ Redis åœ¨åš bgsaveï¼ˆRDB æŒä¹…åŒ–æ“ä½œçš„è¿‡ç¨‹ï¼‰ï¼Œä¸ºäº†å‡å°‘å†…å­˜é¡µçš„è¿‡å¤šåˆ†ç¦»ï¼ˆCopy On Writeï¼‰ï¼ŒRedis ä¸ä¼šå»æ‰©å®¹ã€‚ä½†æ˜¯å¦‚æœ hash è¡¨çš„å…ƒç´ ä¸ªæ•°å·²ç»åˆ°è¾¾äº†ç¬¬ä¸€ç»´æ•°ç»„é•¿åº¦çš„ 5 å€çš„æ—¶å€™ï¼Œå°±ä¼šå¼ºåˆ¶æ‰©å®¹ï¼Œä¸ç®¡ä½ æ˜¯å¦åœ¨æŒä¹…åŒ–ã€‚\n\nä¸æ‰©å®¹ä¸»è¦æ˜¯ä¸ºäº†å°½å¯èƒ½å‡å°‘å†…å­˜é¡µè¿‡å¤šåˆ†ç¦»ï¼Œç³»ç»Ÿéœ€è¦æ›´å¤šçš„å¼€é”€å»å›æ”¶å†…å­˜ã€‚\n\n**ç¼©å®¹æ¡ä»¶**\n\nå½“æˆ‘ä»¬çš„ hash è¡¨å…ƒç´ é€æ¸åˆ é™¤çš„è¶Šæ¥è¶Šå°‘çš„æ—¶å€™ã€‚Redis äºæ˜¯å°±ä¼šå¯¹ hash è¡¨è¿›è¡Œç¼©å®¹æ¥å‡å°‘ç¬¬ä¸€ç»´æ•°ç»„é•¿åº¦çš„ç©ºé—´å ç”¨ã€‚ç¼©å®¹çš„æ¡ä»¶æ˜¯å…ƒç´ ä¸ªæ•°ä½äºæ•°ç»„é•¿åº¦çš„ 10%ï¼Œå¹¶ä¸”ç¼©å®¹ä¸è€ƒè™‘æ˜¯å¦åœ¨åš Redis æŒä¹…åŒ–ã€‚\n\nä¸ç”¨è€ƒè™‘ bgsave ä¸»è¦æ˜¯å› ä¸ºæˆ‘ä»¬çš„ç¼©å®¹çš„å†…å­˜éƒ½æ˜¯å·²ç»ä½¿ç”¨è¿‡çš„ï¼Œç¼©å®¹çš„æ—¶å€™å¯ä»¥ç›´æ¥ç½®ç©ºï¼Œè€Œä¸”ç”±äºç”³è¯·çš„å†…å­˜æ¯”è¾ƒå°ï¼ŒåŒæ—¶ä¼šé‡Šæ”¾æ‰ä¸€äº›å·²ç»ä½¿ç”¨çš„å†…å­˜ï¼Œä¸ä¼šå¢å¤§ç³»ç»Ÿçš„å‹åŠ›ã€‚\n\n**rehash æ­¥éª¤**\n\n![rehash æ­¥éª¤](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650420130964.png)\n\n### Set (intset - hashSet)\n\nRedis çš„é›†åˆç›¸å½“äº Java ä¸­çš„ HashSetï¼Œå®ƒå†…éƒ¨çš„é”®å€¼å¯¹æ˜¯æ— åºã€å”¯ä¸€çš„ã€‚å®ƒçš„å†…éƒ¨å®ç°ç›¸å½“äºä¸€ä¸ªç‰¹æ®Šçš„å­—å…¸ï¼Œå­—å…¸ä¸­æ‰€æœ‰çš„ value éƒ½æ˜¯ä¸€ä¸ªå€¼ NULLã€‚é›†åˆ Set ç±»å‹åº•å±‚ç¼–ç åŒ…æ‹¬ inset å’Œ hashtableã€‚\n\nå½“å­˜å‚¨çš„æ•°æ®åŒæ—¶æ»¡è¶³ä¸‹é¢è¿™æ ·ä¸¤ä¸ªæ¡ä»¶çš„æ—¶å€™ï¼ŒRedis å°±é‡‡ç”¨æ•´æ•°é›†åˆ intset æ¥å®ç° set è¿™ç§æ•°æ®ç±»å‹ï¼š\n\n> å­˜å‚¨çš„æ•°æ®éƒ½æ˜¯æ•´æ•°\n> å­˜å‚¨çš„æ•°æ®å…ƒç´ ä¸ªæ•°å°äº512ä¸ª\n\nå½“ä¸èƒ½åŒæ—¶æ»¡è¶³è¿™ä¸¤ä¸ªæ¡ä»¶çš„æ—¶å€™ï¼ŒRedis å°±ä½¿ç”¨ dict æ¥å­˜å‚¨é›†åˆä¸­çš„æ•°æ®\n\n**intset**\n\nintset æ˜¯ä¸€ä¸ªæœ‰åºé›†åˆï¼ŒæŸ¥æ‰¾å…ƒç´ çš„å¤æ‚åº¦ä¸º O(logN)ï¼ˆé‡‡ç”¨äºŒåˆ†æ³•ï¼‰ï¼Œä½†æ’å…¥æ—¶ä¸ä¸€å®šä¸º O(logN)ï¼Œå› ä¸ºæœ‰å¯èƒ½æ¶‰åŠåˆ°å‡çº§æ“ä½œã€‚æ¯”å¦‚å½“é›†åˆé‡Œå…¨æ˜¯ int16_t å‹çš„æ•´æ•°ï¼Œè¿™æ—¶è¦æ’å…¥ä¸€ä¸ª int32_tï¼Œé‚£ä¹ˆä¸ºäº†ç»´æŒé›†åˆä¸­æ•°æ®ç±»å‹çš„ä¸€è‡´ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„æ•°æ®éƒ½ä¼šè¢«è½¬æ¢æˆ int32_t ç±»å‹ï¼Œæ¶‰åŠåˆ°å†…å­˜çš„é‡æ–°åˆ†é…ï¼Œè¿™æ—¶æ’å…¥çš„å¤æ‚åº¦å°±ä¸º O(N)äº†ã€‚æ˜¯ intset ä¸æ”¯æŒé™çº§æ“ä½œã€‚\n\n**intset æ˜¯æœ‰åºä¸è¦å’Œ zset ææ··ï¼Œzset æ˜¯è®¾ç½®ä¸€ä¸ª score æ¥è¿›è¡Œæ’åºï¼Œè€Œ intset è¿™é‡Œåªæ˜¯å•çº¯çš„å¯¹æ•´æ•°è¿›è¡Œå‡åºè€Œå·²**\n\n### Sorted Set (ziplist - zset(dict + skipList))\n\nZset æœ‰åºé›†åˆå’Œ set é›†åˆæœ‰ç€å¿…ç„¶çš„è”ç³»ï¼Œä»–ä¿ç•™äº†é›†åˆä¸èƒ½æœ‰é‡å¤æˆå‘˜çš„ç‰¹æ€§ï¼Œä½†ä¸åŒçš„æ˜¯ï¼Œæœ‰åºé›†åˆä¸­çš„å…ƒç´ æ˜¯å¯ä»¥æ’åºçš„ï¼Œä½†æ˜¯å®ƒå’Œåˆ—è¡¨çš„ä½¿ç”¨ç´¢å¼•ä¸‹æ ‡ä½œä¸ºæ’åºä¾æ®ä¸åŒçš„æ˜¯ï¼Œå®ƒç»™æ¯ä¸ªå…ƒç´ è®¾ç½®ä¸€ä¸ªåˆ†æ•° scoreï¼Œä½œä¸ºæ’åºçš„ä¾æ®ã€‚\n\nå½“æ•°æ®è¾ƒå°‘æ—¶ï¼Œsorted set æ˜¯ç”± ziplist æ¥å®ç°çš„ã€‚\nå½“æ•°æ®å¤šçš„æ—¶å€™ï¼Œsorted set æ˜¯ç”± zset çš„æ•°æ®ç»“æ„æ¥å®ç°çš„ï¼Œè¿™ä¸ª zset åŒ…å«ä¸€ä¸ª dict + ä¸€ä¸ª skiplistã€‚dict ç”¨æ¥æŸ¥è¯¢æ•°æ®åˆ°åˆ†æ•°(score)çš„å¯¹åº”å…³ç³»ï¼Œè€Œ skiplist ç”¨æ¥æ ¹æ®æŒ‡å®šåˆ†æ•° score çš„èŒƒå›´æ¥è·å– value åˆ—è¡¨ã€‚\n\n**sorted set ziplist å®ç°**\n\nåœ¨è¿™é‡Œæˆ‘ä»¬å…ˆæ¥è®¨è®ºä¸€ä¸‹å‰ä¸€ç§æƒ…å†µâ€”â€”åŸºäº ziplist å®ç°çš„ sorted setã€‚ziplist å°±æ˜¯ç”±å¾ˆå¤šæ•°æ®é¡¹ç»„æˆçš„ä¸€å¤§å—è¿ç»­å†…å­˜ã€‚ç”±äº sorted set çš„æ¯ä¸€é¡¹å…ƒç´ éƒ½ç”±æ•°æ®å’Œ score ç»„æˆï¼Œå› æ­¤ï¼Œå½“ä½¿ç”¨ zadd å‘½ä»¤æ’å…¥ä¸€ä¸ª(æ•°æ®, score)å¯¹çš„æ—¶å€™ï¼Œåº•å±‚åœ¨ç›¸åº”çš„ ziplist ä¸Šå°±æ’å…¥ä¸¤ä¸ªæ•°æ®é¡¹ï¼šæ•°æ®åœ¨å‰ï¼Œscore åœ¨åã€‚\n\n![åŸºäº ziplist å®ç°çš„ sorted set](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650431975904.png)\n\nziplist çš„ä¸»è¦ä¼˜ç‚¹æ˜¯èŠ‚çœå†…å­˜ï¼Œä½†å®ƒä¸Šé¢çš„æŸ¥æ‰¾æ“ä½œåªèƒ½æŒ‰é¡ºåºæŸ¥æ‰¾ï¼ˆå¯ä»¥æ­£åºä¹Ÿå¯ä»¥å€’åºï¼‰ã€‚å› æ­¤ï¼Œsorted set çš„å„ä¸ªæŸ¥è¯¢æ“ä½œï¼Œå°±æ˜¯åœ¨ ziplist ä¸Šä»å‰å‘åï¼ˆæˆ–ä»åå‘å‰ï¼‰ä¸€æ­¥æ­¥æŸ¥æ‰¾ï¼Œæ¯ä¸€æ­¥å‰è¿›ä¸¤ä¸ªæ•°æ®é¡¹ï¼Œè·¨åŸŸä¸€ä¸ª(æ•°æ®, score)å¯¹ã€‚\n\néšç€æ•°æ®çš„æ’å…¥ï¼Œsorted set åº•å±‚çš„è¿™ä¸ª ziplist å°±å¯èƒ½ä¼šè½¬æˆ zset çš„å®ç°ã€‚é‚£ä¹ˆåˆ°åº•æ’å…¥å¤šå°‘æ‰ä¼šè½¬å‘¢ï¼Ÿ\n\n> zset-max-ziplist-entries 128\t# å½“sorted setä¸­çš„å…ƒç´ ä¸ªæ•°ï¼Œå³(æ•°æ®ï¼Œ score)å¯¹çš„æ•°ç›®è¶…è¿‡128çš„æ—¶å€™\n> zset-max-ziplist-value 64\t# å½“sorted setä¸­æ’å…¥çš„ä»»æ„ä¸€ä¸ªæ•°æ®çš„é•¿åº¦è¶…è¿‡äº†64çš„æ—¶å€™ã€‚\n\n**sorted set ziplistå®ç°**\nRedis çš„ zset æ˜¯ä¸€ä¸ªå¤åˆç»“æ„ï¼Œä¸€æ–¹é¢å®ƒéœ€è¦ä¸€ä¸ª hash ç»“æ„æ¥å­˜å‚¨ value å’Œ score çš„å¯¹åº”å…³ç³»ï¼Œå¦ä¸€æ–¹é¢éœ€è¦æä¾›æŒ‰ç…§ score æ¥æ’åºçš„åŠŸèƒ½ï¼Œè¿˜éœ€è¦èƒ½å¤ŸæŒ‡å®š score çš„èŒƒå›´æ¥è·å– value åˆ—è¡¨çš„åŠŸèƒ½ï¼Œè¿™å°±éœ€è¦å¦å¤–ä¸€ä¸ªç»“æ„ã€Œè·³è·ƒè¡¨ã€ã€‚\n\n```c\ntypedef struct zset {\n    dict *dict;\n    zskiplist *zsl;\n} zset;\n```\n\nè·³è¡¨ï¼šé“¾è¡¨+å¤šçº§ç´¢å¼•ï¼ˆç©ºé—´æ¢æ—¶é—´ï¼‰\n\nå’Œå…¶ä»–ç»“æ„çš„æ¯”è¾ƒï¼š\n\nå¯¹äºæœ‰åºé›†åˆçš„åº•å±‚å®ç°ï¼Œå¯ä»¥ç”¨æ•°ç»„ã€å¹³è¡¡æ ‘ã€é“¾è¡¨ç­‰ã€‚æ•°ç»„ä¸ä¾¿å…ƒç´ çš„æ’å…¥ã€åˆ é™¤ï¼›å¹³è¡¡æ ‘æˆ–çº¢é»‘æ ‘è™½ç„¶æ•ˆç‡é«˜ä½†ç»“æ„å¤æ‚ï¼›é“¾è¡¨æŸ¥è¯¢éœ€è¦éå†æ‰€æœ‰æ•ˆç‡ä½ã€‚Redis é‡‡ç”¨çš„æ˜¯è·³è·ƒè¡¨ã€‚è·³è·ƒè¡¨æ•ˆç‡å ªæ¯”çº¢é»‘æ ‘ï¼Œå®ç°è¿œæ¯”çº¢é»‘æ ‘ç®€å•ã€‚\n\n***\n\n## ä¸‰å¤§ç‰¹æ®Šæ•°æ®ç±»å‹\n\n### geospatialï¼ˆåœ°ç†ä½ç½®ï¼‰\n\n1. æŸ¥çœ‹é™„è¿‘çš„äºº\n2. å¾®ä¿¡ä½ç½®å…±äº«\n3. åœ°å›¾ä¸Šç›´çº¿è·ç¦»çš„å±•ç¤º\n\n### Hyperloglogï¼ˆåŸºæ•°ï¼‰\n\nåŸºæ•°ï¼šä¸é‡å¤çš„å…ƒç´ \n\nç½‘é¡µç»Ÿè®¡ UV ï¼ˆæµè§ˆç”¨æˆ·æ•°é‡ï¼ŒåŒä¸€å¤©åŒä¸€ä¸ª ip å¤šæ¬¡è®¿é—®ç®—ä¸€æ¬¡è®¿é—®ï¼Œç›®çš„æ˜¯è®¡æ•°ï¼Œè€Œä¸æ˜¯ä¿å­˜ç”¨æˆ·ï¼‰\n\nä¼ ç»Ÿçš„æ–¹å¼ï¼Œset ä¿å­˜ç”¨æˆ·çš„ idï¼Œå¯ä»¥ç»Ÿè®¡ set ä¸­å…ƒç´ æ•°é‡ä½œä¸ºæ ‡å‡†åˆ¤æ–­ã€‚\n\nä½†å¦‚æœè¿™ç§æ–¹å¼ä¿å­˜å¤§é‡ç”¨æˆ· idï¼Œä¼šå ç”¨å¤§é‡å†…å­˜ï¼Œæˆ‘ä»¬çš„ç›®çš„æ˜¯ä¸ºäº†è®¡æ•°ï¼Œè€Œä¸æ˜¯å»ä¿å­˜ idã€‚\n\n### Bitmapsï¼ˆä½å­˜å‚¨ï¼‰\n\nRedis æä¾›äº† Bitmaps è¿™ä¸ªâ€œæ•°æ®ç±»å‹â€å¯ä»¥å®ç°å¯¹ä½çš„æ“ä½œï¼š\n\n1. Bitmaps æœ¬èº«ä¸æ˜¯ä¸€ç§æ•°æ®ç±»å‹ï¼Œ å®é™…ä¸Šå®ƒå°±æ˜¯å­—ç¬¦ä¸²ï¼ˆkey-valueï¼‰ ï¼Œ ä½†æ˜¯å®ƒå¯ä»¥å¯¹å­—ç¬¦ä¸²çš„ä½è¿›è¡Œæ“ä½œã€‚\n2. Bitmaps å•ç‹¬æä¾›äº†ä¸€å¥—å‘½ä»¤ï¼Œ æ‰€ä»¥åœ¨ Redis ä¸­ä½¿ç”¨ Bitmaps å’Œä½¿ç”¨å­—ç¬¦ä¸²çš„æ–¹æ³•ä¸å¤ªç›¸åŒã€‚ å¯ä»¥æŠŠ Bitmaps æƒ³è±¡æˆä¸€ä¸ªä»¥ä½ä¸ºå•ä½çš„æ•°ç»„ï¼Œ æ•°ç»„çš„æ¯ä¸ªå•å…ƒåªèƒ½å­˜å‚¨ 0 å’Œ 1ï¼Œ æ•°ç»„çš„ä¸‹æ ‡åœ¨ Bitmaps ä¸­å«åšåç§»é‡ã€‚\n\n#### å‘½ä»¤\n\n1. setbit\n\n\t`setbit<key><offset><value>` è®¾ç½® Bitmaps ä¸­æŸä¸ªåç§»é‡çš„å€¼ï¼ˆ0 æˆ– 1ï¼‰\n\n\tå¯ä»¥å°† idx ä½ç½®ä¸º 1 è¡¨ç¤º idx ç”¨æˆ·è®¿é—®è¿‡\n\n2. getbit\n\n\t`getbit<key><offset>` è·å– Bitmaps ä¸­æŸä¸ªåç§»é‡çš„å€¼\n\n\té€šè¿‡ idx ä½æ˜¯å¦ä¸º 1 åˆ¤æ–­ idx ç”¨æˆ·æ˜¯å¦è®¿é—®è¿‡\n\n3. bitcount\n\n\t`bitcount<key>[start end]` ç»Ÿè®¡å­—ç¬¦ä¸²ä» start å­—èŠ‚åˆ° end å­—èŠ‚æ¯”ç‰¹å€¼ä¸º 1 çš„æ•°é‡\n\n4. bitop\n\n\t`bitop and(or/not/xor) <destkey> [keyâ€¦]` bitop æ˜¯ä¸€ä¸ªå¤åˆæ“ä½œï¼Œ å®ƒå¯ä»¥åšå¤šä¸ª Bitmaps çš„ andï¼ˆäº¤é›†ï¼‰ ã€ orï¼ˆå¹¶é›†ï¼‰ ã€ notï¼ˆéï¼‰ ã€ xorï¼ˆå¼‚æˆ–ï¼‰ æ“ä½œå¹¶å°†ç»“æœä¿å­˜åœ¨ destkey ä¸­ã€‚\n\n#### **åº”ç”¨åœºæ™¯**\n\n**ä¸¤ç§çŠ¶æ€çš„ç»Ÿè®¡**éƒ½å¯ä»¥ä½¿ç”¨ bitmapsï¼Œä¾‹å¦‚ï¼šç»Ÿè®¡ç”¨æˆ·æ´»è·ƒä¸éæ´»è·ƒæ•°é‡ã€ç™»å½•ä¸éç™»å½•ã€ä¸Šç­æ‰“å¡ç­‰ç­‰ã€‚\n\n***\n\n## Redisäº‹åŠ¡ä¸é”æœºåˆ¶\n\n### äº‹åŠ¡\n\näº‹åŠ¡æœ¬è´¨ï¼šä¸€ç»„å‘½ä»¤çš„é›†åˆ\n\n#### **æ•°æ®åº“çš„äº‹åŠ¡**\n\næ•°æ®åº“äº‹åŠ¡é€šè¿‡ ACIDï¼ˆåŸå­æ€§ã€ä¸€è‡´æ€§ã€éš”ç¦»æ€§ã€æŒä¹…æ€§ï¼‰æ¥ä¿è¯ã€‚\n\næ•°æ®åº“ä¸­é™¤æŸ¥è¯¢æ“ä½œä»¥å¤–ï¼Œæ’å…¥(Insert)ã€åˆ é™¤(Delete)å’Œæ›´æ–°(Update)è¿™ä¸‰ç§æ“ä½œéƒ½ä¼šå¯¹æ•°æ®é€ æˆå½±å“ï¼Œå› ä¸ºäº‹åŠ¡å¤„ç†èƒ½å¤Ÿä¿è¯ä¸€ç³»åˆ—æ“ä½œå¯ä»¥å®Œå…¨åœ°æ‰§è¡Œæˆ–è€…å®Œå…¨ä¸æ‰§è¡Œï¼Œå› æ­¤åœ¨ä¸€ä¸ªäº‹åŠ¡è¢«æäº¤ä»¥åï¼Œè¯¥äº‹åŠ¡ä¸­çš„ä»»ä½•ä¸€æ¡ SQL è¯­å¥åœ¨è¢«æ‰§è¡Œçš„æ—¶å€™ï¼Œéƒ½ä¼šç”Ÿæˆä¸€æ¡æ’¤é”€æ—¥å¿—(Undo Log)ã€‚\n\n#### Redis äº‹åŠ¡\n\nRedis äº‹åŠ¡æä¾›äº†ä¸€ç§â€œå°†å¤šä¸ªå‘½ä»¤æ‰“åŒ…ï¼Œ ç„¶åä¸€æ¬¡æ€§ã€æŒ‰é¡ºåºåœ°æ‰§è¡Œâ€çš„æœºåˆ¶ï¼Œ å¹¶ä¸”äº‹åŠ¡åœ¨æ‰§è¡Œçš„æœŸé—´ä¸ä¼šä¸»åŠ¨ä¸­æ–­ â€”â€” æœåŠ¡å™¨åœ¨æ‰§è¡Œå®Œäº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤ä¹‹åï¼Œ æ‰ä¼šç»§ç»­å¤„ç†å…¶ä»–å®¢æˆ·ç«¯çš„å…¶ä»–å‘½ä»¤ã€‚äº‹åŠ¡ä¸­å¦‚æœæœ‰ä¸€æ¡å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œå…¶åçš„å‘½ä»¤ä»ç„¶ä¼šè¢«æ‰§è¡Œï¼Œæ²¡æœ‰å›æ»šã€‚\n\nRedis ä¸­ä¸€ä¸ªäº‹åŠ¡ä»å¼€å§‹åˆ°æ‰§è¡Œä¼šç»å†**å¼€å§‹**äº‹åŠ¡ï¼ˆMuitiï¼‰ã€å‘½ä»¤**ç»„é˜Ÿ**å’Œ**æ‰§è¡Œ**äº‹åŠ¡(Exec)ä¸‰ä¸ªé˜¶æ®µï¼Œäº‹åŠ¡ä¸­çš„å‘½ä»¤åœ¨åŠ å…¥æ—¶éƒ½æ²¡æœ‰è¢«æ‰§è¡Œï¼Œç›´åˆ°æäº¤æ—¶æ‰ä¼šå¼€å§‹æ‰§è¡Œ(Exec)ä¸€æ¬¡æ€§å®Œæˆã€‚\n\nç»„é˜Ÿçš„è¿‡ç¨‹ä¸­å¯ä»¥é€šè¿‡ discard æ¥æ”¾å¼ƒç»„é˜Ÿã€‚\n\n**äº‹åŠ¡çš„é”™è¯¯å¤„ç†**\n\nç»„é˜Ÿé˜¶æ®µæŸä¸ªå‘½ä»¤æŠ¥é”™ï¼Œæ‰§è¡Œæ—¶æ•´ä¸ªé˜Ÿåˆ—éƒ½ä¼šè¢«å–æ¶ˆã€‚\n\n![ç»„é˜Ÿé˜¶æ®µæŸä¸ªå‘½ä»¤æŠ¥é”™](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650372301056.png)\n\nå¦‚æœæ‰§è¡Œé˜¶æ®µæŸä¸ªå‘½ä»¤æŠ¥é”™ï¼Œåˆ™åªæœ‰æŠ¥é”™çš„å‘½ä»¤ä¸ä¼šè¢«æ‰§è¡Œï¼Œè€Œå…¶ä»–çš„å‘½ä»¤éƒ½ä¼šæ‰§è¡Œï¼Œä¸ä¼šå›æ»šã€‚ï¼ˆä¸ä¿è¯äº‹åŠ¡çš„åŸå­æ€§ï¼‰\n\n![æ‰§è¡Œé˜¶æ®µæŸä¸ªå‘½ä»¤æŠ¥é”™](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650372359361.png)\n\n**ä¸ºä»€ä¹ˆ Redis ä¸æ”¯æŒå›æ»šæ¥ä¿è¯åŸå­æ€§**\n\nRedis å‘½ä»¤åªä¼šå› ä¸ºé”™è¯¯çš„è¯­æ³•è€Œå¤±è´¥ï¼Œç„¶è€Œæ²¡æœ‰ä»»ä½•æœºåˆ¶èƒ½é¿å…ç¨‹åºå‘˜è‡ªå·±é€ æˆçš„é”™è¯¯ï¼Œ å¹¶ä¸”è¿™ç±»é”™è¯¯é€šå¸¸ä¸ä¼šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­å‡ºç°ï¼Œ æ‰€ä»¥ Redis é€‰æ‹©äº†æ›´ç®€å•ã€æ›´å¿«é€Ÿçš„æ— å›æ»šæ–¹å¼æ¥å¤„ç†äº‹åŠ¡ã€‚\n\n### Redis é”\n\n#### æ‚²è§‚é”\n\n**æ‚²è§‚é”(Pessimistic Lock)**ï¼Œ é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¾ˆæ‚²è§‚ï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¼šä¿®æ”¹ï¼Œæ‰€ä»¥æ¯æ¬¡åœ¨æ‹¿æ•°æ®çš„æ—¶å€™éƒ½ä¼šä¸Šé”ï¼Œè¿™æ ·åˆ«äººæƒ³æ‹¿è¿™ä¸ªæ•°æ®å°±ä¼šé˜»å¡ç›´åˆ°å®ƒæ‹¿åˆ°é”ã€‚**ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“é‡Œè¾¹å°±ç”¨åˆ°äº†å¾ˆå¤šè¿™ç§é”æœºåˆ¶**ï¼Œæ¯”å¦‚**è¡Œé”**ï¼Œ**è¡¨é”**ç­‰ï¼Œ**è¯»é”**ï¼Œ**å†™é”**ç­‰ï¼Œéƒ½æ˜¯åœ¨åšæ“ä½œä¹‹å‰å…ˆä¸Šé”ã€‚\n\n![æ‚²è§‚é”](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650417157625.png)\n\n> çº¿ç¨‹ 1 æ‹¿åˆ°è´¦æˆ·åæŠŠè´¦æˆ·é”ä½ï¼Œç„¶åæ“ä½œï¼Œè¿™æ—¶å€™çº¿ç¨‹ 2 ä¹Ÿæƒ³æ‹¿è´¦æˆ·ï¼Œå‘ç°åŠ äº†é”æ‹¿ä¸åˆ°ï¼Œåªèƒ½é˜»å¡ç­‰åˆ°é”é‡Šæ”¾ã€‚\n\n#### ä¹è§‚é”\n\n**ä¹è§‚é”(Optimistic Lock)ï¼Œ** é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¾ˆä¹è§‚ï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¸ä¼šä¿®æ”¹ï¼Œæ‰€ä»¥ä¸ä¼šä¸Šé”ï¼Œä½†æ˜¯åœ¨**æ›´æ–°çš„æ—¶å€™åˆ¤æ–­**ä¸€ä¸‹åœ¨æ­¤æœŸé—´åˆ«äººæœ‰æ²¡æœ‰å»æ›´æ–°è¿™ä¸ªæ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ç‰ˆæœ¬å·ç­‰æœºåˆ¶ã€‚**ä¹è§‚é”é€‚ç”¨äºå¤šè¯»çš„åº”ç”¨ç±»å‹ï¼Œè¿™æ ·å¯ä»¥æé«˜ååé‡**ã€‚Redis å°±æ˜¯åˆ©ç”¨è¿™ç§æœºåˆ¶å®ç°äº‹åŠ¡çš„ã€‚\n\n![ä¹è§‚é”](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650417222072.png)\n\n> ç»™è´¦æˆ·æ•°æ®åŠ ä¸€ä¸ªç‰ˆæœ¬å·ï¼Œå‡å¦‚çº¿ç¨‹ 1ã€2 éƒ½æ‹¿åˆ°è´¦æˆ·ï¼Œçº¿ç¨‹ 1 ä½¿ç”¨è´¦æˆ·å‰å…ˆè¿›è¡Œç‰ˆæœ¬å·æ¯”è¾ƒï¼Œv1.0 = v1.0ï¼Œåˆ™æ‰£å‡è´¦æˆ·ä½™é¢ï¼Œè´¦æˆ·ç‰ˆæœ¬å·å˜æ›´ä¸º v1.1ï¼Œçº¿ç¨‹ 2 å‡†å¤‡æ“ä½œæ•°æ®åº“ï¼Œå‘ç°è‡ªå·±é¢„æœŸçš„è´¦æˆ·ç‰ˆæœ¬å· v1.0 å’Œå½“å‰è´¦æˆ·ç‰ˆæœ¬å· v1.1 ä¸åŒï¼ˆCASï¼‰ï¼Œåˆ™ä¸èƒ½æ“ä½œã€‚ \n\n***\n\n## RedisæŒä¹…åŒ–\n\nRedis æ˜¯ä¸€ç§å†…å­˜å‹æ•°æ®åº“ï¼Œä¸€æ—¦æœåŠ¡å™¨è¿›ç¨‹é€€å‡ºï¼Œæ•°æ®åº“çš„æ•°æ®å°±ä¼šä¸¢å¤±ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ Redis ä¾›äº†ä¸¤ç§æŒä¹…åŒ–çš„æ–¹æ¡ˆï¼Œå°†å†…å­˜ä¸­çš„æ•°æ®ä¿å­˜åˆ°ç£ç›˜ä¸­ï¼Œé¿å…æ•°æ®çš„ä¸¢å¤±ã€‚\n\nä¸¤ç§æŒä¹…åŒ–æ–¹å¼ï¼šå¿«ç…§ï¼ˆRDB æ–‡ä»¶ï¼‰å’Œè¿½åŠ å¼æ–‡ä»¶ï¼ˆAOF æ–‡ä»¶ï¼‰ï¼Œä¸‹é¢åˆ†åˆ«ä¸ºå¤§å®¶ä»‹ç»ä¸¤ç§æ–¹å¼çš„åŸç†ã€‚\n\n- RDB æŒä¹…åŒ–æ–¹å¼ä¼šåœ¨ä¸€ä¸ªç‰¹å®šçš„é—´éš”ä¿å­˜é‚£ä¸ªæ—¶é—´ç‚¹çš„æ•°æ®å¿«ç…§ã€‚\n\n- AOF æŒä¹…åŒ–æ–¹å¼åˆ™ä¼šè®°å½•æ¯ä¸€ä¸ªæœåŠ¡å™¨æ”¶åˆ°çš„å†™æ“ä½œã€‚åœ¨æœåŠ¡å¯åŠ¨æ—¶ï¼Œè¿™äº›è®°å½•çš„æ“ä½œä¼šé€æ¡æ‰§è¡Œä»è€Œé‡å»ºå‡ºåŸæ¥çš„æ•°æ®ã€‚å†™æ“ä½œå‘½ä»¤è®°å½•çš„æ ¼å¼è·Ÿ Redis åè®®ä¸€è‡´ï¼Œä»¥è¿½åŠ çš„æ–¹å¼è¿›è¡Œä¿å­˜ã€‚\n\n- ä¸¤ç§æ–¹å¼çš„æŒä¹…åŒ–æ˜¯å¯ä»¥åŒæ—¶å­˜åœ¨çš„ï¼Œä½†æ˜¯å½“ Redis é‡å¯æ—¶ï¼ŒAOF æ–‡ä»¶ä¼šè¢«ä¼˜å…ˆç”¨äºé‡å»ºæ•°æ®ã€‚\n\n### RDB(Redis Database)\n\n> åœ¨æ»¡è¶³ç‰¹å®šçš„  Redis æ“ä½œæ¡ä»¶ï¼ˆæ—¶é—´å‘¨æœŸã€å†™æ“ä½œæ¬¡æ•°ï¼‰æ—¶ï¼Œå°†å†…å­˜ä¸­çš„æ•°æ®ä»¥ **æ•°æ®å¿«ç…§** çš„å½¢å¼å­˜å‚¨åˆ° db æ–‡ä»¶ä¸­\n\n#### **å·¥ä½œåŸç†**\n\n> [Redis_RDBæŒä¹…åŒ–ä¹‹å†™æ—¶å¤åˆ¶æŠ€æœ¯çš„åº”ç”¨](https://www.cnblogs.com/zyf98/p/15934058.html)\n\nRDB æ˜¯ä¸€æ¬¡çš„å…¨é‡å¤‡ä»½ï¼Œå³å‘¨æœŸæ€§çš„æŠŠ Redis å½“å‰å†…å­˜ä¸­çš„å…¨é‡æ•°æ®å†™å…¥åˆ°ä¸€ä¸ªå¿«ç…§æ–‡ä»¶ä¸­ã€‚Redis æ˜¯å•çº¿ç¨‹ç¨‹åºï¼Œè¿™ä¸ªçº¿ç¨‹è¦åŒæ—¶è´Ÿè´£å¤šä¸ªå®¢æˆ·ç«¯çš„è¯»å†™è¯·æ±‚ï¼Œè¿˜è¦è´Ÿè´£å‘¨æœŸæ€§çš„æŠŠå½“å‰å†…å­˜ä¸­çš„æ•°æ®å†™åˆ°å¿«ç…§æ–‡ä»¶ä¸­ RDB ä¸­ï¼Œé‚£ä¹ˆå°±ä¼šå¸¦æ¥ä»¥ä¸‹ä¸¤ä¸ªé—®é¢˜ï¼š\n\n1. æ•°æ®å†™åˆ° RDB æ–‡ä»¶æ˜¯ IO æ“ä½œï¼ŒIO æ“ä½œä¼šä¸¥é‡å½±å“ Redis çš„æ€§èƒ½ï¼Œç”šè‡³åœ¨æŒä¹…åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œè¯»å†™è¯·æ±‚ä¼šé˜»å¡\n2. å‡å¦‚ Redis æ­£åœ¨è¿›è¡ŒæŒä¹…åŒ–ä¸€ä¸ªå¤§çš„æ•°æ®ç»“æ„ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªåˆ é™¤è¯·æ±‚ï¼ŒæŠŠè¿™ä¸ªå¤§çš„æ•°æ®ç»“æ„åˆ æ‰äº†ï¼Œè¿™æ—¶å€™æŒä¹…åŒ–çš„åŠ¨ä½œè¿˜æ²¡æœ‰å®Œæˆã€‚\n\näºæ˜¯ Redis ä½¿ç”¨æ“ä½œç³»ç»Ÿçš„å¤šè¿›ç¨‹ **å†™æ—¶å¤åˆ¶(Copy On Write)æœºåˆ¶** æ¥å®ç°å¿«ç…§çš„æŒä¹…åŒ–ï¼Œåœ¨æŒä¹…åŒ–è¿‡ç¨‹ä¸­è°ƒç”¨**glibc**(Linux ä¸‹çš„ C å‡½æ•°åº“)çš„å‡½æ•° **fork()** äº§ç”Ÿä¸€ä¸ªå­è¿›ç¨‹ï¼Œè¯¥å­è¿›ç¨‹å’Œçˆ¶è¿›ç¨‹å…±äº«å†…å­˜é‡Œé¢çš„ä»£ç æ®µå’Œæ•°æ®æ®µï¼Œå¿«ç…§æŒä¹…åŒ–å®Œå…¨äº¤ç»™å­è¿›ç¨‹æ¥å¤„ç†ï¼Œçˆ¶è¿›ç¨‹ç»§ç»­å¤„ç†å®¢æˆ·ç«¯çš„è¯»å†™è¯·æ±‚ã€‚\n\n> å­è¿›ç¨‹å°†æ•°æ®å†™å…¥åˆ°ä¸€ä¸ªä¸´æ—¶ RDB æ–‡ä»¶ä¸­ã€‚å½“å­è¿›ç¨‹å®ŒæˆæŒä¹…åŒ–æ—¶ï¼ŒRedis ç”¨æ–° RDB æ–‡ä»¶æ›¿æ¢åŸæ¥çš„ RDB æ–‡ä»¶ï¼Œå¹¶åˆ é™¤æ—§çš„ RDB æ–‡ä»¶ã€‚\n\nåœ¨å­è¿›ç¨‹æŒä¹…åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœä¸»è¿›ç¨‹æ”¶åˆ°çš„å®¢æˆ·ç«¯çš„è¯»å†™è¯·æ±‚ï¼Œéœ€è¦ä¿®æ”¹æŸå—æ•°æ®ï¼Œé‚£ä¹ˆè¿™å—æ•°æ®å°±ä¼šè¢«å¤åˆ¶ä¸€ä»½åˆ°å†…å­˜ï¼Œç”Ÿæˆè¯¥æ•°æ®çš„å‰¯æœ¬ï¼Œä¸»è¿›ç¨‹åœ¨è¯¥å‰¯æœ¬ä¸Šè¿›è¡Œä¿®æ”¹æ“ä½œã€‚æ‰€ä»¥å³ä½¿å¯¹æŸä¸ªæ•°æ®è¿›è¡Œäº†ä¿®æ”¹ï¼ŒRedis æŒä¹…åŒ–åˆ° RDB ä¸­çš„æ•°æ®ä¹Ÿæ˜¯æœªä¿®æ”¹çš„æ•°æ®ï¼Œè¿™ä¹Ÿæ˜¯æŠŠ RDB æ–‡ä»¶ç§°ä¸º\"å¿«ç…§\"æ–‡ä»¶çš„åŸå› ï¼Œå­è¿›ç¨‹æ‰€çœ‹åˆ°çš„æ•°æ®åœ¨å®ƒè¢«åˆ›å»ºçš„ä¸€ç¬é—´å°±å›ºå®šä¸‹æ¥äº†ï¼Œçˆ¶è¿›ç¨‹ä¿®æ”¹çš„æŸä¸ªæ•°æ®åªæ˜¯è¯¥æ•°æ®çš„å¤åˆ¶å“ã€‚è¿™é‡Œå†æ·±å…¥ä¸€ç‚¹ï¼ŒRedis å†…å­˜ä¸­çš„å…¨é‡æ•°æ®ç”±ä¸€ä¸ªä¸ªçš„\"æ•°æ®æ®µé¡µé¢\"ç»„æˆï¼Œæ¯ä¸ªæ•°æ®æ®µé¡µé¢çš„å¤§å°ä¸º 4Kï¼Œå®¢æˆ·ç«¯è¦ä¿®æ”¹çš„æ•°æ®åœ¨å“ªä¸ªé¡µé¢ä¸­ï¼Œå°±ä¼šå¤åˆ¶ä¸€ä»½è¿™ä¸ªé¡µé¢åˆ°å†…å­˜ä¸­ï¼Œè¿™ä¸ªå¤åˆ¶çš„è¿‡ç¨‹ç§°ä¸º\"é¡µé¢åˆ†ç¦»\"ï¼Œåœ¨æŒä¹…åŒ–è¿‡ç¨‹ä¸­ï¼Œéšç€åˆ†ç¦»å‡ºçš„é¡µé¢è¶Šæ¥è¶Šå¤šï¼Œå†…å­˜å°±ä¼šæŒç»­å¢é•¿ï¼Œä½†æ˜¯ä¸ä¼šè¶…è¿‡åŸå†…å­˜çš„ 2 å€ï¼Œå› ä¸ºåœ¨ä¸€æ¬¡æŒä¹…åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œå‡ ä¹ä¸ä¼šå‡ºç°æ‰€æœ‰çš„é¡µé¢éƒ½ä¼šåˆ†ç¦»çš„æƒ…å†µï¼Œè¯»å†™è¯·æ±‚é’ˆå¯¹çš„åªæ˜¯åŸæ•°æ®ä¸­çš„å°éƒ¨åˆ†ï¼Œå¤§éƒ¨åˆ† Redis æ•°æ®è¿˜æ˜¯\"å†·æ•°æ®\"ã€‚\n\næ­£å› ä¸ºä¿®æ”¹çš„éƒ¨åˆ†æ•°æ®ä¼šè¢«é¢å¤–çš„å¤åˆ¶ä¸€ä»½ï¼Œæ‰€ä»¥ä¼šå ç”¨é¢å¤–çš„å†…å­˜ï¼Œå½“åœ¨è¿›è¡Œ RDB æŒä¹…åŒ–æ“ä½œçš„è¿‡ç¨‹ä¸­ï¼Œä¸æ­¤åŒæ—¶å¦‚æœæŒç»­å¾€ Redis ä¸­å†™å…¥çš„æ•°æ®é‡è¶Šå¤šï¼Œå°±ä¼šå¯¼è‡´å ç”¨çš„é¢å¤–å†…å­˜æ¶ˆè€—è¶Šå¤§ã€‚\n\n![RDB æŒä¹…åŒ–](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes2093494-20220226233822789-2067752089.png)\n\n**ä¼˜ç‚¹**ï¼š\n\n1. RDB çš„å†…å®¹ä¸ºäºŒè¿›åˆ¶çš„æ•°æ®ï¼Œå ç”¨å†…å­˜æ›´å°ï¼Œæ›´ç´§å‡‘ï¼Œæ›´é€‚åˆåšä¸ºå¤‡ä»½æ–‡ä»¶ï¼›\n2. RDB å¯¹ç¾éš¾æ¢å¤éå¸¸æœ‰ç”¨ï¼Œå®ƒæ˜¯ä¸€ä¸ªç´§å‡‘çš„æ–‡ä»¶ï¼Œå¯ä»¥æ›´å¿«çš„ä¼ è¾“åˆ°è¿œç¨‹æœåŠ¡å™¨è¿›è¡Œ Redis æœåŠ¡æ¢å¤ï¼›\n3. RDB å¯ä»¥æ›´å¤§ç¨‹åº¦çš„æé«˜ Redis çš„è¿è¡Œé€Ÿåº¦ï¼Œå› ä¸ºæ¯æ¬¡æŒä¹…åŒ–æ—¶ Redis ä¸»è¿›ç¨‹éƒ½ä¼š fork() ä¸€ä¸ªå­è¿›ç¨‹ï¼Œè¿›è¡Œæ•°æ®æŒä¹…åŒ–åˆ°ç£ç›˜ï¼ŒRedis ä¸»è¿›ç¨‹å¹¶ä¸ä¼šæ‰§è¡Œç£ç›˜ I/O ç­‰æ“ä½œï¼›\n4. ä¸ AOF æ ¼å¼çš„æ–‡ä»¶ç›¸æ¯”ï¼ŒRDB æ–‡ä»¶å¯ä»¥æ›´å¿«çš„é‡å¯ã€‚\n\n**ç¼ºç‚¹**ï¼š\n\n1. å› ä¸º RDB åªèƒ½ä¿å­˜æŸä¸ªæ—¶é—´é—´éš”çš„æ•°æ®ï¼Œå¦‚æœä¸­é€” Redis æœåŠ¡è¢«æ„å¤–ç»ˆæ­¢äº†ï¼Œåˆ™ä¼šä¸¢å¤±ä¸€æ®µæ—¶é—´å†…çš„ Redis æ•°æ®ã€‚\n2. RDB éœ€è¦ç»å¸¸ fork() æ‰èƒ½ä½¿ç”¨å­è¿›ç¨‹å°†å…¶æŒä¹…åŒ–åœ¨ç£ç›˜ä¸Šã€‚å¦‚æœæ•°æ®é›†å¾ˆå¤§ï¼Œfork() å¯èƒ½å¾ˆè€—æ—¶ï¼Œå¹¶ä¸”å¦‚æœæ•°æ®é›†å¾ˆå¤§ä¸” CPU æ€§èƒ½ä¸ä½³ï¼Œåˆ™å¯èƒ½å¯¼è‡´ Redis åœæ­¢ä¸ºå®¢æˆ·ç«¯æœåŠ¡å‡ æ¯«ç§’ç”šè‡³ä¸€ç§’é’Ÿã€‚\n\n### AOF(Append Only File)\n\nä»¥æ—¥å¿—çš„å½¢å¼æ¥è®°å½•æ¯ä¸ªå†™çš„æ“ä½œï¼Œå°† Redis æ‰§è¡Œè¿‡çš„æ‰€æœ‰æŒ‡ä»¤è®°å½•ä¸‹æ¥ï¼ˆè¯»æ“ä½œä¸è®°å½•ï¼‰ï¼Œåªè®¸è¿½åŠ æ–‡ä»¶ä½†ä¸å¯ä»¥æ”¹å†™æ–‡ä»¶ï¼ŒRedis å¯åŠ¨ä¹‹åˆä¼šè¯»å–è¯¥æ–‡ä»¶é‡æ–°æ„å»ºæ•°æ®ï¼Œæ¢è¨€ä¹‹ï¼ŒRedis é‡å¯çš„è¯å°±æ ¹æ®æ—¥å¿—æ–‡ä»¶çš„å†…å®¹å°†å†™æŒ‡ä»¤ä»å‰åˆ°åæ‰§è¡Œä¸€æ¬¡ä»¥å®Œæˆæ•°æ®çš„æ¢å¤å·¥ä½œã€‚\n\n#### **AOFé…ç½®é¡¹**\n\n```\n# é»˜è®¤ä¸å¼€å¯aof  è€Œæ˜¯ä½¿ç”¨rdbçš„æ–¹å¼\nappendonly no\n\n# é»˜è®¤æ–‡ä»¶å\nappendfilename \"appendonly.aof\"\n\n# æ¯æ¬¡ä¿®æ”¹éƒ½ä¼šsync æ¶ˆè€—æ€§èƒ½\n# appendfsync always\n# æ¯ç§’æ‰§è¡Œä¸€æ¬¡ sync å¯èƒ½ä¼šä¸¢å¤±è¿™ä¸€ç§’çš„æ•°æ®\nappendfsync everysec\n# ä¸æ‰§è¡Œ sync ï¼Œè¿™æ—¶å€™æ“ä½œç³»ç»Ÿè‡ªå·±åŒæ­¥æ•°æ®ï¼Œé€Ÿåº¦æœ€å¿«\n# appendfsync no \n```\n\nAOF çš„æ•´ä¸ªæµç¨‹å¤§ä½“æ¥çœ‹å¯ä»¥åˆ†ä¸ºä¸¤æ­¥ï¼Œç¬¬ä¸€æ­¥æ˜¯å‘½ä»¤çš„å®æ—¶å†™å…¥ï¼ˆå¦‚æœæ˜¯ appendfsync everysec é…ç½®ï¼Œä¼šæœ‰ 1s æŸè€—ï¼‰ï¼Œç¬¬äºŒæ­¥æ˜¯å¯¹ aof æ–‡ä»¶çš„é‡å†™ã€‚\n\n#### **AOF é‡å†™æœºåˆ¶**\n\néšç€ Redis çš„è¿è¡Œï¼ŒAOF çš„æ—¥å¿—ä¼šè¶Šæ¥è¶Šé•¿ï¼Œå¦‚æœå®ä¾‹å®•æœºé‡å¯ï¼Œé‚£ä¹ˆé‡æ”¾æ•´ä¸ª AOF å°†ä¼šå˜å¾—ååˆ†è€—æ—¶ï¼Œè€Œåœ¨æ—¥å¿—è®°å½•ä¸­ï¼Œåˆæœ‰å¾ˆå¤šæ— æ„ä¹‰çš„è®°å½•ï¼Œæ¯”å¦‚æˆ‘ç°åœ¨å°†ä¸€ä¸ªæ•°æ® incr ä¸€åƒæ¬¡ï¼Œé‚£ä¹ˆå°±ä¸éœ€è¦å»è®°å½•è¿™ 1000 æ¬¡ä¿®æ”¹ï¼Œåªéœ€è¦è®°å½•æœ€åçš„å€¼å³å¯ã€‚æ‰€ä»¥å°±éœ€è¦è¿›è¡Œ AOF é‡å†™ã€‚\n\nRedis æä¾›äº† bgrewriteaof æŒ‡ä»¤ç”¨äºå¯¹ AOF æ—¥å¿—è¿›è¡Œé‡å†™ï¼Œè¯¥æŒ‡ä»¤è¿è¡Œæ—¶ä¼šå¼€è¾Ÿä¸€ä¸ªå­è¿›ç¨‹å¯¹å†…å­˜è¿›è¡Œéå†ï¼Œç„¶åå°†å…¶è½¬æ¢ä¸ºä¸€ç³»åˆ—çš„ Redis çš„æ“ä½œæŒ‡ä»¤ï¼Œå†åºåˆ—åŒ–åˆ°ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ä¸­ã€‚å®Œæˆåå†æ›¿æ¢åŸæœ‰çš„ AOF æ–‡ä»¶ï¼Œè‡³æ­¤å®Œæˆã€‚\n\nåŒæ ·çš„ä¹Ÿå¯ä»¥åœ¨ Redis.config ä¸­å¯¹é‡å†™æœºåˆ¶çš„è§¦å‘è¿›è¡Œé…ç½®ï¼š\n\né€šè¿‡å°† no-appendfsync-on-rewrite è®¾ç½®ä¸º yesï¼Œå¼€å¯é‡å†™æœºåˆ¶ï¼›auto-aof-rewrite-percentage 100 æ„ä¸ºæ¯”ä¸Šæ¬¡ä»å†™åæ–‡ä»¶å¤§å°å¢é•¿äº† 100%å†æ¬¡è§¦å‘é‡å†™ï¼›\n\nauto-aof-rewrite-min-size 64mb æ„ä¸ºå½“æ–‡ä»¶è‡³å°‘è¦è¾¾åˆ° 64mb æ‰ä¼šè§¦å‘åˆ¶åŠ¨é‡å†™ã€‚\n\n**ä¼˜ç‚¹**ï¼š\n\n1ã€æ•°æ®å®‰å…¨ï¼ŒAOF æ˜¯å¯¹æŒ‡ä»¤æ–‡ä»¶è¿›è¡Œ **å¢é‡æ›´æ–°**ï¼Œæ›´é€‚åˆå®æ—¶æ€§æŒä¹…åŒ–ã€‚\n\n2ã€é€šè¿‡ append æ¨¡å¼å†™æ–‡ä»¶ï¼Œå³ä½¿ä¸­é€”æœåŠ¡å™¨å®•æœºï¼Œå¯ä»¥é€šè¿‡ Redis-check-aof å·¥å…·è§£å†³æ•°æ®ä¸€è‡´æ€§é—®é¢˜ã€‚\n\n3ã€AOF æœºåˆ¶çš„ rewrite æ¨¡å¼ã€‚AOF æ–‡ä»¶æ²¡è¢« rewrite ä¹‹å‰ï¼ˆæ–‡ä»¶è¿‡å¤§æ—¶ä¼šå¯¹å‘½ä»¤ è¿›è¡Œåˆå¹¶é‡å†™ï¼‰ï¼Œå¯ä»¥åˆ é™¤å…¶ä¸­çš„æŸäº›å‘½ä»¤ï¼ˆæ¯”å¦‚è¯¯æ“ä½œçš„ flushallï¼‰)\n\n**ç¼ºç‚¹**ï¼š\n\n1ã€AOF æ–‡ä»¶æ¯” RDB æ–‡ä»¶å¤§ï¼Œä¸”æ¢å¤é€Ÿåº¦æ…¢ã€‚\n\n2ã€æ•°æ®é›†å¤§çš„æ—¶å€™ï¼Œæ¯” RDB å¯åŠ¨æ•ˆç‡ä½ã€‚\n\n### RDBä¸AOFå¯¹æ¯”\n\nRedis å®˜æ–¹å»ºè®®åŒæ—¶å¼€å¯ä¸¤ç§æŒä¹…åŒ–ç­–ç•¥ï¼ŒAOF å’Œ RDB åŒæ—¶å¼€å¯ï¼Œç³»ç»Ÿé»˜è®¤å– AOF çš„æ•°æ®ï¼ˆæ•°æ®ä¸ä¼šå­˜åœ¨ä¸¢å¤±ï¼‰\n\n| æ¯”è¾ƒé¡¹     | RDB    | AOF          |\n| ---------- | ------ | ------------ |\n| å¯åŠ¨ä¼˜å…ˆçº§ | ä½     | é«˜           |\n| ä½“ç§¯       | å°     | å¤§           |\n| æ¢å¤é€Ÿåº¦   | å¿«     | æ…¢           |\n| æ•°æ®å®‰å…¨æ€§ | ä¸¢æ•°æ® | æ ¹æ®ç­–ç•¥å†³å®š |\n\n***\n\n## å‘å¸ƒä¸è®¢é˜…\n\nRedis å‘å¸ƒä¸è®¢é˜…æ˜¯ä¸€ç§æ¶ˆæ¯é€šä¿¡çš„æ¨¡å¼ï¼šå‘é€è€…ï¼ˆpubï¼‰å‘é€æ¶ˆæ¯ï¼Œè®¢é˜…è€…ï¼ˆsubï¼‰æ¥æ”¶æ¶ˆæ¯ã€‚\n\nRedis é€šè¿‡ PUBLISH å’Œ SUBSCRIBE ç­‰å‘½ä»¤å®ç°äº†è®¢é˜…ä¸å‘å¸ƒæ¨¡å¼ï¼Œè¿™ä¸ªåŠŸèƒ½æä¾›ä¸¤ç§ä¿¡æ¯æœºåˆ¶ï¼Œåˆ†åˆ«æ˜¯è®¢é˜…/å‘å¸ƒåˆ°é¢‘é“ã€è®¢é˜…/å‘å¸ƒåˆ°æ¨¡å¼çš„å®¢æˆ·ç«¯ã€‚\n\n### é¢‘é“ï¼ˆchannelï¼‰\n\n**è®¢é˜…**\n\n![é¢‘é“è®¢é˜…](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650436261125.png)\n\n**å‘å¸ƒ**\n\n![é¢‘é“å‘å¸ƒ](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650436267143.png)\n\n#### **å®Œæ•´æµç¨‹**\n\nå‘å¸ƒè€…å‘é¢‘é“ channel:1 å‘å¸ƒæ¶ˆæ¯ hi\n\n```\n127.0.0.1:6379> publish channel:1 hi(integer) 1\n```\n\nè®¢é˜…è€…è®¢é˜…æ¶ˆæ¯\n\n```\n127.0.0.1:6379> subscribe channel:1\nReading messages... (press Ctrl-C to quit)\n1) \"subscribe\" // æ¶ˆæ¯ç±»å‹\n2) \"channel:1\" // é¢‘é“\n3) \"hi\" // æ¶ˆæ¯å†…å®¹\n```\n\næ‰§è¡Œ subscribe åå®¢æˆ·ç«¯ä¼šè¿›å…¥è®¢é˜…çŠ¶æ€ï¼Œä»…å¯ä»¥ä½¿ subscribeã€unsubscribeã€psubscribe å’Œ punsubscribe è¿™å››ä¸ªå±äº\"å‘å¸ƒ/è®¢é˜…\"ä¹‹å¤–çš„å‘½ä»¤\n\nè®¢é˜…é¢‘é“åçš„å®¢æˆ·ç«¯å¯èƒ½ä¼šæ”¶åˆ°ä¸‰ç§æ¶ˆæ¯ç±»å‹\n\n- subscribeï¼šè¡¨ç¤ºè®¢é˜…æˆåŠŸçš„åé¦ˆä¿¡æ¯ã€‚ç¬¬äºŒä¸ªå€¼æ˜¯è®¢é˜…æˆåŠŸçš„é¢‘é“åç§°ï¼Œç¬¬ä¸‰ä¸ªæ˜¯å½“å‰å®¢æˆ·ç«¯è®¢é˜…çš„é¢‘é“æ•°é‡ã€‚\n\n- messageï¼šè¡¨ç¤ºæ¥æ”¶åˆ°çš„æ¶ˆæ¯ï¼Œç¬¬äºŒä¸ªå€¼è¡¨ç¤ºäº§ç”Ÿæ¶ˆæ¯çš„é¢‘é“åç§°ï¼Œç¬¬ä¸‰ä¸ªå€¼æ˜¯æ¶ˆæ¯çš„å†…å®¹ã€‚\n\n- unsubscribeï¼šè¡¨ç¤ºæˆåŠŸå–æ¶ˆè®¢é˜…æŸä¸ªé¢‘é“ã€‚ç¬¬äºŒä¸ªå€¼æ˜¯å¯¹åº”çš„é¢‘é“åç§°ï¼Œç¬¬ä¸‰ä¸ªå€¼æ˜¯å½“å‰å®¢æˆ·ç«¯è®¢é˜…çš„é¢‘é“æ•°é‡ï¼Œå½“æ­¤å€¼ä¸º 0 æ—¶å®¢æˆ·ç«¯ä¼šé€€å‡ºè®¢é˜…çŠ¶æ€ï¼Œä¹‹åå°±å¯ä»¥æ‰§è¡Œå…¶ä»–é\"å‘å¸ƒ/è®¢é˜…\"æ¨¡å¼çš„å‘½ä»¤äº†ã€‚\n\n\n\n#### **æ•°æ®ç»“æ„**\n\nåŸºäº channel çš„å‘å¸ƒè®¢é˜…æ¨¡å¼æ˜¯é€šè¿‡å­—å…¸æ•°æ®ç±»å‹å®ç°çš„\n\n> ç±»ä¼¼hashmapï¼Œé”®ä¸ºchannelï¼Œå€¼ä¸ºè®¢é˜…äº†è¯¥channelçš„clientï¼Œç”¨é“¾è¡¨é“¾æ¥èµ·æ¥\n\nå…¶ä¸­ï¼Œå­—å…¸çš„é”®ä¸ºæ­£åœ¨è¢«è®¢é˜…çš„é¢‘é“ï¼Œ è€Œå­—å…¸çš„å€¼åˆ™æ˜¯ä¸€ä¸ªé“¾è¡¨ï¼Œ é“¾è¡¨ä¸­ä¿å­˜äº†æ‰€æœ‰è®¢é˜…è¿™ä¸ªé¢‘é“çš„å®¢æˆ·ç«¯ã€‚\n\n![é¢‘é“æ¨¡å¼æ•°æ®ç»“æ„æ¨¡å‹](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650420774862.png)\n\n**è®¢é˜…**\n\nå½“ä½¿ç”¨ subscribe è®¢é˜…æ—¶ï¼Œåœ¨å­—å…¸ä¸­æ‰¾åˆ°é¢‘é“ keyï¼ˆå¦‚æ²¡æœ‰åˆ™åˆ›å»ºï¼‰ï¼Œå¹¶å°†è®¢é˜…çš„ client å…³è”åœ¨é“¾è¡¨åé¢ã€‚\n\nå½“ client 10 æ‰§è¡Œ `subscribe channel1 channel2 channel3` æ—¶ï¼Œä¼šå°† client 10 åˆ†åˆ«åŠ åˆ° channel1 channel2 channel3 å…³è”çš„é“¾è¡¨å°¾éƒ¨ã€‚\n\n![é¢‘é“è®¢é˜…](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650420784179.png)\n\n**å‘å¸ƒ**\n\nå‘å¸ƒæ—¶ï¼Œæ ¹æ® keyï¼Œæ‰¾åˆ°å­—å…¸æ±‡æ€» key çš„åœ°å€ï¼Œç„¶åå°† msg å‘é€åˆ°å…³è”çš„é“¾è¡¨æ¯ä¸€å°æœºå™¨ã€‚\n\n**é€€è®¢**\n\néå†å…³è”çš„é“¾è¡¨ï¼Œå°†æŒ‡å®šçš„åœ°å€åˆ é™¤å³å¯ã€‚\n\n\n\n### æ¨¡å¼ï¼ˆpatternï¼‰\n\npattern ä½¿ç”¨äº†é€šé…ç¬¦çš„æ–¹å¼æ¥è®¢é˜…\n\né€šé…ç¬¦ä¸­ ? è¡¨ç¤º 1 ä¸ªå ä½ç¬¦ï¼Œ\\* è¡¨ç¤ºä»»æ„ä¸ªå ä½ç¬¦(åŒ…æ‹¬ 0)ï¼Œ?* è¡¨ç¤º 1 ä¸ªä»¥ä¸Šå ä½ç¬¦ã€‚\n\næ‰€ä»¥å½“ä½¿ç”¨ publish å‘½ä»¤å‘é€ä¿¡æ¯åˆ°æŸä¸ªé¢‘é“æ—¶ï¼Œ ä¸ä»…æ‰€æœ‰è®¢é˜…è¯¥é¢‘é“çš„å®¢æˆ·ç«¯ä¼šæ”¶åˆ°ä¿¡æ¯ï¼Œ å¦‚æœæœ‰æŸä¸ª/æŸäº›æ¨¡å¼å’Œè¿™ä¸ªé¢‘é“åŒ¹é…çš„è¯ï¼Œ é‚£ä¹ˆæ‰€æœ‰è®¢é˜…è¿™ä¸ª/è¿™äº›é¢‘é“çš„å®¢æˆ·ç«¯ä¹ŸåŒæ ·ä¼šæ”¶åˆ°ä¿¡æ¯ã€‚\n\n![æ¨¡å¼](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650420803487.png)\n\n#### **è®¢é˜…å‘å¸ƒå®Œæ•´æµç¨‹**\n\nå‘å¸ƒè€…å‘å¸ƒæ¶ˆæ¯\n\n```\n127.0.0.1:6379> publish b m1\n(integer) 1\n127.0.0.1:6379> publish b1 m1\n(integer) 1\n127.0.0.1:6379> publish b11 m1\n(integer) 1\n```\n\nè®¢é˜…è€…è®¢é˜…æ¶ˆæ¯\n\n```\n127.0.0.1:6379> psubscribe b*\nReading messages... (press Ctrl-C to quit)\n1) \"psubscribe\"\n2) \"b*\"\n3) (integer) 3\n1) \"pmessage\"\n2) \"b*\"\n3) \"b\"\n4) \"m1\"\n1) \"pmessage\"\n2) \"b*\"\n3) \"b1\"\n4) \"m1\"\n1) \"pmessage\"\n2) \"b*\"\n3) \"b11\"\n4) \"m1\"\n```\n\n#### **æ•°æ®ç»“æ„**\n\npattern å±æ€§æ˜¯ä¸€ä¸ªé“¾è¡¨ï¼Œé“¾è¡¨ä¸­ä¿å­˜ç€æ‰€æœ‰å’Œæ¨¡å¼ç›¸å…³çš„ä¿¡æ¯ã€‚\n\n> ç±»ä¼¼é“¾è¡¨ï¼Œæ¯ä¸ªpatternèŠ‚ç‚¹ï¼ŒåŒ…å«patternä»¥åŠè®¢é˜…è¯¥patternçš„client\n\næ•°æ®ç»“æ„å›¾å¦‚ä¸‹ï¼š\n\n![æ¨¡å¼æ•°æ®ç»“æ„](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650420905733.png)\n\n**è®¢é˜…**\n\nå½“æœ‰ä¿¡çš„è®¢é˜…æ—¶ï¼Œä¼šå°†è®¢é˜…çš„å®¢æˆ·ç«¯å’Œæ¨¡å¼ä¿¡æ¯æ·»åŠ åˆ°é“¾è¡¨åé¢ã€‚\n\n![æ¨¡å¼è®¢é˜…](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650420913717.png)\n\n**å‘å¸ƒ**\n\nå½“å‘å¸ƒè€…å‘å¸ƒæ¶ˆæ¯æ—¶ï¼Œé¦–å…ˆä¼šå‘é€åˆ°å¯¹åº”çš„é¢‘é“ä¸Šï¼Œåœ¨éå†æ¨¡å¼åˆ—è¡¨ï¼Œæ ¹æ® key åŒ¹é…æ¨¡å¼ï¼ŒåŒ¹é…æˆåŠŸå°†æ¶ˆæ¯å‘ç»™å¯¹åº”çš„è®¢é˜…è€…ã€‚\n\n**é€€è®¢**\n\nä½¿ç”¨ punsubscribeï¼Œå¯ä»¥å°†è®¢é˜…è€…é€€è®¢ï¼Œå°†æ”¹å®¢æˆ·ç«¯ç§»é™¤å‡ºé“¾è¡¨ã€‚\n\n***\n\n## ä¸»ä»å¤åˆ¶\n\n**ä»€ä¹ˆæ˜¯ä¸»ä»å¤åˆ¶**\n\nåœ¨å¤šä¸ª Redis å®ä¾‹å»ºç«‹èµ·ä¸»ä»å…³ç³»ï¼Œå½“ ä¸» Redis ä¸­çš„æ•°æ®å‘ç”Ÿå˜åŒ–ï¼Œä» Redis ä¸­çš„æ•°æ®ä¹Ÿä¼šåŒæ­¥å˜åŒ–\n\n- é€šè¿‡ä¸»ä»é…ç½®å¯ä»¥å®ç° Redis æ•°æ®çš„å¤‡ä»½ï¼ˆä» Redis å°±æ˜¯å¯¹ ä¸» Redis çš„å¤‡ä»½ï¼‰ï¼Œä¿è¯æ•°æ®å®‰å…¨æ€§\n- ä¸»ä»åº“ä¹‹é—´é‡‡ç”¨çš„æ˜¯è¯»å†™åˆ†ç¦»çš„æ–¹å¼ï¼Œè¯»æ“ä½œï¼šä¸»åº“ã€ä»åº“éƒ½å¯ä»¥æ¥æ”¶ï¼›å†™æ“ä½œï¼šé¦–å…ˆåˆ°ä¸»åº“æ‰§è¡Œï¼Œç„¶åä¸»åº“å°†å†™æ“ä½œåŒæ­¥ç»™ä»åº“\n\n**ä¸»ä»å¤åˆ¶çš„ä½œç”¨**\n\n- æ•°æ®å†—ä½™ï¼šä¸»ä»å¤åˆ¶å®ç°äº†æ•°æ®çš„çƒ­å¤‡ä»½ï¼Œæ˜¯æŒä¹…åŒ–ä¹‹å¤–çš„ä¸€ç§æ•°æ®å†—ä½™æ–¹å¼ã€‚\n\n- æ•…éšœæ¢å¤ï¼šå½“ä¸»èŠ‚ç‚¹å‡ºç°é—®é¢˜æ—¶ï¼Œå¯ä»¥ç”±ä»èŠ‚ç‚¹æä¾›æœåŠ¡ï¼Œå®ç°å¿«é€Ÿçš„æ•…éšœæ¢å¤ï¼›å®é™…ä¸Šæ˜¯ä¸€ç§æœåŠ¡çš„å†—ä½™ã€‚\n\n- è´Ÿè½½å‡è¡¡ï¼šåœ¨ä¸»ä»å¤åˆ¶çš„åŸºç¡€ä¸Šï¼Œé…åˆè¯»å†™åˆ†ç¦»ï¼Œå¯ä»¥ç”±ä¸»èŠ‚ç‚¹æä¾›å†™æœåŠ¡ï¼Œç”±ä»èŠ‚ç‚¹æä¾›è¯»æœåŠ¡ï¼ˆå³å†™ Redis æ•°æ®æ—¶åº”ç”¨è¿æ¥ä¸»èŠ‚ç‚¹ï¼Œè¯» Redis æ•°æ®æ—¶åº”ç”¨è¿æ¥ä»èŠ‚ç‚¹ï¼‰ï¼Œåˆ†æ‹…æœåŠ¡å™¨è´Ÿè½½ï¼›å°¤å…¶æ˜¯åœ¨å†™å°‘è¯»å¤šçš„åœºæ™¯ä¸‹ï¼Œé€šè¿‡å¤šä¸ªä»èŠ‚ç‚¹åˆ†æ‹…è¯»è´Ÿè½½ï¼Œå¯ä»¥å¤§å¤§æé«˜ Redis æœåŠ¡å™¨çš„å¹¶å‘é‡ã€‚\n\n- é«˜å¯ç”¨åŸºçŸ³ï¼šé™¤äº†ä¸Šè¿°ä½œç”¨ä»¥å¤–ï¼Œä¸»ä»å¤åˆ¶è¿˜æ˜¯å“¨å…µå’Œé›†ç¾¤èƒ½å¤Ÿå®æ–½çš„åŸºç¡€ï¼Œå› æ­¤è¯´ä¸»ä»å¤åˆ¶æ˜¯ Redis é«˜å¯ç”¨çš„åŸºç¡€ã€‚\n\nä¸»ä»åº“é‡‡ç”¨çš„æ˜¯è¯»å†™åˆ†ç¦»çš„æ–¹å¼ï¼š\n\n![ä¸»ä»åº“è¯»å†™åˆ†ç¦»](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650420963646.png) \n\n### åŸç†\n\nåˆ†ä¸ºå…¨é‡å¤åˆ¶ä¸å¢é‡å¤åˆ¶\n\nå…¨é‡å¤åˆ¶ï¼šå‘ç”Ÿåœ¨ç¬¬ä¸€æ¬¡å¤åˆ¶æ—¶\n\nå¢é‡å¤åˆ¶ï¼šåªä¼šæŠŠä¸»ä»åº“ç½‘ç»œæ–­è¿æœŸé—´ä¸»åº“æ”¶åˆ°çš„å‘½ä»¤ï¼ŒåŒæ­¥ç»™ä»åº“\n\n### å…¨é‡å¤åˆ¶çš„ä¸‰ä¸ªé˜¶æ®µ\n\n![å…¨é‡å¤åˆ¶](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNoteskjk7gr48ft.jpeg)\n\nç¬¬ä¸€é˜¶æ®µæ˜¯ä¸»ä»åº“é—´å»ºç«‹è¿æ¥ã€åå•†åŒæ­¥çš„è¿‡ç¨‹ã€‚\n\n> ä¸»è¦æ˜¯ä¸ºå…¨é‡å¤åˆ¶åšå‡†å¤‡ã€‚ä»åº“å’Œä¸»åº“å»ºç«‹èµ·è¿æ¥ï¼Œå¹¶å‘Šè¯‰ä¸»åº“å³å°†è¿›è¡ŒåŒæ­¥ï¼Œä¸»åº“ç¡®è®¤å›å¤åï¼Œä¸»ä»åº“é—´å°±å¯ä»¥å¼€å§‹åŒæ­¥äº†ã€‚\n>\n> å…·ä½“æ¥è¯´ï¼Œä»åº“ç»™ä¸»åº“å‘é€ psync å‘½ä»¤ï¼Œè¡¨ç¤ºè¦è¿›è¡Œæ•°æ®åŒæ­¥ï¼Œä¸»åº“æ ¹æ®è¿™ä¸ªå‘½ä»¤çš„å‚æ•°æ¥å¯åŠ¨å¤åˆ¶ã€‚psync å‘½ä»¤åŒ…å«äº†ä¸»åº“çš„ runID å’Œå¤åˆ¶è¿›åº¦ offset ä¸¤ä¸ªå‚æ•°ã€‚runIDï¼Œæ˜¯æ¯ä¸ª Redis å®ä¾‹å¯åŠ¨æ—¶éƒ½ä¼šè‡ªåŠ¨ç”Ÿæˆçš„ä¸€ä¸ªéšæœº IDï¼Œç”¨æ¥å”¯ä¸€æ ‡è®°è¿™ä¸ªå®ä¾‹ã€‚å½“ä»åº“å’Œä¸»åº“ç¬¬ä¸€æ¬¡å¤åˆ¶æ—¶ï¼Œå› ä¸ºä¸çŸ¥é“ä¸»åº“çš„ runIDï¼Œæ‰€ä»¥å°† runID è®¾ä¸ºâ€œï¼Ÿâ€ã€‚offsetï¼Œæ­¤æ—¶è®¾ä¸º -1ï¼Œè¡¨ç¤ºç¬¬ä¸€æ¬¡å¤åˆ¶ã€‚ä¸»åº“æ”¶åˆ° psync å‘½ä»¤åï¼Œä¼šç”¨ FULLRESYNC å“åº”å‘½ä»¤å¸¦ä¸Šä¸¤ä¸ªå‚æ•°ï¼šä¸»åº“ runID å’Œä¸»åº“ç›®å‰çš„å¤åˆ¶è¿›åº¦ offsetï¼Œè¿”å›ç»™ä»åº“ã€‚ä»åº“æ”¶åˆ°å“åº”åï¼Œä¼šè®°å½•ä¸‹è¿™ä¸¤ä¸ªå‚æ•°ã€‚è¿™é‡Œæœ‰ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ï¼ŒFULLRESYNC å“åº”è¡¨ç¤ºç¬¬ä¸€æ¬¡å¤åˆ¶é‡‡ç”¨çš„å…¨é‡å¤åˆ¶ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸»åº“ä¼šæŠŠå½“å‰æ‰€æœ‰çš„æ•°æ®éƒ½å¤åˆ¶ç»™ä»åº“ã€‚\n\nç¬¬äºŒé˜¶æ®µï¼Œä¸»åº“å°†æ‰€æœ‰æ•°æ®åŒæ­¥ç»™ä»åº“ã€‚ä»åº“æ”¶åˆ°æ•°æ®åï¼Œåœ¨æœ¬åœ°å®Œæˆæ•°æ®åŠ è½½ã€‚è¿™ä¸ªè¿‡ç¨‹ä¾èµ–äºå†…å­˜å¿«ç…§ç”Ÿæˆçš„ RDB æ–‡ä»¶ã€‚\n\n> å…·ä½“æ¥è¯´ï¼Œä¸»åº“æ‰§è¡Œ bgsave å‘½ä»¤ï¼Œç”Ÿæˆ RDB æ–‡ä»¶ï¼Œæ¥ç€å°†æ–‡ä»¶å‘ç»™ä»åº“ã€‚ä»åº“æ¥æ”¶åˆ° RDB æ–‡ä»¶åï¼Œä¼šå…ˆæ¸…ç©ºå½“å‰æ•°æ®åº“ï¼Œç„¶ååŠ è½½ RDB æ–‡ä»¶ã€‚è¿™æ˜¯å› ä¸ºä»åº“åœ¨é€šè¿‡ replicaof å‘½ä»¤å¼€å§‹å’Œä¸»åº“åŒæ­¥å‰ï¼Œå¯èƒ½ä¿å­˜äº†å…¶ä»–æ•°æ®ã€‚ä¸ºäº†é¿å…ä¹‹å‰æ•°æ®çš„å½±å“ï¼Œä»åº“éœ€è¦å…ˆæŠŠå½“å‰æ•°æ®åº“æ¸…ç©ºã€‚åœ¨ä¸»åº“å°†æ•°æ®åŒæ­¥ç»™ä»åº“çš„è¿‡ç¨‹ä¸­ï¼Œä¸»åº“ä¸ä¼šè¢«é˜»å¡ï¼Œä»ç„¶å¯ä»¥æ­£å¸¸æ¥æ”¶è¯·æ±‚ã€‚å¦åˆ™ï¼ŒRedis çš„æœåŠ¡å°±è¢«ä¸­æ–­äº†ã€‚ä½†æ˜¯ï¼Œè¿™äº›è¯·æ±‚ä¸­çš„å†™æ“ä½œå¹¶æ²¡æœ‰è®°å½•åˆ°åˆšåˆšç”Ÿæˆçš„ RDB æ–‡ä»¶ä¸­ã€‚ä¸ºäº†ä¿è¯ä¸»ä»åº“çš„æ•°æ®ä¸€è‡´æ€§ï¼Œä¸»åº“ä¼šåœ¨å†…å­˜ä¸­ç”¨ä¸“é—¨çš„ replication bufferï¼Œè®°å½• RDB æ–‡ä»¶ç”Ÿæˆåæ”¶åˆ°çš„æ‰€æœ‰å†™æ“ä½œã€‚\n\nç¬¬ä¸‰ä¸ªé˜¶æ®µï¼Œä¸»åº“ä¼šæŠŠç¬¬äºŒé˜¶æ®µæ‰§è¡Œè¿‡ç¨‹ä¸­æ–°æ”¶åˆ°çš„å†™å‘½ä»¤ï¼Œå†å‘é€ç»™ä»åº“ã€‚\n\n> å…·ä½“çš„æ“ä½œæ˜¯ï¼Œå½“ä¸»åº“å®Œæˆ RDB æ–‡ä»¶å‘é€åï¼Œå°±ä¼šæŠŠæ­¤æ—¶ replication buffer ä¸­çš„ä¿®æ”¹æ“ä½œå‘ç»™ä»åº“ï¼Œä»åº“å†é‡æ–°æ‰§è¡Œè¿™äº›æ“ä½œã€‚è¿™æ ·ä¸€æ¥ï¼Œä¸»ä»åº“å°±å®ç°åŒæ­¥äº†ã€‚\n\n### æ–­ç½‘å¢é‡æ›´æ–°\n\nå½“ä¸»ä»åº“æ–­è¿åï¼Œä¸»åº“ä¼šæŠŠæ–­è¿æœŸé—´æ”¶åˆ°çš„å†™æ“ä½œå‘½ä»¤ï¼Œå†™å…¥ replication bufferï¼ŒåŒæ—¶ä¹Ÿä¼šæŠŠè¿™äº›æ“ä½œå‘½ä»¤ä¹Ÿå†™å…¥ repl_backlog_buffer è¿™ä¸ªç¼“å†²åŒºã€‚\n\n![æ–­ç½‘å¢é‡æ›´æ–°](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesg0eezljwqy.jpeg)\n\n## å“¨å…µæœºåˆ¶\n\n> å“¨å…µçš„æ ¸å¿ƒåŠŸèƒ½æ˜¯ä¸»èŠ‚ç‚¹çš„è‡ªåŠ¨æ•…éšœè½¬ç§»\n>\n> 1. ç›‘æ§ ä¸»åº“ï¼Œåˆ¤æ–­ ä¸»åº“ æ˜¯å¦å®•æœº\n> 2. ä¸»åº“ å¦‚æœå®•æœºï¼Œåˆ™ä» ä»åº“ ä¸­ é€‰ä¸¾æˆä¸º ä¸»åº“ï¼ˆå› æ­¤éœ€è¦å¥‡æ•°ä¸ªå“¨å…µï¼‰\n> 3. æ›´æ”¹ä¸»ä»é…ç½®\n\nä¸‹å›¾æ˜¯ä¸€ä¸ªå…¸å‹çš„å“¨å…µé›†ç¾¤ç›‘æ§çš„é€»è¾‘å›¾ï¼š\n\n![å“¨å…µæœºåˆ¶](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650420977306.png)\n\n![å›¾ç‰‡](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)\n\n \n\nRedis Sentinel åŒ…å«äº†è‹¥ä¸ª Sentinel èŠ‚ç‚¹ï¼Œè¿™æ ·åšä¹Ÿå¸¦æ¥äº†ä¸¤ä¸ªå¥½å¤„ï¼š\n\n1. å¯¹äºèŠ‚ç‚¹çš„æ•…éšœåˆ¤æ–­æ˜¯ç”±å¤šä¸ª Sentinel èŠ‚ç‚¹å…±åŒå®Œæˆï¼Œè¿™æ ·å¯ä»¥æœ‰æ•ˆåœ°é˜²æ­¢è¯¯åˆ¤\n2. å³ä½¿ä¸ªåˆ« Sentinel èŠ‚ç‚¹ä¸å¯ç”¨ï¼Œæ•´ä¸ª Sentinel é›†ç¾¤ä¾ç„¶æ˜¯å¯ç”¨çš„ã€‚\n\nå“¨å…µå®ç°äº†ä»¥ä¸‹åŠŸèƒ½\n\n1. ç›‘æ§ï¼šæ¯ä¸ª Sentinel èŠ‚ç‚¹ä¼šå¯¹æ•°æ®èŠ‚ç‚¹ï¼ˆRedis master/slave èŠ‚ç‚¹ï¼‰å’Œå…¶ä½™ Sentinel èŠ‚ç‚¹è¿›è¡Œç›‘æ§\n2. é€šçŸ¥ï¼šSentinel èŠ‚ç‚¹ä¼šå°†æ•…éšœè½¬ç§»çš„ç»“æœé€šçŸ¥ç»™åº”ç”¨æ–¹\n3. æ•…éšœè½¬ç§»ï¼šå®ç° slave æ™‹å‡ä¸º masterï¼Œå¹¶ç»´æŠ¤åç»­æ­£ç¡®çš„ä¸»ä»å…³ç³»\n4. é…ç½®ä¸­å¿ƒï¼šåœ¨ Redis Sentinel æ¨¡å¼ä¸­ï¼Œå®¢æˆ·ç«¯åœ¨åˆå§‹åŒ–çš„æ—¶å€™è¿æ¥çš„æ˜¯ Sentinel èŠ‚ç‚¹é›†åˆï¼Œä»ä¸­è·å–ä¸»èŠ‚ç‚¹ä¿¡æ¯\n\nå…¶ä¸­ï¼Œç›‘æ§å’Œè‡ªåŠ¨æ•…éšœè½¬ç§»åŠŸèƒ½ï¼Œä½¿å¾—å“¨å…µå¯ä»¥åŠæ—¶å‘ç°ä¸»èŠ‚ç‚¹æ•…éšœå¹¶å®Œæˆè½¬ç§»ï¼›è€Œé…ç½®ä¸­å¿ƒå’Œé€šçŸ¥åŠŸèƒ½ï¼Œåˆ™éœ€è¦åœ¨ä¸å®¢æˆ·ç«¯çš„äº¤äº’ä¸­æ‰èƒ½ä½“ç°ã€‚\n\n### ç›‘æ§\n\nSentinel èŠ‚ç‚¹éœ€è¦ç›‘æ§ masterã€slave ä»¥åŠå…¶å®ƒ Sentinel èŠ‚ç‚¹çš„çŠ¶æ€ã€‚è¿™ä¸€è¿‡ç¨‹æ˜¯é€šè¿‡ Redis çš„ pub/sub ç³»ç»Ÿå®ç°çš„ã€‚Redis Sentinel ä¸€å…±æœ‰ä¸‰ä¸ªå®šæ—¶ç›‘æ§ä»»åŠ¡ï¼Œå®Œæˆå¯¹å„ä¸ªèŠ‚ç‚¹å‘ç°å’Œç›‘æ§ï¼š\n\n1. ç›‘æ§ä¸»ä»æ‹“æ‰‘ä¿¡æ¯ï¼šæ¯éš” 10 ç§’ï¼Œæ¯ä¸ª Sentinel èŠ‚ç‚¹ï¼Œä¼šå‘ master å’Œ slave å‘é€ INFO å‘½ä»¤è·å–æœ€æ–°çš„æ‹“æ‰‘ç»“æ„\n2. Sentinel èŠ‚ç‚¹ä¿¡æ¯äº¤æ¢ï¼šæ¯éš” 2 ç§’ï¼Œæ¯ä¸ª Sentinel èŠ‚ç‚¹ï¼Œä¼šå‘ Redis æ•°æ®èŠ‚ç‚¹çš„`sentinel:hello` é¢‘é“ä¸Šï¼Œå‘é€è‡ªèº«çš„ä¿¡æ¯ï¼Œä»¥åŠå¯¹ä¸»èŠ‚ç‚¹çš„åˆ¤æ–­ä¿¡æ¯ã€‚è¿™æ ·ï¼ŒSentinel èŠ‚ç‚¹ä¹‹é—´å°±å¯ä»¥äº¤æ¢ä¿¡æ¯\n3. èŠ‚ç‚¹çŠ¶æ€ç›‘æ§ï¼šæ¯éš” 1 ç§’ï¼Œæ¯ä¸ª Sentinel èŠ‚ç‚¹ï¼Œä¼šå‘ masterã€slaveã€å…¶ä½™ Sentinel èŠ‚ç‚¹å‘é€ PING å‘½ä»¤åšå¿ƒè·³æ£€æµ‹ï¼Œæ¥ç¡®è®¤è¿™äº›èŠ‚ç‚¹å½“å‰æ˜¯å¦å¯è¾¾\n\n### ä¸»è§‚/å®¢è§‚ä¸‹çº¿\n\n#### ä¸»è§‚ä¸‹çº¿\n\næ¯ä¸ª Sentinel èŠ‚ç‚¹ï¼Œæ¯éš” 1 ç§’ä¼šå¯¹æ•°æ®èŠ‚ç‚¹å‘é€ ping å‘½ä»¤åšå¿ƒè·³æ£€æµ‹ï¼Œå½“è¿™äº›èŠ‚ç‚¹è¶…è¿‡ down-after-milliseconds æ²¡æœ‰è¿›è¡Œæœ‰æ•ˆå›å¤æ—¶ï¼ŒSentinel èŠ‚ç‚¹ä¼šå¯¹è¯¥èŠ‚ç‚¹åšå¤±è´¥åˆ¤å®šï¼Œè¿™ä¸ªè¡Œä¸ºå«åšä¸»è§‚ä¸‹çº¿ã€‚\n\n#### å®¢è§‚ä¸‹çº¿\n\nå®¢è§‚ä¸‹çº¿ï¼Œæ˜¯æŒ‡å½“å¤§å¤šæ•° Sentinel èŠ‚ç‚¹ï¼Œéƒ½è®¤ä¸º master èŠ‚ç‚¹å®•æœºäº†ï¼Œé‚£ä¹ˆè¿™ä¸ªåˆ¤å®šå°±æ˜¯å®¢è§‚çš„ï¼Œå«åšå®¢è§‚ä¸‹çº¿ã€‚\n\né‚£ä¹ˆè¿™ä¸ªå¤§å¤šæ•°æ˜¯æŒ‡å¤šå°‘å‘¢ï¼Ÿè¿™å…¶å®å°±æ˜¯åˆ†å¸ƒå¼åè°ƒä¸­çš„ quorum åˆ¤å®šäº†ï¼Œå¤§å¤šæ•°å°±æ˜¯è¿‡åŠæ•°ï¼Œæ¯”å¦‚å“¨å…µæ•°é‡æ˜¯ 5ï¼Œé‚£ä¹ˆå¤§å¤šæ•°å°±æ˜¯ 5/2+1=3 ä¸ªï¼Œå“¨å…µæ•°é‡æ˜¯ 10 å¤§å¤šæ•°å°±æ˜¯ 10/2+1=6 ä¸ªã€‚\n\næ³¨ï¼šSentinel èŠ‚ç‚¹çš„æ•°é‡è‡³å°‘ä¸º 3 ä¸ªï¼Œå¦åˆ™ä¸æ»¡è¶³ quorum åˆ¤å®šæ¡ä»¶ã€‚\n\n### å“¨å…µé€‰ä¸¾\n\nå¦‚æœå‘ç”Ÿäº†å®¢è§‚ä¸‹çº¿ï¼Œé‚£ä¹ˆå“¨å…µèŠ‚ç‚¹ä¼šé€‰ä¸¾å‡ºä¸€ä¸ª Leader æ¥è¿›è¡Œå®é™…çš„æ•…éšœè½¬ç§»å·¥ä½œã€‚Redis ä½¿ç”¨äº† Raft ç®—æ³•æ¥å®ç°å“¨å…µé¢†å¯¼è€…é€‰ä¸¾ï¼Œå¤§è‡´æ€è·¯å¦‚ä¸‹ï¼š\n\n1. æ¯ä¸ª Sentinel èŠ‚ç‚¹éƒ½æœ‰èµ„æ ¼æˆä¸ºé¢†å¯¼è€…ï¼Œå½“å®ƒä¸»è§‚è®¤ä¸ºæŸä¸ªæ•°æ®èŠ‚ç‚¹å®•æœºåï¼Œä¼šå‘å…¶ä»– Sentinel èŠ‚ç‚¹å‘é€ sentinel is-master-down-by-addr å‘½ä»¤ï¼Œè¦æ±‚è‡ªå·±æˆä¸ºé¢†å¯¼è€…ï¼›\n2. æ”¶åˆ°å‘½ä»¤çš„ Sentinel èŠ‚ç‚¹ï¼Œå¦‚æœæ²¡æœ‰åŒæ„è¿‡å…¶ä»– Sentinel èŠ‚ç‚¹çš„ sentinelis-master-down-by-addr å‘½ä»¤ï¼Œå°†åŒæ„è¯¥è¯·æ±‚ï¼Œå¦åˆ™æ‹’ç»ï¼ˆæ¯ä¸ª Sentinel èŠ‚ç‚¹åªæœ‰ 1 ç¥¨ï¼‰ï¼›\n3. å¦‚æœè¯¥ Sentinel èŠ‚ç‚¹å‘ç°è‡ªå·±çš„ç¥¨æ•°å·²ç»å¤§äºç­‰äº MAX(quorum, num(sentinels)/2+1)ï¼Œé‚£ä¹ˆå®ƒå°†æˆä¸ºé¢†å¯¼è€…ï¼›\n4. å¦‚æœæ­¤è¿‡ç¨‹æ²¡æœ‰é€‰ä¸¾å‡ºé¢†å¯¼è€…ï¼Œå°†è¿›å…¥ä¸‹ä¸€æ¬¡é€‰ä¸¾ã€‚\n\n### **æ•…éšœè½¬ç§»**\n\né€‰ä¸¾å‡ºçš„ Leader Sentinel èŠ‚ç‚¹å°†è´Ÿè´£æ•…éšœè½¬ç§»ï¼Œä¹Ÿå°±æ˜¯è¿›è¡Œ master/slave èŠ‚ç‚¹çš„ä¸»ä»åˆ‡æ¢ã€‚æ•…éšœè½¬ç§»ï¼Œé¦–å…ˆè¦ä» slave èŠ‚ç‚¹ä¸­ç­›é€‰å‡ºä¸€ä¸ªä½œä¸ºæ–°çš„ masterï¼Œä¸»è¦è€ƒè™‘ä»¥ä¸‹ slave ä¿¡æ¯ï¼š\n\n1. è·Ÿ master æ–­å¼€è¿æ¥çš„æ—¶é•¿ï¼šå¦‚æœä¸€ä¸ª slave è·Ÿ master çš„æ–­å¼€è¿æ¥æ—¶é•¿å·²ç»è¶…è¿‡äº† down-after-milliseconds çš„ 10 å€ï¼Œå¤–åŠ  master å®•æœºçš„æ—¶é•¿ï¼Œé‚£ä¹ˆè¯¥ slave å°±è¢«è®¤ä¸ºä¸é€‚åˆé€‰ä¸¾ä¸º masterï¼›\n2. slave çš„ä¼˜å…ˆçº§é…ç½®ï¼šslave priority å‚æ•°å€¼è¶Šå°ï¼Œä¼˜å…ˆçº§å°±è¶Šé«˜ï¼›\n3. å¤åˆ¶ offsetï¼šå½“ä¼˜å…ˆçº§ç›¸åŒæ—¶ï¼Œå“ªä¸ª slave å¤åˆ¶äº†è¶Šå¤šçš„æ•°æ®ï¼ˆoffset è¶Šé åï¼‰ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼›\n4. run idï¼šå¦‚æœ offset å’Œä¼˜å…ˆçº§éƒ½ç›¸åŒï¼Œåˆ™å“ªä¸ª slave çš„ run id è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜ã€‚\n\næ¥ç€ï¼Œç­›é€‰å®Œ slave åï¼Œ ä¼šå¯¹å®ƒæ‰§è¡Œ slaveof no one å‘½ä»¤ï¼Œè®©å…¶æˆä¸ºä¸»èŠ‚ç‚¹ã€‚\n\næœ€åï¼ŒSentinel é¢†å¯¼è€…èŠ‚ç‚¹ä¼šå‘å‰©ä½™çš„ slave èŠ‚ç‚¹å‘é€å‘½ä»¤ï¼Œè®©å®ƒä»¬æˆä¸ºæ–°çš„ master èŠ‚ç‚¹çš„ä»èŠ‚ç‚¹ï¼Œå¤åˆ¶è§„åˆ™ä¸ parallel-syncs å‚æ•°æœ‰å…³ã€‚\n\nSentinel èŠ‚ç‚¹é›†åˆä¼šå°†åŸæ¥çš„ master èŠ‚ç‚¹æ›´æ–°ä¸º slave èŠ‚ç‚¹ï¼Œå¹¶ä¿æŒç€å¯¹å…¶å…³æ³¨ï¼Œå½“å…¶æ¢å¤åå‘½ä»¤å®ƒå»å¤åˆ¶æ–°çš„ä¸»èŠ‚ç‚¹ã€‚\n\næ³¨ï¼šLeader Sentinel èŠ‚ç‚¹ï¼Œä¼šä»æ–°çš„ master èŠ‚ç‚¹é‚£é‡Œå¾—åˆ°ä¸€ä¸ª configuration epochï¼Œæœ¬è´¨æ˜¯ä¸ª version ç‰ˆæœ¬å·ï¼Œæ¯æ¬¡ä¸»ä»åˆ‡æ¢çš„ version å·éƒ½å¿…é¡»æ˜¯å”¯ä¸€çš„ã€‚å…¶ä»–çš„å“¨å…µéƒ½æ˜¯æ ¹æ® version æ¥æ›´æ–°è‡ªå·±çš„ master é…ç½®ã€‚\n\n## é›†ç¾¤é…ç½®\n\n> é«˜å¯ç”¨ï¼šä¿è¯ Redis ä¸€ç›´å¤„äºå¯ç”¨çŠ¶æ€ï¼Œå³ä½¿å‡ºç°äº†æ•…éšœä¹Ÿæœ‰å¤‡ç”¨æ–¹æ¡ˆä¿è¯å¯ç”¨æ€§\n>\n> é«˜å¹¶å‘ï¼šä¸€ä¸ª Redis å®ä¾‹å·²ç»å¯ä»¥æ”¯æŒå¤šè¾¾ 11wå¹¶å‘è¯»æ“ä½œæˆ– 8.1wå¹¶å‘å†™æ“ä½œï¼›ä½†æ˜¯å¦‚æœæœ‰æ›´é«˜å¹¶å‘éœ€æ±‚çš„åº”ç”¨æ¥è¯´ï¼Œå¯ä»¥é€šè¿‡ è¯»å†™åˆ†ç¦»ã€é›†ç¾¤é…ç½® æ¥è§£å†³é«˜å¹¶å‘é—®é¢˜\n\n- Redis é›†ç¾¤ä¸­æ¯ä¸ªèŠ‚ç‚¹æ˜¯å¯¹ç­‰çš„ï¼Œæ— ä¸­å¿ƒç»“æ„\n- æ•°æ®æŒ‰ç…§ slots åˆ†å¸ƒå¼å­˜å‚¨åœ¨ä¸åŒçš„ Redis èŠ‚ç‚¹ä¸Šï¼ŒèŠ‚ç‚¹ä¸­çš„æ•°æ®å¯å…±äº«ï¼Œå¯ä»¥åŠ¨æ€è°ƒæ•´æ•°æ®åˆ†å¸ƒ\n- å¯æ‰©å±•æ€§å¼ºï¼Œå¯ä»¥åŠ¨æ€å¢åˆ èŠ‚ç‚¹ï¼Œæœ€å¤šå¯æ‰©å±•è‡³ 1000+ èŠ‚ç‚¹\n- é›†ç¾¤çš„æ¯ä¸ªèŠ‚ç‚¹é€šè¿‡ `ä¸»ä»ï¼ˆå“¨å…µæ¨¡å¼ï¼‰`ä¿è¯å…¶é«˜å¯ç”¨æ€§\n- Redis å¹¶ä¸èƒ½ä¿è¯æ•°æ®çš„å¼ºä¸€è‡´æ€§ï¼Œè¿™æ„å‘³è¿™åœ¨å®é™…ä¸­é›†ç¾¤åœ¨ç‰¹å®šçš„æ¡ä»¶ä¸‹å¯èƒ½ä¼šä¸¢å¤±å†™æ“ä½œ\n- Redis é›†ç¾¤ä¹‹é—´æ˜¯å¦‚ä½•å¤åˆ¶çš„ï¼Ÿå¼‚æ­¥å¤åˆ¶\n\n> [Redis_æ•°æ®åˆ†å¸ƒç®—æ³•ï¼šä¼ ç»Ÿå“ˆå¸Œ-ä¸€è‡´æ€§å“ˆå¸Œ-å“ˆå¸Œslot](https://blog.csdn.net/qq_43846090/article/details/123721066)\n\n### ä¼ ç»Ÿå“ˆå¸Œ\n\næœ€ç®€å•çš„æ•°æ®åˆ†å¸ƒç®—æ³•ï¼Œå¯¹è¿›æ¥çš„ key è¿›è¡Œ hashï¼Œç„¶åå¯¹èŠ‚ç‚¹æ•°æ®è¿›è¡Œå–æ¨¡ï¼Œå°±çŸ¥é“åˆ†å¸ƒåˆ°å“ªä¸ªèŠ‚ç‚¹ä¸Šäº†ï¼›\nç¼ºç‚¹å°±æ˜¯: å¦‚æœä¸€ä¸ªèŠ‚ç‚¹å®•æœºï¼Œæ‰€æœ‰ç¼“å­˜çš„ä½ç½®éƒ½è¦å‘ç”Ÿæ”¹å˜ï¼Œå½“æœåŠ¡å™¨æ•°é‡å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰ç¼“å­˜åœ¨ä¸€å®šæ—¶é—´å†…æ˜¯å¤±æ•ˆçš„ï¼Œä¼šå¼•èµ·ç¼“å­˜çš„é›ªå´©ï¼Œå¯èƒ½ä¼šå¼•èµ·æ•´ä½“ç³»ç»Ÿå‹åŠ›è¿‡å¤§è€Œå´©æºƒï¼ˆå¤§é‡ç¼“å­˜åŒä¸€æ—¶é—´å¤±æ•ˆï¼‰\n\n### ä¸€è‡´æ€§å“ˆå¸Œ\n\nå®é™…ä¸Šå°±æ˜¯å¼•å…¥äº†ä¸€ä¸ªåœ†ç¯çš„æ¦‚å¿µï¼Œ è®©æ¯ä¸ªæ•°æ®çš„ hash åˆ†å¸ƒåˆ°æ•´ä¸ªåœ†ç¯ï¼Œç„¶åé¡ºæ—¶é’ˆå»æ‰¾ç¦»ä»–æœ€è¿‘çš„èŠ‚ç‚¹å­˜å‚¨\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650525022243.png\" alt=\"ä¸€è‡´æ€§å“ˆå¸Œ\" style=\"zoom: 50%;\" />\n\nhash ç®—æ³•çš„å–æ¨¡æ³•æ˜¯å¯¹æœåŠ¡å™¨çš„æ•°é‡è¿›è¡Œå–æ¨¡ï¼Œè€Œä¸€è‡´æ€§å“ˆå¸Œç®—æ³•æ˜¯å¯¹ 2^32 å–æ¨¡ï¼Œ\ndubbo çš„å¤æ‚å‡è¡¡æœ‰ç”¨åˆ°è¯¥ç®—æ³•ï¼›\n\nå¥½å¤„:\n\nä½¿ç”¨ hash ç®—æ³•ï¼ŒæœåŠ¡å™¨æ•°é‡å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰æœåŠ¡å™¨çš„æ‰€æœ‰ç¼“å­˜åœ¨åŒä¸€æ—¶é—´å¤±æ•ˆäº†ï¼›\nè€Œä½¿ç”¨ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•æ—¶ï¼ŒæœåŠ¡å™¨çš„æ•°é‡å¦‚æœå‘ç”Ÿæ”¹å˜ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰ç¼“å­˜éƒ½ä¼šå¤±æ•ˆï¼Œè€Œæ˜¯åªæœ‰éƒ¨åˆ†ç¼“å­˜ä¼šå¤±æ•ˆã€‚ä¸Šå›¾ä¸­å¦‚æœèŠ‚ç‚¹ A å¤±æ•ˆï¼Œåˆ™ C â†’ A ä¹‹é—´çš„æ•°æ®ä¼šé‡æ–°ç¼“å­˜åˆ°èŠ‚ç‚¹ B ä¸Šã€‚\n\nhash ç¯åæ–œï¼š\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650525154544.png\" alt=\"hash ç¯åæ–œ\" style=\"zoom: 50%;\" />\n\n1 å·ã€2 å·ã€3 å·ã€4 å·ã€6 å·æ•°æ®å‡è¢«ç¼“å­˜åœ¨äº†æœåŠ¡å™¨ A ä¸Šï¼›åªæœ‰ 5 å·è¢«ç¼“å­˜åœ¨äº†æœåŠ¡å™¨ B ä¸Šï¼›æœåŠ¡å™¨ C ä¸Šç”šè‡³æ²¡æœ‰ç¼“å­˜ä»»ä½•å›¾ç‰‡\nå¦‚æœå‡ºç°ä¸Šå›¾ä¸­çš„æƒ…å†µï¼ŒAã€Bã€C ä¸‰å°æœåŠ¡å™¨å¹¶æ²¡æœ‰è¢«åˆç†çš„å¹³å‡çš„å……åˆ†åˆ©ç”¨ï¼Œç¼“å­˜åˆ†å¸ƒçš„æåº¦ä¸å‡åŒ€ï¼Œè€Œä¸”ï¼Œå¦‚æœæ­¤æ—¶æœåŠ¡å™¨ A å‡ºç°æ•…éšœï¼Œé‚£ä¹ˆå¤±æ•ˆç¼“å­˜çš„æ•°é‡ä¹Ÿå°†è¾¾åˆ°æœ€å¤§å€¼ï¼Œåœ¨æç«¯æƒ…å†µä¸‹ï¼Œä»ç„¶æœ‰å¯èƒ½å¼•èµ·ç³»ç»Ÿçš„å´©æºƒï¼›\n\nä¸Šå›¾ä¸­çš„æƒ…å†µåˆ™è¢«ç§°ä¹‹ä¸º hash ç¯çš„åæ–œ ï¼›\næˆ‘ä»¬åº”è¯¥æ€æ ·é˜²æ­¢ hash ç¯çš„åæ–œï¼Ÿ\nå¢åŠ è™šæ‹ŸèŠ‚ç‚¹ï¼š\n\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650525203417.png\" alt=\"å¢åŠ è™šæ‹ŸèŠ‚ç‚¹é˜²æ­¢ hash ç¯çš„åæ–œ\" style=\"zoom:50%;\" />\n\nä¸ºäº†è§£å†³è¿™ä¸ªæ•°æ®è´Ÿè½½å‡è¡¡çš„é—®é¢˜ï¼Œæå‡ºæ¥è™šæ‹ŸèŠ‚ç‚¹ï¼ŒæŠŠçœŸå®èŠ‚ç‚¹æä¸€å †è™šæ‹ŸèŠ‚ç‚¹åˆ†å¸ƒåˆ°ç¯ï¼Œé‚£ä¹ˆæ•´ä¸ªåŒºé—´çš„æ•°æ®ä¼šè½åˆ°è¿™äº›è™šæ‹ŸèŠ‚ç‚¹ä¸Šï¼›\n\nè™šæ‹ŸèŠ‚ç‚¹è¶Šå¤šï¼Œhash ç¯ä¸Šçš„èŠ‚ç‚¹å°±è¶Šå¤šï¼Œç¼“å­˜è¢«å‡åŒ€åˆ†å¸ƒçš„æ¦‚ç‡å°±è¶Šå¤§ã€‚\n\n### å“ˆå¸Œæ§½\n\nRedis é›†ç¾¤ï¼ˆclusterï¼‰å¹¶æ²¡æœ‰é€‰ç”¨ä¸Šé¢ä¸€è‡´æ€§å“ˆå¸Œï¼Œè€Œæ˜¯é‡‡ç”¨äº†å“ˆå¸Œæ§½ï¼ˆslotï¼‰çš„è¿™ç§æ¦‚å¿µã€‚ä¸»è¦çš„åŸå› å°±æ˜¯ä¸Šé¢æ‰€è¯´çš„ï¼Œä¸€è‡´æ€§å“ˆå¸Œç®—æ³•å¯¹äºæ•°æ®åˆ†å¸ƒã€èŠ‚ç‚¹ä½ç½®çš„æ§åˆ¶å¹¶ä¸æ˜¯å¾ˆå‹å¥½ã€‚\n\né¦–å…ˆå“ˆå¸Œæ§½å…¶å®æ˜¯ä¸¤ä¸ªæ¦‚å¿µï¼Œç¬¬ä¸€ä¸ªæ˜¯å“ˆå¸Œç®—æ³•ã€‚Redis cluster çš„ hash ç®—æ³•ä¸æ˜¯ç®€å•çš„ hash()ï¼Œè€Œæ˜¯ crc16 ç®—æ³•ï¼Œä¸€ç§æ ¡éªŒç®—æ³•ã€‚å¦å¤–ä¸€ä¸ªå°±æ˜¯æ§½ä½çš„æ¦‚å¿µï¼Œç©ºé—´åˆ†é…çš„è§„åˆ™ã€‚å…¶å®å“ˆå¸Œæ§½çš„æœ¬è´¨å’Œä¸€è‡´æ€§å“ˆå¸Œç®—æ³•éå¸¸ç›¸ä¼¼ï¼Œä¸åŒç‚¹å°±æ˜¯å¯¹äºå“ˆå¸Œç©ºé—´çš„å®šä¹‰ã€‚ä¸€è‡´æ€§å“ˆå¸Œçš„ç©ºé—´æ˜¯ä¸€ä¸ªåœ†ç¯ï¼ŒèŠ‚ç‚¹åˆ†å¸ƒæ˜¯åŸºäºåœ†ç¯çš„ï¼Œæ— æ³•å¾ˆå¥½çš„æ§åˆ¶æ•°æ®åˆ†å¸ƒã€‚è€Œ Redis cluster çš„æ§½ä½ç©ºé—´æ˜¯è‡ªå®šä¹‰åˆ†é…çš„ï¼Œç±»ä¼¼äº windows ç›˜åˆ†åŒºçš„æ¦‚å¿µã€‚è¿™ç§åˆ†åŒºæ˜¯å¯ä»¥è‡ªå®šä¹‰å¤§å°ï¼Œè‡ªå®šä¹‰ä½ç½®çš„ã€‚\n\nRedis cluster åŒ…å«äº† 16384 ä¸ªå“ˆå¸Œæ§½ï¼Œæ¯ä¸ª key é€šè¿‡è®¡ç®—åéƒ½ä¼šè½åœ¨å…·ä½“ä¸€ä¸ªæ§½ä½ä¸Šï¼Œè€Œè¿™ä¸ªæ§½ä½æ˜¯å±äºå“ªä¸ªå­˜å‚¨èŠ‚ç‚¹çš„ï¼Œåˆ™ç”±ç”¨æˆ·è‡ªå·±å®šä¹‰åˆ†é…ã€‚ä¾‹å¦‚æœºå™¨ç¡¬ç›˜å°çš„ï¼Œå¯ä»¥åˆ†é…å°‘ä¸€ç‚¹æ§½ä½ï¼Œç¡¬ç›˜å¤§çš„å¯ä»¥åˆ†é…å¤šä¸€ç‚¹ã€‚å¦‚æœèŠ‚ç‚¹ç¡¬ç›˜éƒ½å·®ä¸å¤šåˆ™å¯ä»¥å¹³å‡åˆ†é…ã€‚æ‰€ä»¥å“ˆå¸Œæ§½è¿™ç§æ¦‚å¿µå¾ˆå¥½åœ°è§£å†³äº†ä¸€è‡´æ€§å“ˆå¸Œçš„å¼Šç«¯ã€‚\n\n**ä¸ºä»€ä¹ˆå“ˆå¸Œæ§½çš„å¤§å°æ˜¯å›ºå®šçš„16384ï¼Ÿ**\n\n> `CRC16`ç®—æ³•äº§ç”Ÿçš„hashå€¼æœ‰16bitï¼Œè¯¥ç®—æ³•å¯ä»¥äº§ç”Ÿ2^16-=65536ä¸ªå€¼ã€‚æ¢å¥è¯è¯´ï¼Œå€¼æ˜¯åˆ†å¸ƒåœ¨0~65535ä¹‹é—´ã€‚é‚£ä½œè€…åœ¨åš`mod`è¿ç®—çš„æ—¶å€™ï¼Œä¸ºä»€ä¹ˆä¸`mod`65536ï¼Œè€Œé€‰æ‹©`mod`16384ï¼Ÿ\n\n**ä¸èƒ½å¤ªå¤§ï¼Œä¸»è¦ä»èŠ‚ç‚¹é—´çš„é€šä¿¡æ€§èƒ½æ–¹é¢è€ƒè™‘ï¼š**\n\næ¯ä¸ªèŠ‚ç‚¹ä¹‹é—´æ˜¯éœ€è¦è¿›è¡Œä¸€ä¸ªé€šä¿¡çš„ï¼Œä¹Ÿå°±æ˜¯ä¸æ–­åœ° pingpong æœºåˆ¶ï¼Œè®©æ¯ä¸ªèŠ‚ç‚¹è¿æ¥å¯¹æ–¹çš„ä¿¡æ¯ï¼›å‘é€çš„æ¶ˆæ¯å¤´ä¸­æœ‰ä¸€ä¸ª bitmapï¼Œå…¶ä¸­æ¯ä¸€ä½ä»£è¡¨ä¸€ä¸ªæ§½ï¼Œå¦‚æœè¯¥ä½ä¸º 1ï¼Œè¡¨ç¤ºè¿™ä¸ªæ§½æ˜¯å±äºå½“å‰èŠ‚ç‚¹ï¼Œå¦‚æœæ§½ä½è¿‡å¤§ï¼Œé‚£ä¹ˆè¿™ä¸ª bitmap å°±ä¼šå¤ªå¤§ï¼Œå¿ƒè·³åŒ…è¿‡äºåºå¤§ï¼Œæµªè´¹å¸¦å®½ã€‚\n\n**ä¸èƒ½å¤ªå°ï¼Œä¸»è¦ä»å‹ç¼©ç‡æ–¹é¢è€ƒè™‘ï¼š**\n\nç”±äº bitmap åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ä¼šè¿›è¡Œå‹ç¼©ï¼Œbitmap çš„å¡«å……ç‡ç”¨ slots/N è¡¨ç¤ºï¼ˆN å³èŠ‚ç‚¹æ•°ï¼‰ï¼Œå¯¹äºåŒæ ·çš„ slotsï¼Œå¦‚æœ N å¤ªå°ï¼Œå¯¼è‡´å…¶å¡«å……ç‡è¿‡é«˜ï¼Œå‹ç¼©ç‡å°±å¾ˆä½ã€‚\n\n***\n\n## ç¼“å­˜ç©¿é€ã€å‡»ç©¿ã€é›ªå´©\n\n### ç¼“å­˜ç©¿é€\n\n**é—®é¢˜æ¥æº**\n\nç¼“å­˜ç©¿é€æ˜¯æŒ‡ç¼“å­˜å’Œæ•°æ®åº“ä¸­éƒ½æ²¡æœ‰çš„æ•°æ®ï¼Œè€Œç”¨æˆ·ä¸æ–­å‘èµ·è¯·æ±‚ã€‚ç”±äºç¼“å­˜æ˜¯ä¸å‘½ä¸­æ—¶è¢«åŠ¨å†™çš„ï¼Œå¹¶ä¸”å‡ºäºå®¹é”™è€ƒè™‘ï¼Œå¦‚æœä»å­˜å‚¨å±‚æŸ¥ä¸åˆ°æ•°æ®åˆ™ä¸å†™å…¥ç¼“å­˜ï¼Œè¿™å°†å¯¼è‡´è¿™ä¸ªä¸å­˜åœ¨çš„æ•°æ®æ¯æ¬¡è¯·æ±‚éƒ½è¦åˆ°å­˜å‚¨å±‚å»æŸ¥è¯¢ï¼Œå¤±å»äº†ç¼“å­˜çš„æ„ä¹‰ã€‚åœ¨æµé‡å¤§æ—¶ï¼Œå¯èƒ½ DB å°±æŒ‚æ‰äº†ï¼Œè¦æ˜¯æœ‰äººåˆ©ç”¨ä¸å­˜åœ¨çš„ key é¢‘ç¹æ”»å‡»æˆ‘ä»¬çš„åº”ç”¨ï¼Œæ¯æ¬¡éƒ½å» DB åˆ¤æ–­ç„¶è€Œåˆä¸èƒ½å¤åˆ¶åˆ° Redis ä¸­ï¼Œè¿™å°±æ˜¯æ¼æ´ã€‚\n\nä¾‹å¦‚å‘èµ·ä¸º id ä¸ºâ€œ-1â€çš„æ•°æ®æˆ– id ä¸ºç‰¹åˆ«å¤§ä¸å­˜åœ¨çš„æ•°æ®ã€‚è¿™æ—¶çš„ç”¨æˆ·å¾ˆå¯èƒ½æ˜¯æ”»å‡»è€…ï¼Œæ”»å‡»ä¼šå¯¼è‡´æ•°æ®åº“å‹åŠ›è¿‡å¤§ã€‚\n\n**è§£å†³æ–¹æ¡ˆ**\n\n1. **æ¥å£æ ¡éªŒ**ï¼šæ¥å£å±‚å¢åŠ æ ¡éªŒï¼Œä¾‹å¦‚å¯¹ id<=0 çš„ç›´æ¥æ‹¦æˆªã€‚\n\n2. **ç¼“å­˜ç©ºå€¼**ï¼šä»ç¼“å­˜å–ä¸åˆ°çš„æ•°æ®ï¼Œåœ¨æ•°æ®åº“ä¸­ä¹Ÿæ²¡æœ‰å–åˆ°ï¼Œè¿™æ—¶ä¹Ÿå¯ä»¥å°† key-value å¯¹å†™ä¸º key-nullï¼Œç¼“å­˜æœ‰æ•ˆæ—¶é—´å¯ä»¥è®¾ç½®çŸ­ç‚¹ï¼Œå¦‚ 10 ç§’ï¼ˆè®¾ç½®å¤ªé•¿ä¼šå¯¼è‡´æ­£å¸¸æƒ…å†µä¹Ÿæ²¡æ³•ä½¿ç”¨ï¼‰ã€‚\n\n3. **å¸ƒéš†è¿‡æ»¤å™¨**ï¼šå¸ƒéš†è¿‡æ»¤å™¨ç”¨äºå¿«é€Ÿåˆ¤æŸä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨äºé›†åˆä¸­ï¼Œç”±ä¸€ä¸ªå¾ˆé•¿çš„äºŒè¿›åˆ¶å‘é‡ï¼ˆä½å›¾ï¼‰å’Œä¸€ç³»åˆ—å“ˆå¸Œå‡½æ•°ä¸¤éƒ¨åˆ†ç»„æˆã€‚å¸ƒéš†è¿‡æ»¤å™¨å¯ä»¥ç”¨äºæ£€ç´¢ä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨ä¸€ä¸ªé›†åˆä¸­ã€‚å®ƒçš„ä¼˜ç‚¹æ˜¯ç©ºé—´æ•ˆç‡å’ŒæŸ¥è¯¢æ—¶é—´éƒ½è¿œè¿œè¶…è¿‡ä¸€èˆ¬çš„ç®—æ³•ï¼Œç¼ºç‚¹æ˜¯æœ‰ä¸€å®šçš„é”™è¯¯è¯†åˆ«ç‡ï¼Œæ·»åŠ åˆ°é›†åˆä¸­çš„å…ƒç´ è¶Šå¤šï¼Œè¯¯æŠ¥çš„å¯èƒ½æ€§å°±è¶Šå¤§ã€‚\n\n\tä½æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½åªå ç”¨ 1 bit ï¼Œå¹¶ä¸”æ¯ä¸ªå…ƒç´ åªèƒ½æ˜¯ 0 æˆ–è€… 1ã€‚è¿™æ ·ç”³è¯·ä¸€ä¸ª 100w ä¸ªå…ƒç´ çš„ä½æ•°ç»„åªå ç”¨ 1000000Bit / 8 = 125000 Byte = 125000/1024 kb â‰ˆ 122kb çš„ç©ºé—´ã€‚\n\n\t> [å¸ƒéš†è¿‡æ»¤å™¨](https://javaguide.cn/cs-basics/data-structure/bloom-filter.html)\n\t>\n\t> [ç¼“å­˜ç©¿é€-å¸ƒéš†è¿‡æ»¤å™¨](https://javaguide.cn/database/Redis/Redis-questions-01.html#%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F)\n\n\tå…·ä½“è€Œè¨€ï¼š\n\n\tæŠŠ **æ‰€æœ‰å¯èƒ½å­˜åœ¨çš„è¯·æ±‚çš„å€¼** éƒ½å­˜æ”¾åœ¨å¸ƒéš†è¿‡æ»¤å™¨ä¸­ï¼Œå½“ç”¨æˆ·è¯·æ±‚è¿‡æ¥ï¼Œå…ˆåˆ¤æ–­ç”¨æˆ·å‘æ¥çš„è¯·æ±‚çš„å€¼æ˜¯å¦å­˜åœ¨äºå¸ƒéš†è¿‡æ»¤å™¨ä¸­ã€‚å¸ƒéš†è¿‡æ»¤å™¨åˆ¤æ–­ä¸å­˜åœ¨çš„è¯ï¼Œåˆ™è‚¯å®šä¸å­˜åœ¨ï¼Œå¸ƒéš†è¿‡æ»¤å™¨åˆ¤æ–­å­˜åœ¨ï¼Œåˆ™è¿›ä¸€æ­¥æŸ¥ Redisï¼ŒRedis ä¸­å­˜åœ¨åˆ™è¿”å›ï¼ŒRedis ä¸­ä¸å­˜åœ¨åˆ™æŸ¥æ•°æ®åº“ã€‚\n\n\tä¸ºä»€ä¹ˆå¸ƒéš†è¿‡æ»¤å™¨ä¼šå‡ºç°è¯¯åˆ¤çš„æƒ…å†µå‘¢? \n\n\t**å½“ä¸€ä¸ªå…ƒç´ åŠ å…¥å¸ƒéš†è¿‡æ»¤å™¨ä¸­çš„æ—¶å€™ï¼Œä¼šè¿›è¡Œä»¥ä¸‹æ“ä½œï¼š**\n\n\t1. ä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨ä¸­çš„å“ˆå¸Œå‡½æ•°å¯¹å…ƒç´ å€¼è¿›è¡Œè®¡ç®—ï¼Œå¾—åˆ°å“ˆå¸Œå€¼ï¼ˆæœ‰å‡ ä¸ªå“ˆå¸Œå‡½æ•°å¾—åˆ°å‡ ä¸ªå“ˆå¸Œå€¼ï¼‰ã€‚\n\n\t\t> hashVal1 = hashMethod1(key)ï¼Œ hashVal2= hashMethod2(key)...\n\n\t2. æ ¹æ®å¾—åˆ°çš„å“ˆå¸Œå€¼ï¼Œåœ¨ä½æ•°ç»„ä¸­æŠŠå¯¹åº”ä¸‹æ ‡çš„å€¼ç½®ä¸º 1ã€‚\n\n\t\t> æŠŠä½æ•°ç»„ä¸­çš„ hashVal1 å’Œ hashVal2 å¤„ç½®ä¸º 1\n\n\t**å½“æˆ‘ä»¬éœ€è¦åˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨äºå¸ƒéš†è¿‡æ»¤å™¨çš„æ—¶å€™ï¼Œä¼šè¿›è¡Œä»¥ä¸‹æ“ä½œï¼š**\n\n\t1. å¯¹ç»™å®šå…ƒç´ å†æ¬¡è¿›è¡Œç›¸åŒçš„å“ˆå¸Œè®¡ç®—ï¼›\n\n\t\t> hashVal1 = hashMethod1(key)ï¼Œ hashVal2= hashMethod2(key)...\n\n\t2. å¾—åˆ°å€¼ä¹‹ååˆ¤æ–­ä½æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ æ˜¯å¦éƒ½ä¸º 1ï¼Œå¦‚æœå€¼éƒ½ä¸º 1ï¼Œé‚£ä¹ˆè¯´æ˜è¿™ä¸ªå€¼åœ¨å¸ƒéš†è¿‡æ»¤å™¨ä¸­ï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ªå€¼ä¸ä¸º 1ï¼Œè¯´æ˜è¯¥å…ƒç´ ä¸åœ¨å¸ƒéš†è¿‡æ»¤å™¨ä¸­ã€‚\n\n\t\t> åˆ¤æ–­ä½æ•°ç»„ä¸­çš„ hashVal1 å’Œ hashVal2 å¤„æ˜¯å¦å…¨éƒ¨ä¸º 1ï¼Œå…¨éƒ¨ä¸º 1è¯´æ˜å½“å‰å…ƒç´ å­˜åœ¨äºä½æ•°ç»„ä¸­ã€‚\n\n\tç„¶è€Œä¼šå‡ºç°è¿™æ ·ä¸€ç§æƒ…å†µï¼š**ä¸åŒçš„å­—ç¬¦ä¸²å¯èƒ½å“ˆå¸Œå‡ºæ¥çš„ä½ç½®ç›¸åŒã€‚** ï¼ˆå¯ä»¥é€‚å½“å¢åŠ ä½æ•°ç»„å¤§å°æˆ–è€…è°ƒæ•´æˆ‘ä»¬çš„å“ˆå¸Œå‡½æ•°æ¥é™ä½æ¦‚ç‡ï¼‰\n\n\t> **â­ä¾‹å¦‚**ï¼šval1 ç»è¿‡ä¸¤æ¬¡hashå¾—åˆ°ä¸‹æ ‡ 1ï¼Œ 3ï¼Œå°†1ã€3å¤„ç½®ä¸º1ï¼Œval2ç»è¿‡ä¸¤æ¬¡hashå¾—åˆ°ä¸‹æ ‡2ã€4ï¼Œå°†2ã€4å¤„ç½®ä¸º1ï¼Œå¯¹äºæ–°å…ƒç´ val3ç»è¿‡ä¸¤æ¬¡hashå¾—åˆ°ä¸‹æ ‡1ã€2ï¼Œåˆ¤æ–­è¿™ä¸¤ä¸ªä½ç½®éƒ½ä¸º1ï¼Œè¯¯åˆ¤ä»¥ä¸ºval3å­˜åœ¨ï¼Œå®é™…ä¸Šä¸å­˜åœ¨ã€‚\n\n\n### ç¼“å­˜å‡»ç©¿\n\n**é—®é¢˜æ¥æº**\n\nç¼“å­˜å‡»ç©¿æ˜¯æŒ‡ä¸€ä¸ªçƒ­ç‚¹çš„ keyï¼Œæœ‰å¤§å¹¶å‘é›†ä¸­å¯¹å…¶è¿›è¡Œè®¿é—®ï¼Œçªç„¶é—´è¿™ä¸ª key å¤±æ•ˆäº†ï¼Œå¯¼è‡´å¤§å¹¶å‘å…¨éƒ¨æ‰“åœ¨æ•°æ®åº“ä¸Šï¼Œå¯¼è‡´æ•°æ®åº“å‹åŠ›å‰§å¢ã€‚è¿™ç§ç°è±¡å°±å«åšç¼“å­˜å‡»ç©¿ã€‚\n\n**è§£å†³æ–¹æ¡ˆ**\n\n> çƒ­ç‚¹keyå¤±æ•ˆ â†’ æ‰“åˆ°æ•°æ®åº“ä¸Šï¼Œå› æ­¤å¯ä»¥ä»è¿™ä¸¤æ–¹é¢è¿›è¡Œè§£å†³\n\n1ã€è®¾ç½®çƒ­ç‚¹æ•°æ®æ°¸è¿œä¸è¿‡æœŸã€‚\n\n2ã€æ¥å£é™æµã€é™çº§ä¸ç†”æ–­ã€‚é‡è¦çš„æ¥å£ä¸€å®šè¦åšå¥½é™æµç­–ç•¥ï¼Œé˜²æ­¢ç”¨æˆ·æ¶æ„åˆ·æ¥å£ï¼ŒåŒæ—¶è¦é™çº§å‡†å¤‡ï¼Œå½“æ¥å£ä¸­çš„æŸäº›æœåŠ¡ä¸å¯ç”¨æ—¶å€™ï¼Œè¿›è¡Œç†”æ–­ï¼Œå¤±è´¥å¿«é€Ÿè¿”å›æœºåˆ¶ã€‚\n\n3ã€åŠ äº’æ–¥é”ï¼šå¦‚æœç¼“å­˜å¤±æ•ˆçš„æƒ…å†µï¼Œåªæœ‰æ‹¿åˆ°é”æ‰å¯ä»¥æŸ¥è¯¢æ•°æ®åº“ï¼Œåˆ†å¸ƒå¼åœºæ™¯ä¸‹å¯ä»¥ä½¿ç”¨åˆ†å¸ƒå¼é”ã€‚\n\n### ç¼“å­˜é›ªå´©\n\n**é—®é¢˜æ¥æº**\n\nç¼“å­˜é›ªå´©æ˜¯æŒ‡ç¼“å­˜ä¸­æ•°æ®å¤§æ‰¹é‡åˆ°è¿‡æœŸæ—¶é—´ï¼Œè€ŒæŸ¥è¯¢æ•°æ®é‡å·¨å¤§ï¼Œå¼•èµ·æ•°æ®åº“å‹åŠ›è¿‡å¤§ç”šè‡³ down æœºã€‚å’Œç¼“å­˜å‡»ç©¿ä¸åŒçš„æ˜¯ï¼Œç¼“å­˜å‡»ç©¿æŒ‡å¹¶å‘æŸ¥åŒä¸€æ¡æ•°æ®ï¼Œç¼“å­˜é›ªå´©æ˜¯æŒ‡å¾ˆå¤šä¸åŒçš„æ•°æ®éƒ½è¿‡æœŸäº†ï¼Œéƒ½æŸ¥ä¸åˆ°ä»è€ŒæŸ¥æ•°æ®åº“ã€‚\n\n**è§£å†³æ–¹æ¡ˆ**\n\n1. **ç¼“å­˜æ•°æ®çš„è¿‡æœŸæ—¶é—´è®¾ç½®éšæœº**ï¼Œé˜²æ­¢åŒä¸€æ—¶é—´å¤§é‡æ•°æ®è¿‡æœŸç°è±¡å‘ç”Ÿã€‚\n2. è®¾ç½®çƒ­ç‚¹æ•°æ®æ°¸è¿œä¸è¿‡æœŸã€‚\n3. åœ¨å³å°†å‘ç”Ÿå¤§å¹¶å‘è®¿é—®ä¹‹å‰ï¼Œè¿›è¡Œ**ç¼“å­˜é¢„çƒ­**å°†å¯èƒ½å¤§é‡è®¿é—®çš„æ•°æ®åŠ è½½åˆ°ç¼“å­˜ã€‚\n4. æ¥å£é™æµã€é™çº§ä¸ç†”æ–­ã€‚é‡è¦çš„æ¥å£ä¸€å®šè¦åšå¥½é™æµç­–ç•¥ï¼Œé˜²æ­¢ç”¨æˆ·æ¶æ„åˆ·æ¥å£ï¼ŒåŒæ—¶è¦é™çº§å‡†å¤‡ï¼Œå½“æ¥å£ä¸­çš„æŸäº›æœåŠ¡ä¸å¯ç”¨æ—¶å€™ï¼Œè¿›è¡Œç†”æ–­ï¼Œå¤±è´¥å¿«é€Ÿè¿”å›æœºåˆ¶ã€‚\n5. ä¸ºäº†é˜²æ­¢ Redis å®•æœºå¯¼è‡´ç¼“å­˜é›ªå´©çš„é—®é¢˜ï¼Œå¯ä»¥**æ­å»ºRedisé›†ç¾¤**ï¼Œæé«˜ Redis çš„å®¹ç¾æ€§ã€‚\n6. æé«˜æ•°æ®åº“çš„å®¹ç¾èƒ½åŠ›ï¼Œå¯ä»¥ä½¿ç”¨**æ•°æ®åº“åˆ†åº“åˆ†è¡¨**ï¼Œè¯»å†™åˆ†ç¦»çš„ç­–ç•¥ã€‚\n\n## Redis æ·˜æ±°ç­–ç•¥\n\n### Redis å†…å­˜æ·˜æ±°ç­–ç•¥\n\n> Redis æ˜¯åŸºäºå†…å­˜ç»“æ„è¿›è¡Œæ•°æ®ç¼“å­˜çš„ï¼Œå½“å†…å­˜èµ„æºæ¶ˆè€—å®Œæ¯•ï¼Œå½“å°†è¦æœ‰æ–°çš„æ•°æ®ç¼“å­˜è¿›æ¥æ—¶ï¼Œä¸ºäº†è…¾å‡ºç©ºé—´æ”¾æ–°çš„æ•°æ®ï¼Œéœ€è¦å°†å†…å­˜ä¸­çš„ä¸€äº›æ•°æ®é‡Šæ”¾æ‰ï¼Œè¿™ç§é‡Šæ”¾æ•°æ®çš„ç­–ç•¥ç§°ä¸º Redis çš„æ·˜æ±°ç­–ç•¥ã€‚\n\nLRUï¼šLeast Recently Used\n\nLFUï¼šLeast Frequently Used\n\nLRU æ·˜æ±°çš„æ˜¯æœ€ä¹…æœªè®¿é—®åˆ°çš„æ•°æ®ï¼Œè€Œ LFU æ˜¯æ·˜æ±°çš„æ˜¯æœ€ä¸ç»å¸¸ä½¿ç”¨çš„æ•°æ®ï¼ˆè‹¥ä¸¤ä¸ªæˆ–å¤šä¸ªæ•°æ®çš„ä½¿ç”¨é¢‘ç‡ç›¸åŒæ—¶ï¼ŒLFU ä¼šå†é€‰æ‹©æœ€ä¹…æœªè®¿é—®åˆ°çš„æ•°æ®æ·˜æ±°ï¼‰ã€‚\n\n```conf\n# volatile-lru -> åœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„æ•°æ®ä¸­ä½¿ç”¨ LRU\n# allkeys-lru -> åœ¨æ‰€æœ‰æ•°æ®ä¸­ä½¿ç”¨ LRU\n# volatile-lfu -> åœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„æ•°æ®ä¸­ä½¿ç”¨ LFU\n# allkeys-lfu -> åœ¨æ‰€æœ‰æ•°æ®ä¸­ä½¿ç”¨ LFU\n# volatile-random -> åœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„æ•°æ®ä¸­éšæœºæ·˜æ±°\n# allkeys-random -> åœ¨æ‰€æœ‰æ•°æ®ä¸­éšæœºæ·˜æ±°\n# volatile-ttl -> è¶Šæ—©è¿‡æœŸçš„æ•°æ® è¶Šå…ˆè¢«æ·˜æ±°\n# noeviction -> ä¸æ·˜æ±°ä»»ä½•æ•°æ®ï¼Œå½“å†…å­˜ä¸å¤Ÿæ—¶ç›´æ¥æŠ›å‡ºå¼‚å¸¸\n```\n\n### Redis ç¼“å­˜å¤±æ•ˆç­–ç•¥\n\n**å®šæ—¶è¿‡æœŸç­–ç•¥**\n\næ¯ä¸ªè®¾ç½®è¿‡æœŸæ—¶é—´çš„ key éƒ½éœ€è¦åˆ›å»ºä¸€ä¸ªå®šæ—¶å™¨ï¼Œåˆ°è¿‡æœŸæ—¶é—´å°±ä¼šç«‹å³æ¸…é™¤ã€‚è¯¥ç­–ç•¥å¯ä»¥ç«‹å³æ¸…é™¤è¿‡æœŸçš„æ•°æ®ï¼Œå¯¹å†…å­˜å¾ˆå‹å¥½ï¼Œæœ‰æ•ˆåœ°å‡å°‘äº†å› ä¸ºè¿‡æœŸé”®å¸¦æ¥çš„å†…å­˜æµªè´¹ï¼›ä½†æ˜¯ä¼šå ç”¨å¤§é‡çš„ CPU èµ„æºå»å¤„ç†è¿‡æœŸçš„æ•°æ®ï¼Œä»è€Œå½±å“ç¼“å­˜çš„å“åº”æ—¶é—´å’Œååé‡ã€‚\n\n**æƒ°æ€§è¿‡æœŸç­–ç•¥**\n\nåªæœ‰å½“è®¿é—®ä¸€ä¸ª key æ—¶ï¼Œæ‰ä¼šåˆ¤æ–­è¯¥ key æ˜¯å¦å·²è¿‡æœŸï¼Œè¿‡æœŸåˆ™æ¸…é™¤ã€‚è¯¥ç­–ç•¥å¯ä»¥æœ€å¤§åŒ–åœ°èŠ‚çœ CPU èµ„æºï¼Œå´å¯¹å†…å­˜éå¸¸ä¸å‹å¥½ã€‚æç«¯æƒ…å†µå¯èƒ½å‡ºç°å¤§é‡çš„è¿‡æœŸ key æ²¡æœ‰å†æ¬¡è¢«è®¿é—®ï¼Œä»è€Œä¸ä¼šè¢«æ¸…é™¤ï¼Œå ç”¨å¤§é‡å†…å­˜ã€‚\n\n**å®šæœŸè¿‡æœŸç­–ç•¥**\n\næ¯éš”ä¸€å®šçš„æ—¶é—´ï¼Œä¼šæ‰«æä¸€å®šæ•°é‡çš„æ•°æ®åº“çš„ expires å­—å…¸ä¸­ä¸€å®šæ•°é‡çš„ keyï¼Œå¹¶æ¸…é™¤å…¶ä¸­å·²è¿‡æœŸçš„ keyã€‚è¯¥ç­–ç•¥æ˜¯å‰ä¸¤è€…çš„ä¸€ä¸ªæŠ˜ä¸­æ–¹æ¡ˆã€‚é€šè¿‡è°ƒæ•´å®šæ—¶æ‰«æçš„æ—¶é—´é—´éš”å’Œæ¯æ¬¡æ‰«æçš„é™å®šè€—æ—¶ï¼Œå¯ä»¥åœ¨ä¸åŒæƒ…å†µä¸‹ä½¿å¾— CPU å’Œå†…å­˜èµ„æºè¾¾åˆ°æœ€ä¼˜çš„å¹³è¡¡æ•ˆæœã€‚\n\n**Redisä¸­åŒæ—¶ä½¿ç”¨äº†å®šæœŸè¿‡æœŸå’Œæƒ°æ€§è¿‡æœŸä¸¤ç§è¿‡æœŸç­–ç•¥ã€‚**\n\næ‰€è°“å®šæœŸåˆ é™¤ï¼ŒæŒ‡çš„æ˜¯ Redis é»˜è®¤æ˜¯æ¯éš” 100ms å°±éšæœºæŠ½å–ä¸€äº›è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„ keyï¼Œæ£€æŸ¥å…¶æ˜¯å¦è¿‡æœŸï¼Œå¦‚æœè¿‡æœŸå°±åˆ é™¤ã€‚\n\n**å‡è®¾ Redis é‡Œæ”¾äº† 10w ä¸ª keyï¼Œéƒ½è®¾ç½®äº†è¿‡æœŸæ—¶é—´ï¼Œ**ä½ æ¯éš”å‡ ç™¾æ¯«ç§’ï¼Œå°±æ£€æŸ¥ 10w ä¸ª keyï¼Œé‚£ Redis åŸºæœ¬ä¸Šå°±æ­»äº†ï¼Œcpu è´Ÿè½½ä¼šå¾ˆé«˜çš„ï¼Œæ¶ˆè€—åœ¨ä½ çš„æ£€æŸ¥è¿‡æœŸ key ä¸Šäº†ã€‚**æ³¨æ„ï¼Œ**è¿™é‡Œå¯ä¸æ˜¯æ¯éš” 100ms å°±éå†æ‰€æœ‰çš„è®¾ç½®è¿‡æœŸæ—¶é—´çš„ keyï¼Œé‚£æ ·å°±æ˜¯ä¸€åœºæ€§èƒ½ä¸Šçš„ç¾éš¾ã€‚å®é™…ä¸Š Redis æ˜¯æ¯éš” 100ms éšæœºæŠ½å–ä¸€äº› key æ¥æ£€æŸ¥å’Œåˆ é™¤çš„ã€‚\n\n**ä½†æ˜¯é—®é¢˜æ˜¯ï¼Œå®šæœŸåˆ é™¤å¯èƒ½ä¼šå¯¼è‡´å¾ˆå¤šè¿‡æœŸ key åˆ°äº†æ—¶é—´å¹¶æ²¡æœ‰è¢«åˆ é™¤æ‰ï¼Œé‚£å’‹æ•´å‘¢ï¼Ÿ**æ‰€ä»¥å°±æ˜¯æƒ°æ€§åˆ é™¤äº†ã€‚è¿™å°±æ˜¯è¯´ï¼Œåœ¨ä½ è·å–æŸä¸ª key çš„æ—¶å€™ï¼ŒRedis ä¼šæ£€æŸ¥ä¸€ä¸‹ ï¼Œè¿™ä¸ª key å¦‚æœè®¾ç½®äº†è¿‡æœŸæ—¶é—´é‚£ä¹ˆæ˜¯å¦è¿‡æœŸäº†ï¼Ÿå¦‚æœè¿‡æœŸäº†æ­¤æ—¶å°±ä¼šåˆ é™¤ï¼Œä¸ä¼šç»™ä½ è¿”å›ä»»ä½•ä¸œè¥¿ã€‚\n\n**è·å– key çš„æ—¶å€™ï¼Œå¦‚æœæ­¤æ—¶ key å·²ç»è¿‡æœŸï¼Œå°±åˆ é™¤ï¼Œä¸ä¼šè¿”å›ä»»ä½•ä¸œè¥¿ã€‚**ä½†æ˜¯å®é™…ä¸Šè¿™è¿˜æ˜¯æœ‰é—®é¢˜çš„ï¼Œå¦‚æœå®šæœŸåˆ é™¤æ¼æ‰äº†å¾ˆå¤šè¿‡æœŸ keyï¼Œç„¶åä½ ä¹Ÿæ²¡åŠæ—¶å»æŸ¥ï¼Œä¹Ÿå°±æ²¡èµ°æƒ°æ€§åˆ é™¤ï¼Œæ­¤æ—¶ä¼šæ€ä¹ˆæ ·ï¼Ÿå¦‚æœå¤§é‡è¿‡æœŸ key å †ç§¯åœ¨å†…å­˜é‡Œï¼Œå¯¼è‡´ Redis å†…å­˜å¿«è€—å°½äº†ï¼Œå’‹æ•´ï¼Ÿ**ç­”æ¡ˆæ˜¯ï¼šèµ°å†…å­˜æ·˜æ±°æœºåˆ¶ã€‚**\n\n***\n\n## Redisåˆ†å¸ƒå¼å¹¶å‘é—®é¢˜\n\n> å•ä½“é¡¹ç›®ä¸­ï¼Œè´­ç‰©è½¦ä¸‹å•å¯ä»¥ä½¿ç”¨ synchronized å…³é”®å­—é”ä½å®ä¾‹å¯¹è±¡ï¼Œåªè®©ä¸€ä¸ªçº¿ç¨‹ä¸‹å•å¹¶æ‰£å‡åº“å­˜\n>\n> è€Œå¯¹äºé›†ç¾¤è€Œè¨€ï¼Œåœ¨æ¯å°æœåŠ¡å™¨ä¸Šé”ä½å®ä¾‹å¯¹è±¡ï¼Œä½†æ˜¯æ¯å°ä¹‹é—´æ˜¯æ— æ³•æ„ŸçŸ¥çš„ï¼Œä»ç„¶å¯èƒ½å­˜åœ¨å•†å“è¶…å–é—®é¢˜\n\n### ä½¿ç”¨ Redis å®ç°åˆ†å¸ƒå¼é”\n\n```java\n@Transactional\n@Override\npublic Map<String, String> addOrder(String cids, Orders orders) {\n    log.info(\"add order begin...\");\n\n    Map<String, String> map = new HashMap<>();\n\n    // 1ã€æ ¹æ®cidsæŸ¥è¯¢å½“å‰è®¢å•ä¸­å…³è”çš„è´­ç‰©è½¦è®°å½•è¯¦æƒ…ï¼ˆåŒ…æ‹¬åº“å­˜ï¼‰\n    String[] arr = cids.split(\"ï¼Œ\");\n    List<Integer> cidsList = new ArrayList<>();\n    for (String s : arr) {\n        cidsList.add(Integer.parseInt(s));\n    }\n    // è·å–æ‰€æœ‰skuId\n    List<ShoppingCartVO> list1 = shoppingCartMapper.selectShopCartByCids(cidsList);\n\n    boolean allLocked = true;\n    List<String> lockedSkuIds = new ArrayList<>();\n    Map<String, String> values = new HashMap<>();\n    for (ShoppingCartVO sc : list1) {\n        String skuId = sc.getSkuId()ï¼Œ value = UUID.randomUUID().toString();\n        Boolean thisLocked = srt.boundValueOps(sc.getSkuId()).setIfAbsent(value, 10, TimeUnit.SECONDS);\n        if (!thisLocked) {   // è¿”å› false è¯´æ˜ä¹‹å‰æœ‰è¯¥æ•°æ®ï¼Œå³æœ‰çº¿ç¨‹åœ¨æ“ä½œè¿™ä¸ª å•†å“åº“å­˜\n            allLocked = false;  // å› æ­¤è¿™ä¸ªskuå°±æ²¡æœ‰é”ä½ï¼Œä¸èƒ½ç»§ç»­æ“ä½œ\n            break;\n        } else {\n            lockedSkuIds.add(skuId);\n            values.put(skuId, value);\n        }\n    }\n    if (allLocked) {\n        // 2ã€æ ¡éªŒåº“å­˜\n        List<ShoppingCartVO> list = shoppingCartMapper.selectShopCartByCids(cidsList);\n        boolean f = true;\n        StringBuilder sb = new StringBuilder();\n        for (ShoppingCartVO sc : list) {\n            if (Integer.parseInt(sc.getCartNum()) > sc.getSkuStock()) {\n                f = false;\n            }\n            //è·å–æ‰€æœ‰å•†å“çš„åç§°ï¼Œä»¥é€—å·æ‹¼æ¥æˆå­—ç¬¦ä¸²\n            sb.append(sc.getProductName()).append(\"ï¼Œ\");\n        }\n        String untitled = sb.toString();\n\n        if (f) {\n            log.info(\"product stock is ok ... \");\n            // 3ã€è¡¨ç¤ºåº“å­˜å……è¶³----ä¿å­˜è®¢å•\n            // a.userId   b.untitled  c.æ”¶è´§äººä¿¡æ¯ï¼šå§“åã€ç”µè¯ã€åœ°å€\n            // d.æ€»ä»·æ ¼   e.æ”¯ä»˜æ–¹å¼   f.è®¢å•çš„åˆ›å»ºæ—¶é—´  g.è®¢å•åˆå§‹çŠ¶æ€\n            orders.setUntitled(untitled);\n            orders.setCreateTime(new Date());\n            orders.setStatus(\"1\");\n\n            // ç”Ÿæˆè®¢å•ç¼–å·\n            String orderId = UUID.randomUUID().toString().replace(\"-\"ï¼Œ \"\");\n            orders.setOrderId(orderId);\n\n            // ä¿å­˜è®¢å•\n            ordersMapper.insert(orders);\n            // 4ã€ç”Ÿæˆå•†å“å¿«ç…§\n            for (ShoppingCartVO sc : list) {\n                int cnum = Integer.parseInt(sc.getCartNum());\n                String itemId = System.currentTimeMillis() + \"\" + (new Random().nextInt(89999) + 10000);\n                OrderItem orderItem = new OrderItem(itemId, orderId, sc.getProductId()ï¼Œ sc.getProductName()ï¼Œ sc.getProductImg()ï¼Œ sc.getSkuId()ï¼Œ\n                                                    sc.getSkuName()ï¼Œ BigDecimal.valueOf(sc.getSellPrice())ï¼Œ cnum, new BigDecimal(sc.getSellPrice() * cnum)ï¼Œ new Date()ï¼Œ new Date()ï¼Œ 0);\n                orderItemMapper.insert(orderItem);\n            }\n\n            // 5ã€æ‰£å‡åº“å­˜ï¼šæ ¹æ®å¥—é¤Idä¿®æ”¹å¥—é¤åº“å­˜é‡\n            for (ShoppingCartVO sc : list) {\n                String skuId = sc.getSkuId();\n                int newStock = sc.getSkuStock() - Integer.parseInt(sc.getCartNum());\n\n                ProductSku productSku = new ProductSku();\n                productSku.setSkuId(skuId);\n                productSku.setStock(newStock);\n                //æ ¹æ®ä¸»é”®æ¥ä¿®æ”¹å±æ€§å€¼\n                productSkuMapper.updateByPrimaryKeySelective(productSku);\n            }\n\n            // 6ã€åˆ é™¤è´­ç‰©è½¦ï¼šå½“è´­ç‰©è½¦ä¸­çš„è®°å½•è´­ä¹°æˆåŠŸä¹‹åï¼Œè´­ç‰©è½¦ä¸­å¯¹åº”åšåˆ é™¤æ“ä½œ\n            for (int cid : cidsList) {\n                shoppingCartMapper.deleteByPrimaryKey(cid);\n            }\n\n            // é‡Šæ”¾é”\n            for (String lockedSkuId : lockedSkuIds) {\n                String value = srt.boundValueOps(lockedSkuId).get();\n                if (value != null && value.equals(values.get(lockedSkuId))) {\n                    srt.delete(lockedSkuId);\n                }\n            }\n\n            log.info(\"add order finished... \");\n\n            map.put(\"orderId\"ï¼Œ orderId);\n            map.put(\"productNames\"ï¼Œ untitled);\n            return map;\n        } else {\n            // è¡¨ç¤ºåº“å­˜ä¸è¶³\n            return null;\n        }\n    } else {    // åŠ é”å¤±è´¥\n        // è¦å°†éƒ¨åˆ†é”å®šçš„skué‡Šæ”¾é”ï¼Œå³ä»Redisä¸­ç§»é™¤é”ä½çš„skuId\n        for (String lockedSkuId : lockedSkuIds) {\n            srt.delete(lockedSkuId);\n        }\n        return null;\n    }\n}\n```\n\n1. å¦‚æœè®¢å•ä¸­éƒ¨åˆ†å•†å“åŠ é”æˆåŠŸï¼Œä½†æ˜¯ç”±äºä¸€äº›å•†å“åŠ é”å¤±è´¥å¯¼è‡´æ— æ³•æäº¤è®¢å•ï¼Œæ­¤æ—¶è¦æ³¨æ„å°†åŠ é”çš„å•†å“æ¢å¤ï¼Œå³ä» Redis ä¸­ç§»é™¤è¯¥å•†å“\n\n\t> åœ¨ allLocked == false ä¸­ï¼Œé‡Šæ”¾åŠ é”çš„å•†å“\n\n2. ç¬¬ä¸€æ¬¡æ ¹æ® è´­ç‰©è½¦ Id æŸ¥åˆ°çš„è´­ç‰©è½¦è®°å½•ï¼ˆåŒ…å«å•†å“åº“å­˜ï¼‰åˆ°åŠ é”æäº¤è®¢å•ä¹‹å‰ï¼Œå¯èƒ½æœ‰åˆ«çš„çº¿ç¨‹ æ“ä½œäº†å…¶ä¸­æŸä¸ªå•†å“çš„åº“å­˜å¹¶æ“ä½œå®Œäº†ï¼Œä¸ºäº†é˜²æ­¢å½“å‰çº¿ç¨‹è¿˜å¯¹ä¹‹å‰åº“å­˜è¿›è¡Œä¿®æ”¹ï¼Œåº”å½“åœ¨åŠ é”åæ“ä½œå‰é‡æ–°æŸ¥è¯¢åº“å­˜ã€‚\n\n3. å½“å‰çº¿ç¨‹åŠ é”æˆåŠŸä¹‹åï¼Œåœ¨æ‰§è¡Œæ·»åŠ è®¢å•çš„è¿‡ç¨‹ä¸­å¦‚æœå‡ºç°äº†å¼‚å¸¸å¯¼è‡´æ— æ³•é‡Šæ”¾é”\n\n\t> å¯ä»¥åœ¨å¯¹å•†å“åŠ é”æ—¶è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œåˆ™åˆ°æœŸè‡ªåŠ¨é‡Šæ”¾é”\n\n4. æ¡£ç»™é”è®¾ç½®äº†è¿‡æœŸæ—¶é—´ä¹‹åï¼Œå¦‚æœå½“å‰çº¿ç¨‹ t1 å› ä¸ºç‰¹æ®ŠåŸå› ï¼Œåœ¨é”è¿‡æœŸä¹‹å‰æ²¡æœ‰å®Œæˆä¸šåŠ¡æ‰§è¡Œï¼Œé‡Šæ”¾æ‰äº†é”ï¼Œæ­¤æ—¶çº¿ç¨‹ t2 åŠ é”æˆåŠŸï¼Œå¦‚æœçº¿ç¨‹ t1 æ‰§è¡Œç»“æŸï¼Œå°†ä¼šé‡Šæ”¾ çº¿ç¨‹ t2 çš„é”ï¼Œå¯¼è‡´ çº¿ç¨‹ t2 åœ¨æ— é”çŠ¶æ€\n\n\t> å¯¹äºåŠ æˆåŠŸå¹¶æäº¤å®Œè®¢å•ä¹‹åï¼Œå¯¹å½“å‰å•†å“çš„é”é‡Šæ”¾ï¼Œè¦åˆ¤æ–­ Redis ä¸­çš„valueæ˜¯å¦å’Œè‡ªå·±è®°å½•çš„ç›¸åŒï¼Œå³æ˜¯å¦æ˜¯è‡ªå·±åŠ çš„é”\n\t>\n\t> ```java\n\t> // é‡Šæ”¾é”\n\t> for (String lockedSkuId : lockedSkuIds) {\n\t>    String value = srt.boundValueOps(lockedSkuId).get();\n\t>    if (values.get(lockedSkuId).equals(value)) {\n\t>      \tsrt.delete(lockedSkuId);\n\t>    }\n\t> }\n\t> ```\n\n5. å½“å‰çº¿ç¨‹ t1 åˆ¤æ–­æ˜¯è‡ªå·±åŠ çš„é”ï¼Œåœ¨å‡†å¤‡åˆ é™¤ä¹‹å‰ï¼Œé”è¿‡æœŸäº†å¹¶ä¸”è¢«å…¶ä»–çº¿ç¨‹ t2 æ‹¿åˆ°äº†æˆåŠŸåŠ é”ï¼Œè¿™æ—¶å€™çº¿ç¨‹ t1 ä¼šé‡Šæ”¾æ‰çº¿ç¨‹ t2 çš„é”ï¼ˆå¹¶å‘é‡å¾ˆå¤§ä»ç„¶éœ€è¦è€ƒè™‘ï¼‰\n\n\t> ä¿è¯ æŸ¥è¯¢é”æ˜¯å¦æ˜¯è‡ªå·±åŠ çš„å’Œåˆ é™¤è‡ªå·±åŠ çš„é” çš„åŸå­æ€§ï¼ˆä½¿ç”¨ lua è„šæœ¬ï¼Œè®©å¤šä¸ª Redis æ“ä½œå…·æœ‰åŸå­æ€§ï¼ŒæŸ¥è¯¢+åˆ é™¤ï¼‰\n\n6. ä½¿ç”¨çœ‹é—¨ç‹—çº¿ç¨‹è§£å†³çº¿ç¨‹ t1 é‡Šæ”¾ç›¸ä¹˜ t2 çš„é”çš„é—®é¢˜\n\n\t> çº¿ç¨‹t1 åŠ é”å¹¶è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œæ­¤æ—¶å¯åŠ¨ çœ‹é—¨ç‹—çº¿ç¨‹ï¼ˆå®ˆæŠ¤çº¿ç¨‹ï¼‰ç›‘æ§çº¿ç¨‹ t1è¿‡æœŸæ—¶é—´ï¼Œè¿‡æœŸæ—¶é—´è¦åˆ°äº†ä½†æ˜¯çº¿ç¨‹t1 ä¸šåŠ¡è¿˜åœ¨æ‰§è¡Œï¼Œåˆ™é‡ç½®è¿‡æœŸæ—¶é—´ï¼Œè¿™æ ·å¯ä»¥ä¿è¯ä¸šåŠ¡æ‰§è¡Œå®Œä¹‹å‰ä¸ä¼šé‡Šæ”¾é”\n\n### åˆ†å¸ƒå¼é”æ¡†æ¶ Resisson\n\n- æ·»åŠ ä¾èµ–\n\n\t```xml\n\t<!-- https://mvnrepository.com/artifact/org.redisson/redisson -->\n\t<dependency>\n\t    <groupId>org.redisson</groupId>\n\t    <artifactId>redisson</artifactId>\n\t    <version>3.16.7</version>\n\t</dependency>\n\t```\n\n- é…ç½® yaml æ–‡ä»¶\n\n\t```yaml\n\tredisson:\n\t  addr:\n\t    singleAddr:\n\t      host: Redis://47.110.247.63:6389\n\t      password: FYX123fyx.\n\t      database: 0\n\t```\n\n- é…ç½® RedissonClientï¼ˆä¹Ÿå¯ä»¥é…ç½®æˆé›†ç¾¤æ¨¡å¼ã€ä¸»ä»æ¨¡å¼ï¼‰\n\n\t```java\n\t@Configuration\n\tpublic class RedissonConfig {\n\t    @Value(\"${redisson.addr.singleAddr.host}\")\n\t    private String host;\n\t\n\t    @Value(\"${redisson.addr.singleAddr.password}\")\n\t    private String password;\n\t\n\t    @Value(\"${redisson.addr.singleAddr.database}\")\n\t    private int database;\n\t\n\t    @Bean\n\t    public RedissonClient redissonClient() {\n\t        Config config = new Config();\n\t        config.useSingleServer().setAddress(host)\n\t                .setPassword(password)\n\t                .setDatabase(database);\n\t        return Redisson.create(config);\n\t    }\n\t}\n\t```\n\n- æ“ä½œ\n\n\t```java\n\t@Transactional\n\t@Override\n\tpublic Map<String, String> addOrder(String cids, Orders orders) {\n\t    log.info(\"add order begin...\");\n\t\n\t    // 1ã€æ ¹æ®cidsæŸ¥è¯¢å½“å‰è®¢å•ä¸­å…³è”çš„è´­ç‰©è½¦è®°å½•è¯¦æƒ…ï¼ˆåŒ…æ‹¬åº“å­˜ï¼‰\n\t    String[] arr = cids.split(\"ï¼Œ\");\n\t    List<Integer> cidsList = new ArrayList<>();\n\t    for (String s : arr) {\n\t        cidsList.add(Integer.parseInt(s));\n\t    }\n\t    // è·å–æ‰€æœ‰skuId\n\t    List<ShoppingCartVO> list = shoppingCartMapper.selectShopCartByCids(cidsList);\n\t    List<String> lockedSkuIds = new ArrayList<>();\n\t    Map<String, RLock> locks = new HashMap<>(); // {\"1\":lock1, \"2\":lock2}\n\t    boolean allLocked = true;\n\t    for (ShoppingCartVO sc : list) {\n\t        String skuId = sc.getSkuId();\n\t        boolean b = false;\n\t        RLock lock = redissonClient.getLock(skuId);\n\t        try {\n\t            b = lock.tryLock(10, 3, TimeUnit.SECONDS);\n\t        } catch (InterruptedException e) {\n\t            e.printStackTrace();\n\t        }\n\t        if (!b) {\n\t            allLocked = false;\n\t            break;\n\t        } else {\n\t            lockedSkuIds.add(skuId);\n\t            locks.put(skuId, lock);\n\t        }\n\t    }\n\t\n\t    Map<String, String> map = null;\n\t    try {\n\t        if (allLocked) {\n\t            // 2ã€æ ¡éªŒåº“å­˜\n\t            list = shoppingCartMapper.selectShopCartByCids(cidsList);\n\t            boolean f = true;\n\t            StringBuilder sb = new StringBuilder();\n\t            for (ShoppingCartVO sc : list) {\n\t                if (Integer.parseInt(sc.getCartNum()) > sc.getSkuStock()) {\n\t                    f = false;\n\t                }\n\t                //è·å–æ‰€æœ‰å•†å“çš„åç§°ï¼Œä»¥é€—å·æ‹¼æ¥æˆå­—ç¬¦ä¸²\n\t                sb.append(sc.getProductName()).append(\"ï¼Œ\");\n\t            }\n\t            String untitled = sb.toString();\n\t\n\t            if (f) {\n\t                log.info(\"product stock is ok ... \");\n\t                // 3ã€è¡¨ç¤ºåº“å­˜å……è¶³----ä¿å­˜è®¢å•\n\t                // a.userId   b.untitled  c.æ”¶è´§äººä¿¡æ¯ï¼šå§“åã€ç”µè¯ã€åœ°å€\n\t                // d.æ€»ä»·æ ¼   e.æ”¯ä»˜æ–¹å¼   f.è®¢å•çš„åˆ›å»ºæ—¶é—´  g.è®¢å•åˆå§‹çŠ¶æ€\n\t                orders.setUntitled(untitled);\n\t                orders.setCreateTime(new Date());\n\t                orders.setStatus(\"1\");\n\t\n\t                // ç”Ÿæˆè®¢å•ç¼–å·\n\t                String orderId = UUID.randomUUID().toString().replace(\"-\"ï¼Œ \"\");\n\t                orders.setOrderId(orderId);\n\t\n\t                // ä¿å­˜è®¢å•\n\t                ordersMapper.insert(orders);\n\t                // 4ã€ç”Ÿæˆå•†å“å¿«ç…§\n\t                for (ShoppingCartVO sc : list) {\n\t                    int cnum = Integer.parseInt(sc.getCartNum());\n\t                    String itemId = System.currentTimeMillis() + \"\" + (new Random().nextInt(89999) + 10000);\n\t                    OrderItem orderItem = new OrderItem(itemId, orderId, sc.getProductId()ï¼Œ sc.getProductName()ï¼Œ sc.getProductImg()ï¼Œ sc.getSkuId()ï¼Œ\n\t                                                        sc.getSkuName()ï¼Œ BigDecimal.valueOf(sc.getSellPrice())ï¼Œ cnum, new BigDecimal(sc.getSellPrice() * cnum)ï¼Œ new Date()ï¼Œ new Date()ï¼Œ 0);\n\t                    orderItemMapper.insert(orderItem);\n\t                }\n\t\n\t                // 5ã€æ‰£å‡åº“å­˜ï¼šæ ¹æ®å¥—é¤Idä¿®æ”¹å¥—é¤åº“å­˜é‡\n\t                for (ShoppingCartVO sc : list) {\n\t                    String skuId = sc.getSkuId();\n\t                    int newStock = sc.getSkuStock() - Integer.parseInt(sc.getCartNum());\n\t\n\t                    ProductSku productSku = new ProductSku();\n\t                    productSku.setSkuId(skuId);\n\t                    productSku.setStock(newStock);\n\t                    //æ ¹æ®ä¸»é”®æ¥ä¿®æ”¹å±æ€§å€¼\n\t                    productSkuMapper.updateByPrimaryKeySelective(productSku);\n\t                }\n\t\n\t                // 6ã€åˆ é™¤è´­ç‰©è½¦ï¼šå½“è´­ç‰©è½¦ä¸­çš„è®°å½•è´­ä¹°æˆåŠŸä¹‹åï¼Œè´­ç‰©è½¦ä¸­å¯¹åº”åšåˆ é™¤æ“ä½œ\n\t                for (int cid : cidsList) {\n\t                    shoppingCartMapper.deleteByPrimaryKey(cid);\n\t                }\n\t\n\t                log.info(\"add order finished... \");\n\t\n\t                map = new HashMap<>();\n\t                map.put(\"orderId\"ï¼Œ orderId);\n\t                map.put(\"productNames\"ï¼Œ untitled);\n\t\n\t            }\n\t\n\t        }\n\t    } catch (Exception e) {\n\t        e.printStackTrace();\n\t    } finally {\n\t        // é‡Šæ”¾é”\n\t        for (String lockedSkuId : lockedSkuIds) {\n\t            locks.get(lockedSkuId).unlock();\n\t        }\n\t    }\n\t    return map;\n\t}\n\t```\n\n### åˆ†å¸ƒå¼é”ç‰¹ç‚¹\n\n1. äº’æ–¥æ€§\n\n\tä¿è¯åœ¨ä¸åŒèŠ‚ç‚¹é—´ä¸åŒçº¿ç¨‹çš„äº’æ–¥ï¼ˆåªæœ‰ä¸€ä¸ªèŠ‚ç‚¹å½“ç„¶å¯ä»¥ï¼‰\n\n2. å¯é‡å…¥æ€§\n\n\tåŒä¸€ä¸ªèŠ‚ç‚¹ä¸Šçš„åŒä¸€ä¸ªçº¿ç¨‹å¦‚æœè·å–é”ä¹‹åå¯ä»¥å†æ¬¡è·å–åˆ°è¿™ä¸ªé”\n\n3. é”è¶…æ—¶\n\n\tåŠ é”æˆåŠŸä¹‹åè®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œä»¥é˜²æ­¢çº¿ç¨‹æ•…éšœå¯¼è‡´ä¸é‡Šæ”¾é”è€Œå¼•èµ·æ­»é”\n\n4. é«˜æ•ˆã€é«˜å¯ç”¨\n\n\tæ”¯æŒå•èŠ‚ç‚¹ Redisã€ä¸»ä» Redisã€é›†ç¾¤ Redis\n\n5. æ”¯æŒé˜»å¡å’Œéé˜»å¡\n\n\ttryLock éé˜»å¡ å’Œ tryLock(long timeOut) é˜»å¡\n\n### Redisson çš„ä½¿ç”¨\n\n1. è·å–é”ï¼ˆå…¬å¹³é” / éå…¬å¹³é”ï¼‰\n\n\t```java\n\t// å…¬å¹³é”\n\tRLock lock = redissonClient.getFairLock(skuId);\n\t\n\t// éå…¬å¹³é”\n\tRLock lock = redissonClient.getLock(skuId);\n\t```\n\n2. åŠ é”ï¼ˆé˜»å¡é” / éé˜»å¡é”ï¼‰\n\n\t```java\n\t// é˜»å¡é”ï¼Œè®¾ç½®åŠ é”æˆåŠŸåçš„è¶…æ—¶æ—¶é—´ 20sï¼Œä¸åŠ æ—¶é—´é»˜è®¤ 30s\n\tlock.lock(20, TimeUnit.SECONDS);\n\t\n\t// éé˜»å¡é”ï¼ˆè®¾ç½®ç­‰å¾…æ—¶é—´ 3sï¼ŒåŠ é”æˆåŠŸåçš„è¶…æ—¶æ—¶é—´ 10sï¼Œä¸åŠ åˆ™é»˜è®¤ 30sï¼‰\n\tlock.tryLock(10, 3, TimeUnit.SECONDS);\n\t```\n\n3. é‡Šæ”¾é”\n\n\t```java\n\tlock.unlock();\n\t```\n\n4. å®ä¾‹\n\n\t```java\n\t// å…¬å¹³éé˜»å¡é”\n\tRLock lock = redissonClient.getLock(skuId);\n\tlock.tryLock(10, 3, TimeUnit.SECONDS);\n\t```\n\n***\n\n## ç¼“å­˜ä¸æ•°æ®åº“åŒå†™ä¸€è‡´æ€§\n\næ€»ç»“ï¼š\n\nè¯»æ•°æ®ï¼šå…ˆè¯»ç¼“å­˜ï¼Œå¦‚æœæœ‰ç›´æ¥è¿”å›ï¼Œå¦‚æœæ²¡æœ‰æŸ¥æ•°æ®åº“æŸ¥åˆ°æ•°æ®å­˜åˆ°ç¼“å­˜ä¸­å¹¶è¿”å›\n\nå†™æ•°æ®ï¼šå…ˆå†™æ•°æ®åº“ï¼Œå†åˆ ç¼“å­˜ï¼Œè¿™ä¸ªé˜¶æ®µå¯èƒ½åˆ ç¼“å­˜å¤±è´¥ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ä¸€ä¸‹ä¸‰ç§æ–¹æ¡ˆï¼š\n\n1. å¦‚æœåˆ é™¤ç¼“å­˜å¤±è´¥ï¼Œéœ€è¦å°†æ•°æ®å†™å…¥é‡è¯•è¡¨ï¼Œç„¶åä½¿ç”¨ elastic-job ç­‰å®šæ—¶ä»»åŠ¡è¿›è¡Œé‡è¯•ã€‚\n2. å¦‚æœåˆ é™¤ç¼“å­˜å¤±è´¥ï¼Œéœ€è¦å°†æ•°æ®å‘é€ mq æ¶ˆæ¯åˆ° mq æœåŠ¡å™¨ï¼Œåœ¨ mq çš„ consumer ä¸­å¤„ç†ã€‚\n3. è®¢é˜… mysql çš„ binlogï¼Œåœ¨è®¢é˜…è€…ä¸­ï¼Œå¦‚æœå‘ç°äº†æ›´æ–°æ•°æ®è¯·æ±‚ï¼Œåˆ™åˆ é™¤ç›¸åº”çš„ç¼“å­˜ã€‚\n\n> [å¦‚ä½•ä¿è¯æ•°æ®åº“å’Œç¼“å­˜åŒå†™ä¸€è‡´æ€§ï¼Ÿ-è‹ä¸‰è¯´æŠ€æœ¯](https://www.zhihu.com/question/319817091/answer/2432904728)\n\n### é—®é¢˜å¼•å…¥\n\né€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨ç¼“å­˜çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æå‡æŸ¥è¯¢çš„æ€§èƒ½ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ˜¯è¿™æ ·ä½¿ç”¨ç¼“å­˜çš„ï¼š\n\n![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650526232523.png)\n\n1. ç”¨æˆ·è¯·æ±‚è¿‡æ¥ä¹‹åï¼Œå…ˆæŸ¥ç¼“å­˜æœ‰æ²¡æœ‰æ•°æ®ï¼Œå¦‚æœæœ‰åˆ™ç›´æ¥è¿”å›ã€‚\n2. å¦‚æœç¼“å­˜æ²¡æ•°æ®ï¼Œå†ç»§ç»­æŸ¥æ•°æ®åº“ã€‚\n3. å¦‚æœæ•°æ®åº“æœ‰æ•°æ®ï¼Œåˆ™å°†æŸ¥è¯¢å‡ºæ¥çš„æ•°æ®ï¼Œæ”¾å…¥ç¼“å­˜ä¸­ï¼Œç„¶åè¿”å›è¯¥æ•°æ®ã€‚\n4. å¦‚æœæ•°æ®åº“ä¹Ÿæ²¡æ•°æ®ï¼Œåˆ™ç›´æ¥è¿”å›ç©ºã€‚\n\nè¿™æ˜¯ç¼“å­˜éå¸¸å¸¸è§çš„ç”¨æ³•ã€‚ä¸€çœ¼çœ‹ä¸Šå»ï¼Œå¥½åƒæ²¡æœ‰å•¥é—®é¢˜ã€‚\n\nä½†ä½ å¿½ç•¥äº†ä¸€ä¸ªéå¸¸é‡è¦çš„ç»†èŠ‚ï¼š**å¦‚æœæ•°æ®åº“ä¸­çš„æŸæ¡æ•°æ®ï¼Œæ”¾å…¥ç¼“å­˜ä¹‹åï¼Œåˆç«‹é©¬è¢«æ›´æ–°äº†ï¼Œé‚£ä¹ˆè¯¥å¦‚ä½•æ›´æ–°ç¼“å­˜å‘¢ï¼Ÿ**\n\nä¸æ›´æ–°ç¼“å­˜è¡Œä¸è¡Œï¼Ÿ\n\nç­”ï¼šå½“ç„¶ä¸è¡Œï¼Œå¦‚æœä¸æ›´æ–°ç¼“å­˜ï¼Œåœ¨å¾ˆé•¿çš„ä¸€æ®µæ—¶é—´å†…ï¼ˆå†³å®šäºç¼“å­˜çš„è¿‡æœŸæ—¶é—´ï¼‰ï¼Œç”¨æˆ·è¯·æ±‚ä»ç¼“å­˜ä¸­è·å–åˆ°çš„éƒ½å¯èƒ½æ˜¯æ—§å€¼ï¼Œè€Œéæ•°æ®åº“çš„æœ€æ–°å€¼ã€‚è¿™ä¸æ˜¯æœ‰æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ï¼Ÿ\n\né‚£ä¹ˆï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•æ›´æ–°ç¼“å­˜å‘¢ï¼Ÿ\n\nç›®å‰æœ‰ä»¥ä¸‹ 4 ç§æ–¹æ¡ˆï¼š\n\n1. å…ˆå†™ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“\n2. å…ˆå†™æ•°æ®åº“ï¼Œå†å†™ç¼“å­˜\n3. å…ˆåˆ ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“\n4. å…ˆå†™æ•°æ®åº“ï¼Œå†åˆ ç¼“å­˜\n\næ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¯¦ç»†è¯´è¯´è¿™ 4 ç§æ–¹æ¡ˆã€‚\n\n### å…ˆå†™ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“\n\nå¯¹äºæ›´æ–°ç¼“å­˜çš„æ–¹æ¡ˆï¼Œå¾ˆå¤šäººç¬¬ä¸€ä¸ªæƒ³åˆ°çš„å¯èƒ½æ˜¯åœ¨å†™æ“ä½œä¸­ç›´æ¥æ›´æ–°ç¼“å­˜ï¼ˆå†™ç¼“å­˜ï¼‰ï¼Œæ›´ç›´æ¥æ˜äº†ã€‚\n\né‚£ä¹ˆï¼Œé—®é¢˜æ¥äº†ï¼šåœ¨å†™æ“ä½œä¸­ï¼Œåˆ°åº•æ˜¯å…ˆå†™ç¼“å­˜ï¼Œè¿˜æ˜¯å…ˆå†™æ•°æ®åº“å‘¢ï¼Ÿ\n\næˆ‘ä»¬åœ¨è¿™é‡Œå…ˆèŠèŠå…ˆå†™ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“çš„æƒ…å†µï¼Œå› ä¸ºå®ƒçš„é—®é¢˜æœ€ä¸¥é‡ã€‚\n\n![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650526427819.png)\n\næŸä¸€ä¸ªç”¨æˆ·çš„æ¯ä¸€æ¬¡å†™æ“ä½œï¼Œå¦‚æœåˆšå†™å®Œç¼“å­˜ï¼Œçªç„¶ç½‘ç»œå‡ºç°äº†å¼‚å¸¸ï¼Œå¯¼è‡´å†™æ•°æ®åº“å¤±è´¥äº†ã€‚\n\n![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650526436447.png)\n\nå…¶ç»“æœæ˜¯ç¼“å­˜æ›´æ–°æˆäº†æœ€æ–°æ•°æ®ï¼Œä½†æ•°æ®åº“æ²¡æœ‰ï¼Œè¿™æ ·ç¼“å­˜ä¸­çš„æ•°æ®ä¸å°±å˜æˆè„æ•°æ®äº†ï¼Ÿå¦‚æœæ­¤æ—¶è¯¥ç”¨æˆ·çš„æŸ¥è¯¢è¯·æ±‚ï¼Œæ­£å¥½è¯»å–åˆ°è¯¥æ•°æ®ï¼Œå°±ä¼šå‡ºç°é—®é¢˜ï¼Œå› ä¸ºè¯¥æ•°æ®åœ¨æ•°æ®åº“ä¸­æ ¹æœ¬ä¸å­˜åœ¨ï¼Œè¿™ä¸ªé—®é¢˜éå¸¸ä¸¥é‡ã€‚\n\næˆ‘ä»¬éƒ½çŸ¥é“ï¼Œç¼“å­˜çš„ä¸»è¦ç›®çš„æ˜¯æŠŠæ•°æ®åº“çš„æ•°æ®ä¸´æ—¶ä¿å­˜åœ¨å†…å­˜ï¼Œä¾¿äºåç»­çš„æŸ¥è¯¢ï¼Œæå‡æŸ¥è¯¢é€Ÿåº¦ã€‚\n\nä½†å¦‚æœæŸæ¡æ•°æ®ï¼Œåœ¨æ•°æ®åº“ä¸­éƒ½ä¸å­˜åœ¨ï¼Œä½ ç¼“å­˜è¿™ç§â€œ`å‡æ•°æ®`â€åˆæœ‰å•¥æ„ä¹‰å‘¢ï¼Ÿ\n\nå› æ­¤ï¼Œå…ˆå†™ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“çš„æ–¹æ¡ˆæ˜¯ä¸å¯å–çš„ï¼Œåœ¨å®é™…å·¥ä½œä¸­ç”¨å¾—ä¸å¤šã€‚\n\n### å…ˆå†™æ•°æ®åº“ï¼Œå†å†™ç¼“å­˜\n\n![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650526499487.png)\n\nç”¨æˆ·çš„å†™æ“ä½œï¼Œå…ˆå†™æ•°æ®åº“ï¼Œå†å†™ç¼“å­˜ï¼Œå¯ä»¥é¿å…ä¹‹å‰â€œå‡æ•°æ®â€çš„é—®é¢˜ã€‚ä½†å®ƒå´å¸¦æ¥äº†æ–°çš„é—®é¢˜ã€‚\n\n#### å†™ç¼“å­˜å¤±è´¥äº†\n\nå¦‚æœæŠŠå†™æ•°æ®åº“å’Œå†™ç¼“å­˜æ“ä½œï¼Œæ”¾åœ¨åŒä¸€ä¸ªäº‹åŠ¡å½“ä¸­ï¼Œå½“å†™ç¼“å­˜å¤±è´¥äº†ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå†™å…¥æ•°æ®åº“çš„æ•°æ®è¿›è¡Œå›æ»šã€‚\n\n![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650526558901.png)\n\nå¦‚æœæ˜¯å¹¶å‘é‡æ¯”è¾ƒå°ï¼Œå¯¹æ¥å£æ€§èƒ½è¦æ±‚ä¸å¤ªé«˜çš„ç³»ç»Ÿï¼Œå¯ä»¥è¿™ä¹ˆç©ã€‚\n\nä½†å¦‚æœåœ¨é«˜å¹¶å‘çš„ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œå†™æ•°æ®åº“å’Œå†™ç¼“å­˜ï¼Œéƒ½å±äºè¿œç¨‹æ“ä½œã€‚ä¸ºäº†é˜²æ­¢å‡ºç°å¤§äº‹åŠ¡ï¼Œé€ æˆçš„æ­»é”é—®é¢˜ï¼Œé€šå¸¸å»ºè®®å†™æ•°æ®åº“å’Œå†™ç¼“å­˜ä¸è¦æ”¾åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ã€‚\n\nä¹Ÿå°±æ˜¯è¯´åœ¨è¯¥æ–¹æ¡ˆä¸­ï¼Œå¦‚æœå†™æ•°æ®åº“æˆåŠŸäº†ï¼Œä½†å†™ç¼“å­˜å¤±è´¥äº†ï¼Œæ•°æ®åº“ä¸­å·²å†™å…¥çš„æ•°æ®ä¸ä¼šå›æ»šã€‚\n\nè¿™å°±ä¼šå‡ºç°ï¼šæ•°æ®åº“æ˜¯`æ–°æ•°æ®`ï¼Œè€Œç¼“å­˜æ˜¯`æ—§æ•°æ®`ï¼Œä¸¤è¾¹`æ•°æ®ä¸ä¸€è‡´`çš„æƒ…å†µã€‚\n\n#### é«˜å¹¶å‘ä¸‹çš„é—®é¢˜\n\nå‡è®¾åœ¨é«˜å¹¶å‘çš„åœºæ™¯ä¸­ï¼Œé’ˆå¯¹åŒä¸€ä¸ªç”¨æˆ·çš„åŒä¸€æ¡æ•°æ®ï¼Œæœ‰ä¸¤ä¸ªå†™æ•°æ®è¯·æ±‚ï¼ša å’Œ bï¼Œå®ƒä»¬åŒæ—¶è¯·æ±‚åˆ°ä¸šåŠ¡ç³»ç»Ÿã€‚\n\nå…¶ä¸­è¯·æ±‚ a è·å–çš„æ˜¯æ—§æ•°æ®ï¼Œè€Œè¯·æ±‚ b è·å–çš„æ˜¯æ–°æ•°æ®ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n\n![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650526645914.png)\n\n1. è¯·æ±‚ a å…ˆè¿‡æ¥ï¼Œåˆšå†™å®Œäº†æ•°æ®åº“ã€‚ä½†ç”±äºç½‘ç»œåŸå› ï¼Œå¡é¡¿äº†ä¸€ä¸‹ï¼Œè¿˜æ²¡æ¥å¾—åŠå†™ç¼“å­˜ã€‚\n2. è¿™æ—¶å€™è¯·æ±‚ b è¿‡æ¥äº†ï¼Œå…ˆå†™äº†æ•°æ®åº“ã€‚\n3. æ¥ä¸‹æ¥ï¼Œè¯·æ±‚ b é¡ºåˆ©å†™äº†ç¼“å­˜ã€‚\n4. æ­¤æ—¶ï¼Œè¯·æ±‚ a å¡é¡¿ç»“æŸï¼Œä¹Ÿå†™äº†ç¼“å­˜ã€‚\n\nå¾ˆæ˜¾ç„¶ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹å½“ä¸­ï¼Œè¯·æ±‚ b åœ¨ç¼“å­˜ä¸­çš„`æ–°æ•°æ®`ï¼Œè¢«è¯·æ±‚ a çš„`æ—§æ•°æ®`è¦†ç›–äº†ã€‚\n\nä¹Ÿå°±æ˜¯è¯´ï¼šåœ¨é«˜å¹¶å‘åœºæ™¯ä¸­ï¼Œå¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶æ‰§è¡Œå…ˆå†™æ•°æ®åº“ï¼Œå†å†™ç¼“å­˜çš„æ“ä½œï¼Œå¯èƒ½ä¼šå‡ºç°æ•°æ®åº“æ˜¯æ–°å€¼ï¼Œè€Œç¼“å­˜ä¸­æ˜¯æ—§å€¼ï¼Œä¸¤è¾¹æ•°æ®ä¸ä¸€è‡´çš„æƒ…å†µã€‚\n\n#### æµªè´¹ç³»ç»Ÿèµ„æº\n\næœ‰äº›ä¸šåŠ¡åœºæ™¯æ¯”è¾ƒç‰¹æ®Šï¼š`å†™å¤šè¯»å°‘`ã€‚\n\nå¦‚æœåœ¨è¿™ç±»ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œæ¯ä¸ªç”¨çš„å†™æ“ä½œï¼Œéƒ½éœ€è¦å†™ä¸€æ¬¡ç¼“å­˜ï¼Œæœ‰ç‚¹å¾—ä¸å¿å¤±ã€‚\n\nè¿˜ä¸å¦‚ä¸ç”¨ Redisï¼Œåæ­£å†™æ•°æ®åº“éƒ½è¦å†™ï¼Œæˆ‘è¯»æ•°æ®åˆæ¯”è¾ƒå°‘ï¼ŒRedis ä½¿ç”¨é¢‘ç‡ä½ï¼Œå´è¿˜è¦ä¸€ç›´æ›´æ–° Redis ä¸­æ•°æ®ã€‚\n\n### å…ˆåˆ ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“\n\nä¸ç„¶æ˜¯å…ˆå†™ç¼“å­˜è¿˜æ˜¯å…ˆå†™æ•°æ®åº“éƒ½æœ‰å¾ˆå¤šé—®é¢˜ï¼Œé‚£ä¹ˆè€ƒè™‘ä¸æ˜¯ `æ›´æ–°ç¼“å­˜` è€Œæ˜¯ `åˆ é™¤ç¼“å­˜`ã€‚\n\n![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650526855730.png)\n\nåœ¨ç”¨æˆ·çš„å†™æ“ä½œä¸­ï¼Œå…ˆæ‰§è¡Œåˆ é™¤ç¼“å­˜æ“ä½œï¼Œå†å»å†™æ•°æ®åº“\n\n#### é«˜å¹¶å‘ä¸‹çš„é—®é¢˜\n\nå‡è®¾åœ¨é«˜å¹¶å‘çš„åœºæ™¯ä¸­ï¼ŒåŒä¸€ä¸ªç”¨æˆ·çš„åŒä¸€æ¡æ•°æ®ï¼Œæœ‰ä¸€ä¸ªè¯»æ•°æ®è¯·æ±‚ cï¼Œè¿˜æœ‰å¦ä¸€ä¸ªå†™æ•°æ®è¯·æ±‚ dï¼ˆä¸€ä¸ªæ›´æ–°æ“ä½œï¼‰ï¼ŒåŒæ—¶è¯·æ±‚åˆ°ä¸šåŠ¡ç³»ç»Ÿã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n\n![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650527043982.png)\n\n1. è¯·æ±‚ d å…ˆè¿‡æ¥ï¼ŒæŠŠç¼“å­˜åˆ é™¤äº†ã€‚ä½†ç”±äºç½‘ç»œåŸå› ï¼Œå¡é¡¿äº†ä¸€ä¸‹ï¼Œè¿˜æ²¡æ¥å¾—åŠå†™æ•°æ®åº“ã€‚\n2. è¿™æ—¶è¯·æ±‚ c è¿‡æ¥äº†ï¼Œå…ˆæŸ¥ç¼“å­˜å‘ç°æ²¡æ•°æ®ï¼Œå†æŸ¥æ•°æ®åº“ï¼Œæœ‰æ•°æ®ï¼Œä½†æ˜¯æ—§å€¼ã€‚\n3. è¯·æ±‚ c å°†æ•°æ®åº“ä¸­çš„æ—§å€¼ï¼Œæ›´æ–°åˆ°ç¼“å­˜ä¸­ã€‚\n4. æ­¤æ—¶ï¼Œè¯·æ±‚ d å¡é¡¿ç»“æŸï¼ŒæŠŠæ–°å€¼å†™å…¥æ•°æ®åº“ã€‚\n\nåœ¨è¿™ä¸ªè¿‡ç¨‹å½“ä¸­ï¼Œè¯·æ±‚ d çš„æ–°å€¼å¹¶æ²¡æœ‰è¢«è¯·æ±‚ c å†™å…¥ç¼“å­˜ï¼ŒåŒæ ·ä¼šå¯¼è‡´ç¼“å­˜å’Œæ•°æ®åº“çš„æ•°æ®ä¸ä¸€è‡´çš„æƒ…å†µã€‚\n\n#### ç¼“å­˜åŒåˆ \n\nåœ¨ä¸Šé¢çš„ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œä¸€ä¸ªè¯»æ•°æ®è¯·æ±‚ï¼Œä¸€ä¸ªå†™æ•°æ®è¯·æ±‚ã€‚å½“å†™æ•°æ®è¯·æ±‚æŠŠç¼“å­˜åˆ äº†ä¹‹åï¼Œè¯»æ•°æ®è¯·æ±‚ï¼Œå¯èƒ½æŠŠå½“æ—¶ä»æ•°æ®åº“æŸ¥è¯¢å‡ºæ¥çš„æ—§å€¼ï¼Œå†™å…¥ç¼“å­˜å½“ä¸­ã€‚\n\næœ‰äººè¯´è¿˜ä¸å¥½åŠï¼Œè¯·æ±‚ d åœ¨å†™å®Œæ•°æ®åº“ä¹‹åï¼ŒæŠŠç¼“å­˜é‡æ–°åˆ ä¸€æ¬¡ä¸å°±è¡Œäº†ï¼Ÿ\n\n![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650528097218.png)\n\nè¿™å°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„`ç¼“å­˜åŒåˆ `ï¼Œå³åœ¨å†™æ•°æ®åº“ä¹‹å‰åˆ é™¤ä¸€æ¬¡ï¼Œå†™å®Œæ•°æ®åº“åï¼Œå†åˆ é™¤ä¸€æ¬¡ã€‚\n\nè¯¥æ–¹æ¡ˆæœ‰ä¸ªéå¸¸å…³é”®çš„åœ°æ–¹æ˜¯ï¼šç¬¬äºŒæ¬¡åˆ é™¤ç¼“å­˜ï¼Œå¹¶éç«‹é©¬å°±åˆ ï¼Œè€Œæ˜¯è¦åœ¨ä¸€å®šçš„`æ—¶é—´é—´éš”`ä¹‹åã€‚\n\næˆ‘ä»¬å†é‡æ–°å›é¡¾ä¸€ä¸‹ï¼Œé«˜å¹¶å‘ä¸‹ä¸€ä¸ªè¯»æ•°æ®è¯·æ±‚ï¼Œä¸€ä¸ªå†™æ•°æ®è¯·æ±‚å¯¼è‡´æ•°æ®ä¸ä¸€è‡´çš„äº§ç”Ÿè¿‡ç¨‹ï¼š\n\n1. è¯·æ±‚ d å…ˆè¿‡æ¥ï¼ŒæŠŠç¼“å­˜åˆ é™¤äº†ã€‚ä½†ç”±äºç½‘ç»œåŸå› ï¼Œå¡é¡¿äº†ä¸€ä¸‹ï¼Œè¿˜æ²¡æ¥å¾—åŠå†™æ•°æ®åº“ã€‚\n2. è¿™æ—¶è¯·æ±‚ c è¿‡æ¥äº†ï¼Œå…ˆæŸ¥ç¼“å­˜å‘ç°æ²¡æ•°æ®ï¼Œå†æŸ¥æ•°æ®åº“ï¼Œæœ‰æ•°æ®ï¼Œä½†æ˜¯æ—§å€¼ã€‚\n3. è¯·æ±‚ c å°†æ•°æ®åº“ä¸­çš„æ—§å€¼ï¼Œæ›´æ–°åˆ°ç¼“å­˜ä¸­ã€‚\n4. æ­¤æ—¶ï¼Œè¯·æ±‚ d å¡é¡¿ç»“æŸï¼ŒæŠŠæ–°å€¼å†™å…¥æ•°æ®åº“ã€‚\n5. ä¸€æ®µæ—¶é—´ä¹‹åï¼Œæ¯”å¦‚ï¼š500msï¼Œè¯·æ±‚ d å°†ç¼“å­˜åˆ é™¤ã€‚\n\nè¿™æ ·æ¥çœ‹ç¡®å®å¯ä»¥è§£å†³ç¼“å­˜ä¸ä¸€è‡´é—®é¢˜ã€‚\n\né‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆä¸€å®šè¦é—´éš”ä¸€æ®µæ—¶é—´ä¹‹åï¼Œæ‰èƒ½åˆ é™¤ç¼“å­˜å‘¢ï¼Ÿ\n\nè¯·æ±‚ d å¡é¡¿ç»“æŸï¼ŒæŠŠæ–°å€¼å†™å…¥æ•°æ®åº“åï¼Œè¯·æ±‚ c å°†æ•°æ®åº“ä¸­çš„æ—§å€¼ï¼Œæ›´æ–°åˆ°ç¼“å­˜ä¸­ã€‚\n\næ­¤æ—¶ï¼Œå¦‚æœè¯·æ±‚ d åˆ é™¤å¤ªå¿«ï¼Œåœ¨è¯·æ±‚ c å°†æ•°æ®åº“ä¸­çš„æ—§å€¼æ›´æ–°åˆ°ç¼“å­˜ä¹‹å‰ï¼Œå°±å·²ç»æŠŠç¼“å­˜åˆ é™¤äº†ï¼Œè¿™æ¬¡åˆ é™¤å°±æ²¡ä»»ä½•æ„ä¹‰ã€‚å¿…é¡»è¦åœ¨è¯·æ±‚ c æ›´æ–°ç¼“å­˜ä¹‹åï¼Œå†åˆ é™¤ç¼“å­˜ï¼Œæ‰èƒ½æŠŠæ—§å€¼åŠæ—¶åˆ é™¤äº†ã€‚\n\næ‰€ä»¥éœ€è¦åœ¨è¯·æ±‚ d ä¸­åŠ ä¸€ä¸ªæ—¶é—´é—´éš”ï¼Œç¡®ä¿è¯·æ±‚ cï¼Œæˆ–è€…ç±»ä¼¼äºè¯·æ±‚ c çš„å…¶ä»–è¯·æ±‚ï¼Œå¦‚æœåœ¨ç¼“å­˜ä¸­è®¾ç½®äº†æ—§å€¼ï¼Œæœ€ç»ˆéƒ½èƒ½å¤Ÿè¢«è¯·æ±‚ d åˆ é™¤æ‰ã€‚\n\næ¥ä¸‹æ¥ï¼Œè¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœç¬¬äºŒæ¬¡åˆ é™¤ç¼“å­˜æ—¶ï¼Œåˆ é™¤å¤±è´¥äº†è¯¥æ€ä¹ˆåŠï¼Ÿ\n\n### å…ˆå†™æ•°æ®åº“ï¼Œå†åˆ ç¼“å­˜\n\n![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650528137396.png)\n\nåœ¨é«˜å¹¶å‘çš„åœºæ™¯ä¸­ï¼Œæœ‰ä¸€ä¸ªè¯»æ•°æ®è¯·æ±‚ï¼Œæœ‰ä¸€ä¸ªå†™æ•°æ®è¯·æ±‚ï¼Œæ›´æ–°è¿‡ç¨‹å¦‚ä¸‹ï¼š\n\n1. è¯·æ±‚ e å…ˆå†™æ•°æ®åº“ï¼Œç”±äºç½‘ç»œåŸå› å¡é¡¿äº†ä¸€ä¸‹ï¼Œæ²¡æœ‰æ¥å¾—åŠåˆ é™¤ç¼“å­˜ã€‚\n2. è¯·æ±‚ f æŸ¥è¯¢ç¼“å­˜ï¼Œå‘ç°ç¼“å­˜ä¸­æœ‰æ•°æ®ï¼Œç›´æ¥è¿”å›è¯¥æ•°æ®ã€‚\n3. è¯·æ±‚ e åˆ é™¤ç¼“å­˜ã€‚\n\nåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œåªæœ‰è¯·æ±‚ f è¯»äº†ä¸€æ¬¡æ—§æ•°æ®ï¼Œåæ¥æ—§æ•°æ®è¢«è¯·æ±‚ e åŠæ—¶åˆ é™¤äº†ï¼Œçœ‹èµ·æ¥é—®é¢˜ä¸å¤§ã€‚\n\nä½†å¦‚æœæ˜¯è¯»æ•°æ®è¯·æ±‚å…ˆè¿‡æ¥å‘¢ï¼Ÿ\n\n1. è¯·æ±‚ f æŸ¥è¯¢ç¼“å­˜ï¼Œå‘ç°ç¼“å­˜ä¸­æœ‰æ•°æ®ï¼Œç›´æ¥è¿”å›è¯¥æ•°æ®ã€‚\n2. è¯·æ±‚ e å…ˆå†™æ•°æ®åº“ã€‚\n3. è¯·æ±‚ e åˆ é™¤ç¼“å­˜ã€‚\n\nè¿™ç§æƒ…å†µçœ‹èµ·æ¥ä¹Ÿæ²¡é—®é¢˜å‘€ï¼Ÿ\n\nç­”ï¼šå¯¹çš„ã€‚\n\nä½†å°±æ€•å‡ºç°ä¸‹é¢è¿™ç§æƒ…å†µï¼Œå³ç¼“å­˜è‡ªå·±å¤±æ•ˆäº†ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n\n![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650528267733.png)\n\n1. ç¼“å­˜è¿‡æœŸæ—¶é—´åˆ°äº†ï¼Œè‡ªåŠ¨å¤±æ•ˆã€‚\n2. è¯·æ±‚ f æŸ¥è¯¢ç¼“å­˜ï¼Œå‘ç¼“å­˜ä¸­æ²¡æœ‰æ•°æ®ï¼ŒæŸ¥è¯¢æ•°æ®åº“çš„æ—§å€¼ï¼Œä½†ç”±äºç½‘ç»œåŸå› å¡é¡¿äº†ï¼Œæ²¡æœ‰æ¥å¾—åŠæ›´æ–°ç¼“å­˜ã€‚\n3. è¯·æ±‚ e å…ˆå†™æ•°æ®åº“ï¼Œæ¥ç€åˆ é™¤äº†ç¼“å­˜ã€‚\n4. è¯·æ±‚ f æ›´æ–°æ—§å€¼åˆ°ç¼“å­˜ä¸­ã€‚\n\nè¿™æ—¶ï¼Œç¼“å­˜å’Œæ•°æ®åº“çš„æ•°æ®åŒæ ·å‡ºç°ä¸ä¸€è‡´çš„æƒ…å†µäº†ã€‚\n\nä½†è¿™ç§æƒ…å†µè¿˜æ˜¯æ¯”è¾ƒå°‘çš„ï¼Œéœ€è¦åŒæ—¶æ»¡è¶³ä»¥ä¸‹æ¡ä»¶æ‰å¯ä»¥ï¼š\n\n1. ç¼“å­˜åˆšå¥½è‡ªåŠ¨å¤±æ•ˆã€‚\n2. è¯·æ±‚ f ä»æ•°æ®åº“æŸ¥å‡ºæ—§å€¼ï¼Œæ›´æ–°ç¼“å­˜çš„è€—æ—¶ï¼Œæ¯”è¯·æ±‚ e å†™æ•°æ®åº“ï¼Œå¹¶ä¸”åˆ é™¤ç¼“å­˜çš„è¿˜é•¿ã€‚\n\næˆ‘ä»¬éƒ½çŸ¥é“æŸ¥è¯¢æ•°æ®åº“çš„é€Ÿåº¦ï¼Œä¸€èˆ¬æ¯”å†™æ•°æ®åº“è¦å¿«ï¼Œæ›´ä½•å†µå†™å®Œæ•°æ®åº“ï¼Œè¿˜è¦åˆ é™¤ç¼“å­˜ã€‚æ‰€ä»¥ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå†™æ•°æ®è¯·æ±‚æ¯”è¯»æ•°æ®æƒ…å†µè€—æ—¶æ›´é•¿ã€‚\n\nç”±æ­¤å¯è§ï¼Œç³»ç»ŸåŒæ—¶æ»¡è¶³ä¸Šè¿°ä¸¤ä¸ªæ¡ä»¶çš„æ¦‚ç‡éå¸¸å°ã€‚\n\n> æ¨èå¤§å®¶ä½¿ç”¨å…ˆå†™æ•°æ®åº“ï¼Œå†åˆ ç¼“å­˜çš„æ–¹æ¡ˆï¼Œè™½è¯´ä¸èƒ½100%é¿å…æ•°æ®ä¸ä¸€è‡´é—®é¢˜ï¼Œä½†å‡ºç°è¯¥é—®é¢˜çš„æ¦‚ç‡ï¼Œç›¸å¯¹äºå…¶ä»–æ–¹æ¡ˆæ¥è¯´æ˜¯æœ€å°çš„ã€‚\n\nä½†åœ¨è¯¥æ–¹æ¡ˆä¸­ï¼Œå¦‚æœåˆ é™¤ç¼“å­˜å¤±è´¥äº†è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ\n\n### åˆ ç¼“å­˜å¤±è´¥æ€ä¹ˆåŠï¼Ÿ\n\nå…¶å®å…ˆå†™æ•°æ®åº“ï¼Œå†åˆ ç¼“å­˜çš„æ–¹æ¡ˆï¼Œè·Ÿç¼“å­˜åŒåˆ çš„æ–¹æ¡ˆä¸€æ ·ï¼Œæœ‰ä¸€ä¸ªå…±åŒçš„é£é™©ç‚¹ï¼Œå³ï¼šå¦‚æœç¼“å­˜åˆ é™¤å¤±è´¥äº†ï¼Œä¹Ÿä¼šå¯¼è‡´ç¼“å­˜å’Œæ•°æ®åº“çš„æ•°æ®ä¸ä¸€è‡´ã€‚\n\né‚£ä¹ˆï¼Œåˆ é™¤ç¼“å­˜å¤±è´¥æ€ä¹ˆåŠå‘¢ï¼Ÿ\n\nç­”ï¼šéœ€è¦åŠ `é‡è¯•æœºåˆ¶`ã€‚\n\nåœ¨æ¥å£ä¸­å¦‚æœæ›´æ–°äº†æ•°æ®åº“æˆåŠŸäº†ï¼Œä½†æ›´æ–°ç¼“å­˜å¤±è´¥äº†ï¼Œå¯ä»¥ç«‹åˆ»é‡è¯• 3 æ¬¡ã€‚å¦‚æœå…¶ä¸­æœ‰ä»»ä½•ä¸€æ¬¡æˆåŠŸï¼Œåˆ™ç›´æ¥è¿”å›æˆåŠŸã€‚å¦‚æœ 3 æ¬¡éƒ½å¤±è´¥äº†ï¼Œåˆ™å†™å…¥æ•°æ®åº“ï¼Œå‡†å¤‡åç»­å†å¤„ç†ã€‚\n\nå½“ç„¶ï¼Œå¦‚æœä½ åœ¨æ¥å£ä¸­ç›´æ¥`åŒæ­¥é‡è¯•`ï¼Œè¯¥æ¥å£å¹¶å‘é‡æ¯”è¾ƒé«˜çš„æ—¶å€™ï¼Œå¯èƒ½æœ‰ç‚¹å½±å“æ¥å£æ€§èƒ½ã€‚\n\nè¿™æ—¶ï¼Œå°±éœ€è¦æ”¹æˆ`å¼‚æ­¥é‡è¯•`äº†ã€‚\n\nå¼‚æ­¥é‡è¯•æ–¹å¼æœ‰å¾ˆå¤šç§ï¼Œæ¯”å¦‚ï¼š\n\n1. æ¯æ¬¡éƒ½å•ç‹¬èµ·ä¸€ä¸ªçº¿ç¨‹ï¼Œè¯¥çº¿ç¨‹ä¸“é—¨åšé‡è¯•çš„å·¥ä½œã€‚ä½†å¦‚æœåœ¨é«˜å¹¶å‘çš„åœºæ™¯ä¸‹ï¼Œå¯èƒ½ä¼šåˆ›å»ºå¤ªå¤šçš„çº¿ç¨‹ï¼Œå¯¼è‡´ç³»ç»Ÿ OOM é—®é¢˜ï¼Œä¸å¤ªå»ºè®®ä½¿ç”¨ã€‚\n2. å°†é‡è¯•çš„ä»»åŠ¡äº¤ç»™çº¿ç¨‹æ± å¤„ç†ï¼Œä½†å¦‚æœæœåŠ¡å™¨é‡å¯ï¼Œéƒ¨åˆ†æ•°æ®å¯èƒ½ä¼šä¸¢å¤±ã€‚\n3. å°†é‡è¯•æ•°æ®å†™è¡¨ï¼Œç„¶åä½¿ç”¨ elastic-job ç­‰å®šæ—¶ä»»åŠ¡è¿›è¡Œé‡è¯•ã€‚\n4. å°†é‡è¯•çš„è¯·æ±‚å†™å…¥ mq ç­‰æ¶ˆæ¯ä¸­é—´ä»¶ä¸­ï¼Œåœ¨ mq çš„ consumer ä¸­å¤„ç†ã€‚\n5. è®¢é˜… mysql çš„ binlogï¼Œåœ¨è®¢é˜…è€…ä¸­ï¼Œå¦‚æœå‘ç°äº†æ›´æ–°æ•°æ®è¯·æ±‚ï¼Œåˆ™åˆ é™¤ç›¸åº”çš„ç¼“å­˜ã€‚\n\n#### å®šæ—¶ä»»åŠ¡\n\nä½¿ç”¨`å®šæ—¶ä»»åŠ¡é‡è¯•`çš„å…·ä½“æ–¹æ¡ˆå¦‚ä¸‹ï¼š\n\n1. å½“ç”¨æˆ·æ“ä½œå†™å®Œæ•°æ®åº“ï¼Œä½†åˆ é™¤ç¼“å­˜å¤±è´¥äº†ï¼Œéœ€è¦å°†ç”¨æˆ·æ•°æ®å†™å…¥é‡è¯•è¡¨ä¸­ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n\n\t![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650528474531.png)\n\n2. åœ¨å®šæ—¶ä»»åŠ¡ä¸­ï¼Œå¼‚æ­¥è¯»å–é‡è¯•è¡¨ä¸­çš„ç”¨æˆ·æ•°æ®ã€‚é‡è¯•è¡¨éœ€è¦è®°å½•ä¸€ä¸ªé‡è¯•æ¬¡æ•°å­—æ®µï¼Œåˆå§‹å€¼ä¸º 0ã€‚ç„¶åé‡è¯• 5 æ¬¡ï¼Œä¸æ–­åˆ é™¤ç¼“å­˜ï¼Œæ¯é‡è¯•ä¸€æ¬¡è¯¥å­—æ®µå€¼+1ã€‚å¦‚æœå…¶ä¸­æœ‰ä»»æ„ä¸€æ¬¡æˆåŠŸäº†ï¼Œåˆ™è¿”å›æˆåŠŸã€‚å¦‚æœé‡è¯•äº† 5 æ¬¡ï¼Œè¿˜æ˜¯å¤±è´¥ï¼Œåˆ™æˆ‘ä»¬éœ€è¦åœ¨é‡è¯•è¡¨ä¸­è®°å½•ä¸€ä¸ªå¤±è´¥çš„çŠ¶æ€ï¼Œç­‰å¾…åç»­è¿›ä¸€æ­¥å¤„ç†ã€‚\n\n\t![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650528480542.png)\n\n3. åœ¨é«˜å¹¶å‘åœºæ™¯ä¸­ï¼Œå®šæ—¶ä»»åŠ¡æ¨èä½¿ç”¨`elastic-job`ã€‚ç›¸å¯¹äº xxl-job ç­‰å®šæ—¶ä»»åŠ¡ï¼Œå®ƒå¯ä»¥åˆ†ç‰‡å¤„ç†ï¼Œæå‡å¤„ç†é€Ÿåº¦ã€‚åŒæ—¶æ¯ç‰‡çš„é—´éš”å¯ä»¥è®¾ç½®æˆï¼š1,2,3,5,7 ç§’ç­‰ã€‚\n\nä½¿ç”¨å®šæ—¶ä»»åŠ¡é‡è¯•çš„è¯ï¼Œæœ‰ä¸ªç¼ºç‚¹å°±æ˜¯å®æ—¶æ€§æ²¡é‚£ä¹ˆé«˜ï¼Œå¯¹äºå®æ—¶æ€§è¦æ±‚ç‰¹åˆ«é«˜çš„ä¸šåŠ¡åœºæ™¯ï¼Œè¯¥æ–¹æ¡ˆä¸å¤ªé€‚ç”¨ã€‚ä½†æ˜¯å¯¹äºä¸€èˆ¬åœºæ™¯ï¼Œè¿˜æ˜¯å¯ä»¥ç”¨ä¸€ç”¨çš„ã€‚\n\nä½†å®ƒæœ‰ä¸€ä¸ªå¾ˆå¤§çš„ä¼˜ç‚¹ï¼Œå³æ•°æ®æ˜¯è½åº“çš„ï¼Œä¸ä¼šä¸¢æ•°æ®ã€‚\n\n#### mq\n\nåœ¨é«˜å¹¶å‘çš„ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œmqï¼ˆæ¶ˆæ¯é˜Ÿåˆ—ï¼‰æ˜¯å¿…ä¸å¯å°‘çš„æŠ€æœ¯ä¹‹ä¸€ã€‚å®ƒä¸ä»…å¯ä»¥å¼‚æ­¥è§£è€¦ï¼Œè¿˜èƒ½å‰Šå³°å¡«è°·ã€‚å¯¹ä¿è¯ç³»ç»Ÿçš„ç¨³å®šæ€§æ˜¯éå¸¸æœ‰æ„ä¹‰çš„ã€‚\n\nmq çš„ç”Ÿäº§è€…ï¼Œç”Ÿäº§äº†æ¶ˆæ¯ä¹‹åï¼Œé€šè¿‡æŒ‡å®šçš„ topic å‘é€åˆ° mq æœåŠ¡å™¨ã€‚ç„¶å mq çš„æ¶ˆè´¹è€…ï¼Œè®¢é˜…è¯¥ topic çš„æ¶ˆæ¯ï¼Œè¯»å–æ¶ˆæ¯æ•°æ®ä¹‹åï¼Œåšä¸šåŠ¡é€»è¾‘å¤„ç†ã€‚\n\nä½¿ç”¨`mqé‡è¯•`çš„å…·ä½“æ–¹æ¡ˆå¦‚ä¸‹ï¼š\n\n![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650528506474.png)\n\n1. å½“ç”¨æˆ·æ“ä½œå†™å®Œæ•°æ®åº“ï¼Œä½†åˆ é™¤ç¼“å­˜å¤±è´¥äº†ï¼Œäº§ç”Ÿä¸€æ¡ mq æ¶ˆæ¯ï¼Œå‘é€ç»™ mq æœåŠ¡å™¨ã€‚\n2. mq æ¶ˆè´¹è€…è¯»å– mq æ¶ˆæ¯ï¼Œé‡è¯• 5 æ¬¡åˆ é™¤ç¼“å­˜ã€‚å¦‚æœå…¶ä¸­æœ‰ä»»æ„ä¸€æ¬¡æˆåŠŸäº†ï¼Œåˆ™è¿”å›æˆåŠŸã€‚å¦‚æœé‡è¯•äº† 5 æ¬¡ï¼Œè¿˜æ˜¯å¤±è´¥ï¼Œåˆ™å†™å…¥`æ­»ä¿¡é˜Ÿåˆ—`ä¸­ã€‚\n3. æ¨è mq ä½¿ç”¨`rocketmq`ï¼Œé‡è¯•æœºåˆ¶å’Œæ­»ä¿¡é˜Ÿåˆ—é»˜è®¤æ˜¯æ”¯æŒçš„ã€‚ä½¿ç”¨èµ·æ¥éå¸¸æ–¹ä¾¿ï¼Œè€Œä¸”è¿˜æ”¯æŒé¡ºåºæ¶ˆæ¯ï¼Œå»¶è¿Ÿæ¶ˆæ¯å’Œäº‹åŠ¡æ¶ˆæ¯ç­‰å¤šç§ä¸šåŠ¡åœºæ™¯ã€‚\n\nå½“ç„¶åœ¨è¯¥æ–¹æ¡ˆä¸­ï¼Œåˆ é™¤ç¼“å­˜å¯ä»¥å®Œå…¨èµ°å¼‚æ­¥ã€‚å³ç”¨æˆ·çš„å†™æ“ä½œï¼Œåœ¨å†™å®Œæ•°æ®åº“ä¹‹åï¼Œä¸ç”¨ç«‹åˆ»åˆ é™¤ä¸€æ¬¡ç¼“å­˜ã€‚è€Œç›´æ¥å‘é€ mq æ¶ˆæ¯ï¼Œåˆ° mq æœåŠ¡å™¨ï¼Œç„¶åæœ‰ mq æ¶ˆè´¹è€…å…¨æƒè´Ÿè´£åˆ é™¤ç¼“å­˜çš„ä»»åŠ¡ã€‚\n\nå› ä¸º mq çš„å®æ—¶æ€§è¿˜æ˜¯æ¯”è¾ƒé«˜çš„ï¼Œå› æ­¤æ”¹è‰¯åçš„æ–¹æ¡ˆä¹Ÿæ˜¯ä¸€ç§ä¸é”™çš„é€‰æ‹©ã€‚\n\n#### binlog\n\nå‰é¢æˆ‘ä»¬èŠè¿‡çš„ï¼Œæ— è®ºæ˜¯å®šæ—¶ä»»åŠ¡ï¼Œè¿˜æ˜¯ mqï¼ˆæ¶ˆæ¯é˜Ÿåˆ—ï¼‰ï¼Œåšé‡è¯•æœºåˆ¶ï¼Œå¯¹ä¸šåŠ¡éƒ½æœ‰ä¸€å®šçš„ä¾µå…¥æ€§ã€‚\n\nåœ¨ä½¿ç”¨å®šæ—¶ä»»åŠ¡çš„æ–¹æ¡ˆä¸­ï¼Œéœ€è¦åœ¨ä¸šåŠ¡ä»£ç ä¸­å¢åŠ é¢å¤–é€»è¾‘ï¼Œå¦‚æœåˆ é™¤ç¼“å­˜å¤±è´¥ï¼Œéœ€è¦å°†æ•°æ®å†™å…¥é‡è¯•è¡¨ã€‚\n\nè€Œä½¿ç”¨ mq çš„æ–¹æ¡ˆä¸­ï¼Œå¦‚æœåˆ é™¤ç¼“å­˜å¤±è´¥äº†ï¼Œéœ€è¦åœ¨ä¸šåŠ¡ä»£ç ä¸­å‘é€ mq æ¶ˆæ¯åˆ° mq æœåŠ¡å™¨ã€‚\n\nå…¶å®ï¼Œè¿˜æœ‰ä¸€ç§æ›´ä¼˜é›…çš„å®ç°ï¼Œå³`ç›‘å¬binlog`ï¼Œæ¯”å¦‚ä½¿ç”¨ï¼š`canal`ç­‰ä¸­é—´ä»¶ã€‚\n\nå…·ä½“æ–¹æ¡ˆå¦‚ä¸‹ï¼š\n\n![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650528533430.png)\n\n1. åœ¨ä¸šåŠ¡æ¥å£ä¸­å†™æ•°æ®åº“ä¹‹åï¼Œå°±ä¸ç®¡äº†ï¼Œç›´æ¥è¿”å›æˆåŠŸã€‚\n2. mysql æœåŠ¡å™¨ä¼šè‡ªåŠ¨æŠŠå˜æ›´çš„æ•°æ®å†™å…¥ binlog ä¸­ã€‚\n3. binlog è®¢é˜…è€…è·å–å˜æ›´çš„æ•°æ®ï¼Œç„¶ååˆ é™¤ç¼“å­˜ã€‚\n\nè¿™å¥—æ–¹æ¡ˆä¸­ä¸šåŠ¡æ¥å£ç¡®å®ç®€åŒ–äº†ä¸€äº›æµç¨‹ï¼Œåªç”¨å…³å¿ƒæ•°æ®åº“æ“ä½œå³å¯ï¼Œè€Œåœ¨ binlog è®¢é˜…è€…ä¸­åšç¼“å­˜åˆ é™¤å·¥ä½œã€‚\n\nä½†å¦‚æœåªæ˜¯æŒ‰ç…§å›¾ä¸­çš„æ–¹æ¡ˆè¿›è¡Œåˆ é™¤ç¼“å­˜ï¼Œåªåˆ é™¤äº†ä¸€æ¬¡ï¼Œä¹Ÿå¯èƒ½ä¼šå¤±è´¥ã€‚\n\nå¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ\n\nç­”ï¼šè¿™å°±éœ€è¦åŠ ä¸Šå‰é¢èŠè¿‡çš„`é‡è¯•æœºåˆ¶`äº†ã€‚å¦‚æœåˆ é™¤ç¼“å­˜å¤±è´¥ï¼Œå†™å…¥é‡è¯•è¡¨ï¼Œä½¿ç”¨å®šæ—¶ä»»åŠ¡é‡è¯•ã€‚æˆ–è€…å†™å…¥ mqï¼Œè®© mq è‡ªåŠ¨é‡è¯•ã€‚\n\nåœ¨è¿™é‡Œæ¨èä½¿ç”¨`mqè‡ªåŠ¨é‡è¯•æœºåˆ¶`ã€‚\n\n![å›¾ç‰‡](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650528538202.png)\n\nåœ¨ binlog è®¢é˜…è€…ä¸­å¦‚æœåˆ é™¤ç¼“å­˜å¤±è´¥ï¼Œåˆ™å‘é€ä¸€æ¡ mq æ¶ˆæ¯åˆ° mq æœåŠ¡å™¨ï¼Œåœ¨ mq æ¶ˆè´¹è€…ä¸­è‡ªåŠ¨é‡è¯• 5 æ¬¡ã€‚å¦‚æœæœ‰ä»»æ„ä¸€æ¬¡æˆåŠŸï¼Œåˆ™ç›´æ¥è¿”å›æˆåŠŸã€‚å¦‚æœé‡è¯• 5 æ¬¡åè¿˜æ˜¯å¤±è´¥ï¼Œåˆ™è¯¥æ¶ˆæ¯è‡ªåŠ¨è¢«æ”¾å…¥æ­»ä¿¡é˜Ÿåˆ—ï¼Œåé¢å¯èƒ½éœ€è¦äººå·¥ä»‹å…¥ã€‚\n\n***\n\n## Redis çº¿ç¨‹æ¨¡å‹\n\n### å•çº¿ç¨‹çš„Redisä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«\n\n1. çº¯å†…å­˜æ“ä½œ\n\n2. å•çº¿ç¨‹æ“ä½œï¼Œé¿å…äº†é¢‘ç¹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢\n\n3. é‡‡ç”¨äº†éé˜»å¡ I/O å¤šè·¯å¤ç”¨æœºåˆ¶\n\n### Redis ä¸ºä»€ä¹ˆæ˜¯å•çº¿ç¨‹çš„\n\nå®˜æ–¹ FAQ è¡¨ç¤ºï¼Œå› ä¸º Redis æ˜¯åŸºäºå†…å­˜çš„æ“ä½œï¼ŒCPU ä¸æ˜¯ Redis çš„ç“¶é¢ˆï¼ŒRedis çš„ç“¶é¢ˆæœ€æœ‰å¯èƒ½æ˜¯æœºå™¨å†…å­˜çš„å¤§å°æˆ–è€…ç½‘ç»œå¸¦å®½ã€‚\n\næ—¢ç„¶å•çº¿ç¨‹å®¹æ˜“å®ç°ï¼Œè€Œä¸” CPU ä¸ä¼šæˆä¸ºç“¶é¢ˆï¼Œé‚£å°±é¡ºç†æˆç« åœ°é‡‡ç”¨å•çº¿ç¨‹çš„æ–¹æ¡ˆäº†ï¼ˆæ¯•ç«Ÿé‡‡ç”¨å¤šçº¿ç¨‹ä¼šæœ‰å¾ˆå¤šéº»çƒ¦ï¼‰ã€‚Redis åˆ©ç”¨é˜Ÿåˆ—å°†å¹¶å‘è®¿é—®å˜ä¸ºä¸²è¡Œè®¿é—®\n\n1ã€ç»å¤§éƒ¨åˆ†è¯·æ±‚æ˜¯çº¯ç²¹çš„å†…å­˜æ“ä½œï¼ˆéå¸¸å¿«é€Ÿï¼‰\n\n2ã€é‡‡ç”¨å•çº¿ç¨‹ï¼Œé¿å…äº†ä¸å¿…è¦çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œç«äº‰æ¡ä»¶\n\n3ã€éé˜»å¡ IO ä¼˜ç‚¹ï¼š\n\n- é€Ÿåº¦å¿«ï¼Œå› ä¸ºæ•°æ®å­˜åœ¨å†…å­˜ä¸­ï¼Œç±»ä¼¼äº HashMapï¼ŒHashMap çš„ä¼˜åŠ¿å°±æ˜¯æŸ¥æ‰¾å’Œæ“ä½œçš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ O(1)\n- æ”¯æŒä¸°å¯Œæ•°æ®ç±»å‹ï¼Œæ”¯æŒ stringï¼Œlistï¼Œsetï¼Œsorted setï¼Œhash\n- æ”¯æŒäº‹åŠ¡ï¼Œæ“ä½œéƒ½æ˜¯åŸå­æ€§ï¼Œæ‰€è°“çš„åŸå­æ€§å°±æ˜¯å¯¹æ•°æ®çš„æ›´æ”¹è¦ä¹ˆå…¨éƒ¨æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ¨ä¸æ‰§è¡Œ\n- ä¸°å¯Œçš„ç‰¹æ€§ï¼šå¯ç”¨äºç¼“å­˜ï¼Œæ¶ˆæ¯ï¼ŒæŒ‰ key è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œè¿‡æœŸåå°†ä¼šè‡ªåŠ¨åˆ é™¤å¦‚ä½•è§£å†³ Redis çš„å¹¶å‘ç«äº‰ key é—®é¢˜\n\n**åŒæ—¶æœ‰å¤šä¸ªå­ç³»ç»Ÿå»setä¸€ä¸ªkeyã€‚è¿™ä¸ªæ—¶å€™è¦æ³¨æ„ä»€ä¹ˆå‘¢ï¼Ÿ**\n\nä¸æ¨èä½¿ç”¨ Redis çš„äº‹åŠ¡æœºåˆ¶ã€‚å› ä¸ºæˆ‘ä»¬çš„ç”Ÿäº§ç¯å¢ƒï¼ŒåŸºæœ¬éƒ½æ˜¯ Redis é›†ç¾¤ç¯å¢ƒï¼Œåšäº†æ•°æ®åˆ†ç‰‡æ“ä½œã€‚ä½ ä¸€ä¸ªäº‹åŠ¡ä¸­æœ‰æ¶‰åŠåˆ°å¤šä¸ª key æ“ä½œçš„æ—¶å€™ï¼Œè¿™å¤šä¸ª key ä¸ä¸€å®šéƒ½å­˜å‚¨åœ¨åŒä¸€ä¸ª Redis-server ä¸Šã€‚å› æ­¤ï¼ŒRedis çš„äº‹åŠ¡æœºåˆ¶ï¼Œååˆ†é¸¡è‚‹ã€‚\n\n- å¦‚æœå¯¹è¿™ä¸ª key æ“ä½œï¼Œä¸è¦æ±‚é¡ºåºï¼šå‡†å¤‡ä¸€ä¸ªåˆ†å¸ƒå¼é”ï¼Œå¤§å®¶å»æŠ¢é”ï¼ŒæŠ¢åˆ°é”å°±åš set æ“ä½œå³å¯\n- å¦‚æœå¯¹è¿™ä¸ª key æ“ä½œï¼Œè¦æ±‚é¡ºåºï¼šåˆ†å¸ƒå¼é”+æ—¶é—´æˆ³ã€‚å‡è®¾è¿™ä¼šç³»ç»Ÿ B å…ˆæŠ¢åˆ°é”ï¼Œå°† key1 è®¾ç½®ä¸º{valueB 3:05}ã€‚æ¥ä¸‹æ¥ç³»ç»Ÿ A æŠ¢åˆ°é”ï¼Œå‘ç°è‡ªå·±çš„ valueA çš„æ—¶é—´æˆ³æ—©äºç¼“å­˜ä¸­çš„æ—¶é—´æˆ³ï¼Œé‚£å°±ä¸åš set æ“ä½œäº†ã€‚ä»¥æ­¤ç±»æ¨ã€‚\n- åˆ©ç”¨é˜Ÿåˆ—ï¼Œå°† set æ–¹æ³•å˜æˆä¸²è¡Œè®¿é—®ä¹Ÿå¯ä»¥ Redis é‡åˆ°é«˜å¹¶å‘ï¼Œå¦‚æœä¿è¯è¯»å†™ key çš„ä¸€è‡´æ€§\n\nå¯¹ Redis çš„æ“ä½œéƒ½æ˜¯å…·æœ‰åŸå­æ€§çš„ï¼Œæ˜¯çº¿ç¨‹å®‰å…¨çš„æ“ä½œï¼Œä½ ä¸ç”¨è€ƒè™‘å¹¶å‘é—®é¢˜,Redis å†…éƒ¨å·²ç»å¸®ä½ å¤„ç†å¥½å¹¶å‘çš„é—®é¢˜äº†ã€‚\n\n### ä¸ºä»€ä¹ˆRedisçš„æ“ä½œæ˜¯åŸå­æ€§çš„ï¼Œæ€ä¹ˆä¿è¯åŸå­æ€§çš„ï¼Ÿ\n\nå¯¹äº Redis è€Œè¨€ï¼Œå‘½ä»¤çš„åŸå­æ€§æŒ‡çš„æ˜¯ï¼šä¸€ä¸ªæ“ä½œçš„ä¸å¯ä»¥å†åˆ†ï¼Œæ“ä½œè¦ä¹ˆæ‰§è¡Œï¼Œè¦ä¹ˆä¸æ‰§è¡Œã€‚\n\nRedis çš„æ“ä½œä¹‹æ‰€ä»¥æ˜¯åŸå­æ€§çš„ï¼Œæ˜¯å› ä¸º Redis æ˜¯å•çº¿ç¨‹çš„ã€‚ï¼ˆRedis æ–°ç‰ˆæœ¬å·²ç»å¼•å…¥å¤šçº¿ç¨‹ï¼Œè¿™é‡ŒåŸºäºæ—§ç‰ˆæœ¬çš„ Redisï¼‰\n\nRedis æœ¬èº«æä¾›çš„æ‰€æœ‰ API éƒ½æ˜¯åŸå­æ“ä½œï¼ŒRedis ä¸­çš„äº‹åŠ¡å…¶å®æ˜¯è¦ä¿è¯æ‰¹é‡æ“ä½œçš„åŸå­æ€§ã€‚\n\nå¤šä¸ªå‘½ä»¤åœ¨å¹¶å‘ä¸­ä¹Ÿæ˜¯åŸå­æ€§çš„å—ï¼Ÿ\n\nä¸ä¸€å®šï¼Œ å°† get å’Œ set æ”¹æˆå•å‘½ä»¤æ“ä½œï¼Œincr ã€‚ä½¿ç”¨ Redis çš„äº‹åŠ¡ï¼Œæˆ–è€…ä½¿ç”¨ Redis+Lua çš„æ–¹å¼å®ç°.\n\n### è®²è§£ä¸‹Redisçº¿ç¨‹æ¨¡å‹\n\næ–‡ä»¶äº‹ä»¶å¤„ç†å™¨åŒ…æ‹¬åˆ†åˆ«æ˜¯å¥—æ¥å­—ã€ I/O å¤šè·¯å¤ç”¨ç¨‹åºã€ æ–‡ä»¶äº‹ä»¶åˆ†æ´¾å™¨ï¼ˆdispatcherï¼‰ã€ ä»¥åŠäº‹ä»¶å¤„ç†å™¨ã€‚ä½¿ç”¨ I/O å¤šè·¯å¤ç”¨ç¨‹åºæ¥åŒæ—¶ç›‘å¬å¤šä¸ªå¥—æ¥å­—ï¼Œ å¹¶æ ¹æ®å¥—æ¥å­—ç›®å‰æ‰§è¡Œçš„ä»»åŠ¡æ¥ä¸ºå¥—æ¥å­—å…³è”ä¸åŒçš„äº‹ä»¶å¤„ç†å™¨ã€‚\n\nå½“è¢«ç›‘å¬çš„å¥—æ¥å­—å‡†å¤‡å¥½æ‰§è¡Œè¿æ¥åº”ç­”ï¼ˆacceptï¼‰ã€è¯»å–ï¼ˆreadï¼‰ã€å†™å…¥ï¼ˆwriteï¼‰ã€å…³é—­ï¼ˆcloseï¼‰ç­‰æ“ä½œæ—¶ï¼Œ ä¸æ“ä½œç›¸å¯¹åº”çš„æ–‡ä»¶äº‹ä»¶å°±ä¼šäº§ç”Ÿï¼Œ è¿™æ—¶æ–‡ä»¶äº‹ä»¶å¤„ç†å™¨å°±ä¼šè°ƒç”¨å¥—æ¥å­—ä¹‹å‰å…³è”å¥½çš„äº‹ä»¶å¤„ç†å™¨æ¥å¤„ç†è¿™äº›äº‹ä»¶ã€‚\n\nI/O å¤šè·¯å¤ç”¨ç¨‹åºè´Ÿè´£ç›‘å¬å¤šä¸ªå¥—æ¥å­—ï¼Œ å¹¶å‘æ–‡ä»¶äº‹ä»¶åˆ†æ´¾å™¨ä¼ é€é‚£äº›äº§ç”Ÿäº†äº‹ä»¶çš„å¥—æ¥å­—ã€‚\n\n**å·¥ä½œåŸç†ï¼š**\n\nI/O å¤šè·¯å¤ç”¨ç¨‹åºè´Ÿè´£ç›‘å¬å¤šä¸ªå¥—æ¥å­—ï¼Œ å¹¶å‘æ–‡ä»¶äº‹ä»¶åˆ†æ´¾å™¨ä¼ é€é‚£äº›äº§ç”Ÿäº†äº‹ä»¶çš„å¥—æ¥å­—ã€‚\n\nå°½ç®¡å¤šä¸ªæ–‡ä»¶äº‹ä»¶å¯èƒ½ä¼šå¹¶å‘åœ°å‡ºç°ï¼Œ ä½† I/O å¤šè·¯å¤ç”¨ç¨‹åºæ€»æ˜¯ä¼šå°†æ‰€æœ‰äº§ç”Ÿäº‹ä»¶çš„å¥—æ¥å­—éƒ½å…¥é˜Ÿåˆ°ä¸€ä¸ªé˜Ÿåˆ—é‡Œé¢ï¼Œ ç„¶åé€šè¿‡è¿™ä¸ªé˜Ÿåˆ—ï¼Œ ä»¥æœ‰åºï¼ˆsequentiallyï¼‰ã€åŒæ­¥ï¼ˆsynchronouslyï¼‰ã€æ¯æ¬¡ä¸€ä¸ªå¥—æ¥å­—çš„æ–¹å¼å‘æ–‡ä»¶äº‹ä»¶åˆ†æ´¾å™¨ä¼ é€å¥—æ¥å­—ï¼š\n\nå½“ä¸Šä¸€ä¸ªå¥—æ¥å­—äº§ç”Ÿçš„äº‹ä»¶è¢«å¤„ç†å®Œæ¯•ä¹‹åï¼ˆè¯¥å¥—æ¥å­—ä¸ºäº‹ä»¶æ‰€å…³è”çš„äº‹ä»¶å¤„ç†å™¨æ‰§è¡Œå®Œæ¯•ï¼‰ï¼Œ I/O å¤šè·¯å¤ç”¨ç¨‹åºæ‰ä¼šç»§ç»­å‘æ–‡ä»¶äº‹ä»¶åˆ†æ´¾å™¨ä¼ é€ä¸‹ä¸€ä¸ªå¥—æ¥å­—ã€‚å¦‚æœä¸€ä¸ªå¥—æ¥å­—åˆå¯è¯»åˆå¯å†™çš„è¯ï¼Œ é‚£ä¹ˆæœåŠ¡å™¨å°†å…ˆè¯»å¥—æ¥å­—ï¼Œ åå†™å¥—æ¥å­—ã€‚\n\n## å…¶ä»–å‚è€ƒ\n\n[åŸåˆ› ä¸€æ´º [é˜¿é‡Œå¼€å‘è€…](javascript:void(0);) 2022-03-24 08:00](https://mp.weixin.qq.com/s?__biz=MzIzOTU0NTQ0MA==&mid=2247507942&idx=1&sn=e00fd16ec56d0e10cc830678ee25c417&chksm=e92ae2e9de5d6bff6d227646c12685a5c45a4c3322e2186954555a14ebcd9510e8ae579a4941&mpshare=1&scene=24&srcid=0324gng7YtX5XX0z9bf7aObR&sharer_sharetime=1648080975816&sharer_shareid=ebfad4e5798246e3d3928c1f4ee9048e#rd)\n\nhttps://blog.csdn.net/qq_31387317/category_7391502.html\n","slug":"Javaå…«è‚¡æ–‡-Redis","published":1,"updated":"2023-01-29T11:45:09.073Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cldzfw3280013t9t889q7blhp","content":"<blockquote>\n<p>æ•´ç†çš„ Redis ç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½\t<span id=\"more\"></span></p>\n</blockquote>\n<h2 id=\"ä»€ä¹ˆæ˜¯NoSQLï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯NoSQLï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯NoSQLï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯NoSQLï¼Ÿ</h2><p>NoSQL &#x3D; not only sqlï¼ˆä¸ä»…ä»…æ˜¯ SQLï¼‰</p>\n<p>å…³ç³»å‹æ•°æ®åº“ï¼šåˆ—+è¡Œï¼ŒåŒä¸€ä¸ªè¡¨ä¸‹æ•°æ®çš„ç»“æ„æ˜¯ä¸€æ ·çš„ã€‚</p>\n<p>éå…³ç³»å‹æ•°æ®åº“ï¼šæ•°æ®å­˜å‚¨æ²¡æœ‰å›ºå®šçš„æ ¼å¼ï¼Œå¹¶ä¸”å¯ä»¥è¿›è¡Œæ¨ªå‘æ‰©å±•ã€‚</p>\n<p>NoSQL æ³›æŒ‡éå…³ç³»å‹æ•°æ®åº“ï¼Œéšç€ web2.0 äº’è”ç½‘çš„è¯ç”Ÿï¼Œä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“å¾ˆéš¾å¯¹ä»˜ web2.0 å¤§æ•°æ®æ—¶ä»£ã€‚å°¤å…¶æ˜¯è¶…å¤§è§„æ¨¡çš„é«˜å¹¶å‘çš„ç¤¾åŒºï¼Œæš´éœ²å‡ºæ¥å¾ˆå¤šéš¾ä»¥å…‹æœçš„é—®é¢˜ï¼ŒNoSQL åœ¨å½“ä»Šå¤§æ•°æ®ç¯å¢ƒä¸‹å‘å±•çš„ååˆ†è¿…é€Ÿï¼ŒRedis æ˜¯å‘å±•æœ€å¿«çš„ã€‚</p>\n<p>ä¼ ç»Ÿ RDBMSï¼ˆå…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼‰å’Œ NoSQLï¼ˆéå…³ç³»å‹æ•°æ®åº“ï¼‰æ¯”è¾ƒï¼š</p>\n<p>RDBMSï¼š</p>\n<ul>\n<li>ç»„ç»‡åŒ–ç»“æ„</li>\n<li>å›ºå®š SQL</li>\n<li>æ•°æ®å’Œå…³ç³»éƒ½å­˜åœ¨å•ç‹¬çš„è¡¨ä¸­ï¼ˆè¡Œåˆ—ï¼‰</li>\n<li>DMLï¼ˆæ•°æ®æ“ä½œè¯­è¨€ï¼‰ã€DDLï¼ˆæ•°æ®å®šä¹‰è¯­è¨€ï¼‰ç­‰</li>\n<li>ä¸¥æ ¼çš„ä¸€è‡´æ€§ï¼ˆACIDï¼‰ï¼šåŸå­æ€§ã€ä¸€è‡´æ€§ã€éš”ç¦»æ€§ã€æŒä¹…æ€§</li>\n<li>åŸºç¡€çš„äº‹åŠ¡</li>\n</ul>\n<p>NoSQLï¼š</p>\n<ul>\n<li>ä¸ä»…ä»…æ˜¯æ•°æ®</li>\n<li>æ²¡æœ‰å›ºå®šæŸ¥è¯¢è¯­è¨€</li>\n<li>é”®å€¼å¯¹å­˜å‚¨ï¼ˆRedisï¼‰ã€åˆ—å­˜å‚¨ï¼ˆHBaseï¼‰ã€æ–‡æ¡£å­˜å‚¨ï¼ˆMongoDBï¼‰ã€å›¾å½¢æ•°æ®åº“ï¼ˆä¸æ˜¯å­˜å›¾å½¢ï¼Œæ”¾çš„æ˜¯å…³ç³»ï¼‰ï¼ˆNeo4jï¼‰</li>\n<li>æœ€ç»ˆä¸€è‡´æ€§ï¼ˆBASEï¼‰ï¼šåŸºæœ¬å¯ç”¨ã€è½¯çŠ¶æ€&#x2F;æŸ”æ€§äº‹åŠ¡ã€æœ€ç»ˆä¸€è‡´æ€§</li>\n</ul>\n<hr>\n<h2 id=\"Redisæ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#Redisæ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"Redisæ˜¯ä»€ä¹ˆï¼Ÿ\"></a>Redisæ˜¯ä»€ä¹ˆï¼Ÿ</h2><h3 id=\"å®šä¹‰\"><a href=\"#å®šä¹‰\" class=\"headerlink\" title=\"å®šä¹‰\"></a>å®šä¹‰</h3><p>Redis &#x3D; Remote Dictionary Serverï¼Œå³è¿œç¨‹å­—å…¸æœåŠ¡ã€‚</p>\n<p>Redis æ˜¯ä¸€ä¸ªç”¨ C è¯­è¨€å¼€å‘çš„ã€åŸºäºå†…å­˜ç»“æ„è¿›è¡Œ<strong>é”®å€¼å¯¹</strong>æ•°æ®å­˜å‚¨çš„ã€é«˜æ€§èƒ½çš„ã€éå…³ç³»å‹ NoSQL æ•°æ®åº“</p>\n<h3 id=\"ä¼˜ç¼ºç‚¹\"><a href=\"#ä¼˜ç¼ºç‚¹\" class=\"headerlink\" title=\"ä¼˜ç¼ºç‚¹\"></a>ä¼˜ç¼ºç‚¹</h3><p><strong>çº¯å†…å­˜æ“ä½œï¼Œæ€§èƒ½éå¸¸å‡ºè‰²</strong>ï¼Œæ¯ç§’å¯ä»¥å¤„ç†è¶…è¿‡ 10 ä¸‡æ¬¡è¯»å†™æ“ä½œï¼Œæ˜¯å·²çŸ¥æ€§èƒ½æœ€å¿«çš„ Key-Value DBã€‚æ”¯æŒä¿å­˜å¤šç§æ•°æ®ç»“æ„ï¼Œå¯ä»¥ç”¨æ¥å®ç°å¾ˆå¤šæœ‰ç”¨çš„åŠŸèƒ½ã€‚</p>\n<p>Redis çš„ä¸»è¦ç¼ºç‚¹æ˜¯<strong>æ•°æ®åº“å®¹é‡å—åˆ°ç‰©ç†å†…å­˜çš„é™åˆ¶ï¼Œä¸èƒ½ç”¨ä½œæµ·é‡æ•°æ®çš„é«˜æ€§èƒ½è¯»å†™</strong>ï¼Œå› æ­¤ Redis é€‚åˆçš„åœºæ™¯ä¸»è¦å±€é™åœ¨è¾ƒå°æ•°æ®é‡çš„é«˜æ€§èƒ½æ“ä½œå’Œè¿ç®—ä¸Šã€‚</p>\n<h3 id=\"ä¸ºä»€ä¹ˆè¦ç”¨ç¼“å­˜\"><a href=\"#ä¸ºä»€ä¹ˆè¦ç”¨ç¼“å­˜\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆè¦ç”¨ç¼“å­˜\"></a>ä¸ºä»€ä¹ˆè¦ç”¨ç¼“å­˜</h3><p><strong>1ã€ é«˜æ€§èƒ½ï¼š</strong></p>\n<p>å‡å¦‚ç”¨æˆ·ç¬¬ä¸€æ¬¡è®¿é—®æ•°æ®åº“ä¸­çš„æŸäº›æ•°æ®ã€‚è¿™ä¸ªè¿‡ç¨‹ä¼šæ¯”è¾ƒæ…¢ï¼Œå› ä¸ºæ˜¯ä»ç¡¬ç›˜ä¸Šè¯»å–çš„ã€‚å°†è¯¥ç”¨æˆ·è®¿é—®çš„æ•°æ®å­˜åœ¨æ•°ç¼“å­˜ä¸­ï¼Œè¿™æ ·ä¸‹ä¸€æ¬¡å†è®¿é—®è¿™äº›æ•°æ®çš„æ—¶å€™å°±å¯ä»¥ç›´æ¥ä»ç¼“å­˜ä¸­è·å–äº†ã€‚æ“ä½œç¼“å­˜å°±æ˜¯ç›´æ¥æ“ä½œå†…å­˜ï¼Œæ‰€ä»¥é€Ÿåº¦ç›¸å½“å¿«ã€‚å¦‚æœæ•°æ®åº“ä¸­çš„å¯¹åº”æ•°æ®æ”¹å˜çš„ä¹‹åï¼ŒåŒæ­¥æ”¹å˜ç¼“å­˜ä¸­ç›¸åº”çš„æ•°æ®å³å¯ã€‚</p>\n<p><strong>2ã€é«˜å¹¶å‘ï¼š</strong></p>\n<p>ç›´æ¥æ“ä½œç¼“å­˜èƒ½å¤Ÿæ‰¿å—çš„è¯·æ±‚æ˜¯è¿œè¿œå¤§äºç›´æ¥è®¿é—®æ•°æ®åº“çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è€ƒè™‘æŠŠæ•°æ®åº“ä¸­çš„éƒ¨åˆ†æ•°æ®è½¬ç§»åˆ°ç¼“å­˜ä¸­å»ï¼Œè¿™æ ·ç”¨æˆ·çš„ä¸€éƒ¨åˆ†è¯·æ±‚ä¼šç›´æ¥åˆ°ç¼“å­˜è¿™é‡Œè€Œä¸ç”¨ç»è¿‡æ•°æ®åº“ï¼Œç¼“è§£æ•°æ®åº“å‹åŠ›ã€‚</p>\n<h3 id=\"Redis-ä¸-Memcached-ç›¸æ¯”æœ‰å“ªäº›ä¼˜åŠ¿\"><a href=\"#Redis-ä¸-Memcached-ç›¸æ¯”æœ‰å“ªäº›ä¼˜åŠ¿\" class=\"headerlink\" title=\"Redis ä¸ Memcached ç›¸æ¯”æœ‰å“ªäº›ä¼˜åŠ¿\"></a>Redis ä¸ Memcached ç›¸æ¯”æœ‰å“ªäº›ä¼˜åŠ¿</h3><p>Redis æ”¯æŒæ›´ä¸°å¯Œçš„æ•°æ®ç±»å‹ï¼ˆæ”¯æŒæ›´å¤æ‚çš„åº”ç”¨åœºæ™¯ï¼‰</p>\n<p>Redis æ”¯æŒæ•°æ®çš„æŒä¹…åŒ–ï¼Œå¯ä»¥å°†å†…å­˜ä¸­çš„æ•°æ®ä¿æŒåœ¨ç£ç›˜ä¸­ï¼Œé‡å¯çš„æ—¶å€™å¯ä»¥å†æ¬¡åŠ è½½è¿›è¡Œä½¿ç”¨ï¼Œè€Œ Memecache æŠŠæ•°æ®å…¨éƒ¨å­˜åœ¨å†…å­˜ä¹‹ä¸­ã€‚</p>\n<p>Redis ä½¿ç”¨å•çº¿ç¨‹çš„å¤šè·¯ IO å¤ç”¨æ¨¡å‹ï¼›Memcached æ˜¯å¤šçº¿ç¨‹ï¼Œéé˜»å¡ IO å¤ç”¨çš„ç½‘ç»œæ¨¡å‹ã€‚</p>\n<hr>\n<h2 id=\"Redisäº”å¤§åŸºæœ¬ç±»å‹\"><a href=\"#Redisäº”å¤§åŸºæœ¬ç±»å‹\" class=\"headerlink\" title=\"Redisäº”å¤§åŸºæœ¬ç±»å‹\"></a>Redisäº”å¤§åŸºæœ¬ç±»å‹</h2><p><a href=\"https://www.redis.net.cn/order/\">Redis å‘½ä»¤å¤§å…¨</a></p>\n<p><a href=\"https://juejin.cn/post/6857667542652190728\">Redis åº”ç”¨åœºæ™¯</a></p>\n<h3 id=\"Stringï¼ˆå­—ç¬¦ä¸²ï¼‰\"><a href=\"#Stringï¼ˆå­—ç¬¦ä¸²ï¼‰\" class=\"headerlink\" title=\"Stringï¼ˆå­—ç¬¦ä¸²ï¼‰\"></a>Stringï¼ˆå­—ç¬¦ä¸²ï¼‰</h3><blockquote>\n<ol>\n<li><p>String ç±»å‹æ˜¯ Redis çš„æœ€åŸºç¡€çš„æ•°æ®ç»“æ„ï¼Œä¹Ÿæ˜¯æœ€ç»å¸¸ä½¿ç”¨åˆ°çš„ç±»å‹ã€‚è€Œä¸”å…¶ä»–çš„å››ç§ç±»å‹å¤šå¤šå°‘å°‘éƒ½æ˜¯åœ¨å­—ç¬¦ä¸²ç±»å‹çš„åŸºç¡€ä¸Šæ„å»ºçš„ï¼Œæ‰€ä»¥ String ç±»å‹æ˜¯ Redis çš„åŸºç¡€ã€‚</p>\n</li>\n<li><p>String ç±»å‹çš„å€¼æœ€å¤§èƒ½å­˜å‚¨ 512MBï¼Œè¿™é‡Œçš„ String ç±»å‹å¯ä»¥æ˜¯ç®€å•å­—ç¬¦ä¸²ã€  å¤æ‚çš„ xml&#x2F;json çš„å­—ç¬¦ä¸²ã€äºŒè¿›åˆ¶å›¾åƒæˆ–è€…éŸ³é¢‘çš„å­—ç¬¦ä¸²ã€ä»¥åŠå¯ä»¥æ˜¯æ•°å­—çš„å­—ç¬¦ä¸²ã€‚</p>\n</li>\n</ol>\n</blockquote>\n<p><strong>åº”ç”¨åœºæ™¯</strong></p>\n<p>1ã€ç¼“å­˜åŠŸèƒ½ï¼šString å­—ç¬¦ä¸²æ˜¯æœ€å¸¸ç”¨çš„æ•°æ®ç±»å‹ï¼Œä¸ä»…ä»…æ˜¯ Redisï¼Œå„ä¸ªè¯­è¨€éƒ½æ˜¯æœ€åŸºæœ¬ç±»å‹ï¼Œå› æ­¤ï¼Œåˆ©ç”¨ Redis ä½œä¸ºç¼“å­˜ï¼Œé…åˆå…¶å®ƒæ•°æ®åº“ä½œä¸ºå­˜å‚¨å±‚ï¼Œåˆ©ç”¨ Redis æ”¯æŒé«˜å¹¶å‘çš„ç‰¹ç‚¹ï¼Œå¯ä»¥å¤§å¤§åŠ å¿«ç³»ç»Ÿçš„è¯»å†™é€Ÿåº¦ã€ä»¥åŠé™ä½åç«¯æ•°æ®åº“çš„å‹åŠ›ã€‚</p>\n<p>2ã€è®¡æ•°å™¨ï¼šè®¸å¤šç³»ç»Ÿéƒ½ä¼šä½¿ç”¨ Redis ä½œä¸ºç³»ç»Ÿçš„å®æ—¶è®¡æ•°å™¨ï¼Œå¯ä»¥å¿«é€Ÿå®ç°è®¡æ•°å’ŒæŸ¥è¯¢çš„åŠŸèƒ½ã€‚è€Œä¸”æœ€ç»ˆçš„æ•°æ®ç»“æœå¯ä»¥æŒ‰ç…§ç‰¹å®šçš„æ—¶é—´è½åœ°åˆ°æ•°æ®åº“æˆ–è€…å…¶å®ƒå­˜å‚¨ä»‹è´¨å½“ä¸­è¿›è¡Œæ°¸ä¹…ä¿å­˜ã€‚</p>\n<p>3ã€å…±äº«ç”¨æˆ· sessionï¼šç”¨æˆ·é‡æ–°åˆ·æ–°ä¸€æ¬¡ç•Œé¢ï¼Œå¯èƒ½éœ€è¦è®¿é—®ä¸€ä¸‹æ•°æ®è¿›è¡Œé‡æ–°ç™»å½•ï¼Œæˆ–è€…è®¿é—®é¡µé¢ç¼“å­˜ cookieï¼Œè¿™ä¸¤ç§æ–¹å¼åšæœ‰ä¸€å®šå¼Šç«¯ï¼Œ1ï¼‰æ¯æ¬¡éƒ½é‡æ–°ç™»å½•æ•ˆç‡ä½ä¸‹ 2ï¼‰cookie ä¿å­˜åœ¨å®¢æˆ·ç«¯ï¼Œæœ‰å®‰å…¨éšæ‚£ã€‚è¿™æ—¶å¯ä»¥åˆ©ç”¨ Redis å°†ç”¨æˆ·çš„ session é›†ä¸­ç®¡ç†ï¼Œåœ¨è¿™ç§æ¨¡å¼åªéœ€è¦ä¿è¯ Redis çš„é«˜å¯ç”¨ï¼Œæ¯æ¬¡ç”¨æˆ· session çš„æ›´æ–°å’Œè·å–éƒ½å¯ä»¥å¿«é€Ÿå®Œæˆã€‚å¤§å¤§æé«˜æ•ˆç‡ã€‚ï¼ˆåˆ†å¸ƒå¼ä¼šè¯ï¼‰</p>\n<h3 id=\"Listï¼ˆåˆ—è¡¨ï¼‰\"><a href=\"#Listï¼ˆåˆ—è¡¨ï¼‰\" class=\"headerlink\" title=\"Listï¼ˆåˆ—è¡¨ï¼‰\"></a>Listï¼ˆåˆ—è¡¨ï¼‰</h3><blockquote>\n<ol>\n<li>List æ˜¯ç®€å•çš„å­—ç¬¦ä¸²åˆ—è¡¨</li>\n<li>Redis å¯ä»¥ä»åˆ—è¡¨çš„ä¸¤ç«¯è¿›è¡Œæ’å…¥ï¼ˆpubshï¼‰å’Œå¼¹å‡ºï¼ˆpopï¼‰å…ƒç´ ï¼Œæ”¯æŒè¯»å–æŒ‡å®šèŒƒå›´çš„å…ƒç´ é›†ï¼Œæˆ–è€…è¯»å–æŒ‡å®šä¸‹æ ‡çš„å…ƒç´ ç­‰æ“ä½œã€‚Redisåˆ—è¡¨æ˜¯ä¸€ç§æ¯”è¾ƒçµæ´»çš„é“¾è¡¨æ•°æ®ç»“æ„ï¼Œå®ƒå¯ä»¥å……å½“é˜Ÿåˆ—æˆ–è€…æ ˆçš„è§’è‰²ã€‚</li>\n</ol>\n</blockquote>\n<p><strong>åº”ç”¨åœºæ™¯</strong></p>\n<p>1ã€æ¶ˆæ¯é˜Ÿåˆ—ï¼šRedis çš„é“¾è¡¨ç»“æ„ï¼Œå¯ä»¥è½»æ¾å®ç°é˜»å¡é˜Ÿåˆ—ï¼Œå¯ä»¥ä½¿ç”¨å·¦è¿›å³å‡ºçš„å‘½ä»¤ç»„æˆæ¥å®Œæˆé˜Ÿåˆ—çš„è®¾è®¡ã€‚æ¯”å¦‚ï¼šæ•°æ®çš„ç”Ÿäº§è€…å¯ä»¥é€šè¿‡ lpush å‘½ä»¤ä»å·¦è¾¹æ’å…¥æ•°æ®ï¼Œå¤šä¸ªæ•°æ®æ¶ˆè´¹è€…ï¼Œå¯ä»¥ä½¿ç”¨ rpop å‘½ä»¤é˜»å¡çš„â€œæŠ¢â€åˆ—è¡¨å°¾éƒ¨çš„æ•°æ®ã€‚</p>\n<p>2ã€æ–‡ç« åˆ—è¡¨æˆ–è€…æ•°æ®åˆ†é¡µå±•ç¤ºçš„åº”ç”¨ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å¸¸ç”¨çš„åšå®¢ç½‘ç«™çš„æ–‡ç« åˆ—è¡¨ï¼Œå½“ç”¨æˆ·é‡è¶Šæ¥è¶Šå¤šæ—¶ï¼Œè€Œä¸”æ¯ä¸€ä¸ªç”¨æˆ·éƒ½æœ‰è‡ªå·±çš„æ–‡ç« åˆ—è¡¨ï¼Œè€Œä¸”å½“æ–‡ç« å¤šæ—¶ï¼Œéƒ½éœ€è¦åˆ†é¡µå±•ç¤ºï¼Œè¿™æ—¶å¯ä»¥è€ƒè™‘ä½¿ç”¨ Redis çš„åˆ—è¡¨ï¼Œåˆ—è¡¨ä¸ä½†æœ‰åºåŒæ—¶è¿˜æ”¯æŒæŒ‰ç…§èŒƒå›´å†…è·å–å…ƒç´ ï¼Œå¯ä»¥å®Œç¾è§£å†³åˆ†é¡µæŸ¥è¯¢åŠŸèƒ½ã€‚å¤§å¤§æé«˜æŸ¥è¯¢æ•ˆç‡ã€‚</p>\n<h3 id=\"Setï¼ˆé›†åˆï¼‰\"><a href=\"#Setï¼ˆé›†åˆï¼‰\" class=\"headerlink\" title=\"Setï¼ˆé›†åˆï¼‰\"></a>Setï¼ˆé›†åˆï¼‰</h3><blockquote>\n<ol>\n<li>Redis é›†åˆ set ç±»å‹å’Œ list åˆ—è¡¨ç±»å‹ç±»ä¼¼ï¼Œéƒ½å¯ä»¥ç”¨æ¥å­˜å‚¨å¤šä¸ªå­—ç¬¦ä¸²å…ƒç´ çš„é›†åˆã€‚</li>\n<li>ä½†æ˜¯å’Œ list ä¸åŒçš„æ˜¯ set é›†åˆå½“ä¸­ä¸å…è®¸é‡å¤çš„å…ƒç´ ã€‚è€Œä¸” set é›†åˆå½“ä¸­å…ƒç´ æ˜¯æ²¡æœ‰é¡ºåºçš„ï¼Œä¸å­˜åœ¨å…ƒç´ ä¸‹æ ‡ã€‚</li>\n<li>Redis çš„ set ç±»å‹æ˜¯ä½¿ç”¨å“ˆå¸Œè¡¨æ„é€ çš„ï¼Œå› æ­¤å¤æ‚åº¦æ˜¯ O(1)ï¼Œå®ƒæ”¯æŒé›†åˆå†…çš„å¢åˆ æ”¹æŸ¥ï¼Œå¹¶ä¸”æ”¯æŒå¤šä¸ªé›†åˆé—´çš„äº¤é›†ã€å¹¶é›†ã€å·®é›†æ“ä½œã€‚å¯ä»¥åˆ©ç”¨è¿™äº›é›†åˆæ“ä½œï¼Œè§£å†³ç¨‹åºå¼€å‘è¿‡ç¨‹å½“ä¸­å¾ˆå¤šæ•°æ®é›†åˆé—´çš„é—®é¢˜ã€‚</li>\n</ol>\n</blockquote>\n<p><strong>åº”ç”¨åœºæ™¯</strong></p>\n<p>1ã€æ ‡ç­¾ï¼šæ¯”å¦‚æˆ‘ä»¬åšå®¢ç½‘ç«™å¸¸å¸¸ä½¿ç”¨åˆ°çš„å…´è¶£æ ‡ç­¾ï¼ŒæŠŠä¸€ä¸ªä¸ªæœ‰ç€ç›¸åŒçˆ±å¥½ï¼Œå…³æ³¨ç±»ä¼¼å†…å®¹çš„ç”¨æˆ·åˆ©ç”¨ä¸€ä¸ªæ ‡ç­¾æŠŠä»–ä»¬è¿›è¡Œå½’å¹¶ã€‚</p>\n<p>2ã€å…±åŒå¥½å‹åŠŸèƒ½ï¼Œå…±åŒå–œå¥½ï¼Œæˆ–è€…å¯ä»¥å¼•ç”³åˆ°äºŒåº¦å¥½å‹ä¹‹ç±»çš„æ‰©å±•åº”ç”¨ã€‚</p>\n<p>3ã€ç»Ÿè®¡ç½‘ç«™çš„ç‹¬ç«‹ IPã€‚åˆ©ç”¨ set é›†åˆå½“ä¸­å…ƒç´ ä¸å”¯ä¸€æ€§ï¼Œå¯ä»¥å¿«é€Ÿå®æ—¶ç»Ÿè®¡è®¿é—®ç½‘ç«™çš„ç‹¬ç«‹ IPã€‚</p>\n<h3 id=\"sorted-setï¼ˆæœ‰åºé›†åˆï¼‰\"><a href=\"#sorted-setï¼ˆæœ‰åºé›†åˆï¼‰\" class=\"headerlink\" title=\"sorted setï¼ˆæœ‰åºé›†åˆï¼‰\"></a>sorted setï¼ˆæœ‰åºé›†åˆï¼‰</h3><blockquote>\n<p>Redis æœ‰åºé›†åˆä¹Ÿæ˜¯é›†åˆç±»å‹çš„ä¸€éƒ¨åˆ†ï¼Œæ‰€ä»¥å®ƒä¿ç•™äº†é›†åˆä¸­å…ƒç´ ä¸èƒ½é‡å¤çš„ç‰¹æ€§ï¼Œä½†æ˜¯ä¸åŒçš„æ˜¯ï¼Œæœ‰åºé›†åˆç»™æ¯ä¸ªå…ƒç´ å¤šè®¾ç½®äº†ä¸€ä¸ªåˆ†æ•°ï¼Œåˆ©ç”¨è¯¥åˆ†æ•°ä½œä¸ºæ’åºçš„ä¾æ®ã€‚</p>\n</blockquote>\n<h4 id=\"åº”ç”¨åœºæ™¯\"><a href=\"#åº”ç”¨åœºæ™¯\" class=\"headerlink\" title=\"åº”ç”¨åœºæ™¯\"></a>åº”ç”¨åœºæ™¯</h4><p>1ã€æ’è¡Œæ¦œï¼šæœ‰åºé›†åˆç»å…¸ä½¿ç”¨åœºæ™¯ã€‚ä¾‹å¦‚è§†é¢‘ç½‘ç«™éœ€è¦å¯¹ç”¨æˆ·ä¸Šä¼ çš„è§†é¢‘åšæ’è¡Œæ¦œï¼Œæ¦œå•ç»´æŠ¤å¯èƒ½æ˜¯å¤šæ–¹é¢ï¼šæŒ‰ç…§æ—¶é—´ã€æŒ‰ç…§æ’­æ”¾é‡ã€æŒ‰ç…§è·å¾—çš„èµæ•°ç­‰ã€‚</p>\n<p>2ã€ç”¨ Sorted Sets æ¥åšå¸¦æƒé‡çš„é˜Ÿåˆ—ï¼Œæ¯”å¦‚æ™®é€šæ¶ˆæ¯çš„ score ä¸º 1ï¼Œé‡è¦æ¶ˆæ¯çš„ score ä¸º 2ï¼Œç„¶åå·¥ä½œçº¿ç¨‹å¯ä»¥é€‰æ‹©æŒ‰ score çš„å€’åºæ¥è·å–å·¥ä½œä»»åŠ¡ã€‚è®©é‡è¦çš„ä»»åŠ¡ä¼˜å…ˆæ‰§è¡Œã€‚</p>\n<h3 id=\"hashï¼ˆå“ˆå¸Œï¼‰\"><a href=\"#hashï¼ˆå“ˆå¸Œï¼‰\" class=\"headerlink\" title=\"hashï¼ˆå“ˆå¸Œï¼‰\"></a>hashï¼ˆå“ˆå¸Œï¼‰</h3><p>Redis hash æ•°æ®ç»“æ„ æ˜¯ä¸€ä¸ªé”®å€¼å¯¹ï¼ˆkey-valueï¼‰é›†åˆï¼Œå®ƒæ˜¯ä¸€ä¸ª string ç±»å‹çš„ field å’Œ value çš„æ˜ å°„è¡¨ï¼ŒRedis æœ¬èº«å°±æ˜¯ä¸€ä¸ª key-value å‹æ•°æ®åº“ï¼Œå› æ­¤ hash æ•°æ®ç»“æ„ç›¸å½“äºåœ¨ value ä¸­åˆå¥—äº†ä¸€å±‚ key-value å‹æ•°æ®ã€‚æ‰€ä»¥ Redis ä¸­ hash æ•°æ®ç»“æ„ç‰¹åˆ«é€‚åˆå­˜å‚¨å…³ç³»å‹å¯¹è±¡ã€‚</p>\n<blockquote>\n<p>ç”¨æˆ· ID ä¸ºæŸ¥æ‰¾çš„keyï¼Œå­˜å‚¨çš„ value ç”¨æˆ·å¯¹è±¡åŒ…å«å§“åï¼Œå¹´é¾„ï¼Œç”Ÿæ—¥ç­‰ä¿¡æ¯ï¼Œå¦‚æœç”¨æ™®é€šçš„ key&#x2F;value ç»“æ„æ¥å­˜å‚¨</p>\n<ol>\n<li>å°†ç”¨æˆ· ID ä½œä¸º keyï¼Œå§“åå±æ€§+å§“åæ•°æ®æ•´ä½“ä½œä¸º valueã€‚ç¼ºç‚¹æ˜¯æ¯æ¬¡ä¿®æ”¹ç”¨æˆ·çš„æŸä¸ªå±æ€§ï¼Œéƒ½éœ€è¦å…ˆååºåˆ—åŒ– å±æ€§+æ•°æ®ï¼Œä¿®æ”¹å¥½ï¼Œç„¶åå°† å±æ€§+æ•°æ® åºåˆ—åŒ–ä¹‹ååœ¨ä¿®æ”¹å›å»ï¼Œå¼€é”€è¾ƒå¤§ã€‚</li>\n</ol>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650356860189.png\" alt=\"ID -&gt; å±æ€§+æ•°æ®\"></p>\n<ol start=\"2\">\n<li>å°†ç”¨æˆ· ID+å§“åå±æ€§ä½œä¸º keyï¼Œå§“åæ•°æ®ä½œä¸º valueã€‚ç¼ºç‚¹æ˜¯ç”¨æˆ· ID ä½¿ç”¨å¤šæ¬¡ï¼Œæ•°æ®å†—ä½™</li>\n</ol>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650356955204.png\" alt=\"ID+å±æ€§ -&gt; æ•°æ®\"></p>\n<ol start=\"3\">\n<li>å› æ­¤é€šè¿‡ key(ç”¨æˆ· ID) + field(å±æ€§æ ‡ç­¾) å°±å¯ä»¥æ“ä½œå¯¹åº”å±æ€§æ•°æ®äº†ï¼Œæ—¢ä¸éœ€è¦é‡å¤å­˜å‚¨æ•°æ®ï¼Œä¹Ÿä¸ä¼šå¸¦æ¥åºåˆ—åŒ–å’Œå¹¶å‘ä¿®æ”¹æ§åˆ¶çš„é—®é¢˜ã€‚</li>\n</ol>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650356950290.png\" alt=\"ID -&gt; å±æ€§ -&gt; æ•°æ®\"></p>\n</blockquote>\n<h4 id=\"åº”ç”¨åœºæ™¯-1\"><a href=\"#åº”ç”¨åœºæ™¯-1\" class=\"headerlink\" title=\"åº”ç”¨åœºæ™¯\"></a>åº”ç”¨åœºæ™¯</h4><p>1ã€ç”±äº hash æ•°æ®ç±»å‹çš„ key-value çš„ç‰¹æ€§ï¼Œç”¨æ¥å­˜å‚¨å…³ç³»å‹æ•°æ®åº“ä¸­è¡¨è®°å½•ï¼Œæ˜¯ Redis ä¸­å“ˆå¸Œç±»å‹æœ€å¸¸ç”¨çš„åœºæ™¯ã€‚ä¸€æ¡è®°å½•ä½œä¸ºä¸€ä¸ª key-valueï¼ŒæŠŠæ¯åˆ—å±æ€§å€¼å¯¹åº”æˆ field-value å­˜å‚¨åœ¨å“ˆå¸Œè¡¨å½“ä¸­ï¼Œç„¶åé€šè¿‡ key å€¼æ¥åŒºåˆ†è¡¨å½“ä¸­çš„ä¸»é”®ã€‚</p>\n<p>2ã€ç»å¸¸è¢«ç”¨æ¥å­˜å‚¨ç”¨æˆ·ç›¸å…³ä¿¡æ¯ã€‚ä¼˜åŒ–ç”¨æˆ·ä¿¡æ¯çš„è·å–ï¼Œä¸éœ€è¦é‡å¤ä»æ•°æ®åº“å½“ä¸­è¯»å–ï¼Œæé«˜ç³»ç»Ÿæ€§èƒ½ã€‚</p>\n<hr>\n<h2 id=\"äº”å¤§åŸºæœ¬ç±»å‹åº•å±‚æ•°æ®ç»“æ„\"><a href=\"#äº”å¤§åŸºæœ¬ç±»å‹åº•å±‚æ•°æ®ç»“æ„\" class=\"headerlink\" title=\"äº”å¤§åŸºæœ¬ç±»å‹åº•å±‚æ•°æ®ç»“æ„\"></a>äº”å¤§åŸºæœ¬ç±»å‹åº•å±‚æ•°æ®ç»“æ„</h2><p>Redis æ•´ä½“çš„å­˜å‚¨ç»“æ„ï¼š</p>\n<p>Redis å†…éƒ¨æ•´ä½“çš„å­˜å‚¨ç»“æ„æ˜¯ä¸€ä¸ªå¤§çš„ hashmapï¼Œå†…éƒ¨æ˜¯æ•°ç»„å®ç°çš„ hashï¼Œkey å†²çªé€šè¿‡æŒ‚é“¾è¡¨å»å®ç°ï¼Œæ¯ä¸ª dictEntry ä¸ºä¸€ä¸ª key&#x2F;value å¯¹è±¡ï¼Œvalue ä¸ºå®šä¹‰çš„ redisObjectã€‚</p>\n<p>ç»“æ„å›¾å¦‚ä¸‹ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650433179786.png\" alt=\"Redis æ•´ä½“çš„å­˜å‚¨ç»“æ„\"></p>\n<p>dictEntry æ˜¯å­˜å‚¨ key-&gt;value çš„åœ°æ–¹ï¼Œå…¶ä¸­åŒ…å«æŒ‡å‘å…·ä½“çš„ redisObject çš„æŒ‡é’ˆã€‚</p>\n<p>redisObject ä¸­*ptr æŒ‡å‘å…·ä½“çš„æ•°æ®ç»“æ„çš„åœ°å€ï¼›type è¡¨ç¤ºè¯¥å¯¹è±¡çš„ç±»å‹ï¼Œå³ Stringã€Listã€Hashã€Setã€Zset ä¸­çš„ä¸€ä¸ª</p>\n<h3 id=\"String-arrayList\"><a href=\"#String-arrayList\" class=\"headerlink\" title=\"String (arrayList)\"></a>String (arrayList)</h3><p>String çš„æ•°æ®ç»“æ„ä¸ºç®€å•åŠ¨æ€å­—ç¬¦ä¸²(Simple Dynamic Stringï¼Œç¼©å†™ SDS)ã€‚æ˜¯å¯ä»¥ä¿®æ”¹çš„å­—ç¬¦ä¸²ï¼Œå†…éƒ¨ç»“æ„å®ç°ä¸Šç±»ä¼¼äº Java çš„ ArrayListï¼Œé‡‡ç”¨é¢„åˆ†é…å†—ä½™ç©ºé—´çš„æ–¹å¼æ¥å‡å°‘å†…å­˜çš„é¢‘ç¹åˆ†é…ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650356547555.png\" alt=\"String çš„æ•°æ®ç»“æ„\"></p>\n<p>å¦‚å›¾ä¸­æ‰€ç¤ºï¼Œå†…éƒ¨ä¸ºå½“å‰å­—ç¬¦ä¸²å®é™…åˆ†é…çš„ç©ºé—´ capacity ä¸€èˆ¬è¦é«˜äºå®é™…å­—ç¬¦ä¸²é•¿åº¦ lenã€‚å½“å­—ç¬¦ä¸²é•¿åº¦å°äº 1M æ—¶ï¼Œæ‰©å®¹éƒ½æ˜¯åŠ å€ç°æœ‰çš„ç©ºé—´ï¼Œå¦‚æœè¶…è¿‡ 1Mï¼Œæ‰©å®¹æ—¶ä¸€æ¬¡åªä¼šå¤šæ‰© 1M çš„ç©ºé—´ã€‚éœ€è¦æ³¨æ„çš„æ˜¯å­—ç¬¦ä¸²æœ€å¤§é•¿åº¦ä¸º 512Mã€‚</p>\n<h3 id=\"List-ziplist-quickList\"><a href=\"#List-ziplist-quickList\" class=\"headerlink\" title=\"List (ziplist - quickList)\"></a>List (ziplist - quickList)</h3><p>1ã€Redis 3.2 ä¹‹å‰çš„åº•å±‚å®ç°æ–¹å¼ï¼šå‹ç¼©åˆ—è¡¨ ziplist æˆ–è€… åŒå‘å¾ªç¯é“¾è¡¨ linkedlist</p>\n<p>å½“ list å­˜å‚¨çš„æ•°æ®é‡æ¯”è¾ƒå°‘ä¸”åŒæ—¶æ»¡è¶³ä¸‹é¢ä¸¤ä¸ªæ¡ä»¶æ—¶ï¼Œlist å°±ä½¿ç”¨ ziplist å­˜å‚¨æ•°æ®ï¼š</p>\n<ul>\n<li>list ä¸­ä¿å­˜çš„æ¯ä¸ªå…ƒç´ çš„é•¿åº¦å°äº 64 å­—èŠ‚ï¼›</li>\n<li>åˆ—è¡¨ä¸­æ•°æ®ä¸ªæ•°å°‘äº 512 ä¸ªã€‚</li>\n</ul>\n<p>2ã€Redis 3.2 åŠä¹‹åçš„åº•å±‚å®ç°æ–¹å¼ï¼šquicklist</p>\n<p>quicklist æ˜¯ä¸€ä¸ªåŸºäº ziplist çš„åŒå‘é“¾è¡¨ï¼Œquicklist çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸€ä¸ª ziplistï¼Œç»“åˆäº†åŒå‘é“¾è¡¨å’Œ ziplist çš„ä¼˜ç‚¹ã€‚</p>\n<h4 id=\"ziplist\"><a href=\"#ziplist\" class=\"headerlink\" title=\"ziplist\"></a><strong>ziplist</strong></h4><p>ziplist æ˜¯å‹ç¼©åˆ—è¡¨ï¼Œå®ƒçš„å¥½å¤„æ˜¯èƒ½èŠ‚çœå†…å­˜ç©ºé—´ï¼Œå› ä¸ºå®ƒæ‰€å­˜å‚¨çš„å†…å®¹éƒ½æ˜¯åœ¨è¿ç»­çš„å†…å­˜åŒºåŸŸå½“ä¸­çš„ã€‚å½“åˆ—è¡¨å¯¹è±¡å…ƒç´ ä¸å¤§ï¼Œæ¯ä¸ªå…ƒç´ ä¹Ÿä¸å¤§çš„æ—¶å€™ï¼Œå°±é‡‡ç”¨ ziplist å­˜å‚¨ã€‚ä½†å½“æ•°æ®é‡è¿‡å¤§æ—¶å°± ziplist å°±ä¸æ˜¯é‚£ä¹ˆå¥½ç”¨äº†ã€‚å› ä¸ºä¸ºäº†ä¿è¯ä»–å­˜å‚¨å†…å®¹åœ¨å†…å­˜ä¸­çš„è¿ç»­æ€§ï¼Œæ’å…¥çš„å¤æ‚åº¦æ˜¯ O(N)ï¼Œå³æ¯æ¬¡æ’å…¥éƒ½ä¼šé‡æ–°è¿›è¡Œ realloc é‡æ–°åˆ†é…å†…å­˜ç©ºé—´ã€‚</p>\n<p>ziplist ç»“æ„å¦‚ä¸‹ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650419709341.png\" alt=\"ziplist ç»“æ„å›¾\"></p>\n<p>1ã€zlbytesï¼šç”¨äºè®°å½•æ•´ä¸ªå‹ç¼©åˆ—è¡¨å ç”¨å­—èŠ‚æ•°</p>\n<p>2ã€zltailï¼šè®°å½•è¦åˆ—è¡¨å°¾èŠ‚ç‚¹è·ç¦»å‹ç¼©åˆ—è¡¨çš„èµ·å§‹åœ°å€æœ‰å¤šå°‘å­—èŠ‚ï¼Œç”¨äºå¿«é€Ÿå®šä½åˆ°æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œä»è€Œå¯ä»¥åœ¨ ziplist å°¾éƒ¨å¿«é€Ÿçš„æ‰§è¡Œ pushï¼Œpop æ“ä½œ</p>\n<p>3ã€zllenï¼šè®°å½•äº†å‹ç¼©åˆ—è¡¨åŒ…å«çš„èŠ‚ç‚¹æ•°é‡ã€‚</p>\n<p>4ã€entryXï¼šå‹ç¼©åˆ—è¡¨åŒ…å«çš„å„ä¸ªèŠ‚ç‚¹</p>\n<p>5ã€zlendï¼šç”¨äºæ ‡è®°å‹ç¼©åˆ—è¡¨çš„æœ«ç«¯ï¼Œç”¨æ¥å¿«é€Ÿå®šä½åˆ°æœ€åä¸€ä¸ªå…ƒç´ ï¼Œç„¶åå€’ç€éå†ã€‚ï¼ˆentry å—çš„ prevlen å­—æ®µè¡¨ç¤ºå‰ä¸€ä¸ª entry çš„å­—èŠ‚é•¿åº¦ï¼Œå½“å‹ç¼©åˆ—è¡¨å€’ç€éå†æ—¶ï¼Œéœ€è¦é€šè¿‡è¿™ä¸ªå­—æ®µæ¥å¿«é€Ÿå®šä½åˆ°ä¸‹ä¸€ä¸ªå…ƒç´ çš„ä½ç½®ã€‚ï¼‰</p>\n<p><strong>ä¸ºä»€ä¹ˆæ•°æ®é‡å¤§æ—¶ä¸ç”¨ ziplistï¼Ÿ</strong></p>\n<p>å› ä¸º ziplist æ˜¯ä¸€æ®µè¿ç»­çš„å†…å­˜ï¼Œæ’å…¥çš„æ—¶é—´å¤æ‚åŒ–åº¦ä¸º O(n)ï¼Œè€Œä¸”æ¯å½“æ’å…¥æ–°çš„å…ƒç´ éœ€è¦ realloc åšå†…å­˜æ‰©å±•ï¼›è€Œä¸”å¦‚æœè¶…å‡º ziplist å†…å­˜å¤§å°ï¼Œè¿˜ä¼šåšé‡æ–°åˆ†é…çš„å†…å­˜ç©ºé—´ï¼Œå¹¶å°†å†…å®¹å¤åˆ¶åˆ°æ–°çš„åœ°å€ã€‚å¦‚æœæ•°é‡å¤§çš„è¯ï¼Œé‡æ–°åˆ†é…å†…å­˜å’Œæ‹·è´å†…å­˜ä¼šæ¶ˆè€—å¤§é‡æ—¶é—´ã€‚æ‰€ä»¥ä¸é€‚åˆå¤§å‹å­—ç¬¦ä¸²ï¼Œä¹Ÿä¸é€‚åˆå­˜å‚¨é‡å¤šçš„å…ƒç´ ã€‚</p>\n<h4 id=\"quickList\"><a href=\"#quickList\" class=\"headerlink\" title=\"quickList\"></a>quickList</h4><p>å¿«é€Ÿåˆ—è¡¨æ˜¯ ziplist å’Œ linkedlist çš„æ··åˆä½“ï¼Œæ˜¯å°† linkedlist æŒ‰æ®µåˆ‡åˆ†ï¼Œæ¯ä¸€æ®µç”¨ ziplist æ¥ç´§å‡‘å­˜å‚¨ï¼Œå¤šä¸ª ziplist ä¹‹é—´ä½¿ç”¨åŒå‘æŒ‡é’ˆé“¾æ¥ã€‚</p>\n<p><strong>ä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨ linkedlistï¼Ÿ</strong></p>\n<p>linkedlist çš„é™„åŠ ç©ºé—´ç›¸å¯¹å¤ªé«˜ï¼Œprev å’Œ next æŒ‡é’ˆå°±è¦å å» 16 ä¸ªå­—èŠ‚ï¼Œè€Œä¸”æ¯ä¸€ä¸ªç»“ç‚¹éƒ½æ˜¯å•ç‹¬åˆ†é…ï¼Œä¼šåŠ å‰§å†…å­˜çš„ç¢ç‰‡åŒ–ï¼Œå½±å“å†…å­˜ç®¡ç†æ•ˆç‡ã€‚</p>\n<p>quicklist ç»“æ„å›¾å¦‚ä¸‹ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650419719663.png\" alt=\"quicklist ç»“æ„å›¾\"></p>\n<p><strong>ziplistçš„é•¿åº¦</strong></p>\n<p>quicklist å†…éƒ¨é»˜è®¤å•ä¸ª ziplist é•¿åº¦ä¸º 8k å­—èŠ‚ï¼Œè¶…å‡ºäº†è¿™ä¸ªå­—èŠ‚æ•°ï¼Œå°±ä¼šæ–°èµ·ä¸€ä¸ª ziplistã€‚å…³äºé•¿åº¦å¯ä»¥ä½¿ç”¨ list-max-ziplist-size å†³å®šã€‚</p>\n<p><strong>å‹ç¼©æ·±åº¦</strong></p>\n<p>æˆ‘ä»¬ä¸Šé¢è¯´åˆ°äº† quicklist ä¸‹æ˜¯ç”¨å¤šä¸ª ziplist ç»„æˆçš„ï¼ŒåŒæ—¶ä¸ºäº†è¿›ä¸€æ­¥èŠ‚çº¦ç©ºé—´ï¼ŒRedis è¿˜ä¼šå¯¹ ziplist è¿›è¡Œå‹ç¼©å­˜å‚¨ï¼Œä½¿ç”¨ LZF ç®—æ³•å‹ç¼©ï¼Œå¯ä»¥é€‰æ‹©å‹ç¼©æ·±åº¦ã€‚quicklist é»˜è®¤çš„å‹ç¼©æ·±åº¦æ˜¯ 0ï¼Œä¹Ÿå°±æ˜¯ä¸å‹ç¼©ã€‚å‹ç¼©çš„å®é™…æ·±åº¦ç”±é…ç½®å‚æ•° list-compress-depth å†³å®šã€‚ä¸ºäº†æ”¯æŒå¿«é€Ÿ push&#x2F;pop æ“ä½œï¼Œquicklist çš„é¦–å°¾ä¸¤ä¸ª ziplist ä¸å‹ç¼©ï¼Œæ­¤æ—¶æ·±åº¦å°±æ˜¯ 1ã€‚å¦‚æœæ·±åº¦ä¸º 2ï¼Œå°±è¡¨ç¤º quicklist çš„é¦–å°¾ç¬¬ä¸€ä¸ª ziplist ä»¥åŠé¦–å°¾ç¬¬äºŒä¸ª ziplist éƒ½ä¸å‹ç¼©ã€‚</p>\n<h3 id=\"Hash-ziplist-dict\"><a href=\"#Hash-ziplist-dict\" class=\"headerlink\" title=\"Hash (ziplist - dict)\"></a>Hash (ziplist - dict)</h3><h4 id=\"ziplist-1\"><a href=\"#ziplist-1\" class=\"headerlink\" title=\"ziplist\"></a>ziplist</h4><p>å½“ Hash ä¸­æ•°æ®é¡¹æ¯”è¾ƒå°‘çš„æƒ…å†µä¸‹ï¼ŒHash åº•å±‚æ‰ç”¨å‹ç¼©åˆ—è¡¨ ziplist è¿›è¡Œå­˜å‚¨æ•°æ®ï¼Œéšç€æ•°æ®çš„å¢åŠ ï¼Œåº•å±‚çš„ ziplist å°±å¯èƒ½ä¼šè½¬æˆ dictï¼Œå…·ä½“é…ç½®å¦‚ä¸‹</p>\n<blockquote>\n<p>hash-max-ziplist-entries 512<br>hash-max-ziplist-value 64</p>\n</blockquote>\n<p>åœ¨å¦‚ä¸‹ä¸¤ä¸ªæ¡ä»¶ä¹‹ä¸€æ»¡è¶³çš„æ—¶å€™ï¼Œziplist ä¼šè½¬æˆ dictï¼š</p>\n<ul>\n<li>å½“ hash ä¸­çš„æ•°æ®é¡¹çš„æ•°ç›®è¶…è¿‡ 512 çš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯ ziplist æ•°æ®é¡¹è¶…è¿‡ 1024 çš„æ—¶å€™ï¼›</li>\n<li>å½“ hash ä¸­æ’å…¥çš„ä»»æ„ä¸€ä¸ª value çš„é•¿åº¦è¶…è¿‡äº† 64 çš„æ—¶å€™ã€‚</li>\n</ul>\n<p>æ¯å½“æœ‰æ–°çš„é”®å€¼å¯¹åŠ å…¥åˆ°å“ˆå¸Œå¯¹è±¡æ—¶ï¼Œå…ˆå‹å…¥é”®ï¼Œå†å‹å…¥å€¼ï¼Œå¦‚å›¾ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/20190703171927309.png\" alt=\"ziplistå®ç°çš„hash\"></p>\n<p>å½“éå†æ—¶ï¼Œä»å¤´åˆ°å°¾çš„éå†ï¼Œä¸”è·³è¿‡å€¼èŠ‚ç‚¹ã€‚</p>\n<h4 id=\"dict\"><a href=\"#dict\" class=\"headerlink\" title=\"dict\"></a>dict</h4><p>å­—å…¸çš„å“ˆå¸Œè¡¨ç»“æ„å’Œ Java çš„ HashMap ç»“æ„å‡ ä¹æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯é€šè¿‡æŸä¸ªå“ˆå¸Œå‡½æ•°ä» key è®¡ç®—å¾—åˆ°åœ¨å“ˆå¸Œè¡¨ä¸­çš„ä½ç½®ï¼Œé‡‡ç”¨é“¾è¡¨æ³•è§£å†³å†²çªã€‚Redis è¿™é‡Œä½¿ç”¨çš„æ˜¯å•é“¾è¡¨ï¼Œä¸ºäº†æŸ¥è¯¢æ•ˆç‡æ¯æ¬¡æŠŠæ–°æ•°æ®æ’å…¥åˆ°é“¾è¡¨å¤´ä½ç½®ï¼ˆä½¿ç”¨å¤´æ’æ³•æ˜¯å› ä¸ºæ–°æ’å…¥çš„æ•°æ®è¢«è®¿é—®çš„æ¦‚ç‡å¤§ï¼Œå¯ä»¥æ›´å¿«è®¿é—®åˆ°ï¼‰ã€‚</p>\n<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¯ä¸ª dict ä¸­éƒ½æœ‰ä¸¤ä¸ª hashtableï¼Œç»“æ„å›¾å¦‚ä¸‹ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650420119549.png\" alt=\"dictå®ç°çš„hash\"></p>\n<p>è™½ç„¶ dict ç»“æ„æœ‰ä¸¤ä¸ª hashtableï¼Œä½†æ˜¯é€šå¸¸æƒ…å†µä¸‹åªæœ‰ä¸€ä¸ª hashtable æ˜¯æœ‰å€¼çš„ã€‚ä½†æ˜¯åœ¨ dict æ‰©å®¹ç¼©å®¹çš„æ—¶å€™ï¼Œéœ€è¦åˆ†é…æ–°çš„ hashtableï¼Œç„¶åè¿›è¡Œæ¸è¿‘å¼æ¬è¿ï¼Œè¿™æ—¶å€™ä¸¤ä¸ª hashtable å­˜å‚¨çš„æ—§çš„ hashtable å’Œæ–°çš„ hashtableã€‚æ¬è¿ç»“æŸåï¼Œæ—§ hashtable åˆ é™¤ï¼Œæ–°çš„å–è€Œä»£ä¹‹ã€‚</p>\n<p><strong>æ¸è¿›å¼ rehash</strong></p>\n<p>æ‰€è°“æ¸è¿›å¼ rehash æ˜¯æŒ‡æˆ‘ä»¬çš„å¤§å­—å…¸çš„æ‰©å®¹æ˜¯æ¯”è¾ƒæ¶ˆè€—æ—¶é—´çš„ï¼Œéœ€è¦é‡æ–°ç”³è¯·æ–°çš„æ•°ç»„ï¼Œç„¶åå°†æ—§å­—å…¸æ‰€æœ‰é“¾è¡¨çš„å…ƒç´ é‡æ–°æŒ‚æ¥åˆ°æ–°çš„æ•°ç»„ä¸‹é¢ï¼Œæ˜¯ä¸€ä¸ª O(n)çš„æ“ä½œã€‚ä½†æ˜¯å› ä¸ºæˆ‘ä»¬çš„ Redis æ˜¯å•çº¿ç¨‹çš„ï¼Œæ— æ³•æ‰¿å—è¿™æ ·çš„è€—æ—¶è¿‡ç¨‹ï¼Œæ‰€ä»¥é‡‡ç”¨äº†æ¸è¿›å¼ rehash å°æ­¥æ¬è¿ï¼Œè™½ç„¶æ…¢ä¸€ç‚¹ï¼Œä½†æ˜¯å¯ä»¥æ¬è¿å®Œæ¯•ã€‚</p>\n<p><strong>æ‰©å®¹æ¡ä»¶</strong></p>\n<p>æˆ‘ä»¬çš„æ‰©å®¹ä¸€èˆ¬ä¼šåœ¨ Hash è¡¨ä¸­çš„å…ƒç´ ä¸ªæ•°ç­‰äºç¬¬ä¸€ç»´æ•°ç»„çš„é•¿åº¦çš„æ—¶å€™ï¼Œå°±ä¼šå¼€å§‹æ‰©å®¹ã€‚æ‰©å®¹çš„å¤§å°æ˜¯åŸæ•°ç»„çš„ä¸¤å€ã€‚ä¸è¿‡åœ¨ Redis åœ¨åš bgsaveï¼ˆRDB æŒä¹…åŒ–æ“ä½œçš„è¿‡ç¨‹ï¼‰ï¼Œä¸ºäº†å‡å°‘å†…å­˜é¡µçš„è¿‡å¤šåˆ†ç¦»ï¼ˆCopy On Writeï¼‰ï¼ŒRedis ä¸ä¼šå»æ‰©å®¹ã€‚ä½†æ˜¯å¦‚æœ hash è¡¨çš„å…ƒç´ ä¸ªæ•°å·²ç»åˆ°è¾¾äº†ç¬¬ä¸€ç»´æ•°ç»„é•¿åº¦çš„ 5 å€çš„æ—¶å€™ï¼Œå°±ä¼šå¼ºåˆ¶æ‰©å®¹ï¼Œä¸ç®¡ä½ æ˜¯å¦åœ¨æŒä¹…åŒ–ã€‚</p>\n<p>ä¸æ‰©å®¹ä¸»è¦æ˜¯ä¸ºäº†å°½å¯èƒ½å‡å°‘å†…å­˜é¡µè¿‡å¤šåˆ†ç¦»ï¼Œç³»ç»Ÿéœ€è¦æ›´å¤šçš„å¼€é”€å»å›æ”¶å†…å­˜ã€‚</p>\n<p><strong>ç¼©å®¹æ¡ä»¶</strong></p>\n<p>å½“æˆ‘ä»¬çš„ hash è¡¨å…ƒç´ é€æ¸åˆ é™¤çš„è¶Šæ¥è¶Šå°‘çš„æ—¶å€™ã€‚Redis äºæ˜¯å°±ä¼šå¯¹ hash è¡¨è¿›è¡Œç¼©å®¹æ¥å‡å°‘ç¬¬ä¸€ç»´æ•°ç»„é•¿åº¦çš„ç©ºé—´å ç”¨ã€‚ç¼©å®¹çš„æ¡ä»¶æ˜¯å…ƒç´ ä¸ªæ•°ä½äºæ•°ç»„é•¿åº¦çš„ 10%ï¼Œå¹¶ä¸”ç¼©å®¹ä¸è€ƒè™‘æ˜¯å¦åœ¨åš Redis æŒä¹…åŒ–ã€‚</p>\n<p>ä¸ç”¨è€ƒè™‘ bgsave ä¸»è¦æ˜¯å› ä¸ºæˆ‘ä»¬çš„ç¼©å®¹çš„å†…å­˜éƒ½æ˜¯å·²ç»ä½¿ç”¨è¿‡çš„ï¼Œç¼©å®¹çš„æ—¶å€™å¯ä»¥ç›´æ¥ç½®ç©ºï¼Œè€Œä¸”ç”±äºç”³è¯·çš„å†…å­˜æ¯”è¾ƒå°ï¼ŒåŒæ—¶ä¼šé‡Šæ”¾æ‰ä¸€äº›å·²ç»ä½¿ç”¨çš„å†…å­˜ï¼Œä¸ä¼šå¢å¤§ç³»ç»Ÿçš„å‹åŠ›ã€‚</p>\n<p><strong>rehash æ­¥éª¤</strong></p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650420130964.png\" alt=\"rehash æ­¥éª¤\"></p>\n<h3 id=\"Set-intset-hashSet\"><a href=\"#Set-intset-hashSet\" class=\"headerlink\" title=\"Set (intset - hashSet)\"></a>Set (intset - hashSet)</h3><p>Redis çš„é›†åˆç›¸å½“äº Java ä¸­çš„ HashSetï¼Œå®ƒå†…éƒ¨çš„é”®å€¼å¯¹æ˜¯æ— åºã€å”¯ä¸€çš„ã€‚å®ƒçš„å†…éƒ¨å®ç°ç›¸å½“äºä¸€ä¸ªç‰¹æ®Šçš„å­—å…¸ï¼Œå­—å…¸ä¸­æ‰€æœ‰çš„ value éƒ½æ˜¯ä¸€ä¸ªå€¼ NULLã€‚é›†åˆ Set ç±»å‹åº•å±‚ç¼–ç åŒ…æ‹¬ inset å’Œ hashtableã€‚</p>\n<p>å½“å­˜å‚¨çš„æ•°æ®åŒæ—¶æ»¡è¶³ä¸‹é¢è¿™æ ·ä¸¤ä¸ªæ¡ä»¶çš„æ—¶å€™ï¼ŒRedis å°±é‡‡ç”¨æ•´æ•°é›†åˆ intset æ¥å®ç° set è¿™ç§æ•°æ®ç±»å‹ï¼š</p>\n<blockquote>\n<p>å­˜å‚¨çš„æ•°æ®éƒ½æ˜¯æ•´æ•°<br>å­˜å‚¨çš„æ•°æ®å…ƒç´ ä¸ªæ•°å°äº512ä¸ª</p>\n</blockquote>\n<p>å½“ä¸èƒ½åŒæ—¶æ»¡è¶³è¿™ä¸¤ä¸ªæ¡ä»¶çš„æ—¶å€™ï¼ŒRedis å°±ä½¿ç”¨ dict æ¥å­˜å‚¨é›†åˆä¸­çš„æ•°æ®</p>\n<p><strong>intset</strong></p>\n<p>intset æ˜¯ä¸€ä¸ªæœ‰åºé›†åˆï¼ŒæŸ¥æ‰¾å…ƒç´ çš„å¤æ‚åº¦ä¸º O(logN)ï¼ˆé‡‡ç”¨äºŒåˆ†æ³•ï¼‰ï¼Œä½†æ’å…¥æ—¶ä¸ä¸€å®šä¸º O(logN)ï¼Œå› ä¸ºæœ‰å¯èƒ½æ¶‰åŠåˆ°å‡çº§æ“ä½œã€‚æ¯”å¦‚å½“é›†åˆé‡Œå…¨æ˜¯ int16_t å‹çš„æ•´æ•°ï¼Œè¿™æ—¶è¦æ’å…¥ä¸€ä¸ª int32_tï¼Œé‚£ä¹ˆä¸ºäº†ç»´æŒé›†åˆä¸­æ•°æ®ç±»å‹çš„ä¸€è‡´ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„æ•°æ®éƒ½ä¼šè¢«è½¬æ¢æˆ int32_t ç±»å‹ï¼Œæ¶‰åŠåˆ°å†…å­˜çš„é‡æ–°åˆ†é…ï¼Œè¿™æ—¶æ’å…¥çš„å¤æ‚åº¦å°±ä¸º O(N)äº†ã€‚æ˜¯ intset ä¸æ”¯æŒé™çº§æ“ä½œã€‚</p>\n<p><strong>intset æ˜¯æœ‰åºä¸è¦å’Œ zset ææ··ï¼Œzset æ˜¯è®¾ç½®ä¸€ä¸ª score æ¥è¿›è¡Œæ’åºï¼Œè€Œ intset è¿™é‡Œåªæ˜¯å•çº¯çš„å¯¹æ•´æ•°è¿›è¡Œå‡åºè€Œå·²</strong></p>\n<h3 id=\"Sorted-Set-ziplist-zset-dict-skipList\"><a href=\"#Sorted-Set-ziplist-zset-dict-skipList\" class=\"headerlink\" title=\"Sorted Set (ziplist - zset(dict + skipList))\"></a>Sorted Set (ziplist - zset(dict + skipList))</h3><p>Zset æœ‰åºé›†åˆå’Œ set é›†åˆæœ‰ç€å¿…ç„¶çš„è”ç³»ï¼Œä»–ä¿ç•™äº†é›†åˆä¸èƒ½æœ‰é‡å¤æˆå‘˜çš„ç‰¹æ€§ï¼Œä½†ä¸åŒçš„æ˜¯ï¼Œæœ‰åºé›†åˆä¸­çš„å…ƒç´ æ˜¯å¯ä»¥æ’åºçš„ï¼Œä½†æ˜¯å®ƒå’Œåˆ—è¡¨çš„ä½¿ç”¨ç´¢å¼•ä¸‹æ ‡ä½œä¸ºæ’åºä¾æ®ä¸åŒçš„æ˜¯ï¼Œå®ƒç»™æ¯ä¸ªå…ƒç´ è®¾ç½®ä¸€ä¸ªåˆ†æ•° scoreï¼Œä½œä¸ºæ’åºçš„ä¾æ®ã€‚</p>\n<p>å½“æ•°æ®è¾ƒå°‘æ—¶ï¼Œsorted set æ˜¯ç”± ziplist æ¥å®ç°çš„ã€‚<br>å½“æ•°æ®å¤šçš„æ—¶å€™ï¼Œsorted set æ˜¯ç”± zset çš„æ•°æ®ç»“æ„æ¥å®ç°çš„ï¼Œè¿™ä¸ª zset åŒ…å«ä¸€ä¸ª dict + ä¸€ä¸ª skiplistã€‚dict ç”¨æ¥æŸ¥è¯¢æ•°æ®åˆ°åˆ†æ•°(score)çš„å¯¹åº”å…³ç³»ï¼Œè€Œ skiplist ç”¨æ¥æ ¹æ®æŒ‡å®šåˆ†æ•° score çš„èŒƒå›´æ¥è·å– value åˆ—è¡¨ã€‚</p>\n<p><strong>sorted set ziplist å®ç°</strong></p>\n<p>åœ¨è¿™é‡Œæˆ‘ä»¬å…ˆæ¥è®¨è®ºä¸€ä¸‹å‰ä¸€ç§æƒ…å†µâ€”â€”åŸºäº ziplist å®ç°çš„ sorted setã€‚ziplist å°±æ˜¯ç”±å¾ˆå¤šæ•°æ®é¡¹ç»„æˆçš„ä¸€å¤§å—è¿ç»­å†…å­˜ã€‚ç”±äº sorted set çš„æ¯ä¸€é¡¹å…ƒç´ éƒ½ç”±æ•°æ®å’Œ score ç»„æˆï¼Œå› æ­¤ï¼Œå½“ä½¿ç”¨ zadd å‘½ä»¤æ’å…¥ä¸€ä¸ª(æ•°æ®, score)å¯¹çš„æ—¶å€™ï¼Œåº•å±‚åœ¨ç›¸åº”çš„ ziplist ä¸Šå°±æ’å…¥ä¸¤ä¸ªæ•°æ®é¡¹ï¼šæ•°æ®åœ¨å‰ï¼Œscore åœ¨åã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650431975904.png\" alt=\"åŸºäº ziplist å®ç°çš„ sorted set\"></p>\n<p>ziplist çš„ä¸»è¦ä¼˜ç‚¹æ˜¯èŠ‚çœå†…å­˜ï¼Œä½†å®ƒä¸Šé¢çš„æŸ¥æ‰¾æ“ä½œåªèƒ½æŒ‰é¡ºåºæŸ¥æ‰¾ï¼ˆå¯ä»¥æ­£åºä¹Ÿå¯ä»¥å€’åºï¼‰ã€‚å› æ­¤ï¼Œsorted set çš„å„ä¸ªæŸ¥è¯¢æ“ä½œï¼Œå°±æ˜¯åœ¨ ziplist ä¸Šä»å‰å‘åï¼ˆæˆ–ä»åå‘å‰ï¼‰ä¸€æ­¥æ­¥æŸ¥æ‰¾ï¼Œæ¯ä¸€æ­¥å‰è¿›ä¸¤ä¸ªæ•°æ®é¡¹ï¼Œè·¨åŸŸä¸€ä¸ª(æ•°æ®, score)å¯¹ã€‚</p>\n<p>éšç€æ•°æ®çš„æ’å…¥ï¼Œsorted set åº•å±‚çš„è¿™ä¸ª ziplist å°±å¯èƒ½ä¼šè½¬æˆ zset çš„å®ç°ã€‚é‚£ä¹ˆåˆ°åº•æ’å…¥å¤šå°‘æ‰ä¼šè½¬å‘¢ï¼Ÿ</p>\n<blockquote>\n<p>zset-max-ziplist-entries 128\t# å½“sorted setä¸­çš„å…ƒç´ ä¸ªæ•°ï¼Œå³(æ•°æ®ï¼Œ score)å¯¹çš„æ•°ç›®è¶…è¿‡128çš„æ—¶å€™<br>zset-max-ziplist-value 64\t# å½“sorted setä¸­æ’å…¥çš„ä»»æ„ä¸€ä¸ªæ•°æ®çš„é•¿åº¦è¶…è¿‡äº†64çš„æ—¶å€™ã€‚</p>\n</blockquote>\n<p><strong>sorted set ziplistå®ç°</strong><br>Redis çš„ zset æ˜¯ä¸€ä¸ªå¤åˆç»“æ„ï¼Œä¸€æ–¹é¢å®ƒéœ€è¦ä¸€ä¸ª hash ç»“æ„æ¥å­˜å‚¨ value å’Œ score çš„å¯¹åº”å…³ç³»ï¼Œå¦ä¸€æ–¹é¢éœ€è¦æä¾›æŒ‰ç…§ score æ¥æ’åºçš„åŠŸèƒ½ï¼Œè¿˜éœ€è¦èƒ½å¤ŸæŒ‡å®š score çš„èŒƒå›´æ¥è·å– value åˆ—è¡¨çš„åŠŸèƒ½ï¼Œè¿™å°±éœ€è¦å¦å¤–ä¸€ä¸ªç»“æ„ã€Œè·³è·ƒè¡¨ã€ã€‚</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">zset</span> &#123;</span></span><br><span class=\"line\">    dict *dict;</span><br><span class=\"line\">    zskiplist *zsl;</span><br><span class=\"line\">&#125; zset;</span><br></pre></td></tr></table></figure>\n\n<p>è·³è¡¨ï¼šé“¾è¡¨+å¤šçº§ç´¢å¼•ï¼ˆç©ºé—´æ¢æ—¶é—´ï¼‰</p>\n<p>å’Œå…¶ä»–ç»“æ„çš„æ¯”è¾ƒï¼š</p>\n<p>å¯¹äºæœ‰åºé›†åˆçš„åº•å±‚å®ç°ï¼Œå¯ä»¥ç”¨æ•°ç»„ã€å¹³è¡¡æ ‘ã€é“¾è¡¨ç­‰ã€‚æ•°ç»„ä¸ä¾¿å…ƒç´ çš„æ’å…¥ã€åˆ é™¤ï¼›å¹³è¡¡æ ‘æˆ–çº¢é»‘æ ‘è™½ç„¶æ•ˆç‡é«˜ä½†ç»“æ„å¤æ‚ï¼›é“¾è¡¨æŸ¥è¯¢éœ€è¦éå†æ‰€æœ‰æ•ˆç‡ä½ã€‚Redis é‡‡ç”¨çš„æ˜¯è·³è·ƒè¡¨ã€‚è·³è·ƒè¡¨æ•ˆç‡å ªæ¯”çº¢é»‘æ ‘ï¼Œå®ç°è¿œæ¯”çº¢é»‘æ ‘ç®€å•ã€‚</p>\n<hr>\n<h2 id=\"ä¸‰å¤§ç‰¹æ®Šæ•°æ®ç±»å‹\"><a href=\"#ä¸‰å¤§ç‰¹æ®Šæ•°æ®ç±»å‹\" class=\"headerlink\" title=\"ä¸‰å¤§ç‰¹æ®Šæ•°æ®ç±»å‹\"></a>ä¸‰å¤§ç‰¹æ®Šæ•°æ®ç±»å‹</h2><h3 id=\"geospatialï¼ˆåœ°ç†ä½ç½®ï¼‰\"><a href=\"#geospatialï¼ˆåœ°ç†ä½ç½®ï¼‰\" class=\"headerlink\" title=\"geospatialï¼ˆåœ°ç†ä½ç½®ï¼‰\"></a>geospatialï¼ˆåœ°ç†ä½ç½®ï¼‰</h3><ol>\n<li>æŸ¥çœ‹é™„è¿‘çš„äºº</li>\n<li>å¾®ä¿¡ä½ç½®å…±äº«</li>\n<li>åœ°å›¾ä¸Šç›´çº¿è·ç¦»çš„å±•ç¤º</li>\n</ol>\n<h3 id=\"Hyperloglogï¼ˆåŸºæ•°ï¼‰\"><a href=\"#Hyperloglogï¼ˆåŸºæ•°ï¼‰\" class=\"headerlink\" title=\"Hyperloglogï¼ˆåŸºæ•°ï¼‰\"></a>Hyperloglogï¼ˆåŸºæ•°ï¼‰</h3><p>åŸºæ•°ï¼šä¸é‡å¤çš„å…ƒç´ </p>\n<p>ç½‘é¡µç»Ÿè®¡ UV ï¼ˆæµè§ˆç”¨æˆ·æ•°é‡ï¼ŒåŒä¸€å¤©åŒä¸€ä¸ª ip å¤šæ¬¡è®¿é—®ç®—ä¸€æ¬¡è®¿é—®ï¼Œç›®çš„æ˜¯è®¡æ•°ï¼Œè€Œä¸æ˜¯ä¿å­˜ç”¨æˆ·ï¼‰</p>\n<p>ä¼ ç»Ÿçš„æ–¹å¼ï¼Œset ä¿å­˜ç”¨æˆ·çš„ idï¼Œå¯ä»¥ç»Ÿè®¡ set ä¸­å…ƒç´ æ•°é‡ä½œä¸ºæ ‡å‡†åˆ¤æ–­ã€‚</p>\n<p>ä½†å¦‚æœè¿™ç§æ–¹å¼ä¿å­˜å¤§é‡ç”¨æˆ· idï¼Œä¼šå ç”¨å¤§é‡å†…å­˜ï¼Œæˆ‘ä»¬çš„ç›®çš„æ˜¯ä¸ºäº†è®¡æ•°ï¼Œè€Œä¸æ˜¯å»ä¿å­˜ idã€‚</p>\n<h3 id=\"Bitmapsï¼ˆä½å­˜å‚¨ï¼‰\"><a href=\"#Bitmapsï¼ˆä½å­˜å‚¨ï¼‰\" class=\"headerlink\" title=\"Bitmapsï¼ˆä½å­˜å‚¨ï¼‰\"></a>Bitmapsï¼ˆä½å­˜å‚¨ï¼‰</h3><p>Redis æä¾›äº† Bitmaps è¿™ä¸ªâ€œæ•°æ®ç±»å‹â€å¯ä»¥å®ç°å¯¹ä½çš„æ“ä½œï¼š</p>\n<ol>\n<li>Bitmaps æœ¬èº«ä¸æ˜¯ä¸€ç§æ•°æ®ç±»å‹ï¼Œ å®é™…ä¸Šå®ƒå°±æ˜¯å­—ç¬¦ä¸²ï¼ˆkey-valueï¼‰ ï¼Œ ä½†æ˜¯å®ƒå¯ä»¥å¯¹å­—ç¬¦ä¸²çš„ä½è¿›è¡Œæ“ä½œã€‚</li>\n<li>Bitmaps å•ç‹¬æä¾›äº†ä¸€å¥—å‘½ä»¤ï¼Œ æ‰€ä»¥åœ¨ Redis ä¸­ä½¿ç”¨ Bitmaps å’Œä½¿ç”¨å­—ç¬¦ä¸²çš„æ–¹æ³•ä¸å¤ªç›¸åŒã€‚ å¯ä»¥æŠŠ Bitmaps æƒ³è±¡æˆä¸€ä¸ªä»¥ä½ä¸ºå•ä½çš„æ•°ç»„ï¼Œ æ•°ç»„çš„æ¯ä¸ªå•å…ƒåªèƒ½å­˜å‚¨ 0 å’Œ 1ï¼Œ æ•°ç»„çš„ä¸‹æ ‡åœ¨ Bitmaps ä¸­å«åšåç§»é‡ã€‚</li>\n</ol>\n<h4 id=\"å‘½ä»¤\"><a href=\"#å‘½ä»¤\" class=\"headerlink\" title=\"å‘½ä»¤\"></a>å‘½ä»¤</h4><ol>\n<li><p>setbit</p>\n<p> <code>setbit&lt;key&gt;&lt;offset&gt;&lt;value&gt;</code> è®¾ç½® Bitmaps ä¸­æŸä¸ªåç§»é‡çš„å€¼ï¼ˆ0 æˆ– 1ï¼‰</p>\n<p> å¯ä»¥å°† idx ä½ç½®ä¸º 1 è¡¨ç¤º idx ç”¨æˆ·è®¿é—®è¿‡</p>\n</li>\n<li><p>getbit</p>\n<p> <code>getbit&lt;key&gt;&lt;offset&gt;</code> è·å– Bitmaps ä¸­æŸä¸ªåç§»é‡çš„å€¼</p>\n<p> é€šè¿‡ idx ä½æ˜¯å¦ä¸º 1 åˆ¤æ–­ idx ç”¨æˆ·æ˜¯å¦è®¿é—®è¿‡</p>\n</li>\n<li><p>bitcount</p>\n<p> <code>bitcount&lt;key&gt;[start end]</code> ç»Ÿè®¡å­—ç¬¦ä¸²ä» start å­—èŠ‚åˆ° end å­—èŠ‚æ¯”ç‰¹å€¼ä¸º 1 çš„æ•°é‡</p>\n</li>\n<li><p>bitop</p>\n<p> <code>bitop and(or/not/xor) &lt;destkey&gt; [keyâ€¦]</code> bitop æ˜¯ä¸€ä¸ªå¤åˆæ“ä½œï¼Œ å®ƒå¯ä»¥åšå¤šä¸ª Bitmaps çš„ andï¼ˆäº¤é›†ï¼‰ ã€ orï¼ˆå¹¶é›†ï¼‰ ã€ notï¼ˆéï¼‰ ã€ xorï¼ˆå¼‚æˆ–ï¼‰ æ“ä½œå¹¶å°†ç»“æœä¿å­˜åœ¨ destkey ä¸­ã€‚</p>\n</li>\n</ol>\n<h4 id=\"åº”ç”¨åœºæ™¯-2\"><a href=\"#åº”ç”¨åœºæ™¯-2\" class=\"headerlink\" title=\"åº”ç”¨åœºæ™¯\"></a><strong>åº”ç”¨åœºæ™¯</strong></h4><p><strong>ä¸¤ç§çŠ¶æ€çš„ç»Ÿè®¡</strong>éƒ½å¯ä»¥ä½¿ç”¨ bitmapsï¼Œä¾‹å¦‚ï¼šç»Ÿè®¡ç”¨æˆ·æ´»è·ƒä¸éæ´»è·ƒæ•°é‡ã€ç™»å½•ä¸éç™»å½•ã€ä¸Šç­æ‰“å¡ç­‰ç­‰ã€‚</p>\n<hr>\n<h2 id=\"Redisäº‹åŠ¡ä¸é”æœºåˆ¶\"><a href=\"#Redisäº‹åŠ¡ä¸é”æœºåˆ¶\" class=\"headerlink\" title=\"Redisäº‹åŠ¡ä¸é”æœºåˆ¶\"></a>Redisäº‹åŠ¡ä¸é”æœºåˆ¶</h2><h3 id=\"äº‹åŠ¡\"><a href=\"#äº‹åŠ¡\" class=\"headerlink\" title=\"äº‹åŠ¡\"></a>äº‹åŠ¡</h3><p>äº‹åŠ¡æœ¬è´¨ï¼šä¸€ç»„å‘½ä»¤çš„é›†åˆ</p>\n<h4 id=\"æ•°æ®åº“çš„äº‹åŠ¡\"><a href=\"#æ•°æ®åº“çš„äº‹åŠ¡\" class=\"headerlink\" title=\"æ•°æ®åº“çš„äº‹åŠ¡\"></a><strong>æ•°æ®åº“çš„äº‹åŠ¡</strong></h4><p>æ•°æ®åº“äº‹åŠ¡é€šè¿‡ ACIDï¼ˆåŸå­æ€§ã€ä¸€è‡´æ€§ã€éš”ç¦»æ€§ã€æŒä¹…æ€§ï¼‰æ¥ä¿è¯ã€‚</p>\n<p>æ•°æ®åº“ä¸­é™¤æŸ¥è¯¢æ“ä½œä»¥å¤–ï¼Œæ’å…¥(Insert)ã€åˆ é™¤(Delete)å’Œæ›´æ–°(Update)è¿™ä¸‰ç§æ“ä½œéƒ½ä¼šå¯¹æ•°æ®é€ æˆå½±å“ï¼Œå› ä¸ºäº‹åŠ¡å¤„ç†èƒ½å¤Ÿä¿è¯ä¸€ç³»åˆ—æ“ä½œå¯ä»¥å®Œå…¨åœ°æ‰§è¡Œæˆ–è€…å®Œå…¨ä¸æ‰§è¡Œï¼Œå› æ­¤åœ¨ä¸€ä¸ªäº‹åŠ¡è¢«æäº¤ä»¥åï¼Œè¯¥äº‹åŠ¡ä¸­çš„ä»»ä½•ä¸€æ¡ SQL è¯­å¥åœ¨è¢«æ‰§è¡Œçš„æ—¶å€™ï¼Œéƒ½ä¼šç”Ÿæˆä¸€æ¡æ’¤é”€æ—¥å¿—(Undo Log)ã€‚</p>\n<h4 id=\"Redis-äº‹åŠ¡\"><a href=\"#Redis-äº‹åŠ¡\" class=\"headerlink\" title=\"Redis äº‹åŠ¡\"></a>Redis äº‹åŠ¡</h4><p>Redis äº‹åŠ¡æä¾›äº†ä¸€ç§â€œå°†å¤šä¸ªå‘½ä»¤æ‰“åŒ…ï¼Œ ç„¶åä¸€æ¬¡æ€§ã€æŒ‰é¡ºåºåœ°æ‰§è¡Œâ€çš„æœºåˆ¶ï¼Œ å¹¶ä¸”äº‹åŠ¡åœ¨æ‰§è¡Œçš„æœŸé—´ä¸ä¼šä¸»åŠ¨ä¸­æ–­ â€”â€” æœåŠ¡å™¨åœ¨æ‰§è¡Œå®Œäº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤ä¹‹åï¼Œ æ‰ä¼šç»§ç»­å¤„ç†å…¶ä»–å®¢æˆ·ç«¯çš„å…¶ä»–å‘½ä»¤ã€‚äº‹åŠ¡ä¸­å¦‚æœæœ‰ä¸€æ¡å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œå…¶åçš„å‘½ä»¤ä»ç„¶ä¼šè¢«æ‰§è¡Œï¼Œæ²¡æœ‰å›æ»šã€‚</p>\n<p>Redis ä¸­ä¸€ä¸ªäº‹åŠ¡ä»å¼€å§‹åˆ°æ‰§è¡Œä¼šç»å†<strong>å¼€å§‹</strong>äº‹åŠ¡ï¼ˆMuitiï¼‰ã€å‘½ä»¤<strong>ç»„é˜Ÿ</strong>å’Œ<strong>æ‰§è¡Œ</strong>äº‹åŠ¡(Exec)ä¸‰ä¸ªé˜¶æ®µï¼Œäº‹åŠ¡ä¸­çš„å‘½ä»¤åœ¨åŠ å…¥æ—¶éƒ½æ²¡æœ‰è¢«æ‰§è¡Œï¼Œç›´åˆ°æäº¤æ—¶æ‰ä¼šå¼€å§‹æ‰§è¡Œ(Exec)ä¸€æ¬¡æ€§å®Œæˆã€‚</p>\n<p>ç»„é˜Ÿçš„è¿‡ç¨‹ä¸­å¯ä»¥é€šè¿‡ discard æ¥æ”¾å¼ƒç»„é˜Ÿã€‚</p>\n<p><strong>äº‹åŠ¡çš„é”™è¯¯å¤„ç†</strong></p>\n<p>ç»„é˜Ÿé˜¶æ®µæŸä¸ªå‘½ä»¤æŠ¥é”™ï¼Œæ‰§è¡Œæ—¶æ•´ä¸ªé˜Ÿåˆ—éƒ½ä¼šè¢«å–æ¶ˆã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650372301056.png\" alt=\"ç»„é˜Ÿé˜¶æ®µæŸä¸ªå‘½ä»¤æŠ¥é”™\"></p>\n<p>å¦‚æœæ‰§è¡Œé˜¶æ®µæŸä¸ªå‘½ä»¤æŠ¥é”™ï¼Œåˆ™åªæœ‰æŠ¥é”™çš„å‘½ä»¤ä¸ä¼šè¢«æ‰§è¡Œï¼Œè€Œå…¶ä»–çš„å‘½ä»¤éƒ½ä¼šæ‰§è¡Œï¼Œä¸ä¼šå›æ»šã€‚ï¼ˆä¸ä¿è¯äº‹åŠ¡çš„åŸå­æ€§ï¼‰</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650372359361.png\" alt=\"æ‰§è¡Œé˜¶æ®µæŸä¸ªå‘½ä»¤æŠ¥é”™\"></p>\n<p><strong>ä¸ºä»€ä¹ˆ Redis ä¸æ”¯æŒå›æ»šæ¥ä¿è¯åŸå­æ€§</strong></p>\n<p>Redis å‘½ä»¤åªä¼šå› ä¸ºé”™è¯¯çš„è¯­æ³•è€Œå¤±è´¥ï¼Œç„¶è€Œæ²¡æœ‰ä»»ä½•æœºåˆ¶èƒ½é¿å…ç¨‹åºå‘˜è‡ªå·±é€ æˆçš„é”™è¯¯ï¼Œ å¹¶ä¸”è¿™ç±»é”™è¯¯é€šå¸¸ä¸ä¼šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­å‡ºç°ï¼Œ æ‰€ä»¥ Redis é€‰æ‹©äº†æ›´ç®€å•ã€æ›´å¿«é€Ÿçš„æ— å›æ»šæ–¹å¼æ¥å¤„ç†äº‹åŠ¡ã€‚</p>\n<h3 id=\"Redis-é”\"><a href=\"#Redis-é”\" class=\"headerlink\" title=\"Redis é”\"></a>Redis é”</h3><h4 id=\"æ‚²è§‚é”\"><a href=\"#æ‚²è§‚é”\" class=\"headerlink\" title=\"æ‚²è§‚é”\"></a>æ‚²è§‚é”</h4><p><strong>æ‚²è§‚é”(Pessimistic Lock)<strong>ï¼Œ é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¾ˆæ‚²è§‚ï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¼šä¿®æ”¹ï¼Œæ‰€ä»¥æ¯æ¬¡åœ¨æ‹¿æ•°æ®çš„æ—¶å€™éƒ½ä¼šä¸Šé”ï¼Œè¿™æ ·åˆ«äººæƒ³æ‹¿è¿™ä¸ªæ•°æ®å°±ä¼šé˜»å¡ç›´åˆ°å®ƒæ‹¿åˆ°é”ã€‚</strong>ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“é‡Œè¾¹å°±ç”¨åˆ°äº†å¾ˆå¤šè¿™ç§é”æœºåˆ¶</strong>ï¼Œæ¯”å¦‚<strong>è¡Œé”</strong>ï¼Œ<strong>è¡¨é”</strong>ç­‰ï¼Œ<strong>è¯»é”</strong>ï¼Œ<strong>å†™é”</strong>ç­‰ï¼Œéƒ½æ˜¯åœ¨åšæ“ä½œä¹‹å‰å…ˆä¸Šé”ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650417157625.png\" alt=\"æ‚²è§‚é”\"></p>\n<blockquote>\n<p>çº¿ç¨‹ 1 æ‹¿åˆ°è´¦æˆ·åæŠŠè´¦æˆ·é”ä½ï¼Œç„¶åæ“ä½œï¼Œè¿™æ—¶å€™çº¿ç¨‹ 2 ä¹Ÿæƒ³æ‹¿è´¦æˆ·ï¼Œå‘ç°åŠ äº†é”æ‹¿ä¸åˆ°ï¼Œåªèƒ½é˜»å¡ç­‰åˆ°é”é‡Šæ”¾ã€‚</p>\n</blockquote>\n<h4 id=\"ä¹è§‚é”\"><a href=\"#ä¹è§‚é”\" class=\"headerlink\" title=\"ä¹è§‚é”\"></a>ä¹è§‚é”</h4><p><strong>ä¹è§‚é”(Optimistic Lock)ï¼Œ</strong> é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¾ˆä¹è§‚ï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¸ä¼šä¿®æ”¹ï¼Œæ‰€ä»¥ä¸ä¼šä¸Šé”ï¼Œä½†æ˜¯åœ¨<strong>æ›´æ–°çš„æ—¶å€™åˆ¤æ–­</strong>ä¸€ä¸‹åœ¨æ­¤æœŸé—´åˆ«äººæœ‰æ²¡æœ‰å»æ›´æ–°è¿™ä¸ªæ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ç‰ˆæœ¬å·ç­‰æœºåˆ¶ã€‚<strong>ä¹è§‚é”é€‚ç”¨äºå¤šè¯»çš„åº”ç”¨ç±»å‹ï¼Œè¿™æ ·å¯ä»¥æé«˜ååé‡</strong>ã€‚Redis å°±æ˜¯åˆ©ç”¨è¿™ç§æœºåˆ¶å®ç°äº‹åŠ¡çš„ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650417222072.png\" alt=\"ä¹è§‚é”\"></p>\n<blockquote>\n<p>ç»™è´¦æˆ·æ•°æ®åŠ ä¸€ä¸ªç‰ˆæœ¬å·ï¼Œå‡å¦‚çº¿ç¨‹ 1ã€2 éƒ½æ‹¿åˆ°è´¦æˆ·ï¼Œçº¿ç¨‹ 1 ä½¿ç”¨è´¦æˆ·å‰å…ˆè¿›è¡Œç‰ˆæœ¬å·æ¯”è¾ƒï¼Œv1.0 &#x3D; v1.0ï¼Œåˆ™æ‰£å‡è´¦æˆ·ä½™é¢ï¼Œè´¦æˆ·ç‰ˆæœ¬å·å˜æ›´ä¸º v1.1ï¼Œçº¿ç¨‹ 2 å‡†å¤‡æ“ä½œæ•°æ®åº“ï¼Œå‘ç°è‡ªå·±é¢„æœŸçš„è´¦æˆ·ç‰ˆæœ¬å· v1.0 å’Œå½“å‰è´¦æˆ·ç‰ˆæœ¬å· v1.1 ä¸åŒï¼ˆCASï¼‰ï¼Œåˆ™ä¸èƒ½æ“ä½œã€‚ </p>\n</blockquote>\n<hr>\n<h2 id=\"RedisæŒä¹…åŒ–\"><a href=\"#RedisæŒä¹…åŒ–\" class=\"headerlink\" title=\"RedisæŒä¹…åŒ–\"></a>RedisæŒä¹…åŒ–</h2><p>Redis æ˜¯ä¸€ç§å†…å­˜å‹æ•°æ®åº“ï¼Œä¸€æ—¦æœåŠ¡å™¨è¿›ç¨‹é€€å‡ºï¼Œæ•°æ®åº“çš„æ•°æ®å°±ä¼šä¸¢å¤±ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ Redis ä¾›äº†ä¸¤ç§æŒä¹…åŒ–çš„æ–¹æ¡ˆï¼Œå°†å†…å­˜ä¸­çš„æ•°æ®ä¿å­˜åˆ°ç£ç›˜ä¸­ï¼Œé¿å…æ•°æ®çš„ä¸¢å¤±ã€‚</p>\n<p>ä¸¤ç§æŒä¹…åŒ–æ–¹å¼ï¼šå¿«ç…§ï¼ˆRDB æ–‡ä»¶ï¼‰å’Œè¿½åŠ å¼æ–‡ä»¶ï¼ˆAOF æ–‡ä»¶ï¼‰ï¼Œä¸‹é¢åˆ†åˆ«ä¸ºå¤§å®¶ä»‹ç»ä¸¤ç§æ–¹å¼çš„åŸç†ã€‚</p>\n<ul>\n<li><p>RDB æŒä¹…åŒ–æ–¹å¼ä¼šåœ¨ä¸€ä¸ªç‰¹å®šçš„é—´éš”ä¿å­˜é‚£ä¸ªæ—¶é—´ç‚¹çš„æ•°æ®å¿«ç…§ã€‚</p>\n</li>\n<li><p>AOF æŒä¹…åŒ–æ–¹å¼åˆ™ä¼šè®°å½•æ¯ä¸€ä¸ªæœåŠ¡å™¨æ”¶åˆ°çš„å†™æ“ä½œã€‚åœ¨æœåŠ¡å¯åŠ¨æ—¶ï¼Œè¿™äº›è®°å½•çš„æ“ä½œä¼šé€æ¡æ‰§è¡Œä»è€Œé‡å»ºå‡ºåŸæ¥çš„æ•°æ®ã€‚å†™æ“ä½œå‘½ä»¤è®°å½•çš„æ ¼å¼è·Ÿ Redis åè®®ä¸€è‡´ï¼Œä»¥è¿½åŠ çš„æ–¹å¼è¿›è¡Œä¿å­˜ã€‚</p>\n</li>\n<li><p>ä¸¤ç§æ–¹å¼çš„æŒä¹…åŒ–æ˜¯å¯ä»¥åŒæ—¶å­˜åœ¨çš„ï¼Œä½†æ˜¯å½“ Redis é‡å¯æ—¶ï¼ŒAOF æ–‡ä»¶ä¼šè¢«ä¼˜å…ˆç”¨äºé‡å»ºæ•°æ®ã€‚</p>\n</li>\n</ul>\n<h3 id=\"RDB-Redis-Database\"><a href=\"#RDB-Redis-Database\" class=\"headerlink\" title=\"RDB(Redis Database)\"></a>RDB(Redis Database)</h3><blockquote>\n<p>åœ¨æ»¡è¶³ç‰¹å®šçš„  Redis æ“ä½œæ¡ä»¶ï¼ˆæ—¶é—´å‘¨æœŸã€å†™æ“ä½œæ¬¡æ•°ï¼‰æ—¶ï¼Œå°†å†…å­˜ä¸­çš„æ•°æ®ä»¥ <strong>æ•°æ®å¿«ç…§</strong> çš„å½¢å¼å­˜å‚¨åˆ° db æ–‡ä»¶ä¸­</p>\n</blockquote>\n<h4 id=\"å·¥ä½œåŸç†\"><a href=\"#å·¥ä½œåŸç†\" class=\"headerlink\" title=\"å·¥ä½œåŸç†\"></a><strong>å·¥ä½œåŸç†</strong></h4><blockquote>\n<p><a href=\"https://www.cnblogs.com/zyf98/p/15934058.html\">Redis_RDBæŒä¹…åŒ–ä¹‹å†™æ—¶å¤åˆ¶æŠ€æœ¯çš„åº”ç”¨</a></p>\n</blockquote>\n<p>RDB æ˜¯ä¸€æ¬¡çš„å…¨é‡å¤‡ä»½ï¼Œå³å‘¨æœŸæ€§çš„æŠŠ Redis å½“å‰å†…å­˜ä¸­çš„å…¨é‡æ•°æ®å†™å…¥åˆ°ä¸€ä¸ªå¿«ç…§æ–‡ä»¶ä¸­ã€‚Redis æ˜¯å•çº¿ç¨‹ç¨‹åºï¼Œè¿™ä¸ªçº¿ç¨‹è¦åŒæ—¶è´Ÿè´£å¤šä¸ªå®¢æˆ·ç«¯çš„è¯»å†™è¯·æ±‚ï¼Œè¿˜è¦è´Ÿè´£å‘¨æœŸæ€§çš„æŠŠå½“å‰å†…å­˜ä¸­çš„æ•°æ®å†™åˆ°å¿«ç…§æ–‡ä»¶ä¸­ RDB ä¸­ï¼Œé‚£ä¹ˆå°±ä¼šå¸¦æ¥ä»¥ä¸‹ä¸¤ä¸ªé—®é¢˜ï¼š</p>\n<ol>\n<li>æ•°æ®å†™åˆ° RDB æ–‡ä»¶æ˜¯ IO æ“ä½œï¼ŒIO æ“ä½œä¼šä¸¥é‡å½±å“ Redis çš„æ€§èƒ½ï¼Œç”šè‡³åœ¨æŒä¹…åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œè¯»å†™è¯·æ±‚ä¼šé˜»å¡</li>\n<li>å‡å¦‚ Redis æ­£åœ¨è¿›è¡ŒæŒä¹…åŒ–ä¸€ä¸ªå¤§çš„æ•°æ®ç»“æ„ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªåˆ é™¤è¯·æ±‚ï¼ŒæŠŠè¿™ä¸ªå¤§çš„æ•°æ®ç»“æ„åˆ æ‰äº†ï¼Œè¿™æ—¶å€™æŒä¹…åŒ–çš„åŠ¨ä½œè¿˜æ²¡æœ‰å®Œæˆã€‚</li>\n</ol>\n<p>äºæ˜¯ Redis ä½¿ç”¨æ“ä½œç³»ç»Ÿçš„å¤šè¿›ç¨‹ <strong>å†™æ—¶å¤åˆ¶(Copy On Write)æœºåˆ¶</strong> æ¥å®ç°å¿«ç…§çš„æŒä¹…åŒ–ï¼Œåœ¨æŒä¹…åŒ–è¿‡ç¨‹ä¸­è°ƒç”¨<strong>glibc</strong>(Linux ä¸‹çš„ C å‡½æ•°åº“)çš„å‡½æ•° <strong>fork()</strong> äº§ç”Ÿä¸€ä¸ªå­è¿›ç¨‹ï¼Œè¯¥å­è¿›ç¨‹å’Œçˆ¶è¿›ç¨‹å…±äº«å†…å­˜é‡Œé¢çš„ä»£ç æ®µå’Œæ•°æ®æ®µï¼Œå¿«ç…§æŒä¹…åŒ–å®Œå…¨äº¤ç»™å­è¿›ç¨‹æ¥å¤„ç†ï¼Œçˆ¶è¿›ç¨‹ç»§ç»­å¤„ç†å®¢æˆ·ç«¯çš„è¯»å†™è¯·æ±‚ã€‚</p>\n<blockquote>\n<p>å­è¿›ç¨‹å°†æ•°æ®å†™å…¥åˆ°ä¸€ä¸ªä¸´æ—¶ RDB æ–‡ä»¶ä¸­ã€‚å½“å­è¿›ç¨‹å®ŒæˆæŒä¹…åŒ–æ—¶ï¼ŒRedis ç”¨æ–° RDB æ–‡ä»¶æ›¿æ¢åŸæ¥çš„ RDB æ–‡ä»¶ï¼Œå¹¶åˆ é™¤æ—§çš„ RDB æ–‡ä»¶ã€‚</p>\n</blockquote>\n<p>åœ¨å­è¿›ç¨‹æŒä¹…åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœä¸»è¿›ç¨‹æ”¶åˆ°çš„å®¢æˆ·ç«¯çš„è¯»å†™è¯·æ±‚ï¼Œéœ€è¦ä¿®æ”¹æŸå—æ•°æ®ï¼Œé‚£ä¹ˆè¿™å—æ•°æ®å°±ä¼šè¢«å¤åˆ¶ä¸€ä»½åˆ°å†…å­˜ï¼Œç”Ÿæˆè¯¥æ•°æ®çš„å‰¯æœ¬ï¼Œä¸»è¿›ç¨‹åœ¨è¯¥å‰¯æœ¬ä¸Šè¿›è¡Œä¿®æ”¹æ“ä½œã€‚æ‰€ä»¥å³ä½¿å¯¹æŸä¸ªæ•°æ®è¿›è¡Œäº†ä¿®æ”¹ï¼ŒRedis æŒä¹…åŒ–åˆ° RDB ä¸­çš„æ•°æ®ä¹Ÿæ˜¯æœªä¿®æ”¹çš„æ•°æ®ï¼Œè¿™ä¹Ÿæ˜¯æŠŠ RDB æ–‡ä»¶ç§°ä¸ºâ€å¿«ç…§â€æ–‡ä»¶çš„åŸå› ï¼Œå­è¿›ç¨‹æ‰€çœ‹åˆ°çš„æ•°æ®åœ¨å®ƒè¢«åˆ›å»ºçš„ä¸€ç¬é—´å°±å›ºå®šä¸‹æ¥äº†ï¼Œçˆ¶è¿›ç¨‹ä¿®æ”¹çš„æŸä¸ªæ•°æ®åªæ˜¯è¯¥æ•°æ®çš„å¤åˆ¶å“ã€‚è¿™é‡Œå†æ·±å…¥ä¸€ç‚¹ï¼ŒRedis å†…å­˜ä¸­çš„å…¨é‡æ•°æ®ç”±ä¸€ä¸ªä¸ªçš„â€æ•°æ®æ®µé¡µé¢â€ç»„æˆï¼Œæ¯ä¸ªæ•°æ®æ®µé¡µé¢çš„å¤§å°ä¸º 4Kï¼Œå®¢æˆ·ç«¯è¦ä¿®æ”¹çš„æ•°æ®åœ¨å“ªä¸ªé¡µé¢ä¸­ï¼Œå°±ä¼šå¤åˆ¶ä¸€ä»½è¿™ä¸ªé¡µé¢åˆ°å†…å­˜ä¸­ï¼Œè¿™ä¸ªå¤åˆ¶çš„è¿‡ç¨‹ç§°ä¸ºâ€é¡µé¢åˆ†ç¦»â€ï¼Œåœ¨æŒä¹…åŒ–è¿‡ç¨‹ä¸­ï¼Œéšç€åˆ†ç¦»å‡ºçš„é¡µé¢è¶Šæ¥è¶Šå¤šï¼Œå†…å­˜å°±ä¼šæŒç»­å¢é•¿ï¼Œä½†æ˜¯ä¸ä¼šè¶…è¿‡åŸå†…å­˜çš„ 2 å€ï¼Œå› ä¸ºåœ¨ä¸€æ¬¡æŒä¹…åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œå‡ ä¹ä¸ä¼šå‡ºç°æ‰€æœ‰çš„é¡µé¢éƒ½ä¼šåˆ†ç¦»çš„æƒ…å†µï¼Œè¯»å†™è¯·æ±‚é’ˆå¯¹çš„åªæ˜¯åŸæ•°æ®ä¸­çš„å°éƒ¨åˆ†ï¼Œå¤§éƒ¨åˆ† Redis æ•°æ®è¿˜æ˜¯â€å†·æ•°æ®â€ã€‚</p>\n<p>æ­£å› ä¸ºä¿®æ”¹çš„éƒ¨åˆ†æ•°æ®ä¼šè¢«é¢å¤–çš„å¤åˆ¶ä¸€ä»½ï¼Œæ‰€ä»¥ä¼šå ç”¨é¢å¤–çš„å†…å­˜ï¼Œå½“åœ¨è¿›è¡Œ RDB æŒä¹…åŒ–æ“ä½œçš„è¿‡ç¨‹ä¸­ï¼Œä¸æ­¤åŒæ—¶å¦‚æœæŒç»­å¾€ Redis ä¸­å†™å…¥çš„æ•°æ®é‡è¶Šå¤šï¼Œå°±ä¼šå¯¼è‡´å ç”¨çš„é¢å¤–å†…å­˜æ¶ˆè€—è¶Šå¤§ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes2093494-20220226233822789-2067752089.png\" alt=\"RDB æŒä¹…åŒ–\"></p>\n<p><strong>ä¼˜ç‚¹</strong>ï¼š</p>\n<ol>\n<li>RDB çš„å†…å®¹ä¸ºäºŒè¿›åˆ¶çš„æ•°æ®ï¼Œå ç”¨å†…å­˜æ›´å°ï¼Œæ›´ç´§å‡‘ï¼Œæ›´é€‚åˆåšä¸ºå¤‡ä»½æ–‡ä»¶ï¼›</li>\n<li>RDB å¯¹ç¾éš¾æ¢å¤éå¸¸æœ‰ç”¨ï¼Œå®ƒæ˜¯ä¸€ä¸ªç´§å‡‘çš„æ–‡ä»¶ï¼Œå¯ä»¥æ›´å¿«çš„ä¼ è¾“åˆ°è¿œç¨‹æœåŠ¡å™¨è¿›è¡Œ Redis æœåŠ¡æ¢å¤ï¼›</li>\n<li>RDB å¯ä»¥æ›´å¤§ç¨‹åº¦çš„æé«˜ Redis çš„è¿è¡Œé€Ÿåº¦ï¼Œå› ä¸ºæ¯æ¬¡æŒä¹…åŒ–æ—¶ Redis ä¸»è¿›ç¨‹éƒ½ä¼š fork() ä¸€ä¸ªå­è¿›ç¨‹ï¼Œè¿›è¡Œæ•°æ®æŒä¹…åŒ–åˆ°ç£ç›˜ï¼ŒRedis ä¸»è¿›ç¨‹å¹¶ä¸ä¼šæ‰§è¡Œç£ç›˜ I&#x2F;O ç­‰æ“ä½œï¼›</li>\n<li>ä¸ AOF æ ¼å¼çš„æ–‡ä»¶ç›¸æ¯”ï¼ŒRDB æ–‡ä»¶å¯ä»¥æ›´å¿«çš„é‡å¯ã€‚</li>\n</ol>\n<p><strong>ç¼ºç‚¹</strong>ï¼š</p>\n<ol>\n<li>å› ä¸º RDB åªèƒ½ä¿å­˜æŸä¸ªæ—¶é—´é—´éš”çš„æ•°æ®ï¼Œå¦‚æœä¸­é€” Redis æœåŠ¡è¢«æ„å¤–ç»ˆæ­¢äº†ï¼Œåˆ™ä¼šä¸¢å¤±ä¸€æ®µæ—¶é—´å†…çš„ Redis æ•°æ®ã€‚</li>\n<li>RDB éœ€è¦ç»å¸¸ fork() æ‰èƒ½ä½¿ç”¨å­è¿›ç¨‹å°†å…¶æŒä¹…åŒ–åœ¨ç£ç›˜ä¸Šã€‚å¦‚æœæ•°æ®é›†å¾ˆå¤§ï¼Œfork() å¯èƒ½å¾ˆè€—æ—¶ï¼Œå¹¶ä¸”å¦‚æœæ•°æ®é›†å¾ˆå¤§ä¸” CPU æ€§èƒ½ä¸ä½³ï¼Œåˆ™å¯èƒ½å¯¼è‡´ Redis åœæ­¢ä¸ºå®¢æˆ·ç«¯æœåŠ¡å‡ æ¯«ç§’ç”šè‡³ä¸€ç§’é’Ÿã€‚</li>\n</ol>\n<h3 id=\"AOF-Append-Only-File\"><a href=\"#AOF-Append-Only-File\" class=\"headerlink\" title=\"AOF(Append Only File)\"></a>AOF(Append Only File)</h3><p>ä»¥æ—¥å¿—çš„å½¢å¼æ¥è®°å½•æ¯ä¸ªå†™çš„æ“ä½œï¼Œå°† Redis æ‰§è¡Œè¿‡çš„æ‰€æœ‰æŒ‡ä»¤è®°å½•ä¸‹æ¥ï¼ˆè¯»æ“ä½œä¸è®°å½•ï¼‰ï¼Œåªè®¸è¿½åŠ æ–‡ä»¶ä½†ä¸å¯ä»¥æ”¹å†™æ–‡ä»¶ï¼ŒRedis å¯åŠ¨ä¹‹åˆä¼šè¯»å–è¯¥æ–‡ä»¶é‡æ–°æ„å»ºæ•°æ®ï¼Œæ¢è¨€ä¹‹ï¼ŒRedis é‡å¯çš„è¯å°±æ ¹æ®æ—¥å¿—æ–‡ä»¶çš„å†…å®¹å°†å†™æŒ‡ä»¤ä»å‰åˆ°åæ‰§è¡Œä¸€æ¬¡ä»¥å®Œæˆæ•°æ®çš„æ¢å¤å·¥ä½œã€‚</p>\n<h4 id=\"AOFé…ç½®é¡¹\"><a href=\"#AOFé…ç½®é¡¹\" class=\"headerlink\" title=\"AOFé…ç½®é¡¹\"></a><strong>AOFé…ç½®é¡¹</strong></h4><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># é»˜è®¤ä¸å¼€å¯aof  è€Œæ˜¯ä½¿ç”¨rdbçš„æ–¹å¼</span><br><span class=\"line\">appendonly no</span><br><span class=\"line\"></span><br><span class=\"line\"># é»˜è®¤æ–‡ä»¶å</span><br><span class=\"line\">appendfilename &quot;appendonly.aof&quot;</span><br><span class=\"line\"></span><br><span class=\"line\"># æ¯æ¬¡ä¿®æ”¹éƒ½ä¼šsync æ¶ˆè€—æ€§èƒ½</span><br><span class=\"line\"># appendfsync always</span><br><span class=\"line\"># æ¯ç§’æ‰§è¡Œä¸€æ¬¡ sync å¯èƒ½ä¼šä¸¢å¤±è¿™ä¸€ç§’çš„æ•°æ®</span><br><span class=\"line\">appendfsync everysec</span><br><span class=\"line\"># ä¸æ‰§è¡Œ sync ï¼Œè¿™æ—¶å€™æ“ä½œç³»ç»Ÿè‡ªå·±åŒæ­¥æ•°æ®ï¼Œé€Ÿåº¦æœ€å¿«</span><br><span class=\"line\"># appendfsync no </span><br></pre></td></tr></table></figure>\n\n<p>AOF çš„æ•´ä¸ªæµç¨‹å¤§ä½“æ¥çœ‹å¯ä»¥åˆ†ä¸ºä¸¤æ­¥ï¼Œç¬¬ä¸€æ­¥æ˜¯å‘½ä»¤çš„å®æ—¶å†™å…¥ï¼ˆå¦‚æœæ˜¯ appendfsync everysec é…ç½®ï¼Œä¼šæœ‰ 1s æŸè€—ï¼‰ï¼Œç¬¬äºŒæ­¥æ˜¯å¯¹ aof æ–‡ä»¶çš„é‡å†™ã€‚</p>\n<h4 id=\"AOF-é‡å†™æœºåˆ¶\"><a href=\"#AOF-é‡å†™æœºåˆ¶\" class=\"headerlink\" title=\"AOF é‡å†™æœºåˆ¶\"></a><strong>AOF é‡å†™æœºåˆ¶</strong></h4><p>éšç€ Redis çš„è¿è¡Œï¼ŒAOF çš„æ—¥å¿—ä¼šè¶Šæ¥è¶Šé•¿ï¼Œå¦‚æœå®ä¾‹å®•æœºé‡å¯ï¼Œé‚£ä¹ˆé‡æ”¾æ•´ä¸ª AOF å°†ä¼šå˜å¾—ååˆ†è€—æ—¶ï¼Œè€Œåœ¨æ—¥å¿—è®°å½•ä¸­ï¼Œåˆæœ‰å¾ˆå¤šæ— æ„ä¹‰çš„è®°å½•ï¼Œæ¯”å¦‚æˆ‘ç°åœ¨å°†ä¸€ä¸ªæ•°æ® incr ä¸€åƒæ¬¡ï¼Œé‚£ä¹ˆå°±ä¸éœ€è¦å»è®°å½•è¿™ 1000 æ¬¡ä¿®æ”¹ï¼Œåªéœ€è¦è®°å½•æœ€åçš„å€¼å³å¯ã€‚æ‰€ä»¥å°±éœ€è¦è¿›è¡Œ AOF é‡å†™ã€‚</p>\n<p>Redis æä¾›äº† bgrewriteaof æŒ‡ä»¤ç”¨äºå¯¹ AOF æ—¥å¿—è¿›è¡Œé‡å†™ï¼Œè¯¥æŒ‡ä»¤è¿è¡Œæ—¶ä¼šå¼€è¾Ÿä¸€ä¸ªå­è¿›ç¨‹å¯¹å†…å­˜è¿›è¡Œéå†ï¼Œç„¶åå°†å…¶è½¬æ¢ä¸ºä¸€ç³»åˆ—çš„ Redis çš„æ“ä½œæŒ‡ä»¤ï¼Œå†åºåˆ—åŒ–åˆ°ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ä¸­ã€‚å®Œæˆåå†æ›¿æ¢åŸæœ‰çš„ AOF æ–‡ä»¶ï¼Œè‡³æ­¤å®Œæˆã€‚</p>\n<p>åŒæ ·çš„ä¹Ÿå¯ä»¥åœ¨ Redis.config ä¸­å¯¹é‡å†™æœºåˆ¶çš„è§¦å‘è¿›è¡Œé…ç½®ï¼š</p>\n<p>é€šè¿‡å°† no-appendfsync-on-rewrite è®¾ç½®ä¸º yesï¼Œå¼€å¯é‡å†™æœºåˆ¶ï¼›auto-aof-rewrite-percentage 100 æ„ä¸ºæ¯”ä¸Šæ¬¡ä»å†™åæ–‡ä»¶å¤§å°å¢é•¿äº† 100%å†æ¬¡è§¦å‘é‡å†™ï¼›</p>\n<p>auto-aof-rewrite-min-size 64mb æ„ä¸ºå½“æ–‡ä»¶è‡³å°‘è¦è¾¾åˆ° 64mb æ‰ä¼šè§¦å‘åˆ¶åŠ¨é‡å†™ã€‚</p>\n<p><strong>ä¼˜ç‚¹</strong>ï¼š</p>\n<p>1ã€æ•°æ®å®‰å…¨ï¼ŒAOF æ˜¯å¯¹æŒ‡ä»¤æ–‡ä»¶è¿›è¡Œ <strong>å¢é‡æ›´æ–°</strong>ï¼Œæ›´é€‚åˆå®æ—¶æ€§æŒä¹…åŒ–ã€‚</p>\n<p>2ã€é€šè¿‡ append æ¨¡å¼å†™æ–‡ä»¶ï¼Œå³ä½¿ä¸­é€”æœåŠ¡å™¨å®•æœºï¼Œå¯ä»¥é€šè¿‡ Redis-check-aof å·¥å…·è§£å†³æ•°æ®ä¸€è‡´æ€§é—®é¢˜ã€‚</p>\n<p>3ã€AOF æœºåˆ¶çš„ rewrite æ¨¡å¼ã€‚AOF æ–‡ä»¶æ²¡è¢« rewrite ä¹‹å‰ï¼ˆæ–‡ä»¶è¿‡å¤§æ—¶ä¼šå¯¹å‘½ä»¤ è¿›è¡Œåˆå¹¶é‡å†™ï¼‰ï¼Œå¯ä»¥åˆ é™¤å…¶ä¸­çš„æŸäº›å‘½ä»¤ï¼ˆæ¯”å¦‚è¯¯æ“ä½œçš„ flushallï¼‰)</p>\n<p><strong>ç¼ºç‚¹</strong>ï¼š</p>\n<p>1ã€AOF æ–‡ä»¶æ¯” RDB æ–‡ä»¶å¤§ï¼Œä¸”æ¢å¤é€Ÿåº¦æ…¢ã€‚</p>\n<p>2ã€æ•°æ®é›†å¤§çš„æ—¶å€™ï¼Œæ¯” RDB å¯åŠ¨æ•ˆç‡ä½ã€‚</p>\n<h3 id=\"RDBä¸AOFå¯¹æ¯”\"><a href=\"#RDBä¸AOFå¯¹æ¯”\" class=\"headerlink\" title=\"RDBä¸AOFå¯¹æ¯”\"></a>RDBä¸AOFå¯¹æ¯”</h3><p>Redis å®˜æ–¹å»ºè®®åŒæ—¶å¼€å¯ä¸¤ç§æŒä¹…åŒ–ç­–ç•¥ï¼ŒAOF å’Œ RDB åŒæ—¶å¼€å¯ï¼Œç³»ç»Ÿé»˜è®¤å– AOF çš„æ•°æ®ï¼ˆæ•°æ®ä¸ä¼šå­˜åœ¨ä¸¢å¤±ï¼‰</p>\n<table>\n<thead>\n<tr>\n<th>æ¯”è¾ƒé¡¹</th>\n<th>RDB</th>\n<th>AOF</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>å¯åŠ¨ä¼˜å…ˆçº§</td>\n<td>ä½</td>\n<td>é«˜</td>\n</tr>\n<tr>\n<td>ä½“ç§¯</td>\n<td>å°</td>\n<td>å¤§</td>\n</tr>\n<tr>\n<td>æ¢å¤é€Ÿåº¦</td>\n<td>å¿«</td>\n<td>æ…¢</td>\n</tr>\n<tr>\n<td>æ•°æ®å®‰å…¨æ€§</td>\n<td>ä¸¢æ•°æ®</td>\n<td>æ ¹æ®ç­–ç•¥å†³å®š</td>\n</tr>\n</tbody></table>\n<hr>\n<h2 id=\"å‘å¸ƒä¸è®¢é˜…\"><a href=\"#å‘å¸ƒä¸è®¢é˜…\" class=\"headerlink\" title=\"å‘å¸ƒä¸è®¢é˜…\"></a>å‘å¸ƒä¸è®¢é˜…</h2><p>Redis å‘å¸ƒä¸è®¢é˜…æ˜¯ä¸€ç§æ¶ˆæ¯é€šä¿¡çš„æ¨¡å¼ï¼šå‘é€è€…ï¼ˆpubï¼‰å‘é€æ¶ˆæ¯ï¼Œè®¢é˜…è€…ï¼ˆsubï¼‰æ¥æ”¶æ¶ˆæ¯ã€‚</p>\n<p>Redis é€šè¿‡ PUBLISH å’Œ SUBSCRIBE ç­‰å‘½ä»¤å®ç°äº†è®¢é˜…ä¸å‘å¸ƒæ¨¡å¼ï¼Œè¿™ä¸ªåŠŸèƒ½æä¾›ä¸¤ç§ä¿¡æ¯æœºåˆ¶ï¼Œåˆ†åˆ«æ˜¯è®¢é˜…&#x2F;å‘å¸ƒåˆ°é¢‘é“ã€è®¢é˜…&#x2F;å‘å¸ƒåˆ°æ¨¡å¼çš„å®¢æˆ·ç«¯ã€‚</p>\n<h3 id=\"é¢‘é“ï¼ˆchannelï¼‰\"><a href=\"#é¢‘é“ï¼ˆchannelï¼‰\" class=\"headerlink\" title=\"é¢‘é“ï¼ˆchannelï¼‰\"></a>é¢‘é“ï¼ˆchannelï¼‰</h3><p><strong>è®¢é˜…</strong></p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650436261125.png\" alt=\"é¢‘é“è®¢é˜…\"></p>\n<p><strong>å‘å¸ƒ</strong></p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650436267143.png\" alt=\"é¢‘é“å‘å¸ƒ\"></p>\n<h4 id=\"å®Œæ•´æµç¨‹\"><a href=\"#å®Œæ•´æµç¨‹\" class=\"headerlink\" title=\"å®Œæ•´æµç¨‹\"></a><strong>å®Œæ•´æµç¨‹</strong></h4><p>å‘å¸ƒè€…å‘é¢‘é“ channel:1 å‘å¸ƒæ¶ˆæ¯ hi</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; publish channel:1 hi(integer) 1</span><br></pre></td></tr></table></figure>\n\n<p>è®¢é˜…è€…è®¢é˜…æ¶ˆæ¯</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; subscribe channel:1</span><br><span class=\"line\">Reading messages... (press Ctrl-C to quit)</span><br><span class=\"line\">1) &quot;subscribe&quot; // æ¶ˆæ¯ç±»å‹</span><br><span class=\"line\">2) &quot;channel:1&quot; // é¢‘é“</span><br><span class=\"line\">3) &quot;hi&quot; // æ¶ˆæ¯å†…å®¹</span><br></pre></td></tr></table></figure>\n\n<p>æ‰§è¡Œ subscribe åå®¢æˆ·ç«¯ä¼šè¿›å…¥è®¢é˜…çŠ¶æ€ï¼Œä»…å¯ä»¥ä½¿ subscribeã€unsubscribeã€psubscribe å’Œ punsubscribe è¿™å››ä¸ªå±äºâ€å‘å¸ƒ&#x2F;è®¢é˜…â€ä¹‹å¤–çš„å‘½ä»¤</p>\n<p>è®¢é˜…é¢‘é“åçš„å®¢æˆ·ç«¯å¯èƒ½ä¼šæ”¶åˆ°ä¸‰ç§æ¶ˆæ¯ç±»å‹</p>\n<ul>\n<li><p>subscribeï¼šè¡¨ç¤ºè®¢é˜…æˆåŠŸçš„åé¦ˆä¿¡æ¯ã€‚ç¬¬äºŒä¸ªå€¼æ˜¯è®¢é˜…æˆåŠŸçš„é¢‘é“åç§°ï¼Œç¬¬ä¸‰ä¸ªæ˜¯å½“å‰å®¢æˆ·ç«¯è®¢é˜…çš„é¢‘é“æ•°é‡ã€‚</p>\n</li>\n<li><p>messageï¼šè¡¨ç¤ºæ¥æ”¶åˆ°çš„æ¶ˆæ¯ï¼Œç¬¬äºŒä¸ªå€¼è¡¨ç¤ºäº§ç”Ÿæ¶ˆæ¯çš„é¢‘é“åç§°ï¼Œç¬¬ä¸‰ä¸ªå€¼æ˜¯æ¶ˆæ¯çš„å†…å®¹ã€‚</p>\n</li>\n<li><p>unsubscribeï¼šè¡¨ç¤ºæˆåŠŸå–æ¶ˆè®¢é˜…æŸä¸ªé¢‘é“ã€‚ç¬¬äºŒä¸ªå€¼æ˜¯å¯¹åº”çš„é¢‘é“åç§°ï¼Œç¬¬ä¸‰ä¸ªå€¼æ˜¯å½“å‰å®¢æˆ·ç«¯è®¢é˜…çš„é¢‘é“æ•°é‡ï¼Œå½“æ­¤å€¼ä¸º 0 æ—¶å®¢æˆ·ç«¯ä¼šé€€å‡ºè®¢é˜…çŠ¶æ€ï¼Œä¹‹åå°±å¯ä»¥æ‰§è¡Œå…¶ä»–éâ€å‘å¸ƒ&#x2F;è®¢é˜…â€æ¨¡å¼çš„å‘½ä»¤äº†ã€‚</p>\n</li>\n</ul>\n<h4 id=\"æ•°æ®ç»“æ„\"><a href=\"#æ•°æ®ç»“æ„\" class=\"headerlink\" title=\"æ•°æ®ç»“æ„\"></a><strong>æ•°æ®ç»“æ„</strong></h4><p>åŸºäº channel çš„å‘å¸ƒè®¢é˜…æ¨¡å¼æ˜¯é€šè¿‡å­—å…¸æ•°æ®ç±»å‹å®ç°çš„</p>\n<blockquote>\n<p>ç±»ä¼¼hashmapï¼Œé”®ä¸ºchannelï¼Œå€¼ä¸ºè®¢é˜…äº†è¯¥channelçš„clientï¼Œç”¨é“¾è¡¨é“¾æ¥èµ·æ¥</p>\n</blockquote>\n<p>å…¶ä¸­ï¼Œå­—å…¸çš„é”®ä¸ºæ­£åœ¨è¢«è®¢é˜…çš„é¢‘é“ï¼Œ è€Œå­—å…¸çš„å€¼åˆ™æ˜¯ä¸€ä¸ªé“¾è¡¨ï¼Œ é“¾è¡¨ä¸­ä¿å­˜äº†æ‰€æœ‰è®¢é˜…è¿™ä¸ªé¢‘é“çš„å®¢æˆ·ç«¯ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650420774862.png\" alt=\"é¢‘é“æ¨¡å¼æ•°æ®ç»“æ„æ¨¡å‹\"></p>\n<p><strong>è®¢é˜…</strong></p>\n<p>å½“ä½¿ç”¨ subscribe è®¢é˜…æ—¶ï¼Œåœ¨å­—å…¸ä¸­æ‰¾åˆ°é¢‘é“ keyï¼ˆå¦‚æ²¡æœ‰åˆ™åˆ›å»ºï¼‰ï¼Œå¹¶å°†è®¢é˜…çš„ client å…³è”åœ¨é“¾è¡¨åé¢ã€‚</p>\n<p>å½“ client 10 æ‰§è¡Œ <code>subscribe channel1 channel2 channel3</code> æ—¶ï¼Œä¼šå°† client 10 åˆ†åˆ«åŠ åˆ° channel1 channel2 channel3 å…³è”çš„é“¾è¡¨å°¾éƒ¨ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650420784179.png\" alt=\"é¢‘é“è®¢é˜…\"></p>\n<p><strong>å‘å¸ƒ</strong></p>\n<p>å‘å¸ƒæ—¶ï¼Œæ ¹æ® keyï¼Œæ‰¾åˆ°å­—å…¸æ±‡æ€» key çš„åœ°å€ï¼Œç„¶åå°† msg å‘é€åˆ°å…³è”çš„é“¾è¡¨æ¯ä¸€å°æœºå™¨ã€‚</p>\n<p><strong>é€€è®¢</strong></p>\n<p>éå†å…³è”çš„é“¾è¡¨ï¼Œå°†æŒ‡å®šçš„åœ°å€åˆ é™¤å³å¯ã€‚</p>\n<h3 id=\"æ¨¡å¼ï¼ˆpatternï¼‰\"><a href=\"#æ¨¡å¼ï¼ˆpatternï¼‰\" class=\"headerlink\" title=\"æ¨¡å¼ï¼ˆpatternï¼‰\"></a>æ¨¡å¼ï¼ˆpatternï¼‰</h3><p>pattern ä½¿ç”¨äº†é€šé…ç¬¦çš„æ–¹å¼æ¥è®¢é˜…</p>\n<p>é€šé…ç¬¦ä¸­ ? è¡¨ç¤º 1 ä¸ªå ä½ç¬¦ï¼Œ* è¡¨ç¤ºä»»æ„ä¸ªå ä½ç¬¦(åŒ…æ‹¬ 0)ï¼Œ?* è¡¨ç¤º 1 ä¸ªä»¥ä¸Šå ä½ç¬¦ã€‚</p>\n<p>æ‰€ä»¥å½“ä½¿ç”¨ publish å‘½ä»¤å‘é€ä¿¡æ¯åˆ°æŸä¸ªé¢‘é“æ—¶ï¼Œ ä¸ä»…æ‰€æœ‰è®¢é˜…è¯¥é¢‘é“çš„å®¢æˆ·ç«¯ä¼šæ”¶åˆ°ä¿¡æ¯ï¼Œ å¦‚æœæœ‰æŸä¸ª&#x2F;æŸäº›æ¨¡å¼å’Œè¿™ä¸ªé¢‘é“åŒ¹é…çš„è¯ï¼Œ é‚£ä¹ˆæ‰€æœ‰è®¢é˜…è¿™ä¸ª&#x2F;è¿™äº›é¢‘é“çš„å®¢æˆ·ç«¯ä¹ŸåŒæ ·ä¼šæ”¶åˆ°ä¿¡æ¯ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650420803487.png\" alt=\"æ¨¡å¼\"></p>\n<h4 id=\"è®¢é˜…å‘å¸ƒå®Œæ•´æµç¨‹\"><a href=\"#è®¢é˜…å‘å¸ƒå®Œæ•´æµç¨‹\" class=\"headerlink\" title=\"è®¢é˜…å‘å¸ƒå®Œæ•´æµç¨‹\"></a><strong>è®¢é˜…å‘å¸ƒå®Œæ•´æµç¨‹</strong></h4><p>å‘å¸ƒè€…å‘å¸ƒæ¶ˆæ¯</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; publish b m1</span><br><span class=\"line\">(integer) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; publish b1 m1</span><br><span class=\"line\">(integer) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; publish b11 m1</span><br><span class=\"line\">(integer) 1</span><br></pre></td></tr></table></figure>\n\n<p>è®¢é˜…è€…è®¢é˜…æ¶ˆæ¯</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; psubscribe b*</span><br><span class=\"line\">Reading messages... (press Ctrl-C to quit)</span><br><span class=\"line\">1) &quot;psubscribe&quot;</span><br><span class=\"line\">2) &quot;b*&quot;</span><br><span class=\"line\">3) (integer) 3</span><br><span class=\"line\">1) &quot;pmessage&quot;</span><br><span class=\"line\">2) &quot;b*&quot;</span><br><span class=\"line\">3) &quot;b&quot;</span><br><span class=\"line\">4) &quot;m1&quot;</span><br><span class=\"line\">1) &quot;pmessage&quot;</span><br><span class=\"line\">2) &quot;b*&quot;</span><br><span class=\"line\">3) &quot;b1&quot;</span><br><span class=\"line\">4) &quot;m1&quot;</span><br><span class=\"line\">1) &quot;pmessage&quot;</span><br><span class=\"line\">2) &quot;b*&quot;</span><br><span class=\"line\">3) &quot;b11&quot;</span><br><span class=\"line\">4) &quot;m1&quot;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"æ•°æ®ç»“æ„-1\"><a href=\"#æ•°æ®ç»“æ„-1\" class=\"headerlink\" title=\"æ•°æ®ç»“æ„\"></a><strong>æ•°æ®ç»“æ„</strong></h4><p>pattern å±æ€§æ˜¯ä¸€ä¸ªé“¾è¡¨ï¼Œé“¾è¡¨ä¸­ä¿å­˜ç€æ‰€æœ‰å’Œæ¨¡å¼ç›¸å…³çš„ä¿¡æ¯ã€‚</p>\n<blockquote>\n<p>ç±»ä¼¼é“¾è¡¨ï¼Œæ¯ä¸ªpatternèŠ‚ç‚¹ï¼ŒåŒ…å«patternä»¥åŠè®¢é˜…è¯¥patternçš„client</p>\n</blockquote>\n<p>æ•°æ®ç»“æ„å›¾å¦‚ä¸‹ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650420905733.png\" alt=\"æ¨¡å¼æ•°æ®ç»“æ„\"></p>\n<p><strong>è®¢é˜…</strong></p>\n<p>å½“æœ‰ä¿¡çš„è®¢é˜…æ—¶ï¼Œä¼šå°†è®¢é˜…çš„å®¢æˆ·ç«¯å’Œæ¨¡å¼ä¿¡æ¯æ·»åŠ åˆ°é“¾è¡¨åé¢ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650420913717.png\" alt=\"æ¨¡å¼è®¢é˜…\"></p>\n<p><strong>å‘å¸ƒ</strong></p>\n<p>å½“å‘å¸ƒè€…å‘å¸ƒæ¶ˆæ¯æ—¶ï¼Œé¦–å…ˆä¼šå‘é€åˆ°å¯¹åº”çš„é¢‘é“ä¸Šï¼Œåœ¨éå†æ¨¡å¼åˆ—è¡¨ï¼Œæ ¹æ® key åŒ¹é…æ¨¡å¼ï¼ŒåŒ¹é…æˆåŠŸå°†æ¶ˆæ¯å‘ç»™å¯¹åº”çš„è®¢é˜…è€…ã€‚</p>\n<p><strong>é€€è®¢</strong></p>\n<p>ä½¿ç”¨ punsubscribeï¼Œå¯ä»¥å°†è®¢é˜…è€…é€€è®¢ï¼Œå°†æ”¹å®¢æˆ·ç«¯ç§»é™¤å‡ºé“¾è¡¨ã€‚</p>\n<hr>\n<h2 id=\"ä¸»ä»å¤åˆ¶\"><a href=\"#ä¸»ä»å¤åˆ¶\" class=\"headerlink\" title=\"ä¸»ä»å¤åˆ¶\"></a>ä¸»ä»å¤åˆ¶</h2><p><strong>ä»€ä¹ˆæ˜¯ä¸»ä»å¤åˆ¶</strong></p>\n<p>åœ¨å¤šä¸ª Redis å®ä¾‹å»ºç«‹èµ·ä¸»ä»å…³ç³»ï¼Œå½“ ä¸» Redis ä¸­çš„æ•°æ®å‘ç”Ÿå˜åŒ–ï¼Œä» Redis ä¸­çš„æ•°æ®ä¹Ÿä¼šåŒæ­¥å˜åŒ–</p>\n<ul>\n<li>é€šè¿‡ä¸»ä»é…ç½®å¯ä»¥å®ç° Redis æ•°æ®çš„å¤‡ä»½ï¼ˆä» Redis å°±æ˜¯å¯¹ ä¸» Redis çš„å¤‡ä»½ï¼‰ï¼Œä¿è¯æ•°æ®å®‰å…¨æ€§</li>\n<li>ä¸»ä»åº“ä¹‹é—´é‡‡ç”¨çš„æ˜¯è¯»å†™åˆ†ç¦»çš„æ–¹å¼ï¼Œè¯»æ“ä½œï¼šä¸»åº“ã€ä»åº“éƒ½å¯ä»¥æ¥æ”¶ï¼›å†™æ“ä½œï¼šé¦–å…ˆåˆ°ä¸»åº“æ‰§è¡Œï¼Œç„¶åä¸»åº“å°†å†™æ“ä½œåŒæ­¥ç»™ä»åº“</li>\n</ul>\n<p><strong>ä¸»ä»å¤åˆ¶çš„ä½œç”¨</strong></p>\n<ul>\n<li><p>æ•°æ®å†—ä½™ï¼šä¸»ä»å¤åˆ¶å®ç°äº†æ•°æ®çš„çƒ­å¤‡ä»½ï¼Œæ˜¯æŒä¹…åŒ–ä¹‹å¤–çš„ä¸€ç§æ•°æ®å†—ä½™æ–¹å¼ã€‚</p>\n</li>\n<li><p>æ•…éšœæ¢å¤ï¼šå½“ä¸»èŠ‚ç‚¹å‡ºç°é—®é¢˜æ—¶ï¼Œå¯ä»¥ç”±ä»èŠ‚ç‚¹æä¾›æœåŠ¡ï¼Œå®ç°å¿«é€Ÿçš„æ•…éšœæ¢å¤ï¼›å®é™…ä¸Šæ˜¯ä¸€ç§æœåŠ¡çš„å†—ä½™ã€‚</p>\n</li>\n<li><p>è´Ÿè½½å‡è¡¡ï¼šåœ¨ä¸»ä»å¤åˆ¶çš„åŸºç¡€ä¸Šï¼Œé…åˆè¯»å†™åˆ†ç¦»ï¼Œå¯ä»¥ç”±ä¸»èŠ‚ç‚¹æä¾›å†™æœåŠ¡ï¼Œç”±ä»èŠ‚ç‚¹æä¾›è¯»æœåŠ¡ï¼ˆå³å†™ Redis æ•°æ®æ—¶åº”ç”¨è¿æ¥ä¸»èŠ‚ç‚¹ï¼Œè¯» Redis æ•°æ®æ—¶åº”ç”¨è¿æ¥ä»èŠ‚ç‚¹ï¼‰ï¼Œåˆ†æ‹…æœåŠ¡å™¨è´Ÿè½½ï¼›å°¤å…¶æ˜¯åœ¨å†™å°‘è¯»å¤šçš„åœºæ™¯ä¸‹ï¼Œé€šè¿‡å¤šä¸ªä»èŠ‚ç‚¹åˆ†æ‹…è¯»è´Ÿè½½ï¼Œå¯ä»¥å¤§å¤§æé«˜ Redis æœåŠ¡å™¨çš„å¹¶å‘é‡ã€‚</p>\n</li>\n<li><p>é«˜å¯ç”¨åŸºçŸ³ï¼šé™¤äº†ä¸Šè¿°ä½œç”¨ä»¥å¤–ï¼Œä¸»ä»å¤åˆ¶è¿˜æ˜¯å“¨å…µå’Œé›†ç¾¤èƒ½å¤Ÿå®æ–½çš„åŸºç¡€ï¼Œå› æ­¤è¯´ä¸»ä»å¤åˆ¶æ˜¯ Redis é«˜å¯ç”¨çš„åŸºç¡€ã€‚</p>\n</li>\n</ul>\n<p>ä¸»ä»åº“é‡‡ç”¨çš„æ˜¯è¯»å†™åˆ†ç¦»çš„æ–¹å¼ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650420963646.png\" alt=\"ä¸»ä»åº“è¯»å†™åˆ†ç¦»\"> </p>\n<h3 id=\"åŸç†\"><a href=\"#åŸç†\" class=\"headerlink\" title=\"åŸç†\"></a>åŸç†</h3><p>åˆ†ä¸ºå…¨é‡å¤åˆ¶ä¸å¢é‡å¤åˆ¶</p>\n<p>å…¨é‡å¤åˆ¶ï¼šå‘ç”Ÿåœ¨ç¬¬ä¸€æ¬¡å¤åˆ¶æ—¶</p>\n<p>å¢é‡å¤åˆ¶ï¼šåªä¼šæŠŠä¸»ä»åº“ç½‘ç»œæ–­è¿æœŸé—´ä¸»åº“æ”¶åˆ°çš„å‘½ä»¤ï¼ŒåŒæ­¥ç»™ä»åº“</p>\n<h3 id=\"å…¨é‡å¤åˆ¶çš„ä¸‰ä¸ªé˜¶æ®µ\"><a href=\"#å…¨é‡å¤åˆ¶çš„ä¸‰ä¸ªé˜¶æ®µ\" class=\"headerlink\" title=\"å…¨é‡å¤åˆ¶çš„ä¸‰ä¸ªé˜¶æ®µ\"></a>å…¨é‡å¤åˆ¶çš„ä¸‰ä¸ªé˜¶æ®µ</h3><p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNoteskjk7gr48ft.jpeg\" alt=\"å…¨é‡å¤åˆ¶\"></p>\n<p>ç¬¬ä¸€é˜¶æ®µæ˜¯ä¸»ä»åº“é—´å»ºç«‹è¿æ¥ã€åå•†åŒæ­¥çš„è¿‡ç¨‹ã€‚</p>\n<blockquote>\n<p>ä¸»è¦æ˜¯ä¸ºå…¨é‡å¤åˆ¶åšå‡†å¤‡ã€‚ä»åº“å’Œä¸»åº“å»ºç«‹èµ·è¿æ¥ï¼Œå¹¶å‘Šè¯‰ä¸»åº“å³å°†è¿›è¡ŒåŒæ­¥ï¼Œä¸»åº“ç¡®è®¤å›å¤åï¼Œä¸»ä»åº“é—´å°±å¯ä»¥å¼€å§‹åŒæ­¥äº†ã€‚</p>\n<p>å…·ä½“æ¥è¯´ï¼Œä»åº“ç»™ä¸»åº“å‘é€ psync å‘½ä»¤ï¼Œè¡¨ç¤ºè¦è¿›è¡Œæ•°æ®åŒæ­¥ï¼Œä¸»åº“æ ¹æ®è¿™ä¸ªå‘½ä»¤çš„å‚æ•°æ¥å¯åŠ¨å¤åˆ¶ã€‚psync å‘½ä»¤åŒ…å«äº†ä¸»åº“çš„ runID å’Œå¤åˆ¶è¿›åº¦ offset ä¸¤ä¸ªå‚æ•°ã€‚runIDï¼Œæ˜¯æ¯ä¸ª Redis å®ä¾‹å¯åŠ¨æ—¶éƒ½ä¼šè‡ªåŠ¨ç”Ÿæˆçš„ä¸€ä¸ªéšæœº IDï¼Œç”¨æ¥å”¯ä¸€æ ‡è®°è¿™ä¸ªå®ä¾‹ã€‚å½“ä»åº“å’Œä¸»åº“ç¬¬ä¸€æ¬¡å¤åˆ¶æ—¶ï¼Œå› ä¸ºä¸çŸ¥é“ä¸»åº“çš„ runIDï¼Œæ‰€ä»¥å°† runID è®¾ä¸ºâ€œï¼Ÿâ€ã€‚offsetï¼Œæ­¤æ—¶è®¾ä¸º -1ï¼Œè¡¨ç¤ºç¬¬ä¸€æ¬¡å¤åˆ¶ã€‚ä¸»åº“æ”¶åˆ° psync å‘½ä»¤åï¼Œä¼šç”¨ FULLRESYNC å“åº”å‘½ä»¤å¸¦ä¸Šä¸¤ä¸ªå‚æ•°ï¼šä¸»åº“ runID å’Œä¸»åº“ç›®å‰çš„å¤åˆ¶è¿›åº¦ offsetï¼Œè¿”å›ç»™ä»åº“ã€‚ä»åº“æ”¶åˆ°å“åº”åï¼Œä¼šè®°å½•ä¸‹è¿™ä¸¤ä¸ªå‚æ•°ã€‚è¿™é‡Œæœ‰ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ï¼ŒFULLRESYNC å“åº”è¡¨ç¤ºç¬¬ä¸€æ¬¡å¤åˆ¶é‡‡ç”¨çš„å…¨é‡å¤åˆ¶ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸»åº“ä¼šæŠŠå½“å‰æ‰€æœ‰çš„æ•°æ®éƒ½å¤åˆ¶ç»™ä»åº“ã€‚</p>\n</blockquote>\n<p>ç¬¬äºŒé˜¶æ®µï¼Œä¸»åº“å°†æ‰€æœ‰æ•°æ®åŒæ­¥ç»™ä»åº“ã€‚ä»åº“æ”¶åˆ°æ•°æ®åï¼Œåœ¨æœ¬åœ°å®Œæˆæ•°æ®åŠ è½½ã€‚è¿™ä¸ªè¿‡ç¨‹ä¾èµ–äºå†…å­˜å¿«ç…§ç”Ÿæˆçš„ RDB æ–‡ä»¶ã€‚</p>\n<blockquote>\n<p>å…·ä½“æ¥è¯´ï¼Œä¸»åº“æ‰§è¡Œ bgsave å‘½ä»¤ï¼Œç”Ÿæˆ RDB æ–‡ä»¶ï¼Œæ¥ç€å°†æ–‡ä»¶å‘ç»™ä»åº“ã€‚ä»åº“æ¥æ”¶åˆ° RDB æ–‡ä»¶åï¼Œä¼šå…ˆæ¸…ç©ºå½“å‰æ•°æ®åº“ï¼Œç„¶ååŠ è½½ RDB æ–‡ä»¶ã€‚è¿™æ˜¯å› ä¸ºä»åº“åœ¨é€šè¿‡ replicaof å‘½ä»¤å¼€å§‹å’Œä¸»åº“åŒæ­¥å‰ï¼Œå¯èƒ½ä¿å­˜äº†å…¶ä»–æ•°æ®ã€‚ä¸ºäº†é¿å…ä¹‹å‰æ•°æ®çš„å½±å“ï¼Œä»åº“éœ€è¦å…ˆæŠŠå½“å‰æ•°æ®åº“æ¸…ç©ºã€‚åœ¨ä¸»åº“å°†æ•°æ®åŒæ­¥ç»™ä»åº“çš„è¿‡ç¨‹ä¸­ï¼Œä¸»åº“ä¸ä¼šè¢«é˜»å¡ï¼Œä»ç„¶å¯ä»¥æ­£å¸¸æ¥æ”¶è¯·æ±‚ã€‚å¦åˆ™ï¼ŒRedis çš„æœåŠ¡å°±è¢«ä¸­æ–­äº†ã€‚ä½†æ˜¯ï¼Œè¿™äº›è¯·æ±‚ä¸­çš„å†™æ“ä½œå¹¶æ²¡æœ‰è®°å½•åˆ°åˆšåˆšç”Ÿæˆçš„ RDB æ–‡ä»¶ä¸­ã€‚ä¸ºäº†ä¿è¯ä¸»ä»åº“çš„æ•°æ®ä¸€è‡´æ€§ï¼Œä¸»åº“ä¼šåœ¨å†…å­˜ä¸­ç”¨ä¸“é—¨çš„ replication bufferï¼Œè®°å½• RDB æ–‡ä»¶ç”Ÿæˆåæ”¶åˆ°çš„æ‰€æœ‰å†™æ“ä½œã€‚</p>\n</blockquote>\n<p>ç¬¬ä¸‰ä¸ªé˜¶æ®µï¼Œä¸»åº“ä¼šæŠŠç¬¬äºŒé˜¶æ®µæ‰§è¡Œè¿‡ç¨‹ä¸­æ–°æ”¶åˆ°çš„å†™å‘½ä»¤ï¼Œå†å‘é€ç»™ä»åº“ã€‚</p>\n<blockquote>\n<p>å…·ä½“çš„æ“ä½œæ˜¯ï¼Œå½“ä¸»åº“å®Œæˆ RDB æ–‡ä»¶å‘é€åï¼Œå°±ä¼šæŠŠæ­¤æ—¶ replication buffer ä¸­çš„ä¿®æ”¹æ“ä½œå‘ç»™ä»åº“ï¼Œä»åº“å†é‡æ–°æ‰§è¡Œè¿™äº›æ“ä½œã€‚è¿™æ ·ä¸€æ¥ï¼Œä¸»ä»åº“å°±å®ç°åŒæ­¥äº†ã€‚</p>\n</blockquote>\n<h3 id=\"æ–­ç½‘å¢é‡æ›´æ–°\"><a href=\"#æ–­ç½‘å¢é‡æ›´æ–°\" class=\"headerlink\" title=\"æ–­ç½‘å¢é‡æ›´æ–°\"></a>æ–­ç½‘å¢é‡æ›´æ–°</h3><p>å½“ä¸»ä»åº“æ–­è¿åï¼Œä¸»åº“ä¼šæŠŠæ–­è¿æœŸé—´æ”¶åˆ°çš„å†™æ“ä½œå‘½ä»¤ï¼Œå†™å…¥ replication bufferï¼ŒåŒæ—¶ä¹Ÿä¼šæŠŠè¿™äº›æ“ä½œå‘½ä»¤ä¹Ÿå†™å…¥ repl_backlog_buffer è¿™ä¸ªç¼“å†²åŒºã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesg0eezljwqy.jpeg\" alt=\"æ–­ç½‘å¢é‡æ›´æ–°\"></p>\n<h2 id=\"å“¨å…µæœºåˆ¶\"><a href=\"#å“¨å…µæœºåˆ¶\" class=\"headerlink\" title=\"å“¨å…µæœºåˆ¶\"></a>å“¨å…µæœºåˆ¶</h2><blockquote>\n<p>å“¨å…µçš„æ ¸å¿ƒåŠŸèƒ½æ˜¯ä¸»èŠ‚ç‚¹çš„è‡ªåŠ¨æ•…éšœè½¬ç§»</p>\n<ol>\n<li>ç›‘æ§ ä¸»åº“ï¼Œåˆ¤æ–­ ä¸»åº“ æ˜¯å¦å®•æœº</li>\n<li>ä¸»åº“ å¦‚æœå®•æœºï¼Œåˆ™ä» ä»åº“ ä¸­ é€‰ä¸¾æˆä¸º ä¸»åº“ï¼ˆå› æ­¤éœ€è¦å¥‡æ•°ä¸ªå“¨å…µï¼‰</li>\n<li>æ›´æ”¹ä¸»ä»é…ç½®</li>\n</ol>\n</blockquote>\n<p>ä¸‹å›¾æ˜¯ä¸€ä¸ªå…¸å‹çš„å“¨å…µé›†ç¾¤ç›‘æ§çš„é€»è¾‘å›¾ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650420977306.png\" alt=\"å“¨å…µæœºåˆ¶\"></p>\n<p><img src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\" alt=\"å›¾ç‰‡\"></p>\n<p>Redis Sentinel åŒ…å«äº†è‹¥ä¸ª Sentinel èŠ‚ç‚¹ï¼Œè¿™æ ·åšä¹Ÿå¸¦æ¥äº†ä¸¤ä¸ªå¥½å¤„ï¼š</p>\n<ol>\n<li>å¯¹äºèŠ‚ç‚¹çš„æ•…éšœåˆ¤æ–­æ˜¯ç”±å¤šä¸ª Sentinel èŠ‚ç‚¹å…±åŒå®Œæˆï¼Œè¿™æ ·å¯ä»¥æœ‰æ•ˆåœ°é˜²æ­¢è¯¯åˆ¤</li>\n<li>å³ä½¿ä¸ªåˆ« Sentinel èŠ‚ç‚¹ä¸å¯ç”¨ï¼Œæ•´ä¸ª Sentinel é›†ç¾¤ä¾ç„¶æ˜¯å¯ç”¨çš„ã€‚</li>\n</ol>\n<p>å“¨å…µå®ç°äº†ä»¥ä¸‹åŠŸèƒ½</p>\n<ol>\n<li>ç›‘æ§ï¼šæ¯ä¸ª Sentinel èŠ‚ç‚¹ä¼šå¯¹æ•°æ®èŠ‚ç‚¹ï¼ˆRedis master&#x2F;slave èŠ‚ç‚¹ï¼‰å’Œå…¶ä½™ Sentinel èŠ‚ç‚¹è¿›è¡Œç›‘æ§</li>\n<li>é€šçŸ¥ï¼šSentinel èŠ‚ç‚¹ä¼šå°†æ•…éšœè½¬ç§»çš„ç»“æœé€šçŸ¥ç»™åº”ç”¨æ–¹</li>\n<li>æ•…éšœè½¬ç§»ï¼šå®ç° slave æ™‹å‡ä¸º masterï¼Œå¹¶ç»´æŠ¤åç»­æ­£ç¡®çš„ä¸»ä»å…³ç³»</li>\n<li>é…ç½®ä¸­å¿ƒï¼šåœ¨ Redis Sentinel æ¨¡å¼ä¸­ï¼Œå®¢æˆ·ç«¯åœ¨åˆå§‹åŒ–çš„æ—¶å€™è¿æ¥çš„æ˜¯ Sentinel èŠ‚ç‚¹é›†åˆï¼Œä»ä¸­è·å–ä¸»èŠ‚ç‚¹ä¿¡æ¯</li>\n</ol>\n<p>å…¶ä¸­ï¼Œç›‘æ§å’Œè‡ªåŠ¨æ•…éšœè½¬ç§»åŠŸèƒ½ï¼Œä½¿å¾—å“¨å…µå¯ä»¥åŠæ—¶å‘ç°ä¸»èŠ‚ç‚¹æ•…éšœå¹¶å®Œæˆè½¬ç§»ï¼›è€Œé…ç½®ä¸­å¿ƒå’Œé€šçŸ¥åŠŸèƒ½ï¼Œåˆ™éœ€è¦åœ¨ä¸å®¢æˆ·ç«¯çš„äº¤äº’ä¸­æ‰èƒ½ä½“ç°ã€‚</p>\n<h3 id=\"ç›‘æ§\"><a href=\"#ç›‘æ§\" class=\"headerlink\" title=\"ç›‘æ§\"></a>ç›‘æ§</h3><p>Sentinel èŠ‚ç‚¹éœ€è¦ç›‘æ§ masterã€slave ä»¥åŠå…¶å®ƒ Sentinel èŠ‚ç‚¹çš„çŠ¶æ€ã€‚è¿™ä¸€è¿‡ç¨‹æ˜¯é€šè¿‡ Redis çš„ pub&#x2F;sub ç³»ç»Ÿå®ç°çš„ã€‚Redis Sentinel ä¸€å…±æœ‰ä¸‰ä¸ªå®šæ—¶ç›‘æ§ä»»åŠ¡ï¼Œå®Œæˆå¯¹å„ä¸ªèŠ‚ç‚¹å‘ç°å’Œç›‘æ§ï¼š</p>\n<ol>\n<li>ç›‘æ§ä¸»ä»æ‹“æ‰‘ä¿¡æ¯ï¼šæ¯éš” 10 ç§’ï¼Œæ¯ä¸ª Sentinel èŠ‚ç‚¹ï¼Œä¼šå‘ master å’Œ slave å‘é€ INFO å‘½ä»¤è·å–æœ€æ–°çš„æ‹“æ‰‘ç»“æ„</li>\n<li>Sentinel èŠ‚ç‚¹ä¿¡æ¯äº¤æ¢ï¼šæ¯éš” 2 ç§’ï¼Œæ¯ä¸ª Sentinel èŠ‚ç‚¹ï¼Œä¼šå‘ Redis æ•°æ®èŠ‚ç‚¹çš„<code>sentinel:hello</code> é¢‘é“ä¸Šï¼Œå‘é€è‡ªèº«çš„ä¿¡æ¯ï¼Œä»¥åŠå¯¹ä¸»èŠ‚ç‚¹çš„åˆ¤æ–­ä¿¡æ¯ã€‚è¿™æ ·ï¼ŒSentinel èŠ‚ç‚¹ä¹‹é—´å°±å¯ä»¥äº¤æ¢ä¿¡æ¯</li>\n<li>èŠ‚ç‚¹çŠ¶æ€ç›‘æ§ï¼šæ¯éš” 1 ç§’ï¼Œæ¯ä¸ª Sentinel èŠ‚ç‚¹ï¼Œä¼šå‘ masterã€slaveã€å…¶ä½™ Sentinel èŠ‚ç‚¹å‘é€ PING å‘½ä»¤åšå¿ƒè·³æ£€æµ‹ï¼Œæ¥ç¡®è®¤è¿™äº›èŠ‚ç‚¹å½“å‰æ˜¯å¦å¯è¾¾</li>\n</ol>\n<h3 id=\"ä¸»è§‚-x2F-å®¢è§‚ä¸‹çº¿\"><a href=\"#ä¸»è§‚-x2F-å®¢è§‚ä¸‹çº¿\" class=\"headerlink\" title=\"ä¸»è§‚&#x2F;å®¢è§‚ä¸‹çº¿\"></a>ä¸»è§‚&#x2F;å®¢è§‚ä¸‹çº¿</h3><h4 id=\"ä¸»è§‚ä¸‹çº¿\"><a href=\"#ä¸»è§‚ä¸‹çº¿\" class=\"headerlink\" title=\"ä¸»è§‚ä¸‹çº¿\"></a>ä¸»è§‚ä¸‹çº¿</h4><p>æ¯ä¸ª Sentinel èŠ‚ç‚¹ï¼Œæ¯éš” 1 ç§’ä¼šå¯¹æ•°æ®èŠ‚ç‚¹å‘é€ ping å‘½ä»¤åšå¿ƒè·³æ£€æµ‹ï¼Œå½“è¿™äº›èŠ‚ç‚¹è¶…è¿‡ down-after-milliseconds æ²¡æœ‰è¿›è¡Œæœ‰æ•ˆå›å¤æ—¶ï¼ŒSentinel èŠ‚ç‚¹ä¼šå¯¹è¯¥èŠ‚ç‚¹åšå¤±è´¥åˆ¤å®šï¼Œè¿™ä¸ªè¡Œä¸ºå«åšä¸»è§‚ä¸‹çº¿ã€‚</p>\n<h4 id=\"å®¢è§‚ä¸‹çº¿\"><a href=\"#å®¢è§‚ä¸‹çº¿\" class=\"headerlink\" title=\"å®¢è§‚ä¸‹çº¿\"></a>å®¢è§‚ä¸‹çº¿</h4><p>å®¢è§‚ä¸‹çº¿ï¼Œæ˜¯æŒ‡å½“å¤§å¤šæ•° Sentinel èŠ‚ç‚¹ï¼Œéƒ½è®¤ä¸º master èŠ‚ç‚¹å®•æœºäº†ï¼Œé‚£ä¹ˆè¿™ä¸ªåˆ¤å®šå°±æ˜¯å®¢è§‚çš„ï¼Œå«åšå®¢è§‚ä¸‹çº¿ã€‚</p>\n<p>é‚£ä¹ˆè¿™ä¸ªå¤§å¤šæ•°æ˜¯æŒ‡å¤šå°‘å‘¢ï¼Ÿè¿™å…¶å®å°±æ˜¯åˆ†å¸ƒå¼åè°ƒä¸­çš„ quorum åˆ¤å®šäº†ï¼Œå¤§å¤šæ•°å°±æ˜¯è¿‡åŠæ•°ï¼Œæ¯”å¦‚å“¨å…µæ•°é‡æ˜¯ 5ï¼Œé‚£ä¹ˆå¤§å¤šæ•°å°±æ˜¯ 5&#x2F;2+1&#x3D;3 ä¸ªï¼Œå“¨å…µæ•°é‡æ˜¯ 10 å¤§å¤šæ•°å°±æ˜¯ 10&#x2F;2+1&#x3D;6 ä¸ªã€‚</p>\n<p>æ³¨ï¼šSentinel èŠ‚ç‚¹çš„æ•°é‡è‡³å°‘ä¸º 3 ä¸ªï¼Œå¦åˆ™ä¸æ»¡è¶³ quorum åˆ¤å®šæ¡ä»¶ã€‚</p>\n<h3 id=\"å“¨å…µé€‰ä¸¾\"><a href=\"#å“¨å…µé€‰ä¸¾\" class=\"headerlink\" title=\"å“¨å…µé€‰ä¸¾\"></a>å“¨å…µé€‰ä¸¾</h3><p>å¦‚æœå‘ç”Ÿäº†å®¢è§‚ä¸‹çº¿ï¼Œé‚£ä¹ˆå“¨å…µèŠ‚ç‚¹ä¼šé€‰ä¸¾å‡ºä¸€ä¸ª Leader æ¥è¿›è¡Œå®é™…çš„æ•…éšœè½¬ç§»å·¥ä½œã€‚Redis ä½¿ç”¨äº† Raft ç®—æ³•æ¥å®ç°å“¨å…µé¢†å¯¼è€…é€‰ä¸¾ï¼Œå¤§è‡´æ€è·¯å¦‚ä¸‹ï¼š</p>\n<ol>\n<li>æ¯ä¸ª Sentinel èŠ‚ç‚¹éƒ½æœ‰èµ„æ ¼æˆä¸ºé¢†å¯¼è€…ï¼Œå½“å®ƒä¸»è§‚è®¤ä¸ºæŸä¸ªæ•°æ®èŠ‚ç‚¹å®•æœºåï¼Œä¼šå‘å…¶ä»– Sentinel èŠ‚ç‚¹å‘é€ sentinel is-master-down-by-addr å‘½ä»¤ï¼Œè¦æ±‚è‡ªå·±æˆä¸ºé¢†å¯¼è€…ï¼›</li>\n<li>æ”¶åˆ°å‘½ä»¤çš„ Sentinel èŠ‚ç‚¹ï¼Œå¦‚æœæ²¡æœ‰åŒæ„è¿‡å…¶ä»– Sentinel èŠ‚ç‚¹çš„ sentinelis-master-down-by-addr å‘½ä»¤ï¼Œå°†åŒæ„è¯¥è¯·æ±‚ï¼Œå¦åˆ™æ‹’ç»ï¼ˆæ¯ä¸ª Sentinel èŠ‚ç‚¹åªæœ‰ 1 ç¥¨ï¼‰ï¼›</li>\n<li>å¦‚æœè¯¥ Sentinel èŠ‚ç‚¹å‘ç°è‡ªå·±çš„ç¥¨æ•°å·²ç»å¤§äºç­‰äº MAX(quorum, num(sentinels)&#x2F;2+1)ï¼Œé‚£ä¹ˆå®ƒå°†æˆä¸ºé¢†å¯¼è€…ï¼›</li>\n<li>å¦‚æœæ­¤è¿‡ç¨‹æ²¡æœ‰é€‰ä¸¾å‡ºé¢†å¯¼è€…ï¼Œå°†è¿›å…¥ä¸‹ä¸€æ¬¡é€‰ä¸¾ã€‚</li>\n</ol>\n<h3 id=\"æ•…éšœè½¬ç§»\"><a href=\"#æ•…éšœè½¬ç§»\" class=\"headerlink\" title=\"æ•…éšœè½¬ç§»\"></a><strong>æ•…éšœè½¬ç§»</strong></h3><p>é€‰ä¸¾å‡ºçš„ Leader Sentinel èŠ‚ç‚¹å°†è´Ÿè´£æ•…éšœè½¬ç§»ï¼Œä¹Ÿå°±æ˜¯è¿›è¡Œ master&#x2F;slave èŠ‚ç‚¹çš„ä¸»ä»åˆ‡æ¢ã€‚æ•…éšœè½¬ç§»ï¼Œé¦–å…ˆè¦ä» slave èŠ‚ç‚¹ä¸­ç­›é€‰å‡ºä¸€ä¸ªä½œä¸ºæ–°çš„ masterï¼Œä¸»è¦è€ƒè™‘ä»¥ä¸‹ slave ä¿¡æ¯ï¼š</p>\n<ol>\n<li>è·Ÿ master æ–­å¼€è¿æ¥çš„æ—¶é•¿ï¼šå¦‚æœä¸€ä¸ª slave è·Ÿ master çš„æ–­å¼€è¿æ¥æ—¶é•¿å·²ç»è¶…è¿‡äº† down-after-milliseconds çš„ 10 å€ï¼Œå¤–åŠ  master å®•æœºçš„æ—¶é•¿ï¼Œé‚£ä¹ˆè¯¥ slave å°±è¢«è®¤ä¸ºä¸é€‚åˆé€‰ä¸¾ä¸º masterï¼›</li>\n<li>slave çš„ä¼˜å…ˆçº§é…ç½®ï¼šslave priority å‚æ•°å€¼è¶Šå°ï¼Œä¼˜å…ˆçº§å°±è¶Šé«˜ï¼›</li>\n<li>å¤åˆ¶ offsetï¼šå½“ä¼˜å…ˆçº§ç›¸åŒæ—¶ï¼Œå“ªä¸ª slave å¤åˆ¶äº†è¶Šå¤šçš„æ•°æ®ï¼ˆoffset è¶Šé åï¼‰ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼›</li>\n<li>run idï¼šå¦‚æœ offset å’Œä¼˜å…ˆçº§éƒ½ç›¸åŒï¼Œåˆ™å“ªä¸ª slave çš„ run id è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜ã€‚</li>\n</ol>\n<p>æ¥ç€ï¼Œç­›é€‰å®Œ slave åï¼Œ ä¼šå¯¹å®ƒæ‰§è¡Œ slaveof no one å‘½ä»¤ï¼Œè®©å…¶æˆä¸ºä¸»èŠ‚ç‚¹ã€‚</p>\n<p>æœ€åï¼ŒSentinel é¢†å¯¼è€…èŠ‚ç‚¹ä¼šå‘å‰©ä½™çš„ slave èŠ‚ç‚¹å‘é€å‘½ä»¤ï¼Œè®©å®ƒä»¬æˆä¸ºæ–°çš„ master èŠ‚ç‚¹çš„ä»èŠ‚ç‚¹ï¼Œå¤åˆ¶è§„åˆ™ä¸ parallel-syncs å‚æ•°æœ‰å…³ã€‚</p>\n<p>Sentinel èŠ‚ç‚¹é›†åˆä¼šå°†åŸæ¥çš„ master èŠ‚ç‚¹æ›´æ–°ä¸º slave èŠ‚ç‚¹ï¼Œå¹¶ä¿æŒç€å¯¹å…¶å…³æ³¨ï¼Œå½“å…¶æ¢å¤åå‘½ä»¤å®ƒå»å¤åˆ¶æ–°çš„ä¸»èŠ‚ç‚¹ã€‚</p>\n<p>æ³¨ï¼šLeader Sentinel èŠ‚ç‚¹ï¼Œä¼šä»æ–°çš„ master èŠ‚ç‚¹é‚£é‡Œå¾—åˆ°ä¸€ä¸ª configuration epochï¼Œæœ¬è´¨æ˜¯ä¸ª version ç‰ˆæœ¬å·ï¼Œæ¯æ¬¡ä¸»ä»åˆ‡æ¢çš„ version å·éƒ½å¿…é¡»æ˜¯å”¯ä¸€çš„ã€‚å…¶ä»–çš„å“¨å…µéƒ½æ˜¯æ ¹æ® version æ¥æ›´æ–°è‡ªå·±çš„ master é…ç½®ã€‚</p>\n<h2 id=\"é›†ç¾¤é…ç½®\"><a href=\"#é›†ç¾¤é…ç½®\" class=\"headerlink\" title=\"é›†ç¾¤é…ç½®\"></a>é›†ç¾¤é…ç½®</h2><blockquote>\n<p>é«˜å¯ç”¨ï¼šä¿è¯ Redis ä¸€ç›´å¤„äºå¯ç”¨çŠ¶æ€ï¼Œå³ä½¿å‡ºç°äº†æ•…éšœä¹Ÿæœ‰å¤‡ç”¨æ–¹æ¡ˆä¿è¯å¯ç”¨æ€§</p>\n<p>é«˜å¹¶å‘ï¼šä¸€ä¸ª Redis å®ä¾‹å·²ç»å¯ä»¥æ”¯æŒå¤šè¾¾ 11wå¹¶å‘è¯»æ“ä½œæˆ– 8.1wå¹¶å‘å†™æ“ä½œï¼›ä½†æ˜¯å¦‚æœæœ‰æ›´é«˜å¹¶å‘éœ€æ±‚çš„åº”ç”¨æ¥è¯´ï¼Œå¯ä»¥é€šè¿‡ è¯»å†™åˆ†ç¦»ã€é›†ç¾¤é…ç½® æ¥è§£å†³é«˜å¹¶å‘é—®é¢˜</p>\n</blockquote>\n<ul>\n<li>Redis é›†ç¾¤ä¸­æ¯ä¸ªèŠ‚ç‚¹æ˜¯å¯¹ç­‰çš„ï¼Œæ— ä¸­å¿ƒç»“æ„</li>\n<li>æ•°æ®æŒ‰ç…§ slots åˆ†å¸ƒå¼å­˜å‚¨åœ¨ä¸åŒçš„ Redis èŠ‚ç‚¹ä¸Šï¼ŒèŠ‚ç‚¹ä¸­çš„æ•°æ®å¯å…±äº«ï¼Œå¯ä»¥åŠ¨æ€è°ƒæ•´æ•°æ®åˆ†å¸ƒ</li>\n<li>å¯æ‰©å±•æ€§å¼ºï¼Œå¯ä»¥åŠ¨æ€å¢åˆ èŠ‚ç‚¹ï¼Œæœ€å¤šå¯æ‰©å±•è‡³ 1000+ èŠ‚ç‚¹</li>\n<li>é›†ç¾¤çš„æ¯ä¸ªèŠ‚ç‚¹é€šè¿‡ <code>ä¸»ä»ï¼ˆå“¨å…µæ¨¡å¼ï¼‰</code>ä¿è¯å…¶é«˜å¯ç”¨æ€§</li>\n<li>Redis å¹¶ä¸èƒ½ä¿è¯æ•°æ®çš„å¼ºä¸€è‡´æ€§ï¼Œè¿™æ„å‘³è¿™åœ¨å®é™…ä¸­é›†ç¾¤åœ¨ç‰¹å®šçš„æ¡ä»¶ä¸‹å¯èƒ½ä¼šä¸¢å¤±å†™æ“ä½œ</li>\n<li>Redis é›†ç¾¤ä¹‹é—´æ˜¯å¦‚ä½•å¤åˆ¶çš„ï¼Ÿå¼‚æ­¥å¤åˆ¶</li>\n</ul>\n<blockquote>\n<p><a href=\"https://blog.csdn.net/qq_43846090/article/details/123721066\">Redis_æ•°æ®åˆ†å¸ƒç®—æ³•ï¼šä¼ ç»Ÿå“ˆå¸Œ-ä¸€è‡´æ€§å“ˆå¸Œ-å“ˆå¸Œslot</a></p>\n</blockquote>\n<h3 id=\"ä¼ ç»Ÿå“ˆå¸Œ\"><a href=\"#ä¼ ç»Ÿå“ˆå¸Œ\" class=\"headerlink\" title=\"ä¼ ç»Ÿå“ˆå¸Œ\"></a>ä¼ ç»Ÿå“ˆå¸Œ</h3><p>æœ€ç®€å•çš„æ•°æ®åˆ†å¸ƒç®—æ³•ï¼Œå¯¹è¿›æ¥çš„ key è¿›è¡Œ hashï¼Œç„¶åå¯¹èŠ‚ç‚¹æ•°æ®è¿›è¡Œå–æ¨¡ï¼Œå°±çŸ¥é“åˆ†å¸ƒåˆ°å“ªä¸ªèŠ‚ç‚¹ä¸Šäº†ï¼›<br>ç¼ºç‚¹å°±æ˜¯: å¦‚æœä¸€ä¸ªèŠ‚ç‚¹å®•æœºï¼Œæ‰€æœ‰ç¼“å­˜çš„ä½ç½®éƒ½è¦å‘ç”Ÿæ”¹å˜ï¼Œå½“æœåŠ¡å™¨æ•°é‡å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰ç¼“å­˜åœ¨ä¸€å®šæ—¶é—´å†…æ˜¯å¤±æ•ˆçš„ï¼Œä¼šå¼•èµ·ç¼“å­˜çš„é›ªå´©ï¼Œå¯èƒ½ä¼šå¼•èµ·æ•´ä½“ç³»ç»Ÿå‹åŠ›è¿‡å¤§è€Œå´©æºƒï¼ˆå¤§é‡ç¼“å­˜åŒä¸€æ—¶é—´å¤±æ•ˆï¼‰</p>\n<h3 id=\"ä¸€è‡´æ€§å“ˆå¸Œ\"><a href=\"#ä¸€è‡´æ€§å“ˆå¸Œ\" class=\"headerlink\" title=\"ä¸€è‡´æ€§å“ˆå¸Œ\"></a>ä¸€è‡´æ€§å“ˆå¸Œ</h3><p>å®é™…ä¸Šå°±æ˜¯å¼•å…¥äº†ä¸€ä¸ªåœ†ç¯çš„æ¦‚å¿µï¼Œ è®©æ¯ä¸ªæ•°æ®çš„ hash åˆ†å¸ƒåˆ°æ•´ä¸ªåœ†ç¯ï¼Œç„¶åé¡ºæ—¶é’ˆå»æ‰¾ç¦»ä»–æœ€è¿‘çš„èŠ‚ç‚¹å­˜å‚¨</p>\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650525022243.png\" alt=\"ä¸€è‡´æ€§å“ˆå¸Œ\" style=\"zoom: 50%;\" />\n\n<p>hash ç®—æ³•çš„å–æ¨¡æ³•æ˜¯å¯¹æœåŠ¡å™¨çš„æ•°é‡è¿›è¡Œå–æ¨¡ï¼Œè€Œä¸€è‡´æ€§å“ˆå¸Œç®—æ³•æ˜¯å¯¹ 2^32 å–æ¨¡ï¼Œ<br>dubbo çš„å¤æ‚å‡è¡¡æœ‰ç”¨åˆ°è¯¥ç®—æ³•ï¼›</p>\n<p>å¥½å¤„:</p>\n<p>ä½¿ç”¨ hash ç®—æ³•ï¼ŒæœåŠ¡å™¨æ•°é‡å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰æœåŠ¡å™¨çš„æ‰€æœ‰ç¼“å­˜åœ¨åŒä¸€æ—¶é—´å¤±æ•ˆäº†ï¼›<br>è€Œä½¿ç”¨ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•æ—¶ï¼ŒæœåŠ¡å™¨çš„æ•°é‡å¦‚æœå‘ç”Ÿæ”¹å˜ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰ç¼“å­˜éƒ½ä¼šå¤±æ•ˆï¼Œè€Œæ˜¯åªæœ‰éƒ¨åˆ†ç¼“å­˜ä¼šå¤±æ•ˆã€‚ä¸Šå›¾ä¸­å¦‚æœèŠ‚ç‚¹ A å¤±æ•ˆï¼Œåˆ™ C â†’ A ä¹‹é—´çš„æ•°æ®ä¼šé‡æ–°ç¼“å­˜åˆ°èŠ‚ç‚¹ B ä¸Šã€‚</p>\n<p>hash ç¯åæ–œï¼š</p>\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650525154544.png\" alt=\"hash ç¯åæ–œ\" style=\"zoom: 50%;\" />\n\n<p>1 å·ã€2 å·ã€3 å·ã€4 å·ã€6 å·æ•°æ®å‡è¢«ç¼“å­˜åœ¨äº†æœåŠ¡å™¨ A ä¸Šï¼›åªæœ‰ 5 å·è¢«ç¼“å­˜åœ¨äº†æœåŠ¡å™¨ B ä¸Šï¼›æœåŠ¡å™¨ C ä¸Šç”šè‡³æ²¡æœ‰ç¼“å­˜ä»»ä½•å›¾ç‰‡<br>å¦‚æœå‡ºç°ä¸Šå›¾ä¸­çš„æƒ…å†µï¼ŒAã€Bã€C ä¸‰å°æœåŠ¡å™¨å¹¶æ²¡æœ‰è¢«åˆç†çš„å¹³å‡çš„å……åˆ†åˆ©ç”¨ï¼Œç¼“å­˜åˆ†å¸ƒçš„æåº¦ä¸å‡åŒ€ï¼Œè€Œä¸”ï¼Œå¦‚æœæ­¤æ—¶æœåŠ¡å™¨ A å‡ºç°æ•…éšœï¼Œé‚£ä¹ˆå¤±æ•ˆç¼“å­˜çš„æ•°é‡ä¹Ÿå°†è¾¾åˆ°æœ€å¤§å€¼ï¼Œåœ¨æç«¯æƒ…å†µä¸‹ï¼Œä»ç„¶æœ‰å¯èƒ½å¼•èµ·ç³»ç»Ÿçš„å´©æºƒï¼›</p>\n<p>ä¸Šå›¾ä¸­çš„æƒ…å†µåˆ™è¢«ç§°ä¹‹ä¸º hash ç¯çš„åæ–œ ï¼›<br>æˆ‘ä»¬åº”è¯¥æ€æ ·é˜²æ­¢ hash ç¯çš„åæ–œï¼Ÿ<br>å¢åŠ è™šæ‹ŸèŠ‚ç‚¹ï¼š</p>\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650525203417.png\" alt=\"å¢åŠ è™šæ‹ŸèŠ‚ç‚¹é˜²æ­¢ hash ç¯çš„åæ–œ\" style=\"zoom:50%;\" />\n\n<p>ä¸ºäº†è§£å†³è¿™ä¸ªæ•°æ®è´Ÿè½½å‡è¡¡çš„é—®é¢˜ï¼Œæå‡ºæ¥è™šæ‹ŸèŠ‚ç‚¹ï¼ŒæŠŠçœŸå®èŠ‚ç‚¹æä¸€å †è™šæ‹ŸèŠ‚ç‚¹åˆ†å¸ƒåˆ°ç¯ï¼Œé‚£ä¹ˆæ•´ä¸ªåŒºé—´çš„æ•°æ®ä¼šè½åˆ°è¿™äº›è™šæ‹ŸèŠ‚ç‚¹ä¸Šï¼›</p>\n<p>è™šæ‹ŸèŠ‚ç‚¹è¶Šå¤šï¼Œhash ç¯ä¸Šçš„èŠ‚ç‚¹å°±è¶Šå¤šï¼Œç¼“å­˜è¢«å‡åŒ€åˆ†å¸ƒçš„æ¦‚ç‡å°±è¶Šå¤§ã€‚</p>\n<h3 id=\"å“ˆå¸Œæ§½\"><a href=\"#å“ˆå¸Œæ§½\" class=\"headerlink\" title=\"å“ˆå¸Œæ§½\"></a>å“ˆå¸Œæ§½</h3><p>Redis é›†ç¾¤ï¼ˆclusterï¼‰å¹¶æ²¡æœ‰é€‰ç”¨ä¸Šé¢ä¸€è‡´æ€§å“ˆå¸Œï¼Œè€Œæ˜¯é‡‡ç”¨äº†å“ˆå¸Œæ§½ï¼ˆslotï¼‰çš„è¿™ç§æ¦‚å¿µã€‚ä¸»è¦çš„åŸå› å°±æ˜¯ä¸Šé¢æ‰€è¯´çš„ï¼Œä¸€è‡´æ€§å“ˆå¸Œç®—æ³•å¯¹äºæ•°æ®åˆ†å¸ƒã€èŠ‚ç‚¹ä½ç½®çš„æ§åˆ¶å¹¶ä¸æ˜¯å¾ˆå‹å¥½ã€‚</p>\n<p>é¦–å…ˆå“ˆå¸Œæ§½å…¶å®æ˜¯ä¸¤ä¸ªæ¦‚å¿µï¼Œç¬¬ä¸€ä¸ªæ˜¯å“ˆå¸Œç®—æ³•ã€‚Redis cluster çš„ hash ç®—æ³•ä¸æ˜¯ç®€å•çš„ hash()ï¼Œè€Œæ˜¯ crc16 ç®—æ³•ï¼Œä¸€ç§æ ¡éªŒç®—æ³•ã€‚å¦å¤–ä¸€ä¸ªå°±æ˜¯æ§½ä½çš„æ¦‚å¿µï¼Œç©ºé—´åˆ†é…çš„è§„åˆ™ã€‚å…¶å®å“ˆå¸Œæ§½çš„æœ¬è´¨å’Œä¸€è‡´æ€§å“ˆå¸Œç®—æ³•éå¸¸ç›¸ä¼¼ï¼Œä¸åŒç‚¹å°±æ˜¯å¯¹äºå“ˆå¸Œç©ºé—´çš„å®šä¹‰ã€‚ä¸€è‡´æ€§å“ˆå¸Œçš„ç©ºé—´æ˜¯ä¸€ä¸ªåœ†ç¯ï¼ŒèŠ‚ç‚¹åˆ†å¸ƒæ˜¯åŸºäºåœ†ç¯çš„ï¼Œæ— æ³•å¾ˆå¥½çš„æ§åˆ¶æ•°æ®åˆ†å¸ƒã€‚è€Œ Redis cluster çš„æ§½ä½ç©ºé—´æ˜¯è‡ªå®šä¹‰åˆ†é…çš„ï¼Œç±»ä¼¼äº windows ç›˜åˆ†åŒºçš„æ¦‚å¿µã€‚è¿™ç§åˆ†åŒºæ˜¯å¯ä»¥è‡ªå®šä¹‰å¤§å°ï¼Œè‡ªå®šä¹‰ä½ç½®çš„ã€‚</p>\n<p>Redis cluster åŒ…å«äº† 16384 ä¸ªå“ˆå¸Œæ§½ï¼Œæ¯ä¸ª key é€šè¿‡è®¡ç®—åéƒ½ä¼šè½åœ¨å…·ä½“ä¸€ä¸ªæ§½ä½ä¸Šï¼Œè€Œè¿™ä¸ªæ§½ä½æ˜¯å±äºå“ªä¸ªå­˜å‚¨èŠ‚ç‚¹çš„ï¼Œåˆ™ç”±ç”¨æˆ·è‡ªå·±å®šä¹‰åˆ†é…ã€‚ä¾‹å¦‚æœºå™¨ç¡¬ç›˜å°çš„ï¼Œå¯ä»¥åˆ†é…å°‘ä¸€ç‚¹æ§½ä½ï¼Œç¡¬ç›˜å¤§çš„å¯ä»¥åˆ†é…å¤šä¸€ç‚¹ã€‚å¦‚æœèŠ‚ç‚¹ç¡¬ç›˜éƒ½å·®ä¸å¤šåˆ™å¯ä»¥å¹³å‡åˆ†é…ã€‚æ‰€ä»¥å“ˆå¸Œæ§½è¿™ç§æ¦‚å¿µå¾ˆå¥½åœ°è§£å†³äº†ä¸€è‡´æ€§å“ˆå¸Œçš„å¼Šç«¯ã€‚</p>\n<p><strong>ä¸ºä»€ä¹ˆå“ˆå¸Œæ§½çš„å¤§å°æ˜¯å›ºå®šçš„16384ï¼Ÿ</strong></p>\n<blockquote>\n<p><code>CRC16</code>ç®—æ³•äº§ç”Ÿçš„hashå€¼æœ‰16bitï¼Œè¯¥ç®—æ³•å¯ä»¥äº§ç”Ÿ2^16-&#x3D;65536ä¸ªå€¼ã€‚æ¢å¥è¯è¯´ï¼Œå€¼æ˜¯åˆ†å¸ƒåœ¨0~65535ä¹‹é—´ã€‚é‚£ä½œè€…åœ¨åš<code>mod</code>è¿ç®—çš„æ—¶å€™ï¼Œä¸ºä»€ä¹ˆä¸<code>mod</code>65536ï¼Œè€Œé€‰æ‹©<code>mod</code>16384ï¼Ÿ</p>\n</blockquote>\n<p><strong>ä¸èƒ½å¤ªå¤§ï¼Œä¸»è¦ä»èŠ‚ç‚¹é—´çš„é€šä¿¡æ€§èƒ½æ–¹é¢è€ƒè™‘ï¼š</strong></p>\n<p>æ¯ä¸ªèŠ‚ç‚¹ä¹‹é—´æ˜¯éœ€è¦è¿›è¡Œä¸€ä¸ªé€šä¿¡çš„ï¼Œä¹Ÿå°±æ˜¯ä¸æ–­åœ° pingpong æœºåˆ¶ï¼Œè®©æ¯ä¸ªèŠ‚ç‚¹è¿æ¥å¯¹æ–¹çš„ä¿¡æ¯ï¼›å‘é€çš„æ¶ˆæ¯å¤´ä¸­æœ‰ä¸€ä¸ª bitmapï¼Œå…¶ä¸­æ¯ä¸€ä½ä»£è¡¨ä¸€ä¸ªæ§½ï¼Œå¦‚æœè¯¥ä½ä¸º 1ï¼Œè¡¨ç¤ºè¿™ä¸ªæ§½æ˜¯å±äºå½“å‰èŠ‚ç‚¹ï¼Œå¦‚æœæ§½ä½è¿‡å¤§ï¼Œé‚£ä¹ˆè¿™ä¸ª bitmap å°±ä¼šå¤ªå¤§ï¼Œå¿ƒè·³åŒ…è¿‡äºåºå¤§ï¼Œæµªè´¹å¸¦å®½ã€‚</p>\n<p><strong>ä¸èƒ½å¤ªå°ï¼Œä¸»è¦ä»å‹ç¼©ç‡æ–¹é¢è€ƒè™‘ï¼š</strong></p>\n<p>ç”±äº bitmap åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ä¼šè¿›è¡Œå‹ç¼©ï¼Œbitmap çš„å¡«å……ç‡ç”¨ slots&#x2F;N è¡¨ç¤ºï¼ˆN å³èŠ‚ç‚¹æ•°ï¼‰ï¼Œå¯¹äºåŒæ ·çš„ slotsï¼Œå¦‚æœ N å¤ªå°ï¼Œå¯¼è‡´å…¶å¡«å……ç‡è¿‡é«˜ï¼Œå‹ç¼©ç‡å°±å¾ˆä½ã€‚</p>\n<hr>\n<h2 id=\"ç¼“å­˜ç©¿é€ã€å‡»ç©¿ã€é›ªå´©\"><a href=\"#ç¼“å­˜ç©¿é€ã€å‡»ç©¿ã€é›ªå´©\" class=\"headerlink\" title=\"ç¼“å­˜ç©¿é€ã€å‡»ç©¿ã€é›ªå´©\"></a>ç¼“å­˜ç©¿é€ã€å‡»ç©¿ã€é›ªå´©</h2><h3 id=\"ç¼“å­˜ç©¿é€\"><a href=\"#ç¼“å­˜ç©¿é€\" class=\"headerlink\" title=\"ç¼“å­˜ç©¿é€\"></a>ç¼“å­˜ç©¿é€</h3><p><strong>é—®é¢˜æ¥æº</strong></p>\n<p>ç¼“å­˜ç©¿é€æ˜¯æŒ‡ç¼“å­˜å’Œæ•°æ®åº“ä¸­éƒ½æ²¡æœ‰çš„æ•°æ®ï¼Œè€Œç”¨æˆ·ä¸æ–­å‘èµ·è¯·æ±‚ã€‚ç”±äºç¼“å­˜æ˜¯ä¸å‘½ä¸­æ—¶è¢«åŠ¨å†™çš„ï¼Œå¹¶ä¸”å‡ºäºå®¹é”™è€ƒè™‘ï¼Œå¦‚æœä»å­˜å‚¨å±‚æŸ¥ä¸åˆ°æ•°æ®åˆ™ä¸å†™å…¥ç¼“å­˜ï¼Œè¿™å°†å¯¼è‡´è¿™ä¸ªä¸å­˜åœ¨çš„æ•°æ®æ¯æ¬¡è¯·æ±‚éƒ½è¦åˆ°å­˜å‚¨å±‚å»æŸ¥è¯¢ï¼Œå¤±å»äº†ç¼“å­˜çš„æ„ä¹‰ã€‚åœ¨æµé‡å¤§æ—¶ï¼Œå¯èƒ½ DB å°±æŒ‚æ‰äº†ï¼Œè¦æ˜¯æœ‰äººåˆ©ç”¨ä¸å­˜åœ¨çš„ key é¢‘ç¹æ”»å‡»æˆ‘ä»¬çš„åº”ç”¨ï¼Œæ¯æ¬¡éƒ½å» DB åˆ¤æ–­ç„¶è€Œåˆä¸èƒ½å¤åˆ¶åˆ° Redis ä¸­ï¼Œè¿™å°±æ˜¯æ¼æ´ã€‚</p>\n<p>ä¾‹å¦‚å‘èµ·ä¸º id ä¸ºâ€œ-1â€çš„æ•°æ®æˆ– id ä¸ºç‰¹åˆ«å¤§ä¸å­˜åœ¨çš„æ•°æ®ã€‚è¿™æ—¶çš„ç”¨æˆ·å¾ˆå¯èƒ½æ˜¯æ”»å‡»è€…ï¼Œæ”»å‡»ä¼šå¯¼è‡´æ•°æ®åº“å‹åŠ›è¿‡å¤§ã€‚</p>\n<p><strong>è§£å†³æ–¹æ¡ˆ</strong></p>\n<ol>\n<li><p><strong>æ¥å£æ ¡éªŒ</strong>ï¼šæ¥å£å±‚å¢åŠ æ ¡éªŒï¼Œä¾‹å¦‚å¯¹ id&lt;&#x3D;0 çš„ç›´æ¥æ‹¦æˆªã€‚</p>\n</li>\n<li><p><strong>ç¼“å­˜ç©ºå€¼</strong>ï¼šä»ç¼“å­˜å–ä¸åˆ°çš„æ•°æ®ï¼Œåœ¨æ•°æ®åº“ä¸­ä¹Ÿæ²¡æœ‰å–åˆ°ï¼Œè¿™æ—¶ä¹Ÿå¯ä»¥å°† key-value å¯¹å†™ä¸º key-nullï¼Œç¼“å­˜æœ‰æ•ˆæ—¶é—´å¯ä»¥è®¾ç½®çŸ­ç‚¹ï¼Œå¦‚ 10 ç§’ï¼ˆè®¾ç½®å¤ªé•¿ä¼šå¯¼è‡´æ­£å¸¸æƒ…å†µä¹Ÿæ²¡æ³•ä½¿ç”¨ï¼‰ã€‚</p>\n</li>\n<li><p><strong>å¸ƒéš†è¿‡æ»¤å™¨</strong>ï¼šå¸ƒéš†è¿‡æ»¤å™¨ç”¨äºå¿«é€Ÿåˆ¤æŸä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨äºé›†åˆä¸­ï¼Œç”±ä¸€ä¸ªå¾ˆé•¿çš„äºŒè¿›åˆ¶å‘é‡ï¼ˆä½å›¾ï¼‰å’Œä¸€ç³»åˆ—å“ˆå¸Œå‡½æ•°ä¸¤éƒ¨åˆ†ç»„æˆã€‚å¸ƒéš†è¿‡æ»¤å™¨å¯ä»¥ç”¨äºæ£€ç´¢ä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨ä¸€ä¸ªé›†åˆä¸­ã€‚å®ƒçš„ä¼˜ç‚¹æ˜¯ç©ºé—´æ•ˆç‡å’ŒæŸ¥è¯¢æ—¶é—´éƒ½è¿œè¿œè¶…è¿‡ä¸€èˆ¬çš„ç®—æ³•ï¼Œç¼ºç‚¹æ˜¯æœ‰ä¸€å®šçš„é”™è¯¯è¯†åˆ«ç‡ï¼Œæ·»åŠ åˆ°é›†åˆä¸­çš„å…ƒç´ è¶Šå¤šï¼Œè¯¯æŠ¥çš„å¯èƒ½æ€§å°±è¶Šå¤§ã€‚</p>\n<p> ä½æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½åªå ç”¨ 1 bit ï¼Œå¹¶ä¸”æ¯ä¸ªå…ƒç´ åªèƒ½æ˜¯ 0 æˆ–è€… 1ã€‚è¿™æ ·ç”³è¯·ä¸€ä¸ª 100w ä¸ªå…ƒç´ çš„ä½æ•°ç»„åªå ç”¨ 1000000Bit &#x2F; 8 &#x3D; 125000 Byte &#x3D; 125000&#x2F;1024 kb â‰ˆ 122kb çš„ç©ºé—´ã€‚</p>\n<blockquote>\n<p><a href=\"https://javaguide.cn/cs-basics/data-structure/bloom-filter.html\">å¸ƒéš†è¿‡æ»¤å™¨</a></p>\n<p><a href=\"https://javaguide.cn/database/Redis/Redis-questions-01.html#%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F\">ç¼“å­˜ç©¿é€-å¸ƒéš†è¿‡æ»¤å™¨</a></p>\n</blockquote>\n<p> å…·ä½“è€Œè¨€ï¼š</p>\n<p> æŠŠ <strong>æ‰€æœ‰å¯èƒ½å­˜åœ¨çš„è¯·æ±‚çš„å€¼</strong> éƒ½å­˜æ”¾åœ¨å¸ƒéš†è¿‡æ»¤å™¨ä¸­ï¼Œå½“ç”¨æˆ·è¯·æ±‚è¿‡æ¥ï¼Œå…ˆåˆ¤æ–­ç”¨æˆ·å‘æ¥çš„è¯·æ±‚çš„å€¼æ˜¯å¦å­˜åœ¨äºå¸ƒéš†è¿‡æ»¤å™¨ä¸­ã€‚å¸ƒéš†è¿‡æ»¤å™¨åˆ¤æ–­ä¸å­˜åœ¨çš„è¯ï¼Œåˆ™è‚¯å®šä¸å­˜åœ¨ï¼Œå¸ƒéš†è¿‡æ»¤å™¨åˆ¤æ–­å­˜åœ¨ï¼Œåˆ™è¿›ä¸€æ­¥æŸ¥ Redisï¼ŒRedis ä¸­å­˜åœ¨åˆ™è¿”å›ï¼ŒRedis ä¸­ä¸å­˜åœ¨åˆ™æŸ¥æ•°æ®åº“ã€‚</p>\n<p> ä¸ºä»€ä¹ˆå¸ƒéš†è¿‡æ»¤å™¨ä¼šå‡ºç°è¯¯åˆ¤çš„æƒ…å†µå‘¢? </p>\n<p> <strong>å½“ä¸€ä¸ªå…ƒç´ åŠ å…¥å¸ƒéš†è¿‡æ»¤å™¨ä¸­çš„æ—¶å€™ï¼Œä¼šè¿›è¡Œä»¥ä¸‹æ“ä½œï¼š</strong></p>\n<ol>\n<li><p>ä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨ä¸­çš„å“ˆå¸Œå‡½æ•°å¯¹å…ƒç´ å€¼è¿›è¡Œè®¡ç®—ï¼Œå¾—åˆ°å“ˆå¸Œå€¼ï¼ˆæœ‰å‡ ä¸ªå“ˆå¸Œå‡½æ•°å¾—åˆ°å‡ ä¸ªå“ˆå¸Œå€¼ï¼‰ã€‚</p>\n<blockquote>\n<p>hashVal1 &#x3D; hashMethod1(key)ï¼Œ hashVal2&#x3D; hashMethod2(key)â€¦</p>\n</blockquote>\n</li>\n<li><p>æ ¹æ®å¾—åˆ°çš„å“ˆå¸Œå€¼ï¼Œåœ¨ä½æ•°ç»„ä¸­æŠŠå¯¹åº”ä¸‹æ ‡çš„å€¼ç½®ä¸º 1ã€‚</p>\n<blockquote>\n<p>æŠŠä½æ•°ç»„ä¸­çš„ hashVal1 å’Œ hashVal2 å¤„ç½®ä¸º 1</p>\n</blockquote>\n</li>\n</ol>\n<p> <strong>å½“æˆ‘ä»¬éœ€è¦åˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨äºå¸ƒéš†è¿‡æ»¤å™¨çš„æ—¶å€™ï¼Œä¼šè¿›è¡Œä»¥ä¸‹æ“ä½œï¼š</strong></p>\n<ol>\n<li><p>å¯¹ç»™å®šå…ƒç´ å†æ¬¡è¿›è¡Œç›¸åŒçš„å“ˆå¸Œè®¡ç®—ï¼›</p>\n<blockquote>\n<p>hashVal1 &#x3D; hashMethod1(key)ï¼Œ hashVal2&#x3D; hashMethod2(key)â€¦</p>\n</blockquote>\n</li>\n<li><p>å¾—åˆ°å€¼ä¹‹ååˆ¤æ–­ä½æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ æ˜¯å¦éƒ½ä¸º 1ï¼Œå¦‚æœå€¼éƒ½ä¸º 1ï¼Œé‚£ä¹ˆè¯´æ˜è¿™ä¸ªå€¼åœ¨å¸ƒéš†è¿‡æ»¤å™¨ä¸­ï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ªå€¼ä¸ä¸º 1ï¼Œè¯´æ˜è¯¥å…ƒç´ ä¸åœ¨å¸ƒéš†è¿‡æ»¤å™¨ä¸­ã€‚</p>\n<blockquote>\n<p>åˆ¤æ–­ä½æ•°ç»„ä¸­çš„ hashVal1 å’Œ hashVal2 å¤„æ˜¯å¦å…¨éƒ¨ä¸º 1ï¼Œå…¨éƒ¨ä¸º 1è¯´æ˜å½“å‰å…ƒç´ å­˜åœ¨äºä½æ•°ç»„ä¸­ã€‚</p>\n</blockquote>\n</li>\n</ol>\n<p> ç„¶è€Œä¼šå‡ºç°è¿™æ ·ä¸€ç§æƒ…å†µï¼š<strong>ä¸åŒçš„å­—ç¬¦ä¸²å¯èƒ½å“ˆå¸Œå‡ºæ¥çš„ä½ç½®ç›¸åŒã€‚</strong> ï¼ˆå¯ä»¥é€‚å½“å¢åŠ ä½æ•°ç»„å¤§å°æˆ–è€…è°ƒæ•´æˆ‘ä»¬çš„å“ˆå¸Œå‡½æ•°æ¥é™ä½æ¦‚ç‡ï¼‰</p>\n<blockquote>\n<p><strong>â­ä¾‹å¦‚</strong>ï¼šval1 ç»è¿‡ä¸¤æ¬¡hashå¾—åˆ°ä¸‹æ ‡ 1ï¼Œ 3ï¼Œå°†1ã€3å¤„ç½®ä¸º1ï¼Œval2ç»è¿‡ä¸¤æ¬¡hashå¾—åˆ°ä¸‹æ ‡2ã€4ï¼Œå°†2ã€4å¤„ç½®ä¸º1ï¼Œå¯¹äºæ–°å…ƒç´ val3ç»è¿‡ä¸¤æ¬¡hashå¾—åˆ°ä¸‹æ ‡1ã€2ï¼Œåˆ¤æ–­è¿™ä¸¤ä¸ªä½ç½®éƒ½ä¸º1ï¼Œè¯¯åˆ¤ä»¥ä¸ºval3å­˜åœ¨ï¼Œå®é™…ä¸Šä¸å­˜åœ¨ã€‚</p>\n</blockquote>\n</li>\n</ol>\n<h3 id=\"ç¼“å­˜å‡»ç©¿\"><a href=\"#ç¼“å­˜å‡»ç©¿\" class=\"headerlink\" title=\"ç¼“å­˜å‡»ç©¿\"></a>ç¼“å­˜å‡»ç©¿</h3><p><strong>é—®é¢˜æ¥æº</strong></p>\n<p>ç¼“å­˜å‡»ç©¿æ˜¯æŒ‡ä¸€ä¸ªçƒ­ç‚¹çš„ keyï¼Œæœ‰å¤§å¹¶å‘é›†ä¸­å¯¹å…¶è¿›è¡Œè®¿é—®ï¼Œçªç„¶é—´è¿™ä¸ª key å¤±æ•ˆäº†ï¼Œå¯¼è‡´å¤§å¹¶å‘å…¨éƒ¨æ‰“åœ¨æ•°æ®åº“ä¸Šï¼Œå¯¼è‡´æ•°æ®åº“å‹åŠ›å‰§å¢ã€‚è¿™ç§ç°è±¡å°±å«åšç¼“å­˜å‡»ç©¿ã€‚</p>\n<p><strong>è§£å†³æ–¹æ¡ˆ</strong></p>\n<blockquote>\n<p>çƒ­ç‚¹keyå¤±æ•ˆ â†’ æ‰“åˆ°æ•°æ®åº“ä¸Šï¼Œå› æ­¤å¯ä»¥ä»è¿™ä¸¤æ–¹é¢è¿›è¡Œè§£å†³</p>\n</blockquote>\n<p>1ã€è®¾ç½®çƒ­ç‚¹æ•°æ®æ°¸è¿œä¸è¿‡æœŸã€‚</p>\n<p>2ã€æ¥å£é™æµã€é™çº§ä¸ç†”æ–­ã€‚é‡è¦çš„æ¥å£ä¸€å®šè¦åšå¥½é™æµç­–ç•¥ï¼Œé˜²æ­¢ç”¨æˆ·æ¶æ„åˆ·æ¥å£ï¼ŒåŒæ—¶è¦é™çº§å‡†å¤‡ï¼Œå½“æ¥å£ä¸­çš„æŸäº›æœåŠ¡ä¸å¯ç”¨æ—¶å€™ï¼Œè¿›è¡Œç†”æ–­ï¼Œå¤±è´¥å¿«é€Ÿè¿”å›æœºåˆ¶ã€‚</p>\n<p>3ã€åŠ äº’æ–¥é”ï¼šå¦‚æœç¼“å­˜å¤±æ•ˆçš„æƒ…å†µï¼Œåªæœ‰æ‹¿åˆ°é”æ‰å¯ä»¥æŸ¥è¯¢æ•°æ®åº“ï¼Œåˆ†å¸ƒå¼åœºæ™¯ä¸‹å¯ä»¥ä½¿ç”¨åˆ†å¸ƒå¼é”ã€‚</p>\n<h3 id=\"ç¼“å­˜é›ªå´©\"><a href=\"#ç¼“å­˜é›ªå´©\" class=\"headerlink\" title=\"ç¼“å­˜é›ªå´©\"></a>ç¼“å­˜é›ªå´©</h3><p><strong>é—®é¢˜æ¥æº</strong></p>\n<p>ç¼“å­˜é›ªå´©æ˜¯æŒ‡ç¼“å­˜ä¸­æ•°æ®å¤§æ‰¹é‡åˆ°è¿‡æœŸæ—¶é—´ï¼Œè€ŒæŸ¥è¯¢æ•°æ®é‡å·¨å¤§ï¼Œå¼•èµ·æ•°æ®åº“å‹åŠ›è¿‡å¤§ç”šè‡³ down æœºã€‚å’Œç¼“å­˜å‡»ç©¿ä¸åŒçš„æ˜¯ï¼Œç¼“å­˜å‡»ç©¿æŒ‡å¹¶å‘æŸ¥åŒä¸€æ¡æ•°æ®ï¼Œç¼“å­˜é›ªå´©æ˜¯æŒ‡å¾ˆå¤šä¸åŒçš„æ•°æ®éƒ½è¿‡æœŸäº†ï¼Œéƒ½æŸ¥ä¸åˆ°ä»è€ŒæŸ¥æ•°æ®åº“ã€‚</p>\n<p><strong>è§£å†³æ–¹æ¡ˆ</strong></p>\n<ol>\n<li><strong>ç¼“å­˜æ•°æ®çš„è¿‡æœŸæ—¶é—´è®¾ç½®éšæœº</strong>ï¼Œé˜²æ­¢åŒä¸€æ—¶é—´å¤§é‡æ•°æ®è¿‡æœŸç°è±¡å‘ç”Ÿã€‚</li>\n<li>è®¾ç½®çƒ­ç‚¹æ•°æ®æ°¸è¿œä¸è¿‡æœŸã€‚</li>\n<li>åœ¨å³å°†å‘ç”Ÿå¤§å¹¶å‘è®¿é—®ä¹‹å‰ï¼Œè¿›è¡Œ<strong>ç¼“å­˜é¢„çƒ­</strong>å°†å¯èƒ½å¤§é‡è®¿é—®çš„æ•°æ®åŠ è½½åˆ°ç¼“å­˜ã€‚</li>\n<li>æ¥å£é™æµã€é™çº§ä¸ç†”æ–­ã€‚é‡è¦çš„æ¥å£ä¸€å®šè¦åšå¥½é™æµç­–ç•¥ï¼Œé˜²æ­¢ç”¨æˆ·æ¶æ„åˆ·æ¥å£ï¼ŒåŒæ—¶è¦é™çº§å‡†å¤‡ï¼Œå½“æ¥å£ä¸­çš„æŸäº›æœåŠ¡ä¸å¯ç”¨æ—¶å€™ï¼Œè¿›è¡Œç†”æ–­ï¼Œå¤±è´¥å¿«é€Ÿè¿”å›æœºåˆ¶ã€‚</li>\n<li>ä¸ºäº†é˜²æ­¢ Redis å®•æœºå¯¼è‡´ç¼“å­˜é›ªå´©çš„é—®é¢˜ï¼Œå¯ä»¥<strong>æ­å»ºRedisé›†ç¾¤</strong>ï¼Œæé«˜ Redis çš„å®¹ç¾æ€§ã€‚</li>\n<li>æé«˜æ•°æ®åº“çš„å®¹ç¾èƒ½åŠ›ï¼Œå¯ä»¥ä½¿ç”¨<strong>æ•°æ®åº“åˆ†åº“åˆ†è¡¨</strong>ï¼Œè¯»å†™åˆ†ç¦»çš„ç­–ç•¥ã€‚</li>\n</ol>\n<h2 id=\"Redis-æ·˜æ±°ç­–ç•¥\"><a href=\"#Redis-æ·˜æ±°ç­–ç•¥\" class=\"headerlink\" title=\"Redis æ·˜æ±°ç­–ç•¥\"></a>Redis æ·˜æ±°ç­–ç•¥</h2><h3 id=\"Redis-å†…å­˜æ·˜æ±°ç­–ç•¥\"><a href=\"#Redis-å†…å­˜æ·˜æ±°ç­–ç•¥\" class=\"headerlink\" title=\"Redis å†…å­˜æ·˜æ±°ç­–ç•¥\"></a>Redis å†…å­˜æ·˜æ±°ç­–ç•¥</h3><blockquote>\n<p>Redis æ˜¯åŸºäºå†…å­˜ç»“æ„è¿›è¡Œæ•°æ®ç¼“å­˜çš„ï¼Œå½“å†…å­˜èµ„æºæ¶ˆè€—å®Œæ¯•ï¼Œå½“å°†è¦æœ‰æ–°çš„æ•°æ®ç¼“å­˜è¿›æ¥æ—¶ï¼Œä¸ºäº†è…¾å‡ºç©ºé—´æ”¾æ–°çš„æ•°æ®ï¼Œéœ€è¦å°†å†…å­˜ä¸­çš„ä¸€äº›æ•°æ®é‡Šæ”¾æ‰ï¼Œè¿™ç§é‡Šæ”¾æ•°æ®çš„ç­–ç•¥ç§°ä¸º Redis çš„æ·˜æ±°ç­–ç•¥ã€‚</p>\n</blockquote>\n<p>LRUï¼šLeast Recently Used</p>\n<p>LFUï¼šLeast Frequently Used</p>\n<p>LRU æ·˜æ±°çš„æ˜¯æœ€ä¹…æœªè®¿é—®åˆ°çš„æ•°æ®ï¼Œè€Œ LFU æ˜¯æ·˜æ±°çš„æ˜¯æœ€ä¸ç»å¸¸ä½¿ç”¨çš„æ•°æ®ï¼ˆè‹¥ä¸¤ä¸ªæˆ–å¤šä¸ªæ•°æ®çš„ä½¿ç”¨é¢‘ç‡ç›¸åŒæ—¶ï¼ŒLFU ä¼šå†é€‰æ‹©æœ€ä¹…æœªè®¿é—®åˆ°çš„æ•°æ®æ·˜æ±°ï¼‰ã€‚</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># volatile-lru -&gt; åœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„æ•°æ®ä¸­ä½¿ç”¨ LRU</span><br><span class=\"line\"># allkeys-lru -&gt; åœ¨æ‰€æœ‰æ•°æ®ä¸­ä½¿ç”¨ LRU</span><br><span class=\"line\"># volatile-lfu -&gt; åœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„æ•°æ®ä¸­ä½¿ç”¨ LFU</span><br><span class=\"line\"># allkeys-lfu -&gt; åœ¨æ‰€æœ‰æ•°æ®ä¸­ä½¿ç”¨ LFU</span><br><span class=\"line\"># volatile-random -&gt; åœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„æ•°æ®ä¸­éšæœºæ·˜æ±°</span><br><span class=\"line\"># allkeys-random -&gt; åœ¨æ‰€æœ‰æ•°æ®ä¸­éšæœºæ·˜æ±°</span><br><span class=\"line\"># volatile-ttl -&gt; è¶Šæ—©è¿‡æœŸçš„æ•°æ® è¶Šå…ˆè¢«æ·˜æ±°</span><br><span class=\"line\"># noeviction -&gt; ä¸æ·˜æ±°ä»»ä½•æ•°æ®ï¼Œå½“å†…å­˜ä¸å¤Ÿæ—¶ç›´æ¥æŠ›å‡ºå¼‚å¸¸</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Redis-ç¼“å­˜å¤±æ•ˆç­–ç•¥\"><a href=\"#Redis-ç¼“å­˜å¤±æ•ˆç­–ç•¥\" class=\"headerlink\" title=\"Redis ç¼“å­˜å¤±æ•ˆç­–ç•¥\"></a>Redis ç¼“å­˜å¤±æ•ˆç­–ç•¥</h3><p><strong>å®šæ—¶è¿‡æœŸç­–ç•¥</strong></p>\n<p>æ¯ä¸ªè®¾ç½®è¿‡æœŸæ—¶é—´çš„ key éƒ½éœ€è¦åˆ›å»ºä¸€ä¸ªå®šæ—¶å™¨ï¼Œåˆ°è¿‡æœŸæ—¶é—´å°±ä¼šç«‹å³æ¸…é™¤ã€‚è¯¥ç­–ç•¥å¯ä»¥ç«‹å³æ¸…é™¤è¿‡æœŸçš„æ•°æ®ï¼Œå¯¹å†…å­˜å¾ˆå‹å¥½ï¼Œæœ‰æ•ˆåœ°å‡å°‘äº†å› ä¸ºè¿‡æœŸé”®å¸¦æ¥çš„å†…å­˜æµªè´¹ï¼›ä½†æ˜¯ä¼šå ç”¨å¤§é‡çš„ CPU èµ„æºå»å¤„ç†è¿‡æœŸçš„æ•°æ®ï¼Œä»è€Œå½±å“ç¼“å­˜çš„å“åº”æ—¶é—´å’Œååé‡ã€‚</p>\n<p><strong>æƒ°æ€§è¿‡æœŸç­–ç•¥</strong></p>\n<p>åªæœ‰å½“è®¿é—®ä¸€ä¸ª key æ—¶ï¼Œæ‰ä¼šåˆ¤æ–­è¯¥ key æ˜¯å¦å·²è¿‡æœŸï¼Œè¿‡æœŸåˆ™æ¸…é™¤ã€‚è¯¥ç­–ç•¥å¯ä»¥æœ€å¤§åŒ–åœ°èŠ‚çœ CPU èµ„æºï¼Œå´å¯¹å†…å­˜éå¸¸ä¸å‹å¥½ã€‚æç«¯æƒ…å†µå¯èƒ½å‡ºç°å¤§é‡çš„è¿‡æœŸ key æ²¡æœ‰å†æ¬¡è¢«è®¿é—®ï¼Œä»è€Œä¸ä¼šè¢«æ¸…é™¤ï¼Œå ç”¨å¤§é‡å†…å­˜ã€‚</p>\n<p><strong>å®šæœŸè¿‡æœŸç­–ç•¥</strong></p>\n<p>æ¯éš”ä¸€å®šçš„æ—¶é—´ï¼Œä¼šæ‰«æä¸€å®šæ•°é‡çš„æ•°æ®åº“çš„ expires å­—å…¸ä¸­ä¸€å®šæ•°é‡çš„ keyï¼Œå¹¶æ¸…é™¤å…¶ä¸­å·²è¿‡æœŸçš„ keyã€‚è¯¥ç­–ç•¥æ˜¯å‰ä¸¤è€…çš„ä¸€ä¸ªæŠ˜ä¸­æ–¹æ¡ˆã€‚é€šè¿‡è°ƒæ•´å®šæ—¶æ‰«æçš„æ—¶é—´é—´éš”å’Œæ¯æ¬¡æ‰«æçš„é™å®šè€—æ—¶ï¼Œå¯ä»¥åœ¨ä¸åŒæƒ…å†µä¸‹ä½¿å¾— CPU å’Œå†…å­˜èµ„æºè¾¾åˆ°æœ€ä¼˜çš„å¹³è¡¡æ•ˆæœã€‚</p>\n<p><strong>Redisä¸­åŒæ—¶ä½¿ç”¨äº†å®šæœŸè¿‡æœŸå’Œæƒ°æ€§è¿‡æœŸä¸¤ç§è¿‡æœŸç­–ç•¥ã€‚</strong></p>\n<p>æ‰€è°“å®šæœŸåˆ é™¤ï¼ŒæŒ‡çš„æ˜¯ Redis é»˜è®¤æ˜¯æ¯éš” 100ms å°±éšæœºæŠ½å–ä¸€äº›è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„ keyï¼Œæ£€æŸ¥å…¶æ˜¯å¦è¿‡æœŸï¼Œå¦‚æœè¿‡æœŸå°±åˆ é™¤ã€‚</p>\n<p><strong>å‡è®¾ Redis é‡Œæ”¾äº† 10w ä¸ª keyï¼Œéƒ½è®¾ç½®äº†è¿‡æœŸæ—¶é—´ï¼Œ</strong>ä½ æ¯éš”å‡ ç™¾æ¯«ç§’ï¼Œå°±æ£€æŸ¥ 10w ä¸ª keyï¼Œé‚£ Redis åŸºæœ¬ä¸Šå°±æ­»äº†ï¼Œcpu è´Ÿè½½ä¼šå¾ˆé«˜çš„ï¼Œæ¶ˆè€—åœ¨ä½ çš„æ£€æŸ¥è¿‡æœŸ key ä¸Šäº†ã€‚<strong>æ³¨æ„ï¼Œ</strong>è¿™é‡Œå¯ä¸æ˜¯æ¯éš” 100ms å°±éå†æ‰€æœ‰çš„è®¾ç½®è¿‡æœŸæ—¶é—´çš„ keyï¼Œé‚£æ ·å°±æ˜¯ä¸€åœºæ€§èƒ½ä¸Šçš„ç¾éš¾ã€‚å®é™…ä¸Š Redis æ˜¯æ¯éš” 100ms éšæœºæŠ½å–ä¸€äº› key æ¥æ£€æŸ¥å’Œåˆ é™¤çš„ã€‚</p>\n<p><strong>ä½†æ˜¯é—®é¢˜æ˜¯ï¼Œå®šæœŸåˆ é™¤å¯èƒ½ä¼šå¯¼è‡´å¾ˆå¤šè¿‡æœŸ key åˆ°äº†æ—¶é—´å¹¶æ²¡æœ‰è¢«åˆ é™¤æ‰ï¼Œé‚£å’‹æ•´å‘¢ï¼Ÿ</strong>æ‰€ä»¥å°±æ˜¯æƒ°æ€§åˆ é™¤äº†ã€‚è¿™å°±æ˜¯è¯´ï¼Œåœ¨ä½ è·å–æŸä¸ª key çš„æ—¶å€™ï¼ŒRedis ä¼šæ£€æŸ¥ä¸€ä¸‹ ï¼Œè¿™ä¸ª key å¦‚æœè®¾ç½®äº†è¿‡æœŸæ—¶é—´é‚£ä¹ˆæ˜¯å¦è¿‡æœŸäº†ï¼Ÿå¦‚æœè¿‡æœŸäº†æ­¤æ—¶å°±ä¼šåˆ é™¤ï¼Œä¸ä¼šç»™ä½ è¿”å›ä»»ä½•ä¸œè¥¿ã€‚</p>\n<p><strong>è·å– key çš„æ—¶å€™ï¼Œå¦‚æœæ­¤æ—¶ key å·²ç»è¿‡æœŸï¼Œå°±åˆ é™¤ï¼Œä¸ä¼šè¿”å›ä»»ä½•ä¸œè¥¿ã€‚</strong>ä½†æ˜¯å®é™…ä¸Šè¿™è¿˜æ˜¯æœ‰é—®é¢˜çš„ï¼Œå¦‚æœå®šæœŸåˆ é™¤æ¼æ‰äº†å¾ˆå¤šè¿‡æœŸ keyï¼Œç„¶åä½ ä¹Ÿæ²¡åŠæ—¶å»æŸ¥ï¼Œä¹Ÿå°±æ²¡èµ°æƒ°æ€§åˆ é™¤ï¼Œæ­¤æ—¶ä¼šæ€ä¹ˆæ ·ï¼Ÿå¦‚æœå¤§é‡è¿‡æœŸ key å †ç§¯åœ¨å†…å­˜é‡Œï¼Œå¯¼è‡´ Redis å†…å­˜å¿«è€—å°½äº†ï¼Œå’‹æ•´ï¼Ÿ<strong>ç­”æ¡ˆæ˜¯ï¼šèµ°å†…å­˜æ·˜æ±°æœºåˆ¶ã€‚</strong></p>\n<hr>\n<h2 id=\"Redisåˆ†å¸ƒå¼å¹¶å‘é—®é¢˜\"><a href=\"#Redisåˆ†å¸ƒå¼å¹¶å‘é—®é¢˜\" class=\"headerlink\" title=\"Redisåˆ†å¸ƒå¼å¹¶å‘é—®é¢˜\"></a>Redisåˆ†å¸ƒå¼å¹¶å‘é—®é¢˜</h2><blockquote>\n<p>å•ä½“é¡¹ç›®ä¸­ï¼Œè´­ç‰©è½¦ä¸‹å•å¯ä»¥ä½¿ç”¨ synchronized å…³é”®å­—é”ä½å®ä¾‹å¯¹è±¡ï¼Œåªè®©ä¸€ä¸ªçº¿ç¨‹ä¸‹å•å¹¶æ‰£å‡åº“å­˜</p>\n<p>è€Œå¯¹äºé›†ç¾¤è€Œè¨€ï¼Œåœ¨æ¯å°æœåŠ¡å™¨ä¸Šé”ä½å®ä¾‹å¯¹è±¡ï¼Œä½†æ˜¯æ¯å°ä¹‹é—´æ˜¯æ— æ³•æ„ŸçŸ¥çš„ï¼Œä»ç„¶å¯èƒ½å­˜åœ¨å•†å“è¶…å–é—®é¢˜</p>\n</blockquote>\n<h3 id=\"ä½¿ç”¨-Redis-å®ç°åˆ†å¸ƒå¼é”\"><a href=\"#ä½¿ç”¨-Redis-å®ç°åˆ†å¸ƒå¼é”\" class=\"headerlink\" title=\"ä½¿ç”¨ Redis å®ç°åˆ†å¸ƒå¼é”\"></a>ä½¿ç”¨ Redis å®ç°åˆ†å¸ƒå¼é”</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Transactional</span></span><br><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> Map&lt;String, String&gt; <span class=\"title function_\">addOrder</span><span class=\"params\">(String cids, Orders orders)</span> &#123;</span><br><span class=\"line\">    log.info(<span class=\"string\">&quot;add order begin...&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    Map&lt;String, String&gt; map = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 1ã€æ ¹æ®cidsæŸ¥è¯¢å½“å‰è®¢å•ä¸­å…³è”çš„è´­ç‰©è½¦è®°å½•è¯¦æƒ…ï¼ˆåŒ…æ‹¬åº“å­˜ï¼‰</span></span><br><span class=\"line\">    String[] arr = cids.split(<span class=\"string\">&quot;ï¼Œ&quot;</span>);</span><br><span class=\"line\">    List&lt;Integer&gt; cidsList = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (String s : arr) &#123;</span><br><span class=\"line\">        cidsList.add(Integer.parseInt(s));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// è·å–æ‰€æœ‰skuId</span></span><br><span class=\"line\">    List&lt;ShoppingCartVO&gt; list1 = shoppingCartMapper.selectShopCartByCids(cidsList);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"type\">boolean</span> <span class=\"variable\">allLocked</span> <span class=\"operator\">=</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">    List&lt;String&gt; lockedSkuIds = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;&gt;();</span><br><span class=\"line\">    Map&lt;String, String&gt; values = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (ShoppingCartVO sc : list1) &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">skuId</span> <span class=\"operator\">=</span> sc.getSkuId()ï¼Œ value = UUID.randomUUID().toString();</span><br><span class=\"line\">        <span class=\"type\">Boolean</span> <span class=\"variable\">thisLocked</span> <span class=\"operator\">=</span> srt.boundValueOps(sc.getSkuId()).setIfAbsent(value, <span class=\"number\">10</span>, TimeUnit.SECONDS);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!thisLocked) &#123;   <span class=\"comment\">// è¿”å› false è¯´æ˜ä¹‹å‰æœ‰è¯¥æ•°æ®ï¼Œå³æœ‰çº¿ç¨‹åœ¨æ“ä½œè¿™ä¸ª å•†å“åº“å­˜</span></span><br><span class=\"line\">            allLocked = <span class=\"literal\">false</span>;  <span class=\"comment\">// å› æ­¤è¿™ä¸ªskuå°±æ²¡æœ‰é”ä½ï¼Œä¸èƒ½ç»§ç»­æ“ä½œ</span></span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            lockedSkuIds.add(skuId);</span><br><span class=\"line\">            values.put(skuId, value);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (allLocked) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 2ã€æ ¡éªŒåº“å­˜</span></span><br><span class=\"line\">        List&lt;ShoppingCartVO&gt; list = shoppingCartMapper.selectShopCartByCids(cidsList);</span><br><span class=\"line\">        <span class=\"type\">boolean</span> <span class=\"variable\">f</span> <span class=\"operator\">=</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">        <span class=\"type\">StringBuilder</span> <span class=\"variable\">sb</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">StringBuilder</span>();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (ShoppingCartVO sc : list) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (Integer.parseInt(sc.getCartNum()) &gt; sc.getSkuStock()) &#123;</span><br><span class=\"line\">                f = <span class=\"literal\">false</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"comment\">//è·å–æ‰€æœ‰å•†å“çš„åç§°ï¼Œä»¥é€—å·æ‹¼æ¥æˆå­—ç¬¦ä¸²</span></span><br><span class=\"line\">            sb.append(sc.getProductName()).append(<span class=\"string\">&quot;ï¼Œ&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">untitled</span> <span class=\"operator\">=</span> sb.toString();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (f) &#123;</span><br><span class=\"line\">            log.info(<span class=\"string\">&quot;product stock is ok ... &quot;</span>);</span><br><span class=\"line\">            <span class=\"comment\">// 3ã€è¡¨ç¤ºåº“å­˜å……è¶³----ä¿å­˜è®¢å•</span></span><br><span class=\"line\">            <span class=\"comment\">// a.userId   b.untitled  c.æ”¶è´§äººä¿¡æ¯ï¼šå§“åã€ç”µè¯ã€åœ°å€</span></span><br><span class=\"line\">            <span class=\"comment\">// d.æ€»ä»·æ ¼   e.æ”¯ä»˜æ–¹å¼   f.è®¢å•çš„åˆ›å»ºæ—¶é—´  g.è®¢å•åˆå§‹çŠ¶æ€</span></span><br><span class=\"line\">            orders.setUntitled(untitled);</span><br><span class=\"line\">            orders.setCreateTime(<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>());</span><br><span class=\"line\">            orders.setStatus(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// ç”Ÿæˆè®¢å•ç¼–å·</span></span><br><span class=\"line\">            <span class=\"type\">String</span> <span class=\"variable\">orderId</span> <span class=\"operator\">=</span> UUID.randomUUID().toString().replace(<span class=\"string\">&quot;-&quot;</span>ï¼Œ <span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">            orders.setOrderId(orderId);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// ä¿å­˜è®¢å•</span></span><br><span class=\"line\">            ordersMapper.insert(orders);</span><br><span class=\"line\">            <span class=\"comment\">// 4ã€ç”Ÿæˆå•†å“å¿«ç…§</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> (ShoppingCartVO sc : list) &#123;</span><br><span class=\"line\">                <span class=\"type\">int</span> <span class=\"variable\">cnum</span> <span class=\"operator\">=</span> Integer.parseInt(sc.getCartNum());</span><br><span class=\"line\">                <span class=\"type\">String</span> <span class=\"variable\">itemId</span> <span class=\"operator\">=</span> System.currentTimeMillis() + <span class=\"string\">&quot;&quot;</span> + (<span class=\"keyword\">new</span> <span class=\"title class_\">Random</span>().nextInt(<span class=\"number\">89999</span>) + <span class=\"number\">10000</span>);</span><br><span class=\"line\">                <span class=\"type\">OrderItem</span> <span class=\"variable\">orderItem</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">OrderItem</span>(itemId, orderId, sc.getProductId()ï¼Œ sc.getProductName()ï¼Œ sc.getProductImg()ï¼Œ sc.getSkuId()ï¼Œ</span><br><span class=\"line\">                                                    sc.getSkuName()ï¼Œ BigDecimal.valueOf(sc.getSellPrice())ï¼Œ cnum, <span class=\"keyword\">new</span> <span class=\"title class_\">BigDecimal</span>(sc.getSellPrice() * cnum)ï¼Œ <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>()ï¼Œ <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>()ï¼Œ <span class=\"number\">0</span>);</span><br><span class=\"line\">                orderItemMapper.insert(orderItem);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// 5ã€æ‰£å‡åº“å­˜ï¼šæ ¹æ®å¥—é¤Idä¿®æ”¹å¥—é¤åº“å­˜é‡</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> (ShoppingCartVO sc : list) &#123;</span><br><span class=\"line\">                <span class=\"type\">String</span> <span class=\"variable\">skuId</span> <span class=\"operator\">=</span> sc.getSkuId();</span><br><span class=\"line\">                <span class=\"type\">int</span> <span class=\"variable\">newStock</span> <span class=\"operator\">=</span> sc.getSkuStock() - Integer.parseInt(sc.getCartNum());</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"type\">ProductSku</span> <span class=\"variable\">productSku</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ProductSku</span>();</span><br><span class=\"line\">                productSku.setSkuId(skuId);</span><br><span class=\"line\">                productSku.setStock(newStock);</span><br><span class=\"line\">                <span class=\"comment\">//æ ¹æ®ä¸»é”®æ¥ä¿®æ”¹å±æ€§å€¼</span></span><br><span class=\"line\">                productSkuMapper.updateByPrimaryKeySelective(productSku);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// 6ã€åˆ é™¤è´­ç‰©è½¦ï¼šå½“è´­ç‰©è½¦ä¸­çš„è®°å½•è´­ä¹°æˆåŠŸä¹‹åï¼Œè´­ç‰©è½¦ä¸­å¯¹åº”åšåˆ é™¤æ“ä½œ</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> cid : cidsList) &#123;</span><br><span class=\"line\">                shoppingCartMapper.deleteByPrimaryKey(cid);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// é‡Šæ”¾é”</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> (String lockedSkuId : lockedSkuIds) &#123;</span><br><span class=\"line\">                <span class=\"type\">String</span> <span class=\"variable\">value</span> <span class=\"operator\">=</span> srt.boundValueOps(lockedSkuId).get();</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (value != <span class=\"literal\">null</span> &amp;&amp; value.equals(values.get(lockedSkuId))) &#123;</span><br><span class=\"line\">                    srt.delete(lockedSkuId);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            log.info(<span class=\"string\">&quot;add order finished... &quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">            map.put(<span class=\"string\">&quot;orderId&quot;</span>ï¼Œ orderId);</span><br><span class=\"line\">            map.put(<span class=\"string\">&quot;productNames&quot;</span>ï¼Œ untitled);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> map;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// è¡¨ç¤ºåº“å­˜ä¸è¶³</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;    <span class=\"comment\">// åŠ é”å¤±è´¥</span></span><br><span class=\"line\">        <span class=\"comment\">// è¦å°†éƒ¨åˆ†é”å®šçš„skué‡Šæ”¾é”ï¼Œå³ä»Redisä¸­ç§»é™¤é”ä½çš„skuId</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (String lockedSkuId : lockedSkuIds) &#123;</span><br><span class=\"line\">            srt.delete(lockedSkuId);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ol>\n<li><p>å¦‚æœè®¢å•ä¸­éƒ¨åˆ†å•†å“åŠ é”æˆåŠŸï¼Œä½†æ˜¯ç”±äºä¸€äº›å•†å“åŠ é”å¤±è´¥å¯¼è‡´æ— æ³•æäº¤è®¢å•ï¼Œæ­¤æ—¶è¦æ³¨æ„å°†åŠ é”çš„å•†å“æ¢å¤ï¼Œå³ä» Redis ä¸­ç§»é™¤è¯¥å•†å“</p>\n<blockquote>\n<p>åœ¨ allLocked &#x3D;&#x3D; false ä¸­ï¼Œé‡Šæ”¾åŠ é”çš„å•†å“</p>\n</blockquote>\n</li>\n<li><p>ç¬¬ä¸€æ¬¡æ ¹æ® è´­ç‰©è½¦ Id æŸ¥åˆ°çš„è´­ç‰©è½¦è®°å½•ï¼ˆåŒ…å«å•†å“åº“å­˜ï¼‰åˆ°åŠ é”æäº¤è®¢å•ä¹‹å‰ï¼Œå¯èƒ½æœ‰åˆ«çš„çº¿ç¨‹ æ“ä½œäº†å…¶ä¸­æŸä¸ªå•†å“çš„åº“å­˜å¹¶æ“ä½œå®Œäº†ï¼Œä¸ºäº†é˜²æ­¢å½“å‰çº¿ç¨‹è¿˜å¯¹ä¹‹å‰åº“å­˜è¿›è¡Œä¿®æ”¹ï¼Œåº”å½“åœ¨åŠ é”åæ“ä½œå‰é‡æ–°æŸ¥è¯¢åº“å­˜ã€‚</p>\n</li>\n<li><p>å½“å‰çº¿ç¨‹åŠ é”æˆåŠŸä¹‹åï¼Œåœ¨æ‰§è¡Œæ·»åŠ è®¢å•çš„è¿‡ç¨‹ä¸­å¦‚æœå‡ºç°äº†å¼‚å¸¸å¯¼è‡´æ— æ³•é‡Šæ”¾é”</p>\n<blockquote>\n<p>å¯ä»¥åœ¨å¯¹å•†å“åŠ é”æ—¶è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œåˆ™åˆ°æœŸè‡ªåŠ¨é‡Šæ”¾é”</p>\n</blockquote>\n</li>\n<li><p>æ¡£ç»™é”è®¾ç½®äº†è¿‡æœŸæ—¶é—´ä¹‹åï¼Œå¦‚æœå½“å‰çº¿ç¨‹ t1 å› ä¸ºç‰¹æ®ŠåŸå› ï¼Œåœ¨é”è¿‡æœŸä¹‹å‰æ²¡æœ‰å®Œæˆä¸šåŠ¡æ‰§è¡Œï¼Œé‡Šæ”¾æ‰äº†é”ï¼Œæ­¤æ—¶çº¿ç¨‹ t2 åŠ é”æˆåŠŸï¼Œå¦‚æœçº¿ç¨‹ t1 æ‰§è¡Œç»“æŸï¼Œå°†ä¼šé‡Šæ”¾ çº¿ç¨‹ t2 çš„é”ï¼Œå¯¼è‡´ çº¿ç¨‹ t2 åœ¨æ— é”çŠ¶æ€</p>\n<blockquote>\n<p>å¯¹äºåŠ æˆåŠŸå¹¶æäº¤å®Œè®¢å•ä¹‹åï¼Œå¯¹å½“å‰å•†å“çš„é”é‡Šæ”¾ï¼Œè¦åˆ¤æ–­ Redis ä¸­çš„valueæ˜¯å¦å’Œè‡ªå·±è®°å½•çš„ç›¸åŒï¼Œå³æ˜¯å¦æ˜¯è‡ªå·±åŠ çš„é”</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// é‡Šæ”¾é”</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> (String lockedSkuId : lockedSkuIds) &#123;</span><br><span class=\"line\">   <span class=\"type\">String</span> <span class=\"variable\">value</span> <span class=\"operator\">=</span> srt.boundValueOps(lockedSkuId).get();</span><br><span class=\"line\">   <span class=\"keyword\">if</span> (values.get(lockedSkuId).equals(value)) &#123;</span><br><span class=\"line\">     \tsrt.delete(lockedSkuId);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</blockquote>\n</li>\n<li><p>å½“å‰çº¿ç¨‹ t1 åˆ¤æ–­æ˜¯è‡ªå·±åŠ çš„é”ï¼Œåœ¨å‡†å¤‡åˆ é™¤ä¹‹å‰ï¼Œé”è¿‡æœŸäº†å¹¶ä¸”è¢«å…¶ä»–çº¿ç¨‹ t2 æ‹¿åˆ°äº†æˆåŠŸåŠ é”ï¼Œè¿™æ—¶å€™çº¿ç¨‹ t1 ä¼šé‡Šæ”¾æ‰çº¿ç¨‹ t2 çš„é”ï¼ˆå¹¶å‘é‡å¾ˆå¤§ä»ç„¶éœ€è¦è€ƒè™‘ï¼‰</p>\n<blockquote>\n<p>ä¿è¯ æŸ¥è¯¢é”æ˜¯å¦æ˜¯è‡ªå·±åŠ çš„å’Œåˆ é™¤è‡ªå·±åŠ çš„é” çš„åŸå­æ€§ï¼ˆä½¿ç”¨ lua è„šæœ¬ï¼Œè®©å¤šä¸ª Redis æ“ä½œå…·æœ‰åŸå­æ€§ï¼ŒæŸ¥è¯¢+åˆ é™¤ï¼‰</p>\n</blockquote>\n</li>\n<li><p>ä½¿ç”¨çœ‹é—¨ç‹—çº¿ç¨‹è§£å†³çº¿ç¨‹ t1 é‡Šæ”¾ç›¸ä¹˜ t2 çš„é”çš„é—®é¢˜</p>\n<blockquote>\n<p>çº¿ç¨‹t1 åŠ é”å¹¶è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œæ­¤æ—¶å¯åŠ¨ çœ‹é—¨ç‹—çº¿ç¨‹ï¼ˆå®ˆæŠ¤çº¿ç¨‹ï¼‰ç›‘æ§çº¿ç¨‹ t1è¿‡æœŸæ—¶é—´ï¼Œè¿‡æœŸæ—¶é—´è¦åˆ°äº†ä½†æ˜¯çº¿ç¨‹t1 ä¸šåŠ¡è¿˜åœ¨æ‰§è¡Œï¼Œåˆ™é‡ç½®è¿‡æœŸæ—¶é—´ï¼Œè¿™æ ·å¯ä»¥ä¿è¯ä¸šåŠ¡æ‰§è¡Œå®Œä¹‹å‰ä¸ä¼šé‡Šæ”¾é”</p>\n</blockquote>\n</li>\n</ol>\n<h3 id=\"åˆ†å¸ƒå¼é”æ¡†æ¶-Resisson\"><a href=\"#åˆ†å¸ƒå¼é”æ¡†æ¶-Resisson\" class=\"headerlink\" title=\"åˆ†å¸ƒå¼é”æ¡†æ¶ Resisson\"></a>åˆ†å¸ƒå¼é”æ¡†æ¶ Resisson</h3><ul>\n<li><p>æ·»åŠ ä¾èµ–</p>\n  <figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- https://mvnrepository.com/artifact/org.redisson/redisson --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.redisson<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>redisson<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>3.16.7<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>é…ç½® yaml æ–‡ä»¶</p>\n  <figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">redisson:</span></span><br><span class=\"line\">  <span class=\"attr\">addr:</span></span><br><span class=\"line\">    <span class=\"attr\">singleAddr:</span></span><br><span class=\"line\">      <span class=\"attr\">host:</span> <span class=\"string\">Redis://47.110.247.63:6389</span></span><br><span class=\"line\">      <span class=\"attr\">password:</span> <span class=\"string\">FYX123fyx.</span></span><br><span class=\"line\">      <span class=\"attr\">database:</span> <span class=\"number\">0</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>é…ç½® RedissonClientï¼ˆä¹Ÿå¯ä»¥é…ç½®æˆé›†ç¾¤æ¨¡å¼ã€ä¸»ä»æ¨¡å¼ï¼‰</p>\n  <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">RedissonConfig</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Value(&quot;$&#123;redisson.addr.singleAddr.host&#125;&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String host;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Value(&quot;$&#123;redisson.addr.singleAddr.password&#125;&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String password;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Value(&quot;$&#123;redisson.addr.singleAddr.database&#125;&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> database;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> RedissonClient <span class=\"title function_\">redissonClient</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Config</span> <span class=\"variable\">config</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Config</span>();</span><br><span class=\"line\">        config.useSingleServer().setAddress(host)</span><br><span class=\"line\">                .setPassword(password)</span><br><span class=\"line\">                .setDatabase(database);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Redisson.create(config);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>æ“ä½œ</p>\n  <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Transactional</span></span><br><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> Map&lt;String, String&gt; <span class=\"title function_\">addOrder</span><span class=\"params\">(String cids, Orders orders)</span> &#123;</span><br><span class=\"line\">    log.info(<span class=\"string\">&quot;add order begin...&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 1ã€æ ¹æ®cidsæŸ¥è¯¢å½“å‰è®¢å•ä¸­å…³è”çš„è´­ç‰©è½¦è®°å½•è¯¦æƒ…ï¼ˆåŒ…æ‹¬åº“å­˜ï¼‰</span></span><br><span class=\"line\">    String[] arr = cids.split(<span class=\"string\">&quot;ï¼Œ&quot;</span>);</span><br><span class=\"line\">    List&lt;Integer&gt; cidsList = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (String s : arr) &#123;</span><br><span class=\"line\">        cidsList.add(Integer.parseInt(s));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// è·å–æ‰€æœ‰skuId</span></span><br><span class=\"line\">    List&lt;ShoppingCartVO&gt; list = shoppingCartMapper.selectShopCartByCids(cidsList);</span><br><span class=\"line\">    List&lt;String&gt; lockedSkuIds = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;&gt;();</span><br><span class=\"line\">    Map&lt;String, RLock&gt; locks = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;&gt;(); <span class=\"comment\">// &#123;&quot;1&quot;:lock1, &quot;2&quot;:lock2&#125;</span></span><br><span class=\"line\">    <span class=\"type\">boolean</span> <span class=\"variable\">allLocked</span> <span class=\"operator\">=</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (ShoppingCartVO sc : list) &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">skuId</span> <span class=\"operator\">=</span> sc.getSkuId();</span><br><span class=\"line\">        <span class=\"type\">boolean</span> <span class=\"variable\">b</span> <span class=\"operator\">=</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">        <span class=\"type\">RLock</span> <span class=\"variable\">lock</span> <span class=\"operator\">=</span> redissonClient.getLock(skuId);</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            b = lock.tryLock(<span class=\"number\">10</span>, <span class=\"number\">3</span>, TimeUnit.SECONDS);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!b) &#123;</span><br><span class=\"line\">            allLocked = <span class=\"literal\">false</span>;</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            lockedSkuIds.add(skuId);</span><br><span class=\"line\">            locks.put(skuId, lock);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    Map&lt;String, String&gt; map = <span class=\"literal\">null</span>;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (allLocked) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 2ã€æ ¡éªŒåº“å­˜</span></span><br><span class=\"line\">            list = shoppingCartMapper.selectShopCartByCids(cidsList);</span><br><span class=\"line\">            <span class=\"type\">boolean</span> <span class=\"variable\">f</span> <span class=\"operator\">=</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">            <span class=\"type\">StringBuilder</span> <span class=\"variable\">sb</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">StringBuilder</span>();</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (ShoppingCartVO sc : list) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (Integer.parseInt(sc.getCartNum()) &gt; sc.getSkuStock()) &#123;</span><br><span class=\"line\">                    f = <span class=\"literal\">false</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"comment\">//è·å–æ‰€æœ‰å•†å“çš„åç§°ï¼Œä»¥é€—å·æ‹¼æ¥æˆå­—ç¬¦ä¸²</span></span><br><span class=\"line\">                sb.append(sc.getProductName()).append(<span class=\"string\">&quot;ï¼Œ&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"type\">String</span> <span class=\"variable\">untitled</span> <span class=\"operator\">=</span> sb.toString();</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (f) &#123;</span><br><span class=\"line\">                log.info(<span class=\"string\">&quot;product stock is ok ... &quot;</span>);</span><br><span class=\"line\">                <span class=\"comment\">// 3ã€è¡¨ç¤ºåº“å­˜å……è¶³----ä¿å­˜è®¢å•</span></span><br><span class=\"line\">                <span class=\"comment\">// a.userId   b.untitled  c.æ”¶è´§äººä¿¡æ¯ï¼šå§“åã€ç”µè¯ã€åœ°å€</span></span><br><span class=\"line\">                <span class=\"comment\">// d.æ€»ä»·æ ¼   e.æ”¯ä»˜æ–¹å¼   f.è®¢å•çš„åˆ›å»ºæ—¶é—´  g.è®¢å•åˆå§‹çŠ¶æ€</span></span><br><span class=\"line\">                orders.setUntitled(untitled);</span><br><span class=\"line\">                orders.setCreateTime(<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>());</span><br><span class=\"line\">                orders.setStatus(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"comment\">// ç”Ÿæˆè®¢å•ç¼–å·</span></span><br><span class=\"line\">                <span class=\"type\">String</span> <span class=\"variable\">orderId</span> <span class=\"operator\">=</span> UUID.randomUUID().toString().replace(<span class=\"string\">&quot;-&quot;</span>ï¼Œ <span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">                orders.setOrderId(orderId);</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"comment\">// ä¿å­˜è®¢å•</span></span><br><span class=\"line\">                ordersMapper.insert(orders);</span><br><span class=\"line\">                <span class=\"comment\">// 4ã€ç”Ÿæˆå•†å“å¿«ç…§</span></span><br><span class=\"line\">                <span class=\"keyword\">for</span> (ShoppingCartVO sc : list) &#123;</span><br><span class=\"line\">                    <span class=\"type\">int</span> <span class=\"variable\">cnum</span> <span class=\"operator\">=</span> Integer.parseInt(sc.getCartNum());</span><br><span class=\"line\">                    <span class=\"type\">String</span> <span class=\"variable\">itemId</span> <span class=\"operator\">=</span> System.currentTimeMillis() + <span class=\"string\">&quot;&quot;</span> + (<span class=\"keyword\">new</span> <span class=\"title class_\">Random</span>().nextInt(<span class=\"number\">89999</span>) + <span class=\"number\">10000</span>);</span><br><span class=\"line\">                    <span class=\"type\">OrderItem</span> <span class=\"variable\">orderItem</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">OrderItem</span>(itemId, orderId, sc.getProductId()ï¼Œ sc.getProductName()ï¼Œ sc.getProductImg()ï¼Œ sc.getSkuId()ï¼Œ</span><br><span class=\"line\">                                                        sc.getSkuName()ï¼Œ BigDecimal.valueOf(sc.getSellPrice())ï¼Œ cnum, <span class=\"keyword\">new</span> <span class=\"title class_\">BigDecimal</span>(sc.getSellPrice() * cnum)ï¼Œ <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>()ï¼Œ <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>()ï¼Œ <span class=\"number\">0</span>);</span><br><span class=\"line\">                    orderItemMapper.insert(orderItem);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"comment\">// 5ã€æ‰£å‡åº“å­˜ï¼šæ ¹æ®å¥—é¤Idä¿®æ”¹å¥—é¤åº“å­˜é‡</span></span><br><span class=\"line\">                <span class=\"keyword\">for</span> (ShoppingCartVO sc : list) &#123;</span><br><span class=\"line\">                    <span class=\"type\">String</span> <span class=\"variable\">skuId</span> <span class=\"operator\">=</span> sc.getSkuId();</span><br><span class=\"line\">                    <span class=\"type\">int</span> <span class=\"variable\">newStock</span> <span class=\"operator\">=</span> sc.getSkuStock() - Integer.parseInt(sc.getCartNum());</span><br><span class=\"line\"></span><br><span class=\"line\">                    <span class=\"type\">ProductSku</span> <span class=\"variable\">productSku</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ProductSku</span>();</span><br><span class=\"line\">                    productSku.setSkuId(skuId);</span><br><span class=\"line\">                    productSku.setStock(newStock);</span><br><span class=\"line\">                    <span class=\"comment\">//æ ¹æ®ä¸»é”®æ¥ä¿®æ”¹å±æ€§å€¼</span></span><br><span class=\"line\">                    productSkuMapper.updateByPrimaryKeySelective(productSku);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"comment\">// 6ã€åˆ é™¤è´­ç‰©è½¦ï¼šå½“è´­ç‰©è½¦ä¸­çš„è®°å½•è´­ä¹°æˆåŠŸä¹‹åï¼Œè´­ç‰©è½¦ä¸­å¯¹åº”åšåˆ é™¤æ“ä½œ</span></span><br><span class=\"line\">                <span class=\"keyword\">for</span> (<span class=\"type\">int</span> cid : cidsList) &#123;</span><br><span class=\"line\">                    shoppingCartMapper.deleteByPrimaryKey(cid);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                log.info(<span class=\"string\">&quot;add order finished... &quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">                map = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;&gt;();</span><br><span class=\"line\">                map.put(<span class=\"string\">&quot;orderId&quot;</span>ï¼Œ orderId);</span><br><span class=\"line\">                map.put(<span class=\"string\">&quot;productNames&quot;</span>ï¼Œ untitled);</span><br><span class=\"line\"></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">        e.printStackTrace();</span><br><span class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// é‡Šæ”¾é”</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (String lockedSkuId : lockedSkuIds) &#123;</span><br><span class=\"line\">            locks.get(lockedSkuId).unlock();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> map;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h3 id=\"åˆ†å¸ƒå¼é”ç‰¹ç‚¹\"><a href=\"#åˆ†å¸ƒå¼é”ç‰¹ç‚¹\" class=\"headerlink\" title=\"åˆ†å¸ƒå¼é”ç‰¹ç‚¹\"></a>åˆ†å¸ƒå¼é”ç‰¹ç‚¹</h3><ol>\n<li><p>äº’æ–¥æ€§</p>\n<p> ä¿è¯åœ¨ä¸åŒèŠ‚ç‚¹é—´ä¸åŒçº¿ç¨‹çš„äº’æ–¥ï¼ˆåªæœ‰ä¸€ä¸ªèŠ‚ç‚¹å½“ç„¶å¯ä»¥ï¼‰</p>\n</li>\n<li><p>å¯é‡å…¥æ€§</p>\n<p> åŒä¸€ä¸ªèŠ‚ç‚¹ä¸Šçš„åŒä¸€ä¸ªçº¿ç¨‹å¦‚æœè·å–é”ä¹‹åå¯ä»¥å†æ¬¡è·å–åˆ°è¿™ä¸ªé”</p>\n</li>\n<li><p>é”è¶…æ—¶</p>\n<p> åŠ é”æˆåŠŸä¹‹åè®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œä»¥é˜²æ­¢çº¿ç¨‹æ•…éšœå¯¼è‡´ä¸é‡Šæ”¾é”è€Œå¼•èµ·æ­»é”</p>\n</li>\n<li><p>é«˜æ•ˆã€é«˜å¯ç”¨</p>\n<p> æ”¯æŒå•èŠ‚ç‚¹ Redisã€ä¸»ä» Redisã€é›†ç¾¤ Redis</p>\n</li>\n<li><p>æ”¯æŒé˜»å¡å’Œéé˜»å¡</p>\n<p> tryLock éé˜»å¡ å’Œ tryLock(long timeOut) é˜»å¡</p>\n</li>\n</ol>\n<h3 id=\"Redisson-çš„ä½¿ç”¨\"><a href=\"#Redisson-çš„ä½¿ç”¨\" class=\"headerlink\" title=\"Redisson çš„ä½¿ç”¨\"></a>Redisson çš„ä½¿ç”¨</h3><ol>\n<li><p>è·å–é”ï¼ˆå…¬å¹³é” &#x2F; éå…¬å¹³é”ï¼‰</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å…¬å¹³é”</span></span><br><span class=\"line\"><span class=\"type\">RLock</span> <span class=\"variable\">lock</span> <span class=\"operator\">=</span> redissonClient.getFairLock(skuId);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// éå…¬å¹³é”</span></span><br><span class=\"line\"><span class=\"type\">RLock</span> <span class=\"variable\">lock</span> <span class=\"operator\">=</span> redissonClient.getLock(skuId);</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>åŠ é”ï¼ˆé˜»å¡é” &#x2F; éé˜»å¡é”ï¼‰</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// é˜»å¡é”ï¼Œè®¾ç½®åŠ é”æˆåŠŸåçš„è¶…æ—¶æ—¶é—´ 20sï¼Œä¸åŠ æ—¶é—´é»˜è®¤ 30s</span></span><br><span class=\"line\">lock.lock(<span class=\"number\">20</span>, TimeUnit.SECONDS);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// éé˜»å¡é”ï¼ˆè®¾ç½®ç­‰å¾…æ—¶é—´ 3sï¼ŒåŠ é”æˆåŠŸåçš„è¶…æ—¶æ—¶é—´ 10sï¼Œä¸åŠ åˆ™é»˜è®¤ 30sï¼‰</span></span><br><span class=\"line\">lock.tryLock(<span class=\"number\">10</span>, <span class=\"number\">3</span>, TimeUnit.SECONDS);</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>é‡Šæ”¾é”</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">lock.unlock();</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>å®ä¾‹</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å…¬å¹³éé˜»å¡é”</span></span><br><span class=\"line\"><span class=\"type\">RLock</span> <span class=\"variable\">lock</span> <span class=\"operator\">=</span> redissonClient.getLock(skuId);</span><br><span class=\"line\">lock.tryLock(<span class=\"number\">10</span>, <span class=\"number\">3</span>, TimeUnit.SECONDS);</span><br></pre></td></tr></table></figure></li>\n</ol>\n<hr>\n<h2 id=\"ç¼“å­˜ä¸æ•°æ®åº“åŒå†™ä¸€è‡´æ€§\"><a href=\"#ç¼“å­˜ä¸æ•°æ®åº“åŒå†™ä¸€è‡´æ€§\" class=\"headerlink\" title=\"ç¼“å­˜ä¸æ•°æ®åº“åŒå†™ä¸€è‡´æ€§\"></a>ç¼“å­˜ä¸æ•°æ®åº“åŒå†™ä¸€è‡´æ€§</h2><p>æ€»ç»“ï¼š</p>\n<p>è¯»æ•°æ®ï¼šå…ˆè¯»ç¼“å­˜ï¼Œå¦‚æœæœ‰ç›´æ¥è¿”å›ï¼Œå¦‚æœæ²¡æœ‰æŸ¥æ•°æ®åº“æŸ¥åˆ°æ•°æ®å­˜åˆ°ç¼“å­˜ä¸­å¹¶è¿”å›</p>\n<p>å†™æ•°æ®ï¼šå…ˆå†™æ•°æ®åº“ï¼Œå†åˆ ç¼“å­˜ï¼Œè¿™ä¸ªé˜¶æ®µå¯èƒ½åˆ ç¼“å­˜å¤±è´¥ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ä¸€ä¸‹ä¸‰ç§æ–¹æ¡ˆï¼š</p>\n<ol>\n<li>å¦‚æœåˆ é™¤ç¼“å­˜å¤±è´¥ï¼Œéœ€è¦å°†æ•°æ®å†™å…¥é‡è¯•è¡¨ï¼Œç„¶åä½¿ç”¨ elastic-job ç­‰å®šæ—¶ä»»åŠ¡è¿›è¡Œé‡è¯•ã€‚</li>\n<li>å¦‚æœåˆ é™¤ç¼“å­˜å¤±è´¥ï¼Œéœ€è¦å°†æ•°æ®å‘é€ mq æ¶ˆæ¯åˆ° mq æœåŠ¡å™¨ï¼Œåœ¨ mq çš„ consumer ä¸­å¤„ç†ã€‚</li>\n<li>è®¢é˜… mysql çš„ binlogï¼Œåœ¨è®¢é˜…è€…ä¸­ï¼Œå¦‚æœå‘ç°äº†æ›´æ–°æ•°æ®è¯·æ±‚ï¼Œåˆ™åˆ é™¤ç›¸åº”çš„ç¼“å­˜ã€‚</li>\n</ol>\n<blockquote>\n<p><a href=\"https://www.zhihu.com/question/319817091/answer/2432904728\">å¦‚ä½•ä¿è¯æ•°æ®åº“å’Œç¼“å­˜åŒå†™ä¸€è‡´æ€§ï¼Ÿ-è‹ä¸‰è¯´æŠ€æœ¯</a></p>\n</blockquote>\n<h3 id=\"é—®é¢˜å¼•å…¥\"><a href=\"#é—®é¢˜å¼•å…¥\" class=\"headerlink\" title=\"é—®é¢˜å¼•å…¥\"></a>é—®é¢˜å¼•å…¥</h3><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨ç¼“å­˜çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æå‡æŸ¥è¯¢çš„æ€§èƒ½ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ˜¯è¿™æ ·ä½¿ç”¨ç¼“å­˜çš„ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650526232523.png\" alt=\"å›¾ç‰‡\"></p>\n<ol>\n<li>ç”¨æˆ·è¯·æ±‚è¿‡æ¥ä¹‹åï¼Œå…ˆæŸ¥ç¼“å­˜æœ‰æ²¡æœ‰æ•°æ®ï¼Œå¦‚æœæœ‰åˆ™ç›´æ¥è¿”å›ã€‚</li>\n<li>å¦‚æœç¼“å­˜æ²¡æ•°æ®ï¼Œå†ç»§ç»­æŸ¥æ•°æ®åº“ã€‚</li>\n<li>å¦‚æœæ•°æ®åº“æœ‰æ•°æ®ï¼Œåˆ™å°†æŸ¥è¯¢å‡ºæ¥çš„æ•°æ®ï¼Œæ”¾å…¥ç¼“å­˜ä¸­ï¼Œç„¶åè¿”å›è¯¥æ•°æ®ã€‚</li>\n<li>å¦‚æœæ•°æ®åº“ä¹Ÿæ²¡æ•°æ®ï¼Œåˆ™ç›´æ¥è¿”å›ç©ºã€‚</li>\n</ol>\n<p>è¿™æ˜¯ç¼“å­˜éå¸¸å¸¸è§çš„ç”¨æ³•ã€‚ä¸€çœ¼çœ‹ä¸Šå»ï¼Œå¥½åƒæ²¡æœ‰å•¥é—®é¢˜ã€‚</p>\n<p>ä½†ä½ å¿½ç•¥äº†ä¸€ä¸ªéå¸¸é‡è¦çš„ç»†èŠ‚ï¼š<strong>å¦‚æœæ•°æ®åº“ä¸­çš„æŸæ¡æ•°æ®ï¼Œæ”¾å…¥ç¼“å­˜ä¹‹åï¼Œåˆç«‹é©¬è¢«æ›´æ–°äº†ï¼Œé‚£ä¹ˆè¯¥å¦‚ä½•æ›´æ–°ç¼“å­˜å‘¢ï¼Ÿ</strong></p>\n<p>ä¸æ›´æ–°ç¼“å­˜è¡Œä¸è¡Œï¼Ÿ</p>\n<p>ç­”ï¼šå½“ç„¶ä¸è¡Œï¼Œå¦‚æœä¸æ›´æ–°ç¼“å­˜ï¼Œåœ¨å¾ˆé•¿çš„ä¸€æ®µæ—¶é—´å†…ï¼ˆå†³å®šäºç¼“å­˜çš„è¿‡æœŸæ—¶é—´ï¼‰ï¼Œç”¨æˆ·è¯·æ±‚ä»ç¼“å­˜ä¸­è·å–åˆ°çš„éƒ½å¯èƒ½æ˜¯æ—§å€¼ï¼Œè€Œéæ•°æ®åº“çš„æœ€æ–°å€¼ã€‚è¿™ä¸æ˜¯æœ‰æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ï¼Ÿ</p>\n<p>é‚£ä¹ˆï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•æ›´æ–°ç¼“å­˜å‘¢ï¼Ÿ</p>\n<p>ç›®å‰æœ‰ä»¥ä¸‹ 4 ç§æ–¹æ¡ˆï¼š</p>\n<ol>\n<li>å…ˆå†™ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“</li>\n<li>å…ˆå†™æ•°æ®åº“ï¼Œå†å†™ç¼“å­˜</li>\n<li>å…ˆåˆ ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“</li>\n<li>å…ˆå†™æ•°æ®åº“ï¼Œå†åˆ ç¼“å­˜</li>\n</ol>\n<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¯¦ç»†è¯´è¯´è¿™ 4 ç§æ–¹æ¡ˆã€‚</p>\n<h3 id=\"å…ˆå†™ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“\"><a href=\"#å…ˆå†™ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“\" class=\"headerlink\" title=\"å…ˆå†™ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“\"></a>å…ˆå†™ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“</h3><p>å¯¹äºæ›´æ–°ç¼“å­˜çš„æ–¹æ¡ˆï¼Œå¾ˆå¤šäººç¬¬ä¸€ä¸ªæƒ³åˆ°çš„å¯èƒ½æ˜¯åœ¨å†™æ“ä½œä¸­ç›´æ¥æ›´æ–°ç¼“å­˜ï¼ˆå†™ç¼“å­˜ï¼‰ï¼Œæ›´ç›´æ¥æ˜äº†ã€‚</p>\n<p>é‚£ä¹ˆï¼Œé—®é¢˜æ¥äº†ï¼šåœ¨å†™æ“ä½œä¸­ï¼Œåˆ°åº•æ˜¯å…ˆå†™ç¼“å­˜ï¼Œè¿˜æ˜¯å…ˆå†™æ•°æ®åº“å‘¢ï¼Ÿ</p>\n<p>æˆ‘ä»¬åœ¨è¿™é‡Œå…ˆèŠèŠå…ˆå†™ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“çš„æƒ…å†µï¼Œå› ä¸ºå®ƒçš„é—®é¢˜æœ€ä¸¥é‡ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650526427819.png\" alt=\"å›¾ç‰‡\"></p>\n<p>æŸä¸€ä¸ªç”¨æˆ·çš„æ¯ä¸€æ¬¡å†™æ“ä½œï¼Œå¦‚æœåˆšå†™å®Œç¼“å­˜ï¼Œçªç„¶ç½‘ç»œå‡ºç°äº†å¼‚å¸¸ï¼Œå¯¼è‡´å†™æ•°æ®åº“å¤±è´¥äº†ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650526436447.png\" alt=\"å›¾ç‰‡\"></p>\n<p>å…¶ç»“æœæ˜¯ç¼“å­˜æ›´æ–°æˆäº†æœ€æ–°æ•°æ®ï¼Œä½†æ•°æ®åº“æ²¡æœ‰ï¼Œè¿™æ ·ç¼“å­˜ä¸­çš„æ•°æ®ä¸å°±å˜æˆè„æ•°æ®äº†ï¼Ÿå¦‚æœæ­¤æ—¶è¯¥ç”¨æˆ·çš„æŸ¥è¯¢è¯·æ±‚ï¼Œæ­£å¥½è¯»å–åˆ°è¯¥æ•°æ®ï¼Œå°±ä¼šå‡ºç°é—®é¢˜ï¼Œå› ä¸ºè¯¥æ•°æ®åœ¨æ•°æ®åº“ä¸­æ ¹æœ¬ä¸å­˜åœ¨ï¼Œè¿™ä¸ªé—®é¢˜éå¸¸ä¸¥é‡ã€‚</p>\n<p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œç¼“å­˜çš„ä¸»è¦ç›®çš„æ˜¯æŠŠæ•°æ®åº“çš„æ•°æ®ä¸´æ—¶ä¿å­˜åœ¨å†…å­˜ï¼Œä¾¿äºåç»­çš„æŸ¥è¯¢ï¼Œæå‡æŸ¥è¯¢é€Ÿåº¦ã€‚</p>\n<p>ä½†å¦‚æœæŸæ¡æ•°æ®ï¼Œåœ¨æ•°æ®åº“ä¸­éƒ½ä¸å­˜åœ¨ï¼Œä½ ç¼“å­˜è¿™ç§â€œ<code>å‡æ•°æ®</code>â€åˆæœ‰å•¥æ„ä¹‰å‘¢ï¼Ÿ</p>\n<p>å› æ­¤ï¼Œå…ˆå†™ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“çš„æ–¹æ¡ˆæ˜¯ä¸å¯å–çš„ï¼Œåœ¨å®é™…å·¥ä½œä¸­ç”¨å¾—ä¸å¤šã€‚</p>\n<h3 id=\"å…ˆå†™æ•°æ®åº“ï¼Œå†å†™ç¼“å­˜\"><a href=\"#å…ˆå†™æ•°æ®åº“ï¼Œå†å†™ç¼“å­˜\" class=\"headerlink\" title=\"å…ˆå†™æ•°æ®åº“ï¼Œå†å†™ç¼“å­˜\"></a>å…ˆå†™æ•°æ®åº“ï¼Œå†å†™ç¼“å­˜</h3><p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650526499487.png\" alt=\"å›¾ç‰‡\"></p>\n<p>ç”¨æˆ·çš„å†™æ“ä½œï¼Œå…ˆå†™æ•°æ®åº“ï¼Œå†å†™ç¼“å­˜ï¼Œå¯ä»¥é¿å…ä¹‹å‰â€œå‡æ•°æ®â€çš„é—®é¢˜ã€‚ä½†å®ƒå´å¸¦æ¥äº†æ–°çš„é—®é¢˜ã€‚</p>\n<h4 id=\"å†™ç¼“å­˜å¤±è´¥äº†\"><a href=\"#å†™ç¼“å­˜å¤±è´¥äº†\" class=\"headerlink\" title=\"å†™ç¼“å­˜å¤±è´¥äº†\"></a>å†™ç¼“å­˜å¤±è´¥äº†</h4><p>å¦‚æœæŠŠå†™æ•°æ®åº“å’Œå†™ç¼“å­˜æ“ä½œï¼Œæ”¾åœ¨åŒä¸€ä¸ªäº‹åŠ¡å½“ä¸­ï¼Œå½“å†™ç¼“å­˜å¤±è´¥äº†ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå†™å…¥æ•°æ®åº“çš„æ•°æ®è¿›è¡Œå›æ»šã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650526558901.png\" alt=\"å›¾ç‰‡\"></p>\n<p>å¦‚æœæ˜¯å¹¶å‘é‡æ¯”è¾ƒå°ï¼Œå¯¹æ¥å£æ€§èƒ½è¦æ±‚ä¸å¤ªé«˜çš„ç³»ç»Ÿï¼Œå¯ä»¥è¿™ä¹ˆç©ã€‚</p>\n<p>ä½†å¦‚æœåœ¨é«˜å¹¶å‘çš„ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œå†™æ•°æ®åº“å’Œå†™ç¼“å­˜ï¼Œéƒ½å±äºè¿œç¨‹æ“ä½œã€‚ä¸ºäº†é˜²æ­¢å‡ºç°å¤§äº‹åŠ¡ï¼Œé€ æˆçš„æ­»é”é—®é¢˜ï¼Œé€šå¸¸å»ºè®®å†™æ•°æ®åº“å’Œå†™ç¼“å­˜ä¸è¦æ”¾åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ã€‚</p>\n<p>ä¹Ÿå°±æ˜¯è¯´åœ¨è¯¥æ–¹æ¡ˆä¸­ï¼Œå¦‚æœå†™æ•°æ®åº“æˆåŠŸäº†ï¼Œä½†å†™ç¼“å­˜å¤±è´¥äº†ï¼Œæ•°æ®åº“ä¸­å·²å†™å…¥çš„æ•°æ®ä¸ä¼šå›æ»šã€‚</p>\n<p>è¿™å°±ä¼šå‡ºç°ï¼šæ•°æ®åº“æ˜¯<code>æ–°æ•°æ®</code>ï¼Œè€Œç¼“å­˜æ˜¯<code>æ—§æ•°æ®</code>ï¼Œä¸¤è¾¹<code>æ•°æ®ä¸ä¸€è‡´</code>çš„æƒ…å†µã€‚</p>\n<h4 id=\"é«˜å¹¶å‘ä¸‹çš„é—®é¢˜\"><a href=\"#é«˜å¹¶å‘ä¸‹çš„é—®é¢˜\" class=\"headerlink\" title=\"é«˜å¹¶å‘ä¸‹çš„é—®é¢˜\"></a>é«˜å¹¶å‘ä¸‹çš„é—®é¢˜</h4><p>å‡è®¾åœ¨é«˜å¹¶å‘çš„åœºæ™¯ä¸­ï¼Œé’ˆå¯¹åŒä¸€ä¸ªç”¨æˆ·çš„åŒä¸€æ¡æ•°æ®ï¼Œæœ‰ä¸¤ä¸ªå†™æ•°æ®è¯·æ±‚ï¼ša å’Œ bï¼Œå®ƒä»¬åŒæ—¶è¯·æ±‚åˆ°ä¸šåŠ¡ç³»ç»Ÿã€‚</p>\n<p>å…¶ä¸­è¯·æ±‚ a è·å–çš„æ˜¯æ—§æ•°æ®ï¼Œè€Œè¯·æ±‚ b è·å–çš„æ˜¯æ–°æ•°æ®ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650526645914.png\" alt=\"å›¾ç‰‡\"></p>\n<ol>\n<li>è¯·æ±‚ a å…ˆè¿‡æ¥ï¼Œåˆšå†™å®Œäº†æ•°æ®åº“ã€‚ä½†ç”±äºç½‘ç»œåŸå› ï¼Œå¡é¡¿äº†ä¸€ä¸‹ï¼Œè¿˜æ²¡æ¥å¾—åŠå†™ç¼“å­˜ã€‚</li>\n<li>è¿™æ—¶å€™è¯·æ±‚ b è¿‡æ¥äº†ï¼Œå…ˆå†™äº†æ•°æ®åº“ã€‚</li>\n<li>æ¥ä¸‹æ¥ï¼Œè¯·æ±‚ b é¡ºåˆ©å†™äº†ç¼“å­˜ã€‚</li>\n<li>æ­¤æ—¶ï¼Œè¯·æ±‚ a å¡é¡¿ç»“æŸï¼Œä¹Ÿå†™äº†ç¼“å­˜ã€‚</li>\n</ol>\n<p>å¾ˆæ˜¾ç„¶ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹å½“ä¸­ï¼Œè¯·æ±‚ b åœ¨ç¼“å­˜ä¸­çš„<code>æ–°æ•°æ®</code>ï¼Œè¢«è¯·æ±‚ a çš„<code>æ—§æ•°æ®</code>è¦†ç›–äº†ã€‚</p>\n<p>ä¹Ÿå°±æ˜¯è¯´ï¼šåœ¨é«˜å¹¶å‘åœºæ™¯ä¸­ï¼Œå¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶æ‰§è¡Œå…ˆå†™æ•°æ®åº“ï¼Œå†å†™ç¼“å­˜çš„æ“ä½œï¼Œå¯èƒ½ä¼šå‡ºç°æ•°æ®åº“æ˜¯æ–°å€¼ï¼Œè€Œç¼“å­˜ä¸­æ˜¯æ—§å€¼ï¼Œä¸¤è¾¹æ•°æ®ä¸ä¸€è‡´çš„æƒ…å†µã€‚</p>\n<h4 id=\"æµªè´¹ç³»ç»Ÿèµ„æº\"><a href=\"#æµªè´¹ç³»ç»Ÿèµ„æº\" class=\"headerlink\" title=\"æµªè´¹ç³»ç»Ÿèµ„æº\"></a>æµªè´¹ç³»ç»Ÿèµ„æº</h4><p>æœ‰äº›ä¸šåŠ¡åœºæ™¯æ¯”è¾ƒç‰¹æ®Šï¼š<code>å†™å¤šè¯»å°‘</code>ã€‚</p>\n<p>å¦‚æœåœ¨è¿™ç±»ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œæ¯ä¸ªç”¨çš„å†™æ“ä½œï¼Œéƒ½éœ€è¦å†™ä¸€æ¬¡ç¼“å­˜ï¼Œæœ‰ç‚¹å¾—ä¸å¿å¤±ã€‚</p>\n<p>è¿˜ä¸å¦‚ä¸ç”¨ Redisï¼Œåæ­£å†™æ•°æ®åº“éƒ½è¦å†™ï¼Œæˆ‘è¯»æ•°æ®åˆæ¯”è¾ƒå°‘ï¼ŒRedis ä½¿ç”¨é¢‘ç‡ä½ï¼Œå´è¿˜è¦ä¸€ç›´æ›´æ–° Redis ä¸­æ•°æ®ã€‚</p>\n<h3 id=\"å…ˆåˆ ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“\"><a href=\"#å…ˆåˆ ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“\" class=\"headerlink\" title=\"å…ˆåˆ ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“\"></a>å…ˆåˆ ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“</h3><p>ä¸ç„¶æ˜¯å…ˆå†™ç¼“å­˜è¿˜æ˜¯å…ˆå†™æ•°æ®åº“éƒ½æœ‰å¾ˆå¤šé—®é¢˜ï¼Œé‚£ä¹ˆè€ƒè™‘ä¸æ˜¯ <code>æ›´æ–°ç¼“å­˜</code> è€Œæ˜¯ <code>åˆ é™¤ç¼“å­˜</code>ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650526855730.png\" alt=\"å›¾ç‰‡\"></p>\n<p>åœ¨ç”¨æˆ·çš„å†™æ“ä½œä¸­ï¼Œå…ˆæ‰§è¡Œåˆ é™¤ç¼“å­˜æ“ä½œï¼Œå†å»å†™æ•°æ®åº“</p>\n<h4 id=\"é«˜å¹¶å‘ä¸‹çš„é—®é¢˜-1\"><a href=\"#é«˜å¹¶å‘ä¸‹çš„é—®é¢˜-1\" class=\"headerlink\" title=\"é«˜å¹¶å‘ä¸‹çš„é—®é¢˜\"></a>é«˜å¹¶å‘ä¸‹çš„é—®é¢˜</h4><p>å‡è®¾åœ¨é«˜å¹¶å‘çš„åœºæ™¯ä¸­ï¼ŒåŒä¸€ä¸ªç”¨æˆ·çš„åŒä¸€æ¡æ•°æ®ï¼Œæœ‰ä¸€ä¸ªè¯»æ•°æ®è¯·æ±‚ cï¼Œè¿˜æœ‰å¦ä¸€ä¸ªå†™æ•°æ®è¯·æ±‚ dï¼ˆä¸€ä¸ªæ›´æ–°æ“ä½œï¼‰ï¼ŒåŒæ—¶è¯·æ±‚åˆ°ä¸šåŠ¡ç³»ç»Ÿã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650527043982.png\" alt=\"å›¾ç‰‡\"></p>\n<ol>\n<li>è¯·æ±‚ d å…ˆè¿‡æ¥ï¼ŒæŠŠç¼“å­˜åˆ é™¤äº†ã€‚ä½†ç”±äºç½‘ç»œåŸå› ï¼Œå¡é¡¿äº†ä¸€ä¸‹ï¼Œè¿˜æ²¡æ¥å¾—åŠå†™æ•°æ®åº“ã€‚</li>\n<li>è¿™æ—¶è¯·æ±‚ c è¿‡æ¥äº†ï¼Œå…ˆæŸ¥ç¼“å­˜å‘ç°æ²¡æ•°æ®ï¼Œå†æŸ¥æ•°æ®åº“ï¼Œæœ‰æ•°æ®ï¼Œä½†æ˜¯æ—§å€¼ã€‚</li>\n<li>è¯·æ±‚ c å°†æ•°æ®åº“ä¸­çš„æ—§å€¼ï¼Œæ›´æ–°åˆ°ç¼“å­˜ä¸­ã€‚</li>\n<li>æ­¤æ—¶ï¼Œè¯·æ±‚ d å¡é¡¿ç»“æŸï¼ŒæŠŠæ–°å€¼å†™å…¥æ•°æ®åº“ã€‚</li>\n</ol>\n<p>åœ¨è¿™ä¸ªè¿‡ç¨‹å½“ä¸­ï¼Œè¯·æ±‚ d çš„æ–°å€¼å¹¶æ²¡æœ‰è¢«è¯·æ±‚ c å†™å…¥ç¼“å­˜ï¼ŒåŒæ ·ä¼šå¯¼è‡´ç¼“å­˜å’Œæ•°æ®åº“çš„æ•°æ®ä¸ä¸€è‡´çš„æƒ…å†µã€‚</p>\n<h4 id=\"ç¼“å­˜åŒåˆ \"><a href=\"#ç¼“å­˜åŒåˆ \" class=\"headerlink\" title=\"ç¼“å­˜åŒåˆ \"></a>ç¼“å­˜åŒåˆ </h4><p>åœ¨ä¸Šé¢çš„ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œä¸€ä¸ªè¯»æ•°æ®è¯·æ±‚ï¼Œä¸€ä¸ªå†™æ•°æ®è¯·æ±‚ã€‚å½“å†™æ•°æ®è¯·æ±‚æŠŠç¼“å­˜åˆ äº†ä¹‹åï¼Œè¯»æ•°æ®è¯·æ±‚ï¼Œå¯èƒ½æŠŠå½“æ—¶ä»æ•°æ®åº“æŸ¥è¯¢å‡ºæ¥çš„æ—§å€¼ï¼Œå†™å…¥ç¼“å­˜å½“ä¸­ã€‚</p>\n<p>æœ‰äººè¯´è¿˜ä¸å¥½åŠï¼Œè¯·æ±‚ d åœ¨å†™å®Œæ•°æ®åº“ä¹‹åï¼ŒæŠŠç¼“å­˜é‡æ–°åˆ ä¸€æ¬¡ä¸å°±è¡Œäº†ï¼Ÿ</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650528097218.png\" alt=\"å›¾ç‰‡\"></p>\n<p>è¿™å°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„<code>ç¼“å­˜åŒåˆ </code>ï¼Œå³åœ¨å†™æ•°æ®åº“ä¹‹å‰åˆ é™¤ä¸€æ¬¡ï¼Œå†™å®Œæ•°æ®åº“åï¼Œå†åˆ é™¤ä¸€æ¬¡ã€‚</p>\n<p>è¯¥æ–¹æ¡ˆæœ‰ä¸ªéå¸¸å…³é”®çš„åœ°æ–¹æ˜¯ï¼šç¬¬äºŒæ¬¡åˆ é™¤ç¼“å­˜ï¼Œå¹¶éç«‹é©¬å°±åˆ ï¼Œè€Œæ˜¯è¦åœ¨ä¸€å®šçš„<code>æ—¶é—´é—´éš”</code>ä¹‹åã€‚</p>\n<p>æˆ‘ä»¬å†é‡æ–°å›é¡¾ä¸€ä¸‹ï¼Œé«˜å¹¶å‘ä¸‹ä¸€ä¸ªè¯»æ•°æ®è¯·æ±‚ï¼Œä¸€ä¸ªå†™æ•°æ®è¯·æ±‚å¯¼è‡´æ•°æ®ä¸ä¸€è‡´çš„äº§ç”Ÿè¿‡ç¨‹ï¼š</p>\n<ol>\n<li>è¯·æ±‚ d å…ˆè¿‡æ¥ï¼ŒæŠŠç¼“å­˜åˆ é™¤äº†ã€‚ä½†ç”±äºç½‘ç»œåŸå› ï¼Œå¡é¡¿äº†ä¸€ä¸‹ï¼Œè¿˜æ²¡æ¥å¾—åŠå†™æ•°æ®åº“ã€‚</li>\n<li>è¿™æ—¶è¯·æ±‚ c è¿‡æ¥äº†ï¼Œå…ˆæŸ¥ç¼“å­˜å‘ç°æ²¡æ•°æ®ï¼Œå†æŸ¥æ•°æ®åº“ï¼Œæœ‰æ•°æ®ï¼Œä½†æ˜¯æ—§å€¼ã€‚</li>\n<li>è¯·æ±‚ c å°†æ•°æ®åº“ä¸­çš„æ—§å€¼ï¼Œæ›´æ–°åˆ°ç¼“å­˜ä¸­ã€‚</li>\n<li>æ­¤æ—¶ï¼Œè¯·æ±‚ d å¡é¡¿ç»“æŸï¼ŒæŠŠæ–°å€¼å†™å…¥æ•°æ®åº“ã€‚</li>\n<li>ä¸€æ®µæ—¶é—´ä¹‹åï¼Œæ¯”å¦‚ï¼š500msï¼Œè¯·æ±‚ d å°†ç¼“å­˜åˆ é™¤ã€‚</li>\n</ol>\n<p>è¿™æ ·æ¥çœ‹ç¡®å®å¯ä»¥è§£å†³ç¼“å­˜ä¸ä¸€è‡´é—®é¢˜ã€‚</p>\n<p>é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆä¸€å®šè¦é—´éš”ä¸€æ®µæ—¶é—´ä¹‹åï¼Œæ‰èƒ½åˆ é™¤ç¼“å­˜å‘¢ï¼Ÿ</p>\n<p>è¯·æ±‚ d å¡é¡¿ç»“æŸï¼ŒæŠŠæ–°å€¼å†™å…¥æ•°æ®åº“åï¼Œè¯·æ±‚ c å°†æ•°æ®åº“ä¸­çš„æ—§å€¼ï¼Œæ›´æ–°åˆ°ç¼“å­˜ä¸­ã€‚</p>\n<p>æ­¤æ—¶ï¼Œå¦‚æœè¯·æ±‚ d åˆ é™¤å¤ªå¿«ï¼Œåœ¨è¯·æ±‚ c å°†æ•°æ®åº“ä¸­çš„æ—§å€¼æ›´æ–°åˆ°ç¼“å­˜ä¹‹å‰ï¼Œå°±å·²ç»æŠŠç¼“å­˜åˆ é™¤äº†ï¼Œè¿™æ¬¡åˆ é™¤å°±æ²¡ä»»ä½•æ„ä¹‰ã€‚å¿…é¡»è¦åœ¨è¯·æ±‚ c æ›´æ–°ç¼“å­˜ä¹‹åï¼Œå†åˆ é™¤ç¼“å­˜ï¼Œæ‰èƒ½æŠŠæ—§å€¼åŠæ—¶åˆ é™¤äº†ã€‚</p>\n<p>æ‰€ä»¥éœ€è¦åœ¨è¯·æ±‚ d ä¸­åŠ ä¸€ä¸ªæ—¶é—´é—´éš”ï¼Œç¡®ä¿è¯·æ±‚ cï¼Œæˆ–è€…ç±»ä¼¼äºè¯·æ±‚ c çš„å…¶ä»–è¯·æ±‚ï¼Œå¦‚æœåœ¨ç¼“å­˜ä¸­è®¾ç½®äº†æ—§å€¼ï¼Œæœ€ç»ˆéƒ½èƒ½å¤Ÿè¢«è¯·æ±‚ d åˆ é™¤æ‰ã€‚</p>\n<p>æ¥ä¸‹æ¥ï¼Œè¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœç¬¬äºŒæ¬¡åˆ é™¤ç¼“å­˜æ—¶ï¼Œåˆ é™¤å¤±è´¥äº†è¯¥æ€ä¹ˆåŠï¼Ÿ</p>\n<h3 id=\"å…ˆå†™æ•°æ®åº“ï¼Œå†åˆ ç¼“å­˜\"><a href=\"#å…ˆå†™æ•°æ®åº“ï¼Œå†åˆ ç¼“å­˜\" class=\"headerlink\" title=\"å…ˆå†™æ•°æ®åº“ï¼Œå†åˆ ç¼“å­˜\"></a>å…ˆå†™æ•°æ®åº“ï¼Œå†åˆ ç¼“å­˜</h3><p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650528137396.png\" alt=\"å›¾ç‰‡\"></p>\n<p>åœ¨é«˜å¹¶å‘çš„åœºæ™¯ä¸­ï¼Œæœ‰ä¸€ä¸ªè¯»æ•°æ®è¯·æ±‚ï¼Œæœ‰ä¸€ä¸ªå†™æ•°æ®è¯·æ±‚ï¼Œæ›´æ–°è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>\n<ol>\n<li>è¯·æ±‚ e å…ˆå†™æ•°æ®åº“ï¼Œç”±äºç½‘ç»œåŸå› å¡é¡¿äº†ä¸€ä¸‹ï¼Œæ²¡æœ‰æ¥å¾—åŠåˆ é™¤ç¼“å­˜ã€‚</li>\n<li>è¯·æ±‚ f æŸ¥è¯¢ç¼“å­˜ï¼Œå‘ç°ç¼“å­˜ä¸­æœ‰æ•°æ®ï¼Œç›´æ¥è¿”å›è¯¥æ•°æ®ã€‚</li>\n<li>è¯·æ±‚ e åˆ é™¤ç¼“å­˜ã€‚</li>\n</ol>\n<p>åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œåªæœ‰è¯·æ±‚ f è¯»äº†ä¸€æ¬¡æ—§æ•°æ®ï¼Œåæ¥æ—§æ•°æ®è¢«è¯·æ±‚ e åŠæ—¶åˆ é™¤äº†ï¼Œçœ‹èµ·æ¥é—®é¢˜ä¸å¤§ã€‚</p>\n<p>ä½†å¦‚æœæ˜¯è¯»æ•°æ®è¯·æ±‚å…ˆè¿‡æ¥å‘¢ï¼Ÿ</p>\n<ol>\n<li>è¯·æ±‚ f æŸ¥è¯¢ç¼“å­˜ï¼Œå‘ç°ç¼“å­˜ä¸­æœ‰æ•°æ®ï¼Œç›´æ¥è¿”å›è¯¥æ•°æ®ã€‚</li>\n<li>è¯·æ±‚ e å…ˆå†™æ•°æ®åº“ã€‚</li>\n<li>è¯·æ±‚ e åˆ é™¤ç¼“å­˜ã€‚</li>\n</ol>\n<p>è¿™ç§æƒ…å†µçœ‹èµ·æ¥ä¹Ÿæ²¡é—®é¢˜å‘€ï¼Ÿ</p>\n<p>ç­”ï¼šå¯¹çš„ã€‚</p>\n<p>ä½†å°±æ€•å‡ºç°ä¸‹é¢è¿™ç§æƒ…å†µï¼Œå³ç¼“å­˜è‡ªå·±å¤±æ•ˆäº†ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650528267733.png\" alt=\"å›¾ç‰‡\"></p>\n<ol>\n<li>ç¼“å­˜è¿‡æœŸæ—¶é—´åˆ°äº†ï¼Œè‡ªåŠ¨å¤±æ•ˆã€‚</li>\n<li>è¯·æ±‚ f æŸ¥è¯¢ç¼“å­˜ï¼Œå‘ç¼“å­˜ä¸­æ²¡æœ‰æ•°æ®ï¼ŒæŸ¥è¯¢æ•°æ®åº“çš„æ—§å€¼ï¼Œä½†ç”±äºç½‘ç»œåŸå› å¡é¡¿äº†ï¼Œæ²¡æœ‰æ¥å¾—åŠæ›´æ–°ç¼“å­˜ã€‚</li>\n<li>è¯·æ±‚ e å…ˆå†™æ•°æ®åº“ï¼Œæ¥ç€åˆ é™¤äº†ç¼“å­˜ã€‚</li>\n<li>è¯·æ±‚ f æ›´æ–°æ—§å€¼åˆ°ç¼“å­˜ä¸­ã€‚</li>\n</ol>\n<p>è¿™æ—¶ï¼Œç¼“å­˜å’Œæ•°æ®åº“çš„æ•°æ®åŒæ ·å‡ºç°ä¸ä¸€è‡´çš„æƒ…å†µäº†ã€‚</p>\n<p>ä½†è¿™ç§æƒ…å†µè¿˜æ˜¯æ¯”è¾ƒå°‘çš„ï¼Œéœ€è¦åŒæ—¶æ»¡è¶³ä»¥ä¸‹æ¡ä»¶æ‰å¯ä»¥ï¼š</p>\n<ol>\n<li>ç¼“å­˜åˆšå¥½è‡ªåŠ¨å¤±æ•ˆã€‚</li>\n<li>è¯·æ±‚ f ä»æ•°æ®åº“æŸ¥å‡ºæ—§å€¼ï¼Œæ›´æ–°ç¼“å­˜çš„è€—æ—¶ï¼Œæ¯”è¯·æ±‚ e å†™æ•°æ®åº“ï¼Œå¹¶ä¸”åˆ é™¤ç¼“å­˜çš„è¿˜é•¿ã€‚</li>\n</ol>\n<p>æˆ‘ä»¬éƒ½çŸ¥é“æŸ¥è¯¢æ•°æ®åº“çš„é€Ÿåº¦ï¼Œä¸€èˆ¬æ¯”å†™æ•°æ®åº“è¦å¿«ï¼Œæ›´ä½•å†µå†™å®Œæ•°æ®åº“ï¼Œè¿˜è¦åˆ é™¤ç¼“å­˜ã€‚æ‰€ä»¥ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå†™æ•°æ®è¯·æ±‚æ¯”è¯»æ•°æ®æƒ…å†µè€—æ—¶æ›´é•¿ã€‚</p>\n<p>ç”±æ­¤å¯è§ï¼Œç³»ç»ŸåŒæ—¶æ»¡è¶³ä¸Šè¿°ä¸¤ä¸ªæ¡ä»¶çš„æ¦‚ç‡éå¸¸å°ã€‚</p>\n<blockquote>\n<p>æ¨èå¤§å®¶ä½¿ç”¨å…ˆå†™æ•°æ®åº“ï¼Œå†åˆ ç¼“å­˜çš„æ–¹æ¡ˆï¼Œè™½è¯´ä¸èƒ½100%é¿å…æ•°æ®ä¸ä¸€è‡´é—®é¢˜ï¼Œä½†å‡ºç°è¯¥é—®é¢˜çš„æ¦‚ç‡ï¼Œç›¸å¯¹äºå…¶ä»–æ–¹æ¡ˆæ¥è¯´æ˜¯æœ€å°çš„ã€‚</p>\n</blockquote>\n<p>ä½†åœ¨è¯¥æ–¹æ¡ˆä¸­ï¼Œå¦‚æœåˆ é™¤ç¼“å­˜å¤±è´¥äº†è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p>\n<h3 id=\"åˆ ç¼“å­˜å¤±è´¥æ€ä¹ˆåŠï¼Ÿ\"><a href=\"#åˆ ç¼“å­˜å¤±è´¥æ€ä¹ˆåŠï¼Ÿ\" class=\"headerlink\" title=\"åˆ ç¼“å­˜å¤±è´¥æ€ä¹ˆåŠï¼Ÿ\"></a>åˆ ç¼“å­˜å¤±è´¥æ€ä¹ˆåŠï¼Ÿ</h3><p>å…¶å®å…ˆå†™æ•°æ®åº“ï¼Œå†åˆ ç¼“å­˜çš„æ–¹æ¡ˆï¼Œè·Ÿç¼“å­˜åŒåˆ çš„æ–¹æ¡ˆä¸€æ ·ï¼Œæœ‰ä¸€ä¸ªå…±åŒçš„é£é™©ç‚¹ï¼Œå³ï¼šå¦‚æœç¼“å­˜åˆ é™¤å¤±è´¥äº†ï¼Œä¹Ÿä¼šå¯¼è‡´ç¼“å­˜å’Œæ•°æ®åº“çš„æ•°æ®ä¸ä¸€è‡´ã€‚</p>\n<p>é‚£ä¹ˆï¼Œåˆ é™¤ç¼“å­˜å¤±è´¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p>\n<p>ç­”ï¼šéœ€è¦åŠ <code>é‡è¯•æœºåˆ¶</code>ã€‚</p>\n<p>åœ¨æ¥å£ä¸­å¦‚æœæ›´æ–°äº†æ•°æ®åº“æˆåŠŸäº†ï¼Œä½†æ›´æ–°ç¼“å­˜å¤±è´¥äº†ï¼Œå¯ä»¥ç«‹åˆ»é‡è¯• 3 æ¬¡ã€‚å¦‚æœå…¶ä¸­æœ‰ä»»ä½•ä¸€æ¬¡æˆåŠŸï¼Œåˆ™ç›´æ¥è¿”å›æˆåŠŸã€‚å¦‚æœ 3 æ¬¡éƒ½å¤±è´¥äº†ï¼Œåˆ™å†™å…¥æ•°æ®åº“ï¼Œå‡†å¤‡åç»­å†å¤„ç†ã€‚</p>\n<p>å½“ç„¶ï¼Œå¦‚æœä½ åœ¨æ¥å£ä¸­ç›´æ¥<code>åŒæ­¥é‡è¯•</code>ï¼Œè¯¥æ¥å£å¹¶å‘é‡æ¯”è¾ƒé«˜çš„æ—¶å€™ï¼Œå¯èƒ½æœ‰ç‚¹å½±å“æ¥å£æ€§èƒ½ã€‚</p>\n<p>è¿™æ—¶ï¼Œå°±éœ€è¦æ”¹æˆ<code>å¼‚æ­¥é‡è¯•</code>äº†ã€‚</p>\n<p>å¼‚æ­¥é‡è¯•æ–¹å¼æœ‰å¾ˆå¤šç§ï¼Œæ¯”å¦‚ï¼š</p>\n<ol>\n<li>æ¯æ¬¡éƒ½å•ç‹¬èµ·ä¸€ä¸ªçº¿ç¨‹ï¼Œè¯¥çº¿ç¨‹ä¸“é—¨åšé‡è¯•çš„å·¥ä½œã€‚ä½†å¦‚æœåœ¨é«˜å¹¶å‘çš„åœºæ™¯ä¸‹ï¼Œå¯èƒ½ä¼šåˆ›å»ºå¤ªå¤šçš„çº¿ç¨‹ï¼Œå¯¼è‡´ç³»ç»Ÿ OOM é—®é¢˜ï¼Œä¸å¤ªå»ºè®®ä½¿ç”¨ã€‚</li>\n<li>å°†é‡è¯•çš„ä»»åŠ¡äº¤ç»™çº¿ç¨‹æ± å¤„ç†ï¼Œä½†å¦‚æœæœåŠ¡å™¨é‡å¯ï¼Œéƒ¨åˆ†æ•°æ®å¯èƒ½ä¼šä¸¢å¤±ã€‚</li>\n<li>å°†é‡è¯•æ•°æ®å†™è¡¨ï¼Œç„¶åä½¿ç”¨ elastic-job ç­‰å®šæ—¶ä»»åŠ¡è¿›è¡Œé‡è¯•ã€‚</li>\n<li>å°†é‡è¯•çš„è¯·æ±‚å†™å…¥ mq ç­‰æ¶ˆæ¯ä¸­é—´ä»¶ä¸­ï¼Œåœ¨ mq çš„ consumer ä¸­å¤„ç†ã€‚</li>\n<li>è®¢é˜… mysql çš„ binlogï¼Œåœ¨è®¢é˜…è€…ä¸­ï¼Œå¦‚æœå‘ç°äº†æ›´æ–°æ•°æ®è¯·æ±‚ï¼Œåˆ™åˆ é™¤ç›¸åº”çš„ç¼“å­˜ã€‚</li>\n</ol>\n<h4 id=\"å®šæ—¶ä»»åŠ¡\"><a href=\"#å®šæ—¶ä»»åŠ¡\" class=\"headerlink\" title=\"å®šæ—¶ä»»åŠ¡\"></a>å®šæ—¶ä»»åŠ¡</h4><p>ä½¿ç”¨<code>å®šæ—¶ä»»åŠ¡é‡è¯•</code>çš„å…·ä½“æ–¹æ¡ˆå¦‚ä¸‹ï¼š</p>\n<ol>\n<li><p>å½“ç”¨æˆ·æ“ä½œå†™å®Œæ•°æ®åº“ï¼Œä½†åˆ é™¤ç¼“å­˜å¤±è´¥äº†ï¼Œéœ€è¦å°†ç”¨æˆ·æ•°æ®å†™å…¥é‡è¯•è¡¨ä¸­ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>\n<p> <img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650528474531.png\" alt=\"å›¾ç‰‡\"></p>\n</li>\n<li><p>åœ¨å®šæ—¶ä»»åŠ¡ä¸­ï¼Œå¼‚æ­¥è¯»å–é‡è¯•è¡¨ä¸­çš„ç”¨æˆ·æ•°æ®ã€‚é‡è¯•è¡¨éœ€è¦è®°å½•ä¸€ä¸ªé‡è¯•æ¬¡æ•°å­—æ®µï¼Œåˆå§‹å€¼ä¸º 0ã€‚ç„¶åé‡è¯• 5 æ¬¡ï¼Œä¸æ–­åˆ é™¤ç¼“å­˜ï¼Œæ¯é‡è¯•ä¸€æ¬¡è¯¥å­—æ®µå€¼+1ã€‚å¦‚æœå…¶ä¸­æœ‰ä»»æ„ä¸€æ¬¡æˆåŠŸäº†ï¼Œåˆ™è¿”å›æˆåŠŸã€‚å¦‚æœé‡è¯•äº† 5 æ¬¡ï¼Œè¿˜æ˜¯å¤±è´¥ï¼Œåˆ™æˆ‘ä»¬éœ€è¦åœ¨é‡è¯•è¡¨ä¸­è®°å½•ä¸€ä¸ªå¤±è´¥çš„çŠ¶æ€ï¼Œç­‰å¾…åç»­è¿›ä¸€æ­¥å¤„ç†ã€‚</p>\n<p> <img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650528480542.png\" alt=\"å›¾ç‰‡\"></p>\n</li>\n<li><p>åœ¨é«˜å¹¶å‘åœºæ™¯ä¸­ï¼Œå®šæ—¶ä»»åŠ¡æ¨èä½¿ç”¨<code>elastic-job</code>ã€‚ç›¸å¯¹äº xxl-job ç­‰å®šæ—¶ä»»åŠ¡ï¼Œå®ƒå¯ä»¥åˆ†ç‰‡å¤„ç†ï¼Œæå‡å¤„ç†é€Ÿåº¦ã€‚åŒæ—¶æ¯ç‰‡çš„é—´éš”å¯ä»¥è®¾ç½®æˆï¼š1,2,3,5,7 ç§’ç­‰ã€‚</p>\n</li>\n</ol>\n<p>ä½¿ç”¨å®šæ—¶ä»»åŠ¡é‡è¯•çš„è¯ï¼Œæœ‰ä¸ªç¼ºç‚¹å°±æ˜¯å®æ—¶æ€§æ²¡é‚£ä¹ˆé«˜ï¼Œå¯¹äºå®æ—¶æ€§è¦æ±‚ç‰¹åˆ«é«˜çš„ä¸šåŠ¡åœºæ™¯ï¼Œè¯¥æ–¹æ¡ˆä¸å¤ªé€‚ç”¨ã€‚ä½†æ˜¯å¯¹äºä¸€èˆ¬åœºæ™¯ï¼Œè¿˜æ˜¯å¯ä»¥ç”¨ä¸€ç”¨çš„ã€‚</p>\n<p>ä½†å®ƒæœ‰ä¸€ä¸ªå¾ˆå¤§çš„ä¼˜ç‚¹ï¼Œå³æ•°æ®æ˜¯è½åº“çš„ï¼Œä¸ä¼šä¸¢æ•°æ®ã€‚</p>\n<h4 id=\"mq\"><a href=\"#mq\" class=\"headerlink\" title=\"mq\"></a>mq</h4><p>åœ¨é«˜å¹¶å‘çš„ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œmqï¼ˆæ¶ˆæ¯é˜Ÿåˆ—ï¼‰æ˜¯å¿…ä¸å¯å°‘çš„æŠ€æœ¯ä¹‹ä¸€ã€‚å®ƒä¸ä»…å¯ä»¥å¼‚æ­¥è§£è€¦ï¼Œè¿˜èƒ½å‰Šå³°å¡«è°·ã€‚å¯¹ä¿è¯ç³»ç»Ÿçš„ç¨³å®šæ€§æ˜¯éå¸¸æœ‰æ„ä¹‰çš„ã€‚</p>\n<p>mq çš„ç”Ÿäº§è€…ï¼Œç”Ÿäº§äº†æ¶ˆæ¯ä¹‹åï¼Œé€šè¿‡æŒ‡å®šçš„ topic å‘é€åˆ° mq æœåŠ¡å™¨ã€‚ç„¶å mq çš„æ¶ˆè´¹è€…ï¼Œè®¢é˜…è¯¥ topic çš„æ¶ˆæ¯ï¼Œè¯»å–æ¶ˆæ¯æ•°æ®ä¹‹åï¼Œåšä¸šåŠ¡é€»è¾‘å¤„ç†ã€‚</p>\n<p>ä½¿ç”¨<code>mqé‡è¯•</code>çš„å…·ä½“æ–¹æ¡ˆå¦‚ä¸‹ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650528506474.png\" alt=\"å›¾ç‰‡\"></p>\n<ol>\n<li>å½“ç”¨æˆ·æ“ä½œå†™å®Œæ•°æ®åº“ï¼Œä½†åˆ é™¤ç¼“å­˜å¤±è´¥äº†ï¼Œäº§ç”Ÿä¸€æ¡ mq æ¶ˆæ¯ï¼Œå‘é€ç»™ mq æœåŠ¡å™¨ã€‚</li>\n<li>mq æ¶ˆè´¹è€…è¯»å– mq æ¶ˆæ¯ï¼Œé‡è¯• 5 æ¬¡åˆ é™¤ç¼“å­˜ã€‚å¦‚æœå…¶ä¸­æœ‰ä»»æ„ä¸€æ¬¡æˆåŠŸäº†ï¼Œåˆ™è¿”å›æˆåŠŸã€‚å¦‚æœé‡è¯•äº† 5 æ¬¡ï¼Œè¿˜æ˜¯å¤±è´¥ï¼Œåˆ™å†™å…¥<code>æ­»ä¿¡é˜Ÿåˆ—</code>ä¸­ã€‚</li>\n<li>æ¨è mq ä½¿ç”¨<code>rocketmq</code>ï¼Œé‡è¯•æœºåˆ¶å’Œæ­»ä¿¡é˜Ÿåˆ—é»˜è®¤æ˜¯æ”¯æŒçš„ã€‚ä½¿ç”¨èµ·æ¥éå¸¸æ–¹ä¾¿ï¼Œè€Œä¸”è¿˜æ”¯æŒé¡ºåºæ¶ˆæ¯ï¼Œå»¶è¿Ÿæ¶ˆæ¯å’Œäº‹åŠ¡æ¶ˆæ¯ç­‰å¤šç§ä¸šåŠ¡åœºæ™¯ã€‚</li>\n</ol>\n<p>å½“ç„¶åœ¨è¯¥æ–¹æ¡ˆä¸­ï¼Œåˆ é™¤ç¼“å­˜å¯ä»¥å®Œå…¨èµ°å¼‚æ­¥ã€‚å³ç”¨æˆ·çš„å†™æ“ä½œï¼Œåœ¨å†™å®Œæ•°æ®åº“ä¹‹åï¼Œä¸ç”¨ç«‹åˆ»åˆ é™¤ä¸€æ¬¡ç¼“å­˜ã€‚è€Œç›´æ¥å‘é€ mq æ¶ˆæ¯ï¼Œåˆ° mq æœåŠ¡å™¨ï¼Œç„¶åæœ‰ mq æ¶ˆè´¹è€…å…¨æƒè´Ÿè´£åˆ é™¤ç¼“å­˜çš„ä»»åŠ¡ã€‚</p>\n<p>å› ä¸º mq çš„å®æ—¶æ€§è¿˜æ˜¯æ¯”è¾ƒé«˜çš„ï¼Œå› æ­¤æ”¹è‰¯åçš„æ–¹æ¡ˆä¹Ÿæ˜¯ä¸€ç§ä¸é”™çš„é€‰æ‹©ã€‚</p>\n<h4 id=\"binlog\"><a href=\"#binlog\" class=\"headerlink\" title=\"binlog\"></a>binlog</h4><p>å‰é¢æˆ‘ä»¬èŠè¿‡çš„ï¼Œæ— è®ºæ˜¯å®šæ—¶ä»»åŠ¡ï¼Œè¿˜æ˜¯ mqï¼ˆæ¶ˆæ¯é˜Ÿåˆ—ï¼‰ï¼Œåšé‡è¯•æœºåˆ¶ï¼Œå¯¹ä¸šåŠ¡éƒ½æœ‰ä¸€å®šçš„ä¾µå…¥æ€§ã€‚</p>\n<p>åœ¨ä½¿ç”¨å®šæ—¶ä»»åŠ¡çš„æ–¹æ¡ˆä¸­ï¼Œéœ€è¦åœ¨ä¸šåŠ¡ä»£ç ä¸­å¢åŠ é¢å¤–é€»è¾‘ï¼Œå¦‚æœåˆ é™¤ç¼“å­˜å¤±è´¥ï¼Œéœ€è¦å°†æ•°æ®å†™å…¥é‡è¯•è¡¨ã€‚</p>\n<p>è€Œä½¿ç”¨ mq çš„æ–¹æ¡ˆä¸­ï¼Œå¦‚æœåˆ é™¤ç¼“å­˜å¤±è´¥äº†ï¼Œéœ€è¦åœ¨ä¸šåŠ¡ä»£ç ä¸­å‘é€ mq æ¶ˆæ¯åˆ° mq æœåŠ¡å™¨ã€‚</p>\n<p>å…¶å®ï¼Œè¿˜æœ‰ä¸€ç§æ›´ä¼˜é›…çš„å®ç°ï¼Œå³<code>ç›‘å¬binlog</code>ï¼Œæ¯”å¦‚ä½¿ç”¨ï¼š<code>canal</code>ç­‰ä¸­é—´ä»¶ã€‚</p>\n<p>å…·ä½“æ–¹æ¡ˆå¦‚ä¸‹ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650528533430.png\" alt=\"å›¾ç‰‡\"></p>\n<ol>\n<li>åœ¨ä¸šåŠ¡æ¥å£ä¸­å†™æ•°æ®åº“ä¹‹åï¼Œå°±ä¸ç®¡äº†ï¼Œç›´æ¥è¿”å›æˆåŠŸã€‚</li>\n<li>mysql æœåŠ¡å™¨ä¼šè‡ªåŠ¨æŠŠå˜æ›´çš„æ•°æ®å†™å…¥ binlog ä¸­ã€‚</li>\n<li>binlog è®¢é˜…è€…è·å–å˜æ›´çš„æ•°æ®ï¼Œç„¶ååˆ é™¤ç¼“å­˜ã€‚</li>\n</ol>\n<p>è¿™å¥—æ–¹æ¡ˆä¸­ä¸šåŠ¡æ¥å£ç¡®å®ç®€åŒ–äº†ä¸€äº›æµç¨‹ï¼Œåªç”¨å…³å¿ƒæ•°æ®åº“æ“ä½œå³å¯ï¼Œè€Œåœ¨ binlog è®¢é˜…è€…ä¸­åšç¼“å­˜åˆ é™¤å·¥ä½œã€‚</p>\n<p>ä½†å¦‚æœåªæ˜¯æŒ‰ç…§å›¾ä¸­çš„æ–¹æ¡ˆè¿›è¡Œåˆ é™¤ç¼“å­˜ï¼Œåªåˆ é™¤äº†ä¸€æ¬¡ï¼Œä¹Ÿå¯èƒ½ä¼šå¤±è´¥ã€‚</p>\n<p>å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ</p>\n<p>ç­”ï¼šè¿™å°±éœ€è¦åŠ ä¸Šå‰é¢èŠè¿‡çš„<code>é‡è¯•æœºåˆ¶</code>äº†ã€‚å¦‚æœåˆ é™¤ç¼“å­˜å¤±è´¥ï¼Œå†™å…¥é‡è¯•è¡¨ï¼Œä½¿ç”¨å®šæ—¶ä»»åŠ¡é‡è¯•ã€‚æˆ–è€…å†™å…¥ mqï¼Œè®© mq è‡ªåŠ¨é‡è¯•ã€‚</p>\n<p>åœ¨è¿™é‡Œæ¨èä½¿ç”¨<code>mqè‡ªåŠ¨é‡è¯•æœºåˆ¶</code>ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650528538202.png\" alt=\"å›¾ç‰‡\"></p>\n<p>åœ¨ binlog è®¢é˜…è€…ä¸­å¦‚æœåˆ é™¤ç¼“å­˜å¤±è´¥ï¼Œåˆ™å‘é€ä¸€æ¡ mq æ¶ˆæ¯åˆ° mq æœåŠ¡å™¨ï¼Œåœ¨ mq æ¶ˆè´¹è€…ä¸­è‡ªåŠ¨é‡è¯• 5 æ¬¡ã€‚å¦‚æœæœ‰ä»»æ„ä¸€æ¬¡æˆåŠŸï¼Œåˆ™ç›´æ¥è¿”å›æˆåŠŸã€‚å¦‚æœé‡è¯• 5 æ¬¡åè¿˜æ˜¯å¤±è´¥ï¼Œåˆ™è¯¥æ¶ˆæ¯è‡ªåŠ¨è¢«æ”¾å…¥æ­»ä¿¡é˜Ÿåˆ—ï¼Œåé¢å¯èƒ½éœ€è¦äººå·¥ä»‹å…¥ã€‚</p>\n<hr>\n<h2 id=\"Redis-çº¿ç¨‹æ¨¡å‹\"><a href=\"#Redis-çº¿ç¨‹æ¨¡å‹\" class=\"headerlink\" title=\"Redis çº¿ç¨‹æ¨¡å‹\"></a>Redis çº¿ç¨‹æ¨¡å‹</h2><h3 id=\"å•çº¿ç¨‹çš„Redisä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«\"><a href=\"#å•çº¿ç¨‹çš„Redisä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«\" class=\"headerlink\" title=\"å•çº¿ç¨‹çš„Redisä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«\"></a>å•çº¿ç¨‹çš„Redisä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«</h3><ol>\n<li><p>çº¯å†…å­˜æ“ä½œ</p>\n</li>\n<li><p>å•çº¿ç¨‹æ“ä½œï¼Œé¿å…äº†é¢‘ç¹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢</p>\n</li>\n<li><p>é‡‡ç”¨äº†éé˜»å¡ I&#x2F;O å¤šè·¯å¤ç”¨æœºåˆ¶</p>\n</li>\n</ol>\n<h3 id=\"Redis-ä¸ºä»€ä¹ˆæ˜¯å•çº¿ç¨‹çš„\"><a href=\"#Redis-ä¸ºä»€ä¹ˆæ˜¯å•çº¿ç¨‹çš„\" class=\"headerlink\" title=\"Redis ä¸ºä»€ä¹ˆæ˜¯å•çº¿ç¨‹çš„\"></a>Redis ä¸ºä»€ä¹ˆæ˜¯å•çº¿ç¨‹çš„</h3><p>å®˜æ–¹ FAQ è¡¨ç¤ºï¼Œå› ä¸º Redis æ˜¯åŸºäºå†…å­˜çš„æ“ä½œï¼ŒCPU ä¸æ˜¯ Redis çš„ç“¶é¢ˆï¼ŒRedis çš„ç“¶é¢ˆæœ€æœ‰å¯èƒ½æ˜¯æœºå™¨å†…å­˜çš„å¤§å°æˆ–è€…ç½‘ç»œå¸¦å®½ã€‚</p>\n<p>æ—¢ç„¶å•çº¿ç¨‹å®¹æ˜“å®ç°ï¼Œè€Œä¸” CPU ä¸ä¼šæˆä¸ºç“¶é¢ˆï¼Œé‚£å°±é¡ºç†æˆç« åœ°é‡‡ç”¨å•çº¿ç¨‹çš„æ–¹æ¡ˆäº†ï¼ˆæ¯•ç«Ÿé‡‡ç”¨å¤šçº¿ç¨‹ä¼šæœ‰å¾ˆå¤šéº»çƒ¦ï¼‰ã€‚Redis åˆ©ç”¨é˜Ÿåˆ—å°†å¹¶å‘è®¿é—®å˜ä¸ºä¸²è¡Œè®¿é—®</p>\n<p>1ã€ç»å¤§éƒ¨åˆ†è¯·æ±‚æ˜¯çº¯ç²¹çš„å†…å­˜æ“ä½œï¼ˆéå¸¸å¿«é€Ÿï¼‰</p>\n<p>2ã€é‡‡ç”¨å•çº¿ç¨‹ï¼Œé¿å…äº†ä¸å¿…è¦çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œç«äº‰æ¡ä»¶</p>\n<p>3ã€éé˜»å¡ IO ä¼˜ç‚¹ï¼š</p>\n<ul>\n<li>é€Ÿåº¦å¿«ï¼Œå› ä¸ºæ•°æ®å­˜åœ¨å†…å­˜ä¸­ï¼Œç±»ä¼¼äº HashMapï¼ŒHashMap çš„ä¼˜åŠ¿å°±æ˜¯æŸ¥æ‰¾å’Œæ“ä½œçš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ O(1)</li>\n<li>æ”¯æŒä¸°å¯Œæ•°æ®ç±»å‹ï¼Œæ”¯æŒ stringï¼Œlistï¼Œsetï¼Œsorted setï¼Œhash</li>\n<li>æ”¯æŒäº‹åŠ¡ï¼Œæ“ä½œéƒ½æ˜¯åŸå­æ€§ï¼Œæ‰€è°“çš„åŸå­æ€§å°±æ˜¯å¯¹æ•°æ®çš„æ›´æ”¹è¦ä¹ˆå…¨éƒ¨æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ¨ä¸æ‰§è¡Œ</li>\n<li>ä¸°å¯Œçš„ç‰¹æ€§ï¼šå¯ç”¨äºç¼“å­˜ï¼Œæ¶ˆæ¯ï¼ŒæŒ‰ key è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œè¿‡æœŸåå°†ä¼šè‡ªåŠ¨åˆ é™¤å¦‚ä½•è§£å†³ Redis çš„å¹¶å‘ç«äº‰ key é—®é¢˜</li>\n</ul>\n<p><strong>åŒæ—¶æœ‰å¤šä¸ªå­ç³»ç»Ÿå»setä¸€ä¸ªkeyã€‚è¿™ä¸ªæ—¶å€™è¦æ³¨æ„ä»€ä¹ˆå‘¢ï¼Ÿ</strong></p>\n<p>ä¸æ¨èä½¿ç”¨ Redis çš„äº‹åŠ¡æœºåˆ¶ã€‚å› ä¸ºæˆ‘ä»¬çš„ç”Ÿäº§ç¯å¢ƒï¼ŒåŸºæœ¬éƒ½æ˜¯ Redis é›†ç¾¤ç¯å¢ƒï¼Œåšäº†æ•°æ®åˆ†ç‰‡æ“ä½œã€‚ä½ ä¸€ä¸ªäº‹åŠ¡ä¸­æœ‰æ¶‰åŠåˆ°å¤šä¸ª key æ“ä½œçš„æ—¶å€™ï¼Œè¿™å¤šä¸ª key ä¸ä¸€å®šéƒ½å­˜å‚¨åœ¨åŒä¸€ä¸ª Redis-server ä¸Šã€‚å› æ­¤ï¼ŒRedis çš„äº‹åŠ¡æœºåˆ¶ï¼Œååˆ†é¸¡è‚‹ã€‚</p>\n<ul>\n<li>å¦‚æœå¯¹è¿™ä¸ª key æ“ä½œï¼Œä¸è¦æ±‚é¡ºåºï¼šå‡†å¤‡ä¸€ä¸ªåˆ†å¸ƒå¼é”ï¼Œå¤§å®¶å»æŠ¢é”ï¼ŒæŠ¢åˆ°é”å°±åš set æ“ä½œå³å¯</li>\n<li>å¦‚æœå¯¹è¿™ä¸ª key æ“ä½œï¼Œè¦æ±‚é¡ºåºï¼šåˆ†å¸ƒå¼é”+æ—¶é—´æˆ³ã€‚å‡è®¾è¿™ä¼šç³»ç»Ÿ B å…ˆæŠ¢åˆ°é”ï¼Œå°† key1 è®¾ç½®ä¸º{valueB 3:05}ã€‚æ¥ä¸‹æ¥ç³»ç»Ÿ A æŠ¢åˆ°é”ï¼Œå‘ç°è‡ªå·±çš„ valueA çš„æ—¶é—´æˆ³æ—©äºç¼“å­˜ä¸­çš„æ—¶é—´æˆ³ï¼Œé‚£å°±ä¸åš set æ“ä½œäº†ã€‚ä»¥æ­¤ç±»æ¨ã€‚</li>\n<li>åˆ©ç”¨é˜Ÿåˆ—ï¼Œå°† set æ–¹æ³•å˜æˆä¸²è¡Œè®¿é—®ä¹Ÿå¯ä»¥ Redis é‡åˆ°é«˜å¹¶å‘ï¼Œå¦‚æœä¿è¯è¯»å†™ key çš„ä¸€è‡´æ€§</li>\n</ul>\n<p>å¯¹ Redis çš„æ“ä½œéƒ½æ˜¯å…·æœ‰åŸå­æ€§çš„ï¼Œæ˜¯çº¿ç¨‹å®‰å…¨çš„æ“ä½œï¼Œä½ ä¸ç”¨è€ƒè™‘å¹¶å‘é—®é¢˜,Redis å†…éƒ¨å·²ç»å¸®ä½ å¤„ç†å¥½å¹¶å‘çš„é—®é¢˜äº†ã€‚</p>\n<h3 id=\"ä¸ºä»€ä¹ˆRedisçš„æ“ä½œæ˜¯åŸå­æ€§çš„ï¼Œæ€ä¹ˆä¿è¯åŸå­æ€§çš„ï¼Ÿ\"><a href=\"#ä¸ºä»€ä¹ˆRedisçš„æ“ä½œæ˜¯åŸå­æ€§çš„ï¼Œæ€ä¹ˆä¿è¯åŸå­æ€§çš„ï¼Ÿ\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆRedisçš„æ“ä½œæ˜¯åŸå­æ€§çš„ï¼Œæ€ä¹ˆä¿è¯åŸå­æ€§çš„ï¼Ÿ\"></a>ä¸ºä»€ä¹ˆRedisçš„æ“ä½œæ˜¯åŸå­æ€§çš„ï¼Œæ€ä¹ˆä¿è¯åŸå­æ€§çš„ï¼Ÿ</h3><p>å¯¹äº Redis è€Œè¨€ï¼Œå‘½ä»¤çš„åŸå­æ€§æŒ‡çš„æ˜¯ï¼šä¸€ä¸ªæ“ä½œçš„ä¸å¯ä»¥å†åˆ†ï¼Œæ“ä½œè¦ä¹ˆæ‰§è¡Œï¼Œè¦ä¹ˆä¸æ‰§è¡Œã€‚</p>\n<p>Redis çš„æ“ä½œä¹‹æ‰€ä»¥æ˜¯åŸå­æ€§çš„ï¼Œæ˜¯å› ä¸º Redis æ˜¯å•çº¿ç¨‹çš„ã€‚ï¼ˆRedis æ–°ç‰ˆæœ¬å·²ç»å¼•å…¥å¤šçº¿ç¨‹ï¼Œè¿™é‡ŒåŸºäºæ—§ç‰ˆæœ¬çš„ Redisï¼‰</p>\n<p>Redis æœ¬èº«æä¾›çš„æ‰€æœ‰ API éƒ½æ˜¯åŸå­æ“ä½œï¼ŒRedis ä¸­çš„äº‹åŠ¡å…¶å®æ˜¯è¦ä¿è¯æ‰¹é‡æ“ä½œçš„åŸå­æ€§ã€‚</p>\n<p>å¤šä¸ªå‘½ä»¤åœ¨å¹¶å‘ä¸­ä¹Ÿæ˜¯åŸå­æ€§çš„å—ï¼Ÿ</p>\n<p>ä¸ä¸€å®šï¼Œ å°† get å’Œ set æ”¹æˆå•å‘½ä»¤æ“ä½œï¼Œincr ã€‚ä½¿ç”¨ Redis çš„äº‹åŠ¡ï¼Œæˆ–è€…ä½¿ç”¨ Redis+Lua çš„æ–¹å¼å®ç°.</p>\n<h3 id=\"è®²è§£ä¸‹Redisçº¿ç¨‹æ¨¡å‹\"><a href=\"#è®²è§£ä¸‹Redisçº¿ç¨‹æ¨¡å‹\" class=\"headerlink\" title=\"è®²è§£ä¸‹Redisçº¿ç¨‹æ¨¡å‹\"></a>è®²è§£ä¸‹Redisçº¿ç¨‹æ¨¡å‹</h3><p>æ–‡ä»¶äº‹ä»¶å¤„ç†å™¨åŒ…æ‹¬åˆ†åˆ«æ˜¯å¥—æ¥å­—ã€ I&#x2F;O å¤šè·¯å¤ç”¨ç¨‹åºã€ æ–‡ä»¶äº‹ä»¶åˆ†æ´¾å™¨ï¼ˆdispatcherï¼‰ã€ ä»¥åŠäº‹ä»¶å¤„ç†å™¨ã€‚ä½¿ç”¨ I&#x2F;O å¤šè·¯å¤ç”¨ç¨‹åºæ¥åŒæ—¶ç›‘å¬å¤šä¸ªå¥—æ¥å­—ï¼Œ å¹¶æ ¹æ®å¥—æ¥å­—ç›®å‰æ‰§è¡Œçš„ä»»åŠ¡æ¥ä¸ºå¥—æ¥å­—å…³è”ä¸åŒçš„äº‹ä»¶å¤„ç†å™¨ã€‚</p>\n<p>å½“è¢«ç›‘å¬çš„å¥—æ¥å­—å‡†å¤‡å¥½æ‰§è¡Œè¿æ¥åº”ç­”ï¼ˆacceptï¼‰ã€è¯»å–ï¼ˆreadï¼‰ã€å†™å…¥ï¼ˆwriteï¼‰ã€å…³é—­ï¼ˆcloseï¼‰ç­‰æ“ä½œæ—¶ï¼Œ ä¸æ“ä½œç›¸å¯¹åº”çš„æ–‡ä»¶äº‹ä»¶å°±ä¼šäº§ç”Ÿï¼Œ è¿™æ—¶æ–‡ä»¶äº‹ä»¶å¤„ç†å™¨å°±ä¼šè°ƒç”¨å¥—æ¥å­—ä¹‹å‰å…³è”å¥½çš„äº‹ä»¶å¤„ç†å™¨æ¥å¤„ç†è¿™äº›äº‹ä»¶ã€‚</p>\n<p>I&#x2F;O å¤šè·¯å¤ç”¨ç¨‹åºè´Ÿè´£ç›‘å¬å¤šä¸ªå¥—æ¥å­—ï¼Œ å¹¶å‘æ–‡ä»¶äº‹ä»¶åˆ†æ´¾å™¨ä¼ é€é‚£äº›äº§ç”Ÿäº†äº‹ä»¶çš„å¥—æ¥å­—ã€‚</p>\n<p><strong>å·¥ä½œåŸç†ï¼š</strong></p>\n<p>I&#x2F;O å¤šè·¯å¤ç”¨ç¨‹åºè´Ÿè´£ç›‘å¬å¤šä¸ªå¥—æ¥å­—ï¼Œ å¹¶å‘æ–‡ä»¶äº‹ä»¶åˆ†æ´¾å™¨ä¼ é€é‚£äº›äº§ç”Ÿäº†äº‹ä»¶çš„å¥—æ¥å­—ã€‚</p>\n<p>å°½ç®¡å¤šä¸ªæ–‡ä»¶äº‹ä»¶å¯èƒ½ä¼šå¹¶å‘åœ°å‡ºç°ï¼Œ ä½† I&#x2F;O å¤šè·¯å¤ç”¨ç¨‹åºæ€»æ˜¯ä¼šå°†æ‰€æœ‰äº§ç”Ÿäº‹ä»¶çš„å¥—æ¥å­—éƒ½å…¥é˜Ÿåˆ°ä¸€ä¸ªé˜Ÿåˆ—é‡Œé¢ï¼Œ ç„¶åé€šè¿‡è¿™ä¸ªé˜Ÿåˆ—ï¼Œ ä»¥æœ‰åºï¼ˆsequentiallyï¼‰ã€åŒæ­¥ï¼ˆsynchronouslyï¼‰ã€æ¯æ¬¡ä¸€ä¸ªå¥—æ¥å­—çš„æ–¹å¼å‘æ–‡ä»¶äº‹ä»¶åˆ†æ´¾å™¨ä¼ é€å¥—æ¥å­—ï¼š</p>\n<p>å½“ä¸Šä¸€ä¸ªå¥—æ¥å­—äº§ç”Ÿçš„äº‹ä»¶è¢«å¤„ç†å®Œæ¯•ä¹‹åï¼ˆè¯¥å¥—æ¥å­—ä¸ºäº‹ä»¶æ‰€å…³è”çš„äº‹ä»¶å¤„ç†å™¨æ‰§è¡Œå®Œæ¯•ï¼‰ï¼Œ I&#x2F;O å¤šè·¯å¤ç”¨ç¨‹åºæ‰ä¼šç»§ç»­å‘æ–‡ä»¶äº‹ä»¶åˆ†æ´¾å™¨ä¼ é€ä¸‹ä¸€ä¸ªå¥—æ¥å­—ã€‚å¦‚æœä¸€ä¸ªå¥—æ¥å­—åˆå¯è¯»åˆå¯å†™çš„è¯ï¼Œ é‚£ä¹ˆæœåŠ¡å™¨å°†å…ˆè¯»å¥—æ¥å­—ï¼Œ åå†™å¥—æ¥å­—ã€‚</p>\n<h2 id=\"å…¶ä»–å‚è€ƒ\"><a href=\"#å…¶ä»–å‚è€ƒ\" class=\"headerlink\" title=\"å…¶ä»–å‚è€ƒ\"></a>å…¶ä»–å‚è€ƒ</h2><p><a href=\"https://mp.weixin.qq.com/s?__biz=MzIzOTU0NTQ0MA==&mid=2247507942&idx=1&sn=e00fd16ec56d0e10cc830678ee25c417&chksm=e92ae2e9de5d6bff6d227646c12685a5c45a4c3322e2186954555a14ebcd9510e8ae579a4941&mpshare=1&scene=24&srcid=0324gng7YtX5XX0z9bf7aObR&sharer_sharetime=1648080975816&sharer_shareid=ebfad4e5798246e3d3928c1f4ee9048e#rd\">åŸåˆ› ä¸€æ´º <a href=\"javascript:void(0);\">é˜¿é‡Œå¼€å‘è€…</a> 2022-03-24 08:00</a></p>\n<p><a href=\"https://blog.csdn.net/qq_31387317/category_7391502.html\">https://blog.csdn.net/qq_31387317/category_7391502.html</a></p>\n","site":{"data":{}},"length":39274,"excerpt":"<blockquote>\n<p>æ•´ç†çš„ Redis ç›¸å…³çŸ¥è¯†ç‚¹å’Œé¢è¯•é¢˜ï¼Œéƒ¨åˆ†å†…å®¹æ‘˜è‡ªç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ï½","more":"</p>\n</blockquote>\n<h2 id=\"ä»€ä¹ˆæ˜¯NoSQLï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯NoSQLï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯NoSQLï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯NoSQLï¼Ÿ</h2><p>NoSQL &#x3D; not only sqlï¼ˆä¸ä»…ä»…æ˜¯ SQLï¼‰</p>\n<p>å…³ç³»å‹æ•°æ®åº“ï¼šåˆ—+è¡Œï¼ŒåŒä¸€ä¸ªè¡¨ä¸‹æ•°æ®çš„ç»“æ„æ˜¯ä¸€æ ·çš„ã€‚</p>\n<p>éå…³ç³»å‹æ•°æ®åº“ï¼šæ•°æ®å­˜å‚¨æ²¡æœ‰å›ºå®šçš„æ ¼å¼ï¼Œå¹¶ä¸”å¯ä»¥è¿›è¡Œæ¨ªå‘æ‰©å±•ã€‚</p>\n<p>NoSQL æ³›æŒ‡éå…³ç³»å‹æ•°æ®åº“ï¼Œéšç€ web2.0 äº’è”ç½‘çš„è¯ç”Ÿï¼Œä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“å¾ˆéš¾å¯¹ä»˜ web2.0 å¤§æ•°æ®æ—¶ä»£ã€‚å°¤å…¶æ˜¯è¶…å¤§è§„æ¨¡çš„é«˜å¹¶å‘çš„ç¤¾åŒºï¼Œæš´éœ²å‡ºæ¥å¾ˆå¤šéš¾ä»¥å…‹æœçš„é—®é¢˜ï¼ŒNoSQL åœ¨å½“ä»Šå¤§æ•°æ®ç¯å¢ƒä¸‹å‘å±•çš„ååˆ†è¿…é€Ÿï¼ŒRedis æ˜¯å‘å±•æœ€å¿«çš„ã€‚</p>\n<p>ä¼ ç»Ÿ RDBMSï¼ˆå…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼‰å’Œ NoSQLï¼ˆéå…³ç³»å‹æ•°æ®åº“ï¼‰æ¯”è¾ƒï¼š</p>\n<p>RDBMSï¼š</p>\n<ul>\n<li>ç»„ç»‡åŒ–ç»“æ„</li>\n<li>å›ºå®š SQL</li>\n<li>æ•°æ®å’Œå…³ç³»éƒ½å­˜åœ¨å•ç‹¬çš„è¡¨ä¸­ï¼ˆè¡Œåˆ—ï¼‰</li>\n<li>DMLï¼ˆæ•°æ®æ“ä½œè¯­è¨€ï¼‰ã€DDLï¼ˆæ•°æ®å®šä¹‰è¯­è¨€ï¼‰ç­‰</li>\n<li>ä¸¥æ ¼çš„ä¸€è‡´æ€§ï¼ˆACIDï¼‰ï¼šåŸå­æ€§ã€ä¸€è‡´æ€§ã€éš”ç¦»æ€§ã€æŒä¹…æ€§</li>\n<li>åŸºç¡€çš„äº‹åŠ¡</li>\n</ul>\n<p>NoSQLï¼š</p>\n<ul>\n<li>ä¸ä»…ä»…æ˜¯æ•°æ®</li>\n<li>æ²¡æœ‰å›ºå®šæŸ¥è¯¢è¯­è¨€</li>\n<li>é”®å€¼å¯¹å­˜å‚¨ï¼ˆRedisï¼‰ã€åˆ—å­˜å‚¨ï¼ˆHBaseï¼‰ã€æ–‡æ¡£å­˜å‚¨ï¼ˆMongoDBï¼‰ã€å›¾å½¢æ•°æ®åº“ï¼ˆä¸æ˜¯å­˜å›¾å½¢ï¼Œæ”¾çš„æ˜¯å…³ç³»ï¼‰ï¼ˆNeo4jï¼‰</li>\n<li>æœ€ç»ˆä¸€è‡´æ€§ï¼ˆBASEï¼‰ï¼šåŸºæœ¬å¯ç”¨ã€è½¯çŠ¶æ€&#x2F;æŸ”æ€§äº‹åŠ¡ã€æœ€ç»ˆä¸€è‡´æ€§</li>\n</ul>\n<hr>\n<h2 id=\"Redisæ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#Redisæ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"Redisæ˜¯ä»€ä¹ˆï¼Ÿ\"></a>Redisæ˜¯ä»€ä¹ˆï¼Ÿ</h2><h3 id=\"å®šä¹‰\"><a href=\"#å®šä¹‰\" class=\"headerlink\" title=\"å®šä¹‰\"></a>å®šä¹‰</h3><p>Redis &#x3D; Remote Dictionary Serverï¼Œå³è¿œç¨‹å­—å…¸æœåŠ¡ã€‚</p>\n<p>Redis æ˜¯ä¸€ä¸ªç”¨ C è¯­è¨€å¼€å‘çš„ã€åŸºäºå†…å­˜ç»“æ„è¿›è¡Œ<strong>é”®å€¼å¯¹</strong>æ•°æ®å­˜å‚¨çš„ã€é«˜æ€§èƒ½çš„ã€éå…³ç³»å‹ NoSQL æ•°æ®åº“</p>\n<h3 id=\"ä¼˜ç¼ºç‚¹\"><a href=\"#ä¼˜ç¼ºç‚¹\" class=\"headerlink\" title=\"ä¼˜ç¼ºç‚¹\"></a>ä¼˜ç¼ºç‚¹</h3><p><strong>çº¯å†…å­˜æ“ä½œï¼Œæ€§èƒ½éå¸¸å‡ºè‰²</strong>ï¼Œæ¯ç§’å¯ä»¥å¤„ç†è¶…è¿‡ 10 ä¸‡æ¬¡è¯»å†™æ“ä½œï¼Œæ˜¯å·²çŸ¥æ€§èƒ½æœ€å¿«çš„ Key-Value DBã€‚æ”¯æŒä¿å­˜å¤šç§æ•°æ®ç»“æ„ï¼Œå¯ä»¥ç”¨æ¥å®ç°å¾ˆå¤šæœ‰ç”¨çš„åŠŸèƒ½ã€‚</p>\n<p>Redis çš„ä¸»è¦ç¼ºç‚¹æ˜¯<strong>æ•°æ®åº“å®¹é‡å—åˆ°ç‰©ç†å†…å­˜çš„é™åˆ¶ï¼Œä¸èƒ½ç”¨ä½œæµ·é‡æ•°æ®çš„é«˜æ€§èƒ½è¯»å†™</strong>ï¼Œå› æ­¤ Redis é€‚åˆçš„åœºæ™¯ä¸»è¦å±€é™åœ¨è¾ƒå°æ•°æ®é‡çš„é«˜æ€§èƒ½æ“ä½œå’Œè¿ç®—ä¸Šã€‚</p>\n<h3 id=\"ä¸ºä»€ä¹ˆè¦ç”¨ç¼“å­˜\"><a href=\"#ä¸ºä»€ä¹ˆè¦ç”¨ç¼“å­˜\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆè¦ç”¨ç¼“å­˜\"></a>ä¸ºä»€ä¹ˆè¦ç”¨ç¼“å­˜</h3><p><strong>1ã€ é«˜æ€§èƒ½ï¼š</strong></p>\n<p>å‡å¦‚ç”¨æˆ·ç¬¬ä¸€æ¬¡è®¿é—®æ•°æ®åº“ä¸­çš„æŸäº›æ•°æ®ã€‚è¿™ä¸ªè¿‡ç¨‹ä¼šæ¯”è¾ƒæ…¢ï¼Œå› ä¸ºæ˜¯ä»ç¡¬ç›˜ä¸Šè¯»å–çš„ã€‚å°†è¯¥ç”¨æˆ·è®¿é—®çš„æ•°æ®å­˜åœ¨æ•°ç¼“å­˜ä¸­ï¼Œè¿™æ ·ä¸‹ä¸€æ¬¡å†è®¿é—®è¿™äº›æ•°æ®çš„æ—¶å€™å°±å¯ä»¥ç›´æ¥ä»ç¼“å­˜ä¸­è·å–äº†ã€‚æ“ä½œç¼“å­˜å°±æ˜¯ç›´æ¥æ“ä½œå†…å­˜ï¼Œæ‰€ä»¥é€Ÿåº¦ç›¸å½“å¿«ã€‚å¦‚æœæ•°æ®åº“ä¸­çš„å¯¹åº”æ•°æ®æ”¹å˜çš„ä¹‹åï¼ŒåŒæ­¥æ”¹å˜ç¼“å­˜ä¸­ç›¸åº”çš„æ•°æ®å³å¯ã€‚</p>\n<p><strong>2ã€é«˜å¹¶å‘ï¼š</strong></p>\n<p>ç›´æ¥æ“ä½œç¼“å­˜èƒ½å¤Ÿæ‰¿å—çš„è¯·æ±‚æ˜¯è¿œè¿œå¤§äºç›´æ¥è®¿é—®æ•°æ®åº“çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è€ƒè™‘æŠŠæ•°æ®åº“ä¸­çš„éƒ¨åˆ†æ•°æ®è½¬ç§»åˆ°ç¼“å­˜ä¸­å»ï¼Œè¿™æ ·ç”¨æˆ·çš„ä¸€éƒ¨åˆ†è¯·æ±‚ä¼šç›´æ¥åˆ°ç¼“å­˜è¿™é‡Œè€Œä¸ç”¨ç»è¿‡æ•°æ®åº“ï¼Œç¼“è§£æ•°æ®åº“å‹åŠ›ã€‚</p>\n<h3 id=\"Redis-ä¸-Memcached-ç›¸æ¯”æœ‰å“ªäº›ä¼˜åŠ¿\"><a href=\"#Redis-ä¸-Memcached-ç›¸æ¯”æœ‰å“ªäº›ä¼˜åŠ¿\" class=\"headerlink\" title=\"Redis ä¸ Memcached ç›¸æ¯”æœ‰å“ªäº›ä¼˜åŠ¿\"></a>Redis ä¸ Memcached ç›¸æ¯”æœ‰å“ªäº›ä¼˜åŠ¿</h3><p>Redis æ”¯æŒæ›´ä¸°å¯Œçš„æ•°æ®ç±»å‹ï¼ˆæ”¯æŒæ›´å¤æ‚çš„åº”ç”¨åœºæ™¯ï¼‰</p>\n<p>Redis æ”¯æŒæ•°æ®çš„æŒä¹…åŒ–ï¼Œå¯ä»¥å°†å†…å­˜ä¸­çš„æ•°æ®ä¿æŒåœ¨ç£ç›˜ä¸­ï¼Œé‡å¯çš„æ—¶å€™å¯ä»¥å†æ¬¡åŠ è½½è¿›è¡Œä½¿ç”¨ï¼Œè€Œ Memecache æŠŠæ•°æ®å…¨éƒ¨å­˜åœ¨å†…å­˜ä¹‹ä¸­ã€‚</p>\n<p>Redis ä½¿ç”¨å•çº¿ç¨‹çš„å¤šè·¯ IO å¤ç”¨æ¨¡å‹ï¼›Memcached æ˜¯å¤šçº¿ç¨‹ï¼Œéé˜»å¡ IO å¤ç”¨çš„ç½‘ç»œæ¨¡å‹ã€‚</p>\n<hr>\n<h2 id=\"Redisäº”å¤§åŸºæœ¬ç±»å‹\"><a href=\"#Redisäº”å¤§åŸºæœ¬ç±»å‹\" class=\"headerlink\" title=\"Redisäº”å¤§åŸºæœ¬ç±»å‹\"></a>Redisäº”å¤§åŸºæœ¬ç±»å‹</h2><p><a href=\"https://www.redis.net.cn/order/\">Redis å‘½ä»¤å¤§å…¨</a></p>\n<p><a href=\"https://juejin.cn/post/6857667542652190728\">Redis åº”ç”¨åœºæ™¯</a></p>\n<h3 id=\"Stringï¼ˆå­—ç¬¦ä¸²ï¼‰\"><a href=\"#Stringï¼ˆå­—ç¬¦ä¸²ï¼‰\" class=\"headerlink\" title=\"Stringï¼ˆå­—ç¬¦ä¸²ï¼‰\"></a>Stringï¼ˆå­—ç¬¦ä¸²ï¼‰</h3><blockquote>\n<ol>\n<li><p>String ç±»å‹æ˜¯ Redis çš„æœ€åŸºç¡€çš„æ•°æ®ç»“æ„ï¼Œä¹Ÿæ˜¯æœ€ç»å¸¸ä½¿ç”¨åˆ°çš„ç±»å‹ã€‚è€Œä¸”å…¶ä»–çš„å››ç§ç±»å‹å¤šå¤šå°‘å°‘éƒ½æ˜¯åœ¨å­—ç¬¦ä¸²ç±»å‹çš„åŸºç¡€ä¸Šæ„å»ºçš„ï¼Œæ‰€ä»¥ String ç±»å‹æ˜¯ Redis çš„åŸºç¡€ã€‚</p>\n</li>\n<li><p>String ç±»å‹çš„å€¼æœ€å¤§èƒ½å­˜å‚¨ 512MBï¼Œè¿™é‡Œçš„ String ç±»å‹å¯ä»¥æ˜¯ç®€å•å­—ç¬¦ä¸²ã€  å¤æ‚çš„ xml&#x2F;json çš„å­—ç¬¦ä¸²ã€äºŒè¿›åˆ¶å›¾åƒæˆ–è€…éŸ³é¢‘çš„å­—ç¬¦ä¸²ã€ä»¥åŠå¯ä»¥æ˜¯æ•°å­—çš„å­—ç¬¦ä¸²ã€‚</p>\n</li>\n</ol>\n</blockquote>\n<p><strong>åº”ç”¨åœºæ™¯</strong></p>\n<p>1ã€ç¼“å­˜åŠŸèƒ½ï¼šString å­—ç¬¦ä¸²æ˜¯æœ€å¸¸ç”¨çš„æ•°æ®ç±»å‹ï¼Œä¸ä»…ä»…æ˜¯ Redisï¼Œå„ä¸ªè¯­è¨€éƒ½æ˜¯æœ€åŸºæœ¬ç±»å‹ï¼Œå› æ­¤ï¼Œåˆ©ç”¨ Redis ä½œä¸ºç¼“å­˜ï¼Œé…åˆå…¶å®ƒæ•°æ®åº“ä½œä¸ºå­˜å‚¨å±‚ï¼Œåˆ©ç”¨ Redis æ”¯æŒé«˜å¹¶å‘çš„ç‰¹ç‚¹ï¼Œå¯ä»¥å¤§å¤§åŠ å¿«ç³»ç»Ÿçš„è¯»å†™é€Ÿåº¦ã€ä»¥åŠé™ä½åç«¯æ•°æ®åº“çš„å‹åŠ›ã€‚</p>\n<p>2ã€è®¡æ•°å™¨ï¼šè®¸å¤šç³»ç»Ÿéƒ½ä¼šä½¿ç”¨ Redis ä½œä¸ºç³»ç»Ÿçš„å®æ—¶è®¡æ•°å™¨ï¼Œå¯ä»¥å¿«é€Ÿå®ç°è®¡æ•°å’ŒæŸ¥è¯¢çš„åŠŸèƒ½ã€‚è€Œä¸”æœ€ç»ˆçš„æ•°æ®ç»“æœå¯ä»¥æŒ‰ç…§ç‰¹å®šçš„æ—¶é—´è½åœ°åˆ°æ•°æ®åº“æˆ–è€…å…¶å®ƒå­˜å‚¨ä»‹è´¨å½“ä¸­è¿›è¡Œæ°¸ä¹…ä¿å­˜ã€‚</p>\n<p>3ã€å…±äº«ç”¨æˆ· sessionï¼šç”¨æˆ·é‡æ–°åˆ·æ–°ä¸€æ¬¡ç•Œé¢ï¼Œå¯èƒ½éœ€è¦è®¿é—®ä¸€ä¸‹æ•°æ®è¿›è¡Œé‡æ–°ç™»å½•ï¼Œæˆ–è€…è®¿é—®é¡µé¢ç¼“å­˜ cookieï¼Œè¿™ä¸¤ç§æ–¹å¼åšæœ‰ä¸€å®šå¼Šç«¯ï¼Œ1ï¼‰æ¯æ¬¡éƒ½é‡æ–°ç™»å½•æ•ˆç‡ä½ä¸‹ 2ï¼‰cookie ä¿å­˜åœ¨å®¢æˆ·ç«¯ï¼Œæœ‰å®‰å…¨éšæ‚£ã€‚è¿™æ—¶å¯ä»¥åˆ©ç”¨ Redis å°†ç”¨æˆ·çš„ session é›†ä¸­ç®¡ç†ï¼Œåœ¨è¿™ç§æ¨¡å¼åªéœ€è¦ä¿è¯ Redis çš„é«˜å¯ç”¨ï¼Œæ¯æ¬¡ç”¨æˆ· session çš„æ›´æ–°å’Œè·å–éƒ½å¯ä»¥å¿«é€Ÿå®Œæˆã€‚å¤§å¤§æé«˜æ•ˆç‡ã€‚ï¼ˆåˆ†å¸ƒå¼ä¼šè¯ï¼‰</p>\n<h3 id=\"Listï¼ˆåˆ—è¡¨ï¼‰\"><a href=\"#Listï¼ˆåˆ—è¡¨ï¼‰\" class=\"headerlink\" title=\"Listï¼ˆåˆ—è¡¨ï¼‰\"></a>Listï¼ˆåˆ—è¡¨ï¼‰</h3><blockquote>\n<ol>\n<li>List æ˜¯ç®€å•çš„å­—ç¬¦ä¸²åˆ—è¡¨</li>\n<li>Redis å¯ä»¥ä»åˆ—è¡¨çš„ä¸¤ç«¯è¿›è¡Œæ’å…¥ï¼ˆpubshï¼‰å’Œå¼¹å‡ºï¼ˆpopï¼‰å…ƒç´ ï¼Œæ”¯æŒè¯»å–æŒ‡å®šèŒƒå›´çš„å…ƒç´ é›†ï¼Œæˆ–è€…è¯»å–æŒ‡å®šä¸‹æ ‡çš„å…ƒç´ ç­‰æ“ä½œã€‚Redisåˆ—è¡¨æ˜¯ä¸€ç§æ¯”è¾ƒçµæ´»çš„é“¾è¡¨æ•°æ®ç»“æ„ï¼Œå®ƒå¯ä»¥å……å½“é˜Ÿåˆ—æˆ–è€…æ ˆçš„è§’è‰²ã€‚</li>\n</ol>\n</blockquote>\n<p><strong>åº”ç”¨åœºæ™¯</strong></p>\n<p>1ã€æ¶ˆæ¯é˜Ÿåˆ—ï¼šRedis çš„é“¾è¡¨ç»“æ„ï¼Œå¯ä»¥è½»æ¾å®ç°é˜»å¡é˜Ÿåˆ—ï¼Œå¯ä»¥ä½¿ç”¨å·¦è¿›å³å‡ºçš„å‘½ä»¤ç»„æˆæ¥å®Œæˆé˜Ÿåˆ—çš„è®¾è®¡ã€‚æ¯”å¦‚ï¼šæ•°æ®çš„ç”Ÿäº§è€…å¯ä»¥é€šè¿‡ lpush å‘½ä»¤ä»å·¦è¾¹æ’å…¥æ•°æ®ï¼Œå¤šä¸ªæ•°æ®æ¶ˆè´¹è€…ï¼Œå¯ä»¥ä½¿ç”¨ rpop å‘½ä»¤é˜»å¡çš„â€œæŠ¢â€åˆ—è¡¨å°¾éƒ¨çš„æ•°æ®ã€‚</p>\n<p>2ã€æ–‡ç« åˆ—è¡¨æˆ–è€…æ•°æ®åˆ†é¡µå±•ç¤ºçš„åº”ç”¨ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å¸¸ç”¨çš„åšå®¢ç½‘ç«™çš„æ–‡ç« åˆ—è¡¨ï¼Œå½“ç”¨æˆ·é‡è¶Šæ¥è¶Šå¤šæ—¶ï¼Œè€Œä¸”æ¯ä¸€ä¸ªç”¨æˆ·éƒ½æœ‰è‡ªå·±çš„æ–‡ç« åˆ—è¡¨ï¼Œè€Œä¸”å½“æ–‡ç« å¤šæ—¶ï¼Œéƒ½éœ€è¦åˆ†é¡µå±•ç¤ºï¼Œè¿™æ—¶å¯ä»¥è€ƒè™‘ä½¿ç”¨ Redis çš„åˆ—è¡¨ï¼Œåˆ—è¡¨ä¸ä½†æœ‰åºåŒæ—¶è¿˜æ”¯æŒæŒ‰ç…§èŒƒå›´å†…è·å–å…ƒç´ ï¼Œå¯ä»¥å®Œç¾è§£å†³åˆ†é¡µæŸ¥è¯¢åŠŸèƒ½ã€‚å¤§å¤§æé«˜æŸ¥è¯¢æ•ˆç‡ã€‚</p>\n<h3 id=\"Setï¼ˆé›†åˆï¼‰\"><a href=\"#Setï¼ˆé›†åˆï¼‰\" class=\"headerlink\" title=\"Setï¼ˆé›†åˆï¼‰\"></a>Setï¼ˆé›†åˆï¼‰</h3><blockquote>\n<ol>\n<li>Redis é›†åˆ set ç±»å‹å’Œ list åˆ—è¡¨ç±»å‹ç±»ä¼¼ï¼Œéƒ½å¯ä»¥ç”¨æ¥å­˜å‚¨å¤šä¸ªå­—ç¬¦ä¸²å…ƒç´ çš„é›†åˆã€‚</li>\n<li>ä½†æ˜¯å’Œ list ä¸åŒçš„æ˜¯ set é›†åˆå½“ä¸­ä¸å…è®¸é‡å¤çš„å…ƒç´ ã€‚è€Œä¸” set é›†åˆå½“ä¸­å…ƒç´ æ˜¯æ²¡æœ‰é¡ºåºçš„ï¼Œä¸å­˜åœ¨å…ƒç´ ä¸‹æ ‡ã€‚</li>\n<li>Redis çš„ set ç±»å‹æ˜¯ä½¿ç”¨å“ˆå¸Œè¡¨æ„é€ çš„ï¼Œå› æ­¤å¤æ‚åº¦æ˜¯ O(1)ï¼Œå®ƒæ”¯æŒé›†åˆå†…çš„å¢åˆ æ”¹æŸ¥ï¼Œå¹¶ä¸”æ”¯æŒå¤šä¸ªé›†åˆé—´çš„äº¤é›†ã€å¹¶é›†ã€å·®é›†æ“ä½œã€‚å¯ä»¥åˆ©ç”¨è¿™äº›é›†åˆæ“ä½œï¼Œè§£å†³ç¨‹åºå¼€å‘è¿‡ç¨‹å½“ä¸­å¾ˆå¤šæ•°æ®é›†åˆé—´çš„é—®é¢˜ã€‚</li>\n</ol>\n</blockquote>\n<p><strong>åº”ç”¨åœºæ™¯</strong></p>\n<p>1ã€æ ‡ç­¾ï¼šæ¯”å¦‚æˆ‘ä»¬åšå®¢ç½‘ç«™å¸¸å¸¸ä½¿ç”¨åˆ°çš„å…´è¶£æ ‡ç­¾ï¼ŒæŠŠä¸€ä¸ªä¸ªæœ‰ç€ç›¸åŒçˆ±å¥½ï¼Œå…³æ³¨ç±»ä¼¼å†…å®¹çš„ç”¨æˆ·åˆ©ç”¨ä¸€ä¸ªæ ‡ç­¾æŠŠä»–ä»¬è¿›è¡Œå½’å¹¶ã€‚</p>\n<p>2ã€å…±åŒå¥½å‹åŠŸèƒ½ï¼Œå…±åŒå–œå¥½ï¼Œæˆ–è€…å¯ä»¥å¼•ç”³åˆ°äºŒåº¦å¥½å‹ä¹‹ç±»çš„æ‰©å±•åº”ç”¨ã€‚</p>\n<p>3ã€ç»Ÿè®¡ç½‘ç«™çš„ç‹¬ç«‹ IPã€‚åˆ©ç”¨ set é›†åˆå½“ä¸­å…ƒç´ ä¸å”¯ä¸€æ€§ï¼Œå¯ä»¥å¿«é€Ÿå®æ—¶ç»Ÿè®¡è®¿é—®ç½‘ç«™çš„ç‹¬ç«‹ IPã€‚</p>\n<h3 id=\"sorted-setï¼ˆæœ‰åºé›†åˆï¼‰\"><a href=\"#sorted-setï¼ˆæœ‰åºé›†åˆï¼‰\" class=\"headerlink\" title=\"sorted setï¼ˆæœ‰åºé›†åˆï¼‰\"></a>sorted setï¼ˆæœ‰åºé›†åˆï¼‰</h3><blockquote>\n<p>Redis æœ‰åºé›†åˆä¹Ÿæ˜¯é›†åˆç±»å‹çš„ä¸€éƒ¨åˆ†ï¼Œæ‰€ä»¥å®ƒä¿ç•™äº†é›†åˆä¸­å…ƒç´ ä¸èƒ½é‡å¤çš„ç‰¹æ€§ï¼Œä½†æ˜¯ä¸åŒçš„æ˜¯ï¼Œæœ‰åºé›†åˆç»™æ¯ä¸ªå…ƒç´ å¤šè®¾ç½®äº†ä¸€ä¸ªåˆ†æ•°ï¼Œåˆ©ç”¨è¯¥åˆ†æ•°ä½œä¸ºæ’åºçš„ä¾æ®ã€‚</p>\n</blockquote>\n<h4 id=\"åº”ç”¨åœºæ™¯\"><a href=\"#åº”ç”¨åœºæ™¯\" class=\"headerlink\" title=\"åº”ç”¨åœºæ™¯\"></a>åº”ç”¨åœºæ™¯</h4><p>1ã€æ’è¡Œæ¦œï¼šæœ‰åºé›†åˆç»å…¸ä½¿ç”¨åœºæ™¯ã€‚ä¾‹å¦‚è§†é¢‘ç½‘ç«™éœ€è¦å¯¹ç”¨æˆ·ä¸Šä¼ çš„è§†é¢‘åšæ’è¡Œæ¦œï¼Œæ¦œå•ç»´æŠ¤å¯èƒ½æ˜¯å¤šæ–¹é¢ï¼šæŒ‰ç…§æ—¶é—´ã€æŒ‰ç…§æ’­æ”¾é‡ã€æŒ‰ç…§è·å¾—çš„èµæ•°ç­‰ã€‚</p>\n<p>2ã€ç”¨ Sorted Sets æ¥åšå¸¦æƒé‡çš„é˜Ÿåˆ—ï¼Œæ¯”å¦‚æ™®é€šæ¶ˆæ¯çš„ score ä¸º 1ï¼Œé‡è¦æ¶ˆæ¯çš„ score ä¸º 2ï¼Œç„¶åå·¥ä½œçº¿ç¨‹å¯ä»¥é€‰æ‹©æŒ‰ score çš„å€’åºæ¥è·å–å·¥ä½œä»»åŠ¡ã€‚è®©é‡è¦çš„ä»»åŠ¡ä¼˜å…ˆæ‰§è¡Œã€‚</p>\n<h3 id=\"hashï¼ˆå“ˆå¸Œï¼‰\"><a href=\"#hashï¼ˆå“ˆå¸Œï¼‰\" class=\"headerlink\" title=\"hashï¼ˆå“ˆå¸Œï¼‰\"></a>hashï¼ˆå“ˆå¸Œï¼‰</h3><p>Redis hash æ•°æ®ç»“æ„ æ˜¯ä¸€ä¸ªé”®å€¼å¯¹ï¼ˆkey-valueï¼‰é›†åˆï¼Œå®ƒæ˜¯ä¸€ä¸ª string ç±»å‹çš„ field å’Œ value çš„æ˜ å°„è¡¨ï¼ŒRedis æœ¬èº«å°±æ˜¯ä¸€ä¸ª key-value å‹æ•°æ®åº“ï¼Œå› æ­¤ hash æ•°æ®ç»“æ„ç›¸å½“äºåœ¨ value ä¸­åˆå¥—äº†ä¸€å±‚ key-value å‹æ•°æ®ã€‚æ‰€ä»¥ Redis ä¸­ hash æ•°æ®ç»“æ„ç‰¹åˆ«é€‚åˆå­˜å‚¨å…³ç³»å‹å¯¹è±¡ã€‚</p>\n<blockquote>\n<p>ç”¨æˆ· ID ä¸ºæŸ¥æ‰¾çš„keyï¼Œå­˜å‚¨çš„ value ç”¨æˆ·å¯¹è±¡åŒ…å«å§“åï¼Œå¹´é¾„ï¼Œç”Ÿæ—¥ç­‰ä¿¡æ¯ï¼Œå¦‚æœç”¨æ™®é€šçš„ key&#x2F;value ç»“æ„æ¥å­˜å‚¨</p>\n<ol>\n<li>å°†ç”¨æˆ· ID ä½œä¸º keyï¼Œå§“åå±æ€§+å§“åæ•°æ®æ•´ä½“ä½œä¸º valueã€‚ç¼ºç‚¹æ˜¯æ¯æ¬¡ä¿®æ”¹ç”¨æˆ·çš„æŸä¸ªå±æ€§ï¼Œéƒ½éœ€è¦å…ˆååºåˆ—åŒ– å±æ€§+æ•°æ®ï¼Œä¿®æ”¹å¥½ï¼Œç„¶åå°† å±æ€§+æ•°æ® åºåˆ—åŒ–ä¹‹ååœ¨ä¿®æ”¹å›å»ï¼Œå¼€é”€è¾ƒå¤§ã€‚</li>\n</ol>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650356860189.png\" alt=\"ID -&gt; å±æ€§+æ•°æ®\"></p>\n<ol start=\"2\">\n<li>å°†ç”¨æˆ· ID+å§“åå±æ€§ä½œä¸º keyï¼Œå§“åæ•°æ®ä½œä¸º valueã€‚ç¼ºç‚¹æ˜¯ç”¨æˆ· ID ä½¿ç”¨å¤šæ¬¡ï¼Œæ•°æ®å†—ä½™</li>\n</ol>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650356955204.png\" alt=\"ID+å±æ€§ -&gt; æ•°æ®\"></p>\n<ol start=\"3\">\n<li>å› æ­¤é€šè¿‡ key(ç”¨æˆ· ID) + field(å±æ€§æ ‡ç­¾) å°±å¯ä»¥æ“ä½œå¯¹åº”å±æ€§æ•°æ®äº†ï¼Œæ—¢ä¸éœ€è¦é‡å¤å­˜å‚¨æ•°æ®ï¼Œä¹Ÿä¸ä¼šå¸¦æ¥åºåˆ—åŒ–å’Œå¹¶å‘ä¿®æ”¹æ§åˆ¶çš„é—®é¢˜ã€‚</li>\n</ol>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650356950290.png\" alt=\"ID -&gt; å±æ€§ -&gt; æ•°æ®\"></p>\n</blockquote>\n<h4 id=\"åº”ç”¨åœºæ™¯-1\"><a href=\"#åº”ç”¨åœºæ™¯-1\" class=\"headerlink\" title=\"åº”ç”¨åœºæ™¯\"></a>åº”ç”¨åœºæ™¯</h4><p>1ã€ç”±äº hash æ•°æ®ç±»å‹çš„ key-value çš„ç‰¹æ€§ï¼Œç”¨æ¥å­˜å‚¨å…³ç³»å‹æ•°æ®åº“ä¸­è¡¨è®°å½•ï¼Œæ˜¯ Redis ä¸­å“ˆå¸Œç±»å‹æœ€å¸¸ç”¨çš„åœºæ™¯ã€‚ä¸€æ¡è®°å½•ä½œä¸ºä¸€ä¸ª key-valueï¼ŒæŠŠæ¯åˆ—å±æ€§å€¼å¯¹åº”æˆ field-value å­˜å‚¨åœ¨å“ˆå¸Œè¡¨å½“ä¸­ï¼Œç„¶åé€šè¿‡ key å€¼æ¥åŒºåˆ†è¡¨å½“ä¸­çš„ä¸»é”®ã€‚</p>\n<p>2ã€ç»å¸¸è¢«ç”¨æ¥å­˜å‚¨ç”¨æˆ·ç›¸å…³ä¿¡æ¯ã€‚ä¼˜åŒ–ç”¨æˆ·ä¿¡æ¯çš„è·å–ï¼Œä¸éœ€è¦é‡å¤ä»æ•°æ®åº“å½“ä¸­è¯»å–ï¼Œæé«˜ç³»ç»Ÿæ€§èƒ½ã€‚</p>\n<hr>\n<h2 id=\"äº”å¤§åŸºæœ¬ç±»å‹åº•å±‚æ•°æ®ç»“æ„\"><a href=\"#äº”å¤§åŸºæœ¬ç±»å‹åº•å±‚æ•°æ®ç»“æ„\" class=\"headerlink\" title=\"äº”å¤§åŸºæœ¬ç±»å‹åº•å±‚æ•°æ®ç»“æ„\"></a>äº”å¤§åŸºæœ¬ç±»å‹åº•å±‚æ•°æ®ç»“æ„</h2><p>Redis æ•´ä½“çš„å­˜å‚¨ç»“æ„ï¼š</p>\n<p>Redis å†…éƒ¨æ•´ä½“çš„å­˜å‚¨ç»“æ„æ˜¯ä¸€ä¸ªå¤§çš„ hashmapï¼Œå†…éƒ¨æ˜¯æ•°ç»„å®ç°çš„ hashï¼Œkey å†²çªé€šè¿‡æŒ‚é“¾è¡¨å»å®ç°ï¼Œæ¯ä¸ª dictEntry ä¸ºä¸€ä¸ª key&#x2F;value å¯¹è±¡ï¼Œvalue ä¸ºå®šä¹‰çš„ redisObjectã€‚</p>\n<p>ç»“æ„å›¾å¦‚ä¸‹ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650433179786.png\" alt=\"Redis æ•´ä½“çš„å­˜å‚¨ç»“æ„\"></p>\n<p>dictEntry æ˜¯å­˜å‚¨ key-&gt;value çš„åœ°æ–¹ï¼Œå…¶ä¸­åŒ…å«æŒ‡å‘å…·ä½“çš„ redisObject çš„æŒ‡é’ˆã€‚</p>\n<p>redisObject ä¸­*ptr æŒ‡å‘å…·ä½“çš„æ•°æ®ç»“æ„çš„åœ°å€ï¼›type è¡¨ç¤ºè¯¥å¯¹è±¡çš„ç±»å‹ï¼Œå³ Stringã€Listã€Hashã€Setã€Zset ä¸­çš„ä¸€ä¸ª</p>\n<h3 id=\"String-arrayList\"><a href=\"#String-arrayList\" class=\"headerlink\" title=\"String (arrayList)\"></a>String (arrayList)</h3><p>String çš„æ•°æ®ç»“æ„ä¸ºç®€å•åŠ¨æ€å­—ç¬¦ä¸²(Simple Dynamic Stringï¼Œç¼©å†™ SDS)ã€‚æ˜¯å¯ä»¥ä¿®æ”¹çš„å­—ç¬¦ä¸²ï¼Œå†…éƒ¨ç»“æ„å®ç°ä¸Šç±»ä¼¼äº Java çš„ ArrayListï¼Œé‡‡ç”¨é¢„åˆ†é…å†—ä½™ç©ºé—´çš„æ–¹å¼æ¥å‡å°‘å†…å­˜çš„é¢‘ç¹åˆ†é…ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650356547555.png\" alt=\"String çš„æ•°æ®ç»“æ„\"></p>\n<p>å¦‚å›¾ä¸­æ‰€ç¤ºï¼Œå†…éƒ¨ä¸ºå½“å‰å­—ç¬¦ä¸²å®é™…åˆ†é…çš„ç©ºé—´ capacity ä¸€èˆ¬è¦é«˜äºå®é™…å­—ç¬¦ä¸²é•¿åº¦ lenã€‚å½“å­—ç¬¦ä¸²é•¿åº¦å°äº 1M æ—¶ï¼Œæ‰©å®¹éƒ½æ˜¯åŠ å€ç°æœ‰çš„ç©ºé—´ï¼Œå¦‚æœè¶…è¿‡ 1Mï¼Œæ‰©å®¹æ—¶ä¸€æ¬¡åªä¼šå¤šæ‰© 1M çš„ç©ºé—´ã€‚éœ€è¦æ³¨æ„çš„æ˜¯å­—ç¬¦ä¸²æœ€å¤§é•¿åº¦ä¸º 512Mã€‚</p>\n<h3 id=\"List-ziplist-quickList\"><a href=\"#List-ziplist-quickList\" class=\"headerlink\" title=\"List (ziplist - quickList)\"></a>List (ziplist - quickList)</h3><p>1ã€Redis 3.2 ä¹‹å‰çš„åº•å±‚å®ç°æ–¹å¼ï¼šå‹ç¼©åˆ—è¡¨ ziplist æˆ–è€… åŒå‘å¾ªç¯é“¾è¡¨ linkedlist</p>\n<p>å½“ list å­˜å‚¨çš„æ•°æ®é‡æ¯”è¾ƒå°‘ä¸”åŒæ—¶æ»¡è¶³ä¸‹é¢ä¸¤ä¸ªæ¡ä»¶æ—¶ï¼Œlist å°±ä½¿ç”¨ ziplist å­˜å‚¨æ•°æ®ï¼š</p>\n<ul>\n<li>list ä¸­ä¿å­˜çš„æ¯ä¸ªå…ƒç´ çš„é•¿åº¦å°äº 64 å­—èŠ‚ï¼›</li>\n<li>åˆ—è¡¨ä¸­æ•°æ®ä¸ªæ•°å°‘äº 512 ä¸ªã€‚</li>\n</ul>\n<p>2ã€Redis 3.2 åŠä¹‹åçš„åº•å±‚å®ç°æ–¹å¼ï¼šquicklist</p>\n<p>quicklist æ˜¯ä¸€ä¸ªåŸºäº ziplist çš„åŒå‘é“¾è¡¨ï¼Œquicklist çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸€ä¸ª ziplistï¼Œç»“åˆäº†åŒå‘é“¾è¡¨å’Œ ziplist çš„ä¼˜ç‚¹ã€‚</p>\n<h4 id=\"ziplist\"><a href=\"#ziplist\" class=\"headerlink\" title=\"ziplist\"></a><strong>ziplist</strong></h4><p>ziplist æ˜¯å‹ç¼©åˆ—è¡¨ï¼Œå®ƒçš„å¥½å¤„æ˜¯èƒ½èŠ‚çœå†…å­˜ç©ºé—´ï¼Œå› ä¸ºå®ƒæ‰€å­˜å‚¨çš„å†…å®¹éƒ½æ˜¯åœ¨è¿ç»­çš„å†…å­˜åŒºåŸŸå½“ä¸­çš„ã€‚å½“åˆ—è¡¨å¯¹è±¡å…ƒç´ ä¸å¤§ï¼Œæ¯ä¸ªå…ƒç´ ä¹Ÿä¸å¤§çš„æ—¶å€™ï¼Œå°±é‡‡ç”¨ ziplist å­˜å‚¨ã€‚ä½†å½“æ•°æ®é‡è¿‡å¤§æ—¶å°± ziplist å°±ä¸æ˜¯é‚£ä¹ˆå¥½ç”¨äº†ã€‚å› ä¸ºä¸ºäº†ä¿è¯ä»–å­˜å‚¨å†…å®¹åœ¨å†…å­˜ä¸­çš„è¿ç»­æ€§ï¼Œæ’å…¥çš„å¤æ‚åº¦æ˜¯ O(N)ï¼Œå³æ¯æ¬¡æ’å…¥éƒ½ä¼šé‡æ–°è¿›è¡Œ realloc é‡æ–°åˆ†é…å†…å­˜ç©ºé—´ã€‚</p>\n<p>ziplist ç»“æ„å¦‚ä¸‹ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650419709341.png\" alt=\"ziplist ç»“æ„å›¾\"></p>\n<p>1ã€zlbytesï¼šç”¨äºè®°å½•æ•´ä¸ªå‹ç¼©åˆ—è¡¨å ç”¨å­—èŠ‚æ•°</p>\n<p>2ã€zltailï¼šè®°å½•è¦åˆ—è¡¨å°¾èŠ‚ç‚¹è·ç¦»å‹ç¼©åˆ—è¡¨çš„èµ·å§‹åœ°å€æœ‰å¤šå°‘å­—èŠ‚ï¼Œç”¨äºå¿«é€Ÿå®šä½åˆ°æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œä»è€Œå¯ä»¥åœ¨ ziplist å°¾éƒ¨å¿«é€Ÿçš„æ‰§è¡Œ pushï¼Œpop æ“ä½œ</p>\n<p>3ã€zllenï¼šè®°å½•äº†å‹ç¼©åˆ—è¡¨åŒ…å«çš„èŠ‚ç‚¹æ•°é‡ã€‚</p>\n<p>4ã€entryXï¼šå‹ç¼©åˆ—è¡¨åŒ…å«çš„å„ä¸ªèŠ‚ç‚¹</p>\n<p>5ã€zlendï¼šç”¨äºæ ‡è®°å‹ç¼©åˆ—è¡¨çš„æœ«ç«¯ï¼Œç”¨æ¥å¿«é€Ÿå®šä½åˆ°æœ€åä¸€ä¸ªå…ƒç´ ï¼Œç„¶åå€’ç€éå†ã€‚ï¼ˆentry å—çš„ prevlen å­—æ®µè¡¨ç¤ºå‰ä¸€ä¸ª entry çš„å­—èŠ‚é•¿åº¦ï¼Œå½“å‹ç¼©åˆ—è¡¨å€’ç€éå†æ—¶ï¼Œéœ€è¦é€šè¿‡è¿™ä¸ªå­—æ®µæ¥å¿«é€Ÿå®šä½åˆ°ä¸‹ä¸€ä¸ªå…ƒç´ çš„ä½ç½®ã€‚ï¼‰</p>\n<p><strong>ä¸ºä»€ä¹ˆæ•°æ®é‡å¤§æ—¶ä¸ç”¨ ziplistï¼Ÿ</strong></p>\n<p>å› ä¸º ziplist æ˜¯ä¸€æ®µè¿ç»­çš„å†…å­˜ï¼Œæ’å…¥çš„æ—¶é—´å¤æ‚åŒ–åº¦ä¸º O(n)ï¼Œè€Œä¸”æ¯å½“æ’å…¥æ–°çš„å…ƒç´ éœ€è¦ realloc åšå†…å­˜æ‰©å±•ï¼›è€Œä¸”å¦‚æœè¶…å‡º ziplist å†…å­˜å¤§å°ï¼Œè¿˜ä¼šåšé‡æ–°åˆ†é…çš„å†…å­˜ç©ºé—´ï¼Œå¹¶å°†å†…å®¹å¤åˆ¶åˆ°æ–°çš„åœ°å€ã€‚å¦‚æœæ•°é‡å¤§çš„è¯ï¼Œé‡æ–°åˆ†é…å†…å­˜å’Œæ‹·è´å†…å­˜ä¼šæ¶ˆè€—å¤§é‡æ—¶é—´ã€‚æ‰€ä»¥ä¸é€‚åˆå¤§å‹å­—ç¬¦ä¸²ï¼Œä¹Ÿä¸é€‚åˆå­˜å‚¨é‡å¤šçš„å…ƒç´ ã€‚</p>\n<h4 id=\"quickList\"><a href=\"#quickList\" class=\"headerlink\" title=\"quickList\"></a>quickList</h4><p>å¿«é€Ÿåˆ—è¡¨æ˜¯ ziplist å’Œ linkedlist çš„æ··åˆä½“ï¼Œæ˜¯å°† linkedlist æŒ‰æ®µåˆ‡åˆ†ï¼Œæ¯ä¸€æ®µç”¨ ziplist æ¥ç´§å‡‘å­˜å‚¨ï¼Œå¤šä¸ª ziplist ä¹‹é—´ä½¿ç”¨åŒå‘æŒ‡é’ˆé“¾æ¥ã€‚</p>\n<p><strong>ä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨ linkedlistï¼Ÿ</strong></p>\n<p>linkedlist çš„é™„åŠ ç©ºé—´ç›¸å¯¹å¤ªé«˜ï¼Œprev å’Œ next æŒ‡é’ˆå°±è¦å å» 16 ä¸ªå­—èŠ‚ï¼Œè€Œä¸”æ¯ä¸€ä¸ªç»“ç‚¹éƒ½æ˜¯å•ç‹¬åˆ†é…ï¼Œä¼šåŠ å‰§å†…å­˜çš„ç¢ç‰‡åŒ–ï¼Œå½±å“å†…å­˜ç®¡ç†æ•ˆç‡ã€‚</p>\n<p>quicklist ç»“æ„å›¾å¦‚ä¸‹ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650419719663.png\" alt=\"quicklist ç»“æ„å›¾\"></p>\n<p><strong>ziplistçš„é•¿åº¦</strong></p>\n<p>quicklist å†…éƒ¨é»˜è®¤å•ä¸ª ziplist é•¿åº¦ä¸º 8k å­—èŠ‚ï¼Œè¶…å‡ºäº†è¿™ä¸ªå­—èŠ‚æ•°ï¼Œå°±ä¼šæ–°èµ·ä¸€ä¸ª ziplistã€‚å…³äºé•¿åº¦å¯ä»¥ä½¿ç”¨ list-max-ziplist-size å†³å®šã€‚</p>\n<p><strong>å‹ç¼©æ·±åº¦</strong></p>\n<p>æˆ‘ä»¬ä¸Šé¢è¯´åˆ°äº† quicklist ä¸‹æ˜¯ç”¨å¤šä¸ª ziplist ç»„æˆçš„ï¼ŒåŒæ—¶ä¸ºäº†è¿›ä¸€æ­¥èŠ‚çº¦ç©ºé—´ï¼ŒRedis è¿˜ä¼šå¯¹ ziplist è¿›è¡Œå‹ç¼©å­˜å‚¨ï¼Œä½¿ç”¨ LZF ç®—æ³•å‹ç¼©ï¼Œå¯ä»¥é€‰æ‹©å‹ç¼©æ·±åº¦ã€‚quicklist é»˜è®¤çš„å‹ç¼©æ·±åº¦æ˜¯ 0ï¼Œä¹Ÿå°±æ˜¯ä¸å‹ç¼©ã€‚å‹ç¼©çš„å®é™…æ·±åº¦ç”±é…ç½®å‚æ•° list-compress-depth å†³å®šã€‚ä¸ºäº†æ”¯æŒå¿«é€Ÿ push&#x2F;pop æ“ä½œï¼Œquicklist çš„é¦–å°¾ä¸¤ä¸ª ziplist ä¸å‹ç¼©ï¼Œæ­¤æ—¶æ·±åº¦å°±æ˜¯ 1ã€‚å¦‚æœæ·±åº¦ä¸º 2ï¼Œå°±è¡¨ç¤º quicklist çš„é¦–å°¾ç¬¬ä¸€ä¸ª ziplist ä»¥åŠé¦–å°¾ç¬¬äºŒä¸ª ziplist éƒ½ä¸å‹ç¼©ã€‚</p>\n<h3 id=\"Hash-ziplist-dict\"><a href=\"#Hash-ziplist-dict\" class=\"headerlink\" title=\"Hash (ziplist - dict)\"></a>Hash (ziplist - dict)</h3><h4 id=\"ziplist-1\"><a href=\"#ziplist-1\" class=\"headerlink\" title=\"ziplist\"></a>ziplist</h4><p>å½“ Hash ä¸­æ•°æ®é¡¹æ¯”è¾ƒå°‘çš„æƒ…å†µä¸‹ï¼ŒHash åº•å±‚æ‰ç”¨å‹ç¼©åˆ—è¡¨ ziplist è¿›è¡Œå­˜å‚¨æ•°æ®ï¼Œéšç€æ•°æ®çš„å¢åŠ ï¼Œåº•å±‚çš„ ziplist å°±å¯èƒ½ä¼šè½¬æˆ dictï¼Œå…·ä½“é…ç½®å¦‚ä¸‹</p>\n<blockquote>\n<p>hash-max-ziplist-entries 512<br>hash-max-ziplist-value 64</p>\n</blockquote>\n<p>åœ¨å¦‚ä¸‹ä¸¤ä¸ªæ¡ä»¶ä¹‹ä¸€æ»¡è¶³çš„æ—¶å€™ï¼Œziplist ä¼šè½¬æˆ dictï¼š</p>\n<ul>\n<li>å½“ hash ä¸­çš„æ•°æ®é¡¹çš„æ•°ç›®è¶…è¿‡ 512 çš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯ ziplist æ•°æ®é¡¹è¶…è¿‡ 1024 çš„æ—¶å€™ï¼›</li>\n<li>å½“ hash ä¸­æ’å…¥çš„ä»»æ„ä¸€ä¸ª value çš„é•¿åº¦è¶…è¿‡äº† 64 çš„æ—¶å€™ã€‚</li>\n</ul>\n<p>æ¯å½“æœ‰æ–°çš„é”®å€¼å¯¹åŠ å…¥åˆ°å“ˆå¸Œå¯¹è±¡æ—¶ï¼Œå…ˆå‹å…¥é”®ï¼Œå†å‹å…¥å€¼ï¼Œå¦‚å›¾ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/20190703171927309.png\" alt=\"ziplistå®ç°çš„hash\"></p>\n<p>å½“éå†æ—¶ï¼Œä»å¤´åˆ°å°¾çš„éå†ï¼Œä¸”è·³è¿‡å€¼èŠ‚ç‚¹ã€‚</p>\n<h4 id=\"dict\"><a href=\"#dict\" class=\"headerlink\" title=\"dict\"></a>dict</h4><p>å­—å…¸çš„å“ˆå¸Œè¡¨ç»“æ„å’Œ Java çš„ HashMap ç»“æ„å‡ ä¹æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯é€šè¿‡æŸä¸ªå“ˆå¸Œå‡½æ•°ä» key è®¡ç®—å¾—åˆ°åœ¨å“ˆå¸Œè¡¨ä¸­çš„ä½ç½®ï¼Œé‡‡ç”¨é“¾è¡¨æ³•è§£å†³å†²çªã€‚Redis è¿™é‡Œä½¿ç”¨çš„æ˜¯å•é“¾è¡¨ï¼Œä¸ºäº†æŸ¥è¯¢æ•ˆç‡æ¯æ¬¡æŠŠæ–°æ•°æ®æ’å…¥åˆ°é“¾è¡¨å¤´ä½ç½®ï¼ˆä½¿ç”¨å¤´æ’æ³•æ˜¯å› ä¸ºæ–°æ’å…¥çš„æ•°æ®è¢«è®¿é—®çš„æ¦‚ç‡å¤§ï¼Œå¯ä»¥æ›´å¿«è®¿é—®åˆ°ï¼‰ã€‚</p>\n<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¯ä¸ª dict ä¸­éƒ½æœ‰ä¸¤ä¸ª hashtableï¼Œç»“æ„å›¾å¦‚ä¸‹ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650420119549.png\" alt=\"dictå®ç°çš„hash\"></p>\n<p>è™½ç„¶ dict ç»“æ„æœ‰ä¸¤ä¸ª hashtableï¼Œä½†æ˜¯é€šå¸¸æƒ…å†µä¸‹åªæœ‰ä¸€ä¸ª hashtable æ˜¯æœ‰å€¼çš„ã€‚ä½†æ˜¯åœ¨ dict æ‰©å®¹ç¼©å®¹çš„æ—¶å€™ï¼Œéœ€è¦åˆ†é…æ–°çš„ hashtableï¼Œç„¶åè¿›è¡Œæ¸è¿‘å¼æ¬è¿ï¼Œè¿™æ—¶å€™ä¸¤ä¸ª hashtable å­˜å‚¨çš„æ—§çš„ hashtable å’Œæ–°çš„ hashtableã€‚æ¬è¿ç»“æŸåï¼Œæ—§ hashtable åˆ é™¤ï¼Œæ–°çš„å–è€Œä»£ä¹‹ã€‚</p>\n<p><strong>æ¸è¿›å¼ rehash</strong></p>\n<p>æ‰€è°“æ¸è¿›å¼ rehash æ˜¯æŒ‡æˆ‘ä»¬çš„å¤§å­—å…¸çš„æ‰©å®¹æ˜¯æ¯”è¾ƒæ¶ˆè€—æ—¶é—´çš„ï¼Œéœ€è¦é‡æ–°ç”³è¯·æ–°çš„æ•°ç»„ï¼Œç„¶åå°†æ—§å­—å…¸æ‰€æœ‰é“¾è¡¨çš„å…ƒç´ é‡æ–°æŒ‚æ¥åˆ°æ–°çš„æ•°ç»„ä¸‹é¢ï¼Œæ˜¯ä¸€ä¸ª O(n)çš„æ“ä½œã€‚ä½†æ˜¯å› ä¸ºæˆ‘ä»¬çš„ Redis æ˜¯å•çº¿ç¨‹çš„ï¼Œæ— æ³•æ‰¿å—è¿™æ ·çš„è€—æ—¶è¿‡ç¨‹ï¼Œæ‰€ä»¥é‡‡ç”¨äº†æ¸è¿›å¼ rehash å°æ­¥æ¬è¿ï¼Œè™½ç„¶æ…¢ä¸€ç‚¹ï¼Œä½†æ˜¯å¯ä»¥æ¬è¿å®Œæ¯•ã€‚</p>\n<p><strong>æ‰©å®¹æ¡ä»¶</strong></p>\n<p>æˆ‘ä»¬çš„æ‰©å®¹ä¸€èˆ¬ä¼šåœ¨ Hash è¡¨ä¸­çš„å…ƒç´ ä¸ªæ•°ç­‰äºç¬¬ä¸€ç»´æ•°ç»„çš„é•¿åº¦çš„æ—¶å€™ï¼Œå°±ä¼šå¼€å§‹æ‰©å®¹ã€‚æ‰©å®¹çš„å¤§å°æ˜¯åŸæ•°ç»„çš„ä¸¤å€ã€‚ä¸è¿‡åœ¨ Redis åœ¨åš bgsaveï¼ˆRDB æŒä¹…åŒ–æ“ä½œçš„è¿‡ç¨‹ï¼‰ï¼Œä¸ºäº†å‡å°‘å†…å­˜é¡µçš„è¿‡å¤šåˆ†ç¦»ï¼ˆCopy On Writeï¼‰ï¼ŒRedis ä¸ä¼šå»æ‰©å®¹ã€‚ä½†æ˜¯å¦‚æœ hash è¡¨çš„å…ƒç´ ä¸ªæ•°å·²ç»åˆ°è¾¾äº†ç¬¬ä¸€ç»´æ•°ç»„é•¿åº¦çš„ 5 å€çš„æ—¶å€™ï¼Œå°±ä¼šå¼ºåˆ¶æ‰©å®¹ï¼Œä¸ç®¡ä½ æ˜¯å¦åœ¨æŒä¹…åŒ–ã€‚</p>\n<p>ä¸æ‰©å®¹ä¸»è¦æ˜¯ä¸ºäº†å°½å¯èƒ½å‡å°‘å†…å­˜é¡µè¿‡å¤šåˆ†ç¦»ï¼Œç³»ç»Ÿéœ€è¦æ›´å¤šçš„å¼€é”€å»å›æ”¶å†…å­˜ã€‚</p>\n<p><strong>ç¼©å®¹æ¡ä»¶</strong></p>\n<p>å½“æˆ‘ä»¬çš„ hash è¡¨å…ƒç´ é€æ¸åˆ é™¤çš„è¶Šæ¥è¶Šå°‘çš„æ—¶å€™ã€‚Redis äºæ˜¯å°±ä¼šå¯¹ hash è¡¨è¿›è¡Œç¼©å®¹æ¥å‡å°‘ç¬¬ä¸€ç»´æ•°ç»„é•¿åº¦çš„ç©ºé—´å ç”¨ã€‚ç¼©å®¹çš„æ¡ä»¶æ˜¯å…ƒç´ ä¸ªæ•°ä½äºæ•°ç»„é•¿åº¦çš„ 10%ï¼Œå¹¶ä¸”ç¼©å®¹ä¸è€ƒè™‘æ˜¯å¦åœ¨åš Redis æŒä¹…åŒ–ã€‚</p>\n<p>ä¸ç”¨è€ƒè™‘ bgsave ä¸»è¦æ˜¯å› ä¸ºæˆ‘ä»¬çš„ç¼©å®¹çš„å†…å­˜éƒ½æ˜¯å·²ç»ä½¿ç”¨è¿‡çš„ï¼Œç¼©å®¹çš„æ—¶å€™å¯ä»¥ç›´æ¥ç½®ç©ºï¼Œè€Œä¸”ç”±äºç”³è¯·çš„å†…å­˜æ¯”è¾ƒå°ï¼ŒåŒæ—¶ä¼šé‡Šæ”¾æ‰ä¸€äº›å·²ç»ä½¿ç”¨çš„å†…å­˜ï¼Œä¸ä¼šå¢å¤§ç³»ç»Ÿçš„å‹åŠ›ã€‚</p>\n<p><strong>rehash æ­¥éª¤</strong></p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650420130964.png\" alt=\"rehash æ­¥éª¤\"></p>\n<h3 id=\"Set-intset-hashSet\"><a href=\"#Set-intset-hashSet\" class=\"headerlink\" title=\"Set (intset - hashSet)\"></a>Set (intset - hashSet)</h3><p>Redis çš„é›†åˆç›¸å½“äº Java ä¸­çš„ HashSetï¼Œå®ƒå†…éƒ¨çš„é”®å€¼å¯¹æ˜¯æ— åºã€å”¯ä¸€çš„ã€‚å®ƒçš„å†…éƒ¨å®ç°ç›¸å½“äºä¸€ä¸ªç‰¹æ®Šçš„å­—å…¸ï¼Œå­—å…¸ä¸­æ‰€æœ‰çš„ value éƒ½æ˜¯ä¸€ä¸ªå€¼ NULLã€‚é›†åˆ Set ç±»å‹åº•å±‚ç¼–ç åŒ…æ‹¬ inset å’Œ hashtableã€‚</p>\n<p>å½“å­˜å‚¨çš„æ•°æ®åŒæ—¶æ»¡è¶³ä¸‹é¢è¿™æ ·ä¸¤ä¸ªæ¡ä»¶çš„æ—¶å€™ï¼ŒRedis å°±é‡‡ç”¨æ•´æ•°é›†åˆ intset æ¥å®ç° set è¿™ç§æ•°æ®ç±»å‹ï¼š</p>\n<blockquote>\n<p>å­˜å‚¨çš„æ•°æ®éƒ½æ˜¯æ•´æ•°<br>å­˜å‚¨çš„æ•°æ®å…ƒç´ ä¸ªæ•°å°äº512ä¸ª</p>\n</blockquote>\n<p>å½“ä¸èƒ½åŒæ—¶æ»¡è¶³è¿™ä¸¤ä¸ªæ¡ä»¶çš„æ—¶å€™ï¼ŒRedis å°±ä½¿ç”¨ dict æ¥å­˜å‚¨é›†åˆä¸­çš„æ•°æ®</p>\n<p><strong>intset</strong></p>\n<p>intset æ˜¯ä¸€ä¸ªæœ‰åºé›†åˆï¼ŒæŸ¥æ‰¾å…ƒç´ çš„å¤æ‚åº¦ä¸º O(logN)ï¼ˆé‡‡ç”¨äºŒåˆ†æ³•ï¼‰ï¼Œä½†æ’å…¥æ—¶ä¸ä¸€å®šä¸º O(logN)ï¼Œå› ä¸ºæœ‰å¯èƒ½æ¶‰åŠåˆ°å‡çº§æ“ä½œã€‚æ¯”å¦‚å½“é›†åˆé‡Œå…¨æ˜¯ int16_t å‹çš„æ•´æ•°ï¼Œè¿™æ—¶è¦æ’å…¥ä¸€ä¸ª int32_tï¼Œé‚£ä¹ˆä¸ºäº†ç»´æŒé›†åˆä¸­æ•°æ®ç±»å‹çš„ä¸€è‡´ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„æ•°æ®éƒ½ä¼šè¢«è½¬æ¢æˆ int32_t ç±»å‹ï¼Œæ¶‰åŠåˆ°å†…å­˜çš„é‡æ–°åˆ†é…ï¼Œè¿™æ—¶æ’å…¥çš„å¤æ‚åº¦å°±ä¸º O(N)äº†ã€‚æ˜¯ intset ä¸æ”¯æŒé™çº§æ“ä½œã€‚</p>\n<p><strong>intset æ˜¯æœ‰åºä¸è¦å’Œ zset ææ··ï¼Œzset æ˜¯è®¾ç½®ä¸€ä¸ª score æ¥è¿›è¡Œæ’åºï¼Œè€Œ intset è¿™é‡Œåªæ˜¯å•çº¯çš„å¯¹æ•´æ•°è¿›è¡Œå‡åºè€Œå·²</strong></p>\n<h3 id=\"Sorted-Set-ziplist-zset-dict-skipList\"><a href=\"#Sorted-Set-ziplist-zset-dict-skipList\" class=\"headerlink\" title=\"Sorted Set (ziplist - zset(dict + skipList))\"></a>Sorted Set (ziplist - zset(dict + skipList))</h3><p>Zset æœ‰åºé›†åˆå’Œ set é›†åˆæœ‰ç€å¿…ç„¶çš„è”ç³»ï¼Œä»–ä¿ç•™äº†é›†åˆä¸èƒ½æœ‰é‡å¤æˆå‘˜çš„ç‰¹æ€§ï¼Œä½†ä¸åŒçš„æ˜¯ï¼Œæœ‰åºé›†åˆä¸­çš„å…ƒç´ æ˜¯å¯ä»¥æ’åºçš„ï¼Œä½†æ˜¯å®ƒå’Œåˆ—è¡¨çš„ä½¿ç”¨ç´¢å¼•ä¸‹æ ‡ä½œä¸ºæ’åºä¾æ®ä¸åŒçš„æ˜¯ï¼Œå®ƒç»™æ¯ä¸ªå…ƒç´ è®¾ç½®ä¸€ä¸ªåˆ†æ•° scoreï¼Œä½œä¸ºæ’åºçš„ä¾æ®ã€‚</p>\n<p>å½“æ•°æ®è¾ƒå°‘æ—¶ï¼Œsorted set æ˜¯ç”± ziplist æ¥å®ç°çš„ã€‚<br>å½“æ•°æ®å¤šçš„æ—¶å€™ï¼Œsorted set æ˜¯ç”± zset çš„æ•°æ®ç»“æ„æ¥å®ç°çš„ï¼Œè¿™ä¸ª zset åŒ…å«ä¸€ä¸ª dict + ä¸€ä¸ª skiplistã€‚dict ç”¨æ¥æŸ¥è¯¢æ•°æ®åˆ°åˆ†æ•°(score)çš„å¯¹åº”å…³ç³»ï¼Œè€Œ skiplist ç”¨æ¥æ ¹æ®æŒ‡å®šåˆ†æ•° score çš„èŒƒå›´æ¥è·å– value åˆ—è¡¨ã€‚</p>\n<p><strong>sorted set ziplist å®ç°</strong></p>\n<p>åœ¨è¿™é‡Œæˆ‘ä»¬å…ˆæ¥è®¨è®ºä¸€ä¸‹å‰ä¸€ç§æƒ…å†µâ€”â€”åŸºäº ziplist å®ç°çš„ sorted setã€‚ziplist å°±æ˜¯ç”±å¾ˆå¤šæ•°æ®é¡¹ç»„æˆçš„ä¸€å¤§å—è¿ç»­å†…å­˜ã€‚ç”±äº sorted set çš„æ¯ä¸€é¡¹å…ƒç´ éƒ½ç”±æ•°æ®å’Œ score ç»„æˆï¼Œå› æ­¤ï¼Œå½“ä½¿ç”¨ zadd å‘½ä»¤æ’å…¥ä¸€ä¸ª(æ•°æ®, score)å¯¹çš„æ—¶å€™ï¼Œåº•å±‚åœ¨ç›¸åº”çš„ ziplist ä¸Šå°±æ’å…¥ä¸¤ä¸ªæ•°æ®é¡¹ï¼šæ•°æ®åœ¨å‰ï¼Œscore åœ¨åã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650431975904.png\" alt=\"åŸºäº ziplist å®ç°çš„ sorted set\"></p>\n<p>ziplist çš„ä¸»è¦ä¼˜ç‚¹æ˜¯èŠ‚çœå†…å­˜ï¼Œä½†å®ƒä¸Šé¢çš„æŸ¥æ‰¾æ“ä½œåªèƒ½æŒ‰é¡ºåºæŸ¥æ‰¾ï¼ˆå¯ä»¥æ­£åºä¹Ÿå¯ä»¥å€’åºï¼‰ã€‚å› æ­¤ï¼Œsorted set çš„å„ä¸ªæŸ¥è¯¢æ“ä½œï¼Œå°±æ˜¯åœ¨ ziplist ä¸Šä»å‰å‘åï¼ˆæˆ–ä»åå‘å‰ï¼‰ä¸€æ­¥æ­¥æŸ¥æ‰¾ï¼Œæ¯ä¸€æ­¥å‰è¿›ä¸¤ä¸ªæ•°æ®é¡¹ï¼Œè·¨åŸŸä¸€ä¸ª(æ•°æ®, score)å¯¹ã€‚</p>\n<p>éšç€æ•°æ®çš„æ’å…¥ï¼Œsorted set åº•å±‚çš„è¿™ä¸ª ziplist å°±å¯èƒ½ä¼šè½¬æˆ zset çš„å®ç°ã€‚é‚£ä¹ˆåˆ°åº•æ’å…¥å¤šå°‘æ‰ä¼šè½¬å‘¢ï¼Ÿ</p>\n<blockquote>\n<p>zset-max-ziplist-entries 128\t# å½“sorted setä¸­çš„å…ƒç´ ä¸ªæ•°ï¼Œå³(æ•°æ®ï¼Œ score)å¯¹çš„æ•°ç›®è¶…è¿‡128çš„æ—¶å€™<br>zset-max-ziplist-value 64\t# å½“sorted setä¸­æ’å…¥çš„ä»»æ„ä¸€ä¸ªæ•°æ®çš„é•¿åº¦è¶…è¿‡äº†64çš„æ—¶å€™ã€‚</p>\n</blockquote>\n<p><strong>sorted set ziplistå®ç°</strong><br>Redis çš„ zset æ˜¯ä¸€ä¸ªå¤åˆç»“æ„ï¼Œä¸€æ–¹é¢å®ƒéœ€è¦ä¸€ä¸ª hash ç»“æ„æ¥å­˜å‚¨ value å’Œ score çš„å¯¹åº”å…³ç³»ï¼Œå¦ä¸€æ–¹é¢éœ€è¦æä¾›æŒ‰ç…§ score æ¥æ’åºçš„åŠŸèƒ½ï¼Œè¿˜éœ€è¦èƒ½å¤ŸæŒ‡å®š score çš„èŒƒå›´æ¥è·å– value åˆ—è¡¨çš„åŠŸèƒ½ï¼Œè¿™å°±éœ€è¦å¦å¤–ä¸€ä¸ªç»“æ„ã€Œè·³è·ƒè¡¨ã€ã€‚</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">zset</span> &#123;</span></span><br><span class=\"line\">    dict *dict;</span><br><span class=\"line\">    zskiplist *zsl;</span><br><span class=\"line\">&#125; zset;</span><br></pre></td></tr></table></figure>\n\n<p>è·³è¡¨ï¼šé“¾è¡¨+å¤šçº§ç´¢å¼•ï¼ˆç©ºé—´æ¢æ—¶é—´ï¼‰</p>\n<p>å’Œå…¶ä»–ç»“æ„çš„æ¯”è¾ƒï¼š</p>\n<p>å¯¹äºæœ‰åºé›†åˆçš„åº•å±‚å®ç°ï¼Œå¯ä»¥ç”¨æ•°ç»„ã€å¹³è¡¡æ ‘ã€é“¾è¡¨ç­‰ã€‚æ•°ç»„ä¸ä¾¿å…ƒç´ çš„æ’å…¥ã€åˆ é™¤ï¼›å¹³è¡¡æ ‘æˆ–çº¢é»‘æ ‘è™½ç„¶æ•ˆç‡é«˜ä½†ç»“æ„å¤æ‚ï¼›é“¾è¡¨æŸ¥è¯¢éœ€è¦éå†æ‰€æœ‰æ•ˆç‡ä½ã€‚Redis é‡‡ç”¨çš„æ˜¯è·³è·ƒè¡¨ã€‚è·³è·ƒè¡¨æ•ˆç‡å ªæ¯”çº¢é»‘æ ‘ï¼Œå®ç°è¿œæ¯”çº¢é»‘æ ‘ç®€å•ã€‚</p>\n<hr>\n<h2 id=\"ä¸‰å¤§ç‰¹æ®Šæ•°æ®ç±»å‹\"><a href=\"#ä¸‰å¤§ç‰¹æ®Šæ•°æ®ç±»å‹\" class=\"headerlink\" title=\"ä¸‰å¤§ç‰¹æ®Šæ•°æ®ç±»å‹\"></a>ä¸‰å¤§ç‰¹æ®Šæ•°æ®ç±»å‹</h2><h3 id=\"geospatialï¼ˆåœ°ç†ä½ç½®ï¼‰\"><a href=\"#geospatialï¼ˆåœ°ç†ä½ç½®ï¼‰\" class=\"headerlink\" title=\"geospatialï¼ˆåœ°ç†ä½ç½®ï¼‰\"></a>geospatialï¼ˆåœ°ç†ä½ç½®ï¼‰</h3><ol>\n<li>æŸ¥çœ‹é™„è¿‘çš„äºº</li>\n<li>å¾®ä¿¡ä½ç½®å…±äº«</li>\n<li>åœ°å›¾ä¸Šç›´çº¿è·ç¦»çš„å±•ç¤º</li>\n</ol>\n<h3 id=\"Hyperloglogï¼ˆåŸºæ•°ï¼‰\"><a href=\"#Hyperloglogï¼ˆåŸºæ•°ï¼‰\" class=\"headerlink\" title=\"Hyperloglogï¼ˆåŸºæ•°ï¼‰\"></a>Hyperloglogï¼ˆåŸºæ•°ï¼‰</h3><p>åŸºæ•°ï¼šä¸é‡å¤çš„å…ƒç´ </p>\n<p>ç½‘é¡µç»Ÿè®¡ UV ï¼ˆæµè§ˆç”¨æˆ·æ•°é‡ï¼ŒåŒä¸€å¤©åŒä¸€ä¸ª ip å¤šæ¬¡è®¿é—®ç®—ä¸€æ¬¡è®¿é—®ï¼Œç›®çš„æ˜¯è®¡æ•°ï¼Œè€Œä¸æ˜¯ä¿å­˜ç”¨æˆ·ï¼‰</p>\n<p>ä¼ ç»Ÿçš„æ–¹å¼ï¼Œset ä¿å­˜ç”¨æˆ·çš„ idï¼Œå¯ä»¥ç»Ÿè®¡ set ä¸­å…ƒç´ æ•°é‡ä½œä¸ºæ ‡å‡†åˆ¤æ–­ã€‚</p>\n<p>ä½†å¦‚æœè¿™ç§æ–¹å¼ä¿å­˜å¤§é‡ç”¨æˆ· idï¼Œä¼šå ç”¨å¤§é‡å†…å­˜ï¼Œæˆ‘ä»¬çš„ç›®çš„æ˜¯ä¸ºäº†è®¡æ•°ï¼Œè€Œä¸æ˜¯å»ä¿å­˜ idã€‚</p>\n<h3 id=\"Bitmapsï¼ˆä½å­˜å‚¨ï¼‰\"><a href=\"#Bitmapsï¼ˆä½å­˜å‚¨ï¼‰\" class=\"headerlink\" title=\"Bitmapsï¼ˆä½å­˜å‚¨ï¼‰\"></a>Bitmapsï¼ˆä½å­˜å‚¨ï¼‰</h3><p>Redis æä¾›äº† Bitmaps è¿™ä¸ªâ€œæ•°æ®ç±»å‹â€å¯ä»¥å®ç°å¯¹ä½çš„æ“ä½œï¼š</p>\n<ol>\n<li>Bitmaps æœ¬èº«ä¸æ˜¯ä¸€ç§æ•°æ®ç±»å‹ï¼Œ å®é™…ä¸Šå®ƒå°±æ˜¯å­—ç¬¦ä¸²ï¼ˆkey-valueï¼‰ ï¼Œ ä½†æ˜¯å®ƒå¯ä»¥å¯¹å­—ç¬¦ä¸²çš„ä½è¿›è¡Œæ“ä½œã€‚</li>\n<li>Bitmaps å•ç‹¬æä¾›äº†ä¸€å¥—å‘½ä»¤ï¼Œ æ‰€ä»¥åœ¨ Redis ä¸­ä½¿ç”¨ Bitmaps å’Œä½¿ç”¨å­—ç¬¦ä¸²çš„æ–¹æ³•ä¸å¤ªç›¸åŒã€‚ å¯ä»¥æŠŠ Bitmaps æƒ³è±¡æˆä¸€ä¸ªä»¥ä½ä¸ºå•ä½çš„æ•°ç»„ï¼Œ æ•°ç»„çš„æ¯ä¸ªå•å…ƒåªèƒ½å­˜å‚¨ 0 å’Œ 1ï¼Œ æ•°ç»„çš„ä¸‹æ ‡åœ¨ Bitmaps ä¸­å«åšåç§»é‡ã€‚</li>\n</ol>\n<h4 id=\"å‘½ä»¤\"><a href=\"#å‘½ä»¤\" class=\"headerlink\" title=\"å‘½ä»¤\"></a>å‘½ä»¤</h4><ol>\n<li><p>setbit</p>\n<p> <code>setbit&lt;key&gt;&lt;offset&gt;&lt;value&gt;</code> è®¾ç½® Bitmaps ä¸­æŸä¸ªåç§»é‡çš„å€¼ï¼ˆ0 æˆ– 1ï¼‰</p>\n<p> å¯ä»¥å°† idx ä½ç½®ä¸º 1 è¡¨ç¤º idx ç”¨æˆ·è®¿é—®è¿‡</p>\n</li>\n<li><p>getbit</p>\n<p> <code>getbit&lt;key&gt;&lt;offset&gt;</code> è·å– Bitmaps ä¸­æŸä¸ªåç§»é‡çš„å€¼</p>\n<p> é€šè¿‡ idx ä½æ˜¯å¦ä¸º 1 åˆ¤æ–­ idx ç”¨æˆ·æ˜¯å¦è®¿é—®è¿‡</p>\n</li>\n<li><p>bitcount</p>\n<p> <code>bitcount&lt;key&gt;[start end]</code> ç»Ÿè®¡å­—ç¬¦ä¸²ä» start å­—èŠ‚åˆ° end å­—èŠ‚æ¯”ç‰¹å€¼ä¸º 1 çš„æ•°é‡</p>\n</li>\n<li><p>bitop</p>\n<p> <code>bitop and(or/not/xor) &lt;destkey&gt; [keyâ€¦]</code> bitop æ˜¯ä¸€ä¸ªå¤åˆæ“ä½œï¼Œ å®ƒå¯ä»¥åšå¤šä¸ª Bitmaps çš„ andï¼ˆäº¤é›†ï¼‰ ã€ orï¼ˆå¹¶é›†ï¼‰ ã€ notï¼ˆéï¼‰ ã€ xorï¼ˆå¼‚æˆ–ï¼‰ æ“ä½œå¹¶å°†ç»“æœä¿å­˜åœ¨ destkey ä¸­ã€‚</p>\n</li>\n</ol>\n<h4 id=\"åº”ç”¨åœºæ™¯-2\"><a href=\"#åº”ç”¨åœºæ™¯-2\" class=\"headerlink\" title=\"åº”ç”¨åœºæ™¯\"></a><strong>åº”ç”¨åœºæ™¯</strong></h4><p><strong>ä¸¤ç§çŠ¶æ€çš„ç»Ÿè®¡</strong>éƒ½å¯ä»¥ä½¿ç”¨ bitmapsï¼Œä¾‹å¦‚ï¼šç»Ÿè®¡ç”¨æˆ·æ´»è·ƒä¸éæ´»è·ƒæ•°é‡ã€ç™»å½•ä¸éç™»å½•ã€ä¸Šç­æ‰“å¡ç­‰ç­‰ã€‚</p>\n<hr>\n<h2 id=\"Redisäº‹åŠ¡ä¸é”æœºåˆ¶\"><a href=\"#Redisäº‹åŠ¡ä¸é”æœºåˆ¶\" class=\"headerlink\" title=\"Redisäº‹åŠ¡ä¸é”æœºåˆ¶\"></a>Redisäº‹åŠ¡ä¸é”æœºåˆ¶</h2><h3 id=\"äº‹åŠ¡\"><a href=\"#äº‹åŠ¡\" class=\"headerlink\" title=\"äº‹åŠ¡\"></a>äº‹åŠ¡</h3><p>äº‹åŠ¡æœ¬è´¨ï¼šä¸€ç»„å‘½ä»¤çš„é›†åˆ</p>\n<h4 id=\"æ•°æ®åº“çš„äº‹åŠ¡\"><a href=\"#æ•°æ®åº“çš„äº‹åŠ¡\" class=\"headerlink\" title=\"æ•°æ®åº“çš„äº‹åŠ¡\"></a><strong>æ•°æ®åº“çš„äº‹åŠ¡</strong></h4><p>æ•°æ®åº“äº‹åŠ¡é€šè¿‡ ACIDï¼ˆåŸå­æ€§ã€ä¸€è‡´æ€§ã€éš”ç¦»æ€§ã€æŒä¹…æ€§ï¼‰æ¥ä¿è¯ã€‚</p>\n<p>æ•°æ®åº“ä¸­é™¤æŸ¥è¯¢æ“ä½œä»¥å¤–ï¼Œæ’å…¥(Insert)ã€åˆ é™¤(Delete)å’Œæ›´æ–°(Update)è¿™ä¸‰ç§æ“ä½œéƒ½ä¼šå¯¹æ•°æ®é€ æˆå½±å“ï¼Œå› ä¸ºäº‹åŠ¡å¤„ç†èƒ½å¤Ÿä¿è¯ä¸€ç³»åˆ—æ“ä½œå¯ä»¥å®Œå…¨åœ°æ‰§è¡Œæˆ–è€…å®Œå…¨ä¸æ‰§è¡Œï¼Œå› æ­¤åœ¨ä¸€ä¸ªäº‹åŠ¡è¢«æäº¤ä»¥åï¼Œè¯¥äº‹åŠ¡ä¸­çš„ä»»ä½•ä¸€æ¡ SQL è¯­å¥åœ¨è¢«æ‰§è¡Œçš„æ—¶å€™ï¼Œéƒ½ä¼šç”Ÿæˆä¸€æ¡æ’¤é”€æ—¥å¿—(Undo Log)ã€‚</p>\n<h4 id=\"Redis-äº‹åŠ¡\"><a href=\"#Redis-äº‹åŠ¡\" class=\"headerlink\" title=\"Redis äº‹åŠ¡\"></a>Redis äº‹åŠ¡</h4><p>Redis äº‹åŠ¡æä¾›äº†ä¸€ç§â€œå°†å¤šä¸ªå‘½ä»¤æ‰“åŒ…ï¼Œ ç„¶åä¸€æ¬¡æ€§ã€æŒ‰é¡ºåºåœ°æ‰§è¡Œâ€çš„æœºåˆ¶ï¼Œ å¹¶ä¸”äº‹åŠ¡åœ¨æ‰§è¡Œçš„æœŸé—´ä¸ä¼šä¸»åŠ¨ä¸­æ–­ â€”â€” æœåŠ¡å™¨åœ¨æ‰§è¡Œå®Œäº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤ä¹‹åï¼Œ æ‰ä¼šç»§ç»­å¤„ç†å…¶ä»–å®¢æˆ·ç«¯çš„å…¶ä»–å‘½ä»¤ã€‚äº‹åŠ¡ä¸­å¦‚æœæœ‰ä¸€æ¡å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œå…¶åçš„å‘½ä»¤ä»ç„¶ä¼šè¢«æ‰§è¡Œï¼Œæ²¡æœ‰å›æ»šã€‚</p>\n<p>Redis ä¸­ä¸€ä¸ªäº‹åŠ¡ä»å¼€å§‹åˆ°æ‰§è¡Œä¼šç»å†<strong>å¼€å§‹</strong>äº‹åŠ¡ï¼ˆMuitiï¼‰ã€å‘½ä»¤<strong>ç»„é˜Ÿ</strong>å’Œ<strong>æ‰§è¡Œ</strong>äº‹åŠ¡(Exec)ä¸‰ä¸ªé˜¶æ®µï¼Œäº‹åŠ¡ä¸­çš„å‘½ä»¤åœ¨åŠ å…¥æ—¶éƒ½æ²¡æœ‰è¢«æ‰§è¡Œï¼Œç›´åˆ°æäº¤æ—¶æ‰ä¼šå¼€å§‹æ‰§è¡Œ(Exec)ä¸€æ¬¡æ€§å®Œæˆã€‚</p>\n<p>ç»„é˜Ÿçš„è¿‡ç¨‹ä¸­å¯ä»¥é€šè¿‡ discard æ¥æ”¾å¼ƒç»„é˜Ÿã€‚</p>\n<p><strong>äº‹åŠ¡çš„é”™è¯¯å¤„ç†</strong></p>\n<p>ç»„é˜Ÿé˜¶æ®µæŸä¸ªå‘½ä»¤æŠ¥é”™ï¼Œæ‰§è¡Œæ—¶æ•´ä¸ªé˜Ÿåˆ—éƒ½ä¼šè¢«å–æ¶ˆã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650372301056.png\" alt=\"ç»„é˜Ÿé˜¶æ®µæŸä¸ªå‘½ä»¤æŠ¥é”™\"></p>\n<p>å¦‚æœæ‰§è¡Œé˜¶æ®µæŸä¸ªå‘½ä»¤æŠ¥é”™ï¼Œåˆ™åªæœ‰æŠ¥é”™çš„å‘½ä»¤ä¸ä¼šè¢«æ‰§è¡Œï¼Œè€Œå…¶ä»–çš„å‘½ä»¤éƒ½ä¼šæ‰§è¡Œï¼Œä¸ä¼šå›æ»šã€‚ï¼ˆä¸ä¿è¯äº‹åŠ¡çš„åŸå­æ€§ï¼‰</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650372359361.png\" alt=\"æ‰§è¡Œé˜¶æ®µæŸä¸ªå‘½ä»¤æŠ¥é”™\"></p>\n<p><strong>ä¸ºä»€ä¹ˆ Redis ä¸æ”¯æŒå›æ»šæ¥ä¿è¯åŸå­æ€§</strong></p>\n<p>Redis å‘½ä»¤åªä¼šå› ä¸ºé”™è¯¯çš„è¯­æ³•è€Œå¤±è´¥ï¼Œç„¶è€Œæ²¡æœ‰ä»»ä½•æœºåˆ¶èƒ½é¿å…ç¨‹åºå‘˜è‡ªå·±é€ æˆçš„é”™è¯¯ï¼Œ å¹¶ä¸”è¿™ç±»é”™è¯¯é€šå¸¸ä¸ä¼šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­å‡ºç°ï¼Œ æ‰€ä»¥ Redis é€‰æ‹©äº†æ›´ç®€å•ã€æ›´å¿«é€Ÿçš„æ— å›æ»šæ–¹å¼æ¥å¤„ç†äº‹åŠ¡ã€‚</p>\n<h3 id=\"Redis-é”\"><a href=\"#Redis-é”\" class=\"headerlink\" title=\"Redis é”\"></a>Redis é”</h3><h4 id=\"æ‚²è§‚é”\"><a href=\"#æ‚²è§‚é”\" class=\"headerlink\" title=\"æ‚²è§‚é”\"></a>æ‚²è§‚é”</h4><p><strong>æ‚²è§‚é”(Pessimistic Lock)<strong>ï¼Œ é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¾ˆæ‚²è§‚ï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¼šä¿®æ”¹ï¼Œæ‰€ä»¥æ¯æ¬¡åœ¨æ‹¿æ•°æ®çš„æ—¶å€™éƒ½ä¼šä¸Šé”ï¼Œè¿™æ ·åˆ«äººæƒ³æ‹¿è¿™ä¸ªæ•°æ®å°±ä¼šé˜»å¡ç›´åˆ°å®ƒæ‹¿åˆ°é”ã€‚</strong>ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“é‡Œè¾¹å°±ç”¨åˆ°äº†å¾ˆå¤šè¿™ç§é”æœºåˆ¶</strong>ï¼Œæ¯”å¦‚<strong>è¡Œé”</strong>ï¼Œ<strong>è¡¨é”</strong>ç­‰ï¼Œ<strong>è¯»é”</strong>ï¼Œ<strong>å†™é”</strong>ç­‰ï¼Œéƒ½æ˜¯åœ¨åšæ“ä½œä¹‹å‰å…ˆä¸Šé”ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650417157625.png\" alt=\"æ‚²è§‚é”\"></p>\n<blockquote>\n<p>çº¿ç¨‹ 1 æ‹¿åˆ°è´¦æˆ·åæŠŠè´¦æˆ·é”ä½ï¼Œç„¶åæ“ä½œï¼Œè¿™æ—¶å€™çº¿ç¨‹ 2 ä¹Ÿæƒ³æ‹¿è´¦æˆ·ï¼Œå‘ç°åŠ äº†é”æ‹¿ä¸åˆ°ï¼Œåªèƒ½é˜»å¡ç­‰åˆ°é”é‡Šæ”¾ã€‚</p>\n</blockquote>\n<h4 id=\"ä¹è§‚é”\"><a href=\"#ä¹è§‚é”\" class=\"headerlink\" title=\"ä¹è§‚é”\"></a>ä¹è§‚é”</h4><p><strong>ä¹è§‚é”(Optimistic Lock)ï¼Œ</strong> é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¾ˆä¹è§‚ï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¸ä¼šä¿®æ”¹ï¼Œæ‰€ä»¥ä¸ä¼šä¸Šé”ï¼Œä½†æ˜¯åœ¨<strong>æ›´æ–°çš„æ—¶å€™åˆ¤æ–­</strong>ä¸€ä¸‹åœ¨æ­¤æœŸé—´åˆ«äººæœ‰æ²¡æœ‰å»æ›´æ–°è¿™ä¸ªæ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ç‰ˆæœ¬å·ç­‰æœºåˆ¶ã€‚<strong>ä¹è§‚é”é€‚ç”¨äºå¤šè¯»çš„åº”ç”¨ç±»å‹ï¼Œè¿™æ ·å¯ä»¥æé«˜ååé‡</strong>ã€‚Redis å°±æ˜¯åˆ©ç”¨è¿™ç§æœºåˆ¶å®ç°äº‹åŠ¡çš„ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650417222072.png\" alt=\"ä¹è§‚é”\"></p>\n<blockquote>\n<p>ç»™è´¦æˆ·æ•°æ®åŠ ä¸€ä¸ªç‰ˆæœ¬å·ï¼Œå‡å¦‚çº¿ç¨‹ 1ã€2 éƒ½æ‹¿åˆ°è´¦æˆ·ï¼Œçº¿ç¨‹ 1 ä½¿ç”¨è´¦æˆ·å‰å…ˆè¿›è¡Œç‰ˆæœ¬å·æ¯”è¾ƒï¼Œv1.0 &#x3D; v1.0ï¼Œåˆ™æ‰£å‡è´¦æˆ·ä½™é¢ï¼Œè´¦æˆ·ç‰ˆæœ¬å·å˜æ›´ä¸º v1.1ï¼Œçº¿ç¨‹ 2 å‡†å¤‡æ“ä½œæ•°æ®åº“ï¼Œå‘ç°è‡ªå·±é¢„æœŸçš„è´¦æˆ·ç‰ˆæœ¬å· v1.0 å’Œå½“å‰è´¦æˆ·ç‰ˆæœ¬å· v1.1 ä¸åŒï¼ˆCASï¼‰ï¼Œåˆ™ä¸èƒ½æ“ä½œã€‚ </p>\n</blockquote>\n<hr>\n<h2 id=\"RedisæŒä¹…åŒ–\"><a href=\"#RedisæŒä¹…åŒ–\" class=\"headerlink\" title=\"RedisæŒä¹…åŒ–\"></a>RedisæŒä¹…åŒ–</h2><p>Redis æ˜¯ä¸€ç§å†…å­˜å‹æ•°æ®åº“ï¼Œä¸€æ—¦æœåŠ¡å™¨è¿›ç¨‹é€€å‡ºï¼Œæ•°æ®åº“çš„æ•°æ®å°±ä¼šä¸¢å¤±ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ Redis ä¾›äº†ä¸¤ç§æŒä¹…åŒ–çš„æ–¹æ¡ˆï¼Œå°†å†…å­˜ä¸­çš„æ•°æ®ä¿å­˜åˆ°ç£ç›˜ä¸­ï¼Œé¿å…æ•°æ®çš„ä¸¢å¤±ã€‚</p>\n<p>ä¸¤ç§æŒä¹…åŒ–æ–¹å¼ï¼šå¿«ç…§ï¼ˆRDB æ–‡ä»¶ï¼‰å’Œè¿½åŠ å¼æ–‡ä»¶ï¼ˆAOF æ–‡ä»¶ï¼‰ï¼Œä¸‹é¢åˆ†åˆ«ä¸ºå¤§å®¶ä»‹ç»ä¸¤ç§æ–¹å¼çš„åŸç†ã€‚</p>\n<ul>\n<li><p>RDB æŒä¹…åŒ–æ–¹å¼ä¼šåœ¨ä¸€ä¸ªç‰¹å®šçš„é—´éš”ä¿å­˜é‚£ä¸ªæ—¶é—´ç‚¹çš„æ•°æ®å¿«ç…§ã€‚</p>\n</li>\n<li><p>AOF æŒä¹…åŒ–æ–¹å¼åˆ™ä¼šè®°å½•æ¯ä¸€ä¸ªæœåŠ¡å™¨æ”¶åˆ°çš„å†™æ“ä½œã€‚åœ¨æœåŠ¡å¯åŠ¨æ—¶ï¼Œè¿™äº›è®°å½•çš„æ“ä½œä¼šé€æ¡æ‰§è¡Œä»è€Œé‡å»ºå‡ºåŸæ¥çš„æ•°æ®ã€‚å†™æ“ä½œå‘½ä»¤è®°å½•çš„æ ¼å¼è·Ÿ Redis åè®®ä¸€è‡´ï¼Œä»¥è¿½åŠ çš„æ–¹å¼è¿›è¡Œä¿å­˜ã€‚</p>\n</li>\n<li><p>ä¸¤ç§æ–¹å¼çš„æŒä¹…åŒ–æ˜¯å¯ä»¥åŒæ—¶å­˜åœ¨çš„ï¼Œä½†æ˜¯å½“ Redis é‡å¯æ—¶ï¼ŒAOF æ–‡ä»¶ä¼šè¢«ä¼˜å…ˆç”¨äºé‡å»ºæ•°æ®ã€‚</p>\n</li>\n</ul>\n<h3 id=\"RDB-Redis-Database\"><a href=\"#RDB-Redis-Database\" class=\"headerlink\" title=\"RDB(Redis Database)\"></a>RDB(Redis Database)</h3><blockquote>\n<p>åœ¨æ»¡è¶³ç‰¹å®šçš„  Redis æ“ä½œæ¡ä»¶ï¼ˆæ—¶é—´å‘¨æœŸã€å†™æ“ä½œæ¬¡æ•°ï¼‰æ—¶ï¼Œå°†å†…å­˜ä¸­çš„æ•°æ®ä»¥ <strong>æ•°æ®å¿«ç…§</strong> çš„å½¢å¼å­˜å‚¨åˆ° db æ–‡ä»¶ä¸­</p>\n</blockquote>\n<h4 id=\"å·¥ä½œåŸç†\"><a href=\"#å·¥ä½œåŸç†\" class=\"headerlink\" title=\"å·¥ä½œåŸç†\"></a><strong>å·¥ä½œåŸç†</strong></h4><blockquote>\n<p><a href=\"https://www.cnblogs.com/zyf98/p/15934058.html\">Redis_RDBæŒä¹…åŒ–ä¹‹å†™æ—¶å¤åˆ¶æŠ€æœ¯çš„åº”ç”¨</a></p>\n</blockquote>\n<p>RDB æ˜¯ä¸€æ¬¡çš„å…¨é‡å¤‡ä»½ï¼Œå³å‘¨æœŸæ€§çš„æŠŠ Redis å½“å‰å†…å­˜ä¸­çš„å…¨é‡æ•°æ®å†™å…¥åˆ°ä¸€ä¸ªå¿«ç…§æ–‡ä»¶ä¸­ã€‚Redis æ˜¯å•çº¿ç¨‹ç¨‹åºï¼Œè¿™ä¸ªçº¿ç¨‹è¦åŒæ—¶è´Ÿè´£å¤šä¸ªå®¢æˆ·ç«¯çš„è¯»å†™è¯·æ±‚ï¼Œè¿˜è¦è´Ÿè´£å‘¨æœŸæ€§çš„æŠŠå½“å‰å†…å­˜ä¸­çš„æ•°æ®å†™åˆ°å¿«ç…§æ–‡ä»¶ä¸­ RDB ä¸­ï¼Œé‚£ä¹ˆå°±ä¼šå¸¦æ¥ä»¥ä¸‹ä¸¤ä¸ªé—®é¢˜ï¼š</p>\n<ol>\n<li>æ•°æ®å†™åˆ° RDB æ–‡ä»¶æ˜¯ IO æ“ä½œï¼ŒIO æ“ä½œä¼šä¸¥é‡å½±å“ Redis çš„æ€§èƒ½ï¼Œç”šè‡³åœ¨æŒä¹…åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œè¯»å†™è¯·æ±‚ä¼šé˜»å¡</li>\n<li>å‡å¦‚ Redis æ­£åœ¨è¿›è¡ŒæŒä¹…åŒ–ä¸€ä¸ªå¤§çš„æ•°æ®ç»“æ„ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªåˆ é™¤è¯·æ±‚ï¼ŒæŠŠè¿™ä¸ªå¤§çš„æ•°æ®ç»“æ„åˆ æ‰äº†ï¼Œè¿™æ—¶å€™æŒä¹…åŒ–çš„åŠ¨ä½œè¿˜æ²¡æœ‰å®Œæˆã€‚</li>\n</ol>\n<p>äºæ˜¯ Redis ä½¿ç”¨æ“ä½œç³»ç»Ÿçš„å¤šè¿›ç¨‹ <strong>å†™æ—¶å¤åˆ¶(Copy On Write)æœºåˆ¶</strong> æ¥å®ç°å¿«ç…§çš„æŒä¹…åŒ–ï¼Œåœ¨æŒä¹…åŒ–è¿‡ç¨‹ä¸­è°ƒç”¨<strong>glibc</strong>(Linux ä¸‹çš„ C å‡½æ•°åº“)çš„å‡½æ•° <strong>fork()</strong> äº§ç”Ÿä¸€ä¸ªå­è¿›ç¨‹ï¼Œè¯¥å­è¿›ç¨‹å’Œçˆ¶è¿›ç¨‹å…±äº«å†…å­˜é‡Œé¢çš„ä»£ç æ®µå’Œæ•°æ®æ®µï¼Œå¿«ç…§æŒä¹…åŒ–å®Œå…¨äº¤ç»™å­è¿›ç¨‹æ¥å¤„ç†ï¼Œçˆ¶è¿›ç¨‹ç»§ç»­å¤„ç†å®¢æˆ·ç«¯çš„è¯»å†™è¯·æ±‚ã€‚</p>\n<blockquote>\n<p>å­è¿›ç¨‹å°†æ•°æ®å†™å…¥åˆ°ä¸€ä¸ªä¸´æ—¶ RDB æ–‡ä»¶ä¸­ã€‚å½“å­è¿›ç¨‹å®ŒæˆæŒä¹…åŒ–æ—¶ï¼ŒRedis ç”¨æ–° RDB æ–‡ä»¶æ›¿æ¢åŸæ¥çš„ RDB æ–‡ä»¶ï¼Œå¹¶åˆ é™¤æ—§çš„ RDB æ–‡ä»¶ã€‚</p>\n</blockquote>\n<p>åœ¨å­è¿›ç¨‹æŒä¹…åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœä¸»è¿›ç¨‹æ”¶åˆ°çš„å®¢æˆ·ç«¯çš„è¯»å†™è¯·æ±‚ï¼Œéœ€è¦ä¿®æ”¹æŸå—æ•°æ®ï¼Œé‚£ä¹ˆè¿™å—æ•°æ®å°±ä¼šè¢«å¤åˆ¶ä¸€ä»½åˆ°å†…å­˜ï¼Œç”Ÿæˆè¯¥æ•°æ®çš„å‰¯æœ¬ï¼Œä¸»è¿›ç¨‹åœ¨è¯¥å‰¯æœ¬ä¸Šè¿›è¡Œä¿®æ”¹æ“ä½œã€‚æ‰€ä»¥å³ä½¿å¯¹æŸä¸ªæ•°æ®è¿›è¡Œäº†ä¿®æ”¹ï¼ŒRedis æŒä¹…åŒ–åˆ° RDB ä¸­çš„æ•°æ®ä¹Ÿæ˜¯æœªä¿®æ”¹çš„æ•°æ®ï¼Œè¿™ä¹Ÿæ˜¯æŠŠ RDB æ–‡ä»¶ç§°ä¸ºâ€å¿«ç…§â€æ–‡ä»¶çš„åŸå› ï¼Œå­è¿›ç¨‹æ‰€çœ‹åˆ°çš„æ•°æ®åœ¨å®ƒè¢«åˆ›å»ºçš„ä¸€ç¬é—´å°±å›ºå®šä¸‹æ¥äº†ï¼Œçˆ¶è¿›ç¨‹ä¿®æ”¹çš„æŸä¸ªæ•°æ®åªæ˜¯è¯¥æ•°æ®çš„å¤åˆ¶å“ã€‚è¿™é‡Œå†æ·±å…¥ä¸€ç‚¹ï¼ŒRedis å†…å­˜ä¸­çš„å…¨é‡æ•°æ®ç”±ä¸€ä¸ªä¸ªçš„â€æ•°æ®æ®µé¡µé¢â€ç»„æˆï¼Œæ¯ä¸ªæ•°æ®æ®µé¡µé¢çš„å¤§å°ä¸º 4Kï¼Œå®¢æˆ·ç«¯è¦ä¿®æ”¹çš„æ•°æ®åœ¨å“ªä¸ªé¡µé¢ä¸­ï¼Œå°±ä¼šå¤åˆ¶ä¸€ä»½è¿™ä¸ªé¡µé¢åˆ°å†…å­˜ä¸­ï¼Œè¿™ä¸ªå¤åˆ¶çš„è¿‡ç¨‹ç§°ä¸ºâ€é¡µé¢åˆ†ç¦»â€ï¼Œåœ¨æŒä¹…åŒ–è¿‡ç¨‹ä¸­ï¼Œéšç€åˆ†ç¦»å‡ºçš„é¡µé¢è¶Šæ¥è¶Šå¤šï¼Œå†…å­˜å°±ä¼šæŒç»­å¢é•¿ï¼Œä½†æ˜¯ä¸ä¼šè¶…è¿‡åŸå†…å­˜çš„ 2 å€ï¼Œå› ä¸ºåœ¨ä¸€æ¬¡æŒä¹…åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œå‡ ä¹ä¸ä¼šå‡ºç°æ‰€æœ‰çš„é¡µé¢éƒ½ä¼šåˆ†ç¦»çš„æƒ…å†µï¼Œè¯»å†™è¯·æ±‚é’ˆå¯¹çš„åªæ˜¯åŸæ•°æ®ä¸­çš„å°éƒ¨åˆ†ï¼Œå¤§éƒ¨åˆ† Redis æ•°æ®è¿˜æ˜¯â€å†·æ•°æ®â€ã€‚</p>\n<p>æ­£å› ä¸ºä¿®æ”¹çš„éƒ¨åˆ†æ•°æ®ä¼šè¢«é¢å¤–çš„å¤åˆ¶ä¸€ä»½ï¼Œæ‰€ä»¥ä¼šå ç”¨é¢å¤–çš„å†…å­˜ï¼Œå½“åœ¨è¿›è¡Œ RDB æŒä¹…åŒ–æ“ä½œçš„è¿‡ç¨‹ä¸­ï¼Œä¸æ­¤åŒæ—¶å¦‚æœæŒç»­å¾€ Redis ä¸­å†™å…¥çš„æ•°æ®é‡è¶Šå¤šï¼Œå°±ä¼šå¯¼è‡´å ç”¨çš„é¢å¤–å†…å­˜æ¶ˆè€—è¶Šå¤§ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes2093494-20220226233822789-2067752089.png\" alt=\"RDB æŒä¹…åŒ–\"></p>\n<p><strong>ä¼˜ç‚¹</strong>ï¼š</p>\n<ol>\n<li>RDB çš„å†…å®¹ä¸ºäºŒè¿›åˆ¶çš„æ•°æ®ï¼Œå ç”¨å†…å­˜æ›´å°ï¼Œæ›´ç´§å‡‘ï¼Œæ›´é€‚åˆåšä¸ºå¤‡ä»½æ–‡ä»¶ï¼›</li>\n<li>RDB å¯¹ç¾éš¾æ¢å¤éå¸¸æœ‰ç”¨ï¼Œå®ƒæ˜¯ä¸€ä¸ªç´§å‡‘çš„æ–‡ä»¶ï¼Œå¯ä»¥æ›´å¿«çš„ä¼ è¾“åˆ°è¿œç¨‹æœåŠ¡å™¨è¿›è¡Œ Redis æœåŠ¡æ¢å¤ï¼›</li>\n<li>RDB å¯ä»¥æ›´å¤§ç¨‹åº¦çš„æé«˜ Redis çš„è¿è¡Œé€Ÿåº¦ï¼Œå› ä¸ºæ¯æ¬¡æŒä¹…åŒ–æ—¶ Redis ä¸»è¿›ç¨‹éƒ½ä¼š fork() ä¸€ä¸ªå­è¿›ç¨‹ï¼Œè¿›è¡Œæ•°æ®æŒä¹…åŒ–åˆ°ç£ç›˜ï¼ŒRedis ä¸»è¿›ç¨‹å¹¶ä¸ä¼šæ‰§è¡Œç£ç›˜ I&#x2F;O ç­‰æ“ä½œï¼›</li>\n<li>ä¸ AOF æ ¼å¼çš„æ–‡ä»¶ç›¸æ¯”ï¼ŒRDB æ–‡ä»¶å¯ä»¥æ›´å¿«çš„é‡å¯ã€‚</li>\n</ol>\n<p><strong>ç¼ºç‚¹</strong>ï¼š</p>\n<ol>\n<li>å› ä¸º RDB åªèƒ½ä¿å­˜æŸä¸ªæ—¶é—´é—´éš”çš„æ•°æ®ï¼Œå¦‚æœä¸­é€” Redis æœåŠ¡è¢«æ„å¤–ç»ˆæ­¢äº†ï¼Œåˆ™ä¼šä¸¢å¤±ä¸€æ®µæ—¶é—´å†…çš„ Redis æ•°æ®ã€‚</li>\n<li>RDB éœ€è¦ç»å¸¸ fork() æ‰èƒ½ä½¿ç”¨å­è¿›ç¨‹å°†å…¶æŒä¹…åŒ–åœ¨ç£ç›˜ä¸Šã€‚å¦‚æœæ•°æ®é›†å¾ˆå¤§ï¼Œfork() å¯èƒ½å¾ˆè€—æ—¶ï¼Œå¹¶ä¸”å¦‚æœæ•°æ®é›†å¾ˆå¤§ä¸” CPU æ€§èƒ½ä¸ä½³ï¼Œåˆ™å¯èƒ½å¯¼è‡´ Redis åœæ­¢ä¸ºå®¢æˆ·ç«¯æœåŠ¡å‡ æ¯«ç§’ç”šè‡³ä¸€ç§’é’Ÿã€‚</li>\n</ol>\n<h3 id=\"AOF-Append-Only-File\"><a href=\"#AOF-Append-Only-File\" class=\"headerlink\" title=\"AOF(Append Only File)\"></a>AOF(Append Only File)</h3><p>ä»¥æ—¥å¿—çš„å½¢å¼æ¥è®°å½•æ¯ä¸ªå†™çš„æ“ä½œï¼Œå°† Redis æ‰§è¡Œè¿‡çš„æ‰€æœ‰æŒ‡ä»¤è®°å½•ä¸‹æ¥ï¼ˆè¯»æ“ä½œä¸è®°å½•ï¼‰ï¼Œåªè®¸è¿½åŠ æ–‡ä»¶ä½†ä¸å¯ä»¥æ”¹å†™æ–‡ä»¶ï¼ŒRedis å¯åŠ¨ä¹‹åˆä¼šè¯»å–è¯¥æ–‡ä»¶é‡æ–°æ„å»ºæ•°æ®ï¼Œæ¢è¨€ä¹‹ï¼ŒRedis é‡å¯çš„è¯å°±æ ¹æ®æ—¥å¿—æ–‡ä»¶çš„å†…å®¹å°†å†™æŒ‡ä»¤ä»å‰åˆ°åæ‰§è¡Œä¸€æ¬¡ä»¥å®Œæˆæ•°æ®çš„æ¢å¤å·¥ä½œã€‚</p>\n<h4 id=\"AOFé…ç½®é¡¹\"><a href=\"#AOFé…ç½®é¡¹\" class=\"headerlink\" title=\"AOFé…ç½®é¡¹\"></a><strong>AOFé…ç½®é¡¹</strong></h4><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># é»˜è®¤ä¸å¼€å¯aof  è€Œæ˜¯ä½¿ç”¨rdbçš„æ–¹å¼</span><br><span class=\"line\">appendonly no</span><br><span class=\"line\"></span><br><span class=\"line\"># é»˜è®¤æ–‡ä»¶å</span><br><span class=\"line\">appendfilename &quot;appendonly.aof&quot;</span><br><span class=\"line\"></span><br><span class=\"line\"># æ¯æ¬¡ä¿®æ”¹éƒ½ä¼šsync æ¶ˆè€—æ€§èƒ½</span><br><span class=\"line\"># appendfsync always</span><br><span class=\"line\"># æ¯ç§’æ‰§è¡Œä¸€æ¬¡ sync å¯èƒ½ä¼šä¸¢å¤±è¿™ä¸€ç§’çš„æ•°æ®</span><br><span class=\"line\">appendfsync everysec</span><br><span class=\"line\"># ä¸æ‰§è¡Œ sync ï¼Œè¿™æ—¶å€™æ“ä½œç³»ç»Ÿè‡ªå·±åŒæ­¥æ•°æ®ï¼Œé€Ÿåº¦æœ€å¿«</span><br><span class=\"line\"># appendfsync no </span><br></pre></td></tr></table></figure>\n\n<p>AOF çš„æ•´ä¸ªæµç¨‹å¤§ä½“æ¥çœ‹å¯ä»¥åˆ†ä¸ºä¸¤æ­¥ï¼Œç¬¬ä¸€æ­¥æ˜¯å‘½ä»¤çš„å®æ—¶å†™å…¥ï¼ˆå¦‚æœæ˜¯ appendfsync everysec é…ç½®ï¼Œä¼šæœ‰ 1s æŸè€—ï¼‰ï¼Œç¬¬äºŒæ­¥æ˜¯å¯¹ aof æ–‡ä»¶çš„é‡å†™ã€‚</p>\n<h4 id=\"AOF-é‡å†™æœºåˆ¶\"><a href=\"#AOF-é‡å†™æœºåˆ¶\" class=\"headerlink\" title=\"AOF é‡å†™æœºåˆ¶\"></a><strong>AOF é‡å†™æœºåˆ¶</strong></h4><p>éšç€ Redis çš„è¿è¡Œï¼ŒAOF çš„æ—¥å¿—ä¼šè¶Šæ¥è¶Šé•¿ï¼Œå¦‚æœå®ä¾‹å®•æœºé‡å¯ï¼Œé‚£ä¹ˆé‡æ”¾æ•´ä¸ª AOF å°†ä¼šå˜å¾—ååˆ†è€—æ—¶ï¼Œè€Œåœ¨æ—¥å¿—è®°å½•ä¸­ï¼Œåˆæœ‰å¾ˆå¤šæ— æ„ä¹‰çš„è®°å½•ï¼Œæ¯”å¦‚æˆ‘ç°åœ¨å°†ä¸€ä¸ªæ•°æ® incr ä¸€åƒæ¬¡ï¼Œé‚£ä¹ˆå°±ä¸éœ€è¦å»è®°å½•è¿™ 1000 æ¬¡ä¿®æ”¹ï¼Œåªéœ€è¦è®°å½•æœ€åçš„å€¼å³å¯ã€‚æ‰€ä»¥å°±éœ€è¦è¿›è¡Œ AOF é‡å†™ã€‚</p>\n<p>Redis æä¾›äº† bgrewriteaof æŒ‡ä»¤ç”¨äºå¯¹ AOF æ—¥å¿—è¿›è¡Œé‡å†™ï¼Œè¯¥æŒ‡ä»¤è¿è¡Œæ—¶ä¼šå¼€è¾Ÿä¸€ä¸ªå­è¿›ç¨‹å¯¹å†…å­˜è¿›è¡Œéå†ï¼Œç„¶åå°†å…¶è½¬æ¢ä¸ºä¸€ç³»åˆ—çš„ Redis çš„æ“ä½œæŒ‡ä»¤ï¼Œå†åºåˆ—åŒ–åˆ°ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ä¸­ã€‚å®Œæˆåå†æ›¿æ¢åŸæœ‰çš„ AOF æ–‡ä»¶ï¼Œè‡³æ­¤å®Œæˆã€‚</p>\n<p>åŒæ ·çš„ä¹Ÿå¯ä»¥åœ¨ Redis.config ä¸­å¯¹é‡å†™æœºåˆ¶çš„è§¦å‘è¿›è¡Œé…ç½®ï¼š</p>\n<p>é€šè¿‡å°† no-appendfsync-on-rewrite è®¾ç½®ä¸º yesï¼Œå¼€å¯é‡å†™æœºåˆ¶ï¼›auto-aof-rewrite-percentage 100 æ„ä¸ºæ¯”ä¸Šæ¬¡ä»å†™åæ–‡ä»¶å¤§å°å¢é•¿äº† 100%å†æ¬¡è§¦å‘é‡å†™ï¼›</p>\n<p>auto-aof-rewrite-min-size 64mb æ„ä¸ºå½“æ–‡ä»¶è‡³å°‘è¦è¾¾åˆ° 64mb æ‰ä¼šè§¦å‘åˆ¶åŠ¨é‡å†™ã€‚</p>\n<p><strong>ä¼˜ç‚¹</strong>ï¼š</p>\n<p>1ã€æ•°æ®å®‰å…¨ï¼ŒAOF æ˜¯å¯¹æŒ‡ä»¤æ–‡ä»¶è¿›è¡Œ <strong>å¢é‡æ›´æ–°</strong>ï¼Œæ›´é€‚åˆå®æ—¶æ€§æŒä¹…åŒ–ã€‚</p>\n<p>2ã€é€šè¿‡ append æ¨¡å¼å†™æ–‡ä»¶ï¼Œå³ä½¿ä¸­é€”æœåŠ¡å™¨å®•æœºï¼Œå¯ä»¥é€šè¿‡ Redis-check-aof å·¥å…·è§£å†³æ•°æ®ä¸€è‡´æ€§é—®é¢˜ã€‚</p>\n<p>3ã€AOF æœºåˆ¶çš„ rewrite æ¨¡å¼ã€‚AOF æ–‡ä»¶æ²¡è¢« rewrite ä¹‹å‰ï¼ˆæ–‡ä»¶è¿‡å¤§æ—¶ä¼šå¯¹å‘½ä»¤ è¿›è¡Œåˆå¹¶é‡å†™ï¼‰ï¼Œå¯ä»¥åˆ é™¤å…¶ä¸­çš„æŸäº›å‘½ä»¤ï¼ˆæ¯”å¦‚è¯¯æ“ä½œçš„ flushallï¼‰)</p>\n<p><strong>ç¼ºç‚¹</strong>ï¼š</p>\n<p>1ã€AOF æ–‡ä»¶æ¯” RDB æ–‡ä»¶å¤§ï¼Œä¸”æ¢å¤é€Ÿåº¦æ…¢ã€‚</p>\n<p>2ã€æ•°æ®é›†å¤§çš„æ—¶å€™ï¼Œæ¯” RDB å¯åŠ¨æ•ˆç‡ä½ã€‚</p>\n<h3 id=\"RDBä¸AOFå¯¹æ¯”\"><a href=\"#RDBä¸AOFå¯¹æ¯”\" class=\"headerlink\" title=\"RDBä¸AOFå¯¹æ¯”\"></a>RDBä¸AOFå¯¹æ¯”</h3><p>Redis å®˜æ–¹å»ºè®®åŒæ—¶å¼€å¯ä¸¤ç§æŒä¹…åŒ–ç­–ç•¥ï¼ŒAOF å’Œ RDB åŒæ—¶å¼€å¯ï¼Œç³»ç»Ÿé»˜è®¤å– AOF çš„æ•°æ®ï¼ˆæ•°æ®ä¸ä¼šå­˜åœ¨ä¸¢å¤±ï¼‰</p>\n<table>\n<thead>\n<tr>\n<th>æ¯”è¾ƒé¡¹</th>\n<th>RDB</th>\n<th>AOF</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>å¯åŠ¨ä¼˜å…ˆçº§</td>\n<td>ä½</td>\n<td>é«˜</td>\n</tr>\n<tr>\n<td>ä½“ç§¯</td>\n<td>å°</td>\n<td>å¤§</td>\n</tr>\n<tr>\n<td>æ¢å¤é€Ÿåº¦</td>\n<td>å¿«</td>\n<td>æ…¢</td>\n</tr>\n<tr>\n<td>æ•°æ®å®‰å…¨æ€§</td>\n<td>ä¸¢æ•°æ®</td>\n<td>æ ¹æ®ç­–ç•¥å†³å®š</td>\n</tr>\n</tbody></table>\n<hr>\n<h2 id=\"å‘å¸ƒä¸è®¢é˜…\"><a href=\"#å‘å¸ƒä¸è®¢é˜…\" class=\"headerlink\" title=\"å‘å¸ƒä¸è®¢é˜…\"></a>å‘å¸ƒä¸è®¢é˜…</h2><p>Redis å‘å¸ƒä¸è®¢é˜…æ˜¯ä¸€ç§æ¶ˆæ¯é€šä¿¡çš„æ¨¡å¼ï¼šå‘é€è€…ï¼ˆpubï¼‰å‘é€æ¶ˆæ¯ï¼Œè®¢é˜…è€…ï¼ˆsubï¼‰æ¥æ”¶æ¶ˆæ¯ã€‚</p>\n<p>Redis é€šè¿‡ PUBLISH å’Œ SUBSCRIBE ç­‰å‘½ä»¤å®ç°äº†è®¢é˜…ä¸å‘å¸ƒæ¨¡å¼ï¼Œè¿™ä¸ªåŠŸèƒ½æä¾›ä¸¤ç§ä¿¡æ¯æœºåˆ¶ï¼Œåˆ†åˆ«æ˜¯è®¢é˜…&#x2F;å‘å¸ƒåˆ°é¢‘é“ã€è®¢é˜…&#x2F;å‘å¸ƒåˆ°æ¨¡å¼çš„å®¢æˆ·ç«¯ã€‚</p>\n<h3 id=\"é¢‘é“ï¼ˆchannelï¼‰\"><a href=\"#é¢‘é“ï¼ˆchannelï¼‰\" class=\"headerlink\" title=\"é¢‘é“ï¼ˆchannelï¼‰\"></a>é¢‘é“ï¼ˆchannelï¼‰</h3><p><strong>è®¢é˜…</strong></p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650436261125.png\" alt=\"é¢‘é“è®¢é˜…\"></p>\n<p><strong>å‘å¸ƒ</strong></p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650436267143.png\" alt=\"é¢‘é“å‘å¸ƒ\"></p>\n<h4 id=\"å®Œæ•´æµç¨‹\"><a href=\"#å®Œæ•´æµç¨‹\" class=\"headerlink\" title=\"å®Œæ•´æµç¨‹\"></a><strong>å®Œæ•´æµç¨‹</strong></h4><p>å‘å¸ƒè€…å‘é¢‘é“ channel:1 å‘å¸ƒæ¶ˆæ¯ hi</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; publish channel:1 hi(integer) 1</span><br></pre></td></tr></table></figure>\n\n<p>è®¢é˜…è€…è®¢é˜…æ¶ˆæ¯</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; subscribe channel:1</span><br><span class=\"line\">Reading messages... (press Ctrl-C to quit)</span><br><span class=\"line\">1) &quot;subscribe&quot; // æ¶ˆæ¯ç±»å‹</span><br><span class=\"line\">2) &quot;channel:1&quot; // é¢‘é“</span><br><span class=\"line\">3) &quot;hi&quot; // æ¶ˆæ¯å†…å®¹</span><br></pre></td></tr></table></figure>\n\n<p>æ‰§è¡Œ subscribe åå®¢æˆ·ç«¯ä¼šè¿›å…¥è®¢é˜…çŠ¶æ€ï¼Œä»…å¯ä»¥ä½¿ subscribeã€unsubscribeã€psubscribe å’Œ punsubscribe è¿™å››ä¸ªå±äºâ€å‘å¸ƒ&#x2F;è®¢é˜…â€ä¹‹å¤–çš„å‘½ä»¤</p>\n<p>è®¢é˜…é¢‘é“åçš„å®¢æˆ·ç«¯å¯èƒ½ä¼šæ”¶åˆ°ä¸‰ç§æ¶ˆæ¯ç±»å‹</p>\n<ul>\n<li><p>subscribeï¼šè¡¨ç¤ºè®¢é˜…æˆåŠŸçš„åé¦ˆä¿¡æ¯ã€‚ç¬¬äºŒä¸ªå€¼æ˜¯è®¢é˜…æˆåŠŸçš„é¢‘é“åç§°ï¼Œç¬¬ä¸‰ä¸ªæ˜¯å½“å‰å®¢æˆ·ç«¯è®¢é˜…çš„é¢‘é“æ•°é‡ã€‚</p>\n</li>\n<li><p>messageï¼šè¡¨ç¤ºæ¥æ”¶åˆ°çš„æ¶ˆæ¯ï¼Œç¬¬äºŒä¸ªå€¼è¡¨ç¤ºäº§ç”Ÿæ¶ˆæ¯çš„é¢‘é“åç§°ï¼Œç¬¬ä¸‰ä¸ªå€¼æ˜¯æ¶ˆæ¯çš„å†…å®¹ã€‚</p>\n</li>\n<li><p>unsubscribeï¼šè¡¨ç¤ºæˆåŠŸå–æ¶ˆè®¢é˜…æŸä¸ªé¢‘é“ã€‚ç¬¬äºŒä¸ªå€¼æ˜¯å¯¹åº”çš„é¢‘é“åç§°ï¼Œç¬¬ä¸‰ä¸ªå€¼æ˜¯å½“å‰å®¢æˆ·ç«¯è®¢é˜…çš„é¢‘é“æ•°é‡ï¼Œå½“æ­¤å€¼ä¸º 0 æ—¶å®¢æˆ·ç«¯ä¼šé€€å‡ºè®¢é˜…çŠ¶æ€ï¼Œä¹‹åå°±å¯ä»¥æ‰§è¡Œå…¶ä»–éâ€å‘å¸ƒ&#x2F;è®¢é˜…â€æ¨¡å¼çš„å‘½ä»¤äº†ã€‚</p>\n</li>\n</ul>\n<h4 id=\"æ•°æ®ç»“æ„\"><a href=\"#æ•°æ®ç»“æ„\" class=\"headerlink\" title=\"æ•°æ®ç»“æ„\"></a><strong>æ•°æ®ç»“æ„</strong></h4><p>åŸºäº channel çš„å‘å¸ƒè®¢é˜…æ¨¡å¼æ˜¯é€šè¿‡å­—å…¸æ•°æ®ç±»å‹å®ç°çš„</p>\n<blockquote>\n<p>ç±»ä¼¼hashmapï¼Œé”®ä¸ºchannelï¼Œå€¼ä¸ºè®¢é˜…äº†è¯¥channelçš„clientï¼Œç”¨é“¾è¡¨é“¾æ¥èµ·æ¥</p>\n</blockquote>\n<p>å…¶ä¸­ï¼Œå­—å…¸çš„é”®ä¸ºæ­£åœ¨è¢«è®¢é˜…çš„é¢‘é“ï¼Œ è€Œå­—å…¸çš„å€¼åˆ™æ˜¯ä¸€ä¸ªé“¾è¡¨ï¼Œ é“¾è¡¨ä¸­ä¿å­˜äº†æ‰€æœ‰è®¢é˜…è¿™ä¸ªé¢‘é“çš„å®¢æˆ·ç«¯ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650420774862.png\" alt=\"é¢‘é“æ¨¡å¼æ•°æ®ç»“æ„æ¨¡å‹\"></p>\n<p><strong>è®¢é˜…</strong></p>\n<p>å½“ä½¿ç”¨ subscribe è®¢é˜…æ—¶ï¼Œåœ¨å­—å…¸ä¸­æ‰¾åˆ°é¢‘é“ keyï¼ˆå¦‚æ²¡æœ‰åˆ™åˆ›å»ºï¼‰ï¼Œå¹¶å°†è®¢é˜…çš„ client å…³è”åœ¨é“¾è¡¨åé¢ã€‚</p>\n<p>å½“ client 10 æ‰§è¡Œ <code>subscribe channel1 channel2 channel3</code> æ—¶ï¼Œä¼šå°† client 10 åˆ†åˆ«åŠ åˆ° channel1 channel2 channel3 å…³è”çš„é“¾è¡¨å°¾éƒ¨ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650420784179.png\" alt=\"é¢‘é“è®¢é˜…\"></p>\n<p><strong>å‘å¸ƒ</strong></p>\n<p>å‘å¸ƒæ—¶ï¼Œæ ¹æ® keyï¼Œæ‰¾åˆ°å­—å…¸æ±‡æ€» key çš„åœ°å€ï¼Œç„¶åå°† msg å‘é€åˆ°å…³è”çš„é“¾è¡¨æ¯ä¸€å°æœºå™¨ã€‚</p>\n<p><strong>é€€è®¢</strong></p>\n<p>éå†å…³è”çš„é“¾è¡¨ï¼Œå°†æŒ‡å®šçš„åœ°å€åˆ é™¤å³å¯ã€‚</p>\n<h3 id=\"æ¨¡å¼ï¼ˆpatternï¼‰\"><a href=\"#æ¨¡å¼ï¼ˆpatternï¼‰\" class=\"headerlink\" title=\"æ¨¡å¼ï¼ˆpatternï¼‰\"></a>æ¨¡å¼ï¼ˆpatternï¼‰</h3><p>pattern ä½¿ç”¨äº†é€šé…ç¬¦çš„æ–¹å¼æ¥è®¢é˜…</p>\n<p>é€šé…ç¬¦ä¸­ ? è¡¨ç¤º 1 ä¸ªå ä½ç¬¦ï¼Œ* è¡¨ç¤ºä»»æ„ä¸ªå ä½ç¬¦(åŒ…æ‹¬ 0)ï¼Œ?* è¡¨ç¤º 1 ä¸ªä»¥ä¸Šå ä½ç¬¦ã€‚</p>\n<p>æ‰€ä»¥å½“ä½¿ç”¨ publish å‘½ä»¤å‘é€ä¿¡æ¯åˆ°æŸä¸ªé¢‘é“æ—¶ï¼Œ ä¸ä»…æ‰€æœ‰è®¢é˜…è¯¥é¢‘é“çš„å®¢æˆ·ç«¯ä¼šæ”¶åˆ°ä¿¡æ¯ï¼Œ å¦‚æœæœ‰æŸä¸ª&#x2F;æŸäº›æ¨¡å¼å’Œè¿™ä¸ªé¢‘é“åŒ¹é…çš„è¯ï¼Œ é‚£ä¹ˆæ‰€æœ‰è®¢é˜…è¿™ä¸ª&#x2F;è¿™äº›é¢‘é“çš„å®¢æˆ·ç«¯ä¹ŸåŒæ ·ä¼šæ”¶åˆ°ä¿¡æ¯ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650420803487.png\" alt=\"æ¨¡å¼\"></p>\n<h4 id=\"è®¢é˜…å‘å¸ƒå®Œæ•´æµç¨‹\"><a href=\"#è®¢é˜…å‘å¸ƒå®Œæ•´æµç¨‹\" class=\"headerlink\" title=\"è®¢é˜…å‘å¸ƒå®Œæ•´æµç¨‹\"></a><strong>è®¢é˜…å‘å¸ƒå®Œæ•´æµç¨‹</strong></h4><p>å‘å¸ƒè€…å‘å¸ƒæ¶ˆæ¯</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; publish b m1</span><br><span class=\"line\">(integer) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; publish b1 m1</span><br><span class=\"line\">(integer) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; publish b11 m1</span><br><span class=\"line\">(integer) 1</span><br></pre></td></tr></table></figure>\n\n<p>è®¢é˜…è€…è®¢é˜…æ¶ˆæ¯</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; psubscribe b*</span><br><span class=\"line\">Reading messages... (press Ctrl-C to quit)</span><br><span class=\"line\">1) &quot;psubscribe&quot;</span><br><span class=\"line\">2) &quot;b*&quot;</span><br><span class=\"line\">3) (integer) 3</span><br><span class=\"line\">1) &quot;pmessage&quot;</span><br><span class=\"line\">2) &quot;b*&quot;</span><br><span class=\"line\">3) &quot;b&quot;</span><br><span class=\"line\">4) &quot;m1&quot;</span><br><span class=\"line\">1) &quot;pmessage&quot;</span><br><span class=\"line\">2) &quot;b*&quot;</span><br><span class=\"line\">3) &quot;b1&quot;</span><br><span class=\"line\">4) &quot;m1&quot;</span><br><span class=\"line\">1) &quot;pmessage&quot;</span><br><span class=\"line\">2) &quot;b*&quot;</span><br><span class=\"line\">3) &quot;b11&quot;</span><br><span class=\"line\">4) &quot;m1&quot;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"æ•°æ®ç»“æ„-1\"><a href=\"#æ•°æ®ç»“æ„-1\" class=\"headerlink\" title=\"æ•°æ®ç»“æ„\"></a><strong>æ•°æ®ç»“æ„</strong></h4><p>pattern å±æ€§æ˜¯ä¸€ä¸ªé“¾è¡¨ï¼Œé“¾è¡¨ä¸­ä¿å­˜ç€æ‰€æœ‰å’Œæ¨¡å¼ç›¸å…³çš„ä¿¡æ¯ã€‚</p>\n<blockquote>\n<p>ç±»ä¼¼é“¾è¡¨ï¼Œæ¯ä¸ªpatternèŠ‚ç‚¹ï¼ŒåŒ…å«patternä»¥åŠè®¢é˜…è¯¥patternçš„client</p>\n</blockquote>\n<p>æ•°æ®ç»“æ„å›¾å¦‚ä¸‹ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650420905733.png\" alt=\"æ¨¡å¼æ•°æ®ç»“æ„\"></p>\n<p><strong>è®¢é˜…</strong></p>\n<p>å½“æœ‰ä¿¡çš„è®¢é˜…æ—¶ï¼Œä¼šå°†è®¢é˜…çš„å®¢æˆ·ç«¯å’Œæ¨¡å¼ä¿¡æ¯æ·»åŠ åˆ°é“¾è¡¨åé¢ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650420913717.png\" alt=\"æ¨¡å¼è®¢é˜…\"></p>\n<p><strong>å‘å¸ƒ</strong></p>\n<p>å½“å‘å¸ƒè€…å‘å¸ƒæ¶ˆæ¯æ—¶ï¼Œé¦–å…ˆä¼šå‘é€åˆ°å¯¹åº”çš„é¢‘é“ä¸Šï¼Œåœ¨éå†æ¨¡å¼åˆ—è¡¨ï¼Œæ ¹æ® key åŒ¹é…æ¨¡å¼ï¼ŒåŒ¹é…æˆåŠŸå°†æ¶ˆæ¯å‘ç»™å¯¹åº”çš„è®¢é˜…è€…ã€‚</p>\n<p><strong>é€€è®¢</strong></p>\n<p>ä½¿ç”¨ punsubscribeï¼Œå¯ä»¥å°†è®¢é˜…è€…é€€è®¢ï¼Œå°†æ”¹å®¢æˆ·ç«¯ç§»é™¤å‡ºé“¾è¡¨ã€‚</p>\n<hr>\n<h2 id=\"ä¸»ä»å¤åˆ¶\"><a href=\"#ä¸»ä»å¤åˆ¶\" class=\"headerlink\" title=\"ä¸»ä»å¤åˆ¶\"></a>ä¸»ä»å¤åˆ¶</h2><p><strong>ä»€ä¹ˆæ˜¯ä¸»ä»å¤åˆ¶</strong></p>\n<p>åœ¨å¤šä¸ª Redis å®ä¾‹å»ºç«‹èµ·ä¸»ä»å…³ç³»ï¼Œå½“ ä¸» Redis ä¸­çš„æ•°æ®å‘ç”Ÿå˜åŒ–ï¼Œä» Redis ä¸­çš„æ•°æ®ä¹Ÿä¼šåŒæ­¥å˜åŒ–</p>\n<ul>\n<li>é€šè¿‡ä¸»ä»é…ç½®å¯ä»¥å®ç° Redis æ•°æ®çš„å¤‡ä»½ï¼ˆä» Redis å°±æ˜¯å¯¹ ä¸» Redis çš„å¤‡ä»½ï¼‰ï¼Œä¿è¯æ•°æ®å®‰å…¨æ€§</li>\n<li>ä¸»ä»åº“ä¹‹é—´é‡‡ç”¨çš„æ˜¯è¯»å†™åˆ†ç¦»çš„æ–¹å¼ï¼Œè¯»æ“ä½œï¼šä¸»åº“ã€ä»åº“éƒ½å¯ä»¥æ¥æ”¶ï¼›å†™æ“ä½œï¼šé¦–å…ˆåˆ°ä¸»åº“æ‰§è¡Œï¼Œç„¶åä¸»åº“å°†å†™æ“ä½œåŒæ­¥ç»™ä»åº“</li>\n</ul>\n<p><strong>ä¸»ä»å¤åˆ¶çš„ä½œç”¨</strong></p>\n<ul>\n<li><p>æ•°æ®å†—ä½™ï¼šä¸»ä»å¤åˆ¶å®ç°äº†æ•°æ®çš„çƒ­å¤‡ä»½ï¼Œæ˜¯æŒä¹…åŒ–ä¹‹å¤–çš„ä¸€ç§æ•°æ®å†—ä½™æ–¹å¼ã€‚</p>\n</li>\n<li><p>æ•…éšœæ¢å¤ï¼šå½“ä¸»èŠ‚ç‚¹å‡ºç°é—®é¢˜æ—¶ï¼Œå¯ä»¥ç”±ä»èŠ‚ç‚¹æä¾›æœåŠ¡ï¼Œå®ç°å¿«é€Ÿçš„æ•…éšœæ¢å¤ï¼›å®é™…ä¸Šæ˜¯ä¸€ç§æœåŠ¡çš„å†—ä½™ã€‚</p>\n</li>\n<li><p>è´Ÿè½½å‡è¡¡ï¼šåœ¨ä¸»ä»å¤åˆ¶çš„åŸºç¡€ä¸Šï¼Œé…åˆè¯»å†™åˆ†ç¦»ï¼Œå¯ä»¥ç”±ä¸»èŠ‚ç‚¹æä¾›å†™æœåŠ¡ï¼Œç”±ä»èŠ‚ç‚¹æä¾›è¯»æœåŠ¡ï¼ˆå³å†™ Redis æ•°æ®æ—¶åº”ç”¨è¿æ¥ä¸»èŠ‚ç‚¹ï¼Œè¯» Redis æ•°æ®æ—¶åº”ç”¨è¿æ¥ä»èŠ‚ç‚¹ï¼‰ï¼Œåˆ†æ‹…æœåŠ¡å™¨è´Ÿè½½ï¼›å°¤å…¶æ˜¯åœ¨å†™å°‘è¯»å¤šçš„åœºæ™¯ä¸‹ï¼Œé€šè¿‡å¤šä¸ªä»èŠ‚ç‚¹åˆ†æ‹…è¯»è´Ÿè½½ï¼Œå¯ä»¥å¤§å¤§æé«˜ Redis æœåŠ¡å™¨çš„å¹¶å‘é‡ã€‚</p>\n</li>\n<li><p>é«˜å¯ç”¨åŸºçŸ³ï¼šé™¤äº†ä¸Šè¿°ä½œç”¨ä»¥å¤–ï¼Œä¸»ä»å¤åˆ¶è¿˜æ˜¯å“¨å…µå’Œé›†ç¾¤èƒ½å¤Ÿå®æ–½çš„åŸºç¡€ï¼Œå› æ­¤è¯´ä¸»ä»å¤åˆ¶æ˜¯ Redis é«˜å¯ç”¨çš„åŸºç¡€ã€‚</p>\n</li>\n</ul>\n<p>ä¸»ä»åº“é‡‡ç”¨çš„æ˜¯è¯»å†™åˆ†ç¦»çš„æ–¹å¼ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650420963646.png\" alt=\"ä¸»ä»åº“è¯»å†™åˆ†ç¦»\"> </p>\n<h3 id=\"åŸç†\"><a href=\"#åŸç†\" class=\"headerlink\" title=\"åŸç†\"></a>åŸç†</h3><p>åˆ†ä¸ºå…¨é‡å¤åˆ¶ä¸å¢é‡å¤åˆ¶</p>\n<p>å…¨é‡å¤åˆ¶ï¼šå‘ç”Ÿåœ¨ç¬¬ä¸€æ¬¡å¤åˆ¶æ—¶</p>\n<p>å¢é‡å¤åˆ¶ï¼šåªä¼šæŠŠä¸»ä»åº“ç½‘ç»œæ–­è¿æœŸé—´ä¸»åº“æ”¶åˆ°çš„å‘½ä»¤ï¼ŒåŒæ­¥ç»™ä»åº“</p>\n<h3 id=\"å…¨é‡å¤åˆ¶çš„ä¸‰ä¸ªé˜¶æ®µ\"><a href=\"#å…¨é‡å¤åˆ¶çš„ä¸‰ä¸ªé˜¶æ®µ\" class=\"headerlink\" title=\"å…¨é‡å¤åˆ¶çš„ä¸‰ä¸ªé˜¶æ®µ\"></a>å…¨é‡å¤åˆ¶çš„ä¸‰ä¸ªé˜¶æ®µ</h3><p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNoteskjk7gr48ft.jpeg\" alt=\"å…¨é‡å¤åˆ¶\"></p>\n<p>ç¬¬ä¸€é˜¶æ®µæ˜¯ä¸»ä»åº“é—´å»ºç«‹è¿æ¥ã€åå•†åŒæ­¥çš„è¿‡ç¨‹ã€‚</p>\n<blockquote>\n<p>ä¸»è¦æ˜¯ä¸ºå…¨é‡å¤åˆ¶åšå‡†å¤‡ã€‚ä»åº“å’Œä¸»åº“å»ºç«‹èµ·è¿æ¥ï¼Œå¹¶å‘Šè¯‰ä¸»åº“å³å°†è¿›è¡ŒåŒæ­¥ï¼Œä¸»åº“ç¡®è®¤å›å¤åï¼Œä¸»ä»åº“é—´å°±å¯ä»¥å¼€å§‹åŒæ­¥äº†ã€‚</p>\n<p>å…·ä½“æ¥è¯´ï¼Œä»åº“ç»™ä¸»åº“å‘é€ psync å‘½ä»¤ï¼Œè¡¨ç¤ºè¦è¿›è¡Œæ•°æ®åŒæ­¥ï¼Œä¸»åº“æ ¹æ®è¿™ä¸ªå‘½ä»¤çš„å‚æ•°æ¥å¯åŠ¨å¤åˆ¶ã€‚psync å‘½ä»¤åŒ…å«äº†ä¸»åº“çš„ runID å’Œå¤åˆ¶è¿›åº¦ offset ä¸¤ä¸ªå‚æ•°ã€‚runIDï¼Œæ˜¯æ¯ä¸ª Redis å®ä¾‹å¯åŠ¨æ—¶éƒ½ä¼šè‡ªåŠ¨ç”Ÿæˆçš„ä¸€ä¸ªéšæœº IDï¼Œç”¨æ¥å”¯ä¸€æ ‡è®°è¿™ä¸ªå®ä¾‹ã€‚å½“ä»åº“å’Œä¸»åº“ç¬¬ä¸€æ¬¡å¤åˆ¶æ—¶ï¼Œå› ä¸ºä¸çŸ¥é“ä¸»åº“çš„ runIDï¼Œæ‰€ä»¥å°† runID è®¾ä¸ºâ€œï¼Ÿâ€ã€‚offsetï¼Œæ­¤æ—¶è®¾ä¸º -1ï¼Œè¡¨ç¤ºç¬¬ä¸€æ¬¡å¤åˆ¶ã€‚ä¸»åº“æ”¶åˆ° psync å‘½ä»¤åï¼Œä¼šç”¨ FULLRESYNC å“åº”å‘½ä»¤å¸¦ä¸Šä¸¤ä¸ªå‚æ•°ï¼šä¸»åº“ runID å’Œä¸»åº“ç›®å‰çš„å¤åˆ¶è¿›åº¦ offsetï¼Œè¿”å›ç»™ä»åº“ã€‚ä»åº“æ”¶åˆ°å“åº”åï¼Œä¼šè®°å½•ä¸‹è¿™ä¸¤ä¸ªå‚æ•°ã€‚è¿™é‡Œæœ‰ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ï¼ŒFULLRESYNC å“åº”è¡¨ç¤ºç¬¬ä¸€æ¬¡å¤åˆ¶é‡‡ç”¨çš„å…¨é‡å¤åˆ¶ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸»åº“ä¼šæŠŠå½“å‰æ‰€æœ‰çš„æ•°æ®éƒ½å¤åˆ¶ç»™ä»åº“ã€‚</p>\n</blockquote>\n<p>ç¬¬äºŒé˜¶æ®µï¼Œä¸»åº“å°†æ‰€æœ‰æ•°æ®åŒæ­¥ç»™ä»åº“ã€‚ä»åº“æ”¶åˆ°æ•°æ®åï¼Œåœ¨æœ¬åœ°å®Œæˆæ•°æ®åŠ è½½ã€‚è¿™ä¸ªè¿‡ç¨‹ä¾èµ–äºå†…å­˜å¿«ç…§ç”Ÿæˆçš„ RDB æ–‡ä»¶ã€‚</p>\n<blockquote>\n<p>å…·ä½“æ¥è¯´ï¼Œä¸»åº“æ‰§è¡Œ bgsave å‘½ä»¤ï¼Œç”Ÿæˆ RDB æ–‡ä»¶ï¼Œæ¥ç€å°†æ–‡ä»¶å‘ç»™ä»åº“ã€‚ä»åº“æ¥æ”¶åˆ° RDB æ–‡ä»¶åï¼Œä¼šå…ˆæ¸…ç©ºå½“å‰æ•°æ®åº“ï¼Œç„¶ååŠ è½½ RDB æ–‡ä»¶ã€‚è¿™æ˜¯å› ä¸ºä»åº“åœ¨é€šè¿‡ replicaof å‘½ä»¤å¼€å§‹å’Œä¸»åº“åŒæ­¥å‰ï¼Œå¯èƒ½ä¿å­˜äº†å…¶ä»–æ•°æ®ã€‚ä¸ºäº†é¿å…ä¹‹å‰æ•°æ®çš„å½±å“ï¼Œä»åº“éœ€è¦å…ˆæŠŠå½“å‰æ•°æ®åº“æ¸…ç©ºã€‚åœ¨ä¸»åº“å°†æ•°æ®åŒæ­¥ç»™ä»åº“çš„è¿‡ç¨‹ä¸­ï¼Œä¸»åº“ä¸ä¼šè¢«é˜»å¡ï¼Œä»ç„¶å¯ä»¥æ­£å¸¸æ¥æ”¶è¯·æ±‚ã€‚å¦åˆ™ï¼ŒRedis çš„æœåŠ¡å°±è¢«ä¸­æ–­äº†ã€‚ä½†æ˜¯ï¼Œè¿™äº›è¯·æ±‚ä¸­çš„å†™æ“ä½œå¹¶æ²¡æœ‰è®°å½•åˆ°åˆšåˆšç”Ÿæˆçš„ RDB æ–‡ä»¶ä¸­ã€‚ä¸ºäº†ä¿è¯ä¸»ä»åº“çš„æ•°æ®ä¸€è‡´æ€§ï¼Œä¸»åº“ä¼šåœ¨å†…å­˜ä¸­ç”¨ä¸“é—¨çš„ replication bufferï¼Œè®°å½• RDB æ–‡ä»¶ç”Ÿæˆåæ”¶åˆ°çš„æ‰€æœ‰å†™æ“ä½œã€‚</p>\n</blockquote>\n<p>ç¬¬ä¸‰ä¸ªé˜¶æ®µï¼Œä¸»åº“ä¼šæŠŠç¬¬äºŒé˜¶æ®µæ‰§è¡Œè¿‡ç¨‹ä¸­æ–°æ”¶åˆ°çš„å†™å‘½ä»¤ï¼Œå†å‘é€ç»™ä»åº“ã€‚</p>\n<blockquote>\n<p>å…·ä½“çš„æ“ä½œæ˜¯ï¼Œå½“ä¸»åº“å®Œæˆ RDB æ–‡ä»¶å‘é€åï¼Œå°±ä¼šæŠŠæ­¤æ—¶ replication buffer ä¸­çš„ä¿®æ”¹æ“ä½œå‘ç»™ä»åº“ï¼Œä»åº“å†é‡æ–°æ‰§è¡Œè¿™äº›æ“ä½œã€‚è¿™æ ·ä¸€æ¥ï¼Œä¸»ä»åº“å°±å®ç°åŒæ­¥äº†ã€‚</p>\n</blockquote>\n<h3 id=\"æ–­ç½‘å¢é‡æ›´æ–°\"><a href=\"#æ–­ç½‘å¢é‡æ›´æ–°\" class=\"headerlink\" title=\"æ–­ç½‘å¢é‡æ›´æ–°\"></a>æ–­ç½‘å¢é‡æ›´æ–°</h3><p>å½“ä¸»ä»åº“æ–­è¿åï¼Œä¸»åº“ä¼šæŠŠæ–­è¿æœŸé—´æ”¶åˆ°çš„å†™æ“ä½œå‘½ä»¤ï¼Œå†™å…¥ replication bufferï¼ŒåŒæ—¶ä¹Ÿä¼šæŠŠè¿™äº›æ“ä½œå‘½ä»¤ä¹Ÿå†™å…¥ repl_backlog_buffer è¿™ä¸ªç¼“å†²åŒºã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotesg0eezljwqy.jpeg\" alt=\"æ–­ç½‘å¢é‡æ›´æ–°\"></p>\n<h2 id=\"å“¨å…µæœºåˆ¶\"><a href=\"#å“¨å…µæœºåˆ¶\" class=\"headerlink\" title=\"å“¨å…µæœºåˆ¶\"></a>å“¨å…µæœºåˆ¶</h2><blockquote>\n<p>å“¨å…µçš„æ ¸å¿ƒåŠŸèƒ½æ˜¯ä¸»èŠ‚ç‚¹çš„è‡ªåŠ¨æ•…éšœè½¬ç§»</p>\n<ol>\n<li>ç›‘æ§ ä¸»åº“ï¼Œåˆ¤æ–­ ä¸»åº“ æ˜¯å¦å®•æœº</li>\n<li>ä¸»åº“ å¦‚æœå®•æœºï¼Œåˆ™ä» ä»åº“ ä¸­ é€‰ä¸¾æˆä¸º ä¸»åº“ï¼ˆå› æ­¤éœ€è¦å¥‡æ•°ä¸ªå“¨å…µï¼‰</li>\n<li>æ›´æ”¹ä¸»ä»é…ç½®</li>\n</ol>\n</blockquote>\n<p>ä¸‹å›¾æ˜¯ä¸€ä¸ªå…¸å‹çš„å“¨å…µé›†ç¾¤ç›‘æ§çš„é€»è¾‘å›¾ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650420977306.png\" alt=\"å“¨å…µæœºåˆ¶\"></p>\n<p><img src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\" alt=\"å›¾ç‰‡\"></p>\n<p>Redis Sentinel åŒ…å«äº†è‹¥ä¸ª Sentinel èŠ‚ç‚¹ï¼Œè¿™æ ·åšä¹Ÿå¸¦æ¥äº†ä¸¤ä¸ªå¥½å¤„ï¼š</p>\n<ol>\n<li>å¯¹äºèŠ‚ç‚¹çš„æ•…éšœåˆ¤æ–­æ˜¯ç”±å¤šä¸ª Sentinel èŠ‚ç‚¹å…±åŒå®Œæˆï¼Œè¿™æ ·å¯ä»¥æœ‰æ•ˆåœ°é˜²æ­¢è¯¯åˆ¤</li>\n<li>å³ä½¿ä¸ªåˆ« Sentinel èŠ‚ç‚¹ä¸å¯ç”¨ï¼Œæ•´ä¸ª Sentinel é›†ç¾¤ä¾ç„¶æ˜¯å¯ç”¨çš„ã€‚</li>\n</ol>\n<p>å“¨å…µå®ç°äº†ä»¥ä¸‹åŠŸèƒ½</p>\n<ol>\n<li>ç›‘æ§ï¼šæ¯ä¸ª Sentinel èŠ‚ç‚¹ä¼šå¯¹æ•°æ®èŠ‚ç‚¹ï¼ˆRedis master&#x2F;slave èŠ‚ç‚¹ï¼‰å’Œå…¶ä½™ Sentinel èŠ‚ç‚¹è¿›è¡Œç›‘æ§</li>\n<li>é€šçŸ¥ï¼šSentinel èŠ‚ç‚¹ä¼šå°†æ•…éšœè½¬ç§»çš„ç»“æœé€šçŸ¥ç»™åº”ç”¨æ–¹</li>\n<li>æ•…éšœè½¬ç§»ï¼šå®ç° slave æ™‹å‡ä¸º masterï¼Œå¹¶ç»´æŠ¤åç»­æ­£ç¡®çš„ä¸»ä»å…³ç³»</li>\n<li>é…ç½®ä¸­å¿ƒï¼šåœ¨ Redis Sentinel æ¨¡å¼ä¸­ï¼Œå®¢æˆ·ç«¯åœ¨åˆå§‹åŒ–çš„æ—¶å€™è¿æ¥çš„æ˜¯ Sentinel èŠ‚ç‚¹é›†åˆï¼Œä»ä¸­è·å–ä¸»èŠ‚ç‚¹ä¿¡æ¯</li>\n</ol>\n<p>å…¶ä¸­ï¼Œç›‘æ§å’Œè‡ªåŠ¨æ•…éšœè½¬ç§»åŠŸèƒ½ï¼Œä½¿å¾—å“¨å…µå¯ä»¥åŠæ—¶å‘ç°ä¸»èŠ‚ç‚¹æ•…éšœå¹¶å®Œæˆè½¬ç§»ï¼›è€Œé…ç½®ä¸­å¿ƒå’Œé€šçŸ¥åŠŸèƒ½ï¼Œåˆ™éœ€è¦åœ¨ä¸å®¢æˆ·ç«¯çš„äº¤äº’ä¸­æ‰èƒ½ä½“ç°ã€‚</p>\n<h3 id=\"ç›‘æ§\"><a href=\"#ç›‘æ§\" class=\"headerlink\" title=\"ç›‘æ§\"></a>ç›‘æ§</h3><p>Sentinel èŠ‚ç‚¹éœ€è¦ç›‘æ§ masterã€slave ä»¥åŠå…¶å®ƒ Sentinel èŠ‚ç‚¹çš„çŠ¶æ€ã€‚è¿™ä¸€è¿‡ç¨‹æ˜¯é€šè¿‡ Redis çš„ pub&#x2F;sub ç³»ç»Ÿå®ç°çš„ã€‚Redis Sentinel ä¸€å…±æœ‰ä¸‰ä¸ªå®šæ—¶ç›‘æ§ä»»åŠ¡ï¼Œå®Œæˆå¯¹å„ä¸ªèŠ‚ç‚¹å‘ç°å’Œç›‘æ§ï¼š</p>\n<ol>\n<li>ç›‘æ§ä¸»ä»æ‹“æ‰‘ä¿¡æ¯ï¼šæ¯éš” 10 ç§’ï¼Œæ¯ä¸ª Sentinel èŠ‚ç‚¹ï¼Œä¼šå‘ master å’Œ slave å‘é€ INFO å‘½ä»¤è·å–æœ€æ–°çš„æ‹“æ‰‘ç»“æ„</li>\n<li>Sentinel èŠ‚ç‚¹ä¿¡æ¯äº¤æ¢ï¼šæ¯éš” 2 ç§’ï¼Œæ¯ä¸ª Sentinel èŠ‚ç‚¹ï¼Œä¼šå‘ Redis æ•°æ®èŠ‚ç‚¹çš„<code>sentinel:hello</code> é¢‘é“ä¸Šï¼Œå‘é€è‡ªèº«çš„ä¿¡æ¯ï¼Œä»¥åŠå¯¹ä¸»èŠ‚ç‚¹çš„åˆ¤æ–­ä¿¡æ¯ã€‚è¿™æ ·ï¼ŒSentinel èŠ‚ç‚¹ä¹‹é—´å°±å¯ä»¥äº¤æ¢ä¿¡æ¯</li>\n<li>èŠ‚ç‚¹çŠ¶æ€ç›‘æ§ï¼šæ¯éš” 1 ç§’ï¼Œæ¯ä¸ª Sentinel èŠ‚ç‚¹ï¼Œä¼šå‘ masterã€slaveã€å…¶ä½™ Sentinel èŠ‚ç‚¹å‘é€ PING å‘½ä»¤åšå¿ƒè·³æ£€æµ‹ï¼Œæ¥ç¡®è®¤è¿™äº›èŠ‚ç‚¹å½“å‰æ˜¯å¦å¯è¾¾</li>\n</ol>\n<h3 id=\"ä¸»è§‚-x2F-å®¢è§‚ä¸‹çº¿\"><a href=\"#ä¸»è§‚-x2F-å®¢è§‚ä¸‹çº¿\" class=\"headerlink\" title=\"ä¸»è§‚&#x2F;å®¢è§‚ä¸‹çº¿\"></a>ä¸»è§‚&#x2F;å®¢è§‚ä¸‹çº¿</h3><h4 id=\"ä¸»è§‚ä¸‹çº¿\"><a href=\"#ä¸»è§‚ä¸‹çº¿\" class=\"headerlink\" title=\"ä¸»è§‚ä¸‹çº¿\"></a>ä¸»è§‚ä¸‹çº¿</h4><p>æ¯ä¸ª Sentinel èŠ‚ç‚¹ï¼Œæ¯éš” 1 ç§’ä¼šå¯¹æ•°æ®èŠ‚ç‚¹å‘é€ ping å‘½ä»¤åšå¿ƒè·³æ£€æµ‹ï¼Œå½“è¿™äº›èŠ‚ç‚¹è¶…è¿‡ down-after-milliseconds æ²¡æœ‰è¿›è¡Œæœ‰æ•ˆå›å¤æ—¶ï¼ŒSentinel èŠ‚ç‚¹ä¼šå¯¹è¯¥èŠ‚ç‚¹åšå¤±è´¥åˆ¤å®šï¼Œè¿™ä¸ªè¡Œä¸ºå«åšä¸»è§‚ä¸‹çº¿ã€‚</p>\n<h4 id=\"å®¢è§‚ä¸‹çº¿\"><a href=\"#å®¢è§‚ä¸‹çº¿\" class=\"headerlink\" title=\"å®¢è§‚ä¸‹çº¿\"></a>å®¢è§‚ä¸‹çº¿</h4><p>å®¢è§‚ä¸‹çº¿ï¼Œæ˜¯æŒ‡å½“å¤§å¤šæ•° Sentinel èŠ‚ç‚¹ï¼Œéƒ½è®¤ä¸º master èŠ‚ç‚¹å®•æœºäº†ï¼Œé‚£ä¹ˆè¿™ä¸ªåˆ¤å®šå°±æ˜¯å®¢è§‚çš„ï¼Œå«åšå®¢è§‚ä¸‹çº¿ã€‚</p>\n<p>é‚£ä¹ˆè¿™ä¸ªå¤§å¤šæ•°æ˜¯æŒ‡å¤šå°‘å‘¢ï¼Ÿè¿™å…¶å®å°±æ˜¯åˆ†å¸ƒå¼åè°ƒä¸­çš„ quorum åˆ¤å®šäº†ï¼Œå¤§å¤šæ•°å°±æ˜¯è¿‡åŠæ•°ï¼Œæ¯”å¦‚å“¨å…µæ•°é‡æ˜¯ 5ï¼Œé‚£ä¹ˆå¤§å¤šæ•°å°±æ˜¯ 5&#x2F;2+1&#x3D;3 ä¸ªï¼Œå“¨å…µæ•°é‡æ˜¯ 10 å¤§å¤šæ•°å°±æ˜¯ 10&#x2F;2+1&#x3D;6 ä¸ªã€‚</p>\n<p>æ³¨ï¼šSentinel èŠ‚ç‚¹çš„æ•°é‡è‡³å°‘ä¸º 3 ä¸ªï¼Œå¦åˆ™ä¸æ»¡è¶³ quorum åˆ¤å®šæ¡ä»¶ã€‚</p>\n<h3 id=\"å“¨å…µé€‰ä¸¾\"><a href=\"#å“¨å…µé€‰ä¸¾\" class=\"headerlink\" title=\"å“¨å…µé€‰ä¸¾\"></a>å“¨å…µé€‰ä¸¾</h3><p>å¦‚æœå‘ç”Ÿäº†å®¢è§‚ä¸‹çº¿ï¼Œé‚£ä¹ˆå“¨å…µèŠ‚ç‚¹ä¼šé€‰ä¸¾å‡ºä¸€ä¸ª Leader æ¥è¿›è¡Œå®é™…çš„æ•…éšœè½¬ç§»å·¥ä½œã€‚Redis ä½¿ç”¨äº† Raft ç®—æ³•æ¥å®ç°å“¨å…µé¢†å¯¼è€…é€‰ä¸¾ï¼Œå¤§è‡´æ€è·¯å¦‚ä¸‹ï¼š</p>\n<ol>\n<li>æ¯ä¸ª Sentinel èŠ‚ç‚¹éƒ½æœ‰èµ„æ ¼æˆä¸ºé¢†å¯¼è€…ï¼Œå½“å®ƒä¸»è§‚è®¤ä¸ºæŸä¸ªæ•°æ®èŠ‚ç‚¹å®•æœºåï¼Œä¼šå‘å…¶ä»– Sentinel èŠ‚ç‚¹å‘é€ sentinel is-master-down-by-addr å‘½ä»¤ï¼Œè¦æ±‚è‡ªå·±æˆä¸ºé¢†å¯¼è€…ï¼›</li>\n<li>æ”¶åˆ°å‘½ä»¤çš„ Sentinel èŠ‚ç‚¹ï¼Œå¦‚æœæ²¡æœ‰åŒæ„è¿‡å…¶ä»– Sentinel èŠ‚ç‚¹çš„ sentinelis-master-down-by-addr å‘½ä»¤ï¼Œå°†åŒæ„è¯¥è¯·æ±‚ï¼Œå¦åˆ™æ‹’ç»ï¼ˆæ¯ä¸ª Sentinel èŠ‚ç‚¹åªæœ‰ 1 ç¥¨ï¼‰ï¼›</li>\n<li>å¦‚æœè¯¥ Sentinel èŠ‚ç‚¹å‘ç°è‡ªå·±çš„ç¥¨æ•°å·²ç»å¤§äºç­‰äº MAX(quorum, num(sentinels)&#x2F;2+1)ï¼Œé‚£ä¹ˆå®ƒå°†æˆä¸ºé¢†å¯¼è€…ï¼›</li>\n<li>å¦‚æœæ­¤è¿‡ç¨‹æ²¡æœ‰é€‰ä¸¾å‡ºé¢†å¯¼è€…ï¼Œå°†è¿›å…¥ä¸‹ä¸€æ¬¡é€‰ä¸¾ã€‚</li>\n</ol>\n<h3 id=\"æ•…éšœè½¬ç§»\"><a href=\"#æ•…éšœè½¬ç§»\" class=\"headerlink\" title=\"æ•…éšœè½¬ç§»\"></a><strong>æ•…éšœè½¬ç§»</strong></h3><p>é€‰ä¸¾å‡ºçš„ Leader Sentinel èŠ‚ç‚¹å°†è´Ÿè´£æ•…éšœè½¬ç§»ï¼Œä¹Ÿå°±æ˜¯è¿›è¡Œ master&#x2F;slave èŠ‚ç‚¹çš„ä¸»ä»åˆ‡æ¢ã€‚æ•…éšœè½¬ç§»ï¼Œé¦–å…ˆè¦ä» slave èŠ‚ç‚¹ä¸­ç­›é€‰å‡ºä¸€ä¸ªä½œä¸ºæ–°çš„ masterï¼Œä¸»è¦è€ƒè™‘ä»¥ä¸‹ slave ä¿¡æ¯ï¼š</p>\n<ol>\n<li>è·Ÿ master æ–­å¼€è¿æ¥çš„æ—¶é•¿ï¼šå¦‚æœä¸€ä¸ª slave è·Ÿ master çš„æ–­å¼€è¿æ¥æ—¶é•¿å·²ç»è¶…è¿‡äº† down-after-milliseconds çš„ 10 å€ï¼Œå¤–åŠ  master å®•æœºçš„æ—¶é•¿ï¼Œé‚£ä¹ˆè¯¥ slave å°±è¢«è®¤ä¸ºä¸é€‚åˆé€‰ä¸¾ä¸º masterï¼›</li>\n<li>slave çš„ä¼˜å…ˆçº§é…ç½®ï¼šslave priority å‚æ•°å€¼è¶Šå°ï¼Œä¼˜å…ˆçº§å°±è¶Šé«˜ï¼›</li>\n<li>å¤åˆ¶ offsetï¼šå½“ä¼˜å…ˆçº§ç›¸åŒæ—¶ï¼Œå“ªä¸ª slave å¤åˆ¶äº†è¶Šå¤šçš„æ•°æ®ï¼ˆoffset è¶Šé åï¼‰ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼›</li>\n<li>run idï¼šå¦‚æœ offset å’Œä¼˜å…ˆçº§éƒ½ç›¸åŒï¼Œåˆ™å“ªä¸ª slave çš„ run id è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜ã€‚</li>\n</ol>\n<p>æ¥ç€ï¼Œç­›é€‰å®Œ slave åï¼Œ ä¼šå¯¹å®ƒæ‰§è¡Œ slaveof no one å‘½ä»¤ï¼Œè®©å…¶æˆä¸ºä¸»èŠ‚ç‚¹ã€‚</p>\n<p>æœ€åï¼ŒSentinel é¢†å¯¼è€…èŠ‚ç‚¹ä¼šå‘å‰©ä½™çš„ slave èŠ‚ç‚¹å‘é€å‘½ä»¤ï¼Œè®©å®ƒä»¬æˆä¸ºæ–°çš„ master èŠ‚ç‚¹çš„ä»èŠ‚ç‚¹ï¼Œå¤åˆ¶è§„åˆ™ä¸ parallel-syncs å‚æ•°æœ‰å…³ã€‚</p>\n<p>Sentinel èŠ‚ç‚¹é›†åˆä¼šå°†åŸæ¥çš„ master èŠ‚ç‚¹æ›´æ–°ä¸º slave èŠ‚ç‚¹ï¼Œå¹¶ä¿æŒç€å¯¹å…¶å…³æ³¨ï¼Œå½“å…¶æ¢å¤åå‘½ä»¤å®ƒå»å¤åˆ¶æ–°çš„ä¸»èŠ‚ç‚¹ã€‚</p>\n<p>æ³¨ï¼šLeader Sentinel èŠ‚ç‚¹ï¼Œä¼šä»æ–°çš„ master èŠ‚ç‚¹é‚£é‡Œå¾—åˆ°ä¸€ä¸ª configuration epochï¼Œæœ¬è´¨æ˜¯ä¸ª version ç‰ˆæœ¬å·ï¼Œæ¯æ¬¡ä¸»ä»åˆ‡æ¢çš„ version å·éƒ½å¿…é¡»æ˜¯å”¯ä¸€çš„ã€‚å…¶ä»–çš„å“¨å…µéƒ½æ˜¯æ ¹æ® version æ¥æ›´æ–°è‡ªå·±çš„ master é…ç½®ã€‚</p>\n<h2 id=\"é›†ç¾¤é…ç½®\"><a href=\"#é›†ç¾¤é…ç½®\" class=\"headerlink\" title=\"é›†ç¾¤é…ç½®\"></a>é›†ç¾¤é…ç½®</h2><blockquote>\n<p>é«˜å¯ç”¨ï¼šä¿è¯ Redis ä¸€ç›´å¤„äºå¯ç”¨çŠ¶æ€ï¼Œå³ä½¿å‡ºç°äº†æ•…éšœä¹Ÿæœ‰å¤‡ç”¨æ–¹æ¡ˆä¿è¯å¯ç”¨æ€§</p>\n<p>é«˜å¹¶å‘ï¼šä¸€ä¸ª Redis å®ä¾‹å·²ç»å¯ä»¥æ”¯æŒå¤šè¾¾ 11wå¹¶å‘è¯»æ“ä½œæˆ– 8.1wå¹¶å‘å†™æ“ä½œï¼›ä½†æ˜¯å¦‚æœæœ‰æ›´é«˜å¹¶å‘éœ€æ±‚çš„åº”ç”¨æ¥è¯´ï¼Œå¯ä»¥é€šè¿‡ è¯»å†™åˆ†ç¦»ã€é›†ç¾¤é…ç½® æ¥è§£å†³é«˜å¹¶å‘é—®é¢˜</p>\n</blockquote>\n<ul>\n<li>Redis é›†ç¾¤ä¸­æ¯ä¸ªèŠ‚ç‚¹æ˜¯å¯¹ç­‰çš„ï¼Œæ— ä¸­å¿ƒç»“æ„</li>\n<li>æ•°æ®æŒ‰ç…§ slots åˆ†å¸ƒå¼å­˜å‚¨åœ¨ä¸åŒçš„ Redis èŠ‚ç‚¹ä¸Šï¼ŒèŠ‚ç‚¹ä¸­çš„æ•°æ®å¯å…±äº«ï¼Œå¯ä»¥åŠ¨æ€è°ƒæ•´æ•°æ®åˆ†å¸ƒ</li>\n<li>å¯æ‰©å±•æ€§å¼ºï¼Œå¯ä»¥åŠ¨æ€å¢åˆ èŠ‚ç‚¹ï¼Œæœ€å¤šå¯æ‰©å±•è‡³ 1000+ èŠ‚ç‚¹</li>\n<li>é›†ç¾¤çš„æ¯ä¸ªèŠ‚ç‚¹é€šè¿‡ <code>ä¸»ä»ï¼ˆå“¨å…µæ¨¡å¼ï¼‰</code>ä¿è¯å…¶é«˜å¯ç”¨æ€§</li>\n<li>Redis å¹¶ä¸èƒ½ä¿è¯æ•°æ®çš„å¼ºä¸€è‡´æ€§ï¼Œè¿™æ„å‘³è¿™åœ¨å®é™…ä¸­é›†ç¾¤åœ¨ç‰¹å®šçš„æ¡ä»¶ä¸‹å¯èƒ½ä¼šä¸¢å¤±å†™æ“ä½œ</li>\n<li>Redis é›†ç¾¤ä¹‹é—´æ˜¯å¦‚ä½•å¤åˆ¶çš„ï¼Ÿå¼‚æ­¥å¤åˆ¶</li>\n</ul>\n<blockquote>\n<p><a href=\"https://blog.csdn.net/qq_43846090/article/details/123721066\">Redis_æ•°æ®åˆ†å¸ƒç®—æ³•ï¼šä¼ ç»Ÿå“ˆå¸Œ-ä¸€è‡´æ€§å“ˆå¸Œ-å“ˆå¸Œslot</a></p>\n</blockquote>\n<h3 id=\"ä¼ ç»Ÿå“ˆå¸Œ\"><a href=\"#ä¼ ç»Ÿå“ˆå¸Œ\" class=\"headerlink\" title=\"ä¼ ç»Ÿå“ˆå¸Œ\"></a>ä¼ ç»Ÿå“ˆå¸Œ</h3><p>æœ€ç®€å•çš„æ•°æ®åˆ†å¸ƒç®—æ³•ï¼Œå¯¹è¿›æ¥çš„ key è¿›è¡Œ hashï¼Œç„¶åå¯¹èŠ‚ç‚¹æ•°æ®è¿›è¡Œå–æ¨¡ï¼Œå°±çŸ¥é“åˆ†å¸ƒåˆ°å“ªä¸ªèŠ‚ç‚¹ä¸Šäº†ï¼›<br>ç¼ºç‚¹å°±æ˜¯: å¦‚æœä¸€ä¸ªèŠ‚ç‚¹å®•æœºï¼Œæ‰€æœ‰ç¼“å­˜çš„ä½ç½®éƒ½è¦å‘ç”Ÿæ”¹å˜ï¼Œå½“æœåŠ¡å™¨æ•°é‡å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰ç¼“å­˜åœ¨ä¸€å®šæ—¶é—´å†…æ˜¯å¤±æ•ˆçš„ï¼Œä¼šå¼•èµ·ç¼“å­˜çš„é›ªå´©ï¼Œå¯èƒ½ä¼šå¼•èµ·æ•´ä½“ç³»ç»Ÿå‹åŠ›è¿‡å¤§è€Œå´©æºƒï¼ˆå¤§é‡ç¼“å­˜åŒä¸€æ—¶é—´å¤±æ•ˆï¼‰</p>\n<h3 id=\"ä¸€è‡´æ€§å“ˆå¸Œ\"><a href=\"#ä¸€è‡´æ€§å“ˆå¸Œ\" class=\"headerlink\" title=\"ä¸€è‡´æ€§å“ˆå¸Œ\"></a>ä¸€è‡´æ€§å“ˆå¸Œ</h3><p>å®é™…ä¸Šå°±æ˜¯å¼•å…¥äº†ä¸€ä¸ªåœ†ç¯çš„æ¦‚å¿µï¼Œ è®©æ¯ä¸ªæ•°æ®çš„ hash åˆ†å¸ƒåˆ°æ•´ä¸ªåœ†ç¯ï¼Œç„¶åé¡ºæ—¶é’ˆå»æ‰¾ç¦»ä»–æœ€è¿‘çš„èŠ‚ç‚¹å­˜å‚¨</p>\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650525022243.png\" alt=\"ä¸€è‡´æ€§å“ˆå¸Œ\" style=\"zoom: 50%;\" />\n\n<p>hash ç®—æ³•çš„å–æ¨¡æ³•æ˜¯å¯¹æœåŠ¡å™¨çš„æ•°é‡è¿›è¡Œå–æ¨¡ï¼Œè€Œä¸€è‡´æ€§å“ˆå¸Œç®—æ³•æ˜¯å¯¹ 2^32 å–æ¨¡ï¼Œ<br>dubbo çš„å¤æ‚å‡è¡¡æœ‰ç”¨åˆ°è¯¥ç®—æ³•ï¼›</p>\n<p>å¥½å¤„:</p>\n<p>ä½¿ç”¨ hash ç®—æ³•ï¼ŒæœåŠ¡å™¨æ•°é‡å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰æœåŠ¡å™¨çš„æ‰€æœ‰ç¼“å­˜åœ¨åŒä¸€æ—¶é—´å¤±æ•ˆäº†ï¼›<br>è€Œä½¿ç”¨ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•æ—¶ï¼ŒæœåŠ¡å™¨çš„æ•°é‡å¦‚æœå‘ç”Ÿæ”¹å˜ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰ç¼“å­˜éƒ½ä¼šå¤±æ•ˆï¼Œè€Œæ˜¯åªæœ‰éƒ¨åˆ†ç¼“å­˜ä¼šå¤±æ•ˆã€‚ä¸Šå›¾ä¸­å¦‚æœèŠ‚ç‚¹ A å¤±æ•ˆï¼Œåˆ™ C â†’ A ä¹‹é—´çš„æ•°æ®ä¼šé‡æ–°ç¼“å­˜åˆ°èŠ‚ç‚¹ B ä¸Šã€‚</p>\n<p>hash ç¯åæ–œï¼š</p>\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650525154544.png\" alt=\"hash ç¯åæ–œ\" style=\"zoom: 50%;\" />\n\n<p>1 å·ã€2 å·ã€3 å·ã€4 å·ã€6 å·æ•°æ®å‡è¢«ç¼“å­˜åœ¨äº†æœåŠ¡å™¨ A ä¸Šï¼›åªæœ‰ 5 å·è¢«ç¼“å­˜åœ¨äº†æœåŠ¡å™¨ B ä¸Šï¼›æœåŠ¡å™¨ C ä¸Šç”šè‡³æ²¡æœ‰ç¼“å­˜ä»»ä½•å›¾ç‰‡<br>å¦‚æœå‡ºç°ä¸Šå›¾ä¸­çš„æƒ…å†µï¼ŒAã€Bã€C ä¸‰å°æœåŠ¡å™¨å¹¶æ²¡æœ‰è¢«åˆç†çš„å¹³å‡çš„å……åˆ†åˆ©ç”¨ï¼Œç¼“å­˜åˆ†å¸ƒçš„æåº¦ä¸å‡åŒ€ï¼Œè€Œä¸”ï¼Œå¦‚æœæ­¤æ—¶æœåŠ¡å™¨ A å‡ºç°æ•…éšœï¼Œé‚£ä¹ˆå¤±æ•ˆç¼“å­˜çš„æ•°é‡ä¹Ÿå°†è¾¾åˆ°æœ€å¤§å€¼ï¼Œåœ¨æç«¯æƒ…å†µä¸‹ï¼Œä»ç„¶æœ‰å¯èƒ½å¼•èµ·ç³»ç»Ÿçš„å´©æºƒï¼›</p>\n<p>ä¸Šå›¾ä¸­çš„æƒ…å†µåˆ™è¢«ç§°ä¹‹ä¸º hash ç¯çš„åæ–œ ï¼›<br>æˆ‘ä»¬åº”è¯¥æ€æ ·é˜²æ­¢ hash ç¯çš„åæ–œï¼Ÿ<br>å¢åŠ è™šæ‹ŸèŠ‚ç‚¹ï¼š</p>\n<img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes1650525203417.png\" alt=\"å¢åŠ è™šæ‹ŸèŠ‚ç‚¹é˜²æ­¢ hash ç¯çš„åæ–œ\" style=\"zoom:50%;\" />\n\n<p>ä¸ºäº†è§£å†³è¿™ä¸ªæ•°æ®è´Ÿè½½å‡è¡¡çš„é—®é¢˜ï¼Œæå‡ºæ¥è™šæ‹ŸèŠ‚ç‚¹ï¼ŒæŠŠçœŸå®èŠ‚ç‚¹æä¸€å †è™šæ‹ŸèŠ‚ç‚¹åˆ†å¸ƒåˆ°ç¯ï¼Œé‚£ä¹ˆæ•´ä¸ªåŒºé—´çš„æ•°æ®ä¼šè½åˆ°è¿™äº›è™šæ‹ŸèŠ‚ç‚¹ä¸Šï¼›</p>\n<p>è™šæ‹ŸèŠ‚ç‚¹è¶Šå¤šï¼Œhash ç¯ä¸Šçš„èŠ‚ç‚¹å°±è¶Šå¤šï¼Œç¼“å­˜è¢«å‡åŒ€åˆ†å¸ƒçš„æ¦‚ç‡å°±è¶Šå¤§ã€‚</p>\n<h3 id=\"å“ˆå¸Œæ§½\"><a href=\"#å“ˆå¸Œæ§½\" class=\"headerlink\" title=\"å“ˆå¸Œæ§½\"></a>å“ˆå¸Œæ§½</h3><p>Redis é›†ç¾¤ï¼ˆclusterï¼‰å¹¶æ²¡æœ‰é€‰ç”¨ä¸Šé¢ä¸€è‡´æ€§å“ˆå¸Œï¼Œè€Œæ˜¯é‡‡ç”¨äº†å“ˆå¸Œæ§½ï¼ˆslotï¼‰çš„è¿™ç§æ¦‚å¿µã€‚ä¸»è¦çš„åŸå› å°±æ˜¯ä¸Šé¢æ‰€è¯´çš„ï¼Œä¸€è‡´æ€§å“ˆå¸Œç®—æ³•å¯¹äºæ•°æ®åˆ†å¸ƒã€èŠ‚ç‚¹ä½ç½®çš„æ§åˆ¶å¹¶ä¸æ˜¯å¾ˆå‹å¥½ã€‚</p>\n<p>é¦–å…ˆå“ˆå¸Œæ§½å…¶å®æ˜¯ä¸¤ä¸ªæ¦‚å¿µï¼Œç¬¬ä¸€ä¸ªæ˜¯å“ˆå¸Œç®—æ³•ã€‚Redis cluster çš„ hash ç®—æ³•ä¸æ˜¯ç®€å•çš„ hash()ï¼Œè€Œæ˜¯ crc16 ç®—æ³•ï¼Œä¸€ç§æ ¡éªŒç®—æ³•ã€‚å¦å¤–ä¸€ä¸ªå°±æ˜¯æ§½ä½çš„æ¦‚å¿µï¼Œç©ºé—´åˆ†é…çš„è§„åˆ™ã€‚å…¶å®å“ˆå¸Œæ§½çš„æœ¬è´¨å’Œä¸€è‡´æ€§å“ˆå¸Œç®—æ³•éå¸¸ç›¸ä¼¼ï¼Œä¸åŒç‚¹å°±æ˜¯å¯¹äºå“ˆå¸Œç©ºé—´çš„å®šä¹‰ã€‚ä¸€è‡´æ€§å“ˆå¸Œçš„ç©ºé—´æ˜¯ä¸€ä¸ªåœ†ç¯ï¼ŒèŠ‚ç‚¹åˆ†å¸ƒæ˜¯åŸºäºåœ†ç¯çš„ï¼Œæ— æ³•å¾ˆå¥½çš„æ§åˆ¶æ•°æ®åˆ†å¸ƒã€‚è€Œ Redis cluster çš„æ§½ä½ç©ºé—´æ˜¯è‡ªå®šä¹‰åˆ†é…çš„ï¼Œç±»ä¼¼äº windows ç›˜åˆ†åŒºçš„æ¦‚å¿µã€‚è¿™ç§åˆ†åŒºæ˜¯å¯ä»¥è‡ªå®šä¹‰å¤§å°ï¼Œè‡ªå®šä¹‰ä½ç½®çš„ã€‚</p>\n<p>Redis cluster åŒ…å«äº† 16384 ä¸ªå“ˆå¸Œæ§½ï¼Œæ¯ä¸ª key é€šè¿‡è®¡ç®—åéƒ½ä¼šè½åœ¨å…·ä½“ä¸€ä¸ªæ§½ä½ä¸Šï¼Œè€Œè¿™ä¸ªæ§½ä½æ˜¯å±äºå“ªä¸ªå­˜å‚¨èŠ‚ç‚¹çš„ï¼Œåˆ™ç”±ç”¨æˆ·è‡ªå·±å®šä¹‰åˆ†é…ã€‚ä¾‹å¦‚æœºå™¨ç¡¬ç›˜å°çš„ï¼Œå¯ä»¥åˆ†é…å°‘ä¸€ç‚¹æ§½ä½ï¼Œç¡¬ç›˜å¤§çš„å¯ä»¥åˆ†é…å¤šä¸€ç‚¹ã€‚å¦‚æœèŠ‚ç‚¹ç¡¬ç›˜éƒ½å·®ä¸å¤šåˆ™å¯ä»¥å¹³å‡åˆ†é…ã€‚æ‰€ä»¥å“ˆå¸Œæ§½è¿™ç§æ¦‚å¿µå¾ˆå¥½åœ°è§£å†³äº†ä¸€è‡´æ€§å“ˆå¸Œçš„å¼Šç«¯ã€‚</p>\n<p><strong>ä¸ºä»€ä¹ˆå“ˆå¸Œæ§½çš„å¤§å°æ˜¯å›ºå®šçš„16384ï¼Ÿ</strong></p>\n<blockquote>\n<p><code>CRC16</code>ç®—æ³•äº§ç”Ÿçš„hashå€¼æœ‰16bitï¼Œè¯¥ç®—æ³•å¯ä»¥äº§ç”Ÿ2^16-&#x3D;65536ä¸ªå€¼ã€‚æ¢å¥è¯è¯´ï¼Œå€¼æ˜¯åˆ†å¸ƒåœ¨0~65535ä¹‹é—´ã€‚é‚£ä½œè€…åœ¨åš<code>mod</code>è¿ç®—çš„æ—¶å€™ï¼Œä¸ºä»€ä¹ˆä¸<code>mod</code>65536ï¼Œè€Œé€‰æ‹©<code>mod</code>16384ï¼Ÿ</p>\n</blockquote>\n<p><strong>ä¸èƒ½å¤ªå¤§ï¼Œä¸»è¦ä»èŠ‚ç‚¹é—´çš„é€šä¿¡æ€§èƒ½æ–¹é¢è€ƒè™‘ï¼š</strong></p>\n<p>æ¯ä¸ªèŠ‚ç‚¹ä¹‹é—´æ˜¯éœ€è¦è¿›è¡Œä¸€ä¸ªé€šä¿¡çš„ï¼Œä¹Ÿå°±æ˜¯ä¸æ–­åœ° pingpong æœºåˆ¶ï¼Œè®©æ¯ä¸ªèŠ‚ç‚¹è¿æ¥å¯¹æ–¹çš„ä¿¡æ¯ï¼›å‘é€çš„æ¶ˆæ¯å¤´ä¸­æœ‰ä¸€ä¸ª bitmapï¼Œå…¶ä¸­æ¯ä¸€ä½ä»£è¡¨ä¸€ä¸ªæ§½ï¼Œå¦‚æœè¯¥ä½ä¸º 1ï¼Œè¡¨ç¤ºè¿™ä¸ªæ§½æ˜¯å±äºå½“å‰èŠ‚ç‚¹ï¼Œå¦‚æœæ§½ä½è¿‡å¤§ï¼Œé‚£ä¹ˆè¿™ä¸ª bitmap å°±ä¼šå¤ªå¤§ï¼Œå¿ƒè·³åŒ…è¿‡äºåºå¤§ï¼Œæµªè´¹å¸¦å®½ã€‚</p>\n<p><strong>ä¸èƒ½å¤ªå°ï¼Œä¸»è¦ä»å‹ç¼©ç‡æ–¹é¢è€ƒè™‘ï¼š</strong></p>\n<p>ç”±äº bitmap åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ä¼šè¿›è¡Œå‹ç¼©ï¼Œbitmap çš„å¡«å……ç‡ç”¨ slots&#x2F;N è¡¨ç¤ºï¼ˆN å³èŠ‚ç‚¹æ•°ï¼‰ï¼Œå¯¹äºåŒæ ·çš„ slotsï¼Œå¦‚æœ N å¤ªå°ï¼Œå¯¼è‡´å…¶å¡«å……ç‡è¿‡é«˜ï¼Œå‹ç¼©ç‡å°±å¾ˆä½ã€‚</p>\n<hr>\n<h2 id=\"ç¼“å­˜ç©¿é€ã€å‡»ç©¿ã€é›ªå´©\"><a href=\"#ç¼“å­˜ç©¿é€ã€å‡»ç©¿ã€é›ªå´©\" class=\"headerlink\" title=\"ç¼“å­˜ç©¿é€ã€å‡»ç©¿ã€é›ªå´©\"></a>ç¼“å­˜ç©¿é€ã€å‡»ç©¿ã€é›ªå´©</h2><h3 id=\"ç¼“å­˜ç©¿é€\"><a href=\"#ç¼“å­˜ç©¿é€\" class=\"headerlink\" title=\"ç¼“å­˜ç©¿é€\"></a>ç¼“å­˜ç©¿é€</h3><p><strong>é—®é¢˜æ¥æº</strong></p>\n<p>ç¼“å­˜ç©¿é€æ˜¯æŒ‡ç¼“å­˜å’Œæ•°æ®åº“ä¸­éƒ½æ²¡æœ‰çš„æ•°æ®ï¼Œè€Œç”¨æˆ·ä¸æ–­å‘èµ·è¯·æ±‚ã€‚ç”±äºç¼“å­˜æ˜¯ä¸å‘½ä¸­æ—¶è¢«åŠ¨å†™çš„ï¼Œå¹¶ä¸”å‡ºäºå®¹é”™è€ƒè™‘ï¼Œå¦‚æœä»å­˜å‚¨å±‚æŸ¥ä¸åˆ°æ•°æ®åˆ™ä¸å†™å…¥ç¼“å­˜ï¼Œè¿™å°†å¯¼è‡´è¿™ä¸ªä¸å­˜åœ¨çš„æ•°æ®æ¯æ¬¡è¯·æ±‚éƒ½è¦åˆ°å­˜å‚¨å±‚å»æŸ¥è¯¢ï¼Œå¤±å»äº†ç¼“å­˜çš„æ„ä¹‰ã€‚åœ¨æµé‡å¤§æ—¶ï¼Œå¯èƒ½ DB å°±æŒ‚æ‰äº†ï¼Œè¦æ˜¯æœ‰äººåˆ©ç”¨ä¸å­˜åœ¨çš„ key é¢‘ç¹æ”»å‡»æˆ‘ä»¬çš„åº”ç”¨ï¼Œæ¯æ¬¡éƒ½å» DB åˆ¤æ–­ç„¶è€Œåˆä¸èƒ½å¤åˆ¶åˆ° Redis ä¸­ï¼Œè¿™å°±æ˜¯æ¼æ´ã€‚</p>\n<p>ä¾‹å¦‚å‘èµ·ä¸º id ä¸ºâ€œ-1â€çš„æ•°æ®æˆ– id ä¸ºç‰¹åˆ«å¤§ä¸å­˜åœ¨çš„æ•°æ®ã€‚è¿™æ—¶çš„ç”¨æˆ·å¾ˆå¯èƒ½æ˜¯æ”»å‡»è€…ï¼Œæ”»å‡»ä¼šå¯¼è‡´æ•°æ®åº“å‹åŠ›è¿‡å¤§ã€‚</p>\n<p><strong>è§£å†³æ–¹æ¡ˆ</strong></p>\n<ol>\n<li><p><strong>æ¥å£æ ¡éªŒ</strong>ï¼šæ¥å£å±‚å¢åŠ æ ¡éªŒï¼Œä¾‹å¦‚å¯¹ id&lt;&#x3D;0 çš„ç›´æ¥æ‹¦æˆªã€‚</p>\n</li>\n<li><p><strong>ç¼“å­˜ç©ºå€¼</strong>ï¼šä»ç¼“å­˜å–ä¸åˆ°çš„æ•°æ®ï¼Œåœ¨æ•°æ®åº“ä¸­ä¹Ÿæ²¡æœ‰å–åˆ°ï¼Œè¿™æ—¶ä¹Ÿå¯ä»¥å°† key-value å¯¹å†™ä¸º key-nullï¼Œç¼“å­˜æœ‰æ•ˆæ—¶é—´å¯ä»¥è®¾ç½®çŸ­ç‚¹ï¼Œå¦‚ 10 ç§’ï¼ˆè®¾ç½®å¤ªé•¿ä¼šå¯¼è‡´æ­£å¸¸æƒ…å†µä¹Ÿæ²¡æ³•ä½¿ç”¨ï¼‰ã€‚</p>\n</li>\n<li><p><strong>å¸ƒéš†è¿‡æ»¤å™¨</strong>ï¼šå¸ƒéš†è¿‡æ»¤å™¨ç”¨äºå¿«é€Ÿåˆ¤æŸä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨äºé›†åˆä¸­ï¼Œç”±ä¸€ä¸ªå¾ˆé•¿çš„äºŒè¿›åˆ¶å‘é‡ï¼ˆä½å›¾ï¼‰å’Œä¸€ç³»åˆ—å“ˆå¸Œå‡½æ•°ä¸¤éƒ¨åˆ†ç»„æˆã€‚å¸ƒéš†è¿‡æ»¤å™¨å¯ä»¥ç”¨äºæ£€ç´¢ä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨ä¸€ä¸ªé›†åˆä¸­ã€‚å®ƒçš„ä¼˜ç‚¹æ˜¯ç©ºé—´æ•ˆç‡å’ŒæŸ¥è¯¢æ—¶é—´éƒ½è¿œè¿œè¶…è¿‡ä¸€èˆ¬çš„ç®—æ³•ï¼Œç¼ºç‚¹æ˜¯æœ‰ä¸€å®šçš„é”™è¯¯è¯†åˆ«ç‡ï¼Œæ·»åŠ åˆ°é›†åˆä¸­çš„å…ƒç´ è¶Šå¤šï¼Œè¯¯æŠ¥çš„å¯èƒ½æ€§å°±è¶Šå¤§ã€‚</p>\n<p> ä½æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½åªå ç”¨ 1 bit ï¼Œå¹¶ä¸”æ¯ä¸ªå…ƒç´ åªèƒ½æ˜¯ 0 æˆ–è€… 1ã€‚è¿™æ ·ç”³è¯·ä¸€ä¸ª 100w ä¸ªå…ƒç´ çš„ä½æ•°ç»„åªå ç”¨ 1000000Bit &#x2F; 8 &#x3D; 125000 Byte &#x3D; 125000&#x2F;1024 kb â‰ˆ 122kb çš„ç©ºé—´ã€‚</p>\n<blockquote>\n<p><a href=\"https://javaguide.cn/cs-basics/data-structure/bloom-filter.html\">å¸ƒéš†è¿‡æ»¤å™¨</a></p>\n<p><a href=\"https://javaguide.cn/database/Redis/Redis-questions-01.html#%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F\">ç¼“å­˜ç©¿é€-å¸ƒéš†è¿‡æ»¤å™¨</a></p>\n</blockquote>\n<p> å…·ä½“è€Œè¨€ï¼š</p>\n<p> æŠŠ <strong>æ‰€æœ‰å¯èƒ½å­˜åœ¨çš„è¯·æ±‚çš„å€¼</strong> éƒ½å­˜æ”¾åœ¨å¸ƒéš†è¿‡æ»¤å™¨ä¸­ï¼Œå½“ç”¨æˆ·è¯·æ±‚è¿‡æ¥ï¼Œå…ˆåˆ¤æ–­ç”¨æˆ·å‘æ¥çš„è¯·æ±‚çš„å€¼æ˜¯å¦å­˜åœ¨äºå¸ƒéš†è¿‡æ»¤å™¨ä¸­ã€‚å¸ƒéš†è¿‡æ»¤å™¨åˆ¤æ–­ä¸å­˜åœ¨çš„è¯ï¼Œåˆ™è‚¯å®šä¸å­˜åœ¨ï¼Œå¸ƒéš†è¿‡æ»¤å™¨åˆ¤æ–­å­˜åœ¨ï¼Œåˆ™è¿›ä¸€æ­¥æŸ¥ Redisï¼ŒRedis ä¸­å­˜åœ¨åˆ™è¿”å›ï¼ŒRedis ä¸­ä¸å­˜åœ¨åˆ™æŸ¥æ•°æ®åº“ã€‚</p>\n<p> ä¸ºä»€ä¹ˆå¸ƒéš†è¿‡æ»¤å™¨ä¼šå‡ºç°è¯¯åˆ¤çš„æƒ…å†µå‘¢? </p>\n<p> <strong>å½“ä¸€ä¸ªå…ƒç´ åŠ å…¥å¸ƒéš†è¿‡æ»¤å™¨ä¸­çš„æ—¶å€™ï¼Œä¼šè¿›è¡Œä»¥ä¸‹æ“ä½œï¼š</strong></p>\n<ol>\n<li><p>ä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨ä¸­çš„å“ˆå¸Œå‡½æ•°å¯¹å…ƒç´ å€¼è¿›è¡Œè®¡ç®—ï¼Œå¾—åˆ°å“ˆå¸Œå€¼ï¼ˆæœ‰å‡ ä¸ªå“ˆå¸Œå‡½æ•°å¾—åˆ°å‡ ä¸ªå“ˆå¸Œå€¼ï¼‰ã€‚</p>\n<blockquote>\n<p>hashVal1 &#x3D; hashMethod1(key)ï¼Œ hashVal2&#x3D; hashMethod2(key)â€¦</p>\n</blockquote>\n</li>\n<li><p>æ ¹æ®å¾—åˆ°çš„å“ˆå¸Œå€¼ï¼Œåœ¨ä½æ•°ç»„ä¸­æŠŠå¯¹åº”ä¸‹æ ‡çš„å€¼ç½®ä¸º 1ã€‚</p>\n<blockquote>\n<p>æŠŠä½æ•°ç»„ä¸­çš„ hashVal1 å’Œ hashVal2 å¤„ç½®ä¸º 1</p>\n</blockquote>\n</li>\n</ol>\n<p> <strong>å½“æˆ‘ä»¬éœ€è¦åˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨äºå¸ƒéš†è¿‡æ»¤å™¨çš„æ—¶å€™ï¼Œä¼šè¿›è¡Œä»¥ä¸‹æ“ä½œï¼š</strong></p>\n<ol>\n<li><p>å¯¹ç»™å®šå…ƒç´ å†æ¬¡è¿›è¡Œç›¸åŒçš„å“ˆå¸Œè®¡ç®—ï¼›</p>\n<blockquote>\n<p>hashVal1 &#x3D; hashMethod1(key)ï¼Œ hashVal2&#x3D; hashMethod2(key)â€¦</p>\n</blockquote>\n</li>\n<li><p>å¾—åˆ°å€¼ä¹‹ååˆ¤æ–­ä½æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ æ˜¯å¦éƒ½ä¸º 1ï¼Œå¦‚æœå€¼éƒ½ä¸º 1ï¼Œé‚£ä¹ˆè¯´æ˜è¿™ä¸ªå€¼åœ¨å¸ƒéš†è¿‡æ»¤å™¨ä¸­ï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ªå€¼ä¸ä¸º 1ï¼Œè¯´æ˜è¯¥å…ƒç´ ä¸åœ¨å¸ƒéš†è¿‡æ»¤å™¨ä¸­ã€‚</p>\n<blockquote>\n<p>åˆ¤æ–­ä½æ•°ç»„ä¸­çš„ hashVal1 å’Œ hashVal2 å¤„æ˜¯å¦å…¨éƒ¨ä¸º 1ï¼Œå…¨éƒ¨ä¸º 1è¯´æ˜å½“å‰å…ƒç´ å­˜åœ¨äºä½æ•°ç»„ä¸­ã€‚</p>\n</blockquote>\n</li>\n</ol>\n<p> ç„¶è€Œä¼šå‡ºç°è¿™æ ·ä¸€ç§æƒ…å†µï¼š<strong>ä¸åŒçš„å­—ç¬¦ä¸²å¯èƒ½å“ˆå¸Œå‡ºæ¥çš„ä½ç½®ç›¸åŒã€‚</strong> ï¼ˆå¯ä»¥é€‚å½“å¢åŠ ä½æ•°ç»„å¤§å°æˆ–è€…è°ƒæ•´æˆ‘ä»¬çš„å“ˆå¸Œå‡½æ•°æ¥é™ä½æ¦‚ç‡ï¼‰</p>\n<blockquote>\n<p><strong>â­ä¾‹å¦‚</strong>ï¼šval1 ç»è¿‡ä¸¤æ¬¡hashå¾—åˆ°ä¸‹æ ‡ 1ï¼Œ 3ï¼Œå°†1ã€3å¤„ç½®ä¸º1ï¼Œval2ç»è¿‡ä¸¤æ¬¡hashå¾—åˆ°ä¸‹æ ‡2ã€4ï¼Œå°†2ã€4å¤„ç½®ä¸º1ï¼Œå¯¹äºæ–°å…ƒç´ val3ç»è¿‡ä¸¤æ¬¡hashå¾—åˆ°ä¸‹æ ‡1ã€2ï¼Œåˆ¤æ–­è¿™ä¸¤ä¸ªä½ç½®éƒ½ä¸º1ï¼Œè¯¯åˆ¤ä»¥ä¸ºval3å­˜åœ¨ï¼Œå®é™…ä¸Šä¸å­˜åœ¨ã€‚</p>\n</blockquote>\n</li>\n</ol>\n<h3 id=\"ç¼“å­˜å‡»ç©¿\"><a href=\"#ç¼“å­˜å‡»ç©¿\" class=\"headerlink\" title=\"ç¼“å­˜å‡»ç©¿\"></a>ç¼“å­˜å‡»ç©¿</h3><p><strong>é—®é¢˜æ¥æº</strong></p>\n<p>ç¼“å­˜å‡»ç©¿æ˜¯æŒ‡ä¸€ä¸ªçƒ­ç‚¹çš„ keyï¼Œæœ‰å¤§å¹¶å‘é›†ä¸­å¯¹å…¶è¿›è¡Œè®¿é—®ï¼Œçªç„¶é—´è¿™ä¸ª key å¤±æ•ˆäº†ï¼Œå¯¼è‡´å¤§å¹¶å‘å…¨éƒ¨æ‰“åœ¨æ•°æ®åº“ä¸Šï¼Œå¯¼è‡´æ•°æ®åº“å‹åŠ›å‰§å¢ã€‚è¿™ç§ç°è±¡å°±å«åšç¼“å­˜å‡»ç©¿ã€‚</p>\n<p><strong>è§£å†³æ–¹æ¡ˆ</strong></p>\n<blockquote>\n<p>çƒ­ç‚¹keyå¤±æ•ˆ â†’ æ‰“åˆ°æ•°æ®åº“ä¸Šï¼Œå› æ­¤å¯ä»¥ä»è¿™ä¸¤æ–¹é¢è¿›è¡Œè§£å†³</p>\n</blockquote>\n<p>1ã€è®¾ç½®çƒ­ç‚¹æ•°æ®æ°¸è¿œä¸è¿‡æœŸã€‚</p>\n<p>2ã€æ¥å£é™æµã€é™çº§ä¸ç†”æ–­ã€‚é‡è¦çš„æ¥å£ä¸€å®šè¦åšå¥½é™æµç­–ç•¥ï¼Œé˜²æ­¢ç”¨æˆ·æ¶æ„åˆ·æ¥å£ï¼ŒåŒæ—¶è¦é™çº§å‡†å¤‡ï¼Œå½“æ¥å£ä¸­çš„æŸäº›æœåŠ¡ä¸å¯ç”¨æ—¶å€™ï¼Œè¿›è¡Œç†”æ–­ï¼Œå¤±è´¥å¿«é€Ÿè¿”å›æœºåˆ¶ã€‚</p>\n<p>3ã€åŠ äº’æ–¥é”ï¼šå¦‚æœç¼“å­˜å¤±æ•ˆçš„æƒ…å†µï¼Œåªæœ‰æ‹¿åˆ°é”æ‰å¯ä»¥æŸ¥è¯¢æ•°æ®åº“ï¼Œåˆ†å¸ƒå¼åœºæ™¯ä¸‹å¯ä»¥ä½¿ç”¨åˆ†å¸ƒå¼é”ã€‚</p>\n<h3 id=\"ç¼“å­˜é›ªå´©\"><a href=\"#ç¼“å­˜é›ªå´©\" class=\"headerlink\" title=\"ç¼“å­˜é›ªå´©\"></a>ç¼“å­˜é›ªå´©</h3><p><strong>é—®é¢˜æ¥æº</strong></p>\n<p>ç¼“å­˜é›ªå´©æ˜¯æŒ‡ç¼“å­˜ä¸­æ•°æ®å¤§æ‰¹é‡åˆ°è¿‡æœŸæ—¶é—´ï¼Œè€ŒæŸ¥è¯¢æ•°æ®é‡å·¨å¤§ï¼Œå¼•èµ·æ•°æ®åº“å‹åŠ›è¿‡å¤§ç”šè‡³ down æœºã€‚å’Œç¼“å­˜å‡»ç©¿ä¸åŒçš„æ˜¯ï¼Œç¼“å­˜å‡»ç©¿æŒ‡å¹¶å‘æŸ¥åŒä¸€æ¡æ•°æ®ï¼Œç¼“å­˜é›ªå´©æ˜¯æŒ‡å¾ˆå¤šä¸åŒçš„æ•°æ®éƒ½è¿‡æœŸäº†ï¼Œéƒ½æŸ¥ä¸åˆ°ä»è€ŒæŸ¥æ•°æ®åº“ã€‚</p>\n<p><strong>è§£å†³æ–¹æ¡ˆ</strong></p>\n<ol>\n<li><strong>ç¼“å­˜æ•°æ®çš„è¿‡æœŸæ—¶é—´è®¾ç½®éšæœº</strong>ï¼Œé˜²æ­¢åŒä¸€æ—¶é—´å¤§é‡æ•°æ®è¿‡æœŸç°è±¡å‘ç”Ÿã€‚</li>\n<li>è®¾ç½®çƒ­ç‚¹æ•°æ®æ°¸è¿œä¸è¿‡æœŸã€‚</li>\n<li>åœ¨å³å°†å‘ç”Ÿå¤§å¹¶å‘è®¿é—®ä¹‹å‰ï¼Œè¿›è¡Œ<strong>ç¼“å­˜é¢„çƒ­</strong>å°†å¯èƒ½å¤§é‡è®¿é—®çš„æ•°æ®åŠ è½½åˆ°ç¼“å­˜ã€‚</li>\n<li>æ¥å£é™æµã€é™çº§ä¸ç†”æ–­ã€‚é‡è¦çš„æ¥å£ä¸€å®šè¦åšå¥½é™æµç­–ç•¥ï¼Œé˜²æ­¢ç”¨æˆ·æ¶æ„åˆ·æ¥å£ï¼ŒåŒæ—¶è¦é™çº§å‡†å¤‡ï¼Œå½“æ¥å£ä¸­çš„æŸäº›æœåŠ¡ä¸å¯ç”¨æ—¶å€™ï¼Œè¿›è¡Œç†”æ–­ï¼Œå¤±è´¥å¿«é€Ÿè¿”å›æœºåˆ¶ã€‚</li>\n<li>ä¸ºäº†é˜²æ­¢ Redis å®•æœºå¯¼è‡´ç¼“å­˜é›ªå´©çš„é—®é¢˜ï¼Œå¯ä»¥<strong>æ­å»ºRedisé›†ç¾¤</strong>ï¼Œæé«˜ Redis çš„å®¹ç¾æ€§ã€‚</li>\n<li>æé«˜æ•°æ®åº“çš„å®¹ç¾èƒ½åŠ›ï¼Œå¯ä»¥ä½¿ç”¨<strong>æ•°æ®åº“åˆ†åº“åˆ†è¡¨</strong>ï¼Œè¯»å†™åˆ†ç¦»çš„ç­–ç•¥ã€‚</li>\n</ol>\n<h2 id=\"Redis-æ·˜æ±°ç­–ç•¥\"><a href=\"#Redis-æ·˜æ±°ç­–ç•¥\" class=\"headerlink\" title=\"Redis æ·˜æ±°ç­–ç•¥\"></a>Redis æ·˜æ±°ç­–ç•¥</h2><h3 id=\"Redis-å†…å­˜æ·˜æ±°ç­–ç•¥\"><a href=\"#Redis-å†…å­˜æ·˜æ±°ç­–ç•¥\" class=\"headerlink\" title=\"Redis å†…å­˜æ·˜æ±°ç­–ç•¥\"></a>Redis å†…å­˜æ·˜æ±°ç­–ç•¥</h3><blockquote>\n<p>Redis æ˜¯åŸºäºå†…å­˜ç»“æ„è¿›è¡Œæ•°æ®ç¼“å­˜çš„ï¼Œå½“å†…å­˜èµ„æºæ¶ˆè€—å®Œæ¯•ï¼Œå½“å°†è¦æœ‰æ–°çš„æ•°æ®ç¼“å­˜è¿›æ¥æ—¶ï¼Œä¸ºäº†è…¾å‡ºç©ºé—´æ”¾æ–°çš„æ•°æ®ï¼Œéœ€è¦å°†å†…å­˜ä¸­çš„ä¸€äº›æ•°æ®é‡Šæ”¾æ‰ï¼Œè¿™ç§é‡Šæ”¾æ•°æ®çš„ç­–ç•¥ç§°ä¸º Redis çš„æ·˜æ±°ç­–ç•¥ã€‚</p>\n</blockquote>\n<p>LRUï¼šLeast Recently Used</p>\n<p>LFUï¼šLeast Frequently Used</p>\n<p>LRU æ·˜æ±°çš„æ˜¯æœ€ä¹…æœªè®¿é—®åˆ°çš„æ•°æ®ï¼Œè€Œ LFU æ˜¯æ·˜æ±°çš„æ˜¯æœ€ä¸ç»å¸¸ä½¿ç”¨çš„æ•°æ®ï¼ˆè‹¥ä¸¤ä¸ªæˆ–å¤šä¸ªæ•°æ®çš„ä½¿ç”¨é¢‘ç‡ç›¸åŒæ—¶ï¼ŒLFU ä¼šå†é€‰æ‹©æœ€ä¹…æœªè®¿é—®åˆ°çš„æ•°æ®æ·˜æ±°ï¼‰ã€‚</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># volatile-lru -&gt; åœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„æ•°æ®ä¸­ä½¿ç”¨ LRU</span><br><span class=\"line\"># allkeys-lru -&gt; åœ¨æ‰€æœ‰æ•°æ®ä¸­ä½¿ç”¨ LRU</span><br><span class=\"line\"># volatile-lfu -&gt; åœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„æ•°æ®ä¸­ä½¿ç”¨ LFU</span><br><span class=\"line\"># allkeys-lfu -&gt; åœ¨æ‰€æœ‰æ•°æ®ä¸­ä½¿ç”¨ LFU</span><br><span class=\"line\"># volatile-random -&gt; åœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„æ•°æ®ä¸­éšæœºæ·˜æ±°</span><br><span class=\"line\"># allkeys-random -&gt; åœ¨æ‰€æœ‰æ•°æ®ä¸­éšæœºæ·˜æ±°</span><br><span class=\"line\"># volatile-ttl -&gt; è¶Šæ—©è¿‡æœŸçš„æ•°æ® è¶Šå…ˆè¢«æ·˜æ±°</span><br><span class=\"line\"># noeviction -&gt; ä¸æ·˜æ±°ä»»ä½•æ•°æ®ï¼Œå½“å†…å­˜ä¸å¤Ÿæ—¶ç›´æ¥æŠ›å‡ºå¼‚å¸¸</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Redis-ç¼“å­˜å¤±æ•ˆç­–ç•¥\"><a href=\"#Redis-ç¼“å­˜å¤±æ•ˆç­–ç•¥\" class=\"headerlink\" title=\"Redis ç¼“å­˜å¤±æ•ˆç­–ç•¥\"></a>Redis ç¼“å­˜å¤±æ•ˆç­–ç•¥</h3><p><strong>å®šæ—¶è¿‡æœŸç­–ç•¥</strong></p>\n<p>æ¯ä¸ªè®¾ç½®è¿‡æœŸæ—¶é—´çš„ key éƒ½éœ€è¦åˆ›å»ºä¸€ä¸ªå®šæ—¶å™¨ï¼Œåˆ°è¿‡æœŸæ—¶é—´å°±ä¼šç«‹å³æ¸…é™¤ã€‚è¯¥ç­–ç•¥å¯ä»¥ç«‹å³æ¸…é™¤è¿‡æœŸçš„æ•°æ®ï¼Œå¯¹å†…å­˜å¾ˆå‹å¥½ï¼Œæœ‰æ•ˆåœ°å‡å°‘äº†å› ä¸ºè¿‡æœŸé”®å¸¦æ¥çš„å†…å­˜æµªè´¹ï¼›ä½†æ˜¯ä¼šå ç”¨å¤§é‡çš„ CPU èµ„æºå»å¤„ç†è¿‡æœŸçš„æ•°æ®ï¼Œä»è€Œå½±å“ç¼“å­˜çš„å“åº”æ—¶é—´å’Œååé‡ã€‚</p>\n<p><strong>æƒ°æ€§è¿‡æœŸç­–ç•¥</strong></p>\n<p>åªæœ‰å½“è®¿é—®ä¸€ä¸ª key æ—¶ï¼Œæ‰ä¼šåˆ¤æ–­è¯¥ key æ˜¯å¦å·²è¿‡æœŸï¼Œè¿‡æœŸåˆ™æ¸…é™¤ã€‚è¯¥ç­–ç•¥å¯ä»¥æœ€å¤§åŒ–åœ°èŠ‚çœ CPU èµ„æºï¼Œå´å¯¹å†…å­˜éå¸¸ä¸å‹å¥½ã€‚æç«¯æƒ…å†µå¯èƒ½å‡ºç°å¤§é‡çš„è¿‡æœŸ key æ²¡æœ‰å†æ¬¡è¢«è®¿é—®ï¼Œä»è€Œä¸ä¼šè¢«æ¸…é™¤ï¼Œå ç”¨å¤§é‡å†…å­˜ã€‚</p>\n<p><strong>å®šæœŸè¿‡æœŸç­–ç•¥</strong></p>\n<p>æ¯éš”ä¸€å®šçš„æ—¶é—´ï¼Œä¼šæ‰«æä¸€å®šæ•°é‡çš„æ•°æ®åº“çš„ expires å­—å…¸ä¸­ä¸€å®šæ•°é‡çš„ keyï¼Œå¹¶æ¸…é™¤å…¶ä¸­å·²è¿‡æœŸçš„ keyã€‚è¯¥ç­–ç•¥æ˜¯å‰ä¸¤è€…çš„ä¸€ä¸ªæŠ˜ä¸­æ–¹æ¡ˆã€‚é€šè¿‡è°ƒæ•´å®šæ—¶æ‰«æçš„æ—¶é—´é—´éš”å’Œæ¯æ¬¡æ‰«æçš„é™å®šè€—æ—¶ï¼Œå¯ä»¥åœ¨ä¸åŒæƒ…å†µä¸‹ä½¿å¾— CPU å’Œå†…å­˜èµ„æºè¾¾åˆ°æœ€ä¼˜çš„å¹³è¡¡æ•ˆæœã€‚</p>\n<p><strong>Redisä¸­åŒæ—¶ä½¿ç”¨äº†å®šæœŸè¿‡æœŸå’Œæƒ°æ€§è¿‡æœŸä¸¤ç§è¿‡æœŸç­–ç•¥ã€‚</strong></p>\n<p>æ‰€è°“å®šæœŸåˆ é™¤ï¼ŒæŒ‡çš„æ˜¯ Redis é»˜è®¤æ˜¯æ¯éš” 100ms å°±éšæœºæŠ½å–ä¸€äº›è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„ keyï¼Œæ£€æŸ¥å…¶æ˜¯å¦è¿‡æœŸï¼Œå¦‚æœè¿‡æœŸå°±åˆ é™¤ã€‚</p>\n<p><strong>å‡è®¾ Redis é‡Œæ”¾äº† 10w ä¸ª keyï¼Œéƒ½è®¾ç½®äº†è¿‡æœŸæ—¶é—´ï¼Œ</strong>ä½ æ¯éš”å‡ ç™¾æ¯«ç§’ï¼Œå°±æ£€æŸ¥ 10w ä¸ª keyï¼Œé‚£ Redis åŸºæœ¬ä¸Šå°±æ­»äº†ï¼Œcpu è´Ÿè½½ä¼šå¾ˆé«˜çš„ï¼Œæ¶ˆè€—åœ¨ä½ çš„æ£€æŸ¥è¿‡æœŸ key ä¸Šäº†ã€‚<strong>æ³¨æ„ï¼Œ</strong>è¿™é‡Œå¯ä¸æ˜¯æ¯éš” 100ms å°±éå†æ‰€æœ‰çš„è®¾ç½®è¿‡æœŸæ—¶é—´çš„ keyï¼Œé‚£æ ·å°±æ˜¯ä¸€åœºæ€§èƒ½ä¸Šçš„ç¾éš¾ã€‚å®é™…ä¸Š Redis æ˜¯æ¯éš” 100ms éšæœºæŠ½å–ä¸€äº› key æ¥æ£€æŸ¥å’Œåˆ é™¤çš„ã€‚</p>\n<p><strong>ä½†æ˜¯é—®é¢˜æ˜¯ï¼Œå®šæœŸåˆ é™¤å¯èƒ½ä¼šå¯¼è‡´å¾ˆå¤šè¿‡æœŸ key åˆ°äº†æ—¶é—´å¹¶æ²¡æœ‰è¢«åˆ é™¤æ‰ï¼Œé‚£å’‹æ•´å‘¢ï¼Ÿ</strong>æ‰€ä»¥å°±æ˜¯æƒ°æ€§åˆ é™¤äº†ã€‚è¿™å°±æ˜¯è¯´ï¼Œåœ¨ä½ è·å–æŸä¸ª key çš„æ—¶å€™ï¼ŒRedis ä¼šæ£€æŸ¥ä¸€ä¸‹ ï¼Œè¿™ä¸ª key å¦‚æœè®¾ç½®äº†è¿‡æœŸæ—¶é—´é‚£ä¹ˆæ˜¯å¦è¿‡æœŸäº†ï¼Ÿå¦‚æœè¿‡æœŸäº†æ­¤æ—¶å°±ä¼šåˆ é™¤ï¼Œä¸ä¼šç»™ä½ è¿”å›ä»»ä½•ä¸œè¥¿ã€‚</p>\n<p><strong>è·å– key çš„æ—¶å€™ï¼Œå¦‚æœæ­¤æ—¶ key å·²ç»è¿‡æœŸï¼Œå°±åˆ é™¤ï¼Œä¸ä¼šè¿”å›ä»»ä½•ä¸œè¥¿ã€‚</strong>ä½†æ˜¯å®é™…ä¸Šè¿™è¿˜æ˜¯æœ‰é—®é¢˜çš„ï¼Œå¦‚æœå®šæœŸåˆ é™¤æ¼æ‰äº†å¾ˆå¤šè¿‡æœŸ keyï¼Œç„¶åä½ ä¹Ÿæ²¡åŠæ—¶å»æŸ¥ï¼Œä¹Ÿå°±æ²¡èµ°æƒ°æ€§åˆ é™¤ï¼Œæ­¤æ—¶ä¼šæ€ä¹ˆæ ·ï¼Ÿå¦‚æœå¤§é‡è¿‡æœŸ key å †ç§¯åœ¨å†…å­˜é‡Œï¼Œå¯¼è‡´ Redis å†…å­˜å¿«è€—å°½äº†ï¼Œå’‹æ•´ï¼Ÿ<strong>ç­”æ¡ˆæ˜¯ï¼šèµ°å†…å­˜æ·˜æ±°æœºåˆ¶ã€‚</strong></p>\n<hr>\n<h2 id=\"Redisåˆ†å¸ƒå¼å¹¶å‘é—®é¢˜\"><a href=\"#Redisåˆ†å¸ƒå¼å¹¶å‘é—®é¢˜\" class=\"headerlink\" title=\"Redisåˆ†å¸ƒå¼å¹¶å‘é—®é¢˜\"></a>Redisåˆ†å¸ƒå¼å¹¶å‘é—®é¢˜</h2><blockquote>\n<p>å•ä½“é¡¹ç›®ä¸­ï¼Œè´­ç‰©è½¦ä¸‹å•å¯ä»¥ä½¿ç”¨ synchronized å…³é”®å­—é”ä½å®ä¾‹å¯¹è±¡ï¼Œåªè®©ä¸€ä¸ªçº¿ç¨‹ä¸‹å•å¹¶æ‰£å‡åº“å­˜</p>\n<p>è€Œå¯¹äºé›†ç¾¤è€Œè¨€ï¼Œåœ¨æ¯å°æœåŠ¡å™¨ä¸Šé”ä½å®ä¾‹å¯¹è±¡ï¼Œä½†æ˜¯æ¯å°ä¹‹é—´æ˜¯æ— æ³•æ„ŸçŸ¥çš„ï¼Œä»ç„¶å¯èƒ½å­˜åœ¨å•†å“è¶…å–é—®é¢˜</p>\n</blockquote>\n<h3 id=\"ä½¿ç”¨-Redis-å®ç°åˆ†å¸ƒå¼é”\"><a href=\"#ä½¿ç”¨-Redis-å®ç°åˆ†å¸ƒå¼é”\" class=\"headerlink\" title=\"ä½¿ç”¨ Redis å®ç°åˆ†å¸ƒå¼é”\"></a>ä½¿ç”¨ Redis å®ç°åˆ†å¸ƒå¼é”</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Transactional</span></span><br><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> Map&lt;String, String&gt; <span class=\"title function_\">addOrder</span><span class=\"params\">(String cids, Orders orders)</span> &#123;</span><br><span class=\"line\">    log.info(<span class=\"string\">&quot;add order begin...&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    Map&lt;String, String&gt; map = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 1ã€æ ¹æ®cidsæŸ¥è¯¢å½“å‰è®¢å•ä¸­å…³è”çš„è´­ç‰©è½¦è®°å½•è¯¦æƒ…ï¼ˆåŒ…æ‹¬åº“å­˜ï¼‰</span></span><br><span class=\"line\">    String[] arr = cids.split(<span class=\"string\">&quot;ï¼Œ&quot;</span>);</span><br><span class=\"line\">    List&lt;Integer&gt; cidsList = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (String s : arr) &#123;</span><br><span class=\"line\">        cidsList.add(Integer.parseInt(s));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// è·å–æ‰€æœ‰skuId</span></span><br><span class=\"line\">    List&lt;ShoppingCartVO&gt; list1 = shoppingCartMapper.selectShopCartByCids(cidsList);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"type\">boolean</span> <span class=\"variable\">allLocked</span> <span class=\"operator\">=</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">    List&lt;String&gt; lockedSkuIds = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;&gt;();</span><br><span class=\"line\">    Map&lt;String, String&gt; values = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (ShoppingCartVO sc : list1) &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">skuId</span> <span class=\"operator\">=</span> sc.getSkuId()ï¼Œ value = UUID.randomUUID().toString();</span><br><span class=\"line\">        <span class=\"type\">Boolean</span> <span class=\"variable\">thisLocked</span> <span class=\"operator\">=</span> srt.boundValueOps(sc.getSkuId()).setIfAbsent(value, <span class=\"number\">10</span>, TimeUnit.SECONDS);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!thisLocked) &#123;   <span class=\"comment\">// è¿”å› false è¯´æ˜ä¹‹å‰æœ‰è¯¥æ•°æ®ï¼Œå³æœ‰çº¿ç¨‹åœ¨æ“ä½œè¿™ä¸ª å•†å“åº“å­˜</span></span><br><span class=\"line\">            allLocked = <span class=\"literal\">false</span>;  <span class=\"comment\">// å› æ­¤è¿™ä¸ªskuå°±æ²¡æœ‰é”ä½ï¼Œä¸èƒ½ç»§ç»­æ“ä½œ</span></span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            lockedSkuIds.add(skuId);</span><br><span class=\"line\">            values.put(skuId, value);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (allLocked) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 2ã€æ ¡éªŒåº“å­˜</span></span><br><span class=\"line\">        List&lt;ShoppingCartVO&gt; list = shoppingCartMapper.selectShopCartByCids(cidsList);</span><br><span class=\"line\">        <span class=\"type\">boolean</span> <span class=\"variable\">f</span> <span class=\"operator\">=</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">        <span class=\"type\">StringBuilder</span> <span class=\"variable\">sb</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">StringBuilder</span>();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (ShoppingCartVO sc : list) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (Integer.parseInt(sc.getCartNum()) &gt; sc.getSkuStock()) &#123;</span><br><span class=\"line\">                f = <span class=\"literal\">false</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"comment\">//è·å–æ‰€æœ‰å•†å“çš„åç§°ï¼Œä»¥é€—å·æ‹¼æ¥æˆå­—ç¬¦ä¸²</span></span><br><span class=\"line\">            sb.append(sc.getProductName()).append(<span class=\"string\">&quot;ï¼Œ&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">untitled</span> <span class=\"operator\">=</span> sb.toString();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (f) &#123;</span><br><span class=\"line\">            log.info(<span class=\"string\">&quot;product stock is ok ... &quot;</span>);</span><br><span class=\"line\">            <span class=\"comment\">// 3ã€è¡¨ç¤ºåº“å­˜å……è¶³----ä¿å­˜è®¢å•</span></span><br><span class=\"line\">            <span class=\"comment\">// a.userId   b.untitled  c.æ”¶è´§äººä¿¡æ¯ï¼šå§“åã€ç”µè¯ã€åœ°å€</span></span><br><span class=\"line\">            <span class=\"comment\">// d.æ€»ä»·æ ¼   e.æ”¯ä»˜æ–¹å¼   f.è®¢å•çš„åˆ›å»ºæ—¶é—´  g.è®¢å•åˆå§‹çŠ¶æ€</span></span><br><span class=\"line\">            orders.setUntitled(untitled);</span><br><span class=\"line\">            orders.setCreateTime(<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>());</span><br><span class=\"line\">            orders.setStatus(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// ç”Ÿæˆè®¢å•ç¼–å·</span></span><br><span class=\"line\">            <span class=\"type\">String</span> <span class=\"variable\">orderId</span> <span class=\"operator\">=</span> UUID.randomUUID().toString().replace(<span class=\"string\">&quot;-&quot;</span>ï¼Œ <span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">            orders.setOrderId(orderId);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// ä¿å­˜è®¢å•</span></span><br><span class=\"line\">            ordersMapper.insert(orders);</span><br><span class=\"line\">            <span class=\"comment\">// 4ã€ç”Ÿæˆå•†å“å¿«ç…§</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> (ShoppingCartVO sc : list) &#123;</span><br><span class=\"line\">                <span class=\"type\">int</span> <span class=\"variable\">cnum</span> <span class=\"operator\">=</span> Integer.parseInt(sc.getCartNum());</span><br><span class=\"line\">                <span class=\"type\">String</span> <span class=\"variable\">itemId</span> <span class=\"operator\">=</span> System.currentTimeMillis() + <span class=\"string\">&quot;&quot;</span> + (<span class=\"keyword\">new</span> <span class=\"title class_\">Random</span>().nextInt(<span class=\"number\">89999</span>) + <span class=\"number\">10000</span>);</span><br><span class=\"line\">                <span class=\"type\">OrderItem</span> <span class=\"variable\">orderItem</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">OrderItem</span>(itemId, orderId, sc.getProductId()ï¼Œ sc.getProductName()ï¼Œ sc.getProductImg()ï¼Œ sc.getSkuId()ï¼Œ</span><br><span class=\"line\">                                                    sc.getSkuName()ï¼Œ BigDecimal.valueOf(sc.getSellPrice())ï¼Œ cnum, <span class=\"keyword\">new</span> <span class=\"title class_\">BigDecimal</span>(sc.getSellPrice() * cnum)ï¼Œ <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>()ï¼Œ <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>()ï¼Œ <span class=\"number\">0</span>);</span><br><span class=\"line\">                orderItemMapper.insert(orderItem);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// 5ã€æ‰£å‡åº“å­˜ï¼šæ ¹æ®å¥—é¤Idä¿®æ”¹å¥—é¤åº“å­˜é‡</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> (ShoppingCartVO sc : list) &#123;</span><br><span class=\"line\">                <span class=\"type\">String</span> <span class=\"variable\">skuId</span> <span class=\"operator\">=</span> sc.getSkuId();</span><br><span class=\"line\">                <span class=\"type\">int</span> <span class=\"variable\">newStock</span> <span class=\"operator\">=</span> sc.getSkuStock() - Integer.parseInt(sc.getCartNum());</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"type\">ProductSku</span> <span class=\"variable\">productSku</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ProductSku</span>();</span><br><span class=\"line\">                productSku.setSkuId(skuId);</span><br><span class=\"line\">                productSku.setStock(newStock);</span><br><span class=\"line\">                <span class=\"comment\">//æ ¹æ®ä¸»é”®æ¥ä¿®æ”¹å±æ€§å€¼</span></span><br><span class=\"line\">                productSkuMapper.updateByPrimaryKeySelective(productSku);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// 6ã€åˆ é™¤è´­ç‰©è½¦ï¼šå½“è´­ç‰©è½¦ä¸­çš„è®°å½•è´­ä¹°æˆåŠŸä¹‹åï¼Œè´­ç‰©è½¦ä¸­å¯¹åº”åšåˆ é™¤æ“ä½œ</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> cid : cidsList) &#123;</span><br><span class=\"line\">                shoppingCartMapper.deleteByPrimaryKey(cid);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// é‡Šæ”¾é”</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> (String lockedSkuId : lockedSkuIds) &#123;</span><br><span class=\"line\">                <span class=\"type\">String</span> <span class=\"variable\">value</span> <span class=\"operator\">=</span> srt.boundValueOps(lockedSkuId).get();</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (value != <span class=\"literal\">null</span> &amp;&amp; value.equals(values.get(lockedSkuId))) &#123;</span><br><span class=\"line\">                    srt.delete(lockedSkuId);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            log.info(<span class=\"string\">&quot;add order finished... &quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">            map.put(<span class=\"string\">&quot;orderId&quot;</span>ï¼Œ orderId);</span><br><span class=\"line\">            map.put(<span class=\"string\">&quot;productNames&quot;</span>ï¼Œ untitled);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> map;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// è¡¨ç¤ºåº“å­˜ä¸è¶³</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;    <span class=\"comment\">// åŠ é”å¤±è´¥</span></span><br><span class=\"line\">        <span class=\"comment\">// è¦å°†éƒ¨åˆ†é”å®šçš„skué‡Šæ”¾é”ï¼Œå³ä»Redisä¸­ç§»é™¤é”ä½çš„skuId</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (String lockedSkuId : lockedSkuIds) &#123;</span><br><span class=\"line\">            srt.delete(lockedSkuId);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ol>\n<li><p>å¦‚æœè®¢å•ä¸­éƒ¨åˆ†å•†å“åŠ é”æˆåŠŸï¼Œä½†æ˜¯ç”±äºä¸€äº›å•†å“åŠ é”å¤±è´¥å¯¼è‡´æ— æ³•æäº¤è®¢å•ï¼Œæ­¤æ—¶è¦æ³¨æ„å°†åŠ é”çš„å•†å“æ¢å¤ï¼Œå³ä» Redis ä¸­ç§»é™¤è¯¥å•†å“</p>\n<blockquote>\n<p>åœ¨ allLocked &#x3D;&#x3D; false ä¸­ï¼Œé‡Šæ”¾åŠ é”çš„å•†å“</p>\n</blockquote>\n</li>\n<li><p>ç¬¬ä¸€æ¬¡æ ¹æ® è´­ç‰©è½¦ Id æŸ¥åˆ°çš„è´­ç‰©è½¦è®°å½•ï¼ˆåŒ…å«å•†å“åº“å­˜ï¼‰åˆ°åŠ é”æäº¤è®¢å•ä¹‹å‰ï¼Œå¯èƒ½æœ‰åˆ«çš„çº¿ç¨‹ æ“ä½œäº†å…¶ä¸­æŸä¸ªå•†å“çš„åº“å­˜å¹¶æ“ä½œå®Œäº†ï¼Œä¸ºäº†é˜²æ­¢å½“å‰çº¿ç¨‹è¿˜å¯¹ä¹‹å‰åº“å­˜è¿›è¡Œä¿®æ”¹ï¼Œåº”å½“åœ¨åŠ é”åæ“ä½œå‰é‡æ–°æŸ¥è¯¢åº“å­˜ã€‚</p>\n</li>\n<li><p>å½“å‰çº¿ç¨‹åŠ é”æˆåŠŸä¹‹åï¼Œåœ¨æ‰§è¡Œæ·»åŠ è®¢å•çš„è¿‡ç¨‹ä¸­å¦‚æœå‡ºç°äº†å¼‚å¸¸å¯¼è‡´æ— æ³•é‡Šæ”¾é”</p>\n<blockquote>\n<p>å¯ä»¥åœ¨å¯¹å•†å“åŠ é”æ—¶è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œåˆ™åˆ°æœŸè‡ªåŠ¨é‡Šæ”¾é”</p>\n</blockquote>\n</li>\n<li><p>æ¡£ç»™é”è®¾ç½®äº†è¿‡æœŸæ—¶é—´ä¹‹åï¼Œå¦‚æœå½“å‰çº¿ç¨‹ t1 å› ä¸ºç‰¹æ®ŠåŸå› ï¼Œåœ¨é”è¿‡æœŸä¹‹å‰æ²¡æœ‰å®Œæˆä¸šåŠ¡æ‰§è¡Œï¼Œé‡Šæ”¾æ‰äº†é”ï¼Œæ­¤æ—¶çº¿ç¨‹ t2 åŠ é”æˆåŠŸï¼Œå¦‚æœçº¿ç¨‹ t1 æ‰§è¡Œç»“æŸï¼Œå°†ä¼šé‡Šæ”¾ çº¿ç¨‹ t2 çš„é”ï¼Œå¯¼è‡´ çº¿ç¨‹ t2 åœ¨æ— é”çŠ¶æ€</p>\n<blockquote>\n<p>å¯¹äºåŠ æˆåŠŸå¹¶æäº¤å®Œè®¢å•ä¹‹åï¼Œå¯¹å½“å‰å•†å“çš„é”é‡Šæ”¾ï¼Œè¦åˆ¤æ–­ Redis ä¸­çš„valueæ˜¯å¦å’Œè‡ªå·±è®°å½•çš„ç›¸åŒï¼Œå³æ˜¯å¦æ˜¯è‡ªå·±åŠ çš„é”</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// é‡Šæ”¾é”</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> (String lockedSkuId : lockedSkuIds) &#123;</span><br><span class=\"line\">   <span class=\"type\">String</span> <span class=\"variable\">value</span> <span class=\"operator\">=</span> srt.boundValueOps(lockedSkuId).get();</span><br><span class=\"line\">   <span class=\"keyword\">if</span> (values.get(lockedSkuId).equals(value)) &#123;</span><br><span class=\"line\">     \tsrt.delete(lockedSkuId);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</blockquote>\n</li>\n<li><p>å½“å‰çº¿ç¨‹ t1 åˆ¤æ–­æ˜¯è‡ªå·±åŠ çš„é”ï¼Œåœ¨å‡†å¤‡åˆ é™¤ä¹‹å‰ï¼Œé”è¿‡æœŸäº†å¹¶ä¸”è¢«å…¶ä»–çº¿ç¨‹ t2 æ‹¿åˆ°äº†æˆåŠŸåŠ é”ï¼Œè¿™æ—¶å€™çº¿ç¨‹ t1 ä¼šé‡Šæ”¾æ‰çº¿ç¨‹ t2 çš„é”ï¼ˆå¹¶å‘é‡å¾ˆå¤§ä»ç„¶éœ€è¦è€ƒè™‘ï¼‰</p>\n<blockquote>\n<p>ä¿è¯ æŸ¥è¯¢é”æ˜¯å¦æ˜¯è‡ªå·±åŠ çš„å’Œåˆ é™¤è‡ªå·±åŠ çš„é” çš„åŸå­æ€§ï¼ˆä½¿ç”¨ lua è„šæœ¬ï¼Œè®©å¤šä¸ª Redis æ“ä½œå…·æœ‰åŸå­æ€§ï¼ŒæŸ¥è¯¢+åˆ é™¤ï¼‰</p>\n</blockquote>\n</li>\n<li><p>ä½¿ç”¨çœ‹é—¨ç‹—çº¿ç¨‹è§£å†³çº¿ç¨‹ t1 é‡Šæ”¾ç›¸ä¹˜ t2 çš„é”çš„é—®é¢˜</p>\n<blockquote>\n<p>çº¿ç¨‹t1 åŠ é”å¹¶è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œæ­¤æ—¶å¯åŠ¨ çœ‹é—¨ç‹—çº¿ç¨‹ï¼ˆå®ˆæŠ¤çº¿ç¨‹ï¼‰ç›‘æ§çº¿ç¨‹ t1è¿‡æœŸæ—¶é—´ï¼Œè¿‡æœŸæ—¶é—´è¦åˆ°äº†ä½†æ˜¯çº¿ç¨‹t1 ä¸šåŠ¡è¿˜åœ¨æ‰§è¡Œï¼Œåˆ™é‡ç½®è¿‡æœŸæ—¶é—´ï¼Œè¿™æ ·å¯ä»¥ä¿è¯ä¸šåŠ¡æ‰§è¡Œå®Œä¹‹å‰ä¸ä¼šé‡Šæ”¾é”</p>\n</blockquote>\n</li>\n</ol>\n<h3 id=\"åˆ†å¸ƒå¼é”æ¡†æ¶-Resisson\"><a href=\"#åˆ†å¸ƒå¼é”æ¡†æ¶-Resisson\" class=\"headerlink\" title=\"åˆ†å¸ƒå¼é”æ¡†æ¶ Resisson\"></a>åˆ†å¸ƒå¼é”æ¡†æ¶ Resisson</h3><ul>\n<li><p>æ·»åŠ ä¾èµ–</p>\n  <figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- https://mvnrepository.com/artifact/org.redisson/redisson --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.redisson<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>redisson<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>3.16.7<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>é…ç½® yaml æ–‡ä»¶</p>\n  <figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">redisson:</span></span><br><span class=\"line\">  <span class=\"attr\">addr:</span></span><br><span class=\"line\">    <span class=\"attr\">singleAddr:</span></span><br><span class=\"line\">      <span class=\"attr\">host:</span> <span class=\"string\">Redis://47.110.247.63:6389</span></span><br><span class=\"line\">      <span class=\"attr\">password:</span> <span class=\"string\">FYX123fyx.</span></span><br><span class=\"line\">      <span class=\"attr\">database:</span> <span class=\"number\">0</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>é…ç½® RedissonClientï¼ˆä¹Ÿå¯ä»¥é…ç½®æˆé›†ç¾¤æ¨¡å¼ã€ä¸»ä»æ¨¡å¼ï¼‰</p>\n  <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">RedissonConfig</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Value(&quot;$&#123;redisson.addr.singleAddr.host&#125;&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String host;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Value(&quot;$&#123;redisson.addr.singleAddr.password&#125;&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String password;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Value(&quot;$&#123;redisson.addr.singleAddr.database&#125;&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> database;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> RedissonClient <span class=\"title function_\">redissonClient</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Config</span> <span class=\"variable\">config</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Config</span>();</span><br><span class=\"line\">        config.useSingleServer().setAddress(host)</span><br><span class=\"line\">                .setPassword(password)</span><br><span class=\"line\">                .setDatabase(database);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Redisson.create(config);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>æ“ä½œ</p>\n  <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Transactional</span></span><br><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> Map&lt;String, String&gt; <span class=\"title function_\">addOrder</span><span class=\"params\">(String cids, Orders orders)</span> &#123;</span><br><span class=\"line\">    log.info(<span class=\"string\">&quot;add order begin...&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 1ã€æ ¹æ®cidsæŸ¥è¯¢å½“å‰è®¢å•ä¸­å…³è”çš„è´­ç‰©è½¦è®°å½•è¯¦æƒ…ï¼ˆåŒ…æ‹¬åº“å­˜ï¼‰</span></span><br><span class=\"line\">    String[] arr = cids.split(<span class=\"string\">&quot;ï¼Œ&quot;</span>);</span><br><span class=\"line\">    List&lt;Integer&gt; cidsList = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (String s : arr) &#123;</span><br><span class=\"line\">        cidsList.add(Integer.parseInt(s));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// è·å–æ‰€æœ‰skuId</span></span><br><span class=\"line\">    List&lt;ShoppingCartVO&gt; list = shoppingCartMapper.selectShopCartByCids(cidsList);</span><br><span class=\"line\">    List&lt;String&gt; lockedSkuIds = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;&gt;();</span><br><span class=\"line\">    Map&lt;String, RLock&gt; locks = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;&gt;(); <span class=\"comment\">// &#123;&quot;1&quot;:lock1, &quot;2&quot;:lock2&#125;</span></span><br><span class=\"line\">    <span class=\"type\">boolean</span> <span class=\"variable\">allLocked</span> <span class=\"operator\">=</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (ShoppingCartVO sc : list) &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">skuId</span> <span class=\"operator\">=</span> sc.getSkuId();</span><br><span class=\"line\">        <span class=\"type\">boolean</span> <span class=\"variable\">b</span> <span class=\"operator\">=</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">        <span class=\"type\">RLock</span> <span class=\"variable\">lock</span> <span class=\"operator\">=</span> redissonClient.getLock(skuId);</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            b = lock.tryLock(<span class=\"number\">10</span>, <span class=\"number\">3</span>, TimeUnit.SECONDS);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!b) &#123;</span><br><span class=\"line\">            allLocked = <span class=\"literal\">false</span>;</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            lockedSkuIds.add(skuId);</span><br><span class=\"line\">            locks.put(skuId, lock);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    Map&lt;String, String&gt; map = <span class=\"literal\">null</span>;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (allLocked) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 2ã€æ ¡éªŒåº“å­˜</span></span><br><span class=\"line\">            list = shoppingCartMapper.selectShopCartByCids(cidsList);</span><br><span class=\"line\">            <span class=\"type\">boolean</span> <span class=\"variable\">f</span> <span class=\"operator\">=</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">            <span class=\"type\">StringBuilder</span> <span class=\"variable\">sb</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">StringBuilder</span>();</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (ShoppingCartVO sc : list) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (Integer.parseInt(sc.getCartNum()) &gt; sc.getSkuStock()) &#123;</span><br><span class=\"line\">                    f = <span class=\"literal\">false</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"comment\">//è·å–æ‰€æœ‰å•†å“çš„åç§°ï¼Œä»¥é€—å·æ‹¼æ¥æˆå­—ç¬¦ä¸²</span></span><br><span class=\"line\">                sb.append(sc.getProductName()).append(<span class=\"string\">&quot;ï¼Œ&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"type\">String</span> <span class=\"variable\">untitled</span> <span class=\"operator\">=</span> sb.toString();</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (f) &#123;</span><br><span class=\"line\">                log.info(<span class=\"string\">&quot;product stock is ok ... &quot;</span>);</span><br><span class=\"line\">                <span class=\"comment\">// 3ã€è¡¨ç¤ºåº“å­˜å……è¶³----ä¿å­˜è®¢å•</span></span><br><span class=\"line\">                <span class=\"comment\">// a.userId   b.untitled  c.æ”¶è´§äººä¿¡æ¯ï¼šå§“åã€ç”µè¯ã€åœ°å€</span></span><br><span class=\"line\">                <span class=\"comment\">// d.æ€»ä»·æ ¼   e.æ”¯ä»˜æ–¹å¼   f.è®¢å•çš„åˆ›å»ºæ—¶é—´  g.è®¢å•åˆå§‹çŠ¶æ€</span></span><br><span class=\"line\">                orders.setUntitled(untitled);</span><br><span class=\"line\">                orders.setCreateTime(<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>());</span><br><span class=\"line\">                orders.setStatus(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"comment\">// ç”Ÿæˆè®¢å•ç¼–å·</span></span><br><span class=\"line\">                <span class=\"type\">String</span> <span class=\"variable\">orderId</span> <span class=\"operator\">=</span> UUID.randomUUID().toString().replace(<span class=\"string\">&quot;-&quot;</span>ï¼Œ <span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">                orders.setOrderId(orderId);</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"comment\">// ä¿å­˜è®¢å•</span></span><br><span class=\"line\">                ordersMapper.insert(orders);</span><br><span class=\"line\">                <span class=\"comment\">// 4ã€ç”Ÿæˆå•†å“å¿«ç…§</span></span><br><span class=\"line\">                <span class=\"keyword\">for</span> (ShoppingCartVO sc : list) &#123;</span><br><span class=\"line\">                    <span class=\"type\">int</span> <span class=\"variable\">cnum</span> <span class=\"operator\">=</span> Integer.parseInt(sc.getCartNum());</span><br><span class=\"line\">                    <span class=\"type\">String</span> <span class=\"variable\">itemId</span> <span class=\"operator\">=</span> System.currentTimeMillis() + <span class=\"string\">&quot;&quot;</span> + (<span class=\"keyword\">new</span> <span class=\"title class_\">Random</span>().nextInt(<span class=\"number\">89999</span>) + <span class=\"number\">10000</span>);</span><br><span class=\"line\">                    <span class=\"type\">OrderItem</span> <span class=\"variable\">orderItem</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">OrderItem</span>(itemId, orderId, sc.getProductId()ï¼Œ sc.getProductName()ï¼Œ sc.getProductImg()ï¼Œ sc.getSkuId()ï¼Œ</span><br><span class=\"line\">                                                        sc.getSkuName()ï¼Œ BigDecimal.valueOf(sc.getSellPrice())ï¼Œ cnum, <span class=\"keyword\">new</span> <span class=\"title class_\">BigDecimal</span>(sc.getSellPrice() * cnum)ï¼Œ <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>()ï¼Œ <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>()ï¼Œ <span class=\"number\">0</span>);</span><br><span class=\"line\">                    orderItemMapper.insert(orderItem);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"comment\">// 5ã€æ‰£å‡åº“å­˜ï¼šæ ¹æ®å¥—é¤Idä¿®æ”¹å¥—é¤åº“å­˜é‡</span></span><br><span class=\"line\">                <span class=\"keyword\">for</span> (ShoppingCartVO sc : list) &#123;</span><br><span class=\"line\">                    <span class=\"type\">String</span> <span class=\"variable\">skuId</span> <span class=\"operator\">=</span> sc.getSkuId();</span><br><span class=\"line\">                    <span class=\"type\">int</span> <span class=\"variable\">newStock</span> <span class=\"operator\">=</span> sc.getSkuStock() - Integer.parseInt(sc.getCartNum());</span><br><span class=\"line\"></span><br><span class=\"line\">                    <span class=\"type\">ProductSku</span> <span class=\"variable\">productSku</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ProductSku</span>();</span><br><span class=\"line\">                    productSku.setSkuId(skuId);</span><br><span class=\"line\">                    productSku.setStock(newStock);</span><br><span class=\"line\">                    <span class=\"comment\">//æ ¹æ®ä¸»é”®æ¥ä¿®æ”¹å±æ€§å€¼</span></span><br><span class=\"line\">                    productSkuMapper.updateByPrimaryKeySelective(productSku);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"comment\">// 6ã€åˆ é™¤è´­ç‰©è½¦ï¼šå½“è´­ç‰©è½¦ä¸­çš„è®°å½•è´­ä¹°æˆåŠŸä¹‹åï¼Œè´­ç‰©è½¦ä¸­å¯¹åº”åšåˆ é™¤æ“ä½œ</span></span><br><span class=\"line\">                <span class=\"keyword\">for</span> (<span class=\"type\">int</span> cid : cidsList) &#123;</span><br><span class=\"line\">                    shoppingCartMapper.deleteByPrimaryKey(cid);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                log.info(<span class=\"string\">&quot;add order finished... &quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">                map = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;&gt;();</span><br><span class=\"line\">                map.put(<span class=\"string\">&quot;orderId&quot;</span>ï¼Œ orderId);</span><br><span class=\"line\">                map.put(<span class=\"string\">&quot;productNames&quot;</span>ï¼Œ untitled);</span><br><span class=\"line\"></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">        e.printStackTrace();</span><br><span class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// é‡Šæ”¾é”</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (String lockedSkuId : lockedSkuIds) &#123;</span><br><span class=\"line\">            locks.get(lockedSkuId).unlock();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> map;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h3 id=\"åˆ†å¸ƒå¼é”ç‰¹ç‚¹\"><a href=\"#åˆ†å¸ƒå¼é”ç‰¹ç‚¹\" class=\"headerlink\" title=\"åˆ†å¸ƒå¼é”ç‰¹ç‚¹\"></a>åˆ†å¸ƒå¼é”ç‰¹ç‚¹</h3><ol>\n<li><p>äº’æ–¥æ€§</p>\n<p> ä¿è¯åœ¨ä¸åŒèŠ‚ç‚¹é—´ä¸åŒçº¿ç¨‹çš„äº’æ–¥ï¼ˆåªæœ‰ä¸€ä¸ªèŠ‚ç‚¹å½“ç„¶å¯ä»¥ï¼‰</p>\n</li>\n<li><p>å¯é‡å…¥æ€§</p>\n<p> åŒä¸€ä¸ªèŠ‚ç‚¹ä¸Šçš„åŒä¸€ä¸ªçº¿ç¨‹å¦‚æœè·å–é”ä¹‹åå¯ä»¥å†æ¬¡è·å–åˆ°è¿™ä¸ªé”</p>\n</li>\n<li><p>é”è¶…æ—¶</p>\n<p> åŠ é”æˆåŠŸä¹‹åè®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œä»¥é˜²æ­¢çº¿ç¨‹æ•…éšœå¯¼è‡´ä¸é‡Šæ”¾é”è€Œå¼•èµ·æ­»é”</p>\n</li>\n<li><p>é«˜æ•ˆã€é«˜å¯ç”¨</p>\n<p> æ”¯æŒå•èŠ‚ç‚¹ Redisã€ä¸»ä» Redisã€é›†ç¾¤ Redis</p>\n</li>\n<li><p>æ”¯æŒé˜»å¡å’Œéé˜»å¡</p>\n<p> tryLock éé˜»å¡ å’Œ tryLock(long timeOut) é˜»å¡</p>\n</li>\n</ol>\n<h3 id=\"Redisson-çš„ä½¿ç”¨\"><a href=\"#Redisson-çš„ä½¿ç”¨\" class=\"headerlink\" title=\"Redisson çš„ä½¿ç”¨\"></a>Redisson çš„ä½¿ç”¨</h3><ol>\n<li><p>è·å–é”ï¼ˆå…¬å¹³é” &#x2F; éå…¬å¹³é”ï¼‰</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å…¬å¹³é”</span></span><br><span class=\"line\"><span class=\"type\">RLock</span> <span class=\"variable\">lock</span> <span class=\"operator\">=</span> redissonClient.getFairLock(skuId);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// éå…¬å¹³é”</span></span><br><span class=\"line\"><span class=\"type\">RLock</span> <span class=\"variable\">lock</span> <span class=\"operator\">=</span> redissonClient.getLock(skuId);</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>åŠ é”ï¼ˆé˜»å¡é” &#x2F; éé˜»å¡é”ï¼‰</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// é˜»å¡é”ï¼Œè®¾ç½®åŠ é”æˆåŠŸåçš„è¶…æ—¶æ—¶é—´ 20sï¼Œä¸åŠ æ—¶é—´é»˜è®¤ 30s</span></span><br><span class=\"line\">lock.lock(<span class=\"number\">20</span>, TimeUnit.SECONDS);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// éé˜»å¡é”ï¼ˆè®¾ç½®ç­‰å¾…æ—¶é—´ 3sï¼ŒåŠ é”æˆåŠŸåçš„è¶…æ—¶æ—¶é—´ 10sï¼Œä¸åŠ åˆ™é»˜è®¤ 30sï¼‰</span></span><br><span class=\"line\">lock.tryLock(<span class=\"number\">10</span>, <span class=\"number\">3</span>, TimeUnit.SECONDS);</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>é‡Šæ”¾é”</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">lock.unlock();</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>å®ä¾‹</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å…¬å¹³éé˜»å¡é”</span></span><br><span class=\"line\"><span class=\"type\">RLock</span> <span class=\"variable\">lock</span> <span class=\"operator\">=</span> redissonClient.getLock(skuId);</span><br><span class=\"line\">lock.tryLock(<span class=\"number\">10</span>, <span class=\"number\">3</span>, TimeUnit.SECONDS);</span><br></pre></td></tr></table></figure></li>\n</ol>\n<hr>\n<h2 id=\"ç¼“å­˜ä¸æ•°æ®åº“åŒå†™ä¸€è‡´æ€§\"><a href=\"#ç¼“å­˜ä¸æ•°æ®åº“åŒå†™ä¸€è‡´æ€§\" class=\"headerlink\" title=\"ç¼“å­˜ä¸æ•°æ®åº“åŒå†™ä¸€è‡´æ€§\"></a>ç¼“å­˜ä¸æ•°æ®åº“åŒå†™ä¸€è‡´æ€§</h2><p>æ€»ç»“ï¼š</p>\n<p>è¯»æ•°æ®ï¼šå…ˆè¯»ç¼“å­˜ï¼Œå¦‚æœæœ‰ç›´æ¥è¿”å›ï¼Œå¦‚æœæ²¡æœ‰æŸ¥æ•°æ®åº“æŸ¥åˆ°æ•°æ®å­˜åˆ°ç¼“å­˜ä¸­å¹¶è¿”å›</p>\n<p>å†™æ•°æ®ï¼šå…ˆå†™æ•°æ®åº“ï¼Œå†åˆ ç¼“å­˜ï¼Œè¿™ä¸ªé˜¶æ®µå¯èƒ½åˆ ç¼“å­˜å¤±è´¥ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ä¸€ä¸‹ä¸‰ç§æ–¹æ¡ˆï¼š</p>\n<ol>\n<li>å¦‚æœåˆ é™¤ç¼“å­˜å¤±è´¥ï¼Œéœ€è¦å°†æ•°æ®å†™å…¥é‡è¯•è¡¨ï¼Œç„¶åä½¿ç”¨ elastic-job ç­‰å®šæ—¶ä»»åŠ¡è¿›è¡Œé‡è¯•ã€‚</li>\n<li>å¦‚æœåˆ é™¤ç¼“å­˜å¤±è´¥ï¼Œéœ€è¦å°†æ•°æ®å‘é€ mq æ¶ˆæ¯åˆ° mq æœåŠ¡å™¨ï¼Œåœ¨ mq çš„ consumer ä¸­å¤„ç†ã€‚</li>\n<li>è®¢é˜… mysql çš„ binlogï¼Œåœ¨è®¢é˜…è€…ä¸­ï¼Œå¦‚æœå‘ç°äº†æ›´æ–°æ•°æ®è¯·æ±‚ï¼Œåˆ™åˆ é™¤ç›¸åº”çš„ç¼“å­˜ã€‚</li>\n</ol>\n<blockquote>\n<p><a href=\"https://www.zhihu.com/question/319817091/answer/2432904728\">å¦‚ä½•ä¿è¯æ•°æ®åº“å’Œç¼“å­˜åŒå†™ä¸€è‡´æ€§ï¼Ÿ-è‹ä¸‰è¯´æŠ€æœ¯</a></p>\n</blockquote>\n<h3 id=\"é—®é¢˜å¼•å…¥\"><a href=\"#é—®é¢˜å¼•å…¥\" class=\"headerlink\" title=\"é—®é¢˜å¼•å…¥\"></a>é—®é¢˜å¼•å…¥</h3><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨ç¼“å­˜çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æå‡æŸ¥è¯¢çš„æ€§èƒ½ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ˜¯è¿™æ ·ä½¿ç”¨ç¼“å­˜çš„ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650526232523.png\" alt=\"å›¾ç‰‡\"></p>\n<ol>\n<li>ç”¨æˆ·è¯·æ±‚è¿‡æ¥ä¹‹åï¼Œå…ˆæŸ¥ç¼“å­˜æœ‰æ²¡æœ‰æ•°æ®ï¼Œå¦‚æœæœ‰åˆ™ç›´æ¥è¿”å›ã€‚</li>\n<li>å¦‚æœç¼“å­˜æ²¡æ•°æ®ï¼Œå†ç»§ç»­æŸ¥æ•°æ®åº“ã€‚</li>\n<li>å¦‚æœæ•°æ®åº“æœ‰æ•°æ®ï¼Œåˆ™å°†æŸ¥è¯¢å‡ºæ¥çš„æ•°æ®ï¼Œæ”¾å…¥ç¼“å­˜ä¸­ï¼Œç„¶åè¿”å›è¯¥æ•°æ®ã€‚</li>\n<li>å¦‚æœæ•°æ®åº“ä¹Ÿæ²¡æ•°æ®ï¼Œåˆ™ç›´æ¥è¿”å›ç©ºã€‚</li>\n</ol>\n<p>è¿™æ˜¯ç¼“å­˜éå¸¸å¸¸è§çš„ç”¨æ³•ã€‚ä¸€çœ¼çœ‹ä¸Šå»ï¼Œå¥½åƒæ²¡æœ‰å•¥é—®é¢˜ã€‚</p>\n<p>ä½†ä½ å¿½ç•¥äº†ä¸€ä¸ªéå¸¸é‡è¦çš„ç»†èŠ‚ï¼š<strong>å¦‚æœæ•°æ®åº“ä¸­çš„æŸæ¡æ•°æ®ï¼Œæ”¾å…¥ç¼“å­˜ä¹‹åï¼Œåˆç«‹é©¬è¢«æ›´æ–°äº†ï¼Œé‚£ä¹ˆè¯¥å¦‚ä½•æ›´æ–°ç¼“å­˜å‘¢ï¼Ÿ</strong></p>\n<p>ä¸æ›´æ–°ç¼“å­˜è¡Œä¸è¡Œï¼Ÿ</p>\n<p>ç­”ï¼šå½“ç„¶ä¸è¡Œï¼Œå¦‚æœä¸æ›´æ–°ç¼“å­˜ï¼Œåœ¨å¾ˆé•¿çš„ä¸€æ®µæ—¶é—´å†…ï¼ˆå†³å®šäºç¼“å­˜çš„è¿‡æœŸæ—¶é—´ï¼‰ï¼Œç”¨æˆ·è¯·æ±‚ä»ç¼“å­˜ä¸­è·å–åˆ°çš„éƒ½å¯èƒ½æ˜¯æ—§å€¼ï¼Œè€Œéæ•°æ®åº“çš„æœ€æ–°å€¼ã€‚è¿™ä¸æ˜¯æœ‰æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ï¼Ÿ</p>\n<p>é‚£ä¹ˆï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•æ›´æ–°ç¼“å­˜å‘¢ï¼Ÿ</p>\n<p>ç›®å‰æœ‰ä»¥ä¸‹ 4 ç§æ–¹æ¡ˆï¼š</p>\n<ol>\n<li>å…ˆå†™ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“</li>\n<li>å…ˆå†™æ•°æ®åº“ï¼Œå†å†™ç¼“å­˜</li>\n<li>å…ˆåˆ ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“</li>\n<li>å…ˆå†™æ•°æ®åº“ï¼Œå†åˆ ç¼“å­˜</li>\n</ol>\n<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¯¦ç»†è¯´è¯´è¿™ 4 ç§æ–¹æ¡ˆã€‚</p>\n<h3 id=\"å…ˆå†™ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“\"><a href=\"#å…ˆå†™ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“\" class=\"headerlink\" title=\"å…ˆå†™ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“\"></a>å…ˆå†™ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“</h3><p>å¯¹äºæ›´æ–°ç¼“å­˜çš„æ–¹æ¡ˆï¼Œå¾ˆå¤šäººç¬¬ä¸€ä¸ªæƒ³åˆ°çš„å¯èƒ½æ˜¯åœ¨å†™æ“ä½œä¸­ç›´æ¥æ›´æ–°ç¼“å­˜ï¼ˆå†™ç¼“å­˜ï¼‰ï¼Œæ›´ç›´æ¥æ˜äº†ã€‚</p>\n<p>é‚£ä¹ˆï¼Œé—®é¢˜æ¥äº†ï¼šåœ¨å†™æ“ä½œä¸­ï¼Œåˆ°åº•æ˜¯å…ˆå†™ç¼“å­˜ï¼Œè¿˜æ˜¯å…ˆå†™æ•°æ®åº“å‘¢ï¼Ÿ</p>\n<p>æˆ‘ä»¬åœ¨è¿™é‡Œå…ˆèŠèŠå…ˆå†™ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“çš„æƒ…å†µï¼Œå› ä¸ºå®ƒçš„é—®é¢˜æœ€ä¸¥é‡ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650526427819.png\" alt=\"å›¾ç‰‡\"></p>\n<p>æŸä¸€ä¸ªç”¨æˆ·çš„æ¯ä¸€æ¬¡å†™æ“ä½œï¼Œå¦‚æœåˆšå†™å®Œç¼“å­˜ï¼Œçªç„¶ç½‘ç»œå‡ºç°äº†å¼‚å¸¸ï¼Œå¯¼è‡´å†™æ•°æ®åº“å¤±è´¥äº†ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650526436447.png\" alt=\"å›¾ç‰‡\"></p>\n<p>å…¶ç»“æœæ˜¯ç¼“å­˜æ›´æ–°æˆäº†æœ€æ–°æ•°æ®ï¼Œä½†æ•°æ®åº“æ²¡æœ‰ï¼Œè¿™æ ·ç¼“å­˜ä¸­çš„æ•°æ®ä¸å°±å˜æˆè„æ•°æ®äº†ï¼Ÿå¦‚æœæ­¤æ—¶è¯¥ç”¨æˆ·çš„æŸ¥è¯¢è¯·æ±‚ï¼Œæ­£å¥½è¯»å–åˆ°è¯¥æ•°æ®ï¼Œå°±ä¼šå‡ºç°é—®é¢˜ï¼Œå› ä¸ºè¯¥æ•°æ®åœ¨æ•°æ®åº“ä¸­æ ¹æœ¬ä¸å­˜åœ¨ï¼Œè¿™ä¸ªé—®é¢˜éå¸¸ä¸¥é‡ã€‚</p>\n<p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œç¼“å­˜çš„ä¸»è¦ç›®çš„æ˜¯æŠŠæ•°æ®åº“çš„æ•°æ®ä¸´æ—¶ä¿å­˜åœ¨å†…å­˜ï¼Œä¾¿äºåç»­çš„æŸ¥è¯¢ï¼Œæå‡æŸ¥è¯¢é€Ÿåº¦ã€‚</p>\n<p>ä½†å¦‚æœæŸæ¡æ•°æ®ï¼Œåœ¨æ•°æ®åº“ä¸­éƒ½ä¸å­˜åœ¨ï¼Œä½ ç¼“å­˜è¿™ç§â€œ<code>å‡æ•°æ®</code>â€åˆæœ‰å•¥æ„ä¹‰å‘¢ï¼Ÿ</p>\n<p>å› æ­¤ï¼Œå…ˆå†™ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“çš„æ–¹æ¡ˆæ˜¯ä¸å¯å–çš„ï¼Œåœ¨å®é™…å·¥ä½œä¸­ç”¨å¾—ä¸å¤šã€‚</p>\n<h3 id=\"å…ˆå†™æ•°æ®åº“ï¼Œå†å†™ç¼“å­˜\"><a href=\"#å…ˆå†™æ•°æ®åº“ï¼Œå†å†™ç¼“å­˜\" class=\"headerlink\" title=\"å…ˆå†™æ•°æ®åº“ï¼Œå†å†™ç¼“å­˜\"></a>å…ˆå†™æ•°æ®åº“ï¼Œå†å†™ç¼“å­˜</h3><p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650526499487.png\" alt=\"å›¾ç‰‡\"></p>\n<p>ç”¨æˆ·çš„å†™æ“ä½œï¼Œå…ˆå†™æ•°æ®åº“ï¼Œå†å†™ç¼“å­˜ï¼Œå¯ä»¥é¿å…ä¹‹å‰â€œå‡æ•°æ®â€çš„é—®é¢˜ã€‚ä½†å®ƒå´å¸¦æ¥äº†æ–°çš„é—®é¢˜ã€‚</p>\n<h4 id=\"å†™ç¼“å­˜å¤±è´¥äº†\"><a href=\"#å†™ç¼“å­˜å¤±è´¥äº†\" class=\"headerlink\" title=\"å†™ç¼“å­˜å¤±è´¥äº†\"></a>å†™ç¼“å­˜å¤±è´¥äº†</h4><p>å¦‚æœæŠŠå†™æ•°æ®åº“å’Œå†™ç¼“å­˜æ“ä½œï¼Œæ”¾åœ¨åŒä¸€ä¸ªäº‹åŠ¡å½“ä¸­ï¼Œå½“å†™ç¼“å­˜å¤±è´¥äº†ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå†™å…¥æ•°æ®åº“çš„æ•°æ®è¿›è¡Œå›æ»šã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650526558901.png\" alt=\"å›¾ç‰‡\"></p>\n<p>å¦‚æœæ˜¯å¹¶å‘é‡æ¯”è¾ƒå°ï¼Œå¯¹æ¥å£æ€§èƒ½è¦æ±‚ä¸å¤ªé«˜çš„ç³»ç»Ÿï¼Œå¯ä»¥è¿™ä¹ˆç©ã€‚</p>\n<p>ä½†å¦‚æœåœ¨é«˜å¹¶å‘çš„ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œå†™æ•°æ®åº“å’Œå†™ç¼“å­˜ï¼Œéƒ½å±äºè¿œç¨‹æ“ä½œã€‚ä¸ºäº†é˜²æ­¢å‡ºç°å¤§äº‹åŠ¡ï¼Œé€ æˆçš„æ­»é”é—®é¢˜ï¼Œé€šå¸¸å»ºè®®å†™æ•°æ®åº“å’Œå†™ç¼“å­˜ä¸è¦æ”¾åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ã€‚</p>\n<p>ä¹Ÿå°±æ˜¯è¯´åœ¨è¯¥æ–¹æ¡ˆä¸­ï¼Œå¦‚æœå†™æ•°æ®åº“æˆåŠŸäº†ï¼Œä½†å†™ç¼“å­˜å¤±è´¥äº†ï¼Œæ•°æ®åº“ä¸­å·²å†™å…¥çš„æ•°æ®ä¸ä¼šå›æ»šã€‚</p>\n<p>è¿™å°±ä¼šå‡ºç°ï¼šæ•°æ®åº“æ˜¯<code>æ–°æ•°æ®</code>ï¼Œè€Œç¼“å­˜æ˜¯<code>æ—§æ•°æ®</code>ï¼Œä¸¤è¾¹<code>æ•°æ®ä¸ä¸€è‡´</code>çš„æƒ…å†µã€‚</p>\n<h4 id=\"é«˜å¹¶å‘ä¸‹çš„é—®é¢˜\"><a href=\"#é«˜å¹¶å‘ä¸‹çš„é—®é¢˜\" class=\"headerlink\" title=\"é«˜å¹¶å‘ä¸‹çš„é—®é¢˜\"></a>é«˜å¹¶å‘ä¸‹çš„é—®é¢˜</h4><p>å‡è®¾åœ¨é«˜å¹¶å‘çš„åœºæ™¯ä¸­ï¼Œé’ˆå¯¹åŒä¸€ä¸ªç”¨æˆ·çš„åŒä¸€æ¡æ•°æ®ï¼Œæœ‰ä¸¤ä¸ªå†™æ•°æ®è¯·æ±‚ï¼ša å’Œ bï¼Œå®ƒä»¬åŒæ—¶è¯·æ±‚åˆ°ä¸šåŠ¡ç³»ç»Ÿã€‚</p>\n<p>å…¶ä¸­è¯·æ±‚ a è·å–çš„æ˜¯æ—§æ•°æ®ï¼Œè€Œè¯·æ±‚ b è·å–çš„æ˜¯æ–°æ•°æ®ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650526645914.png\" alt=\"å›¾ç‰‡\"></p>\n<ol>\n<li>è¯·æ±‚ a å…ˆè¿‡æ¥ï¼Œåˆšå†™å®Œäº†æ•°æ®åº“ã€‚ä½†ç”±äºç½‘ç»œåŸå› ï¼Œå¡é¡¿äº†ä¸€ä¸‹ï¼Œè¿˜æ²¡æ¥å¾—åŠå†™ç¼“å­˜ã€‚</li>\n<li>è¿™æ—¶å€™è¯·æ±‚ b è¿‡æ¥äº†ï¼Œå…ˆå†™äº†æ•°æ®åº“ã€‚</li>\n<li>æ¥ä¸‹æ¥ï¼Œè¯·æ±‚ b é¡ºåˆ©å†™äº†ç¼“å­˜ã€‚</li>\n<li>æ­¤æ—¶ï¼Œè¯·æ±‚ a å¡é¡¿ç»“æŸï¼Œä¹Ÿå†™äº†ç¼“å­˜ã€‚</li>\n</ol>\n<p>å¾ˆæ˜¾ç„¶ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹å½“ä¸­ï¼Œè¯·æ±‚ b åœ¨ç¼“å­˜ä¸­çš„<code>æ–°æ•°æ®</code>ï¼Œè¢«è¯·æ±‚ a çš„<code>æ—§æ•°æ®</code>è¦†ç›–äº†ã€‚</p>\n<p>ä¹Ÿå°±æ˜¯è¯´ï¼šåœ¨é«˜å¹¶å‘åœºæ™¯ä¸­ï¼Œå¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶æ‰§è¡Œå…ˆå†™æ•°æ®åº“ï¼Œå†å†™ç¼“å­˜çš„æ“ä½œï¼Œå¯èƒ½ä¼šå‡ºç°æ•°æ®åº“æ˜¯æ–°å€¼ï¼Œè€Œç¼“å­˜ä¸­æ˜¯æ—§å€¼ï¼Œä¸¤è¾¹æ•°æ®ä¸ä¸€è‡´çš„æƒ…å†µã€‚</p>\n<h4 id=\"æµªè´¹ç³»ç»Ÿèµ„æº\"><a href=\"#æµªè´¹ç³»ç»Ÿèµ„æº\" class=\"headerlink\" title=\"æµªè´¹ç³»ç»Ÿèµ„æº\"></a>æµªè´¹ç³»ç»Ÿèµ„æº</h4><p>æœ‰äº›ä¸šåŠ¡åœºæ™¯æ¯”è¾ƒç‰¹æ®Šï¼š<code>å†™å¤šè¯»å°‘</code>ã€‚</p>\n<p>å¦‚æœåœ¨è¿™ç±»ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œæ¯ä¸ªç”¨çš„å†™æ“ä½œï¼Œéƒ½éœ€è¦å†™ä¸€æ¬¡ç¼“å­˜ï¼Œæœ‰ç‚¹å¾—ä¸å¿å¤±ã€‚</p>\n<p>è¿˜ä¸å¦‚ä¸ç”¨ Redisï¼Œåæ­£å†™æ•°æ®åº“éƒ½è¦å†™ï¼Œæˆ‘è¯»æ•°æ®åˆæ¯”è¾ƒå°‘ï¼ŒRedis ä½¿ç”¨é¢‘ç‡ä½ï¼Œå´è¿˜è¦ä¸€ç›´æ›´æ–° Redis ä¸­æ•°æ®ã€‚</p>\n<h3 id=\"å…ˆåˆ ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“\"><a href=\"#å…ˆåˆ ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“\" class=\"headerlink\" title=\"å…ˆåˆ ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“\"></a>å…ˆåˆ ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“</h3><p>ä¸ç„¶æ˜¯å…ˆå†™ç¼“å­˜è¿˜æ˜¯å…ˆå†™æ•°æ®åº“éƒ½æœ‰å¾ˆå¤šé—®é¢˜ï¼Œé‚£ä¹ˆè€ƒè™‘ä¸æ˜¯ <code>æ›´æ–°ç¼“å­˜</code> è€Œæ˜¯ <code>åˆ é™¤ç¼“å­˜</code>ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650526855730.png\" alt=\"å›¾ç‰‡\"></p>\n<p>åœ¨ç”¨æˆ·çš„å†™æ“ä½œä¸­ï¼Œå…ˆæ‰§è¡Œåˆ é™¤ç¼“å­˜æ“ä½œï¼Œå†å»å†™æ•°æ®åº“</p>\n<h4 id=\"é«˜å¹¶å‘ä¸‹çš„é—®é¢˜-1\"><a href=\"#é«˜å¹¶å‘ä¸‹çš„é—®é¢˜-1\" class=\"headerlink\" title=\"é«˜å¹¶å‘ä¸‹çš„é—®é¢˜\"></a>é«˜å¹¶å‘ä¸‹çš„é—®é¢˜</h4><p>å‡è®¾åœ¨é«˜å¹¶å‘çš„åœºæ™¯ä¸­ï¼ŒåŒä¸€ä¸ªç”¨æˆ·çš„åŒä¸€æ¡æ•°æ®ï¼Œæœ‰ä¸€ä¸ªè¯»æ•°æ®è¯·æ±‚ cï¼Œè¿˜æœ‰å¦ä¸€ä¸ªå†™æ•°æ®è¯·æ±‚ dï¼ˆä¸€ä¸ªæ›´æ–°æ“ä½œï¼‰ï¼ŒåŒæ—¶è¯·æ±‚åˆ°ä¸šåŠ¡ç³»ç»Ÿã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650527043982.png\" alt=\"å›¾ç‰‡\"></p>\n<ol>\n<li>è¯·æ±‚ d å…ˆè¿‡æ¥ï¼ŒæŠŠç¼“å­˜åˆ é™¤äº†ã€‚ä½†ç”±äºç½‘ç»œåŸå› ï¼Œå¡é¡¿äº†ä¸€ä¸‹ï¼Œè¿˜æ²¡æ¥å¾—åŠå†™æ•°æ®åº“ã€‚</li>\n<li>è¿™æ—¶è¯·æ±‚ c è¿‡æ¥äº†ï¼Œå…ˆæŸ¥ç¼“å­˜å‘ç°æ²¡æ•°æ®ï¼Œå†æŸ¥æ•°æ®åº“ï¼Œæœ‰æ•°æ®ï¼Œä½†æ˜¯æ—§å€¼ã€‚</li>\n<li>è¯·æ±‚ c å°†æ•°æ®åº“ä¸­çš„æ—§å€¼ï¼Œæ›´æ–°åˆ°ç¼“å­˜ä¸­ã€‚</li>\n<li>æ­¤æ—¶ï¼Œè¯·æ±‚ d å¡é¡¿ç»“æŸï¼ŒæŠŠæ–°å€¼å†™å…¥æ•°æ®åº“ã€‚</li>\n</ol>\n<p>åœ¨è¿™ä¸ªè¿‡ç¨‹å½“ä¸­ï¼Œè¯·æ±‚ d çš„æ–°å€¼å¹¶æ²¡æœ‰è¢«è¯·æ±‚ c å†™å…¥ç¼“å­˜ï¼ŒåŒæ ·ä¼šå¯¼è‡´ç¼“å­˜å’Œæ•°æ®åº“çš„æ•°æ®ä¸ä¸€è‡´çš„æƒ…å†µã€‚</p>\n<h4 id=\"ç¼“å­˜åŒåˆ \"><a href=\"#ç¼“å­˜åŒåˆ \" class=\"headerlink\" title=\"ç¼“å­˜åŒåˆ \"></a>ç¼“å­˜åŒåˆ </h4><p>åœ¨ä¸Šé¢çš„ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œä¸€ä¸ªè¯»æ•°æ®è¯·æ±‚ï¼Œä¸€ä¸ªå†™æ•°æ®è¯·æ±‚ã€‚å½“å†™æ•°æ®è¯·æ±‚æŠŠç¼“å­˜åˆ äº†ä¹‹åï¼Œè¯»æ•°æ®è¯·æ±‚ï¼Œå¯èƒ½æŠŠå½“æ—¶ä»æ•°æ®åº“æŸ¥è¯¢å‡ºæ¥çš„æ—§å€¼ï¼Œå†™å…¥ç¼“å­˜å½“ä¸­ã€‚</p>\n<p>æœ‰äººè¯´è¿˜ä¸å¥½åŠï¼Œè¯·æ±‚ d åœ¨å†™å®Œæ•°æ®åº“ä¹‹åï¼ŒæŠŠç¼“å­˜é‡æ–°åˆ ä¸€æ¬¡ä¸å°±è¡Œäº†ï¼Ÿ</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650528097218.png\" alt=\"å›¾ç‰‡\"></p>\n<p>è¿™å°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„<code>ç¼“å­˜åŒåˆ </code>ï¼Œå³åœ¨å†™æ•°æ®åº“ä¹‹å‰åˆ é™¤ä¸€æ¬¡ï¼Œå†™å®Œæ•°æ®åº“åï¼Œå†åˆ é™¤ä¸€æ¬¡ã€‚</p>\n<p>è¯¥æ–¹æ¡ˆæœ‰ä¸ªéå¸¸å…³é”®çš„åœ°æ–¹æ˜¯ï¼šç¬¬äºŒæ¬¡åˆ é™¤ç¼“å­˜ï¼Œå¹¶éç«‹é©¬å°±åˆ ï¼Œè€Œæ˜¯è¦åœ¨ä¸€å®šçš„<code>æ—¶é—´é—´éš”</code>ä¹‹åã€‚</p>\n<p>æˆ‘ä»¬å†é‡æ–°å›é¡¾ä¸€ä¸‹ï¼Œé«˜å¹¶å‘ä¸‹ä¸€ä¸ªè¯»æ•°æ®è¯·æ±‚ï¼Œä¸€ä¸ªå†™æ•°æ®è¯·æ±‚å¯¼è‡´æ•°æ®ä¸ä¸€è‡´çš„äº§ç”Ÿè¿‡ç¨‹ï¼š</p>\n<ol>\n<li>è¯·æ±‚ d å…ˆè¿‡æ¥ï¼ŒæŠŠç¼“å­˜åˆ é™¤äº†ã€‚ä½†ç”±äºç½‘ç»œåŸå› ï¼Œå¡é¡¿äº†ä¸€ä¸‹ï¼Œè¿˜æ²¡æ¥å¾—åŠå†™æ•°æ®åº“ã€‚</li>\n<li>è¿™æ—¶è¯·æ±‚ c è¿‡æ¥äº†ï¼Œå…ˆæŸ¥ç¼“å­˜å‘ç°æ²¡æ•°æ®ï¼Œå†æŸ¥æ•°æ®åº“ï¼Œæœ‰æ•°æ®ï¼Œä½†æ˜¯æ—§å€¼ã€‚</li>\n<li>è¯·æ±‚ c å°†æ•°æ®åº“ä¸­çš„æ—§å€¼ï¼Œæ›´æ–°åˆ°ç¼“å­˜ä¸­ã€‚</li>\n<li>æ­¤æ—¶ï¼Œè¯·æ±‚ d å¡é¡¿ç»“æŸï¼ŒæŠŠæ–°å€¼å†™å…¥æ•°æ®åº“ã€‚</li>\n<li>ä¸€æ®µæ—¶é—´ä¹‹åï¼Œæ¯”å¦‚ï¼š500msï¼Œè¯·æ±‚ d å°†ç¼“å­˜åˆ é™¤ã€‚</li>\n</ol>\n<p>è¿™æ ·æ¥çœ‹ç¡®å®å¯ä»¥è§£å†³ç¼“å­˜ä¸ä¸€è‡´é—®é¢˜ã€‚</p>\n<p>é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆä¸€å®šè¦é—´éš”ä¸€æ®µæ—¶é—´ä¹‹åï¼Œæ‰èƒ½åˆ é™¤ç¼“å­˜å‘¢ï¼Ÿ</p>\n<p>è¯·æ±‚ d å¡é¡¿ç»“æŸï¼ŒæŠŠæ–°å€¼å†™å…¥æ•°æ®åº“åï¼Œè¯·æ±‚ c å°†æ•°æ®åº“ä¸­çš„æ—§å€¼ï¼Œæ›´æ–°åˆ°ç¼“å­˜ä¸­ã€‚</p>\n<p>æ­¤æ—¶ï¼Œå¦‚æœè¯·æ±‚ d åˆ é™¤å¤ªå¿«ï¼Œåœ¨è¯·æ±‚ c å°†æ•°æ®åº“ä¸­çš„æ—§å€¼æ›´æ–°åˆ°ç¼“å­˜ä¹‹å‰ï¼Œå°±å·²ç»æŠŠç¼“å­˜åˆ é™¤äº†ï¼Œè¿™æ¬¡åˆ é™¤å°±æ²¡ä»»ä½•æ„ä¹‰ã€‚å¿…é¡»è¦åœ¨è¯·æ±‚ c æ›´æ–°ç¼“å­˜ä¹‹åï¼Œå†åˆ é™¤ç¼“å­˜ï¼Œæ‰èƒ½æŠŠæ—§å€¼åŠæ—¶åˆ é™¤äº†ã€‚</p>\n<p>æ‰€ä»¥éœ€è¦åœ¨è¯·æ±‚ d ä¸­åŠ ä¸€ä¸ªæ—¶é—´é—´éš”ï¼Œç¡®ä¿è¯·æ±‚ cï¼Œæˆ–è€…ç±»ä¼¼äºè¯·æ±‚ c çš„å…¶ä»–è¯·æ±‚ï¼Œå¦‚æœåœ¨ç¼“å­˜ä¸­è®¾ç½®äº†æ—§å€¼ï¼Œæœ€ç»ˆéƒ½èƒ½å¤Ÿè¢«è¯·æ±‚ d åˆ é™¤æ‰ã€‚</p>\n<p>æ¥ä¸‹æ¥ï¼Œè¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœç¬¬äºŒæ¬¡åˆ é™¤ç¼“å­˜æ—¶ï¼Œåˆ é™¤å¤±è´¥äº†è¯¥æ€ä¹ˆåŠï¼Ÿ</p>\n<h3 id=\"å…ˆå†™æ•°æ®åº“ï¼Œå†åˆ ç¼“å­˜\"><a href=\"#å…ˆå†™æ•°æ®åº“ï¼Œå†åˆ ç¼“å­˜\" class=\"headerlink\" title=\"å…ˆå†™æ•°æ®åº“ï¼Œå†åˆ ç¼“å­˜\"></a>å…ˆå†™æ•°æ®åº“ï¼Œå†åˆ ç¼“å­˜</h3><p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650528137396.png\" alt=\"å›¾ç‰‡\"></p>\n<p>åœ¨é«˜å¹¶å‘çš„åœºæ™¯ä¸­ï¼Œæœ‰ä¸€ä¸ªè¯»æ•°æ®è¯·æ±‚ï¼Œæœ‰ä¸€ä¸ªå†™æ•°æ®è¯·æ±‚ï¼Œæ›´æ–°è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>\n<ol>\n<li>è¯·æ±‚ e å…ˆå†™æ•°æ®åº“ï¼Œç”±äºç½‘ç»œåŸå› å¡é¡¿äº†ä¸€ä¸‹ï¼Œæ²¡æœ‰æ¥å¾—åŠåˆ é™¤ç¼“å­˜ã€‚</li>\n<li>è¯·æ±‚ f æŸ¥è¯¢ç¼“å­˜ï¼Œå‘ç°ç¼“å­˜ä¸­æœ‰æ•°æ®ï¼Œç›´æ¥è¿”å›è¯¥æ•°æ®ã€‚</li>\n<li>è¯·æ±‚ e åˆ é™¤ç¼“å­˜ã€‚</li>\n</ol>\n<p>åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œåªæœ‰è¯·æ±‚ f è¯»äº†ä¸€æ¬¡æ—§æ•°æ®ï¼Œåæ¥æ—§æ•°æ®è¢«è¯·æ±‚ e åŠæ—¶åˆ é™¤äº†ï¼Œçœ‹èµ·æ¥é—®é¢˜ä¸å¤§ã€‚</p>\n<p>ä½†å¦‚æœæ˜¯è¯»æ•°æ®è¯·æ±‚å…ˆè¿‡æ¥å‘¢ï¼Ÿ</p>\n<ol>\n<li>è¯·æ±‚ f æŸ¥è¯¢ç¼“å­˜ï¼Œå‘ç°ç¼“å­˜ä¸­æœ‰æ•°æ®ï¼Œç›´æ¥è¿”å›è¯¥æ•°æ®ã€‚</li>\n<li>è¯·æ±‚ e å…ˆå†™æ•°æ®åº“ã€‚</li>\n<li>è¯·æ±‚ e åˆ é™¤ç¼“å­˜ã€‚</li>\n</ol>\n<p>è¿™ç§æƒ…å†µçœ‹èµ·æ¥ä¹Ÿæ²¡é—®é¢˜å‘€ï¼Ÿ</p>\n<p>ç­”ï¼šå¯¹çš„ã€‚</p>\n<p>ä½†å°±æ€•å‡ºç°ä¸‹é¢è¿™ç§æƒ…å†µï¼Œå³ç¼“å­˜è‡ªå·±å¤±æ•ˆäº†ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650528267733.png\" alt=\"å›¾ç‰‡\"></p>\n<ol>\n<li>ç¼“å­˜è¿‡æœŸæ—¶é—´åˆ°äº†ï¼Œè‡ªåŠ¨å¤±æ•ˆã€‚</li>\n<li>è¯·æ±‚ f æŸ¥è¯¢ç¼“å­˜ï¼Œå‘ç¼“å­˜ä¸­æ²¡æœ‰æ•°æ®ï¼ŒæŸ¥è¯¢æ•°æ®åº“çš„æ—§å€¼ï¼Œä½†ç”±äºç½‘ç»œåŸå› å¡é¡¿äº†ï¼Œæ²¡æœ‰æ¥å¾—åŠæ›´æ–°ç¼“å­˜ã€‚</li>\n<li>è¯·æ±‚ e å…ˆå†™æ•°æ®åº“ï¼Œæ¥ç€åˆ é™¤äº†ç¼“å­˜ã€‚</li>\n<li>è¯·æ±‚ f æ›´æ–°æ—§å€¼åˆ°ç¼“å­˜ä¸­ã€‚</li>\n</ol>\n<p>è¿™æ—¶ï¼Œç¼“å­˜å’Œæ•°æ®åº“çš„æ•°æ®åŒæ ·å‡ºç°ä¸ä¸€è‡´çš„æƒ…å†µäº†ã€‚</p>\n<p>ä½†è¿™ç§æƒ…å†µè¿˜æ˜¯æ¯”è¾ƒå°‘çš„ï¼Œéœ€è¦åŒæ—¶æ»¡è¶³ä»¥ä¸‹æ¡ä»¶æ‰å¯ä»¥ï¼š</p>\n<ol>\n<li>ç¼“å­˜åˆšå¥½è‡ªåŠ¨å¤±æ•ˆã€‚</li>\n<li>è¯·æ±‚ f ä»æ•°æ®åº“æŸ¥å‡ºæ—§å€¼ï¼Œæ›´æ–°ç¼“å­˜çš„è€—æ—¶ï¼Œæ¯”è¯·æ±‚ e å†™æ•°æ®åº“ï¼Œå¹¶ä¸”åˆ é™¤ç¼“å­˜çš„è¿˜é•¿ã€‚</li>\n</ol>\n<p>æˆ‘ä»¬éƒ½çŸ¥é“æŸ¥è¯¢æ•°æ®åº“çš„é€Ÿåº¦ï¼Œä¸€èˆ¬æ¯”å†™æ•°æ®åº“è¦å¿«ï¼Œæ›´ä½•å†µå†™å®Œæ•°æ®åº“ï¼Œè¿˜è¦åˆ é™¤ç¼“å­˜ã€‚æ‰€ä»¥ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå†™æ•°æ®è¯·æ±‚æ¯”è¯»æ•°æ®æƒ…å†µè€—æ—¶æ›´é•¿ã€‚</p>\n<p>ç”±æ­¤å¯è§ï¼Œç³»ç»ŸåŒæ—¶æ»¡è¶³ä¸Šè¿°ä¸¤ä¸ªæ¡ä»¶çš„æ¦‚ç‡éå¸¸å°ã€‚</p>\n<blockquote>\n<p>æ¨èå¤§å®¶ä½¿ç”¨å…ˆå†™æ•°æ®åº“ï¼Œå†åˆ ç¼“å­˜çš„æ–¹æ¡ˆï¼Œè™½è¯´ä¸èƒ½100%é¿å…æ•°æ®ä¸ä¸€è‡´é—®é¢˜ï¼Œä½†å‡ºç°è¯¥é—®é¢˜çš„æ¦‚ç‡ï¼Œç›¸å¯¹äºå…¶ä»–æ–¹æ¡ˆæ¥è¯´æ˜¯æœ€å°çš„ã€‚</p>\n</blockquote>\n<p>ä½†åœ¨è¯¥æ–¹æ¡ˆä¸­ï¼Œå¦‚æœåˆ é™¤ç¼“å­˜å¤±è´¥äº†è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p>\n<h3 id=\"åˆ ç¼“å­˜å¤±è´¥æ€ä¹ˆåŠï¼Ÿ\"><a href=\"#åˆ ç¼“å­˜å¤±è´¥æ€ä¹ˆåŠï¼Ÿ\" class=\"headerlink\" title=\"åˆ ç¼“å­˜å¤±è´¥æ€ä¹ˆåŠï¼Ÿ\"></a>åˆ ç¼“å­˜å¤±è´¥æ€ä¹ˆåŠï¼Ÿ</h3><p>å…¶å®å…ˆå†™æ•°æ®åº“ï¼Œå†åˆ ç¼“å­˜çš„æ–¹æ¡ˆï¼Œè·Ÿç¼“å­˜åŒåˆ çš„æ–¹æ¡ˆä¸€æ ·ï¼Œæœ‰ä¸€ä¸ªå…±åŒçš„é£é™©ç‚¹ï¼Œå³ï¼šå¦‚æœç¼“å­˜åˆ é™¤å¤±è´¥äº†ï¼Œä¹Ÿä¼šå¯¼è‡´ç¼“å­˜å’Œæ•°æ®åº“çš„æ•°æ®ä¸ä¸€è‡´ã€‚</p>\n<p>é‚£ä¹ˆï¼Œåˆ é™¤ç¼“å­˜å¤±è´¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p>\n<p>ç­”ï¼šéœ€è¦åŠ <code>é‡è¯•æœºåˆ¶</code>ã€‚</p>\n<p>åœ¨æ¥å£ä¸­å¦‚æœæ›´æ–°äº†æ•°æ®åº“æˆåŠŸäº†ï¼Œä½†æ›´æ–°ç¼“å­˜å¤±è´¥äº†ï¼Œå¯ä»¥ç«‹åˆ»é‡è¯• 3 æ¬¡ã€‚å¦‚æœå…¶ä¸­æœ‰ä»»ä½•ä¸€æ¬¡æˆåŠŸï¼Œåˆ™ç›´æ¥è¿”å›æˆåŠŸã€‚å¦‚æœ 3 æ¬¡éƒ½å¤±è´¥äº†ï¼Œåˆ™å†™å…¥æ•°æ®åº“ï¼Œå‡†å¤‡åç»­å†å¤„ç†ã€‚</p>\n<p>å½“ç„¶ï¼Œå¦‚æœä½ åœ¨æ¥å£ä¸­ç›´æ¥<code>åŒæ­¥é‡è¯•</code>ï¼Œè¯¥æ¥å£å¹¶å‘é‡æ¯”è¾ƒé«˜çš„æ—¶å€™ï¼Œå¯èƒ½æœ‰ç‚¹å½±å“æ¥å£æ€§èƒ½ã€‚</p>\n<p>è¿™æ—¶ï¼Œå°±éœ€è¦æ”¹æˆ<code>å¼‚æ­¥é‡è¯•</code>äº†ã€‚</p>\n<p>å¼‚æ­¥é‡è¯•æ–¹å¼æœ‰å¾ˆå¤šç§ï¼Œæ¯”å¦‚ï¼š</p>\n<ol>\n<li>æ¯æ¬¡éƒ½å•ç‹¬èµ·ä¸€ä¸ªçº¿ç¨‹ï¼Œè¯¥çº¿ç¨‹ä¸“é—¨åšé‡è¯•çš„å·¥ä½œã€‚ä½†å¦‚æœåœ¨é«˜å¹¶å‘çš„åœºæ™¯ä¸‹ï¼Œå¯èƒ½ä¼šåˆ›å»ºå¤ªå¤šçš„çº¿ç¨‹ï¼Œå¯¼è‡´ç³»ç»Ÿ OOM é—®é¢˜ï¼Œä¸å¤ªå»ºè®®ä½¿ç”¨ã€‚</li>\n<li>å°†é‡è¯•çš„ä»»åŠ¡äº¤ç»™çº¿ç¨‹æ± å¤„ç†ï¼Œä½†å¦‚æœæœåŠ¡å™¨é‡å¯ï¼Œéƒ¨åˆ†æ•°æ®å¯èƒ½ä¼šä¸¢å¤±ã€‚</li>\n<li>å°†é‡è¯•æ•°æ®å†™è¡¨ï¼Œç„¶åä½¿ç”¨ elastic-job ç­‰å®šæ—¶ä»»åŠ¡è¿›è¡Œé‡è¯•ã€‚</li>\n<li>å°†é‡è¯•çš„è¯·æ±‚å†™å…¥ mq ç­‰æ¶ˆæ¯ä¸­é—´ä»¶ä¸­ï¼Œåœ¨ mq çš„ consumer ä¸­å¤„ç†ã€‚</li>\n<li>è®¢é˜… mysql çš„ binlogï¼Œåœ¨è®¢é˜…è€…ä¸­ï¼Œå¦‚æœå‘ç°äº†æ›´æ–°æ•°æ®è¯·æ±‚ï¼Œåˆ™åˆ é™¤ç›¸åº”çš„ç¼“å­˜ã€‚</li>\n</ol>\n<h4 id=\"å®šæ—¶ä»»åŠ¡\"><a href=\"#å®šæ—¶ä»»åŠ¡\" class=\"headerlink\" title=\"å®šæ—¶ä»»åŠ¡\"></a>å®šæ—¶ä»»åŠ¡</h4><p>ä½¿ç”¨<code>å®šæ—¶ä»»åŠ¡é‡è¯•</code>çš„å…·ä½“æ–¹æ¡ˆå¦‚ä¸‹ï¼š</p>\n<ol>\n<li><p>å½“ç”¨æˆ·æ“ä½œå†™å®Œæ•°æ®åº“ï¼Œä½†åˆ é™¤ç¼“å­˜å¤±è´¥äº†ï¼Œéœ€è¦å°†ç”¨æˆ·æ•°æ®å†™å…¥é‡è¯•è¡¨ä¸­ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>\n<p> <img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650528474531.png\" alt=\"å›¾ç‰‡\"></p>\n</li>\n<li><p>åœ¨å®šæ—¶ä»»åŠ¡ä¸­ï¼Œå¼‚æ­¥è¯»å–é‡è¯•è¡¨ä¸­çš„ç”¨æˆ·æ•°æ®ã€‚é‡è¯•è¡¨éœ€è¦è®°å½•ä¸€ä¸ªé‡è¯•æ¬¡æ•°å­—æ®µï¼Œåˆå§‹å€¼ä¸º 0ã€‚ç„¶åé‡è¯• 5 æ¬¡ï¼Œä¸æ–­åˆ é™¤ç¼“å­˜ï¼Œæ¯é‡è¯•ä¸€æ¬¡è¯¥å­—æ®µå€¼+1ã€‚å¦‚æœå…¶ä¸­æœ‰ä»»æ„ä¸€æ¬¡æˆåŠŸäº†ï¼Œåˆ™è¿”å›æˆåŠŸã€‚å¦‚æœé‡è¯•äº† 5 æ¬¡ï¼Œè¿˜æ˜¯å¤±è´¥ï¼Œåˆ™æˆ‘ä»¬éœ€è¦åœ¨é‡è¯•è¡¨ä¸­è®°å½•ä¸€ä¸ªå¤±è´¥çš„çŠ¶æ€ï¼Œç­‰å¾…åç»­è¿›ä¸€æ­¥å¤„ç†ã€‚</p>\n<p> <img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650528480542.png\" alt=\"å›¾ç‰‡\"></p>\n</li>\n<li><p>åœ¨é«˜å¹¶å‘åœºæ™¯ä¸­ï¼Œå®šæ—¶ä»»åŠ¡æ¨èä½¿ç”¨<code>elastic-job</code>ã€‚ç›¸å¯¹äº xxl-job ç­‰å®šæ—¶ä»»åŠ¡ï¼Œå®ƒå¯ä»¥åˆ†ç‰‡å¤„ç†ï¼Œæå‡å¤„ç†é€Ÿåº¦ã€‚åŒæ—¶æ¯ç‰‡çš„é—´éš”å¯ä»¥è®¾ç½®æˆï¼š1,2,3,5,7 ç§’ç­‰ã€‚</p>\n</li>\n</ol>\n<p>ä½¿ç”¨å®šæ—¶ä»»åŠ¡é‡è¯•çš„è¯ï¼Œæœ‰ä¸ªç¼ºç‚¹å°±æ˜¯å®æ—¶æ€§æ²¡é‚£ä¹ˆé«˜ï¼Œå¯¹äºå®æ—¶æ€§è¦æ±‚ç‰¹åˆ«é«˜çš„ä¸šåŠ¡åœºæ™¯ï¼Œè¯¥æ–¹æ¡ˆä¸å¤ªé€‚ç”¨ã€‚ä½†æ˜¯å¯¹äºä¸€èˆ¬åœºæ™¯ï¼Œè¿˜æ˜¯å¯ä»¥ç”¨ä¸€ç”¨çš„ã€‚</p>\n<p>ä½†å®ƒæœ‰ä¸€ä¸ªå¾ˆå¤§çš„ä¼˜ç‚¹ï¼Œå³æ•°æ®æ˜¯è½åº“çš„ï¼Œä¸ä¼šä¸¢æ•°æ®ã€‚</p>\n<h4 id=\"mq\"><a href=\"#mq\" class=\"headerlink\" title=\"mq\"></a>mq</h4><p>åœ¨é«˜å¹¶å‘çš„ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œmqï¼ˆæ¶ˆæ¯é˜Ÿåˆ—ï¼‰æ˜¯å¿…ä¸å¯å°‘çš„æŠ€æœ¯ä¹‹ä¸€ã€‚å®ƒä¸ä»…å¯ä»¥å¼‚æ­¥è§£è€¦ï¼Œè¿˜èƒ½å‰Šå³°å¡«è°·ã€‚å¯¹ä¿è¯ç³»ç»Ÿçš„ç¨³å®šæ€§æ˜¯éå¸¸æœ‰æ„ä¹‰çš„ã€‚</p>\n<p>mq çš„ç”Ÿäº§è€…ï¼Œç”Ÿäº§äº†æ¶ˆæ¯ä¹‹åï¼Œé€šè¿‡æŒ‡å®šçš„ topic å‘é€åˆ° mq æœåŠ¡å™¨ã€‚ç„¶å mq çš„æ¶ˆè´¹è€…ï¼Œè®¢é˜…è¯¥ topic çš„æ¶ˆæ¯ï¼Œè¯»å–æ¶ˆæ¯æ•°æ®ä¹‹åï¼Œåšä¸šåŠ¡é€»è¾‘å¤„ç†ã€‚</p>\n<p>ä½¿ç”¨<code>mqé‡è¯•</code>çš„å…·ä½“æ–¹æ¡ˆå¦‚ä¸‹ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650528506474.png\" alt=\"å›¾ç‰‡\"></p>\n<ol>\n<li>å½“ç”¨æˆ·æ“ä½œå†™å®Œæ•°æ®åº“ï¼Œä½†åˆ é™¤ç¼“å­˜å¤±è´¥äº†ï¼Œäº§ç”Ÿä¸€æ¡ mq æ¶ˆæ¯ï¼Œå‘é€ç»™ mq æœåŠ¡å™¨ã€‚</li>\n<li>mq æ¶ˆè´¹è€…è¯»å– mq æ¶ˆæ¯ï¼Œé‡è¯• 5 æ¬¡åˆ é™¤ç¼“å­˜ã€‚å¦‚æœå…¶ä¸­æœ‰ä»»æ„ä¸€æ¬¡æˆåŠŸäº†ï¼Œåˆ™è¿”å›æˆåŠŸã€‚å¦‚æœé‡è¯•äº† 5 æ¬¡ï¼Œè¿˜æ˜¯å¤±è´¥ï¼Œåˆ™å†™å…¥<code>æ­»ä¿¡é˜Ÿåˆ—</code>ä¸­ã€‚</li>\n<li>æ¨è mq ä½¿ç”¨<code>rocketmq</code>ï¼Œé‡è¯•æœºåˆ¶å’Œæ­»ä¿¡é˜Ÿåˆ—é»˜è®¤æ˜¯æ”¯æŒçš„ã€‚ä½¿ç”¨èµ·æ¥éå¸¸æ–¹ä¾¿ï¼Œè€Œä¸”è¿˜æ”¯æŒé¡ºåºæ¶ˆæ¯ï¼Œå»¶è¿Ÿæ¶ˆæ¯å’Œäº‹åŠ¡æ¶ˆæ¯ç­‰å¤šç§ä¸šåŠ¡åœºæ™¯ã€‚</li>\n</ol>\n<p>å½“ç„¶åœ¨è¯¥æ–¹æ¡ˆä¸­ï¼Œåˆ é™¤ç¼“å­˜å¯ä»¥å®Œå…¨èµ°å¼‚æ­¥ã€‚å³ç”¨æˆ·çš„å†™æ“ä½œï¼Œåœ¨å†™å®Œæ•°æ®åº“ä¹‹åï¼Œä¸ç”¨ç«‹åˆ»åˆ é™¤ä¸€æ¬¡ç¼“å­˜ã€‚è€Œç›´æ¥å‘é€ mq æ¶ˆæ¯ï¼Œåˆ° mq æœåŠ¡å™¨ï¼Œç„¶åæœ‰ mq æ¶ˆè´¹è€…å…¨æƒè´Ÿè´£åˆ é™¤ç¼“å­˜çš„ä»»åŠ¡ã€‚</p>\n<p>å› ä¸º mq çš„å®æ—¶æ€§è¿˜æ˜¯æ¯”è¾ƒé«˜çš„ï¼Œå› æ­¤æ”¹è‰¯åçš„æ–¹æ¡ˆä¹Ÿæ˜¯ä¸€ç§ä¸é”™çš„é€‰æ‹©ã€‚</p>\n<h4 id=\"binlog\"><a href=\"#binlog\" class=\"headerlink\" title=\"binlog\"></a>binlog</h4><p>å‰é¢æˆ‘ä»¬èŠè¿‡çš„ï¼Œæ— è®ºæ˜¯å®šæ—¶ä»»åŠ¡ï¼Œè¿˜æ˜¯ mqï¼ˆæ¶ˆæ¯é˜Ÿåˆ—ï¼‰ï¼Œåšé‡è¯•æœºåˆ¶ï¼Œå¯¹ä¸šåŠ¡éƒ½æœ‰ä¸€å®šçš„ä¾µå…¥æ€§ã€‚</p>\n<p>åœ¨ä½¿ç”¨å®šæ—¶ä»»åŠ¡çš„æ–¹æ¡ˆä¸­ï¼Œéœ€è¦åœ¨ä¸šåŠ¡ä»£ç ä¸­å¢åŠ é¢å¤–é€»è¾‘ï¼Œå¦‚æœåˆ é™¤ç¼“å­˜å¤±è´¥ï¼Œéœ€è¦å°†æ•°æ®å†™å…¥é‡è¯•è¡¨ã€‚</p>\n<p>è€Œä½¿ç”¨ mq çš„æ–¹æ¡ˆä¸­ï¼Œå¦‚æœåˆ é™¤ç¼“å­˜å¤±è´¥äº†ï¼Œéœ€è¦åœ¨ä¸šåŠ¡ä»£ç ä¸­å‘é€ mq æ¶ˆæ¯åˆ° mq æœåŠ¡å™¨ã€‚</p>\n<p>å…¶å®ï¼Œè¿˜æœ‰ä¸€ç§æ›´ä¼˜é›…çš„å®ç°ï¼Œå³<code>ç›‘å¬binlog</code>ï¼Œæ¯”å¦‚ä½¿ç”¨ï¼š<code>canal</code>ç­‰ä¸­é—´ä»¶ã€‚</p>\n<p>å…·ä½“æ–¹æ¡ˆå¦‚ä¸‹ï¼š</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650528533430.png\" alt=\"å›¾ç‰‡\"></p>\n<ol>\n<li>åœ¨ä¸šåŠ¡æ¥å£ä¸­å†™æ•°æ®åº“ä¹‹åï¼Œå°±ä¸ç®¡äº†ï¼Œç›´æ¥è¿”å›æˆåŠŸã€‚</li>\n<li>mysql æœåŠ¡å™¨ä¼šè‡ªåŠ¨æŠŠå˜æ›´çš„æ•°æ®å†™å…¥ binlog ä¸­ã€‚</li>\n<li>binlog è®¢é˜…è€…è·å–å˜æ›´çš„æ•°æ®ï¼Œç„¶ååˆ é™¤ç¼“å­˜ã€‚</li>\n</ol>\n<p>è¿™å¥—æ–¹æ¡ˆä¸­ä¸šåŠ¡æ¥å£ç¡®å®ç®€åŒ–äº†ä¸€äº›æµç¨‹ï¼Œåªç”¨å…³å¿ƒæ•°æ®åº“æ“ä½œå³å¯ï¼Œè€Œåœ¨ binlog è®¢é˜…è€…ä¸­åšç¼“å­˜åˆ é™¤å·¥ä½œã€‚</p>\n<p>ä½†å¦‚æœåªæ˜¯æŒ‰ç…§å›¾ä¸­çš„æ–¹æ¡ˆè¿›è¡Œåˆ é™¤ç¼“å­˜ï¼Œåªåˆ é™¤äº†ä¸€æ¬¡ï¼Œä¹Ÿå¯èƒ½ä¼šå¤±è´¥ã€‚</p>\n<p>å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ</p>\n<p>ç­”ï¼šè¿™å°±éœ€è¦åŠ ä¸Šå‰é¢èŠè¿‡çš„<code>é‡è¯•æœºåˆ¶</code>äº†ã€‚å¦‚æœåˆ é™¤ç¼“å­˜å¤±è´¥ï¼Œå†™å…¥é‡è¯•è¡¨ï¼Œä½¿ç”¨å®šæ—¶ä»»åŠ¡é‡è¯•ã€‚æˆ–è€…å†™å…¥ mqï¼Œè®© mq è‡ªåŠ¨é‡è¯•ã€‚</p>\n<p>åœ¨è¿™é‡Œæ¨èä½¿ç”¨<code>mqè‡ªåŠ¨é‡è¯•æœºåˆ¶</code>ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/TyporaNotes640-1650528538202.png\" alt=\"å›¾ç‰‡\"></p>\n<p>åœ¨ binlog è®¢é˜…è€…ä¸­å¦‚æœåˆ é™¤ç¼“å­˜å¤±è´¥ï¼Œåˆ™å‘é€ä¸€æ¡ mq æ¶ˆæ¯åˆ° mq æœåŠ¡å™¨ï¼Œåœ¨ mq æ¶ˆè´¹è€…ä¸­è‡ªåŠ¨é‡è¯• 5 æ¬¡ã€‚å¦‚æœæœ‰ä»»æ„ä¸€æ¬¡æˆåŠŸï¼Œåˆ™ç›´æ¥è¿”å›æˆåŠŸã€‚å¦‚æœé‡è¯• 5 æ¬¡åè¿˜æ˜¯å¤±è´¥ï¼Œåˆ™è¯¥æ¶ˆæ¯è‡ªåŠ¨è¢«æ”¾å…¥æ­»ä¿¡é˜Ÿåˆ—ï¼Œåé¢å¯èƒ½éœ€è¦äººå·¥ä»‹å…¥ã€‚</p>\n<hr>\n<h2 id=\"Redis-çº¿ç¨‹æ¨¡å‹\"><a href=\"#Redis-çº¿ç¨‹æ¨¡å‹\" class=\"headerlink\" title=\"Redis çº¿ç¨‹æ¨¡å‹\"></a>Redis çº¿ç¨‹æ¨¡å‹</h2><h3 id=\"å•çº¿ç¨‹çš„Redisä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«\"><a href=\"#å•çº¿ç¨‹çš„Redisä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«\" class=\"headerlink\" title=\"å•çº¿ç¨‹çš„Redisä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«\"></a>å•çº¿ç¨‹çš„Redisä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«</h3><ol>\n<li><p>çº¯å†…å­˜æ“ä½œ</p>\n</li>\n<li><p>å•çº¿ç¨‹æ“ä½œï¼Œé¿å…äº†é¢‘ç¹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢</p>\n</li>\n<li><p>é‡‡ç”¨äº†éé˜»å¡ I&#x2F;O å¤šè·¯å¤ç”¨æœºåˆ¶</p>\n</li>\n</ol>\n<h3 id=\"Redis-ä¸ºä»€ä¹ˆæ˜¯å•çº¿ç¨‹çš„\"><a href=\"#Redis-ä¸ºä»€ä¹ˆæ˜¯å•çº¿ç¨‹çš„\" class=\"headerlink\" title=\"Redis ä¸ºä»€ä¹ˆæ˜¯å•çº¿ç¨‹çš„\"></a>Redis ä¸ºä»€ä¹ˆæ˜¯å•çº¿ç¨‹çš„</h3><p>å®˜æ–¹ FAQ è¡¨ç¤ºï¼Œå› ä¸º Redis æ˜¯åŸºäºå†…å­˜çš„æ“ä½œï¼ŒCPU ä¸æ˜¯ Redis çš„ç“¶é¢ˆï¼ŒRedis çš„ç“¶é¢ˆæœ€æœ‰å¯èƒ½æ˜¯æœºå™¨å†…å­˜çš„å¤§å°æˆ–è€…ç½‘ç»œå¸¦å®½ã€‚</p>\n<p>æ—¢ç„¶å•çº¿ç¨‹å®¹æ˜“å®ç°ï¼Œè€Œä¸” CPU ä¸ä¼šæˆä¸ºç“¶é¢ˆï¼Œé‚£å°±é¡ºç†æˆç« åœ°é‡‡ç”¨å•çº¿ç¨‹çš„æ–¹æ¡ˆäº†ï¼ˆæ¯•ç«Ÿé‡‡ç”¨å¤šçº¿ç¨‹ä¼šæœ‰å¾ˆå¤šéº»çƒ¦ï¼‰ã€‚Redis åˆ©ç”¨é˜Ÿåˆ—å°†å¹¶å‘è®¿é—®å˜ä¸ºä¸²è¡Œè®¿é—®</p>\n<p>1ã€ç»å¤§éƒ¨åˆ†è¯·æ±‚æ˜¯çº¯ç²¹çš„å†…å­˜æ“ä½œï¼ˆéå¸¸å¿«é€Ÿï¼‰</p>\n<p>2ã€é‡‡ç”¨å•çº¿ç¨‹ï¼Œé¿å…äº†ä¸å¿…è¦çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œç«äº‰æ¡ä»¶</p>\n<p>3ã€éé˜»å¡ IO ä¼˜ç‚¹ï¼š</p>\n<ul>\n<li>é€Ÿåº¦å¿«ï¼Œå› ä¸ºæ•°æ®å­˜åœ¨å†…å­˜ä¸­ï¼Œç±»ä¼¼äº HashMapï¼ŒHashMap çš„ä¼˜åŠ¿å°±æ˜¯æŸ¥æ‰¾å’Œæ“ä½œçš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ O(1)</li>\n<li>æ”¯æŒä¸°å¯Œæ•°æ®ç±»å‹ï¼Œæ”¯æŒ stringï¼Œlistï¼Œsetï¼Œsorted setï¼Œhash</li>\n<li>æ”¯æŒäº‹åŠ¡ï¼Œæ“ä½œéƒ½æ˜¯åŸå­æ€§ï¼Œæ‰€è°“çš„åŸå­æ€§å°±æ˜¯å¯¹æ•°æ®çš„æ›´æ”¹è¦ä¹ˆå…¨éƒ¨æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ¨ä¸æ‰§è¡Œ</li>\n<li>ä¸°å¯Œçš„ç‰¹æ€§ï¼šå¯ç”¨äºç¼“å­˜ï¼Œæ¶ˆæ¯ï¼ŒæŒ‰ key è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œè¿‡æœŸåå°†ä¼šè‡ªåŠ¨åˆ é™¤å¦‚ä½•è§£å†³ Redis çš„å¹¶å‘ç«äº‰ key é—®é¢˜</li>\n</ul>\n<p><strong>åŒæ—¶æœ‰å¤šä¸ªå­ç³»ç»Ÿå»setä¸€ä¸ªkeyã€‚è¿™ä¸ªæ—¶å€™è¦æ³¨æ„ä»€ä¹ˆå‘¢ï¼Ÿ</strong></p>\n<p>ä¸æ¨èä½¿ç”¨ Redis çš„äº‹åŠ¡æœºåˆ¶ã€‚å› ä¸ºæˆ‘ä»¬çš„ç”Ÿäº§ç¯å¢ƒï¼ŒåŸºæœ¬éƒ½æ˜¯ Redis é›†ç¾¤ç¯å¢ƒï¼Œåšäº†æ•°æ®åˆ†ç‰‡æ“ä½œã€‚ä½ ä¸€ä¸ªäº‹åŠ¡ä¸­æœ‰æ¶‰åŠåˆ°å¤šä¸ª key æ“ä½œçš„æ—¶å€™ï¼Œè¿™å¤šä¸ª key ä¸ä¸€å®šéƒ½å­˜å‚¨åœ¨åŒä¸€ä¸ª Redis-server ä¸Šã€‚å› æ­¤ï¼ŒRedis çš„äº‹åŠ¡æœºåˆ¶ï¼Œååˆ†é¸¡è‚‹ã€‚</p>\n<ul>\n<li>å¦‚æœå¯¹è¿™ä¸ª key æ“ä½œï¼Œä¸è¦æ±‚é¡ºåºï¼šå‡†å¤‡ä¸€ä¸ªåˆ†å¸ƒå¼é”ï¼Œå¤§å®¶å»æŠ¢é”ï¼ŒæŠ¢åˆ°é”å°±åš set æ“ä½œå³å¯</li>\n<li>å¦‚æœå¯¹è¿™ä¸ª key æ“ä½œï¼Œè¦æ±‚é¡ºåºï¼šåˆ†å¸ƒå¼é”+æ—¶é—´æˆ³ã€‚å‡è®¾è¿™ä¼šç³»ç»Ÿ B å…ˆæŠ¢åˆ°é”ï¼Œå°† key1 è®¾ç½®ä¸º{valueB 3:05}ã€‚æ¥ä¸‹æ¥ç³»ç»Ÿ A æŠ¢åˆ°é”ï¼Œå‘ç°è‡ªå·±çš„ valueA çš„æ—¶é—´æˆ³æ—©äºç¼“å­˜ä¸­çš„æ—¶é—´æˆ³ï¼Œé‚£å°±ä¸åš set æ“ä½œäº†ã€‚ä»¥æ­¤ç±»æ¨ã€‚</li>\n<li>åˆ©ç”¨é˜Ÿåˆ—ï¼Œå°† set æ–¹æ³•å˜æˆä¸²è¡Œè®¿é—®ä¹Ÿå¯ä»¥ Redis é‡åˆ°é«˜å¹¶å‘ï¼Œå¦‚æœä¿è¯è¯»å†™ key çš„ä¸€è‡´æ€§</li>\n</ul>\n<p>å¯¹ Redis çš„æ“ä½œéƒ½æ˜¯å…·æœ‰åŸå­æ€§çš„ï¼Œæ˜¯çº¿ç¨‹å®‰å…¨çš„æ“ä½œï¼Œä½ ä¸ç”¨è€ƒè™‘å¹¶å‘é—®é¢˜,Redis å†…éƒ¨å·²ç»å¸®ä½ å¤„ç†å¥½å¹¶å‘çš„é—®é¢˜äº†ã€‚</p>\n<h3 id=\"ä¸ºä»€ä¹ˆRedisçš„æ“ä½œæ˜¯åŸå­æ€§çš„ï¼Œæ€ä¹ˆä¿è¯åŸå­æ€§çš„ï¼Ÿ\"><a href=\"#ä¸ºä»€ä¹ˆRedisçš„æ“ä½œæ˜¯åŸå­æ€§çš„ï¼Œæ€ä¹ˆä¿è¯åŸå­æ€§çš„ï¼Ÿ\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆRedisçš„æ“ä½œæ˜¯åŸå­æ€§çš„ï¼Œæ€ä¹ˆä¿è¯åŸå­æ€§çš„ï¼Ÿ\"></a>ä¸ºä»€ä¹ˆRedisçš„æ“ä½œæ˜¯åŸå­æ€§çš„ï¼Œæ€ä¹ˆä¿è¯åŸå­æ€§çš„ï¼Ÿ</h3><p>å¯¹äº Redis è€Œè¨€ï¼Œå‘½ä»¤çš„åŸå­æ€§æŒ‡çš„æ˜¯ï¼šä¸€ä¸ªæ“ä½œçš„ä¸å¯ä»¥å†åˆ†ï¼Œæ“ä½œè¦ä¹ˆæ‰§è¡Œï¼Œè¦ä¹ˆä¸æ‰§è¡Œã€‚</p>\n<p>Redis çš„æ“ä½œä¹‹æ‰€ä»¥æ˜¯åŸå­æ€§çš„ï¼Œæ˜¯å› ä¸º Redis æ˜¯å•çº¿ç¨‹çš„ã€‚ï¼ˆRedis æ–°ç‰ˆæœ¬å·²ç»å¼•å…¥å¤šçº¿ç¨‹ï¼Œè¿™é‡ŒåŸºäºæ—§ç‰ˆæœ¬çš„ Redisï¼‰</p>\n<p>Redis æœ¬èº«æä¾›çš„æ‰€æœ‰ API éƒ½æ˜¯åŸå­æ“ä½œï¼ŒRedis ä¸­çš„äº‹åŠ¡å…¶å®æ˜¯è¦ä¿è¯æ‰¹é‡æ“ä½œçš„åŸå­æ€§ã€‚</p>\n<p>å¤šä¸ªå‘½ä»¤åœ¨å¹¶å‘ä¸­ä¹Ÿæ˜¯åŸå­æ€§çš„å—ï¼Ÿ</p>\n<p>ä¸ä¸€å®šï¼Œ å°† get å’Œ set æ”¹æˆå•å‘½ä»¤æ“ä½œï¼Œincr ã€‚ä½¿ç”¨ Redis çš„äº‹åŠ¡ï¼Œæˆ–è€…ä½¿ç”¨ Redis+Lua çš„æ–¹å¼å®ç°.</p>\n<h3 id=\"è®²è§£ä¸‹Redisçº¿ç¨‹æ¨¡å‹\"><a href=\"#è®²è§£ä¸‹Redisçº¿ç¨‹æ¨¡å‹\" class=\"headerlink\" title=\"è®²è§£ä¸‹Redisçº¿ç¨‹æ¨¡å‹\"></a>è®²è§£ä¸‹Redisçº¿ç¨‹æ¨¡å‹</h3><p>æ–‡ä»¶äº‹ä»¶å¤„ç†å™¨åŒ…æ‹¬åˆ†åˆ«æ˜¯å¥—æ¥å­—ã€ I&#x2F;O å¤šè·¯å¤ç”¨ç¨‹åºã€ æ–‡ä»¶äº‹ä»¶åˆ†æ´¾å™¨ï¼ˆdispatcherï¼‰ã€ ä»¥åŠäº‹ä»¶å¤„ç†å™¨ã€‚ä½¿ç”¨ I&#x2F;O å¤šè·¯å¤ç”¨ç¨‹åºæ¥åŒæ—¶ç›‘å¬å¤šä¸ªå¥—æ¥å­—ï¼Œ å¹¶æ ¹æ®å¥—æ¥å­—ç›®å‰æ‰§è¡Œçš„ä»»åŠ¡æ¥ä¸ºå¥—æ¥å­—å…³è”ä¸åŒçš„äº‹ä»¶å¤„ç†å™¨ã€‚</p>\n<p>å½“è¢«ç›‘å¬çš„å¥—æ¥å­—å‡†å¤‡å¥½æ‰§è¡Œè¿æ¥åº”ç­”ï¼ˆacceptï¼‰ã€è¯»å–ï¼ˆreadï¼‰ã€å†™å…¥ï¼ˆwriteï¼‰ã€å…³é—­ï¼ˆcloseï¼‰ç­‰æ“ä½œæ—¶ï¼Œ ä¸æ“ä½œç›¸å¯¹åº”çš„æ–‡ä»¶äº‹ä»¶å°±ä¼šäº§ç”Ÿï¼Œ è¿™æ—¶æ–‡ä»¶äº‹ä»¶å¤„ç†å™¨å°±ä¼šè°ƒç”¨å¥—æ¥å­—ä¹‹å‰å…³è”å¥½çš„äº‹ä»¶å¤„ç†å™¨æ¥å¤„ç†è¿™äº›äº‹ä»¶ã€‚</p>\n<p>I&#x2F;O å¤šè·¯å¤ç”¨ç¨‹åºè´Ÿè´£ç›‘å¬å¤šä¸ªå¥—æ¥å­—ï¼Œ å¹¶å‘æ–‡ä»¶äº‹ä»¶åˆ†æ´¾å™¨ä¼ é€é‚£äº›äº§ç”Ÿäº†äº‹ä»¶çš„å¥—æ¥å­—ã€‚</p>\n<p><strong>å·¥ä½œåŸç†ï¼š</strong></p>\n<p>I&#x2F;O å¤šè·¯å¤ç”¨ç¨‹åºè´Ÿè´£ç›‘å¬å¤šä¸ªå¥—æ¥å­—ï¼Œ å¹¶å‘æ–‡ä»¶äº‹ä»¶åˆ†æ´¾å™¨ä¼ é€é‚£äº›äº§ç”Ÿäº†äº‹ä»¶çš„å¥—æ¥å­—ã€‚</p>\n<p>å°½ç®¡å¤šä¸ªæ–‡ä»¶äº‹ä»¶å¯èƒ½ä¼šå¹¶å‘åœ°å‡ºç°ï¼Œ ä½† I&#x2F;O å¤šè·¯å¤ç”¨ç¨‹åºæ€»æ˜¯ä¼šå°†æ‰€æœ‰äº§ç”Ÿäº‹ä»¶çš„å¥—æ¥å­—éƒ½å…¥é˜Ÿåˆ°ä¸€ä¸ªé˜Ÿåˆ—é‡Œé¢ï¼Œ ç„¶åé€šè¿‡è¿™ä¸ªé˜Ÿåˆ—ï¼Œ ä»¥æœ‰åºï¼ˆsequentiallyï¼‰ã€åŒæ­¥ï¼ˆsynchronouslyï¼‰ã€æ¯æ¬¡ä¸€ä¸ªå¥—æ¥å­—çš„æ–¹å¼å‘æ–‡ä»¶äº‹ä»¶åˆ†æ´¾å™¨ä¼ é€å¥—æ¥å­—ï¼š</p>\n<p>å½“ä¸Šä¸€ä¸ªå¥—æ¥å­—äº§ç”Ÿçš„äº‹ä»¶è¢«å¤„ç†å®Œæ¯•ä¹‹åï¼ˆè¯¥å¥—æ¥å­—ä¸ºäº‹ä»¶æ‰€å…³è”çš„äº‹ä»¶å¤„ç†å™¨æ‰§è¡Œå®Œæ¯•ï¼‰ï¼Œ I&#x2F;O å¤šè·¯å¤ç”¨ç¨‹åºæ‰ä¼šç»§ç»­å‘æ–‡ä»¶äº‹ä»¶åˆ†æ´¾å™¨ä¼ é€ä¸‹ä¸€ä¸ªå¥—æ¥å­—ã€‚å¦‚æœä¸€ä¸ªå¥—æ¥å­—åˆå¯è¯»åˆå¯å†™çš„è¯ï¼Œ é‚£ä¹ˆæœåŠ¡å™¨å°†å…ˆè¯»å¥—æ¥å­—ï¼Œ åå†™å¥—æ¥å­—ã€‚</p>\n<h2 id=\"å…¶ä»–å‚è€ƒ\"><a href=\"#å…¶ä»–å‚è€ƒ\" class=\"headerlink\" title=\"å…¶ä»–å‚è€ƒ\"></a>å…¶ä»–å‚è€ƒ</h2><p><a href=\"https://mp.weixin.qq.com/s?__biz=MzIzOTU0NTQ0MA==&mid=2247507942&idx=1&sn=e00fd16ec56d0e10cc830678ee25c417&chksm=e92ae2e9de5d6bff6d227646c12685a5c45a4c3322e2186954555a14ebcd9510e8ae579a4941&mpshare=1&scene=24&srcid=0324gng7YtX5XX0z9bf7aObR&sharer_sharetime=1648080975816&sharer_shareid=ebfad4e5798246e3d3928c1f4ee9048e#rd\">åŸåˆ› ä¸€æ´º <a href=\"javascript:void(0);\">é˜¿é‡Œå¼€å‘è€…</a> 2022-03-24 08:00</a></p>\n<p><a href=\"https://blog.csdn.net/qq_31387317/category_7391502.html\">https://blog.csdn.net/qq_31387317/category_7391502.html</a></p>"},{"title":"æ‰‹æŠŠæ‰‹å¸¦ä½ æ­å»ºä¸ªäººåšå®¢","copyright":true,"mathjax":true,"date":"2022-12-12T13:08:31.000Z","toc":true,"urlname":"build-blog","_content":"\n## ç³»ç»Ÿç¯å¢ƒ&å·¥å…·\n\nç³»ç»Ÿç¯å¢ƒï¼šMacOS\n\nå·¥å…·ï¼šåšå®¢æ¡†æ¶ä¸º hexoï¼Œåšå®¢æ–‡ä»¶æ‰˜ç®¡äº GitHubï¼Œåšå®¢ç½‘ç«™ç”¨ Netlify ç”Ÿæˆï¼Œå›½å†…è®¿é—®é‡‡ç”¨ CloudFlare è¿›è¡Œ CDN åŠ é€Ÿ\n\n<!--more-->\n\n## hexoåšå®¢æ¡†æ¶å®‰è£…\n\n### é¢„å…ˆç¯å¢ƒ\n\n1ã€å®‰è£… nodeï¼ˆä½¿ç”¨ homebrewï¼‰\n\n```bash\nbrew install node\n```\n\n2ã€æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ­£å¸¸çœ‹åˆ°ç‰ˆæœ¬ä¿¡æ¯å³ä¸ºæˆåŠŸ\n\n```bash\nnode -v\nnpm -v\n```\n\n3ã€åˆ‡æ¢ npm çš„æºå°†æºè®¾ç½®ä¸ºæ·˜å®æºï¼ˆé€Ÿåº¦å¿«ï¼‰\n\n```bash\nnpm config get registry\t# æŸ¥çœ‹æº\nnpm config set registry https://registry.npm.taobao.org # ä¿®æ”¹ä¸ºæ·˜å®æº\n```\n\n### å®‰è£…\n\n1ã€å®‰è£… hexo\n\n```bash\nnpm install hexo-cli -g # å…¨å±€å®‰è£…hexoå‘½ä»¤è¡Œå·¥å…·\n```\n\n2ã€åˆå§‹åŒ–åšå®¢é¡¹ç›®\n\n```bash\nhexo init \"åšå®¢ç›®å½•åç§°\"\n# hexo init \"blog\" å³æˆ‘çš„åšå®¢ç›®å½•åç§°ä¸ºblogï¼Œåç»­éƒ½ç”¨è¯¥ç›®å½•æ¥è®²è§£\n```\n\n3ã€åˆ‡æ¢è‡³åšå®¢ç›®å½•å®‰è£…ä¾èµ–\n\n```bash\ncd blog\nnpm install\n```\n\n4ã€è¿è¡Œ\n\n```bash\nhexo clean\nhexo g\nhexo s\n```\n\næ‰“å¼€é“¾æ¥ï¼Œæœ¬åœ°å‡ºç°åšå®¢ç•Œé¢ï¼Œå³æœ¬åœ°æ­å»ºæˆåŠŸï¼\n\n### æ·»åŠ å»ºç«™è„šæœ¬\n\nä¸ºäº†åç»­`netlify`å»ºç«™æ–¹ä¾¿ï¼Œåœ¨`package.json`é‡Œé¢æ·»åŠ ä¸€ä¸ªå‘½ä»¤ï¼š\n\n```json\nJSON\n{\n    // ......\n    \"scripts\": {\n        \"build\": \"hexo generate\",\n        \"clean\": \"hexo clean\",\n        \"deploy\": \"hexo deploy\",\n        \"server\": \"hexo server\",\n        \"netlify\": \"npm run clean && npm run build\" // æ–°åŠ è¡Œ\n    },\n    // ......\n}\n```\n\n## GitHubæ‰˜ç®¡é¡¹ç›®æ–‡ä»¶\n\nåˆ›å»ºæœ¬åœ°ä»“åº“ï¼Œæ¨é€åˆ°è¿œç«¯æœåŠ¡å™¨\n\n```bash\ncd blog\ngit init\ngit add .\ngit commit -m \"my blog first commit\"\ngit remote add origin \"è¿œç«¯githubä»“åº“åœ°å€\"\ngit branch -M main\ngit push -u origin main\n```\n\n## Netlifyå»ºç«™\n\nç”±äº GitHub è‡ªå¸¦çš„ gitpage è®¿é—®é€Ÿåº¦è¾ƒæ…¢ï¼Œæˆ‘ä»¬ä½¿ç”¨ Netlifyï¼ˆä¸€ä¸ªå›½å¤–çš„å…è´¹çš„æä¾›é™æ€ç½‘ç«™éƒ¨ç½²æœåŠ¡çš„å¹³å°ï¼‰å°†æ‰˜ç®¡ GitHub ä¸Šçš„é™æ€ç½‘ç«™éƒ¨ç½²ä¸Šçº¿ã€‚\n\n### æ­¥éª¤\n\n1ã€æ³¨å†Œå¹¶ç™»é™† Netlify\n\n2ã€add new site - import an existing project\n\n3ã€è¿æ¥åˆ° GitHubï¼Œé€‰æ‹©æˆ‘ä»¬æ‰˜ç®¡åœ¨ GitHub ä¸Šçš„åšå®¢é¡¹ç›®\n\n4ã€åœ¨è®¾ç½®ä¸­æ³¨æ„ä¿®æ”¹ä¸€å¤„ï¼ŒBasic build settings - Build command ä¿®æ”¹ä¸º `npm run netlify`\n\n5ã€æ„å»ºå®Œæˆå¯ä»¥çœ‹åˆ°ä¸€ä¸ª xxx.netlify.app çš„ urlï¼Œå³ä¸ºæˆ‘ä»¬åšå®¢çš„ urlï¼Œä¿®æ”¹è¯¥ url ä¸­çš„ xxx ä¸º yaxing97ï¼Œå³è®¾ç½®æˆ‘çš„ä¸ªäººåšå®¢åŸŸåä¸º`yaxing97.netlify.app`\n\n### é…ç½®åŸŸå\n\n1ã€è´­ä¹°åŸŸåï¼ˆå›½å†…å›½å¤–éƒ½å¯ï¼‰\n\n2ã€è´­ä¹°å®Œæˆååœ¨åŸŸååˆ—è¡¨æ‰¾åˆ°è‡ªå·±çš„åŸŸåï¼Œç‚¹å‡»æ“ä½œä¸­çš„è§£ææŒ‰é’®\n\n3ã€è®¾ç½®åŸŸåè§£æï¼Œç±»å‹ä¸º`CNAME`ï¼Œä¸»æœºè®°å½•ä¸º`@`ï¼Œè®°å½•å€¼ä¸º`yaxing97.netlify.app`ï¼Œå…¶ä¸­`yaxing97`æ˜¯ä¹‹å‰å»ºç«™æ­¥éª¤ä¸­è®¾ç½®çš„ä¸ªæ€§äºŒçº§åŸŸå\n\n4ã€åœ¨ netlify ä¸­é…ç½®åŸŸåï¼Œdomain management - domains - add custom domainï¼Œä¸€è·¯é€šè¿‡å³å¯\n\n## CloudFlareåŠ é€Ÿ\n\nNetlify è™½ç„¶å·²ç»æä¾›äº† CDN åŠ é€Ÿï¼Œä½†åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­å‘ç°å›½å†…è®¿é—®è¿˜æ˜¯æ¯”è¾ƒæ…¢ï¼ŒCloudflare ç›¸å¯¹äºå›½å†…çš„ä¸ƒç‰›äº‘ã€é˜¿é‡Œäº‘ç­‰äº‘æœåŠ¡å•†çš„ CDN é€Ÿåº¦ä¼šæ…¢ä¸€äº›ï¼Œä½†æ˜¯å®ƒæœ‰å…è´¹ç‰ˆæœ¬ï¼Œè€Œä¸”æœ€é‡è¦çš„æ˜¯åŸŸåä¸ç”¨å¤‡æ¡ˆã€‚\n\n### æ­¥éª¤\n\n1ã€æ³¨å†Œ Cloudflare å¹¶ç™»é™†\n\n2ã€è¾“å…¥æ‚¨çš„ç«™ç‚¹ï¼ˆyaxing97.comï¼‰ï¼Œç‚¹å‡»æ·»åŠ ç«™ç‚¹\n\n3ã€é€‰æ‹©å…è´¹å¥—é¤\n\n4ã€æ·»åŠ  DNSï¼ŒType ä¸º`CNAME`ï¼ŒName ä¸º`yaxing97.com`ï¼ŒContent ä¸º`yaxing97.netlify.app`\n\n5ã€ä½¿ç”¨ cloudflare æä¾›çš„ dns è§£ææœåŠ¡å™¨ï¼ˆCloudflare Nameserversï¼‰å¯¹ `yaxing97.com` è¿›è¡Œ dns è§£æ\n\n6ã€åˆ°é˜¿é‡Œäº‘æ§åˆ¶å°ä¸­ï¼ŒDNS ç®¡ç† - DNS ä¿®æ”¹ï¼Œä¿®æ”¹ DNS æœåŠ¡å™¨\n\n## é…ç½®https\n\nå›åˆ° netlify ä¸­ï¼ŒDomain management - HTTPSï¼Œç‚¹å‡» verify DNS configurationï¼Œç»“æœå¦‚ä¸‹å³ä¸ºé…ç½®å®Œæˆ\n\n![é…ç½®HTTPS](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/image-20221212214817015.png)\n\n\n\n## æ–‡ç« ç¼–å†™\n\n```bash\nhexo new \"æ–‡ç« æ ‡é¢˜\"\n# ç¼–å†™å¥½ä¹‹å\nhexo clean\nhexo g\ngit add *\ngit commit -m \"commitä¿¡æ¯\"\ngit push\n```\n\nè¿‡ç‰‡åˆ»ï¼Œè®¿é—®æˆ‘ä»¬çš„`https://yaxing97.com`ï¼Œå¯ä»¥çœ‹åˆ°æ–°æ·»åŠ çš„æ–‡ç« ã€‚\n\n## å‚è€ƒ&æ›´å¤š\n\nhttps://blog.cuijiacai.com/blog-building/\n\nhttps://www.mdnice.com/writing/382af676baff4ed4ad5511074fb736da\n","source":"_posts/æ‰‹æŠŠæ‰‹å¸¦ä½ æ­å»ºä¸ªäººåšå®¢.md","raw":"---\ntitle: æ‰‹æŠŠæ‰‹å¸¦ä½ æ­å»ºä¸ªäººåšå®¢\ncopyright: true\nmathjax: true\ndate: 2022-12-12 21:08:31\ncategories: æŠ€æœ¯æ€»ç»“\ntags: \ntoc: true\nurlname: build-blog\n---\n\n## ç³»ç»Ÿç¯å¢ƒ&å·¥å…·\n\nç³»ç»Ÿç¯å¢ƒï¼šMacOS\n\nå·¥å…·ï¼šåšå®¢æ¡†æ¶ä¸º hexoï¼Œåšå®¢æ–‡ä»¶æ‰˜ç®¡äº GitHubï¼Œåšå®¢ç½‘ç«™ç”¨ Netlify ç”Ÿæˆï¼Œå›½å†…è®¿é—®é‡‡ç”¨ CloudFlare è¿›è¡Œ CDN åŠ é€Ÿ\n\n<!--more-->\n\n## hexoåšå®¢æ¡†æ¶å®‰è£…\n\n### é¢„å…ˆç¯å¢ƒ\n\n1ã€å®‰è£… nodeï¼ˆä½¿ç”¨ homebrewï¼‰\n\n```bash\nbrew install node\n```\n\n2ã€æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ­£å¸¸çœ‹åˆ°ç‰ˆæœ¬ä¿¡æ¯å³ä¸ºæˆåŠŸ\n\n```bash\nnode -v\nnpm -v\n```\n\n3ã€åˆ‡æ¢ npm çš„æºå°†æºè®¾ç½®ä¸ºæ·˜å®æºï¼ˆé€Ÿåº¦å¿«ï¼‰\n\n```bash\nnpm config get registry\t# æŸ¥çœ‹æº\nnpm config set registry https://registry.npm.taobao.org # ä¿®æ”¹ä¸ºæ·˜å®æº\n```\n\n### å®‰è£…\n\n1ã€å®‰è£… hexo\n\n```bash\nnpm install hexo-cli -g # å…¨å±€å®‰è£…hexoå‘½ä»¤è¡Œå·¥å…·\n```\n\n2ã€åˆå§‹åŒ–åšå®¢é¡¹ç›®\n\n```bash\nhexo init \"åšå®¢ç›®å½•åç§°\"\n# hexo init \"blog\" å³æˆ‘çš„åšå®¢ç›®å½•åç§°ä¸ºblogï¼Œåç»­éƒ½ç”¨è¯¥ç›®å½•æ¥è®²è§£\n```\n\n3ã€åˆ‡æ¢è‡³åšå®¢ç›®å½•å®‰è£…ä¾èµ–\n\n```bash\ncd blog\nnpm install\n```\n\n4ã€è¿è¡Œ\n\n```bash\nhexo clean\nhexo g\nhexo s\n```\n\næ‰“å¼€é“¾æ¥ï¼Œæœ¬åœ°å‡ºç°åšå®¢ç•Œé¢ï¼Œå³æœ¬åœ°æ­å»ºæˆåŠŸï¼\n\n### æ·»åŠ å»ºç«™è„šæœ¬\n\nä¸ºäº†åç»­`netlify`å»ºç«™æ–¹ä¾¿ï¼Œåœ¨`package.json`é‡Œé¢æ·»åŠ ä¸€ä¸ªå‘½ä»¤ï¼š\n\n```json\nJSON\n{\n    // ......\n    \"scripts\": {\n        \"build\": \"hexo generate\",\n        \"clean\": \"hexo clean\",\n        \"deploy\": \"hexo deploy\",\n        \"server\": \"hexo server\",\n        \"netlify\": \"npm run clean && npm run build\" // æ–°åŠ è¡Œ\n    },\n    // ......\n}\n```\n\n## GitHubæ‰˜ç®¡é¡¹ç›®æ–‡ä»¶\n\nåˆ›å»ºæœ¬åœ°ä»“åº“ï¼Œæ¨é€åˆ°è¿œç«¯æœåŠ¡å™¨\n\n```bash\ncd blog\ngit init\ngit add .\ngit commit -m \"my blog first commit\"\ngit remote add origin \"è¿œç«¯githubä»“åº“åœ°å€\"\ngit branch -M main\ngit push -u origin main\n```\n\n## Netlifyå»ºç«™\n\nç”±äº GitHub è‡ªå¸¦çš„ gitpage è®¿é—®é€Ÿåº¦è¾ƒæ…¢ï¼Œæˆ‘ä»¬ä½¿ç”¨ Netlifyï¼ˆä¸€ä¸ªå›½å¤–çš„å…è´¹çš„æä¾›é™æ€ç½‘ç«™éƒ¨ç½²æœåŠ¡çš„å¹³å°ï¼‰å°†æ‰˜ç®¡ GitHub ä¸Šçš„é™æ€ç½‘ç«™éƒ¨ç½²ä¸Šçº¿ã€‚\n\n### æ­¥éª¤\n\n1ã€æ³¨å†Œå¹¶ç™»é™† Netlify\n\n2ã€add new site - import an existing project\n\n3ã€è¿æ¥åˆ° GitHubï¼Œé€‰æ‹©æˆ‘ä»¬æ‰˜ç®¡åœ¨ GitHub ä¸Šçš„åšå®¢é¡¹ç›®\n\n4ã€åœ¨è®¾ç½®ä¸­æ³¨æ„ä¿®æ”¹ä¸€å¤„ï¼ŒBasic build settings - Build command ä¿®æ”¹ä¸º `npm run netlify`\n\n5ã€æ„å»ºå®Œæˆå¯ä»¥çœ‹åˆ°ä¸€ä¸ª xxx.netlify.app çš„ urlï¼Œå³ä¸ºæˆ‘ä»¬åšå®¢çš„ urlï¼Œä¿®æ”¹è¯¥ url ä¸­çš„ xxx ä¸º yaxing97ï¼Œå³è®¾ç½®æˆ‘çš„ä¸ªäººåšå®¢åŸŸåä¸º`yaxing97.netlify.app`\n\n### é…ç½®åŸŸå\n\n1ã€è´­ä¹°åŸŸåï¼ˆå›½å†…å›½å¤–éƒ½å¯ï¼‰\n\n2ã€è´­ä¹°å®Œæˆååœ¨åŸŸååˆ—è¡¨æ‰¾åˆ°è‡ªå·±çš„åŸŸåï¼Œç‚¹å‡»æ“ä½œä¸­çš„è§£ææŒ‰é’®\n\n3ã€è®¾ç½®åŸŸåè§£æï¼Œç±»å‹ä¸º`CNAME`ï¼Œä¸»æœºè®°å½•ä¸º`@`ï¼Œè®°å½•å€¼ä¸º`yaxing97.netlify.app`ï¼Œå…¶ä¸­`yaxing97`æ˜¯ä¹‹å‰å»ºç«™æ­¥éª¤ä¸­è®¾ç½®çš„ä¸ªæ€§äºŒçº§åŸŸå\n\n4ã€åœ¨ netlify ä¸­é…ç½®åŸŸåï¼Œdomain management - domains - add custom domainï¼Œä¸€è·¯é€šè¿‡å³å¯\n\n## CloudFlareåŠ é€Ÿ\n\nNetlify è™½ç„¶å·²ç»æä¾›äº† CDN åŠ é€Ÿï¼Œä½†åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­å‘ç°å›½å†…è®¿é—®è¿˜æ˜¯æ¯”è¾ƒæ…¢ï¼ŒCloudflare ç›¸å¯¹äºå›½å†…çš„ä¸ƒç‰›äº‘ã€é˜¿é‡Œäº‘ç­‰äº‘æœåŠ¡å•†çš„ CDN é€Ÿåº¦ä¼šæ…¢ä¸€äº›ï¼Œä½†æ˜¯å®ƒæœ‰å…è´¹ç‰ˆæœ¬ï¼Œè€Œä¸”æœ€é‡è¦çš„æ˜¯åŸŸåä¸ç”¨å¤‡æ¡ˆã€‚\n\n### æ­¥éª¤\n\n1ã€æ³¨å†Œ Cloudflare å¹¶ç™»é™†\n\n2ã€è¾“å…¥æ‚¨çš„ç«™ç‚¹ï¼ˆyaxing97.comï¼‰ï¼Œç‚¹å‡»æ·»åŠ ç«™ç‚¹\n\n3ã€é€‰æ‹©å…è´¹å¥—é¤\n\n4ã€æ·»åŠ  DNSï¼ŒType ä¸º`CNAME`ï¼ŒName ä¸º`yaxing97.com`ï¼ŒContent ä¸º`yaxing97.netlify.app`\n\n5ã€ä½¿ç”¨ cloudflare æä¾›çš„ dns è§£ææœåŠ¡å™¨ï¼ˆCloudflare Nameserversï¼‰å¯¹ `yaxing97.com` è¿›è¡Œ dns è§£æ\n\n6ã€åˆ°é˜¿é‡Œäº‘æ§åˆ¶å°ä¸­ï¼ŒDNS ç®¡ç† - DNS ä¿®æ”¹ï¼Œä¿®æ”¹ DNS æœåŠ¡å™¨\n\n## é…ç½®https\n\nå›åˆ° netlify ä¸­ï¼ŒDomain management - HTTPSï¼Œç‚¹å‡» verify DNS configurationï¼Œç»“æœå¦‚ä¸‹å³ä¸ºé…ç½®å®Œæˆ\n\n![é…ç½®HTTPS](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/image-20221212214817015.png)\n\n\n\n## æ–‡ç« ç¼–å†™\n\n```bash\nhexo new \"æ–‡ç« æ ‡é¢˜\"\n# ç¼–å†™å¥½ä¹‹å\nhexo clean\nhexo g\ngit add *\ngit commit -m \"commitä¿¡æ¯\"\ngit push\n```\n\nè¿‡ç‰‡åˆ»ï¼Œè®¿é—®æˆ‘ä»¬çš„`https://yaxing97.com`ï¼Œå¯ä»¥çœ‹åˆ°æ–°æ·»åŠ çš„æ–‡ç« ã€‚\n\n## å‚è€ƒ&æ›´å¤š\n\nhttps://blog.cuijiacai.com/blog-building/\n\nhttps://www.mdnice.com/writing/382af676baff4ed4ad5511074fb736da\n","slug":"æ‰‹æŠŠæ‰‹å¸¦ä½ æ­å»ºä¸ªäººåšå®¢","published":1,"updated":"2023-01-26T12:35:58.982Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cldzfw3290015t9t845071rec","content":"<h2 id=\"ç³»ç»Ÿç¯å¢ƒ-amp-å·¥å…·\"><a href=\"#ç³»ç»Ÿç¯å¢ƒ-amp-å·¥å…·\" class=\"headerlink\" title=\"ç³»ç»Ÿç¯å¢ƒ&å·¥å…·\"></a>ç³»ç»Ÿç¯å¢ƒ&amp;å·¥å…·</h2><p>ç³»ç»Ÿç¯å¢ƒï¼šMacOS</p>\n<p>å·¥å…·ï¼šåšå®¢æ¡†æ¶ä¸º hexoï¼Œåšå®¢æ–‡ä»¶æ‰˜ç®¡äº GitHubï¼Œåšå®¢ç½‘ç«™ç”¨ Netlify ç”Ÿæˆï¼Œå›½å†…è®¿é—®é‡‡ç”¨ CloudFlare è¿›è¡Œ CDN åŠ é€Ÿ</p>\n<span id=\"more\"></span>\n\n<h2 id=\"hexoåšå®¢æ¡†æ¶å®‰è£…\"><a href=\"#hexoåšå®¢æ¡†æ¶å®‰è£…\" class=\"headerlink\" title=\"hexoåšå®¢æ¡†æ¶å®‰è£…\"></a>hexoåšå®¢æ¡†æ¶å®‰è£…</h2><h3 id=\"é¢„å…ˆç¯å¢ƒ\"><a href=\"#é¢„å…ˆç¯å¢ƒ\" class=\"headerlink\" title=\"é¢„å…ˆç¯å¢ƒ\"></a>é¢„å…ˆç¯å¢ƒ</h3><p>1ã€å®‰è£… nodeï¼ˆä½¿ç”¨ homebrewï¼‰</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew install node</span><br></pre></td></tr></table></figure>\n\n<p>2ã€æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ­£å¸¸çœ‹åˆ°ç‰ˆæœ¬ä¿¡æ¯å³ä¸ºæˆåŠŸ</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">node -v</span><br><span class=\"line\">npm -v</span><br></pre></td></tr></table></figure>\n\n<p>3ã€åˆ‡æ¢ npm çš„æºå°†æºè®¾ç½®ä¸ºæ·˜å®æºï¼ˆé€Ÿåº¦å¿«ï¼‰</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm config get registry\t<span class=\"comment\"># æŸ¥çœ‹æº</span></span><br><span class=\"line\">npm config <span class=\"built_in\">set</span> registry https://registry.npm.taobao.org <span class=\"comment\"># ä¿®æ”¹ä¸ºæ·˜å®æº</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"å®‰è£…\"><a href=\"#å®‰è£…\" class=\"headerlink\" title=\"å®‰è£…\"></a>å®‰è£…</h3><p>1ã€å®‰è£… hexo</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install hexo-cli -g <span class=\"comment\"># å…¨å±€å®‰è£…hexoå‘½ä»¤è¡Œå·¥å…·</span></span><br></pre></td></tr></table></figure>\n\n<p>2ã€åˆå§‹åŒ–åšå®¢é¡¹ç›®</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo init <span class=\"string\">\"åšå®¢ç›®å½•åç§°\"</span></span><br><span class=\"line\"><span class=\"comment\"># hexo init \"blog\" å³æˆ‘çš„åšå®¢ç›®å½•åç§°ä¸ºblogï¼Œåç»­éƒ½ç”¨è¯¥ç›®å½•æ¥è®²è§£</span></span><br></pre></td></tr></table></figure>\n\n<p>3ã€åˆ‡æ¢è‡³åšå®¢ç›®å½•å®‰è£…ä¾èµ–</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> blog</span><br><span class=\"line\">npm install</span><br></pre></td></tr></table></figure>\n\n<p>4ã€è¿è¡Œ</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo clean</span><br><span class=\"line\">hexo g</span><br><span class=\"line\">hexo s</span><br></pre></td></tr></table></figure>\n\n<p>æ‰“å¼€é“¾æ¥ï¼Œæœ¬åœ°å‡ºç°åšå®¢ç•Œé¢ï¼Œå³æœ¬åœ°æ­å»ºæˆåŠŸï¼</p>\n<h3 id=\"æ·»åŠ å»ºç«™è„šæœ¬\"><a href=\"#æ·»åŠ å»ºç«™è„šæœ¬\" class=\"headerlink\" title=\"æ·»åŠ å»ºç«™è„šæœ¬\"></a>æ·»åŠ å»ºç«™è„šæœ¬</h3><p>ä¸ºäº†åç»­<code>netlify</code>å»ºç«™æ–¹ä¾¿ï¼Œåœ¨<code>package.json</code>é‡Œé¢æ·»åŠ ä¸€ä¸ªå‘½ä»¤ï¼š</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">JSON</span><br><span class=\"line\"><span class=\"punctuation\">{</span></span><br><span class=\"line\">    <span class=\"comment\">// ......</span></span><br><span class=\"line\">    <span class=\"attr\">\"scripts\"</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">{</span></span><br><span class=\"line\">        <span class=\"attr\">\"build\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"hexo generate\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"attr\">\"clean\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"hexo clean\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"attr\">\"deploy\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"hexo deploy\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"attr\">\"server\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"hexo server\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"attr\">\"netlify\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"npm run clean &amp;&amp; npm run build\"</span> <span class=\"comment\">// æ–°åŠ è¡Œ</span></span><br><span class=\"line\">    <span class=\"punctuation\">}</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"comment\">// ......</span></span><br><span class=\"line\"><span class=\"punctuation\">}</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"GitHubæ‰˜ç®¡é¡¹ç›®æ–‡ä»¶\"><a href=\"#GitHubæ‰˜ç®¡é¡¹ç›®æ–‡ä»¶\" class=\"headerlink\" title=\"GitHubæ‰˜ç®¡é¡¹ç›®æ–‡ä»¶\"></a>GitHubæ‰˜ç®¡é¡¹ç›®æ–‡ä»¶</h2><p>åˆ›å»ºæœ¬åœ°ä»“åº“ï¼Œæ¨é€åˆ°è¿œç«¯æœåŠ¡å™¨</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> blog</span><br><span class=\"line\">git init</span><br><span class=\"line\">git add .</span><br><span class=\"line\">git commit -m <span class=\"string\">\"my blog first commit\"</span></span><br><span class=\"line\">git remote add origin <span class=\"string\">\"è¿œç«¯githubä»“åº“åœ°å€\"</span></span><br><span class=\"line\">git branch -M main</span><br><span class=\"line\">git push -u origin main</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Netlifyå»ºç«™\"><a href=\"#Netlifyå»ºç«™\" class=\"headerlink\" title=\"Netlifyå»ºç«™\"></a>Netlifyå»ºç«™</h2><p>ç”±äº GitHub è‡ªå¸¦çš„ gitpage è®¿é—®é€Ÿåº¦è¾ƒæ…¢ï¼Œæˆ‘ä»¬ä½¿ç”¨ Netlifyï¼ˆä¸€ä¸ªå›½å¤–çš„å…è´¹çš„æä¾›é™æ€ç½‘ç«™éƒ¨ç½²æœåŠ¡çš„å¹³å°ï¼‰å°†æ‰˜ç®¡ GitHub ä¸Šçš„é™æ€ç½‘ç«™éƒ¨ç½²ä¸Šçº¿ã€‚</p>\n<h3 id=\"æ­¥éª¤\"><a href=\"#æ­¥éª¤\" class=\"headerlink\" title=\"æ­¥éª¤\"></a>æ­¥éª¤</h3><p>1ã€æ³¨å†Œå¹¶ç™»é™† Netlify</p>\n<p>2ã€add new site - import an existing project</p>\n<p>3ã€è¿æ¥åˆ° GitHubï¼Œé€‰æ‹©æˆ‘ä»¬æ‰˜ç®¡åœ¨ GitHub ä¸Šçš„åšå®¢é¡¹ç›®</p>\n<p>4ã€åœ¨è®¾ç½®ä¸­æ³¨æ„ä¿®æ”¹ä¸€å¤„ï¼ŒBasic build settings - Build command ä¿®æ”¹ä¸º <code>npm run netlify</code></p>\n<p>5ã€æ„å»ºå®Œæˆå¯ä»¥çœ‹åˆ°ä¸€ä¸ª xxx.netlify.app çš„ urlï¼Œå³ä¸ºæˆ‘ä»¬åšå®¢çš„ urlï¼Œä¿®æ”¹è¯¥ url ä¸­çš„ xxx ä¸º yaxing97ï¼Œå³è®¾ç½®æˆ‘çš„ä¸ªäººåšå®¢åŸŸåä¸º<code>yaxing97.netlify.app</code></p>\n<h3 id=\"é…ç½®åŸŸå\"><a href=\"#é…ç½®åŸŸå\" class=\"headerlink\" title=\"é…ç½®åŸŸå\"></a>é…ç½®åŸŸå</h3><p>1ã€è´­ä¹°åŸŸåï¼ˆå›½å†…å›½å¤–éƒ½å¯ï¼‰</p>\n<p>2ã€è´­ä¹°å®Œæˆååœ¨åŸŸååˆ—è¡¨æ‰¾åˆ°è‡ªå·±çš„åŸŸåï¼Œç‚¹å‡»æ“ä½œä¸­çš„è§£ææŒ‰é’®</p>\n<p>3ã€è®¾ç½®åŸŸåè§£æï¼Œç±»å‹ä¸º<code>CNAME</code>ï¼Œä¸»æœºè®°å½•ä¸º<code>@</code>ï¼Œè®°å½•å€¼ä¸º<code>yaxing97.netlify.app</code>ï¼Œå…¶ä¸­<code>yaxing97</code>æ˜¯ä¹‹å‰å»ºç«™æ­¥éª¤ä¸­è®¾ç½®çš„ä¸ªæ€§äºŒçº§åŸŸå</p>\n<p>4ã€åœ¨ netlify ä¸­é…ç½®åŸŸåï¼Œdomain management - domains - add custom domainï¼Œä¸€è·¯é€šè¿‡å³å¯</p>\n<h2 id=\"CloudFlareåŠ é€Ÿ\"><a href=\"#CloudFlareåŠ é€Ÿ\" class=\"headerlink\" title=\"CloudFlareåŠ é€Ÿ\"></a>CloudFlareåŠ é€Ÿ</h2><p>Netlify è™½ç„¶å·²ç»æä¾›äº† CDN åŠ é€Ÿï¼Œä½†åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­å‘ç°å›½å†…è®¿é—®è¿˜æ˜¯æ¯”è¾ƒæ…¢ï¼ŒCloudflare ç›¸å¯¹äºå›½å†…çš„ä¸ƒç‰›äº‘ã€é˜¿é‡Œäº‘ç­‰äº‘æœåŠ¡å•†çš„ CDN é€Ÿåº¦ä¼šæ…¢ä¸€äº›ï¼Œä½†æ˜¯å®ƒæœ‰å…è´¹ç‰ˆæœ¬ï¼Œè€Œä¸”æœ€é‡è¦çš„æ˜¯åŸŸåä¸ç”¨å¤‡æ¡ˆã€‚</p>\n<h3 id=\"æ­¥éª¤-1\"><a href=\"#æ­¥éª¤-1\" class=\"headerlink\" title=\"æ­¥éª¤\"></a>æ­¥éª¤</h3><p>1ã€æ³¨å†Œ Cloudflare å¹¶ç™»é™†</p>\n<p>2ã€è¾“å…¥æ‚¨çš„ç«™ç‚¹ï¼ˆyaxing97.comï¼‰ï¼Œç‚¹å‡»æ·»åŠ ç«™ç‚¹</p>\n<p>3ã€é€‰æ‹©å…è´¹å¥—é¤</p>\n<p>4ã€æ·»åŠ  DNSï¼ŒType ä¸º<code>CNAME</code>ï¼ŒName ä¸º<code>yaxing97.com</code>ï¼ŒContent ä¸º<code>yaxing97.netlify.app</code></p>\n<p>5ã€ä½¿ç”¨ cloudflare æä¾›çš„ dns è§£ææœåŠ¡å™¨ï¼ˆCloudflare Nameserversï¼‰å¯¹ <code>yaxing97.com</code> è¿›è¡Œ dns è§£æ</p>\n<p>6ã€åˆ°é˜¿é‡Œäº‘æ§åˆ¶å°ä¸­ï¼ŒDNS ç®¡ç† - DNS ä¿®æ”¹ï¼Œä¿®æ”¹ DNS æœåŠ¡å™¨</p>\n<h2 id=\"é…ç½®https\"><a href=\"#é…ç½®https\" class=\"headerlink\" title=\"é…ç½®https\"></a>é…ç½®https</h2><p>å›åˆ° netlify ä¸­ï¼ŒDomain management - HTTPSï¼Œç‚¹å‡» verify DNS configurationï¼Œç»“æœå¦‚ä¸‹å³ä¸ºé…ç½®å®Œæˆ</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/image-20221212214817015.png\" alt=\"é…ç½®HTTPS\"></p>\n<h2 id=\"æ–‡ç« ç¼–å†™\"><a href=\"#æ–‡ç« ç¼–å†™\" class=\"headerlink\" title=\"æ–‡ç« ç¼–å†™\"></a>æ–‡ç« ç¼–å†™</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo new <span class=\"string\">\"æ–‡ç« æ ‡é¢˜\"</span></span><br><span class=\"line\"><span class=\"comment\"># ç¼–å†™å¥½ä¹‹å</span></span><br><span class=\"line\">hexo clean</span><br><span class=\"line\">hexo g</span><br><span class=\"line\">git add *</span><br><span class=\"line\">git commit -m <span class=\"string\">\"commitä¿¡æ¯\"</span></span><br><span class=\"line\">git push</span><br></pre></td></tr></table></figure>\n\n<p>è¿‡ç‰‡åˆ»ï¼Œè®¿é—®æˆ‘ä»¬çš„<code>https://yaxing97.com</code>ï¼Œå¯ä»¥çœ‹åˆ°æ–°æ·»åŠ çš„æ–‡ç« ã€‚</p>\n<h2 id=\"å‚è€ƒ-amp-æ›´å¤š\"><a href=\"#å‚è€ƒ-amp-æ›´å¤š\" class=\"headerlink\" title=\"å‚è€ƒ&æ›´å¤š\"></a>å‚è€ƒ&amp;æ›´å¤š</h2><p><a href=\"https://blog.cuijiacai.com/blog-building/\">https://blog.cuijiacai.com/blog-building/</a></p>\n<p><a href=\"https://www.mdnice.com/writing/382af676baff4ed4ad5511074fb736da\">https://www.mdnice.com/writing/382af676baff4ed4ad5511074fb736da</a></p>\n","site":{"data":{}},"length":2194,"excerpt":"<h2 id=\"ç³»ç»Ÿç¯å¢ƒ-amp-å·¥å…·\"><a href=\"#ç³»ç»Ÿç¯å¢ƒ-amp-å·¥å…·\" class=\"headerlink\" title=\"ç³»ç»Ÿç¯å¢ƒ&å·¥å…·\"></a>ç³»ç»Ÿç¯å¢ƒ&amp;å·¥å…·</h2><p>ç³»ç»Ÿç¯å¢ƒï¼šMacOS</p>\n<p>å·¥å…·ï¼šåšå®¢æ¡†æ¶ä¸º hexoï¼Œåšå®¢æ–‡ä»¶æ‰˜ç®¡äº GitHubï¼Œåšå®¢ç½‘ç«™ç”¨ Netlify ç”Ÿæˆï¼Œå›½å†…è®¿é—®é‡‡ç”¨ CloudFlare è¿›è¡Œ CDN åŠ é€Ÿ</p>","more":"<h2 id=\"hexoåšå®¢æ¡†æ¶å®‰è£…\"><a href=\"#hexoåšå®¢æ¡†æ¶å®‰è£…\" class=\"headerlink\" title=\"hexoåšå®¢æ¡†æ¶å®‰è£…\"></a>hexoåšå®¢æ¡†æ¶å®‰è£…</h2><h3 id=\"é¢„å…ˆç¯å¢ƒ\"><a href=\"#é¢„å…ˆç¯å¢ƒ\" class=\"headerlink\" title=\"é¢„å…ˆç¯å¢ƒ\"></a>é¢„å…ˆç¯å¢ƒ</h3><p>1ã€å®‰è£… nodeï¼ˆä½¿ç”¨ homebrewï¼‰</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew install node</span><br></pre></td></tr></table></figure>\n\n<p>2ã€æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ­£å¸¸çœ‹åˆ°ç‰ˆæœ¬ä¿¡æ¯å³ä¸ºæˆåŠŸ</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">node -v</span><br><span class=\"line\">npm -v</span><br></pre></td></tr></table></figure>\n\n<p>3ã€åˆ‡æ¢ npm çš„æºå°†æºè®¾ç½®ä¸ºæ·˜å®æºï¼ˆé€Ÿåº¦å¿«ï¼‰</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm config get registry\t<span class=\"comment\"># æŸ¥çœ‹æº</span></span><br><span class=\"line\">npm config <span class=\"built_in\">set</span> registry https://registry.npm.taobao.org <span class=\"comment\"># ä¿®æ”¹ä¸ºæ·˜å®æº</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"å®‰è£…\"><a href=\"#å®‰è£…\" class=\"headerlink\" title=\"å®‰è£…\"></a>å®‰è£…</h3><p>1ã€å®‰è£… hexo</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install hexo-cli -g <span class=\"comment\"># å…¨å±€å®‰è£…hexoå‘½ä»¤è¡Œå·¥å…·</span></span><br></pre></td></tr></table></figure>\n\n<p>2ã€åˆå§‹åŒ–åšå®¢é¡¹ç›®</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo init <span class=\"string\">\"åšå®¢ç›®å½•åç§°\"</span></span><br><span class=\"line\"><span class=\"comment\"># hexo init \"blog\" å³æˆ‘çš„åšå®¢ç›®å½•åç§°ä¸ºblogï¼Œåç»­éƒ½ç”¨è¯¥ç›®å½•æ¥è®²è§£</span></span><br></pre></td></tr></table></figure>\n\n<p>3ã€åˆ‡æ¢è‡³åšå®¢ç›®å½•å®‰è£…ä¾èµ–</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> blog</span><br><span class=\"line\">npm install</span><br></pre></td></tr></table></figure>\n\n<p>4ã€è¿è¡Œ</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo clean</span><br><span class=\"line\">hexo g</span><br><span class=\"line\">hexo s</span><br></pre></td></tr></table></figure>\n\n<p>æ‰“å¼€é“¾æ¥ï¼Œæœ¬åœ°å‡ºç°åšå®¢ç•Œé¢ï¼Œå³æœ¬åœ°æ­å»ºæˆåŠŸï¼</p>\n<h3 id=\"æ·»åŠ å»ºç«™è„šæœ¬\"><a href=\"#æ·»åŠ å»ºç«™è„šæœ¬\" class=\"headerlink\" title=\"æ·»åŠ å»ºç«™è„šæœ¬\"></a>æ·»åŠ å»ºç«™è„šæœ¬</h3><p>ä¸ºäº†åç»­<code>netlify</code>å»ºç«™æ–¹ä¾¿ï¼Œåœ¨<code>package.json</code>é‡Œé¢æ·»åŠ ä¸€ä¸ªå‘½ä»¤ï¼š</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">JSON</span><br><span class=\"line\"><span class=\"punctuation\">{</span></span><br><span class=\"line\">    <span class=\"comment\">// ......</span></span><br><span class=\"line\">    <span class=\"attr\">\"scripts\"</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">{</span></span><br><span class=\"line\">        <span class=\"attr\">\"build\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"hexo generate\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"attr\">\"clean\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"hexo clean\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"attr\">\"deploy\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"hexo deploy\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"attr\">\"server\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"hexo server\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"attr\">\"netlify\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"npm run clean &amp;&amp; npm run build\"</span> <span class=\"comment\">// æ–°åŠ è¡Œ</span></span><br><span class=\"line\">    <span class=\"punctuation\">}</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"comment\">// ......</span></span><br><span class=\"line\"><span class=\"punctuation\">}</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"GitHubæ‰˜ç®¡é¡¹ç›®æ–‡ä»¶\"><a href=\"#GitHubæ‰˜ç®¡é¡¹ç›®æ–‡ä»¶\" class=\"headerlink\" title=\"GitHubæ‰˜ç®¡é¡¹ç›®æ–‡ä»¶\"></a>GitHubæ‰˜ç®¡é¡¹ç›®æ–‡ä»¶</h2><p>åˆ›å»ºæœ¬åœ°ä»“åº“ï¼Œæ¨é€åˆ°è¿œç«¯æœåŠ¡å™¨</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> blog</span><br><span class=\"line\">git init</span><br><span class=\"line\">git add .</span><br><span class=\"line\">git commit -m <span class=\"string\">\"my blog first commit\"</span></span><br><span class=\"line\">git remote add origin <span class=\"string\">\"è¿œç«¯githubä»“åº“åœ°å€\"</span></span><br><span class=\"line\">git branch -M main</span><br><span class=\"line\">git push -u origin main</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Netlifyå»ºç«™\"><a href=\"#Netlifyå»ºç«™\" class=\"headerlink\" title=\"Netlifyå»ºç«™\"></a>Netlifyå»ºç«™</h2><p>ç”±äº GitHub è‡ªå¸¦çš„ gitpage è®¿é—®é€Ÿåº¦è¾ƒæ…¢ï¼Œæˆ‘ä»¬ä½¿ç”¨ Netlifyï¼ˆä¸€ä¸ªå›½å¤–çš„å…è´¹çš„æä¾›é™æ€ç½‘ç«™éƒ¨ç½²æœåŠ¡çš„å¹³å°ï¼‰å°†æ‰˜ç®¡ GitHub ä¸Šçš„é™æ€ç½‘ç«™éƒ¨ç½²ä¸Šçº¿ã€‚</p>\n<h3 id=\"æ­¥éª¤\"><a href=\"#æ­¥éª¤\" class=\"headerlink\" title=\"æ­¥éª¤\"></a>æ­¥éª¤</h3><p>1ã€æ³¨å†Œå¹¶ç™»é™† Netlify</p>\n<p>2ã€add new site - import an existing project</p>\n<p>3ã€è¿æ¥åˆ° GitHubï¼Œé€‰æ‹©æˆ‘ä»¬æ‰˜ç®¡åœ¨ GitHub ä¸Šçš„åšå®¢é¡¹ç›®</p>\n<p>4ã€åœ¨è®¾ç½®ä¸­æ³¨æ„ä¿®æ”¹ä¸€å¤„ï¼ŒBasic build settings - Build command ä¿®æ”¹ä¸º <code>npm run netlify</code></p>\n<p>5ã€æ„å»ºå®Œæˆå¯ä»¥çœ‹åˆ°ä¸€ä¸ª xxx.netlify.app çš„ urlï¼Œå³ä¸ºæˆ‘ä»¬åšå®¢çš„ urlï¼Œä¿®æ”¹è¯¥ url ä¸­çš„ xxx ä¸º yaxing97ï¼Œå³è®¾ç½®æˆ‘çš„ä¸ªäººåšå®¢åŸŸåä¸º<code>yaxing97.netlify.app</code></p>\n<h3 id=\"é…ç½®åŸŸå\"><a href=\"#é…ç½®åŸŸå\" class=\"headerlink\" title=\"é…ç½®åŸŸå\"></a>é…ç½®åŸŸå</h3><p>1ã€è´­ä¹°åŸŸåï¼ˆå›½å†…å›½å¤–éƒ½å¯ï¼‰</p>\n<p>2ã€è´­ä¹°å®Œæˆååœ¨åŸŸååˆ—è¡¨æ‰¾åˆ°è‡ªå·±çš„åŸŸåï¼Œç‚¹å‡»æ“ä½œä¸­çš„è§£ææŒ‰é’®</p>\n<p>3ã€è®¾ç½®åŸŸåè§£æï¼Œç±»å‹ä¸º<code>CNAME</code>ï¼Œä¸»æœºè®°å½•ä¸º<code>@</code>ï¼Œè®°å½•å€¼ä¸º<code>yaxing97.netlify.app</code>ï¼Œå…¶ä¸­<code>yaxing97</code>æ˜¯ä¹‹å‰å»ºç«™æ­¥éª¤ä¸­è®¾ç½®çš„ä¸ªæ€§äºŒçº§åŸŸå</p>\n<p>4ã€åœ¨ netlify ä¸­é…ç½®åŸŸåï¼Œdomain management - domains - add custom domainï¼Œä¸€è·¯é€šè¿‡å³å¯</p>\n<h2 id=\"CloudFlareåŠ é€Ÿ\"><a href=\"#CloudFlareåŠ é€Ÿ\" class=\"headerlink\" title=\"CloudFlareåŠ é€Ÿ\"></a>CloudFlareåŠ é€Ÿ</h2><p>Netlify è™½ç„¶å·²ç»æä¾›äº† CDN åŠ é€Ÿï¼Œä½†åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­å‘ç°å›½å†…è®¿é—®è¿˜æ˜¯æ¯”è¾ƒæ…¢ï¼ŒCloudflare ç›¸å¯¹äºå›½å†…çš„ä¸ƒç‰›äº‘ã€é˜¿é‡Œäº‘ç­‰äº‘æœåŠ¡å•†çš„ CDN é€Ÿåº¦ä¼šæ…¢ä¸€äº›ï¼Œä½†æ˜¯å®ƒæœ‰å…è´¹ç‰ˆæœ¬ï¼Œè€Œä¸”æœ€é‡è¦çš„æ˜¯åŸŸåä¸ç”¨å¤‡æ¡ˆã€‚</p>\n<h3 id=\"æ­¥éª¤-1\"><a href=\"#æ­¥éª¤-1\" class=\"headerlink\" title=\"æ­¥éª¤\"></a>æ­¥éª¤</h3><p>1ã€æ³¨å†Œ Cloudflare å¹¶ç™»é™†</p>\n<p>2ã€è¾“å…¥æ‚¨çš„ç«™ç‚¹ï¼ˆyaxing97.comï¼‰ï¼Œç‚¹å‡»æ·»åŠ ç«™ç‚¹</p>\n<p>3ã€é€‰æ‹©å…è´¹å¥—é¤</p>\n<p>4ã€æ·»åŠ  DNSï¼ŒType ä¸º<code>CNAME</code>ï¼ŒName ä¸º<code>yaxing97.com</code>ï¼ŒContent ä¸º<code>yaxing97.netlify.app</code></p>\n<p>5ã€ä½¿ç”¨ cloudflare æä¾›çš„ dns è§£ææœåŠ¡å™¨ï¼ˆCloudflare Nameserversï¼‰å¯¹ <code>yaxing97.com</code> è¿›è¡Œ dns è§£æ</p>\n<p>6ã€åˆ°é˜¿é‡Œäº‘æ§åˆ¶å°ä¸­ï¼ŒDNS ç®¡ç† - DNS ä¿®æ”¹ï¼Œä¿®æ”¹ DNS æœåŠ¡å™¨</p>\n<h2 id=\"é…ç½®https\"><a href=\"#é…ç½®https\" class=\"headerlink\" title=\"é…ç½®https\"></a>é…ç½®https</h2><p>å›åˆ° netlify ä¸­ï¼ŒDomain management - HTTPSï¼Œç‚¹å‡» verify DNS configurationï¼Œç»“æœå¦‚ä¸‹å³ä¸ºé…ç½®å®Œæˆ</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/image-20221212214817015.png\" alt=\"é…ç½®HTTPS\"></p>\n<h2 id=\"æ–‡ç« ç¼–å†™\"><a href=\"#æ–‡ç« ç¼–å†™\" class=\"headerlink\" title=\"æ–‡ç« ç¼–å†™\"></a>æ–‡ç« ç¼–å†™</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo new <span class=\"string\">\"æ–‡ç« æ ‡é¢˜\"</span></span><br><span class=\"line\"><span class=\"comment\"># ç¼–å†™å¥½ä¹‹å</span></span><br><span class=\"line\">hexo clean</span><br><span class=\"line\">hexo g</span><br><span class=\"line\">git add *</span><br><span class=\"line\">git commit -m <span class=\"string\">\"commitä¿¡æ¯\"</span></span><br><span class=\"line\">git push</span><br></pre></td></tr></table></figure>\n\n<p>è¿‡ç‰‡åˆ»ï¼Œè®¿é—®æˆ‘ä»¬çš„<code>https://yaxing97.com</code>ï¼Œå¯ä»¥çœ‹åˆ°æ–°æ·»åŠ çš„æ–‡ç« ã€‚</p>\n<h2 id=\"å‚è€ƒ-amp-æ›´å¤š\"><a href=\"#å‚è€ƒ-amp-æ›´å¤š\" class=\"headerlink\" title=\"å‚è€ƒ&æ›´å¤š\"></a>å‚è€ƒ&amp;æ›´å¤š</h2><p><a href=\"https://blog.cuijiacai.com/blog-building/\">https://blog.cuijiacai.com/blog-building/</a></p>\n<p><a href=\"https://www.mdnice.com/writing/382af676baff4ed4ad5511074fb736da\">https://www.mdnice.com/writing/382af676baff4ed4ad5511074fb736da</a></p>"},{"title":"æ–°ä¹°çš„å°ä¹¦æ¡Œ","copyright":true,"mathjax":true,"date":"2022-12-14T08:21:02.000Z","urlname":"new-desk","_content":"\nä¹‹å‰ä¹°äº†ä¸ª LG çš„ 27 å¯¸æ˜¾ç¤ºå™¨ï¼Œæ”¾åœ¨ä¹¦æˆ¿çš„æ¡Œå­ä¸Šï¼Œä¸€æ–¹é¢ä¸èƒ½å‡é«˜ï¼ˆä¸Šé¢æœ‰æ¶æ¿æŒ¡ä½ï¼‰ï¼Œå¦ä¸€æ–¹é¢æ˜¯æ¡Œå­å®½åº¦ä¸å¤Ÿï¼ˆåªæœ‰ 50cmï¼‰ï¼Œæ˜¾ç¤ºå™¨é å¢™å‰é¢åªèƒ½å‹‰å¼ºæ”¾ä¸‹æˆ‘çš„ macï¼Œå¯¼è‡´å±å¹•ç¦»æˆ‘å¾ˆè¿‘ï¼Œè§‚æ„Ÿæå·®ã€‚äºæ˜¯åœ¨æ·˜å®ä¸Šæ·˜äº†ä¸ªä¹¦æ¡Œï¼Œè¿˜ç®—ä¸é”™ã€‚\n\n<!--more-->\n\nå¦‚æœè¦ä½¿ç”¨ 27 å¯¸åŠä»¥ä¸Šå°ºå¯¸æ˜¾ç¤ºå™¨çš„è¯ï¼Œå»ºè®®è´­ä¹°å®½åº¦è‡³å°‘ 70cm çš„ï¼Œæˆ‘è´­ä¹°çš„å°ºå¯¸ä¸º $120 \\times 80 \\times 74 cm$ï¼Œåº—é“ºæ˜¯â€œæ–°å°šç¾å®¶å±…â€ã€‚\n\næ³¨æ„åˆ°æ‰‹éœ€è¦è‡ªå·±æ‹§èºä¸å›ºå®šæ¡Œè…¿å’Œæ¡Œæ¿ï¼ˆç”¨ç”µåŠ¨èºä¸åˆ€ï¼‰ä»¥åŠæ¡Œè…¿å’Œæ¡Œè…¿ä¹‹é—´çš„è¿æ¥ï¼ˆæ‰‹æ‹§å³å¯ï¼‰ã€‚\n\nä»¥ä¸‹æ˜¯å®æ‹å›¾ hhã€‚\n\n![æ–°ä¹¦æ¡Œå®æ‹å›¾](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/IMG_1396.JPG)\n","source":"_posts/æ–°ä¹°çš„å°ä¹¦æ¡Œ.md","raw":"---\ntitle: æ–°ä¹°çš„å°ä¹¦æ¡Œ\ncopyright: true\nmathjax: true\ndate: 2022-12-14 16:21:02\ncategories: æ—¥å¸¸å°è®°\ntags: \nurlname: new-desk\n---\n\nä¹‹å‰ä¹°äº†ä¸ª LG çš„ 27 å¯¸æ˜¾ç¤ºå™¨ï¼Œæ”¾åœ¨ä¹¦æˆ¿çš„æ¡Œå­ä¸Šï¼Œä¸€æ–¹é¢ä¸èƒ½å‡é«˜ï¼ˆä¸Šé¢æœ‰æ¶æ¿æŒ¡ä½ï¼‰ï¼Œå¦ä¸€æ–¹é¢æ˜¯æ¡Œå­å®½åº¦ä¸å¤Ÿï¼ˆåªæœ‰ 50cmï¼‰ï¼Œæ˜¾ç¤ºå™¨é å¢™å‰é¢åªèƒ½å‹‰å¼ºæ”¾ä¸‹æˆ‘çš„ macï¼Œå¯¼è‡´å±å¹•ç¦»æˆ‘å¾ˆè¿‘ï¼Œè§‚æ„Ÿæå·®ã€‚äºæ˜¯åœ¨æ·˜å®ä¸Šæ·˜äº†ä¸ªä¹¦æ¡Œï¼Œè¿˜ç®—ä¸é”™ã€‚\n\n<!--more-->\n\nå¦‚æœè¦ä½¿ç”¨ 27 å¯¸åŠä»¥ä¸Šå°ºå¯¸æ˜¾ç¤ºå™¨çš„è¯ï¼Œå»ºè®®è´­ä¹°å®½åº¦è‡³å°‘ 70cm çš„ï¼Œæˆ‘è´­ä¹°çš„å°ºå¯¸ä¸º $120 \\times 80 \\times 74 cm$ï¼Œåº—é“ºæ˜¯â€œæ–°å°šç¾å®¶å±…â€ã€‚\n\næ³¨æ„åˆ°æ‰‹éœ€è¦è‡ªå·±æ‹§èºä¸å›ºå®šæ¡Œè…¿å’Œæ¡Œæ¿ï¼ˆç”¨ç”µåŠ¨èºä¸åˆ€ï¼‰ä»¥åŠæ¡Œè…¿å’Œæ¡Œè…¿ä¹‹é—´çš„è¿æ¥ï¼ˆæ‰‹æ‹§å³å¯ï¼‰ã€‚\n\nä»¥ä¸‹æ˜¯å®æ‹å›¾ hhã€‚\n\n![æ–°ä¹¦æ¡Œå®æ‹å›¾](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/IMG_1396.JPG)\n","slug":"æ–°ä¹°çš„å°ä¹¦æ¡Œ","published":1,"updated":"2023-01-26T12:35:58.983Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cldzfw32a0018t9t80g27c17z","content":"<p>ä¹‹å‰ä¹°äº†ä¸ª LG çš„ 27 å¯¸æ˜¾ç¤ºå™¨ï¼Œæ”¾åœ¨ä¹¦æˆ¿çš„æ¡Œå­ä¸Šï¼Œä¸€æ–¹é¢ä¸èƒ½å‡é«˜ï¼ˆä¸Šé¢æœ‰æ¶æ¿æŒ¡ä½ï¼‰ï¼Œå¦ä¸€æ–¹é¢æ˜¯æ¡Œå­å®½åº¦ä¸å¤Ÿï¼ˆåªæœ‰ 50cmï¼‰ï¼Œæ˜¾ç¤ºå™¨é å¢™å‰é¢åªèƒ½å‹‰å¼ºæ”¾ä¸‹æˆ‘çš„ macï¼Œå¯¼è‡´å±å¹•ç¦»æˆ‘å¾ˆè¿‘ï¼Œè§‚æ„Ÿæå·®ã€‚äºæ˜¯åœ¨æ·˜å®ä¸Šæ·˜äº†ä¸ªä¹¦æ¡Œï¼Œè¿˜ç®—ä¸é”™ã€‚</p>\n<span id=\"more\"></span>\n\n<p>å¦‚æœè¦ä½¿ç”¨ 27 å¯¸åŠä»¥ä¸Šå°ºå¯¸æ˜¾ç¤ºå™¨çš„è¯ï¼Œå»ºè®®è´­ä¹°å®½åº¦è‡³å°‘ 70cm çš„ï¼Œæˆ‘è´­ä¹°çš„å°ºå¯¸ä¸º <mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.05ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"16.416ex\" height=\"1.581ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -677 7255.9 699\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mn\"><path data-c=\"31\" d=\"M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z\"></path><path data-c=\"32\" d=\"M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z\" transform=\"translate(500,0)\"></path><path data-c=\"30\" d=\"M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z\" transform=\"translate(1000,0)\"></path></g><g data-mml-node=\"mo\" transform=\"translate(1722.2,0)\"><path data-c=\"D7\" d=\"M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z\"></path></g><g data-mml-node=\"mn\" transform=\"translate(2722.4,0)\"><path data-c=\"38\" d=\"M70 417T70 494T124 618T248 666Q319 666 374 624T429 515Q429 485 418 459T392 417T361 389T335 371T324 363L338 354Q352 344 366 334T382 323Q457 264 457 174Q457 95 399 37T249 -22Q159 -22 101 29T43 155Q43 263 172 335L154 348Q133 361 127 368Q70 417 70 494ZM286 386L292 390Q298 394 301 396T311 403T323 413T334 425T345 438T355 454T364 471T369 491T371 513Q371 556 342 586T275 624Q268 625 242 625Q201 625 165 599T128 534Q128 511 141 492T167 463T217 431Q224 426 228 424L286 386ZM250 21Q308 21 350 55T392 137Q392 154 387 169T375 194T353 216T330 234T301 253T274 270Q260 279 244 289T218 306L210 311Q204 311 181 294T133 239T107 157Q107 98 150 60T250 21Z\"></path><path data-c=\"30\" d=\"M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z\" transform=\"translate(500,0)\"></path></g><g data-mml-node=\"mo\" transform=\"translate(3944.7,0)\"><path data-c=\"D7\" d=\"M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z\"></path></g><g data-mml-node=\"mn\" transform=\"translate(4944.9,0)\"><path data-c=\"37\" d=\"M55 458Q56 460 72 567L88 674Q88 676 108 676H128V672Q128 662 143 655T195 646T364 644H485V605L417 512Q408 500 387 472T360 435T339 403T319 367T305 330T292 284T284 230T278 162T275 80Q275 66 275 52T274 28V19Q270 2 255 -10T221 -22Q210 -22 200 -19T179 0T168 40Q168 198 265 368Q285 400 349 489L395 552H302Q128 552 119 546Q113 543 108 522T98 479L95 458V455H55V458Z\"></path><path data-c=\"34\" d=\"M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z\" transform=\"translate(500,0)\"></path></g><g data-mml-node=\"mi\" transform=\"translate(5944.9,0)\"><path data-c=\"1D450\" d=\"M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(6377.9,0)\"><path data-c=\"1D45A\" d=\"M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z\"></path></g></g></g></svg></mjx-container>ï¼Œåº—é“ºæ˜¯â€œæ–°å°šç¾å®¶å±…â€ã€‚</p>\n<p>æ³¨æ„åˆ°æ‰‹éœ€è¦è‡ªå·±æ‹§èºä¸å›ºå®šæ¡Œè…¿å’Œæ¡Œæ¿ï¼ˆç”¨ç”µåŠ¨èºä¸åˆ€ï¼‰ä»¥åŠæ¡Œè…¿å’Œæ¡Œè…¿ä¹‹é—´çš„è¿æ¥ï¼ˆæ‰‹æ‹§å³å¯ï¼‰ã€‚</p>\n<p>ä»¥ä¸‹æ˜¯å®æ‹å›¾ hhã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/IMG_1396.JPG\" alt=\"æ–°ä¹¦æ¡Œå®æ‹å›¾\"></p>\n","site":{"data":{}},"length":240,"excerpt":"<p>ä¹‹å‰ä¹°äº†ä¸ª LG çš„ 27 å¯¸æ˜¾ç¤ºå™¨ï¼Œæ”¾åœ¨ä¹¦æˆ¿çš„æ¡Œå­ä¸Šï¼Œä¸€æ–¹é¢ä¸èƒ½å‡é«˜ï¼ˆä¸Šé¢æœ‰æ¶æ¿æŒ¡ä½ï¼‰ï¼Œå¦ä¸€æ–¹é¢æ˜¯æ¡Œå­å®½åº¦ä¸å¤Ÿï¼ˆåªæœ‰ 50cmï¼‰ï¼Œæ˜¾ç¤ºå™¨é å¢™å‰é¢åªèƒ½å‹‰å¼ºæ”¾ä¸‹æˆ‘çš„ macï¼Œå¯¼è‡´å±å¹•ç¦»æˆ‘å¾ˆè¿‘ï¼Œè§‚æ„Ÿæå·®ã€‚äºæ˜¯åœ¨æ·˜å®ä¸Šæ·˜äº†ä¸ªä¹¦æ¡Œï¼Œè¿˜ç®—ä¸é”™ã€‚</p>","more":"<p>å¦‚æœè¦ä½¿ç”¨ 27 å¯¸åŠä»¥ä¸Šå°ºå¯¸æ˜¾ç¤ºå™¨çš„è¯ï¼Œå»ºè®®è´­ä¹°å®½åº¦è‡³å°‘ 70cm çš„ï¼Œæˆ‘è´­ä¹°çš„å°ºå¯¸ä¸º <mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.05ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"16.416ex\" height=\"1.581ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -677 7255.9 699\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mn\"><path data-c=\"31\" d=\"M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z\"></path><path data-c=\"32\" d=\"M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z\" transform=\"translate(500,0)\"></path><path data-c=\"30\" d=\"M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z\" transform=\"translate(1000,0)\"></path></g><g data-mml-node=\"mo\" transform=\"translate(1722.2,0)\"><path data-c=\"D7\" d=\"M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z\"></path></g><g data-mml-node=\"mn\" transform=\"translate(2722.4,0)\"><path data-c=\"38\" d=\"M70 417T70 494T124 618T248 666Q319 666 374 624T429 515Q429 485 418 459T392 417T361 389T335 371T324 363L338 354Q352 344 366 334T382 323Q457 264 457 174Q457 95 399 37T249 -22Q159 -22 101 29T43 155Q43 263 172 335L154 348Q133 361 127 368Q70 417 70 494ZM286 386L292 390Q298 394 301 396T311 403T323 413T334 425T345 438T355 454T364 471T369 491T371 513Q371 556 342 586T275 624Q268 625 242 625Q201 625 165 599T128 534Q128 511 141 492T167 463T217 431Q224 426 228 424L286 386ZM250 21Q308 21 350 55T392 137Q392 154 387 169T375 194T353 216T330 234T301 253T274 270Q260 279 244 289T218 306L210 311Q204 311 181 294T133 239T107 157Q107 98 150 60T250 21Z\"></path><path data-c=\"30\" d=\"M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z\" transform=\"translate(500,0)\"></path></g><g data-mml-node=\"mo\" transform=\"translate(3944.7,0)\"><path data-c=\"D7\" d=\"M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z\"></path></g><g data-mml-node=\"mn\" transform=\"translate(4944.9,0)\"><path data-c=\"37\" d=\"M55 458Q56 460 72 567L88 674Q88 676 108 676H128V672Q128 662 143 655T195 646T364 644H485V605L417 512Q408 500 387 472T360 435T339 403T319 367T305 330T292 284T284 230T278 162T275 80Q275 66 275 52T274 28V19Q270 2 255 -10T221 -22Q210 -22 200 -19T179 0T168 40Q168 198 265 368Q285 400 349 489L395 552H302Q128 552 119 546Q113 543 108 522T98 479L95 458V455H55V458Z\"></path><path data-c=\"34\" d=\"M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z\" transform=\"translate(500,0)\"></path></g><g data-mml-node=\"mi\" transform=\"translate(5944.9,0)\"><path data-c=\"1D450\" d=\"M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(6377.9,0)\"><path data-c=\"1D45A\" d=\"M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z\"></path></g></g></g></svg></mjx-container>ï¼Œåº—é“ºæ˜¯â€œæ–°å°šç¾å®¶å±…â€ã€‚</p>\n<p>æ³¨æ„åˆ°æ‰‹éœ€è¦è‡ªå·±æ‹§èºä¸å›ºå®šæ¡Œè…¿å’Œæ¡Œæ¿ï¼ˆç”¨ç”µåŠ¨èºä¸åˆ€ï¼‰ä»¥åŠæ¡Œè…¿å’Œæ¡Œè…¿ä¹‹é—´çš„è¿æ¥ï¼ˆæ‰‹æ‹§å³å¯ï¼‰ã€‚</p>\n<p>ä»¥ä¸‹æ˜¯å®æ‹å›¾ hhã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/IMG_1396.JPG\" alt=\"æ–°ä¹¦æ¡Œå®æ‹å›¾\"></p>"},{"title":"æ–°å¹´å¿«ä¹ï¼","copyright":true,"mathjax":false,"date":"2023-01-22T01:55:21.000Z","toc":null,"urlname":"2023-happy-spring-festival","_content":"\nä»Šå¹´æ˜¯å¤§å¹´åˆä¸€ï¼Œè¿‡æ–°å¹´ã€‚ç¥æ„¿æˆ‘å’Œå„ä½è¯»è€…ä»¬æ–°å¹´å¿«ä¹ï¼Œäº‹äº‹å¦‚æ„ï¼Œæ—¥è¿›æ–—é‡‘ï¼Œè´¢è¿äº¨é€šï¼Œå…”å¹´å¤§å‰ğŸ‰\n","source":"_posts/æ–°å¹´å¿«ä¹ï¼.md","raw":"---\ntitle: æ–°å¹´å¿«ä¹ï¼\ncopyright: true\nmathjax: false\ncategories:\n  - æ—¥å¸¸å°è®°\ndate: 2023-01-22 09:55:21\ntags: \ntoc: \nurlname: 2023-happy-spring-festival\n---\n\nä»Šå¹´æ˜¯å¤§å¹´åˆä¸€ï¼Œè¿‡æ–°å¹´ã€‚ç¥æ„¿æˆ‘å’Œå„ä½è¯»è€…ä»¬æ–°å¹´å¿«ä¹ï¼Œäº‹äº‹å¦‚æ„ï¼Œæ—¥è¿›æ–—é‡‘ï¼Œè´¢è¿äº¨é€šï¼Œå…”å¹´å¤§å‰ğŸ‰\n","slug":"æ–°å¹´å¿«ä¹ï¼","published":1,"updated":"2023-01-26T12:07:10.270Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cldzfw32a001at9t88remake6","content":"<p>ä»Šå¹´æ˜¯å¤§å¹´åˆä¸€ï¼Œè¿‡æ–°å¹´ã€‚ç¥æ„¿æˆ‘å’Œå„ä½è¯»è€…ä»¬æ–°å¹´å¿«ä¹ï¼Œäº‹äº‹å¦‚æ„ï¼Œæ—¥è¿›æ–—é‡‘ï¼Œè´¢è¿äº¨é€šï¼Œå…”å¹´å¤§å‰ğŸ‰</p>\n","site":{"data":{}},"length":47,"excerpt":"","more":"<p>ä»Šå¹´æ˜¯å¤§å¹´åˆä¸€ï¼Œè¿‡æ–°å¹´ã€‚ç¥æ„¿æˆ‘å’Œå„ä½è¯»è€…ä»¬æ–°å¹´å¿«ä¹ï¼Œäº‹äº‹å¦‚æ„ï¼Œæ—¥è¿›æ–—é‡‘ï¼Œè´¢è¿äº¨é€šï¼Œå…”å¹´å¤§å‰ğŸ‰</p>\n"},{"title":"æœ€è¿‘å…³äºæ ¡æ‹›ã€äº’è”ç½‘çš„ä¸€äº›ä¿¡æ¯","copyright":true,"mathjax":true,"date":"2023-01-13T04:56:40.000Z","urlname":"202301-it-info","_content":"\næœ€è¿‘åˆ·è„‰è„‰ã€çŸ¥ä¹ç­‰è®°å½•ä¸‹ä¸€äº›ç½‘å‹å‘å¸ƒçš„ä¸€äº›ä¿¡æ¯ï¼Œä»…ä½œè®°å½•ï¼Œä¸å¯¹å…¶çœŸå®æ€§ç­‰ä½œæ·±ç©¶ï¼Œä¾µåˆ ã€‚\n\n<!--more-->\n\n1ã€å­—èŠ‚é£ä¹¦ EAï¼Œbase æ­å·çš„å¾ˆå¤š 22 å±Šæ ¡æ‹›ç”Ÿæ²¡è¿‡è¯•ç”¨æœŸã€‚\n\n2ã€æŠ–éŸ³ä¸Šä¸€å•†å®¶ C++åŸºç¡€è¯¾ç¨‹å– 2999 ä¸€ä»½ï¼Œé”€é‡ 1700+ã€‚\n\n3ã€é“¶è¡Œç±»å¼€å‘å²—ï¼Œä»ä½“é‡ã€å‘å±•ã€åˆ¶åº¦ç­‰æ–¹é¢è€ƒè™‘ï¼Œå»ºè®®å»å›½æœ‰å¤§å‹é“¶è¡Œï¼Œä»¥åŠå¤´éƒ¨çš„è‚¡ä»½åˆ¶é“¶è¡Œã€‚\n\n4ã€è‹¥æ˜¯å»å¤§åŸå¸‚å½“ç¨‹åºå‘˜ï¼Œä»¥åå¯èƒ½ä¼šæƒ³è±¡åœ¨è€å®¶å½“è€å¸ˆå¤šèˆ’æœå‘€ï¼›è‹¥æ˜¯å›å®¶å½“è€å¸ˆï¼Œæˆ–è®¸ä¸€è¾ˆå­éƒ½ä¼šåæ‚”ä¸ºä»€ä¹ˆå¹´è½»çš„æ—¶å€™ä¸å»å¤§åŸå¸‚é—¯ä¸€é—¯ï¼Œè¿™å°±æ˜¯äººç”Ÿã€‚å¸Œæœ›è‹¥å¹²å¹´åï¼Œéƒ½èƒ½å’Œè‡ªå·±å’Œè§£ï¼Œè¿™è¾ˆå­è¿‡çš„è¿˜ä¸é”™ã€‚\n\n5ã€ä»¥å‰è¿›å¤§ä¸“æŠ€æ ¡ä¸­å°å­¦ç­‰å½“è€å¸ˆé—¨æ§›å¾ˆä½ï¼Œç°åœ¨è¶Šæ¥è¶Šé«˜ï¼Œè¶Šæ¥è¶Šå·ã€‚\n\n6ã€ä¸çƒ­çˆ±ç¼–ç¨‹ï¼Œæ²¡è‡ªä¿¡æˆä¸ºè¡Œä¸šç²¾è‹±ï¼Œä¸å–œæ¬¢åŠ ç­ï¼Œä¸æ¨èæˆä¸ºç¨‹åºå‘˜ã€‚\n\n7ã€è¿™æ˜¯ä¸€ä½å­—èŠ‚æˆ˜ç•¥ç¦»èŒçš„è€å“¥/è€å§å¯¹é£ä¹¦çš„çœ‹æ³•ï¼šä¸ªäººä¸çœ‹å¥½ã€‚æ¬§ç¾çš„ä¼ä¸š saas èƒ½åšèµ·æ¥æœ‰ä¸¤ä¸ªå‰æï¼šä¸€æ˜¯æ¬§ç¾æœ‰å¾ˆæˆç†Ÿçš„èŒä¸šç»ç†äººä½“ç³»ï¼ŒèŒä¸šç»ç†äººæ¥åšé‡‡è´­å†³ç­–ï¼Œè€Œä¸­å›½å¤§éƒ¨åˆ†å…¬å¸æ˜¯ä¸è¿½æ±‚æ•ˆç‡çš„å›½ä¼æˆ–è€…æŠ é—¨åˆ›å§‹äººæä¸€è¨€å ‚çš„ç§ä¼ï¼›äºŒæ˜¯ä¼ä¸š saas çš„æœ¬è´¨æ˜¯æå‡å‘˜å·¥å·¥ä½œæ•ˆç‡ï¼Œä»è€Œå®ç°å‡å°‘å‘˜å·¥æ•°é‡ï¼Œé™ä½äººåŠ›æˆæœ¬ï¼Œç¾å›½äººå¹³å‡å·¥èµ„æ˜¯ 5-7 ä¸‡ç¾å…ƒï¼Œçœä¸€ä¸ªäººå°±æ˜¯å¤§é‡çš„æˆæœ¬ï¼Œä¸­å›½äººåŠ›æˆæœ¬è¿™ä¹ˆä½ï¼Œä¸ºä»€ä¹ˆä¼šæ„¿æ„å‘é£ä¹¦è¿™æ ·çš„ä¼ä¸š saas ä»˜è´¹å‘¢ï¼Ÿ\n\n8ã€ä¸Šæµ·é“¶è¡Œå¼€å‘å²—ä»Šå¹´é™è–ªï¼Œ22 å¹´åŠä»¥å‰å¾ˆé¦™çš„ä¸Šé“¶ï¼Œä»Šå¹´é£è¯„é€æ¸å˜å·®ã€‚\n\n9ã€è„‰è„‰æŠ•ç¥¨æ˜¾ç¤ºå››å¤§è¡Œç ”å‘ä¸­å¿ƒå½“ä¸€è¾ˆå­ç¨‹åºå‘˜çš„èŒä¸šç”Ÿæ¶¯å¼€å±€æ¯”å»å¤§å‚åº”å±Šè¯•ç”¨æœŸè¢«è£ä¸‹å®¶ä¸ç¡®å®šæ›´å¥½ã€‚\n\n10ã€èŒåœº puaï¼šè¿™ä¸ªéœ€æ±‚äº¤ç»™ä½ åšæ˜¯ä¸ºäº†åŸ¹å…»ä½ ï¼Œä½ è¦å¼€å‘ä¸‰å¤©ï¼Œæˆ‘äº¤ç»™è€å‘˜å·¥åªè¦ä¸€å¤©ï¼›ä½ èƒ½åŠ›ä¸è¡Œï¼Œä¸åƒåˆ«çš„å‘˜å·¥ï¼Œä½ ç¦»å¼€è¿™ä¸ªå¹³å°å¯¸æ­¥éš¾è¡Œï¼Œè¦çæƒœå­¦ä¹ çš„æœºä¼šã€‚\n\n11ã€æŸé“¶è¡Œï¼šä¸€ä¸ªå†…éƒ¨å‡ åä¸ªäººç”¨çš„å•ä½“ç³»ç»Ÿï¼Œè¿˜è¦æ devopsã€‚åƒä½™äººï¼Œå¤§éƒ¨åˆ†è¿˜æ˜¯åƒµå°¸ç”¨æˆ·çš„ç³»ç»Ÿé€¼ç€ä½ åšç†”æ–­é™æµã€‚\n\n12ã€å†œè¡Œçš„ä¸€äº›ç ”å‘ä¸­å¿ƒé£è¯„è¾ƒå·®ï¼Œå˜æ›´é—®é¢˜ã€å…è´¹åŠ ç­ã€å‰Šå‡ç¦åˆ©ã€å˜ç›¸é™è–ªã€æ™‹å‡å›°éš¾ã€å‡ºå¸‚å®¡æ‰¹ã€å„ç§è€ƒæ ¸ï¼Œè¦ä»”ç»†ç”„åˆ«ã€‚\n\n13ã€äº’è”ç½‘ä¼ä¸šçš„å·å·²ç»æ˜¯å…±è¯†äº†ï¼Œåœ¨ç»æµç¯å¢ƒä¸å¥½çš„å¤§åŠ¿ä¸‹ï¼Œä»ç„¶æœ‰æºæºä¸æ–­çš„å¹´è½»å°ä¼™ä¼´å‡å¦‚åˆ°å·åŠ¨å¤§æ½®ã€‚è¿™ä¸ªå·èƒ½ä¸èƒ½é¿å…ï¼Ÿæˆ‘ä»¥å‰è®¤ä¸ºä¸èƒ½ï¼Œå› ä¸ºä¸šåŠ¡å‘å±•é€Ÿåº¦å¤ªå¿«ï¼Œå˜åŒ–å¤ªå¤§ï¼Œå¾ˆéš¾é¿å…åŠ ç­åŠ ç‚¹çš„å·ã€‚äº‹å®ä¸Šè·³å‡ºæ¥çœ‹çœ‹ï¼Œè‡³å°‘æœ‰ä¸€åŠä»¥ä¸Šçš„å·éƒ½æ˜¯å› ä¸ºç®¡ç†è€…æ— çŸ¥ï¼Œæ²¡æœ‰æ€è·¯ï¼Œä¸ç»™å›¢é˜ŸæŒ‡å¯¼å’Œæ–¹å‘å¯¼è‡´çš„â€œæ‰¯æ·¡å·â€ã€‚ä¹Ÿè®¸å¹´è½»é²œæ´»çš„ç”Ÿå‘½ä¸å·ç™½ä¸å·ï¼Œæ‰€è°“å°‘å¹´å¾—å¿—çš„ç®¡ç†è€…è‡ªå·±ä¹Ÿæ˜¯è¿™ä¹ˆè¢«å·è‡³ä»Šã€‚ä¼ä¸šæˆé•¿çš„ä»£ä»·ï¼Œæœ€åä¸€åŠè¢«æŠ•èµ„äººä¹°å•ï¼Œä¸€åŠè¢«å‘˜å·¥ä¹°å•ï¼Œå¦‚æœèŠ±äº†ä»£ä»·èƒ½ä¹°æ¥æˆé•¿ï¼Œä¹Ÿç®—å€¼å¾—ï¼Œå¯æ‚²çš„æ˜¯ï¼Œå¤šåŠä¹°ä¸æ¥æˆé•¿ï¼Œä¹°æ¥çš„æ˜¯å¤±è´¥åçš„æ•™è®­ã€‚\n\n14ã€å›½å®¶å·²ç»æ‹‰å“äº†ä½ç”Ÿè‚²è­¦æŠ¥ï¼Œä½ å¯¹æé«˜å¹´è½»äººç”Ÿè‚²æœ‰ä»€ä¹ˆå»ºè®®ï¼Ÿ - [å®‡å®™åŒºé•¿å­™è¿åŸçš„å›ç­”](https://www.zhihu.com/question/576438196/answer/2830715899)\n\n15ã€å­—èŠ‚æ­å·æœ‰éƒ¨é—¨å…¨æ’¤è½¬ base äº†ï¼Œè™½ç„¶äººä¸å¤šã€‚\n\n16ã€é‚®å‚¨ç ”å‘ä¸­å¿ƒæ€»åŒ…èƒ½åˆ° 30+wï¼Œå¾ˆé¦™ï¼Œä½†æ˜¯è²Œä¼¼è¦ 996ï¼Œä¸ªäººæ„Ÿè§‰è¿˜æ˜¯æ¯”è¾ƒé¦™ã€‚\n\n17ã€å­—èŠ‚æ•™è‚²å‰©ä¸‹çš„äººä¸ç”¨èƒŒæŒ‡æ ‡ï¼Œä¸ç”¨æ‰¿æ‹…é›†å›¢çš„é«˜é¢„æœŸï¼Œåªéœ€æ¢ç´¢æ–°æ–¹å‘å’Œæ‰“ç£¨æ–°äº§å“ï¼Œè€Œä¸”é›†å›¢æ¯ä¸ªæœˆå›ºå®šæ‹¨é’±å…»ä¸šåŠ¡ï¼Œä½•å°ä¸æ˜¯ä¸€ç§å¹¸ç¦å‘¢ï¼Ÿ\n\n18ã€å‰å‡ å¹´å½“è€å¸ˆé—¨æ§›å¾ˆä½ï¼Œå¦‚æœä»¥å½“åˆçš„æ¡ä»¶ï¼Œç°åœ¨å»åº”è˜ï¼Œæ ¹æœ¬è¿›ä¸å»ã€‚\n\n19ã€â€œå›´åŸâ€è¿™ä¸ªè¯ä¸€å®šèƒ½åœ¨ä»Šå¹´ç§‹æ‹›å æ®ä¸€å¸­ä¹‹åœ°ã€‚å¤§åŸå°åŸï¼Œå›½ä¼å¤®ä¼ç§ä¼å¤–ä¼ä½“åˆ¶ï¼Œé“¶è¡Œåˆ¸å•†äº’è”ç½‘åˆ¶é€ ä¸šå†›å·¥ç ”ç©¶æ‰€ã€‚ç©¶ç«Ÿæ˜¯é€‰ä¸ªèƒ½å®‰å®¶çš„å°åŸè¿˜æ˜¯å°½æƒ…äº«å—å¤§åŸå¸‚çš„å¹´è½»ä¸è‡ªç”±ï¼Ÿæ˜¯é€‰æ‹©ä¸€æ­¥åˆ°ä½è¿˜æ˜¯å°†æ‚¬å¿µç•™ä¸ªæœªæ¥ï¼Ÿæ˜¯æŒ¤å‡ºæ—¶é—´æ¥å·¥ä½œè¿˜æ˜¯é€‰æ‹©å·¥ä½œå¤–çš„ç”Ÿæ´»ï¼Ÿæ˜¯åšå®šèµ°è‡ªå·±çš„ä¸“ä¸šè¿˜æ˜¯å¦è¾Ÿè¹Šå¾„ï¼Ÿæ˜¯é€‰æ‹©ä¸€çœ¼çœ‹åˆ°å¤´çš„å®‰å¿ƒè¿˜æ˜¯æœªçŸ¥ä¼´éšçš„é£é™©ä¸æœºé‡ï¼Ÿæœ€åï¼Œå¸Œæœ›å„ä½éƒ½èƒ½æœ‰æ»¡æ„çš„é€‰æ‹©ã€‚æˆ‘ä»¬å·²æ˜¯å½“ä»£é’å¹´ï¼Œæˆ‘ä»¬çš„é€‰æ‹©ä¾¿æ˜¯æ–°ä¸€ä»£é’å¹´çš„é€‰æ‹©ã€‚ä¸è¯¸ä½å…±å‹‰ã€‚\n\n20ã€ä»åŒ—å¤§æ¥è¯»ä¹¦çš„ï¼Œæœ€è¿‘çœ‹å·¥ä½œï¼Œè¶Šæ¥è¶Šè§‰å¾—ï¼Œåœ¨åŒ—äº¬æŒ£ä¸‰åå’ŒæŒ£äº”åæ²¡æœ‰å¤ªå¤§åŒºåˆ«ï¼Œåšäº’è”ç½‘å’Œåšå…¶ä»–è¡Œä¸šä¹Ÿæ²¡æœ‰å¤ªå¤§åŒºåˆ«ï¼Œå¯è§çš„æœªæ¥çš„å·¥ä½œåªæ˜¯ä½œä¸ºç³Šå£çš„å·¥å…·ï¼Œå¾ˆéš¾æœ‰ä»€ä¹ˆçƒ­çˆ±å¯è¨€ã€‚è¶Šæ¥è¶Šæƒ³å›å®¶ä¹¡æ‰¾ä¸ªä½“åˆ¶å†…çš„ç¨³å®šå·¥ä½œäº†ï¼ŒæŠŠæ›´å¤šçš„æ—¶é—´ç”¨åœ¨ç”Ÿæ´»ä¸Šé¢ã€‚æ˜¯æˆ‘å¤ªèººäº†å—ï¼Ÿè¿˜æ˜¯æˆ‘æ ¼å±€ä¸å¤Ÿï¼Ÿ\n","source":"_posts/æœ€è¿‘å…³äºæ ¡æ‹›ã€äº’è”ç½‘çš„ä¸€äº›ä¿¡æ¯.md","raw":"---\ntitle: æœ€è¿‘å…³äºæ ¡æ‹›ã€äº’è”ç½‘çš„ä¸€äº›ä¿¡æ¯\ncopyright: true\nmathjax: true\ncategories: æ—¥å¸¸å°è®°\ntags: \ndate: 2023-01-13 12:56:40\nurlname: 202301-it-info\n---\n\næœ€è¿‘åˆ·è„‰è„‰ã€çŸ¥ä¹ç­‰è®°å½•ä¸‹ä¸€äº›ç½‘å‹å‘å¸ƒçš„ä¸€äº›ä¿¡æ¯ï¼Œä»…ä½œè®°å½•ï¼Œä¸å¯¹å…¶çœŸå®æ€§ç­‰ä½œæ·±ç©¶ï¼Œä¾µåˆ ã€‚\n\n<!--more-->\n\n1ã€å­—èŠ‚é£ä¹¦ EAï¼Œbase æ­å·çš„å¾ˆå¤š 22 å±Šæ ¡æ‹›ç”Ÿæ²¡è¿‡è¯•ç”¨æœŸã€‚\n\n2ã€æŠ–éŸ³ä¸Šä¸€å•†å®¶ C++åŸºç¡€è¯¾ç¨‹å– 2999 ä¸€ä»½ï¼Œé”€é‡ 1700+ã€‚\n\n3ã€é“¶è¡Œç±»å¼€å‘å²—ï¼Œä»ä½“é‡ã€å‘å±•ã€åˆ¶åº¦ç­‰æ–¹é¢è€ƒè™‘ï¼Œå»ºè®®å»å›½æœ‰å¤§å‹é“¶è¡Œï¼Œä»¥åŠå¤´éƒ¨çš„è‚¡ä»½åˆ¶é“¶è¡Œã€‚\n\n4ã€è‹¥æ˜¯å»å¤§åŸå¸‚å½“ç¨‹åºå‘˜ï¼Œä»¥åå¯èƒ½ä¼šæƒ³è±¡åœ¨è€å®¶å½“è€å¸ˆå¤šèˆ’æœå‘€ï¼›è‹¥æ˜¯å›å®¶å½“è€å¸ˆï¼Œæˆ–è®¸ä¸€è¾ˆå­éƒ½ä¼šåæ‚”ä¸ºä»€ä¹ˆå¹´è½»çš„æ—¶å€™ä¸å»å¤§åŸå¸‚é—¯ä¸€é—¯ï¼Œè¿™å°±æ˜¯äººç”Ÿã€‚å¸Œæœ›è‹¥å¹²å¹´åï¼Œéƒ½èƒ½å’Œè‡ªå·±å’Œè§£ï¼Œè¿™è¾ˆå­è¿‡çš„è¿˜ä¸é”™ã€‚\n\n5ã€ä»¥å‰è¿›å¤§ä¸“æŠ€æ ¡ä¸­å°å­¦ç­‰å½“è€å¸ˆé—¨æ§›å¾ˆä½ï¼Œç°åœ¨è¶Šæ¥è¶Šé«˜ï¼Œè¶Šæ¥è¶Šå·ã€‚\n\n6ã€ä¸çƒ­çˆ±ç¼–ç¨‹ï¼Œæ²¡è‡ªä¿¡æˆä¸ºè¡Œä¸šç²¾è‹±ï¼Œä¸å–œæ¬¢åŠ ç­ï¼Œä¸æ¨èæˆä¸ºç¨‹åºå‘˜ã€‚\n\n7ã€è¿™æ˜¯ä¸€ä½å­—èŠ‚æˆ˜ç•¥ç¦»èŒçš„è€å“¥/è€å§å¯¹é£ä¹¦çš„çœ‹æ³•ï¼šä¸ªäººä¸çœ‹å¥½ã€‚æ¬§ç¾çš„ä¼ä¸š saas èƒ½åšèµ·æ¥æœ‰ä¸¤ä¸ªå‰æï¼šä¸€æ˜¯æ¬§ç¾æœ‰å¾ˆæˆç†Ÿçš„èŒä¸šç»ç†äººä½“ç³»ï¼ŒèŒä¸šç»ç†äººæ¥åšé‡‡è´­å†³ç­–ï¼Œè€Œä¸­å›½å¤§éƒ¨åˆ†å…¬å¸æ˜¯ä¸è¿½æ±‚æ•ˆç‡çš„å›½ä¼æˆ–è€…æŠ é—¨åˆ›å§‹äººæä¸€è¨€å ‚çš„ç§ä¼ï¼›äºŒæ˜¯ä¼ä¸š saas çš„æœ¬è´¨æ˜¯æå‡å‘˜å·¥å·¥ä½œæ•ˆç‡ï¼Œä»è€Œå®ç°å‡å°‘å‘˜å·¥æ•°é‡ï¼Œé™ä½äººåŠ›æˆæœ¬ï¼Œç¾å›½äººå¹³å‡å·¥èµ„æ˜¯ 5-7 ä¸‡ç¾å…ƒï¼Œçœä¸€ä¸ªäººå°±æ˜¯å¤§é‡çš„æˆæœ¬ï¼Œä¸­å›½äººåŠ›æˆæœ¬è¿™ä¹ˆä½ï¼Œä¸ºä»€ä¹ˆä¼šæ„¿æ„å‘é£ä¹¦è¿™æ ·çš„ä¼ä¸š saas ä»˜è´¹å‘¢ï¼Ÿ\n\n8ã€ä¸Šæµ·é“¶è¡Œå¼€å‘å²—ä»Šå¹´é™è–ªï¼Œ22 å¹´åŠä»¥å‰å¾ˆé¦™çš„ä¸Šé“¶ï¼Œä»Šå¹´é£è¯„é€æ¸å˜å·®ã€‚\n\n9ã€è„‰è„‰æŠ•ç¥¨æ˜¾ç¤ºå››å¤§è¡Œç ”å‘ä¸­å¿ƒå½“ä¸€è¾ˆå­ç¨‹åºå‘˜çš„èŒä¸šç”Ÿæ¶¯å¼€å±€æ¯”å»å¤§å‚åº”å±Šè¯•ç”¨æœŸè¢«è£ä¸‹å®¶ä¸ç¡®å®šæ›´å¥½ã€‚\n\n10ã€èŒåœº puaï¼šè¿™ä¸ªéœ€æ±‚äº¤ç»™ä½ åšæ˜¯ä¸ºäº†åŸ¹å…»ä½ ï¼Œä½ è¦å¼€å‘ä¸‰å¤©ï¼Œæˆ‘äº¤ç»™è€å‘˜å·¥åªè¦ä¸€å¤©ï¼›ä½ èƒ½åŠ›ä¸è¡Œï¼Œä¸åƒåˆ«çš„å‘˜å·¥ï¼Œä½ ç¦»å¼€è¿™ä¸ªå¹³å°å¯¸æ­¥éš¾è¡Œï¼Œè¦çæƒœå­¦ä¹ çš„æœºä¼šã€‚\n\n11ã€æŸé“¶è¡Œï¼šä¸€ä¸ªå†…éƒ¨å‡ åä¸ªäººç”¨çš„å•ä½“ç³»ç»Ÿï¼Œè¿˜è¦æ devopsã€‚åƒä½™äººï¼Œå¤§éƒ¨åˆ†è¿˜æ˜¯åƒµå°¸ç”¨æˆ·çš„ç³»ç»Ÿé€¼ç€ä½ åšç†”æ–­é™æµã€‚\n\n12ã€å†œè¡Œçš„ä¸€äº›ç ”å‘ä¸­å¿ƒé£è¯„è¾ƒå·®ï¼Œå˜æ›´é—®é¢˜ã€å…è´¹åŠ ç­ã€å‰Šå‡ç¦åˆ©ã€å˜ç›¸é™è–ªã€æ™‹å‡å›°éš¾ã€å‡ºå¸‚å®¡æ‰¹ã€å„ç§è€ƒæ ¸ï¼Œè¦ä»”ç»†ç”„åˆ«ã€‚\n\n13ã€äº’è”ç½‘ä¼ä¸šçš„å·å·²ç»æ˜¯å…±è¯†äº†ï¼Œåœ¨ç»æµç¯å¢ƒä¸å¥½çš„å¤§åŠ¿ä¸‹ï¼Œä»ç„¶æœ‰æºæºä¸æ–­çš„å¹´è½»å°ä¼™ä¼´å‡å¦‚åˆ°å·åŠ¨å¤§æ½®ã€‚è¿™ä¸ªå·èƒ½ä¸èƒ½é¿å…ï¼Ÿæˆ‘ä»¥å‰è®¤ä¸ºä¸èƒ½ï¼Œå› ä¸ºä¸šåŠ¡å‘å±•é€Ÿåº¦å¤ªå¿«ï¼Œå˜åŒ–å¤ªå¤§ï¼Œå¾ˆéš¾é¿å…åŠ ç­åŠ ç‚¹çš„å·ã€‚äº‹å®ä¸Šè·³å‡ºæ¥çœ‹çœ‹ï¼Œè‡³å°‘æœ‰ä¸€åŠä»¥ä¸Šçš„å·éƒ½æ˜¯å› ä¸ºç®¡ç†è€…æ— çŸ¥ï¼Œæ²¡æœ‰æ€è·¯ï¼Œä¸ç»™å›¢é˜ŸæŒ‡å¯¼å’Œæ–¹å‘å¯¼è‡´çš„â€œæ‰¯æ·¡å·â€ã€‚ä¹Ÿè®¸å¹´è½»é²œæ´»çš„ç”Ÿå‘½ä¸å·ç™½ä¸å·ï¼Œæ‰€è°“å°‘å¹´å¾—å¿—çš„ç®¡ç†è€…è‡ªå·±ä¹Ÿæ˜¯è¿™ä¹ˆè¢«å·è‡³ä»Šã€‚ä¼ä¸šæˆé•¿çš„ä»£ä»·ï¼Œæœ€åä¸€åŠè¢«æŠ•èµ„äººä¹°å•ï¼Œä¸€åŠè¢«å‘˜å·¥ä¹°å•ï¼Œå¦‚æœèŠ±äº†ä»£ä»·èƒ½ä¹°æ¥æˆé•¿ï¼Œä¹Ÿç®—å€¼å¾—ï¼Œå¯æ‚²çš„æ˜¯ï¼Œå¤šåŠä¹°ä¸æ¥æˆé•¿ï¼Œä¹°æ¥çš„æ˜¯å¤±è´¥åçš„æ•™è®­ã€‚\n\n14ã€å›½å®¶å·²ç»æ‹‰å“äº†ä½ç”Ÿè‚²è­¦æŠ¥ï¼Œä½ å¯¹æé«˜å¹´è½»äººç”Ÿè‚²æœ‰ä»€ä¹ˆå»ºè®®ï¼Ÿ - [å®‡å®™åŒºé•¿å­™è¿åŸçš„å›ç­”](https://www.zhihu.com/question/576438196/answer/2830715899)\n\n15ã€å­—èŠ‚æ­å·æœ‰éƒ¨é—¨å…¨æ’¤è½¬ base äº†ï¼Œè™½ç„¶äººä¸å¤šã€‚\n\n16ã€é‚®å‚¨ç ”å‘ä¸­å¿ƒæ€»åŒ…èƒ½åˆ° 30+wï¼Œå¾ˆé¦™ï¼Œä½†æ˜¯è²Œä¼¼è¦ 996ï¼Œä¸ªäººæ„Ÿè§‰è¿˜æ˜¯æ¯”è¾ƒé¦™ã€‚\n\n17ã€å­—èŠ‚æ•™è‚²å‰©ä¸‹çš„äººä¸ç”¨èƒŒæŒ‡æ ‡ï¼Œä¸ç”¨æ‰¿æ‹…é›†å›¢çš„é«˜é¢„æœŸï¼Œåªéœ€æ¢ç´¢æ–°æ–¹å‘å’Œæ‰“ç£¨æ–°äº§å“ï¼Œè€Œä¸”é›†å›¢æ¯ä¸ªæœˆå›ºå®šæ‹¨é’±å…»ä¸šåŠ¡ï¼Œä½•å°ä¸æ˜¯ä¸€ç§å¹¸ç¦å‘¢ï¼Ÿ\n\n18ã€å‰å‡ å¹´å½“è€å¸ˆé—¨æ§›å¾ˆä½ï¼Œå¦‚æœä»¥å½“åˆçš„æ¡ä»¶ï¼Œç°åœ¨å»åº”è˜ï¼Œæ ¹æœ¬è¿›ä¸å»ã€‚\n\n19ã€â€œå›´åŸâ€è¿™ä¸ªè¯ä¸€å®šèƒ½åœ¨ä»Šå¹´ç§‹æ‹›å æ®ä¸€å¸­ä¹‹åœ°ã€‚å¤§åŸå°åŸï¼Œå›½ä¼å¤®ä¼ç§ä¼å¤–ä¼ä½“åˆ¶ï¼Œé“¶è¡Œåˆ¸å•†äº’è”ç½‘åˆ¶é€ ä¸šå†›å·¥ç ”ç©¶æ‰€ã€‚ç©¶ç«Ÿæ˜¯é€‰ä¸ªèƒ½å®‰å®¶çš„å°åŸè¿˜æ˜¯å°½æƒ…äº«å—å¤§åŸå¸‚çš„å¹´è½»ä¸è‡ªç”±ï¼Ÿæ˜¯é€‰æ‹©ä¸€æ­¥åˆ°ä½è¿˜æ˜¯å°†æ‚¬å¿µç•™ä¸ªæœªæ¥ï¼Ÿæ˜¯æŒ¤å‡ºæ—¶é—´æ¥å·¥ä½œè¿˜æ˜¯é€‰æ‹©å·¥ä½œå¤–çš„ç”Ÿæ´»ï¼Ÿæ˜¯åšå®šèµ°è‡ªå·±çš„ä¸“ä¸šè¿˜æ˜¯å¦è¾Ÿè¹Šå¾„ï¼Ÿæ˜¯é€‰æ‹©ä¸€çœ¼çœ‹åˆ°å¤´çš„å®‰å¿ƒè¿˜æ˜¯æœªçŸ¥ä¼´éšçš„é£é™©ä¸æœºé‡ï¼Ÿæœ€åï¼Œå¸Œæœ›å„ä½éƒ½èƒ½æœ‰æ»¡æ„çš„é€‰æ‹©ã€‚æˆ‘ä»¬å·²æ˜¯å½“ä»£é’å¹´ï¼Œæˆ‘ä»¬çš„é€‰æ‹©ä¾¿æ˜¯æ–°ä¸€ä»£é’å¹´çš„é€‰æ‹©ã€‚ä¸è¯¸ä½å…±å‹‰ã€‚\n\n20ã€ä»åŒ—å¤§æ¥è¯»ä¹¦çš„ï¼Œæœ€è¿‘çœ‹å·¥ä½œï¼Œè¶Šæ¥è¶Šè§‰å¾—ï¼Œåœ¨åŒ—äº¬æŒ£ä¸‰åå’ŒæŒ£äº”åæ²¡æœ‰å¤ªå¤§åŒºåˆ«ï¼Œåšäº’è”ç½‘å’Œåšå…¶ä»–è¡Œä¸šä¹Ÿæ²¡æœ‰å¤ªå¤§åŒºåˆ«ï¼Œå¯è§çš„æœªæ¥çš„å·¥ä½œåªæ˜¯ä½œä¸ºç³Šå£çš„å·¥å…·ï¼Œå¾ˆéš¾æœ‰ä»€ä¹ˆçƒ­çˆ±å¯è¨€ã€‚è¶Šæ¥è¶Šæƒ³å›å®¶ä¹¡æ‰¾ä¸ªä½“åˆ¶å†…çš„ç¨³å®šå·¥ä½œäº†ï¼ŒæŠŠæ›´å¤šçš„æ—¶é—´ç”¨åœ¨ç”Ÿæ´»ä¸Šé¢ã€‚æ˜¯æˆ‘å¤ªèººäº†å—ï¼Ÿè¿˜æ˜¯æˆ‘æ ¼å±€ä¸å¤Ÿï¼Ÿ\n","slug":"æœ€è¿‘å…³äºæ ¡æ‹›ã€äº’è”ç½‘çš„ä¸€äº›ä¿¡æ¯","published":1,"updated":"2023-01-26T12:35:58.983Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cldzfw32b001ct9t88yodawq8","content":"<p>æœ€è¿‘åˆ·è„‰è„‰ã€çŸ¥ä¹ç­‰è®°å½•ä¸‹ä¸€äº›ç½‘å‹å‘å¸ƒçš„ä¸€äº›ä¿¡æ¯ï¼Œä»…ä½œè®°å½•ï¼Œä¸å¯¹å…¶çœŸå®æ€§ç­‰ä½œæ·±ç©¶ï¼Œä¾µåˆ ã€‚</p>\n<span id=\"more\"></span>\n\n<p>1ã€å­—èŠ‚é£ä¹¦ EAï¼Œbase æ­å·çš„å¾ˆå¤š 22 å±Šæ ¡æ‹›ç”Ÿæ²¡è¿‡è¯•ç”¨æœŸã€‚</p>\n<p>2ã€æŠ–éŸ³ä¸Šä¸€å•†å®¶ C++åŸºç¡€è¯¾ç¨‹å– 2999 ä¸€ä»½ï¼Œé”€é‡ 1700+ã€‚</p>\n<p>3ã€é“¶è¡Œç±»å¼€å‘å²—ï¼Œä»ä½“é‡ã€å‘å±•ã€åˆ¶åº¦ç­‰æ–¹é¢è€ƒè™‘ï¼Œå»ºè®®å»å›½æœ‰å¤§å‹é“¶è¡Œï¼Œä»¥åŠå¤´éƒ¨çš„è‚¡ä»½åˆ¶é“¶è¡Œã€‚</p>\n<p>4ã€è‹¥æ˜¯å»å¤§åŸå¸‚å½“ç¨‹åºå‘˜ï¼Œä»¥åå¯èƒ½ä¼šæƒ³è±¡åœ¨è€å®¶å½“è€å¸ˆå¤šèˆ’æœå‘€ï¼›è‹¥æ˜¯å›å®¶å½“è€å¸ˆï¼Œæˆ–è®¸ä¸€è¾ˆå­éƒ½ä¼šåæ‚”ä¸ºä»€ä¹ˆå¹´è½»çš„æ—¶å€™ä¸å»å¤§åŸå¸‚é—¯ä¸€é—¯ï¼Œè¿™å°±æ˜¯äººç”Ÿã€‚å¸Œæœ›è‹¥å¹²å¹´åï¼Œéƒ½èƒ½å’Œè‡ªå·±å’Œè§£ï¼Œè¿™è¾ˆå­è¿‡çš„è¿˜ä¸é”™ã€‚</p>\n<p>5ã€ä»¥å‰è¿›å¤§ä¸“æŠ€æ ¡ä¸­å°å­¦ç­‰å½“è€å¸ˆé—¨æ§›å¾ˆä½ï¼Œç°åœ¨è¶Šæ¥è¶Šé«˜ï¼Œè¶Šæ¥è¶Šå·ã€‚</p>\n<p>6ã€ä¸çƒ­çˆ±ç¼–ç¨‹ï¼Œæ²¡è‡ªä¿¡æˆä¸ºè¡Œä¸šç²¾è‹±ï¼Œä¸å–œæ¬¢åŠ ç­ï¼Œä¸æ¨èæˆä¸ºç¨‹åºå‘˜ã€‚</p>\n<p>7ã€è¿™æ˜¯ä¸€ä½å­—èŠ‚æˆ˜ç•¥ç¦»èŒçš„è€å“¥/è€å§å¯¹é£ä¹¦çš„çœ‹æ³•ï¼šä¸ªäººä¸çœ‹å¥½ã€‚æ¬§ç¾çš„ä¼ä¸š saas èƒ½åšèµ·æ¥æœ‰ä¸¤ä¸ªå‰æï¼šä¸€æ˜¯æ¬§ç¾æœ‰å¾ˆæˆç†Ÿçš„èŒä¸šç»ç†äººä½“ç³»ï¼ŒèŒä¸šç»ç†äººæ¥åšé‡‡è´­å†³ç­–ï¼Œè€Œä¸­å›½å¤§éƒ¨åˆ†å…¬å¸æ˜¯ä¸è¿½æ±‚æ•ˆç‡çš„å›½ä¼æˆ–è€…æŠ é—¨åˆ›å§‹äººæä¸€è¨€å ‚çš„ç§ä¼ï¼›äºŒæ˜¯ä¼ä¸š saas çš„æœ¬è´¨æ˜¯æå‡å‘˜å·¥å·¥ä½œæ•ˆç‡ï¼Œä»è€Œå®ç°å‡å°‘å‘˜å·¥æ•°é‡ï¼Œé™ä½äººåŠ›æˆæœ¬ï¼Œç¾å›½äººå¹³å‡å·¥èµ„æ˜¯ 5-7 ä¸‡ç¾å…ƒï¼Œçœä¸€ä¸ªäººå°±æ˜¯å¤§é‡çš„æˆæœ¬ï¼Œä¸­å›½äººåŠ›æˆæœ¬è¿™ä¹ˆä½ï¼Œä¸ºä»€ä¹ˆä¼šæ„¿æ„å‘é£ä¹¦è¿™æ ·çš„ä¼ä¸š saas ä»˜è´¹å‘¢ï¼Ÿ</p>\n<p>8ã€ä¸Šæµ·é“¶è¡Œå¼€å‘å²—ä»Šå¹´é™è–ªï¼Œ22 å¹´åŠä»¥å‰å¾ˆé¦™çš„ä¸Šé“¶ï¼Œä»Šå¹´é£è¯„é€æ¸å˜å·®ã€‚</p>\n<p>9ã€è„‰è„‰æŠ•ç¥¨æ˜¾ç¤ºå››å¤§è¡Œç ”å‘ä¸­å¿ƒå½“ä¸€è¾ˆå­ç¨‹åºå‘˜çš„èŒä¸šç”Ÿæ¶¯å¼€å±€æ¯”å»å¤§å‚åº”å±Šè¯•ç”¨æœŸè¢«è£ä¸‹å®¶ä¸ç¡®å®šæ›´å¥½ã€‚</p>\n<p>10ã€èŒåœº puaï¼šè¿™ä¸ªéœ€æ±‚äº¤ç»™ä½ åšæ˜¯ä¸ºäº†åŸ¹å…»ä½ ï¼Œä½ è¦å¼€å‘ä¸‰å¤©ï¼Œæˆ‘äº¤ç»™è€å‘˜å·¥åªè¦ä¸€å¤©ï¼›ä½ èƒ½åŠ›ä¸è¡Œï¼Œä¸åƒåˆ«çš„å‘˜å·¥ï¼Œä½ ç¦»å¼€è¿™ä¸ªå¹³å°å¯¸æ­¥éš¾è¡Œï¼Œè¦çæƒœå­¦ä¹ çš„æœºä¼šã€‚</p>\n<p>11ã€æŸé“¶è¡Œï¼šä¸€ä¸ªå†…éƒ¨å‡ åä¸ªäººç”¨çš„å•ä½“ç³»ç»Ÿï¼Œè¿˜è¦æ devopsã€‚åƒä½™äººï¼Œå¤§éƒ¨åˆ†è¿˜æ˜¯åƒµå°¸ç”¨æˆ·çš„ç³»ç»Ÿé€¼ç€ä½ åšç†”æ–­é™æµã€‚</p>\n<p>12ã€å†œè¡Œçš„ä¸€äº›ç ”å‘ä¸­å¿ƒé£è¯„è¾ƒå·®ï¼Œå˜æ›´é—®é¢˜ã€å…è´¹åŠ ç­ã€å‰Šå‡ç¦åˆ©ã€å˜ç›¸é™è–ªã€æ™‹å‡å›°éš¾ã€å‡ºå¸‚å®¡æ‰¹ã€å„ç§è€ƒæ ¸ï¼Œè¦ä»”ç»†ç”„åˆ«ã€‚</p>\n<p>13ã€äº’è”ç½‘ä¼ä¸šçš„å·å·²ç»æ˜¯å…±è¯†äº†ï¼Œåœ¨ç»æµç¯å¢ƒä¸å¥½çš„å¤§åŠ¿ä¸‹ï¼Œä»ç„¶æœ‰æºæºä¸æ–­çš„å¹´è½»å°ä¼™ä¼´å‡å¦‚åˆ°å·åŠ¨å¤§æ½®ã€‚è¿™ä¸ªå·èƒ½ä¸èƒ½é¿å…ï¼Ÿæˆ‘ä»¥å‰è®¤ä¸ºä¸èƒ½ï¼Œå› ä¸ºä¸šåŠ¡å‘å±•é€Ÿåº¦å¤ªå¿«ï¼Œå˜åŒ–å¤ªå¤§ï¼Œå¾ˆéš¾é¿å…åŠ ç­åŠ ç‚¹çš„å·ã€‚äº‹å®ä¸Šè·³å‡ºæ¥çœ‹çœ‹ï¼Œè‡³å°‘æœ‰ä¸€åŠä»¥ä¸Šçš„å·éƒ½æ˜¯å› ä¸ºç®¡ç†è€…æ— çŸ¥ï¼Œæ²¡æœ‰æ€è·¯ï¼Œä¸ç»™å›¢é˜ŸæŒ‡å¯¼å’Œæ–¹å‘å¯¼è‡´çš„â€œæ‰¯æ·¡å·â€ã€‚ä¹Ÿè®¸å¹´è½»é²œæ´»çš„ç”Ÿå‘½ä¸å·ç™½ä¸å·ï¼Œæ‰€è°“å°‘å¹´å¾—å¿—çš„ç®¡ç†è€…è‡ªå·±ä¹Ÿæ˜¯è¿™ä¹ˆè¢«å·è‡³ä»Šã€‚ä¼ä¸šæˆé•¿çš„ä»£ä»·ï¼Œæœ€åä¸€åŠè¢«æŠ•èµ„äººä¹°å•ï¼Œä¸€åŠè¢«å‘˜å·¥ä¹°å•ï¼Œå¦‚æœèŠ±äº†ä»£ä»·èƒ½ä¹°æ¥æˆé•¿ï¼Œä¹Ÿç®—å€¼å¾—ï¼Œå¯æ‚²çš„æ˜¯ï¼Œå¤šåŠä¹°ä¸æ¥æˆé•¿ï¼Œä¹°æ¥çš„æ˜¯å¤±è´¥åçš„æ•™è®­ã€‚</p>\n<p>14ã€å›½å®¶å·²ç»æ‹‰å“äº†ä½ç”Ÿè‚²è­¦æŠ¥ï¼Œä½ å¯¹æé«˜å¹´è½»äººç”Ÿè‚²æœ‰ä»€ä¹ˆå»ºè®®ï¼Ÿ - <a href=\"https://www.zhihu.com/question/576438196/answer/2830715899\">å®‡å®™åŒºé•¿å­™è¿åŸçš„å›ç­”</a></p>\n<p>15ã€å­—èŠ‚æ­å·æœ‰éƒ¨é—¨å…¨æ’¤è½¬ base äº†ï¼Œè™½ç„¶äººä¸å¤šã€‚</p>\n<p>16ã€é‚®å‚¨ç ”å‘ä¸­å¿ƒæ€»åŒ…èƒ½åˆ° 30+wï¼Œå¾ˆé¦™ï¼Œä½†æ˜¯è²Œä¼¼è¦ 996ï¼Œä¸ªäººæ„Ÿè§‰è¿˜æ˜¯æ¯”è¾ƒé¦™ã€‚</p>\n<p>17ã€å­—èŠ‚æ•™è‚²å‰©ä¸‹çš„äººä¸ç”¨èƒŒæŒ‡æ ‡ï¼Œä¸ç”¨æ‰¿æ‹…é›†å›¢çš„é«˜é¢„æœŸï¼Œåªéœ€æ¢ç´¢æ–°æ–¹å‘å’Œæ‰“ç£¨æ–°äº§å“ï¼Œè€Œä¸”é›†å›¢æ¯ä¸ªæœˆå›ºå®šæ‹¨é’±å…»ä¸šåŠ¡ï¼Œä½•å°ä¸æ˜¯ä¸€ç§å¹¸ç¦å‘¢ï¼Ÿ</p>\n<p>18ã€å‰å‡ å¹´å½“è€å¸ˆé—¨æ§›å¾ˆä½ï¼Œå¦‚æœä»¥å½“åˆçš„æ¡ä»¶ï¼Œç°åœ¨å»åº”è˜ï¼Œæ ¹æœ¬è¿›ä¸å»ã€‚</p>\n<p>19ã€â€œå›´åŸâ€è¿™ä¸ªè¯ä¸€å®šèƒ½åœ¨ä»Šå¹´ç§‹æ‹›å æ®ä¸€å¸­ä¹‹åœ°ã€‚å¤§åŸå°åŸï¼Œå›½ä¼å¤®ä¼ç§ä¼å¤–ä¼ä½“åˆ¶ï¼Œé“¶è¡Œåˆ¸å•†äº’è”ç½‘åˆ¶é€ ä¸šå†›å·¥ç ”ç©¶æ‰€ã€‚ç©¶ç«Ÿæ˜¯é€‰ä¸ªèƒ½å®‰å®¶çš„å°åŸè¿˜æ˜¯å°½æƒ…äº«å—å¤§åŸå¸‚çš„å¹´è½»ä¸è‡ªç”±ï¼Ÿæ˜¯é€‰æ‹©ä¸€æ­¥åˆ°ä½è¿˜æ˜¯å°†æ‚¬å¿µç•™ä¸ªæœªæ¥ï¼Ÿæ˜¯æŒ¤å‡ºæ—¶é—´æ¥å·¥ä½œè¿˜æ˜¯é€‰æ‹©å·¥ä½œå¤–çš„ç”Ÿæ´»ï¼Ÿæ˜¯åšå®šèµ°è‡ªå·±çš„ä¸“ä¸šè¿˜æ˜¯å¦è¾Ÿè¹Šå¾„ï¼Ÿæ˜¯é€‰æ‹©ä¸€çœ¼çœ‹åˆ°å¤´çš„å®‰å¿ƒè¿˜æ˜¯æœªçŸ¥ä¼´éšçš„é£é™©ä¸æœºé‡ï¼Ÿæœ€åï¼Œå¸Œæœ›å„ä½éƒ½èƒ½æœ‰æ»¡æ„çš„é€‰æ‹©ã€‚æˆ‘ä»¬å·²æ˜¯å½“ä»£é’å¹´ï¼Œæˆ‘ä»¬çš„é€‰æ‹©ä¾¿æ˜¯æ–°ä¸€ä»£é’å¹´çš„é€‰æ‹©ã€‚ä¸è¯¸ä½å…±å‹‰ã€‚</p>\n<p>20ã€ä»åŒ—å¤§æ¥è¯»ä¹¦çš„ï¼Œæœ€è¿‘çœ‹å·¥ä½œï¼Œè¶Šæ¥è¶Šè§‰å¾—ï¼Œåœ¨åŒ—äº¬æŒ£ä¸‰åå’ŒæŒ£äº”åæ²¡æœ‰å¤ªå¤§åŒºåˆ«ï¼Œåšäº’è”ç½‘å’Œåšå…¶ä»–è¡Œä¸šä¹Ÿæ²¡æœ‰å¤ªå¤§åŒºåˆ«ï¼Œå¯è§çš„æœªæ¥çš„å·¥ä½œåªæ˜¯ä½œä¸ºç³Šå£çš„å·¥å…·ï¼Œå¾ˆéš¾æœ‰ä»€ä¹ˆçƒ­çˆ±å¯è¨€ã€‚è¶Šæ¥è¶Šæƒ³å›å®¶ä¹¡æ‰¾ä¸ªä½“åˆ¶å†…çš„ç¨³å®šå·¥ä½œäº†ï¼ŒæŠŠæ›´å¤šçš„æ—¶é—´ç”¨åœ¨ç”Ÿæ´»ä¸Šé¢ã€‚æ˜¯æˆ‘å¤ªèººäº†å—ï¼Ÿè¿˜æ˜¯æˆ‘æ ¼å±€ä¸å¤Ÿï¼Ÿ</p>\n","site":{"data":{}},"length":1596,"excerpt":"<p>æœ€è¿‘åˆ·è„‰è„‰ã€çŸ¥ä¹ç­‰è®°å½•ä¸‹ä¸€äº›ç½‘å‹å‘å¸ƒçš„ä¸€äº›ä¿¡æ¯ï¼Œä»…ä½œè®°å½•ï¼Œä¸å¯¹å…¶çœŸå®æ€§ç­‰ä½œæ·±ç©¶ï¼Œä¾µåˆ ã€‚</p>","more":"<p>1ã€å­—èŠ‚é£ä¹¦ EAï¼Œbase æ­å·çš„å¾ˆå¤š 22 å±Šæ ¡æ‹›ç”Ÿæ²¡è¿‡è¯•ç”¨æœŸã€‚</p>\n<p>2ã€æŠ–éŸ³ä¸Šä¸€å•†å®¶ C++åŸºç¡€è¯¾ç¨‹å– 2999 ä¸€ä»½ï¼Œé”€é‡ 1700+ã€‚</p>\n<p>3ã€é“¶è¡Œç±»å¼€å‘å²—ï¼Œä»ä½“é‡ã€å‘å±•ã€åˆ¶åº¦ç­‰æ–¹é¢è€ƒè™‘ï¼Œå»ºè®®å»å›½æœ‰å¤§å‹é“¶è¡Œï¼Œä»¥åŠå¤´éƒ¨çš„è‚¡ä»½åˆ¶é“¶è¡Œã€‚</p>\n<p>4ã€è‹¥æ˜¯å»å¤§åŸå¸‚å½“ç¨‹åºå‘˜ï¼Œä»¥åå¯èƒ½ä¼šæƒ³è±¡åœ¨è€å®¶å½“è€å¸ˆå¤šèˆ’æœå‘€ï¼›è‹¥æ˜¯å›å®¶å½“è€å¸ˆï¼Œæˆ–è®¸ä¸€è¾ˆå­éƒ½ä¼šåæ‚”ä¸ºä»€ä¹ˆå¹´è½»çš„æ—¶å€™ä¸å»å¤§åŸå¸‚é—¯ä¸€é—¯ï¼Œè¿™å°±æ˜¯äººç”Ÿã€‚å¸Œæœ›è‹¥å¹²å¹´åï¼Œéƒ½èƒ½å’Œè‡ªå·±å’Œè§£ï¼Œè¿™è¾ˆå­è¿‡çš„è¿˜ä¸é”™ã€‚</p>\n<p>5ã€ä»¥å‰è¿›å¤§ä¸“æŠ€æ ¡ä¸­å°å­¦ç­‰å½“è€å¸ˆé—¨æ§›å¾ˆä½ï¼Œç°åœ¨è¶Šæ¥è¶Šé«˜ï¼Œè¶Šæ¥è¶Šå·ã€‚</p>\n<p>6ã€ä¸çƒ­çˆ±ç¼–ç¨‹ï¼Œæ²¡è‡ªä¿¡æˆä¸ºè¡Œä¸šç²¾è‹±ï¼Œä¸å–œæ¬¢åŠ ç­ï¼Œä¸æ¨èæˆä¸ºç¨‹åºå‘˜ã€‚</p>\n<p>7ã€è¿™æ˜¯ä¸€ä½å­—èŠ‚æˆ˜ç•¥ç¦»èŒçš„è€å“¥/è€å§å¯¹é£ä¹¦çš„çœ‹æ³•ï¼šä¸ªäººä¸çœ‹å¥½ã€‚æ¬§ç¾çš„ä¼ä¸š saas èƒ½åšèµ·æ¥æœ‰ä¸¤ä¸ªå‰æï¼šä¸€æ˜¯æ¬§ç¾æœ‰å¾ˆæˆç†Ÿçš„èŒä¸šç»ç†äººä½“ç³»ï¼ŒèŒä¸šç»ç†äººæ¥åšé‡‡è´­å†³ç­–ï¼Œè€Œä¸­å›½å¤§éƒ¨åˆ†å…¬å¸æ˜¯ä¸è¿½æ±‚æ•ˆç‡çš„å›½ä¼æˆ–è€…æŠ é—¨åˆ›å§‹äººæä¸€è¨€å ‚çš„ç§ä¼ï¼›äºŒæ˜¯ä¼ä¸š saas çš„æœ¬è´¨æ˜¯æå‡å‘˜å·¥å·¥ä½œæ•ˆç‡ï¼Œä»è€Œå®ç°å‡å°‘å‘˜å·¥æ•°é‡ï¼Œé™ä½äººåŠ›æˆæœ¬ï¼Œç¾å›½äººå¹³å‡å·¥èµ„æ˜¯ 5-7 ä¸‡ç¾å…ƒï¼Œçœä¸€ä¸ªäººå°±æ˜¯å¤§é‡çš„æˆæœ¬ï¼Œä¸­å›½äººåŠ›æˆæœ¬è¿™ä¹ˆä½ï¼Œä¸ºä»€ä¹ˆä¼šæ„¿æ„å‘é£ä¹¦è¿™æ ·çš„ä¼ä¸š saas ä»˜è´¹å‘¢ï¼Ÿ</p>\n<p>8ã€ä¸Šæµ·é“¶è¡Œå¼€å‘å²—ä»Šå¹´é™è–ªï¼Œ22 å¹´åŠä»¥å‰å¾ˆé¦™çš„ä¸Šé“¶ï¼Œä»Šå¹´é£è¯„é€æ¸å˜å·®ã€‚</p>\n<p>9ã€è„‰è„‰æŠ•ç¥¨æ˜¾ç¤ºå››å¤§è¡Œç ”å‘ä¸­å¿ƒå½“ä¸€è¾ˆå­ç¨‹åºå‘˜çš„èŒä¸šç”Ÿæ¶¯å¼€å±€æ¯”å»å¤§å‚åº”å±Šè¯•ç”¨æœŸè¢«è£ä¸‹å®¶ä¸ç¡®å®šæ›´å¥½ã€‚</p>\n<p>10ã€èŒåœº puaï¼šè¿™ä¸ªéœ€æ±‚äº¤ç»™ä½ åšæ˜¯ä¸ºäº†åŸ¹å…»ä½ ï¼Œä½ è¦å¼€å‘ä¸‰å¤©ï¼Œæˆ‘äº¤ç»™è€å‘˜å·¥åªè¦ä¸€å¤©ï¼›ä½ èƒ½åŠ›ä¸è¡Œï¼Œä¸åƒåˆ«çš„å‘˜å·¥ï¼Œä½ ç¦»å¼€è¿™ä¸ªå¹³å°å¯¸æ­¥éš¾è¡Œï¼Œè¦çæƒœå­¦ä¹ çš„æœºä¼šã€‚</p>\n<p>11ã€æŸé“¶è¡Œï¼šä¸€ä¸ªå†…éƒ¨å‡ åä¸ªäººç”¨çš„å•ä½“ç³»ç»Ÿï¼Œè¿˜è¦æ devopsã€‚åƒä½™äººï¼Œå¤§éƒ¨åˆ†è¿˜æ˜¯åƒµå°¸ç”¨æˆ·çš„ç³»ç»Ÿé€¼ç€ä½ åšç†”æ–­é™æµã€‚</p>\n<p>12ã€å†œè¡Œçš„ä¸€äº›ç ”å‘ä¸­å¿ƒé£è¯„è¾ƒå·®ï¼Œå˜æ›´é—®é¢˜ã€å…è´¹åŠ ç­ã€å‰Šå‡ç¦åˆ©ã€å˜ç›¸é™è–ªã€æ™‹å‡å›°éš¾ã€å‡ºå¸‚å®¡æ‰¹ã€å„ç§è€ƒæ ¸ï¼Œè¦ä»”ç»†ç”„åˆ«ã€‚</p>\n<p>13ã€äº’è”ç½‘ä¼ä¸šçš„å·å·²ç»æ˜¯å…±è¯†äº†ï¼Œåœ¨ç»æµç¯å¢ƒä¸å¥½çš„å¤§åŠ¿ä¸‹ï¼Œä»ç„¶æœ‰æºæºä¸æ–­çš„å¹´è½»å°ä¼™ä¼´å‡å¦‚åˆ°å·åŠ¨å¤§æ½®ã€‚è¿™ä¸ªå·èƒ½ä¸èƒ½é¿å…ï¼Ÿæˆ‘ä»¥å‰è®¤ä¸ºä¸èƒ½ï¼Œå› ä¸ºä¸šåŠ¡å‘å±•é€Ÿåº¦å¤ªå¿«ï¼Œå˜åŒ–å¤ªå¤§ï¼Œå¾ˆéš¾é¿å…åŠ ç­åŠ ç‚¹çš„å·ã€‚äº‹å®ä¸Šè·³å‡ºæ¥çœ‹çœ‹ï¼Œè‡³å°‘æœ‰ä¸€åŠä»¥ä¸Šçš„å·éƒ½æ˜¯å› ä¸ºç®¡ç†è€…æ— çŸ¥ï¼Œæ²¡æœ‰æ€è·¯ï¼Œä¸ç»™å›¢é˜ŸæŒ‡å¯¼å’Œæ–¹å‘å¯¼è‡´çš„â€œæ‰¯æ·¡å·â€ã€‚ä¹Ÿè®¸å¹´è½»é²œæ´»çš„ç”Ÿå‘½ä¸å·ç™½ä¸å·ï¼Œæ‰€è°“å°‘å¹´å¾—å¿—çš„ç®¡ç†è€…è‡ªå·±ä¹Ÿæ˜¯è¿™ä¹ˆè¢«å·è‡³ä»Šã€‚ä¼ä¸šæˆé•¿çš„ä»£ä»·ï¼Œæœ€åä¸€åŠè¢«æŠ•èµ„äººä¹°å•ï¼Œä¸€åŠè¢«å‘˜å·¥ä¹°å•ï¼Œå¦‚æœèŠ±äº†ä»£ä»·èƒ½ä¹°æ¥æˆé•¿ï¼Œä¹Ÿç®—å€¼å¾—ï¼Œå¯æ‚²çš„æ˜¯ï¼Œå¤šåŠä¹°ä¸æ¥æˆé•¿ï¼Œä¹°æ¥çš„æ˜¯å¤±è´¥åçš„æ•™è®­ã€‚</p>\n<p>14ã€å›½å®¶å·²ç»æ‹‰å“äº†ä½ç”Ÿè‚²è­¦æŠ¥ï¼Œä½ å¯¹æé«˜å¹´è½»äººç”Ÿè‚²æœ‰ä»€ä¹ˆå»ºè®®ï¼Ÿ - <a href=\"https://www.zhihu.com/question/576438196/answer/2830715899\">å®‡å®™åŒºé•¿å­™è¿åŸçš„å›ç­”</a></p>\n<p>15ã€å­—èŠ‚æ­å·æœ‰éƒ¨é—¨å…¨æ’¤è½¬ base äº†ï¼Œè™½ç„¶äººä¸å¤šã€‚</p>\n<p>16ã€é‚®å‚¨ç ”å‘ä¸­å¿ƒæ€»åŒ…èƒ½åˆ° 30+wï¼Œå¾ˆé¦™ï¼Œä½†æ˜¯è²Œä¼¼è¦ 996ï¼Œä¸ªäººæ„Ÿè§‰è¿˜æ˜¯æ¯”è¾ƒé¦™ã€‚</p>\n<p>17ã€å­—èŠ‚æ•™è‚²å‰©ä¸‹çš„äººä¸ç”¨èƒŒæŒ‡æ ‡ï¼Œä¸ç”¨æ‰¿æ‹…é›†å›¢çš„é«˜é¢„æœŸï¼Œåªéœ€æ¢ç´¢æ–°æ–¹å‘å’Œæ‰“ç£¨æ–°äº§å“ï¼Œè€Œä¸”é›†å›¢æ¯ä¸ªæœˆå›ºå®šæ‹¨é’±å…»ä¸šåŠ¡ï¼Œä½•å°ä¸æ˜¯ä¸€ç§å¹¸ç¦å‘¢ï¼Ÿ</p>\n<p>18ã€å‰å‡ å¹´å½“è€å¸ˆé—¨æ§›å¾ˆä½ï¼Œå¦‚æœä»¥å½“åˆçš„æ¡ä»¶ï¼Œç°åœ¨å»åº”è˜ï¼Œæ ¹æœ¬è¿›ä¸å»ã€‚</p>\n<p>19ã€â€œå›´åŸâ€è¿™ä¸ªè¯ä¸€å®šèƒ½åœ¨ä»Šå¹´ç§‹æ‹›å æ®ä¸€å¸­ä¹‹åœ°ã€‚å¤§åŸå°åŸï¼Œå›½ä¼å¤®ä¼ç§ä¼å¤–ä¼ä½“åˆ¶ï¼Œé“¶è¡Œåˆ¸å•†äº’è”ç½‘åˆ¶é€ ä¸šå†›å·¥ç ”ç©¶æ‰€ã€‚ç©¶ç«Ÿæ˜¯é€‰ä¸ªèƒ½å®‰å®¶çš„å°åŸè¿˜æ˜¯å°½æƒ…äº«å—å¤§åŸå¸‚çš„å¹´è½»ä¸è‡ªç”±ï¼Ÿæ˜¯é€‰æ‹©ä¸€æ­¥åˆ°ä½è¿˜æ˜¯å°†æ‚¬å¿µç•™ä¸ªæœªæ¥ï¼Ÿæ˜¯æŒ¤å‡ºæ—¶é—´æ¥å·¥ä½œè¿˜æ˜¯é€‰æ‹©å·¥ä½œå¤–çš„ç”Ÿæ´»ï¼Ÿæ˜¯åšå®šèµ°è‡ªå·±çš„ä¸“ä¸šè¿˜æ˜¯å¦è¾Ÿè¹Šå¾„ï¼Ÿæ˜¯é€‰æ‹©ä¸€çœ¼çœ‹åˆ°å¤´çš„å®‰å¿ƒè¿˜æ˜¯æœªçŸ¥ä¼´éšçš„é£é™©ä¸æœºé‡ï¼Ÿæœ€åï¼Œå¸Œæœ›å„ä½éƒ½èƒ½æœ‰æ»¡æ„çš„é€‰æ‹©ã€‚æˆ‘ä»¬å·²æ˜¯å½“ä»£é’å¹´ï¼Œæˆ‘ä»¬çš„é€‰æ‹©ä¾¿æ˜¯æ–°ä¸€ä»£é’å¹´çš„é€‰æ‹©ã€‚ä¸è¯¸ä½å…±å‹‰ã€‚</p>\n<p>20ã€ä»åŒ—å¤§æ¥è¯»ä¹¦çš„ï¼Œæœ€è¿‘çœ‹å·¥ä½œï¼Œè¶Šæ¥è¶Šè§‰å¾—ï¼Œåœ¨åŒ—äº¬æŒ£ä¸‰åå’ŒæŒ£äº”åæ²¡æœ‰å¤ªå¤§åŒºåˆ«ï¼Œåšäº’è”ç½‘å’Œåšå…¶ä»–è¡Œä¸šä¹Ÿæ²¡æœ‰å¤ªå¤§åŒºåˆ«ï¼Œå¯è§çš„æœªæ¥çš„å·¥ä½œåªæ˜¯ä½œä¸ºç³Šå£çš„å·¥å…·ï¼Œå¾ˆéš¾æœ‰ä»€ä¹ˆçƒ­çˆ±å¯è¨€ã€‚è¶Šæ¥è¶Šæƒ³å›å®¶ä¹¡æ‰¾ä¸ªä½“åˆ¶å†…çš„ç¨³å®šå·¥ä½œäº†ï¼ŒæŠŠæ›´å¤šçš„æ—¶é—´ç”¨åœ¨ç”Ÿæ´»ä¸Šé¢ã€‚æ˜¯æˆ‘å¤ªèººäº†å—ï¼Ÿè¿˜æ˜¯æˆ‘æ ¼å±€ä¸å¤Ÿï¼Ÿ</p>"},{"title":"æ±Ÿè‹çœè€ƒè€ƒå®Œå•¦","copyright":true,"mathjax":true,"date":"2022-12-18T03:49:32.000Z","urlname":"2022-jiangsu-gwy","_content":"\nåæ ‡å¸¸å·é’Ÿæ¥¼åŒºè‚¯å¾·åŸºé’å±±åº—ï¼Œçœ‹äº†ä¸‹ä¸‹ä¸€ç­å›å®¶çš„ç­è½¦è¦åˆ°ä¸‹åˆä¸€ç‚¹äº†ï¼Œé‚ååœ¨è‚¯å¾·åŸºé‡Œï¼Œæ²æµ´æš–å†¬çš„é˜³å…‰ï¼Œç®€å•å›é¡¾ä¸€ä¸‹æˆ‘å¤‡è€ƒè¿™æ¬¡æ±Ÿè‹çœè€ƒçš„ä¸€äº›äº‹æƒ…å§ã€‚\n\n<!--more-->\n\n8 æœˆåº•ä»å­—èŠ‚å›å­¦æ ¡ï¼Œæœ¬æ¥æ˜¯å‡†å¤‡ç”¨ 80%çš„æ—¶é—´å‡†å¤‡ gwy è€ƒè¯•ï¼Œå‰©ä¸‹æ—¶é—´å‚åŠ ç§‹æ‹›çš„ã€‚ç„¶è€Œï¼Œäº‹ä¸æ„¿è¿ï¼Œç”±äºè€ƒå…¬çš„æ„æ„¿ä¸æ˜¯å¾ˆå¼ºçƒˆï¼Œå†åŠ ä¸Šä¸€æ³¢åˆä¸€æ³¢çš„ç¬”è¯•é¢è¯•ï¼Œä¸¥é‡æŒ¤å äº†å¤ä¹ æ—¶é—´ã€‚æ›´å…³é”®çš„æ˜¯ï¼Œåœ¨åæœŸç§‹æ‹›å¿«ç»“æŸçš„æ—¶å€™ï¼Œç”±äº offer é€‰æ‹©ç­‰é—®é¢˜è®©äººå¿ƒçƒ¦ï¼Œå¤‡è€ƒç”šè‡³ä¸­æ–­è¿‡ä¸€æ®µæ—¶é—´ã€‚\n\næ¥å¸¸å·ä¹Ÿæ˜¯ä¸å¤ªé¡ºåˆ©ï¼Œæœ€è¿‘ç–«æƒ…ç®¡æ§æ”¾å¼€ï¼Œç¤¼æ‹œäº”ä¸­åˆæ¥å¸¸ä¹‹å‰ç‰¹æ„åšäº†å•ç®¡æ ¸é…¸æ£€æµ‹ï¼Œé—®äº†ä¸‹è¯´æ˜¯æ™šä¸Šå…­ä¸ƒç‚¹å°±èƒ½å‡ºç»“æœï¼Œå¹¶ä¸”å¬æœ‹å‹è¯´å¦‚æœç¬¬äºŒå¤©æ—©ä¸Šå…«ç‚¹ä¸å‡ºç»“æœï¼Œå°±æ˜¯é˜³äº†ã€‚ç­‰å•Šç­‰ï¼Œåˆ°æ™šä¸Šä¸ƒå…«ç‚¹äº†åå¤æŸ¥çœ‹æ ¸é…¸ç»“æœï¼Œæ— ã€‚åä¸€ç‚¹ç¡å‰å†çœ‹äº†ä¸€æ¬¡ï¼Œè¿˜æ˜¯æ— ï¼Œç¡å§ï¼Œèƒ½å’‹åŠå‘¢ã€‚ç¬¬äºŒå¤©ä¸€æ—©ï¼Œé†’æ¥ç¬¬ä¸€ä»¶äº‹å°±æ˜¯çœ‹æ ¸é…¸ç»“æœï¼Œç»“æœå‡ºæ¥äº†ï¼Œé˜´æ€§ï¼Œå¤§èˆ’ä¸€å£æ°”ï¼Œä¸ç„¶ä¸æ˜¯æµªè´¹äº†æŠ¥åè´¹è·Ÿé…’åº—è´¹å˜›ï¼ˆç¬‘æ­»ï¼‰ã€‚\n\næ˜¨å¤©æ—©ä¸Šè¡Œæµ‹ï¼Œ135 é¢˜ï¼Œåšç¤¼èŸ¹ï¼Œæ„Ÿè§‰ä»¥æˆ‘ç›®å‰çš„æ°´å¹³ 120 åˆ†é’Ÿåšå®Œ 125 é¢˜æ˜¯ä¸ªæé™äº†ï¼Œè¿˜æœ‰æµ™æ±Ÿçœè€ƒç«Ÿç„¶ 115 é¢˜ï¼Œæ™•ã€‚ä¸‹åˆç”³è®ºï¼Œå†™äº†ä¸‰å°æ—¶å°å­¦ç”Ÿå†™ä½œï¼Œä¸å¾—ä¸è¯´æˆ‘çš„å­—å†™çš„å¤ªæŒ«äº†ï¼Œä»¥åæœ‰ç©ºå¯ä»¥ç»ƒç»ƒï¼ˆflag å·²ç«‹ï¼‰ï¼Œä¸è¿‡ä»¥åæœ‰å°å­©è¿™ä¸ªä¸€å®šè¦æ”¾åˆ°é«˜ä¼˜é¡¹ã€‚ä»Šå¤©ä¸Šåˆåˆšè€ƒå®Œä¸“ä¸šç§‘ç›®ï¼Œè·Ÿå‰ä¸¤å¤©ç²‰ç¬”ä¸Šåšçš„å»å¹´å’Œå‰å¹´çš„ä¸“ä¸šè¯¾æ„Ÿè§‰å·®ä¸å¤šï¼Œéƒ½æ˜¯è¯¥ä¼šçš„ä¼šï¼Œä¸ä¼šçš„çŒœï¼Œæ¯•ç«Ÿè£¸è€ƒã€‚\n\næ€»ä½“è€Œè¨€ï¼Œå¯¹äºæˆ‘è¿™ä¸ªå²—ä½è€Œè¨€ï¼ŒæŠ¥å½•æ¯” 80:2ï¼Œå¦‚æœä»ä¸ƒæœˆä»½å¥½å¥½å‡†å¤‡ï¼Œå¿ƒæ— æ—éª›ï¼Œæˆ‘è§‰å¾—åº”è¯¥æ˜¯å¯ä»¥è¿›é¢è¯•çš„ï¼ˆèœœæ±è‡ªä¿¡ï¼‰ã€‚\n\nä¸‹ä¸ªæœˆè¿˜æœ‰å›½è€ƒï¼Œè¿™å‡ å¤©å†å¸¦ç€çœ‹çœ‹è¡Œæµ‹å§ã€‚\n","source":"_posts/æ±Ÿè‹çœè€ƒè€ƒå®Œå•¦.md","raw":"---\ntitle: æ±Ÿè‹çœè€ƒè€ƒå®Œå•¦\ncopyright: true\nmathjax: true\ncategories: æ—¥å¸¸å°è®°\ntags: \ndate: 2022-12-18 11:49:32\nurlname: 2022-jiangsu-gwy\n---\n\nåæ ‡å¸¸å·é’Ÿæ¥¼åŒºè‚¯å¾·åŸºé’å±±åº—ï¼Œçœ‹äº†ä¸‹ä¸‹ä¸€ç­å›å®¶çš„ç­è½¦è¦åˆ°ä¸‹åˆä¸€ç‚¹äº†ï¼Œé‚ååœ¨è‚¯å¾·åŸºé‡Œï¼Œæ²æµ´æš–å†¬çš„é˜³å…‰ï¼Œç®€å•å›é¡¾ä¸€ä¸‹æˆ‘å¤‡è€ƒè¿™æ¬¡æ±Ÿè‹çœè€ƒçš„ä¸€äº›äº‹æƒ…å§ã€‚\n\n<!--more-->\n\n8 æœˆåº•ä»å­—èŠ‚å›å­¦æ ¡ï¼Œæœ¬æ¥æ˜¯å‡†å¤‡ç”¨ 80%çš„æ—¶é—´å‡†å¤‡ gwy è€ƒè¯•ï¼Œå‰©ä¸‹æ—¶é—´å‚åŠ ç§‹æ‹›çš„ã€‚ç„¶è€Œï¼Œäº‹ä¸æ„¿è¿ï¼Œç”±äºè€ƒå…¬çš„æ„æ„¿ä¸æ˜¯å¾ˆå¼ºçƒˆï¼Œå†åŠ ä¸Šä¸€æ³¢åˆä¸€æ³¢çš„ç¬”è¯•é¢è¯•ï¼Œä¸¥é‡æŒ¤å äº†å¤ä¹ æ—¶é—´ã€‚æ›´å…³é”®çš„æ˜¯ï¼Œåœ¨åæœŸç§‹æ‹›å¿«ç»“æŸçš„æ—¶å€™ï¼Œç”±äº offer é€‰æ‹©ç­‰é—®é¢˜è®©äººå¿ƒçƒ¦ï¼Œå¤‡è€ƒç”šè‡³ä¸­æ–­è¿‡ä¸€æ®µæ—¶é—´ã€‚\n\næ¥å¸¸å·ä¹Ÿæ˜¯ä¸å¤ªé¡ºåˆ©ï¼Œæœ€è¿‘ç–«æƒ…ç®¡æ§æ”¾å¼€ï¼Œç¤¼æ‹œäº”ä¸­åˆæ¥å¸¸ä¹‹å‰ç‰¹æ„åšäº†å•ç®¡æ ¸é…¸æ£€æµ‹ï¼Œé—®äº†ä¸‹è¯´æ˜¯æ™šä¸Šå…­ä¸ƒç‚¹å°±èƒ½å‡ºç»“æœï¼Œå¹¶ä¸”å¬æœ‹å‹è¯´å¦‚æœç¬¬äºŒå¤©æ—©ä¸Šå…«ç‚¹ä¸å‡ºç»“æœï¼Œå°±æ˜¯é˜³äº†ã€‚ç­‰å•Šç­‰ï¼Œåˆ°æ™šä¸Šä¸ƒå…«ç‚¹äº†åå¤æŸ¥çœ‹æ ¸é…¸ç»“æœï¼Œæ— ã€‚åä¸€ç‚¹ç¡å‰å†çœ‹äº†ä¸€æ¬¡ï¼Œè¿˜æ˜¯æ— ï¼Œç¡å§ï¼Œèƒ½å’‹åŠå‘¢ã€‚ç¬¬äºŒå¤©ä¸€æ—©ï¼Œé†’æ¥ç¬¬ä¸€ä»¶äº‹å°±æ˜¯çœ‹æ ¸é…¸ç»“æœï¼Œç»“æœå‡ºæ¥äº†ï¼Œé˜´æ€§ï¼Œå¤§èˆ’ä¸€å£æ°”ï¼Œä¸ç„¶ä¸æ˜¯æµªè´¹äº†æŠ¥åè´¹è·Ÿé…’åº—è´¹å˜›ï¼ˆç¬‘æ­»ï¼‰ã€‚\n\næ˜¨å¤©æ—©ä¸Šè¡Œæµ‹ï¼Œ135 é¢˜ï¼Œåšç¤¼èŸ¹ï¼Œæ„Ÿè§‰ä»¥æˆ‘ç›®å‰çš„æ°´å¹³ 120 åˆ†é’Ÿåšå®Œ 125 é¢˜æ˜¯ä¸ªæé™äº†ï¼Œè¿˜æœ‰æµ™æ±Ÿçœè€ƒç«Ÿç„¶ 115 é¢˜ï¼Œæ™•ã€‚ä¸‹åˆç”³è®ºï¼Œå†™äº†ä¸‰å°æ—¶å°å­¦ç”Ÿå†™ä½œï¼Œä¸å¾—ä¸è¯´æˆ‘çš„å­—å†™çš„å¤ªæŒ«äº†ï¼Œä»¥åæœ‰ç©ºå¯ä»¥ç»ƒç»ƒï¼ˆflag å·²ç«‹ï¼‰ï¼Œä¸è¿‡ä»¥åæœ‰å°å­©è¿™ä¸ªä¸€å®šè¦æ”¾åˆ°é«˜ä¼˜é¡¹ã€‚ä»Šå¤©ä¸Šåˆåˆšè€ƒå®Œä¸“ä¸šç§‘ç›®ï¼Œè·Ÿå‰ä¸¤å¤©ç²‰ç¬”ä¸Šåšçš„å»å¹´å’Œå‰å¹´çš„ä¸“ä¸šè¯¾æ„Ÿè§‰å·®ä¸å¤šï¼Œéƒ½æ˜¯è¯¥ä¼šçš„ä¼šï¼Œä¸ä¼šçš„çŒœï¼Œæ¯•ç«Ÿè£¸è€ƒã€‚\n\næ€»ä½“è€Œè¨€ï¼Œå¯¹äºæˆ‘è¿™ä¸ªå²—ä½è€Œè¨€ï¼ŒæŠ¥å½•æ¯” 80:2ï¼Œå¦‚æœä»ä¸ƒæœˆä»½å¥½å¥½å‡†å¤‡ï¼Œå¿ƒæ— æ—éª›ï¼Œæˆ‘è§‰å¾—åº”è¯¥æ˜¯å¯ä»¥è¿›é¢è¯•çš„ï¼ˆèœœæ±è‡ªä¿¡ï¼‰ã€‚\n\nä¸‹ä¸ªæœˆè¿˜æœ‰å›½è€ƒï¼Œè¿™å‡ å¤©å†å¸¦ç€çœ‹çœ‹è¡Œæµ‹å§ã€‚\n","slug":"æ±Ÿè‹çœè€ƒè€ƒå®Œå•¦","published":1,"updated":"2023-01-26T12:35:58.984Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cldzfw32b001ft9t80w2fb6d7","content":"<p>åæ ‡å¸¸å·é’Ÿæ¥¼åŒºè‚¯å¾·åŸºé’å±±åº—ï¼Œçœ‹äº†ä¸‹ä¸‹ä¸€ç­å›å®¶çš„ç­è½¦è¦åˆ°ä¸‹åˆä¸€ç‚¹äº†ï¼Œé‚ååœ¨è‚¯å¾·åŸºé‡Œï¼Œæ²æµ´æš–å†¬çš„é˜³å…‰ï¼Œç®€å•å›é¡¾ä¸€ä¸‹æˆ‘å¤‡è€ƒè¿™æ¬¡æ±Ÿè‹çœè€ƒçš„ä¸€äº›äº‹æƒ…å§ã€‚</p>\n<span id=\"more\"></span>\n\n<p>8 æœˆåº•ä»å­—èŠ‚å›å­¦æ ¡ï¼Œæœ¬æ¥æ˜¯å‡†å¤‡ç”¨ 80%çš„æ—¶é—´å‡†å¤‡ gwy è€ƒè¯•ï¼Œå‰©ä¸‹æ—¶é—´å‚åŠ ç§‹æ‹›çš„ã€‚ç„¶è€Œï¼Œäº‹ä¸æ„¿è¿ï¼Œç”±äºè€ƒå…¬çš„æ„æ„¿ä¸æ˜¯å¾ˆå¼ºçƒˆï¼Œå†åŠ ä¸Šä¸€æ³¢åˆä¸€æ³¢çš„ç¬”è¯•é¢è¯•ï¼Œä¸¥é‡æŒ¤å äº†å¤ä¹ æ—¶é—´ã€‚æ›´å…³é”®çš„æ˜¯ï¼Œåœ¨åæœŸç§‹æ‹›å¿«ç»“æŸçš„æ—¶å€™ï¼Œç”±äº offer é€‰æ‹©ç­‰é—®é¢˜è®©äººå¿ƒçƒ¦ï¼Œå¤‡è€ƒç”šè‡³ä¸­æ–­è¿‡ä¸€æ®µæ—¶é—´ã€‚</p>\n<p>æ¥å¸¸å·ä¹Ÿæ˜¯ä¸å¤ªé¡ºåˆ©ï¼Œæœ€è¿‘ç–«æƒ…ç®¡æ§æ”¾å¼€ï¼Œç¤¼æ‹œäº”ä¸­åˆæ¥å¸¸ä¹‹å‰ç‰¹æ„åšäº†å•ç®¡æ ¸é…¸æ£€æµ‹ï¼Œé—®äº†ä¸‹è¯´æ˜¯æ™šä¸Šå…­ä¸ƒç‚¹å°±èƒ½å‡ºç»“æœï¼Œå¹¶ä¸”å¬æœ‹å‹è¯´å¦‚æœç¬¬äºŒå¤©æ—©ä¸Šå…«ç‚¹ä¸å‡ºç»“æœï¼Œå°±æ˜¯é˜³äº†ã€‚ç­‰å•Šç­‰ï¼Œåˆ°æ™šä¸Šä¸ƒå…«ç‚¹äº†åå¤æŸ¥çœ‹æ ¸é…¸ç»“æœï¼Œæ— ã€‚åä¸€ç‚¹ç¡å‰å†çœ‹äº†ä¸€æ¬¡ï¼Œè¿˜æ˜¯æ— ï¼Œç¡å§ï¼Œèƒ½å’‹åŠå‘¢ã€‚ç¬¬äºŒå¤©ä¸€æ—©ï¼Œé†’æ¥ç¬¬ä¸€ä»¶äº‹å°±æ˜¯çœ‹æ ¸é…¸ç»“æœï¼Œç»“æœå‡ºæ¥äº†ï¼Œé˜´æ€§ï¼Œå¤§èˆ’ä¸€å£æ°”ï¼Œä¸ç„¶ä¸æ˜¯æµªè´¹äº†æŠ¥åè´¹è·Ÿé…’åº—è´¹å˜›ï¼ˆç¬‘æ­»ï¼‰ã€‚</p>\n<p>æ˜¨å¤©æ—©ä¸Šè¡Œæµ‹ï¼Œ135 é¢˜ï¼Œåšç¤¼èŸ¹ï¼Œæ„Ÿè§‰ä»¥æˆ‘ç›®å‰çš„æ°´å¹³ 120 åˆ†é’Ÿåšå®Œ 125 é¢˜æ˜¯ä¸ªæé™äº†ï¼Œè¿˜æœ‰æµ™æ±Ÿçœè€ƒç«Ÿç„¶ 115 é¢˜ï¼Œæ™•ã€‚ä¸‹åˆç”³è®ºï¼Œå†™äº†ä¸‰å°æ—¶å°å­¦ç”Ÿå†™ä½œï¼Œä¸å¾—ä¸è¯´æˆ‘çš„å­—å†™çš„å¤ªæŒ«äº†ï¼Œä»¥åæœ‰ç©ºå¯ä»¥ç»ƒç»ƒï¼ˆflag å·²ç«‹ï¼‰ï¼Œä¸è¿‡ä»¥åæœ‰å°å­©è¿™ä¸ªä¸€å®šè¦æ”¾åˆ°é«˜ä¼˜é¡¹ã€‚ä»Šå¤©ä¸Šåˆåˆšè€ƒå®Œä¸“ä¸šç§‘ç›®ï¼Œè·Ÿå‰ä¸¤å¤©ç²‰ç¬”ä¸Šåšçš„å»å¹´å’Œå‰å¹´çš„ä¸“ä¸šè¯¾æ„Ÿè§‰å·®ä¸å¤šï¼Œéƒ½æ˜¯è¯¥ä¼šçš„ä¼šï¼Œä¸ä¼šçš„çŒœï¼Œæ¯•ç«Ÿè£¸è€ƒã€‚</p>\n<p>æ€»ä½“è€Œè¨€ï¼Œå¯¹äºæˆ‘è¿™ä¸ªå²—ä½è€Œè¨€ï¼ŒæŠ¥å½•æ¯” 80:2ï¼Œå¦‚æœä»ä¸ƒæœˆä»½å¥½å¥½å‡†å¤‡ï¼Œå¿ƒæ— æ—éª›ï¼Œæˆ‘è§‰å¾—åº”è¯¥æ˜¯å¯ä»¥è¿›é¢è¯•çš„ï¼ˆèœœæ±è‡ªä¿¡ï¼‰ã€‚</p>\n<p>ä¸‹ä¸ªæœˆè¿˜æœ‰å›½è€ƒï¼Œè¿™å‡ å¤©å†å¸¦ç€çœ‹çœ‹è¡Œæµ‹å§ã€‚</p>\n","site":{"data":{}},"length":635,"excerpt":"<p>åæ ‡å¸¸å·é’Ÿæ¥¼åŒºè‚¯å¾·åŸºé’å±±åº—ï¼Œçœ‹äº†ä¸‹ä¸‹ä¸€ç­å›å®¶çš„ç­è½¦è¦åˆ°ä¸‹åˆä¸€ç‚¹äº†ï¼Œé‚ååœ¨è‚¯å¾·åŸºé‡Œï¼Œæ²æµ´æš–å†¬çš„é˜³å…‰ï¼Œç®€å•å›é¡¾ä¸€ä¸‹æˆ‘å¤‡è€ƒè¿™æ¬¡æ±Ÿè‹çœè€ƒçš„ä¸€äº›äº‹æƒ…å§ã€‚</p>","more":"<p>8 æœˆåº•ä»å­—èŠ‚å›å­¦æ ¡ï¼Œæœ¬æ¥æ˜¯å‡†å¤‡ç”¨ 80%çš„æ—¶é—´å‡†å¤‡ gwy è€ƒè¯•ï¼Œå‰©ä¸‹æ—¶é—´å‚åŠ ç§‹æ‹›çš„ã€‚ç„¶è€Œï¼Œäº‹ä¸æ„¿è¿ï¼Œç”±äºè€ƒå…¬çš„æ„æ„¿ä¸æ˜¯å¾ˆå¼ºçƒˆï¼Œå†åŠ ä¸Šä¸€æ³¢åˆä¸€æ³¢çš„ç¬”è¯•é¢è¯•ï¼Œä¸¥é‡æŒ¤å äº†å¤ä¹ æ—¶é—´ã€‚æ›´å…³é”®çš„æ˜¯ï¼Œåœ¨åæœŸç§‹æ‹›å¿«ç»“æŸçš„æ—¶å€™ï¼Œç”±äº offer é€‰æ‹©ç­‰é—®é¢˜è®©äººå¿ƒçƒ¦ï¼Œå¤‡è€ƒç”šè‡³ä¸­æ–­è¿‡ä¸€æ®µæ—¶é—´ã€‚</p>\n<p>æ¥å¸¸å·ä¹Ÿæ˜¯ä¸å¤ªé¡ºåˆ©ï¼Œæœ€è¿‘ç–«æƒ…ç®¡æ§æ”¾å¼€ï¼Œç¤¼æ‹œäº”ä¸­åˆæ¥å¸¸ä¹‹å‰ç‰¹æ„åšäº†å•ç®¡æ ¸é…¸æ£€æµ‹ï¼Œé—®äº†ä¸‹è¯´æ˜¯æ™šä¸Šå…­ä¸ƒç‚¹å°±èƒ½å‡ºç»“æœï¼Œå¹¶ä¸”å¬æœ‹å‹è¯´å¦‚æœç¬¬äºŒå¤©æ—©ä¸Šå…«ç‚¹ä¸å‡ºç»“æœï¼Œå°±æ˜¯é˜³äº†ã€‚ç­‰å•Šç­‰ï¼Œåˆ°æ™šä¸Šä¸ƒå…«ç‚¹äº†åå¤æŸ¥çœ‹æ ¸é…¸ç»“æœï¼Œæ— ã€‚åä¸€ç‚¹ç¡å‰å†çœ‹äº†ä¸€æ¬¡ï¼Œè¿˜æ˜¯æ— ï¼Œç¡å§ï¼Œèƒ½å’‹åŠå‘¢ã€‚ç¬¬äºŒå¤©ä¸€æ—©ï¼Œé†’æ¥ç¬¬ä¸€ä»¶äº‹å°±æ˜¯çœ‹æ ¸é…¸ç»“æœï¼Œç»“æœå‡ºæ¥äº†ï¼Œé˜´æ€§ï¼Œå¤§èˆ’ä¸€å£æ°”ï¼Œä¸ç„¶ä¸æ˜¯æµªè´¹äº†æŠ¥åè´¹è·Ÿé…’åº—è´¹å˜›ï¼ˆç¬‘æ­»ï¼‰ã€‚</p>\n<p>æ˜¨å¤©æ—©ä¸Šè¡Œæµ‹ï¼Œ135 é¢˜ï¼Œåšç¤¼èŸ¹ï¼Œæ„Ÿè§‰ä»¥æˆ‘ç›®å‰çš„æ°´å¹³ 120 åˆ†é’Ÿåšå®Œ 125 é¢˜æ˜¯ä¸ªæé™äº†ï¼Œè¿˜æœ‰æµ™æ±Ÿçœè€ƒç«Ÿç„¶ 115 é¢˜ï¼Œæ™•ã€‚ä¸‹åˆç”³è®ºï¼Œå†™äº†ä¸‰å°æ—¶å°å­¦ç”Ÿå†™ä½œï¼Œä¸å¾—ä¸è¯´æˆ‘çš„å­—å†™çš„å¤ªæŒ«äº†ï¼Œä»¥åæœ‰ç©ºå¯ä»¥ç»ƒç»ƒï¼ˆflag å·²ç«‹ï¼‰ï¼Œä¸è¿‡ä»¥åæœ‰å°å­©è¿™ä¸ªä¸€å®šè¦æ”¾åˆ°é«˜ä¼˜é¡¹ã€‚ä»Šå¤©ä¸Šåˆåˆšè€ƒå®Œä¸“ä¸šç§‘ç›®ï¼Œè·Ÿå‰ä¸¤å¤©ç²‰ç¬”ä¸Šåšçš„å»å¹´å’Œå‰å¹´çš„ä¸“ä¸šè¯¾æ„Ÿè§‰å·®ä¸å¤šï¼Œéƒ½æ˜¯è¯¥ä¼šçš„ä¼šï¼Œä¸ä¼šçš„çŒœï¼Œæ¯•ç«Ÿè£¸è€ƒã€‚</p>\n<p>æ€»ä½“è€Œè¨€ï¼Œå¯¹äºæˆ‘è¿™ä¸ªå²—ä½è€Œè¨€ï¼ŒæŠ¥å½•æ¯” 80:2ï¼Œå¦‚æœä»ä¸ƒæœˆä»½å¥½å¥½å‡†å¤‡ï¼Œå¿ƒæ— æ—éª›ï¼Œæˆ‘è§‰å¾—åº”è¯¥æ˜¯å¯ä»¥è¿›é¢è¯•çš„ï¼ˆèœœæ±è‡ªä¿¡ï¼‰ã€‚</p>\n<p>ä¸‹ä¸ªæœˆè¿˜æœ‰å›½è€ƒï¼Œè¿™å‡ å¤©å†å¸¦ç€çœ‹çœ‹è¡Œæµ‹å§ã€‚</p>"},{"title":"ç®—æ³• - æ’åºç®—æ³•","copyright":true,"mathjax":true,"date":"2023-01-25T05:44:55.000Z","toc":true,"urlname":"algorithm-sort","_content":"\nå…«å¤§æ’åºç®—æ³•çš„ä»£ç å®ç°å’Œæ—¶ç©ºå¤æ‚åº¦æ¯”è¾ƒã€‚<!--more-->\n\n| æ’åºæ³• | å¹³å‡æ—¶é—´   | æœ€å·®æƒ…å½¢      | ç¨³å®šåº¦ | é¢å¤–ç©ºé—´   | å¤‡æ³¨                              |\n| ------ | ---------- | ------------- | ------ | ---------- | --------------------------------- |\n| â­æ’å…¥  | $O(n^2)$   | $O(n^2)$      | ç¨³å®š   | $O(1)$     | å¤§éƒ¨åˆ†å·²æ’åºæ—¶è¾ƒå¥½                |\n| â­å†’æ³¡  | $O(n^2)$   | $O(n^2)$      | ç¨³å®š   | $O(1)$     | $n$å°æ—¶è¾ƒå¥½                       |\n| â­é€‰æ‹©  | $O(n^2)$   | $O(n^2)$      | ä¸ç¨³å®š | $O(1)$     | $n$å°æ—¶è¾ƒå¥½                       |\n| â­å¿«æ’  | $O(nlogn)$ | $O(n^2)$      | ä¸ç¨³å®š | $O(nlogn)$ | $n$å¤§æ—¶è¾ƒå¥½                       |\n| â­å †    | $O(nlogn)$ | $O(nlogn)$    | ä¸ç¨³å®š | $O(1)$     | $n$å¤§æ—¶è¾ƒå¥½                       |\n| â­å½’å¹¶  | $O(nlogn)$ | $O(nlogn)$    | ç¨³å®š   | $O(1)$     | $n$å¤§æ—¶è¾ƒå¥½                       |\n| åŸºæ•°   | $O(logRB)$ | $O(logRB)$    | ç¨³å®š   | $O(1)$     | $B$æ˜¯çœŸæ•°(0-9)ï¼Œ$R$æ˜¯åŸºæ•°(ä¸ªåç™¾) |\n| å¸Œå°”   | $O(nlogn)$ | $O(ns) 1<s<2$ | ä¸ç¨³å®š | $O(1)$     | $s$æ˜¯æ‰€é€‰åˆ†ç»„                     |\n\n### æ’å…¥\n\nå°†å¾…æ’åºåºåˆ—ç¬¬ä¸€ä¸ªå…ƒç´ çœ‹åšä¸€ä¸ªæœ‰åºåºåˆ—ï¼ŒæŠŠç¬¬äºŒä¸ªå…ƒç´ åˆ°æœ€åä¸€ä¸ªå…ƒç´ å½“æˆæ˜¯æœªæ’åºåºåˆ—ã€‚\n\nä»å¤´åˆ°å°¾ä¾æ¬¡æ‰«ææœªæ’åºåºåˆ—ï¼Œå°†æ‰«æåˆ°çš„æ¯ä¸ªå…ƒç´ æ’å…¥æœ‰åºåºåˆ—çš„é€‚å½“ä½ç½®ã€‚ï¼ˆå¦‚æœå¾…æ’å…¥çš„å…ƒç´ ä¸æœ‰åºåºåˆ—ä¸­çš„æŸä¸ªå…ƒç´ ç›¸ç­‰ï¼Œåˆ™å°†å¾…æ’å…¥å…ƒç´ æ’å…¥åˆ°ç›¸ç­‰å…ƒç´ çš„åé¢ã€‚ï¼‰\n\n![æ’å…¥æ’åº](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/insertionSort.gif)\n\n```java\n/**\n  * ä»ç¬¬äºŒä¸ªå…ƒç´ å¼€å§‹ï¼Œæ’å…¥åˆ°å‰é¢å·²ç»æœ‰åºçš„åºåˆ—ä¸­ï¼Œå³æ‰¾åˆ°åºåˆ—ä¸­ç¬¬ä¸€ä¸ªå°äºç­‰äºå½“å‰å…ƒç´ çš„ï¼Œå°†è¿™ä»¥åçš„å…ƒç´ éƒ½\n  * å‘åç§»ä¸€ä½ï¼Œç„¶åå°†å½“å‰å…ƒç´ æ’å…¥åˆ°è¿™ä¸ªä½ç½®ä¸­\n  *\n  * @param arr\n*/\npublic void insertionSort(int[] arr) {\n    /*\n       0 1 2 ...i-1 i i+1 ... n-1\n       å¯¹äºä¸‹æ ‡ i,[0, i-1]æ­¤æ—¶å·²ç»æœ‰åºï¼Œå°†iæ’å…¥åˆ°[0, i-1]ä¸­\n       å…·ä½“æ“ä½œæ˜¯æ‰¾åˆ°iåº”è¯¥æ’å…¥çš„ä¸‹æ ‡idxï¼Œå°†[idx, i-1]çš„å…ƒç´ åç§»ï¼Œ\n       å°†iå…ƒç´ æ”¾åˆ°idx+1(æœ€åä¸€ä¸ªæ¯”æ–°å…ƒç´ æ›´å¤§çš„ä½ç½®æ˜¯ä¸‹æ ‡idxï¼Œä½†æ˜¯å¾ªç¯ä¸­idxæœ€åä¸€æ¬¡è¿˜æ˜¯ä¼šå¾€å·¦å‡ä¸€\n       å› æ­¤è¦æ”¾åˆ°idx+1å¤„\n     */\n    int n = arr.length;\n    for (int i = 0; i < n; i++) {\n        int cur_val = arr[i];\n        int idx = i - 1;\n        while (idx >= 0 && arr[idx] > cur_val) {\n            arr[idx + 1] = arr[idx];\n            idx--;\n        }\n        arr[idx + 1] = cur_val;\n    }\n}\n```\n\n### å†’æ³¡\n\næ¯”è¾ƒç›¸é‚»çš„å…ƒç´ ã€‚å¦‚æœç¬¬ä¸€ä¸ªæ¯”ç¬¬äºŒä¸ªå¤§ï¼Œå°±äº¤æ¢ä»–ä»¬ä¸¤ä¸ªã€‚\n\nå¯¹æ¯ä¸€å¯¹ç›¸é‚»å…ƒç´ ä½œåŒæ ·çš„å·¥ä½œï¼Œä»å¼€å§‹ç¬¬ä¸€å¯¹åˆ°ç»“å°¾çš„æœ€åä¸€å¯¹ã€‚è¿™æ­¥åšå®Œåï¼Œæœ€åçš„å…ƒç´ ä¼šæ˜¯æœ€å¤§çš„æ•°ã€‚\n\né’ˆå¯¹æ‰€æœ‰çš„å…ƒç´ é‡å¤ä»¥ä¸Šçš„æ­¥éª¤ï¼Œé™¤äº†æœ€åä¸€ä¸ªã€‚\n\næŒç»­æ¯æ¬¡å¯¹è¶Šæ¥è¶Šå°‘çš„å…ƒç´ é‡å¤ä¸Šé¢çš„æ­¥éª¤ï¼Œç›´åˆ°æ²¡æœ‰ä»»ä½•ä¸€å¯¹æ•°å­—éœ€è¦æ¯”è¾ƒã€‚\n\n![å†’æ³¡æ’åº](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/bubbleSort.gif)\n\n```java\n/**\n  * ä¸€å…±nä¸ªå…ƒç´ ï¼Œæ¯è½®å°†ä¸€ä¸ªå…ƒç´ å†’æ³¡åˆ°æœ€åçš„ä½ç½®\n  * å¯¹äºç¬¬iè½®ï¼Œéœ€è¦å†’æ³¡ä¸€ä¸ªå…ƒç´ åˆ°ç¬¬n-1-içš„ä½ç½®ï¼Œå› æ­¤éœ€è¦ä»[0,1],[1,2], ..., [n-1-i-1,n-1-i]æ¯æ¬¡å°†è¾ƒå¤§çš„å…ƒç´ å¾€åæ”¾\n  * ä¸ºäº†ä¼˜åŒ–å·²ç»æœ‰åºçš„æƒ…å†µï¼Œå¯ä»¥è®¾ç½®flagè®°å½•æ˜¯å¦å·²ç»æœ‰åº\n  * å¦‚æœå½“è½®å­˜åœ¨äº¤æ¢åˆ™å°†flagç½®ä¸ºfalseè¡¨ç¤ºæœªæœ‰åºï¼Œå¦‚æœflagä¸ºtrueè¯´æ˜å‰é¢çš„å…ƒç´ å·²ç»æœ‰åºäº†\n  *\n  * @param arr\n*/\n    public void bubbleSort(int[] arr) {\n        int n = arr.length;\n        for (int i = 0; i < n; i++) {       // æ¯è½®å°†ä¸€ä¸ªæœ€å¤§çš„å…ƒç´ æ²‰åˆ°æœ€å\n            boolean flag = true;            // å½“å‰è½®æ˜¯å¦æœ‰åº\n            for (int j = 0; j < n - 1 - i; j++) {\n                if (arr[j] > arr[j + 1]) {\n                    flag = false;           // æœªæœ‰åº\n                    int temp = arr[j];\n                    arr[j] = arr[j + 1];\n                    arr[j + 1] = temp;   \n                }\n            }\n            if (flag) break;                // æœ‰åº\n        }\n    }\n```\n\n### é€‰æ‹©\n\né¦–å…ˆåœ¨æœªæ’åºåºåˆ—ä¸­æ‰¾åˆ°æœ€å°ï¼ˆå¤§ï¼‰å…ƒç´ ï¼Œå­˜æ”¾åˆ°æ’åºåºåˆ—çš„èµ·å§‹ä½ç½®ã€‚\n\nå†ä»å‰©ä½™æœªæ’åºå…ƒç´ ä¸­ç»§ç»­å¯»æ‰¾æœ€å°ï¼ˆå¤§ï¼‰å…ƒç´ ï¼Œç„¶åæ”¾åˆ°å·²æ’åºåºåˆ—çš„æœ«å°¾ã€‚\n\né‡å¤ç¬¬äºŒæ­¥ï¼Œç›´åˆ°æ‰€æœ‰å…ƒç´ å‡æ’åºå®Œæ¯•ã€‚\n\n![é€‰æ‹©æ’åº](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/selectionSort.gif)\n\n```java\n/**\n  * å¯¹äºæ¯ä¸ªä½ç½®æˆ‘ä»¬æ’å…¥å…¶åº”å½“æœ‰çš„å…ƒç´ ï¼Œå³å¯¹äºç¬¬0ä½ç½®çš„å…ƒç´ ï¼Œæˆ‘ä»¬æ‰¾åˆ°æœ€å°çš„ç„¶åå’Œè¿™ä¸ªä½ç½®çš„å…ƒç´ è¿›è¡Œäº¤æ¢\n  *\n  * @param arr\n*/\npublic void selectionSort(int[] arr) {\n    int n = arr.length;\n    for (int i = 0; i < n; i++) {\n        int min_index = i;\n        for (int j = i; j < n; j++) {\n            if (arr[j] < arr[min_index]) {\n                min_index = j;\n            }\n        }\n        int temp = arr[i];\n        arr[i] = arr[min_index];\n        arr[min_index] = temp;\n    }\n}\n```\n\n### å¿«æ’\n\n1. ä»æ•°åˆ—ä¸­æŒ‘å‡ºä¸€ä¸ªå…ƒç´ ï¼Œç§°ä¸º \"åŸºå‡†\"ï¼ˆpivotï¼‰;\n2. é‡æ–°æ’åºæ•°åˆ—ï¼Œæ‰€æœ‰å…ƒç´ æ¯”åŸºå‡†å€¼å°çš„æ‘†æ”¾åœ¨åŸºå‡†å‰é¢ï¼Œæ‰€æœ‰å…ƒç´ æ¯”åŸºå‡†å€¼å¤§çš„æ‘†åœ¨åŸºå‡†çš„åé¢ï¼ˆç›¸åŒçš„æ•°å¯ä»¥åˆ°ä»»ä¸€è¾¹ï¼‰ã€‚åœ¨è¿™ä¸ªåˆ†åŒºé€€å‡ºä¹‹åï¼Œè¯¥åŸºå‡†å°±å¤„äºæ•°åˆ—çš„ä¸­é—´ä½ç½®ã€‚è¿™ä¸ªç§°ä¸ºåˆ†åŒºï¼ˆpartitionï¼‰æ“ä½œï¼›\n3. é€’å½’åœ°ï¼ˆrecursiveï¼‰æŠŠå°äºåŸºå‡†å€¼å…ƒç´ çš„å­æ•°åˆ—å’Œå¤§äºåŸºå‡†å€¼å…ƒç´ çš„å­æ•°åˆ—æ’åºï¼›\n\n![å¿«é€Ÿæ’åº](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/quickSort-20221125182030127.gif)\n\né€’å½’ç‰ˆæœ¬ï¼š\n\n```java\npublic void quickSort(int[] arr) {\n    quickSortRange(arr, 0, arr.length - 1);\n}\n\npublic void quickSortRange(int[] arr, int left, int right) {\n    if (left < right) {\n        int mid = partition(arr, left, right);\n        quickSortRange(arr, left, mid - 1);\n        quickSortRange(arr, mid + 1, right);\n    }\n\n}\n\nprivate int partition(int[] arr, int left, int right) {\n    int pivot = arr[left];\n    while (left < right) {\n        while (left < right && arr[right] >= pivot) {\n            right--;\n        }\n        arr[left] = arr[right];\n        while (left < right && arr[left] <= pivot) {\n            left++;\n        }\n        arr[right] = arr[left];\n    }\n    arr[left] = pivot;\n    return left;\n}\n```\n\néé€’å½’ç‰ˆæœ¬ï¼š\n\n```java\nclass Solution {\n    public void quickSort(int[] nums) {\n        stackQuickSort(nums, 0, nums.length - 1);\n    }\n\n    public void stackQuickSort(int[] nums, int left, int right) {\n        Deque<Integer> stack = new LinkedList<>();\n        if (left < right) {\n            stack.push(right);\n            stack.push(left);\n        }\n        while (!stack.isEmpty()) {\n            int l = stack.pop();\n            int r = stack.pop();\n            int mid = partition(nums, l, r);\n            // å¾—åˆ°midååˆ’åˆ†ä¸º [l, mid - 1] mid [mid + 1, r]\n            if (l < mid - 1) {\n                stack.push(mid - 1);\n                stack.push(l);\n            }\n            if (r > mid + 1) {\n                stack.push(r);\n                stack.push(mid + 1);\n            }\n        }\n    }\n\n    private int partition(int[] nums, int left, int right) {\n        int pivot = nums[left];\n        while (left < right) {\n            while (left < right && nums[right] >= pivot) {\n                right--;\n            }\n            nums[left] = nums[right];\n            while (left < right && nums[left] <= pivot) {\n                left++;\n            }\n            nums[right] = nums[left];\n        }\n        nums[left] = pivot;\n        return left;\n    }\n}\n```\n\n### å †\n\n```java\npublic void heapSort(int[] arr) {\n    int len = arr.length;\n\n    buildMaxHeap(arr, len);\n\n    for (int i = len - 1; i > 0; i--) {\n        swap(arr, 0, i);\n        len--;\n        heapify(arr, 0, len);\n    }\n}\n\nprivate void buildMaxHeap(int[] arr, int len) {\n    for (int i = len / 2 - 1; i >= 0; i--) {\n        heapify(arr, i, len);\n    }\n}\n\nprivate void heapify(int[] arr, int i, int len) {\n    while (true) {\n        int left = 2 * i + 1;\n        int right = 2 * i + 2;\n        int largest = i;\n\n        if (left < len && arr[left] > arr[largest]) {\n            largest = left;\n        }\n\n        if (right < len && arr[right] > arr[largest]) {\n            largest = right;\n        }\n\n        if (largest == i) break;\n        swap(arr, i, largest);\n        i = largest;\n    }\n}\n\nprivate void swap(int[] arr, int i, int j) {\n    int temp = arr[i];\n    arr[i] = arr[j];\n    arr[j] = temp;\n}\n```\n\n### å½’å¹¶\n\n```java\n/**\n\t* å½’å¹¶æ’åº\n  * @param arr\n  * @return\n*/\npublic int[] mergeSort(int[] arr) {\n    if (arr == null || arr.length <= 1) return arr;\n    int n = arr.length;\n    int mid = n / 2;\n    int[] left = Arrays.copyOfRange(arr, 0, mid);\n    int[] right = Arrays.copyOfRange(arr, mid, n);\n    return merge(mergeSort(left), mergeSort(right));\n}\n\nprivate int[] merge(int[] a, int[] b) {\n    int[] res = new int[a.length + b.length];\n    int i = 0, j = 0, ind = 0;\n    while (i < a.length && j < b.length) {\n        res[ind++] = (a[i] < b[j]) ? a[i++] : b[j++];\n    }\n    while (i < a.length) {\n        res[ind++] = a[i++];\n    }\n    while (j < b.length) {\n        res[ind++] = b[j++];\n    }\n    return res;\n}\n```\n\n### å¸Œå°”\n\n```java\n/**\n\t* å¸Œå°”æ’åºï¼Œå‡å¢é‡æ’åºç®—æ³•ï¼Œæ˜¯æ’å…¥æ’åºçš„ä¸€ç§æ›´é«˜æ•ˆçš„æ”¹è¿›ç‰ˆæœ¬ã€‚ä½†å¸Œå°”æ’åºæ˜¯éç¨³å®šæ’åºç®—æ³•ã€‚\n\t* @param arr\n*/\npublic void shellSort(int[] arr) {\n    int n = arr.length;\n    for (int gap = n / 2; gap > 0; gap /= 2) {\n        // {i, i+gap, i+2gap, ...}\n        for (int i = 0; i < n; i++) {\n            int cur_val = arr[i];\n            int idx = i - gap;\n            while (idx >= 0 && arr[idx] > cur_val) {\n                arr[idx + gap] = arr[idx];\n                idx -= gap;\n            }\n            arr[idx + gap] = cur_val;\n        }\n    }\n}\n```\n\n \n","source":"_posts/ç®—æ³•-æ’åºç®—æ³•.md","raw":"---\ntitle: ç®—æ³• - æ’åºç®—æ³•\ncopyright: true\nmathjax: true\ncategories:\n  - ç®—æ³•\ndate: 2023-01-25 13:44:55\ntags:\ntoc: true\nurlname: algorithm-sort\n---\n\nå…«å¤§æ’åºç®—æ³•çš„ä»£ç å®ç°å’Œæ—¶ç©ºå¤æ‚åº¦æ¯”è¾ƒã€‚<!--more-->\n\n| æ’åºæ³• | å¹³å‡æ—¶é—´   | æœ€å·®æƒ…å½¢      | ç¨³å®šåº¦ | é¢å¤–ç©ºé—´   | å¤‡æ³¨                              |\n| ------ | ---------- | ------------- | ------ | ---------- | --------------------------------- |\n| â­æ’å…¥  | $O(n^2)$   | $O(n^2)$      | ç¨³å®š   | $O(1)$     | å¤§éƒ¨åˆ†å·²æ’åºæ—¶è¾ƒå¥½                |\n| â­å†’æ³¡  | $O(n^2)$   | $O(n^2)$      | ç¨³å®š   | $O(1)$     | $n$å°æ—¶è¾ƒå¥½                       |\n| â­é€‰æ‹©  | $O(n^2)$   | $O(n^2)$      | ä¸ç¨³å®š | $O(1)$     | $n$å°æ—¶è¾ƒå¥½                       |\n| â­å¿«æ’  | $O(nlogn)$ | $O(n^2)$      | ä¸ç¨³å®š | $O(nlogn)$ | $n$å¤§æ—¶è¾ƒå¥½                       |\n| â­å †    | $O(nlogn)$ | $O(nlogn)$    | ä¸ç¨³å®š | $O(1)$     | $n$å¤§æ—¶è¾ƒå¥½                       |\n| â­å½’å¹¶  | $O(nlogn)$ | $O(nlogn)$    | ç¨³å®š   | $O(1)$     | $n$å¤§æ—¶è¾ƒå¥½                       |\n| åŸºæ•°   | $O(logRB)$ | $O(logRB)$    | ç¨³å®š   | $O(1)$     | $B$æ˜¯çœŸæ•°(0-9)ï¼Œ$R$æ˜¯åŸºæ•°(ä¸ªåç™¾) |\n| å¸Œå°”   | $O(nlogn)$ | $O(ns) 1<s<2$ | ä¸ç¨³å®š | $O(1)$     | $s$æ˜¯æ‰€é€‰åˆ†ç»„                     |\n\n### æ’å…¥\n\nå°†å¾…æ’åºåºåˆ—ç¬¬ä¸€ä¸ªå…ƒç´ çœ‹åšä¸€ä¸ªæœ‰åºåºåˆ—ï¼ŒæŠŠç¬¬äºŒä¸ªå…ƒç´ åˆ°æœ€åä¸€ä¸ªå…ƒç´ å½“æˆæ˜¯æœªæ’åºåºåˆ—ã€‚\n\nä»å¤´åˆ°å°¾ä¾æ¬¡æ‰«ææœªæ’åºåºåˆ—ï¼Œå°†æ‰«æåˆ°çš„æ¯ä¸ªå…ƒç´ æ’å…¥æœ‰åºåºåˆ—çš„é€‚å½“ä½ç½®ã€‚ï¼ˆå¦‚æœå¾…æ’å…¥çš„å…ƒç´ ä¸æœ‰åºåºåˆ—ä¸­çš„æŸä¸ªå…ƒç´ ç›¸ç­‰ï¼Œåˆ™å°†å¾…æ’å…¥å…ƒç´ æ’å…¥åˆ°ç›¸ç­‰å…ƒç´ çš„åé¢ã€‚ï¼‰\n\n![æ’å…¥æ’åº](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/insertionSort.gif)\n\n```java\n/**\n  * ä»ç¬¬äºŒä¸ªå…ƒç´ å¼€å§‹ï¼Œæ’å…¥åˆ°å‰é¢å·²ç»æœ‰åºçš„åºåˆ—ä¸­ï¼Œå³æ‰¾åˆ°åºåˆ—ä¸­ç¬¬ä¸€ä¸ªå°äºç­‰äºå½“å‰å…ƒç´ çš„ï¼Œå°†è¿™ä»¥åçš„å…ƒç´ éƒ½\n  * å‘åç§»ä¸€ä½ï¼Œç„¶åå°†å½“å‰å…ƒç´ æ’å…¥åˆ°è¿™ä¸ªä½ç½®ä¸­\n  *\n  * @param arr\n*/\npublic void insertionSort(int[] arr) {\n    /*\n       0 1 2 ...i-1 i i+1 ... n-1\n       å¯¹äºä¸‹æ ‡ i,[0, i-1]æ­¤æ—¶å·²ç»æœ‰åºï¼Œå°†iæ’å…¥åˆ°[0, i-1]ä¸­\n       å…·ä½“æ“ä½œæ˜¯æ‰¾åˆ°iåº”è¯¥æ’å…¥çš„ä¸‹æ ‡idxï¼Œå°†[idx, i-1]çš„å…ƒç´ åç§»ï¼Œ\n       å°†iå…ƒç´ æ”¾åˆ°idx+1(æœ€åä¸€ä¸ªæ¯”æ–°å…ƒç´ æ›´å¤§çš„ä½ç½®æ˜¯ä¸‹æ ‡idxï¼Œä½†æ˜¯å¾ªç¯ä¸­idxæœ€åä¸€æ¬¡è¿˜æ˜¯ä¼šå¾€å·¦å‡ä¸€\n       å› æ­¤è¦æ”¾åˆ°idx+1å¤„\n     */\n    int n = arr.length;\n    for (int i = 0; i < n; i++) {\n        int cur_val = arr[i];\n        int idx = i - 1;\n        while (idx >= 0 && arr[idx] > cur_val) {\n            arr[idx + 1] = arr[idx];\n            idx--;\n        }\n        arr[idx + 1] = cur_val;\n    }\n}\n```\n\n### å†’æ³¡\n\næ¯”è¾ƒç›¸é‚»çš„å…ƒç´ ã€‚å¦‚æœç¬¬ä¸€ä¸ªæ¯”ç¬¬äºŒä¸ªå¤§ï¼Œå°±äº¤æ¢ä»–ä»¬ä¸¤ä¸ªã€‚\n\nå¯¹æ¯ä¸€å¯¹ç›¸é‚»å…ƒç´ ä½œåŒæ ·çš„å·¥ä½œï¼Œä»å¼€å§‹ç¬¬ä¸€å¯¹åˆ°ç»“å°¾çš„æœ€åä¸€å¯¹ã€‚è¿™æ­¥åšå®Œåï¼Œæœ€åçš„å…ƒç´ ä¼šæ˜¯æœ€å¤§çš„æ•°ã€‚\n\né’ˆå¯¹æ‰€æœ‰çš„å…ƒç´ é‡å¤ä»¥ä¸Šçš„æ­¥éª¤ï¼Œé™¤äº†æœ€åä¸€ä¸ªã€‚\n\næŒç»­æ¯æ¬¡å¯¹è¶Šæ¥è¶Šå°‘çš„å…ƒç´ é‡å¤ä¸Šé¢çš„æ­¥éª¤ï¼Œç›´åˆ°æ²¡æœ‰ä»»ä½•ä¸€å¯¹æ•°å­—éœ€è¦æ¯”è¾ƒã€‚\n\n![å†’æ³¡æ’åº](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/bubbleSort.gif)\n\n```java\n/**\n  * ä¸€å…±nä¸ªå…ƒç´ ï¼Œæ¯è½®å°†ä¸€ä¸ªå…ƒç´ å†’æ³¡åˆ°æœ€åçš„ä½ç½®\n  * å¯¹äºç¬¬iè½®ï¼Œéœ€è¦å†’æ³¡ä¸€ä¸ªå…ƒç´ åˆ°ç¬¬n-1-içš„ä½ç½®ï¼Œå› æ­¤éœ€è¦ä»[0,1],[1,2], ..., [n-1-i-1,n-1-i]æ¯æ¬¡å°†è¾ƒå¤§çš„å…ƒç´ å¾€åæ”¾\n  * ä¸ºäº†ä¼˜åŒ–å·²ç»æœ‰åºçš„æƒ…å†µï¼Œå¯ä»¥è®¾ç½®flagè®°å½•æ˜¯å¦å·²ç»æœ‰åº\n  * å¦‚æœå½“è½®å­˜åœ¨äº¤æ¢åˆ™å°†flagç½®ä¸ºfalseè¡¨ç¤ºæœªæœ‰åºï¼Œå¦‚æœflagä¸ºtrueè¯´æ˜å‰é¢çš„å…ƒç´ å·²ç»æœ‰åºäº†\n  *\n  * @param arr\n*/\n    public void bubbleSort(int[] arr) {\n        int n = arr.length;\n        for (int i = 0; i < n; i++) {       // æ¯è½®å°†ä¸€ä¸ªæœ€å¤§çš„å…ƒç´ æ²‰åˆ°æœ€å\n            boolean flag = true;            // å½“å‰è½®æ˜¯å¦æœ‰åº\n            for (int j = 0; j < n - 1 - i; j++) {\n                if (arr[j] > arr[j + 1]) {\n                    flag = false;           // æœªæœ‰åº\n                    int temp = arr[j];\n                    arr[j] = arr[j + 1];\n                    arr[j + 1] = temp;   \n                }\n            }\n            if (flag) break;                // æœ‰åº\n        }\n    }\n```\n\n### é€‰æ‹©\n\né¦–å…ˆåœ¨æœªæ’åºåºåˆ—ä¸­æ‰¾åˆ°æœ€å°ï¼ˆå¤§ï¼‰å…ƒç´ ï¼Œå­˜æ”¾åˆ°æ’åºåºåˆ—çš„èµ·å§‹ä½ç½®ã€‚\n\nå†ä»å‰©ä½™æœªæ’åºå…ƒç´ ä¸­ç»§ç»­å¯»æ‰¾æœ€å°ï¼ˆå¤§ï¼‰å…ƒç´ ï¼Œç„¶åæ”¾åˆ°å·²æ’åºåºåˆ—çš„æœ«å°¾ã€‚\n\né‡å¤ç¬¬äºŒæ­¥ï¼Œç›´åˆ°æ‰€æœ‰å…ƒç´ å‡æ’åºå®Œæ¯•ã€‚\n\n![é€‰æ‹©æ’åº](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/selectionSort.gif)\n\n```java\n/**\n  * å¯¹äºæ¯ä¸ªä½ç½®æˆ‘ä»¬æ’å…¥å…¶åº”å½“æœ‰çš„å…ƒç´ ï¼Œå³å¯¹äºç¬¬0ä½ç½®çš„å…ƒç´ ï¼Œæˆ‘ä»¬æ‰¾åˆ°æœ€å°çš„ç„¶åå’Œè¿™ä¸ªä½ç½®çš„å…ƒç´ è¿›è¡Œäº¤æ¢\n  *\n  * @param arr\n*/\npublic void selectionSort(int[] arr) {\n    int n = arr.length;\n    for (int i = 0; i < n; i++) {\n        int min_index = i;\n        for (int j = i; j < n; j++) {\n            if (arr[j] < arr[min_index]) {\n                min_index = j;\n            }\n        }\n        int temp = arr[i];\n        arr[i] = arr[min_index];\n        arr[min_index] = temp;\n    }\n}\n```\n\n### å¿«æ’\n\n1. ä»æ•°åˆ—ä¸­æŒ‘å‡ºä¸€ä¸ªå…ƒç´ ï¼Œç§°ä¸º \"åŸºå‡†\"ï¼ˆpivotï¼‰;\n2. é‡æ–°æ’åºæ•°åˆ—ï¼Œæ‰€æœ‰å…ƒç´ æ¯”åŸºå‡†å€¼å°çš„æ‘†æ”¾åœ¨åŸºå‡†å‰é¢ï¼Œæ‰€æœ‰å…ƒç´ æ¯”åŸºå‡†å€¼å¤§çš„æ‘†åœ¨åŸºå‡†çš„åé¢ï¼ˆç›¸åŒçš„æ•°å¯ä»¥åˆ°ä»»ä¸€è¾¹ï¼‰ã€‚åœ¨è¿™ä¸ªåˆ†åŒºé€€å‡ºä¹‹åï¼Œè¯¥åŸºå‡†å°±å¤„äºæ•°åˆ—çš„ä¸­é—´ä½ç½®ã€‚è¿™ä¸ªç§°ä¸ºåˆ†åŒºï¼ˆpartitionï¼‰æ“ä½œï¼›\n3. é€’å½’åœ°ï¼ˆrecursiveï¼‰æŠŠå°äºåŸºå‡†å€¼å…ƒç´ çš„å­æ•°åˆ—å’Œå¤§äºåŸºå‡†å€¼å…ƒç´ çš„å­æ•°åˆ—æ’åºï¼›\n\n![å¿«é€Ÿæ’åº](https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/quickSort-20221125182030127.gif)\n\né€’å½’ç‰ˆæœ¬ï¼š\n\n```java\npublic void quickSort(int[] arr) {\n    quickSortRange(arr, 0, arr.length - 1);\n}\n\npublic void quickSortRange(int[] arr, int left, int right) {\n    if (left < right) {\n        int mid = partition(arr, left, right);\n        quickSortRange(arr, left, mid - 1);\n        quickSortRange(arr, mid + 1, right);\n    }\n\n}\n\nprivate int partition(int[] arr, int left, int right) {\n    int pivot = arr[left];\n    while (left < right) {\n        while (left < right && arr[right] >= pivot) {\n            right--;\n        }\n        arr[left] = arr[right];\n        while (left < right && arr[left] <= pivot) {\n            left++;\n        }\n        arr[right] = arr[left];\n    }\n    arr[left] = pivot;\n    return left;\n}\n```\n\néé€’å½’ç‰ˆæœ¬ï¼š\n\n```java\nclass Solution {\n    public void quickSort(int[] nums) {\n        stackQuickSort(nums, 0, nums.length - 1);\n    }\n\n    public void stackQuickSort(int[] nums, int left, int right) {\n        Deque<Integer> stack = new LinkedList<>();\n        if (left < right) {\n            stack.push(right);\n            stack.push(left);\n        }\n        while (!stack.isEmpty()) {\n            int l = stack.pop();\n            int r = stack.pop();\n            int mid = partition(nums, l, r);\n            // å¾—åˆ°midååˆ’åˆ†ä¸º [l, mid - 1] mid [mid + 1, r]\n            if (l < mid - 1) {\n                stack.push(mid - 1);\n                stack.push(l);\n            }\n            if (r > mid + 1) {\n                stack.push(r);\n                stack.push(mid + 1);\n            }\n        }\n    }\n\n    private int partition(int[] nums, int left, int right) {\n        int pivot = nums[left];\n        while (left < right) {\n            while (left < right && nums[right] >= pivot) {\n                right--;\n            }\n            nums[left] = nums[right];\n            while (left < right && nums[left] <= pivot) {\n                left++;\n            }\n            nums[right] = nums[left];\n        }\n        nums[left] = pivot;\n        return left;\n    }\n}\n```\n\n### å †\n\n```java\npublic void heapSort(int[] arr) {\n    int len = arr.length;\n\n    buildMaxHeap(arr, len);\n\n    for (int i = len - 1; i > 0; i--) {\n        swap(arr, 0, i);\n        len--;\n        heapify(arr, 0, len);\n    }\n}\n\nprivate void buildMaxHeap(int[] arr, int len) {\n    for (int i = len / 2 - 1; i >= 0; i--) {\n        heapify(arr, i, len);\n    }\n}\n\nprivate void heapify(int[] arr, int i, int len) {\n    while (true) {\n        int left = 2 * i + 1;\n        int right = 2 * i + 2;\n        int largest = i;\n\n        if (left < len && arr[left] > arr[largest]) {\n            largest = left;\n        }\n\n        if (right < len && arr[right] > arr[largest]) {\n            largest = right;\n        }\n\n        if (largest == i) break;\n        swap(arr, i, largest);\n        i = largest;\n    }\n}\n\nprivate void swap(int[] arr, int i, int j) {\n    int temp = arr[i];\n    arr[i] = arr[j];\n    arr[j] = temp;\n}\n```\n\n### å½’å¹¶\n\n```java\n/**\n\t* å½’å¹¶æ’åº\n  * @param arr\n  * @return\n*/\npublic int[] mergeSort(int[] arr) {\n    if (arr == null || arr.length <= 1) return arr;\n    int n = arr.length;\n    int mid = n / 2;\n    int[] left = Arrays.copyOfRange(arr, 0, mid);\n    int[] right = Arrays.copyOfRange(arr, mid, n);\n    return merge(mergeSort(left), mergeSort(right));\n}\n\nprivate int[] merge(int[] a, int[] b) {\n    int[] res = new int[a.length + b.length];\n    int i = 0, j = 0, ind = 0;\n    while (i < a.length && j < b.length) {\n        res[ind++] = (a[i] < b[j]) ? a[i++] : b[j++];\n    }\n    while (i < a.length) {\n        res[ind++] = a[i++];\n    }\n    while (j < b.length) {\n        res[ind++] = b[j++];\n    }\n    return res;\n}\n```\n\n### å¸Œå°”\n\n```java\n/**\n\t* å¸Œå°”æ’åºï¼Œå‡å¢é‡æ’åºç®—æ³•ï¼Œæ˜¯æ’å…¥æ’åºçš„ä¸€ç§æ›´é«˜æ•ˆçš„æ”¹è¿›ç‰ˆæœ¬ã€‚ä½†å¸Œå°”æ’åºæ˜¯éç¨³å®šæ’åºç®—æ³•ã€‚\n\t* @param arr\n*/\npublic void shellSort(int[] arr) {\n    int n = arr.length;\n    for (int gap = n / 2; gap > 0; gap /= 2) {\n        // {i, i+gap, i+2gap, ...}\n        for (int i = 0; i < n; i++) {\n            int cur_val = arr[i];\n            int idx = i - gap;\n            while (idx >= 0 && arr[idx] > cur_val) {\n                arr[idx + gap] = arr[idx];\n                idx -= gap;\n            }\n            arr[idx + gap] = cur_val;\n        }\n    }\n}\n```\n\n \n","slug":"ç®—æ³•-æ’åºç®—æ³•","published":1,"updated":"2023-01-31T03:48:26.886Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cldzfw32c001ht9t831k882v6","content":"<p>å…«å¤§æ’åºç®—æ³•çš„ä»£ç å®ç°å’Œæ—¶ç©ºå¤æ‚åº¦æ¯”è¾ƒã€‚<span id=\"more\"></span></p>\n<table>\n<thead>\n<tr>\n<th>æ’åºæ³•</th>\n<th>å¹³å‡æ—¶é—´</th>\n<th>æœ€å·®æƒ…å½¢</th>\n<th>ç¨³å®šåº¦</th>\n<th>é¢å¤–ç©ºé—´</th>\n<th>å¤‡æ³¨</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>â­æ’å…¥</td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"5.832ex\" height=\"2.452ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -833.9 2577.6 1083.9\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"msup\" transform=\"translate(1152,0)\"><g data-mml-node=\"mi\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mn\" transform=\"translate(633,363) scale(0.707)\"><path data-c=\"32\" d=\"M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z\"></path></g></g><g data-mml-node=\"mo\" transform=\"translate(2188.6,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"5.832ex\" height=\"2.452ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -833.9 2577.6 1083.9\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"msup\" transform=\"translate(1152,0)\"><g data-mml-node=\"mi\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mn\" transform=\"translate(633,363) scale(0.707)\"><path data-c=\"32\" d=\"M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z\"></path></g></g><g data-mml-node=\"mo\" transform=\"translate(2188.6,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td>ç¨³å®š</td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"4.618ex\" height=\"2.262ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -750 2041 1000\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"mn\" transform=\"translate(1152,0)\"><path data-c=\"31\" d=\"M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(1652,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td>å¤§éƒ¨åˆ†å·²æ’åºæ—¶è¾ƒå¥½</td>\n</tr>\n<tr>\n<td>â­å†’æ³¡</td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"5.832ex\" height=\"2.452ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -833.9 2577.6 1083.9\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"msup\" transform=\"translate(1152,0)\"><g data-mml-node=\"mi\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mn\" transform=\"translate(633,363) scale(0.707)\"><path data-c=\"32\" d=\"M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z\"></path></g></g><g data-mml-node=\"mo\" transform=\"translate(2188.6,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"5.832ex\" height=\"2.452ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -833.9 2577.6 1083.9\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"msup\" transform=\"translate(1152,0)\"><g data-mml-node=\"mi\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mn\" transform=\"translate(633,363) scale(0.707)\"><path data-c=\"32\" d=\"M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z\"></path></g></g><g data-mml-node=\"mo\" transform=\"translate(2188.6,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td>ç¨³å®š</td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"4.618ex\" height=\"2.262ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -750 2041 1000\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"mn\" transform=\"translate(1152,0)\"><path data-c=\"31\" d=\"M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(1652,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.025ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"1.357ex\" height=\"1.025ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -442 600 453\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g></g></g></svg></mjx-container>å°æ—¶è¾ƒå¥½</td>\n</tr>\n<tr>\n<td>â­é€‰æ‹©</td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"5.832ex\" height=\"2.452ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -833.9 2577.6 1083.9\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"msup\" transform=\"translate(1152,0)\"><g data-mml-node=\"mi\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mn\" transform=\"translate(633,363) scale(0.707)\"><path data-c=\"32\" d=\"M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z\"></path></g></g><g data-mml-node=\"mo\" transform=\"translate(2188.6,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"5.832ex\" height=\"2.452ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -833.9 2577.6 1083.9\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"msup\" transform=\"translate(1152,0)\"><g data-mml-node=\"mi\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mn\" transform=\"translate(633,363) scale(0.707)\"><path data-c=\"32\" d=\"M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z\"></path></g></g><g data-mml-node=\"mo\" transform=\"translate(2188.6,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td>ä¸ç¨³å®š</td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"4.618ex\" height=\"2.262ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -750 2041 1000\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"mn\" transform=\"translate(1152,0)\"><path data-c=\"31\" d=\"M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(1652,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.025ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"1.357ex\" height=\"1.025ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -442 600 453\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g></g></g></svg></mjx-container>å°æ—¶è¾ƒå¥½</td>\n</tr>\n<tr>\n<td>â­å¿«æ’</td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"9.052ex\" height=\"2.262ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -750 4001 1000\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1152,0)\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1752,0)\"><path data-c=\"1D459\" d=\"M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(2050,0)\"><path data-c=\"1D45C\" d=\"M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(2535,0)\"><path data-c=\"1D454\" d=\"M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(3012,0)\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(3612,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"5.832ex\" height=\"2.452ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -833.9 2577.6 1083.9\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"msup\" transform=\"translate(1152,0)\"><g data-mml-node=\"mi\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mn\" transform=\"translate(633,363) scale(0.707)\"><path data-c=\"32\" d=\"M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z\"></path></g></g><g data-mml-node=\"mo\" transform=\"translate(2188.6,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td>ä¸ç¨³å®š</td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"9.052ex\" height=\"2.262ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -750 4001 1000\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1152,0)\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1752,0)\"><path data-c=\"1D459\" d=\"M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(2050,0)\"><path data-c=\"1D45C\" d=\"M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(2535,0)\"><path data-c=\"1D454\" d=\"M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(3012,0)\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(3612,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.025ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"1.357ex\" height=\"1.025ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -442 600 453\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g></g></g></svg></mjx-container>å¤§æ—¶è¾ƒå¥½</td>\n</tr>\n<tr>\n<td>â­å †</td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"9.052ex\" height=\"2.262ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -750 4001 1000\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1152,0)\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1752,0)\"><path data-c=\"1D459\" d=\"M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(2050,0)\"><path data-c=\"1D45C\" d=\"M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(2535,0)\"><path data-c=\"1D454\" d=\"M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(3012,0)\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(3612,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"9.052ex\" height=\"2.262ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -750 4001 1000\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1152,0)\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1752,0)\"><path data-c=\"1D459\" d=\"M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(2050,0)\"><path data-c=\"1D45C\" d=\"M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(2535,0)\"><path data-c=\"1D454\" d=\"M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(3012,0)\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(3612,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td>ä¸ç¨³å®š</td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"4.618ex\" height=\"2.262ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -750 2041 1000\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"mn\" transform=\"translate(1152,0)\"><path data-c=\"31\" d=\"M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(1652,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.025ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"1.357ex\" height=\"1.025ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -442 600 453\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g></g></g></svg></mjx-container>å¤§æ—¶è¾ƒå¥½</td>\n</tr>\n<tr>\n<td>â­å½’å¹¶</td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"9.052ex\" height=\"2.262ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -750 4001 1000\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1152,0)\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1752,0)\"><path data-c=\"1D459\" d=\"M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(2050,0)\"><path data-c=\"1D45C\" d=\"M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(2535,0)\"><path data-c=\"1D454\" d=\"M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(3012,0)\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(3612,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"9.052ex\" height=\"2.262ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -750 4001 1000\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1152,0)\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1752,0)\"><path data-c=\"1D459\" d=\"M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(2050,0)\"><path data-c=\"1D45C\" d=\"M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(2535,0)\"><path data-c=\"1D454\" d=\"M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(3012,0)\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(3612,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td>ç¨³å®š</td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"4.618ex\" height=\"2.262ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -750 2041 1000\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"mn\" transform=\"translate(1152,0)\"><path data-c=\"31\" d=\"M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(1652,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.025ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"1.357ex\" height=\"1.025ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -442 600 453\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g></g></g></svg></mjx-container>å¤§æ—¶è¾ƒå¥½</td>\n</tr>\n<tr>\n<td>åŸºæ•°</td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"9.771ex\" height=\"2.262ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -750 4319 1000\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1152,0)\"><path data-c=\"1D459\" d=\"M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1450,0)\"><path data-c=\"1D45C\" d=\"M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1935,0)\"><path data-c=\"1D454\" d=\"M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(2412,0)\"><path data-c=\"1D445\" d=\"M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(3171,0)\"><path data-c=\"1D435\" d=\"M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(3930,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"9.771ex\" height=\"2.262ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -750 4319 1000\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1152,0)\"><path data-c=\"1D459\" d=\"M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1450,0)\"><path data-c=\"1D45C\" d=\"M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1935,0)\"><path data-c=\"1D454\" d=\"M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(2412,0)\"><path data-c=\"1D445\" d=\"M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(3171,0)\"><path data-c=\"1D435\" d=\"M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(3930,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td>ç¨³å®š</td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"4.618ex\" height=\"2.262ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -750 2041 1000\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"mn\" transform=\"translate(1152,0)\"><path data-c=\"31\" d=\"M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(1652,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: 0;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"1.717ex\" height=\"1.545ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -683 759 683\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D435\" d=\"M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z\"></path></g></g></g></svg></mjx-container>æ˜¯çœŸæ•°(0-9)ï¼Œ<mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.048ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"1.717ex\" height=\"1.593ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -683 759 704\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D445\" d=\"M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z\"></path></g></g></g></svg></mjx-container>æ˜¯åŸºæ•°(ä¸ªåç™¾)</td>\n</tr>\n<tr>\n<td>å¸Œå°”</td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"9.052ex\" height=\"2.262ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -750 4001 1000\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1152,0)\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1752,0)\"><path data-c=\"1D459\" d=\"M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(2050,0)\"><path data-c=\"1D45C\" d=\"M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(2535,0)\"><path data-c=\"1D454\" d=\"M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(3012,0)\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(3612,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"15.263ex\" height=\"2.262ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -750 6746.1 1000\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1152,0)\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1752,0)\"><path data-c=\"1D460\" d=\"M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(2221,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g><g data-mml-node=\"mn\" transform=\"translate(2610,0)\"><path data-c=\"31\" d=\"M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(3387.8,0)\"><path data-c=\"3C\" d=\"M694 -11T694 -19T688 -33T678 -40Q671 -40 524 29T234 166L90 235Q83 240 83 250Q83 261 91 266Q664 540 678 540Q681 540 687 534T694 519T687 505Q686 504 417 376L151 250L417 124Q686 -4 687 -5Q694 -11 694 -19Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(4443.6,0)\"><path data-c=\"1D460\" d=\"M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(5190.3,0)\"><path data-c=\"3C\" d=\"M694 -11T694 -19T688 -33T678 -40Q671 -40 524 29T234 166L90 235Q83 240 83 250Q83 261 91 266Q664 540 678 540Q681 540 687 534T694 519T687 505Q686 504 417 376L151 250L417 124Q686 -4 687 -5Q694 -11 694 -19Z\"></path></g><g data-mml-node=\"mn\" transform=\"translate(6246.1,0)\"><path data-c=\"32\" d=\"M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z\"></path></g></g></g></svg></mjx-container></td>\n<td>ä¸ç¨³å®š</td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"4.618ex\" height=\"2.262ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -750 2041 1000\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"mn\" transform=\"translate(1152,0)\"><path data-c=\"31\" d=\"M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(1652,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.023ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"1.061ex\" height=\"1.023ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -442 469 452\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D460\" d=\"M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z\"></path></g></g></g></svg></mjx-container>æ˜¯æ‰€é€‰åˆ†ç»„</td>\n</tr>\n</tbody></table>\n<h3 id=\"æ’å…¥\"><a href=\"#æ’å…¥\" class=\"headerlink\" title=\"æ’å…¥\"></a>æ’å…¥</h3><p>å°†å¾…æ’åºåºåˆ—ç¬¬ä¸€ä¸ªå…ƒç´ çœ‹åšä¸€ä¸ªæœ‰åºåºåˆ—ï¼ŒæŠŠç¬¬äºŒä¸ªå…ƒç´ åˆ°æœ€åä¸€ä¸ªå…ƒç´ å½“æˆæ˜¯æœªæ’åºåºåˆ—ã€‚</p>\n<p>ä»å¤´åˆ°å°¾ä¾æ¬¡æ‰«ææœªæ’åºåºåˆ—ï¼Œå°†æ‰«æåˆ°çš„æ¯ä¸ªå…ƒç´ æ’å…¥æœ‰åºåºåˆ—çš„é€‚å½“ä½ç½®ã€‚ï¼ˆå¦‚æœå¾…æ’å…¥çš„å…ƒç´ ä¸æœ‰åºåºåˆ—ä¸­çš„æŸä¸ªå…ƒç´ ç›¸ç­‰ï¼Œåˆ™å°†å¾…æ’å…¥å…ƒç´ æ’å…¥åˆ°ç›¸ç­‰å…ƒç´ çš„åé¢ã€‚ï¼‰</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/insertionSort.gif\" alt=\"æ’å…¥æ’åº\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * ä»ç¬¬äºŒä¸ªå…ƒç´ å¼€å§‹ï¼Œæ’å…¥åˆ°å‰é¢å·²ç»æœ‰åºçš„åºåˆ—ä¸­ï¼Œå³æ‰¾åˆ°åºåˆ—ä¸­ç¬¬ä¸€ä¸ªå°äºç­‰äºå½“å‰å…ƒç´ çš„ï¼Œå°†è¿™ä»¥åçš„å…ƒç´ éƒ½</span></span><br><span class=\"line\"><span class=\"comment\">  * å‘åç§»ä¸€ä½ï¼Œç„¶åå°†å½“å‰å…ƒç´ æ’å…¥åˆ°è¿™ä¸ªä½ç½®ä¸­</span></span><br><span class=\"line\"><span class=\"comment\">  *</span></span><br><span class=\"line\"><span class=\"comment\">  * <span class=\"doctag\">@param</span> arr</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">insertionSort</span><span class=\"params\">(<span class=\"type\">int</span>[] arr)</span> {</span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">       0 1 2 ...i-1 i i+1 ... n-1</span></span><br><span class=\"line\"><span class=\"comment\">       å¯¹äºä¸‹æ ‡ i,[0, i-1]æ­¤æ—¶å·²ç»æœ‰åºï¼Œå°†iæ’å…¥åˆ°[0, i-1]ä¸­</span></span><br><span class=\"line\"><span class=\"comment\">       å…·ä½“æ“ä½œæ˜¯æ‰¾åˆ°iåº”è¯¥æ’å…¥çš„ä¸‹æ ‡idxï¼Œå°†[idx, i-1]çš„å…ƒç´ åç§»ï¼Œ</span></span><br><span class=\"line\"><span class=\"comment\">       å°†iå…ƒç´ æ”¾åˆ°idx+1(æœ€åä¸€ä¸ªæ¯”æ–°å…ƒç´ æ›´å¤§çš„ä½ç½®æ˜¯ä¸‹æ ‡idxï¼Œä½†æ˜¯å¾ªç¯ä¸­idxæœ€åä¸€æ¬¡è¿˜æ˜¯ä¼šå¾€å·¦å‡ä¸€</span></span><br><span class=\"line\"><span class=\"comment\">       å› æ­¤è¦æ”¾åˆ°idx+1å¤„</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">n</span> <span class=\"operator\">=</span> arr.length;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; n; i++) {</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">cur_val</span> <span class=\"operator\">=</span> arr[i];</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">idx</span> <span class=\"operator\">=</span> i - <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (idx &gt;= <span class=\"number\">0</span> &amp;&amp; arr[idx] &gt; cur_val) {</span><br><span class=\"line\">            arr[idx + <span class=\"number\">1</span>] = arr[idx];</span><br><span class=\"line\">            idx--;</span><br><span class=\"line\">        }</span><br><span class=\"line\">        arr[idx + <span class=\"number\">1</span>] = cur_val;</span><br><span class=\"line\">    }</span><br><span class=\"line\">}</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"å†’æ³¡\"><a href=\"#å†’æ³¡\" class=\"headerlink\" title=\"å†’æ³¡\"></a>å†’æ³¡</h3><p>æ¯”è¾ƒç›¸é‚»çš„å…ƒç´ ã€‚å¦‚æœç¬¬ä¸€ä¸ªæ¯”ç¬¬äºŒä¸ªå¤§ï¼Œå°±äº¤æ¢ä»–ä»¬ä¸¤ä¸ªã€‚</p>\n<p>å¯¹æ¯ä¸€å¯¹ç›¸é‚»å…ƒç´ ä½œåŒæ ·çš„å·¥ä½œï¼Œä»å¼€å§‹ç¬¬ä¸€å¯¹åˆ°ç»“å°¾çš„æœ€åä¸€å¯¹ã€‚è¿™æ­¥åšå®Œåï¼Œæœ€åçš„å…ƒç´ ä¼šæ˜¯æœ€å¤§çš„æ•°ã€‚</p>\n<p>é’ˆå¯¹æ‰€æœ‰çš„å…ƒç´ é‡å¤ä»¥ä¸Šçš„æ­¥éª¤ï¼Œé™¤äº†æœ€åä¸€ä¸ªã€‚</p>\n<p>æŒç»­æ¯æ¬¡å¯¹è¶Šæ¥è¶Šå°‘çš„å…ƒç´ é‡å¤ä¸Šé¢çš„æ­¥éª¤ï¼Œç›´åˆ°æ²¡æœ‰ä»»ä½•ä¸€å¯¹æ•°å­—éœ€è¦æ¯”è¾ƒã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/bubbleSort.gif\" alt=\"å†’æ³¡æ’åº\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * ä¸€å…±nä¸ªå…ƒç´ ï¼Œæ¯è½®å°†ä¸€ä¸ªå…ƒç´ å†’æ³¡åˆ°æœ€åçš„ä½ç½®</span></span><br><span class=\"line\"><span class=\"comment\">  * å¯¹äºç¬¬iè½®ï¼Œéœ€è¦å†’æ³¡ä¸€ä¸ªå…ƒç´ åˆ°ç¬¬n-1-içš„ä½ç½®ï¼Œå› æ­¤éœ€è¦ä»[0,1],[1,2], ..., [n-1-i-1,n-1-i]æ¯æ¬¡å°†è¾ƒå¤§çš„å…ƒç´ å¾€åæ”¾</span></span><br><span class=\"line\"><span class=\"comment\">  * ä¸ºäº†ä¼˜åŒ–å·²ç»æœ‰åºçš„æƒ…å†µï¼Œå¯ä»¥è®¾ç½®flagè®°å½•æ˜¯å¦å·²ç»æœ‰åº</span></span><br><span class=\"line\"><span class=\"comment\">  * å¦‚æœå½“è½®å­˜åœ¨äº¤æ¢åˆ™å°†flagç½®ä¸ºfalseè¡¨ç¤ºæœªæœ‰åºï¼Œå¦‚æœflagä¸ºtrueè¯´æ˜å‰é¢çš„å…ƒç´ å·²ç»æœ‰åºäº†</span></span><br><span class=\"line\"><span class=\"comment\">  *</span></span><br><span class=\"line\"><span class=\"comment\">  * <span class=\"doctag\">@param</span> arr</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">bubbleSort</span><span class=\"params\">(<span class=\"type\">int</span>[] arr)</span> {</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">n</span> <span class=\"operator\">=</span> arr.length;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; n; i++) {       <span class=\"comment\">// æ¯è½®å°†ä¸€ä¸ªæœ€å¤§çš„å…ƒç´ æ²‰åˆ°æœ€å</span></span><br><span class=\"line\">            <span class=\"type\">boolean</span> <span class=\"variable\">flag</span> <span class=\"operator\">=</span> <span class=\"literal\">true</span>;            <span class=\"comment\">// å½“å‰è½®æ˜¯å¦æœ‰åº</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">j</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; j &lt; n - <span class=\"number\">1</span> - i; j++) {</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (arr[j] &gt; arr[j + <span class=\"number\">1</span>]) {</span><br><span class=\"line\">                    flag = <span class=\"literal\">false</span>;           <span class=\"comment\">// æœªæœ‰åº</span></span><br><span class=\"line\">                    <span class=\"type\">int</span> <span class=\"variable\">temp</span> <span class=\"operator\">=</span> arr[j];</span><br><span class=\"line\">                    arr[j] = arr[j + <span class=\"number\">1</span>];</span><br><span class=\"line\">                    arr[j + <span class=\"number\">1</span>] = temp;   </span><br><span class=\"line\">                }</span><br><span class=\"line\">            }</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (flag) <span class=\"keyword\">break</span>;                <span class=\"comment\">// æœ‰åº</span></span><br><span class=\"line\">        }</span><br><span class=\"line\">    }</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"é€‰æ‹©\"><a href=\"#é€‰æ‹©\" class=\"headerlink\" title=\"é€‰æ‹©\"></a>é€‰æ‹©</h3><p>é¦–å…ˆåœ¨æœªæ’åºåºåˆ—ä¸­æ‰¾åˆ°æœ€å°ï¼ˆå¤§ï¼‰å…ƒç´ ï¼Œå­˜æ”¾åˆ°æ’åºåºåˆ—çš„èµ·å§‹ä½ç½®ã€‚</p>\n<p>å†ä»å‰©ä½™æœªæ’åºå…ƒç´ ä¸­ç»§ç»­å¯»æ‰¾æœ€å°ï¼ˆå¤§ï¼‰å…ƒç´ ï¼Œç„¶åæ”¾åˆ°å·²æ’åºåºåˆ—çš„æœ«å°¾ã€‚</p>\n<p>é‡å¤ç¬¬äºŒæ­¥ï¼Œç›´åˆ°æ‰€æœ‰å…ƒç´ å‡æ’åºå®Œæ¯•ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/selectionSort.gif\" alt=\"é€‰æ‹©æ’åº\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * å¯¹äºæ¯ä¸ªä½ç½®æˆ‘ä»¬æ’å…¥å…¶åº”å½“æœ‰çš„å…ƒç´ ï¼Œå³å¯¹äºç¬¬0ä½ç½®çš„å…ƒç´ ï¼Œæˆ‘ä»¬æ‰¾åˆ°æœ€å°çš„ç„¶åå’Œè¿™ä¸ªä½ç½®çš„å…ƒç´ è¿›è¡Œäº¤æ¢</span></span><br><span class=\"line\"><span class=\"comment\">  *</span></span><br><span class=\"line\"><span class=\"comment\">  * <span class=\"doctag\">@param</span> arr</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">selectionSort</span><span class=\"params\">(<span class=\"type\">int</span>[] arr)</span> {</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">n</span> <span class=\"operator\">=</span> arr.length;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; n; i++) {</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">min_index</span> <span class=\"operator\">=</span> i;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">j</span> <span class=\"operator\">=</span> i; j &lt; n; j++) {</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (arr[j] &lt; arr[min_index]) {</span><br><span class=\"line\">                min_index = j;</span><br><span class=\"line\">            }</span><br><span class=\"line\">        }</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">temp</span> <span class=\"operator\">=</span> arr[i];</span><br><span class=\"line\">        arr[i] = arr[min_index];</span><br><span class=\"line\">        arr[min_index] = temp;</span><br><span class=\"line\">    }</span><br><span class=\"line\">}</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"å¿«æ’\"><a href=\"#å¿«æ’\" class=\"headerlink\" title=\"å¿«æ’\"></a>å¿«æ’</h3><ol>\n<li>ä»æ•°åˆ—ä¸­æŒ‘å‡ºä¸€ä¸ªå…ƒç´ ï¼Œç§°ä¸º â€œåŸºå‡†â€ï¼ˆpivotï¼‰;</li>\n<li>é‡æ–°æ’åºæ•°åˆ—ï¼Œæ‰€æœ‰å…ƒç´ æ¯”åŸºå‡†å€¼å°çš„æ‘†æ”¾åœ¨åŸºå‡†å‰é¢ï¼Œæ‰€æœ‰å…ƒç´ æ¯”åŸºå‡†å€¼å¤§çš„æ‘†åœ¨åŸºå‡†çš„åé¢ï¼ˆç›¸åŒçš„æ•°å¯ä»¥åˆ°ä»»ä¸€è¾¹ï¼‰ã€‚åœ¨è¿™ä¸ªåˆ†åŒºé€€å‡ºä¹‹åï¼Œè¯¥åŸºå‡†å°±å¤„äºæ•°åˆ—çš„ä¸­é—´ä½ç½®ã€‚è¿™ä¸ªç§°ä¸ºåˆ†åŒºï¼ˆpartitionï¼‰æ“ä½œï¼›</li>\n<li>é€’å½’åœ°ï¼ˆrecursiveï¼‰æŠŠå°äºåŸºå‡†å€¼å…ƒç´ çš„å­æ•°åˆ—å’Œå¤§äºåŸºå‡†å€¼å…ƒç´ çš„å­æ•°åˆ—æ’åºï¼›</li>\n</ol>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/quickSort-20221125182030127.gif\" alt=\"å¿«é€Ÿæ’åº\"></p>\n<p>é€’å½’ç‰ˆæœ¬ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">quickSort</span><span class=\"params\">(<span class=\"type\">int</span>[] arr)</span> {</span><br><span class=\"line\">    quickSortRange(arr, <span class=\"number\">0</span>, arr.length - <span class=\"number\">1</span>);</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">quickSortRange</span><span class=\"params\">(<span class=\"type\">int</span>[] arr, <span class=\"type\">int</span> left, <span class=\"type\">int</span> right)</span> {</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (left &lt; right) {</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">mid</span> <span class=\"operator\">=</span> partition(arr, left, right);</span><br><span class=\"line\">        quickSortRange(arr, left, mid - <span class=\"number\">1</span>);</span><br><span class=\"line\">        quickSortRange(arr, mid + <span class=\"number\">1</span>, right);</span><br><span class=\"line\">    }</span><br><span class=\"line\"></span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"type\">int</span> <span class=\"title function_\">partition</span><span class=\"params\">(<span class=\"type\">int</span>[] arr, <span class=\"type\">int</span> left, <span class=\"type\">int</span> right)</span> {</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">pivot</span> <span class=\"operator\">=</span> arr[left];</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (left &lt; right) {</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (left &lt; right &amp;&amp; arr[right] &gt;= pivot) {</span><br><span class=\"line\">            right--;</span><br><span class=\"line\">        }</span><br><span class=\"line\">        arr[left] = arr[right];</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (left &lt; right &amp;&amp; arr[left] &lt;= pivot) {</span><br><span class=\"line\">            left++;</span><br><span class=\"line\">        }</span><br><span class=\"line\">        arr[right] = arr[left];</span><br><span class=\"line\">    }</span><br><span class=\"line\">    arr[left] = pivot;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> left;</span><br><span class=\"line\">}</span><br></pre></td></tr></table></figure>\n\n<p>éé€’å½’ç‰ˆæœ¬ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> {</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">quickSort</span><span class=\"params\">(<span class=\"type\">int</span>[] nums)</span> {</span><br><span class=\"line\">        stackQuickSort(nums, <span class=\"number\">0</span>, nums.length - <span class=\"number\">1</span>);</span><br><span class=\"line\">    }</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">stackQuickSort</span><span class=\"params\">(<span class=\"type\">int</span>[] nums, <span class=\"type\">int</span> left, <span class=\"type\">int</span> right)</span> {</span><br><span class=\"line\">        Deque&lt;Integer&gt; stack = <span class=\"keyword\">new</span> <span class=\"title class_\">LinkedList</span>&lt;&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (left &lt; right) {</span><br><span class=\"line\">            stack.push(right);</span><br><span class=\"line\">            stack.push(left);</span><br><span class=\"line\">        }</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (!stack.isEmpty()) {</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">l</span> <span class=\"operator\">=</span> stack.pop();</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">r</span> <span class=\"operator\">=</span> stack.pop();</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">mid</span> <span class=\"operator\">=</span> partition(nums, l, r);</span><br><span class=\"line\">            <span class=\"comment\">// å¾—åˆ°midååˆ’åˆ†ä¸º [l, mid - 1] mid [mid + 1, r]</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (l &lt; mid - <span class=\"number\">1</span>) {</span><br><span class=\"line\">                stack.push(mid - <span class=\"number\">1</span>);</span><br><span class=\"line\">                stack.push(l);</span><br><span class=\"line\">            }</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (r &gt; mid + <span class=\"number\">1</span>) {</span><br><span class=\"line\">                stack.push(r);</span><br><span class=\"line\">                stack.push(mid + <span class=\"number\">1</span>);</span><br><span class=\"line\">            }</span><br><span class=\"line\">        }</span><br><span class=\"line\">    }</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> <span class=\"title function_\">partition</span><span class=\"params\">(<span class=\"type\">int</span>[] nums, <span class=\"type\">int</span> left, <span class=\"type\">int</span> right)</span> {</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">pivot</span> <span class=\"operator\">=</span> nums[left];</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (left &lt; right) {</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (left &lt; right &amp;&amp; nums[right] &gt;= pivot) {</span><br><span class=\"line\">                right--;</span><br><span class=\"line\">            }</span><br><span class=\"line\">            nums[left] = nums[right];</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (left &lt; right &amp;&amp; nums[left] &lt;= pivot) {</span><br><span class=\"line\">                left++;</span><br><span class=\"line\">            }</span><br><span class=\"line\">            nums[right] = nums[left];</span><br><span class=\"line\">        }</span><br><span class=\"line\">        nums[left] = pivot;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> left;</span><br><span class=\"line\">    }</span><br><span class=\"line\">}</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"å †\"><a href=\"#å †\" class=\"headerlink\" title=\"å †\"></a>å †</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">heapSort</span><span class=\"params\">(<span class=\"type\">int</span>[] arr)</span> {</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">len</span> <span class=\"operator\">=</span> arr.length;</span><br><span class=\"line\"></span><br><span class=\"line\">    buildMaxHeap(arr, len);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> len - <span class=\"number\">1</span>; i &gt; <span class=\"number\">0</span>; i--) {</span><br><span class=\"line\">        swap(arr, <span class=\"number\">0</span>, i);</span><br><span class=\"line\">        len--;</span><br><span class=\"line\">        heapify(arr, <span class=\"number\">0</span>, len);</span><br><span class=\"line\">    }</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">buildMaxHeap</span><span class=\"params\">(<span class=\"type\">int</span>[] arr, <span class=\"type\">int</span> len)</span> {</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> len / <span class=\"number\">2</span> - <span class=\"number\">1</span>; i &gt;= <span class=\"number\">0</span>; i--) {</span><br><span class=\"line\">        heapify(arr, i, len);</span><br><span class=\"line\">    }</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">heapify</span><span class=\"params\">(<span class=\"type\">int</span>[] arr, <span class=\"type\">int</span> i, <span class=\"type\">int</span> len)</span> {</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>) {</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">left</span> <span class=\"operator\">=</span> <span class=\"number\">2</span> * i + <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">right</span> <span class=\"operator\">=</span> <span class=\"number\">2</span> * i + <span class=\"number\">2</span>;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">largest</span> <span class=\"operator\">=</span> i;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (left &lt; len &amp;&amp; arr[left] &gt; arr[largest]) {</span><br><span class=\"line\">            largest = left;</span><br><span class=\"line\">        }</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (right &lt; len &amp;&amp; arr[right] &gt; arr[largest]) {</span><br><span class=\"line\">            largest = right;</span><br><span class=\"line\">        }</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (largest == i) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        swap(arr, i, largest);</span><br><span class=\"line\">        i = largest;</span><br><span class=\"line\">    }</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">swap</span><span class=\"params\">(<span class=\"type\">int</span>[] arr, <span class=\"type\">int</span> i, <span class=\"type\">int</span> j)</span> {</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">temp</span> <span class=\"operator\">=</span> arr[i];</span><br><span class=\"line\">    arr[i] = arr[j];</span><br><span class=\"line\">    arr[j] = temp;</span><br><span class=\"line\">}</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"å½’å¹¶\"><a href=\"#å½’å¹¶\" class=\"headerlink\" title=\"å½’å¹¶\"></a>å½’å¹¶</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t* å½’å¹¶æ’åº</span></span><br><span class=\"line\"><span class=\"comment\">  * <span class=\"doctag\">@param</span> arr</span></span><br><span class=\"line\"><span class=\"comment\">  * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"type\">int</span>[] mergeSort(<span class=\"type\">int</span>[] arr) {</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (arr == <span class=\"literal\">null</span> || arr.length &lt;= <span class=\"number\">1</span>) <span class=\"keyword\">return</span> arr;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">n</span> <span class=\"operator\">=</span> arr.length;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">mid</span> <span class=\"operator\">=</span> n / <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span>[] left = Arrays.copyOfRange(arr, <span class=\"number\">0</span>, mid);</span><br><span class=\"line\">    <span class=\"type\">int</span>[] right = Arrays.copyOfRange(arr, mid, n);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> merge(mergeSort(left), mergeSort(right));</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"type\">int</span>[] merge(<span class=\"type\">int</span>[] a, <span class=\"type\">int</span>[] b) {</span><br><span class=\"line\">    <span class=\"type\">int</span>[] res = <span class=\"keyword\">new</span> <span class=\"title class_\">int</span>[a.length + b.length];</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>, j = <span class=\"number\">0</span>, ind = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (i &lt; a.length &amp;&amp; j &lt; b.length) {</span><br><span class=\"line\">        res[ind++] = (a[i] &lt; b[j]) ? a[i++] : b[j++];</span><br><span class=\"line\">    }</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (i &lt; a.length) {</span><br><span class=\"line\">        res[ind++] = a[i++];</span><br><span class=\"line\">    }</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (j &lt; b.length) {</span><br><span class=\"line\">        res[ind++] = b[j++];</span><br><span class=\"line\">    }</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">}</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"å¸Œå°”\"><a href=\"#å¸Œå°”\" class=\"headerlink\" title=\"å¸Œå°”\"></a>å¸Œå°”</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t* å¸Œå°”æ’åºï¼Œå‡å¢é‡æ’åºç®—æ³•ï¼Œæ˜¯æ’å…¥æ’åºçš„ä¸€ç§æ›´é«˜æ•ˆçš„æ”¹è¿›ç‰ˆæœ¬ã€‚ä½†å¸Œå°”æ’åºæ˜¯éç¨³å®šæ’åºç®—æ³•ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">\t* <span class=\"doctag\">@param</span> arr</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">shellSort</span><span class=\"params\">(<span class=\"type\">int</span>[] arr)</span> {</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">n</span> <span class=\"operator\">=</span> arr.length;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">gap</span> <span class=\"operator\">=</span> n / <span class=\"number\">2</span>; gap &gt; <span class=\"number\">0</span>; gap /= <span class=\"number\">2</span>) {</span><br><span class=\"line\">        <span class=\"comment\">// {i, i+gap, i+2gap, ...}</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; n; i++) {</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">cur_val</span> <span class=\"operator\">=</span> arr[i];</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">idx</span> <span class=\"operator\">=</span> i - gap;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (idx &gt;= <span class=\"number\">0</span> &amp;&amp; arr[idx] &gt; cur_val) {</span><br><span class=\"line\">                arr[idx + gap] = arr[idx];</span><br><span class=\"line\">                idx -= gap;</span><br><span class=\"line\">            }</span><br><span class=\"line\">            arr[idx + gap] = cur_val;</span><br><span class=\"line\">        }</span><br><span class=\"line\">    }</span><br><span class=\"line\">}</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"length":5576,"excerpt":"<p>å…«å¤§æ’åºç®—æ³•çš„ä»£ç å®ç°å’Œæ—¶ç©ºå¤æ‚åº¦æ¯”è¾ƒã€‚","more":"</p>\n<table>\n<thead>\n<tr>\n<th>æ’åºæ³•</th>\n<th>å¹³å‡æ—¶é—´</th>\n<th>æœ€å·®æƒ…å½¢</th>\n<th>ç¨³å®šåº¦</th>\n<th>é¢å¤–ç©ºé—´</th>\n<th>å¤‡æ³¨</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>â­æ’å…¥</td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"5.832ex\" height=\"2.452ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -833.9 2577.6 1083.9\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"msup\" transform=\"translate(1152,0)\"><g data-mml-node=\"mi\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mn\" transform=\"translate(633,363) scale(0.707)\"><path data-c=\"32\" d=\"M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z\"></path></g></g><g data-mml-node=\"mo\" transform=\"translate(2188.6,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"5.832ex\" height=\"2.452ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -833.9 2577.6 1083.9\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"msup\" transform=\"translate(1152,0)\"><g data-mml-node=\"mi\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mn\" transform=\"translate(633,363) scale(0.707)\"><path data-c=\"32\" d=\"M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z\"></path></g></g><g data-mml-node=\"mo\" transform=\"translate(2188.6,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td>ç¨³å®š</td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"4.618ex\" height=\"2.262ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -750 2041 1000\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"mn\" transform=\"translate(1152,0)\"><path data-c=\"31\" d=\"M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(1652,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td>å¤§éƒ¨åˆ†å·²æ’åºæ—¶è¾ƒå¥½</td>\n</tr>\n<tr>\n<td>â­å†’æ³¡</td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"5.832ex\" height=\"2.452ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -833.9 2577.6 1083.9\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"msup\" transform=\"translate(1152,0)\"><g data-mml-node=\"mi\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mn\" transform=\"translate(633,363) scale(0.707)\"><path data-c=\"32\" d=\"M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z\"></path></g></g><g data-mml-node=\"mo\" transform=\"translate(2188.6,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"5.832ex\" height=\"2.452ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -833.9 2577.6 1083.9\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"msup\" transform=\"translate(1152,0)\"><g data-mml-node=\"mi\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mn\" transform=\"translate(633,363) scale(0.707)\"><path data-c=\"32\" d=\"M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z\"></path></g></g><g data-mml-node=\"mo\" transform=\"translate(2188.6,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td>ç¨³å®š</td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"4.618ex\" height=\"2.262ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -750 2041 1000\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"mn\" transform=\"translate(1152,0)\"><path data-c=\"31\" d=\"M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(1652,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.025ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"1.357ex\" height=\"1.025ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -442 600 453\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g></g></g></svg></mjx-container>å°æ—¶è¾ƒå¥½</td>\n</tr>\n<tr>\n<td>â­é€‰æ‹©</td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"5.832ex\" height=\"2.452ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -833.9 2577.6 1083.9\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"msup\" transform=\"translate(1152,0)\"><g data-mml-node=\"mi\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mn\" transform=\"translate(633,363) scale(0.707)\"><path data-c=\"32\" d=\"M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z\"></path></g></g><g data-mml-node=\"mo\" transform=\"translate(2188.6,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"5.832ex\" height=\"2.452ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -833.9 2577.6 1083.9\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"msup\" transform=\"translate(1152,0)\"><g data-mml-node=\"mi\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mn\" transform=\"translate(633,363) scale(0.707)\"><path data-c=\"32\" d=\"M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z\"></path></g></g><g data-mml-node=\"mo\" transform=\"translate(2188.6,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td>ä¸ç¨³å®š</td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"4.618ex\" height=\"2.262ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -750 2041 1000\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"mn\" transform=\"translate(1152,0)\"><path data-c=\"31\" d=\"M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(1652,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.025ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"1.357ex\" height=\"1.025ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -442 600 453\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g></g></g></svg></mjx-container>å°æ—¶è¾ƒå¥½</td>\n</tr>\n<tr>\n<td>â­å¿«æ’</td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"9.052ex\" height=\"2.262ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -750 4001 1000\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1152,0)\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1752,0)\"><path data-c=\"1D459\" d=\"M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(2050,0)\"><path data-c=\"1D45C\" d=\"M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(2535,0)\"><path data-c=\"1D454\" d=\"M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(3012,0)\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(3612,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"5.832ex\" height=\"2.452ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -833.9 2577.6 1083.9\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"msup\" transform=\"translate(1152,0)\"><g data-mml-node=\"mi\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mn\" transform=\"translate(633,363) scale(0.707)\"><path data-c=\"32\" d=\"M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z\"></path></g></g><g data-mml-node=\"mo\" transform=\"translate(2188.6,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td>ä¸ç¨³å®š</td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"9.052ex\" height=\"2.262ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -750 4001 1000\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1152,0)\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1752,0)\"><path data-c=\"1D459\" d=\"M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(2050,0)\"><path data-c=\"1D45C\" d=\"M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(2535,0)\"><path data-c=\"1D454\" d=\"M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(3012,0)\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(3612,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.025ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"1.357ex\" height=\"1.025ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -442 600 453\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g></g></g></svg></mjx-container>å¤§æ—¶è¾ƒå¥½</td>\n</tr>\n<tr>\n<td>â­å †</td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"9.052ex\" height=\"2.262ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -750 4001 1000\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1152,0)\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1752,0)\"><path data-c=\"1D459\" d=\"M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(2050,0)\"><path data-c=\"1D45C\" d=\"M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(2535,0)\"><path data-c=\"1D454\" d=\"M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(3012,0)\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(3612,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"9.052ex\" height=\"2.262ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -750 4001 1000\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1152,0)\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1752,0)\"><path data-c=\"1D459\" d=\"M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(2050,0)\"><path data-c=\"1D45C\" d=\"M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(2535,0)\"><path data-c=\"1D454\" d=\"M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(3012,0)\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(3612,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td>ä¸ç¨³å®š</td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"4.618ex\" height=\"2.262ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -750 2041 1000\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"mn\" transform=\"translate(1152,0)\"><path data-c=\"31\" d=\"M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(1652,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.025ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"1.357ex\" height=\"1.025ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -442 600 453\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g></g></g></svg></mjx-container>å¤§æ—¶è¾ƒå¥½</td>\n</tr>\n<tr>\n<td>â­å½’å¹¶</td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"9.052ex\" height=\"2.262ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -750 4001 1000\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1152,0)\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1752,0)\"><path data-c=\"1D459\" d=\"M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(2050,0)\"><path data-c=\"1D45C\" d=\"M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(2535,0)\"><path data-c=\"1D454\" d=\"M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(3012,0)\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(3612,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"9.052ex\" height=\"2.262ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -750 4001 1000\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1152,0)\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1752,0)\"><path data-c=\"1D459\" d=\"M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(2050,0)\"><path data-c=\"1D45C\" d=\"M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(2535,0)\"><path data-c=\"1D454\" d=\"M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(3012,0)\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(3612,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td>ç¨³å®š</td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"4.618ex\" height=\"2.262ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -750 2041 1000\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"mn\" transform=\"translate(1152,0)\"><path data-c=\"31\" d=\"M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(1652,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.025ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"1.357ex\" height=\"1.025ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -442 600 453\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g></g></g></svg></mjx-container>å¤§æ—¶è¾ƒå¥½</td>\n</tr>\n<tr>\n<td>åŸºæ•°</td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"9.771ex\" height=\"2.262ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -750 4319 1000\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1152,0)\"><path data-c=\"1D459\" d=\"M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1450,0)\"><path data-c=\"1D45C\" d=\"M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1935,0)\"><path data-c=\"1D454\" d=\"M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(2412,0)\"><path data-c=\"1D445\" d=\"M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(3171,0)\"><path data-c=\"1D435\" d=\"M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(3930,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"9.771ex\" height=\"2.262ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -750 4319 1000\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1152,0)\"><path data-c=\"1D459\" d=\"M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1450,0)\"><path data-c=\"1D45C\" d=\"M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1935,0)\"><path data-c=\"1D454\" d=\"M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(2412,0)\"><path data-c=\"1D445\" d=\"M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(3171,0)\"><path data-c=\"1D435\" d=\"M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(3930,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td>ç¨³å®š</td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"4.618ex\" height=\"2.262ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -750 2041 1000\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"mn\" transform=\"translate(1152,0)\"><path data-c=\"31\" d=\"M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(1652,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: 0;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"1.717ex\" height=\"1.545ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -683 759 683\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D435\" d=\"M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z\"></path></g></g></g></svg></mjx-container>æ˜¯çœŸæ•°(0-9)ï¼Œ<mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.048ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"1.717ex\" height=\"1.593ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -683 759 704\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D445\" d=\"M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z\"></path></g></g></g></svg></mjx-container>æ˜¯åŸºæ•°(ä¸ªåç™¾)</td>\n</tr>\n<tr>\n<td>å¸Œå°”</td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"9.052ex\" height=\"2.262ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -750 4001 1000\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1152,0)\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1752,0)\"><path data-c=\"1D459\" d=\"M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(2050,0)\"><path data-c=\"1D45C\" d=\"M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(2535,0)\"><path data-c=\"1D454\" d=\"M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(3012,0)\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(3612,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"15.263ex\" height=\"2.262ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -750 6746.1 1000\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1152,0)\"><path data-c=\"1D45B\" d=\"M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(1752,0)\"><path data-c=\"1D460\" d=\"M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(2221,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g><g data-mml-node=\"mn\" transform=\"translate(2610,0)\"><path data-c=\"31\" d=\"M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(3387.8,0)\"><path data-c=\"3C\" d=\"M694 -11T694 -19T688 -33T678 -40Q671 -40 524 29T234 166L90 235Q83 240 83 250Q83 261 91 266Q664 540 678 540Q681 540 687 534T694 519T687 505Q686 504 417 376L151 250L417 124Q686 -4 687 -5Q694 -11 694 -19Z\"></path></g><g data-mml-node=\"mi\" transform=\"translate(4443.6,0)\"><path data-c=\"1D460\" d=\"M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(5190.3,0)\"><path data-c=\"3C\" d=\"M694 -11T694 -19T688 -33T678 -40Q671 -40 524 29T234 166L90 235Q83 240 83 250Q83 261 91 266Q664 540 678 540Q681 540 687 534T694 519T687 505Q686 504 417 376L151 250L417 124Q686 -4 687 -5Q694 -11 694 -19Z\"></path></g><g data-mml-node=\"mn\" transform=\"translate(6246.1,0)\"><path data-c=\"32\" d=\"M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z\"></path></g></g></g></svg></mjx-container></td>\n<td>ä¸ç¨³å®š</td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.566ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"4.618ex\" height=\"2.262ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -750 2041 1000\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D442\" d=\"M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(763,0)\"><path data-c=\"28\" d=\"M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z\"></path></g><g data-mml-node=\"mn\" transform=\"translate(1152,0)\"><path data-c=\"31\" d=\"M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z\"></path></g><g data-mml-node=\"mo\" transform=\"translate(1652,0)\"><path data-c=\"29\" d=\"M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z\"></path></g></g></g></svg></mjx-container></td>\n<td><mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.023ex;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"1.061ex\" height=\"1.023ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -442 469 452\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D460\" d=\"M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z\"></path></g></g></g></svg></mjx-container>æ˜¯æ‰€é€‰åˆ†ç»„</td>\n</tr>\n</tbody></table>\n<h3 id=\"æ’å…¥\"><a href=\"#æ’å…¥\" class=\"headerlink\" title=\"æ’å…¥\"></a>æ’å…¥</h3><p>å°†å¾…æ’åºåºåˆ—ç¬¬ä¸€ä¸ªå…ƒç´ çœ‹åšä¸€ä¸ªæœ‰åºåºåˆ—ï¼ŒæŠŠç¬¬äºŒä¸ªå…ƒç´ åˆ°æœ€åä¸€ä¸ªå…ƒç´ å½“æˆæ˜¯æœªæ’åºåºåˆ—ã€‚</p>\n<p>ä»å¤´åˆ°å°¾ä¾æ¬¡æ‰«ææœªæ’åºåºåˆ—ï¼Œå°†æ‰«æåˆ°çš„æ¯ä¸ªå…ƒç´ æ’å…¥æœ‰åºåºåˆ—çš„é€‚å½“ä½ç½®ã€‚ï¼ˆå¦‚æœå¾…æ’å…¥çš„å…ƒç´ ä¸æœ‰åºåºåˆ—ä¸­çš„æŸä¸ªå…ƒç´ ç›¸ç­‰ï¼Œåˆ™å°†å¾…æ’å…¥å…ƒç´ æ’å…¥åˆ°ç›¸ç­‰å…ƒç´ çš„åé¢ã€‚ï¼‰</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/insertionSort.gif\" alt=\"æ’å…¥æ’åº\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * ä»ç¬¬äºŒä¸ªå…ƒç´ å¼€å§‹ï¼Œæ’å…¥åˆ°å‰é¢å·²ç»æœ‰åºçš„åºåˆ—ä¸­ï¼Œå³æ‰¾åˆ°åºåˆ—ä¸­ç¬¬ä¸€ä¸ªå°äºç­‰äºå½“å‰å…ƒç´ çš„ï¼Œå°†è¿™ä»¥åçš„å…ƒç´ éƒ½</span></span><br><span class=\"line\"><span class=\"comment\">  * å‘åç§»ä¸€ä½ï¼Œç„¶åå°†å½“å‰å…ƒç´ æ’å…¥åˆ°è¿™ä¸ªä½ç½®ä¸­</span></span><br><span class=\"line\"><span class=\"comment\">  *</span></span><br><span class=\"line\"><span class=\"comment\">  * <span class=\"doctag\">@param</span> arr</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">insertionSort</span><span class=\"params\">(<span class=\"type\">int</span>[] arr)</span> {</span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">       0 1 2 ...i-1 i i+1 ... n-1</span></span><br><span class=\"line\"><span class=\"comment\">       å¯¹äºä¸‹æ ‡ i,[0, i-1]æ­¤æ—¶å·²ç»æœ‰åºï¼Œå°†iæ’å…¥åˆ°[0, i-1]ä¸­</span></span><br><span class=\"line\"><span class=\"comment\">       å…·ä½“æ“ä½œæ˜¯æ‰¾åˆ°iåº”è¯¥æ’å…¥çš„ä¸‹æ ‡idxï¼Œå°†[idx, i-1]çš„å…ƒç´ åç§»ï¼Œ</span></span><br><span class=\"line\"><span class=\"comment\">       å°†iå…ƒç´ æ”¾åˆ°idx+1(æœ€åä¸€ä¸ªæ¯”æ–°å…ƒç´ æ›´å¤§çš„ä½ç½®æ˜¯ä¸‹æ ‡idxï¼Œä½†æ˜¯å¾ªç¯ä¸­idxæœ€åä¸€æ¬¡è¿˜æ˜¯ä¼šå¾€å·¦å‡ä¸€</span></span><br><span class=\"line\"><span class=\"comment\">       å› æ­¤è¦æ”¾åˆ°idx+1å¤„</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">n</span> <span class=\"operator\">=</span> arr.length;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; n; i++) {</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">cur_val</span> <span class=\"operator\">=</span> arr[i];</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">idx</span> <span class=\"operator\">=</span> i - <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (idx &gt;= <span class=\"number\">0</span> &amp;&amp; arr[idx] &gt; cur_val) {</span><br><span class=\"line\">            arr[idx + <span class=\"number\">1</span>] = arr[idx];</span><br><span class=\"line\">            idx--;</span><br><span class=\"line\">        }</span><br><span class=\"line\">        arr[idx + <span class=\"number\">1</span>] = cur_val;</span><br><span class=\"line\">    }</span><br><span class=\"line\">}</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"å†’æ³¡\"><a href=\"#å†’æ³¡\" class=\"headerlink\" title=\"å†’æ³¡\"></a>å†’æ³¡</h3><p>æ¯”è¾ƒç›¸é‚»çš„å…ƒç´ ã€‚å¦‚æœç¬¬ä¸€ä¸ªæ¯”ç¬¬äºŒä¸ªå¤§ï¼Œå°±äº¤æ¢ä»–ä»¬ä¸¤ä¸ªã€‚</p>\n<p>å¯¹æ¯ä¸€å¯¹ç›¸é‚»å…ƒç´ ä½œåŒæ ·çš„å·¥ä½œï¼Œä»å¼€å§‹ç¬¬ä¸€å¯¹åˆ°ç»“å°¾çš„æœ€åä¸€å¯¹ã€‚è¿™æ­¥åšå®Œåï¼Œæœ€åçš„å…ƒç´ ä¼šæ˜¯æœ€å¤§çš„æ•°ã€‚</p>\n<p>é’ˆå¯¹æ‰€æœ‰çš„å…ƒç´ é‡å¤ä»¥ä¸Šçš„æ­¥éª¤ï¼Œé™¤äº†æœ€åä¸€ä¸ªã€‚</p>\n<p>æŒç»­æ¯æ¬¡å¯¹è¶Šæ¥è¶Šå°‘çš„å…ƒç´ é‡å¤ä¸Šé¢çš„æ­¥éª¤ï¼Œç›´åˆ°æ²¡æœ‰ä»»ä½•ä¸€å¯¹æ•°å­—éœ€è¦æ¯”è¾ƒã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/bubbleSort.gif\" alt=\"å†’æ³¡æ’åº\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * ä¸€å…±nä¸ªå…ƒç´ ï¼Œæ¯è½®å°†ä¸€ä¸ªå…ƒç´ å†’æ³¡åˆ°æœ€åçš„ä½ç½®</span></span><br><span class=\"line\"><span class=\"comment\">  * å¯¹äºç¬¬iè½®ï¼Œéœ€è¦å†’æ³¡ä¸€ä¸ªå…ƒç´ åˆ°ç¬¬n-1-içš„ä½ç½®ï¼Œå› æ­¤éœ€è¦ä»[0,1],[1,2], ..., [n-1-i-1,n-1-i]æ¯æ¬¡å°†è¾ƒå¤§çš„å…ƒç´ å¾€åæ”¾</span></span><br><span class=\"line\"><span class=\"comment\">  * ä¸ºäº†ä¼˜åŒ–å·²ç»æœ‰åºçš„æƒ…å†µï¼Œå¯ä»¥è®¾ç½®flagè®°å½•æ˜¯å¦å·²ç»æœ‰åº</span></span><br><span class=\"line\"><span class=\"comment\">  * å¦‚æœå½“è½®å­˜åœ¨äº¤æ¢åˆ™å°†flagç½®ä¸ºfalseè¡¨ç¤ºæœªæœ‰åºï¼Œå¦‚æœflagä¸ºtrueè¯´æ˜å‰é¢çš„å…ƒç´ å·²ç»æœ‰åºäº†</span></span><br><span class=\"line\"><span class=\"comment\">  *</span></span><br><span class=\"line\"><span class=\"comment\">  * <span class=\"doctag\">@param</span> arr</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">bubbleSort</span><span class=\"params\">(<span class=\"type\">int</span>[] arr)</span> {</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">n</span> <span class=\"operator\">=</span> arr.length;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; n; i++) {       <span class=\"comment\">// æ¯è½®å°†ä¸€ä¸ªæœ€å¤§çš„å…ƒç´ æ²‰åˆ°æœ€å</span></span><br><span class=\"line\">            <span class=\"type\">boolean</span> <span class=\"variable\">flag</span> <span class=\"operator\">=</span> <span class=\"literal\">true</span>;            <span class=\"comment\">// å½“å‰è½®æ˜¯å¦æœ‰åº</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">j</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; j &lt; n - <span class=\"number\">1</span> - i; j++) {</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (arr[j] &gt; arr[j + <span class=\"number\">1</span>]) {</span><br><span class=\"line\">                    flag = <span class=\"literal\">false</span>;           <span class=\"comment\">// æœªæœ‰åº</span></span><br><span class=\"line\">                    <span class=\"type\">int</span> <span class=\"variable\">temp</span> <span class=\"operator\">=</span> arr[j];</span><br><span class=\"line\">                    arr[j] = arr[j + <span class=\"number\">1</span>];</span><br><span class=\"line\">                    arr[j + <span class=\"number\">1</span>] = temp;   </span><br><span class=\"line\">                }</span><br><span class=\"line\">            }</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (flag) <span class=\"keyword\">break</span>;                <span class=\"comment\">// æœ‰åº</span></span><br><span class=\"line\">        }</span><br><span class=\"line\">    }</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"é€‰æ‹©\"><a href=\"#é€‰æ‹©\" class=\"headerlink\" title=\"é€‰æ‹©\"></a>é€‰æ‹©</h3><p>é¦–å…ˆåœ¨æœªæ’åºåºåˆ—ä¸­æ‰¾åˆ°æœ€å°ï¼ˆå¤§ï¼‰å…ƒç´ ï¼Œå­˜æ”¾åˆ°æ’åºåºåˆ—çš„èµ·å§‹ä½ç½®ã€‚</p>\n<p>å†ä»å‰©ä½™æœªæ’åºå…ƒç´ ä¸­ç»§ç»­å¯»æ‰¾æœ€å°ï¼ˆå¤§ï¼‰å…ƒç´ ï¼Œç„¶åæ”¾åˆ°å·²æ’åºåºåˆ—çš„æœ«å°¾ã€‚</p>\n<p>é‡å¤ç¬¬äºŒæ­¥ï¼Œç›´åˆ°æ‰€æœ‰å…ƒç´ å‡æ’åºå®Œæ¯•ã€‚</p>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/selectionSort.gif\" alt=\"é€‰æ‹©æ’åº\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * å¯¹äºæ¯ä¸ªä½ç½®æˆ‘ä»¬æ’å…¥å…¶åº”å½“æœ‰çš„å…ƒç´ ï¼Œå³å¯¹äºç¬¬0ä½ç½®çš„å…ƒç´ ï¼Œæˆ‘ä»¬æ‰¾åˆ°æœ€å°çš„ç„¶åå’Œè¿™ä¸ªä½ç½®çš„å…ƒç´ è¿›è¡Œäº¤æ¢</span></span><br><span class=\"line\"><span class=\"comment\">  *</span></span><br><span class=\"line\"><span class=\"comment\">  * <span class=\"doctag\">@param</span> arr</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">selectionSort</span><span class=\"params\">(<span class=\"type\">int</span>[] arr)</span> {</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">n</span> <span class=\"operator\">=</span> arr.length;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; n; i++) {</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">min_index</span> <span class=\"operator\">=</span> i;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">j</span> <span class=\"operator\">=</span> i; j &lt; n; j++) {</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (arr[j] &lt; arr[min_index]) {</span><br><span class=\"line\">                min_index = j;</span><br><span class=\"line\">            }</span><br><span class=\"line\">        }</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">temp</span> <span class=\"operator\">=</span> arr[i];</span><br><span class=\"line\">        arr[i] = arr[min_index];</span><br><span class=\"line\">        arr[min_index] = temp;</span><br><span class=\"line\">    }</span><br><span class=\"line\">}</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"å¿«æ’\"><a href=\"#å¿«æ’\" class=\"headerlink\" title=\"å¿«æ’\"></a>å¿«æ’</h3><ol>\n<li>ä»æ•°åˆ—ä¸­æŒ‘å‡ºä¸€ä¸ªå…ƒç´ ï¼Œç§°ä¸º â€œåŸºå‡†â€ï¼ˆpivotï¼‰;</li>\n<li>é‡æ–°æ’åºæ•°åˆ—ï¼Œæ‰€æœ‰å…ƒç´ æ¯”åŸºå‡†å€¼å°çš„æ‘†æ”¾åœ¨åŸºå‡†å‰é¢ï¼Œæ‰€æœ‰å…ƒç´ æ¯”åŸºå‡†å€¼å¤§çš„æ‘†åœ¨åŸºå‡†çš„åé¢ï¼ˆç›¸åŒçš„æ•°å¯ä»¥åˆ°ä»»ä¸€è¾¹ï¼‰ã€‚åœ¨è¿™ä¸ªåˆ†åŒºé€€å‡ºä¹‹åï¼Œè¯¥åŸºå‡†å°±å¤„äºæ•°åˆ—çš„ä¸­é—´ä½ç½®ã€‚è¿™ä¸ªç§°ä¸ºåˆ†åŒºï¼ˆpartitionï¼‰æ“ä½œï¼›</li>\n<li>é€’å½’åœ°ï¼ˆrecursiveï¼‰æŠŠå°äºåŸºå‡†å€¼å…ƒç´ çš„å­æ•°åˆ—å’Œå¤§äºåŸºå‡†å€¼å…ƒç´ çš„å­æ•°åˆ—æ’åºï¼›</li>\n</ol>\n<p><img src=\"https://yaxingfang-typora.oss-cn-hangzhou.aliyuncs.com/quickSort-20221125182030127.gif\" alt=\"å¿«é€Ÿæ’åº\"></p>\n<p>é€’å½’ç‰ˆæœ¬ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">quickSort</span><span class=\"params\">(<span class=\"type\">int</span>[] arr)</span> {</span><br><span class=\"line\">    quickSortRange(arr, <span class=\"number\">0</span>, arr.length - <span class=\"number\">1</span>);</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">quickSortRange</span><span class=\"params\">(<span class=\"type\">int</span>[] arr, <span class=\"type\">int</span> left, <span class=\"type\">int</span> right)</span> {</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (left &lt; right) {</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">mid</span> <span class=\"operator\">=</span> partition(arr, left, right);</span><br><span class=\"line\">        quickSortRange(arr, left, mid - <span class=\"number\">1</span>);</span><br><span class=\"line\">        quickSortRange(arr, mid + <span class=\"number\">1</span>, right);</span><br><span class=\"line\">    }</span><br><span class=\"line\"></span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"type\">int</span> <span class=\"title function_\">partition</span><span class=\"params\">(<span class=\"type\">int</span>[] arr, <span class=\"type\">int</span> left, <span class=\"type\">int</span> right)</span> {</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">pivot</span> <span class=\"operator\">=</span> arr[left];</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (left &lt; right) {</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (left &lt; right &amp;&amp; arr[right] &gt;= pivot) {</span><br><span class=\"line\">            right--;</span><br><span class=\"line\">        }</span><br><span class=\"line\">        arr[left] = arr[right];</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (left &lt; right &amp;&amp; arr[left] &lt;= pivot) {</span><br><span class=\"line\">            left++;</span><br><span class=\"line\">        }</span><br><span class=\"line\">        arr[right] = arr[left];</span><br><span class=\"line\">    }</span><br><span class=\"line\">    arr[left] = pivot;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> left;</span><br><span class=\"line\">}</span><br></pre></td></tr></table></figure>\n\n<p>éé€’å½’ç‰ˆæœ¬ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> {</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">quickSort</span><span class=\"params\">(<span class=\"type\">int</span>[] nums)</span> {</span><br><span class=\"line\">        stackQuickSort(nums, <span class=\"number\">0</span>, nums.length - <span class=\"number\">1</span>);</span><br><span class=\"line\">    }</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">stackQuickSort</span><span class=\"params\">(<span class=\"type\">int</span>[] nums, <span class=\"type\">int</span> left, <span class=\"type\">int</span> right)</span> {</span><br><span class=\"line\">        Deque&lt;Integer&gt; stack = <span class=\"keyword\">new</span> <span class=\"title class_\">LinkedList</span>&lt;&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (left &lt; right) {</span><br><span class=\"line\">            stack.push(right);</span><br><span class=\"line\">            stack.push(left);</span><br><span class=\"line\">        }</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (!stack.isEmpty()) {</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">l</span> <span class=\"operator\">=</span> stack.pop();</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">r</span> <span class=\"operator\">=</span> stack.pop();</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">mid</span> <span class=\"operator\">=</span> partition(nums, l, r);</span><br><span class=\"line\">            <span class=\"comment\">// å¾—åˆ°midååˆ’åˆ†ä¸º [l, mid - 1] mid [mid + 1, r]</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (l &lt; mid - <span class=\"number\">1</span>) {</span><br><span class=\"line\">                stack.push(mid - <span class=\"number\">1</span>);</span><br><span class=\"line\">                stack.push(l);</span><br><span class=\"line\">            }</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (r &gt; mid + <span class=\"number\">1</span>) {</span><br><span class=\"line\">                stack.push(r);</span><br><span class=\"line\">                stack.push(mid + <span class=\"number\">1</span>);</span><br><span class=\"line\">            }</span><br><span class=\"line\">        }</span><br><span class=\"line\">    }</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> <span class=\"title function_\">partition</span><span class=\"params\">(<span class=\"type\">int</span>[] nums, <span class=\"type\">int</span> left, <span class=\"type\">int</span> right)</span> {</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">pivot</span> <span class=\"operator\">=</span> nums[left];</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (left &lt; right) {</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (left &lt; right &amp;&amp; nums[right] &gt;= pivot) {</span><br><span class=\"line\">                right--;</span><br><span class=\"line\">            }</span><br><span class=\"line\">            nums[left] = nums[right];</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (left &lt; right &amp;&amp; nums[left] &lt;= pivot) {</span><br><span class=\"line\">                left++;</span><br><span class=\"line\">            }</span><br><span class=\"line\">            nums[right] = nums[left];</span><br><span class=\"line\">        }</span><br><span class=\"line\">        nums[left] = pivot;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> left;</span><br><span class=\"line\">    }</span><br><span class=\"line\">}</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"å †\"><a href=\"#å †\" class=\"headerlink\" title=\"å †\"></a>å †</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">heapSort</span><span class=\"params\">(<span class=\"type\">int</span>[] arr)</span> {</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">len</span> <span class=\"operator\">=</span> arr.length;</span><br><span class=\"line\"></span><br><span class=\"line\">    buildMaxHeap(arr, len);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> len - <span class=\"number\">1</span>; i &gt; <span class=\"number\">0</span>; i--) {</span><br><span class=\"line\">        swap(arr, <span class=\"number\">0</span>, i);</span><br><span class=\"line\">        len--;</span><br><span class=\"line\">        heapify(arr, <span class=\"number\">0</span>, len);</span><br><span class=\"line\">    }</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">buildMaxHeap</span><span class=\"params\">(<span class=\"type\">int</span>[] arr, <span class=\"type\">int</span> len)</span> {</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> len / <span class=\"number\">2</span> - <span class=\"number\">1</span>; i &gt;= <span class=\"number\">0</span>; i--) {</span><br><span class=\"line\">        heapify(arr, i, len);</span><br><span class=\"line\">    }</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">heapify</span><span class=\"params\">(<span class=\"type\">int</span>[] arr, <span class=\"type\">int</span> i, <span class=\"type\">int</span> len)</span> {</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>) {</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">left</span> <span class=\"operator\">=</span> <span class=\"number\">2</span> * i + <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">right</span> <span class=\"operator\">=</span> <span class=\"number\">2</span> * i + <span class=\"number\">2</span>;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">largest</span> <span class=\"operator\">=</span> i;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (left &lt; len &amp;&amp; arr[left] &gt; arr[largest]) {</span><br><span class=\"line\">            largest = left;</span><br><span class=\"line\">        }</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (right &lt; len &amp;&amp; arr[right] &gt; arr[largest]) {</span><br><span class=\"line\">            largest = right;</span><br><span class=\"line\">        }</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (largest == i) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        swap(arr, i, largest);</span><br><span class=\"line\">        i = largest;</span><br><span class=\"line\">    }</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">swap</span><span class=\"params\">(<span class=\"type\">int</span>[] arr, <span class=\"type\">int</span> i, <span class=\"type\">int</span> j)</span> {</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">temp</span> <span class=\"operator\">=</span> arr[i];</span><br><span class=\"line\">    arr[i] = arr[j];</span><br><span class=\"line\">    arr[j] = temp;</span><br><span class=\"line\">}</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"å½’å¹¶\"><a href=\"#å½’å¹¶\" class=\"headerlink\" title=\"å½’å¹¶\"></a>å½’å¹¶</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t* å½’å¹¶æ’åº</span></span><br><span class=\"line\"><span class=\"comment\">  * <span class=\"doctag\">@param</span> arr</span></span><br><span class=\"line\"><span class=\"comment\">  * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"type\">int</span>[] mergeSort(<span class=\"type\">int</span>[] arr) {</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (arr == <span class=\"literal\">null</span> || arr.length &lt;= <span class=\"number\">1</span>) <span class=\"keyword\">return</span> arr;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">n</span> <span class=\"operator\">=</span> arr.length;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">mid</span> <span class=\"operator\">=</span> n / <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span>[] left = Arrays.copyOfRange(arr, <span class=\"number\">0</span>, mid);</span><br><span class=\"line\">    <span class=\"type\">int</span>[] right = Arrays.copyOfRange(arr, mid, n);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> merge(mergeSort(left), mergeSort(right));</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"type\">int</span>[] merge(<span class=\"type\">int</span>[] a, <span class=\"type\">int</span>[] b) {</span><br><span class=\"line\">    <span class=\"type\">int</span>[] res = <span class=\"keyword\">new</span> <span class=\"title class_\">int</span>[a.length + b.length];</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>, j = <span class=\"number\">0</span>, ind = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (i &lt; a.length &amp;&amp; j &lt; b.length) {</span><br><span class=\"line\">        res[ind++] = (a[i] &lt; b[j]) ? a[i++] : b[j++];</span><br><span class=\"line\">    }</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (i &lt; a.length) {</span><br><span class=\"line\">        res[ind++] = a[i++];</span><br><span class=\"line\">    }</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (j &lt; b.length) {</span><br><span class=\"line\">        res[ind++] = b[j++];</span><br><span class=\"line\">    }</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">}</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"å¸Œå°”\"><a href=\"#å¸Œå°”\" class=\"headerlink\" title=\"å¸Œå°”\"></a>å¸Œå°”</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t* å¸Œå°”æ’åºï¼Œå‡å¢é‡æ’åºç®—æ³•ï¼Œæ˜¯æ’å…¥æ’åºçš„ä¸€ç§æ›´é«˜æ•ˆçš„æ”¹è¿›ç‰ˆæœ¬ã€‚ä½†å¸Œå°”æ’åºæ˜¯éç¨³å®šæ’åºç®—æ³•ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">\t* <span class=\"doctag\">@param</span> arr</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">shellSort</span><span class=\"params\">(<span class=\"type\">int</span>[] arr)</span> {</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">n</span> <span class=\"operator\">=</span> arr.length;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">gap</span> <span class=\"operator\">=</span> n / <span class=\"number\">2</span>; gap &gt; <span class=\"number\">0</span>; gap /= <span class=\"number\">2</span>) {</span><br><span class=\"line\">        <span class=\"comment\">// {i, i+gap, i+2gap, ...}</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; n; i++) {</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">cur_val</span> <span class=\"operator\">=</span> arr[i];</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">idx</span> <span class=\"operator\">=</span> i - gap;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (idx &gt;= <span class=\"number\">0</span> &amp;&amp; arr[idx] &gt; cur_val) {</span><br><span class=\"line\">                arr[idx + gap] = arr[idx];</span><br><span class=\"line\">                idx -= gap;</span><br><span class=\"line\">            }</span><br><span class=\"line\">            arr[idx + gap] = cur_val;</span><br><span class=\"line\">        }</span><br><span class=\"line\">    }</span><br><span class=\"line\">}</span><br></pre></td></tr></table></figure>"}],"PostAsset":[],"PostCategory":[{"post_id":"cldzfw31p0001t9t8bfgybk9z","category_id":"cldzfw31t0004t9t86fxx7k2s","_id":"cldzfw31z000ct9t8gv51g7b4"},{"post_id":"cldzfw322000ht9t8001aa5cu","category_id":"cldzfw321000gt9t82r04hnto","_id":"cldzfw324000mt9t8gfx3feri"},{"post_id":"cldzfw31w0007t9t8f86m5nb0","category_id":"cldzfw321000gt9t82r04hnto","_id":"cldzfw325000pt9t87w23061s"},{"post_id":"cldzfw322000it9t83h3z0w23","category_id":"cldzfw321000gt9t82r04hnto","_id":"cldzfw325000rt9t8cjha9z3d"},{"post_id":"cldzfw323000kt9t80bu0aizt","category_id":"cldzfw321000gt9t82r04hnto","_id":"cldzfw326000ut9t81pnv4pez"},{"post_id":"cldzfw31w0008t9t883lmba4k","category_id":"cldzfw321000gt9t82r04hnto","_id":"cldzfw327000wt9t8g3w23a0b"},{"post_id":"cldzfw31y000at9t8hzfmcqld","category_id":"cldzfw321000gt9t82r04hnto","_id":"cldzfw327000zt9t8cpp7husa"},{"post_id":"cldzfw326000tt9t8h9aa10ku","category_id":"cldzfw31t0004t9t86fxx7k2s","_id":"cldzfw3280011t9t8crnxb5vj"},{"post_id":"cldzfw31s0003t9t865h262z4","category_id":"cldzfw31x0009t9t8h8hbd442","_id":"cldzfw3290014t9t8hg8w9szm"},{"post_id":"cldzfw31s0003t9t865h262z4","category_id":"cldzfw326000st9t82jv6cdlu","_id":"cldzfw3290016t9t8bfoybush"},{"post_id":"cldzfw326000vt9t81ihgaxuw","category_id":"cldzfw31x0009t9t8h8hbd442","_id":"cldzfw32a0019t9t8euks6vlw"},{"post_id":"cldzfw326000vt9t81ihgaxuw","category_id":"cldzfw326000st9t82jv6cdlu","_id":"cldzfw32a001bt9t89f350jux"},{"post_id":"cldzfw327000yt9t857gt6vr3","category_id":"cldzfw321000gt9t82r04hnto","_id":"cldzfw32b001dt9t8azp23r8w"},{"post_id":"cldzfw31y000bt9t8d77e6f6g","category_id":"cldzfw321000gt9t82r04hnto","_id":"cldzfw32c001gt9t8av046wb5"},{"post_id":"cldzfw3280010t9t80132hzi0","category_id":"cldzfw31t0004t9t86fxx7k2s","_id":"cldzfw32c001it9t8ciwag29n"},{"post_id":"cldzfw3280013t9t889q7blhp","category_id":"cldzfw321000gt9t82r04hnto","_id":"cldzfw32c001kt9t829ui9iut"},{"post_id":"cldzfw320000et9t827tqb6pj","category_id":"cldzfw321000gt9t82r04hnto","_id":"cldzfw32d001lt9t8fx9lcaz0"},{"post_id":"cldzfw32a0018t9t80g27c17z","category_id":"cldzfw31t0004t9t86fxx7k2s","_id":"cldzfw32d001nt9t82eu683k3"},{"post_id":"cldzfw32a001at9t88remake6","category_id":"cldzfw31t0004t9t86fxx7k2s","_id":"cldzfw32d001ot9t8gjdre6un"},{"post_id":"cldzfw31v0006t9t88c4za2p0","category_id":"cldzfw31x0009t9t8h8hbd442","_id":"cldzfw32d001qt9t8fopk8y3b"},{"post_id":"cldzfw31v0006t9t88c4za2p0","category_id":"cldzfw32a0017t9t80iblfx7j","_id":"cldzfw32d001rt9t8ecec5phc"},{"post_id":"cldzfw32b001ct9t88yodawq8","category_id":"cldzfw31t0004t9t86fxx7k2s","_id":"cldzfw32d001tt9t88xhx2wiv"},{"post_id":"cldzfw32b001ft9t80w2fb6d7","category_id":"cldzfw31t0004t9t86fxx7k2s","_id":"cldzfw32d001ut9t80ynrc1r8"},{"post_id":"cldzfw321000ft9t82hv43rgr","category_id":"cldzfw321000gt9t82r04hnto","_id":"cldzfw32e001wt9t8afzl6z5u"},{"post_id":"cldzfw324000lt9t81a19ajys","category_id":"cldzfw32c001jt9t85v626a5j","_id":"cldzfw32e001xt9t800d86rp5"},{"post_id":"cldzfw324000ot9t8gyptfx3q","category_id":"cldzfw32d001mt9t886rm9wo5","_id":"cldzfw32e001yt9t8hhlha5w8"},{"post_id":"cldzfw325000qt9t8fhuraug6","category_id":"cldzfw32d001pt9t88wpifyz5","_id":"cldzfw32e001zt9t85mz3boyt"},{"post_id":"cldzfw3290015t9t845071rec","category_id":"cldzfw32d001mt9t886rm9wo5","_id":"cldzfw32e0020t9t8hq4egilu"},{"post_id":"cldzfw32c001ht9t831k882v6","category_id":"cldzfw32d001vt9t8h6hj1xu8","_id":"cldzfw32e0021t9t85fuzblnd"}],"PostTag":[],"Tag":[]}}